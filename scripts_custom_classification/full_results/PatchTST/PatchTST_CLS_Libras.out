Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.40629506111145
Epoch: 1, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.281 Vali Acc: 0.322 Test Loss: 2.281 Test Acc: 0.322
Validation loss decreased (inf --> -0.322199).  Saving model ...
Epoch: 2 cost time: 1.691669225692749
Epoch: 2, Steps: 12 | Train Loss: 1.979 Vali Loss: 1.607 Vali Acc: 0.522 Test Loss: 1.607 Test Acc: 0.522
Validation loss decreased (-0.322199 --> -0.522206).  Saving model ...
Epoch: 3 cost time: 1.7005629539489746
Epoch: 3, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.374 Vali Acc: 0.561 Test Loss: 1.374 Test Acc: 0.561
Validation loss decreased (-0.522206 --> -0.561097).  Saving model ...
Epoch: 4 cost time: 1.623870849609375
Epoch: 4, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.252 Vali Acc: 0.622 Test Loss: 1.252 Test Acc: 0.622
Validation loss decreased (-0.561097 --> -0.622210).  Saving model ...
Epoch: 5 cost time: 1.5336370468139648
Epoch: 5, Steps: 12 | Train Loss: 0.685 Vali Loss: 1.139 Vali Acc: 0.689 Test Loss: 1.139 Test Acc: 0.689
Validation loss decreased (-0.622210 --> -0.688878).  Saving model ...
Epoch: 6 cost time: 1.4307372570037842
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 1.210 Vali Acc: 0.661 Test Loss: 1.210 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5257513523101807
Epoch: 7, Steps: 12 | Train Loss: 0.484 Vali Loss: 1.122 Vali Acc: 0.672 Test Loss: 1.122 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5155632495880127
Epoch: 8, Steps: 12 | Train Loss: 0.360 Vali Loss: 1.184 Vali Acc: 0.694 Test Loss: 1.184 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694433).  Saving model ...
Epoch: 9 cost time: 1.4276509284973145
Epoch: 9, Steps: 12 | Train Loss: 0.317 Vali Loss: 1.043 Vali Acc: 0.728 Test Loss: 1.043 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727767).  Saving model ...
Epoch: 10 cost time: 1.5521280765533447
Epoch: 10, Steps: 12 | Train Loss: 0.252 Vali Loss: 1.148 Vali Acc: 0.772 Test Loss: 1.148 Test Acc: 0.772
Validation loss decreased (-0.727767 --> -0.772211).  Saving model ...
Epoch: 11 cost time: 1.7197761535644531
Epoch: 11, Steps: 12 | Train Loss: 0.191 Vali Loss: 1.259 Vali Acc: 0.728 Test Loss: 1.259 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.597931146621704
Epoch: 12, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.312 Vali Acc: 0.711 Test Loss: 1.312 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5179271697998047
Epoch: 13, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.420 Vali Acc: 0.728 Test Loss: 1.420 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3857669830322266
Epoch: 14, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.450 Vali Acc: 0.722 Test Loss: 1.450 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.568063735961914
Epoch: 15, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.518 Vali Acc: 0.722 Test Loss: 1.518 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5925517082214355
Epoch: 16, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.500 Vali Acc: 0.733 Test Loss: 1.500 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5623109340667725
Epoch: 17, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.705 Vali Acc: 0.733 Test Loss: 1.705 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5485730171203613
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.749 Vali Acc: 0.717 Test Loss: 1.749 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5256147384643555
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.756 Vali Acc: 0.733 Test Loss: 1.756 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4919991493225098
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.715 Vali Acc: 0.756 Test Loss: 1.715 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 570767
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.59295654296875
Epoch: 1, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.414 Vali Acc: 0.294 Test Loss: 2.414 Test Acc: 0.294
Validation loss decreased (inf --> -0.294420).  Saving model ...
Epoch: 2 cost time: 0.8095717430114746
Epoch: 2, Steps: 12 | Train Loss: 2.146 Vali Loss: 1.878 Vali Acc: 0.506 Test Loss: 1.878 Test Acc: 0.506
Validation loss decreased (-0.294420 --> -0.505537).  Saving model ...
Epoch: 3 cost time: 0.9097232818603516
Epoch: 3, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.554 Vali Acc: 0.539 Test Loss: 1.554 Test Acc: 0.539
Validation loss decreased (-0.505537 --> -0.538873).  Saving model ...
Epoch: 4 cost time: 0.8360245227813721
Epoch: 4, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.344 Vali Acc: 0.606 Test Loss: 1.344 Test Acc: 0.606
Validation loss decreased (-0.538873 --> -0.605542).  Saving model ...
Epoch: 5 cost time: 0.9995379447937012
Epoch: 5, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.260 Vali Acc: 0.633 Test Loss: 1.260 Test Acc: 0.633
Validation loss decreased (-0.605542 --> -0.633321).  Saving model ...
Epoch: 6 cost time: 0.8353714942932129
Epoch: 6, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.230 Vali Acc: 0.639 Test Loss: 1.230 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 0.8284587860107422
Epoch: 7, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.144 Vali Acc: 0.683 Test Loss: 1.144 Test Acc: 0.683
Validation loss decreased (-0.638877 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 0.8739917278289795
Epoch: 8, Steps: 12 | Train Loss: 0.517 Vali Loss: 1.094 Vali Acc: 0.678 Test Loss: 1.094 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9459469318389893
Epoch: 9, Steps: 12 | Train Loss: 0.453 Vali Loss: 1.016 Vali Acc: 0.733 Test Loss: 1.016 Test Acc: 0.733
Validation loss decreased (-0.683322 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 0.9511451721191406
Epoch: 10, Steps: 12 | Train Loss: 0.372 Vali Loss: 1.026 Vali Acc: 0.711 Test Loss: 1.026 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9928123950958252
Epoch: 11, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.975 Vali Acc: 0.733 Test Loss: 0.975 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733324).  Saving model ...
Epoch: 12 cost time: 0.9006352424621582
Epoch: 12, Steps: 12 | Train Loss: 0.283 Vali Loss: 1.059 Vali Acc: 0.728 Test Loss: 1.059 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8933165073394775
Epoch: 13, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.091 Vali Acc: 0.750 Test Loss: 1.091 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 0.8834807872772217
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.188 Vali Acc: 0.706 Test Loss: 1.188 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9373862743377686
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.060 Vali Acc: 0.772 Test Loss: 1.060 Test Acc: 0.772
Validation loss decreased (-0.749989 --> -0.772212).  Saving model ...
Epoch: 16 cost time: 0.8804738521575928
Epoch: 16, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.135 Vali Acc: 0.761 Test Loss: 1.135 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8817205429077148
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.158 Vali Acc: 0.750 Test Loss: 1.158 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9295904636383057
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.327 Vali Acc: 0.728 Test Loss: 1.327 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9053471088409424
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.187 Vali Acc: 0.767 Test Loss: 1.187 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9393398761749268
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.349 Vali Acc: 0.744 Test Loss: 1.349 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9513652324676514
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.308 Vali Acc: 0.750 Test Loss: 1.308 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9724853038787842
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.344 Vali Acc: 0.761 Test Loss: 1.344 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9258067607879639
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.373 Vali Acc: 0.739 Test Loss: 1.373 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9723489284515381
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.381 Vali Acc: 0.739 Test Loss: 1.381 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0382652282714844
Epoch: 25, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.340 Vali Acc: 0.750 Test Loss: 1.340 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 486415
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3209328651428223
Epoch: 1, Steps: 12 | Train Loss: 2.865 Vali Loss: 2.533 Vali Acc: 0.217 Test Loss: 2.533 Test Acc: 0.217
Validation loss decreased (inf --> -0.216641).  Saving model ...
Epoch: 2 cost time: 0.8972973823547363
Epoch: 2, Steps: 12 | Train Loss: 2.285 Vali Loss: 1.961 Vali Acc: 0.450 Test Loss: 1.961 Test Acc: 0.450
Validation loss decreased (-0.216641 --> -0.449980).  Saving model ...
Epoch: 3 cost time: 0.9286026954650879
Epoch: 3, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.594 Vali Acc: 0.544 Test Loss: 1.594 Test Acc: 0.544
Validation loss decreased (-0.449980 --> -0.544429).  Saving model ...
Epoch: 4 cost time: 0.9284727573394775
Epoch: 4, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.359 Vali Acc: 0.600 Test Loss: 1.359 Test Acc: 0.600
Validation loss decreased (-0.544429 --> -0.599986).  Saving model ...
Epoch: 5 cost time: 0.9114067554473877
Epoch: 5, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.241 Vali Acc: 0.600 Test Loss: 1.241 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 1.0067622661590576
Epoch: 6, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.188 Vali Acc: 0.661 Test Loss: 1.188 Test Acc: 0.661
Validation loss decreased (-0.599988 --> -0.661099).  Saving model ...
Epoch: 7 cost time: 1.01869797706604
Epoch: 7, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.073 Vali Acc: 0.683 Test Loss: 1.073 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 0.9004237651824951
Epoch: 8, Steps: 12 | Train Loss: 0.557 Vali Loss: 1.080 Vali Acc: 0.678 Test Loss: 1.080 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9402341842651367
Epoch: 9, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.961 Vali Acc: 0.733 Test Loss: 0.961 Test Acc: 0.733
Validation loss decreased (-0.683323 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 1.0025405883789062
Epoch: 10, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1265192031860352
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.937 Vali Acc: 0.739 Test Loss: 0.937 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 12 cost time: 1.033975601196289
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.8824479579925537
Epoch: 13, Steps: 12 | Train Loss: 0.272 Vali Loss: 1.019 Vali Acc: 0.722 Test Loss: 1.019 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9393067359924316
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.055 Vali Acc: 0.761 Test Loss: 1.055 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 15 cost time: 0.9551699161529541
Epoch: 15, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.085 Vali Acc: 0.750 Test Loss: 1.085 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0100526809692383
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.061 Vali Acc: 0.761 Test Loss: 1.061 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8429393768310547
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.160 Vali Acc: 0.767 Test Loss: 1.160 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766655).  Saving model ...
Epoch: 18 cost time: 0.9487361907958984
Epoch: 18, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.198 Vali Acc: 0.744 Test Loss: 1.198 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9558677673339844
Epoch: 19, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.212 Vali Acc: 0.767 Test Loss: 1.212 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8853011131286621
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.202 Vali Acc: 0.761 Test Loss: 1.202 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0139856338500977
Epoch: 21, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.354 Vali Acc: 0.744 Test Loss: 1.354 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8782401084899902
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.294 Vali Acc: 0.756 Test Loss: 1.294 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.816962718963623
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.281 Vali Acc: 0.772 Test Loss: 1.281 Test Acc: 0.772
Validation loss decreased (-0.766655 --> -0.772209).  Saving model ...
Epoch: 24 cost time: 0.9112222194671631
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.300 Vali Acc: 0.761 Test Loss: 1.300 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9049451351165771
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.356 Vali Acc: 0.756 Test Loss: 1.356 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9442348480224609
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.339 Vali Acc: 0.744 Test Loss: 1.339 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9366693496704102
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.375 Vali Acc: 0.767 Test Loss: 1.375 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0263185501098633
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.355 Vali Acc: 0.750 Test Loss: 1.355 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9878673553466797
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.410 Vali Acc: 0.767 Test Loss: 1.410 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9542956352233887
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.424 Vali Acc: 0.772 Test Loss: 1.424 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9071848392486572
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.412 Vali Acc: 0.767 Test Loss: 1.412 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9896359443664551
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.342 Vali Acc: 0.778 Test Loss: 1.342 Test Acc: 0.778
Validation loss decreased (-0.772209 --> -0.777764).  Saving model ...
Epoch: 33 cost time: 1.0576856136322021
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.373 Vali Acc: 0.794 Test Loss: 1.373 Test Acc: 0.794
Validation loss decreased (-0.777764 --> -0.794431).  Saving model ...
Epoch: 34 cost time: 0.9300577640533447
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.478 Vali Acc: 0.761 Test Loss: 1.478 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8835463523864746
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.484 Vali Acc: 0.744 Test Loss: 1.484 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9992561340332031
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.584 Vali Acc: 0.772 Test Loss: 1.584 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9916775226593018
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.455 Vali Acc: 0.767 Test Loss: 1.455 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.935814619064331
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.431 Vali Acc: 0.772 Test Loss: 1.431 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9037120342254639
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.479 Vali Acc: 0.772 Test Loss: 1.479 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8740899562835693
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.527 Vali Acc: 0.761 Test Loss: 1.527 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9173398017883301
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.767 Test Loss: 1.535 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9560904502868652
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.538 Vali Acc: 0.761 Test Loss: 1.538 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9764742851257324
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.527 Vali Acc: 0.767 Test Loss: 1.527 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 482703
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6016833782196045
Epoch: 1, Steps: 12 | Train Loss: 2.917 Vali Loss: 2.643 Vali Acc: 0.122 Test Loss: 2.643 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.8746929168701172
Epoch: 2, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.132 Vali Acc: 0.378 Test Loss: 2.132 Test Acc: 0.378
Validation loss decreased (-0.122196 --> -0.377756).  Saving model ...
Epoch: 3 cost time: 0.8721115589141846
Epoch: 3, Steps: 12 | Train Loss: 1.975 Vali Loss: 1.750 Vali Acc: 0.511 Test Loss: 1.750 Test Acc: 0.511
Validation loss decreased (-0.377756 --> -0.511094).  Saving model ...
Epoch: 4 cost time: 0.8768298625946045
Epoch: 4, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.508 Vali Acc: 0.556 Test Loss: 1.508 Test Acc: 0.556
Validation loss decreased (-0.511094 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 0.8714752197265625
Epoch: 5, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.341 Vali Acc: 0.600 Test Loss: 1.341 Test Acc: 0.600
Validation loss decreased (-0.555540 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 0.9691760540008545
Epoch: 6, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.262 Vali Acc: 0.633 Test Loss: 1.262 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 0.9411921501159668
Epoch: 7, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.176 Vali Acc: 0.672 Test Loss: 1.176 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672210).  Saving model ...
Epoch: 8 cost time: 0.9344022274017334
Epoch: 8, Steps: 12 | Train Loss: 0.725 Vali Loss: 1.182 Vali Acc: 0.678 Test Loss: 1.182 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677766).  Saving model ...
Epoch: 9 cost time: 1.034379243850708
Epoch: 9, Steps: 12 | Train Loss: 0.569 Vali Loss: 1.087 Vali Acc: 0.706 Test Loss: 1.087 Test Acc: 0.706
Validation loss decreased (-0.677766 --> -0.705545).  Saving model ...
Epoch: 10 cost time: 0.9490687847137451
Epoch: 10, Steps: 12 | Train Loss: 0.496 Vali Loss: 1.037 Vali Acc: 0.722 Test Loss: 1.037 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722212).  Saving model ...
Epoch: 11 cost time: 0.9505548477172852
Epoch: 11, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.975 Vali Acc: 0.722 Test Loss: 0.975 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 0.8888700008392334
Epoch: 12, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.999 Vali Acc: 0.733 Test Loss: 0.999 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 0.8526711463928223
Epoch: 13, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.932 Vali Acc: 0.739 Test Loss: 0.932 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 14 cost time: 0.9308702945709229
Epoch: 14, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.937 Vali Acc: 0.772 Test Loss: 0.937 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772213).  Saving model ...
Epoch: 15 cost time: 0.9050712585449219
Epoch: 15, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.919 Vali Acc: 0.778 Test Loss: 0.919 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 0.962670087814331
Epoch: 16, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.933 Vali Acc: 0.811 Test Loss: 0.933 Test Acc: 0.811
Validation loss decreased (-0.777769 --> -0.811102).  Saving model ...
Epoch: 17 cost time: 1.0121328830718994
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.990 Vali Acc: 0.728 Test Loss: 0.990 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8869671821594238
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.957 Vali Acc: 0.800 Test Loss: 0.957 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8937878608703613
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.934 Vali Acc: 0.772 Test Loss: 0.934 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0636646747589111
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.095 Vali Acc: 0.750 Test Loss: 1.095 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9267590045928955
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.029 Vali Acc: 0.800 Test Loss: 1.029 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8499531745910645
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.052 Vali Acc: 0.767 Test Loss: 1.052 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.855973482131958
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.130 Vali Acc: 0.767 Test Loss: 1.130 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9628775119781494
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.099 Vali Acc: 0.783 Test Loss: 1.099 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9404830932617188
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.145 Vali Acc: 0.772 Test Loss: 1.145 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.86676025390625
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.108 Vali Acc: 0.772 Test Loss: 1.108 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 455951
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6775267124176025
Epoch: 1, Steps: 12 | Train Loss: 2.919 Vali Loss: 2.707 Vali Acc: 0.189 Test Loss: 2.707 Test Acc: 0.189
Validation loss decreased (inf --> -0.188862).  Saving model ...
Epoch: 2 cost time: 1.027360439300537
Epoch: 2, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.273 Vali Acc: 0.317 Test Loss: 2.273 Test Acc: 0.317
Validation loss decreased (-0.188862 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 0.8553488254547119
Epoch: 3, Steps: 12 | Train Loss: 2.112 Vali Loss: 1.893 Vali Acc: 0.461 Test Loss: 1.893 Test Acc: 0.461
Validation loss decreased (-0.316644 --> -0.461092).  Saving model ...
Epoch: 4 cost time: 1.0578324794769287
Epoch: 4, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.647 Vali Acc: 0.528 Test Loss: 1.647 Test Acc: 0.528
Validation loss decreased (-0.461092 --> -0.527761).  Saving model ...
Epoch: 5 cost time: 0.9821372032165527
Epoch: 5, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.444 Vali Acc: 0.556 Test Loss: 1.444 Test Acc: 0.556
Validation loss decreased (-0.527761 --> -0.555541).  Saving model ...
Epoch: 6 cost time: 0.8255925178527832
Epoch: 6, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.320 Vali Acc: 0.617 Test Loss: 1.320 Test Acc: 0.617
Validation loss decreased (-0.555541 --> -0.616653).  Saving model ...
Epoch: 7 cost time: 0.9494309425354004
Epoch: 7, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.199 Vali Acc: 0.628 Test Loss: 1.199 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627766).  Saving model ...
Epoch: 8 cost time: 0.9365284442901611
Epoch: 8, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.124 Vali Acc: 0.644 Test Loss: 1.124 Test Acc: 0.644
Validation loss decreased (-0.627766 --> -0.644433).  Saving model ...
Epoch: 9 cost time: 0.9810914993286133
Epoch: 9, Steps: 12 | Train Loss: 0.665 Vali Loss: 1.069 Vali Acc: 0.656 Test Loss: 1.069 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655545).  Saving model ...
Epoch: 10 cost time: 0.9270932674407959
Epoch: 10, Steps: 12 | Train Loss: 0.620 Vali Loss: 1.016 Vali Acc: 0.667 Test Loss: 1.016 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.9412295818328857
Epoch: 11, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.954 Vali Acc: 0.689 Test Loss: 0.954 Test Acc: 0.689
Validation loss decreased (-0.666657 --> -0.688879).  Saving model ...
Epoch: 12 cost time: 0.9901435375213623
Epoch: 12, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.904 Vali Acc: 0.711 Test Loss: 0.904 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.9533543586730957
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
Validation loss decreased (-0.711102 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.8922734260559082
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.887 Vali Acc: 0.744 Test Loss: 0.887 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.010237693786621
Epoch: 15, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.840 Vali Acc: 0.772 Test Loss: 0.840 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772214).  Saving model ...
Epoch: 16 cost time: 0.9153003692626953
Epoch: 16, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9008448123931885
Epoch: 17, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.840 Vali Acc: 0.761 Test Loss: 0.840 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9341473579406738
Epoch: 18, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.839 Vali Acc: 0.761 Test Loss: 0.839 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8942043781280518
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.915 Vali Acc: 0.778 Test Loss: 0.915 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777769).  Saving model ...
Epoch: 20 cost time: 0.8588047027587891
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.859 Vali Acc: 0.772 Test Loss: 0.859 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9057211875915527
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.882 Vali Acc: 0.756 Test Loss: 0.882 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9227659702301025
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.908 Vali Acc: 0.778 Test Loss: 0.908 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 23 cost time: 0.9505100250244141
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.938 Vali Acc: 0.772 Test Loss: 0.938 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9178750514984131
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.916 Vali Acc: 0.789 Test Loss: 0.916 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 25 cost time: 0.8921692371368408
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.968 Vali Acc: 0.761 Test Loss: 0.968 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9376308917999268
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.975 Vali Acc: 0.778 Test Loss: 0.975 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9875798225402832
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.951 Vali Acc: 0.794 Test Loss: 0.951 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794435).  Saving model ...
Epoch: 28 cost time: 1.0245306491851807
Epoch: 28, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.983 Vali Acc: 0.789 Test Loss: 0.983 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0220355987548828
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.951 Vali Acc: 0.794 Test Loss: 0.951 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.864438533782959
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.960 Vali Acc: 0.794 Test Loss: 0.960 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.99027419090271
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.986 Vali Acc: 0.778 Test Loss: 0.986 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9076635837554932
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.999 Vali Acc: 0.789 Test Loss: 0.999 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9399509429931641
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.974 Vali Acc: 0.811 Test Loss: 0.974 Test Acc: 0.811
Validation loss decreased (-0.794435 --> -0.811101).  Saving model ...
Epoch: 34 cost time: 0.9510667324066162
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.032 Vali Acc: 0.800 Test Loss: 1.032 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9989175796508789
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.049 Vali Acc: 0.800 Test Loss: 1.049 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8944170475006104
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.101 Vali Acc: 0.778 Test Loss: 1.101 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9350881576538086
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.010 Vali Acc: 0.800 Test Loss: 1.010 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8777191638946533
Epoch: 38, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.021 Vali Acc: 0.811 Test Loss: 1.021 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0070013999938965
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.064 Vali Acc: 0.794 Test Loss: 1.064 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9980401992797852
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.106 Vali Acc: 0.817 Test Loss: 1.106 Test Acc: 0.817
Validation loss decreased (-0.811101 --> -0.816656).  Saving model ...
Epoch: 41 cost time: 0.9124536514282227
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.088 Vali Acc: 0.806 Test Loss: 1.088 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9299042224884033
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.129 Vali Acc: 0.811 Test Loss: 1.129 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9535813331604004
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.096 Vali Acc: 0.806 Test Loss: 1.096 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0123934745788574
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.086 Vali Acc: 0.806 Test Loss: 1.086 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9829981327056885
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.117 Vali Acc: 0.800 Test Loss: 1.117 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9215235710144043
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.101 Vali Acc: 0.806 Test Loss: 1.101 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9675462245941162
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.107 Vali Acc: 0.806 Test Loss: 1.107 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0605766773223877
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.128 Vali Acc: 0.800 Test Loss: 1.128 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1997718811035156
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.116 Vali Acc: 0.817 Test Loss: 1.116 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0267713069915771
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.116 Vali Acc: 0.811 Test Loss: 1.116 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 440847
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7553536891937256
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.513 Vali Acc: 0.200 Test Loss: 2.513 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 1.0102448463439941
Epoch: 2, Steps: 12 | Train Loss: 2.424 Vali Loss: 2.138 Vali Acc: 0.422 Test Loss: 2.138 Test Acc: 0.422
Validation loss decreased (-0.199975 --> -0.422201).  Saving model ...
Epoch: 3 cost time: 1.0254085063934326
Epoch: 3, Steps: 12 | Train Loss: 2.017 Vali Loss: 1.819 Vali Acc: 0.522 Test Loss: 1.819 Test Acc: 0.522
Validation loss decreased (-0.422201 --> -0.522204).  Saving model ...
Epoch: 4 cost time: 1.0141055583953857
Epoch: 4, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.590 Vali Acc: 0.561 Test Loss: 1.590 Test Acc: 0.561
Validation loss decreased (-0.522204 --> -0.561095).  Saving model ...
Epoch: 5 cost time: 0.961517333984375
Epoch: 5, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.428 Vali Acc: 0.583 Test Loss: 1.428 Test Acc: 0.583
Validation loss decreased (-0.561095 --> -0.583319).  Saving model ...
Epoch: 6 cost time: 0.9086692333221436
Epoch: 6, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.310 Vali Acc: 0.633 Test Loss: 1.310 Test Acc: 0.633
Validation loss decreased (-0.583319 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 1.0122718811035156
Epoch: 7, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.278 Vali Acc: 0.606 Test Loss: 1.278 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0210480690002441
Epoch: 8, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.189 Vali Acc: 0.661 Test Loss: 1.189 Test Acc: 0.661
Validation loss decreased (-0.633320 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 1.1495938301086426
Epoch: 9, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.090 Vali Acc: 0.672 Test Loss: 1.090 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 0.9760274887084961
Epoch: 10, Steps: 12 | Train Loss: 0.656 Vali Loss: 1.021 Vali Acc: 0.689 Test Loss: 1.021 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 0.870628833770752
Epoch: 11, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.967 Vali Acc: 0.678 Test Loss: 0.967 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9956068992614746
Epoch: 12, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.881 Vali Acc: 0.711 Test Loss: 0.881 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.8500733375549316
Epoch: 13, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.870 Vali Acc: 0.722 Test Loss: 0.870 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 14 cost time: 0.9461269378662109
Epoch: 14, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.821 Vali Acc: 0.750 Test Loss: 0.821 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.9892685413360596
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.810 Vali Acc: 0.733 Test Loss: 0.810 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0494301319122314
Epoch: 16, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 17 cost time: 1.0996894836425781
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.772 Vali Acc: 0.756 Test Loss: 0.772 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 18 cost time: 1.1064326763153076
Epoch: 18, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.779 Vali Acc: 0.761 Test Loss: 0.779 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 19 cost time: 1.0826644897460938
Epoch: 19, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.777 Vali Acc: 0.750 Test Loss: 0.777 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1484167575836182
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0033323764801025
Epoch: 21, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.804 Vali Acc: 0.767 Test Loss: 0.804 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 0.9719340801239014
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783325).  Saving model ...
Epoch: 23 cost time: 1.0072290897369385
Epoch: 23, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.887 Vali Acc: 0.756 Test Loss: 0.887 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0292160511016846
Epoch: 24, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.798 Vali Acc: 0.772 Test Loss: 0.798 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0498533248901367
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.888 Vali Acc: 0.761 Test Loss: 0.888 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9708740711212158
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.813 Vali Acc: 0.789 Test Loss: 0.813 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 27 cost time: 1.0518150329589844
Epoch: 27, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.848 Vali Acc: 0.778 Test Loss: 0.848 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0801167488098145
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.914 Vali Acc: 0.783 Test Loss: 0.914 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9975085258483887
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.846 Vali Acc: 0.817 Test Loss: 0.846 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816658).  Saving model ...
Epoch: 30 cost time: 1.1178600788116455
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.910 Vali Acc: 0.783 Test Loss: 0.910 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9462106227874756
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.890 Vali Acc: 0.778 Test Loss: 0.890 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9403245449066162
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.931 Vali Acc: 0.794 Test Loss: 0.931 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9911057949066162
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.899 Vali Acc: 0.794 Test Loss: 0.899 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9506485462188721
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.952 Vali Acc: 0.794 Test Loss: 0.952 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9167602062225342
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.911 Vali Acc: 0.783 Test Loss: 0.911 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9816935062408447
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.906 Vali Acc: 0.783 Test Loss: 0.906 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.079641342163086
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.968 Vali Acc: 0.800 Test Loss: 0.968 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9502592086791992
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.971 Vali Acc: 0.789 Test Loss: 0.971 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9634017944335938
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.924 Vali Acc: 0.789 Test Loss: 0.924 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 433423
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7045540809631348
Epoch: 1, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.673 Vali Acc: 0.089 Test Loss: 2.673 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.0028517246246338
Epoch: 2, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.332 Vali Acc: 0.317 Test Loss: 2.332 Test Acc: 0.317
Validation loss decreased (-0.088862 --> -0.316643).  Saving model ...
Epoch: 3 cost time: 0.9263224601745605
Epoch: 3, Steps: 12 | Train Loss: 2.182 Vali Loss: 1.999 Vali Acc: 0.450 Test Loss: 1.999 Test Acc: 0.450
Validation loss decreased (-0.316643 --> -0.449980).  Saving model ...
Epoch: 4 cost time: 1.01051664352417
Epoch: 4, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.740 Vali Acc: 0.533 Test Loss: 1.740 Test Acc: 0.533
Validation loss decreased (-0.449980 --> -0.533316).  Saving model ...
Epoch: 5 cost time: 0.9494459629058838
Epoch: 5, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.526 Vali Acc: 0.611 Test Loss: 1.526 Test Acc: 0.611
Validation loss decreased (-0.533316 --> -0.611096).  Saving model ...
Epoch: 6 cost time: 1.0464251041412354
Epoch: 6, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.392 Vali Acc: 0.617 Test Loss: 1.392 Test Acc: 0.617
Validation loss decreased (-0.611096 --> -0.616653).  Saving model ...
Epoch: 7 cost time: 1.0750348567962646
Epoch: 7, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.278 Vali Acc: 0.594 Test Loss: 1.278 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9810605049133301
Epoch: 8, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.179 Vali Acc: 0.656 Test Loss: 1.179 Test Acc: 0.656
Validation loss decreased (-0.616653 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 0.9018614292144775
Epoch: 9, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.078 Vali Acc: 0.656 Test Loss: 1.078 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 10 cost time: 0.8800442218780518
Epoch: 10, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.990 Vali Acc: 0.656 Test Loss: 0.990 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655546).  Saving model ...
Epoch: 11 cost time: 0.8540067672729492
Epoch: 11, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.921 Vali Acc: 0.706 Test Loss: 0.921 Test Acc: 0.706
Validation loss decreased (-0.655546 --> -0.705546).  Saving model ...
Epoch: 12 cost time: 0.9513950347900391
Epoch: 12, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.877 Vali Acc: 0.722 Test Loss: 0.877 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 0.903221607208252
Epoch: 13, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.860 Vali Acc: 0.706 Test Loss: 0.860 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9158523082733154
Epoch: 14, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 1.0248630046844482
Epoch: 15, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.784 Vali Acc: 0.767 Test Loss: 0.784 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 0.9004783630371094
Epoch: 16, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.799 Vali Acc: 0.744 Test Loss: 0.799 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9216907024383545
Epoch: 17, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.752 Vali Acc: 0.767 Test Loss: 0.752 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 0.9485650062561035
Epoch: 18, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.757 Vali Acc: 0.772 Test Loss: 0.757 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 0.9899239540100098
Epoch: 19, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 20 cost time: 0.8932571411132812
Epoch: 20, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.745 Vali Acc: 0.767 Test Loss: 0.745 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9605512619018555
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 22 cost time: 0.984119176864624
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9860315322875977
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.784 Vali Acc: 0.794 Test Loss: 0.784 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 24 cost time: 0.9844822883605957
Epoch: 24, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.762 Vali Acc: 0.794 Test Loss: 0.762 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 25 cost time: 0.9049892425537109
Epoch: 25, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.783 Vali Acc: 0.778 Test Loss: 0.783 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9831442832946777
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0486667156219482
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.780 Vali Acc: 0.806 Test Loss: 0.780 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 28 cost time: 1.0901451110839844
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9458742141723633
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.819 Vali Acc: 0.800 Test Loss: 0.819 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9124917984008789
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9006030559539795
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.849 Vali Acc: 0.789 Test Loss: 0.849 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0455236434936523
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.866 Vali Acc: 0.783 Test Loss: 0.866 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0255355834960938
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.885 Vali Acc: 0.800 Test Loss: 0.885 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9578969478607178
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.898 Vali Acc: 0.789 Test Loss: 0.898 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9425206184387207
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.916 Vali Acc: 0.789 Test Loss: 0.916 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9874687194824219
Epoch: 36, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.891 Vali Acc: 0.800 Test Loss: 0.891 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9730315208435059
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.889 Vali Acc: 0.783 Test Loss: 0.889 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 426127
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6548032760620117
Epoch: 1, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.238 Vali Acc: 0.350 Test Loss: 2.238 Test Acc: 0.350
Validation loss decreased (inf --> -0.349978).  Saving model ...
Epoch: 2 cost time: 1.9551637172698975
Epoch: 2, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.637 Vali Acc: 0.567 Test Loss: 1.637 Test Acc: 0.567
Validation loss decreased (-0.349978 --> -0.566650).  Saving model ...
Epoch: 3 cost time: 2.196370840072632
Epoch: 3, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.431 Vali Acc: 0.572 Test Loss: 1.431 Test Acc: 0.572
Validation loss decreased (-0.566650 --> -0.572208).  Saving model ...
Epoch: 4 cost time: 2.360447645187378
Epoch: 4, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.283 Vali Acc: 0.639 Test Loss: 1.283 Test Acc: 0.639
Validation loss decreased (-0.572208 --> -0.638876).  Saving model ...
Epoch: 5 cost time: 2.0391314029693604
Epoch: 5, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.220 Vali Acc: 0.661 Test Loss: 1.220 Test Acc: 0.661
Validation loss decreased (-0.638876 --> -0.661099).  Saving model ...
Epoch: 6 cost time: 1.9917731285095215
Epoch: 6, Steps: 12 | Train Loss: 0.639 Vali Loss: 1.156 Vali Acc: 0.667 Test Loss: 1.156 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 2.132460832595825
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 1.130 Vali Acc: 0.700 Test Loss: 1.130 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 2.0786311626434326
Epoch: 8, Steps: 12 | Train Loss: 0.451 Vali Loss: 1.053 Vali Acc: 0.711 Test Loss: 1.053 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 9 cost time: 2.08007550239563
Epoch: 9, Steps: 12 | Train Loss: 0.295 Vali Loss: 1.123 Vali Acc: 0.717 Test Loss: 1.123 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716655).  Saving model ...
Epoch: 10 cost time: 2.3592779636383057
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 1.091 Vali Acc: 0.717 Test Loss: 1.091 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716656).  Saving model ...
Epoch: 11 cost time: 2.4595437049865723
Epoch: 11, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.284 Vali Acc: 0.733 Test Loss: 1.284 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733320).  Saving model ...
Epoch: 12 cost time: 1.9882323741912842
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 1.187 Vali Acc: 0.706 Test Loss: 1.187 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1487131118774414
Epoch: 13, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.319 Vali Acc: 0.722 Test Loss: 1.319 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5760326385498047
Epoch: 14, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.331 Vali Acc: 0.722 Test Loss: 1.331 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8914861679077148
Epoch: 15, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.560 Vali Acc: 0.706 Test Loss: 1.560 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9794089794158936
Epoch: 16, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.454 Vali Acc: 0.733 Test Loss: 1.454 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.898024320602417
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.633 Vali Acc: 0.711 Test Loss: 1.633 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6905312538146973
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.660 Vali Acc: 0.700 Test Loss: 1.660 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.667353630065918
Epoch: 19, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.769 Vali Acc: 0.733 Test Loss: 1.769 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7567105293273926
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.597 Vali Acc: 0.772 Test Loss: 1.597 Test Acc: 0.772
Validation loss decreased (-0.733320 --> -0.772206).  Saving model ...
Epoch: 21 cost time: 1.577885627746582
Epoch: 21, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.947 Vali Acc: 0.700 Test Loss: 1.947 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3601415157318115
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.751 Vali Acc: 0.761 Test Loss: 1.751 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5443968772888184
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.932 Vali Acc: 0.733 Test Loss: 1.932 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5174834728240967
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.893 Vali Acc: 0.756 Test Loss: 1.893 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.546750783920288
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.850 Vali Acc: 0.750 Test Loss: 1.850 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.478952169418335
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.880 Vali Acc: 0.767 Test Loss: 1.880 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7133886814117432
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.944 Vali Acc: 0.744 Test Loss: 1.944 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6453988552093506
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 2.025 Vali Acc: 0.750 Test Loss: 2.025 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4125101566314697
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 2.012 Vali Acc: 0.750 Test Loss: 2.012 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2738368511199951
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 2.009 Vali Acc: 0.756 Test Loss: 2.009 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 472079
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8068721294403076
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.481 Vali Acc: 0.250 Test Loss: 2.481 Test Acc: 0.250
Validation loss decreased (inf --> -0.249975).  Saving model ...
Epoch: 2 cost time: 1.1425707340240479
Epoch: 2, Steps: 12 | Train Loss: 2.234 Vali Loss: 1.929 Vali Acc: 0.439 Test Loss: 1.929 Test Acc: 0.439
Validation loss decreased (-0.249975 --> -0.438870).  Saving model ...
Epoch: 3 cost time: 0.9596898555755615
Epoch: 3, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.560 Vali Acc: 0.583 Test Loss: 1.560 Test Acc: 0.583
Validation loss decreased (-0.438870 --> -0.583318).  Saving model ...
Epoch: 4 cost time: 1.0522000789642334
Epoch: 4, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.369 Vali Acc: 0.617 Test Loss: 1.369 Test Acc: 0.617
Validation loss decreased (-0.583318 --> -0.616653).  Saving model ...
Epoch: 5 cost time: 1.1073410511016846
Epoch: 5, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.301 Vali Acc: 0.594 Test Loss: 1.301 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1112334728240967
Epoch: 6, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.175 Vali Acc: 0.639 Test Loss: 1.175 Test Acc: 0.639
Validation loss decreased (-0.616653 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 1.200899600982666
Epoch: 7, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.150 Vali Acc: 0.661 Test Loss: 1.150 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 1.1690864562988281
Epoch: 8, Steps: 12 | Train Loss: 0.577 Vali Loss: 1.089 Vali Acc: 0.678 Test Loss: 1.089 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 1.0703835487365723
Epoch: 9, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 1.1461327075958252
Epoch: 10, Steps: 12 | Train Loss: 0.466 Vali Loss: 1.032 Vali Acc: 0.717 Test Loss: 1.032 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716656).  Saving model ...
Epoch: 11 cost time: 0.8937745094299316
Epoch: 11, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.938 Vali Acc: 0.761 Test Loss: 0.938 Test Acc: 0.761
Validation loss decreased (-0.716656 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 1.0229237079620361
Epoch: 12, Steps: 12 | Train Loss: 0.279 Vali Loss: 1.078 Vali Acc: 0.706 Test Loss: 1.078 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.154311180114746
Epoch: 13, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.078 Vali Acc: 0.717 Test Loss: 1.078 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.030102252960205
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 1.075 Vali Acc: 0.767 Test Loss: 1.075 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766656).  Saving model ...
Epoch: 15 cost time: 1.0397858619689941
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.049 Vali Acc: 0.733 Test Loss: 1.049 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0825562477111816
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.135 Vali Acc: 0.744 Test Loss: 1.135 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2054624557495117
Epoch: 17, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.103 Vali Acc: 0.750 Test Loss: 1.103 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.12841796875
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.197 Vali Acc: 0.728 Test Loss: 1.197 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.048732042312622
Epoch: 19, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.246 Vali Acc: 0.739 Test Loss: 1.246 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2749621868133545
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.161 Vali Acc: 0.767 Test Loss: 1.161 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.11627197265625
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.247 Vali Acc: 0.750 Test Loss: 1.247 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1550979614257812
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.263 Vali Acc: 0.761 Test Loss: 1.263 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.14634108543396
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.395 Vali Acc: 0.744 Test Loss: 1.395 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0094900131225586
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.289 Vali Acc: 0.750 Test Loss: 1.289 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 387727
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5034053325653076
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.524 Vali Acc: 0.172 Test Loss: 2.524 Test Acc: 0.172
Validation loss decreased (inf --> -0.172197).  Saving model ...
Epoch: 2 cost time: 0.9656929969787598
Epoch: 2, Steps: 12 | Train Loss: 2.269 Vali Loss: 1.976 Vali Acc: 0.483 Test Loss: 1.976 Test Acc: 0.483
Validation loss decreased (-0.172197 --> -0.483314).  Saving model ...
Epoch: 3 cost time: 1.1799750328063965
Epoch: 3, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.625 Vali Acc: 0.517 Test Loss: 1.625 Test Acc: 0.517
Validation loss decreased (-0.483314 --> -0.516650).  Saving model ...
Epoch: 4 cost time: 1.067762851715088
Epoch: 4, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.392 Vali Acc: 0.572 Test Loss: 1.392 Test Acc: 0.572
Validation loss decreased (-0.516650 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 1.0984082221984863
Epoch: 5, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.260 Vali Acc: 0.589 Test Loss: 1.260 Test Acc: 0.589
Validation loss decreased (-0.572208 --> -0.588876).  Saving model ...
Epoch: 6 cost time: 1.136854648590088
Epoch: 6, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.200 Vali Acc: 0.639 Test Loss: 1.200 Test Acc: 0.639
Validation loss decreased (-0.588876 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 1.1392474174499512
Epoch: 7, Steps: 12 | Train Loss: 0.734 Vali Loss: 1.167 Vali Acc: 0.656 Test Loss: 1.167 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 8 cost time: 1.0144476890563965
Epoch: 8, Steps: 12 | Train Loss: 0.652 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0103199481964111
Epoch: 9, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.028 Vali Acc: 0.694 Test Loss: 1.028 Test Acc: 0.694
Validation loss decreased (-0.655544 --> -0.694434).  Saving model ...
Epoch: 10 cost time: 1.1199052333831787
Epoch: 10, Steps: 12 | Train Loss: 0.600 Vali Loss: 1.029 Vali Acc: 0.722 Test Loss: 1.029 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 11 cost time: 1.0720970630645752
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 1.013 Vali Acc: 0.722 Test Loss: 1.013 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 1.0693206787109375
Epoch: 12, Steps: 12 | Train Loss: 0.302 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.165923833847046
Epoch: 13, Steps: 12 | Train Loss: 0.263 Vali Loss: 1.055 Vali Acc: 0.706 Test Loss: 1.055 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2173995971679688
Epoch: 14, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.989 Vali Acc: 0.756 Test Loss: 0.989 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 1.0932188034057617
Epoch: 15, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.077 Vali Acc: 0.739 Test Loss: 1.077 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2324838638305664
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.065 Vali Acc: 0.750 Test Loss: 1.065 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0993354320526123
Epoch: 17, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.130 Vali Acc: 0.733 Test Loss: 1.130 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0229780673980713
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.145 Vali Acc: 0.750 Test Loss: 1.145 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.119518518447876
Epoch: 19, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.206 Vali Acc: 0.728 Test Loss: 1.206 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2374353408813477
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.169 Vali Acc: 0.756 Test Loss: 1.169 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0109694004058838
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.188 Vali Acc: 0.767 Test Loss: 1.188 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766655).  Saving model ...
Epoch: 22 cost time: 0.9596738815307617
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.244 Vali Acc: 0.728 Test Loss: 1.244 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0082805156707764
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.234 Vali Acc: 0.750 Test Loss: 1.234 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1025362014770508
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.310 Vali Acc: 0.750 Test Loss: 1.310 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0961110591888428
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.280 Vali Acc: 0.778 Test Loss: 1.280 Test Acc: 0.778
Validation loss decreased (-0.766655 --> -0.777765).  Saving model ...
Epoch: 26 cost time: 1.3689279556274414
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.272 Vali Acc: 0.761 Test Loss: 1.272 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1301212310791016
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.266 Vali Acc: 0.778 Test Loss: 1.266 Test Acc: 0.778
Validation loss decreased (-0.777765 --> -0.777765).  Saving model ...
Epoch: 28 cost time: 1.1682729721069336
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.352 Vali Acc: 0.756 Test Loss: 1.352 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1543500423431396
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.355 Vali Acc: 0.756 Test Loss: 1.355 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.154151201248169
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.425 Vali Acc: 0.761 Test Loss: 1.425 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1355078220367432
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.377 Vali Acc: 0.778 Test Loss: 1.377 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1618540287017822
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.363 Vali Acc: 0.761 Test Loss: 1.363 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0092155933380127
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.331 Vali Acc: 0.783 Test Loss: 1.331 Test Acc: 0.783
Validation loss decreased (-0.777765 --> -0.783320).  Saving model ...
Epoch: 34 cost time: 1.1604349613189697
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.472 Vali Acc: 0.750 Test Loss: 1.472 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0865204334259033
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.478 Vali Acc: 0.772 Test Loss: 1.478 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0920679569244385
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.491 Vali Acc: 0.772 Test Loss: 1.491 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1035528182983398
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.506 Vali Acc: 0.767 Test Loss: 1.506 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1345365047454834
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.504 Vali Acc: 0.767 Test Loss: 1.504 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1821620464324951
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.471 Vali Acc: 0.767 Test Loss: 1.471 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1848771572113037
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.526 Vali Acc: 0.767 Test Loss: 1.526 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2201917171478271
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.531 Vali Acc: 0.778 Test Loss: 1.531 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.191105604171753
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.544 Vali Acc: 0.783 Test Loss: 1.544 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1953580379486084
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.551 Vali Acc: 0.761 Test Loss: 1.551 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 384015
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8623180389404297
Epoch: 1, Steps: 12 | Train Loss: 2.914 Vali Loss: 2.550 Vali Acc: 0.178 Test Loss: 2.550 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 1.1111762523651123
Epoch: 2, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.106 Vali Acc: 0.372 Test Loss: 2.106 Test Acc: 0.372
Validation loss decreased (-0.177752 --> -0.372201).  Saving model ...
Epoch: 3 cost time: 1.1349356174468994
Epoch: 3, Steps: 12 | Train Loss: 1.993 Vali Loss: 1.731 Vali Acc: 0.539 Test Loss: 1.731 Test Acc: 0.539
Validation loss decreased (-0.372201 --> -0.538872).  Saving model ...
Epoch: 4 cost time: 1.118027925491333
Epoch: 4, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.507 Vali Acc: 0.594 Test Loss: 1.507 Test Acc: 0.594
Validation loss decreased (-0.538872 --> -0.594429).  Saving model ...
Epoch: 5 cost time: 1.0970399379730225
Epoch: 5, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.382 Vali Acc: 0.600 Test Loss: 1.382 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 1.0473027229309082
Epoch: 6, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.282 Vali Acc: 0.644 Test Loss: 1.282 Test Acc: 0.644
Validation loss decreased (-0.599986 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 1.101517915725708
Epoch: 7, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.176 Vali Acc: 0.656 Test Loss: 1.176 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 8 cost time: 1.1543657779693604
Epoch: 8, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.119 Vali Acc: 0.672 Test Loss: 1.119 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 1.2219548225402832
Epoch: 9, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.104 Vali Acc: 0.661 Test Loss: 1.104 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0718698501586914
Epoch: 10, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.994 Vali Acc: 0.706 Test Loss: 0.994 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 1.1732430458068848
Epoch: 11, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.955 Vali Acc: 0.728 Test Loss: 0.955 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727768).  Saving model ...
Epoch: 12 cost time: 1.0325894355773926
Epoch: 12, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.1183197498321533
Epoch: 13, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.910 Vali Acc: 0.756 Test Loss: 0.910 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755546).  Saving model ...
Epoch: 14 cost time: 1.0638165473937988
Epoch: 14, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.911 Vali Acc: 0.756 Test Loss: 0.911 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0967507362365723
Epoch: 15, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.933 Vali Acc: 0.744 Test Loss: 0.933 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2078857421875
Epoch: 16, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.898 Vali Acc: 0.772 Test Loss: 0.898 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 1.1303176879882812
Epoch: 17, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.911 Vali Acc: 0.767 Test Loss: 0.911 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1815009117126465
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.967 Vali Acc: 0.756 Test Loss: 0.967 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.235306978225708
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.009 Vali Acc: 0.767 Test Loss: 1.009 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.137491226196289
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.007 Vali Acc: 0.767 Test Loss: 1.007 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0190119743347168
Epoch: 21, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.041 Vali Acc: 0.778 Test Loss: 1.041 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777767).  Saving model ...
Epoch: 22 cost time: 1.0587852001190186
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.054 Vali Acc: 0.750 Test Loss: 1.054 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0780987739562988
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.066 Vali Acc: 0.778 Test Loss: 1.066 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1949043273925781
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.093 Vali Acc: 0.767 Test Loss: 1.093 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0785958766937256
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.122 Vali Acc: 0.772 Test Loss: 1.122 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2209157943725586
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.081 Vali Acc: 0.783 Test Loss: 1.081 Test Acc: 0.783
Validation loss decreased (-0.777767 --> -0.783323).  Saving model ...
Epoch: 27 cost time: 1.075582504272461
Epoch: 27, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.064 Vali Acc: 0.778 Test Loss: 1.064 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2019331455230713
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.209 Vali Acc: 0.750 Test Loss: 1.209 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.063979148864746
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.196 Vali Acc: 0.778 Test Loss: 1.196 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.047022819519043
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.258 Vali Acc: 0.772 Test Loss: 1.258 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.126659870147705
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.168 Vali Acc: 0.806 Test Loss: 1.168 Test Acc: 0.806
Validation loss decreased (-0.783323 --> -0.805544).  Saving model ...
Epoch: 32 cost time: 1.044830560684204
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.187 Vali Acc: 0.794 Test Loss: 1.187 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1064460277557373
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.323 Vali Acc: 0.767 Test Loss: 1.323 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1154422760009766
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.240 Vali Acc: 0.783 Test Loss: 1.240 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.359344482421875
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.193 Vali Acc: 0.800 Test Loss: 1.193 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2505290508270264
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.235 Vali Acc: 0.800 Test Loss: 1.235 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3170945644378662
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.307 Vali Acc: 0.767 Test Loss: 1.307 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1346452236175537
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.201 Vali Acc: 0.817 Test Loss: 1.201 Test Acc: 0.817
Validation loss decreased (-0.805544 --> -0.816655).  Saving model ...
Epoch: 39 cost time: 1.2679109573364258
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.286 Vali Acc: 0.767 Test Loss: 1.286 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0979461669921875
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.263 Vali Acc: 0.783 Test Loss: 1.263 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2315318584442139
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.237 Vali Acc: 0.794 Test Loss: 1.237 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.251401662826538
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.260 Vali Acc: 0.783 Test Loss: 1.260 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.211972951889038
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.238 Vali Acc: 0.783 Test Loss: 1.238 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0953788757324219
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.229 Vali Acc: 0.778 Test Loss: 1.229 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.098536491394043
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.245 Vali Acc: 0.806 Test Loss: 1.245 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.249809980392456
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.389 Vali Acc: 0.761 Test Loss: 1.389 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1329293251037598
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.309 Vali Acc: 0.789 Test Loss: 1.309 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.4220263957977295
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.311 Vali Acc: 0.794 Test Loss: 1.311 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 357263
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6533186435699463
Epoch: 1, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.606 Vali Acc: 0.144 Test Loss: 2.606 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 1.2243423461914062
Epoch: 2, Steps: 12 | Train Loss: 2.402 Vali Loss: 2.227 Vali Acc: 0.339 Test Loss: 2.227 Test Acc: 0.339
Validation loss decreased (-0.144418 --> -0.338867).  Saving model ...
Epoch: 3 cost time: 1.1925249099731445
Epoch: 3, Steps: 12 | Train Loss: 2.015 Vali Loss: 1.897 Vali Acc: 0.411 Test Loss: 1.897 Test Acc: 0.411
Validation loss decreased (-0.338867 --> -0.411092).  Saving model ...
Epoch: 4 cost time: 1.2850642204284668
Epoch: 4, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.630 Vali Acc: 0.539 Test Loss: 1.630 Test Acc: 0.539
Validation loss decreased (-0.411092 --> -0.538873).  Saving model ...
Epoch: 5 cost time: 1.0565943717956543
Epoch: 5, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.467 Vali Acc: 0.578 Test Loss: 1.467 Test Acc: 0.578
Validation loss decreased (-0.538873 --> -0.577763).  Saving model ...
Epoch: 6 cost time: 1.2481749057769775
Epoch: 6, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.340 Vali Acc: 0.589 Test Loss: 1.340 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 1.0332558155059814
Epoch: 7, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.314 Vali Acc: 0.622 Test Loss: 1.314 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 1.2705326080322266
Epoch: 8, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.221 Vali Acc: 0.633 Test Loss: 1.221 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 9 cost time: 1.1320080757141113
Epoch: 9, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.148 Vali Acc: 0.672 Test Loss: 1.148 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 1.2880401611328125
Epoch: 10, Steps: 12 | Train Loss: 0.655 Vali Loss: 1.112 Vali Acc: 0.661 Test Loss: 1.112 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2013318538665771
Epoch: 11, Steps: 12 | Train Loss: 0.545 Vali Loss: 1.020 Vali Acc: 0.700 Test Loss: 1.020 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.1504969596862793
Epoch: 12, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 1.2083706855773926
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.951 Vali Acc: 0.733 Test Loss: 0.951 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 1.0986528396606445
Epoch: 14, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.883 Vali Acc: 0.728 Test Loss: 0.883 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2816181182861328
Epoch: 15, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.867 Vali Acc: 0.733 Test Loss: 0.867 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733325).  Saving model ...
Epoch: 16 cost time: 1.0565664768218994
Epoch: 16, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.856 Vali Acc: 0.767 Test Loss: 0.856 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766658).  Saving model ...
Epoch: 17 cost time: 1.0214970111846924
Epoch: 17, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.897 Vali Acc: 0.756 Test Loss: 0.897 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.051529884338379
Epoch: 18, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.833 Vali Acc: 0.778 Test Loss: 0.833 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777769).  Saving model ...
Epoch: 19 cost time: 1.0696873664855957
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.889 Vali Acc: 0.767 Test Loss: 0.889 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9753801822662354
Epoch: 20, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.836 Vali Acc: 0.778 Test Loss: 0.836 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0056791305541992
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.904 Vali Acc: 0.761 Test Loss: 0.904 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0161161422729492
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.882 Vali Acc: 0.767 Test Loss: 0.882 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0479817390441895
Epoch: 23, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0633444786071777
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.951 Vali Acc: 0.772 Test Loss: 0.951 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2430782318115234
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1709160804748535
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.994 Vali Acc: 0.778 Test Loss: 0.994 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1112570762634277
Epoch: 27, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.997 Vali Acc: 0.772 Test Loss: 0.997 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0120418071746826
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.999 Vali Acc: 0.772 Test Loss: 0.999 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 342159
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7134599685668945
Epoch: 1, Steps: 12 | Train Loss: 3.047 Vali Loss: 2.750 Vali Acc: 0.028 Test Loss: 2.750 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 1.0450363159179688
Epoch: 2, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.370 Vali Acc: 0.244 Test Loss: 2.370 Test Acc: 0.244
Validation loss decreased (-0.027750 --> -0.244421).  Saving model ...
Epoch: 3 cost time: 1.2310855388641357
Epoch: 3, Steps: 12 | Train Loss: 2.218 Vali Loss: 2.003 Vali Acc: 0.444 Test Loss: 2.003 Test Acc: 0.444
Validation loss decreased (-0.244421 --> -0.444424).  Saving model ...
Epoch: 4 cost time: 1.062307596206665
Epoch: 4, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.708 Vali Acc: 0.511 Test Loss: 1.708 Test Acc: 0.511
Validation loss decreased (-0.444424 --> -0.511094).  Saving model ...
Epoch: 5 cost time: 1.0360004901885986
Epoch: 5, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.504 Vali Acc: 0.594 Test Loss: 1.504 Test Acc: 0.594
Validation loss decreased (-0.511094 --> -0.594429).  Saving model ...
Epoch: 6 cost time: 1.1847262382507324
Epoch: 6, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.356 Vali Acc: 0.606 Test Loss: 1.356 Test Acc: 0.606
Validation loss decreased (-0.594429 --> -0.605542).  Saving model ...
Epoch: 7 cost time: 1.1652777194976807
Epoch: 7, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.232 Vali Acc: 0.617 Test Loss: 1.232 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 8 cost time: 1.1457953453063965
Epoch: 8, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.168 Vali Acc: 0.639 Test Loss: 1.168 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 1.1342747211456299
Epoch: 9, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.107 Vali Acc: 0.650 Test Loss: 1.107 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.1654400825500488
Epoch: 10, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.065 Vali Acc: 0.656 Test Loss: 1.065 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 11 cost time: 1.1191871166229248
Epoch: 11, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
Validation loss decreased (-0.655545 --> -0.711101).  Saving model ...
Epoch: 12 cost time: 1.0656895637512207
Epoch: 12, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.906 Vali Acc: 0.700 Test Loss: 0.906 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1155164241790771
Epoch: 13, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711102).  Saving model ...
Epoch: 14 cost time: 1.186131238937378
Epoch: 14, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.882 Vali Acc: 0.700 Test Loss: 0.882 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0552690029144287
Epoch: 15, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.805 Vali Acc: 0.756 Test Loss: 0.805 Test Acc: 0.756
Validation loss decreased (-0.711102 --> -0.755548).  Saving model ...
Epoch: 16 cost time: 1.1339936256408691
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1912798881530762
Epoch: 17, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.865 Vali Acc: 0.728 Test Loss: 0.865 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0986497402191162
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.806 Vali Acc: 0.733 Test Loss: 0.806 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3593473434448242
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1425106525421143
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.834 Vali Acc: 0.722 Test Loss: 0.834 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.409604787826538
Epoch: 21, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.856 Vali Acc: 0.778 Test Loss: 0.856 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777769).  Saving model ...
Epoch: 22 cost time: 1.257699966430664
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.821 Vali Acc: 0.733 Test Loss: 0.821 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2974967956542969
Epoch: 23, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.351167917251587
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.888 Vali Acc: 0.761 Test Loss: 0.888 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1055805683135986
Epoch: 25, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0128040313720703
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.890 Vali Acc: 0.756 Test Loss: 0.890 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1601009368896484
Epoch: 27, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.901 Vali Acc: 0.767 Test Loss: 0.901 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.319643259048462
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.892 Vali Acc: 0.778 Test Loss: 0.892 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.125978708267212
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.931 Vali Acc: 0.767 Test Loss: 0.931 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.357656478881836
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.972 Vali Acc: 0.772 Test Loss: 0.972 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2515835762023926
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.946 Vali Acc: 0.767 Test Loss: 0.946 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 334735
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1087026596069336
Epoch: 1, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.681 Vali Acc: 0.100 Test Loss: 2.681 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.122528076171875
Epoch: 2, Steps: 12 | Train Loss: 2.546 Vali Loss: 2.358 Vali Acc: 0.228 Test Loss: 2.358 Test Acc: 0.228
Validation loss decreased (-0.099973 --> -0.227754).  Saving model ...
Epoch: 3 cost time: 1.128448247909546
Epoch: 3, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.012 Vali Acc: 0.383 Test Loss: 2.012 Test Acc: 0.383
Validation loss decreased (-0.227754 --> -0.383313).  Saving model ...
Epoch: 4 cost time: 1.145521640777588
Epoch: 4, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.719 Vali Acc: 0.533 Test Loss: 1.719 Test Acc: 0.533
Validation loss decreased (-0.383313 --> -0.533316).  Saving model ...
Epoch: 5 cost time: 0.9884936809539795
Epoch: 5, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.533 Vali Acc: 0.556 Test Loss: 1.533 Test Acc: 0.556
Validation loss decreased (-0.533316 --> -0.555540).  Saving model ...
Epoch: 6 cost time: 1.1157183647155762
Epoch: 6, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.381 Vali Acc: 0.606 Test Loss: 1.381 Test Acc: 0.606
Validation loss decreased (-0.555540 --> -0.605542).  Saving model ...
Epoch: 7 cost time: 1.0512943267822266
Epoch: 7, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.266 Vali Acc: 0.589 Test Loss: 1.266 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5018799304962158
Epoch: 8, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.123 Vali Acc: 0.639 Test Loss: 1.123 Test Acc: 0.639
Validation loss decreased (-0.605542 --> -0.638878).  Saving model ...
Epoch: 9 cost time: 1.3791284561157227
Epoch: 9, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 1.2669529914855957
Epoch: 10, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.942 Vali Acc: 0.667 Test Loss: 0.942 Test Acc: 0.667
Validation loss decreased (-0.649990 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 1.3966858386993408
Epoch: 11, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.889 Vali Acc: 0.678 Test Loss: 0.889 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 12 cost time: 1.3214843273162842
Epoch: 12, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.853 Vali Acc: 0.717 Test Loss: 0.853 Test Acc: 0.717
Validation loss decreased (-0.677769 --> -0.716658).  Saving model ...
Epoch: 13 cost time: 1.4364030361175537
Epoch: 13, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.814 Vali Acc: 0.739 Test Loss: 0.814 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 14 cost time: 1.4478332996368408
Epoch: 14, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.814 Vali Acc: 0.717 Test Loss: 0.814 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3368453979492188
Epoch: 15, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.768 Vali Acc: 0.733 Test Loss: 0.768 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1951260566711426
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 17 cost time: 1.204613447189331
Epoch: 17, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.734 Vali Acc: 0.756 Test Loss: 0.734 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 18 cost time: 1.2586884498596191
Epoch: 18, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.759 Vali Acc: 0.772 Test Loss: 0.759 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 1.429086685180664
Epoch: 19, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.754 Vali Acc: 0.767 Test Loss: 0.754 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1613645553588867
Epoch: 20, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.769 Vali Acc: 0.767 Test Loss: 0.769 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1888971328735352
Epoch: 21, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.739 Vali Acc: 0.767 Test Loss: 0.739 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2294957637786865
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.818 Vali Acc: 0.756 Test Loss: 0.818 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2890973091125488
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.791 Vali Acc: 0.783 Test Loss: 0.791 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783325).  Saving model ...
Epoch: 24 cost time: 1.2078211307525635
Epoch: 24, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.798 Vali Acc: 0.778 Test Loss: 0.798 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2933886051177979
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.785 Vali Acc: 0.772 Test Loss: 0.785 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2856669425964355
Epoch: 26, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.838 Vali Acc: 0.778 Test Loss: 0.838 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3538227081298828
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.256028413772583
Epoch: 28, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.824 Vali Acc: 0.778 Test Loss: 0.824 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2758533954620361
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.870 Vali Acc: 0.789 Test Loss: 0.870 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788880).  Saving model ...
Epoch: 30 cost time: 1.1870253086090088
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.846 Vali Acc: 0.783 Test Loss: 0.846 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.192493200302124
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.866 Vali Acc: 0.778 Test Loss: 0.866 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2530975341796875
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.895 Vali Acc: 0.794 Test Loss: 0.895 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794435).  Saving model ...
Epoch: 33 cost time: 1.1976780891418457
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.864 Vali Acc: 0.794 Test Loss: 0.864 Test Acc: 0.794
Validation loss decreased (-0.794435 --> -0.794436).  Saving model ...
Epoch: 34 cost time: 1.2291288375854492
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.880 Vali Acc: 0.806 Test Loss: 0.880 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805547).  Saving model ...
Epoch: 35 cost time: 1.103698968887329
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.884 Vali Acc: 0.789 Test Loss: 0.884 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4189338684082031
Epoch: 36, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.900 Vali Acc: 0.806 Test Loss: 0.900 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4385526180267334
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.958 Vali Acc: 0.800 Test Loss: 0.958 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.442467212677002
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.934 Vali Acc: 0.794 Test Loss: 0.934 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2506351470947266
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.967 Vali Acc: 0.800 Test Loss: 0.967 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4351940155029297
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.005 Vali Acc: 0.778 Test Loss: 1.005 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3507099151611328
Epoch: 41, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.962 Vali Acc: 0.778 Test Loss: 0.962 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.521233081817627
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.991 Vali Acc: 0.806 Test Loss: 0.991 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1276326179504395
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.002 Vali Acc: 0.789 Test Loss: 1.002 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.1729834079742432
Epoch: 44, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.005 Vali Acc: 0.817 Test Loss: 1.005 Test Acc: 0.817
Validation loss decreased (-0.805547 --> -0.816657).  Saving model ...
Epoch: 45 cost time: 1.1640779972076416
Epoch: 45, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.073 Vali Acc: 0.806 Test Loss: 1.073 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3913276195526123
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.088 Vali Acc: 0.789 Test Loss: 1.088 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3790578842163086
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.048 Vali Acc: 0.794 Test Loss: 1.048 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1467299461364746
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.011 Vali Acc: 0.806 Test Loss: 1.011 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3496685028076172
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.061 Vali Acc: 0.800 Test Loss: 1.061 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.4049627780914307
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.075 Vali Acc: 0.806 Test Loss: 1.075 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.3622868061065674
Epoch: 51, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.039 Vali Acc: 0.817 Test Loss: 1.039 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2608606815338135
Epoch: 52, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.145 Vali Acc: 0.800 Test Loss: 1.145 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3391125202178955
Epoch: 53, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.079 Vali Acc: 0.794 Test Loss: 1.079 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.3473749160766602
Epoch: 54, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.043 Vali Acc: 0.783 Test Loss: 1.043 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 327439
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.454373836517334
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.289 Vali Acc: 0.294 Test Loss: 2.289 Test Acc: 0.294
Validation loss decreased (inf --> -0.294422).  Saving model ...
Epoch: 2 cost time: 2.05720853805542
Epoch: 2, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.642 Vali Acc: 0.533 Test Loss: 1.642 Test Acc: 0.533
Validation loss decreased (-0.294422 --> -0.533317).  Saving model ...
Epoch: 3 cost time: 1.5808539390563965
Epoch: 3, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.403 Vali Acc: 0.561 Test Loss: 1.403 Test Acc: 0.561
Validation loss decreased (-0.533317 --> -0.561097).  Saving model ...
Epoch: 4 cost time: 1.2266733646392822
Epoch: 4, Steps: 12 | Train Loss: 1.090 Vali Loss: 1.294 Vali Acc: 0.661 Test Loss: 1.294 Test Acc: 0.661
Validation loss decreased (-0.561097 --> -0.661098).  Saving model ...
Epoch: 5 cost time: 1.2651243209838867
Epoch: 5, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.169 Vali Acc: 0.639 Test Loss: 1.169 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2942736148834229
Epoch: 6, Steps: 12 | Train Loss: 0.648 Vali Loss: 1.161 Vali Acc: 0.661 Test Loss: 1.161 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661099).  Saving model ...
Epoch: 7 cost time: 2.2215728759765625
Epoch: 7, Steps: 12 | Train Loss: 0.507 Vali Loss: 1.066 Vali Acc: 0.700 Test Loss: 1.066 Test Acc: 0.700
Validation loss decreased (-0.661099 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 2.1602938175201416
Epoch: 8, Steps: 12 | Train Loss: 0.441 Vali Loss: 1.066 Vali Acc: 0.728 Test Loss: 1.066 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727767).  Saving model ...
Epoch: 9 cost time: 2.1447293758392334
Epoch: 9, Steps: 12 | Train Loss: 0.352 Vali Loss: 1.142 Vali Acc: 0.728 Test Loss: 1.142 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2004032135009766
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 1.068 Vali Acc: 0.733 Test Loss: 1.068 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 2.1826565265655518
Epoch: 11, Steps: 12 | Train Loss: 0.288 Vali Loss: 1.207 Vali Acc: 0.739 Test Loss: 1.207 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738877).  Saving model ...
Epoch: 12 cost time: 2.1971523761749268
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.271 Vali Acc: 0.733 Test Loss: 1.271 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.18045711517334
Epoch: 13, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.395 Vali Acc: 0.711 Test Loss: 1.395 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1000208854675293
Epoch: 14, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.357 Vali Acc: 0.728 Test Loss: 1.357 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1531174182891846
Epoch: 15, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.469 Vali Acc: 0.728 Test Loss: 1.469 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.271730661392212
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.588 Vali Acc: 0.717 Test Loss: 1.588 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4426116943359375
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.443 Vali Acc: 0.756 Test Loss: 1.443 Test Acc: 0.756
Validation loss decreased (-0.738877 --> -0.755541).  Saving model ...
Epoch: 18 cost time: 1.3631401062011719
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.695 Vali Acc: 0.739 Test Loss: 1.695 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2989380359649658
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.735 Vali Acc: 0.739 Test Loss: 1.735 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6472399234771729
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.964 Vali Acc: 0.706 Test Loss: 1.964 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0224051475524902
Epoch: 21, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.734 Vali Acc: 0.694 Test Loss: 1.734 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0800702571868896
Epoch: 22, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.879 Vali Acc: 0.733 Test Loss: 1.879 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.857332706451416
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 2.006 Vali Acc: 0.733 Test Loss: 2.006 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1379263401031494
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.951 Vali Acc: 0.750 Test Loss: 1.951 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1215052604675293
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 2.063 Vali Acc: 0.717 Test Loss: 2.063 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.056278944015503
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 2.062 Vali Acc: 0.756 Test Loss: 2.062 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1956121921539307
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.957 Vali Acc: 0.756 Test Loss: 1.957 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 422735
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.981612205505371
Epoch: 1, Steps: 12 | Train Loss: 2.921 Vali Loss: 2.639 Vali Acc: 0.078 Test Loss: 2.639 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 1.096235752105713
Epoch: 2, Steps: 12 | Train Loss: 2.363 Vali Loss: 2.051 Vali Acc: 0.411 Test Loss: 2.051 Test Acc: 0.411
Validation loss decreased (-0.077751 --> -0.411091).  Saving model ...
Epoch: 3 cost time: 1.098419189453125
Epoch: 3, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.640 Vali Acc: 0.533 Test Loss: 1.640 Test Acc: 0.533
Validation loss decreased (-0.411091 --> -0.533317).  Saving model ...
Epoch: 4 cost time: 1.1427793502807617
Epoch: 4, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.433 Vali Acc: 0.567 Test Loss: 1.433 Test Acc: 0.567
Validation loss decreased (-0.533317 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 1.2149715423583984
Epoch: 5, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.291 Vali Acc: 0.628 Test Loss: 1.291 Test Acc: 0.628
Validation loss decreased (-0.566652 --> -0.627765).  Saving model ...
Epoch: 6 cost time: 1.2599122524261475
Epoch: 6, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.233 Vali Acc: 0.628 Test Loss: 1.233 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 1.2286462783813477
Epoch: 7, Steps: 12 | Train Loss: 0.681 Vali Loss: 1.188 Vali Acc: 0.633 Test Loss: 1.188 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 1.2160499095916748
Epoch: 8, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.130 Vali Acc: 0.672 Test Loss: 1.130 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 1.2718946933746338
Epoch: 9, Steps: 12 | Train Loss: 0.482 Vali Loss: 1.138 Vali Acc: 0.661 Test Loss: 1.138 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.12827730178833
Epoch: 10, Steps: 12 | Train Loss: 0.400 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
Validation loss decreased (-0.672211 --> -0.722212).  Saving model ...
Epoch: 11 cost time: 1.1885905265808105
Epoch: 11, Steps: 12 | Train Loss: 0.322 Vali Loss: 1.007 Vali Acc: 0.744 Test Loss: 1.007 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 1.1598889827728271
Epoch: 12, Steps: 12 | Train Loss: 0.282 Vali Loss: 1.019 Vali Acc: 0.750 Test Loss: 1.019 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 1.1370799541473389
Epoch: 13, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.020 Vali Acc: 0.739 Test Loss: 1.020 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1904237270355225
Epoch: 14, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.072 Vali Acc: 0.744 Test Loss: 1.072 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1843199729919434
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.191 Vali Acc: 0.733 Test Loss: 1.191 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2488665580749512
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.128 Vali Acc: 0.750 Test Loss: 1.128 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1028904914855957
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.209 Vali Acc: 0.744 Test Loss: 1.209 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3562119007110596
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.136 Vali Acc: 0.733 Test Loss: 1.136 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2540953159332275
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.266 Vali Acc: 0.739 Test Loss: 1.266 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1645495891571045
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.260 Vali Acc: 0.767 Test Loss: 1.260 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766654).  Saving model ...
Epoch: 21 cost time: 1.2119688987731934
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.292 Vali Acc: 0.739 Test Loss: 1.292 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1296184062957764
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.296 Vali Acc: 0.756 Test Loss: 1.296 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2406315803527832
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.322 Vali Acc: 0.772 Test Loss: 1.322 Test Acc: 0.772
Validation loss decreased (-0.766654 --> -0.772209).  Saving model ...
Epoch: 24 cost time: 1.1586346626281738
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.371 Vali Acc: 0.739 Test Loss: 1.371 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2361361980438232
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.457 Vali Acc: 0.761 Test Loss: 1.457 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1324496269226074
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.391 Vali Acc: 0.778 Test Loss: 1.391 Test Acc: 0.778
Validation loss decreased (-0.772209 --> -0.777764).  Saving model ...
Epoch: 27 cost time: 1.3395216464996338
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.421 Vali Acc: 0.739 Test Loss: 1.421 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3487591743469238
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.438 Vali Acc: 0.772 Test Loss: 1.438 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4380152225494385
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.465 Vali Acc: 0.767 Test Loss: 1.465 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4378907680511475
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.485 Vali Acc: 0.750 Test Loss: 1.485 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2857098579406738
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.466 Vali Acc: 0.778 Test Loss: 1.466 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.272695541381836
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.512 Vali Acc: 0.750 Test Loss: 1.512 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4284639358520508
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.565 Vali Acc: 0.761 Test Loss: 1.565 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4912056922912598
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.551 Vali Acc: 0.739 Test Loss: 1.551 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.230715274810791
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.581 Vali Acc: 0.767 Test Loss: 1.581 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3506572246551514
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.521 Vali Acc: 0.767 Test Loss: 1.521 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 338383
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9618682861328125
Epoch: 1, Steps: 12 | Train Loss: 2.864 Vali Loss: 2.546 Vali Acc: 0.150 Test Loss: 2.546 Test Acc: 0.150
Validation loss decreased (inf --> -0.149975).  Saving model ...
Epoch: 2 cost time: 1.3185243606567383
Epoch: 2, Steps: 12 | Train Loss: 2.208 Vali Loss: 1.960 Vali Acc: 0.456 Test Loss: 1.960 Test Acc: 0.456
Validation loss decreased (-0.149975 --> -0.455536).  Saving model ...
Epoch: 3 cost time: 1.2761139869689941
Epoch: 3, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.615 Vali Acc: 0.511 Test Loss: 1.615 Test Acc: 0.511
Validation loss decreased (-0.455536 --> -0.511095).  Saving model ...
Epoch: 4 cost time: 1.3552203178405762
Epoch: 4, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.442 Vali Acc: 0.556 Test Loss: 1.442 Test Acc: 0.556
Validation loss decreased (-0.511095 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 1.3691096305847168
Epoch: 5, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.326 Vali Acc: 0.594 Test Loss: 1.326 Test Acc: 0.594
Validation loss decreased (-0.555541 --> -0.594431).  Saving model ...
Epoch: 6 cost time: 1.3306779861450195
Epoch: 6, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.257 Vali Acc: 0.644 Test Loss: 1.257 Test Acc: 0.644
Validation loss decreased (-0.594431 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 1.364048719406128
Epoch: 7, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.147 Vali Acc: 0.639 Test Loss: 1.147 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.236656665802002
Epoch: 8, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.140 Vali Acc: 0.650 Test Loss: 1.140 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 1.3355600833892822
Epoch: 9, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 1.2956469058990479
Epoch: 10, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.001 Vali Acc: 0.728 Test Loss: 1.001 Test Acc: 0.728
Validation loss decreased (-0.699990 --> -0.727768).  Saving model ...
Epoch: 11 cost time: 1.3627448081970215
Epoch: 11, Steps: 12 | Train Loss: 0.370 Vali Loss: 1.011 Vali Acc: 0.728 Test Loss: 1.011 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.301086664199829
Epoch: 12, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.992 Vali Acc: 0.756 Test Loss: 0.992 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755546).  Saving model ...
Epoch: 13 cost time: 1.2675392627716064
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.994 Vali Acc: 0.744 Test Loss: 0.994 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2442882061004639
Epoch: 14, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.985 Vali Acc: 0.739 Test Loss: 0.985 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1894245147705078
Epoch: 15, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.055 Vali Acc: 0.756 Test Loss: 1.055 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.994152307510376
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.025 Vali Acc: 0.756 Test Loss: 1.025 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1277813911437988
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.072 Vali Acc: 0.783 Test Loss: 1.072 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783323).  Saving model ...
Epoch: 18 cost time: 1.2931618690490723
Epoch: 18, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.071 Vali Acc: 0.772 Test Loss: 1.071 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1364161968231201
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.061 Vali Acc: 0.750 Test Loss: 1.061 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.339221477508545
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.181 Vali Acc: 0.739 Test Loss: 1.181 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3428549766540527
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.209 Vali Acc: 0.794 Test Loss: 1.209 Test Acc: 0.794
Validation loss decreased (-0.783323 --> -0.794432).  Saving model ...
Epoch: 22 cost time: 1.3599786758422852
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.165 Vali Acc: 0.772 Test Loss: 1.165 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4232676029205322
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.175 Vali Acc: 0.761 Test Loss: 1.175 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3274052143096924
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.249 Vali Acc: 0.767 Test Loss: 1.249 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3377482891082764
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.245 Vali Acc: 0.778 Test Loss: 1.245 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2804582118988037
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.225 Vali Acc: 0.772 Test Loss: 1.225 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2359836101531982
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.272 Vali Acc: 0.789 Test Loss: 1.272 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3617043495178223
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.339 Vali Acc: 0.778 Test Loss: 1.339 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.452951192855835
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.307 Vali Acc: 0.794 Test Loss: 1.307 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1813392639160156
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.331 Vali Acc: 0.794 Test Loss: 1.331 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2466349601745605
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.333 Vali Acc: 0.789 Test Loss: 1.333 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 334671
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.089627504348755
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.541 Vali Acc: 0.144 Test Loss: 2.541 Test Acc: 0.144
Validation loss decreased (inf --> -0.144419).  Saving model ...
Epoch: 2 cost time: 1.2362556457519531
Epoch: 2, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.109 Vali Acc: 0.433 Test Loss: 2.109 Test Acc: 0.433
Validation loss decreased (-0.144419 --> -0.433312).  Saving model ...
Epoch: 3 cost time: 1.3749949932098389
Epoch: 3, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.749 Vali Acc: 0.500 Test Loss: 1.749 Test Acc: 0.500
Validation loss decreased (-0.433312 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 1.2763874530792236
Epoch: 4, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.522 Vali Acc: 0.556 Test Loss: 1.522 Test Acc: 0.556
Validation loss decreased (-0.499983 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 1.4024248123168945
Epoch: 5, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.367 Vali Acc: 0.600 Test Loss: 1.367 Test Acc: 0.600
Validation loss decreased (-0.555540 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 1.2898931503295898
Epoch: 6, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.282 Vali Acc: 0.617 Test Loss: 1.282 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 7 cost time: 1.3890414237976074
Epoch: 7, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.204 Vali Acc: 0.639 Test Loss: 1.204 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 8 cost time: 1.4038927555084229
Epoch: 8, Steps: 12 | Train Loss: 0.753 Vali Loss: 1.156 Vali Acc: 0.656 Test Loss: 1.156 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 1.3158104419708252
Epoch: 9, Steps: 12 | Train Loss: 0.627 Vali Loss: 1.117 Vali Acc: 0.667 Test Loss: 1.117 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 1.2942020893096924
Epoch: 10, Steps: 12 | Train Loss: 0.652 Vali Loss: 1.096 Vali Acc: 0.678 Test Loss: 1.096 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 11 cost time: 1.4879703521728516
Epoch: 11, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.962 Vali Acc: 0.733 Test Loss: 0.962 Test Acc: 0.733
Validation loss decreased (-0.677767 --> -0.733324).  Saving model ...
Epoch: 12 cost time: 1.2760074138641357
Epoch: 12, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.924 Vali Acc: 0.728 Test Loss: 0.924 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4026706218719482
Epoch: 13, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.887 Vali Acc: 0.783 Test Loss: 0.887 Test Acc: 0.783
Validation loss decreased (-0.733324 --> -0.783324).  Saving model ...
Epoch: 14 cost time: 1.3087031841278076
Epoch: 14, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3405232429504395
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.902 Vali Acc: 0.778 Test Loss: 0.902 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3064429759979248
Epoch: 16, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.854 Vali Acc: 0.778 Test Loss: 0.854 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3681321144104004
Epoch: 17, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.931 Vali Acc: 0.744 Test Loss: 0.931 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2084019184112549
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.934 Vali Acc: 0.767 Test Loss: 0.934 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.374279260635376
Epoch: 19, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.027 Vali Acc: 0.778 Test Loss: 1.027 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1644949913024902
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.084 Vali Acc: 0.750 Test Loss: 1.084 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3637661933898926
Epoch: 21, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.921 Vali Acc: 0.800 Test Loss: 0.921 Test Acc: 0.800
Validation loss decreased (-0.783324 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 1.2626173496246338
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.023 Vali Acc: 0.756 Test Loss: 1.023 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4138855934143066
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.081 Vali Acc: 0.778 Test Loss: 1.081 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.388777494430542
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.031 Vali Acc: 0.794 Test Loss: 1.031 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3697161674499512
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.075 Vali Acc: 0.789 Test Loss: 1.075 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2647404670715332
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.108 Vali Acc: 0.767 Test Loss: 1.108 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.313697338104248
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.103 Vali Acc: 0.794 Test Loss: 1.103 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3806159496307373
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.121 Vali Acc: 0.794 Test Loss: 1.121 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.314096450805664
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.154 Vali Acc: 0.789 Test Loss: 1.154 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3902552127838135
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.129 Vali Acc: 0.794 Test Loss: 1.129 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3582763671875
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.245 Vali Acc: 0.783 Test Loss: 1.245 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 307919
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9743311405181885
Epoch: 1, Steps: 12 | Train Loss: 2.844 Vali Loss: 2.656 Vali Acc: 0.150 Test Loss: 2.656 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 1.3171958923339844
Epoch: 2, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.275 Vali Acc: 0.367 Test Loss: 2.275 Test Acc: 0.367
Validation loss decreased (-0.149973 --> -0.366644).  Saving model ...
Epoch: 3 cost time: 1.2568469047546387
Epoch: 3, Steps: 12 | Train Loss: 2.094 Vali Loss: 1.917 Vali Acc: 0.489 Test Loss: 1.917 Test Acc: 0.489
Validation loss decreased (-0.366644 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 1.2120628356933594
Epoch: 4, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.634 Vali Acc: 0.561 Test Loss: 1.634 Test Acc: 0.561
Validation loss decreased (-0.488870 --> -0.561095).  Saving model ...
Epoch: 5 cost time: 1.2771356105804443
Epoch: 5, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.469 Vali Acc: 0.556 Test Loss: 1.469 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.308532476425171
Epoch: 6, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.357 Vali Acc: 0.594 Test Loss: 1.357 Test Acc: 0.594
Validation loss decreased (-0.561095 --> -0.594431).  Saving model ...
Epoch: 7 cost time: 1.3574597835540771
Epoch: 7, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.260 Vali Acc: 0.611 Test Loss: 1.260 Test Acc: 0.611
Validation loss decreased (-0.594431 --> -0.611099).  Saving model ...
Epoch: 8 cost time: 1.2864611148834229
Epoch: 8, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.172 Vali Acc: 0.644 Test Loss: 1.172 Test Acc: 0.644
Validation loss decreased (-0.611099 --> -0.644433).  Saving model ...
Epoch: 9 cost time: 1.401557207107544
Epoch: 9, Steps: 12 | Train Loss: 0.734 Vali Loss: 1.127 Vali Acc: 0.650 Test Loss: 1.127 Test Acc: 0.650
Validation loss decreased (-0.644433 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.2548308372497559
Epoch: 10, Steps: 12 | Train Loss: 0.695 Vali Loss: 1.059 Vali Acc: 0.644 Test Loss: 1.059 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1885476112365723
Epoch: 11, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.1455323696136475
Epoch: 12, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.905 Vali Acc: 0.700 Test Loss: 0.905 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 1.116420030593872
Epoch: 13, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.902 Vali Acc: 0.700 Test Loss: 0.902 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 1.207247257232666
Epoch: 14, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.850 Vali Acc: 0.711 Test Loss: 0.850 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711103).  Saving model ...
Epoch: 15 cost time: 1.198697566986084
Epoch: 15, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.841 Vali Acc: 0.733 Test Loss: 0.841 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733325).  Saving model ...
Epoch: 16 cost time: 1.1642510890960693
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 1.2466163635253906
Epoch: 17, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.840 Vali Acc: 0.761 Test Loss: 0.840 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 18 cost time: 1.2800133228302002
Epoch: 18, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.851 Vali Acc: 0.744 Test Loss: 0.851 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.328378677368164
Epoch: 19, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3119888305664062
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4737131595611572
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.882 Vali Acc: 0.744 Test Loss: 0.882 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3813457489013672
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.886 Vali Acc: 0.772 Test Loss: 0.886 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772213).  Saving model ...
Epoch: 23 cost time: 1.3850374221801758
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 24 cost time: 1.2936246395111084
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.911 Vali Acc: 0.761 Test Loss: 0.911 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3075988292694092
Epoch: 25, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.914 Vali Acc: 0.761 Test Loss: 0.914 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3080151081085205
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.938 Vali Acc: 0.761 Test Loss: 0.938 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2333340644836426
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.910 Vali Acc: 0.778 Test Loss: 0.910 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1214191913604736
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.911 Vali Acc: 0.794 Test Loss: 0.911 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794435).  Saving model ...
Epoch: 29 cost time: 1.369002103805542
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.937 Vali Acc: 0.789 Test Loss: 0.937 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1465966701507568
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.973 Vali Acc: 0.767 Test Loss: 0.973 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1315324306488037
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.968 Vali Acc: 0.783 Test Loss: 0.968 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3072013854980469
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.990 Vali Acc: 0.778 Test Loss: 0.990 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.294412612915039
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.069 Vali Acc: 0.783 Test Loss: 1.069 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2183964252471924
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.039 Vali Acc: 0.789 Test Loss: 1.039 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.141369342803955
Epoch: 35, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.042 Vali Acc: 0.789 Test Loss: 1.042 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4305341243743896
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.013 Vali Acc: 0.772 Test Loss: 1.013 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3026118278503418
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.038 Vali Acc: 0.772 Test Loss: 1.038 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2095787525177002
Epoch: 38, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.067 Vali Acc: 0.778 Test Loss: 1.067 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 292815
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.91703462600708
Epoch: 1, Steps: 12 | Train Loss: 2.918 Vali Loss: 2.700 Vali Acc: 0.072 Test Loss: 2.700 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.224867820739746
Epoch: 2, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.317 Vali Acc: 0.356 Test Loss: 2.317 Test Acc: 0.356
Validation loss decreased (-0.072195 --> -0.355532).  Saving model ...
Epoch: 3 cost time: 1.248582124710083
Epoch: 3, Steps: 12 | Train Loss: 2.214 Vali Loss: 1.972 Vali Acc: 0.494 Test Loss: 1.972 Test Acc: 0.494
Validation loss decreased (-0.355532 --> -0.494425).  Saving model ...
Epoch: 4 cost time: 1.3951330184936523
Epoch: 4, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.702 Vali Acc: 0.539 Test Loss: 1.702 Test Acc: 0.539
Validation loss decreased (-0.494425 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 1.119797706604004
Epoch: 5, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.525 Vali Acc: 0.561 Test Loss: 1.525 Test Acc: 0.561
Validation loss decreased (-0.538872 --> -0.561096).  Saving model ...
Epoch: 6 cost time: 1.3094041347503662
Epoch: 6, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.387 Vali Acc: 0.589 Test Loss: 1.387 Test Acc: 0.589
Validation loss decreased (-0.561096 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 1.3246984481811523
Epoch: 7, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.296 Vali Acc: 0.589 Test Loss: 1.296 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588876).  Saving model ...
Epoch: 8 cost time: 1.3214030265808105
Epoch: 8, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.172 Vali Acc: 0.633 Test Loss: 1.172 Test Acc: 0.633
Validation loss decreased (-0.588876 --> -0.633322).  Saving model ...
Epoch: 9 cost time: 1.1780412197113037
Epoch: 9, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.102 Vali Acc: 0.672 Test Loss: 1.102 Test Acc: 0.672
Validation loss decreased (-0.633322 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 1.217127799987793
Epoch: 10, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.996 Vali Acc: 0.678 Test Loss: 0.996 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677768).  Saving model ...
Epoch: 11 cost time: 1.4727790355682373
Epoch: 11, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.957 Vali Acc: 0.689 Test Loss: 0.957 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 12 cost time: 1.4282112121582031
Epoch: 12, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.893 Vali Acc: 0.706 Test Loss: 0.893 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 1.262547492980957
Epoch: 13, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 1.275787115097046
Epoch: 14, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.794 Vali Acc: 0.761 Test Loss: 0.794 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 1.2848176956176758
Epoch: 15, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.784 Vali Acc: 0.767 Test Loss: 0.784 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 1.3333802223205566
Epoch: 16, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.797 Vali Acc: 0.772 Test Loss: 0.797 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 17 cost time: 1.4580624103546143
Epoch: 17, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.780 Vali Acc: 0.772 Test Loss: 0.780 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 18 cost time: 1.426978349685669
Epoch: 18, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.799 Vali Acc: 0.767 Test Loss: 0.799 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3444294929504395
Epoch: 19, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.814 Vali Acc: 0.772 Test Loss: 0.814 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5148463249206543
Epoch: 20, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.783 Vali Acc: 0.794 Test Loss: 0.783 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 1.404998540878296
Epoch: 21, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.807 Vali Acc: 0.761 Test Loss: 0.807 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3396220207214355
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.823 Vali Acc: 0.778 Test Loss: 0.823 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.42435622215271
Epoch: 23, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.809 Vali Acc: 0.778 Test Loss: 0.809 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4047958850860596
Epoch: 24, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.835 Vali Acc: 0.778 Test Loss: 0.835 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4760491847991943
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.873 Vali Acc: 0.761 Test Loss: 0.873 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3449411392211914
Epoch: 26, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.838 Vali Acc: 0.794 Test Loss: 0.838 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.280503273010254
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.824 Vali Acc: 0.789 Test Loss: 0.824 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3867251873016357
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.933 Vali Acc: 0.778 Test Loss: 0.933 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.400538444519043
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1567184925079346
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.899 Vali Acc: 0.783 Test Loss: 0.899 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 285391
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8381264209747314
Epoch: 1, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.443 Vali Acc: 0.244 Test Loss: 2.443 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 1.2208352088928223
Epoch: 2, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.161 Vali Acc: 0.444 Test Loss: 2.161 Test Acc: 0.444
Validation loss decreased (-0.244420 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 1.2277631759643555
Epoch: 3, Steps: 12 | Train Loss: 2.019 Vali Loss: 1.877 Vali Acc: 0.556 Test Loss: 1.877 Test Acc: 0.556
Validation loss decreased (-0.444423 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 1.330963134765625
Epoch: 4, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.650 Vali Acc: 0.572 Test Loss: 1.650 Test Acc: 0.572
Validation loss decreased (-0.555537 --> -0.572206).  Saving model ...
Epoch: 5 cost time: 1.3461039066314697
Epoch: 5, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.484 Vali Acc: 0.578 Test Loss: 1.484 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577763).  Saving model ...
Epoch: 6 cost time: 1.3049123287200928
Epoch: 6, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.372 Vali Acc: 0.594 Test Loss: 1.372 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594431).  Saving model ...
Epoch: 7 cost time: 1.1902904510498047
Epoch: 7, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.266 Vali Acc: 0.600 Test Loss: 1.266 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 1.1434850692749023
Epoch: 8, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.151 Vali Acc: 0.622 Test Loss: 1.151 Test Acc: 0.622
Validation loss decreased (-0.599987 --> -0.622211).  Saving model ...
Epoch: 9 cost time: 1.2746374607086182
Epoch: 9, Steps: 12 | Train Loss: 0.785 Vali Loss: 1.040 Vali Acc: 0.644 Test Loss: 1.040 Test Acc: 0.644
Validation loss decreased (-0.622211 --> -0.644434).  Saving model ...
Epoch: 10 cost time: 1.2402167320251465
Epoch: 10, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.979 Vali Acc: 0.650 Test Loss: 0.979 Test Acc: 0.650
Validation loss decreased (-0.644434 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 1.151710033416748
Epoch: 11, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.948 Vali Acc: 0.661 Test Loss: 0.948 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661102).  Saving model ...
Epoch: 12 cost time: 0.9892418384552002
Epoch: 12, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.880 Vali Acc: 0.678 Test Loss: 0.880 Test Acc: 0.678
Validation loss decreased (-0.661102 --> -0.677769).  Saving model ...
Epoch: 13 cost time: 1.0507073402404785
Epoch: 13, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
Validation loss decreased (-0.677769 --> -0.711103).  Saving model ...
Epoch: 14 cost time: 1.0797638893127441
Epoch: 14, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.809 Vali Acc: 0.728 Test Loss: 0.809 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 15 cost time: 1.2585384845733643
Epoch: 15, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.824 Vali Acc: 0.722 Test Loss: 0.824 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2275350093841553
Epoch: 16, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.799 Vali Acc: 0.728 Test Loss: 0.799 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 17 cost time: 1.171295404434204
Epoch: 17, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.786 Vali Acc: 0.733 Test Loss: 0.786 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733325).  Saving model ...
Epoch: 18 cost time: 1.3173956871032715
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.763 Vali Acc: 0.761 Test Loss: 0.763 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761103).  Saving model ...
Epoch: 19 cost time: 1.3286023139953613
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.789 Vali Acc: 0.772 Test Loss: 0.789 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 20 cost time: 1.3333990573883057
Epoch: 20, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.779 Vali Acc: 0.761 Test Loss: 0.779 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.249337911605835
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.788 Vali Acc: 0.772 Test Loss: 0.788 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 22 cost time: 1.2034204006195068
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2513933181762695
Epoch: 23, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4710829257965088
Epoch: 24, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3339195251464844
Epoch: 25, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.802 Vali Acc: 0.767 Test Loss: 0.802 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2520508766174316
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 1.2463648319244385
Epoch: 27, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.817 Vali Acc: 0.778 Test Loss: 0.817 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2248680591583252
Epoch: 28, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.841 Vali Acc: 0.761 Test Loss: 0.841 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.11899995803833
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.822 Vali Acc: 0.756 Test Loss: 0.822 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0436861515045166
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.899 Vali Acc: 0.767 Test Loss: 0.899 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1117291450500488
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.889 Vali Acc: 0.783 Test Loss: 0.889 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.33323073387146
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.894 Vali Acc: 0.789 Test Loss: 0.894 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.24418306350708
Epoch: 33, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.884 Vali Acc: 0.767 Test Loss: 0.884 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3684682846069336
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.859 Vali Acc: 0.794 Test Loss: 0.859 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3237791061401367
Epoch: 35, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.918 Vali Acc: 0.772 Test Loss: 0.918 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1878509521484375
Epoch: 36, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.925 Vali Acc: 0.772 Test Loss: 0.925 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm128_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 278095
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.874523639678955
Epoch: 1, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.482 Vali Acc: 0.183 Test Loss: 2.482 Test Acc: 0.183
Validation loss decreased (inf --> -0.183309).  Saving model ...
Epoch: 2 cost time: 1.126561164855957
Epoch: 2, Steps: 12 | Train Loss: 2.235 Vali Loss: 1.961 Vali Acc: 0.411 Test Loss: 1.961 Test Acc: 0.411
Validation loss decreased (-0.183309 --> -0.411092).  Saving model ...
Epoch: 3 cost time: 1.1828954219818115
Epoch: 3, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.633 Vali Acc: 0.494 Test Loss: 1.633 Test Acc: 0.494
Validation loss decreased (-0.411092 --> -0.494428).  Saving model ...
Epoch: 4 cost time: 1.2578144073486328
Epoch: 4, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.442 Vali Acc: 0.572 Test Loss: 1.442 Test Acc: 0.572
Validation loss decreased (-0.494428 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 1.3083522319793701
Epoch: 5, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.373 Vali Acc: 0.600 Test Loss: 1.373 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 1.02162766456604
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.234 Vali Acc: 0.633 Test Loss: 1.234 Test Acc: 0.633
Validation loss decreased (-0.599986 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 1.223085641860962
Epoch: 7, Steps: 12 | Train Loss: 0.703 Vali Loss: 1.136 Vali Acc: 0.661 Test Loss: 1.136 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 1.0388729572296143
Epoch: 8, Steps: 12 | Train Loss: 0.620 Vali Loss: 1.109 Vali Acc: 0.683 Test Loss: 1.109 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683322).  Saving model ...
Epoch: 9 cost time: 1.0761988162994385
Epoch: 9, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.046 Vali Acc: 0.706 Test Loss: 1.046 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705545).  Saving model ...
Epoch: 10 cost time: 1.2802658081054688
Epoch: 10, Steps: 12 | Train Loss: 0.424 Vali Loss: 1.017 Vali Acc: 0.711 Test Loss: 1.017 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 11 cost time: 1.099153757095337
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.983 Vali Acc: 0.744 Test Loss: 0.983 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744435).  Saving model ...
Epoch: 12 cost time: 1.1955411434173584
Epoch: 12, Steps: 12 | Train Loss: 0.279 Vali Loss: 1.061 Vali Acc: 0.700 Test Loss: 1.061 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.095191240310669
Epoch: 13, Steps: 12 | Train Loss: 0.246 Vali Loss: 1.037 Vali Acc: 0.733 Test Loss: 1.037 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2303779125213623
Epoch: 14, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.096 Vali Acc: 0.722 Test Loss: 1.096 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.213927984237671
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.110 Vali Acc: 0.744 Test Loss: 1.110 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2823395729064941
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.154 Vali Acc: 0.761 Test Loss: 1.154 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761100).  Saving model ...
Epoch: 17 cost time: 1.1719813346862793
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.210 Vali Acc: 0.717 Test Loss: 1.210 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.163503885269165
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.202 Vali Acc: 0.761 Test Loss: 1.202 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2462663650512695
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.266 Vali Acc: 0.733 Test Loss: 1.266 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1753876209259033
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.262 Vali Acc: 0.756 Test Loss: 1.262 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.136396884918213
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.398 Vali Acc: 0.739 Test Loss: 1.398 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1405866146087646
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.381 Vali Acc: 0.728 Test Loss: 1.381 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.134911060333252
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.368 Vali Acc: 0.722 Test Loss: 1.368 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.108520269393921
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.385 Vali Acc: 0.733 Test Loss: 1.385 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0505611896514893
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.450 Vali Acc: 0.733 Test Loss: 1.450 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0792677402496338
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.429 Vali Acc: 0.728 Test Loss: 1.429 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 236623
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.886993885040283
Epoch: 1, Steps: 12 | Train Loss: 2.860 Vali Loss: 2.644 Vali Acc: 0.128 Test Loss: 2.644 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 1.1671745777130127
Epoch: 2, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.302 Vali Acc: 0.311 Test Loss: 2.302 Test Acc: 0.311
Validation loss decreased (-0.127751 --> -0.311088).  Saving model ...
Epoch: 3 cost time: 1.1266276836395264
Epoch: 3, Steps: 12 | Train Loss: 2.162 Vali Loss: 1.980 Vali Acc: 0.444 Test Loss: 1.980 Test Acc: 0.444
Validation loss decreased (-0.311088 --> -0.444425).  Saving model ...
Epoch: 4 cost time: 1.1817383766174316
Epoch: 4, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.726 Vali Acc: 0.478 Test Loss: 1.726 Test Acc: 0.478
Validation loss decreased (-0.444425 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 1.1468260288238525
Epoch: 5, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.551 Vali Acc: 0.528 Test Loss: 1.551 Test Acc: 0.528
Validation loss decreased (-0.477761 --> -0.527762).  Saving model ...
Epoch: 6 cost time: 1.1308443546295166
Epoch: 6, Steps: 12 | Train Loss: 1.302 Vali Loss: 1.436 Vali Acc: 0.561 Test Loss: 1.436 Test Acc: 0.561
Validation loss decreased (-0.527762 --> -0.561097).  Saving model ...
Epoch: 7 cost time: 1.2330718040466309
Epoch: 7, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.295 Vali Acc: 0.600 Test Loss: 1.295 Test Acc: 0.600
Validation loss decreased (-0.561097 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 1.2398967742919922
Epoch: 8, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.244 Vali Acc: 0.611 Test Loss: 1.244 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611099).  Saving model ...
Epoch: 9 cost time: 1.049687147140503
Epoch: 9, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.189 Vali Acc: 0.639 Test Loss: 1.189 Test Acc: 0.639
Validation loss decreased (-0.611099 --> -0.638877).  Saving model ...
Epoch: 10 cost time: 1.0036518573760986
Epoch: 10, Steps: 12 | Train Loss: 0.617 Vali Loss: 1.134 Vali Acc: 0.661 Test Loss: 1.134 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 11 cost time: 1.0785644054412842
Epoch: 11, Steps: 12 | Train Loss: 0.555 Vali Loss: 1.042 Vali Acc: 0.678 Test Loss: 1.042 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 12 cost time: 0.9753966331481934
Epoch: 12, Steps: 12 | Train Loss: 0.475 Vali Loss: 1.031 Vali Acc: 0.678 Test Loss: 1.031 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 1.1950757503509521
Epoch: 13, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.1073846817016602
Epoch: 14, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.970 Vali Acc: 0.706 Test Loss: 0.970 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 15 cost time: 1.0178697109222412
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.979 Vali Acc: 0.733 Test Loss: 0.979 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 1.1704661846160889
Epoch: 16, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.971 Vali Acc: 0.739 Test Loss: 0.971 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 17 cost time: 1.134690284729004
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.979 Vali Acc: 0.744 Test Loss: 0.979 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 18 cost time: 1.1498067378997803
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.954 Vali Acc: 0.767 Test Loss: 0.954 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766657).  Saving model ...
Epoch: 19 cost time: 1.1507437229156494
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.980 Vali Acc: 0.778 Test Loss: 0.980 Test Acc: 0.778
Validation loss decreased (-0.766657 --> -0.777768).  Saving model ...
Epoch: 20 cost time: 1.2115228176116943
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.097 Vali Acc: 0.728 Test Loss: 1.097 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.111647129058838
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.041 Vali Acc: 0.750 Test Loss: 1.041 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0832092761993408
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.093 Vali Acc: 0.728 Test Loss: 1.093 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0130503177642822
Epoch: 23, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.046 Vali Acc: 0.783 Test Loss: 1.046 Test Acc: 0.783
Validation loss decreased (-0.777768 --> -0.783323).  Saving model ...
Epoch: 24 cost time: 1.0876843929290771
Epoch: 24, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.078 Vali Acc: 0.739 Test Loss: 1.078 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.186290979385376
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.049 Vali Acc: 0.772 Test Loss: 1.049 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3115217685699463
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.125 Vali Acc: 0.744 Test Loss: 1.125 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3241500854492188
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.172 Vali Acc: 0.722 Test Loss: 1.172 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.185598611831665
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.132 Vali Acc: 0.783 Test Loss: 1.132 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0321364402770996
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.196 Vali Acc: 0.756 Test Loss: 1.196 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.063549280166626
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.137 Vali Acc: 0.750 Test Loss: 1.137 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2425475120544434
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.203 Vali Acc: 0.750 Test Loss: 1.203 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0768051147460938
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.162 Vali Acc: 0.761 Test Loss: 1.162 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1391701698303223
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.187 Vali Acc: 0.750 Test Loss: 1.187 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 194447
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9317915439605713
Epoch: 1, Steps: 12 | Train Loss: 2.814 Vali Loss: 2.670 Vali Acc: 0.044 Test Loss: 2.670 Test Acc: 0.044
Validation loss decreased (inf --> -0.044418).  Saving model ...
Epoch: 2 cost time: 1.384225606918335
Epoch: 2, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.281 Vali Acc: 0.317 Test Loss: 2.281 Test Acc: 0.317
Validation loss decreased (-0.044418 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 1.2291145324707031
Epoch: 3, Steps: 12 | Train Loss: 2.072 Vali Loss: 1.909 Vali Acc: 0.467 Test Loss: 1.909 Test Acc: 0.467
Validation loss decreased (-0.316644 --> -0.466648).  Saving model ...
Epoch: 4 cost time: 1.3423192501068115
Epoch: 4, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.656 Vali Acc: 0.539 Test Loss: 1.656 Test Acc: 0.539
Validation loss decreased (-0.466648 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 1.1823554039001465
Epoch: 5, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.485 Vali Acc: 0.561 Test Loss: 1.485 Test Acc: 0.561
Validation loss decreased (-0.538872 --> -0.561096).  Saving model ...
Epoch: 6 cost time: 1.394761562347412
Epoch: 6, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.388 Vali Acc: 0.606 Test Loss: 1.388 Test Acc: 0.606
Validation loss decreased (-0.561096 --> -0.605542).  Saving model ...
Epoch: 7 cost time: 1.3105261325836182
Epoch: 7, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.279 Vali Acc: 0.628 Test Loss: 1.279 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627765).  Saving model ...
Epoch: 8 cost time: 1.218644618988037
Epoch: 8, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.227 Vali Acc: 0.639 Test Loss: 1.227 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 1.2787384986877441
Epoch: 9, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.163 Vali Acc: 0.650 Test Loss: 1.163 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 1.1429715156555176
Epoch: 10, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.115 Vali Acc: 0.661 Test Loss: 1.115 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 11 cost time: 1.4624228477478027
Epoch: 11, Steps: 12 | Train Loss: 0.601 Vali Loss: 1.071 Vali Acc: 0.672 Test Loss: 1.071 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 12 cost time: 1.3581719398498535
Epoch: 12, Steps: 12 | Train Loss: 0.495 Vali Loss: 1.006 Vali Acc: 0.722 Test Loss: 1.006 Test Acc: 0.722
Validation loss decreased (-0.672212 --> -0.722212).  Saving model ...
Epoch: 13 cost time: 1.4838833808898926
Epoch: 13, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 1.3917148113250732
Epoch: 14, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.952 Vali Acc: 0.739 Test Loss: 0.952 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 1.3545684814453125
Epoch: 15, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.939 Vali Acc: 0.756 Test Loss: 0.939 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 1.51414155960083
Epoch: 16, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.948 Vali Acc: 0.772 Test Loss: 0.948 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 1.567518711090088
Epoch: 17, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.942 Vali Acc: 0.767 Test Loss: 0.942 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3664112091064453
Epoch: 18, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.989 Vali Acc: 0.767 Test Loss: 0.989 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3675973415374756
Epoch: 19, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4438807964324951
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.981 Vali Acc: 0.761 Test Loss: 0.981 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4710423946380615
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.036 Vali Acc: 0.761 Test Loss: 1.036 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4088454246520996
Epoch: 22, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.037 Vali Acc: 0.756 Test Loss: 1.037 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3989219665527344
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.039 Vali Acc: 0.767 Test Loss: 1.039 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3976902961730957
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.060 Vali Acc: 0.778 Test Loss: 1.060 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777767).  Saving model ...
Epoch: 25 cost time: 1.428126573562622
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.087 Vali Acc: 0.761 Test Loss: 1.087 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3098657131195068
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.094 Vali Acc: 0.756 Test Loss: 1.094 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2508389949798584
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.097 Vali Acc: 0.767 Test Loss: 1.097 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4053199291229248
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.120 Vali Acc: 0.761 Test Loss: 1.120 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3922553062438965
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.151 Vali Acc: 0.778 Test Loss: 1.151 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4355134963989258
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.149 Vali Acc: 0.772 Test Loss: 1.149 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5186209678649902
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.174 Vali Acc: 0.778 Test Loss: 1.174 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5444436073303223
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.166 Vali Acc: 0.778 Test Loss: 1.166 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3106143474578857
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.205 Vali Acc: 0.761 Test Loss: 1.205 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4778237342834473
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.220 Vali Acc: 0.772 Test Loss: 1.220 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 192591
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.289991855621338
Epoch: 1, Steps: 12 | Train Loss: 2.888 Vali Loss: 2.777 Vali Acc: 0.067 Test Loss: 2.777 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.4385340213775635
Epoch: 2, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.453 Vali Acc: 0.256 Test Loss: 2.453 Test Acc: 0.256
Validation loss decreased (-0.066639 --> -0.255531).  Saving model ...
Epoch: 3 cost time: 1.6954858303070068
Epoch: 3, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.103 Vali Acc: 0.467 Test Loss: 2.103 Test Acc: 0.467
Validation loss decreased (-0.255531 --> -0.466646).  Saving model ...
Epoch: 4 cost time: 1.53348708152771
Epoch: 4, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.860 Vali Acc: 0.522 Test Loss: 1.860 Test Acc: 0.522
Validation loss decreased (-0.466646 --> -0.522204).  Saving model ...
Epoch: 5 cost time: 1.5174250602722168
Epoch: 5, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.651 Vali Acc: 0.550 Test Loss: 1.651 Test Acc: 0.550
Validation loss decreased (-0.522204 --> -0.549983).  Saving model ...
Epoch: 6 cost time: 1.4344983100891113
Epoch: 6, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.533 Vali Acc: 0.600 Test Loss: 1.533 Test Acc: 0.600
Validation loss decreased (-0.549983 --> -0.599985).  Saving model ...
Epoch: 7 cost time: 1.5902059078216553
Epoch: 7, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.447 Vali Acc: 0.578 Test Loss: 1.447 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4042558670043945
Epoch: 8, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.346 Vali Acc: 0.617 Test Loss: 1.346 Test Acc: 0.617
Validation loss decreased (-0.599985 --> -0.616653).  Saving model ...
Epoch: 9 cost time: 1.3354284763336182
Epoch: 9, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.291 Vali Acc: 0.611 Test Loss: 1.291 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2741169929504395
Epoch: 10, Steps: 12 | Train Loss: 0.833 Vali Loss: 1.225 Vali Acc: 0.650 Test Loss: 1.225 Test Acc: 0.650
Validation loss decreased (-0.616653 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 1.1664893627166748
Epoch: 11, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.164 Vali Acc: 0.689 Test Loss: 1.164 Test Acc: 0.689
Validation loss decreased (-0.649988 --> -0.688877).  Saving model ...
Epoch: 12 cost time: 1.187988042831421
Epoch: 12, Steps: 12 | Train Loss: 0.645 Vali Loss: 1.119 Vali Acc: 0.667 Test Loss: 1.119 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2159082889556885
Epoch: 13, Steps: 12 | Train Loss: 0.571 Vali Loss: 1.092 Vali Acc: 0.678 Test Loss: 1.092 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.429288387298584
Epoch: 14, Steps: 12 | Train Loss: 0.515 Vali Loss: 1.025 Vali Acc: 0.694 Test Loss: 1.025 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694434).  Saving model ...
Epoch: 15 cost time: 1.6971940994262695
Epoch: 15, Steps: 12 | Train Loss: 0.486 Vali Loss: 1.002 Vali Acc: 0.700 Test Loss: 1.002 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 1.6356618404388428
Epoch: 16, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.971 Vali Acc: 0.750 Test Loss: 0.971 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 1.759690761566162
Epoch: 17, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.925 Vali Acc: 0.756 Test Loss: 0.925 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 18 cost time: 1.6987321376800537
Epoch: 18, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.942 Vali Acc: 0.739 Test Loss: 0.942 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.724851369857788
Epoch: 19, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.913 Vali Acc: 0.778 Test Loss: 0.913 Test Acc: 0.778
Validation loss decreased (-0.755546 --> -0.777769).  Saving model ...
Epoch: 20 cost time: 1.6362016201019287
Epoch: 20, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7782926559448242
Epoch: 21, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.944 Vali Acc: 0.772 Test Loss: 0.944 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8203229904174805
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.952 Vali Acc: 0.761 Test Loss: 0.952 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7305927276611328
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.952 Vali Acc: 0.783 Test Loss: 0.952 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783324).  Saving model ...
Epoch: 24 cost time: 1.5976049900054932
Epoch: 24, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.982 Vali Acc: 0.756 Test Loss: 0.982 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5609872341156006
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.001 Vali Acc: 0.767 Test Loss: 1.001 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5909185409545898
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.006 Vali Acc: 0.739 Test Loss: 1.006 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6075851917266846
Epoch: 27, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.978 Vali Acc: 0.767 Test Loss: 0.978 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4675288200378418
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.015 Vali Acc: 0.772 Test Loss: 1.015 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5901072025299072
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.012 Vali Acc: 0.767 Test Loss: 1.012 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4658241271972656
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.032 Vali Acc: 0.756 Test Loss: 1.032 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5580596923828125
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.060 Vali Acc: 0.772 Test Loss: 1.060 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4055635929107666
Epoch: 32, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.049 Vali Acc: 0.772 Test Loss: 1.049 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.637192964553833
Epoch: 33, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.049 Vali Acc: 0.767 Test Loss: 1.049 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 179215
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.017667293548584
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.717 Vali Acc: 0.078 Test Loss: 2.717 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 1.429199457168579
Epoch: 2, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.477 Vali Acc: 0.128 Test Loss: 2.477 Test Acc: 0.128
Validation loss decreased (-0.077751 --> -0.127753).  Saving model ...
Epoch: 3 cost time: 1.4505553245544434
Epoch: 3, Steps: 12 | Train Loss: 2.392 Vali Loss: 2.207 Vali Acc: 0.361 Test Loss: 2.207 Test Acc: 0.361
Validation loss decreased (-0.127753 --> -0.361089).  Saving model ...
Epoch: 4 cost time: 1.590501070022583
Epoch: 4, Steps: 12 | Train Loss: 2.113 Vali Loss: 1.960 Vali Acc: 0.444 Test Loss: 1.960 Test Acc: 0.444
Validation loss decreased (-0.361089 --> -0.444425).  Saving model ...
Epoch: 5 cost time: 1.6630542278289795
Epoch: 5, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.763 Vali Acc: 0.478 Test Loss: 1.763 Test Acc: 0.478
Validation loss decreased (-0.444425 --> -0.477760).  Saving model ...
Epoch: 6 cost time: 1.7759037017822266
Epoch: 6, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.597 Vali Acc: 0.539 Test Loss: 1.597 Test Acc: 0.539
Validation loss decreased (-0.477760 --> -0.538873).  Saving model ...
Epoch: 7 cost time: 1.8059051036834717
Epoch: 7, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.483 Vali Acc: 0.600 Test Loss: 1.483 Test Acc: 0.600
Validation loss decreased (-0.538873 --> -0.599985).  Saving model ...
Epoch: 8 cost time: 1.4742627143859863
Epoch: 8, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.386 Vali Acc: 0.594 Test Loss: 1.386 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.462989091873169
Epoch: 9, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.308 Vali Acc: 0.606 Test Loss: 1.308 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605542).  Saving model ...
Epoch: 10 cost time: 1.6155657768249512
Epoch: 10, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.241 Vali Acc: 0.606 Test Loss: 1.241 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605543).  Saving model ...
Epoch: 11 cost time: 1.4684429168701172
Epoch: 11, Steps: 12 | Train Loss: 0.834 Vali Loss: 1.189 Vali Acc: 0.639 Test Loss: 1.189 Test Acc: 0.639
Validation loss decreased (-0.605543 --> -0.638877).  Saving model ...
Epoch: 12 cost time: 1.4880473613739014
Epoch: 12, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 1.6219508647918701
Epoch: 13, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.078 Vali Acc: 0.644 Test Loss: 1.078 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.676642656326294
Epoch: 14, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 1.6502132415771484
Epoch: 15, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.982 Vali Acc: 0.678 Test Loss: 0.982 Test Acc: 0.678
Validation loss decreased (-0.649990 --> -0.677768).  Saving model ...
Epoch: 16 cost time: 1.4825770854949951
Epoch: 16, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 1.6265530586242676
Epoch: 17, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.915 Vali Acc: 0.700 Test Loss: 0.915 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 1.3910834789276123
Epoch: 18, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.896 Vali Acc: 0.711 Test Loss: 0.896 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 19 cost time: 1.7016494274139404
Epoch: 19, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.841 Vali Acc: 0.761 Test Loss: 0.841 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761103).  Saving model ...
Epoch: 20 cost time: 1.5291743278503418
Epoch: 20, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.855 Vali Acc: 0.761 Test Loss: 0.855 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5283021926879883
Epoch: 21, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.847 Vali Acc: 0.756 Test Loss: 0.847 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5948655605316162
Epoch: 22, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.845 Vali Acc: 0.767 Test Loss: 0.845 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 23 cost time: 1.4507403373718262
Epoch: 23, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.832 Vali Acc: 0.783 Test Loss: 0.832 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 24 cost time: 1.4228613376617432
Epoch: 24, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4763119220733643
Epoch: 25, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.858 Vali Acc: 0.778 Test Loss: 0.858 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1152317523956299
Epoch: 26, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.850 Vali Acc: 0.772 Test Loss: 0.850 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6300146579742432
Epoch: 27, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.858 Vali Acc: 0.778 Test Loss: 0.858 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3081331253051758
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3989636898040771
Epoch: 29, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.865 Vali Acc: 0.772 Test Loss: 0.865 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.417086124420166
Epoch: 30, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.864 Vali Acc: 0.794 Test Loss: 0.864 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794436).  Saving model ...
Epoch: 31 cost time: 1.4257049560546875
Epoch: 31, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.871 Vali Acc: 0.794 Test Loss: 0.871 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5548758506774902
Epoch: 32, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.894 Vali Acc: 0.772 Test Loss: 0.894 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5464353561401367
Epoch: 33, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.917 Vali Acc: 0.772 Test Loss: 0.917 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4340906143188477
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.896 Vali Acc: 0.789 Test Loss: 0.896 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5605628490447998
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.912 Vali Acc: 0.794 Test Loss: 0.912 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3910841941833496
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.899 Vali Acc: 0.794 Test Loss: 0.899 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3803620338439941
Epoch: 37, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.903 Vali Acc: 0.789 Test Loss: 0.903 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4296002388000488
Epoch: 38, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.891 Vali Acc: 0.800 Test Loss: 0.891 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799991).  Saving model ...
Epoch: 39 cost time: 1.3533220291137695
Epoch: 39, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.920 Vali Acc: 0.800 Test Loss: 0.920 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.327054500579834
Epoch: 40, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.950 Vali Acc: 0.767 Test Loss: 0.950 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.448256492614746
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.945 Vali Acc: 0.789 Test Loss: 0.945 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4386255741119385
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.946 Vali Acc: 0.772 Test Loss: 0.946 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.3676540851593018
Epoch: 43, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.981 Vali Acc: 0.783 Test Loss: 0.981 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4778261184692383
Epoch: 44, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.960 Vali Acc: 0.783 Test Loss: 0.960 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4609832763671875
Epoch: 45, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.947 Vali Acc: 0.789 Test Loss: 0.947 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3809592723846436
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.980 Vali Acc: 0.783 Test Loss: 0.980 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.5757601261138916
Epoch: 47, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.973 Vali Acc: 0.794 Test Loss: 0.973 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.539527416229248
Epoch: 48, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.970 Vali Acc: 0.794 Test Loss: 0.970 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 171663
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.428297996520996
Epoch: 1, Steps: 12 | Train Loss: 2.949 Vali Loss: 2.731 Vali Acc: 0.056 Test Loss: 2.731 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 1.588458776473999
Epoch: 2, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.488 Vali Acc: 0.194 Test Loss: 2.488 Test Acc: 0.194
Validation loss decreased (-0.055528 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 1.6521177291870117
Epoch: 3, Steps: 12 | Train Loss: 2.418 Vali Loss: 2.212 Vali Acc: 0.328 Test Loss: 2.212 Test Acc: 0.328
Validation loss decreased (-0.194420 --> -0.327756).  Saving model ...
Epoch: 4 cost time: 1.438054084777832
Epoch: 4, Steps: 12 | Train Loss: 2.093 Vali Loss: 1.962 Vali Acc: 0.428 Test Loss: 1.962 Test Acc: 0.428
Validation loss decreased (-0.327756 --> -0.427758).  Saving model ...
Epoch: 5 cost time: 1.281043291091919
Epoch: 5, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.777 Vali Acc: 0.500 Test Loss: 1.777 Test Acc: 0.500
Validation loss decreased (-0.427758 --> -0.499982).  Saving model ...
Epoch: 6 cost time: 1.466146469116211
Epoch: 6, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.619 Vali Acc: 0.511 Test Loss: 1.619 Test Acc: 0.511
Validation loss decreased (-0.499982 --> -0.511095).  Saving model ...
Epoch: 7 cost time: 1.5186007022857666
Epoch: 7, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.513 Vali Acc: 0.578 Test Loss: 1.513 Test Acc: 0.578
Validation loss decreased (-0.511095 --> -0.577763).  Saving model ...
Epoch: 8 cost time: 1.459202527999878
Epoch: 8, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.401 Vali Acc: 0.606 Test Loss: 1.401 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605542).  Saving model ...
Epoch: 9 cost time: 1.5059547424316406
Epoch: 9, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.315 Vali Acc: 0.611 Test Loss: 1.315 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 10 cost time: 1.3314902782440186
Epoch: 10, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.266 Vali Acc: 0.622 Test Loss: 1.266 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 11 cost time: 1.4688646793365479
Epoch: 11, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.187 Vali Acc: 0.656 Test Loss: 1.187 Test Acc: 0.656
Validation loss decreased (-0.622210 --> -0.655544).  Saving model ...
Epoch: 12 cost time: 1.5838596820831299
Epoch: 12, Steps: 12 | Train Loss: 0.833 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.420945405960083
Epoch: 13, Steps: 12 | Train Loss: 0.753 Vali Loss: 1.068 Vali Acc: 0.661 Test Loss: 1.068 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 1.4937000274658203
Epoch: 14, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.010 Vali Acc: 0.683 Test Loss: 1.010 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683323).  Saving model ...
Epoch: 15 cost time: 1.5471265316009521
Epoch: 15, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 1.3716328144073486
Epoch: 16, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.943 Vali Acc: 0.694 Test Loss: 0.943 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3175008296966553
Epoch: 17, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.887 Vali Acc: 0.711 Test Loss: 0.887 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 18 cost time: 1.2140324115753174
Epoch: 18, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.834 Vali Acc: 0.733 Test Loss: 0.834 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 19 cost time: 1.204967975616455
Epoch: 19, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.843 Vali Acc: 0.728 Test Loss: 0.843 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2991602420806885
Epoch: 20, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.812 Vali Acc: 0.717 Test Loss: 0.812 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5963413715362549
Epoch: 21, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 1.5548956394195557
Epoch: 22, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.783 Vali Acc: 0.733 Test Loss: 0.783 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4347443580627441
Epoch: 23, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.807 Vali Acc: 0.750 Test Loss: 0.807 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4029290676116943
Epoch: 24, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.803 Vali Acc: 0.733 Test Loss: 0.803 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.416654109954834
Epoch: 25, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.773 Vali Acc: 0.739 Test Loss: 0.773 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.489466667175293
Epoch: 26, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.779 Vali Acc: 0.756 Test Loss: 0.779 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 1.440016746520996
Epoch: 27, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 1.4713950157165527
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.793 Vali Acc: 0.772 Test Loss: 0.793 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772214).  Saving model ...
Epoch: 29 cost time: 1.6003732681274414
Epoch: 29, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.523402214050293
Epoch: 30, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.852 Vali Acc: 0.722 Test Loss: 0.852 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4503278732299805
Epoch: 31, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3891923427581787
Epoch: 32, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.861 Vali Acc: 0.744 Test Loss: 0.861 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4389779567718506
Epoch: 33, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.837 Vali Acc: 0.756 Test Loss: 0.837 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3257455825805664
Epoch: 34, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.843 Vali Acc: 0.761 Test Loss: 0.843 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4213643074035645
Epoch: 35, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.836 Vali Acc: 0.739 Test Loss: 0.836 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3177967071533203
Epoch: 36, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.853 Vali Acc: 0.756 Test Loss: 0.853 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2600083351135254
Epoch: 37, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.874 Vali Acc: 0.756 Test Loss: 0.874 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3544743061065674
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.892 Vali Acc: 0.767 Test Loss: 0.892 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 167951
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1732871532440186
Epoch: 1, Steps: 12 | Train Loss: 2.847 Vali Loss: 2.665 Vali Acc: 0.106 Test Loss: 2.665 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.4037220478057861
Epoch: 2, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.456 Vali Acc: 0.194 Test Loss: 2.456 Test Acc: 0.194
Validation loss decreased (-0.105529 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 1.4680399894714355
Epoch: 3, Steps: 12 | Train Loss: 2.460 Vali Loss: 2.227 Vali Acc: 0.322 Test Loss: 2.227 Test Acc: 0.322
Validation loss decreased (-0.194420 --> -0.322200).  Saving model ...
Epoch: 4 cost time: 1.351693868637085
Epoch: 4, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.022 Vali Acc: 0.417 Test Loss: 2.022 Test Acc: 0.417
Validation loss decreased (-0.322200 --> -0.416646).  Saving model ...
Epoch: 5 cost time: 1.4707252979278564
Epoch: 5, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.835 Vali Acc: 0.483 Test Loss: 1.835 Test Acc: 0.483
Validation loss decreased (-0.416646 --> -0.483315).  Saving model ...
Epoch: 6 cost time: 1.4446873664855957
Epoch: 6, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.703 Vali Acc: 0.506 Test Loss: 1.703 Test Acc: 0.506
Validation loss decreased (-0.483315 --> -0.505539).  Saving model ...
Epoch: 7 cost time: 1.361328363418579
Epoch: 7, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.581 Vali Acc: 0.539 Test Loss: 1.581 Test Acc: 0.539
Validation loss decreased (-0.505539 --> -0.538873).  Saving model ...
Epoch: 8 cost time: 1.44215989112854
Epoch: 8, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.482 Vali Acc: 0.556 Test Loss: 1.482 Test Acc: 0.556
Validation loss decreased (-0.538873 --> -0.555541).  Saving model ...
Epoch: 9 cost time: 1.4722390174865723
Epoch: 9, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.396 Vali Acc: 0.578 Test Loss: 1.396 Test Acc: 0.578
Validation loss decreased (-0.555541 --> -0.577764).  Saving model ...
Epoch: 10 cost time: 1.2806522846221924
Epoch: 10, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.312 Vali Acc: 0.600 Test Loss: 1.312 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.3176591396331787
Epoch: 11, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.247 Vali Acc: 0.611 Test Loss: 1.247 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611099).  Saving model ...
Epoch: 12 cost time: 1.3271033763885498
Epoch: 12, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.136 Vali Acc: 0.639 Test Loss: 1.136 Test Acc: 0.639
Validation loss decreased (-0.611099 --> -0.638878).  Saving model ...
Epoch: 13 cost time: 1.3126921653747559
Epoch: 13, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.060 Vali Acc: 0.656 Test Loss: 1.060 Test Acc: 0.656
Validation loss decreased (-0.638878 --> -0.655545).  Saving model ...
Epoch: 14 cost time: 1.555116891860962
Epoch: 14, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.983 Vali Acc: 0.661 Test Loss: 0.983 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661101).  Saving model ...
Epoch: 15 cost time: 1.3067409992218018
Epoch: 15, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.940 Vali Acc: 0.650 Test Loss: 0.940 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4962761402130127
Epoch: 16, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.901 Vali Acc: 0.678 Test Loss: 0.901 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677769).  Saving model ...
Epoch: 17 cost time: 1.5024683475494385
Epoch: 17, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.865 Vali Acc: 0.711 Test Loss: 0.865 Test Acc: 0.711
Validation loss decreased (-0.677769 --> -0.711102).  Saving model ...
Epoch: 18 cost time: 1.4641988277435303
Epoch: 18, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.854 Vali Acc: 0.672 Test Loss: 0.854 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4484138488769531
Epoch: 19, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.809 Vali Acc: 0.728 Test Loss: 0.809 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727770).  Saving model ...
Epoch: 20 cost time: 1.444046974182129
Epoch: 20, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 1.4763922691345215
Epoch: 21, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 1.4387061595916748
Epoch: 22, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.782 Vali Acc: 0.744 Test Loss: 0.782 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.499544382095337
Epoch: 23, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.776 Vali Acc: 0.744 Test Loss: 0.776 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4749431610107422
Epoch: 24, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.783 Vali Acc: 0.733 Test Loss: 0.783 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.516502857208252
Epoch: 25, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.783 Vali Acc: 0.761 Test Loss: 0.783 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 26 cost time: 1.6017491817474365
Epoch: 26, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.764 Vali Acc: 0.761 Test Loss: 0.764 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 27 cost time: 1.4367539882659912
Epoch: 27, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.771 Vali Acc: 0.761 Test Loss: 0.771 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.637190818786621
Epoch: 28, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.794 Vali Acc: 0.756 Test Loss: 0.794 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5339419841766357
Epoch: 29, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.746 Vali Acc: 0.761 Test Loss: 0.746 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761104).  Saving model ...
Epoch: 30 cost time: 1.4235186576843262
Epoch: 30, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.761 Vali Acc: 0.778 Test Loss: 0.761 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777770).  Saving model ...
Epoch: 31 cost time: 1.5411927700042725
Epoch: 31, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 32 cost time: 1.487046718597412
Epoch: 32, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.766 Vali Acc: 0.772 Test Loss: 0.766 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4498343467712402
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5411818027496338
Epoch: 34, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.778 Vali Acc: 0.761 Test Loss: 0.778 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5045814514160156
Epoch: 35, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4223074913024902
Epoch: 36, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.757 Vali Acc: 0.778 Test Loss: 0.757 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5180187225341797
Epoch: 37, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.773 Vali Acc: 0.772 Test Loss: 0.773 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5467755794525146
Epoch: 38, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.834 Vali Acc: 0.739 Test Loss: 0.834 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3562321662902832
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.807 Vali Acc: 0.756 Test Loss: 0.807 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5410664081573486
Epoch: 40, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.792 Vali Acc: 0.761 Test Loss: 0.792 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3855948448181152
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799992).  Saving model ...
Epoch: 42 cost time: 1.2835922241210938
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.862 Vali Acc: 0.778 Test Loss: 0.862 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4509644508361816
Epoch: 43, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.845 Vali Acc: 0.783 Test Loss: 0.845 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4444818496704102
Epoch: 44, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.808 Vali Acc: 0.772 Test Loss: 0.808 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3849873542785645
Epoch: 45, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.895 Vali Acc: 0.750 Test Loss: 0.895 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2465193271636963
Epoch: 46, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.853 Vali Acc: 0.778 Test Loss: 0.853 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.354266881942749
Epoch: 47, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.861 Vali Acc: 0.778 Test Loss: 0.861 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1690800189971924
Epoch: 48, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.934 Vali Acc: 0.767 Test Loss: 0.934 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3519155979156494
Epoch: 49, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.840 Vali Acc: 0.778 Test Loss: 0.840 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.3229808807373047
Epoch: 50, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.924 Vali Acc: 0.767 Test Loss: 0.924 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2854740619659424
Epoch: 51, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.863 Vali Acc: 0.778 Test Loss: 0.863 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 164303
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1276583671569824
Epoch: 1, Steps: 12 | Train Loss: 2.841 Vali Loss: 2.564 Vali Acc: 0.072 Test Loss: 2.564 Test Acc: 0.072
Validation loss decreased (inf --> -0.072197).  Saving model ...
Epoch: 2 cost time: 1.2785840034484863
Epoch: 2, Steps: 12 | Train Loss: 2.352 Vali Loss: 2.041 Vali Acc: 0.422 Test Loss: 2.041 Test Acc: 0.422
Validation loss decreased (-0.072197 --> -0.422202).  Saving model ...
Epoch: 3 cost time: 1.353322982788086
Epoch: 3, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.643 Vali Acc: 0.489 Test Loss: 1.643 Test Acc: 0.489
Validation loss decreased (-0.422202 --> -0.488872).  Saving model ...
Epoch: 4 cost time: 1.4089303016662598
Epoch: 4, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.433 Vali Acc: 0.583 Test Loss: 1.433 Test Acc: 0.583
Validation loss decreased (-0.488872 --> -0.583319).  Saving model ...
Epoch: 5 cost time: 1.1990759372711182
Epoch: 5, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.306 Vali Acc: 0.600 Test Loss: 1.306 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 1.4258792400360107
Epoch: 6, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.247 Vali Acc: 0.633 Test Loss: 1.247 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 1.1481537818908691
Epoch: 7, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.215 Vali Acc: 0.628 Test Loss: 1.215 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4051282405853271
Epoch: 8, Steps: 12 | Train Loss: 0.624 Vali Loss: 1.150 Vali Acc: 0.656 Test Loss: 1.150 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 1.319542646408081
Epoch: 9, Steps: 12 | Train Loss: 0.526 Vali Loss: 1.062 Vali Acc: 0.683 Test Loss: 1.062 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 1.1934270858764648
Epoch: 10, Steps: 12 | Train Loss: 0.409 Vali Loss: 1.019 Vali Acc: 0.689 Test Loss: 1.019 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 1.343470811843872
Epoch: 11, Steps: 12 | Train Loss: 0.338 Vali Loss: 1.015 Vali Acc: 0.706 Test Loss: 1.015 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705545).  Saving model ...
Epoch: 12 cost time: 1.2126991748809814
Epoch: 12, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.029 Vali Acc: 0.728 Test Loss: 1.029 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727767).  Saving model ...
Epoch: 13 cost time: 1.4147610664367676
Epoch: 13, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.029 Vali Acc: 0.722 Test Loss: 1.029 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2622673511505127
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.069 Vali Acc: 0.722 Test Loss: 1.069 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4486002922058105
Epoch: 15, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.136 Vali Acc: 0.750 Test Loss: 1.136 Test Acc: 0.750
Validation loss decreased (-0.727767 --> -0.749989).  Saving model ...
Epoch: 16 cost time: 1.3083457946777344
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.147 Vali Acc: 0.750 Test Loss: 1.147 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.361699104309082
Epoch: 17, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.191 Vali Acc: 0.733 Test Loss: 1.191 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3611321449279785
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.240 Vali Acc: 0.761 Test Loss: 1.240 Test Acc: 0.761
Validation loss decreased (-0.749989 --> -0.761099).  Saving model ...
Epoch: 19 cost time: 1.3276903629302979
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.260 Vali Acc: 0.733 Test Loss: 1.260 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.418043851852417
Epoch: 20, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.305 Vali Acc: 0.706 Test Loss: 1.305 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3563344478607178
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.347 Vali Acc: 0.717 Test Loss: 1.347 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1982285976409912
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.390 Vali Acc: 0.711 Test Loss: 1.390 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2051897048950195
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.290 Vali Acc: 0.717 Test Loss: 1.290 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2501468658447266
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.438 Vali Acc: 0.722 Test Loss: 1.438 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3714110851287842
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.388 Vali Acc: 0.728 Test Loss: 1.388 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.435319423675537
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.469 Vali Acc: 0.717 Test Loss: 1.469 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4450304508209229
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.479 Vali Acc: 0.722 Test Loss: 1.479 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1387786865234375
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.484 Vali Acc: 0.728 Test Loss: 1.484 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 187087
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1388020515441895
Epoch: 1, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.568 Vali Acc: 0.189 Test Loss: 2.568 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 1.2085041999816895
Epoch: 2, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.244 Vali Acc: 0.344 Test Loss: 2.244 Test Acc: 0.344
Validation loss decreased (-0.188863 --> -0.344422).  Saving model ...
Epoch: 3 cost time: 1.2889022827148438
Epoch: 3, Steps: 12 | Train Loss: 2.157 Vali Loss: 1.923 Vali Acc: 0.494 Test Loss: 1.923 Test Acc: 0.494
Validation loss decreased (-0.344422 --> -0.494425).  Saving model ...
Epoch: 4 cost time: 1.1386148929595947
Epoch: 4, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.668 Vali Acc: 0.556 Test Loss: 1.668 Test Acc: 0.556
Validation loss decreased (-0.494425 --> -0.555539).  Saving model ...
Epoch: 5 cost time: 1.3344573974609375
Epoch: 5, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.502 Vali Acc: 0.594 Test Loss: 1.502 Test Acc: 0.594
Validation loss decreased (-0.555539 --> -0.594429).  Saving model ...
Epoch: 6 cost time: 1.318608045578003
Epoch: 6, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.382 Vali Acc: 0.617 Test Loss: 1.382 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616653).  Saving model ...
Epoch: 7 cost time: 1.4570026397705078
Epoch: 7, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.283 Vali Acc: 0.622 Test Loss: 1.283 Test Acc: 0.622
Validation loss decreased (-0.616653 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 1.328399896621704
Epoch: 8, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.250 Vali Acc: 0.639 Test Loss: 1.250 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638876).  Saving model ...
Epoch: 9 cost time: 1.3512499332427979
Epoch: 9, Steps: 12 | Train Loss: 0.745 Vali Loss: 1.192 Vali Acc: 0.633 Test Loss: 1.192 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.286787509918213
Epoch: 10, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.134 Vali Acc: 0.661 Test Loss: 1.134 Test Acc: 0.661
Validation loss decreased (-0.638876 --> -0.661100).  Saving model ...
Epoch: 11 cost time: 1.3519978523254395
Epoch: 11, Steps: 12 | Train Loss: 0.617 Vali Loss: 1.078 Vali Acc: 0.689 Test Loss: 1.078 Test Acc: 0.689
Validation loss decreased (-0.661100 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 1.386035442352295
Epoch: 12, Steps: 12 | Train Loss: 0.560 Vali Loss: 1.066 Vali Acc: 0.689 Test Loss: 1.066 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 13 cost time: 1.4017515182495117
Epoch: 13, Steps: 12 | Train Loss: 0.503 Vali Loss: 1.011 Vali Acc: 0.711 Test Loss: 1.011 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 1.3930814266204834
Epoch: 14, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.993 Vali Acc: 0.722 Test Loss: 0.993 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 15 cost time: 1.2684111595153809
Epoch: 15, Steps: 12 | Train Loss: 0.375 Vali Loss: 1.028 Vali Acc: 0.728 Test Loss: 1.028 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727767).  Saving model ...
Epoch: 16 cost time: 1.2865123748779297
Epoch: 16, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.979 Vali Acc: 0.728 Test Loss: 0.979 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 17 cost time: 1.3592536449432373
Epoch: 17, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.021 Vali Acc: 0.739 Test Loss: 1.021 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 18 cost time: 1.237025499343872
Epoch: 18, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.053 Vali Acc: 0.739 Test Loss: 1.053 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2133285999298096
Epoch: 19, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.000 Vali Acc: 0.728 Test Loss: 1.000 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3327407836914062
Epoch: 20, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.057 Vali Acc: 0.733 Test Loss: 1.057 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2052550315856934
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.078 Vali Acc: 0.756 Test Loss: 1.078 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755545).  Saving model ...
Epoch: 22 cost time: 1.2283549308776855
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.048 Vali Acc: 0.761 Test Loss: 1.048 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761101).  Saving model ...
Epoch: 23 cost time: 1.4018936157226562
Epoch: 23, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.141 Vali Acc: 0.717 Test Loss: 1.141 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.25718355178833
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.105 Vali Acc: 0.739 Test Loss: 1.105 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3239820003509521
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.130 Vali Acc: 0.744 Test Loss: 1.130 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.272603988647461
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.145 Vali Acc: 0.744 Test Loss: 1.145 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1331126689910889
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.145 Vali Acc: 0.756 Test Loss: 1.145 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2809240818023682
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.141 Vali Acc: 0.756 Test Loss: 1.141 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2073166370391846
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.163 Vali Acc: 0.756 Test Loss: 1.163 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3776462078094482
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.199 Vali Acc: 0.744 Test Loss: 1.199 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2866289615631104
Epoch: 31, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.217 Vali Acc: 0.767 Test Loss: 1.217 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766654).  Saving model ...
Epoch: 32 cost time: 1.4257733821868896
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.269 Vali Acc: 0.744 Test Loss: 1.269 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2952990531921387
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.208 Vali Acc: 0.767 Test Loss: 1.208 Test Acc: 0.767
Validation loss decreased (-0.766654 --> -0.766655).  Saving model ...
Epoch: 34 cost time: 1.4580433368682861
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.223 Vali Acc: 0.761 Test Loss: 1.223 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2054624557495117
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.283 Vali Acc: 0.761 Test Loss: 1.283 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2410650253295898
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.262 Vali Acc: 0.767 Test Loss: 1.262 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.261251449584961
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.307 Vali Acc: 0.761 Test Loss: 1.307 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5267119407653809
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.312 Vali Acc: 0.772 Test Loss: 1.312 Test Acc: 0.772
Validation loss decreased (-0.766655 --> -0.772209).  Saving model ...
Epoch: 39 cost time: 1.4214692115783691
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.321 Vali Acc: 0.767 Test Loss: 1.321 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5134148597717285
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.315 Vali Acc: 0.772 Test Loss: 1.315 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3231534957885742
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.336 Vali Acc: 0.778 Test Loss: 1.336 Test Acc: 0.778
Validation loss decreased (-0.772209 --> -0.777764).  Saving model ...
Epoch: 42 cost time: 1.5037791728973389
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.305 Vali Acc: 0.778 Test Loss: 1.305 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777765).  Saving model ...
Epoch: 43 cost time: 1.334829568862915
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.303 Vali Acc: 0.767 Test Loss: 1.303 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4724323749542236
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.306 Vali Acc: 0.778 Test Loss: 1.306 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4038031101226807
Epoch: 45, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.316 Vali Acc: 0.783 Test Loss: 1.316 Test Acc: 0.783
Validation loss decreased (-0.777765 --> -0.783320).  Saving model ...
Epoch: 46 cost time: 1.4323370456695557
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.341 Vali Acc: 0.778 Test Loss: 1.341 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.361715316772461
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.349 Vali Acc: 0.772 Test Loss: 1.349 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4364283084869385
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.367 Vali Acc: 0.772 Test Loss: 1.367 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.56071138381958
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.352 Vali Acc: 0.772 Test Loss: 1.352 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3832178115844727
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.356 Vali Acc: 0.772 Test Loss: 1.356 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.4876675605773926
Epoch: 51, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.378 Vali Acc: 0.783 Test Loss: 1.378 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.4361863136291504
Epoch: 52, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.412 Vali Acc: 0.783 Test Loss: 1.412 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.5855023860931396
Epoch: 53, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.399 Vali Acc: 0.783 Test Loss: 1.399 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.3690423965454102
Epoch: 54, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.382 Vali Acc: 0.783 Test Loss: 1.382 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.4098045825958252
Epoch: 55, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.410 Vali Acc: 0.778 Test Loss: 1.410 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 144911
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0338871479034424
Epoch: 1, Steps: 12 | Train Loss: 2.938 Vali Loss: 2.659 Vali Acc: 0.083 Test Loss: 2.659 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 1.5429611206054688
Epoch: 2, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.302 Vali Acc: 0.317 Test Loss: 2.302 Test Acc: 0.317
Validation loss decreased (-0.083307 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 1.4663197994232178
Epoch: 3, Steps: 12 | Train Loss: 2.194 Vali Loss: 1.956 Vali Acc: 0.411 Test Loss: 1.956 Test Acc: 0.411
Validation loss decreased (-0.316644 --> -0.411092).  Saving model ...
Epoch: 4 cost time: 1.3472938537597656
Epoch: 4, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.709 Vali Acc: 0.472 Test Loss: 1.709 Test Acc: 0.472
Validation loss decreased (-0.411092 --> -0.472205).  Saving model ...
Epoch: 5 cost time: 1.2690198421478271
Epoch: 5, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.543 Vali Acc: 0.544 Test Loss: 1.543 Test Acc: 0.544
Validation loss decreased (-0.472205 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 1.2895057201385498
Epoch: 6, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.395 Vali Acc: 0.589 Test Loss: 1.395 Test Acc: 0.589
Validation loss decreased (-0.544429 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 1.4170842170715332
Epoch: 7, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.309 Vali Acc: 0.611 Test Loss: 1.309 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611098).  Saving model ...
Epoch: 8 cost time: 1.2091469764709473
Epoch: 8, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.246 Vali Acc: 0.622 Test Loss: 1.246 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 9 cost time: 1.2407817840576172
Epoch: 9, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.193 Vali Acc: 0.667 Test Loss: 1.193 Test Acc: 0.667
Validation loss decreased (-0.622210 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 1.3680529594421387
Epoch: 10, Steps: 12 | Train Loss: 0.721 Vali Loss: 1.134 Vali Acc: 0.644 Test Loss: 1.134 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4535484313964844
Epoch: 11, Steps: 12 | Train Loss: 0.641 Vali Loss: 1.110 Vali Acc: 0.683 Test Loss: 1.110 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 12 cost time: 1.5161325931549072
Epoch: 12, Steps: 12 | Train Loss: 0.503 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 1.4870829582214355
Epoch: 13, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.997 Vali Acc: 0.722 Test Loss: 0.997 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 1.4904377460479736
Epoch: 14, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.977 Vali Acc: 0.728 Test Loss: 0.977 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 15 cost time: 1.2867496013641357
Epoch: 15, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 16 cost time: 1.3999965190887451
Epoch: 16, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.952 Vali Acc: 0.711 Test Loss: 0.952 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4229145050048828
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.944 Vali Acc: 0.711 Test Loss: 0.944 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.290273666381836
Epoch: 18, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.971 Vali Acc: 0.722 Test Loss: 0.971 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4684035778045654
Epoch: 19, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.963 Vali Acc: 0.733 Test Loss: 0.963 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 20 cost time: 1.3008034229278564
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.992 Vali Acc: 0.733 Test Loss: 0.992 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3041813373565674
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.003 Vali Acc: 0.717 Test Loss: 1.003 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.29835844039917
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.000 Vali Acc: 0.761 Test Loss: 1.000 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761101).  Saving model ...
Epoch: 23 cost time: 1.5993106365203857
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.023 Vali Acc: 0.750 Test Loss: 1.023 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.293060302734375
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.044 Vali Acc: 0.744 Test Loss: 1.044 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3122317790985107
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.063 Vali Acc: 0.756 Test Loss: 1.063 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2757909297943115
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.089 Vali Acc: 0.744 Test Loss: 1.089 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.34865140914917
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.110 Vali Acc: 0.756 Test Loss: 1.110 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4337434768676758
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.114 Vali Acc: 0.767 Test Loss: 1.114 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766656).  Saving model ...
Epoch: 29 cost time: 1.338670015335083
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.110 Vali Acc: 0.756 Test Loss: 1.110 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4785175323486328
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.169 Vali Acc: 0.739 Test Loss: 1.169 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3810808658599854
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.140 Vali Acc: 0.778 Test Loss: 1.140 Test Acc: 0.778
Validation loss decreased (-0.766656 --> -0.777766).  Saving model ...
Epoch: 32 cost time: 1.2906100749969482
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.249 Vali Acc: 0.733 Test Loss: 1.249 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4799487590789795
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.205 Vali Acc: 0.750 Test Loss: 1.205 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3631036281585693
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.157 Vali Acc: 0.767 Test Loss: 1.157 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3503243923187256
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.250 Vali Acc: 0.722 Test Loss: 1.250 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3751132488250732
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.229 Vali Acc: 0.761 Test Loss: 1.229 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.197160243988037
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.226 Vali Acc: 0.761 Test Loss: 1.226 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3590645790100098
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.243 Vali Acc: 0.767 Test Loss: 1.243 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4303324222564697
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.270 Vali Acc: 0.767 Test Loss: 1.270 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.6534368991851807
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.261 Vali Acc: 0.761 Test Loss: 1.261 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4170312881469727
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.283 Vali Acc: 0.761 Test Loss: 1.283 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 143055
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.903475522994995
Epoch: 1, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.694 Vali Acc: 0.106 Test Loss: 2.694 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.147575855255127
Epoch: 2, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.389 Vali Acc: 0.250 Test Loss: 2.389 Test Acc: 0.250
Validation loss decreased (-0.105529 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 1.1634442806243896
Epoch: 3, Steps: 12 | Train Loss: 2.227 Vali Loss: 2.072 Vali Acc: 0.378 Test Loss: 2.072 Test Acc: 0.378
Validation loss decreased (-0.249976 --> -0.377757).  Saving model ...
Epoch: 4 cost time: 1.3304531574249268
Epoch: 4, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.835 Vali Acc: 0.506 Test Loss: 1.835 Test Acc: 0.506
Validation loss decreased (-0.377757 --> -0.505537).  Saving model ...
Epoch: 5 cost time: 1.3813464641571045
Epoch: 5, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.643 Vali Acc: 0.561 Test Loss: 1.643 Test Acc: 0.561
Validation loss decreased (-0.505537 --> -0.561095).  Saving model ...
Epoch: 6 cost time: 1.2725517749786377
Epoch: 6, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.508 Vali Acc: 0.578 Test Loss: 1.508 Test Acc: 0.578
Validation loss decreased (-0.561095 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 1.2598474025726318
Epoch: 7, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.394 Vali Acc: 0.611 Test Loss: 1.394 Test Acc: 0.611
Validation loss decreased (-0.577763 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 1.3091888427734375
Epoch: 8, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.302 Vali Acc: 0.617 Test Loss: 1.302 Test Acc: 0.617
Validation loss decreased (-0.611097 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 1.3487439155578613
Epoch: 9, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.233 Vali Acc: 0.628 Test Loss: 1.233 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627765).  Saving model ...
Epoch: 10 cost time: 1.1271867752075195
Epoch: 10, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.212 Vali Acc: 0.650 Test Loss: 1.212 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 1.4078798294067383
Epoch: 11, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.181 Vali Acc: 0.661 Test Loss: 1.181 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661099).  Saving model ...
Epoch: 12 cost time: 1.410161018371582
Epoch: 12, Steps: 12 | Train Loss: 0.662 Vali Loss: 1.117 Vali Acc: 0.672 Test Loss: 1.117 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 1.4972057342529297
Epoch: 13, Steps: 12 | Train Loss: 0.589 Vali Loss: 1.121 Vali Acc: 0.661 Test Loss: 1.121 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.425546407699585
Epoch: 14, Steps: 12 | Train Loss: 0.544 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 1.4743866920471191
Epoch: 15, Steps: 12 | Train Loss: 0.426 Vali Loss: 1.055 Vali Acc: 0.700 Test Loss: 1.055 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4768683910369873
Epoch: 16, Steps: 12 | Train Loss: 0.448 Vali Loss: 1.022 Vali Acc: 0.694 Test Loss: 1.022 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4046359062194824
Epoch: 17, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.988 Vali Acc: 0.717 Test Loss: 0.988 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 18 cost time: 1.387758731842041
Epoch: 18, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.964 Vali Acc: 0.733 Test Loss: 0.964 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 1.5124061107635498
Epoch: 19, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 20 cost time: 1.299666404724121
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.958 Vali Acc: 0.744 Test Loss: 0.958 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 21 cost time: 1.454413890838623
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 1.3659119606018066
Epoch: 22, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.161529302597046
Epoch: 23, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2921037673950195
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.978 Vali Acc: 0.761 Test Loss: 0.978 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 25 cost time: 1.3026206493377686
Epoch: 25, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.980 Vali Acc: 0.744 Test Loss: 0.980 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5229003429412842
Epoch: 26, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.961 Vali Acc: 0.761 Test Loss: 0.961 Test Acc: 0.761
Validation loss decreased (-0.761101 --> -0.761101).  Saving model ...
Epoch: 27 cost time: 1.3470282554626465
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3945281505584717
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.997 Vali Acc: 0.744 Test Loss: 0.997 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2871310710906982
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4691486358642578
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.986 Vali Acc: 0.767 Test Loss: 0.986 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766657).  Saving model ...
Epoch: 31 cost time: 1.2904000282287598
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.001 Vali Acc: 0.778 Test Loss: 1.001 Test Acc: 0.778
Validation loss decreased (-0.766657 --> -0.777768).  Saving model ...
Epoch: 32 cost time: 1.1983802318572998
Epoch: 32, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.993 Vali Acc: 0.761 Test Loss: 0.993 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3490588665008545
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.059 Vali Acc: 0.756 Test Loss: 1.059 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.434377908706665
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.027 Vali Acc: 0.761 Test Loss: 1.027 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.458200454711914
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.025 Vali Acc: 0.772 Test Loss: 1.025 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.417372703552246
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.071 Vali Acc: 0.750 Test Loss: 1.071 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3720364570617676
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.050 Vali Acc: 0.772 Test Loss: 1.050 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4534237384796143
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.078 Vali Acc: 0.767 Test Loss: 1.078 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.384495735168457
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.090 Vali Acc: 0.767 Test Loss: 1.090 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5156619548797607
Epoch: 40, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.097 Vali Acc: 0.778 Test Loss: 1.097 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.413808822631836
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.080 Vali Acc: 0.783 Test Loss: 1.080 Test Acc: 0.783
Validation loss decreased (-0.777768 --> -0.783323).  Saving model ...
Epoch: 42 cost time: 1.4048783779144287
Epoch: 42, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.081 Vali Acc: 0.783 Test Loss: 1.081 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.509138584136963
Epoch: 43, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.076 Vali Acc: 0.789 Test Loss: 1.076 Test Acc: 0.789
Validation loss decreased (-0.783323 --> -0.788878).  Saving model ...
Epoch: 44 cost time: 1.2859776020050049
Epoch: 44, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.104 Vali Acc: 0.756 Test Loss: 1.104 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.420609474182129
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.134 Vali Acc: 0.778 Test Loss: 1.134 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3520591259002686
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.213 Vali Acc: 0.772 Test Loss: 1.213 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4772403240203857
Epoch: 47, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.168 Vali Acc: 0.756 Test Loss: 1.168 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3913333415985107
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.168 Vali Acc: 0.778 Test Loss: 1.168 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.4100043773651123
Epoch: 49, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.169 Vali Acc: 0.789 Test Loss: 1.169 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.5279324054718018
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.159 Vali Acc: 0.761 Test Loss: 1.159 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.4581737518310547
Epoch: 51, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.180 Vali Acc: 0.778 Test Loss: 1.180 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.4484219551086426
Epoch: 52, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.183 Vali Acc: 0.783 Test Loss: 1.183 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.5154168605804443
Epoch: 53, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.144 Vali Acc: 0.778 Test Loss: 1.144 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 129679
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.230935573577881
Epoch: 1, Steps: 12 | Train Loss: 2.883 Vali Loss: 2.744 Vali Acc: 0.100 Test Loss: 2.744 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.3794257640838623
Epoch: 2, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.532 Vali Acc: 0.217 Test Loss: 2.532 Test Acc: 0.217
Validation loss decreased (-0.099973 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 1.434408187866211
Epoch: 3, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.279 Vali Acc: 0.306 Test Loss: 2.279 Test Acc: 0.306
Validation loss decreased (-0.216641 --> -0.305533).  Saving model ...
Epoch: 4 cost time: 1.3541276454925537
Epoch: 4, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.034 Vali Acc: 0.428 Test Loss: 2.034 Test Acc: 0.428
Validation loss decreased (-0.305533 --> -0.427757).  Saving model ...
Epoch: 5 cost time: 1.4423775672912598
Epoch: 5, Steps: 12 | Train Loss: 1.912 Vali Loss: 1.839 Vali Acc: 0.472 Test Loss: 1.839 Test Acc: 0.472
Validation loss decreased (-0.427757 --> -0.472204).  Saving model ...
Epoch: 6 cost time: 1.4701459407806396
Epoch: 6, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.667 Vali Acc: 0.528 Test Loss: 1.667 Test Acc: 0.528
Validation loss decreased (-0.472204 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 1.2949929237365723
Epoch: 7, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.554 Vali Acc: 0.561 Test Loss: 1.554 Test Acc: 0.561
Validation loss decreased (-0.527761 --> -0.561096).  Saving model ...
Epoch: 8 cost time: 1.4848740100860596
Epoch: 8, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.464 Vali Acc: 0.572 Test Loss: 1.464 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 9 cost time: 1.4430203437805176
Epoch: 9, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.375 Vali Acc: 0.583 Test Loss: 1.375 Test Acc: 0.583
Validation loss decreased (-0.572208 --> -0.583320).  Saving model ...
Epoch: 10 cost time: 1.3736062049865723
Epoch: 10, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.294 Vali Acc: 0.606 Test Loss: 1.294 Test Acc: 0.606
Validation loss decreased (-0.583320 --> -0.605543).  Saving model ...
Epoch: 11 cost time: 1.301940679550171
Epoch: 11, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.246 Vali Acc: 0.639 Test Loss: 1.246 Test Acc: 0.639
Validation loss decreased (-0.605543 --> -0.638876).  Saving model ...
Epoch: 12 cost time: 1.1876635551452637
Epoch: 12, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.202 Vali Acc: 0.644 Test Loss: 1.202 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 13 cost time: 1.1722264289855957
Epoch: 13, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 1.085709571838379
Epoch: 14, Steps: 12 | Train Loss: 0.653 Vali Loss: 1.107 Vali Acc: 0.644 Test Loss: 1.107 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1136219501495361
Epoch: 15, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.043 Vali Acc: 0.656 Test Loss: 1.043 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 16 cost time: 1.1164753437042236
Epoch: 16, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.000 Vali Acc: 0.667 Test Loss: 1.000 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 17 cost time: 1.2405869960784912
Epoch: 17, Steps: 12 | Train Loss: 0.512 Vali Loss: 1.002 Vali Acc: 0.700 Test Loss: 1.002 Test Acc: 0.700
Validation loss decreased (-0.666657 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 1.396911859512329
Epoch: 18, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.954 Vali Acc: 0.694 Test Loss: 0.954 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.360973596572876
Epoch: 19, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.903 Vali Acc: 0.722 Test Loss: 0.903 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 20 cost time: 1.2994747161865234
Epoch: 20, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.926 Vali Acc: 0.722 Test Loss: 0.926 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5025575160980225
Epoch: 21, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.902 Vali Acc: 0.733 Test Loss: 0.902 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 22 cost time: 1.3873951435089111
Epoch: 22, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 1.511934518814087
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.841 Vali Acc: 0.756 Test Loss: 0.841 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 24 cost time: 1.43269944190979
Epoch: 24, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.874 Vali Acc: 0.772 Test Loss: 0.874 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772213).  Saving model ...
Epoch: 25 cost time: 1.3044466972351074
Epoch: 25, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4527969360351562
Epoch: 26, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.843 Vali Acc: 0.733 Test Loss: 0.843 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2836582660675049
Epoch: 27, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3736977577209473
Epoch: 28, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.863 Vali Acc: 0.756 Test Loss: 0.863 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4062151908874512
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.861 Vali Acc: 0.733 Test Loss: 0.861 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4515118598937988
Epoch: 30, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.882 Vali Acc: 0.744 Test Loss: 0.882 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3226654529571533
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.894 Vali Acc: 0.767 Test Loss: 0.894 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3332664966583252
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.889 Vali Acc: 0.728 Test Loss: 0.889 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4213244915008545
Epoch: 33, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.906 Vali Acc: 0.756 Test Loss: 0.906 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3693759441375732
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.922 Vali Acc: 0.767 Test Loss: 0.922 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 122127
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8175482749938965
Epoch: 1, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.691 Vali Acc: 0.089 Test Loss: 2.691 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.1739797592163086
Epoch: 2, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.492 Vali Acc: 0.189 Test Loss: 2.492 Test Acc: 0.189
Validation loss decreased (-0.088862 --> -0.188864).  Saving model ...
Epoch: 3 cost time: 1.221043348312378
Epoch: 3, Steps: 12 | Train Loss: 2.424 Vali Loss: 2.230 Vali Acc: 0.267 Test Loss: 2.230 Test Acc: 0.267
Validation loss decreased (-0.188864 --> -0.266644).  Saving model ...
Epoch: 4 cost time: 1.304687738418579
Epoch: 4, Steps: 12 | Train Loss: 2.137 Vali Loss: 1.978 Vali Acc: 0.400 Test Loss: 1.978 Test Acc: 0.400
Validation loss decreased (-0.266644 --> -0.399980).  Saving model ...
Epoch: 5 cost time: 1.2642805576324463
Epoch: 5, Steps: 12 | Train Loss: 1.993 Vali Loss: 1.776 Vali Acc: 0.472 Test Loss: 1.776 Test Acc: 0.472
Validation loss decreased (-0.399980 --> -0.472204).  Saving model ...
Epoch: 6 cost time: 1.2763376235961914
Epoch: 6, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.646 Vali Acc: 0.517 Test Loss: 1.646 Test Acc: 0.517
Validation loss decreased (-0.472204 --> -0.516650).  Saving model ...
Epoch: 7 cost time: 1.3142592906951904
Epoch: 7, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.526 Vali Acc: 0.556 Test Loss: 1.526 Test Acc: 0.556
Validation loss decreased (-0.516650 --> -0.555540).  Saving model ...
Epoch: 8 cost time: 1.309497594833374
Epoch: 8, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.409 Vali Acc: 0.589 Test Loss: 1.409 Test Acc: 0.589
Validation loss decreased (-0.555540 --> -0.588875).  Saving model ...
Epoch: 9 cost time: 1.384307622909546
Epoch: 9, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.339 Vali Acc: 0.594 Test Loss: 1.339 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594431).  Saving model ...
Epoch: 10 cost time: 1.3481671810150146
Epoch: 10, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.266 Vali Acc: 0.617 Test Loss: 1.266 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616654).  Saving model ...
Epoch: 11 cost time: 1.3715147972106934
Epoch: 11, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.208 Vali Acc: 0.644 Test Loss: 1.208 Test Acc: 0.644
Validation loss decreased (-0.616654 --> -0.644432).  Saving model ...
Epoch: 12 cost time: 1.5002806186676025
Epoch: 12, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.144 Vali Acc: 0.639 Test Loss: 1.144 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2602179050445557
Epoch: 13, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.075 Vali Acc: 0.661 Test Loss: 1.075 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 1.3446133136749268
Epoch: 14, Steps: 12 | Train Loss: 0.687 Vali Loss: 1.015 Vali Acc: 0.656 Test Loss: 1.015 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2862615585327148
Epoch: 15, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.954 Vali Acc: 0.667 Test Loss: 0.954 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 1.2549831867218018
Epoch: 16, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.926 Vali Acc: 0.694 Test Loss: 0.926 Test Acc: 0.694
Validation loss decreased (-0.666657 --> -0.694435).  Saving model ...
Epoch: 17 cost time: 1.292323112487793
Epoch: 17, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.895 Vali Acc: 0.700 Test Loss: 0.895 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 1.243323802947998
Epoch: 18, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.868 Vali Acc: 0.694 Test Loss: 0.868 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2138111591339111
Epoch: 19, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.844 Vali Acc: 0.722 Test Loss: 0.844 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 20 cost time: 1.2795312404632568
Epoch: 20, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.822 Vali Acc: 0.717 Test Loss: 0.822 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2572002410888672
Epoch: 21, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.796 Vali Acc: 0.728 Test Loss: 0.796 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 22 cost time: 1.2580997943878174
Epoch: 22, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
Validation loss decreased (-0.727770 --> -0.761103).  Saving model ...
Epoch: 23 cost time: 1.3181993961334229
Epoch: 23, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.774 Vali Acc: 0.767 Test Loss: 0.774 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 24 cost time: 1.2696678638458252
Epoch: 24, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.788 Vali Acc: 0.728 Test Loss: 0.788 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3139665126800537
Epoch: 25, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.800 Vali Acc: 0.744 Test Loss: 0.800 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3556499481201172
Epoch: 26, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.793 Vali Acc: 0.772 Test Loss: 0.793 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 27 cost time: 1.2619991302490234
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.794 Vali Acc: 0.739 Test Loss: 0.794 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1424164772033691
Epoch: 28, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.791 Vali Acc: 0.756 Test Loss: 0.791 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.334226131439209
Epoch: 29, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.813 Vali Acc: 0.733 Test Loss: 0.813 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.453556776046753
Epoch: 30, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.841 Vali Acc: 0.739 Test Loss: 0.841 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3470029830932617
Epoch: 31, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3741486072540283
Epoch: 32, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3960180282592773
Epoch: 33, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3491716384887695
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3237245082855225
Epoch: 35, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.835 Vali Acc: 0.761 Test Loss: 0.835 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2086524963378906
Epoch: 36, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 118415
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0451085567474365
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.691 Vali Acc: 0.139 Test Loss: 2.691 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.3974754810333252
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.534 Vali Acc: 0.194 Test Loss: 2.534 Test Acc: 0.194
Validation loss decreased (-0.138862 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 1.218324899673462
Epoch: 3, Steps: 12 | Train Loss: 2.513 Vali Loss: 2.321 Vali Acc: 0.361 Test Loss: 2.321 Test Acc: 0.361
Validation loss decreased (-0.194419 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 1.2494218349456787
Epoch: 4, Steps: 12 | Train Loss: 2.298 Vali Loss: 2.104 Vali Acc: 0.433 Test Loss: 2.104 Test Acc: 0.433
Validation loss decreased (-0.361088 --> -0.433312).  Saving model ...
Epoch: 5 cost time: 1.275564432144165
Epoch: 5, Steps: 12 | Train Loss: 2.015 Vali Loss: 1.908 Vali Acc: 0.467 Test Loss: 1.908 Test Acc: 0.467
Validation loss decreased (-0.433312 --> -0.466648).  Saving model ...
Epoch: 6 cost time: 1.3681399822235107
Epoch: 6, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.735 Vali Acc: 0.533 Test Loss: 1.735 Test Acc: 0.533
Validation loss decreased (-0.466648 --> -0.533316).  Saving model ...
Epoch: 7 cost time: 1.238401174545288
Epoch: 7, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.586 Vali Acc: 0.589 Test Loss: 1.586 Test Acc: 0.589
Validation loss decreased (-0.533316 --> -0.588873).  Saving model ...
Epoch: 8 cost time: 1.3048853874206543
Epoch: 8, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.460 Vali Acc: 0.594 Test Loss: 1.460 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594430).  Saving model ...
Epoch: 9 cost time: 1.2408463954925537
Epoch: 9, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.362 Vali Acc: 0.622 Test Loss: 1.362 Test Acc: 0.622
Validation loss decreased (-0.594430 --> -0.622209).  Saving model ...
Epoch: 10 cost time: 1.3881592750549316
Epoch: 10, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.259 Vali Acc: 0.617 Test Loss: 1.259 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3136446475982666
Epoch: 11, Steps: 12 | Train Loss: 1.022 Vali Loss: 1.167 Vali Acc: 0.639 Test Loss: 1.167 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638877).  Saving model ...
Epoch: 12 cost time: 1.2455253601074219
Epoch: 12, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.081 Vali Acc: 0.661 Test Loss: 1.081 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 13 cost time: 1.338876485824585
Epoch: 13, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.001 Vali Acc: 0.661 Test Loss: 1.001 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661101).  Saving model ...
Epoch: 14 cost time: 1.3303508758544922
Epoch: 14, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.952 Vali Acc: 0.678 Test Loss: 0.952 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 15 cost time: 1.3461503982543945
Epoch: 15, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.920 Vali Acc: 0.689 Test Loss: 0.920 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 16 cost time: 1.2723004817962646
Epoch: 16, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.894 Vali Acc: 0.706 Test Loss: 0.894 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705547).  Saving model ...
Epoch: 17 cost time: 1.3530607223510742
Epoch: 17, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.861 Vali Acc: 0.706 Test Loss: 0.861 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 18 cost time: 1.3292300701141357
Epoch: 18, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.849 Vali Acc: 0.706 Test Loss: 0.849 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 19 cost time: 1.237633228302002
Epoch: 19, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 20 cost time: 1.3815269470214844
Epoch: 20, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.807 Vali Acc: 0.744 Test Loss: 0.807 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 1.284005880355835
Epoch: 21, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 1.2718908786773682
Epoch: 22, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 23 cost time: 1.2555642127990723
Epoch: 23, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 24 cost time: 1.3525493144989014
Epoch: 24, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.725 Vali Acc: 0.772 Test Loss: 0.725 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 25 cost time: 1.4043409824371338
Epoch: 25, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 26 cost time: 1.2423927783966064
Epoch: 26, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.224473476409912
Epoch: 27, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.743 Vali Acc: 0.778 Test Loss: 0.743 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1507303714752197
Epoch: 28, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.234116792678833
Epoch: 29, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.719 Vali Acc: 0.778 Test Loss: 0.719 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1846880912780762
Epoch: 30, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.727 Vali Acc: 0.767 Test Loss: 0.727 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2883827686309814
Epoch: 31, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.737 Vali Acc: 0.772 Test Loss: 0.737 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3883404731750488
Epoch: 32, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.744 Vali Acc: 0.778 Test Loss: 0.744 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.321929931640625
Epoch: 33, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2306842803955078
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.780 Vali Acc: 0.767 Test Loss: 0.780 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2287774085998535
Epoch: 35, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.745 Vali Acc: 0.783 Test Loss: 0.745 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 114767
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9374327659606934
Epoch: 1, Steps: 12 | Train Loss: 2.941 Vali Loss: 2.611 Vali Acc: 0.150 Test Loss: 2.611 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 1.1962890625
Epoch: 2, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.083 Vali Acc: 0.433 Test Loss: 2.083 Test Acc: 0.433
Validation loss decreased (-0.149974 --> -0.433313).  Saving model ...
Epoch: 3 cost time: 1.211228370666504
Epoch: 3, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.697 Vali Acc: 0.506 Test Loss: 1.697 Test Acc: 0.506
Validation loss decreased (-0.433313 --> -0.505539).  Saving model ...
Epoch: 4 cost time: 1.2216591835021973
Epoch: 4, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.438 Vali Acc: 0.583 Test Loss: 1.438 Test Acc: 0.583
Validation loss decreased (-0.505539 --> -0.583319).  Saving model ...
Epoch: 5 cost time: 1.1700589656829834
Epoch: 5, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.341 Vali Acc: 0.583 Test Loss: 1.341 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 1.086336612701416
Epoch: 6, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.247 Vali Acc: 0.639 Test Loss: 1.247 Test Acc: 0.639
Validation loss decreased (-0.583320 --> -0.638876).  Saving model ...
Epoch: 7 cost time: 1.114588737487793
Epoch: 7, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.186 Vali Acc: 0.650 Test Loss: 1.186 Test Acc: 0.650
Validation loss decreased (-0.638876 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 1.3358936309814453
Epoch: 8, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.172 Vali Acc: 0.661 Test Loss: 1.172 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 1.1793360710144043
Epoch: 9, Steps: 12 | Train Loss: 0.632 Vali Loss: 1.086 Vali Acc: 0.689 Test Loss: 1.086 Test Acc: 0.689
Validation loss decreased (-0.661099 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 1.204542875289917
Epoch: 10, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.032 Vali Acc: 0.694 Test Loss: 1.032 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 1.4959802627563477
Epoch: 11, Steps: 12 | Train Loss: 0.431 Vali Loss: 1.077 Vali Acc: 0.689 Test Loss: 1.077 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3550171852111816
Epoch: 12, Steps: 12 | Train Loss: 0.320 Vali Loss: 1.036 Vali Acc: 0.722 Test Loss: 1.036 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 13 cost time: 1.3821744918823242
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 1.034 Vali Acc: 0.722 Test Loss: 1.034 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 1.2651658058166504
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.103 Vali Acc: 0.722 Test Loss: 1.103 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.421769380569458
Epoch: 15, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.034 Vali Acc: 0.744 Test Loss: 1.034 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744434).  Saving model ...
Epoch: 16 cost time: 1.342986822128296
Epoch: 16, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.142 Vali Acc: 0.728 Test Loss: 1.142 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.383779525756836
Epoch: 17, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.134 Vali Acc: 0.739 Test Loss: 1.134 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4251139163970947
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.170 Vali Acc: 0.733 Test Loss: 1.170 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5013775825500488
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.139 Vali Acc: 0.756 Test Loss: 1.139 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755544).  Saving model ...
Epoch: 20 cost time: 1.4342079162597656
Epoch: 20, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.249 Vali Acc: 0.739 Test Loss: 1.249 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3819622993469238
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.246 Vali Acc: 0.717 Test Loss: 1.246 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.273669958114624
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.350 Vali Acc: 0.744 Test Loss: 1.350 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3279125690460205
Epoch: 23, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.284 Vali Acc: 0.744 Test Loss: 1.284 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.320570468902588
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.315 Vali Acc: 0.733 Test Loss: 1.315 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2883684635162354
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.389 Vali Acc: 0.744 Test Loss: 1.389 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1780166625976562
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.356 Vali Acc: 0.728 Test Loss: 1.356 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.336477279663086
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.415 Vali Acc: 0.756 Test Loss: 1.415 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.192779302597046
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.384 Vali Acc: 0.761 Test Loss: 1.384 Test Acc: 0.761
Validation loss decreased (-0.755544 --> -0.761097).  Saving model ...
Epoch: 29 cost time: 1.4644832611083984
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.433 Vali Acc: 0.750 Test Loss: 1.433 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5003938674926758
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.445 Vali Acc: 0.767 Test Loss: 1.445 Test Acc: 0.767
Validation loss decreased (-0.761097 --> -0.766652).  Saving model ...
Epoch: 31 cost time: 1.3767924308776855
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.465 Vali Acc: 0.756 Test Loss: 1.465 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4867169857025146
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.430 Vali Acc: 0.761 Test Loss: 1.430 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.326190710067749
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.446 Vali Acc: 0.756 Test Loss: 1.446 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3868131637573242
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.472 Vali Acc: 0.744 Test Loss: 1.472 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.393899917602539
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.495 Vali Acc: 0.756 Test Loss: 1.495 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4543697834014893
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.480 Vali Acc: 0.767 Test Loss: 1.480 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4565036296844482
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.495 Vali Acc: 0.761 Test Loss: 1.495 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4631249904632568
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.535 Vali Acc: 0.733 Test Loss: 1.535 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2138609886169434
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.515 Vali Acc: 0.756 Test Loss: 1.515 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4244234561920166
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.565 Vali Acc: 0.756 Test Loss: 1.565 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 162319
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.258462429046631
Epoch: 1, Steps: 12 | Train Loss: 2.896 Vali Loss: 2.699 Vali Acc: 0.100 Test Loss: 2.699 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.5070533752441406
Epoch: 2, Steps: 12 | Train Loss: 2.589 Vali Loss: 2.341 Vali Acc: 0.372 Test Loss: 2.341 Test Acc: 0.372
Validation loss decreased (-0.099973 --> -0.372199).  Saving model ...
Epoch: 3 cost time: 1.490602731704712
Epoch: 3, Steps: 12 | Train Loss: 2.217 Vali Loss: 1.993 Vali Acc: 0.506 Test Loss: 1.993 Test Acc: 0.506
Validation loss decreased (-0.372199 --> -0.505536).  Saving model ...
Epoch: 4 cost time: 1.4893419742584229
Epoch: 4, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.727 Vali Acc: 0.561 Test Loss: 1.727 Test Acc: 0.561
Validation loss decreased (-0.505536 --> -0.561094).  Saving model ...
Epoch: 5 cost time: 1.49513840675354
Epoch: 5, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.536 Vali Acc: 0.561 Test Loss: 1.536 Test Acc: 0.561
Validation loss decreased (-0.561094 --> -0.561096).  Saving model ...
Epoch: 6 cost time: 1.4964447021484375
Epoch: 6, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.445 Vali Acc: 0.567 Test Loss: 1.445 Test Acc: 0.567
Validation loss decreased (-0.561096 --> -0.566652).  Saving model ...
Epoch: 7 cost time: 1.3207330703735352
Epoch: 7, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.345 Vali Acc: 0.606 Test Loss: 1.345 Test Acc: 0.606
Validation loss decreased (-0.566652 --> -0.605542).  Saving model ...
Epoch: 8 cost time: 1.502239465713501
Epoch: 8, Steps: 12 | Train Loss: 0.984 Vali Loss: 1.261 Vali Acc: 0.650 Test Loss: 1.261 Test Acc: 0.650
Validation loss decreased (-0.605542 --> -0.649987).  Saving model ...
Epoch: 9 cost time: 1.4444692134857178
Epoch: 9, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.198 Vali Acc: 0.661 Test Loss: 1.198 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661099).  Saving model ...
Epoch: 10 cost time: 1.6164605617523193
Epoch: 10, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.167 Vali Acc: 0.650 Test Loss: 1.167 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6161723136901855
Epoch: 11, Steps: 12 | Train Loss: 0.660 Vali Loss: 1.120 Vali Acc: 0.683 Test Loss: 1.120 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683322).  Saving model ...
Epoch: 12 cost time: 1.5414607524871826
Epoch: 12, Steps: 12 | Train Loss: 0.598 Vali Loss: 1.073 Vali Acc: 0.689 Test Loss: 1.073 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 13 cost time: 1.5970978736877441
Epoch: 13, Steps: 12 | Train Loss: 0.498 Vali Loss: 1.051 Vali Acc: 0.706 Test Loss: 1.051 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 1.461320400238037
Epoch: 14, Steps: 12 | Train Loss: 0.426 Vali Loss: 1.016 Vali Acc: 0.706 Test Loss: 1.016 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705545).  Saving model ...
Epoch: 15 cost time: 1.4384162425994873
Epoch: 15, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.968 Vali Acc: 0.706 Test Loss: 0.968 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705546).  Saving model ...
Epoch: 16 cost time: 1.520033597946167
Epoch: 16, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.994 Vali Acc: 0.744 Test Loss: 0.994 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744435).  Saving model ...
Epoch: 17 cost time: 1.56638503074646
Epoch: 17, Steps: 12 | Train Loss: 0.256 Vali Loss: 1.016 Vali Acc: 0.733 Test Loss: 1.016 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5657711029052734
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.944 Vali Acc: 0.761 Test Loss: 0.944 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761102).  Saving model ...
Epoch: 19 cost time: 1.5961859226226807
Epoch: 19, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.006 Vali Acc: 0.756 Test Loss: 1.006 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4934968948364258
Epoch: 20, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.003 Vali Acc: 0.783 Test Loss: 1.003 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783323).  Saving model ...
Epoch: 21 cost time: 1.6641294956207275
Epoch: 21, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.037 Vali Acc: 0.750 Test Loss: 1.037 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5138270854949951
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.059 Vali Acc: 0.761 Test Loss: 1.059 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.577892780303955
Epoch: 23, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.046 Vali Acc: 0.744 Test Loss: 1.046 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4635412693023682
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.059 Vali Acc: 0.756 Test Loss: 1.059 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.572798490524292
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.124 Vali Acc: 0.744 Test Loss: 1.124 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6522560119628906
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.113 Vali Acc: 0.778 Test Loss: 1.113 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7007293701171875
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.127 Vali Acc: 0.756 Test Loss: 1.127 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7355091571807861
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.105 Vali Acc: 0.772 Test Loss: 1.105 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.466594934463501
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.153 Vali Acc: 0.750 Test Loss: 1.153 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6009337902069092
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.184 Vali Acc: 0.767 Test Loss: 1.184 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 120143
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.212584972381592
Epoch: 1, Steps: 12 | Train Loss: 2.916 Vali Loss: 2.657 Vali Acc: 0.083 Test Loss: 2.657 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 1.6145131587982178
Epoch: 2, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.299 Vali Acc: 0.339 Test Loss: 2.299 Test Acc: 0.339
Validation loss decreased (-0.083307 --> -0.338866).  Saving model ...
Epoch: 3 cost time: 1.6244394779205322
Epoch: 3, Steps: 12 | Train Loss: 2.142 Vali Loss: 1.968 Vali Acc: 0.433 Test Loss: 1.968 Test Acc: 0.433
Validation loss decreased (-0.338866 --> -0.433314).  Saving model ...
Epoch: 4 cost time: 1.5029327869415283
Epoch: 4, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.719 Vali Acc: 0.478 Test Loss: 1.719 Test Acc: 0.478
Validation loss decreased (-0.433314 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 1.5554451942443848
Epoch: 5, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.568 Vali Acc: 0.506 Test Loss: 1.568 Test Acc: 0.506
Validation loss decreased (-0.477761 --> -0.505540).  Saving model ...
Epoch: 6 cost time: 1.4983396530151367
Epoch: 6, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.432 Vali Acc: 0.600 Test Loss: 1.432 Test Acc: 0.600
Validation loss decreased (-0.505540 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 1.3512153625488281
Epoch: 7, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 1.536696434020996
Epoch: 8, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.316 Vali Acc: 0.617 Test Loss: 1.316 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 1.1938016414642334
Epoch: 9, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.263 Vali Acc: 0.639 Test Loss: 1.263 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638876).  Saving model ...
Epoch: 10 cost time: 1.4654889106750488
Epoch: 10, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.197 Vali Acc: 0.672 Test Loss: 1.197 Test Acc: 0.672
Validation loss decreased (-0.638876 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 1.4110548496246338
Epoch: 11, Steps: 12 | Train Loss: 0.696 Vali Loss: 1.160 Vali Acc: 0.656 Test Loss: 1.160 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4516925811767578
Epoch: 12, Steps: 12 | Train Loss: 0.618 Vali Loss: 1.131 Vali Acc: 0.678 Test Loss: 1.131 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677766).  Saving model ...
Epoch: 13 cost time: 1.2727046012878418
Epoch: 13, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.040 Vali Acc: 0.706 Test Loss: 1.040 Test Acc: 0.706
Validation loss decreased (-0.677766 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 1.2966527938842773
Epoch: 14, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.988 Vali Acc: 0.711 Test Loss: 0.988 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 15 cost time: 1.153214931488037
Epoch: 15, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.985 Vali Acc: 0.706 Test Loss: 0.985 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1365594863891602
Epoch: 16, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.976 Vali Acc: 0.717 Test Loss: 0.976 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 17 cost time: 1.231921911239624
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.937 Vali Acc: 0.728 Test Loss: 0.937 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 18 cost time: 1.1731786727905273
Epoch: 18, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749991).  Saving model ...
Epoch: 19 cost time: 1.3150851726531982
Epoch: 19, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.951 Vali Acc: 0.739 Test Loss: 0.951 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.381018877029419
Epoch: 20, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.956 Vali Acc: 0.739 Test Loss: 0.956 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3303520679473877
Epoch: 21, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.993 Vali Acc: 0.744 Test Loss: 0.993 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5915093421936035
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.971 Vali Acc: 0.756 Test Loss: 0.971 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755546).  Saving model ...
Epoch: 23 cost time: 1.3688240051269531
Epoch: 23, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.000 Vali Acc: 0.756 Test Loss: 1.000 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.479628086090088
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.022 Vali Acc: 0.728 Test Loss: 1.022 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.409597635269165
Epoch: 25, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.079 Vali Acc: 0.739 Test Loss: 1.079 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4646580219268799
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.007 Vali Acc: 0.772 Test Loss: 1.007 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772212).  Saving model ...
Epoch: 27 cost time: 1.4937326908111572
Epoch: 27, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.038 Vali Acc: 0.756 Test Loss: 1.038 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4042575359344482
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.066 Vali Acc: 0.750 Test Loss: 1.066 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.452458143234253
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.048 Vali Acc: 0.767 Test Loss: 1.048 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4249444007873535
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.113 Vali Acc: 0.744 Test Loss: 1.113 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5325639247894287
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.114 Vali Acc: 0.756 Test Loss: 1.114 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2812047004699707
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.113 Vali Acc: 0.756 Test Loss: 1.113 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3626716136932373
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.150 Vali Acc: 0.761 Test Loss: 1.150 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3860664367675781
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.166 Vali Acc: 0.767 Test Loss: 1.166 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4228739738464355
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.149 Vali Acc: 0.778 Test Loss: 1.149 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777766).  Saving model ...
Epoch: 36 cost time: 1.5000243186950684
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.181 Vali Acc: 0.767 Test Loss: 1.181 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.460890293121338
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.180 Vali Acc: 0.789 Test Loss: 1.180 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788877).  Saving model ...
Epoch: 38 cost time: 1.189265251159668
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.199 Vali Acc: 0.761 Test Loss: 1.199 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2969684600830078
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.208 Vali Acc: 0.772 Test Loss: 1.208 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2924714088439941
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.170 Vali Acc: 0.767 Test Loss: 1.170 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2468864917755127
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.216 Vali Acc: 0.772 Test Loss: 1.216 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0949018001556396
Epoch: 42, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.227 Vali Acc: 0.772 Test Loss: 1.227 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.3134865760803223
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.219 Vali Acc: 0.767 Test Loss: 1.219 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3609578609466553
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.252 Vali Acc: 0.767 Test Loss: 1.252 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.3081696033477783
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.283 Vali Acc: 0.761 Test Loss: 1.283 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3929355144500732
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.253 Vali Acc: 0.789 Test Loss: 1.253 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2823405265808105
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.264 Vali Acc: 0.767 Test Loss: 1.264 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 118287
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.832669258117676
Epoch: 1, Steps: 12 | Train Loss: 2.892 Vali Loss: 2.681 Vali Acc: 0.139 Test Loss: 2.681 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.3456544876098633
Epoch: 2, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.398 Vali Acc: 0.322 Test Loss: 2.398 Test Acc: 0.322
Validation loss decreased (-0.138862 --> -0.322198).  Saving model ...
Epoch: 3 cost time: 1.2656464576721191
Epoch: 3, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.093 Vali Acc: 0.422 Test Loss: 2.093 Test Acc: 0.422
Validation loss decreased (-0.322198 --> -0.422201).  Saving model ...
Epoch: 4 cost time: 1.3285183906555176
Epoch: 4, Steps: 12 | Train Loss: 1.935 Vali Loss: 1.843 Vali Acc: 0.489 Test Loss: 1.843 Test Acc: 0.489
Validation loss decreased (-0.422201 --> -0.488870).  Saving model ...
Epoch: 5 cost time: 1.3806722164154053
Epoch: 5, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.657 Vali Acc: 0.522 Test Loss: 1.657 Test Acc: 0.522
Validation loss decreased (-0.488870 --> -0.522206).  Saving model ...
Epoch: 6 cost time: 1.293151617050171
Epoch: 6, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.514 Vali Acc: 0.561 Test Loss: 1.514 Test Acc: 0.561
Validation loss decreased (-0.522206 --> -0.561096).  Saving model ...
Epoch: 7 cost time: 1.130620002746582
Epoch: 7, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.408 Vali Acc: 0.578 Test Loss: 1.408 Test Acc: 0.578
Validation loss decreased (-0.561096 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 1.3290760517120361
Epoch: 8, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.337 Vali Acc: 0.600 Test Loss: 1.337 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 1.2566547393798828
Epoch: 9, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.258 Vali Acc: 0.639 Test Loss: 1.258 Test Acc: 0.639
Validation loss decreased (-0.599987 --> -0.638876).  Saving model ...
Epoch: 10 cost time: 1.2647240161895752
Epoch: 10, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.222 Vali Acc: 0.667 Test Loss: 1.222 Test Acc: 0.667
Validation loss decreased (-0.638876 --> -0.666654).  Saving model ...
Epoch: 11 cost time: 1.246628999710083
Epoch: 11, Steps: 12 | Train Loss: 0.761 Vali Loss: 1.167 Vali Acc: 0.661 Test Loss: 1.167 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3525781631469727
Epoch: 12, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.139 Vali Acc: 0.644 Test Loss: 1.139 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3697187900543213
Epoch: 13, Steps: 12 | Train Loss: 0.605 Vali Loss: 1.099 Vali Acc: 0.667 Test Loss: 1.099 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 1.2237796783447266
Epoch: 14, Steps: 12 | Train Loss: 0.575 Vali Loss: 1.055 Vali Acc: 0.706 Test Loss: 1.055 Test Acc: 0.706
Validation loss decreased (-0.666656 --> -0.705545).  Saving model ...
Epoch: 15 cost time: 1.2430851459503174
Epoch: 15, Steps: 12 | Train Loss: 0.544 Vali Loss: 1.033 Vali Acc: 0.706 Test Loss: 1.033 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705545).  Saving model ...
Epoch: 16 cost time: 1.356499195098877
Epoch: 16, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.989 Vali Acc: 0.717 Test Loss: 0.989 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 17 cost time: 1.4757630825042725
Epoch: 17, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.963 Vali Acc: 0.739 Test Loss: 0.963 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738879).  Saving model ...
Epoch: 18 cost time: 1.4579827785491943
Epoch: 18, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.950 Vali Acc: 0.756 Test Loss: 0.950 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 19 cost time: 1.3519763946533203
Epoch: 19, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.930 Vali Acc: 0.744 Test Loss: 0.930 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1752617359161377
Epoch: 20, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.909 Vali Acc: 0.767 Test Loss: 0.909 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 21 cost time: 1.2422692775726318
Epoch: 21, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.897 Vali Acc: 0.783 Test Loss: 0.897 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783324).  Saving model ...
Epoch: 22 cost time: 1.2682552337646484
Epoch: 22, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.909 Vali Acc: 0.783 Test Loss: 0.909 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2373452186584473
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.923 Vali Acc: 0.744 Test Loss: 0.923 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.145531177520752
Epoch: 24, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.909 Vali Acc: 0.778 Test Loss: 0.909 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2090473175048828
Epoch: 25, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.915 Vali Acc: 0.778 Test Loss: 0.915 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.450664758682251
Epoch: 26, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.959 Vali Acc: 0.772 Test Loss: 0.959 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2354693412780762
Epoch: 27, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.940 Vali Acc: 0.761 Test Loss: 0.940 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1442384719848633
Epoch: 28, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.949 Vali Acc: 0.783 Test Loss: 0.949 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2151565551757812
Epoch: 29, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.973 Vali Acc: 0.772 Test Loss: 0.973 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.230109453201294
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.963 Vali Acc: 0.772 Test Loss: 0.963 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2283046245574951
Epoch: 31, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.940 Vali Acc: 0.778 Test Loss: 0.940 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 104911
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.794710874557495
Epoch: 1, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.650 Vali Acc: 0.072 Test Loss: 2.650 Test Acc: 0.072
Validation loss decreased (inf --> -0.072196).  Saving model ...
Epoch: 2 cost time: 1.1883957386016846
Epoch: 2, Steps: 12 | Train Loss: 2.618 Vali Loss: 2.466 Vali Acc: 0.167 Test Loss: 2.466 Test Acc: 0.167
Validation loss decreased (-0.072196 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 1.2126941680908203
Epoch: 3, Steps: 12 | Train Loss: 2.384 Vali Loss: 2.228 Vali Acc: 0.333 Test Loss: 2.228 Test Acc: 0.333
Validation loss decreased (-0.166642 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 1.3491637706756592
Epoch: 4, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.001 Vali Acc: 0.456 Test Loss: 2.001 Test Acc: 0.456
Validation loss decreased (-0.333311 --> -0.455536).  Saving model ...
Epoch: 5 cost time: 1.1670985221862793
Epoch: 5, Steps: 12 | Train Loss: 1.956 Vali Loss: 1.832 Vali Acc: 0.489 Test Loss: 1.832 Test Acc: 0.489
Validation loss decreased (-0.455536 --> -0.488871).  Saving model ...
Epoch: 6 cost time: 1.264963150024414
Epoch: 6, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.665 Vali Acc: 0.561 Test Loss: 1.665 Test Acc: 0.561
Validation loss decreased (-0.488871 --> -0.561094).  Saving model ...
Epoch: 7 cost time: 1.3518977165222168
Epoch: 7, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.546 Vali Acc: 0.600 Test Loss: 1.546 Test Acc: 0.600
Validation loss decreased (-0.561094 --> -0.599985).  Saving model ...
Epoch: 8 cost time: 1.3752985000610352
Epoch: 8, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.476 Vali Acc: 0.611 Test Loss: 1.476 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 1.2539587020874023
Epoch: 9, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.402 Vali Acc: 0.583 Test Loss: 1.402 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.19069242477417
Epoch: 10, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.333 Vali Acc: 0.622 Test Loss: 1.333 Test Acc: 0.622
Validation loss decreased (-0.611096 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 1.1025176048278809
Epoch: 11, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.275 Vali Acc: 0.644 Test Loss: 1.275 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644432).  Saving model ...
Epoch: 12 cost time: 1.238649845123291
Epoch: 12, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.231 Vali Acc: 0.656 Test Loss: 1.231 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655543).  Saving model ...
Epoch: 13 cost time: 1.15505051612854
Epoch: 13, Steps: 12 | Train Loss: 0.797 Vali Loss: 1.185 Vali Acc: 0.656 Test Loss: 1.185 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 1.2051684856414795
Epoch: 14, Steps: 12 | Train Loss: 0.716 Vali Loss: 1.117 Vali Acc: 0.683 Test Loss: 1.117 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683322).  Saving model ...
Epoch: 15 cost time: 1.2021706104278564
Epoch: 15, Steps: 12 | Train Loss: 0.650 Vali Loss: 1.081 Vali Acc: 0.683 Test Loss: 1.081 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683323).  Saving model ...
Epoch: 16 cost time: 1.137113094329834
Epoch: 16, Steps: 12 | Train Loss: 0.601 Vali Loss: 1.015 Vali Acc: 0.689 Test Loss: 1.015 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 17 cost time: 1.1781957149505615
Epoch: 17, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.985 Vali Acc: 0.689 Test Loss: 0.985 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 18 cost time: 1.2215566635131836
Epoch: 18, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
Validation loss decreased (-0.688879 --> -0.722213).  Saving model ...
Epoch: 19 cost time: 1.2958498001098633
Epoch: 19, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.915 Vali Acc: 0.739 Test Loss: 0.915 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 20 cost time: 1.2897284030914307
Epoch: 20, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.886 Vali Acc: 0.733 Test Loss: 0.886 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.290332317352295
Epoch: 21, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.860 Vali Acc: 0.733 Test Loss: 0.860 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1820635795593262
Epoch: 22, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 1.2970612049102783
Epoch: 23, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.835 Vali Acc: 0.772 Test Loss: 0.835 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772214).  Saving model ...
Epoch: 24 cost time: 1.1716680526733398
Epoch: 24, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2560935020446777
Epoch: 25, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.838 Vali Acc: 0.794 Test Loss: 0.838 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794436).  Saving model ...
Epoch: 26 cost time: 1.2753918170928955
Epoch: 26, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1433041095733643
Epoch: 27, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.850 Vali Acc: 0.772 Test Loss: 0.850 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2664742469787598
Epoch: 28, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.870 Vali Acc: 0.767 Test Loss: 0.870 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3134450912475586
Epoch: 29, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.862 Vali Acc: 0.756 Test Loss: 0.862 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1450121402740479
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.855 Vali Acc: 0.794 Test Loss: 0.855 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.284031629562378
Epoch: 31, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.839 Vali Acc: 0.783 Test Loss: 0.839 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.25335693359375
Epoch: 32, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.868 Vali Acc: 0.794 Test Loss: 0.868 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2274837493896484
Epoch: 33, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.879 Vali Acc: 0.772 Test Loss: 0.879 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1660823822021484
Epoch: 34, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.872 Vali Acc: 0.783 Test Loss: 0.872 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2650840282440186
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.877 Vali Acc: 0.789 Test Loss: 0.877 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 97359
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.914496660232544
Epoch: 1, Steps: 12 | Train Loss: 2.840 Vali Loss: 2.753 Vali Acc: 0.111 Test Loss: 2.753 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 1.1323440074920654
Epoch: 2, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.530 Vali Acc: 0.194 Test Loss: 2.530 Test Acc: 0.194
Validation loss decreased (-0.111084 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 1.174727439880371
Epoch: 3, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.284 Vali Acc: 0.311 Test Loss: 2.284 Test Acc: 0.311
Validation loss decreased (-0.194419 --> -0.311088).  Saving model ...
Epoch: 4 cost time: 1.0884971618652344
Epoch: 4, Steps: 12 | Train Loss: 2.193 Vali Loss: 2.053 Vali Acc: 0.456 Test Loss: 2.053 Test Acc: 0.456
Validation loss decreased (-0.311088 --> -0.455535).  Saving model ...
Epoch: 5 cost time: 1.180140495300293
Epoch: 5, Steps: 12 | Train Loss: 2.001 Vali Loss: 1.856 Vali Acc: 0.522 Test Loss: 1.856 Test Acc: 0.522
Validation loss decreased (-0.455535 --> -0.522204).  Saving model ...
Epoch: 6 cost time: 1.230834722518921
Epoch: 6, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.698 Vali Acc: 0.567 Test Loss: 1.698 Test Acc: 0.567
Validation loss decreased (-0.522204 --> -0.566650).  Saving model ...
Epoch: 7 cost time: 1.0905985832214355
Epoch: 7, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.588 Vali Acc: 0.572 Test Loss: 1.588 Test Acc: 0.572
Validation loss decreased (-0.566650 --> -0.572206).  Saving model ...
Epoch: 8 cost time: 1.0184922218322754
Epoch: 8, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.499 Vali Acc: 0.572 Test Loss: 1.499 Test Acc: 0.572
Validation loss decreased (-0.572206 --> -0.572207).  Saving model ...
Epoch: 9 cost time: 1.0527827739715576
Epoch: 9, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.425 Vali Acc: 0.589 Test Loss: 1.425 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588875).  Saving model ...
Epoch: 10 cost time: 1.248112678527832
Epoch: 10, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.372 Vali Acc: 0.578 Test Loss: 1.372 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1890532970428467
Epoch: 11, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.302 Vali Acc: 0.572 Test Loss: 1.302 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.347839117050171
Epoch: 12, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.249 Vali Acc: 0.611 Test Loss: 1.249 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611099).  Saving model ...
Epoch: 13 cost time: 1.3985028266906738
Epoch: 13, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.207 Vali Acc: 0.611 Test Loss: 1.207 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 14 cost time: 1.2294414043426514
Epoch: 14, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.148 Vali Acc: 0.611 Test Loss: 1.148 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611100).  Saving model ...
Epoch: 15 cost time: 1.2948815822601318
Epoch: 15, Steps: 12 | Train Loss: 0.742 Vali Loss: 1.104 Vali Acc: 0.644 Test Loss: 1.104 Test Acc: 0.644
Validation loss decreased (-0.611100 --> -0.644433).  Saving model ...
Epoch: 16 cost time: 1.3483762741088867
Epoch: 16, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.036 Vali Acc: 0.672 Test Loss: 1.036 Test Acc: 0.672
Validation loss decreased (-0.644433 --> -0.672212).  Saving model ...
Epoch: 17 cost time: 1.3548007011413574
Epoch: 17, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.996 Vali Acc: 0.650 Test Loss: 0.996 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3135402202606201
Epoch: 18, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.942 Vali Acc: 0.694 Test Loss: 0.942 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694435).  Saving model ...
Epoch: 19 cost time: 1.4059014320373535
Epoch: 19, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.903 Vali Acc: 0.694 Test Loss: 0.903 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 20 cost time: 1.25944185256958
Epoch: 20, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.861 Vali Acc: 0.700 Test Loss: 0.861 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 1.3819739818572998
Epoch: 21, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.844 Vali Acc: 0.722 Test Loss: 0.844 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 22 cost time: 1.3080668449401855
Epoch: 22, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.801 Vali Acc: 0.761 Test Loss: 0.801 Test Acc: 0.761
Validation loss decreased (-0.722214 --> -0.761103).  Saving model ...
Epoch: 23 cost time: 1.2156295776367188
Epoch: 23, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.326174259185791
Epoch: 24, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.791 Vali Acc: 0.761 Test Loss: 0.791 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 25 cost time: 1.2965116500854492
Epoch: 25, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.24210786819458
Epoch: 26, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3874974250793457
Epoch: 27, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.761 Vali Acc: 0.744 Test Loss: 0.761 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2926197052001953
Epoch: 28, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.763 Vali Acc: 0.744 Test Loss: 0.763 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3707249164581299
Epoch: 29, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.748 Vali Acc: 0.761 Test Loss: 0.748 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761104).  Saving model ...
Epoch: 30 cost time: 1.3688349723815918
Epoch: 30, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.750 Vali Acc: 0.772 Test Loss: 0.750 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 31 cost time: 1.325242519378662
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.759 Vali Acc: 0.767 Test Loss: 0.759 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1825923919677734
Epoch: 32, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.769 Vali Acc: 0.767 Test Loss: 0.769 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3665213584899902
Epoch: 33, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4656822681427002
Epoch: 34, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3146460056304932
Epoch: 35, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.822 Vali Acc: 0.783 Test Loss: 0.822 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783325).  Saving model ...
Epoch: 36 cost time: 1.3225440979003906
Epoch: 36, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.797 Vali Acc: 0.772 Test Loss: 0.797 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.255446434020996
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.847 Vali Acc: 0.761 Test Loss: 0.847 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1129827499389648
Epoch: 38, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.831 Vali Acc: 0.756 Test Loss: 0.831 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0559601783752441
Epoch: 39, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.812 Vali Acc: 0.778 Test Loss: 0.812 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1117355823516846
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.827 Vali Acc: 0.794 Test Loss: 0.827 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794436).  Saving model ...
Epoch: 41 cost time: 1.2152841091156006
Epoch: 41, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.840 Vali Acc: 0.783 Test Loss: 0.840 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2833945751190186
Epoch: 42, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.803 Vali Acc: 0.783 Test Loss: 0.803 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.173203468322754
Epoch: 43, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.844 Vali Acc: 0.778 Test Loss: 0.844 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3217787742614746
Epoch: 44, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.857 Vali Acc: 0.767 Test Loss: 0.857 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3427293300628662
Epoch: 45, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.892 Vali Acc: 0.783 Test Loss: 0.892 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2277050018310547
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.886 Vali Acc: 0.778 Test Loss: 0.886 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2098467350006104
Epoch: 47, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.917 Vali Acc: 0.778 Test Loss: 0.917 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2660601139068604
Epoch: 48, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.909 Vali Acc: 0.767 Test Loss: 0.909 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2988171577453613
Epoch: 49, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.904 Vali Acc: 0.783 Test Loss: 0.904 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1077923774719238
Epoch: 50, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.939 Vali Acc: 0.783 Test Loss: 0.939 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 93647
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1694090366363525
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.613 Vali Acc: 0.139 Test Loss: 2.613 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.1631758213043213
Epoch: 2, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.454 Vali Acc: 0.194 Test Loss: 2.454 Test Acc: 0.194
Validation loss decreased (-0.138863 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 1.2038319110870361
Epoch: 3, Steps: 12 | Train Loss: 2.568 Vali Loss: 2.257 Vali Acc: 0.278 Test Loss: 2.257 Test Acc: 0.278
Validation loss decreased (-0.194420 --> -0.277755).  Saving model ...
Epoch: 4 cost time: 1.0926270484924316
Epoch: 4, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.060 Vali Acc: 0.394 Test Loss: 2.060 Test Acc: 0.394
Validation loss decreased (-0.277755 --> -0.394424).  Saving model ...
Epoch: 5 cost time: 1.079683542251587
Epoch: 5, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.897 Vali Acc: 0.500 Test Loss: 1.897 Test Acc: 0.500
Validation loss decreased (-0.394424 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 1.0584344863891602
Epoch: 6, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.755 Vali Acc: 0.522 Test Loss: 1.755 Test Acc: 0.522
Validation loss decreased (-0.499981 --> -0.522205).  Saving model ...
Epoch: 7 cost time: 1.089841365814209
Epoch: 7, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.613 Vali Acc: 0.544 Test Loss: 1.613 Test Acc: 0.544
Validation loss decreased (-0.522205 --> -0.544428).  Saving model ...
Epoch: 8 cost time: 1.09977388381958
Epoch: 8, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.523 Vali Acc: 0.567 Test Loss: 1.523 Test Acc: 0.567
Validation loss decreased (-0.544428 --> -0.566651).  Saving model ...
Epoch: 9 cost time: 1.0945920944213867
Epoch: 9, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.433 Vali Acc: 0.589 Test Loss: 1.433 Test Acc: 0.589
Validation loss decreased (-0.566651 --> -0.588875).  Saving model ...
Epoch: 10 cost time: 1.1057524681091309
Epoch: 10, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.361 Vali Acc: 0.611 Test Loss: 1.361 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611098).  Saving model ...
Epoch: 11 cost time: 1.1839313507080078
Epoch: 11, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.297 Vali Acc: 0.600 Test Loss: 1.297 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3921709060668945
Epoch: 12, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.212 Vali Acc: 0.617 Test Loss: 1.212 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616655).  Saving model ...
Epoch: 13 cost time: 1.0695652961730957
Epoch: 13, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.126 Vali Acc: 0.622 Test Loss: 1.126 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622211).  Saving model ...
Epoch: 14 cost time: 1.268765926361084
Epoch: 14, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.056 Vali Acc: 0.639 Test Loss: 1.056 Test Acc: 0.639
Validation loss decreased (-0.622211 --> -0.638878).  Saving model ...
Epoch: 15 cost time: 1.2023186683654785
Epoch: 15, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.990 Vali Acc: 0.639 Test Loss: 0.990 Test Acc: 0.639
Validation loss decreased (-0.638878 --> -0.638879).  Saving model ...
Epoch: 16 cost time: 1.3083910942077637
Epoch: 16, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.933 Vali Acc: 0.656 Test Loss: 0.933 Test Acc: 0.656
Validation loss decreased (-0.638879 --> -0.655546).  Saving model ...
Epoch: 17 cost time: 1.1493282318115234
Epoch: 17, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.918 Vali Acc: 0.678 Test Loss: 0.918 Test Acc: 0.678
Validation loss decreased (-0.655546 --> -0.677769).  Saving model ...
Epoch: 18 cost time: 1.2331593036651611
Epoch: 18, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.894 Vali Acc: 0.672 Test Loss: 0.894 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2412505149841309
Epoch: 19, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.883 Vali Acc: 0.689 Test Loss: 0.883 Test Acc: 0.689
Validation loss decreased (-0.677769 --> -0.688880).  Saving model ...
Epoch: 20 cost time: 1.1353068351745605
Epoch: 20, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.857 Vali Acc: 0.706 Test Loss: 0.857 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705547).  Saving model ...
Epoch: 21 cost time: 1.1771318912506104
Epoch: 21, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.818 Vali Acc: 0.700 Test Loss: 0.818 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1519157886505127
Epoch: 22, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.824 Vali Acc: 0.706 Test Loss: 0.824 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 23 cost time: 1.281233787536621
Epoch: 23, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.817 Vali Acc: 0.706 Test Loss: 0.817 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 24 cost time: 1.2102835178375244
Epoch: 24, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 25 cost time: 1.1521084308624268
Epoch: 25, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 1.062342882156372
Epoch: 26, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 1.1727583408355713
Epoch: 27, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.811 Vali Acc: 0.756 Test Loss: 0.811 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.187413215637207
Epoch: 28, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.043499231338501
Epoch: 29, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.753 Vali Acc: 0.767 Test Loss: 0.753 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 30 cost time: 1.1818819046020508
Epoch: 30, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2195470333099365
Epoch: 31, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.792 Vali Acc: 0.767 Test Loss: 0.792 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1167669296264648
Epoch: 32, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.800 Vali Acc: 0.761 Test Loss: 0.800 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1380479335784912
Epoch: 33, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2621779441833496
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.804 Vali Acc: 0.767 Test Loss: 0.804 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.21502685546875
Epoch: 35, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.797 Vali Acc: 0.767 Test Loss: 0.797 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1738026142120361
Epoch: 36, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.822 Vali Acc: 0.767 Test Loss: 0.822 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2126390933990479
Epoch: 37, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2815830707550049
Epoch: 38, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1811954975128174
Epoch: 39, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm64_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 89999
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9881584644317627
Epoch: 1, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.614 Vali Acc: 0.106 Test Loss: 2.614 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.2458417415618896
Epoch: 2, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.265 Vali Acc: 0.339 Test Loss: 2.265 Test Acc: 0.339
Validation loss decreased (-0.105529 --> -0.338866).  Saving model ...
Epoch: 3 cost time: 1.1900694370269775
Epoch: 3, Steps: 12 | Train Loss: 2.133 Vali Loss: 1.957 Vali Acc: 0.450 Test Loss: 1.957 Test Acc: 0.450
Validation loss decreased (-0.338866 --> -0.449980).  Saving model ...
Epoch: 4 cost time: 1.0661365985870361
Epoch: 4, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.702 Vali Acc: 0.517 Test Loss: 1.702 Test Acc: 0.517
Validation loss decreased (-0.449980 --> -0.516650).  Saving model ...
Epoch: 5 cost time: 1.2957963943481445
Epoch: 5, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.479 Vali Acc: 0.583 Test Loss: 1.479 Test Acc: 0.583
Validation loss decreased (-0.516650 --> -0.583319).  Saving model ...
Epoch: 6 cost time: 1.0358319282531738
Epoch: 6, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.361 Vali Acc: 0.611 Test Loss: 1.361 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 1.2370047569274902
Epoch: 7, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.290 Vali Acc: 0.617 Test Loss: 1.290 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616654).  Saving model ...
Epoch: 8 cost time: 1.1170830726623535
Epoch: 8, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.230 Vali Acc: 0.644 Test Loss: 1.230 Test Acc: 0.644
Validation loss decreased (-0.616654 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 1.1865992546081543
Epoch: 9, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.188 Vali Acc: 0.667 Test Loss: 1.188 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 1.186527967453003
Epoch: 10, Steps: 12 | Train Loss: 0.703 Vali Loss: 1.171 Vali Acc: 0.656 Test Loss: 1.171 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1832315921783447
Epoch: 11, Steps: 12 | Train Loss: 0.620 Vali Loss: 1.078 Vali Acc: 0.672 Test Loss: 1.078 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 12 cost time: 1.121591567993164
Epoch: 12, Steps: 12 | Train Loss: 0.546 Vali Loss: 1.058 Vali Acc: 0.694 Test Loss: 1.058 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 13 cost time: 1.1820905208587646
Epoch: 13, Steps: 12 | Train Loss: 0.486 Vali Loss: 1.072 Vali Acc: 0.694 Test Loss: 1.072 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.206782579421997
Epoch: 14, Steps: 12 | Train Loss: 0.398 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
Validation loss decreased (-0.694434 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 1.154414415359497
Epoch: 15, Steps: 12 | Train Loss: 0.325 Vali Loss: 1.005 Vali Acc: 0.733 Test Loss: 1.005 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0709443092346191
Epoch: 16, Steps: 12 | Train Loss: 0.305 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0735337734222412
Epoch: 17, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.19704008102417
Epoch: 18, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.031 Vali Acc: 0.739 Test Loss: 1.031 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1082844734191895
Epoch: 19, Steps: 12 | Train Loss: 0.217 Vali Loss: 1.041 Vali Acc: 0.722 Test Loss: 1.041 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1480181217193604
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.078 Vali Acc: 0.722 Test Loss: 1.078 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.078528642654419
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.095 Vali Acc: 0.711 Test Loss: 1.095 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.094374179840088
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.114 Vali Acc: 0.733 Test Loss: 1.114 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1415441036224365
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.122 Vali Acc: 0.711 Test Loss: 1.122 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1691079139709473
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.185 Vali Acc: 0.711 Test Loss: 1.185 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 106415
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.734095573425293
Epoch: 1, Steps: 12 | Train Loss: 2.900 Vali Loss: 2.704 Vali Acc: 0.122 Test Loss: 2.704 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 1.2545359134674072
Epoch: 2, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.519 Vali Acc: 0.144 Test Loss: 2.519 Test Acc: 0.144
Validation loss decreased (-0.122195 --> -0.144419).  Saving model ...
Epoch: 3 cost time: 1.0687305927276611
Epoch: 3, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.288 Vali Acc: 0.250 Test Loss: 2.288 Test Acc: 0.250
Validation loss decreased (-0.144419 --> -0.249977).  Saving model ...
Epoch: 4 cost time: 1.0397014617919922
Epoch: 4, Steps: 12 | Train Loss: 2.290 Vali Loss: 2.050 Vali Acc: 0.383 Test Loss: 2.050 Test Acc: 0.383
Validation loss decreased (-0.249977 --> -0.383313).  Saving model ...
Epoch: 5 cost time: 0.9700143337249756
Epoch: 5, Steps: 12 | Train Loss: 2.001 Vali Loss: 1.840 Vali Acc: 0.422 Test Loss: 1.840 Test Acc: 0.422
Validation loss decreased (-0.383313 --> -0.422204).  Saving model ...
Epoch: 6 cost time: 1.1609106063842773
Epoch: 6, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.676 Vali Acc: 0.506 Test Loss: 1.676 Test Acc: 0.506
Validation loss decreased (-0.422204 --> -0.505539).  Saving model ...
Epoch: 7 cost time: 1.1590235233306885
Epoch: 7, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.549 Vali Acc: 0.511 Test Loss: 1.549 Test Acc: 0.511
Validation loss decreased (-0.505539 --> -0.511096).  Saving model ...
Epoch: 8 cost time: 1.1272006034851074
Epoch: 8, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.446 Vali Acc: 0.561 Test Loss: 1.446 Test Acc: 0.561
Validation loss decreased (-0.511096 --> -0.561097).  Saving model ...
Epoch: 9 cost time: 1.1142466068267822
Epoch: 9, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.389 Vali Acc: 0.583 Test Loss: 1.389 Test Acc: 0.583
Validation loss decreased (-0.561097 --> -0.583319).  Saving model ...
Epoch: 10 cost time: 1.0865988731384277
Epoch: 10, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.0955121517181396
Epoch: 11, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.267 Vali Acc: 0.650 Test Loss: 1.267 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649987).  Saving model ...
Epoch: 12 cost time: 1.1205716133117676
Epoch: 12, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.194 Vali Acc: 0.644 Test Loss: 1.194 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1588530540466309
Epoch: 13, Steps: 12 | Train Loss: 0.762 Vali Loss: 1.151 Vali Acc: 0.656 Test Loss: 1.151 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 1.0734038352966309
Epoch: 14, Steps: 12 | Train Loss: 0.733 Vali Loss: 1.149 Vali Acc: 0.656 Test Loss: 1.149 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 0.9424915313720703
Epoch: 15, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.093 Vali Acc: 0.678 Test Loss: 1.093 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677767).  Saving model ...
Epoch: 16 cost time: 1.0437040328979492
Epoch: 16, Steps: 12 | Train Loss: 0.561 Vali Loss: 1.032 Vali Acc: 0.711 Test Loss: 1.032 Test Acc: 0.711
Validation loss decreased (-0.677767 --> -0.711101).  Saving model ...
Epoch: 17 cost time: 1.0564813613891602
Epoch: 17, Steps: 12 | Train Loss: 0.493 Vali Loss: 1.026 Vali Acc: 0.700 Test Loss: 1.026 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2409062385559082
Epoch: 18, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.980 Vali Acc: 0.711 Test Loss: 0.980 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 19 cost time: 1.0165295600891113
Epoch: 19, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.960 Vali Acc: 0.722 Test Loss: 0.960 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 20 cost time: 1.1388049125671387
Epoch: 20, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.950 Vali Acc: 0.744 Test Loss: 0.950 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744435).  Saving model ...
Epoch: 21 cost time: 1.1095294952392578
Epoch: 21, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.964 Vali Acc: 0.722 Test Loss: 0.964 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.032392978668213
Epoch: 22, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 1.1499183177947998
Epoch: 23, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.924 Vali Acc: 0.744 Test Loss: 0.924 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0640532970428467
Epoch: 24, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1981840133666992
Epoch: 25, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.967 Vali Acc: 0.744 Test Loss: 0.967 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.074260950088501
Epoch: 26, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1088016033172607
Epoch: 27, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.958 Vali Acc: 0.739 Test Loss: 0.958 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0878632068634033
Epoch: 28, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.976 Vali Acc: 0.733 Test Loss: 0.976 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.00496506690979
Epoch: 29, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.993 Vali Acc: 0.756 Test Loss: 0.993 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755546).  Saving model ...
Epoch: 30 cost time: 1.1360809803009033
Epoch: 30, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.992 Vali Acc: 0.744 Test Loss: 0.992 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0770175457000732
Epoch: 31, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.026 Vali Acc: 0.756 Test Loss: 1.026 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0728938579559326
Epoch: 32, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.987 Vali Acc: 0.756 Test Loss: 0.987 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 33 cost time: 1.0919020175933838
Epoch: 33, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.047 Vali Acc: 0.756 Test Loss: 1.047 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3553788661956787
Epoch: 34, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.023 Vali Acc: 0.750 Test Loss: 1.023 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.439194917678833
Epoch: 35, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.030 Vali Acc: 0.750 Test Loss: 1.030 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4319140911102295
Epoch: 36, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.053 Vali Acc: 0.744 Test Loss: 1.053 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1636555194854736
Epoch: 37, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.060 Vali Acc: 0.772 Test Loss: 1.060 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772212).  Saving model ...
Epoch: 38 cost time: 1.3452863693237305
Epoch: 38, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.067 Vali Acc: 0.756 Test Loss: 1.067 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3585951328277588
Epoch: 39, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.072 Vali Acc: 0.756 Test Loss: 1.072 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3333003520965576
Epoch: 40, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.066 Vali Acc: 0.750 Test Loss: 1.066 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2928836345672607
Epoch: 41, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.113 Vali Acc: 0.739 Test Loss: 1.113 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2897703647613525
Epoch: 42, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.086 Vali Acc: 0.761 Test Loss: 1.086 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.3252341747283936
Epoch: 43, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.103 Vali Acc: 0.739 Test Loss: 1.103 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2326412200927734
Epoch: 44, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.100 Vali Acc: 0.750 Test Loss: 1.100 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4098362922668457
Epoch: 45, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.119 Vali Acc: 0.761 Test Loss: 1.119 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3117570877075195
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.112 Vali Acc: 0.761 Test Loss: 1.112 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1606063842773438
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.132 Vali Acc: 0.750 Test Loss: 1.132 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 85327
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7081682682037354
Epoch: 1, Steps: 12 | Train Loss: 2.861 Vali Loss: 2.734 Vali Acc: 0.067 Test Loss: 2.734 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.3935468196868896
Epoch: 2, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.501 Vali Acc: 0.200 Test Loss: 2.501 Test Acc: 0.200
Validation loss decreased (-0.066639 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 1.3910579681396484
Epoch: 3, Steps: 12 | Train Loss: 2.389 Vali Loss: 2.241 Vali Acc: 0.322 Test Loss: 2.241 Test Acc: 0.322
Validation loss decreased (-0.199975 --> -0.322200).  Saving model ...
Epoch: 4 cost time: 1.22385835647583
Epoch: 4, Steps: 12 | Train Loss: 2.079 Vali Loss: 1.998 Vali Acc: 0.428 Test Loss: 1.998 Test Acc: 0.428
Validation loss decreased (-0.322200 --> -0.427758).  Saving model ...
Epoch: 5 cost time: 1.2675042152404785
Epoch: 5, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.821 Vali Acc: 0.494 Test Loss: 1.821 Test Acc: 0.494
Validation loss decreased (-0.427758 --> -0.494426).  Saving model ...
Epoch: 6 cost time: 1.2732720375061035
Epoch: 6, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.656 Vali Acc: 0.511 Test Loss: 1.656 Test Acc: 0.511
Validation loss decreased (-0.494426 --> -0.511095).  Saving model ...
Epoch: 7 cost time: 1.3083162307739258
Epoch: 7, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.536 Vali Acc: 0.561 Test Loss: 1.536 Test Acc: 0.561
Validation loss decreased (-0.511095 --> -0.561096).  Saving model ...
Epoch: 8 cost time: 1.2284467220306396
Epoch: 8, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.468 Vali Acc: 0.572 Test Loss: 1.468 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 9 cost time: 1.1649909019470215
Epoch: 9, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.361 Vali Acc: 0.622 Test Loss: 1.361 Test Acc: 0.622
Validation loss decreased (-0.572208 --> -0.622209).  Saving model ...
Epoch: 10 cost time: 1.2757902145385742
Epoch: 10, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.288 Vali Acc: 0.617 Test Loss: 1.288 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0320067405700684
Epoch: 11, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.237 Vali Acc: 0.628 Test Loss: 1.237 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 12 cost time: 1.298215627670288
Epoch: 12, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.219 Vali Acc: 0.639 Test Loss: 1.219 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 13 cost time: 1.0702409744262695
Epoch: 13, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.162 Vali Acc: 0.656 Test Loss: 1.162 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 1.0390520095825195
Epoch: 14, Steps: 12 | Train Loss: 0.638 Vali Loss: 1.119 Vali Acc: 0.644 Test Loss: 1.119 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0777907371520996
Epoch: 15, Steps: 12 | Train Loss: 0.598 Vali Loss: 1.055 Vali Acc: 0.667 Test Loss: 1.055 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 1.1837620735168457
Epoch: 16, Steps: 12 | Train Loss: 0.535 Vali Loss: 1.013 Vali Acc: 0.683 Test Loss: 1.013 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683323).  Saving model ...
Epoch: 17 cost time: 1.1634202003479004
Epoch: 17, Steps: 12 | Train Loss: 0.505 Vali Loss: 1.020 Vali Acc: 0.661 Test Loss: 1.020 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1509342193603516
Epoch: 18, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.982 Vali Acc: 0.689 Test Loss: 0.982 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 19 cost time: 1.162691593170166
Epoch: 19, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.977 Vali Acc: 0.717 Test Loss: 0.977 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716657).  Saving model ...
Epoch: 20 cost time: 1.1634011268615723
Epoch: 20, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.971 Vali Acc: 0.711 Test Loss: 0.971 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2401838302612305
Epoch: 21, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.935 Vali Acc: 0.728 Test Loss: 0.935 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 22 cost time: 1.2098004817962646
Epoch: 22, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.941 Vali Acc: 0.728 Test Loss: 0.941 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0825307369232178
Epoch: 23, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.956 Vali Acc: 0.744 Test Loss: 0.956 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 24 cost time: 1.122129201889038
Epoch: 24, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.938 Vali Acc: 0.722 Test Loss: 0.938 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.220362663269043
Epoch: 25, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.951 Vali Acc: 0.739 Test Loss: 0.951 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2146375179290771
Epoch: 26, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.974 Vali Acc: 0.733 Test Loss: 0.974 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0561950206756592
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.949 Vali Acc: 0.761 Test Loss: 0.949 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761102).  Saving model ...
Epoch: 28 cost time: 1.2876076698303223
Epoch: 28, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.966 Vali Acc: 0.756 Test Loss: 0.966 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0869131088256836
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.976 Vali Acc: 0.767 Test Loss: 0.976 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766657).  Saving model ...
Epoch: 30 cost time: 1.166186809539795
Epoch: 30, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.012 Vali Acc: 0.733 Test Loss: 1.012 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2057387828826904
Epoch: 31, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.039 Vali Acc: 0.733 Test Loss: 1.039 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2138681411743164
Epoch: 32, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.015 Vali Acc: 0.750 Test Loss: 1.015 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2313454151153564
Epoch: 33, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.039 Vali Acc: 0.728 Test Loss: 1.039 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2733521461486816
Epoch: 34, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.031 Vali Acc: 0.767 Test Loss: 1.031 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.159959077835083
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.058 Vali Acc: 0.750 Test Loss: 1.058 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2481968402862549
Epoch: 36, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.037 Vali Acc: 0.761 Test Loss: 1.037 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2423338890075684
Epoch: 37, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.070 Vali Acc: 0.739 Test Loss: 1.070 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.15195894241333
Epoch: 38, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.099 Vali Acc: 0.750 Test Loss: 1.099 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.135617733001709
Epoch: 39, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.091 Vali Acc: 0.744 Test Loss: 1.091 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 84399
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0420544147491455
Epoch: 1, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.781 Vali Acc: 0.128 Test Loss: 2.781 Test Acc: 0.128
Validation loss decreased (inf --> -0.127750).  Saving model ...
Epoch: 2 cost time: 1.1287834644317627
Epoch: 2, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.604 Vali Acc: 0.133 Test Loss: 2.604 Test Acc: 0.133
Validation loss decreased (-0.127750 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 1.1325547695159912
Epoch: 3, Steps: 12 | Train Loss: 2.516 Vali Loss: 2.396 Vali Acc: 0.239 Test Loss: 2.396 Test Acc: 0.239
Validation loss decreased (-0.133307 --> -0.238865).  Saving model ...
Epoch: 4 cost time: 1.3284480571746826
Epoch: 4, Steps: 12 | Train Loss: 2.277 Vali Loss: 2.185 Vali Acc: 0.344 Test Loss: 2.185 Test Acc: 0.344
Validation loss decreased (-0.238865 --> -0.344423).  Saving model ...
Epoch: 5 cost time: 1.4518413543701172
Epoch: 5, Steps: 12 | Train Loss: 2.035 Vali Loss: 1.990 Vali Acc: 0.422 Test Loss: 1.990 Test Acc: 0.422
Validation loss decreased (-0.344423 --> -0.422202).  Saving model ...
Epoch: 6 cost time: 1.4717962741851807
Epoch: 6, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.827 Vali Acc: 0.467 Test Loss: 1.827 Test Acc: 0.467
Validation loss decreased (-0.422202 --> -0.466648).  Saving model ...
Epoch: 7 cost time: 1.5388681888580322
Epoch: 7, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.673 Vali Acc: 0.506 Test Loss: 1.673 Test Acc: 0.506
Validation loss decreased (-0.466648 --> -0.505539).  Saving model ...
Epoch: 8 cost time: 1.3106601238250732
Epoch: 8, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.561 Vali Acc: 0.550 Test Loss: 1.561 Test Acc: 0.550
Validation loss decreased (-0.505539 --> -0.549984).  Saving model ...
Epoch: 9 cost time: 1.2785899639129639
Epoch: 9, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.460 Vali Acc: 0.578 Test Loss: 1.460 Test Acc: 0.578
Validation loss decreased (-0.549984 --> -0.577763).  Saving model ...
Epoch: 10 cost time: 1.1997644901275635
Epoch: 10, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.395 Vali Acc: 0.589 Test Loss: 1.395 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 1.193577766418457
Epoch: 11, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.331 Vali Acc: 0.594 Test Loss: 1.331 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594431).  Saving model ...
Epoch: 12 cost time: 1.3618812561035156
Epoch: 12, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.257 Vali Acc: 0.633 Test Loss: 1.257 Test Acc: 0.633
Validation loss decreased (-0.594431 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 1.2455191612243652
Epoch: 13, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.228 Vali Acc: 0.617 Test Loss: 1.228 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.476508617401123
Epoch: 14, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.173 Vali Acc: 0.644 Test Loss: 1.173 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644433).  Saving model ...
Epoch: 15 cost time: 1.355422019958496
Epoch: 15, Steps: 12 | Train Loss: 0.734 Vali Loss: 1.112 Vali Acc: 0.672 Test Loss: 1.112 Test Acc: 0.672
Validation loss decreased (-0.644433 --> -0.672211).  Saving model ...
Epoch: 16 cost time: 1.3282480239868164
Epoch: 16, Steps: 12 | Train Loss: 0.719 Vali Loss: 1.074 Vali Acc: 0.672 Test Loss: 1.074 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 1.3020288944244385
Epoch: 17, Steps: 12 | Train Loss: 0.648 Vali Loss: 1.035 Vali Acc: 0.678 Test Loss: 1.035 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 18 cost time: 1.381160020828247
Epoch: 18, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.991 Vali Acc: 0.683 Test Loss: 0.991 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 19 cost time: 1.4607212543487549
Epoch: 19, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.964 Vali Acc: 0.694 Test Loss: 0.964 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 20 cost time: 1.185739278793335
Epoch: 20, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.976 Vali Acc: 0.706 Test Loss: 0.976 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705546).  Saving model ...
Epoch: 21 cost time: 1.3655335903167725
Epoch: 21, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.941 Vali Acc: 0.711 Test Loss: 0.941 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 22 cost time: 1.431516170501709
Epoch: 22, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.922 Vali Acc: 0.722 Test Loss: 0.922 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722213).  Saving model ...
Epoch: 23 cost time: 1.1156821250915527
Epoch: 23, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.892 Vali Acc: 0.728 Test Loss: 0.892 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 24 cost time: 1.1577043533325195
Epoch: 24, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.866 Vali Acc: 0.756 Test Loss: 0.866 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755547).  Saving model ...
Epoch: 25 cost time: 1.2642772197723389
Epoch: 25, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.874 Vali Acc: 0.756 Test Loss: 0.874 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.246396541595459
Epoch: 26, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.882 Vali Acc: 0.756 Test Loss: 0.882 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.12782621383667
Epoch: 27, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.887 Vali Acc: 0.728 Test Loss: 0.887 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2376782894134521
Epoch: 28, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3336267471313477
Epoch: 29, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2767536640167236
Epoch: 30, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.884 Vali Acc: 0.739 Test Loss: 0.884 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2444851398468018
Epoch: 31, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.878 Vali Acc: 0.739 Test Loss: 0.878 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.191504716873169
Epoch: 32, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.37550950050354
Epoch: 33, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.875 Vali Acc: 0.756 Test Loss: 0.875 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3200898170471191
Epoch: 34, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.905 Vali Acc: 0.733 Test Loss: 0.905 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 77711
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.789686441421509
Epoch: 1, Steps: 12 | Train Loss: 2.854 Vali Loss: 2.908 Vali Acc: 0.067 Test Loss: 2.908 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 1.207991123199463
Epoch: 2, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.770 Vali Acc: 0.106 Test Loss: 2.770 Test Acc: 0.106
Validation loss decreased (-0.066638 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 1.2718064785003662
Epoch: 3, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.581 Vali Acc: 0.172 Test Loss: 2.581 Test Acc: 0.172
Validation loss decreased (-0.105528 --> -0.172196).  Saving model ...
Epoch: 4 cost time: 1.1317081451416016
Epoch: 4, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.392 Vali Acc: 0.317 Test Loss: 2.392 Test Acc: 0.317
Validation loss decreased (-0.172196 --> -0.316643).  Saving model ...
Epoch: 5 cost time: 1.301382303237915
Epoch: 5, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.208 Vali Acc: 0.444 Test Loss: 2.208 Test Acc: 0.444
Validation loss decreased (-0.316643 --> -0.444422).  Saving model ...
Epoch: 6 cost time: 1.2937402725219727
Epoch: 6, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.031 Vali Acc: 0.506 Test Loss: 2.031 Test Acc: 0.506
Validation loss decreased (-0.444422 --> -0.505535).  Saving model ...
Epoch: 7 cost time: 1.1712226867675781
Epoch: 7, Steps: 12 | Train Loss: 1.915 Vali Loss: 1.882 Vali Acc: 0.500 Test Loss: 1.882 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1540679931640625
Epoch: 8, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.764 Vali Acc: 0.528 Test Loss: 1.764 Test Acc: 0.528
Validation loss decreased (-0.505535 --> -0.527760).  Saving model ...
Epoch: 9 cost time: 1.1493690013885498
Epoch: 9, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.648 Vali Acc: 0.533 Test Loss: 1.648 Test Acc: 0.533
Validation loss decreased (-0.527760 --> -0.533317).  Saving model ...
Epoch: 10 cost time: 1.3146007061004639
Epoch: 10, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.561 Vali Acc: 0.561 Test Loss: 1.561 Test Acc: 0.561
Validation loss decreased (-0.533317 --> -0.561095).  Saving model ...
Epoch: 11 cost time: 1.247697353363037
Epoch: 11, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.480 Vali Acc: 0.578 Test Loss: 1.480 Test Acc: 0.578
Validation loss decreased (-0.561095 --> -0.577763).  Saving model ...
Epoch: 12 cost time: 1.2742798328399658
Epoch: 12, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.399 Vali Acc: 0.594 Test Loss: 1.399 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594430).  Saving model ...
Epoch: 13 cost time: 1.2283437252044678
Epoch: 13, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.338 Vali Acc: 0.617 Test Loss: 1.338 Test Acc: 0.617
Validation loss decreased (-0.594430 --> -0.616653).  Saving model ...
Epoch: 14 cost time: 1.2537059783935547
Epoch: 14, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.293 Vali Acc: 0.617 Test Loss: 1.293 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 15 cost time: 1.1396656036376953
Epoch: 15, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.237 Vali Acc: 0.622 Test Loss: 1.237 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 16 cost time: 1.2376642227172852
Epoch: 16, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.172 Vali Acc: 0.650 Test Loss: 1.172 Test Acc: 0.650
Validation loss decreased (-0.622210 --> -0.649988).  Saving model ...
Epoch: 17 cost time: 1.2556192874908447
Epoch: 17, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.132 Vali Acc: 0.661 Test Loss: 1.132 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 18 cost time: 1.328813076019287
Epoch: 18, Steps: 12 | Train Loss: 0.696 Vali Loss: 1.087 Vali Acc: 0.661 Test Loss: 1.087 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661100).  Saving model ...
Epoch: 19 cost time: 1.190427541732788
Epoch: 19, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.028 Vali Acc: 0.706 Test Loss: 1.028 Test Acc: 0.706
Validation loss decreased (-0.661100 --> -0.705545).  Saving model ...
Epoch: 20 cost time: 1.2724425792694092
Epoch: 20, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.989 Vali Acc: 0.689 Test Loss: 0.989 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3071842193603516
Epoch: 21, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.959 Vali Acc: 0.706 Test Loss: 0.959 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705546).  Saving model ...
Epoch: 22 cost time: 1.194227933883667
Epoch: 22, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.926 Vali Acc: 0.694 Test Loss: 0.926 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2594823837280273
Epoch: 23, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 24 cost time: 1.1167585849761963
Epoch: 24, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.890 Vali Acc: 0.722 Test Loss: 0.890 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722213).  Saving model ...
Epoch: 25 cost time: 1.2806506156921387
Epoch: 25, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 26 cost time: 1.0042667388916016
Epoch: 26, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733325).  Saving model ...
Epoch: 27 cost time: 1.255089282989502
Epoch: 27, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.808 Vali Acc: 0.767 Test Loss: 0.808 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766659).  Saving model ...
Epoch: 28 cost time: 1.1890714168548584
Epoch: 28, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.808 Vali Acc: 0.744 Test Loss: 0.808 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4201018810272217
Epoch: 29, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.804 Vali Acc: 0.756 Test Loss: 0.804 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3718326091766357
Epoch: 30, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.207519769668579
Epoch: 31, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.780 Vali Acc: 0.767 Test Loss: 0.780 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 32 cost time: 1.3200733661651611
Epoch: 32, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.761 Vali Acc: 0.772 Test Loss: 0.761 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 33 cost time: 1.2179856300354004
Epoch: 33, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.778 Vali Acc: 0.756 Test Loss: 0.778 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.179239273071289
Epoch: 34, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.790 Vali Acc: 0.767 Test Loss: 0.790 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3867027759552002
Epoch: 35, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.765 Vali Acc: 0.767 Test Loss: 0.765 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2451555728912354
Epoch: 36, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.756 Vali Acc: 0.772 Test Loss: 0.756 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 37 cost time: 1.3372583389282227
Epoch: 37, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2433433532714844
Epoch: 38, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.759 Vali Acc: 0.767 Test Loss: 0.759 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2571241855621338
Epoch: 39, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.786 Vali Acc: 0.778 Test Loss: 0.786 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 40 cost time: 1.2485260963439941
Epoch: 40, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.791 Vali Acc: 0.756 Test Loss: 0.791 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0919194221496582
Epoch: 41, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.775 Vali Acc: 0.772 Test Loss: 0.775 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0168766975402832
Epoch: 42, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.781 Vali Acc: 0.772 Test Loss: 0.781 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2153956890106201
Epoch: 43, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.815 Vali Acc: 0.744 Test Loss: 0.815 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.240448236465454
Epoch: 44, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 45 cost time: 1.1917152404785156
Epoch: 45, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.784 Vali Acc: 0.767 Test Loss: 0.784 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3193750381469727
Epoch: 46, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.786 Vali Acc: 0.778 Test Loss: 0.786 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2573332786560059
Epoch: 47, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.780 Vali Acc: 0.761 Test Loss: 0.780 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2686409950256348
Epoch: 48, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.812 Vali Acc: 0.761 Test Loss: 0.812 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.191239833831787
Epoch: 49, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.806 Vali Acc: 0.772 Test Loss: 0.806 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1492383480072021
Epoch: 50, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.811 Vali Acc: 0.772 Test Loss: 0.811 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.4020566940307617
Epoch: 51, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.808 Vali Acc: 0.778 Test Loss: 0.808 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2364411354064941
Epoch: 52, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.799 Vali Acc: 0.789 Test Loss: 0.799 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788881).  Saving model ...
Epoch: 53 cost time: 1.3278107643127441
Epoch: 53, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.796 Vali Acc: 0.794 Test Loss: 0.796 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794436).  Saving model ...
Epoch: 54 cost time: 1.0582411289215088
Epoch: 54, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.816 Vali Acc: 0.772 Test Loss: 0.816 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.177668571472168
Epoch: 55, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.817 Vali Acc: 0.783 Test Loss: 0.817 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.3311753273010254
Epoch: 56, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.828 Vali Acc: 0.778 Test Loss: 0.828 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1321425437927246
Epoch: 57, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.850 Vali Acc: 0.767 Test Loss: 0.850 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.4228498935699463
Epoch: 58, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.815 Vali Acc: 0.778 Test Loss: 0.815 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1845295429229736
Epoch: 59, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.833 Vali Acc: 0.783 Test Loss: 0.833 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.174842357635498
Epoch: 60, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.870 Vali Acc: 0.778 Test Loss: 0.870 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.208188772201538
Epoch: 61, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.863 Vali Acc: 0.783 Test Loss: 0.863 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.2745599746704102
Epoch: 62, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.847 Vali Acc: 0.794 Test Loss: 0.847 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.360625982284546
Epoch: 63, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.814 Vali Acc: 0.800 Test Loss: 0.814 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799992).  Saving model ...
Epoch: 64 cost time: 1.3352117538452148
Epoch: 64, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.851 Vali Acc: 0.783 Test Loss: 0.851 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.4572420120239258
Epoch: 65, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.857 Vali Acc: 0.794 Test Loss: 0.857 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.331789255142212
Epoch: 66, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.858 Vali Acc: 0.794 Test Loss: 0.858 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.2661373615264893
Epoch: 67, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.859 Vali Acc: 0.806 Test Loss: 0.859 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805547).  Saving model ...
Epoch: 68 cost time: 1.2973484992980957
Epoch: 68, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.874 Vali Acc: 0.789 Test Loss: 0.874 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2034881114959717
Epoch: 69, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.852 Vali Acc: 0.800 Test Loss: 0.852 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.4902572631835938
Epoch: 70, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.833 Vali Acc: 0.806 Test Loss: 0.833 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805547).  Saving model ...
Epoch: 71 cost time: 1.1525957584381104
Epoch: 71, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.880 Vali Acc: 0.794 Test Loss: 0.880 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.4232730865478516
Epoch: 72, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.899 Vali Acc: 0.783 Test Loss: 0.899 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.3576130867004395
Epoch: 73, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.870 Vali Acc: 0.794 Test Loss: 0.870 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.2114827632904053
Epoch: 74, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.868 Vali Acc: 0.800 Test Loss: 0.868 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.137284755706787
Epoch: 75, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.903 Vali Acc: 0.778 Test Loss: 0.903 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.2540876865386963
Epoch: 76, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.922 Vali Acc: 0.789 Test Loss: 0.922 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.2959675788879395
Epoch: 77, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.948 Vali Acc: 0.778 Test Loss: 0.948 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.3138446807861328
Epoch: 78, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.938 Vali Acc: 0.778 Test Loss: 0.938 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.3547613620758057
Epoch: 79, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.905 Vali Acc: 0.772 Test Loss: 0.905 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.3602559566497803
Epoch: 80, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.903 Vali Acc: 0.778 Test Loss: 0.903 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 73935
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.498854398727417
Epoch: 1, Steps: 12 | Train Loss: 2.837 Vali Loss: 2.721 Vali Acc: 0.078 Test Loss: 2.721 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 1.0743064880371094
Epoch: 2, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.613 Vali Acc: 0.161 Test Loss: 2.613 Test Acc: 0.161
Validation loss decreased (-0.077751 --> -0.161085).  Saving model ...
Epoch: 3 cost time: 1.2863528728485107
Epoch: 3, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.475 Vali Acc: 0.244 Test Loss: 2.475 Test Acc: 0.244
Validation loss decreased (-0.161085 --> -0.244420).  Saving model ...
Epoch: 4 cost time: 1.2775075435638428
Epoch: 4, Steps: 12 | Train Loss: 2.436 Vali Loss: 2.312 Vali Acc: 0.339 Test Loss: 2.312 Test Acc: 0.339
Validation loss decreased (-0.244420 --> -0.338866).  Saving model ...
Epoch: 5 cost time: 1.2434799671173096
Epoch: 5, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.148 Vali Acc: 0.411 Test Loss: 2.148 Test Acc: 0.411
Validation loss decreased (-0.338866 --> -0.411090).  Saving model ...
Epoch: 6 cost time: 1.295806884765625
Epoch: 6, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.008 Vali Acc: 0.494 Test Loss: 2.008 Test Acc: 0.494
Validation loss decreased (-0.411090 --> -0.494424).  Saving model ...
Epoch: 7 cost time: 1.2270174026489258
Epoch: 7, Steps: 12 | Train Loss: 1.983 Vali Loss: 1.870 Vali Acc: 0.500 Test Loss: 1.870 Test Acc: 0.500
Validation loss decreased (-0.494424 --> -0.499981).  Saving model ...
Epoch: 8 cost time: 1.3381907939910889
Epoch: 8, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.752 Vali Acc: 0.517 Test Loss: 1.752 Test Acc: 0.517
Validation loss decreased (-0.499981 --> -0.516649).  Saving model ...
Epoch: 9 cost time: 1.262373447418213
Epoch: 9, Steps: 12 | Train Loss: 1.727 Vali Loss: 1.643 Vali Acc: 0.556 Test Loss: 1.643 Test Acc: 0.556
Validation loss decreased (-0.516649 --> -0.555539).  Saving model ...
Epoch: 10 cost time: 1.1340007781982422
Epoch: 10, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.559 Vali Acc: 0.572 Test Loss: 1.559 Test Acc: 0.572
Validation loss decreased (-0.555539 --> -0.572207).  Saving model ...
Epoch: 11 cost time: 1.1561121940612793
Epoch: 11, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.479 Vali Acc: 0.572 Test Loss: 1.479 Test Acc: 0.572
Validation loss decreased (-0.572207 --> -0.572207).  Saving model ...
Epoch: 12 cost time: 1.3024895191192627
Epoch: 12, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.384 Vali Acc: 0.600 Test Loss: 1.384 Test Acc: 0.600
Validation loss decreased (-0.572207 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 1.3455591201782227
Epoch: 13, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.314 Vali Acc: 0.617 Test Loss: 1.314 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 14 cost time: 1.201993465423584
Epoch: 14, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.250 Vali Acc: 0.650 Test Loss: 1.250 Test Acc: 0.650
Validation loss decreased (-0.616654 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 1.2730748653411865
Epoch: 15, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.173 Vali Acc: 0.644 Test Loss: 1.173 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0917940139770508
Epoch: 16, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.123 Vali Acc: 0.661 Test Loss: 1.123 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 17 cost time: 1.358790636062622
Epoch: 17, Steps: 12 | Train Loss: 0.825 Vali Loss: 1.075 Vali Acc: 0.650 Test Loss: 1.075 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.095823049545288
Epoch: 18, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.015 Vali Acc: 0.672 Test Loss: 1.015 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 19 cost time: 1.1821177005767822
Epoch: 19, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.996 Vali Acc: 0.667 Test Loss: 0.996 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1824874877929688
Epoch: 20, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.959 Vali Acc: 0.694 Test Loss: 0.959 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694435).  Saving model ...
Epoch: 21 cost time: 1.5008893013000488
Epoch: 21, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.947 Vali Acc: 0.683 Test Loss: 0.947 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2445316314697266
Epoch: 22, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.906 Vali Acc: 0.700 Test Loss: 0.906 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 23 cost time: 1.1730470657348633
Epoch: 23, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.896 Vali Acc: 0.683 Test Loss: 0.896 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.120819330215454
Epoch: 24, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.852 Vali Acc: 0.717 Test Loss: 0.852 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 25 cost time: 1.156867504119873
Epoch: 25, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.831 Vali Acc: 0.739 Test Loss: 0.831 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 26 cost time: 1.4621927738189697
Epoch: 26, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.840 Vali Acc: 0.722 Test Loss: 0.840 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.194256067276001
Epoch: 27, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2661590576171875
Epoch: 28, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.808 Vali Acc: 0.706 Test Loss: 0.808 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1779229640960693
Epoch: 29, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.803 Vali Acc: 0.722 Test Loss: 0.803 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1884067058563232
Epoch: 30, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.797 Vali Acc: 0.744 Test Loss: 0.797 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744436).  Saving model ...
Epoch: 31 cost time: 1.1852891445159912
Epoch: 31, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.792 Vali Acc: 0.739 Test Loss: 0.792 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0874764919281006
Epoch: 32, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.776 Vali Acc: 0.744 Test Loss: 0.776 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 33 cost time: 1.1415019035339355
Epoch: 33, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.150801181793213
Epoch: 34, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.769 Vali Acc: 0.744 Test Loss: 0.769 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 35 cost time: 1.296382188796997
Epoch: 35, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.752 Vali Acc: 0.761 Test Loss: 0.752 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761104).  Saving model ...
Epoch: 36 cost time: 1.2003469467163086
Epoch: 36, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.777 Vali Acc: 0.761 Test Loss: 0.777 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2605617046356201
Epoch: 37, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.787 Vali Acc: 0.739 Test Loss: 0.787 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.219266414642334
Epoch: 38, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.769 Vali Acc: 0.750 Test Loss: 0.769 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.319673776626587
Epoch: 39, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.752 Vali Acc: 0.750 Test Loss: 0.752 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2210137844085693
Epoch: 40, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.778 Vali Acc: 0.761 Test Loss: 0.778 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1619417667388916
Epoch: 41, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.783 Vali Acc: 0.767 Test Loss: 0.783 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 42 cost time: 1.2774906158447266
Epoch: 42, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.750 Vali Acc: 0.767 Test Loss: 0.750 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 43 cost time: 1.295929193496704
Epoch: 43, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.748 Vali Acc: 0.772 Test Loss: 0.748 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 44 cost time: 1.2197167873382568
Epoch: 44, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 45 cost time: 1.2033069133758545
Epoch: 45, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2349767684936523
Epoch: 46, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.294182300567627
Epoch: 47, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.774 Vali Acc: 0.767 Test Loss: 0.774 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2425882816314697
Epoch: 48, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.780 Vali Acc: 0.756 Test Loss: 0.780 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2810041904449463
Epoch: 49, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.786 Vali Acc: 0.767 Test Loss: 0.786 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1073787212371826
Epoch: 50, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.808 Vali Acc: 0.756 Test Loss: 0.808 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0466532707214355
Epoch: 51, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.797 Vali Acc: 0.756 Test Loss: 0.797 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.1571097373962402
Epoch: 52, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.797 Vali Acc: 0.744 Test Loss: 0.797 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.2346851825714111
Epoch: 53, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.803 Vali Acc: 0.744 Test Loss: 0.803 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.2237792015075684
Epoch: 54, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.808 Vali Acc: 0.744 Test Loss: 0.808 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 72079
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7257049083709717
Epoch: 1, Steps: 12 | Train Loss: 2.982 Vali Loss: 2.838 Vali Acc: 0.028 Test Loss: 2.838 Test Acc: 0.028
Validation loss decreased (inf --> -0.027749).  Saving model ...
Epoch: 2 cost time: 1.032470464706421
Epoch: 2, Steps: 12 | Train Loss: 2.883 Vali Loss: 2.748 Vali Acc: 0.050 Test Loss: 2.748 Test Acc: 0.050
Validation loss decreased (-0.027749 --> -0.049973).  Saving model ...
Epoch: 3 cost time: 1.077573537826538
Epoch: 3, Steps: 12 | Train Loss: 2.777 Vali Loss: 2.617 Vali Acc: 0.133 Test Loss: 2.617 Test Acc: 0.133
Validation loss decreased (-0.049973 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 1.2676591873168945
Epoch: 4, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.471 Vali Acc: 0.267 Test Loss: 2.471 Test Acc: 0.267
Validation loss decreased (-0.133307 --> -0.266642).  Saving model ...
Epoch: 5 cost time: 1.1273972988128662
Epoch: 5, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.328 Vali Acc: 0.333 Test Loss: 2.328 Test Acc: 0.333
Validation loss decreased (-0.266642 --> -0.333310).  Saving model ...
Epoch: 6 cost time: 1.133329153060913
Epoch: 6, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.176 Vali Acc: 0.367 Test Loss: 2.176 Test Acc: 0.367
Validation loss decreased (-0.333310 --> -0.366645).  Saving model ...
Epoch: 7 cost time: 1.1025278568267822
Epoch: 7, Steps: 12 | Train Loss: 2.061 Vali Loss: 2.044 Vali Acc: 0.400 Test Loss: 2.044 Test Acc: 0.400
Validation loss decreased (-0.366645 --> -0.399980).  Saving model ...
Epoch: 8 cost time: 0.9944307804107666
Epoch: 8, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.919 Vali Acc: 0.428 Test Loss: 1.919 Test Acc: 0.428
Validation loss decreased (-0.399980 --> -0.427759).  Saving model ...
Epoch: 9 cost time: 1.1708979606628418
Epoch: 9, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.812 Vali Acc: 0.472 Test Loss: 1.812 Test Acc: 0.472
Validation loss decreased (-0.427759 --> -0.472204).  Saving model ...
Epoch: 10 cost time: 1.0657310485839844
Epoch: 10, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.706 Vali Acc: 0.483 Test Loss: 1.706 Test Acc: 0.483
Validation loss decreased (-0.472204 --> -0.483316).  Saving model ...
Epoch: 11 cost time: 1.0944840908050537
Epoch: 11, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.612 Vali Acc: 0.500 Test Loss: 1.612 Test Acc: 0.500
Validation loss decreased (-0.483316 --> -0.499984).  Saving model ...
Epoch: 12 cost time: 1.157942295074463
Epoch: 12, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.518 Vali Acc: 0.511 Test Loss: 1.518 Test Acc: 0.511
Validation loss decreased (-0.499984 --> -0.511096).  Saving model ...
Epoch: 13 cost time: 1.0607638359069824
Epoch: 13, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.434 Vali Acc: 0.561 Test Loss: 1.434 Test Acc: 0.561
Validation loss decreased (-0.511096 --> -0.561097).  Saving model ...
Epoch: 14 cost time: 1.2741546630859375
Epoch: 14, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.348 Vali Acc: 0.589 Test Loss: 1.348 Test Acc: 0.589
Validation loss decreased (-0.561097 --> -0.588875).  Saving model ...
Epoch: 15 cost time: 1.1122443675994873
Epoch: 15, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.278 Vali Acc: 0.606 Test Loss: 1.278 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605543).  Saving model ...
Epoch: 16 cost time: 1.154104471206665
Epoch: 16, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.192 Vali Acc: 0.611 Test Loss: 1.192 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611099).  Saving model ...
Epoch: 17 cost time: 1.2133512496948242
Epoch: 17, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.139 Vali Acc: 0.617 Test Loss: 1.139 Test Acc: 0.617
Validation loss decreased (-0.611099 --> -0.616655).  Saving model ...
Epoch: 18 cost time: 1.1867976188659668
Epoch: 18, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.093 Vali Acc: 0.633 Test Loss: 1.093 Test Acc: 0.633
Validation loss decreased (-0.616655 --> -0.633322).  Saving model ...
Epoch: 19 cost time: 1.2499234676361084
Epoch: 19, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.048 Vali Acc: 0.639 Test Loss: 1.048 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638878).  Saving model ...
Epoch: 20 cost time: 1.099313735961914
Epoch: 20, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.005 Vali Acc: 0.628 Test Loss: 1.005 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1785914897918701
Epoch: 21, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.976 Vali Acc: 0.650 Test Loss: 0.976 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649990).  Saving model ...
Epoch: 22 cost time: 1.1934165954589844
Epoch: 22, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.965 Vali Acc: 0.656 Test Loss: 0.965 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 23 cost time: 1.195190191268921
Epoch: 23, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.936 Vali Acc: 0.661 Test Loss: 0.936 Test Acc: 0.661
Validation loss decreased (-0.655546 --> -0.661102).  Saving model ...
Epoch: 24 cost time: 1.2116127014160156
Epoch: 24, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.916 Vali Acc: 0.678 Test Loss: 0.916 Test Acc: 0.678
Validation loss decreased (-0.661102 --> -0.677769).  Saving model ...
Epoch: 25 cost time: 1.0693628787994385
Epoch: 25, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.887 Vali Acc: 0.672 Test Loss: 0.887 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1224644184112549
Epoch: 26, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.874 Vali Acc: 0.683 Test Loss: 0.874 Test Acc: 0.683
Validation loss decreased (-0.677769 --> -0.683325).  Saving model ...
Epoch: 27 cost time: 1.15268874168396
Epoch: 27, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.843 Vali Acc: 0.706 Test Loss: 0.843 Test Acc: 0.706
Validation loss decreased (-0.683325 --> -0.705547).  Saving model ...
Epoch: 28 cost time: 1.0485374927520752
Epoch: 28, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.832 Vali Acc: 0.706 Test Loss: 0.832 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 29 cost time: 1.0530085563659668
Epoch: 29, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.824 Vali Acc: 0.728 Test Loss: 0.824 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 30 cost time: 1.057232141494751
Epoch: 30, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.807 Vali Acc: 0.722 Test Loss: 0.807 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1402356624603271
Epoch: 31, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.814 Vali Acc: 0.733 Test Loss: 0.814 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733325).  Saving model ...
Epoch: 32 cost time: 1.3077576160430908
Epoch: 32, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.795 Vali Acc: 0.728 Test Loss: 0.795 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0799708366394043
Epoch: 33, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.779 Vali Acc: 0.739 Test Loss: 0.779 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 34 cost time: 1.123701572418213
Epoch: 34, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.778 Vali Acc: 0.739 Test Loss: 0.778 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 35 cost time: 1.1648461818695068
Epoch: 35, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.774 Vali Acc: 0.761 Test Loss: 0.774 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761103).  Saving model ...
Epoch: 36 cost time: 1.146735429763794
Epoch: 36, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.184194803237915
Epoch: 37, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.764 Vali Acc: 0.750 Test Loss: 0.764 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1477952003479004
Epoch: 38, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1637322902679443
Epoch: 39, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.765 Vali Acc: 0.744 Test Loss: 0.765 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1815755367279053
Epoch: 40, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.761 Vali Acc: 0.739 Test Loss: 0.761 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0531339645385742
Epoch: 41, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.079620122909546
Epoch: 42, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.737 Vali Acc: 0.750 Test Loss: 0.737 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0985543727874756
Epoch: 43, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.751 Vali Acc: 0.750 Test Loss: 0.751 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9843785762786865
Epoch: 44, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.749 Vali Acc: 0.750 Test Loss: 0.749 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3179967403411865
Epoch: 45, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.734 Vali Acc: 0.761 Test Loss: 0.734 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761104).  Saving model ...
Epoch: 46 cost time: 1.1914844512939453
Epoch: 46, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.723 Vali Acc: 0.772 Test Loss: 0.723 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 47 cost time: 1.0946552753448486
Epoch: 47, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.733 Vali Acc: 0.756 Test Loss: 0.733 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1270568370819092
Epoch: 48, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.717 Vali Acc: 0.767 Test Loss: 0.717 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1152622699737549
Epoch: 49, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.743 Vali Acc: 0.767 Test Loss: 0.743 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2665941715240479
Epoch: 50, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 51 cost time: 1.0061087608337402
Epoch: 51, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.758 Vali Acc: 0.772 Test Loss: 0.758 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2153880596160889
Epoch: 52, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.748 Vali Acc: 0.772 Test Loss: 0.748 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0449671745300293
Epoch: 53, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.738 Vali Acc: 0.767 Test Loss: 0.738 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1357691287994385
Epoch: 54, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.760 Vali Acc: 0.761 Test Loss: 0.760 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0376701354980469
Epoch: 55, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.757 Vali Acc: 0.778 Test Loss: 0.757 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.0487983226776123
Epoch: 56, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.772 Vali Acc: 0.767 Test Loss: 0.772 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.9983315467834473
Epoch: 57, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1236164569854736
Epoch: 58, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.755 Vali Acc: 0.767 Test Loss: 0.755 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.9764206409454346
Epoch: 59, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.2927420139312744
Epoch: 60, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.731 Vali Acc: 0.772 Test Loss: 0.731 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 70255
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.11514949798584
Epoch: 1, Steps: 12 | Train Loss: 2.847 Vali Loss: 2.588 Vali Acc: 0.111 Test Loss: 2.588 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 1.1652803421020508
Epoch: 2, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.241 Vali Acc: 0.350 Test Loss: 2.241 Test Acc: 0.350
Validation loss decreased (-0.111085 --> -0.349978).  Saving model ...
Epoch: 3 cost time: 1.2290825843811035
Epoch: 3, Steps: 12 | Train Loss: 2.122 Vali Loss: 1.945 Vali Acc: 0.467 Test Loss: 1.945 Test Acc: 0.467
Validation loss decreased (-0.349978 --> -0.466647).  Saving model ...
Epoch: 4 cost time: 1.1661646366119385
Epoch: 4, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.699 Vali Acc: 0.533 Test Loss: 1.699 Test Acc: 0.533
Validation loss decreased (-0.466647 --> -0.533316).  Saving model ...
Epoch: 5 cost time: 1.2285094261169434
Epoch: 5, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.541 Vali Acc: 0.544 Test Loss: 1.541 Test Acc: 0.544
Validation loss decreased (-0.533316 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 1.2502942085266113
Epoch: 6, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.390 Vali Acc: 0.622 Test Loss: 1.390 Test Acc: 0.622
Validation loss decreased (-0.544429 --> -0.622208).  Saving model ...
Epoch: 7 cost time: 1.1830546855926514
Epoch: 7, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.356 Vali Acc: 0.600 Test Loss: 1.356 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2667217254638672
Epoch: 8, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.262 Vali Acc: 0.644 Test Loss: 1.262 Test Acc: 0.644
Validation loss decreased (-0.622208 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 1.1499028205871582
Epoch: 9, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.218 Vali Acc: 0.644 Test Loss: 1.218 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 10 cost time: 1.208444356918335
Epoch: 10, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.152 Vali Acc: 0.678 Test Loss: 1.152 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677766).  Saving model ...
Epoch: 11 cost time: 1.2956702709197998
Epoch: 11, Steps: 12 | Train Loss: 0.638 Vali Loss: 1.131 Vali Acc: 0.678 Test Loss: 1.131 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 1.2031128406524658
Epoch: 12, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.088 Vali Acc: 0.683 Test Loss: 1.088 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683322).  Saving model ...
Epoch: 13 cost time: 1.1549644470214844
Epoch: 13, Steps: 12 | Train Loss: 0.527 Vali Loss: 1.043 Vali Acc: 0.717 Test Loss: 1.043 Test Acc: 0.717
Validation loss decreased (-0.683322 --> -0.716656).  Saving model ...
Epoch: 14 cost time: 1.2034809589385986
Epoch: 14, Steps: 12 | Train Loss: 0.440 Vali Loss: 1.026 Vali Acc: 0.706 Test Loss: 1.026 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2844719886779785
Epoch: 15, Steps: 12 | Train Loss: 0.400 Vali Loss: 1.020 Vali Acc: 0.694 Test Loss: 1.020 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.152508020401001
Epoch: 16, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.971 Vali Acc: 0.739 Test Loss: 0.971 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738879).  Saving model ...
Epoch: 17 cost time: 1.04563307762146
Epoch: 17, Steps: 12 | Train Loss: 0.272 Vali Loss: 1.045 Vali Acc: 0.722 Test Loss: 1.045 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0940423011779785
Epoch: 18, Steps: 12 | Train Loss: 0.263 Vali Loss: 1.028 Vali Acc: 0.744 Test Loss: 1.028 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744434).  Saving model ...
Epoch: 19 cost time: 1.1565780639648438
Epoch: 19, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.036 Vali Acc: 0.733 Test Loss: 1.036 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1808879375457764
Epoch: 20, Steps: 12 | Train Loss: 0.173 Vali Loss: 1.058 Vali Acc: 0.739 Test Loss: 1.058 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1878256797790527
Epoch: 21, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.080 Vali Acc: 0.744 Test Loss: 1.080 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3184916973114014
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.115 Vali Acc: 0.711 Test Loss: 1.115 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.306194543838501
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.144 Vali Acc: 0.733 Test Loss: 1.144 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.246098279953003
Epoch: 24, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.148 Vali Acc: 0.728 Test Loss: 1.148 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4153265953063965
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.207 Vali Acc: 0.722 Test Loss: 1.207 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2582802772521973
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.162 Vali Acc: 0.761 Test Loss: 1.162 Test Acc: 0.761
Validation loss decreased (-0.744434 --> -0.761099).  Saving model ...
Epoch: 27 cost time: 1.3080809116363525
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.208 Vali Acc: 0.711 Test Loss: 1.208 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.128286361694336
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.215 Vali Acc: 0.750 Test Loss: 1.215 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1057755947113037
Epoch: 29, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.291 Vali Acc: 0.694 Test Loss: 1.291 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0978610515594482
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.249 Vali Acc: 0.739 Test Loss: 1.249 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1680810451507568
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.259 Vali Acc: 0.744 Test Loss: 1.259 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9818727970123291
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.293 Vali Acc: 0.750 Test Loss: 1.293 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0943443775177002
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.336 Vali Acc: 0.739 Test Loss: 1.336 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1588809490203857
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.339 Vali Acc: 0.744 Test Loss: 1.339 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.140113353729248
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.361 Vali Acc: 0.728 Test Loss: 1.361 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2696826457977295
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.344 Vali Acc: 0.761 Test Loss: 1.344 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 81455
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6613354682922363
Epoch: 1, Steps: 12 | Train Loss: 2.793 Vali Loss: 2.666 Vali Acc: 0.117 Test Loss: 2.666 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.2293384075164795
Epoch: 2, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.468 Vali Acc: 0.239 Test Loss: 2.468 Test Acc: 0.239
Validation loss decreased (-0.116640 --> -0.238864).  Saving model ...
Epoch: 3 cost time: 1.0787956714630127
Epoch: 3, Steps: 12 | Train Loss: 2.443 Vali Loss: 2.236 Vali Acc: 0.339 Test Loss: 2.236 Test Acc: 0.339
Validation loss decreased (-0.238864 --> -0.338867).  Saving model ...
Epoch: 4 cost time: 1.2025933265686035
Epoch: 4, Steps: 12 | Train Loss: 2.175 Vali Loss: 2.020 Vali Acc: 0.483 Test Loss: 2.020 Test Acc: 0.483
Validation loss decreased (-0.338867 --> -0.483313).  Saving model ...
Epoch: 5 cost time: 1.080270767211914
Epoch: 5, Steps: 12 | Train Loss: 1.952 Vali Loss: 1.840 Vali Acc: 0.517 Test Loss: 1.840 Test Acc: 0.517
Validation loss decreased (-0.483313 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 1.116023063659668
Epoch: 6, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.700 Vali Acc: 0.550 Test Loss: 1.700 Test Acc: 0.550
Validation loss decreased (-0.516648 --> -0.549983).  Saving model ...
Epoch: 7 cost time: 1.1683893203735352
Epoch: 7, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.571 Vali Acc: 0.556 Test Loss: 1.571 Test Acc: 0.556
Validation loss decreased (-0.549983 --> -0.555540).  Saving model ...
Epoch: 8 cost time: 1.184575080871582
Epoch: 8, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.491 Vali Acc: 0.594 Test Loss: 1.491 Test Acc: 0.594
Validation loss decreased (-0.555540 --> -0.594430).  Saving model ...
Epoch: 9 cost time: 1.2151439189910889
Epoch: 9, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.423 Vali Acc: 0.578 Test Loss: 1.423 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.241830825805664
Epoch: 10, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.345 Vali Acc: 0.611 Test Loss: 1.345 Test Acc: 0.611
Validation loss decreased (-0.594430 --> -0.611098).  Saving model ...
Epoch: 11 cost time: 1.2652654647827148
Epoch: 11, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.295 Vali Acc: 0.622 Test Loss: 1.295 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 12 cost time: 1.247049331665039
Epoch: 12, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.237 Vali Acc: 0.628 Test Loss: 1.237 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 1.2596614360809326
Epoch: 13, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.204 Vali Acc: 0.628 Test Loss: 1.204 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627766).  Saving model ...
Epoch: 14 cost time: 1.3043029308319092
Epoch: 14, Steps: 12 | Train Loss: 0.730 Vali Loss: 1.180 Vali Acc: 0.661 Test Loss: 1.180 Test Acc: 0.661
Validation loss decreased (-0.627766 --> -0.661099).  Saving model ...
Epoch: 15 cost time: 1.2487101554870605
Epoch: 15, Steps: 12 | Train Loss: 0.725 Vali Loss: 1.155 Vali Acc: 0.650 Test Loss: 1.155 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2681281566619873
Epoch: 16, Steps: 12 | Train Loss: 0.637 Vali Loss: 1.113 Vali Acc: 0.678 Test Loss: 1.113 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 17 cost time: 1.2507576942443848
Epoch: 17, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.048 Vali Acc: 0.678 Test Loss: 1.048 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 18 cost time: 1.0775387287139893
Epoch: 18, Steps: 12 | Train Loss: 0.539 Vali Loss: 1.051 Vali Acc: 0.683 Test Loss: 1.051 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 19 cost time: 1.0926029682159424
Epoch: 19, Steps: 12 | Train Loss: 0.435 Vali Loss: 1.011 Vali Acc: 0.711 Test Loss: 1.011 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 20 cost time: 1.2300267219543457
Epoch: 20, Steps: 12 | Train Loss: 0.445 Vali Loss: 1.020 Vali Acc: 0.694 Test Loss: 1.020 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0383784770965576
Epoch: 21, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.994 Vali Acc: 0.717 Test Loss: 0.994 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 22 cost time: 1.1301665306091309
Epoch: 22, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.970 Vali Acc: 0.717 Test Loss: 0.970 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 23 cost time: 1.1243839263916016
Epoch: 23, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.974 Vali Acc: 0.739 Test Loss: 0.974 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738879).  Saving model ...
Epoch: 24 cost time: 1.1830692291259766
Epoch: 24, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.987 Vali Acc: 0.717 Test Loss: 0.987 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1833837032318115
Epoch: 25, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.974 Vali Acc: 0.733 Test Loss: 0.974 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2397022247314453
Epoch: 26, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.956 Vali Acc: 0.739 Test Loss: 0.956 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 27 cost time: 1.2880244255065918
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.982 Vali Acc: 0.717 Test Loss: 0.982 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2002477645874023
Epoch: 28, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.981 Vali Acc: 0.744 Test Loss: 0.981 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 29 cost time: 1.125304937362671
Epoch: 29, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1994035243988037
Epoch: 30, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1937341690063477
Epoch: 31, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.993 Vali Acc: 0.733 Test Loss: 0.993 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0786638259887695
Epoch: 32, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.046 Vali Acc: 0.733 Test Loss: 1.046 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1608307361602783
Epoch: 33, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.027 Vali Acc: 0.722 Test Loss: 1.027 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2326891422271729
Epoch: 34, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.020 Vali Acc: 0.733 Test Loss: 1.020 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1472840309143066
Epoch: 35, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2019245624542236
Epoch: 36, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.020 Vali Acc: 0.733 Test Loss: 1.020 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3302512168884277
Epoch: 37, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.030 Vali Acc: 0.750 Test Loss: 1.030 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 38 cost time: 1.1392700672149658
Epoch: 38, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.057 Vali Acc: 0.739 Test Loss: 1.057 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.145714282989502
Epoch: 39, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.066 Vali Acc: 0.750 Test Loss: 1.066 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.163583517074585
Epoch: 40, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.094 Vali Acc: 0.739 Test Loss: 1.094 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.178819179534912
Epoch: 41, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.108 Vali Acc: 0.728 Test Loss: 1.108 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2148072719573975
Epoch: 42, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.079 Vali Acc: 0.750 Test Loss: 1.079 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1070334911346436
Epoch: 43, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.102 Vali Acc: 0.750 Test Loss: 1.102 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.234755516052246
Epoch: 44, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.132 Vali Acc: 0.739 Test Loss: 1.132 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2501556873321533
Epoch: 45, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.126 Vali Acc: 0.733 Test Loss: 1.126 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.2376296520233154
Epoch: 46, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.095 Vali Acc: 0.739 Test Loss: 1.095 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2587535381317139
Epoch: 47, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.150 Vali Acc: 0.761 Test Loss: 1.150 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761100).  Saving model ...
Epoch: 48 cost time: 1.188962459564209
Epoch: 48, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.120 Vali Acc: 0.756 Test Loss: 1.120 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2125115394592285
Epoch: 49, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.137 Vali Acc: 0.733 Test Loss: 1.137 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.225738286972046
Epoch: 50, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.191 Vali Acc: 0.739 Test Loss: 1.191 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1663074493408203
Epoch: 51, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.160 Vali Acc: 0.744 Test Loss: 1.160 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.159205675125122
Epoch: 52, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.144 Vali Acc: 0.744 Test Loss: 1.144 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2954883575439453
Epoch: 53, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.175 Vali Acc: 0.756 Test Loss: 1.175 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1351759433746338
Epoch: 54, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.180 Vali Acc: 0.739 Test Loss: 1.180 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.1568362712860107
Epoch: 55, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.189 Vali Acc: 0.750 Test Loss: 1.189 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.1653852462768555
Epoch: 56, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.228 Vali Acc: 0.728 Test Loss: 1.228 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.095885992050171
Epoch: 57, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.208 Vali Acc: 0.767 Test Loss: 1.208 Test Acc: 0.767
Validation loss decreased (-0.761100 --> -0.766655).  Saving model ...
Epoch: 58 cost time: 1.1990318298339844
Epoch: 58, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.186 Vali Acc: 0.767 Test Loss: 1.186 Test Acc: 0.767
Validation loss decreased (-0.766655 --> -0.766655).  Saving model ...
Epoch: 59 cost time: 1.1644086837768555
Epoch: 59, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.182 Vali Acc: 0.750 Test Loss: 1.182 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2845251560211182
Epoch: 60, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.202 Vali Acc: 0.744 Test Loss: 1.202 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1516788005828857
Epoch: 61, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.251 Vali Acc: 0.750 Test Loss: 1.251 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.1559679508209229
Epoch: 62, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.271 Vali Acc: 0.739 Test Loss: 1.271 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0670807361602783
Epoch: 63, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.266 Vali Acc: 0.733 Test Loss: 1.266 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.169496774673462
Epoch: 64, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.268 Vali Acc: 0.744 Test Loss: 1.268 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1222600936889648
Epoch: 65, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.282 Vali Acc: 0.739 Test Loss: 1.282 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.0960173606872559
Epoch: 66, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.284 Vali Acc: 0.739 Test Loss: 1.284 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.095447063446045
Epoch: 67, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.261 Vali Acc: 0.739 Test Loss: 1.261 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.010014533996582
Epoch: 68, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.280 Vali Acc: 0.756 Test Loss: 1.280 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 60367
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8378286361694336
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.755 Vali Acc: 0.094 Test Loss: 2.755 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.0839853286743164
Epoch: 2, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.564 Vali Acc: 0.133 Test Loss: 2.564 Test Acc: 0.133
Validation loss decreased (-0.094417 --> -0.133308).  Saving model ...
Epoch: 3 cost time: 1.102745771408081
Epoch: 3, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.335 Vali Acc: 0.239 Test Loss: 2.335 Test Acc: 0.239
Validation loss decreased (-0.133308 --> -0.238866).  Saving model ...
Epoch: 4 cost time: 1.041100263595581
Epoch: 4, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.099 Vali Acc: 0.406 Test Loss: 2.099 Test Acc: 0.406
Validation loss decreased (-0.238866 --> -0.405535).  Saving model ...
Epoch: 5 cost time: 1.143221139907837
Epoch: 5, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.905 Vali Acc: 0.500 Test Loss: 1.905 Test Acc: 0.500
Validation loss decreased (-0.405535 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 1.0151731967926025
Epoch: 6, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.746 Vali Acc: 0.506 Test Loss: 1.746 Test Acc: 0.506
Validation loss decreased (-0.499981 --> -0.505538).  Saving model ...
Epoch: 7 cost time: 1.2137691974639893
Epoch: 7, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.600 Vali Acc: 0.533 Test Loss: 1.600 Test Acc: 0.533
Validation loss decreased (-0.505538 --> -0.533317).  Saving model ...
Epoch: 8 cost time: 1.0173933506011963
Epoch: 8, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.488 Vali Acc: 0.550 Test Loss: 1.488 Test Acc: 0.550
Validation loss decreased (-0.533317 --> -0.549985).  Saving model ...
Epoch: 9 cost time: 0.9982531070709229
Epoch: 9, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.408 Vali Acc: 0.578 Test Loss: 1.408 Test Acc: 0.578
Validation loss decreased (-0.549985 --> -0.577764).  Saving model ...
Epoch: 10 cost time: 1.1888384819030762
Epoch: 10, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.336 Vali Acc: 0.594 Test Loss: 1.336 Test Acc: 0.594
Validation loss decreased (-0.577764 --> -0.594431).  Saving model ...
Epoch: 11 cost time: 1.0923130512237549
Epoch: 11, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.312 Vali Acc: 0.578 Test Loss: 1.312 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.139312505722046
Epoch: 12, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.226 Vali Acc: 0.628 Test Loss: 1.226 Test Acc: 0.628
Validation loss decreased (-0.594431 --> -0.627766).  Saving model ...
Epoch: 13 cost time: 1.111947774887085
Epoch: 13, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.166 Vali Acc: 0.656 Test Loss: 1.166 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 1.1101882457733154
Epoch: 14, Steps: 12 | Train Loss: 0.710 Vali Loss: 1.146 Vali Acc: 0.656 Test Loss: 1.146 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 1.160247564315796
Epoch: 15, Steps: 12 | Train Loss: 0.654 Vali Loss: 1.096 Vali Acc: 0.644 Test Loss: 1.096 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0746798515319824
Epoch: 16, Steps: 12 | Train Loss: 0.580 Vali Loss: 1.078 Vali Acc: 0.661 Test Loss: 1.078 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 17 cost time: 0.9992725849151611
Epoch: 17, Steps: 12 | Train Loss: 0.561 Vali Loss: 1.047 Vali Acc: 0.678 Test Loss: 1.047 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 18 cost time: 1.188260793685913
Epoch: 18, Steps: 12 | Train Loss: 0.494 Vali Loss: 1.011 Vali Acc: 0.672 Test Loss: 1.011 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1158578395843506
Epoch: 19, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.968 Vali Acc: 0.717 Test Loss: 0.968 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716657).  Saving model ...
Epoch: 20 cost time: 1.2395408153533936
Epoch: 20, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.954 Vali Acc: 0.744 Test Loss: 0.954 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744435).  Saving model ...
Epoch: 21 cost time: 1.0767803192138672
Epoch: 21, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.968 Vali Acc: 0.711 Test Loss: 0.968 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0525267124176025
Epoch: 22, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.975 Vali Acc: 0.744 Test Loss: 0.975 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1940281391143799
Epoch: 23, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.965 Vali Acc: 0.717 Test Loss: 0.965 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1587626934051514
Epoch: 24, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.931 Vali Acc: 0.739 Test Loss: 0.931 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1708743572235107
Epoch: 25, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.964 Vali Acc: 0.717 Test Loss: 0.964 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2517869472503662
Epoch: 26, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.957 Vali Acc: 0.733 Test Loss: 0.957 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2397480010986328
Epoch: 27, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.952 Vali Acc: 0.722 Test Loss: 0.952 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0477824211120605
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.967 Vali Acc: 0.717 Test Loss: 0.967 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0586493015289307
Epoch: 29, Steps: 12 | Train Loss: 0.181 Vali Loss: 1.007 Vali Acc: 0.717 Test Loss: 1.007 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1224465370178223
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.013 Vali Acc: 0.711 Test Loss: 1.013 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 59439
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7480111122131348
Epoch: 1, Steps: 12 | Train Loss: 2.878 Vali Loss: 2.695 Vali Acc: 0.139 Test Loss: 2.695 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.1229374408721924
Epoch: 2, Steps: 12 | Train Loss: 2.679 Vali Loss: 2.531 Vali Acc: 0.222 Test Loss: 2.531 Test Acc: 0.222
Validation loss decreased (-0.138862 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 1.206437587738037
Epoch: 3, Steps: 12 | Train Loss: 2.513 Vali Loss: 2.332 Vali Acc: 0.333 Test Loss: 2.332 Test Acc: 0.333
Validation loss decreased (-0.222197 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 1.1942157745361328
Epoch: 4, Steps: 12 | Train Loss: 2.283 Vali Loss: 2.138 Vali Acc: 0.411 Test Loss: 2.138 Test Acc: 0.411
Validation loss decreased (-0.333310 --> -0.411090).  Saving model ...
Epoch: 5 cost time: 1.085721731185913
Epoch: 5, Steps: 12 | Train Loss: 2.027 Vali Loss: 1.958 Vali Acc: 0.456 Test Loss: 1.958 Test Acc: 0.456
Validation loss decreased (-0.411090 --> -0.455536).  Saving model ...
Epoch: 6 cost time: 1.1287059783935547
Epoch: 6, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.804 Vali Acc: 0.489 Test Loss: 1.804 Test Acc: 0.489
Validation loss decreased (-0.455536 --> -0.488871).  Saving model ...
Epoch: 7 cost time: 1.2607848644256592
Epoch: 7, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.691 Vali Acc: 0.528 Test Loss: 1.691 Test Acc: 0.528
Validation loss decreased (-0.488871 --> -0.527761).  Saving model ...
Epoch: 8 cost time: 1.1765637397766113
Epoch: 8, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.574 Vali Acc: 0.556 Test Loss: 1.574 Test Acc: 0.556
Validation loss decreased (-0.527761 --> -0.555540).  Saving model ...
Epoch: 9 cost time: 1.0544383525848389
Epoch: 9, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.500 Vali Acc: 0.594 Test Loss: 1.500 Test Acc: 0.594
Validation loss decreased (-0.555540 --> -0.594429).  Saving model ...
Epoch: 10 cost time: 1.3239166736602783
Epoch: 10, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.419 Vali Acc: 0.606 Test Loss: 1.419 Test Acc: 0.606
Validation loss decreased (-0.594429 --> -0.605541).  Saving model ...
Epoch: 11 cost time: 1.1829841136932373
Epoch: 11, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.372 Vali Acc: 0.600 Test Loss: 1.372 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3070743083953857
Epoch: 12, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.307 Vali Acc: 0.622 Test Loss: 1.307 Test Acc: 0.622
Validation loss decreased (-0.605541 --> -0.622209).  Saving model ...
Epoch: 13 cost time: 1.2667510509490967
Epoch: 13, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.267 Vali Acc: 0.617 Test Loss: 1.267 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1885149478912354
Epoch: 14, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.219 Vali Acc: 0.628 Test Loss: 1.219 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627766).  Saving model ...
Epoch: 15 cost time: 1.129685878753662
Epoch: 15, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.186 Vali Acc: 0.661 Test Loss: 1.186 Test Acc: 0.661
Validation loss decreased (-0.627766 --> -0.661099).  Saving model ...
Epoch: 16 cost time: 1.1982271671295166
Epoch: 16, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.154 Vali Acc: 0.644 Test Loss: 1.154 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.249953031539917
Epoch: 17, Steps: 12 | Train Loss: 0.667 Vali Loss: 1.115 Vali Acc: 0.678 Test Loss: 1.115 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 18 cost time: 1.2908456325531006
Epoch: 18, Steps: 12 | Train Loss: 0.614 Vali Loss: 1.074 Vali Acc: 0.667 Test Loss: 1.074 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1955323219299316
Epoch: 19, Steps: 12 | Train Loss: 0.651 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699989).  Saving model ...
Epoch: 20 cost time: 1.1801507472991943
Epoch: 20, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.016 Vali Acc: 0.717 Test Loss: 1.016 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716657).  Saving model ...
Epoch: 21 cost time: 1.0798633098602295
Epoch: 21, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.982 Vali Acc: 0.717 Test Loss: 0.982 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 22 cost time: 1.0357346534729004
Epoch: 22, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.978 Vali Acc: 0.717 Test Loss: 0.978 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 23 cost time: 0.9939639568328857
Epoch: 23, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.943 Vali Acc: 0.733 Test Loss: 0.943 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 24 cost time: 1.0803332328796387
Epoch: 24, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.931 Vali Acc: 0.744 Test Loss: 0.931 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 25 cost time: 1.0226035118103027
Epoch: 25, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 1.1896324157714844
Epoch: 26, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.904 Vali Acc: 0.750 Test Loss: 0.904 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 27 cost time: 1.199840784072876
Epoch: 27, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.865 Vali Acc: 0.767 Test Loss: 0.865 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766658).  Saving model ...
Epoch: 28 cost time: 1.1349782943725586
Epoch: 28, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.882 Vali Acc: 0.761 Test Loss: 0.882 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1214537620544434
Epoch: 29, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.878 Vali Acc: 0.761 Test Loss: 0.878 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1820416450500488
Epoch: 30, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.870 Vali Acc: 0.756 Test Loss: 0.870 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3170835971832275
Epoch: 31, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.890 Vali Acc: 0.767 Test Loss: 0.890 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2373812198638916
Epoch: 32, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.887 Vali Acc: 0.761 Test Loss: 0.887 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2175838947296143
Epoch: 33, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.875 Vali Acc: 0.772 Test Loss: 0.875 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772213).  Saving model ...
Epoch: 34 cost time: 1.1149051189422607
Epoch: 34, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 35 cost time: 1.187948226928711
Epoch: 35, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.878 Vali Acc: 0.767 Test Loss: 0.878 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0518875122070312
Epoch: 36, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.872 Vali Acc: 0.767 Test Loss: 0.872 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2037181854248047
Epoch: 37, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.899 Vali Acc: 0.778 Test Loss: 0.899 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.137963056564331
Epoch: 38, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.894 Vali Acc: 0.778 Test Loss: 0.894 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1581714153289795
Epoch: 39, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.883 Vali Acc: 0.778 Test Loss: 0.883 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1384925842285156
Epoch: 40, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.875 Vali Acc: 0.783 Test Loss: 0.875 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783325).  Saving model ...
Epoch: 41 cost time: 1.126455307006836
Epoch: 41, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.906 Vali Acc: 0.783 Test Loss: 0.906 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1032586097717285
Epoch: 42, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.925 Vali Acc: 0.772 Test Loss: 0.925 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1872735023498535
Epoch: 43, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.909 Vali Acc: 0.783 Test Loss: 0.909 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1742181777954102
Epoch: 44, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.903 Vali Acc: 0.778 Test Loss: 0.903 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2474758625030518
Epoch: 45, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.919 Vali Acc: 0.783 Test Loss: 0.919 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2471013069152832
Epoch: 46, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.929 Vali Acc: 0.800 Test Loss: 0.929 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799991).  Saving model ...
Epoch: 47 cost time: 1.100743055343628
Epoch: 47, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.962 Vali Acc: 0.778 Test Loss: 0.962 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1111564636230469
Epoch: 48, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.952 Vali Acc: 0.772 Test Loss: 0.952 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1682562828063965
Epoch: 49, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.947 Vali Acc: 0.767 Test Loss: 0.947 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0894279479980469
Epoch: 50, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.966 Vali Acc: 0.794 Test Loss: 0.966 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1418347358703613
Epoch: 51, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.963 Vali Acc: 0.783 Test Loss: 0.963 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.117241621017456
Epoch: 52, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.964 Vali Acc: 0.778 Test Loss: 0.964 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.2157728672027588
Epoch: 53, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.990 Vali Acc: 0.772 Test Loss: 0.990 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.057032585144043
Epoch: 54, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.000 Vali Acc: 0.767 Test Loss: 1.000 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.0522172451019287
Epoch: 55, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.984 Vali Acc: 0.767 Test Loss: 0.984 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1577966213226318
Epoch: 56, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.982 Vali Acc: 0.778 Test Loss: 0.982 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 52751
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.871999502182007
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.819 Vali Acc: 0.067 Test Loss: 2.819 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 1.034170389175415
Epoch: 2, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.705 Vali Acc: 0.094 Test Loss: 2.705 Test Acc: 0.094
Validation loss decreased (-0.066638 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 0.9402327537536621
Epoch: 3, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.551 Vali Acc: 0.128 Test Loss: 2.551 Test Acc: 0.128
Validation loss decreased (-0.094417 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 0.9967091083526611
Epoch: 4, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.385 Vali Acc: 0.211 Test Loss: 2.385 Test Acc: 0.211
Validation loss decreased (-0.127752 --> -0.211087).  Saving model ...
Epoch: 5 cost time: 1.0524194240570068
Epoch: 5, Steps: 12 | Train Loss: 2.247 Vali Loss: 2.222 Vali Acc: 0.344 Test Loss: 2.222 Test Acc: 0.344
Validation loss decreased (-0.211087 --> -0.344422).  Saving model ...
Epoch: 6 cost time: 0.9763827323913574
Epoch: 6, Steps: 12 | Train Loss: 2.138 Vali Loss: 2.061 Vali Acc: 0.400 Test Loss: 2.061 Test Acc: 0.400
Validation loss decreased (-0.344422 --> -0.399979).  Saving model ...
Epoch: 7 cost time: 0.9996943473815918
Epoch: 7, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.907 Vali Acc: 0.472 Test Loss: 1.907 Test Acc: 0.472
Validation loss decreased (-0.399979 --> -0.472203).  Saving model ...
Epoch: 8 cost time: 1.0305593013763428
Epoch: 8, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.777 Vali Acc: 0.556 Test Loss: 1.777 Test Acc: 0.556
Validation loss decreased (-0.472203 --> -0.555538).  Saving model ...
Epoch: 9 cost time: 1.0114176273345947
Epoch: 9, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.672 Vali Acc: 0.578 Test Loss: 1.672 Test Acc: 0.578
Validation loss decreased (-0.555538 --> -0.577761).  Saving model ...
Epoch: 10 cost time: 1.0555074214935303
Epoch: 10, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.579 Vali Acc: 0.589 Test Loss: 1.579 Test Acc: 0.589
Validation loss decreased (-0.577761 --> -0.588873).  Saving model ...
Epoch: 11 cost time: 0.9788446426391602
Epoch: 11, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.503 Vali Acc: 0.583 Test Loss: 1.503 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.990344762802124
Epoch: 12, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.436 Vali Acc: 0.594 Test Loss: 1.436 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594430).  Saving model ...
Epoch: 13 cost time: 0.9812941551208496
Epoch: 13, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.381 Vali Acc: 0.583 Test Loss: 1.381 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9284424781799316
Epoch: 14, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.345 Vali Acc: 0.611 Test Loss: 1.345 Test Acc: 0.611
Validation loss decreased (-0.594430 --> -0.611098).  Saving model ...
Epoch: 15 cost time: 0.946408748626709
Epoch: 15, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.305 Vali Acc: 0.611 Test Loss: 1.305 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 16 cost time: 1.030198335647583
Epoch: 16, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.265 Vali Acc: 0.622 Test Loss: 1.265 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 17 cost time: 0.9592328071594238
Epoch: 17, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.241 Vali Acc: 0.639 Test Loss: 1.241 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638876).  Saving model ...
Epoch: 18 cost time: 1.0393288135528564
Epoch: 18, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.201 Vali Acc: 0.656 Test Loss: 1.201 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 19 cost time: 1.0484697818756104
Epoch: 19, Steps: 12 | Train Loss: 0.740 Vali Loss: 1.158 Vali Acc: 0.661 Test Loss: 1.158 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 20 cost time: 0.9930825233459473
Epoch: 20, Steps: 12 | Train Loss: 0.710 Vali Loss: 1.125 Vali Acc: 0.656 Test Loss: 1.125 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9796702861785889
Epoch: 21, Steps: 12 | Train Loss: 0.650 Vali Loss: 1.096 Vali Acc: 0.661 Test Loss: 1.096 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661100).  Saving model ...
Epoch: 22 cost time: 1.017256259918213
Epoch: 22, Steps: 12 | Train Loss: 0.603 Vali Loss: 1.068 Vali Acc: 0.672 Test Loss: 1.068 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 23 cost time: 1.1694660186767578
Epoch: 23, Steps: 12 | Train Loss: 0.566 Vali Loss: 1.074 Vali Acc: 0.678 Test Loss: 1.074 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677767).  Saving model ...
Epoch: 24 cost time: 0.9355831146240234
Epoch: 24, Steps: 12 | Train Loss: 0.535 Vali Loss: 1.023 Vali Acc: 0.700 Test Loss: 1.023 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.9794127941131592
Epoch: 25, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.998 Vali Acc: 0.706 Test Loss: 0.998 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 26 cost time: 1.073066234588623
Epoch: 26, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.975 Vali Acc: 0.711 Test Loss: 0.975 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711101).  Saving model ...
Epoch: 27 cost time: 1.1010522842407227
Epoch: 27, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.971 Vali Acc: 0.722 Test Loss: 0.971 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 28 cost time: 1.1086275577545166
Epoch: 28, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.954 Vali Acc: 0.728 Test Loss: 0.954 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727768).  Saving model ...
Epoch: 29 cost time: 0.9397177696228027
Epoch: 29, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.941 Vali Acc: 0.739 Test Loss: 0.941 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 30 cost time: 1.1658971309661865
Epoch: 30, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.909 Vali Acc: 0.728 Test Loss: 0.909 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9913880825042725
Epoch: 31, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.914 Vali Acc: 0.733 Test Loss: 0.914 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0734412670135498
Epoch: 32, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.901 Vali Acc: 0.733 Test Loss: 0.901 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1230790615081787
Epoch: 33, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.902 Vali Acc: 0.739 Test Loss: 0.902 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738880).  Saving model ...
Epoch: 34 cost time: 1.0580601692199707
Epoch: 34, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.904 Vali Acc: 0.717 Test Loss: 0.904 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.13093900680542
Epoch: 35, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 36 cost time: 1.0642352104187012
Epoch: 36, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.883 Vali Acc: 0.728 Test Loss: 0.883 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0094146728515625
Epoch: 37, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 1.1382052898406982
Epoch: 38, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.866 Vali Acc: 0.744 Test Loss: 0.866 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0441882610321045
Epoch: 39, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.863 Vali Acc: 0.756 Test Loss: 0.863 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 40 cost time: 1.0946786403656006
Epoch: 40, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.866 Vali Acc: 0.761 Test Loss: 0.866 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 41 cost time: 1.0861456394195557
Epoch: 41, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.086991548538208
Epoch: 42, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.859 Vali Acc: 0.761 Test Loss: 0.859 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761103).  Saving model ...
Epoch: 43 cost time: 1.0035884380340576
Epoch: 43, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.855 Vali Acc: 0.739 Test Loss: 0.855 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1053705215454102
Epoch: 44, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.889 Vali Acc: 0.739 Test Loss: 0.889 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0605156421661377
Epoch: 45, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.875 Vali Acc: 0.761 Test Loss: 0.875 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0081031322479248
Epoch: 46, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.863 Vali Acc: 0.778 Test Loss: 0.863 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777769).  Saving model ...
Epoch: 47 cost time: 1.071955919265747
Epoch: 47, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.864 Vali Acc: 0.761 Test Loss: 0.864 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2895417213439941
Epoch: 48, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.874 Vali Acc: 0.789 Test Loss: 0.874 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 49 cost time: 1.025496482849121
Epoch: 49, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.910 Vali Acc: 0.733 Test Loss: 0.910 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.934075117111206
Epoch: 50, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.896 Vali Acc: 0.744 Test Loss: 0.896 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0248761177062988
Epoch: 51, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.872 Vali Acc: 0.761 Test Loss: 0.872 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1845667362213135
Epoch: 52, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.3171164989471436
Epoch: 53, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.884 Vali Acc: 0.783 Test Loss: 0.884 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1141164302825928
Epoch: 54, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.901 Vali Acc: 0.772 Test Loss: 0.901 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.062180995941162
Epoch: 55, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.879 Vali Acc: 0.783 Test Loss: 0.879 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.0572094917297363
Epoch: 56, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.878 Vali Acc: 0.778 Test Loss: 0.878 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.126891851425171
Epoch: 57, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.903 Vali Acc: 0.756 Test Loss: 0.903 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.1076135635375977
Epoch: 58, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.903 Vali Acc: 0.767 Test Loss: 0.903 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 48975
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6013095378875732
Epoch: 1, Steps: 12 | Train Loss: 2.884 Vali Loss: 2.743 Vali Acc: 0.078 Test Loss: 2.743 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 1.0505831241607666
Epoch: 2, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.643 Vali Acc: 0.117 Test Loss: 2.643 Test Acc: 0.117
Validation loss decreased (-0.077750 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 1.2720494270324707
Epoch: 3, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.501 Vali Acc: 0.172 Test Loss: 2.501 Test Acc: 0.172
Validation loss decreased (-0.116640 --> -0.172197).  Saving model ...
Epoch: 4 cost time: 1.1818997859954834
Epoch: 4, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.345 Vali Acc: 0.244 Test Loss: 2.345 Test Acc: 0.244
Validation loss decreased (-0.172197 --> -0.244421).  Saving model ...
Epoch: 5 cost time: 1.1191446781158447
Epoch: 5, Steps: 12 | Train Loss: 2.272 Vali Loss: 2.194 Vali Acc: 0.333 Test Loss: 2.194 Test Acc: 0.333
Validation loss decreased (-0.244421 --> -0.333311).  Saving model ...
Epoch: 6 cost time: 1.0090866088867188
Epoch: 6, Steps: 12 | Train Loss: 2.099 Vali Loss: 2.041 Vali Acc: 0.383 Test Loss: 2.041 Test Acc: 0.383
Validation loss decreased (-0.333311 --> -0.383313).  Saving model ...
Epoch: 7 cost time: 1.115950584411621
Epoch: 7, Steps: 12 | Train Loss: 1.918 Vali Loss: 1.903 Vali Acc: 0.439 Test Loss: 1.903 Test Acc: 0.439
Validation loss decreased (-0.383313 --> -0.438870).  Saving model ...
Epoch: 8 cost time: 0.9550786018371582
Epoch: 8, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.795 Vali Acc: 0.456 Test Loss: 1.795 Test Acc: 0.456
Validation loss decreased (-0.438870 --> -0.455538).  Saving model ...
Epoch: 9 cost time: 1.0828509330749512
Epoch: 9, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.703 Vali Acc: 0.506 Test Loss: 1.703 Test Acc: 0.506
Validation loss decreased (-0.455538 --> -0.505539).  Saving model ...
Epoch: 10 cost time: 1.1122746467590332
Epoch: 10, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.623 Vali Acc: 0.528 Test Loss: 1.623 Test Acc: 0.528
Validation loss decreased (-0.505539 --> -0.527762).  Saving model ...
Epoch: 11 cost time: 1.0623760223388672
Epoch: 11, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.566 Vali Acc: 0.550 Test Loss: 1.566 Test Acc: 0.550
Validation loss decreased (-0.527762 --> -0.549984).  Saving model ...
Epoch: 12 cost time: 1.1643238067626953
Epoch: 12, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.500 Vali Acc: 0.578 Test Loss: 1.500 Test Acc: 0.578
Validation loss decreased (-0.549984 --> -0.577763).  Saving model ...
Epoch: 13 cost time: 1.1684021949768066
Epoch: 13, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.449 Vali Acc: 0.589 Test Loss: 1.449 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588874).  Saving model ...
Epoch: 14 cost time: 1.0210630893707275
Epoch: 14, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.400 Vali Acc: 0.606 Test Loss: 1.400 Test Acc: 0.606
Validation loss decreased (-0.588874 --> -0.605542).  Saving model ...
Epoch: 15 cost time: 1.0564825534820557
Epoch: 15, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.354 Vali Acc: 0.606 Test Loss: 1.354 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 1.1200311183929443
Epoch: 16, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.314 Vali Acc: 0.622 Test Loss: 1.314 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 17 cost time: 1.1855711936950684
Epoch: 17, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.269 Vali Acc: 0.617 Test Loss: 1.269 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1154954433441162
Epoch: 18, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.245 Vali Acc: 0.622 Test Loss: 1.245 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 19 cost time: 1.1617960929870605
Epoch: 19, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.197 Vali Acc: 0.628 Test Loss: 1.197 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 20 cost time: 1.1831793785095215
Epoch: 20, Steps: 12 | Train Loss: 0.775 Vali Loss: 1.147 Vali Acc: 0.650 Test Loss: 1.147 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 1.2965059280395508
Epoch: 21, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.128 Vali Acc: 0.628 Test Loss: 1.128 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2307546138763428
Epoch: 22, Steps: 12 | Train Loss: 0.675 Vali Loss: 1.074 Vali Acc: 0.633 Test Loss: 1.074 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2286505699157715
Epoch: 23, Steps: 12 | Train Loss: 0.619 Vali Loss: 1.041 Vali Acc: 0.656 Test Loss: 1.041 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 24 cost time: 1.113229513168335
Epoch: 24, Steps: 12 | Train Loss: 0.570 Vali Loss: 1.028 Vali Acc: 0.656 Test Loss: 1.028 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 25 cost time: 1.1830570697784424
Epoch: 25, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.996 Vali Acc: 0.672 Test Loss: 0.996 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672212).  Saving model ...
Epoch: 26 cost time: 1.112767219543457
Epoch: 26, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.973 Vali Acc: 0.672 Test Loss: 0.973 Test Acc: 0.672
Validation loss decreased (-0.672212 --> -0.672212).  Saving model ...
Epoch: 27 cost time: 1.230395793914795
Epoch: 27, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.930 Vali Acc: 0.694 Test Loss: 0.930 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694435).  Saving model ...
Epoch: 28 cost time: 1.2613794803619385
Epoch: 28, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.904 Vali Acc: 0.700 Test Loss: 0.904 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 29 cost time: 1.133208990097046
Epoch: 29, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 30 cost time: 1.133277177810669
Epoch: 30, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 31 cost time: 1.116225242614746
Epoch: 31, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.886 Vali Acc: 0.717 Test Loss: 0.886 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.032383680343628
Epoch: 32, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.884 Vali Acc: 0.717 Test Loss: 0.884 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1480205059051514
Epoch: 33, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.868 Vali Acc: 0.744 Test Loss: 0.868 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 34 cost time: 1.1452252864837646
Epoch: 34, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 35 cost time: 1.0748305320739746
Epoch: 35, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.840 Vali Acc: 0.756 Test Loss: 0.840 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 36 cost time: 1.1741151809692383
Epoch: 36, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.835 Vali Acc: 0.744 Test Loss: 0.835 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.169753074645996
Epoch: 37, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.826 Vali Acc: 0.739 Test Loss: 0.826 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1112151145935059
Epoch: 38, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.833 Vali Acc: 0.744 Test Loss: 0.833 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1750507354736328
Epoch: 39, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.832 Vali Acc: 0.756 Test Loss: 0.832 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 40 cost time: 1.1980643272399902
Epoch: 40, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1676177978515625
Epoch: 41, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.831 Vali Acc: 0.733 Test Loss: 0.831 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.229048490524292
Epoch: 42, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.820 Vali Acc: 0.756 Test Loss: 0.820 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 43 cost time: 1.1108369827270508
Epoch: 43, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1340274810791016
Epoch: 44, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.822 Vali Acc: 0.728 Test Loss: 0.822 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1491715908050537
Epoch: 45, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.837 Vali Acc: 0.733 Test Loss: 0.837 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0958316326141357
Epoch: 46, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2030410766601562
Epoch: 47, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.857 Vali Acc: 0.722 Test Loss: 0.857 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1585602760314941
Epoch: 48, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.852 Vali Acc: 0.728 Test Loss: 0.852 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0641531944274902
Epoch: 49, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.837 Vali Acc: 0.739 Test Loss: 0.837 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1050622463226318
Epoch: 50, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.852 Vali Acc: 0.722 Test Loss: 0.852 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0611460208892822
Epoch: 51, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.862 Vali Acc: 0.733 Test Loss: 0.862 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.2094340324401855
Epoch: 52, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.840 Vali Acc: 0.728 Test Loss: 0.840 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 47119
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7701854705810547
Epoch: 1, Steps: 12 | Train Loss: 3.032 Vali Loss: 2.874 Vali Acc: 0.017 Test Loss: 2.874 Test Acc: 0.017
Validation loss decreased (inf --> -0.016638).  Saving model ...
Epoch: 2 cost time: 1.07869553565979
Epoch: 2, Steps: 12 | Train Loss: 2.910 Vali Loss: 2.795 Vali Acc: 0.033 Test Loss: 2.795 Test Acc: 0.033
Validation loss decreased (-0.016638 --> -0.033305).  Saving model ...
Epoch: 3 cost time: 1.0266668796539307
Epoch: 3, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.674 Vali Acc: 0.117 Test Loss: 2.674 Test Acc: 0.117
Validation loss decreased (-0.033305 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 1.0971860885620117
Epoch: 4, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.522 Vali Acc: 0.167 Test Loss: 2.522 Test Acc: 0.167
Validation loss decreased (-0.116640 --> -0.166641).  Saving model ...
Epoch: 5 cost time: 1.1318719387054443
Epoch: 5, Steps: 12 | Train Loss: 2.492 Vali Loss: 2.361 Vali Acc: 0.317 Test Loss: 2.361 Test Acc: 0.317
Validation loss decreased (-0.166641 --> -0.316643).  Saving model ...
Epoch: 6 cost time: 1.092695713043213
Epoch: 6, Steps: 12 | Train Loss: 2.268 Vali Loss: 2.208 Vali Acc: 0.367 Test Loss: 2.208 Test Acc: 0.367
Validation loss decreased (-0.316643 --> -0.366645).  Saving model ...
Epoch: 7 cost time: 1.0004396438598633
Epoch: 7, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.066 Vali Acc: 0.428 Test Loss: 2.066 Test Acc: 0.428
Validation loss decreased (-0.366645 --> -0.427757).  Saving model ...
Epoch: 8 cost time: 0.9835593700408936
Epoch: 8, Steps: 12 | Train Loss: 1.982 Vali Loss: 1.941 Vali Acc: 0.456 Test Loss: 1.941 Test Acc: 0.456
Validation loss decreased (-0.427757 --> -0.455536).  Saving model ...
Epoch: 9 cost time: 1.1275670528411865
Epoch: 9, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.826 Vali Acc: 0.489 Test Loss: 1.826 Test Acc: 0.489
Validation loss decreased (-0.455536 --> -0.488871).  Saving model ...
Epoch: 10 cost time: 1.214437484741211
Epoch: 10, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.731 Vali Acc: 0.494 Test Loss: 1.731 Test Acc: 0.494
Validation loss decreased (-0.488871 --> -0.494427).  Saving model ...
Epoch: 11 cost time: 1.1547322273254395
Epoch: 11, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.663 Vali Acc: 0.528 Test Loss: 1.663 Test Acc: 0.528
Validation loss decreased (-0.494427 --> -0.527761).  Saving model ...
Epoch: 12 cost time: 1.114858865737915
Epoch: 12, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.597 Vali Acc: 0.533 Test Loss: 1.597 Test Acc: 0.533
Validation loss decreased (-0.527761 --> -0.533317).  Saving model ...
Epoch: 13 cost time: 1.0389080047607422
Epoch: 13, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.535 Vali Acc: 0.539 Test Loss: 1.535 Test Acc: 0.539
Validation loss decreased (-0.533317 --> -0.538874).  Saving model ...
Epoch: 14 cost time: 1.154404878616333
Epoch: 14, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.472 Vali Acc: 0.544 Test Loss: 1.472 Test Acc: 0.544
Validation loss decreased (-0.538874 --> -0.544430).  Saving model ...
Epoch: 15 cost time: 1.127593755722046
Epoch: 15, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.402 Vali Acc: 0.567 Test Loss: 1.402 Test Acc: 0.567
Validation loss decreased (-0.544430 --> -0.566653).  Saving model ...
Epoch: 16 cost time: 1.1592185497283936
Epoch: 16, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.350 Vali Acc: 0.583 Test Loss: 1.350 Test Acc: 0.583
Validation loss decreased (-0.566653 --> -0.583320).  Saving model ...
Epoch: 17 cost time: 1.0585072040557861
Epoch: 17, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.295 Vali Acc: 0.611 Test Loss: 1.295 Test Acc: 0.611
Validation loss decreased (-0.583320 --> -0.611098).  Saving model ...
Epoch: 18 cost time: 1.1717407703399658
Epoch: 18, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.237 Vali Acc: 0.617 Test Loss: 1.237 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616654).  Saving model ...
Epoch: 19 cost time: 1.2320129871368408
Epoch: 19, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.191 Vali Acc: 0.633 Test Loss: 1.191 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 20 cost time: 1.125147819519043
Epoch: 20, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.144 Vali Acc: 0.656 Test Loss: 1.144 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 21 cost time: 1.144397258758545
Epoch: 21, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.103 Vali Acc: 0.656 Test Loss: 1.103 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 22 cost time: 1.0893254280090332
Epoch: 22, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.045 Vali Acc: 0.661 Test Loss: 1.045 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661101).  Saving model ...
Epoch: 23 cost time: 1.1515812873840332
Epoch: 23, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.004 Vali Acc: 0.667 Test Loss: 1.004 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666657).  Saving model ...
Epoch: 24 cost time: 1.1847953796386719
Epoch: 24, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.988 Vali Acc: 0.672 Test Loss: 0.988 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672212).  Saving model ...
Epoch: 25 cost time: 1.1892962455749512
Epoch: 25, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.961 Vali Acc: 0.694 Test Loss: 0.961 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694435).  Saving model ...
Epoch: 26 cost time: 1.128434181213379
Epoch: 26, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.940 Vali Acc: 0.706 Test Loss: 0.940 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705546).  Saving model ...
Epoch: 27 cost time: 1.1432740688323975
Epoch: 27, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.918 Vali Acc: 0.706 Test Loss: 0.918 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705546).  Saving model ...
Epoch: 28 cost time: 1.2008674144744873
Epoch: 28, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.908 Vali Acc: 0.700 Test Loss: 0.908 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0839457511901855
Epoch: 29, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.889 Vali Acc: 0.711 Test Loss: 0.889 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 30 cost time: 1.1882433891296387
Epoch: 30, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.877 Vali Acc: 0.728 Test Loss: 0.877 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 31 cost time: 1.1424899101257324
Epoch: 31, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.868 Vali Acc: 0.722 Test Loss: 0.868 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1293530464172363
Epoch: 32, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.851 Vali Acc: 0.728 Test Loss: 0.851 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 33 cost time: 1.1229987144470215
Epoch: 33, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.832 Vali Acc: 0.756 Test Loss: 0.832 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755547).  Saving model ...
Epoch: 34 cost time: 1.1599791049957275
Epoch: 34, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.845 Vali Acc: 0.739 Test Loss: 0.845 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.190974235534668
Epoch: 35, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.266411542892456
Epoch: 36, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.832 Vali Acc: 0.739 Test Loss: 0.832 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.08302640914917
Epoch: 37, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 38 cost time: 1.141953706741333
Epoch: 38, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1694257259368896
Epoch: 39, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1215744018554688
Epoch: 40, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0858166217803955
Epoch: 41, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.813 Vali Acc: 0.739 Test Loss: 0.813 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0559885501861572
Epoch: 42, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.080155849456787
Epoch: 43, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0503973960876465
Epoch: 44, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1246767044067383
Epoch: 45, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.841 Vali Acc: 0.739 Test Loss: 0.841 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.069516897201538
Epoch: 46, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.849 Vali Acc: 0.733 Test Loss: 0.849 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1803581714630127
Epoch: 47, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.851 Vali Acc: 0.733 Test Loss: 0.851 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 45295
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.150501251220703
Epoch: 1, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.674 Vali Acc: 0.089 Test Loss: 2.674 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.1674010753631592
Epoch: 2, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.321 Vali Acc: 0.311 Test Loss: 2.321 Test Acc: 0.311
Validation loss decreased (-0.088862 --> -0.311088).  Saving model ...
Epoch: 3 cost time: 1.0464775562286377
Epoch: 3, Steps: 12 | Train Loss: 2.161 Vali Loss: 1.992 Vali Acc: 0.461 Test Loss: 1.992 Test Acc: 0.461
Validation loss decreased (-0.311088 --> -0.461091).  Saving model ...
Epoch: 4 cost time: 1.0513145923614502
Epoch: 4, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.759 Vali Acc: 0.467 Test Loss: 1.759 Test Acc: 0.467
Validation loss decreased (-0.461091 --> -0.466649).  Saving model ...
Epoch: 5 cost time: 1.0616724491119385
Epoch: 5, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.578 Vali Acc: 0.539 Test Loss: 1.578 Test Acc: 0.539
Validation loss decreased (-0.466649 --> -0.538873).  Saving model ...
Epoch: 6 cost time: 1.030041217803955
Epoch: 6, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.466 Vali Acc: 0.539 Test Loss: 1.466 Test Acc: 0.539
Validation loss decreased (-0.538873 --> -0.538874).  Saving model ...
Epoch: 7 cost time: 0.9812121391296387
Epoch: 7, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.358 Vali Acc: 0.617 Test Loss: 1.358 Test Acc: 0.617
Validation loss decreased (-0.538874 --> -0.616653).  Saving model ...
Epoch: 8 cost time: 1.0516612529754639
Epoch: 8, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.304 Vali Acc: 0.611 Test Loss: 1.304 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0556206703186035
Epoch: 9, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.296 Vali Acc: 0.633 Test Loss: 1.296 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633320).  Saving model ...
Epoch: 10 cost time: 1.0647783279418945
Epoch: 10, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.242 Vali Acc: 0.622 Test Loss: 1.242 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0011343955993652
Epoch: 11, Steps: 12 | Train Loss: 0.779 Vali Loss: 1.183 Vali Acc: 0.656 Test Loss: 1.183 Test Acc: 0.656
Validation loss decreased (-0.633320 --> -0.655544).  Saving model ...
Epoch: 12 cost time: 1.031808853149414
Epoch: 12, Steps: 12 | Train Loss: 0.648 Vali Loss: 1.122 Vali Acc: 0.683 Test Loss: 1.122 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683322).  Saving model ...
Epoch: 13 cost time: 1.1581265926361084
Epoch: 13, Steps: 12 | Train Loss: 0.557 Vali Loss: 1.092 Vali Acc: 0.672 Test Loss: 1.092 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0932207107543945
Epoch: 14, Steps: 12 | Train Loss: 0.464 Vali Loss: 1.073 Vali Acc: 0.678 Test Loss: 1.073 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1939871311187744
Epoch: 15, Steps: 12 | Train Loss: 0.438 Vali Loss: 1.011 Vali Acc: 0.711 Test Loss: 1.011 Test Acc: 0.711
Validation loss decreased (-0.683322 --> -0.711101).  Saving model ...
Epoch: 16 cost time: 1.1555914878845215
Epoch: 16, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.993 Vali Acc: 0.722 Test Loss: 0.993 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 1.211153268814087
Epoch: 17, Steps: 12 | Train Loss: 0.299 Vali Loss: 1.012 Vali Acc: 0.722 Test Loss: 1.012 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1429390907287598
Epoch: 18, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.009 Vali Acc: 0.733 Test Loss: 1.009 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 19 cost time: 1.255228042602539
Epoch: 19, Steps: 12 | Train Loss: 0.282 Vali Loss: 1.029 Vali Acc: 0.750 Test Loss: 1.029 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 1.072248935699463
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 1.043 Vali Acc: 0.711 Test Loss: 1.043 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.247145175933838
Epoch: 21, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.108 Vali Acc: 0.722 Test Loss: 1.108 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0984735488891602
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.095 Vali Acc: 0.739 Test Loss: 1.095 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0545761585235596
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.119 Vali Acc: 0.756 Test Loss: 1.119 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755544).  Saving model ...
Epoch: 24 cost time: 1.1091103553771973
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.147 Vali Acc: 0.722 Test Loss: 1.147 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2125816345214844
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.116 Vali Acc: 0.761 Test Loss: 1.116 Test Acc: 0.761
Validation loss decreased (-0.755544 --> -0.761100).  Saving model ...
Epoch: 26 cost time: 1.0512030124664307
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.144 Vali Acc: 0.750 Test Loss: 1.144 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0354974269866943
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.152 Vali Acc: 0.772 Test Loss: 1.152 Test Acc: 0.772
Validation loss decreased (-0.761100 --> -0.772211).  Saving model ...
Epoch: 28 cost time: 1.0971009731292725
Epoch: 28, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.193 Vali Acc: 0.739 Test Loss: 1.193 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0305798053741455
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.226 Vali Acc: 0.744 Test Loss: 1.226 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0428407192230225
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.218 Vali Acc: 0.739 Test Loss: 1.218 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0993008613586426
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.221 Vali Acc: 0.744 Test Loss: 1.221 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1056139469146729
Epoch: 32, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.306 Vali Acc: 0.717 Test Loss: 1.306 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1427452564239502
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.305 Vali Acc: 0.761 Test Loss: 1.305 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0411570072174072
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.284 Vali Acc: 0.756 Test Loss: 1.284 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1046957969665527
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.385 Vali Acc: 0.700 Test Loss: 1.385 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0892717838287354
Epoch: 36, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.368 Vali Acc: 0.761 Test Loss: 1.368 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1514272689819336
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.381 Vali Acc: 0.744 Test Loss: 1.381 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 68975
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0941879749298096
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.654 Vali Acc: 0.156 Test Loss: 2.654 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.225100040435791
Epoch: 2, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.479 Vali Acc: 0.200 Test Loss: 2.479 Test Acc: 0.200
Validation loss decreased (-0.155529 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 1.0803492069244385
Epoch: 3, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.264 Vali Acc: 0.333 Test Loss: 2.264 Test Acc: 0.333
Validation loss decreased (-0.199975 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 1.2257294654846191
Epoch: 4, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.062 Vali Acc: 0.422 Test Loss: 2.062 Test Acc: 0.422
Validation loss decreased (-0.333311 --> -0.422202).  Saving model ...
Epoch: 5 cost time: 1.0370984077453613
Epoch: 5, Steps: 12 | Train Loss: 1.953 Vali Loss: 1.874 Vali Acc: 0.500 Test Loss: 1.874 Test Acc: 0.500
Validation loss decreased (-0.422202 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 1.0676419734954834
Epoch: 6, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.702 Vali Acc: 0.533 Test Loss: 1.702 Test Acc: 0.533
Validation loss decreased (-0.499981 --> -0.533316).  Saving model ...
Epoch: 7 cost time: 1.0368483066558838
Epoch: 7, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.559 Vali Acc: 0.556 Test Loss: 1.559 Test Acc: 0.556
Validation loss decreased (-0.533316 --> -0.555540).  Saving model ...
Epoch: 8 cost time: 1.0010619163513184
Epoch: 8, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.471 Vali Acc: 0.578 Test Loss: 1.471 Test Acc: 0.578
Validation loss decreased (-0.555540 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 1.0439472198486328
Epoch: 9, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.389 Vali Acc: 0.600 Test Loss: 1.389 Test Acc: 0.600
Validation loss decreased (-0.577763 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 1.106480360031128
Epoch: 10, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.341 Vali Acc: 0.617 Test Loss: 1.341 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616653).  Saving model ...
Epoch: 11 cost time: 0.9886713027954102
Epoch: 11, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.296 Vali Acc: 0.589 Test Loss: 1.296 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0678844451904297
Epoch: 12, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.236 Vali Acc: 0.633 Test Loss: 1.236 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 1.1179404258728027
Epoch: 13, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.187 Vali Acc: 0.650 Test Loss: 1.187 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 1.1407551765441895
Epoch: 14, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.163 Vali Acc: 0.683 Test Loss: 1.163 Test Acc: 0.683
Validation loss decreased (-0.649988 --> -0.683322).  Saving model ...
Epoch: 15 cost time: 1.0926389694213867
Epoch: 15, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.124 Vali Acc: 0.689 Test Loss: 1.124 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 16 cost time: 1.0525002479553223
Epoch: 16, Steps: 12 | Train Loss: 0.685 Vali Loss: 1.097 Vali Acc: 0.694 Test Loss: 1.097 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694433).  Saving model ...
Epoch: 17 cost time: 1.1215949058532715
Epoch: 17, Steps: 12 | Train Loss: 0.557 Vali Loss: 1.031 Vali Acc: 0.728 Test Loss: 1.031 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727767).  Saving model ...
Epoch: 18 cost time: 1.0531401634216309
Epoch: 18, Steps: 12 | Train Loss: 0.478 Vali Loss: 1.020 Vali Acc: 0.700 Test Loss: 1.020 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9482839107513428
Epoch: 19, Steps: 12 | Train Loss: 0.514 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1945674419403076
Epoch: 20, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.990 Vali Acc: 0.739 Test Loss: 0.990 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 21 cost time: 1.0165770053863525
Epoch: 21, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.980 Vali Acc: 0.750 Test Loss: 0.980 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 1.0686087608337402
Epoch: 22, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.969 Vali Acc: 0.739 Test Loss: 0.969 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0211737155914307
Epoch: 23, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.972 Vali Acc: 0.750 Test Loss: 0.972 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 24 cost time: 0.9968852996826172
Epoch: 24, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.965 Vali Acc: 0.728 Test Loss: 0.965 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.943640947341919
Epoch: 25, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.966 Vali Acc: 0.728 Test Loss: 0.966 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9784359931945801
Epoch: 26, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.974 Vali Acc: 0.739 Test Loss: 0.974 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1131868362426758
Epoch: 27, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.980 Vali Acc: 0.728 Test Loss: 0.980 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0517618656158447
Epoch: 28, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2168114185333252
Epoch: 29, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.007 Vali Acc: 0.739 Test Loss: 1.007 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0224919319152832
Epoch: 30, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.980 Vali Acc: 0.744 Test Loss: 0.980 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0644876956939697
Epoch: 31, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.027 Vali Acc: 0.744 Test Loss: 1.027 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9831228256225586
Epoch: 32, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.033 Vali Acc: 0.728 Test Loss: 1.033 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0950381755828857
Epoch: 33, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.024 Vali Acc: 0.733 Test Loss: 1.024 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 47887
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.34348201751709
Epoch: 1, Steps: 12 | Train Loss: 2.893 Vali Loss: 2.665 Vali Acc: 0.156 Test Loss: 2.665 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.255652904510498
Epoch: 2, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.454 Vali Acc: 0.267 Test Loss: 2.454 Test Acc: 0.267
Validation loss decreased (-0.155529 --> -0.266642).  Saving model ...
Epoch: 3 cost time: 1.1708853244781494
Epoch: 3, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.194 Vali Acc: 0.472 Test Loss: 2.194 Test Acc: 0.472
Validation loss decreased (-0.266642 --> -0.472200).  Saving model ...
Epoch: 4 cost time: 1.265401840209961
Epoch: 4, Steps: 12 | Train Loss: 2.105 Vali Loss: 1.972 Vali Acc: 0.472 Test Loss: 1.972 Test Acc: 0.472
Validation loss decreased (-0.472200 --> -0.472203).  Saving model ...
Epoch: 5 cost time: 1.2403192520141602
Epoch: 5, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.794 Vali Acc: 0.544 Test Loss: 1.794 Test Acc: 0.544
Validation loss decreased (-0.472203 --> -0.544427).  Saving model ...
Epoch: 6 cost time: 1.1095576286315918
Epoch: 6, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.626 Vali Acc: 0.550 Test Loss: 1.626 Test Acc: 0.550
Validation loss decreased (-0.544427 --> -0.549984).  Saving model ...
Epoch: 7 cost time: 0.9773609638214111
Epoch: 7, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.517 Vali Acc: 0.589 Test Loss: 1.517 Test Acc: 0.589
Validation loss decreased (-0.549984 --> -0.588874).  Saving model ...
Epoch: 8 cost time: 1.1483328342437744
Epoch: 8, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.435 Vali Acc: 0.600 Test Loss: 1.435 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 9 cost time: 1.2775006294250488
Epoch: 9, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.362 Vali Acc: 0.600 Test Loss: 1.362 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 1.3499135971069336
Epoch: 10, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.295 Vali Acc: 0.639 Test Loss: 1.295 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638876).  Saving model ...
Epoch: 11 cost time: 1.1622138023376465
Epoch: 11, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.255 Vali Acc: 0.639 Test Loss: 1.255 Test Acc: 0.639
Validation loss decreased (-0.638876 --> -0.638876).  Saving model ...
Epoch: 12 cost time: 1.2651071548461914
Epoch: 12, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.223 Vali Acc: 0.656 Test Loss: 1.223 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655543).  Saving model ...
Epoch: 13 cost time: 1.152343511581421
Epoch: 13, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.180 Vali Acc: 0.656 Test Loss: 1.180 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 1.1761338710784912
Epoch: 14, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.108 Vali Acc: 0.672 Test Loss: 1.108 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672211).  Saving model ...
Epoch: 15 cost time: 1.1050100326538086
Epoch: 15, Steps: 12 | Train Loss: 0.642 Vali Loss: 1.097 Vali Acc: 0.672 Test Loss: 1.097 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 16 cost time: 1.0522420406341553
Epoch: 16, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.079 Vali Acc: 0.683 Test Loss: 1.079 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 17 cost time: 1.2177128791809082
Epoch: 17, Steps: 12 | Train Loss: 0.544 Vali Loss: 1.051 Vali Acc: 0.694 Test Loss: 1.051 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694434).  Saving model ...
Epoch: 18 cost time: 1.3764612674713135
Epoch: 18, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.011 Vali Acc: 0.717 Test Loss: 1.011 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 19 cost time: 1.2304408550262451
Epoch: 19, Steps: 12 | Train Loss: 0.478 Vali Loss: 1.002 Vali Acc: 0.728 Test Loss: 1.002 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 20 cost time: 1.2812671661376953
Epoch: 20, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.995 Vali Acc: 0.728 Test Loss: 0.995 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 21 cost time: 1.2969520092010498
Epoch: 21, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1438729763031006
Epoch: 22, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.955 Vali Acc: 0.733 Test Loss: 0.955 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 23 cost time: 1.1219072341918945
Epoch: 23, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.946 Vali Acc: 0.739 Test Loss: 0.946 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 24 cost time: 1.224595308303833
Epoch: 24, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1480491161346436
Epoch: 25, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.964 Vali Acc: 0.722 Test Loss: 0.964 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0544557571411133
Epoch: 26, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.942 Vali Acc: 0.739 Test Loss: 0.942 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 27 cost time: 1.0433344841003418
Epoch: 27, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.957 Vali Acc: 0.744 Test Loss: 0.957 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 28 cost time: 1.2550158500671387
Epoch: 28, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.987 Vali Acc: 0.744 Test Loss: 0.987 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2619547843933105
Epoch: 29, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 30 cost time: 1.279496192932129
Epoch: 30, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.994 Vali Acc: 0.744 Test Loss: 0.994 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0156750679016113
Epoch: 31, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.016 Vali Acc: 0.756 Test Loss: 1.016 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755545).  Saving model ...
Epoch: 32 cost time: 1.151540994644165
Epoch: 32, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.034 Vali Acc: 0.750 Test Loss: 1.034 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.222304344177246
Epoch: 33, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.008 Vali Acc: 0.756 Test Loss: 1.008 Test Acc: 0.756
Validation loss decreased (-0.755545 --> -0.755545).  Saving model ...
Epoch: 34 cost time: 1.0743482112884521
Epoch: 34, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.027 Vali Acc: 0.756 Test Loss: 1.027 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3427505493164062
Epoch: 35, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.043 Vali Acc: 0.739 Test Loss: 1.043 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1768386363983154
Epoch: 36, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.062 Vali Acc: 0.739 Test Loss: 1.062 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1391658782958984
Epoch: 37, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.069 Vali Acc: 0.744 Test Loss: 1.069 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3304452896118164
Epoch: 38, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.081 Vali Acc: 0.756 Test Loss: 1.081 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0702669620513916
Epoch: 39, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.076 Vali Acc: 0.739 Test Loss: 1.076 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.113325834274292
Epoch: 40, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.088 Vali Acc: 0.728 Test Loss: 1.088 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2572875022888184
Epoch: 41, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.106 Vali Acc: 0.756 Test Loss: 1.106 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1695799827575684
Epoch: 42, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.116 Vali Acc: 0.744 Test Loss: 1.116 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.099020004272461
Epoch: 43, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.152 Vali Acc: 0.750 Test Loss: 1.152 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 46959
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7563772201538086
Epoch: 1, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.686 Vali Acc: 0.133 Test Loss: 2.686 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 1.2076890468597412
Epoch: 2, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.523 Vali Acc: 0.222 Test Loss: 2.523 Test Acc: 0.222
Validation loss decreased (-0.133306 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 1.2499020099639893
Epoch: 3, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.325 Vali Acc: 0.339 Test Loss: 2.325 Test Acc: 0.339
Validation loss decreased (-0.222197 --> -0.338866).  Saving model ...
Epoch: 4 cost time: 1.1348793506622314
Epoch: 4, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.127 Vali Acc: 0.428 Test Loss: 2.127 Test Acc: 0.428
Validation loss decreased (-0.338866 --> -0.427757).  Saving model ...
Epoch: 5 cost time: 1.238933801651001
Epoch: 5, Steps: 12 | Train Loss: 2.010 Vali Loss: 1.942 Vali Acc: 0.467 Test Loss: 1.942 Test Acc: 0.467
Validation loss decreased (-0.427757 --> -0.466647).  Saving model ...
Epoch: 6 cost time: 1.1475207805633545
Epoch: 6, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.790 Vali Acc: 0.483 Test Loss: 1.790 Test Acc: 0.483
Validation loss decreased (-0.466647 --> -0.483315).  Saving model ...
Epoch: 7 cost time: 1.120490312576294
Epoch: 7, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.673 Vali Acc: 0.517 Test Loss: 1.673 Test Acc: 0.517
Validation loss decreased (-0.483315 --> -0.516650).  Saving model ...
Epoch: 8 cost time: 1.1437759399414062
Epoch: 8, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.584 Vali Acc: 0.544 Test Loss: 1.584 Test Acc: 0.544
Validation loss decreased (-0.516650 --> -0.544429).  Saving model ...
Epoch: 9 cost time: 1.0962035655975342
Epoch: 9, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.491 Vali Acc: 0.556 Test Loss: 1.491 Test Acc: 0.556
Validation loss decreased (-0.544429 --> -0.555541).  Saving model ...
Epoch: 10 cost time: 1.2125120162963867
Epoch: 10, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.434 Vali Acc: 0.567 Test Loss: 1.434 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566652).  Saving model ...
Epoch: 11 cost time: 1.2321856021881104
Epoch: 11, Steps: 12 | Train Loss: 1.114 Vali Loss: 1.387 Vali Acc: 0.583 Test Loss: 1.387 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583319).  Saving model ...
Epoch: 12 cost time: 0.9535529613494873
Epoch: 12, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.339 Vali Acc: 0.611 Test Loss: 1.339 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611098).  Saving model ...
Epoch: 13 cost time: 1.0403292179107666
Epoch: 13, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.285 Vali Acc: 0.633 Test Loss: 1.285 Test Acc: 0.633
Validation loss decreased (-0.611098 --> -0.633320).  Saving model ...
Epoch: 14 cost time: 1.2465541362762451
Epoch: 14, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.244 Vali Acc: 0.650 Test Loss: 1.244 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 1.2284579277038574
Epoch: 15, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.222 Vali Acc: 0.656 Test Loss: 1.222 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655543).  Saving model ...
Epoch: 16 cost time: 1.3225674629211426
Epoch: 16, Steps: 12 | Train Loss: 0.751 Vali Loss: 1.185 Vali Acc: 0.656 Test Loss: 1.185 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 17 cost time: 1.154797077178955
Epoch: 17, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.153 Vali Acc: 0.661 Test Loss: 1.153 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 18 cost time: 1.0878729820251465
Epoch: 18, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.124 Vali Acc: 0.667 Test Loss: 1.124 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666655).  Saving model ...
Epoch: 19 cost time: 1.2321867942810059
Epoch: 19, Steps: 12 | Train Loss: 0.611 Vali Loss: 1.107 Vali Acc: 0.644 Test Loss: 1.107 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2378733158111572
Epoch: 20, Steps: 12 | Train Loss: 0.551 Vali Loss: 1.072 Vali Acc: 0.678 Test Loss: 1.072 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 21 cost time: 0.975193977355957
Epoch: 21, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.038 Vali Acc: 0.683 Test Loss: 1.038 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 22 cost time: 1.3099000453948975
Epoch: 22, Steps: 12 | Train Loss: 0.474 Vali Loss: 1.010 Vali Acc: 0.706 Test Loss: 1.010 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705545).  Saving model ...
Epoch: 23 cost time: 1.347724437713623
Epoch: 23, Steps: 12 | Train Loss: 0.444 Vali Loss: 1.018 Vali Acc: 0.667 Test Loss: 1.018 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.909071683883667
Epoch: 24, Steps: 12 | Train Loss: 0.458 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4803047180175781
Epoch: 25, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.977 Vali Acc: 0.706 Test Loss: 0.977 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705546).  Saving model ...
Epoch: 26 cost time: 1.4304523468017578
Epoch: 26, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727768).  Saving model ...
Epoch: 27 cost time: 1.3362154960632324
Epoch: 27, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.966 Vali Acc: 0.733 Test Loss: 0.966 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 28 cost time: 1.392580509185791
Epoch: 28, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4362335205078125
Epoch: 29, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.971 Vali Acc: 0.717 Test Loss: 0.971 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.400456190109253
Epoch: 30, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.945 Vali Acc: 0.711 Test Loss: 0.945 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3080530166625977
Epoch: 31, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.954 Vali Acc: 0.739 Test Loss: 0.954 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 32 cost time: 1.2139885425567627
Epoch: 32, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.948 Vali Acc: 0.733 Test Loss: 0.948 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2175073623657227
Epoch: 33, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1099796295166016
Epoch: 34, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.964 Vali Acc: 0.728 Test Loss: 0.964 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2321949005126953
Epoch: 35, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2325522899627686
Epoch: 36, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.946 Vali Acc: 0.722 Test Loss: 0.946 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1713011264801025
Epoch: 37, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.954 Vali Acc: 0.717 Test Loss: 0.954 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0886588096618652
Epoch: 38, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.966 Vali Acc: 0.733 Test Loss: 0.966 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1976189613342285
Epoch: 39, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.983 Vali Acc: 0.722 Test Loss: 0.983 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1571083068847656
Epoch: 40, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.967 Vali Acc: 0.733 Test Loss: 0.967 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1609838008880615
Epoch: 41, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.989 Vali Acc: 0.717 Test Loss: 0.989 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 40271
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.830568313598633
Epoch: 1, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.654 Vali Acc: 0.056 Test Loss: 2.654 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 1.3542759418487549
Epoch: 2, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.517 Vali Acc: 0.128 Test Loss: 2.517 Test Acc: 0.128
Validation loss decreased (-0.055529 --> -0.127753).  Saving model ...
Epoch: 3 cost time: 1.198763370513916
Epoch: 3, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.362 Vali Acc: 0.222 Test Loss: 2.362 Test Acc: 0.222
Validation loss decreased (-0.127753 --> -0.222199).  Saving model ...
Epoch: 4 cost time: 1.1385228633880615
Epoch: 4, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.206 Vali Acc: 0.333 Test Loss: 2.206 Test Acc: 0.333
Validation loss decreased (-0.222199 --> -0.333311).  Saving model ...
Epoch: 5 cost time: 1.1765520572662354
Epoch: 5, Steps: 12 | Train Loss: 2.188 Vali Loss: 2.055 Vali Acc: 0.439 Test Loss: 2.055 Test Acc: 0.439
Validation loss decreased (-0.333311 --> -0.438868).  Saving model ...
Epoch: 6 cost time: 1.087017297744751
Epoch: 6, Steps: 12 | Train Loss: 2.024 Vali Loss: 1.915 Vali Acc: 0.489 Test Loss: 1.915 Test Acc: 0.489
Validation loss decreased (-0.438868 --> -0.488870).  Saving model ...
Epoch: 7 cost time: 1.1864778995513916
Epoch: 7, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.798 Vali Acc: 0.522 Test Loss: 1.798 Test Acc: 0.522
Validation loss decreased (-0.488870 --> -0.522204).  Saving model ...
Epoch: 8 cost time: 1.1441218852996826
Epoch: 8, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.695 Vali Acc: 0.517 Test Loss: 1.695 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.211258888244629
Epoch: 9, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.617 Vali Acc: 0.539 Test Loss: 1.617 Test Acc: 0.539
Validation loss decreased (-0.522204 --> -0.538873).  Saving model ...
Epoch: 10 cost time: 1.3352203369140625
Epoch: 10, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.543 Vali Acc: 0.550 Test Loss: 1.543 Test Acc: 0.550
Validation loss decreased (-0.538873 --> -0.549985).  Saving model ...
Epoch: 11 cost time: 1.1678833961486816
Epoch: 11, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.491 Vali Acc: 0.578 Test Loss: 1.491 Test Acc: 0.578
Validation loss decreased (-0.549985 --> -0.577763).  Saving model ...
Epoch: 12 cost time: 1.0929646492004395
Epoch: 12, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.433 Vali Acc: 0.572 Test Loss: 1.433 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3904235363006592
Epoch: 13, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.391 Vali Acc: 0.589 Test Loss: 1.391 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588875).  Saving model ...
Epoch: 14 cost time: 1.212615728378296
Epoch: 14, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.346 Vali Acc: 0.583 Test Loss: 1.346 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2461986541748047
Epoch: 15, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.317 Vali Acc: 0.567 Test Loss: 1.317 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2101414203643799
Epoch: 16, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.289 Vali Acc: 0.589 Test Loss: 1.289 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588876).  Saving model ...
Epoch: 17 cost time: 1.2778351306915283
Epoch: 17, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.255 Vali Acc: 0.622 Test Loss: 1.255 Test Acc: 0.622
Validation loss decreased (-0.588876 --> -0.622210).  Saving model ...
Epoch: 18 cost time: 1.2912461757659912
Epoch: 18, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.235 Vali Acc: 0.628 Test Loss: 1.235 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627765).  Saving model ...
Epoch: 19 cost time: 1.2057733535766602
Epoch: 19, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.198 Vali Acc: 0.661 Test Loss: 1.198 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661099).  Saving model ...
Epoch: 20 cost time: 1.2039082050323486
Epoch: 20, Steps: 12 | Train Loss: 0.787 Vali Loss: 1.160 Vali Acc: 0.672 Test Loss: 1.160 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 21 cost time: 1.2016937732696533
Epoch: 21, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.140 Vali Acc: 0.678 Test Loss: 1.140 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677766).  Saving model ...
Epoch: 22 cost time: 1.2868664264678955
Epoch: 22, Steps: 12 | Train Loss: 0.637 Vali Loss: 1.127 Vali Acc: 0.667 Test Loss: 1.127 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2544581890106201
Epoch: 23, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.101 Vali Acc: 0.678 Test Loss: 1.101 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677767).  Saving model ...
Epoch: 24 cost time: 1.2200558185577393
Epoch: 24, Steps: 12 | Train Loss: 0.564 Vali Loss: 1.061 Vali Acc: 0.678 Test Loss: 1.061 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 25 cost time: 1.2232375144958496
Epoch: 25, Steps: 12 | Train Loss: 0.535 Vali Loss: 1.037 Vali Acc: 0.694 Test Loss: 1.037 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 26 cost time: 1.1670494079589844
Epoch: 26, Steps: 12 | Train Loss: 0.504 Vali Loss: 1.027 Vali Acc: 0.711 Test Loss: 1.027 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 27 cost time: 1.1516008377075195
Epoch: 27, Steps: 12 | Train Loss: 0.491 Vali Loss: 1.009 Vali Acc: 0.750 Test Loss: 1.009 Test Acc: 0.750
Validation loss decreased (-0.711101 --> -0.749990).  Saving model ...
Epoch: 28 cost time: 1.2288012504577637
Epoch: 28, Steps: 12 | Train Loss: 0.457 Vali Loss: 1.008 Vali Acc: 0.711 Test Loss: 1.008 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2777915000915527
Epoch: 29, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.965 Vali Acc: 0.744 Test Loss: 0.965 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2652878761291504
Epoch: 30, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.950 Vali Acc: 0.744 Test Loss: 0.950 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.319638967514038
Epoch: 31, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.958 Vali Acc: 0.756 Test Loss: 0.958 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 32 cost time: 1.2604634761810303
Epoch: 32, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.949 Vali Acc: 0.761 Test Loss: 0.949 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 33 cost time: 1.186248779296875
Epoch: 33, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.209444284439087
Epoch: 34, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.928 Vali Acc: 0.756 Test Loss: 0.928 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2186343669891357
Epoch: 35, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.924 Vali Acc: 0.761 Test Loss: 0.924 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 36 cost time: 1.333789587020874
Epoch: 36, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.939 Vali Acc: 0.739 Test Loss: 0.939 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2585904598236084
Epoch: 37, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.922 Vali Acc: 0.739 Test Loss: 0.922 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1977934837341309
Epoch: 38, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2221744060516357
Epoch: 39, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.920 Vali Acc: 0.761 Test Loss: 0.920 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 40 cost time: 1.2006487846374512
Epoch: 40, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1179134845733643
Epoch: 41, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.918 Vali Acc: 0.767 Test Loss: 0.918 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766657).  Saving model ...
Epoch: 42 cost time: 1.189237356185913
Epoch: 42, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.948 Vali Acc: 0.756 Test Loss: 0.948 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2695538997650146
Epoch: 43, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.912 Vali Acc: 0.767 Test Loss: 0.912 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766658).  Saving model ...
Epoch: 44 cost time: 1.2601094245910645
Epoch: 44, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.905 Vali Acc: 0.761 Test Loss: 0.905 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2904045581817627
Epoch: 45, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.924 Vali Acc: 0.772 Test Loss: 0.924 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772213).  Saving model ...
Epoch: 46 cost time: 1.3368780612945557
Epoch: 46, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.921 Vali Acc: 0.767 Test Loss: 0.921 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.393733024597168
Epoch: 47, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.922 Vali Acc: 0.756 Test Loss: 0.922 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2363598346710205
Epoch: 48, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.907 Vali Acc: 0.756 Test Loss: 0.907 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2353262901306152
Epoch: 49, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.913 Vali Acc: 0.761 Test Loss: 0.913 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1381404399871826
Epoch: 50, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.928 Vali Acc: 0.761 Test Loss: 0.928 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.23162841796875
Epoch: 51, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.930 Vali Acc: 0.772 Test Loss: 0.930 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.1305172443389893
Epoch: 52, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.935 Vali Acc: 0.761 Test Loss: 0.935 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0947692394256592
Epoch: 53, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.919 Vali Acc: 0.783 Test Loss: 0.919 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783324).  Saving model ...
Epoch: 54 cost time: 1.0230276584625244
Epoch: 54, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.927 Vali Acc: 0.783 Test Loss: 0.927 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.060797929763794
Epoch: 55, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.944 Vali Acc: 0.761 Test Loss: 0.944 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1924805641174316
Epoch: 56, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.957 Vali Acc: 0.761 Test Loss: 0.957 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.3221385478973389
Epoch: 57, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.956 Vali Acc: 0.767 Test Loss: 0.956 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.190896987915039
Epoch: 58, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.936 Vali Acc: 0.772 Test Loss: 0.936 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.0117998123168945
Epoch: 59, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.926 Vali Acc: 0.800 Test Loss: 0.926 Test Acc: 0.800
Validation loss decreased (-0.783324 --> -0.799991).  Saving model ...
Epoch: 60 cost time: 1.203441858291626
Epoch: 60, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.936 Vali Acc: 0.783 Test Loss: 0.936 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.210963487625122
Epoch: 61, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.956 Vali Acc: 0.767 Test Loss: 0.956 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2934789657592773
Epoch: 62, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.947 Vali Acc: 0.772 Test Loss: 0.947 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.2926008701324463
Epoch: 63, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.933 Vali Acc: 0.789 Test Loss: 0.933 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.019876480102539
Epoch: 64, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.940 Vali Acc: 0.783 Test Loss: 0.940 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.1775104999542236
Epoch: 65, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.955 Vali Acc: 0.772 Test Loss: 0.955 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.2069299221038818
Epoch: 66, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.952 Vali Acc: 0.789 Test Loss: 0.952 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.313662052154541
Epoch: 67, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.965 Vali Acc: 0.783 Test Loss: 0.965 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.167959213256836
Epoch: 68, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.990 Vali Acc: 0.778 Test Loss: 0.990 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.1421000957489014
Epoch: 69, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.985 Vali Acc: 0.789 Test Loss: 0.985 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 36495
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6835131645202637
Epoch: 1, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.690 Vali Acc: 0.156 Test Loss: 2.690 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.2162461280822754
Epoch: 2, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.569 Vali Acc: 0.172 Test Loss: 2.569 Test Acc: 0.172
Validation loss decreased (-0.155529 --> -0.172197).  Saving model ...
Epoch: 3 cost time: 1.085144281387329
Epoch: 3, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.428 Vali Acc: 0.261 Test Loss: 2.428 Test Acc: 0.261
Validation loss decreased (-0.172197 --> -0.261087).  Saving model ...
Epoch: 4 cost time: 1.0597121715545654
Epoch: 4, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.265 Vali Acc: 0.311 Test Loss: 2.265 Test Acc: 0.311
Validation loss decreased (-0.261087 --> -0.311088).  Saving model ...
Epoch: 5 cost time: 1.0786705017089844
Epoch: 5, Steps: 12 | Train Loss: 2.261 Vali Loss: 2.119 Vali Acc: 0.367 Test Loss: 2.119 Test Acc: 0.367
Validation loss decreased (-0.311088 --> -0.366645).  Saving model ...
Epoch: 6 cost time: 1.0840613842010498
Epoch: 6, Steps: 12 | Train Loss: 2.054 Vali Loss: 1.979 Vali Acc: 0.417 Test Loss: 1.979 Test Acc: 0.417
Validation loss decreased (-0.366645 --> -0.416647).  Saving model ...
Epoch: 7 cost time: 1.0664381980895996
Epoch: 7, Steps: 12 | Train Loss: 1.915 Vali Loss: 1.862 Vali Acc: 0.472 Test Loss: 1.862 Test Acc: 0.472
Validation loss decreased (-0.416647 --> -0.472204).  Saving model ...
Epoch: 8 cost time: 1.1117393970489502
Epoch: 8, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.752 Vali Acc: 0.517 Test Loss: 1.752 Test Acc: 0.517
Validation loss decreased (-0.472204 --> -0.516649).  Saving model ...
Epoch: 9 cost time: 1.1278457641601562
Epoch: 9, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.665 Vali Acc: 0.528 Test Loss: 1.665 Test Acc: 0.528
Validation loss decreased (-0.516649 --> -0.527761).  Saving model ...
Epoch: 10 cost time: 1.1192266941070557
Epoch: 10, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.595 Vali Acc: 0.550 Test Loss: 1.595 Test Acc: 0.550
Validation loss decreased (-0.527761 --> -0.549984).  Saving model ...
Epoch: 11 cost time: 1.0629315376281738
Epoch: 11, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.508 Vali Acc: 0.556 Test Loss: 1.508 Test Acc: 0.556
Validation loss decreased (-0.549984 --> -0.555540).  Saving model ...
Epoch: 12 cost time: 1.0615870952606201
Epoch: 12, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.437 Vali Acc: 0.583 Test Loss: 1.437 Test Acc: 0.583
Validation loss decreased (-0.555540 --> -0.583319).  Saving model ...
Epoch: 13 cost time: 1.0958733558654785
Epoch: 13, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.368 Vali Acc: 0.611 Test Loss: 1.368 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611097).  Saving model ...
Epoch: 14 cost time: 1.0583033561706543
Epoch: 14, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.307 Vali Acc: 0.617 Test Loss: 1.307 Test Acc: 0.617
Validation loss decreased (-0.611097 --> -0.616654).  Saving model ...
Epoch: 15 cost time: 1.1624133586883545
Epoch: 15, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.247 Vali Acc: 0.633 Test Loss: 1.247 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 1.1033670902252197
Epoch: 16, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.186 Vali Acc: 0.633 Test Loss: 1.186 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 17 cost time: 1.2574901580810547
Epoch: 17, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 1.0369648933410645
Epoch: 18, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.083 Vali Acc: 0.661 Test Loss: 1.083 Test Acc: 0.661
Validation loss decreased (-0.649989 --> -0.661100).  Saving model ...
Epoch: 19 cost time: 1.1849088668823242
Epoch: 19, Steps: 12 | Train Loss: 0.765 Vali Loss: 1.038 Vali Acc: 0.644 Test Loss: 1.038 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1925899982452393
Epoch: 20, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 1.2309174537658691
Epoch: 21, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.962 Vali Acc: 0.672 Test Loss: 0.962 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 22 cost time: 1.1814053058624268
Epoch: 22, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.937 Vali Acc: 0.689 Test Loss: 0.937 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688880).  Saving model ...
Epoch: 23 cost time: 1.1736640930175781
Epoch: 23, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.934 Vali Acc: 0.678 Test Loss: 0.934 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1187324523925781
Epoch: 24, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.894 Vali Acc: 0.694 Test Loss: 0.894 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694435).  Saving model ...
Epoch: 25 cost time: 1.1168646812438965
Epoch: 25, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 26 cost time: 1.0859289169311523
Epoch: 26, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.865 Vali Acc: 0.694 Test Loss: 0.865 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.101562738418579
Epoch: 27, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.846 Vali Acc: 0.711 Test Loss: 0.846 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
Epoch: 28 cost time: 1.1029882431030273
Epoch: 28, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.851 Vali Acc: 0.722 Test Loss: 0.851 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722214).  Saving model ...
Epoch: 29 cost time: 1.1113595962524414
Epoch: 29, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.844 Vali Acc: 0.728 Test Loss: 0.844 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727769).  Saving model ...
Epoch: 30 cost time: 1.0741665363311768
Epoch: 30, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.827 Vali Acc: 0.733 Test Loss: 0.827 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 31 cost time: 1.1670708656311035
Epoch: 31, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.838 Vali Acc: 0.733 Test Loss: 0.838 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.157747507095337
Epoch: 32, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.830 Vali Acc: 0.722 Test Loss: 0.830 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1620213985443115
Epoch: 33, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.800 Vali Acc: 0.744 Test Loss: 0.800 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 34 cost time: 1.1091578006744385
Epoch: 34, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.799 Vali Acc: 0.744 Test Loss: 0.799 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 35 cost time: 1.0755763053894043
Epoch: 35, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 36 cost time: 1.0858871936798096
Epoch: 36, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.802 Vali Acc: 0.744 Test Loss: 0.802 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0992317199707031
Epoch: 37, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 38 cost time: 1.1055455207824707
Epoch: 38, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 1.126542091369629
Epoch: 39, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.794 Vali Acc: 0.756 Test Loss: 0.794 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 40 cost time: 1.1204392910003662
Epoch: 40, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.073800802230835
Epoch: 41, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.028461217880249
Epoch: 42, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.809 Vali Acc: 0.728 Test Loss: 0.809 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0492675304412842
Epoch: 43, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.798 Vali Acc: 0.750 Test Loss: 0.798 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1605308055877686
Epoch: 44, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.213043212890625
Epoch: 45, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.801 Vali Acc: 0.733 Test Loss: 0.801 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1326494216918945
Epoch: 46, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.789 Vali Acc: 0.744 Test Loss: 0.789 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1460843086242676
Epoch: 47, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.820 Vali Acc: 0.739 Test Loss: 0.820 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1101100444793701
Epoch: 48, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.819 Vali Acc: 0.739 Test Loss: 0.819 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.1054375171661377
Epoch: 49, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.784 Vali Acc: 0.744 Test Loss: 0.784 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 34639
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8366007804870605
Epoch: 1, Steps: 12 | Train Loss: 2.920 Vali Loss: 2.813 Vali Acc: 0.028 Test Loss: 2.813 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 1.106896162033081
Epoch: 2, Steps: 12 | Train Loss: 2.900 Vali Loss: 2.729 Vali Acc: 0.106 Test Loss: 2.729 Test Acc: 0.106
Validation loss decreased (-0.027750 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 1.0340828895568848
Epoch: 3, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.616 Vali Acc: 0.156 Test Loss: 2.616 Test Acc: 0.156
Validation loss decreased (-0.105528 --> -0.155529).  Saving model ...
Epoch: 4 cost time: 1.0506813526153564
Epoch: 4, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.488 Vali Acc: 0.222 Test Loss: 2.488 Test Acc: 0.222
Validation loss decreased (-0.155529 --> -0.222197).  Saving model ...
Epoch: 5 cost time: 1.0227546691894531
Epoch: 5, Steps: 12 | Train Loss: 2.494 Vali Loss: 2.352 Vali Acc: 0.272 Test Loss: 2.352 Test Acc: 0.272
Validation loss decreased (-0.222197 --> -0.272199).  Saving model ...
Epoch: 6 cost time: 1.0189123153686523
Epoch: 6, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.211 Vali Acc: 0.344 Test Loss: 2.211 Test Acc: 0.344
Validation loss decreased (-0.272199 --> -0.344422).  Saving model ...
Epoch: 7 cost time: 1.169391393661499
Epoch: 7, Steps: 12 | Train Loss: 2.288 Vali Loss: 2.080 Vali Acc: 0.422 Test Loss: 2.080 Test Acc: 0.422
Validation loss decreased (-0.344422 --> -0.422201).  Saving model ...
Epoch: 8 cost time: 1.0483415126800537
Epoch: 8, Steps: 12 | Train Loss: 2.153 Vali Loss: 1.963 Vali Acc: 0.467 Test Loss: 1.963 Test Acc: 0.467
Validation loss decreased (-0.422201 --> -0.466647).  Saving model ...
Epoch: 9 cost time: 1.1062500476837158
Epoch: 9, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.862 Vali Acc: 0.511 Test Loss: 1.862 Test Acc: 0.511
Validation loss decreased (-0.466647 --> -0.511092).  Saving model ...
Epoch: 10 cost time: 1.0332741737365723
Epoch: 10, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.763 Vali Acc: 0.533 Test Loss: 1.763 Test Acc: 0.533
Validation loss decreased (-0.511092 --> -0.533316).  Saving model ...
Epoch: 11 cost time: 1.0530123710632324
Epoch: 11, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.674 Vali Acc: 0.572 Test Loss: 1.674 Test Acc: 0.572
Validation loss decreased (-0.533316 --> -0.572205).  Saving model ...
Epoch: 12 cost time: 1.1910290718078613
Epoch: 12, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.607 Vali Acc: 0.578 Test Loss: 1.607 Test Acc: 0.578
Validation loss decreased (-0.572205 --> -0.577762).  Saving model ...
Epoch: 13 cost time: 1.198089361190796
Epoch: 13, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.532 Vali Acc: 0.583 Test Loss: 1.532 Test Acc: 0.583
Validation loss decreased (-0.577762 --> -0.583318).  Saving model ...
Epoch: 14 cost time: 0.9359254837036133
Epoch: 14, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.475 Vali Acc: 0.578 Test Loss: 1.475 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.086836338043213
Epoch: 15, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.429 Vali Acc: 0.572 Test Loss: 1.429 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0489099025726318
Epoch: 16, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.373 Vali Acc: 0.589 Test Loss: 1.373 Test Acc: 0.589
Validation loss decreased (-0.583318 --> -0.588875).  Saving model ...
Epoch: 17 cost time: 0.9859921932220459
Epoch: 17, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.306 Vali Acc: 0.611 Test Loss: 1.306 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611098).  Saving model ...
Epoch: 18 cost time: 1.063180923461914
Epoch: 18, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.256 Vali Acc: 0.606 Test Loss: 1.256 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1035113334655762
Epoch: 19, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.192 Vali Acc: 0.606 Test Loss: 1.192 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.001718282699585
Epoch: 20, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.136 Vali Acc: 0.622 Test Loss: 1.136 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622211).  Saving model ...
Epoch: 21 cost time: 1.0904581546783447
Epoch: 21, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.9101150035858154
Epoch: 22, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.053 Vali Acc: 0.656 Test Loss: 1.053 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 23 cost time: 1.0011310577392578
Epoch: 23, Steps: 12 | Train Loss: 0.727 Vali Loss: 1.025 Vali Acc: 0.678 Test Loss: 1.025 Test Acc: 0.678
Validation loss decreased (-0.655545 --> -0.677768).  Saving model ...
Epoch: 24 cost time: 1.1730811595916748
Epoch: 24, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.992 Vali Acc: 0.661 Test Loss: 0.992 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9722819328308105
Epoch: 25, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.964 Vali Acc: 0.667 Test Loss: 0.964 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0259873867034912
Epoch: 26, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.941 Vali Acc: 0.656 Test Loss: 0.941 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9709341526031494
Epoch: 27, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.921 Vali Acc: 0.706 Test Loss: 0.921 Test Acc: 0.706
Validation loss decreased (-0.677768 --> -0.705546).  Saving model ...
Epoch: 28 cost time: 0.9239726066589355
Epoch: 28, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.917 Vali Acc: 0.689 Test Loss: 0.917 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9192578792572021
Epoch: 29, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.893 Vali Acc: 0.706 Test Loss: 0.893 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705547).  Saving model ...
Epoch: 30 cost time: 0.9748716354370117
Epoch: 30, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.871 Vali Acc: 0.739 Test Loss: 0.871 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738880).  Saving model ...
Epoch: 31 cost time: 0.9846177101135254
Epoch: 31, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.869 Vali Acc: 0.722 Test Loss: 0.869 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9150228500366211
Epoch: 32, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.845 Vali Acc: 0.744 Test Loss: 0.845 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 33 cost time: 1.1062254905700684
Epoch: 33, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.852 Vali Acc: 0.728 Test Loss: 0.852 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9897141456604004
Epoch: 34, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.851 Vali Acc: 0.728 Test Loss: 0.851 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9547343254089355
Epoch: 35, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.836 Vali Acc: 0.744 Test Loss: 0.836 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 36 cost time: 0.9567689895629883
Epoch: 36, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.813 Vali Acc: 0.761 Test Loss: 0.813 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 37 cost time: 1.0366859436035156
Epoch: 37, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.819 Vali Acc: 0.761 Test Loss: 0.819 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0154545307159424
Epoch: 38, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.826 Vali Acc: 0.744 Test Loss: 0.826 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0378260612487793
Epoch: 39, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.809 Vali Acc: 0.744 Test Loss: 0.809 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.009211540222168
Epoch: 40, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 41 cost time: 0.9536089897155762
Epoch: 41, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.826 Vali Acc: 0.744 Test Loss: 0.826 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9447813034057617
Epoch: 42, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.821 Vali Acc: 0.744 Test Loss: 0.821 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0769309997558594
Epoch: 43, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9366588592529297
Epoch: 44, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.819 Vali Acc: 0.750 Test Loss: 0.819 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9298739433288574
Epoch: 45, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.809 Vali Acc: 0.744 Test Loss: 0.809 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9782037734985352
Epoch: 46, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.820 Vali Acc: 0.739 Test Loss: 0.820 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0043795108795166
Epoch: 47, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.792 Vali Acc: 0.744 Test Loss: 0.792 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9553630352020264
Epoch: 48, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9140229225158691
Epoch: 49, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9778854846954346
Epoch: 50, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.829 Vali Acc: 0.739 Test Loss: 0.829 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm32_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 32815
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.672769784927368
Epoch: 1, Steps: 12 | Train Loss: 2.846 Vali Loss: 2.705 Vali Acc: 0.111 Test Loss: 2.705 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.987971305847168
Epoch: 2, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.522 Vali Acc: 0.283 Test Loss: 2.522 Test Acc: 0.283
Validation loss decreased (-0.111084 --> -0.283308).  Saving model ...
Epoch: 3 cost time: 1.0067543983459473
Epoch: 3, Steps: 12 | Train Loss: 2.504 Vali Loss: 2.304 Vali Acc: 0.356 Test Loss: 2.304 Test Acc: 0.356
Validation loss decreased (-0.283308 --> -0.355533).  Saving model ...
Epoch: 4 cost time: 1.0202269554138184
Epoch: 4, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.079 Vali Acc: 0.444 Test Loss: 2.079 Test Acc: 0.444
Validation loss decreased (-0.355533 --> -0.444424).  Saving model ...
Epoch: 5 cost time: 1.0287415981292725
Epoch: 5, Steps: 12 | Train Loss: 2.031 Vali Loss: 1.861 Vali Acc: 0.522 Test Loss: 1.861 Test Acc: 0.522
Validation loss decreased (-0.444424 --> -0.522204).  Saving model ...
Epoch: 6 cost time: 1.0238397121429443
Epoch: 6, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.665 Vali Acc: 0.556 Test Loss: 1.665 Test Acc: 0.556
Validation loss decreased (-0.522204 --> -0.555539).  Saving model ...
Epoch: 7 cost time: 0.9478659629821777
Epoch: 7, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.520 Vali Acc: 0.567 Test Loss: 1.520 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566651).  Saving model ...
Epoch: 8 cost time: 1.0412602424621582
Epoch: 8, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.408 Vali Acc: 0.567 Test Loss: 1.408 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566653).  Saving model ...
Epoch: 9 cost time: 0.9626023769378662
Epoch: 9, Steps: 12 | Train Loss: 1.123 Vali Loss: 1.348 Vali Acc: 0.617 Test Loss: 1.348 Test Acc: 0.617
Validation loss decreased (-0.566653 --> -0.616653).  Saving model ...
Epoch: 10 cost time: 0.956956148147583
Epoch: 10, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.254 Vali Acc: 0.622 Test Loss: 1.254 Test Acc: 0.622
Validation loss decreased (-0.616653 --> -0.622210).  Saving model ...
Epoch: 11 cost time: 0.7728557586669922
Epoch: 11, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.202 Vali Acc: 0.633 Test Loss: 1.202 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 0.9604196548461914
Epoch: 12, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.170 Vali Acc: 0.628 Test Loss: 1.170 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9775238037109375
Epoch: 13, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.103 Vali Acc: 0.661 Test Loss: 1.103 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 1.0329930782318115
Epoch: 14, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.053 Vali Acc: 0.700 Test Loss: 1.053 Test Acc: 0.700
Validation loss decreased (-0.661100 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 1.0524559020996094
Epoch: 15, Steps: 12 | Train Loss: 0.598 Vali Loss: 1.005 Vali Acc: 0.694 Test Loss: 1.005 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1163454055786133
Epoch: 16, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.996 Vali Acc: 0.706 Test Loss: 0.996 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705546).  Saving model ...
Epoch: 17 cost time: 0.9995300769805908
Epoch: 17, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 18 cost time: 1.0554873943328857
Epoch: 18, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.961 Vali Acc: 0.733 Test Loss: 0.961 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 1.025719165802002
Epoch: 19, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.946 Vali Acc: 0.733 Test Loss: 0.946 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 20 cost time: 0.9950690269470215
Epoch: 20, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.945 Vali Acc: 0.733 Test Loss: 0.945 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 21 cost time: 0.9832503795623779
Epoch: 21, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.938 Vali Acc: 0.756 Test Loss: 0.938 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755546).  Saving model ...
Epoch: 22 cost time: 1.1111299991607666
Epoch: 22, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.945 Vali Acc: 0.744 Test Loss: 0.945 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.026759386062622
Epoch: 23, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.927 Vali Acc: 0.761 Test Loss: 0.927 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 24 cost time: 0.951113224029541
Epoch: 24, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.959 Vali Acc: 0.744 Test Loss: 0.959 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0659046173095703
Epoch: 25, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.07474684715271
Epoch: 26, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.991 Vali Acc: 0.756 Test Loss: 0.991 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0300683975219727
Epoch: 27, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.985 Vali Acc: 0.756 Test Loss: 0.985 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0671348571777344
Epoch: 28, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.995 Vali Acc: 0.761 Test Loss: 0.995 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0066852569580078
Epoch: 29, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.023 Vali Acc: 0.739 Test Loss: 1.023 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9408848285675049
Epoch: 30, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.018 Vali Acc: 0.756 Test Loss: 1.018 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0379598140716553
Epoch: 31, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.033 Vali Acc: 0.733 Test Loss: 1.033 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0503020286560059
Epoch: 32, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.040 Vali Acc: 0.756 Test Loss: 1.040 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0575511455535889
Epoch: 33, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.038 Vali Acc: 0.756 Test Loss: 1.038 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 50527
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5279030799865723
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.850 Vali Acc: 0.061 Test Loss: 2.850 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 0.979163408279419
Epoch: 2, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.712 Vali Acc: 0.111 Test Loss: 2.712 Test Acc: 0.111
Validation loss decreased (-0.061083 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 0.9648387432098389
Epoch: 3, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.530 Vali Acc: 0.150 Test Loss: 2.530 Test Acc: 0.150
Validation loss decreased (-0.111084 --> -0.149975).  Saving model ...
Epoch: 4 cost time: 1.0072667598724365
Epoch: 4, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.354 Vali Acc: 0.261 Test Loss: 2.354 Test Acc: 0.261
Validation loss decreased (-0.149975 --> -0.261088).  Saving model ...
Epoch: 5 cost time: 1.0545625686645508
Epoch: 5, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.181 Vali Acc: 0.322 Test Loss: 2.181 Test Acc: 0.322
Validation loss decreased (-0.261088 --> -0.322200).  Saving model ...
Epoch: 6 cost time: 0.9799830913543701
Epoch: 6, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.027 Vali Acc: 0.406 Test Loss: 2.027 Test Acc: 0.406
Validation loss decreased (-0.322200 --> -0.405535).  Saving model ...
Epoch: 7 cost time: 1.037022352218628
Epoch: 7, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.876 Vali Acc: 0.467 Test Loss: 1.876 Test Acc: 0.467
Validation loss decreased (-0.405535 --> -0.466648).  Saving model ...
Epoch: 8 cost time: 1.1356441974639893
Epoch: 8, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.745 Vali Acc: 0.528 Test Loss: 1.745 Test Acc: 0.528
Validation loss decreased (-0.466648 --> -0.527760).  Saving model ...
Epoch: 9 cost time: 0.9853169918060303
Epoch: 9, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.634 Vali Acc: 0.533 Test Loss: 1.634 Test Acc: 0.533
Validation loss decreased (-0.527760 --> -0.533317).  Saving model ...
Epoch: 10 cost time: 0.9716062545776367
Epoch: 10, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.550 Vali Acc: 0.550 Test Loss: 1.550 Test Acc: 0.550
Validation loss decreased (-0.533317 --> -0.549985).  Saving model ...
Epoch: 11 cost time: 0.9283444881439209
Epoch: 11, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.465 Vali Acc: 0.594 Test Loss: 1.465 Test Acc: 0.594
Validation loss decreased (-0.549985 --> -0.594430).  Saving model ...
Epoch: 12 cost time: 0.9303185939788818
Epoch: 12, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.403 Vali Acc: 0.600 Test Loss: 1.403 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 1.005871295928955
Epoch: 13, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.337 Vali Acc: 0.611 Test Loss: 1.337 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 14 cost time: 0.8822031021118164
Epoch: 14, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.293 Vali Acc: 0.628 Test Loss: 1.293 Test Acc: 0.628
Validation loss decreased (-0.611098 --> -0.627765).  Saving model ...
Epoch: 15 cost time: 0.8794040679931641
Epoch: 15, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.251 Vali Acc: 0.656 Test Loss: 1.251 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655543).  Saving model ...
Epoch: 16 cost time: 0.9934930801391602
Epoch: 16, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.224 Vali Acc: 0.667 Test Loss: 1.224 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666654).  Saving model ...
Epoch: 17 cost time: 0.9262089729309082
Epoch: 17, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.178 Vali Acc: 0.672 Test Loss: 1.178 Test Acc: 0.672
Validation loss decreased (-0.666654 --> -0.672210).  Saving model ...
Epoch: 18 cost time: 0.9783909320831299
Epoch: 18, Steps: 12 | Train Loss: 0.727 Vali Loss: 1.147 Vali Acc: 0.683 Test Loss: 1.147 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 19 cost time: 0.9691512584686279
Epoch: 19, Steps: 12 | Train Loss: 0.677 Vali Loss: 1.118 Vali Acc: 0.683 Test Loss: 1.118 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 20 cost time: 1.0023314952850342
Epoch: 20, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.087 Vali Acc: 0.683 Test Loss: 1.087 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 21 cost time: 1.0600848197937012
Epoch: 21, Steps: 12 | Train Loss: 0.603 Vali Loss: 1.058 Vali Acc: 0.678 Test Loss: 1.058 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.026205062866211
Epoch: 22, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 1.021219253540039
Epoch: 23, Steps: 12 | Train Loss: 0.542 Vali Loss: 1.024 Vali Acc: 0.706 Test Loss: 1.024 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705545).  Saving model ...
Epoch: 24 cost time: 1.0803604125976562
Epoch: 24, Steps: 12 | Train Loss: 0.478 Vali Loss: 1.014 Vali Acc: 0.711 Test Loss: 1.014 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 25 cost time: 0.9940652847290039
Epoch: 25, Steps: 12 | Train Loss: 0.452 Vali Loss: 1.001 Vali Acc: 0.717 Test Loss: 1.001 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 26 cost time: 1.0599408149719238
Epoch: 26, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.989 Vali Acc: 0.717 Test Loss: 0.989 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 27 cost time: 1.096926212310791
Epoch: 27, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.981 Vali Acc: 0.711 Test Loss: 0.981 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.024427890777588
Epoch: 28, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.957 Vali Acc: 0.756 Test Loss: 0.957 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755546).  Saving model ...
Epoch: 29 cost time: 1.0554184913635254
Epoch: 29, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0613269805908203
Epoch: 30, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.961 Vali Acc: 0.739 Test Loss: 0.961 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.103205919265747
Epoch: 31, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.02384614944458
Epoch: 32, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.983 Vali Acc: 0.722 Test Loss: 0.983 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2251970767974854
Epoch: 33, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.980 Vali Acc: 0.722 Test Loss: 0.980 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.037379264831543
Epoch: 34, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.964 Vali Acc: 0.728 Test Loss: 0.964 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0843217372894287
Epoch: 35, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.981 Vali Acc: 0.739 Test Loss: 0.981 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0567257404327393
Epoch: 36, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1286122798919678
Epoch: 37, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.998 Vali Acc: 0.717 Test Loss: 0.998 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.031454086303711
Epoch: 38, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.983 Vali Acc: 0.722 Test Loss: 0.983 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 39983
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6036019325256348
Epoch: 1, Steps: 12 | Train Loss: 2.905 Vali Loss: 2.779 Vali Acc: 0.067 Test Loss: 2.779 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.0356206893920898
Epoch: 2, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.673 Vali Acc: 0.106 Test Loss: 2.673 Test Acc: 0.106
Validation loss decreased (-0.066639 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 1.0086092948913574
Epoch: 3, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.538 Vali Acc: 0.150 Test Loss: 2.538 Test Acc: 0.150
Validation loss decreased (-0.105529 --> -0.149975).  Saving model ...
Epoch: 4 cost time: 0.9965522289276123
Epoch: 4, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.396 Vali Acc: 0.217 Test Loss: 2.396 Test Acc: 0.217
Validation loss decreased (-0.149975 --> -0.216643).  Saving model ...
Epoch: 5 cost time: 0.9594690799713135
Epoch: 5, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.252 Vali Acc: 0.272 Test Loss: 2.252 Test Acc: 0.272
Validation loss decreased (-0.216643 --> -0.272200).  Saving model ...
Epoch: 6 cost time: 1.108320951461792
Epoch: 6, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.107 Vali Acc: 0.378 Test Loss: 2.107 Test Acc: 0.378
Validation loss decreased (-0.272200 --> -0.377757).  Saving model ...
Epoch: 7 cost time: 1.0839438438415527
Epoch: 7, Steps: 12 | Train Loss: 2.057 Vali Loss: 1.972 Vali Acc: 0.450 Test Loss: 1.972 Test Acc: 0.450
Validation loss decreased (-0.377757 --> -0.449980).  Saving model ...
Epoch: 8 cost time: 0.9860258102416992
Epoch: 8, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.848 Vali Acc: 0.506 Test Loss: 1.848 Test Acc: 0.506
Validation loss decreased (-0.449980 --> -0.505537).  Saving model ...
Epoch: 9 cost time: 1.1560895442962646
Epoch: 9, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.739 Vali Acc: 0.528 Test Loss: 1.739 Test Acc: 0.528
Validation loss decreased (-0.505537 --> -0.527760).  Saving model ...
Epoch: 10 cost time: 1.0711183547973633
Epoch: 10, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.635 Vali Acc: 0.556 Test Loss: 1.635 Test Acc: 0.556
Validation loss decreased (-0.527760 --> -0.555539).  Saving model ...
Epoch: 11 cost time: 1.0763320922851562
Epoch: 11, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.551 Vali Acc: 0.567 Test Loss: 1.551 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566651).  Saving model ...
Epoch: 12 cost time: 0.9975800514221191
Epoch: 12, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.493 Vali Acc: 0.578 Test Loss: 1.493 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577763).  Saving model ...
Epoch: 13 cost time: 1.043914556503296
Epoch: 13, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.431 Vali Acc: 0.594 Test Loss: 1.431 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594430).  Saving model ...
Epoch: 14 cost time: 1.0557923316955566
Epoch: 14, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.366 Vali Acc: 0.600 Test Loss: 1.366 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 15 cost time: 1.101348876953125
Epoch: 15, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.324 Vali Acc: 0.606 Test Loss: 1.324 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 0.9956374168395996
Epoch: 16, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.277 Vali Acc: 0.606 Test Loss: 1.277 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605543).  Saving model ...
Epoch: 17 cost time: 1.0115702152252197
Epoch: 17, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.229 Vali Acc: 0.633 Test Loss: 1.229 Test Acc: 0.633
Validation loss decreased (-0.605543 --> -0.633321).  Saving model ...
Epoch: 18 cost time: 1.0475034713745117
Epoch: 18, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.196 Vali Acc: 0.639 Test Loss: 1.196 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 19 cost time: 1.0329625606536865
Epoch: 19, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.155 Vali Acc: 0.639 Test Loss: 1.155 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 20 cost time: 1.0953559875488281
Epoch: 20, Steps: 12 | Train Loss: 0.660 Vali Loss: 1.130 Vali Acc: 0.661 Test Loss: 1.130 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 21 cost time: 1.1144189834594727
Epoch: 21, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.106 Vali Acc: 0.683 Test Loss: 1.106 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683322).  Saving model ...
Epoch: 22 cost time: 1.0654208660125732
Epoch: 22, Steps: 12 | Train Loss: 0.564 Vali Loss: 1.063 Vali Acc: 0.678 Test Loss: 1.063 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1385607719421387
Epoch: 23, Steps: 12 | Train Loss: 0.554 Vali Loss: 1.058 Vali Acc: 0.694 Test Loss: 1.058 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 24 cost time: 1.063805103302002
Epoch: 24, Steps: 12 | Train Loss: 0.495 Vali Loss: 1.042 Vali Acc: 0.694 Test Loss: 1.042 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 25 cost time: 1.0517089366912842
Epoch: 25, Steps: 12 | Train Loss: 0.475 Vali Loss: 1.012 Vali Acc: 0.678 Test Loss: 1.012 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0963613986968994
Epoch: 26, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.994 Vali Acc: 0.694 Test Loss: 0.994 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 27 cost time: 1.0565886497497559
Epoch: 27, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.977 Vali Acc: 0.700 Test Loss: 0.977 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 1.0489857196807861
Epoch: 28, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.982 Vali Acc: 0.700 Test Loss: 0.982 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0333456993103027
Epoch: 29, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.958 Vali Acc: 0.706 Test Loss: 0.958 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 30 cost time: 1.0430200099945068
Epoch: 30, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.946 Vali Acc: 0.717 Test Loss: 0.946 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 31 cost time: 1.0658392906188965
Epoch: 31, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.933 Vali Acc: 0.711 Test Loss: 0.933 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0578927993774414
Epoch: 32, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 33 cost time: 1.059910774230957
Epoch: 33, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.939 Vali Acc: 0.722 Test Loss: 0.939 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1160717010498047
Epoch: 34, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.927 Vali Acc: 0.733 Test Loss: 0.927 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 35 cost time: 0.99151611328125
Epoch: 35, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.929 Vali Acc: 0.756 Test Loss: 0.929 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755546).  Saving model ...
Epoch: 36 cost time: 0.9878408908843994
Epoch: 36, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.947 Vali Acc: 0.722 Test Loss: 0.947 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0665180683135986
Epoch: 37, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.965 Vali Acc: 0.733 Test Loss: 0.965 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9695699214935303
Epoch: 38, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0317819118499756
Epoch: 39, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.962 Vali Acc: 0.733 Test Loss: 0.962 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0505664348602295
Epoch: 40, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.947 Vali Acc: 0.733 Test Loss: 0.947 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9892740249633789
Epoch: 41, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.954 Vali Acc: 0.728 Test Loss: 0.954 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0408403873443604
Epoch: 42, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9779472351074219
Epoch: 43, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.972 Vali Acc: 0.733 Test Loss: 0.972 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.064974069595337
Epoch: 44, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.959 Vali Acc: 0.739 Test Loss: 0.959 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.068488359451294
Epoch: 45, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 39519
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7572021484375
Epoch: 1, Steps: 12 | Train Loss: 2.891 Vali Loss: 2.805 Vali Acc: 0.056 Test Loss: 2.805 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.9931137561798096
Epoch: 2, Steps: 12 | Train Loss: 2.889 Vali Loss: 2.705 Vali Acc: 0.067 Test Loss: 2.705 Test Acc: 0.067
Validation loss decreased (-0.055528 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 1.010392427444458
Epoch: 3, Steps: 12 | Train Loss: 2.804 Vali Loss: 2.579 Vali Acc: 0.089 Test Loss: 2.579 Test Acc: 0.089
Validation loss decreased (-0.066640 --> -0.088863).  Saving model ...
Epoch: 4 cost time: 1.0309476852416992
Epoch: 4, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.432 Vali Acc: 0.200 Test Loss: 2.432 Test Acc: 0.200
Validation loss decreased (-0.088863 --> -0.199976).  Saving model ...
Epoch: 5 cost time: 0.9743432998657227
Epoch: 5, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.298 Vali Acc: 0.300 Test Loss: 2.298 Test Acc: 0.300
Validation loss decreased (-0.199976 --> -0.299977).  Saving model ...
Epoch: 6 cost time: 1.0226831436157227
Epoch: 6, Steps: 12 | Train Loss: 2.294 Vali Loss: 2.156 Vali Acc: 0.394 Test Loss: 2.156 Test Acc: 0.394
Validation loss decreased (-0.299977 --> -0.394423).  Saving model ...
Epoch: 7 cost time: 1.0079972743988037
Epoch: 7, Steps: 12 | Train Loss: 2.117 Vali Loss: 2.012 Vali Acc: 0.483 Test Loss: 2.012 Test Acc: 0.483
Validation loss decreased (-0.394423 --> -0.483313).  Saving model ...
Epoch: 8 cost time: 1.033200979232788
Epoch: 8, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.894 Vali Acc: 0.500 Test Loss: 1.894 Test Acc: 0.500
Validation loss decreased (-0.483313 --> -0.499981).  Saving model ...
Epoch: 9 cost time: 0.9609527587890625
Epoch: 9, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.776 Vali Acc: 0.522 Test Loss: 1.776 Test Acc: 0.522
Validation loss decreased (-0.499981 --> -0.522204).  Saving model ...
Epoch: 10 cost time: 1.0071957111358643
Epoch: 10, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.689 Vali Acc: 0.567 Test Loss: 1.689 Test Acc: 0.567
Validation loss decreased (-0.522204 --> -0.566650).  Saving model ...
Epoch: 11 cost time: 1.0066461563110352
Epoch: 11, Steps: 12 | Train Loss: 1.575 Vali Loss: 1.609 Vali Acc: 0.561 Test Loss: 1.609 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0080938339233398
Epoch: 12, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.548 Vali Acc: 0.561 Test Loss: 1.548 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.070568561553955
Epoch: 13, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.489 Vali Acc: 0.539 Test Loss: 1.489 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0318303108215332
Epoch: 14, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.426 Vali Acc: 0.578 Test Loss: 1.426 Test Acc: 0.578
Validation loss decreased (-0.566650 --> -0.577764).  Saving model ...
Epoch: 15 cost time: 1.0556087493896484
Epoch: 15, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.372 Vali Acc: 0.622 Test Loss: 1.372 Test Acc: 0.622
Validation loss decreased (-0.577764 --> -0.622209).  Saving model ...
Epoch: 16 cost time: 0.9558260440826416
Epoch: 16, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.344 Vali Acc: 0.633 Test Loss: 1.344 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 17 cost time: 1.044999361038208
Epoch: 17, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.302 Vali Acc: 0.622 Test Loss: 1.302 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0098316669464111
Epoch: 18, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.254 Vali Acc: 0.639 Test Loss: 1.254 Test Acc: 0.639
Validation loss decreased (-0.633320 --> -0.638876).  Saving model ...
Epoch: 19 cost time: 0.9912376403808594
Epoch: 19, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.230 Vali Acc: 0.650 Test Loss: 1.230 Test Acc: 0.650
Validation loss decreased (-0.638876 --> -0.649988).  Saving model ...
Epoch: 20 cost time: 1.0458381175994873
Epoch: 20, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.197 Vali Acc: 0.667 Test Loss: 1.197 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666655).  Saving model ...
Epoch: 21 cost time: 1.0583558082580566
Epoch: 21, Steps: 12 | Train Loss: 0.773 Vali Loss: 1.163 Vali Acc: 0.689 Test Loss: 1.163 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688877).  Saving model ...
Epoch: 22 cost time: 0.9383683204650879
Epoch: 22, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.140 Vali Acc: 0.667 Test Loss: 1.140 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9356563091278076
Epoch: 23, Steps: 12 | Train Loss: 0.710 Vali Loss: 1.114 Vali Acc: 0.661 Test Loss: 1.114 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0007350444793701
Epoch: 24, Steps: 12 | Train Loss: 0.677 Vali Loss: 1.087 Vali Acc: 0.667 Test Loss: 1.087 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0326569080352783
Epoch: 25, Steps: 12 | Train Loss: 0.670 Vali Loss: 1.075 Vali Acc: 0.672 Test Loss: 1.075 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0117757320404053
Epoch: 26, Steps: 12 | Train Loss: 0.619 Vali Loss: 1.046 Vali Acc: 0.689 Test Loss: 1.046 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688878).  Saving model ...
Epoch: 27 cost time: 1.0865881443023682
Epoch: 27, Steps: 12 | Train Loss: 0.550 Vali Loss: 1.031 Vali Acc: 0.678 Test Loss: 1.031 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9616062641143799
Epoch: 28, Steps: 12 | Train Loss: 0.521 Vali Loss: 1.027 Vali Acc: 0.678 Test Loss: 1.027 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0268609523773193
Epoch: 29, Steps: 12 | Train Loss: 0.518 Vali Loss: 1.007 Vali Acc: 0.694 Test Loss: 1.007 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 30 cost time: 1.1401581764221191
Epoch: 30, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 31 cost time: 1.0175819396972656
Epoch: 31, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.9884111881256104
Epoch: 32, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 33 cost time: 1.0893898010253906
Epoch: 33, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.960 Vali Acc: 0.722 Test Loss: 0.960 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 34 cost time: 1.0085034370422363
Epoch: 34, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.962 Vali Acc: 0.717 Test Loss: 0.962 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1050043106079102
Epoch: 35, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.953 Vali Acc: 0.722 Test Loss: 0.953 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 36 cost time: 1.1035537719726562
Epoch: 36, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.932 Vali Acc: 0.717 Test Loss: 0.932 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.020418643951416
Epoch: 37, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.934 Vali Acc: 0.761 Test Loss: 0.934 Test Acc: 0.761
Validation loss decreased (-0.722213 --> -0.761102).  Saving model ...
Epoch: 38 cost time: 1.0593476295471191
Epoch: 38, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0681660175323486
Epoch: 39, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0724315643310547
Epoch: 40, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.934 Vali Acc: 0.711 Test Loss: 0.934 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0308349132537842
Epoch: 41, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.903 Vali Acc: 0.756 Test Loss: 0.903 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0704131126403809
Epoch: 42, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.908 Vali Acc: 0.722 Test Loss: 0.908 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0941505432128906
Epoch: 43, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1384363174438477
Epoch: 44, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.933 Vali Acc: 0.761 Test Loss: 0.933 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 45 cost time: 1.0725626945495605
Epoch: 45, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.921 Vali Acc: 0.739 Test Loss: 0.921 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0202913284301758
Epoch: 46, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0443191528320312
Epoch: 47, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0740935802459717
Epoch: 48, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.927 Vali Acc: 0.756 Test Loss: 0.927 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9938983917236328
Epoch: 49, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.923 Vali Acc: 0.739 Test Loss: 0.923 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1051623821258545
Epoch: 50, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.913 Vali Acc: 0.728 Test Loss: 0.913 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0852808952331543
Epoch: 51, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.0353920459747314
Epoch: 52, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.934 Vali Acc: 0.728 Test Loss: 0.934 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.0745182037353516
Epoch: 53, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.923 Vali Acc: 0.711 Test Loss: 0.923 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.0502550601959229
Epoch: 54, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.921 Vali Acc: 0.761 Test Loss: 0.921 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 55 cost time: 1.0281562805175781
Epoch: 55, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9636776447296143
Epoch: 56, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.927 Vali Acc: 0.733 Test Loss: 0.927 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9949395656585693
Epoch: 57, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.950 Vali Acc: 0.744 Test Loss: 0.950 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9968149662017822
Epoch: 58, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.942 Vali Acc: 0.761 Test Loss: 0.942 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.027498483657837
Epoch: 59, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.964 Vali Acc: 0.717 Test Loss: 0.964 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.0656564235687256
Epoch: 60, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.969 Vali Acc: 0.733 Test Loss: 0.969 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.0164623260498047
Epoch: 61, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.108656406402588
Epoch: 62, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.974 Vali Acc: 0.744 Test Loss: 0.974 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.0194742679595947
Epoch: 63, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.978 Vali Acc: 0.750 Test Loss: 0.978 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.060359001159668
Epoch: 64, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.972 Vali Acc: 0.761 Test Loss: 0.972 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 36175
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.643907308578491
Epoch: 1, Steps: 12 | Train Loss: 2.860 Vali Loss: 2.710 Vali Acc: 0.061 Test Loss: 2.710 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 1.0746095180511475
Epoch: 2, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.626 Vali Acc: 0.050 Test Loss: 2.626 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.07621169090271
Epoch: 3, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.515 Vali Acc: 0.111 Test Loss: 2.515 Test Acc: 0.111
Validation loss decreased (-0.061084 --> -0.111086).  Saving model ...
Epoch: 4 cost time: 0.988990306854248
Epoch: 4, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.390 Vali Acc: 0.233 Test Loss: 2.390 Test Acc: 0.233
Validation loss decreased (-0.111086 --> -0.233309).  Saving model ...
Epoch: 5 cost time: 1.0320584774017334
Epoch: 5, Steps: 12 | Train Loss: 2.418 Vali Loss: 2.266 Vali Acc: 0.294 Test Loss: 2.266 Test Acc: 0.294
Validation loss decreased (-0.233309 --> -0.294422).  Saving model ...
Epoch: 6 cost time: 1.0403542518615723
Epoch: 6, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.153 Vali Acc: 0.339 Test Loss: 2.153 Test Acc: 0.339
Validation loss decreased (-0.294422 --> -0.338867).  Saving model ...
Epoch: 7 cost time: 1.0245170593261719
Epoch: 7, Steps: 12 | Train Loss: 2.167 Vali Loss: 2.041 Vali Acc: 0.406 Test Loss: 2.041 Test Acc: 0.406
Validation loss decreased (-0.338867 --> -0.405535).  Saving model ...
Epoch: 8 cost time: 1.0034959316253662
Epoch: 8, Steps: 12 | Train Loss: 2.091 Vali Loss: 1.947 Vali Acc: 0.428 Test Loss: 1.947 Test Acc: 0.428
Validation loss decreased (-0.405535 --> -0.427758).  Saving model ...
Epoch: 9 cost time: 1.0556519031524658
Epoch: 9, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.854 Vali Acc: 0.467 Test Loss: 1.854 Test Acc: 0.467
Validation loss decreased (-0.427758 --> -0.466648).  Saving model ...
Epoch: 10 cost time: 0.9948012828826904
Epoch: 10, Steps: 12 | Train Loss: 1.882 Vali Loss: 1.772 Vali Acc: 0.483 Test Loss: 1.772 Test Acc: 0.483
Validation loss decreased (-0.466648 --> -0.483316).  Saving model ...
Epoch: 11 cost time: 1.007399082183838
Epoch: 11, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.701 Vali Acc: 0.517 Test Loss: 1.701 Test Acc: 0.517
Validation loss decreased (-0.483316 --> -0.516650).  Saving model ...
Epoch: 12 cost time: 0.9884657859802246
Epoch: 12, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.642 Vali Acc: 0.533 Test Loss: 1.642 Test Acc: 0.533
Validation loss decreased (-0.516650 --> -0.533317).  Saving model ...
Epoch: 13 cost time: 1.0082454681396484
Epoch: 13, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.584 Vali Acc: 0.533 Test Loss: 1.584 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 14 cost time: 0.9799971580505371
Epoch: 14, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.529 Vali Acc: 0.556 Test Loss: 1.529 Test Acc: 0.556
Validation loss decreased (-0.533317 --> -0.555540).  Saving model ...
Epoch: 15 cost time: 0.9534077644348145
Epoch: 15, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.481 Vali Acc: 0.578 Test Loss: 1.481 Test Acc: 0.578
Validation loss decreased (-0.555540 --> -0.577763).  Saving model ...
Epoch: 16 cost time: 0.9815444946289062
Epoch: 16, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.438 Vali Acc: 0.583 Test Loss: 1.438 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 17 cost time: 0.8815939426422119
Epoch: 17, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.406 Vali Acc: 0.600 Test Loss: 1.406 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599986).  Saving model ...
Epoch: 18 cost time: 0.8718676567077637
Epoch: 18, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.380 Vali Acc: 0.600 Test Loss: 1.380 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 0.9796416759490967
Epoch: 19, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.344 Vali Acc: 0.611 Test Loss: 1.344 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 20 cost time: 0.9522378444671631
Epoch: 20, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.304 Vali Acc: 0.628 Test Loss: 1.304 Test Acc: 0.628
Validation loss decreased (-0.611098 --> -0.627765).  Saving model ...
Epoch: 21 cost time: 0.9702363014221191
Epoch: 21, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.270 Vali Acc: 0.617 Test Loss: 1.270 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9229228496551514
Epoch: 22, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.244 Vali Acc: 0.650 Test Loss: 1.244 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 23 cost time: 1.0118746757507324
Epoch: 23, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.226 Vali Acc: 0.639 Test Loss: 1.226 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.033965826034546
Epoch: 24, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.188 Vali Acc: 0.639 Test Loss: 1.188 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0233216285705566
Epoch: 25, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.163 Vali Acc: 0.650 Test Loss: 1.163 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 26 cost time: 1.0514543056488037
Epoch: 26, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.150 Vali Acc: 0.650 Test Loss: 1.150 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 27 cost time: 0.964118242263794
Epoch: 27, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.118 Vali Acc: 0.656 Test Loss: 1.118 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655544).  Saving model ...
Epoch: 28 cost time: 0.9548244476318359
Epoch: 28, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.098 Vali Acc: 0.656 Test Loss: 1.098 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 29 cost time: 1.0144989490509033
Epoch: 29, Steps: 12 | Train Loss: 0.654 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9556965827941895
Epoch: 30, Steps: 12 | Train Loss: 0.664 Vali Loss: 1.037 Vali Acc: 0.667 Test Loss: 1.037 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666656).  Saving model ...
Epoch: 31 cost time: 1.0047011375427246
Epoch: 31, Steps: 12 | Train Loss: 0.638 Vali Loss: 1.021 Vali Acc: 0.656 Test Loss: 1.021 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1712651252746582
Epoch: 32, Steps: 12 | Train Loss: 0.583 Vali Loss: 1.000 Vali Acc: 0.667 Test Loss: 1.000 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 33 cost time: 0.9677619934082031
Epoch: 33, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.975 Vali Acc: 0.678 Test Loss: 0.975 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677768).  Saving model ...
Epoch: 34 cost time: 0.9588992595672607
Epoch: 34, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.972 Vali Acc: 0.678 Test Loss: 0.972 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 35 cost time: 0.9317407608032227
Epoch: 35, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.925 Vali Acc: 0.694 Test Loss: 0.925 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 36 cost time: 1.2361047267913818
Epoch: 36, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.912 Vali Acc: 0.678 Test Loss: 0.912 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9233982563018799
Epoch: 37, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.896 Vali Acc: 0.711 Test Loss: 0.896 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 38 cost time: 1.007127046585083
Epoch: 38, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.860 Vali Acc: 0.700 Test Loss: 0.860 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9810142517089844
Epoch: 39, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.866 Vali Acc: 0.700 Test Loss: 0.866 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.015517234802246
Epoch: 40, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.846 Vali Acc: 0.706 Test Loss: 0.846 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9917078018188477
Epoch: 41, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.830 Vali Acc: 0.706 Test Loss: 0.830 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0384602546691895
Epoch: 42, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.837 Vali Acc: 0.711 Test Loss: 0.837 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 43 cost time: 1.0413110256195068
Epoch: 43, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.804 Vali Acc: 0.739 Test Loss: 0.804 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738881).  Saving model ...
Epoch: 44 cost time: 1.0611960887908936
Epoch: 44, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.809 Vali Acc: 0.739 Test Loss: 0.809 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9596178531646729
Epoch: 45, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.820 Vali Acc: 0.722 Test Loss: 0.820 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0607340335845947
Epoch: 46, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.800 Vali Acc: 0.722 Test Loss: 0.800 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0036814212799072
Epoch: 47, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.786 Vali Acc: 0.744 Test Loss: 0.786 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 48 cost time: 1.0345394611358643
Epoch: 48, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.776 Vali Acc: 0.733 Test Loss: 0.776 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.951913595199585
Epoch: 49, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.779 Vali Acc: 0.744 Test Loss: 0.779 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 50 cost time: 1.0273234844207764
Epoch: 50, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.770 Vali Acc: 0.728 Test Loss: 0.770 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8921751976013184
Epoch: 51, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.789 Vali Acc: 0.744 Test Loss: 0.789 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.8970901966094971
Epoch: 52, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.759 Vali Acc: 0.739 Test Loss: 0.759 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9788174629211426
Epoch: 53, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.754 Vali Acc: 0.750 Test Loss: 0.754 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 0.9035754203796387
Epoch: 54, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.766 Vali Acc: 0.744 Test Loss: 0.766 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0085091590881348
Epoch: 55, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.758 Vali Acc: 0.733 Test Loss: 0.758 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0547058582305908
Epoch: 56, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 57 cost time: 0.9471848011016846
Epoch: 57, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.760 Vali Acc: 0.733 Test Loss: 0.760 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0211398601531982
Epoch: 58, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.768 Vali Acc: 0.744 Test Loss: 0.768 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.037675142288208
Epoch: 59, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.774 Vali Acc: 0.761 Test Loss: 0.774 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761103).  Saving model ...
Epoch: 60 cost time: 0.9501535892486572
Epoch: 60, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.745 Vali Acc: 0.744 Test Loss: 0.745 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.951556921005249
Epoch: 61, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.761 Vali Acc: 0.750 Test Loss: 0.761 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9576611518859863
Epoch: 62, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.762 Vali Acc: 0.750 Test Loss: 0.762 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0101981163024902
Epoch: 63, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.781 Vali Acc: 0.739 Test Loss: 0.781 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.09489107131958
Epoch: 64, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.778 Vali Acc: 0.739 Test Loss: 0.778 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.9991073608398438
Epoch: 65, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.771 Vali Acc: 0.733 Test Loss: 0.771 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.9774131774902344
Epoch: 66, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.762 Vali Acc: 0.733 Test Loss: 0.762 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.1418938636779785
Epoch: 67, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.773 Vali Acc: 0.733 Test Loss: 0.773 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.9079406261444092
Epoch: 68, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.792 Vali Acc: 0.761 Test Loss: 0.792 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.1141047477722168
Epoch: 69, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 34287
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7291347980499268
Epoch: 1, Steps: 12 | Train Loss: 2.875 Vali Loss: 2.806 Vali Acc: 0.133 Test Loss: 2.806 Test Acc: 0.133
Validation loss decreased (inf --> -0.133305).  Saving model ...
Epoch: 2 cost time: 0.9435758590698242
Epoch: 2, Steps: 12 | Train Loss: 2.893 Vali Loss: 2.738 Vali Acc: 0.133 Test Loss: 2.738 Test Acc: 0.133
Validation loss decreased (-0.133305 --> -0.133306).  Saving model ...
Epoch: 3 cost time: 0.9146921634674072
Epoch: 3, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.647 Vali Acc: 0.172 Test Loss: 2.647 Test Acc: 0.172
Validation loss decreased (-0.133306 --> -0.172196).  Saving model ...
Epoch: 4 cost time: 0.8659250736236572
Epoch: 4, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.545 Vali Acc: 0.233 Test Loss: 2.545 Test Acc: 0.233
Validation loss decreased (-0.172196 --> -0.233308).  Saving model ...
Epoch: 5 cost time: 1.0664458274841309
Epoch: 5, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.430 Vali Acc: 0.278 Test Loss: 2.430 Test Acc: 0.278
Validation loss decreased (-0.233308 --> -0.277753).  Saving model ...
Epoch: 6 cost time: 1.2066946029663086
Epoch: 6, Steps: 12 | Train Loss: 2.436 Vali Loss: 2.324 Vali Acc: 0.322 Test Loss: 2.324 Test Acc: 0.322
Validation loss decreased (-0.277753 --> -0.322199).  Saving model ...
Epoch: 7 cost time: 1.119861364364624
Epoch: 7, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.216 Vali Acc: 0.406 Test Loss: 2.216 Test Acc: 0.406
Validation loss decreased (-0.322199 --> -0.405533).  Saving model ...
Epoch: 8 cost time: 0.9916040897369385
Epoch: 8, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.116 Vali Acc: 0.422 Test Loss: 2.116 Test Acc: 0.422
Validation loss decreased (-0.405533 --> -0.422201).  Saving model ...
Epoch: 9 cost time: 0.9235150814056396
Epoch: 9, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.014 Vali Acc: 0.478 Test Loss: 2.014 Test Acc: 0.478
Validation loss decreased (-0.422201 --> -0.477758).  Saving model ...
Epoch: 10 cost time: 0.9626221656799316
Epoch: 10, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.926 Vali Acc: 0.483 Test Loss: 1.926 Test Acc: 0.483
Validation loss decreased (-0.477758 --> -0.483314).  Saving model ...
Epoch: 11 cost time: 0.992363452911377
Epoch: 11, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.841 Vali Acc: 0.478 Test Loss: 1.841 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9674856662750244
Epoch: 12, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.768 Vali Acc: 0.489 Test Loss: 1.768 Test Acc: 0.489
Validation loss decreased (-0.483314 --> -0.488871).  Saving model ...
Epoch: 13 cost time: 1.0032165050506592
Epoch: 13, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.694 Vali Acc: 0.533 Test Loss: 1.694 Test Acc: 0.533
Validation loss decreased (-0.488871 --> -0.533316).  Saving model ...
Epoch: 14 cost time: 0.961733341217041
Epoch: 14, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.633 Vali Acc: 0.533 Test Loss: 1.633 Test Acc: 0.533
Validation loss decreased (-0.533316 --> -0.533317).  Saving model ...
Epoch: 15 cost time: 1.0346050262451172
Epoch: 15, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.583 Vali Acc: 0.567 Test Loss: 1.583 Test Acc: 0.567
Validation loss decreased (-0.533317 --> -0.566651).  Saving model ...
Epoch: 16 cost time: 1.0577731132507324
Epoch: 16, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.535 Vali Acc: 0.567 Test Loss: 1.535 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 17 cost time: 1.003180742263794
Epoch: 17, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.495 Vali Acc: 0.578 Test Loss: 1.495 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577763).  Saving model ...
Epoch: 18 cost time: 0.9991343021392822
Epoch: 18, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.448 Vali Acc: 0.606 Test Loss: 1.448 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605541).  Saving model ...
Epoch: 19 cost time: 1.0223331451416016
Epoch: 19, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.412 Vali Acc: 0.600 Test Loss: 1.412 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9698135852813721
Epoch: 20, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.380 Vali Acc: 0.600 Test Loss: 1.380 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9849197864532471
Epoch: 21, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.339 Vali Acc: 0.600 Test Loss: 1.339 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0614166259765625
Epoch: 22, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.289 Vali Acc: 0.606 Test Loss: 1.289 Test Acc: 0.606
Validation loss decreased (-0.605541 --> -0.605543).  Saving model ...
Epoch: 23 cost time: 0.9434463977813721
Epoch: 23, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.245 Vali Acc: 0.611 Test Loss: 1.245 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611099).  Saving model ...
Epoch: 24 cost time: 1.0345549583435059
Epoch: 24, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.200 Vali Acc: 0.622 Test Loss: 1.200 Test Acc: 0.622
Validation loss decreased (-0.611099 --> -0.622210).  Saving model ...
Epoch: 25 cost time: 0.993687629699707
Epoch: 25, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.171 Vali Acc: 0.628 Test Loss: 1.171 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 26 cost time: 1.0039992332458496
Epoch: 26, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.138 Vali Acc: 0.639 Test Loss: 1.138 Test Acc: 0.639
Validation loss decreased (-0.627766 --> -0.638878).  Saving model ...
Epoch: 27 cost time: 1.007084846496582
Epoch: 27, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.092 Vali Acc: 0.628 Test Loss: 1.092 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0022001266479492
Epoch: 28, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.053 Vali Acc: 0.633 Test Loss: 1.053 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.042400598526001
Epoch: 29, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649990).  Saving model ...
Epoch: 30 cost time: 1.0426428318023682
Epoch: 30, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.010 Vali Acc: 0.656 Test Loss: 1.010 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655545).  Saving model ...
Epoch: 31 cost time: 1.0165600776672363
Epoch: 31, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.985 Vali Acc: 0.661 Test Loss: 0.985 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661101).  Saving model ...
Epoch: 32 cost time: 1.0567939281463623
Epoch: 32, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.952 Vali Acc: 0.678 Test Loss: 0.952 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 33 cost time: 1.0031378269195557
Epoch: 33, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.941 Vali Acc: 0.667 Test Loss: 0.941 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1128337383270264
Epoch: 34, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.930 Vali Acc: 0.678 Test Loss: 0.930 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 35 cost time: 1.0426981449127197
Epoch: 35, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.914 Vali Acc: 0.700 Test Loss: 0.914 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 36 cost time: 1.0612916946411133
Epoch: 36, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.890 Vali Acc: 0.689 Test Loss: 0.890 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.001587152481079
Epoch: 37, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.876 Vali Acc: 0.700 Test Loss: 0.876 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 38 cost time: 0.9989016056060791
Epoch: 38, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.866 Vali Acc: 0.717 Test Loss: 0.866 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 39 cost time: 1.0142381191253662
Epoch: 39, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.871 Vali Acc: 0.717 Test Loss: 0.871 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.086303472518921
Epoch: 40, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.853 Vali Acc: 0.728 Test Loss: 0.853 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727769).  Saving model ...
Epoch: 41 cost time: 1.0659735202789307
Epoch: 41, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 42 cost time: 1.1761977672576904
Epoch: 42, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.821 Vali Acc: 0.733 Test Loss: 0.821 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 43 cost time: 1.1085178852081299
Epoch: 43, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.829 Vali Acc: 0.722 Test Loss: 0.829 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0737509727478027
Epoch: 44, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.820 Vali Acc: 0.733 Test Loss: 0.820 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 45 cost time: 1.107839822769165
Epoch: 45, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761103).  Saving model ...
Epoch: 46 cost time: 1.0370190143585205
Epoch: 46, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.805 Vali Acc: 0.756 Test Loss: 0.805 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9967629909515381
Epoch: 47, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.784 Vali Acc: 0.761 Test Loss: 0.784 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 48 cost time: 1.0490913391113281
Epoch: 48, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.790 Vali Acc: 0.767 Test Loss: 0.790 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 49 cost time: 1.0223047733306885
Epoch: 49, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.786 Vali Acc: 0.761 Test Loss: 0.786 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0609211921691895
Epoch: 50, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.768 Vali Acc: 0.772 Test Loss: 0.768 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 51 cost time: 1.0263607501983643
Epoch: 51, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.796 Vali Acc: 0.756 Test Loss: 0.796 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0365746021270752
Epoch: 52, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783325).  Saving model ...
Epoch: 53 cost time: 1.08268141746521
Epoch: 53, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0069270133972168
Epoch: 54, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0789618492126465
Epoch: 55, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.763 Vali Acc: 0.772 Test Loss: 0.763 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.060805320739746
Epoch: 56, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.794 Vali Acc: 0.767 Test Loss: 0.794 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.96449875831604
Epoch: 57, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.785 Vali Acc: 0.767 Test Loss: 0.785 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.055711030960083
Epoch: 58, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.0345606803894043
Epoch: 59, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.0662097930908203
Epoch: 60, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.772 Vali Acc: 0.756 Test Loss: 0.772 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.0340049266815186
Epoch: 61, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.780 Vali Acc: 0.744 Test Loss: 0.780 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.9672794342041016
Epoch: 62, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 33359
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6884586811065674
Epoch: 1, Steps: 12 | Train Loss: 2.861 Vali Loss: 2.797 Vali Acc: 0.067 Test Loss: 2.797 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.9895181655883789
Epoch: 2, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.725 Vali Acc: 0.072 Test Loss: 2.725 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.9896798133850098
Epoch: 3, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.648 Vali Acc: 0.106 Test Loss: 2.648 Test Acc: 0.106
Validation loss decreased (-0.072195 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 0.9062323570251465
Epoch: 4, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.571 Vali Acc: 0.161 Test Loss: 2.571 Test Acc: 0.161
Validation loss decreased (-0.105529 --> -0.161085).  Saving model ...
Epoch: 5 cost time: 1.035642147064209
Epoch: 5, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.481 Vali Acc: 0.217 Test Loss: 2.481 Test Acc: 0.217
Validation loss decreased (-0.161085 --> -0.216642).  Saving model ...
Epoch: 6 cost time: 0.9953494071960449
Epoch: 6, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.392 Vali Acc: 0.272 Test Loss: 2.392 Test Acc: 0.272
Validation loss decreased (-0.216642 --> -0.272198).  Saving model ...
Epoch: 7 cost time: 1.0230231285095215
Epoch: 7, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.299 Vali Acc: 0.339 Test Loss: 2.299 Test Acc: 0.339
Validation loss decreased (-0.272198 --> -0.338866).  Saving model ...
Epoch: 8 cost time: 0.9907033443450928
Epoch: 8, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.197 Vali Acc: 0.356 Test Loss: 2.197 Test Acc: 0.356
Validation loss decreased (-0.338866 --> -0.355534).  Saving model ...
Epoch: 9 cost time: 0.9472229480743408
Epoch: 9, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.104 Vali Acc: 0.428 Test Loss: 2.104 Test Acc: 0.428
Validation loss decreased (-0.355534 --> -0.427757).  Saving model ...
Epoch: 10 cost time: 1.0010311603546143
Epoch: 10, Steps: 12 | Train Loss: 2.024 Vali Loss: 2.018 Vali Acc: 0.494 Test Loss: 2.018 Test Acc: 0.494
Validation loss decreased (-0.427757 --> -0.494424).  Saving model ...
Epoch: 11 cost time: 0.9974548816680908
Epoch: 11, Steps: 12 | Train Loss: 1.933 Vali Loss: 1.932 Vali Acc: 0.522 Test Loss: 1.932 Test Acc: 0.522
Validation loss decreased (-0.494424 --> -0.522203).  Saving model ...
Epoch: 12 cost time: 1.0007824897766113
Epoch: 12, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.848 Vali Acc: 0.522 Test Loss: 1.848 Test Acc: 0.522
Validation loss decreased (-0.522203 --> -0.522204).  Saving model ...
Epoch: 13 cost time: 1.1199519634246826
Epoch: 13, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.775 Vali Acc: 0.544 Test Loss: 1.775 Test Acc: 0.544
Validation loss decreased (-0.522204 --> -0.544427).  Saving model ...
Epoch: 14 cost time: 1.116603136062622
Epoch: 14, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.704 Vali Acc: 0.561 Test Loss: 1.704 Test Acc: 0.561
Validation loss decreased (-0.544427 --> -0.561094).  Saving model ...
Epoch: 15 cost time: 1.0528099536895752
Epoch: 15, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.640 Vali Acc: 0.561 Test Loss: 1.640 Test Acc: 0.561
Validation loss decreased (-0.561094 --> -0.561095).  Saving model ...
Epoch: 16 cost time: 1.1158223152160645
Epoch: 16, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.590 Vali Acc: 0.561 Test Loss: 1.590 Test Acc: 0.561
Validation loss decreased (-0.561095 --> -0.561095).  Saving model ...
Epoch: 17 cost time: 1.105266809463501
Epoch: 17, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.531 Vali Acc: 0.544 Test Loss: 1.531 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.049065351486206
Epoch: 18, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.480 Vali Acc: 0.561 Test Loss: 1.480 Test Acc: 0.561
Validation loss decreased (-0.561095 --> -0.561096).  Saving model ...
Epoch: 19 cost time: 1.0981321334838867
Epoch: 19, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.428 Vali Acc: 0.572 Test Loss: 1.428 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 20 cost time: 1.052924633026123
Epoch: 20, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.380 Vali Acc: 0.578 Test Loss: 1.380 Test Acc: 0.578
Validation loss decreased (-0.572208 --> -0.577764).  Saving model ...
Epoch: 21 cost time: 1.1936039924621582
Epoch: 21, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.335 Vali Acc: 0.606 Test Loss: 1.335 Test Acc: 0.606
Validation loss decreased (-0.577764 --> -0.605542).  Saving model ...
Epoch: 22 cost time: 0.9556994438171387
Epoch: 22, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.291 Vali Acc: 0.600 Test Loss: 1.291 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.025597095489502
Epoch: 23, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.248 Vali Acc: 0.611 Test Loss: 1.248 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611099).  Saving model ...
Epoch: 24 cost time: 1.06325101852417
Epoch: 24, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.214 Vali Acc: 0.617 Test Loss: 1.214 Test Acc: 0.617
Validation loss decreased (-0.611099 --> -0.616655).  Saving model ...
Epoch: 25 cost time: 0.9500348567962646
Epoch: 25, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.179 Vali Acc: 0.622 Test Loss: 1.179 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622210).  Saving model ...
Epoch: 26 cost time: 0.9313755035400391
Epoch: 26, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.151 Vali Acc: 0.644 Test Loss: 1.151 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644433).  Saving model ...
Epoch: 27 cost time: 1.082000494003296
Epoch: 27, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.117 Vali Acc: 0.644 Test Loss: 1.117 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 28 cost time: 1.0560047626495361
Epoch: 28, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.091 Vali Acc: 0.661 Test Loss: 1.091 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661100).  Saving model ...
Epoch: 29 cost time: 1.0261998176574707
Epoch: 29, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.069 Vali Acc: 0.656 Test Loss: 1.069 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.041020154953003
Epoch: 30, Steps: 12 | Train Loss: 0.750 Vali Loss: 1.048 Vali Acc: 0.656 Test Loss: 1.048 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0544648170471191
Epoch: 31, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.016 Vali Acc: 0.667 Test Loss: 1.016 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666657).  Saving model ...
Epoch: 32 cost time: 1.1528310775756836
Epoch: 32, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.007 Vali Acc: 0.661 Test Loss: 1.007 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.047391653060913
Epoch: 33, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.988 Vali Acc: 0.672 Test Loss: 0.988 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672212).  Saving model ...
Epoch: 34 cost time: 1.0713849067687988
Epoch: 34, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.970 Vali Acc: 0.678 Test Loss: 0.970 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 35 cost time: 1.0186893939971924
Epoch: 35, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.946 Vali Acc: 0.678 Test Loss: 0.946 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 36 cost time: 1.0250940322875977
Epoch: 36, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.935 Vali Acc: 0.689 Test Loss: 0.935 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 37 cost time: 0.9757297039031982
Epoch: 37, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.917 Vali Acc: 0.694 Test Loss: 0.917 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694435).  Saving model ...
Epoch: 38 cost time: 0.9859797954559326
Epoch: 38, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.899 Vali Acc: 0.717 Test Loss: 0.899 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716658).  Saving model ...
Epoch: 39 cost time: 1.0525946617126465
Epoch: 39, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.887 Vali Acc: 0.728 Test Loss: 0.887 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727769).  Saving model ...
Epoch: 40 cost time: 1.074256181716919
Epoch: 40, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.875 Vali Acc: 0.717 Test Loss: 0.875 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1418910026550293
Epoch: 41, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.873 Vali Acc: 0.694 Test Loss: 0.873 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.127061128616333
Epoch: 42, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.861 Vali Acc: 0.711 Test Loss: 0.861 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1765928268432617
Epoch: 43, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 44 cost time: 1.1337659358978271
Epoch: 44, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.843 Vali Acc: 0.728 Test Loss: 0.843 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 45 cost time: 1.119231939315796
Epoch: 45, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.849 Vali Acc: 0.717 Test Loss: 0.849 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.017775297164917
Epoch: 46, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.856 Vali Acc: 0.711 Test Loss: 0.856 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1086292266845703
Epoch: 47, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.833 Vali Acc: 0.717 Test Loss: 0.833 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0632710456848145
Epoch: 48, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.826 Vali Acc: 0.728 Test Loss: 0.826 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 49 cost time: 0.9926278591156006
Epoch: 49, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.819 Vali Acc: 0.733 Test Loss: 0.819 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733325).  Saving model ...
Epoch: 50 cost time: 1.0704784393310547
Epoch: 50, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.799 Vali Acc: 0.733 Test Loss: 0.799 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 51 cost time: 1.1636404991149902
Epoch: 51, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.811 Vali Acc: 0.728 Test Loss: 0.811 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0895674228668213
Epoch: 52, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.809 Vali Acc: 0.711 Test Loss: 0.809 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0457000732421875
Epoch: 53, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.797 Vali Acc: 0.733 Test Loss: 0.797 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 54 cost time: 1.1171603202819824
Epoch: 54, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.797 Vali Acc: 0.739 Test Loss: 0.797 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 55 cost time: 1.1442244052886963
Epoch: 55, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 56 cost time: 0.9586551189422607
Epoch: 56, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.785 Vali Acc: 0.733 Test Loss: 0.785 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0264201164245605
Epoch: 57, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0770039558410645
Epoch: 58, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.059401512145996
Epoch: 59, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 60 cost time: 1.0727810859680176
Epoch: 60, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.758 Vali Acc: 0.767 Test Loss: 0.758 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.121917486190796
Epoch: 61, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.767 Vali Acc: 0.756 Test Loss: 0.767 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9863512516021729
Epoch: 62, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.764 Vali Acc: 0.744 Test Loss: 0.764 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0419588088989258
Epoch: 63, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.746 Vali Acc: 0.772 Test Loss: 0.746 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 64 cost time: 1.0834431648254395
Epoch: 64, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.734 Vali Acc: 0.772 Test Loss: 0.734 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 65 cost time: 1.0399444103240967
Epoch: 65, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.747 Vali Acc: 0.778 Test Loss: 0.747 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 66 cost time: 1.0705206394195557
Epoch: 66, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.745 Vali Acc: 0.756 Test Loss: 0.745 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.025421142578125
Epoch: 67, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0435259342193604
Epoch: 68, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.765 Vali Acc: 0.778 Test Loss: 0.765 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.0108883380889893
Epoch: 69, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.771 Vali Acc: 0.778 Test Loss: 0.771 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.0846667289733887
Epoch: 70, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.177964448928833
Epoch: 71, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.769 Vali Acc: 0.761 Test Loss: 0.769 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0393218994140625
Epoch: 72, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.0571279525756836
Epoch: 73, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.775 Vali Acc: 0.778 Test Loss: 0.775 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.9910311698913574
Epoch: 74, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.801 Vali Acc: 0.761 Test Loss: 0.801 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.9711673259735107
Epoch: 75, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.786 Vali Acc: 0.778 Test Loss: 0.786 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 32447
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.477679967880249
Epoch: 1, Steps: 12 | Train Loss: 2.881 Vali Loss: 2.767 Vali Acc: 0.111 Test Loss: 2.767 Test Acc: 0.111
Validation loss decreased (inf --> -0.111083).  Saving model ...
Epoch: 2 cost time: 0.9905893802642822
Epoch: 2, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.587 Vali Acc: 0.189 Test Loss: 2.587 Test Acc: 0.189
Validation loss decreased (-0.111083 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 1.0645134449005127
Epoch: 3, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.384 Vali Acc: 0.233 Test Loss: 2.384 Test Acc: 0.233
Validation loss decreased (-0.188863 --> -0.233309).  Saving model ...
Epoch: 4 cost time: 1.043832540512085
Epoch: 4, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.176 Vali Acc: 0.406 Test Loss: 2.176 Test Acc: 0.406
Validation loss decreased (-0.233309 --> -0.405534).  Saving model ...
Epoch: 5 cost time: 0.9612727165222168
Epoch: 5, Steps: 12 | Train Loss: 2.095 Vali Loss: 1.991 Vali Acc: 0.489 Test Loss: 1.991 Test Acc: 0.489
Validation loss decreased (-0.405534 --> -0.488869).  Saving model ...
Epoch: 6 cost time: 1.0085926055908203
Epoch: 6, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.825 Vali Acc: 0.494 Test Loss: 1.825 Test Acc: 0.494
Validation loss decreased (-0.488869 --> -0.494426).  Saving model ...
Epoch: 7 cost time: 1.0618140697479248
Epoch: 7, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.689 Vali Acc: 0.506 Test Loss: 1.689 Test Acc: 0.506
Validation loss decreased (-0.494426 --> -0.505539).  Saving model ...
Epoch: 8 cost time: 0.9656126499176025
Epoch: 8, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.573 Vali Acc: 0.583 Test Loss: 1.573 Test Acc: 0.583
Validation loss decreased (-0.505539 --> -0.583318).  Saving model ...
Epoch: 9 cost time: 1.0090460777282715
Epoch: 9, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.470 Vali Acc: 0.611 Test Loss: 1.470 Test Acc: 0.611
Validation loss decreased (-0.583318 --> -0.611096).  Saving model ...
Epoch: 10 cost time: 0.9626927375793457
Epoch: 10, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.387 Vali Acc: 0.622 Test Loss: 1.387 Test Acc: 0.622
Validation loss decreased (-0.611096 --> -0.622208).  Saving model ...
Epoch: 11 cost time: 0.9568607807159424
Epoch: 11, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.324 Vali Acc: 0.606 Test Loss: 1.324 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.000392198562622
Epoch: 12, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.271 Vali Acc: 0.617 Test Loss: 1.271 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2419559955596924
Epoch: 13, Steps: 12 | Train Loss: 0.863 Vali Loss: 1.238 Vali Acc: 0.639 Test Loss: 1.238 Test Acc: 0.639
Validation loss decreased (-0.622208 --> -0.638877).  Saving model ...
Epoch: 14 cost time: 1.0316753387451172
Epoch: 14, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.208 Vali Acc: 0.639 Test Loss: 1.208 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 15 cost time: 1.186539888381958
Epoch: 15, Steps: 12 | Train Loss: 0.721 Vali Loss: 1.175 Vali Acc: 0.667 Test Loss: 1.175 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666655).  Saving model ...
Epoch: 16 cost time: 0.9574394226074219
Epoch: 16, Steps: 12 | Train Loss: 0.660 Vali Loss: 1.135 Vali Acc: 0.672 Test Loss: 1.135 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 1.1373810768127441
Epoch: 17, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2010934352874756
Epoch: 18, Steps: 12 | Train Loss: 0.567 Vali Loss: 1.070 Vali Acc: 0.694 Test Loss: 1.070 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 19 cost time: 1.0620179176330566
Epoch: 19, Steps: 12 | Train Loss: 0.541 Vali Loss: 1.037 Vali Acc: 0.689 Test Loss: 1.037 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2153913974761963
Epoch: 20, Steps: 12 | Train Loss: 0.446 Vali Loss: 1.002 Vali Acc: 0.744 Test Loss: 1.002 Test Acc: 0.744
Validation loss decreased (-0.694434 --> -0.744434).  Saving model ...
Epoch: 21 cost time: 1.0459997653961182
Epoch: 21, Steps: 12 | Train Loss: 0.428 Vali Loss: 1.009 Vali Acc: 0.717 Test Loss: 1.009 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0269522666931152
Epoch: 22, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.983 Vali Acc: 0.739 Test Loss: 0.983 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.13197922706604
Epoch: 23, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.981 Vali Acc: 0.733 Test Loss: 0.981 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1696534156799316
Epoch: 24, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.961 Vali Acc: 0.750 Test Loss: 0.961 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 1.2413318157196045
Epoch: 25, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.980 Vali Acc: 0.744 Test Loss: 0.980 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0369160175323486
Epoch: 26, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.963 Vali Acc: 0.744 Test Loss: 0.963 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9830005168914795
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.121476173400879
Epoch: 28, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.982 Vali Acc: 0.750 Test Loss: 0.982 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.969078540802002
Epoch: 29, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.995 Vali Acc: 0.728 Test Loss: 0.995 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1263401508331299
Epoch: 30, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.996 Vali Acc: 0.761 Test Loss: 0.996 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 31 cost time: 1.013484239578247
Epoch: 31, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.022 Vali Acc: 0.744 Test Loss: 1.022 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0568897724151611
Epoch: 32, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.025 Vali Acc: 0.744 Test Loss: 1.025 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0691158771514893
Epoch: 33, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.049 Vali Acc: 0.744 Test Loss: 1.049 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9801843166351318
Epoch: 34, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.046 Vali Acc: 0.744 Test Loss: 1.046 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1795146465301514
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.056 Vali Acc: 0.733 Test Loss: 1.056 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0354714393615723
Epoch: 36, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.062 Vali Acc: 0.750 Test Loss: 1.062 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1597938537597656
Epoch: 37, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.067 Vali Acc: 0.728 Test Loss: 1.067 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.186577558517456
Epoch: 38, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.084 Vali Acc: 0.744 Test Loss: 1.084 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0774056911468506
Epoch: 39, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.072 Vali Acc: 0.750 Test Loss: 1.072 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2065389156341553
Epoch: 40, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.107 Vali Acc: 0.739 Test Loss: 1.107 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 37855
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9957218170166016
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.751 Vali Acc: 0.056 Test Loss: 2.751 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.9916505813598633
Epoch: 2, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.656 Vali Acc: 0.072 Test Loss: 2.656 Test Acc: 0.072
Validation loss decreased (-0.055528 --> -0.072196).  Saving model ...
Epoch: 3 cost time: 1.1489200592041016
Epoch: 3, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.527 Vali Acc: 0.111 Test Loss: 2.527 Test Acc: 0.111
Validation loss decreased (-0.072196 --> -0.111086).  Saving model ...
Epoch: 4 cost time: 1.0627620220184326
Epoch: 4, Steps: 12 | Train Loss: 2.402 Vali Loss: 2.373 Vali Acc: 0.200 Test Loss: 2.373 Test Acc: 0.200
Validation loss decreased (-0.111086 --> -0.199976).  Saving model ...
Epoch: 5 cost time: 1.1669740676879883
Epoch: 5, Steps: 12 | Train Loss: 2.333 Vali Loss: 2.216 Vali Acc: 0.339 Test Loss: 2.216 Test Acc: 0.339
Validation loss decreased (-0.199976 --> -0.338867).  Saving model ...
Epoch: 6 cost time: 1.3866806030273438
Epoch: 6, Steps: 12 | Train Loss: 2.138 Vali Loss: 2.065 Vali Acc: 0.394 Test Loss: 2.065 Test Acc: 0.394
Validation loss decreased (-0.338867 --> -0.394424).  Saving model ...
Epoch: 7 cost time: 1.0062057971954346
Epoch: 7, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.914 Vali Acc: 0.433 Test Loss: 1.914 Test Acc: 0.433
Validation loss decreased (-0.394424 --> -0.433314).  Saving model ...
Epoch: 8 cost time: 1.1838257312774658
Epoch: 8, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.789 Vali Acc: 0.489 Test Loss: 1.789 Test Acc: 0.489
Validation loss decreased (-0.433314 --> -0.488871).  Saving model ...
Epoch: 9 cost time: 1.0991239547729492
Epoch: 9, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.685 Vali Acc: 0.522 Test Loss: 1.685 Test Acc: 0.522
Validation loss decreased (-0.488871 --> -0.522205).  Saving model ...
Epoch: 10 cost time: 1.057243824005127
Epoch: 10, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.594 Vali Acc: 0.544 Test Loss: 1.594 Test Acc: 0.544
Validation loss decreased (-0.522205 --> -0.544428).  Saving model ...
Epoch: 11 cost time: 1.2737770080566406
Epoch: 11, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.512 Vali Acc: 0.583 Test Loss: 1.512 Test Acc: 0.583
Validation loss decreased (-0.544428 --> -0.583318).  Saving model ...
Epoch: 12 cost time: 1.0592503547668457
Epoch: 12, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.449 Vali Acc: 0.572 Test Loss: 1.449 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0407094955444336
Epoch: 13, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.402 Vali Acc: 0.583 Test Loss: 1.402 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 14 cost time: 1.0666875839233398
Epoch: 14, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.364 Vali Acc: 0.561 Test Loss: 1.364 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2252228260040283
Epoch: 15, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.314 Vali Acc: 0.594 Test Loss: 1.314 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594431).  Saving model ...
Epoch: 16 cost time: 1.0287373065948486
Epoch: 16, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.281 Vali Acc: 0.600 Test Loss: 1.281 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599987).  Saving model ...
Epoch: 17 cost time: 1.0552825927734375
Epoch: 17, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.237 Vali Acc: 0.611 Test Loss: 1.237 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611099).  Saving model ...
Epoch: 18 cost time: 1.0625834465026855
Epoch: 18, Steps: 12 | Train Loss: 0.806 Vali Loss: 1.207 Vali Acc: 0.611 Test Loss: 1.207 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 19 cost time: 1.0095558166503906
Epoch: 19, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.175 Vali Acc: 0.644 Test Loss: 1.175 Test Acc: 0.644
Validation loss decreased (-0.611099 --> -0.644433).  Saving model ...
Epoch: 20 cost time: 1.1985158920288086
Epoch: 20, Steps: 12 | Train Loss: 0.684 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
Validation loss decreased (-0.644433 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 1.17130708694458
Epoch: 21, Steps: 12 | Train Loss: 0.628 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 1.0349712371826172
Epoch: 22, Steps: 12 | Train Loss: 0.584 Vali Loss: 1.077 Vali Acc: 0.661 Test Loss: 1.077 Test Acc: 0.661
Validation loss decreased (-0.649989 --> -0.661100).  Saving model ...
Epoch: 23 cost time: 0.9804317951202393
Epoch: 23, Steps: 12 | Train Loss: 0.568 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
Validation loss decreased (-0.661100 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 1.117795467376709
Epoch: 24, Steps: 12 | Train Loss: 0.501 Vali Loss: 1.032 Vali Acc: 0.694 Test Loss: 1.032 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1751794815063477
Epoch: 25, Steps: 12 | Train Loss: 0.473 Vali Loss: 1.008 Vali Acc: 0.694 Test Loss: 1.008 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0074121952056885
Epoch: 26, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 27 cost time: 1.0619068145751953
Epoch: 27, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.979 Vali Acc: 0.694 Test Loss: 0.979 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.122523546218872
Epoch: 28, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 29 cost time: 1.184478521347046
Epoch: 29, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 30 cost time: 1.2800662517547607
Epoch: 30, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.959 Vali Acc: 0.733 Test Loss: 0.959 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 31 cost time: 1.0367374420166016
Epoch: 31, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.947 Vali Acc: 0.722 Test Loss: 0.947 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0150644779205322
Epoch: 32, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.943 Vali Acc: 0.733 Test Loss: 0.943 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 33 cost time: 0.9844436645507812
Epoch: 33, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9885423183441162
Epoch: 34, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.955 Vali Acc: 0.733 Test Loss: 0.955 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0118365287780762
Epoch: 35, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.024214744567871
Epoch: 36, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.959 Vali Acc: 0.733 Test Loss: 0.959 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0371673107147217
Epoch: 37, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.963 Vali Acc: 0.728 Test Loss: 0.963 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0462560653686523
Epoch: 38, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.976 Vali Acc: 0.717 Test Loss: 0.976 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.026137113571167
Epoch: 39, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.972 Vali Acc: 0.711 Test Loss: 0.972 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9361798763275146
Epoch: 40, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.978 Vali Acc: 0.722 Test Loss: 0.978 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1071417331695557
Epoch: 41, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.967 Vali Acc: 0.717 Test Loss: 0.967 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.150552749633789
Epoch: 42, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7333333333333333
model parameter : 27311
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5866034030914307
Epoch: 1, Steps: 12 | Train Loss: 2.871 Vali Loss: 2.777 Vali Acc: 0.072 Test Loss: 2.777 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 1.000274896621704
Epoch: 2, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.688 Vali Acc: 0.167 Test Loss: 2.688 Test Acc: 0.167
Validation loss decreased (-0.072194 --> -0.166640).  Saving model ...
Epoch: 3 cost time: 1.0559086799621582
Epoch: 3, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.563 Vali Acc: 0.217 Test Loss: 2.563 Test Acc: 0.217
Validation loss decreased (-0.166640 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 1.1779520511627197
Epoch: 4, Steps: 12 | Train Loss: 2.495 Vali Loss: 2.425 Vali Acc: 0.272 Test Loss: 2.425 Test Acc: 0.272
Validation loss decreased (-0.216641 --> -0.272198).  Saving model ...
Epoch: 5 cost time: 1.2442021369934082
Epoch: 5, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.280 Vali Acc: 0.328 Test Loss: 2.280 Test Acc: 0.328
Validation loss decreased (-0.272198 --> -0.327755).  Saving model ...
Epoch: 6 cost time: 1.1376891136169434
Epoch: 6, Steps: 12 | Train Loss: 2.208 Vali Loss: 2.125 Vali Acc: 0.406 Test Loss: 2.125 Test Acc: 0.406
Validation loss decreased (-0.327755 --> -0.405534).  Saving model ...
Epoch: 7 cost time: 1.0129635334014893
Epoch: 7, Steps: 12 | Train Loss: 2.041 Vali Loss: 1.976 Vali Acc: 0.456 Test Loss: 1.976 Test Acc: 0.456
Validation loss decreased (-0.405534 --> -0.455536).  Saving model ...
Epoch: 8 cost time: 0.9984776973724365
Epoch: 8, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.840 Vali Acc: 0.511 Test Loss: 1.840 Test Acc: 0.511
Validation loss decreased (-0.455536 --> -0.511093).  Saving model ...
Epoch: 9 cost time: 0.9792852401733398
Epoch: 9, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.737 Vali Acc: 0.528 Test Loss: 1.737 Test Acc: 0.528
Validation loss decreased (-0.511093 --> -0.527760).  Saving model ...
Epoch: 10 cost time: 1.0740480422973633
Epoch: 10, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.646 Vali Acc: 0.533 Test Loss: 1.646 Test Acc: 0.533
Validation loss decreased (-0.527760 --> -0.533317).  Saving model ...
Epoch: 11 cost time: 1.0716321468353271
Epoch: 11, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.564 Vali Acc: 0.567 Test Loss: 1.564 Test Acc: 0.567
Validation loss decreased (-0.533317 --> -0.566651).  Saving model ...
Epoch: 12 cost time: 1.0583314895629883
Epoch: 12, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.517 Vali Acc: 0.606 Test Loss: 1.517 Test Acc: 0.606
Validation loss decreased (-0.566651 --> -0.605540).  Saving model ...
Epoch: 13 cost time: 1.0746493339538574
Epoch: 13, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.454 Vali Acc: 0.606 Test Loss: 1.454 Test Acc: 0.606
Validation loss decreased (-0.605540 --> -0.605541).  Saving model ...
Epoch: 14 cost time: 0.8995046615600586
Epoch: 14, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.406 Vali Acc: 0.628 Test Loss: 1.406 Test Acc: 0.628
Validation loss decreased (-0.605541 --> -0.627764).  Saving model ...
Epoch: 15 cost time: 1.0552713871002197
Epoch: 15, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.381 Vali Acc: 0.600 Test Loss: 1.381 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0813837051391602
Epoch: 16, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.345 Vali Acc: 0.633 Test Loss: 1.345 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633320).  Saving model ...
Epoch: 17 cost time: 1.0225229263305664
Epoch: 17, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.330 Vali Acc: 0.650 Test Loss: 1.330 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649987).  Saving model ...
Epoch: 18 cost time: 1.1042201519012451
Epoch: 18, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.289 Vali Acc: 0.628 Test Loss: 1.289 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.969191312789917
Epoch: 19, Steps: 12 | Train Loss: 0.826 Vali Loss: 1.269 Vali Acc: 0.617 Test Loss: 1.269 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9479925632476807
Epoch: 20, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.238 Vali Acc: 0.661 Test Loss: 1.238 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661099).  Saving model ...
Epoch: 21 cost time: 0.9968996047973633
Epoch: 21, Steps: 12 | Train Loss: 0.709 Vali Loss: 1.225 Vali Acc: 0.667 Test Loss: 1.225 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666654).  Saving model ...
Epoch: 22 cost time: 1.0373029708862305
Epoch: 22, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.201 Vali Acc: 0.650 Test Loss: 1.201 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.071869134902954
Epoch: 23, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.177 Vali Acc: 0.656 Test Loss: 1.177 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0968379974365234
Epoch: 24, Steps: 12 | Train Loss: 0.681 Vali Loss: 1.144 Vali Acc: 0.656 Test Loss: 1.144 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0070745944976807
Epoch: 25, Steps: 12 | Train Loss: 0.570 Vali Loss: 1.127 Vali Acc: 0.667 Test Loss: 1.127 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666655).  Saving model ...
Epoch: 26 cost time: 1.084064245223999
Epoch: 26, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.118 Vali Acc: 0.667 Test Loss: 1.118 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 27 cost time: 0.9778971672058105
Epoch: 27, Steps: 12 | Train Loss: 0.510 Vali Loss: 1.084 Vali Acc: 0.672 Test Loss: 1.084 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 28 cost time: 1.0712194442749023
Epoch: 28, Steps: 12 | Train Loss: 0.507 Vali Loss: 1.063 Vali Acc: 0.661 Test Loss: 1.063 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0476047992706299
Epoch: 29, Steps: 12 | Train Loss: 0.436 Vali Loss: 1.049 Vali Acc: 0.689 Test Loss: 1.049 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 30 cost time: 1.0682928562164307
Epoch: 30, Steps: 12 | Train Loss: 0.367 Vali Loss: 1.023 Vali Acc: 0.694 Test Loss: 1.023 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 31 cost time: 1.1290819644927979
Epoch: 31, Steps: 12 | Train Loss: 0.386 Vali Loss: 1.022 Vali Acc: 0.683 Test Loss: 1.022 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0091304779052734
Epoch: 32, Steps: 12 | Train Loss: 0.371 Vali Loss: 1.020 Vali Acc: 0.706 Test Loss: 1.020 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 33 cost time: 0.9956300258636475
Epoch: 33, Steps: 12 | Train Loss: 0.393 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1169607639312744
Epoch: 34, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0476980209350586
Epoch: 35, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.985 Vali Acc: 0.711 Test Loss: 0.985 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 36 cost time: 1.083470106124878
Epoch: 36, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.998 Vali Acc: 0.711 Test Loss: 0.998 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0320444107055664
Epoch: 37, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.980 Vali Acc: 0.711 Test Loss: 0.980 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 38 cost time: 1.079413652420044
Epoch: 38, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.981 Vali Acc: 0.706 Test Loss: 0.981 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.062610387802124
Epoch: 39, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0795300006866455
Epoch: 40, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.989 Vali Acc: 0.717 Test Loss: 0.989 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 41 cost time: 1.1309278011322021
Epoch: 41, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.995 Vali Acc: 0.706 Test Loss: 0.995 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1170380115509033
Epoch: 42, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722212).  Saving model ...
Epoch: 43 cost time: 1.2434587478637695
Epoch: 43, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1289937496185303
Epoch: 44, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.026 Vali Acc: 0.717 Test Loss: 1.026 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.056323766708374
Epoch: 45, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.010 Vali Acc: 0.717 Test Loss: 1.010 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0637311935424805
Epoch: 46, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.990 Vali Acc: 0.728 Test Loss: 0.990 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 47 cost time: 1.0213801860809326
Epoch: 47, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.025 Vali Acc: 0.733 Test Loss: 1.025 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733323).  Saving model ...
Epoch: 48 cost time: 1.053114652633667
Epoch: 48, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.043 Vali Acc: 0.711 Test Loss: 1.043 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0958571434020996
Epoch: 49, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.043 Vali Acc: 0.717 Test Loss: 1.043 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0502278804779053
Epoch: 50, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.031 Vali Acc: 0.717 Test Loss: 1.031 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9980306625366211
Epoch: 51, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.052 Vali Acc: 0.728 Test Loss: 1.052 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0786185264587402
Epoch: 52, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.058 Vali Acc: 0.728 Test Loss: 1.058 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1374003887176514
Epoch: 53, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.066 Vali Acc: 0.717 Test Loss: 1.066 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1829469203948975
Epoch: 54, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.063 Vali Acc: 0.739 Test Loss: 1.063 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738878).  Saving model ...
Epoch: 55 cost time: 1.177727460861206
Epoch: 55, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.060 Vali Acc: 0.733 Test Loss: 1.060 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1201045513153076
Epoch: 56, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.081 Vali Acc: 0.711 Test Loss: 1.081 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1307764053344727
Epoch: 57, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.068 Vali Acc: 0.722 Test Loss: 1.068 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9848062992095947
Epoch: 58, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.068 Vali Acc: 0.733 Test Loss: 1.068 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.0687167644500732
Epoch: 59, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.081 Vali Acc: 0.733 Test Loss: 1.081 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.142714023590088
Epoch: 60, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.107 Vali Acc: 0.739 Test Loss: 1.107 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.0279440879821777
Epoch: 61, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.105 Vali Acc: 0.739 Test Loss: 1.105 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.0412938594818115
Epoch: 62, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.112 Vali Acc: 0.733 Test Loss: 1.112 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.098559856414795
Epoch: 63, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.125 Vali Acc: 0.728 Test Loss: 1.125 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.08311128616333
Epoch: 64, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.123 Vali Acc: 0.739 Test Loss: 1.123 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 26847
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6183114051818848
Epoch: 1, Steps: 12 | Train Loss: 2.877 Vali Loss: 2.864 Vali Acc: 0.094 Test Loss: 2.864 Test Acc: 0.094
Validation loss decreased (inf --> -0.094416).  Saving model ...
Epoch: 2 cost time: 1.0840554237365723
Epoch: 2, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.757 Vali Acc: 0.111 Test Loss: 2.757 Test Acc: 0.111
Validation loss decreased (-0.094416 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 1.0720250606536865
Epoch: 3, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.631 Vali Acc: 0.156 Test Loss: 2.631 Test Acc: 0.156
Validation loss decreased (-0.111084 --> -0.155529).  Saving model ...
Epoch: 4 cost time: 0.989079475402832
Epoch: 4, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.497 Vali Acc: 0.228 Test Loss: 2.497 Test Acc: 0.228
Validation loss decreased (-0.155529 --> -0.227753).  Saving model ...
Epoch: 5 cost time: 1.048232078552246
Epoch: 5, Steps: 12 | Train Loss: 2.473 Vali Loss: 2.354 Vali Acc: 0.322 Test Loss: 2.354 Test Acc: 0.322
Validation loss decreased (-0.227753 --> -0.322199).  Saving model ...
Epoch: 6 cost time: 1.0666532516479492
Epoch: 6, Steps: 12 | Train Loss: 2.323 Vali Loss: 2.219 Vali Acc: 0.394 Test Loss: 2.219 Test Acc: 0.394
Validation loss decreased (-0.322199 --> -0.394422).  Saving model ...
Epoch: 7 cost time: 0.9970052242279053
Epoch: 7, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.091 Vali Acc: 0.461 Test Loss: 2.091 Test Acc: 0.461
Validation loss decreased (-0.394422 --> -0.461090).  Saving model ...
Epoch: 8 cost time: 1.1309192180633545
Epoch: 8, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.969 Vali Acc: 0.500 Test Loss: 1.969 Test Acc: 0.500
Validation loss decreased (-0.461090 --> -0.499980).  Saving model ...
Epoch: 9 cost time: 1.1438417434692383
Epoch: 9, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.868 Vali Acc: 0.528 Test Loss: 1.868 Test Acc: 0.528
Validation loss decreased (-0.499980 --> -0.527759).  Saving model ...
Epoch: 10 cost time: 1.0712108612060547
Epoch: 10, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.775 Vali Acc: 0.528 Test Loss: 1.775 Test Acc: 0.528
Validation loss decreased (-0.527759 --> -0.527760).  Saving model ...
Epoch: 11 cost time: 1.0282061100006104
Epoch: 11, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.698 Vali Acc: 0.550 Test Loss: 1.698 Test Acc: 0.550
Validation loss decreased (-0.527760 --> -0.549983).  Saving model ...
Epoch: 12 cost time: 1.0258796215057373
Epoch: 12, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.628 Vali Acc: 0.544 Test Loss: 1.628 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.977435827255249
Epoch: 13, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.571 Vali Acc: 0.556 Test Loss: 1.571 Test Acc: 0.556
Validation loss decreased (-0.549983 --> -0.555540).  Saving model ...
Epoch: 14 cost time: 1.0687263011932373
Epoch: 14, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.526 Vali Acc: 0.567 Test Loss: 1.526 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566651).  Saving model ...
Epoch: 15 cost time: 0.9748494625091553
Epoch: 15, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.474 Vali Acc: 0.600 Test Loss: 1.474 Test Acc: 0.600
Validation loss decreased (-0.566651 --> -0.599985).  Saving model ...
Epoch: 16 cost time: 0.9855825901031494
Epoch: 16, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.427 Vali Acc: 0.611 Test Loss: 1.427 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 17 cost time: 1.0449552536010742
Epoch: 17, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.389 Vali Acc: 0.617 Test Loss: 1.389 Test Acc: 0.617
Validation loss decreased (-0.611097 --> -0.616653).  Saving model ...
Epoch: 18 cost time: 1.0553886890411377
Epoch: 18, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.369 Vali Acc: 0.644 Test Loss: 1.369 Test Acc: 0.644
Validation loss decreased (-0.616653 --> -0.644431).  Saving model ...
Epoch: 19 cost time: 1.0657365322113037
Epoch: 19, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.343 Vali Acc: 0.656 Test Loss: 1.343 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655542).  Saving model ...
Epoch: 20 cost time: 1.0391590595245361
Epoch: 20, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.305 Vali Acc: 0.650 Test Loss: 1.305 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1291723251342773
Epoch: 21, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.280 Vali Acc: 0.633 Test Loss: 1.280 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0398523807525635
Epoch: 22, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.263 Vali Acc: 0.650 Test Loss: 1.263 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0151984691619873
Epoch: 23, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.236 Vali Acc: 0.656 Test Loss: 1.236 Test Acc: 0.656
Validation loss decreased (-0.655542 --> -0.655543).  Saving model ...
Epoch: 24 cost time: 0.9778189659118652
Epoch: 24, Steps: 12 | Train Loss: 0.760 Vali Loss: 1.215 Vali Acc: 0.661 Test Loss: 1.215 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 25 cost time: 0.9830055236816406
Epoch: 25, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.193 Vali Acc: 0.672 Test Loss: 1.193 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672210).  Saving model ...
Epoch: 26 cost time: 0.9559414386749268
Epoch: 26, Steps: 12 | Train Loss: 0.707 Vali Loss: 1.172 Vali Acc: 0.683 Test Loss: 1.172 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 27 cost time: 1.0439965724945068
Epoch: 27, Steps: 12 | Train Loss: 0.631 Vali Loss: 1.150 Vali Acc: 0.689 Test Loss: 1.150 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688877).  Saving model ...
Epoch: 28 cost time: 1.034409761428833
Epoch: 28, Steps: 12 | Train Loss: 0.601 Vali Loss: 1.138 Vali Acc: 0.683 Test Loss: 1.138 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0130958557128906
Epoch: 29, Steps: 12 | Train Loss: 0.607 Vali Loss: 1.119 Vali Acc: 0.672 Test Loss: 1.119 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.134225606918335
Epoch: 30, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.105 Vali Acc: 0.689 Test Loss: 1.105 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688878).  Saving model ...
Epoch: 31 cost time: 1.1720168590545654
Epoch: 31, Steps: 12 | Train Loss: 0.512 Vali Loss: 1.090 Vali Acc: 0.694 Test Loss: 1.090 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 32 cost time: 1.100318193435669
Epoch: 32, Steps: 12 | Train Loss: 0.539 Vali Loss: 1.076 Vali Acc: 0.689 Test Loss: 1.076 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0758929252624512
Epoch: 33, Steps: 12 | Train Loss: 0.494 Vali Loss: 1.048 Vali Acc: 0.717 Test Loss: 1.048 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716656).  Saving model ...
Epoch: 34 cost time: 1.0442092418670654
Epoch: 34, Steps: 12 | Train Loss: 0.460 Vali Loss: 1.040 Vali Acc: 0.717 Test Loss: 1.040 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716656).  Saving model ...
Epoch: 35 cost time: 1.091984748840332
Epoch: 35, Steps: 12 | Train Loss: 0.458 Vali Loss: 1.041 Vali Acc: 0.717 Test Loss: 1.041 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0183908939361572
Epoch: 36, Steps: 12 | Train Loss: 0.413 Vali Loss: 1.042 Vali Acc: 0.706 Test Loss: 1.042 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.017695426940918
Epoch: 37, Steps: 12 | Train Loss: 0.372 Vali Loss: 1.029 Vali Acc: 0.711 Test Loss: 1.029 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0758638381958008
Epoch: 38, Steps: 12 | Train Loss: 0.381 Vali Loss: 1.008 Vali Acc: 0.717 Test Loss: 1.008 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716657).  Saving model ...
Epoch: 39 cost time: 1.157102346420288
Epoch: 39, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9904966354370117
Epoch: 40, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.990 Vali Acc: 0.717 Test Loss: 0.990 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 41 cost time: 1.0605921745300293
Epoch: 41, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0229382514953613
Epoch: 42, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.996 Vali Acc: 0.717 Test Loss: 0.996 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0976288318634033
Epoch: 43, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.973 Vali Acc: 0.722 Test Loss: 0.973 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722212).  Saving model ...
Epoch: 44 cost time: 1.012998342514038
Epoch: 44, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 45 cost time: 1.106518030166626
Epoch: 45, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.964 Vali Acc: 0.728 Test Loss: 0.964 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727768).  Saving model ...
Epoch: 46 cost time: 0.9761714935302734
Epoch: 46, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.979 Vali Acc: 0.722 Test Loss: 0.979 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0649070739746094
Epoch: 47, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.955 Vali Acc: 0.722 Test Loss: 0.955 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1506268978118896
Epoch: 48, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.962 Vali Acc: 0.733 Test Loss: 0.962 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 49 cost time: 1.0562143325805664
Epoch: 49, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.958 Vali Acc: 0.728 Test Loss: 0.958 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0233478546142578
Epoch: 50, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.955 Vali Acc: 0.744 Test Loss: 0.955 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 51 cost time: 0.9871475696563721
Epoch: 51, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.964 Vali Acc: 0.739 Test Loss: 0.964 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0408973693847656
Epoch: 52, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.968 Vali Acc: 0.733 Test Loss: 0.968 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.044341802597046
Epoch: 53, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.967 Vali Acc: 0.739 Test Loss: 0.967 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.004162311553955
Epoch: 54, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.151275396347046
Epoch: 55, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.974 Vali Acc: 0.722 Test Loss: 0.974 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2136058807373047
Epoch: 56, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.989 Vali Acc: 0.733 Test Loss: 0.989 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.080134630203247
Epoch: 57, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.976 Vali Acc: 0.733 Test Loss: 0.976 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1065950393676758
Epoch: 58, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.974 Vali Acc: 0.733 Test Loss: 0.974 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.1192526817321777
Epoch: 59, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.976 Vali Acc: 0.733 Test Loss: 0.976 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.116708755493164
Epoch: 60, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.978 Vali Acc: 0.744 Test Loss: 0.978 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 23503
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6065781116485596
Epoch: 1, Steps: 12 | Train Loss: 2.873 Vali Loss: 2.772 Vali Acc: 0.056 Test Loss: 2.772 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 1.0456132888793945
Epoch: 2, Steps: 12 | Train Loss: 2.797 Vali Loss: 2.679 Vali Acc: 0.089 Test Loss: 2.679 Test Acc: 0.089
Validation loss decreased (-0.055528 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 1.0932362079620361
Epoch: 3, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.578 Vali Acc: 0.128 Test Loss: 2.578 Test Acc: 0.128
Validation loss decreased (-0.088862 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 1.0053772926330566
Epoch: 4, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.466 Vali Acc: 0.178 Test Loss: 2.466 Test Acc: 0.178
Validation loss decreased (-0.127752 --> -0.177753).  Saving model ...
Epoch: 5 cost time: 1.0470547676086426
Epoch: 5, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.353 Vali Acc: 0.283 Test Loss: 2.353 Test Acc: 0.283
Validation loss decreased (-0.177753 --> -0.283310).  Saving model ...
Epoch: 6 cost time: 0.9697370529174805
Epoch: 6, Steps: 12 | Train Loss: 2.314 Vali Loss: 2.239 Vali Acc: 0.361 Test Loss: 2.239 Test Acc: 0.361
Validation loss decreased (-0.283310 --> -0.361089).  Saving model ...
Epoch: 7 cost time: 0.9760301113128662
Epoch: 7, Steps: 12 | Train Loss: 2.240 Vali Loss: 2.126 Vali Acc: 0.411 Test Loss: 2.126 Test Acc: 0.411
Validation loss decreased (-0.361089 --> -0.411090).  Saving model ...
Epoch: 8 cost time: 1.0661218166351318
Epoch: 8, Steps: 12 | Train Loss: 2.092 Vali Loss: 2.018 Vali Acc: 0.467 Test Loss: 2.018 Test Acc: 0.467
Validation loss decreased (-0.411090 --> -0.466646).  Saving model ...
Epoch: 9 cost time: 1.0311107635498047
Epoch: 9, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.924 Vali Acc: 0.483 Test Loss: 1.924 Test Acc: 0.483
Validation loss decreased (-0.466646 --> -0.483314).  Saving model ...
Epoch: 10 cost time: 0.962855339050293
Epoch: 10, Steps: 12 | Train Loss: 1.837 Vali Loss: 1.836 Vali Acc: 0.494 Test Loss: 1.836 Test Acc: 0.494
Validation loss decreased (-0.483314 --> -0.494426).  Saving model ...
Epoch: 11 cost time: 0.9928324222564697
Epoch: 11, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.759 Vali Acc: 0.528 Test Loss: 1.759 Test Acc: 0.528
Validation loss decreased (-0.494426 --> -0.527760).  Saving model ...
Epoch: 12 cost time: 1.0291469097137451
Epoch: 12, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.684 Vali Acc: 0.556 Test Loss: 1.684 Test Acc: 0.556
Validation loss decreased (-0.527760 --> -0.555539).  Saving model ...
Epoch: 13 cost time: 0.9900805950164795
Epoch: 13, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.619 Vali Acc: 0.561 Test Loss: 1.619 Test Acc: 0.561
Validation loss decreased (-0.555539 --> -0.561095).  Saving model ...
Epoch: 14 cost time: 0.9569365978240967
Epoch: 14, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.558 Vali Acc: 0.567 Test Loss: 1.558 Test Acc: 0.567
Validation loss decreased (-0.561095 --> -0.566651).  Saving model ...
Epoch: 15 cost time: 1.08693265914917
Epoch: 15, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.511 Vali Acc: 0.572 Test Loss: 1.511 Test Acc: 0.572
Validation loss decreased (-0.566651 --> -0.572207).  Saving model ...
Epoch: 16 cost time: 1.0507900714874268
Epoch: 16, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.469 Vali Acc: 0.572 Test Loss: 1.469 Test Acc: 0.572
Validation loss decreased (-0.572207 --> -0.572208).  Saving model ...
Epoch: 17 cost time: 0.9875233173370361
Epoch: 17, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.424 Vali Acc: 0.572 Test Loss: 1.424 Test Acc: 0.572
Validation loss decreased (-0.572208 --> -0.572208).  Saving model ...
Epoch: 18 cost time: 1.1758503913879395
Epoch: 18, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.392 Vali Acc: 0.572 Test Loss: 1.392 Test Acc: 0.572
Validation loss decreased (-0.572208 --> -0.572208).  Saving model ...
Epoch: 19 cost time: 1.0973172187805176
Epoch: 19, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.363 Vali Acc: 0.583 Test Loss: 1.363 Test Acc: 0.583
Validation loss decreased (-0.572208 --> -0.583320).  Saving model ...
Epoch: 20 cost time: 1.107248067855835
Epoch: 20, Steps: 12 | Train Loss: 1.090 Vali Loss: 1.333 Vali Acc: 0.611 Test Loss: 1.333 Test Acc: 0.611
Validation loss decreased (-0.583320 --> -0.611098).  Saving model ...
Epoch: 21 cost time: 1.0873596668243408
Epoch: 21, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.304 Vali Acc: 0.622 Test Loss: 1.304 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 22 cost time: 1.1443207263946533
Epoch: 22, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.275 Vali Acc: 0.628 Test Loss: 1.275 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 23 cost time: 1.065094232559204
Epoch: 23, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.253 Vali Acc: 0.633 Test Loss: 1.253 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 24 cost time: 1.1811165809631348
Epoch: 24, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.226 Vali Acc: 0.650 Test Loss: 1.226 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649988).  Saving model ...
Epoch: 25 cost time: 1.1369001865386963
Epoch: 25, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.207 Vali Acc: 0.667 Test Loss: 1.207 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666655).  Saving model ...
Epoch: 26 cost time: 1.082242727279663
Epoch: 26, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.195 Vali Acc: 0.667 Test Loss: 1.195 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 27 cost time: 1.2423095703125
Epoch: 27, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.173 Vali Acc: 0.644 Test Loss: 1.173 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.102593183517456
Epoch: 28, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.163 Vali Acc: 0.667 Test Loss: 1.163 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 29 cost time: 1.2214572429656982
Epoch: 29, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.141 Vali Acc: 0.678 Test Loss: 1.141 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677766).  Saving model ...
Epoch: 30 cost time: 1.1505327224731445
Epoch: 30, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.122 Vali Acc: 0.672 Test Loss: 1.122 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0021438598632812
Epoch: 31, Steps: 12 | Train Loss: 0.695 Vali Loss: 1.096 Vali Acc: 0.661 Test Loss: 1.096 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.183074712753296
Epoch: 32, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.082 Vali Acc: 0.672 Test Loss: 1.082 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0308363437652588
Epoch: 33, Steps: 12 | Train Loss: 0.651 Vali Loss: 1.064 Vali Acc: 0.678 Test Loss: 1.064 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677767).  Saving model ...
Epoch: 34 cost time: 1.1755716800689697
Epoch: 34, Steps: 12 | Train Loss: 0.638 Vali Loss: 1.042 Vali Acc: 0.683 Test Loss: 1.042 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 35 cost time: 1.1326382160186768
Epoch: 35, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.030 Vali Acc: 0.700 Test Loss: 1.030 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699990).  Saving model ...
Epoch: 36 cost time: 1.216141939163208
Epoch: 36, Steps: 12 | Train Loss: 0.545 Vali Loss: 1.022 Vali Acc: 0.694 Test Loss: 1.022 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2950384616851807
Epoch: 37, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.999 Vali Acc: 0.722 Test Loss: 0.999 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722212).  Saving model ...
Epoch: 38 cost time: 1.1787705421447754
Epoch: 38, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.990 Vali Acc: 0.722 Test Loss: 0.990 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 39 cost time: 1.230485200881958
Epoch: 39, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.981 Vali Acc: 0.728 Test Loss: 0.981 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 40 cost time: 1.1545302867889404
Epoch: 40, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.967 Vali Acc: 0.722 Test Loss: 0.967 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0393340587615967
Epoch: 41, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.957 Vali Acc: 0.744 Test Loss: 0.957 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 42 cost time: 1.1279826164245605
Epoch: 42, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.952 Vali Acc: 0.756 Test Loss: 0.952 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 43 cost time: 0.9911270141601562
Epoch: 43, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.942 Vali Acc: 0.739 Test Loss: 0.942 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1216349601745605
Epoch: 44, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.926 Vali Acc: 0.744 Test Loss: 0.926 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2624590396881104
Epoch: 45, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1354401111602783
Epoch: 46, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.922 Vali Acc: 0.733 Test Loss: 0.922 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1765375137329102
Epoch: 47, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2256898880004883
Epoch: 48, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.922 Vali Acc: 0.750 Test Loss: 0.922 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1613490581512451
Epoch: 49, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.926 Vali Acc: 0.744 Test Loss: 0.926 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0260038375854492
Epoch: 50, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.1832187175750732
Epoch: 51, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0655038356781006
Epoch: 52, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.902 Vali Acc: 0.744 Test Loss: 0.902 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 21615
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7664504051208496
Epoch: 1, Steps: 12 | Train Loss: 2.852 Vali Loss: 2.743 Vali Acc: 0.017 Test Loss: 2.743 Test Acc: 0.017
Validation loss decreased (inf --> -0.016639).  Saving model ...
Epoch: 2 cost time: 1.0341689586639404
Epoch: 2, Steps: 12 | Train Loss: 2.844 Vali Loss: 2.679 Vali Acc: 0.011 Test Loss: 2.679 Test Acc: 0.011
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.010544776916504
Epoch: 3, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.598 Vali Acc: 0.056 Test Loss: 2.598 Test Acc: 0.056
Validation loss decreased (-0.016639 --> -0.055530).  Saving model ...
Epoch: 4 cost time: 1.044503927230835
Epoch: 4, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.505 Vali Acc: 0.083 Test Loss: 2.505 Test Acc: 0.083
Validation loss decreased (-0.055530 --> -0.083308).  Saving model ...
Epoch: 5 cost time: 1.1893489360809326
Epoch: 5, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.405 Vali Acc: 0.150 Test Loss: 2.405 Test Acc: 0.150
Validation loss decreased (-0.083308 --> -0.149976).  Saving model ...
Epoch: 6 cost time: 1.1791293621063232
Epoch: 6, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.303 Vali Acc: 0.239 Test Loss: 2.303 Test Acc: 0.239
Validation loss decreased (-0.149976 --> -0.238866).  Saving model ...
Epoch: 7 cost time: 1.0165977478027344
Epoch: 7, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.203 Vali Acc: 0.306 Test Loss: 2.203 Test Acc: 0.306
Validation loss decreased (-0.238866 --> -0.305534).  Saving model ...
Epoch: 8 cost time: 0.9757976531982422
Epoch: 8, Steps: 12 | Train Loss: 2.207 Vali Loss: 2.111 Vali Acc: 0.394 Test Loss: 2.111 Test Acc: 0.394
Validation loss decreased (-0.305534 --> -0.394423).  Saving model ...
Epoch: 9 cost time: 0.9821796417236328
Epoch: 9, Steps: 12 | Train Loss: 2.119 Vali Loss: 2.021 Vali Acc: 0.444 Test Loss: 2.021 Test Acc: 0.444
Validation loss decreased (-0.394423 --> -0.444424).  Saving model ...
Epoch: 10 cost time: 0.8430891036987305
Epoch: 10, Steps: 12 | Train Loss: 1.942 Vali Loss: 1.930 Vali Acc: 0.478 Test Loss: 1.930 Test Acc: 0.478
Validation loss decreased (-0.444424 --> -0.477758).  Saving model ...
Epoch: 11 cost time: 0.8678593635559082
Epoch: 11, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.855 Vali Acc: 0.483 Test Loss: 1.855 Test Acc: 0.483
Validation loss decreased (-0.477758 --> -0.483315).  Saving model ...
Epoch: 12 cost time: 1.0245702266693115
Epoch: 12, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.791 Vali Acc: 0.478 Test Loss: 1.791 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9769461154937744
Epoch: 13, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.724 Vali Acc: 0.517 Test Loss: 1.724 Test Acc: 0.517
Validation loss decreased (-0.483315 --> -0.516649).  Saving model ...
Epoch: 14 cost time: 1.0606598854064941
Epoch: 14, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.662 Vali Acc: 0.506 Test Loss: 1.662 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0571906566619873
Epoch: 15, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.599 Vali Acc: 0.544 Test Loss: 1.599 Test Acc: 0.544
Validation loss decreased (-0.516649 --> -0.544428).  Saving model ...
Epoch: 16 cost time: 0.9500916004180908
Epoch: 16, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.550 Vali Acc: 0.556 Test Loss: 1.550 Test Acc: 0.556
Validation loss decreased (-0.544428 --> -0.555540).  Saving model ...
Epoch: 17 cost time: 0.8946511745452881
Epoch: 17, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.509 Vali Acc: 0.578 Test Loss: 1.509 Test Acc: 0.578
Validation loss decreased (-0.555540 --> -0.577763).  Saving model ...
Epoch: 18 cost time: 1.0305001735687256
Epoch: 18, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.453 Vali Acc: 0.578 Test Loss: 1.453 Test Acc: 0.578
Validation loss decreased (-0.577763 --> -0.577763).  Saving model ...
Epoch: 19 cost time: 1.1012895107269287
Epoch: 19, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.399 Vali Acc: 0.583 Test Loss: 1.399 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 20 cost time: 0.9359872341156006
Epoch: 20, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.350 Vali Acc: 0.594 Test Loss: 1.350 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594431).  Saving model ...
Epoch: 21 cost time: 0.9524247646331787
Epoch: 21, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.307 Vali Acc: 0.606 Test Loss: 1.307 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605542).  Saving model ...
Epoch: 22 cost time: 0.9105675220489502
Epoch: 22, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.258 Vali Acc: 0.611 Test Loss: 1.258 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611099).  Saving model ...
Epoch: 23 cost time: 0.9443602561950684
Epoch: 23, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.216 Vali Acc: 0.611 Test Loss: 1.216 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 24 cost time: 1.1148693561553955
Epoch: 24, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.183 Vali Acc: 0.617 Test Loss: 1.183 Test Acc: 0.617
Validation loss decreased (-0.611099 --> -0.616655).  Saving model ...
Epoch: 25 cost time: 1.0753023624420166
Epoch: 25, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.145 Vali Acc: 0.606 Test Loss: 1.145 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9356744289398193
Epoch: 26, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.110 Vali Acc: 0.617 Test Loss: 1.110 Test Acc: 0.617
Validation loss decreased (-0.616655 --> -0.616656).  Saving model ...
Epoch: 27 cost time: 0.9836428165435791
Epoch: 27, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.074 Vali Acc: 0.617 Test Loss: 1.074 Test Acc: 0.617
Validation loss decreased (-0.616656 --> -0.616656).  Saving model ...
Epoch: 28 cost time: 0.9680995941162109
Epoch: 28, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.049 Vali Acc: 0.611 Test Loss: 1.049 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8887691497802734
Epoch: 29, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.021 Vali Acc: 0.633 Test Loss: 1.021 Test Acc: 0.633
Validation loss decreased (-0.616656 --> -0.633323).  Saving model ...
Epoch: 30 cost time: 1.0766046047210693
Epoch: 30, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
Validation loss decreased (-0.633323 --> -0.649990).  Saving model ...
Epoch: 31 cost time: 0.8739068508148193
Epoch: 31, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.974 Vali Acc: 0.656 Test Loss: 0.974 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 32 cost time: 0.8556628227233887
Epoch: 32, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.951 Vali Acc: 0.656 Test Loss: 0.951 Test Acc: 0.656
Validation loss decreased (-0.655546 --> -0.655546).  Saving model ...
Epoch: 33 cost time: 0.8740296363830566
Epoch: 33, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.939 Vali Acc: 0.667 Test Loss: 0.939 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 34 cost time: 1.1386544704437256
Epoch: 34, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.925 Vali Acc: 0.667 Test Loss: 0.925 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 35 cost time: 1.0330979824066162
Epoch: 35, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.911 Vali Acc: 0.667 Test Loss: 0.911 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666658).  Saving model ...
Epoch: 36 cost time: 1.0096924304962158
Epoch: 36, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.910 Vali Acc: 0.689 Test Loss: 0.910 Test Acc: 0.689
Validation loss decreased (-0.666658 --> -0.688880).  Saving model ...
Epoch: 37 cost time: 1.0115959644317627
Epoch: 37, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.898 Vali Acc: 0.689 Test Loss: 0.898 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 38 cost time: 0.9360716342926025
Epoch: 38, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.881 Vali Acc: 0.717 Test Loss: 0.881 Test Acc: 0.717
Validation loss decreased (-0.688880 --> -0.716658).  Saving model ...
Epoch: 39 cost time: 1.000915288925171
Epoch: 39, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 40 cost time: 0.9482865333557129
Epoch: 40, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.851 Vali Acc: 0.711 Test Loss: 0.851 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.911790132522583
Epoch: 41, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.861 Vali Acc: 0.711 Test Loss: 0.861 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0154659748077393
Epoch: 42, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.841 Vali Acc: 0.733 Test Loss: 0.841 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733325).  Saving model ...
Epoch: 43 cost time: 0.967719554901123
Epoch: 43, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.840 Vali Acc: 0.739 Test Loss: 0.840 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738880).  Saving model ...
Epoch: 44 cost time: 0.8357367515563965
Epoch: 44, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 45 cost time: 0.9922623634338379
Epoch: 45, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.802 Vali Acc: 0.733 Test Loss: 0.802 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0107572078704834
Epoch: 46, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.802 Vali Acc: 0.733 Test Loss: 0.802 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0183074474334717
Epoch: 47, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9759440422058105
Epoch: 48, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.794 Vali Acc: 0.744 Test Loss: 0.794 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9521863460540771
Epoch: 49, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.820 Vali Acc: 0.728 Test Loss: 0.820 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1427693367004395
Epoch: 50, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.788 Vali Acc: 0.733 Test Loss: 0.788 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.00754976272583
Epoch: 51, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.776 Vali Acc: 0.761 Test Loss: 0.776 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 52 cost time: 0.9907665252685547
Epoch: 52, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.781 Vali Acc: 0.772 Test Loss: 0.781 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 53 cost time: 0.9374673366546631
Epoch: 53, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.775 Vali Acc: 0.761 Test Loss: 0.775 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.04905366897583
Epoch: 54, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.761 Vali Acc: 0.744 Test Loss: 0.761 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9107165336608887
Epoch: 55, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.0061101913452148
Epoch: 56, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.745 Vali Acc: 0.767 Test Loss: 0.745 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0117082595825195
Epoch: 57, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.744 Vali Acc: 0.778 Test Loss: 0.744 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 58 cost time: 0.9618327617645264
Epoch: 58, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.735 Vali Acc: 0.767 Test Loss: 0.735 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1100184917449951
Epoch: 59, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9594020843505859
Epoch: 60, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.737 Vali Acc: 0.767 Test Loss: 0.737 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8963005542755127
Epoch: 61, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.749 Vali Acc: 0.772 Test Loss: 0.749 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9490277767181396
Epoch: 62, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.750 Vali Acc: 0.778 Test Loss: 0.750 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.2241897583007812
Epoch: 63, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.755 Vali Acc: 0.772 Test Loss: 0.755 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.9671039581298828
Epoch: 64, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 65 cost time: 0.9377052783966064
Epoch: 65, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 66 cost time: 1.0326898097991943
Epoch: 66, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.766 Vali Acc: 0.778 Test Loss: 0.766 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9750807285308838
Epoch: 67, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.740 Vali Acc: 0.778 Test Loss: 0.740 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1607697010040283
Epoch: 68, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.741 Vali Acc: 0.778 Test Loss: 0.741 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9966576099395752
Epoch: 69, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.9555580615997314
Epoch: 70, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.735 Vali Acc: 0.789 Test Loss: 0.735 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.00750732421875
Epoch: 71, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.724 Vali Acc: 0.789 Test Loss: 0.724 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.1887824535369873
Epoch: 72, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.734 Vali Acc: 0.789 Test Loss: 0.734 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.9791703224182129
Epoch: 73, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.748 Vali Acc: 0.783 Test Loss: 0.748 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.8635728359222412
Epoch: 74, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.9515635967254639
Epoch: 75, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.730 Vali Acc: 0.794 Test Loss: 0.730 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 76 cost time: 1.0695545673370361
Epoch: 76, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.733 Vali Acc: 0.789 Test Loss: 0.733 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9761576652526855
Epoch: 77, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 78 cost time: 0.9597198963165283
Epoch: 78, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 79 cost time: 0.9160027503967285
Epoch: 79, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.0406417846679688
Epoch: 80, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.764 Vali Acc: 0.806 Test Loss: 0.764 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 81 cost time: 1.0379245281219482
Epoch: 81, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.751 Vali Acc: 0.794 Test Loss: 0.751 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.9105527400970459
Epoch: 82, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.758 Vali Acc: 0.772 Test Loss: 0.758 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.8722634315490723
Epoch: 83, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.9962465763092041
Epoch: 84, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.745 Vali Acc: 0.789 Test Loss: 0.745 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.9963910579681396
Epoch: 85, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.0588445663452148
Epoch: 86, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.770 Vali Acc: 0.783 Test Loss: 0.770 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.056537389755249
Epoch: 87, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.949765682220459
Epoch: 88, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.759 Vali Acc: 0.783 Test Loss: 0.759 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.9300105571746826
Epoch: 89, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.774 Vali Acc: 0.789 Test Loss: 0.774 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.9419674873352051
Epoch: 90, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 20687
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7712976932525635
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.786 Vali Acc: 0.061 Test Loss: 2.786 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 0.949244499206543
Epoch: 2, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.745 Vali Acc: 0.078 Test Loss: 2.745 Test Acc: 0.078
Validation loss decreased (-0.061083 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 1.0115330219268799
Epoch: 3, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.683 Vali Acc: 0.111 Test Loss: 2.683 Test Acc: 0.111
Validation loss decreased (-0.077750 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 0.9912219047546387
Epoch: 4, Steps: 12 | Train Loss: 2.554 Vali Loss: 2.607 Vali Acc: 0.172 Test Loss: 2.607 Test Acc: 0.172
Validation loss decreased (-0.111084 --> -0.172196).  Saving model ...
Epoch: 5 cost time: 1.1514432430267334
Epoch: 5, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.525 Vali Acc: 0.228 Test Loss: 2.525 Test Acc: 0.228
Validation loss decreased (-0.172196 --> -0.227753).  Saving model ...
Epoch: 6 cost time: 0.9934511184692383
Epoch: 6, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.444 Vali Acc: 0.256 Test Loss: 2.444 Test Acc: 0.256
Validation loss decreased (-0.227753 --> -0.255531).  Saving model ...
Epoch: 7 cost time: 0.9670722484588623
Epoch: 7, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.359 Vali Acc: 0.322 Test Loss: 2.359 Test Acc: 0.322
Validation loss decreased (-0.255531 --> -0.322199).  Saving model ...
Epoch: 8 cost time: 0.9284238815307617
Epoch: 8, Steps: 12 | Train Loss: 2.298 Vali Loss: 2.270 Vali Acc: 0.394 Test Loss: 2.270 Test Acc: 0.394
Validation loss decreased (-0.322199 --> -0.394422).  Saving model ...
Epoch: 9 cost time: 0.9820048809051514
Epoch: 9, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.186 Vali Acc: 0.394 Test Loss: 2.186 Test Acc: 0.394
Validation loss decreased (-0.394422 --> -0.394423).  Saving model ...
Epoch: 10 cost time: 0.9504528045654297
Epoch: 10, Steps: 12 | Train Loss: 2.093 Vali Loss: 2.102 Vali Acc: 0.389 Test Loss: 2.102 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9593784809112549
Epoch: 11, Steps: 12 | Train Loss: 1.987 Vali Loss: 2.029 Vali Acc: 0.417 Test Loss: 2.029 Test Acc: 0.417
Validation loss decreased (-0.394423 --> -0.416646).  Saving model ...
Epoch: 12 cost time: 1.023937702178955
Epoch: 12, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.945 Vali Acc: 0.461 Test Loss: 1.945 Test Acc: 0.461
Validation loss decreased (-0.416646 --> -0.461092).  Saving model ...
Epoch: 13 cost time: 0.8905582427978516
Epoch: 13, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.870 Vali Acc: 0.478 Test Loss: 1.870 Test Acc: 0.478
Validation loss decreased (-0.461092 --> -0.477759).  Saving model ...
Epoch: 14 cost time: 1.002910852432251
Epoch: 14, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.797 Vali Acc: 0.478 Test Loss: 1.797 Test Acc: 0.478
Validation loss decreased (-0.477759 --> -0.477760).  Saving model ...
Epoch: 15 cost time: 1.0481767654418945
Epoch: 15, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.730 Vali Acc: 0.489 Test Loss: 1.730 Test Acc: 0.489
Validation loss decreased (-0.477760 --> -0.488872).  Saving model ...
Epoch: 16 cost time: 1.0988616943359375
Epoch: 16, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.661 Vali Acc: 0.528 Test Loss: 1.661 Test Acc: 0.528
Validation loss decreased (-0.488872 --> -0.527761).  Saving model ...
Epoch: 17 cost time: 1.0106587409973145
Epoch: 17, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.604 Vali Acc: 0.544 Test Loss: 1.604 Test Acc: 0.544
Validation loss decreased (-0.527761 --> -0.544428).  Saving model ...
Epoch: 18 cost time: 1.0934550762176514
Epoch: 18, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.548 Vali Acc: 0.556 Test Loss: 1.548 Test Acc: 0.556
Validation loss decreased (-0.544428 --> -0.555540).  Saving model ...
Epoch: 19 cost time: 0.9519076347351074
Epoch: 19, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.483 Vali Acc: 0.589 Test Loss: 1.483 Test Acc: 0.589
Validation loss decreased (-0.555540 --> -0.588874).  Saving model ...
Epoch: 20 cost time: 0.9272172451019287
Epoch: 20, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.428 Vali Acc: 0.600 Test Loss: 1.428 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 21 cost time: 0.9514706134796143
Epoch: 21, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.359 Vali Acc: 0.600 Test Loss: 1.359 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 1.0036554336547852
Epoch: 22, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 23 cost time: 1.060929536819458
Epoch: 23, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.257 Vali Acc: 0.606 Test Loss: 1.257 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605543).  Saving model ...
Epoch: 24 cost time: 1.0224964618682861
Epoch: 24, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.217 Vali Acc: 0.606 Test Loss: 1.217 Test Acc: 0.606
Validation loss decreased (-0.605543 --> -0.605543).  Saving model ...
Epoch: 25 cost time: 1.097132921218872
Epoch: 25, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.175 Vali Acc: 0.606 Test Loss: 1.175 Test Acc: 0.606
Validation loss decreased (-0.605543 --> -0.605544).  Saving model ...
Epoch: 26 cost time: 0.9770057201385498
Epoch: 26, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.135 Vali Acc: 0.633 Test Loss: 1.135 Test Acc: 0.633
Validation loss decreased (-0.605544 --> -0.633322).  Saving model ...
Epoch: 27 cost time: 1.0634315013885498
Epoch: 27, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.110 Vali Acc: 0.633 Test Loss: 1.110 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 28 cost time: 1.05643630027771
Epoch: 28, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.083 Vali Acc: 0.633 Test Loss: 1.083 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633323).  Saving model ...
Epoch: 29 cost time: 1.0631847381591797
Epoch: 29, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
Validation loss decreased (-0.633323 --> -0.649989).  Saving model ...
Epoch: 30 cost time: 1.013554573059082
Epoch: 30, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.041 Vali Acc: 0.656 Test Loss: 1.041 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 31 cost time: 0.9602859020233154
Epoch: 31, Steps: 12 | Train Loss: 0.748 Vali Loss: 1.012 Vali Acc: 0.644 Test Loss: 1.012 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0310859680175781
Epoch: 32, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.989 Vali Acc: 0.661 Test Loss: 0.989 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661101).  Saving model ...
Epoch: 33 cost time: 0.9691128730773926
Epoch: 33, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.984 Vali Acc: 0.656 Test Loss: 0.984 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1089468002319336
Epoch: 34, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.973 Vali Acc: 0.672 Test Loss: 0.973 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672212).  Saving model ...
Epoch: 35 cost time: 1.0104749202728271
Epoch: 35, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.955 Vali Acc: 0.667 Test Loss: 0.955 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0876855850219727
Epoch: 36, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.943 Vali Acc: 0.661 Test Loss: 0.943 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0799839496612549
Epoch: 37, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.930 Vali Acc: 0.672 Test Loss: 0.930 Test Acc: 0.672
Validation loss decreased (-0.672212 --> -0.672213).  Saving model ...
Epoch: 38 cost time: 1.085970401763916
Epoch: 38, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.914 Vali Acc: 0.683 Test Loss: 0.914 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683324).  Saving model ...
Epoch: 39 cost time: 1.0776748657226562
Epoch: 39, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.902 Vali Acc: 0.689 Test Loss: 0.902 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 40 cost time: 1.0653648376464844
Epoch: 40, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.906 Vali Acc: 0.694 Test Loss: 0.906 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694435).  Saving model ...
Epoch: 41 cost time: 1.1431703567504883
Epoch: 41, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.890 Vali Acc: 0.717 Test Loss: 0.890 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716658).  Saving model ...
Epoch: 42 cost time: 1.0919256210327148
Epoch: 42, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.880 Vali Acc: 0.717 Test Loss: 0.880 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 43 cost time: 1.0872914791107178
Epoch: 43, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.877 Vali Acc: 0.717 Test Loss: 0.877 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 44 cost time: 0.9959151744842529
Epoch: 44, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.866 Vali Acc: 0.706 Test Loss: 0.866 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9972896575927734
Epoch: 45, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.864 Vali Acc: 0.711 Test Loss: 0.864 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9643130302429199
Epoch: 46, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.858 Vali Acc: 0.700 Test Loss: 0.858 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9954743385314941
Epoch: 47, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.857 Vali Acc: 0.717 Test Loss: 0.857 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 48 cost time: 0.9524056911468506
Epoch: 48, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.848 Vali Acc: 0.733 Test Loss: 0.848 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733325).  Saving model ...
Epoch: 49 cost time: 0.9449594020843506
Epoch: 49, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.835 Vali Acc: 0.711 Test Loss: 0.835 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0322299003601074
Epoch: 50, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.828 Vali Acc: 0.739 Test Loss: 0.828 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 51 cost time: 0.9688935279846191
Epoch: 51, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.828 Vali Acc: 0.728 Test Loss: 0.828 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0108649730682373
Epoch: 52, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.824 Vali Acc: 0.728 Test Loss: 0.824 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0001482963562012
Epoch: 53, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.821 Vali Acc: 0.728 Test Loss: 0.821 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.002624750137329
Epoch: 54, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.812 Vali Acc: 0.722 Test Loss: 0.812 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0121476650238037
Epoch: 55, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.806 Vali Acc: 0.722 Test Loss: 0.806 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.0266036987304688
Epoch: 56, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0095720291137695
Epoch: 57, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.817 Vali Acc: 0.728 Test Loss: 0.817 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9364638328552246
Epoch: 58, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.804 Vali Acc: 0.733 Test Loss: 0.804 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.0217738151550293
Epoch: 59, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.119539737701416
Epoch: 60, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.816 Vali Acc: 0.722 Test Loss: 0.816 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 19775
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4058120250701904
Epoch: 1, Steps: 12 | Train Loss: 2.870 Vali Loss: 2.807 Vali Acc: 0.044 Test Loss: 2.807 Test Acc: 0.044
Validation loss decreased (inf --> -0.044416).  Saving model ...
Epoch: 2 cost time: 0.9610378742218018
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.619 Vali Acc: 0.133 Test Loss: 2.619 Test Acc: 0.133
Validation loss decreased (-0.044416 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 1.0154039859771729
Epoch: 3, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.392 Vali Acc: 0.256 Test Loss: 2.392 Test Acc: 0.256
Validation loss decreased (-0.133307 --> -0.255532).  Saving model ...
Epoch: 4 cost time: 1.026017665863037
Epoch: 4, Steps: 12 | Train Loss: 2.307 Vali Loss: 2.198 Vali Acc: 0.411 Test Loss: 2.198 Test Acc: 0.411
Validation loss decreased (-0.255532 --> -0.411089).  Saving model ...
Epoch: 5 cost time: 0.9867937564849854
Epoch: 5, Steps: 12 | Train Loss: 1.971 Vali Loss: 2.006 Vali Acc: 0.461 Test Loss: 2.006 Test Acc: 0.461
Validation loss decreased (-0.411089 --> -0.461091).  Saving model ...
Epoch: 6 cost time: 0.9758765697479248
Epoch: 6, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.837 Vali Acc: 0.494 Test Loss: 1.837 Test Acc: 0.494
Validation loss decreased (-0.461091 --> -0.494426).  Saving model ...
Epoch: 7 cost time: 1.015432357788086
Epoch: 7, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.685 Vali Acc: 0.522 Test Loss: 1.685 Test Acc: 0.522
Validation loss decreased (-0.494426 --> -0.522205).  Saving model ...
Epoch: 8 cost time: 0.9441790580749512
Epoch: 8, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.586 Vali Acc: 0.556 Test Loss: 1.586 Test Acc: 0.556
Validation loss decreased (-0.522205 --> -0.555540).  Saving model ...
Epoch: 9 cost time: 1.0486421585083008
Epoch: 9, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.486 Vali Acc: 0.567 Test Loss: 1.486 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 0.9488711357116699
Epoch: 10, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.386 Vali Acc: 0.606 Test Loss: 1.386 Test Acc: 0.606
Validation loss decreased (-0.566652 --> -0.605542).  Saving model ...
Epoch: 11 cost time: 0.9878749847412109
Epoch: 11, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.332 Vali Acc: 0.606 Test Loss: 1.332 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 1.0294346809387207
Epoch: 12, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.292 Vali Acc: 0.622 Test Loss: 1.292 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 13 cost time: 0.9956443309783936
Epoch: 13, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.251 Vali Acc: 0.617 Test Loss: 1.251 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9816572666168213
Epoch: 14, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.194 Vali Acc: 0.628 Test Loss: 1.194 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627766).  Saving model ...
Epoch: 15 cost time: 1.0124459266662598
Epoch: 15, Steps: 12 | Train Loss: 0.748 Vali Loss: 1.171 Vali Acc: 0.667 Test Loss: 1.171 Test Acc: 0.667
Validation loss decreased (-0.627766 --> -0.666655).  Saving model ...
Epoch: 16 cost time: 0.8994998931884766
Epoch: 16, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.150 Vali Acc: 0.650 Test Loss: 1.150 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0594124794006348
Epoch: 17, Steps: 12 | Train Loss: 0.623 Vali Loss: 1.094 Vali Acc: 0.672 Test Loss: 1.094 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 18 cost time: 0.9572744369506836
Epoch: 18, Steps: 12 | Train Loss: 0.583 Vali Loss: 1.072 Vali Acc: 0.667 Test Loss: 1.072 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9870278835296631
Epoch: 19, Steps: 12 | Train Loss: 0.520 Vali Loss: 1.045 Vali Acc: 0.661 Test Loss: 1.045 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0779039859771729
Epoch: 20, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.990 Vali Acc: 0.717 Test Loss: 0.990 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716657).  Saving model ...
Epoch: 21 cost time: 1.0431480407714844
Epoch: 21, Steps: 12 | Train Loss: 0.422 Vali Loss: 1.034 Vali Acc: 0.700 Test Loss: 1.034 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9887106418609619
Epoch: 22, Steps: 12 | Train Loss: 0.415 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0007414817810059
Epoch: 23, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.985 Vali Acc: 0.733 Test Loss: 0.985 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733323).  Saving model ...
Epoch: 24 cost time: 0.9856514930725098
Epoch: 24, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.9511902332305908
Epoch: 25, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.982 Vali Acc: 0.750 Test Loss: 0.982 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 26 cost time: 1.0597341060638428
Epoch: 26, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.969 Vali Acc: 0.733 Test Loss: 0.969 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0131144523620605
Epoch: 27, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.957 Vali Acc: 0.756 Test Loss: 0.957 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 28 cost time: 1.0389325618743896
Epoch: 28, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.970 Vali Acc: 0.728 Test Loss: 0.970 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0367703437805176
Epoch: 29, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.977 Vali Acc: 0.728 Test Loss: 0.977 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0284602642059326
Epoch: 30, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.001476764678955
Epoch: 31, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.166316032409668
Epoch: 32, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.002 Vali Acc: 0.744 Test Loss: 1.002 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0238282680511475
Epoch: 33, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.023 Vali Acc: 0.739 Test Loss: 1.023 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0256619453430176
Epoch: 34, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.043 Vali Acc: 0.756 Test Loss: 1.043 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.023829460144043
Epoch: 35, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.037 Vali Acc: 0.750 Test Loss: 1.037 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0205650329589844
Epoch: 36, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.056 Vali Acc: 0.739 Test Loss: 1.056 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0360596179962158
Epoch: 37, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.076 Vali Acc: 0.733 Test Loss: 1.076 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 31519
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3961920738220215
Epoch: 1, Steps: 12 | Train Loss: 2.849 Vali Loss: 2.837 Vali Acc: 0.067 Test Loss: 2.837 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 0.916010856628418
Epoch: 2, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.722 Vali Acc: 0.078 Test Loss: 2.722 Test Acc: 0.078
Validation loss decreased (-0.066638 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 0.9793362617492676
Epoch: 3, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.579 Vali Acc: 0.161 Test Loss: 2.579 Test Acc: 0.161
Validation loss decreased (-0.077751 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 0.9748306274414062
Epoch: 4, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.435 Vali Acc: 0.211 Test Loss: 2.435 Test Acc: 0.211
Validation loss decreased (-0.161085 --> -0.211087).  Saving model ...
Epoch: 5 cost time: 0.9941496849060059
Epoch: 5, Steps: 12 | Train Loss: 2.306 Vali Loss: 2.294 Vali Acc: 0.272 Test Loss: 2.294 Test Acc: 0.272
Validation loss decreased (-0.211087 --> -0.272199).  Saving model ...
Epoch: 6 cost time: 0.8968298435211182
Epoch: 6, Steps: 12 | Train Loss: 2.173 Vali Loss: 2.145 Vali Acc: 0.328 Test Loss: 2.145 Test Acc: 0.328
Validation loss decreased (-0.272199 --> -0.327756).  Saving model ...
Epoch: 7 cost time: 0.9531903266906738
Epoch: 7, Steps: 12 | Train Loss: 1.959 Vali Loss: 2.007 Vali Acc: 0.372 Test Loss: 2.007 Test Acc: 0.372
Validation loss decreased (-0.327756 --> -0.372202).  Saving model ...
Epoch: 8 cost time: 0.8996589183807373
Epoch: 8, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.876 Vali Acc: 0.417 Test Loss: 1.876 Test Acc: 0.417
Validation loss decreased (-0.372202 --> -0.416648).  Saving model ...
Epoch: 9 cost time: 0.9172399044036865
Epoch: 9, Steps: 12 | Train Loss: 1.641 Vali Loss: 1.754 Vali Acc: 0.483 Test Loss: 1.754 Test Acc: 0.483
Validation loss decreased (-0.416648 --> -0.483316).  Saving model ...
Epoch: 10 cost time: 0.9613246917724609
Epoch: 10, Steps: 12 | Train Loss: 1.603 Vali Loss: 1.653 Vali Acc: 0.528 Test Loss: 1.653 Test Acc: 0.528
Validation loss decreased (-0.483316 --> -0.527761).  Saving model ...
Epoch: 11 cost time: 1.0947906970977783
Epoch: 11, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.566 Vali Acc: 0.539 Test Loss: 1.566 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 12 cost time: 1.1078431606292725
Epoch: 12, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.489 Vali Acc: 0.539 Test Loss: 1.489 Test Acc: 0.539
Validation loss decreased (-0.538873 --> -0.538874).  Saving model ...
Epoch: 13 cost time: 1.0849368572235107
Epoch: 13, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.436 Vali Acc: 0.578 Test Loss: 1.436 Test Acc: 0.578
Validation loss decreased (-0.538874 --> -0.577763).  Saving model ...
Epoch: 14 cost time: 1.0872015953063965
Epoch: 14, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.393 Vali Acc: 0.583 Test Loss: 1.393 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 15 cost time: 1.1030447483062744
Epoch: 15, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.343 Vali Acc: 0.583 Test Loss: 1.343 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583320).  Saving model ...
Epoch: 16 cost time: 1.0753185749053955
Epoch: 16, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.293 Vali Acc: 0.617 Test Loss: 1.293 Test Acc: 0.617
Validation loss decreased (-0.583320 --> -0.616654).  Saving model ...
Epoch: 17 cost time: 1.1674587726593018
Epoch: 17, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.256 Vali Acc: 0.633 Test Loss: 1.256 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 18 cost time: 1.0378856658935547
Epoch: 18, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.219 Vali Acc: 0.656 Test Loss: 1.219 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655543).  Saving model ...
Epoch: 19 cost time: 1.1163721084594727
Epoch: 19, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.191 Vali Acc: 0.644 Test Loss: 1.191 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2725574970245361
Epoch: 20, Steps: 12 | Train Loss: 0.702 Vali Loss: 1.165 Vali Acc: 0.633 Test Loss: 1.165 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1203196048736572
Epoch: 21, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.135 Vali Acc: 0.644 Test Loss: 1.135 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1878564357757568
Epoch: 22, Steps: 12 | Train Loss: 0.593 Vali Loss: 1.097 Vali Acc: 0.672 Test Loss: 1.097 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672211).  Saving model ...
Epoch: 23 cost time: 1.0890402793884277
Epoch: 23, Steps: 12 | Train Loss: 0.576 Vali Loss: 1.093 Vali Acc: 0.667 Test Loss: 1.093 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1065123081207275
Epoch: 24, Steps: 12 | Train Loss: 0.525 Vali Loss: 1.074 Vali Acc: 0.661 Test Loss: 1.074 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1520581245422363
Epoch: 25, Steps: 12 | Train Loss: 0.535 Vali Loss: 1.044 Vali Acc: 0.667 Test Loss: 1.044 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1236190795898438
Epoch: 26, Steps: 12 | Train Loss: 0.466 Vali Loss: 1.014 Vali Acc: 0.694 Test Loss: 1.014 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 27 cost time: 1.094513177871704
Epoch: 27, Steps: 12 | Train Loss: 0.415 Vali Loss: 1.007 Vali Acc: 0.689 Test Loss: 1.007 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0094997882843018
Epoch: 28, Steps: 12 | Train Loss: 0.428 Vali Loss: 1.002 Vali Acc: 0.683 Test Loss: 1.002 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2021148204803467
Epoch: 29, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.978 Vali Acc: 0.711 Test Loss: 0.978 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 30 cost time: 1.2696189880371094
Epoch: 30, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.980 Vali Acc: 0.706 Test Loss: 0.980 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.202847957611084
Epoch: 31, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.972 Vali Acc: 0.694 Test Loss: 0.972 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2158215045928955
Epoch: 32, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.970 Vali Acc: 0.706 Test Loss: 0.970 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2180757522583008
Epoch: 33, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.969 Vali Acc: 0.711 Test Loss: 0.969 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 34 cost time: 1.1977674961090088
Epoch: 34, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.973 Vali Acc: 0.711 Test Loss: 0.973 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.345712661743164
Epoch: 35, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.975 Vali Acc: 0.694 Test Loss: 0.975 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.251328706741333
Epoch: 36, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.987 Vali Acc: 0.711 Test Loss: 0.987 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.115692377090454
Epoch: 37, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.976 Vali Acc: 0.717 Test Loss: 0.976 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 38 cost time: 1.2571394443511963
Epoch: 38, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.970 Vali Acc: 0.728 Test Loss: 0.970 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 39 cost time: 1.1256558895111084
Epoch: 39, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.989 Vali Acc: 0.711 Test Loss: 0.989 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2833192348480225
Epoch: 40, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.010 Vali Acc: 0.722 Test Loss: 1.010 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1414473056793213
Epoch: 41, Steps: 12 | Train Loss: 0.191 Vali Loss: 1.022 Vali Acc: 0.722 Test Loss: 1.022 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2221810817718506
Epoch: 42, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.004 Vali Acc: 0.728 Test Loss: 1.004 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2692947387695312
Epoch: 43, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.000 Vali Acc: 0.717 Test Loss: 1.000 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.176344394683838
Epoch: 44, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.000 Vali Acc: 0.728 Test Loss: 1.000 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9883124828338623
Epoch: 45, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.991 Vali Acc: 0.722 Test Loss: 0.991 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1953306198120117
Epoch: 46, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.995 Vali Acc: 0.744 Test Loss: 0.995 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744434).  Saving model ...
Epoch: 47 cost time: 1.1005661487579346
Epoch: 47, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.013 Vali Acc: 0.733 Test Loss: 1.013 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2117118835449219
Epoch: 48, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.053 Vali Acc: 0.739 Test Loss: 1.053 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1217539310455322
Epoch: 49, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.072 Vali Acc: 0.728 Test Loss: 1.072 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0716156959533691
Epoch: 50, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.043 Vali Acc: 0.739 Test Loss: 1.043 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.138920545578003
Epoch: 51, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.029 Vali Acc: 0.722 Test Loss: 1.029 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0273661613464355
Epoch: 52, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.061 Vali Acc: 0.722 Test Loss: 1.061 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.1000666618347168
Epoch: 53, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.075 Vali Acc: 0.728 Test Loss: 1.075 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.1210918426513672
Epoch: 54, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.074 Vali Acc: 0.739 Test Loss: 1.074 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.169945240020752
Epoch: 55, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.071 Vali Acc: 0.733 Test Loss: 1.071 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.223426342010498
Epoch: 56, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.058 Vali Acc: 0.750 Test Loss: 1.058 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749989).  Saving model ...
Epoch: 57 cost time: 1.1793200969696045
Epoch: 57, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.068 Vali Acc: 0.739 Test Loss: 1.068 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1545379161834717
Epoch: 58, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.068 Vali Acc: 0.756 Test Loss: 1.068 Test Acc: 0.756
Validation loss decreased (-0.749989 --> -0.755545).  Saving model ...
Epoch: 59 cost time: 1.1195261478424072
Epoch: 59, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.084 Vali Acc: 0.739 Test Loss: 1.084 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2334012985229492
Epoch: 60, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.082 Vali Acc: 0.756 Test Loss: 1.082 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.2068734169006348
Epoch: 61, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.099 Vali Acc: 0.744 Test Loss: 1.099 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.957390546798706
Epoch: 62, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.104 Vali Acc: 0.739 Test Loss: 1.104 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0895357131958008
Epoch: 63, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.093 Vali Acc: 0.756 Test Loss: 1.093 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9111320972442627
Epoch: 64, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.092 Vali Acc: 0.744 Test Loss: 1.092 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.17457914352417
Epoch: 65, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.088 Vali Acc: 0.761 Test Loss: 1.088 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761100).  Saving model ...
Epoch: 66 cost time: 1.1266071796417236
Epoch: 66, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.133 Vali Acc: 0.739 Test Loss: 1.133 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.207789659500122
Epoch: 67, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.148 Vali Acc: 0.739 Test Loss: 1.148 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9937188625335693
Epoch: 68, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.150 Vali Acc: 0.744 Test Loss: 1.150 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.074157476425171
Epoch: 69, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.148 Vali Acc: 0.744 Test Loss: 1.148 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.0263640880584717
Epoch: 70, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.149 Vali Acc: 0.733 Test Loss: 1.149 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.051194429397583
Epoch: 71, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.171 Vali Acc: 0.733 Test Loss: 1.171 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.139974594116211
Epoch: 72, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.189 Vali Acc: 0.733 Test Loss: 1.189 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.1478586196899414
Epoch: 73, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.178 Vali Acc: 0.733 Test Loss: 1.178 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.1350815296173096
Epoch: 74, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.173 Vali Acc: 0.739 Test Loss: 1.173 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.1924877166748047
Epoch: 75, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.183 Vali Acc: 0.739 Test Loss: 1.183 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 20975
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.74416184425354
Epoch: 1, Steps: 12 | Train Loss: 2.948 Vali Loss: 2.741 Vali Acc: 0.089 Test Loss: 2.741 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 1.1044564247131348
Epoch: 2, Steps: 12 | Train Loss: 2.847 Vali Loss: 2.640 Vali Acc: 0.111 Test Loss: 2.640 Test Acc: 0.111
Validation loss decreased (-0.088861 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 1.0207114219665527
Epoch: 3, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.506 Vali Acc: 0.178 Test Loss: 2.506 Test Acc: 0.178
Validation loss decreased (-0.111085 --> -0.177753).  Saving model ...
Epoch: 4 cost time: 1.0351755619049072
Epoch: 4, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.362 Vali Acc: 0.283 Test Loss: 2.362 Test Acc: 0.283
Validation loss decreased (-0.177753 --> -0.283310).  Saving model ...
Epoch: 5 cost time: 0.8979284763336182
Epoch: 5, Steps: 12 | Train Loss: 2.425 Vali Loss: 2.221 Vali Acc: 0.361 Test Loss: 2.221 Test Acc: 0.361
Validation loss decreased (-0.283310 --> -0.361089).  Saving model ...
Epoch: 6 cost time: 1.1782598495483398
Epoch: 6, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.078 Vali Acc: 0.472 Test Loss: 2.078 Test Acc: 0.472
Validation loss decreased (-0.361089 --> -0.472201).  Saving model ...
Epoch: 7 cost time: 1.0400505065917969
Epoch: 7, Steps: 12 | Train Loss: 2.000 Vali Loss: 1.952 Vali Acc: 0.506 Test Loss: 1.952 Test Acc: 0.506
Validation loss decreased (-0.472201 --> -0.505536).  Saving model ...
Epoch: 8 cost time: 1.005918264389038
Epoch: 8, Steps: 12 | Train Loss: 1.909 Vali Loss: 1.843 Vali Acc: 0.506 Test Loss: 1.843 Test Acc: 0.506
Validation loss decreased (-0.505536 --> -0.505537).  Saving model ...
Epoch: 9 cost time: 1.1890733242034912
Epoch: 9, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.747 Vali Acc: 0.533 Test Loss: 1.747 Test Acc: 0.533
Validation loss decreased (-0.505537 --> -0.533316).  Saving model ...
Epoch: 10 cost time: 1.153923749923706
Epoch: 10, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.651 Vali Acc: 0.556 Test Loss: 1.651 Test Acc: 0.556
Validation loss decreased (-0.533316 --> -0.555539).  Saving model ...
Epoch: 11 cost time: 1.042736530303955
Epoch: 11, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.585 Vali Acc: 0.561 Test Loss: 1.585 Test Acc: 0.561
Validation loss decreased (-0.555539 --> -0.561095).  Saving model ...
Epoch: 12 cost time: 1.0639212131500244
Epoch: 12, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.506 Vali Acc: 0.600 Test Loss: 1.506 Test Acc: 0.600
Validation loss decreased (-0.561095 --> -0.599985).  Saving model ...
Epoch: 13 cost time: 1.088008165359497
Epoch: 13, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.456 Vali Acc: 0.594 Test Loss: 1.456 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1421616077423096
Epoch: 14, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.407 Vali Acc: 0.606 Test Loss: 1.407 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605541).  Saving model ...
Epoch: 15 cost time: 1.1499450206756592
Epoch: 15, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.365 Vali Acc: 0.606 Test Loss: 1.365 Test Acc: 0.606
Validation loss decreased (-0.605541 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 0.9840347766876221
Epoch: 16, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.333 Vali Acc: 0.617 Test Loss: 1.333 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616653).  Saving model ...
Epoch: 17 cost time: 1.0016045570373535
Epoch: 17, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.304 Vali Acc: 0.633 Test Loss: 1.304 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633320).  Saving model ...
Epoch: 18 cost time: 1.0028493404388428
Epoch: 18, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.264 Vali Acc: 0.650 Test Loss: 1.264 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649987).  Saving model ...
Epoch: 19 cost time: 1.1374821662902832
Epoch: 19, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.231 Vali Acc: 0.656 Test Loss: 1.231 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655543).  Saving model ...
Epoch: 20 cost time: 1.009969711303711
Epoch: 20, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.187 Vali Acc: 0.644 Test Loss: 1.187 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9540746212005615
Epoch: 21, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.166 Vali Acc: 0.650 Test Loss: 1.166 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0239388942718506
Epoch: 22, Steps: 12 | Train Loss: 0.715 Vali Loss: 1.141 Vali Acc: 0.661 Test Loss: 1.141 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661100).  Saving model ...
Epoch: 23 cost time: 1.0640738010406494
Epoch: 23, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.108 Vali Acc: 0.683 Test Loss: 1.108 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683322).  Saving model ...
Epoch: 24 cost time: 1.0678954124450684
Epoch: 24, Steps: 12 | Train Loss: 0.627 Vali Loss: 1.108 Vali Acc: 0.678 Test Loss: 1.108 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.109316110610962
Epoch: 25, Steps: 12 | Train Loss: 0.598 Vali Loss: 1.077 Vali Acc: 0.689 Test Loss: 1.077 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 26 cost time: 1.0143709182739258
Epoch: 26, Steps: 12 | Train Loss: 0.542 Vali Loss: 1.030 Vali Acc: 0.694 Test Loss: 1.030 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 27 cost time: 1.0257236957550049
Epoch: 27, Steps: 12 | Train Loss: 0.491 Vali Loss: 1.023 Vali Acc: 0.706 Test Loss: 1.023 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 28 cost time: 1.0019936561584473
Epoch: 28, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.999 Vali Acc: 0.717 Test Loss: 0.999 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 29 cost time: 1.045210838317871
Epoch: 29, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 30 cost time: 1.0458416938781738
Epoch: 30, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.972 Vali Acc: 0.722 Test Loss: 0.972 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722212).  Saving model ...
Epoch: 31 cost time: 1.0757408142089844
Epoch: 31, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.956 Vali Acc: 0.706 Test Loss: 0.956 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0592153072357178
Epoch: 32, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749991).  Saving model ...
Epoch: 33 cost time: 0.9738824367523193
Epoch: 33, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.924 Vali Acc: 0.750 Test Loss: 0.924 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 34 cost time: 0.9542052745819092
Epoch: 34, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.928 Vali Acc: 0.744 Test Loss: 0.928 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0275144577026367
Epoch: 35, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 1.0458762645721436
Epoch: 36, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 37 cost time: 1.0127067565917969
Epoch: 37, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.911 Vali Acc: 0.733 Test Loss: 0.911 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.05525541305542
Epoch: 38, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.932 Vali Acc: 0.733 Test Loss: 0.932 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.912297248840332
Epoch: 39, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.937 Vali Acc: 0.739 Test Loss: 0.937 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.210353136062622
Epoch: 40, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.919 Vali Acc: 0.739 Test Loss: 0.919 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0377919673919678
Epoch: 41, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0649402141571045
Epoch: 42, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1128671169281006
Epoch: 43, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1215486526489258
Epoch: 44, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.099687099456787
Epoch: 45, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.937 Vali Acc: 0.733 Test Loss: 0.937 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0260024070739746
Epoch: 46, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.955 Vali Acc: 0.739 Test Loss: 0.955 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 20511
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3800463676452637
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.795 Vali Acc: 0.117 Test Loss: 2.795 Test Acc: 0.117
Validation loss decreased (inf --> -0.116639).  Saving model ...
Epoch: 2 cost time: 1.0431432723999023
Epoch: 2, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.721 Vali Acc: 0.150 Test Loss: 2.721 Test Acc: 0.150
Validation loss decreased (-0.116639 --> -0.149973).  Saving model ...
Epoch: 3 cost time: 1.0937409400939941
Epoch: 3, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.616 Vali Acc: 0.167 Test Loss: 2.616 Test Acc: 0.167
Validation loss decreased (-0.149973 --> -0.166641).  Saving model ...
Epoch: 4 cost time: 1.0564045906066895
Epoch: 4, Steps: 12 | Train Loss: 2.494 Vali Loss: 2.490 Vali Acc: 0.217 Test Loss: 2.490 Test Acc: 0.217
Validation loss decreased (-0.166641 --> -0.216642).  Saving model ...
Epoch: 5 cost time: 1.0612976551055908
Epoch: 5, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.360 Vali Acc: 0.267 Test Loss: 2.360 Test Acc: 0.267
Validation loss decreased (-0.216642 --> -0.266643).  Saving model ...
Epoch: 6 cost time: 1.0734291076660156
Epoch: 6, Steps: 12 | Train Loss: 2.174 Vali Loss: 2.232 Vali Acc: 0.322 Test Loss: 2.232 Test Acc: 0.322
Validation loss decreased (-0.266643 --> -0.322200).  Saving model ...
Epoch: 7 cost time: 1.146113395690918
Epoch: 7, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.114 Vali Acc: 0.383 Test Loss: 2.114 Test Acc: 0.383
Validation loss decreased (-0.322200 --> -0.383312).  Saving model ...
Epoch: 8 cost time: 1.0469434261322021
Epoch: 8, Steps: 12 | Train Loss: 1.964 Vali Loss: 1.997 Vali Acc: 0.439 Test Loss: 1.997 Test Acc: 0.439
Validation loss decreased (-0.383312 --> -0.438869).  Saving model ...
Epoch: 9 cost time: 0.9899635314941406
Epoch: 9, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.897 Vali Acc: 0.494 Test Loss: 1.897 Test Acc: 0.494
Validation loss decreased (-0.438869 --> -0.494425).  Saving model ...
Epoch: 10 cost time: 0.9819228649139404
Epoch: 10, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.801 Vali Acc: 0.533 Test Loss: 1.801 Test Acc: 0.533
Validation loss decreased (-0.494425 --> -0.533315).  Saving model ...
Epoch: 11 cost time: 1.063798189163208
Epoch: 11, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.727 Vali Acc: 0.522 Test Loss: 1.727 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9957382678985596
Epoch: 12, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.653 Vali Acc: 0.539 Test Loss: 1.653 Test Acc: 0.539
Validation loss decreased (-0.533315 --> -0.538872).  Saving model ...
Epoch: 13 cost time: 1.123896837234497
Epoch: 13, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.599 Vali Acc: 0.556 Test Loss: 1.599 Test Acc: 0.556
Validation loss decreased (-0.538872 --> -0.555540).  Saving model ...
Epoch: 14 cost time: 1.1087548732757568
Epoch: 14, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.546 Vali Acc: 0.561 Test Loss: 1.546 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561096).  Saving model ...
Epoch: 15 cost time: 0.9933798313140869
Epoch: 15, Steps: 12 | Train Loss: 1.258 Vali Loss: 1.503 Vali Acc: 0.567 Test Loss: 1.503 Test Acc: 0.567
Validation loss decreased (-0.561096 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 0.9709568023681641
Epoch: 16, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.461 Vali Acc: 0.572 Test Loss: 1.461 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 17 cost time: 0.9801673889160156
Epoch: 17, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.428 Vali Acc: 0.583 Test Loss: 1.428 Test Acc: 0.583
Validation loss decreased (-0.572208 --> -0.583319).  Saving model ...
Epoch: 18 cost time: 1.0136423110961914
Epoch: 18, Steps: 12 | Train Loss: 1.103 Vali Loss: 1.393 Vali Acc: 0.600 Test Loss: 1.393 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 1.1413049697875977
Epoch: 19, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.364 Vali Acc: 0.589 Test Loss: 1.364 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9912161827087402
Epoch: 20, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.324 Vali Acc: 0.617 Test Loss: 1.324 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616653).  Saving model ...
Epoch: 21 cost time: 1.0281331539154053
Epoch: 21, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.298 Vali Acc: 0.617 Test Loss: 1.298 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 22 cost time: 1.1052744388580322
Epoch: 22, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.276 Vali Acc: 0.639 Test Loss: 1.276 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638876).  Saving model ...
Epoch: 23 cost time: 1.0573840141296387
Epoch: 23, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.266 Vali Acc: 0.656 Test Loss: 1.266 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655543).  Saving model ...
Epoch: 24 cost time: 1.162649154663086
Epoch: 24, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.239 Vali Acc: 0.656 Test Loss: 1.239 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 25 cost time: 1.2621486186981201
Epoch: 25, Steps: 12 | Train Loss: 0.775 Vali Loss: 1.229 Vali Acc: 0.656 Test Loss: 1.229 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 26 cost time: 1.195582389831543
Epoch: 26, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.202 Vali Acc: 0.661 Test Loss: 1.202 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 27 cost time: 1.0877165794372559
Epoch: 27, Steps: 12 | Train Loss: 0.726 Vali Loss: 1.187 Vali Acc: 0.672 Test Loss: 1.187 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672210).  Saving model ...
Epoch: 28 cost time: 1.0589663982391357
Epoch: 28, Steps: 12 | Train Loss: 0.646 Vali Loss: 1.160 Vali Acc: 0.667 Test Loss: 1.160 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0874745845794678
Epoch: 29, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.146 Vali Acc: 0.683 Test Loss: 1.146 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 30 cost time: 1.127936601638794
Epoch: 30, Steps: 12 | Train Loss: 0.624 Vali Loss: 1.130 Vali Acc: 0.689 Test Loss: 1.130 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 31 cost time: 1.066004991531372
Epoch: 31, Steps: 12 | Train Loss: 0.610 Vali Loss: 1.113 Vali Acc: 0.694 Test Loss: 1.113 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694433).  Saving model ...
Epoch: 32 cost time: 1.0806913375854492
Epoch: 32, Steps: 12 | Train Loss: 0.546 Vali Loss: 1.090 Vali Acc: 0.694 Test Loss: 1.090 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694434).  Saving model ...
Epoch: 33 cost time: 1.1076231002807617
Epoch: 33, Steps: 12 | Train Loss: 0.504 Vali Loss: 1.072 Vali Acc: 0.711 Test Loss: 1.072 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711100).  Saving model ...
Epoch: 34 cost time: 1.105294942855835
Epoch: 34, Steps: 12 | Train Loss: 0.486 Vali Loss: 1.061 Vali Acc: 0.711 Test Loss: 1.061 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711100).  Saving model ...
Epoch: 35 cost time: 1.0016562938690186
Epoch: 35, Steps: 12 | Train Loss: 0.497 Vali Loss: 1.036 Vali Acc: 0.706 Test Loss: 1.036 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1595485210418701
Epoch: 36, Steps: 12 | Train Loss: 0.461 Vali Loss: 1.019 Vali Acc: 0.717 Test Loss: 1.019 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716656).  Saving model ...
Epoch: 37 cost time: 1.1815412044525146
Epoch: 37, Steps: 12 | Train Loss: 0.424 Vali Loss: 1.011 Vali Acc: 0.722 Test Loss: 1.011 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722212).  Saving model ...
Epoch: 38 cost time: 1.1297481060028076
Epoch: 38, Steps: 12 | Train Loss: 0.398 Vali Loss: 1.012 Vali Acc: 0.717 Test Loss: 1.012 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.070169448852539
Epoch: 39, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 40 cost time: 1.1210994720458984
Epoch: 40, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.990 Vali Acc: 0.739 Test Loss: 0.990 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 41 cost time: 1.2198755741119385
Epoch: 41, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.979 Vali Acc: 0.750 Test Loss: 0.979 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749990).  Saving model ...
Epoch: 42 cost time: 1.1949646472930908
Epoch: 42, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.968 Vali Acc: 0.761 Test Loss: 0.968 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 43 cost time: 1.1702296733856201
Epoch: 43, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.970 Vali Acc: 0.739 Test Loss: 0.970 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1424627304077148
Epoch: 44, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.979 Vali Acc: 0.722 Test Loss: 0.979 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.114201307296753
Epoch: 45, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.107729196548462
Epoch: 46, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1177561283111572
Epoch: 47, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.979 Vali Acc: 0.722 Test Loss: 0.979 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9752509593963623
Epoch: 48, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.967 Vali Acc: 0.739 Test Loss: 0.967 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.2190515995025635
Epoch: 49, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.967 Vali Acc: 0.761 Test Loss: 0.967 Test Acc: 0.761
Validation loss decreased (-0.761101 --> -0.761101).  Saving model ...
Epoch: 50 cost time: 1.1195285320281982
Epoch: 50, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.961 Vali Acc: 0.750 Test Loss: 0.961 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1746890544891357
Epoch: 51, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1216135025024414
Epoch: 52, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1550912857055664
Epoch: 53, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.984 Vali Acc: 0.756 Test Loss: 0.984 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.1164803504943848
Epoch: 54, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.981 Vali Acc: 0.722 Test Loss: 0.981 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1900079250335693
Epoch: 55, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0736103057861328
Epoch: 56, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.958 Vali Acc: 0.744 Test Loss: 0.958 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.1783397197723389
Epoch: 57, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.985 Vali Acc: 0.728 Test Loss: 0.985 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.087740421295166
Epoch: 58, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.980 Vali Acc: 0.744 Test Loss: 0.980 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.1323494911193848
Epoch: 59, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 17167
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7454144954681396
Epoch: 1, Steps: 12 | Train Loss: 2.896 Vali Loss: 2.803 Vali Acc: 0.078 Test Loss: 2.803 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 1.1936531066894531
Epoch: 2, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.765 Vali Acc: 0.106 Test Loss: 2.765 Test Acc: 0.106
Validation loss decreased (-0.077750 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 1.1319212913513184
Epoch: 3, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.695 Vali Acc: 0.133 Test Loss: 2.695 Test Acc: 0.133
Validation loss decreased (-0.105528 --> -0.133306).  Saving model ...
Epoch: 4 cost time: 1.1359295845031738
Epoch: 4, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.612 Vali Acc: 0.183 Test Loss: 2.612 Test Acc: 0.183
Validation loss decreased (-0.133306 --> -0.183307).  Saving model ...
Epoch: 5 cost time: 1.1701993942260742
Epoch: 5, Steps: 12 | Train Loss: 2.569 Vali Loss: 2.517 Vali Acc: 0.222 Test Loss: 2.517 Test Acc: 0.222
Validation loss decreased (-0.183307 --> -0.222197).  Saving model ...
Epoch: 6 cost time: 1.237884283065796
Epoch: 6, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.419 Vali Acc: 0.283 Test Loss: 2.419 Test Acc: 0.283
Validation loss decreased (-0.222197 --> -0.283309).  Saving model ...
Epoch: 7 cost time: 1.1227247714996338
Epoch: 7, Steps: 12 | Train Loss: 2.415 Vali Loss: 2.316 Vali Acc: 0.300 Test Loss: 2.316 Test Acc: 0.300
Validation loss decreased (-0.283309 --> -0.299977).  Saving model ...
Epoch: 8 cost time: 1.2721130847930908
Epoch: 8, Steps: 12 | Train Loss: 2.268 Vali Loss: 2.215 Vali Acc: 0.394 Test Loss: 2.215 Test Acc: 0.394
Validation loss decreased (-0.299977 --> -0.394422).  Saving model ...
Epoch: 9 cost time: 1.0672366619110107
Epoch: 9, Steps: 12 | Train Loss: 2.102 Vali Loss: 2.111 Vali Acc: 0.400 Test Loss: 2.111 Test Acc: 0.400
Validation loss decreased (-0.394422 --> -0.399979).  Saving model ...
Epoch: 10 cost time: 1.0933332443237305
Epoch: 10, Steps: 12 | Train Loss: 2.032 Vali Loss: 2.017 Vali Acc: 0.456 Test Loss: 2.017 Test Acc: 0.456
Validation loss decreased (-0.399979 --> -0.455535).  Saving model ...
Epoch: 11 cost time: 1.144477128982544
Epoch: 11, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.924 Vali Acc: 0.494 Test Loss: 1.924 Test Acc: 0.494
Validation loss decreased (-0.455535 --> -0.494425).  Saving model ...
Epoch: 12 cost time: 1.0414526462554932
Epoch: 12, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.833 Vali Acc: 0.528 Test Loss: 1.833 Test Acc: 0.528
Validation loss decreased (-0.494425 --> -0.527759).  Saving model ...
Epoch: 13 cost time: 1.056497573852539
Epoch: 13, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.747 Vali Acc: 0.539 Test Loss: 1.747 Test Acc: 0.539
Validation loss decreased (-0.527759 --> -0.538871).  Saving model ...
Epoch: 14 cost time: 1.1538665294647217
Epoch: 14, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.674 Vali Acc: 0.567 Test Loss: 1.674 Test Acc: 0.567
Validation loss decreased (-0.538871 --> -0.566650).  Saving model ...
Epoch: 15 cost time: 1.0958709716796875
Epoch: 15, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.619 Vali Acc: 0.561 Test Loss: 1.619 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9631164073944092
Epoch: 16, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.557 Vali Acc: 0.583 Test Loss: 1.557 Test Acc: 0.583
Validation loss decreased (-0.566650 --> -0.583318).  Saving model ...
Epoch: 17 cost time: 1.0936646461486816
Epoch: 17, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.501 Vali Acc: 0.594 Test Loss: 1.501 Test Acc: 0.594
Validation loss decreased (-0.583318 --> -0.594429).  Saving model ...
Epoch: 18 cost time: 1.1702508926391602
Epoch: 18, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.452 Vali Acc: 0.600 Test Loss: 1.452 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599985).  Saving model ...
Epoch: 19 cost time: 1.1227307319641113
Epoch: 19, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.405 Vali Acc: 0.611 Test Loss: 1.405 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 20 cost time: 1.068312168121338
Epoch: 20, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.373 Vali Acc: 0.622 Test Loss: 1.373 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622208).  Saving model ...
Epoch: 21 cost time: 1.13560152053833
Epoch: 21, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.332 Vali Acc: 0.617 Test Loss: 1.332 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1346542835235596
Epoch: 22, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.296 Vali Acc: 0.628 Test Loss: 1.296 Test Acc: 0.628
Validation loss decreased (-0.622208 --> -0.627765).  Saving model ...
Epoch: 23 cost time: 1.1300134658813477
Epoch: 23, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.260 Vali Acc: 0.644 Test Loss: 1.260 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644432).  Saving model ...
Epoch: 24 cost time: 1.1889865398406982
Epoch: 24, Steps: 12 | Train Loss: 0.901 Vali Loss: 1.232 Vali Acc: 0.644 Test Loss: 1.232 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 25 cost time: 1.186347246170044
Epoch: 25, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.206 Vali Acc: 0.661 Test Loss: 1.206 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 26 cost time: 1.1214792728424072
Epoch: 26, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.198 Vali Acc: 0.656 Test Loss: 1.198 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0654528141021729
Epoch: 27, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.164 Vali Acc: 0.656 Test Loss: 1.164 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0522606372833252
Epoch: 28, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.134 Vali Acc: 0.661 Test Loss: 1.134 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661100).  Saving model ...
Epoch: 29 cost time: 1.0789036750793457
Epoch: 29, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0222387313842773
Epoch: 30, Steps: 12 | Train Loss: 0.715 Vali Loss: 1.090 Vali Acc: 0.678 Test Loss: 1.090 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 31 cost time: 0.9258534908294678
Epoch: 31, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.067 Vali Acc: 0.683 Test Loss: 1.067 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 32 cost time: 1.1531929969787598
Epoch: 32, Steps: 12 | Train Loss: 0.636 Vali Loss: 1.049 Vali Acc: 0.683 Test Loss: 1.049 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 33 cost time: 1.152510643005371
Epoch: 33, Steps: 12 | Train Loss: 0.623 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0668342113494873
Epoch: 34, Steps: 12 | Train Loss: 0.580 Vali Loss: 1.034 Vali Acc: 0.694 Test Loss: 1.034 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694434).  Saving model ...
Epoch: 35 cost time: 1.0530037879943848
Epoch: 35, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.998 Vali Acc: 0.694 Test Loss: 0.998 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 36 cost time: 1.1779248714447021
Epoch: 36, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.981 Vali Acc: 0.689 Test Loss: 0.981 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0861568450927734
Epoch: 37, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.962 Vali Acc: 0.694 Test Loss: 0.962 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 38 cost time: 1.0577096939086914
Epoch: 38, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.948 Vali Acc: 0.694 Test Loss: 0.948 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 39 cost time: 1.1580393314361572
Epoch: 39, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.946 Vali Acc: 0.694 Test Loss: 0.946 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 40 cost time: 1.129357099533081
Epoch: 40, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.919 Vali Acc: 0.717 Test Loss: 0.919 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716657).  Saving model ...
Epoch: 41 cost time: 1.1093618869781494
Epoch: 41, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.904 Vali Acc: 0.728 Test Loss: 0.904 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 42 cost time: 1.1191840171813965
Epoch: 42, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.897 Vali Acc: 0.733 Test Loss: 0.897 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733324).  Saving model ...
Epoch: 43 cost time: 1.1303441524505615
Epoch: 43, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.901 Vali Acc: 0.728 Test Loss: 0.901 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2136991024017334
Epoch: 44, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.900 Vali Acc: 0.733 Test Loss: 0.900 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0992953777313232
Epoch: 45, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.885 Vali Acc: 0.728 Test Loss: 0.885 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0544373989105225
Epoch: 46, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.868 Vali Acc: 0.739 Test Loss: 0.868 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 47 cost time: 1.0824732780456543
Epoch: 47, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.867 Vali Acc: 0.739 Test Loss: 0.867 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 48 cost time: 1.1092584133148193
Epoch: 48, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.871 Vali Acc: 0.744 Test Loss: 0.871 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 49 cost time: 1.1106650829315186
Epoch: 49, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.864 Vali Acc: 0.756 Test Loss: 0.864 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 50 cost time: 1.072352647781372
Epoch: 50, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.846 Vali Acc: 0.761 Test Loss: 0.846 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 51 cost time: 1.071639060974121
Epoch: 51, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.846 Vali Acc: 0.756 Test Loss: 0.846 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1206307411193848
Epoch: 52, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0758559703826904
Epoch: 53, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.854 Vali Acc: 0.756 Test Loss: 0.854 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.055206060409546
Epoch: 54, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.852 Vali Acc: 0.739 Test Loss: 0.852 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1847667694091797
Epoch: 55, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.835 Vali Acc: 0.761 Test Loss: 0.835 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 56 cost time: 1.1516473293304443
Epoch: 56, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 57 cost time: 1.1036927700042725
Epoch: 57, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.819 Vali Acc: 0.761 Test Loss: 0.819 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 58 cost time: 1.1691110134124756
Epoch: 58, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1642382144927979
Epoch: 59, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 60 cost time: 1.1589617729187012
Epoch: 60, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.833 Vali Acc: 0.761 Test Loss: 0.833 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1330490112304688
Epoch: 61, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.834 Vali Acc: 0.761 Test Loss: 0.834 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.104623556137085
Epoch: 62, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.856 Vali Acc: 0.761 Test Loss: 0.856 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1383395195007324
Epoch: 63, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.842 Vali Acc: 0.761 Test Loss: 0.842 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.1661622524261475
Epoch: 64, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.810 Vali Acc: 0.761 Test Loss: 0.810 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.1172592639923096
Epoch: 65, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.802 Vali Acc: 0.772 Test Loss: 0.802 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 66 cost time: 1.1247923374176025
Epoch: 66, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.811 Vali Acc: 0.772 Test Loss: 0.811 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0935356616973877
Epoch: 67, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.817 Vali Acc: 0.761 Test Loss: 0.817 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0951879024505615
Epoch: 68, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.836 Vali Acc: 0.767 Test Loss: 0.836 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1430354118347168
Epoch: 69, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.838 Vali Acc: 0.767 Test Loss: 0.838 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.149249792098999
Epoch: 70, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.841 Vali Acc: 0.772 Test Loss: 0.841 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.1043405532836914
Epoch: 71, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.847 Vali Acc: 0.772 Test Loss: 0.847 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0643703937530518
Epoch: 72, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.844 Vali Acc: 0.772 Test Loss: 0.844 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.1386797428131104
Epoch: 73, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.857 Vali Acc: 0.767 Test Loss: 0.857 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.151710033416748
Epoch: 74, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.855 Vali Acc: 0.767 Test Loss: 0.855 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.2011914253234863
Epoch: 75, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.851 Vali Acc: 0.772 Test Loss: 0.851 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 15279
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5731406211853027
Epoch: 1, Steps: 12 | Train Loss: 2.867 Vali Loss: 2.843 Vali Acc: 0.033 Test Loss: 2.843 Test Acc: 0.033
Validation loss decreased (inf --> -0.033305).  Saving model ...
Epoch: 2 cost time: 1.1334853172302246
Epoch: 2, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.807 Vali Acc: 0.078 Test Loss: 2.807 Test Acc: 0.078
Validation loss decreased (-0.033305 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 1.020439863204956
Epoch: 3, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.753 Vali Acc: 0.111 Test Loss: 2.753 Test Acc: 0.111
Validation loss decreased (-0.077750 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.0516185760498047
Epoch: 4, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.682 Vali Acc: 0.122 Test Loss: 2.682 Test Acc: 0.122
Validation loss decreased (-0.111084 --> -0.122195).  Saving model ...
Epoch: 5 cost time: 1.1068496704101562
Epoch: 5, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.602 Vali Acc: 0.150 Test Loss: 2.602 Test Acc: 0.150
Validation loss decreased (-0.122195 --> -0.149974).  Saving model ...
Epoch: 6 cost time: 1.071629285812378
Epoch: 6, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.514 Vali Acc: 0.189 Test Loss: 2.514 Test Acc: 0.189
Validation loss decreased (-0.149974 --> -0.188864).  Saving model ...
Epoch: 7 cost time: 1.1338844299316406
Epoch: 7, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.428 Vali Acc: 0.239 Test Loss: 2.428 Test Acc: 0.239
Validation loss decreased (-0.188864 --> -0.238865).  Saving model ...
Epoch: 8 cost time: 1.1287505626678467
Epoch: 8, Steps: 12 | Train Loss: 2.390 Vali Loss: 2.339 Vali Acc: 0.289 Test Loss: 2.339 Test Acc: 0.289
Validation loss decreased (-0.238865 --> -0.288866).  Saving model ...
Epoch: 9 cost time: 1.0250587463378906
Epoch: 9, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.249 Vali Acc: 0.294 Test Loss: 2.249 Test Acc: 0.294
Validation loss decreased (-0.288866 --> -0.294422).  Saving model ...
Epoch: 10 cost time: 1.0062766075134277
Epoch: 10, Steps: 12 | Train Loss: 2.144 Vali Loss: 2.160 Vali Acc: 0.372 Test Loss: 2.160 Test Acc: 0.372
Validation loss decreased (-0.294422 --> -0.372201).  Saving model ...
Epoch: 11 cost time: 1.2155325412750244
Epoch: 11, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.071 Vali Acc: 0.406 Test Loss: 2.071 Test Acc: 0.406
Validation loss decreased (-0.372201 --> -0.405535).  Saving model ...
Epoch: 12 cost time: 1.1074886322021484
Epoch: 12, Steps: 12 | Train Loss: 1.975 Vali Loss: 1.989 Vali Acc: 0.428 Test Loss: 1.989 Test Acc: 0.428
Validation loss decreased (-0.405535 --> -0.427758).  Saving model ...
Epoch: 13 cost time: 1.2864360809326172
Epoch: 13, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.911 Vali Acc: 0.456 Test Loss: 1.911 Test Acc: 0.456
Validation loss decreased (-0.427758 --> -0.455536).  Saving model ...
Epoch: 14 cost time: 1.2670872211456299
Epoch: 14, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.838 Vali Acc: 0.467 Test Loss: 1.838 Test Acc: 0.467
Validation loss decreased (-0.455536 --> -0.466648).  Saving model ...
Epoch: 15 cost time: 1.2571964263916016
Epoch: 15, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.779 Vali Acc: 0.506 Test Loss: 1.779 Test Acc: 0.506
Validation loss decreased (-0.466648 --> -0.505538).  Saving model ...
Epoch: 16 cost time: 1.2772061824798584
Epoch: 16, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.721 Vali Acc: 0.511 Test Loss: 1.721 Test Acc: 0.511
Validation loss decreased (-0.505538 --> -0.511094).  Saving model ...
Epoch: 17 cost time: 1.1844477653503418
Epoch: 17, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.667 Vali Acc: 0.511 Test Loss: 1.667 Test Acc: 0.511
Validation loss decreased (-0.511094 --> -0.511094).  Saving model ...
Epoch: 18 cost time: 1.3061127662658691
Epoch: 18, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.624 Vali Acc: 0.517 Test Loss: 1.624 Test Acc: 0.517
Validation loss decreased (-0.511094 --> -0.516650).  Saving model ...
Epoch: 19 cost time: 1.236950397491455
Epoch: 19, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.575 Vali Acc: 0.539 Test Loss: 1.575 Test Acc: 0.539
Validation loss decreased (-0.516650 --> -0.538873).  Saving model ...
Epoch: 20 cost time: 1.2716636657714844
Epoch: 20, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.524 Vali Acc: 0.567 Test Loss: 1.524 Test Acc: 0.567
Validation loss decreased (-0.538873 --> -0.566651).  Saving model ...
Epoch: 21 cost time: 1.3153958320617676
Epoch: 21, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.486 Vali Acc: 0.589 Test Loss: 1.486 Test Acc: 0.589
Validation loss decreased (-0.566651 --> -0.588874).  Saving model ...
Epoch: 22 cost time: 1.255547285079956
Epoch: 22, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.446 Vali Acc: 0.589 Test Loss: 1.446 Test Acc: 0.589
Validation loss decreased (-0.588874 --> -0.588874).  Saving model ...
Epoch: 23 cost time: 1.1657121181488037
Epoch: 23, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.411 Vali Acc: 0.606 Test Loss: 1.411 Test Acc: 0.606
Validation loss decreased (-0.588874 --> -0.605541).  Saving model ...
Epoch: 24 cost time: 1.1993248462677002
Epoch: 24, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.380 Vali Acc: 0.606 Test Loss: 1.380 Test Acc: 0.606
Validation loss decreased (-0.605541 --> -0.605542).  Saving model ...
Epoch: 25 cost time: 1.2032864093780518
Epoch: 25, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.354 Vali Acc: 0.622 Test Loss: 1.354 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 26 cost time: 1.2527072429656982
Epoch: 26, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.319 Vali Acc: 0.606 Test Loss: 1.319 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2721452713012695
Epoch: 27, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.286 Vali Acc: 0.611 Test Loss: 1.286 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0425734519958496
Epoch: 28, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.247 Vali Acc: 0.633 Test Loss: 1.247 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 29 cost time: 1.238710880279541
Epoch: 29, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.212 Vali Acc: 0.650 Test Loss: 1.212 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649988).  Saving model ...
Epoch: 30 cost time: 1.2615430355072021
Epoch: 30, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.180 Vali Acc: 0.650 Test Loss: 1.180 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 31 cost time: 1.2734034061431885
Epoch: 31, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.150 Vali Acc: 0.661 Test Loss: 1.150 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 32 cost time: 0.9449548721313477
Epoch: 32, Steps: 12 | Train Loss: 0.795 Vali Loss: 1.127 Vali Acc: 0.650 Test Loss: 1.127 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1350679397583008
Epoch: 33, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.098 Vali Acc: 0.656 Test Loss: 1.098 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1654696464538574
Epoch: 34, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.074 Vali Acc: 0.650 Test Loss: 1.074 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1070079803466797
Epoch: 35, Steps: 12 | Train Loss: 0.709 Vali Loss: 1.057 Vali Acc: 0.644 Test Loss: 1.057 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1018767356872559
Epoch: 36, Steps: 12 | Train Loss: 0.658 Vali Loss: 1.039 Vali Acc: 0.650 Test Loss: 1.039 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2631778717041016
Epoch: 37, Steps: 12 | Train Loss: 0.636 Vali Loss: 1.022 Vali Acc: 0.661 Test Loss: 1.022 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661101).  Saving model ...
Epoch: 38 cost time: 1.1813819408416748
Epoch: 38, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.997 Vali Acc: 0.683 Test Loss: 0.997 Test Acc: 0.683
Validation loss decreased (-0.661101 --> -0.683323).  Saving model ...
Epoch: 39 cost time: 1.1386480331420898
Epoch: 39, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.970 Vali Acc: 0.717 Test Loss: 0.970 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716657).  Saving model ...
Epoch: 40 cost time: 1.2519326210021973
Epoch: 40, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2368042469024658
Epoch: 41, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.946 Vali Acc: 0.717 Test Loss: 0.946 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 42 cost time: 1.1764156818389893
Epoch: 42, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.936 Vali Acc: 0.711 Test Loss: 0.936 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1461360454559326
Epoch: 43, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.929 Vali Acc: 0.728 Test Loss: 0.929 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 44 cost time: 1.1244494915008545
Epoch: 44, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.907 Vali Acc: 0.722 Test Loss: 0.907 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2684898376464844
Epoch: 45, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.887 Vali Acc: 0.744 Test Loss: 0.887 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744436).  Saving model ...
Epoch: 46 cost time: 1.2647368907928467
Epoch: 46, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.900 Vali Acc: 0.733 Test Loss: 0.900 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2059285640716553
Epoch: 47, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.886 Vali Acc: 0.733 Test Loss: 0.886 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0449297428131104
Epoch: 48, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.876 Vali Acc: 0.739 Test Loss: 0.876 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2032065391540527
Epoch: 49, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.866 Vali Acc: 0.722 Test Loss: 0.866 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2155451774597168
Epoch: 50, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.853 Vali Acc: 0.722 Test Loss: 0.853 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1331446170806885
Epoch: 51, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.841 Vali Acc: 0.733 Test Loss: 0.841 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.216789960861206
Epoch: 52, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 53 cost time: 1.1570253372192383
Epoch: 53, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 1.2188692092895508
Epoch: 54, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 55 cost time: 1.2794709205627441
Epoch: 55, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.809 Vali Acc: 0.711 Test Loss: 0.809 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2175168991088867
Epoch: 56, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.803 Vali Acc: 0.733 Test Loss: 0.803 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.132744550704956
Epoch: 57, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.817 Vali Acc: 0.728 Test Loss: 0.817 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.166658878326416
Epoch: 58, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.820 Vali Acc: 0.728 Test Loss: 0.820 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2789926528930664
Epoch: 59, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.28971529006958
Epoch: 60, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 61 cost time: 1.1972448825836182
Epoch: 61, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 62 cost time: 1.1948719024658203
Epoch: 62, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.783 Vali Acc: 0.772 Test Loss: 0.783 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 63 cost time: 1.2217388153076172
Epoch: 63, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.783 Vali Acc: 0.767 Test Loss: 0.783 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2360069751739502
Epoch: 64, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.090968132019043
Epoch: 65, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.793 Vali Acc: 0.767 Test Loss: 0.793 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.145040512084961
Epoch: 66, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.774 Vali Acc: 0.767 Test Loss: 0.774 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.0961432456970215
Epoch: 67, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.778 Vali Acc: 0.772 Test Loss: 0.778 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 68 cost time: 1.061291217803955
Epoch: 68, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2350900173187256
Epoch: 69, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.795 Vali Acc: 0.739 Test Loss: 0.795 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.1918814182281494
Epoch: 70, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.798 Vali Acc: 0.739 Test Loss: 0.798 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.1705248355865479
Epoch: 71, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.780 Vali Acc: 0.772 Test Loss: 0.780 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.167921543121338
Epoch: 72, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.265746831893921
Epoch: 73, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.2179043292999268
Epoch: 74, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.1641449928283691
Epoch: 75, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.783 Vali Acc: 0.772 Test Loss: 0.783 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.2301101684570312
Epoch: 76, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.794 Vali Acc: 0.767 Test Loss: 0.794 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.237748384475708
Epoch: 77, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.788 Vali Acc: 0.772 Test Loss: 0.788 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 14351
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8190293312072754
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.842 Vali Acc: 0.083 Test Loss: 2.842 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 1.3431041240692139
Epoch: 2, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.803 Vali Acc: 0.094 Test Loss: 2.803 Test Acc: 0.094
Validation loss decreased (-0.083305 --> -0.094416).  Saving model ...
Epoch: 3 cost time: 1.1335842609405518
Epoch: 3, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.753 Vali Acc: 0.128 Test Loss: 2.753 Test Acc: 0.128
Validation loss decreased (-0.094416 --> -0.127750).  Saving model ...
Epoch: 4 cost time: 1.093334674835205
Epoch: 4, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.688 Vali Acc: 0.144 Test Loss: 2.688 Test Acc: 0.144
Validation loss decreased (-0.127750 --> -0.144418).  Saving model ...
Epoch: 5 cost time: 1.1011061668395996
Epoch: 5, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.623 Vali Acc: 0.167 Test Loss: 2.623 Test Acc: 0.167
Validation loss decreased (-0.144418 --> -0.166640).  Saving model ...
Epoch: 6 cost time: 1.2155017852783203
Epoch: 6, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.546 Vali Acc: 0.189 Test Loss: 2.546 Test Acc: 0.189
Validation loss decreased (-0.166640 --> -0.188863).  Saving model ...
Epoch: 7 cost time: 1.1652729511260986
Epoch: 7, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.463 Vali Acc: 0.228 Test Loss: 2.463 Test Acc: 0.228
Validation loss decreased (-0.188863 --> -0.227753).  Saving model ...
Epoch: 8 cost time: 1.0668597221374512
Epoch: 8, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.375 Vali Acc: 0.306 Test Loss: 2.375 Test Acc: 0.306
Validation loss decreased (-0.227753 --> -0.305532).  Saving model ...
Epoch: 9 cost time: 1.0182676315307617
Epoch: 9, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.286 Vali Acc: 0.367 Test Loss: 2.286 Test Acc: 0.367
Validation loss decreased (-0.305532 --> -0.366644).  Saving model ...
Epoch: 10 cost time: 0.972736120223999
Epoch: 10, Steps: 12 | Train Loss: 2.209 Vali Loss: 2.195 Vali Acc: 0.406 Test Loss: 2.195 Test Acc: 0.406
Validation loss decreased (-0.366644 --> -0.405534).  Saving model ...
Epoch: 11 cost time: 1.2494621276855469
Epoch: 11, Steps: 12 | Train Loss: 2.144 Vali Loss: 2.105 Vali Acc: 0.411 Test Loss: 2.105 Test Acc: 0.411
Validation loss decreased (-0.405534 --> -0.411090).  Saving model ...
Epoch: 12 cost time: 1.2022264003753662
Epoch: 12, Steps: 12 | Train Loss: 1.976 Vali Loss: 2.024 Vali Acc: 0.428 Test Loss: 2.024 Test Acc: 0.428
Validation loss decreased (-0.411090 --> -0.427758).  Saving model ...
Epoch: 13 cost time: 1.1874985694885254
Epoch: 13, Steps: 12 | Train Loss: 1.925 Vali Loss: 1.938 Vali Acc: 0.444 Test Loss: 1.938 Test Acc: 0.444
Validation loss decreased (-0.427758 --> -0.444425).  Saving model ...
Epoch: 14 cost time: 1.190049171447754
Epoch: 14, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.865 Vali Acc: 0.456 Test Loss: 1.865 Test Acc: 0.456
Validation loss decreased (-0.444425 --> -0.455537).  Saving model ...
Epoch: 15 cost time: 1.264810562133789
Epoch: 15, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.792 Vali Acc: 0.478 Test Loss: 1.792 Test Acc: 0.478
Validation loss decreased (-0.455537 --> -0.477760).  Saving model ...
Epoch: 16 cost time: 1.1389448642730713
Epoch: 16, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.708 Vali Acc: 0.506 Test Loss: 1.708 Test Acc: 0.506
Validation loss decreased (-0.477760 --> -0.505538).  Saving model ...
Epoch: 17 cost time: 1.1112208366394043
Epoch: 17, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.640 Vali Acc: 0.533 Test Loss: 1.640 Test Acc: 0.533
Validation loss decreased (-0.505538 --> -0.533317).  Saving model ...
Epoch: 18 cost time: 1.1587071418762207
Epoch: 18, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.583 Vali Acc: 0.533 Test Loss: 1.583 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533318).  Saving model ...
Epoch: 19 cost time: 1.185558795928955
Epoch: 19, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.519 Vali Acc: 0.550 Test Loss: 1.519 Test Acc: 0.550
Validation loss decreased (-0.533318 --> -0.549985).  Saving model ...
Epoch: 20 cost time: 1.1654000282287598
Epoch: 20, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.468 Vali Acc: 0.561 Test Loss: 1.468 Test Acc: 0.561
Validation loss decreased (-0.549985 --> -0.561096).  Saving model ...
Epoch: 21 cost time: 1.1005890369415283
Epoch: 21, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.414 Vali Acc: 0.561 Test Loss: 1.414 Test Acc: 0.561
Validation loss decreased (-0.561096 --> -0.561097).  Saving model ...
Epoch: 22 cost time: 1.067511796951294
Epoch: 22, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.354 Vali Acc: 0.567 Test Loss: 1.354 Test Acc: 0.567
Validation loss decreased (-0.561097 --> -0.566653).  Saving model ...
Epoch: 23 cost time: 1.108459711074829
Epoch: 23, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.303 Vali Acc: 0.583 Test Loss: 1.303 Test Acc: 0.583
Validation loss decreased (-0.566653 --> -0.583320).  Saving model ...
Epoch: 24 cost time: 1.195582628250122
Epoch: 24, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.258 Vali Acc: 0.578 Test Loss: 1.258 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0667829513549805
Epoch: 25, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.216 Vali Acc: 0.578 Test Loss: 1.216 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0285418033599854
Epoch: 26, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.175 Vali Acc: 0.578 Test Loss: 1.175 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.085709571838379
Epoch: 27, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.137 Vali Acc: 0.583 Test Loss: 1.137 Test Acc: 0.583
Validation loss decreased (-0.583320 --> -0.583322).  Saving model ...
Epoch: 28 cost time: 1.0586881637573242
Epoch: 28, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.114 Vali Acc: 0.606 Test Loss: 1.114 Test Acc: 0.606
Validation loss decreased (-0.583322 --> -0.605544).  Saving model ...
Epoch: 29 cost time: 1.0616648197174072
Epoch: 29, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.084 Vali Acc: 0.611 Test Loss: 1.084 Test Acc: 0.611
Validation loss decreased (-0.605544 --> -0.611100).  Saving model ...
Epoch: 30 cost time: 1.1871142387390137
Epoch: 30, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.064 Vali Acc: 0.594 Test Loss: 1.064 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1587045192718506
Epoch: 31, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.038 Vali Acc: 0.628 Test Loss: 1.038 Test Acc: 0.628
Validation loss decreased (-0.611100 --> -0.627767).  Saving model ...
Epoch: 32 cost time: 1.1692330837249756
Epoch: 32, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.020 Vali Acc: 0.617 Test Loss: 1.020 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1442549228668213
Epoch: 33, Steps: 12 | Train Loss: 0.733 Vali Loss: 1.003 Vali Acc: 0.639 Test Loss: 1.003 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638879).  Saving model ...
Epoch: 34 cost time: 1.047727346420288
Epoch: 34, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
Validation loss decreased (-0.638879 --> -0.649990).  Saving model ...
Epoch: 35 cost time: 1.1071500778198242
Epoch: 35, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.980 Vali Acc: 0.644 Test Loss: 0.980 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1762123107910156
Epoch: 36, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.966 Vali Acc: 0.644 Test Loss: 0.966 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.184706687927246
Epoch: 37, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.951 Vali Acc: 0.661 Test Loss: 0.951 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661102).  Saving model ...
Epoch: 38 cost time: 1.0213677883148193
Epoch: 38, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.935 Vali Acc: 0.672 Test Loss: 0.935 Test Acc: 0.672
Validation loss decreased (-0.661102 --> -0.672213).  Saving model ...
Epoch: 39 cost time: 1.085036039352417
Epoch: 39, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.921 Vali Acc: 0.689 Test Loss: 0.921 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688880).  Saving model ...
Epoch: 40 cost time: 1.1070332527160645
Epoch: 40, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.916 Vali Acc: 0.689 Test Loss: 0.916 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 41 cost time: 1.0578947067260742
Epoch: 41, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.912 Vali Acc: 0.683 Test Loss: 0.912 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.093557357788086
Epoch: 42, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.904 Vali Acc: 0.683 Test Loss: 0.904 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0958890914916992
Epoch: 43, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.899 Vali Acc: 0.678 Test Loss: 0.899 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.023662805557251
Epoch: 44, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.886 Vali Acc: 0.689 Test Loss: 0.886 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 45 cost time: 1.0711700916290283
Epoch: 45, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.872 Vali Acc: 0.694 Test Loss: 0.872 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694436).  Saving model ...
Epoch: 46 cost time: 1.0020945072174072
Epoch: 46, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.865 Vali Acc: 0.689 Test Loss: 0.865 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0487885475158691
Epoch: 47, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.859 Vali Acc: 0.706 Test Loss: 0.859 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705547).  Saving model ...
Epoch: 48 cost time: 1.0019147396087646
Epoch: 48, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.860 Vali Acc: 0.706 Test Loss: 0.860 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.114161729812622
Epoch: 49, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.855 Vali Acc: 0.700 Test Loss: 0.855 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.229947805404663
Epoch: 50, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.843 Vali Acc: 0.700 Test Loss: 0.843 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.172861099243164
Epoch: 51, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.830 Vali Acc: 0.711 Test Loss: 0.830 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
Epoch: 52 cost time: 1.0432062149047852
Epoch: 52, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.813 Vali Acc: 0.711 Test Loss: 0.813 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 53 cost time: 1.1517534255981445
Epoch: 53, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.811 Vali Acc: 0.717 Test Loss: 0.811 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716659).  Saving model ...
Epoch: 54 cost time: 1.1043298244476318
Epoch: 54, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.809 Vali Acc: 0.728 Test Loss: 0.809 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727770).  Saving model ...
Epoch: 55 cost time: 1.0523676872253418
Epoch: 55, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.807 Vali Acc: 0.739 Test Loss: 0.807 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 56 cost time: 1.1090571880340576
Epoch: 56, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.809 Vali Acc: 0.733 Test Loss: 0.809 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1284160614013672
Epoch: 57, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.806 Vali Acc: 0.739 Test Loss: 0.806 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 58 cost time: 1.033588171005249
Epoch: 58, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.802 Vali Acc: 0.739 Test Loss: 0.802 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 59 cost time: 1.031404972076416
Epoch: 59, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 60 cost time: 1.0666403770446777
Epoch: 60, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.786 Vali Acc: 0.744 Test Loss: 0.786 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 61 cost time: 0.9552829265594482
Epoch: 61, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.791 Vali Acc: 0.739 Test Loss: 0.791 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0682172775268555
Epoch: 62, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.790 Vali Acc: 0.739 Test Loss: 0.790 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9540894031524658
Epoch: 63, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.786 Vali Acc: 0.744 Test Loss: 0.786 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.021533489227295
Epoch: 64, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.772 Vali Acc: 0.756 Test Loss: 0.772 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 65 cost time: 1.0056343078613281
Epoch: 65, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 66 cost time: 1.1649584770202637
Epoch: 66, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1685540676116943
Epoch: 67, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.772 Vali Acc: 0.756 Test Loss: 0.772 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1200568675994873
Epoch: 68, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.767 Vali Acc: 0.767 Test Loss: 0.767 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 69 cost time: 1.198338508605957
Epoch: 69, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.764 Vali Acc: 0.767 Test Loss: 0.764 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 70 cost time: 1.041825771331787
Epoch: 70, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.735 Vali Acc: 0.767 Test Loss: 0.735 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 71 cost time: 0.994938850402832
Epoch: 71, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.738 Vali Acc: 0.767 Test Loss: 0.738 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.0571160316467285
Epoch: 72, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.761 Vali Acc: 0.767 Test Loss: 0.761 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0474662780761719
Epoch: 73, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.117739200592041
Epoch: 74, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.759 Vali Acc: 0.761 Test Loss: 0.759 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.1138134002685547
Epoch: 75, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.769 Vali Acc: 0.767 Test Loss: 0.769 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.057424545288086
Epoch: 76, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.769 Vali Acc: 0.767 Test Loss: 0.769 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.0591151714324951
Epoch: 77, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.764 Vali Acc: 0.772 Test Loss: 0.764 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 78 cost time: 1.0499649047851562
Epoch: 78, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.743 Vali Acc: 0.778 Test Loss: 0.743 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 79 cost time: 0.9544556140899658
Epoch: 79, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.752 Vali Acc: 0.772 Test Loss: 0.752 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9850401878356934
Epoch: 80, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.015247106552124
Epoch: 81, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.795 Vali Acc: 0.767 Test Loss: 0.795 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.9854240417480469
Epoch: 82, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.057464599609375
Epoch: 83, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.1267504692077637
Epoch: 84, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.767 Vali Acc: 0.778 Test Loss: 0.767 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.0680837631225586
Epoch: 85, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.752 Vali Acc: 0.789 Test Loss: 0.752 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 86 cost time: 1.0539202690124512
Epoch: 86, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.784 Vali Acc: 0.778 Test Loss: 0.784 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.9717791080474854
Epoch: 87, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.796 Vali Acc: 0.778 Test Loss: 0.796 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.9768786430358887
Epoch: 88, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.789 Vali Acc: 0.772 Test Loss: 0.789 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.9042270183563232
Epoch: 89, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.798 Vali Acc: 0.778 Test Loss: 0.798 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.0013396739959717
Epoch: 90, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.804 Vali Acc: 0.761 Test Loss: 0.804 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.9077334403991699
Epoch: 91, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.801 Vali Acc: 0.756 Test Loss: 0.801 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.024315595626831
Epoch: 92, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.781 Vali Acc: 0.783 Test Loss: 0.781 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.9343328475952148
Epoch: 93, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.959831953048706
Epoch: 94, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.773 Vali Acc: 0.783 Test Loss: 0.773 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.8872742652893066
Epoch: 95, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799992).  Saving model ...
Epoch: 96 cost time: 0.8666532039642334
Epoch: 96, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.793 Vali Acc: 0.789 Test Loss: 0.793 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.9248981475830078
Epoch: 97, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.9463565349578857
Epoch: 98, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.788 Vali Acc: 0.778 Test Loss: 0.788 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.8145327568054199
Epoch: 99, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.8269169330596924
Epoch: 100, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.828 Vali Acc: 0.772 Test Loss: 0.828 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el3_dm16_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 13439
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.612597942352295
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.293 Vali Acc: 0.311 Test Loss: 2.293 Test Acc: 0.311
Validation loss decreased (inf --> -0.311088).  Saving model ...
Epoch: 2 cost time: 1.143930435180664
Epoch: 2, Steps: 12 | Train Loss: 1.959 Vali Loss: 1.638 Vali Acc: 0.500 Test Loss: 1.638 Test Acc: 0.500
Validation loss decreased (-0.311088 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.1558187007904053
Epoch: 3, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.362 Vali Acc: 0.606 Test Loss: 1.362 Test Acc: 0.606
Validation loss decreased (-0.499984 --> -0.605542).  Saving model ...
Epoch: 4 cost time: 1.139554738998413
Epoch: 4, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.296 Vali Acc: 0.622 Test Loss: 1.296 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 5 cost time: 1.1486077308654785
Epoch: 5, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.194 Vali Acc: 0.611 Test Loss: 1.194 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.170536756515503
Epoch: 6, Steps: 12 | Train Loss: 0.639 Vali Loss: 1.181 Vali Acc: 0.656 Test Loss: 1.181 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655544).  Saving model ...
Epoch: 7 cost time: 1.1327121257781982
Epoch: 7, Steps: 12 | Train Loss: 0.464 Vali Loss: 1.043 Vali Acc: 0.717 Test Loss: 1.043 Test Acc: 0.717
Validation loss decreased (-0.655544 --> -0.716656).  Saving model ...
Epoch: 8 cost time: 1.0963897705078125
Epoch: 8, Steps: 12 | Train Loss: 0.378 Vali Loss: 1.094 Vali Acc: 0.733 Test Loss: 1.094 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733322).  Saving model ...
Epoch: 9 cost time: 1.0739083290100098
Epoch: 9, Steps: 12 | Train Loss: 0.275 Vali Loss: 1.083 Vali Acc: 0.733 Test Loss: 1.083 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733322).  Saving model ...
Epoch: 10 cost time: 1.1226747035980225
Epoch: 10, Steps: 12 | Train Loss: 0.278 Vali Loss: 1.195 Vali Acc: 0.700 Test Loss: 1.195 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2366054058074951
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.316 Vali Acc: 0.694 Test Loss: 1.316 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1135461330413818
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.287 Vali Acc: 0.717 Test Loss: 1.287 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2139613628387451
Epoch: 13, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.428 Vali Acc: 0.722 Test Loss: 1.428 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2146952152252197
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.397 Vali Acc: 0.733 Test Loss: 1.397 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2068793773651123
Epoch: 15, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.453 Vali Acc: 0.756 Test Loss: 1.453 Test Acc: 0.756
Validation loss decreased (-0.733322 --> -0.755541).  Saving model ...
Epoch: 16 cost time: 1.05794095993042
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.631 Vali Acc: 0.739 Test Loss: 1.631 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9926247596740723
Epoch: 17, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.524 Vali Acc: 0.722 Test Loss: 1.524 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0672967433929443
Epoch: 18, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.824 Vali Acc: 0.711 Test Loss: 1.824 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0440616607666016
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.722 Vali Acc: 0.722 Test Loss: 1.722 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1000864505767822
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 2.000 Vali Acc: 0.717 Test Loss: 2.000 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.189321756362915
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.755 Vali Acc: 0.744 Test Loss: 1.755 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2337274551391602
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.905 Vali Acc: 0.694 Test Loss: 1.905 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2250983715057373
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.934 Vali Acc: 0.700 Test Loss: 1.934 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2818841934204102
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 2.059 Vali Acc: 0.706 Test Loss: 2.059 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.120497465133667
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.957 Vali Acc: 0.733 Test Loss: 1.957 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 438287
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3642005920410156
Epoch: 1, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.524 Vali Acc: 0.233 Test Loss: 2.524 Test Acc: 0.233
Validation loss decreased (inf --> -0.233308).  Saving model ...
Epoch: 2 cost time: 0.8811326026916504
Epoch: 2, Steps: 12 | Train Loss: 2.234 Vali Loss: 1.977 Vali Acc: 0.456 Test Loss: 1.977 Test Acc: 0.456
Validation loss decreased (-0.233308 --> -0.455536).  Saving model ...
Epoch: 3 cost time: 0.8429663181304932
Epoch: 3, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.582 Vali Acc: 0.528 Test Loss: 1.582 Test Acc: 0.528
Validation loss decreased (-0.455536 --> -0.527762).  Saving model ...
Epoch: 4 cost time: 0.7504191398620605
Epoch: 4, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.392 Vali Acc: 0.572 Test Loss: 1.392 Test Acc: 0.572
Validation loss decreased (-0.527762 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 0.787125825881958
Epoch: 5, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.229 Vali Acc: 0.656 Test Loss: 1.229 Test Acc: 0.656
Validation loss decreased (-0.572208 --> -0.655543).  Saving model ...
Epoch: 6 cost time: 0.8556666374206543
Epoch: 6, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7901222705841064
Epoch: 7, Steps: 12 | Train Loss: 0.732 Vali Loss: 1.149 Vali Acc: 0.683 Test Loss: 1.149 Test Acc: 0.683
Validation loss decreased (-0.655543 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 0.8244452476501465
Epoch: 8, Steps: 12 | Train Loss: 0.598 Vali Loss: 1.143 Vali Acc: 0.667 Test Loss: 1.143 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8716700077056885
Epoch: 9, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.994 Vali Acc: 0.711 Test Loss: 0.994 Test Acc: 0.711
Validation loss decreased (-0.683322 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 0.9019687175750732
Epoch: 10, Steps: 12 | Train Loss: 0.381 Vali Loss: 1.018 Vali Acc: 0.706 Test Loss: 1.018 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8507781028747559
Epoch: 11, Steps: 12 | Train Loss: 0.352 Vali Loss: 1.074 Vali Acc: 0.683 Test Loss: 1.074 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8586723804473877
Epoch: 12, Steps: 12 | Train Loss: 0.279 Vali Loss: 1.007 Vali Acc: 0.761 Test Loss: 1.007 Test Acc: 0.761
Validation loss decreased (-0.711101 --> -0.761101).  Saving model ...
Epoch: 13 cost time: 0.8276176452636719
Epoch: 13, Steps: 12 | Train Loss: 0.271 Vali Loss: 1.081 Vali Acc: 0.750 Test Loss: 1.081 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7756421566009521
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 1.118 Vali Acc: 0.750 Test Loss: 1.118 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8266236782073975
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.118 Vali Acc: 0.722 Test Loss: 1.118 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8452954292297363
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.181 Vali Acc: 0.728 Test Loss: 1.181 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6918957233428955
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.169 Vali Acc: 0.728 Test Loss: 1.169 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7538261413574219
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.180 Vali Acc: 0.756 Test Loss: 1.180 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8407561779022217
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.240 Vali Acc: 0.739 Test Loss: 1.240 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7663064002990723
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.329 Vali Acc: 0.756 Test Loss: 1.329 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7663302421569824
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.307 Vali Acc: 0.739 Test Loss: 1.307 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7310221195220947
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.350 Vali Acc: 0.739 Test Loss: 1.350 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 353935
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1692070960998535
Epoch: 1, Steps: 12 | Train Loss: 2.894 Vali Loss: 2.559 Vali Acc: 0.161 Test Loss: 2.559 Test Acc: 0.161
Validation loss decreased (inf --> -0.161086).  Saving model ...
Epoch: 2 cost time: 0.7810478210449219
Epoch: 2, Steps: 12 | Train Loss: 2.296 Vali Loss: 1.971 Vali Acc: 0.472 Test Loss: 1.971 Test Acc: 0.472
Validation loss decreased (-0.161086 --> -0.472203).  Saving model ...
Epoch: 3 cost time: 0.7420084476470947
Epoch: 3, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.595 Vali Acc: 0.517 Test Loss: 1.595 Test Acc: 0.517
Validation loss decreased (-0.472203 --> -0.516651).  Saving model ...
Epoch: 4 cost time: 0.9278678894042969
Epoch: 4, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.420 Vali Acc: 0.572 Test Loss: 1.420 Test Acc: 0.572
Validation loss decreased (-0.516651 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 0.7810556888580322
Epoch: 5, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.304 Vali Acc: 0.594 Test Loss: 1.304 Test Acc: 0.594
Validation loss decreased (-0.572208 --> -0.594431).  Saving model ...
Epoch: 6 cost time: 0.8066267967224121
Epoch: 6, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.240 Vali Acc: 0.633 Test Loss: 1.240 Test Acc: 0.633
Validation loss decreased (-0.594431 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 0.8100461959838867
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 1.249 Vali Acc: 0.667 Test Loss: 1.249 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666654).  Saving model ...
Epoch: 8 cost time: 0.8740262985229492
Epoch: 8, Steps: 12 | Train Loss: 0.652 Vali Loss: 1.156 Vali Acc: 0.656 Test Loss: 1.156 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.853369951248169
Epoch: 9, Steps: 12 | Train Loss: 0.566 Vali Loss: 1.060 Vali Acc: 0.694 Test Loss: 1.060 Test Acc: 0.694
Validation loss decreased (-0.666654 --> -0.694434).  Saving model ...
Epoch: 10 cost time: 0.7798810005187988
Epoch: 10, Steps: 12 | Train Loss: 0.425 Vali Loss: 1.027 Vali Acc: 0.706 Test Loss: 1.027 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 11 cost time: 0.764035701751709
Epoch: 11, Steps: 12 | Train Loss: 0.399 Vali Loss: 1.061 Vali Acc: 0.706 Test Loss: 1.061 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7739231586456299
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.951 Vali Acc: 0.756 Test Loss: 0.951 Test Acc: 0.756
Validation loss decreased (-0.705545 --> -0.755546).  Saving model ...
Epoch: 13 cost time: 0.8786952495574951
Epoch: 13, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.007 Vali Acc: 0.756 Test Loss: 1.007 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.797705888748169
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7950541973114014
Epoch: 15, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.089 Vali Acc: 0.750 Test Loss: 1.089 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7781410217285156
Epoch: 16, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.138 Vali Acc: 0.739 Test Loss: 1.138 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8604674339294434
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.104 Vali Acc: 0.750 Test Loss: 1.104 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9022643566131592
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.193 Vali Acc: 0.739 Test Loss: 1.193 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9128873348236084
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.217 Vali Acc: 0.761 Test Loss: 1.217 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761099).  Saving model ...
Epoch: 20 cost time: 0.8371727466583252
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.212 Vali Acc: 0.756 Test Loss: 1.212 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7839303016662598
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.206 Vali Acc: 0.761 Test Loss: 1.206 Test Acc: 0.761
Validation loss decreased (-0.761099 --> -0.761099).  Saving model ...
Epoch: 22 cost time: 0.7906203269958496
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.247 Vali Acc: 0.744 Test Loss: 1.247 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8488192558288574
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.278 Vali Acc: 0.750 Test Loss: 1.278 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7913751602172852
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.333 Vali Acc: 0.767 Test Loss: 1.333 Test Acc: 0.767
Validation loss decreased (-0.761099 --> -0.766653).  Saving model ...
Epoch: 25 cost time: 0.8021032810211182
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.269 Vali Acc: 0.794 Test Loss: 1.269 Test Acc: 0.794
Validation loss decreased (-0.766653 --> -0.794432).  Saving model ...
Epoch: 26 cost time: 0.8123281002044678
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.294 Vali Acc: 0.767 Test Loss: 1.294 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8523674011230469
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.309 Vali Acc: 0.756 Test Loss: 1.309 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8476581573486328
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.375 Vali Acc: 0.789 Test Loss: 1.375 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8624083995819092
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.386 Vali Acc: 0.767 Test Loss: 1.386 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8272497653961182
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.399 Vali Acc: 0.767 Test Loss: 1.399 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7383544445037842
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.514 Vali Acc: 0.767 Test Loss: 1.514 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7389452457427979
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.458 Vali Acc: 0.778 Test Loss: 1.458 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7764596939086914
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.463 Vali Acc: 0.783 Test Loss: 1.463 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8080055713653564
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.486 Vali Acc: 0.767 Test Loss: 1.486 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7944550514221191
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.560 Vali Acc: 0.767 Test Loss: 1.560 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 350223
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.341766357421875
Epoch: 1, Steps: 12 | Train Loss: 2.860 Vali Loss: 2.610 Vali Acc: 0.183 Test Loss: 2.610 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 0.8109288215637207
Epoch: 2, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.130 Vali Acc: 0.294 Test Loss: 2.130 Test Acc: 0.294
Validation loss decreased (-0.183307 --> -0.294423).  Saving model ...
Epoch: 3 cost time: 0.8758285045623779
Epoch: 3, Steps: 12 | Train Loss: 1.981 Vali Loss: 1.742 Vali Acc: 0.500 Test Loss: 1.742 Test Acc: 0.500
Validation loss decreased (-0.294423 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 0.8001468181610107
Epoch: 4, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.505 Vali Acc: 0.567 Test Loss: 1.505 Test Acc: 0.567
Validation loss decreased (-0.499983 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 0.7076966762542725
Epoch: 5, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.381 Vali Acc: 0.583 Test Loss: 1.381 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 0.7626168727874756
Epoch: 6, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.281 Vali Acc: 0.633 Test Loss: 1.281 Test Acc: 0.633
Validation loss decreased (-0.583320 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 0.7624378204345703
Epoch: 7, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.222 Vali Acc: 0.644 Test Loss: 1.222 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.7908802032470703
Epoch: 8, Steps: 12 | Train Loss: 0.678 Vali Loss: 1.128 Vali Acc: 0.650 Test Loss: 1.128 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.8400876522064209
Epoch: 9, Steps: 12 | Train Loss: 0.641 Vali Loss: 1.118 Vali Acc: 0.650 Test Loss: 1.118 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.8397316932678223
Epoch: 10, Steps: 12 | Train Loss: 0.512 Vali Loss: 1.030 Vali Acc: 0.711 Test Loss: 1.030 Test Acc: 0.711
Validation loss decreased (-0.649989 --> -0.711101).  Saving model ...
Epoch: 11 cost time: 0.7760679721832275
Epoch: 11, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.993 Vali Acc: 0.744 Test Loss: 0.993 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744435).  Saving model ...
Epoch: 12 cost time: 0.718184232711792
Epoch: 12, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.947 Vali Acc: 0.756 Test Loss: 0.947 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 13 cost time: 0.6982812881469727
Epoch: 13, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.950 Vali Acc: 0.744 Test Loss: 0.950 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7501087188720703
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.919 Vali Acc: 0.772 Test Loss: 0.919 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772213).  Saving model ...
Epoch: 15 cost time: 0.8532507419586182
Epoch: 15, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7761282920837402
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.947 Vali Acc: 0.744 Test Loss: 0.947 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7695770263671875
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.004 Vali Acc: 0.772 Test Loss: 1.004 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8433544635772705
Epoch: 18, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.964 Vali Acc: 0.772 Test Loss: 0.964 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8460030555725098
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.018 Vali Acc: 0.761 Test Loss: 1.018 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7668845653533936
Epoch: 20, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.993 Vali Acc: 0.767 Test Loss: 0.993 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8110518455505371
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.116 Vali Acc: 0.700 Test Loss: 1.116 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8223073482513428
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.100 Vali Acc: 0.783 Test Loss: 1.100 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783322).  Saving model ...
Epoch: 23 cost time: 0.8182322978973389
Epoch: 23, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.135 Vali Acc: 0.756 Test Loss: 1.135 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8303940296173096
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.103 Vali Acc: 0.794 Test Loss: 1.103 Test Acc: 0.794
Validation loss decreased (-0.783322 --> -0.794433).  Saving model ...
Epoch: 25 cost time: 0.8517425060272217
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.097 Vali Acc: 0.772 Test Loss: 1.097 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8188512325286865
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.144 Vali Acc: 0.750 Test Loss: 1.144 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8087167739868164
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.165 Vali Acc: 0.778 Test Loss: 1.165 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.806868314743042
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.170 Vali Acc: 0.778 Test Loss: 1.170 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.819328784942627
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.203 Vali Acc: 0.783 Test Loss: 1.203 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7952518463134766
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.182 Vali Acc: 0.783 Test Loss: 1.182 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7827343940734863
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.184 Vali Acc: 0.778 Test Loss: 1.184 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7666730880737305
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.262 Vali Acc: 0.778 Test Loss: 1.262 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7693803310394287
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.266 Vali Acc: 0.761 Test Loss: 1.266 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8263912200927734
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.253 Vali Acc: 0.783 Test Loss: 1.253 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 323471
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.384894609451294
Epoch: 1, Steps: 12 | Train Loss: 2.842 Vali Loss: 2.700 Vali Acc: 0.106 Test Loss: 2.700 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.7943334579467773
Epoch: 2, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.274 Vali Acc: 0.272 Test Loss: 2.274 Test Acc: 0.272
Validation loss decreased (-0.105529 --> -0.272199).  Saving model ...
Epoch: 3 cost time: 0.7396652698516846
Epoch: 3, Steps: 12 | Train Loss: 2.134 Vali Loss: 1.859 Vali Acc: 0.494 Test Loss: 1.859 Test Acc: 0.494
Validation loss decreased (-0.272199 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 0.7832794189453125
Epoch: 4, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.605 Vali Acc: 0.550 Test Loss: 1.605 Test Acc: 0.550
Validation loss decreased (-0.494426 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 0.7528579235076904
Epoch: 5, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.438 Vali Acc: 0.572 Test Loss: 1.438 Test Acc: 0.572
Validation loss decreased (-0.549984 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 0.7597923278808594
Epoch: 6, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.325 Vali Acc: 0.611 Test Loss: 1.325 Test Acc: 0.611
Validation loss decreased (-0.572208 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 0.7355554103851318
Epoch: 7, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.271 Vali Acc: 0.633 Test Loss: 1.271 Test Acc: 0.633
Validation loss decreased (-0.611098 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 0.7116625308990479
Epoch: 8, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.217 Vali Acc: 0.661 Test Loss: 1.217 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 0.7844052314758301
Epoch: 9, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.198 Vali Acc: 0.650 Test Loss: 1.198 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7254786491394043
Epoch: 10, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.090 Vali Acc: 0.678 Test Loss: 1.090 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 11 cost time: 0.7245316505432129
Epoch: 11, Steps: 12 | Train Loss: 0.581 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.7919833660125732
Epoch: 12, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.975 Vali Acc: 0.694 Test Loss: 0.975 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7291367053985596
Epoch: 13, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.8346960544586182
Epoch: 14, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.954 Vali Acc: 0.722 Test Loss: 0.954 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722213).  Saving model ...
Epoch: 15 cost time: 0.7543625831604004
Epoch: 15, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.895 Vali Acc: 0.744 Test Loss: 0.895 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744435).  Saving model ...
Epoch: 16 cost time: 0.8011250495910645
Epoch: 16, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.881 Vali Acc: 0.739 Test Loss: 0.881 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7728006839752197
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.907 Vali Acc: 0.744 Test Loss: 0.907 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7766258716583252
Epoch: 18, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.897 Vali Acc: 0.728 Test Loss: 0.897 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7389969825744629
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.891 Vali Acc: 0.783 Test Loss: 0.891 Test Acc: 0.783
Validation loss decreased (-0.744435 --> -0.783324).  Saving model ...
Epoch: 20 cost time: 0.7862277030944824
Epoch: 20, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.891 Vali Acc: 0.761 Test Loss: 0.891 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7984881401062012
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.931 Vali Acc: 0.761 Test Loss: 0.931 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7678179740905762
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.972 Vali Acc: 0.761 Test Loss: 0.972 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.800107479095459
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.947 Vali Acc: 0.761 Test Loss: 0.947 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8190793991088867
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.973 Vali Acc: 0.772 Test Loss: 0.973 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.779862642288208
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.983 Vali Acc: 0.778 Test Loss: 0.983 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7282869815826416
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.970 Vali Acc: 0.772 Test Loss: 0.970 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7082879543304443
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.032 Vali Acc: 0.783 Test Loss: 1.032 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6779139041900635
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.020 Vali Acc: 0.767 Test Loss: 1.020 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8012614250183105
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.039 Vali Acc: 0.772 Test Loss: 1.039 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 308367
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.352285861968994
Epoch: 1, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.667 Vali Acc: 0.100 Test Loss: 2.667 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.8334994316101074
Epoch: 2, Steps: 12 | Train Loss: 2.506 Vali Loss: 2.301 Vali Acc: 0.239 Test Loss: 2.301 Test Acc: 0.239
Validation loss decreased (-0.099973 --> -0.238866).  Saving model ...
Epoch: 3 cost time: 0.8304769992828369
Epoch: 3, Steps: 12 | Train Loss: 2.110 Vali Loss: 1.941 Vali Acc: 0.483 Test Loss: 1.941 Test Acc: 0.483
Validation loss decreased (-0.238866 --> -0.483314).  Saving model ...
Epoch: 4 cost time: 0.7869386672973633
Epoch: 4, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.686 Vali Acc: 0.556 Test Loss: 1.686 Test Acc: 0.556
Validation loss decreased (-0.483314 --> -0.555539).  Saving model ...
Epoch: 5 cost time: 0.816300630569458
Epoch: 5, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.482 Vali Acc: 0.561 Test Loss: 1.482 Test Acc: 0.561
Validation loss decreased (-0.555539 --> -0.561096).  Saving model ...
Epoch: 6 cost time: 0.7976033687591553
Epoch: 6, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.359 Vali Acc: 0.617 Test Loss: 1.359 Test Acc: 0.617
Validation loss decreased (-0.561096 --> -0.616653).  Saving model ...
Epoch: 7 cost time: 0.9179551601409912
Epoch: 7, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.275 Vali Acc: 0.606 Test Loss: 1.275 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0306751728057861
Epoch: 8, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.233 Vali Acc: 0.622 Test Loss: 1.233 Test Acc: 0.622
Validation loss decreased (-0.616653 --> -0.622210).  Saving model ...
Epoch: 9 cost time: 0.8966860771179199
Epoch: 9, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.119 Vali Acc: 0.644 Test Loss: 1.119 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644433).  Saving model ...
Epoch: 10 cost time: 0.9115715026855469
Epoch: 10, Steps: 12 | Train Loss: 0.660 Vali Loss: 1.063 Vali Acc: 0.667 Test Loss: 1.063 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 0.8224570751190186
Epoch: 11, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.959 Vali Acc: 0.689 Test Loss: 0.959 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688879).  Saving model ...
Epoch: 12 cost time: 0.7576923370361328
Epoch: 12, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.890 Vali Acc: 0.711 Test Loss: 0.890 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.85341477394104
Epoch: 13, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.862 Vali Acc: 0.733 Test Loss: 0.862 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 0.9179055690765381
Epoch: 14, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.868 Vali Acc: 0.728 Test Loss: 0.868 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8114721775054932
Epoch: 15, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.7207462787628174
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7599220275878906
Epoch: 17, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.850 Vali Acc: 0.733 Test Loss: 0.850 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7531046867370605
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 19 cost time: 0.8001737594604492
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 20 cost time: 0.857367753982544
Epoch: 20, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.805 Vali Acc: 0.744 Test Loss: 0.805 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8309462070465088
Epoch: 21, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.836 Vali Acc: 0.767 Test Loss: 0.836 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 22 cost time: 0.8417806625366211
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.872 Vali Acc: 0.756 Test Loss: 0.872 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7893083095550537
Epoch: 23, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.887 Vali Acc: 0.761 Test Loss: 0.887 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8348493576049805
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.886 Vali Acc: 0.772 Test Loss: 0.886 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772213).  Saving model ...
Epoch: 25 cost time: 0.9067363739013672
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.928 Vali Acc: 0.750 Test Loss: 0.928 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8398711681365967
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8564944267272949
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.937 Vali Acc: 0.767 Test Loss: 0.937 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9136784076690674
Epoch: 28, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.962 Vali Acc: 0.744 Test Loss: 0.962 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.959430456161499
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.945 Vali Acc: 0.744 Test Loss: 0.945 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7896387577056885
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.813622236251831
Epoch: 31, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.002 Vali Acc: 0.756 Test Loss: 1.002 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7823412418365479
Epoch: 32, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.993 Vali Acc: 0.767 Test Loss: 0.993 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.769279956817627
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.993 Vali Acc: 0.767 Test Loss: 0.993 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8289625644683838
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.071 Vali Acc: 0.739 Test Loss: 1.071 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 300943
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.372835874557495
Epoch: 1, Steps: 12 | Train Loss: 2.901 Vali Loss: 2.710 Vali Acc: 0.039 Test Loss: 2.710 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 0.7802760601043701
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.392 Vali Acc: 0.272 Test Loss: 2.392 Test Acc: 0.272
Validation loss decreased (-0.038862 --> -0.272198).  Saving model ...
Epoch: 3 cost time: 0.7782247066497803
Epoch: 3, Steps: 12 | Train Loss: 2.272 Vali Loss: 2.052 Vali Acc: 0.411 Test Loss: 2.052 Test Acc: 0.411
Validation loss decreased (-0.272198 --> -0.411091).  Saving model ...
Epoch: 4 cost time: 0.7793309688568115
Epoch: 4, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.776 Vali Acc: 0.528 Test Loss: 1.776 Test Acc: 0.528
Validation loss decreased (-0.411091 --> -0.527760).  Saving model ...
Epoch: 5 cost time: 0.8025004863739014
Epoch: 5, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.584 Vali Acc: 0.550 Test Loss: 1.584 Test Acc: 0.550
Validation loss decreased (-0.527760 --> -0.549984).  Saving model ...
Epoch: 6 cost time: 0.7648301124572754
Epoch: 6, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.458 Vali Acc: 0.567 Test Loss: 1.458 Test Acc: 0.567
Validation loss decreased (-0.549984 --> -0.566652).  Saving model ...
Epoch: 7 cost time: 0.7995033264160156
Epoch: 7, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.325 Vali Acc: 0.606 Test Loss: 1.325 Test Acc: 0.606
Validation loss decreased (-0.566652 --> -0.605542).  Saving model ...
Epoch: 8 cost time: 0.753582239151001
Epoch: 8, Steps: 12 | Train Loss: 0.984 Vali Loss: 1.204 Vali Acc: 0.633 Test Loss: 1.204 Test Acc: 0.633
Validation loss decreased (-0.605542 --> -0.633321).  Saving model ...
Epoch: 9 cost time: 0.744809627532959
Epoch: 9, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.119 Vali Acc: 0.656 Test Loss: 1.119 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 0.686328649520874
Epoch: 10, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.015 Vali Acc: 0.650 Test Loss: 1.015 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7797505855560303
Epoch: 11, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.987 Vali Acc: 0.656 Test Loss: 0.987 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655546).  Saving model ...
Epoch: 12 cost time: 0.8925604820251465
Epoch: 12, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.909 Vali Acc: 0.706 Test Loss: 0.909 Test Acc: 0.706
Validation loss decreased (-0.655546 --> -0.705546).  Saving model ...
Epoch: 13 cost time: 0.7931563854217529
Epoch: 13, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.870 Vali Acc: 0.717 Test Loss: 0.870 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716658).  Saving model ...
Epoch: 14 cost time: 0.7288064956665039
Epoch: 14, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.846 Vali Acc: 0.689 Test Loss: 0.846 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7140920162200928
Epoch: 15, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 16 cost time: 0.7806541919708252
Epoch: 16, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.843 Vali Acc: 0.728 Test Loss: 0.843 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727769).  Saving model ...
Epoch: 17 cost time: 0.750690221786499
Epoch: 17, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.784 Vali Acc: 0.761 Test Loss: 0.784 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761103).  Saving model ...
Epoch: 18 cost time: 0.7390377521514893
Epoch: 18, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.840 Vali Acc: 0.772 Test Loss: 0.840 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 19 cost time: 0.7782208919525146
Epoch: 19, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.811 Vali Acc: 0.739 Test Loss: 0.811 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.781456708908081
Epoch: 20, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.818 Vali Acc: 0.772 Test Loss: 0.818 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 21 cost time: 0.7814078330993652
Epoch: 21, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.812 Vali Acc: 0.761 Test Loss: 0.812 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7942266464233398
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8430359363555908
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.835 Vali Acc: 0.772 Test Loss: 0.835 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7190084457397461
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.833 Vali Acc: 0.778 Test Loss: 0.833 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777769).  Saving model ...
Epoch: 25 cost time: 0.7207226753234863
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.838 Vali Acc: 0.761 Test Loss: 0.838 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7409889698028564
Epoch: 26, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.878 Vali Acc: 0.767 Test Loss: 0.878 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7737195491790771
Epoch: 27, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.864 Vali Acc: 0.772 Test Loss: 0.864 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7529361248016357
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.859 Vali Acc: 0.778 Test Loss: 0.859 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6907353401184082
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.948 Vali Acc: 0.761 Test Loss: 0.948 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7626087665557861
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.898 Vali Acc: 0.767 Test Loss: 0.898 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7682247161865234
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.916 Vali Acc: 0.767 Test Loss: 0.916 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.746457576751709
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.908 Vali Acc: 0.756 Test Loss: 0.908 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7799286842346191
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.962 Vali Acc: 0.767 Test Loss: 0.962 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8296966552734375
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.930 Vali Acc: 0.772 Test Loss: 0.930 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 293647
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9435691833496094
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.314 Vali Acc: 0.289 Test Loss: 2.314 Test Acc: 0.289
Validation loss decreased (inf --> -0.288866).  Saving model ...
Epoch: 2 cost time: 1.3059425354003906
Epoch: 2, Steps: 12 | Train Loss: 1.911 Vali Loss: 1.616 Vali Acc: 0.544 Test Loss: 1.616 Test Acc: 0.544
Validation loss decreased (-0.288866 --> -0.544428).  Saving model ...
Epoch: 3 cost time: 1.1969621181488037
Epoch: 3, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.351 Vali Acc: 0.611 Test Loss: 1.351 Test Acc: 0.611
Validation loss decreased (-0.544428 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 1.1371042728424072
Epoch: 4, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.297 Vali Acc: 0.611 Test Loss: 1.297 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 5 cost time: 1.2263588905334473
Epoch: 5, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.291 Vali Acc: 0.644 Test Loss: 1.291 Test Acc: 0.644
Validation loss decreased (-0.611098 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 1.4377307891845703
Epoch: 6, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.188 Vali Acc: 0.667 Test Loss: 1.188 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 1.4149553775787354
Epoch: 7, Steps: 12 | Train Loss: 0.572 Vali Loss: 1.154 Vali Acc: 0.689 Test Loss: 1.154 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688877).  Saving model ...
Epoch: 8 cost time: 1.471545696258545
Epoch: 8, Steps: 12 | Train Loss: 0.439 Vali Loss: 1.135 Vali Acc: 0.683 Test Loss: 1.135 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2050447463989258
Epoch: 9, Steps: 12 | Train Loss: 0.386 Vali Loss: 1.113 Vali Acc: 0.694 Test Loss: 1.113 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694433).  Saving model ...
Epoch: 10 cost time: 1.2971563339233398
Epoch: 10, Steps: 12 | Train Loss: 0.332 Vali Loss: 1.122 Vali Acc: 0.728 Test Loss: 1.122 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727767).  Saving model ...
Epoch: 11 cost time: 1.2773382663726807
Epoch: 11, Steps: 12 | Train Loss: 0.296 Vali Loss: 1.297 Vali Acc: 0.700 Test Loss: 1.297 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1043689250946045
Epoch: 12, Steps: 12 | Train Loss: 0.215 Vali Loss: 1.377 Vali Acc: 0.689 Test Loss: 1.377 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2164137363433838
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 1.313 Vali Acc: 0.722 Test Loss: 1.313 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0470376014709473
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.548 Vali Acc: 0.739 Test Loss: 1.548 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738873).  Saving model ...
Epoch: 15 cost time: 1.3419435024261475
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.448 Vali Acc: 0.728 Test Loss: 1.448 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2999005317687988
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.514 Vali Acc: 0.733 Test Loss: 1.514 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2647182941436768
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.554 Vali Acc: 0.733 Test Loss: 1.554 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2579233646392822
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.806 Vali Acc: 0.706 Test Loss: 1.806 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.368501901626587
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.580 Vali Acc: 0.756 Test Loss: 1.580 Test Acc: 0.756
Validation loss decreased (-0.738873 --> -0.755540).  Saving model ...
Epoch: 20 cost time: 1.281830072402954
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.868 Vali Acc: 0.711 Test Loss: 1.868 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2487618923187256
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.780 Vali Acc: 0.733 Test Loss: 1.780 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2200887203216553
Epoch: 22, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.866 Vali Acc: 0.756 Test Loss: 1.866 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0782976150512695
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.879 Vali Acc: 0.722 Test Loss: 1.879 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1562068462371826
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.817 Vali Acc: 0.739 Test Loss: 1.817 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9887382984161377
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.907 Vali Acc: 0.733 Test Loss: 1.907 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.074251651763916
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.893 Vali Acc: 0.767 Test Loss: 1.893 Test Acc: 0.767
Validation loss decreased (-0.755540 --> -0.766648).  Saving model ...
Epoch: 27 cost time: 0.73052978515625
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.880 Vali Acc: 0.767 Test Loss: 1.880 Test Acc: 0.767
Validation loss decreased (-0.766648 --> -0.766648).  Saving model ...
Epoch: 28 cost time: 1.162792682647705
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.897 Vali Acc: 0.756 Test Loss: 1.897 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2170352935791016
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.957 Vali Acc: 0.756 Test Loss: 1.957 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2662975788116455
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.991 Vali Acc: 0.744 Test Loss: 1.991 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1236004829406738
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.008 Vali Acc: 0.744 Test Loss: 2.008 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4069008827209473
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.986 Vali Acc: 0.756 Test Loss: 1.986 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.567728042602539
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.012 Vali Acc: 0.756 Test Loss: 2.012 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5586333274841309
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.038 Vali Acc: 0.744 Test Loss: 2.038 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4757204055786133
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 2.031 Vali Acc: 0.756 Test Loss: 2.031 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3446767330169678
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.012 Vali Acc: 0.756 Test Loss: 2.012 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.553682565689087
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.993 Vali Acc: 0.744 Test Loss: 1.993 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 372495
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4340434074401855
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.437 Vali Acc: 0.233 Test Loss: 2.437 Test Acc: 0.233
Validation loss decreased (inf --> -0.233309).  Saving model ...
Epoch: 2 cost time: 0.8831617832183838
Epoch: 2, Steps: 12 | Train Loss: 2.258 Vali Loss: 1.903 Vali Acc: 0.422 Test Loss: 1.903 Test Acc: 0.422
Validation loss decreased (-0.233309 --> -0.422203).  Saving model ...
Epoch: 3 cost time: 0.8918712139129639
Epoch: 3, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.532 Vali Acc: 0.539 Test Loss: 1.532 Test Acc: 0.539
Validation loss decreased (-0.422203 --> -0.538874).  Saving model ...
Epoch: 4 cost time: 0.8640644550323486
Epoch: 4, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.367 Vali Acc: 0.628 Test Loss: 1.367 Test Acc: 0.628
Validation loss decreased (-0.538874 --> -0.627764).  Saving model ...
Epoch: 5 cost time: 0.9319419860839844
Epoch: 5, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.198 Vali Acc: 0.656 Test Loss: 1.198 Test Acc: 0.656
Validation loss decreased (-0.627764 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 0.9442286491394043
Epoch: 6, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.134 Vali Acc: 0.667 Test Loss: 1.134 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 0.8100070953369141
Epoch: 7, Steps: 12 | Train Loss: 0.744 Vali Loss: 1.116 Vali Acc: 0.667 Test Loss: 1.116 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 0.8754169940948486
Epoch: 8, Steps: 12 | Train Loss: 0.595 Vali Loss: 1.103 Vali Acc: 0.700 Test Loss: 1.103 Test Acc: 0.700
Validation loss decreased (-0.666656 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.8917496204376221
Epoch: 9, Steps: 12 | Train Loss: 0.529 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
Validation loss decreased (-0.699989 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 0.9156405925750732
Epoch: 10, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.985 Vali Acc: 0.717 Test Loss: 0.985 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0096304416656494
Epoch: 11, Steps: 12 | Train Loss: 0.351 Vali Loss: 1.003 Vali Acc: 0.717 Test Loss: 1.003 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.96990966796875
Epoch: 12, Steps: 12 | Train Loss: 0.291 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.9056553840637207
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.054 Vali Acc: 0.711 Test Loss: 1.054 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9759702682495117
Epoch: 14, Steps: 12 | Train Loss: 0.268 Vali Loss: 1.075 Vali Acc: 0.750 Test Loss: 1.075 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.932032585144043
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.127 Vali Acc: 0.739 Test Loss: 1.127 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0246551036834717
Epoch: 16, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.130 Vali Acc: 0.728 Test Loss: 1.130 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8575422763824463
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.204 Vali Acc: 0.744 Test Loss: 1.204 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9080898761749268
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.202 Vali Acc: 0.756 Test Loss: 1.202 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755544).  Saving model ...
Epoch: 19 cost time: 0.9303104877471924
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.194 Vali Acc: 0.750 Test Loss: 1.194 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9020090103149414
Epoch: 20, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.259 Vali Acc: 0.750 Test Loss: 1.259 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9404661655426025
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.303 Vali Acc: 0.728 Test Loss: 1.303 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9088261127471924
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.334 Vali Acc: 0.767 Test Loss: 1.334 Test Acc: 0.767
Validation loss decreased (-0.755544 --> -0.766653).  Saving model ...
Epoch: 23 cost time: 0.9631388187408447
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.425 Vali Acc: 0.733 Test Loss: 1.425 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9626059532165527
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.353 Vali Acc: 0.767 Test Loss: 1.353 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9014699459075928
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.396 Vali Acc: 0.772 Test Loss: 1.396 Test Acc: 0.772
Validation loss decreased (-0.766653 --> -0.772208).  Saving model ...
Epoch: 26 cost time: 0.9573099613189697
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.430 Vali Acc: 0.772 Test Loss: 1.430 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9520366191864014
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.443 Vali Acc: 0.756 Test Loss: 1.443 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9011151790618896
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.440 Vali Acc: 0.761 Test Loss: 1.440 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1137771606445312
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.455 Vali Acc: 0.778 Test Loss: 1.455 Test Acc: 0.778
Validation loss decreased (-0.772208 --> -0.777763).  Saving model ...
Epoch: 30 cost time: 0.9661140441894531
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.532 Vali Acc: 0.756 Test Loss: 1.532 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0564005374908447
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.496 Vali Acc: 0.761 Test Loss: 1.496 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0574932098388672
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.497 Vali Acc: 0.761 Test Loss: 1.497 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0161073207855225
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.525 Vali Acc: 0.756 Test Loss: 1.525 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0607655048370361
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.545 Vali Acc: 0.756 Test Loss: 1.545 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.959606409072876
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.540 Vali Acc: 0.767 Test Loss: 1.540 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9763062000274658
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.532 Vali Acc: 0.772 Test Loss: 1.532 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9532349109649658
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.553 Vali Acc: 0.761 Test Loss: 1.553 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.132843255996704
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.582 Vali Acc: 0.756 Test Loss: 1.582 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0072963237762451
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.595 Vali Acc: 0.756 Test Loss: 1.595 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 288143
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.452354669570923
Epoch: 1, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.610 Vali Acc: 0.139 Test Loss: 2.610 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.9734001159667969
Epoch: 2, Steps: 12 | Train Loss: 2.294 Vali Loss: 2.045 Vali Acc: 0.389 Test Loss: 2.045 Test Acc: 0.389
Validation loss decreased (-0.138863 --> -0.388868).  Saving model ...
Epoch: 3 cost time: 1.0161314010620117
Epoch: 3, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.656 Vali Acc: 0.511 Test Loss: 1.656 Test Acc: 0.511
Validation loss decreased (-0.388868 --> -0.511095).  Saving model ...
Epoch: 4 cost time: 0.9668838977813721
Epoch: 4, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.420 Vali Acc: 0.567 Test Loss: 1.420 Test Acc: 0.567
Validation loss decreased (-0.511095 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 0.9440243244171143
Epoch: 5, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.338 Vali Acc: 0.600 Test Loss: 1.338 Test Acc: 0.600
Validation loss decreased (-0.566652 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 1.0366075038909912
Epoch: 6, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.266 Vali Acc: 0.628 Test Loss: 1.266 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 0.9807078838348389
Epoch: 7, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.228 Vali Acc: 0.650 Test Loss: 1.228 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 1.0355982780456543
Epoch: 8, Steps: 12 | Train Loss: 0.649 Vali Loss: 1.176 Vali Acc: 0.628 Test Loss: 1.176 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.064530372619629
Epoch: 9, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.088 Vali Acc: 0.678 Test Loss: 1.088 Test Acc: 0.678
Validation loss decreased (-0.649988 --> -0.677767).  Saving model ...
Epoch: 10 cost time: 0.9685735702514648
Epoch: 10, Steps: 12 | Train Loss: 0.454 Vali Loss: 1.080 Vali Acc: 0.689 Test Loss: 1.080 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688878).  Saving model ...
Epoch: 11 cost time: 0.9483699798583984
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 1.068 Vali Acc: 0.711 Test Loss: 1.068 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711100).  Saving model ...
Epoch: 12 cost time: 0.9107978343963623
Epoch: 12, Steps: 12 | Train Loss: 0.299 Vali Loss: 1.003 Vali Acc: 0.717 Test Loss: 1.003 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 0.9221899509429932
Epoch: 13, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.033 Vali Acc: 0.728 Test Loss: 1.033 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727767).  Saving model ...
Epoch: 14 cost time: 0.9132130146026611
Epoch: 14, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.060 Vali Acc: 0.728 Test Loss: 1.060 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9340980052947998
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.099 Vali Acc: 0.728 Test Loss: 1.099 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9721648693084717
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.106 Vali Acc: 0.756 Test Loss: 1.106 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755544).  Saving model ...
Epoch: 17 cost time: 0.9076192378997803
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.160 Vali Acc: 0.750 Test Loss: 1.160 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9628322124481201
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.159 Vali Acc: 0.761 Test Loss: 1.159 Test Acc: 0.761
Validation loss decreased (-0.755544 --> -0.761100).  Saving model ...
Epoch: 19 cost time: 0.9915127754211426
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.221 Vali Acc: 0.739 Test Loss: 1.221 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0176763534545898
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.185 Vali Acc: 0.744 Test Loss: 1.185 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9623086452484131
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.251 Vali Acc: 0.750 Test Loss: 1.251 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9636776447296143
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.317 Vali Acc: 0.728 Test Loss: 1.317 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.973336935043335
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.289 Vali Acc: 0.756 Test Loss: 1.289 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0451414585113525
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.296 Vali Acc: 0.756 Test Loss: 1.296 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0476179122924805
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.291 Vali Acc: 0.756 Test Loss: 1.291 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0081167221069336
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.385 Vali Acc: 0.744 Test Loss: 1.385 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.864112138748169
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.407 Vali Acc: 0.733 Test Loss: 1.407 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9760029315948486
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.363 Vali Acc: 0.783 Test Loss: 1.363 Test Acc: 0.783
Validation loss decreased (-0.761100 --> -0.783320).  Saving model ...
Epoch: 29 cost time: 0.9739260673522949
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.433 Vali Acc: 0.767 Test Loss: 1.433 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9361975193023682
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.439 Vali Acc: 0.789 Test Loss: 1.439 Test Acc: 0.789
Validation loss decreased (-0.783320 --> -0.788875).  Saving model ...
Epoch: 31 cost time: 0.9642376899719238
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.474 Vali Acc: 0.744 Test Loss: 1.474 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9078536033630371
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.391 Vali Acc: 0.783 Test Loss: 1.391 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9663355350494385
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.490 Vali Acc: 0.744 Test Loss: 1.490 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.984635591506958
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.485 Vali Acc: 0.783 Test Loss: 1.485 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.941472053527832
Epoch: 35, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.441 Vali Acc: 0.750 Test Loss: 1.441 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9784533977508545
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.489 Vali Acc: 0.733 Test Loss: 1.489 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9083878993988037
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.510 Vali Acc: 0.778 Test Loss: 1.510 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.950279951095581
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.551 Vali Acc: 0.772 Test Loss: 1.551 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9693827629089355
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.520 Vali Acc: 0.761 Test Loss: 1.520 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9063892364501953
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.539 Vali Acc: 0.767 Test Loss: 1.539 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 284431
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.362525224685669
Epoch: 1, Steps: 12 | Train Loss: 2.929 Vali Loss: 2.660 Vali Acc: 0.067 Test Loss: 2.660 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.8700158596038818
Epoch: 2, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.187 Vali Acc: 0.339 Test Loss: 2.187 Test Acc: 0.339
Validation loss decreased (-0.066640 --> -0.338867).  Saving model ...
Epoch: 3 cost time: 0.9758837223052979
Epoch: 3, Steps: 12 | Train Loss: 1.953 Vali Loss: 1.796 Vali Acc: 0.422 Test Loss: 1.796 Test Acc: 0.422
Validation loss decreased (-0.338867 --> -0.422204).  Saving model ...
Epoch: 4 cost time: 1.0275676250457764
Epoch: 4, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.543 Vali Acc: 0.550 Test Loss: 1.543 Test Acc: 0.550
Validation loss decreased (-0.422204 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 0.9138929843902588
Epoch: 5, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.401 Vali Acc: 0.561 Test Loss: 1.401 Test Acc: 0.561
Validation loss decreased (-0.549985 --> -0.561097).  Saving model ...
Epoch: 6 cost time: 0.9453375339508057
Epoch: 6, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.283 Vali Acc: 0.611 Test Loss: 1.283 Test Acc: 0.611
Validation loss decreased (-0.561097 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 0.9228127002716064
Epoch: 7, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.211 Vali Acc: 0.622 Test Loss: 1.211 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 8 cost time: 1.002974510192871
Epoch: 8, Steps: 12 | Train Loss: 0.745 Vali Loss: 1.166 Vali Acc: 0.617 Test Loss: 1.166 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9713690280914307
Epoch: 9, Steps: 12 | Train Loss: 0.627 Vali Loss: 1.137 Vali Acc: 0.672 Test Loss: 1.137 Test Acc: 0.672
Validation loss decreased (-0.622210 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 0.9126949310302734
Epoch: 10, Steps: 12 | Train Loss: 0.549 Vali Loss: 1.043 Vali Acc: 0.672 Test Loss: 1.043 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672212).  Saving model ...
Epoch: 11 cost time: 0.9431357383728027
Epoch: 11, Steps: 12 | Train Loss: 0.503 Vali Loss: 1.019 Vali Acc: 0.678 Test Loss: 1.019 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 12 cost time: 0.9670407772064209
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.974 Vali Acc: 0.722 Test Loss: 0.974 Test Acc: 0.722
Validation loss decreased (-0.677768 --> -0.722212).  Saving model ...
Epoch: 13 cost time: 0.9256300926208496
Epoch: 13, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.933 Vali Acc: 0.739 Test Loss: 0.933 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738880).  Saving model ...
Epoch: 14 cost time: 0.9130513668060303
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.910 Vali Acc: 0.756 Test Loss: 0.910 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 0.9534037113189697
Epoch: 15, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9632472991943359
Epoch: 16, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.922 Vali Acc: 0.767 Test Loss: 0.922 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766657).  Saving model ...
Epoch: 17 cost time: 0.925013542175293
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.956 Vali Acc: 0.767 Test Loss: 0.956 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0787672996520996
Epoch: 18, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.930 Vali Acc: 0.767 Test Loss: 0.930 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.067779779434204
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.980 Vali Acc: 0.800 Test Loss: 0.980 Test Acc: 0.800
Validation loss decreased (-0.766657 --> -0.799990).  Saving model ...
Epoch: 20 cost time: 1.027735710144043
Epoch: 20, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.001 Vali Acc: 0.761 Test Loss: 1.001 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9737288951873779
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.029 Vali Acc: 0.783 Test Loss: 1.029 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0029876232147217
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.045 Vali Acc: 0.744 Test Loss: 1.045 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9803793430328369
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.994 Vali Acc: 0.811 Test Loss: 0.994 Test Acc: 0.811
Validation loss decreased (-0.799990 --> -0.811101).  Saving model ...
Epoch: 24 cost time: 1.0368762016296387
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.122 Vali Acc: 0.761 Test Loss: 1.122 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9432384967803955
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.066 Vali Acc: 0.806 Test Loss: 1.066 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0204551219940186
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.119 Vali Acc: 0.783 Test Loss: 1.119 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9608101844787598
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.097 Vali Acc: 0.794 Test Loss: 1.097 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.901146411895752
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.143 Vali Acc: 0.789 Test Loss: 1.143 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.914522647857666
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.149 Vali Acc: 0.783 Test Loss: 1.149 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8962147235870361
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.108 Vali Acc: 0.789 Test Loss: 1.108 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9661118984222412
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.122 Vali Acc: 0.800 Test Loss: 1.122 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0007610321044922
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.178 Vali Acc: 0.783 Test Loss: 1.178 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0341148376464844
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.142 Vali Acc: 0.789 Test Loss: 1.142 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 257679
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.59907603263855
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.672 Vali Acc: 0.078 Test Loss: 2.672 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 1.0470974445343018
Epoch: 2, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.265 Vali Acc: 0.328 Test Loss: 2.265 Test Acc: 0.328
Validation loss decreased (-0.077751 --> -0.327755).  Saving model ...
Epoch: 3 cost time: 0.950721025466919
Epoch: 3, Steps: 12 | Train Loss: 2.017 Vali Loss: 1.896 Vali Acc: 0.511 Test Loss: 1.896 Test Acc: 0.511
Validation loss decreased (-0.327755 --> -0.511092).  Saving model ...
Epoch: 4 cost time: 1.018733263015747
Epoch: 4, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.641 Vali Acc: 0.578 Test Loss: 1.641 Test Acc: 0.578
Validation loss decreased (-0.511092 --> -0.577761).  Saving model ...
Epoch: 5 cost time: 0.9346222877502441
Epoch: 5, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.481 Vali Acc: 0.544 Test Loss: 1.481 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.863654613494873
Epoch: 6, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.387 Vali Acc: 0.578 Test Loss: 1.387 Test Acc: 0.578
Validation loss decreased (-0.577761 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 0.8955175876617432
Epoch: 7, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.271 Vali Acc: 0.633 Test Loss: 1.271 Test Acc: 0.633
Validation loss decreased (-0.577764 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 1.0244417190551758
Epoch: 8, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.176 Vali Acc: 0.656 Test Loss: 1.176 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 1.0303983688354492
Epoch: 9, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.125 Vali Acc: 0.661 Test Loss: 1.125 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 10 cost time: 0.9229795932769775
Epoch: 10, Steps: 12 | Train Loss: 0.637 Vali Loss: 1.052 Vali Acc: 0.672 Test Loss: 1.052 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 11 cost time: 0.9952962398529053
Epoch: 11, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.992 Vali Acc: 0.722 Test Loss: 0.992 Test Acc: 0.722
Validation loss decreased (-0.672212 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 0.9497921466827393
Epoch: 12, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.978 Vali Acc: 0.694 Test Loss: 0.978 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.907315731048584
Epoch: 13, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.913 Vali Acc: 0.728 Test Loss: 0.913 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 14 cost time: 0.9211225509643555
Epoch: 14, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.846 Vali Acc: 0.761 Test Loss: 0.846 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 1.085211992263794
Epoch: 15, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.855 Vali Acc: 0.772 Test Loss: 0.855 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 16 cost time: 0.9683101177215576
Epoch: 16, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.866 Vali Acc: 0.756 Test Loss: 0.866 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9718406200408936
Epoch: 17, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.841 Vali Acc: 0.761 Test Loss: 0.841 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.050976037979126
Epoch: 18, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0306808948516846
Epoch: 19, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.883 Vali Acc: 0.767 Test Loss: 0.883 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.101464033126831
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.078526496887207
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.853 Vali Acc: 0.772 Test Loss: 0.853 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 22 cost time: 0.9852461814880371
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.039902925491333
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.899 Vali Acc: 0.767 Test Loss: 0.899 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0175879001617432
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.905 Vali Acc: 0.767 Test Loss: 0.905 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0091438293457031
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.895 Vali Acc: 0.767 Test Loss: 0.895 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0199551582336426
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.951 Vali Acc: 0.778 Test Loss: 0.951 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777768).  Saving model ...
Epoch: 27 cost time: 1.010669231414795
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.964 Vali Acc: 0.794 Test Loss: 0.964 Test Acc: 0.794
Validation loss decreased (-0.777768 --> -0.794435).  Saving model ...
Epoch: 28 cost time: 0.9772138595581055
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.980 Vali Acc: 0.778 Test Loss: 0.980 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0107812881469727
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.999 Vali Acc: 0.778 Test Loss: 0.999 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9667799472808838
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.010 Vali Acc: 0.772 Test Loss: 1.010 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9678869247436523
Epoch: 31, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.982 Vali Acc: 0.794 Test Loss: 0.982 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9505047798156738
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.993 Vali Acc: 0.794 Test Loss: 0.993 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9055500030517578
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.027 Vali Acc: 0.783 Test Loss: 1.027 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.877927303314209
Epoch: 34, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.047 Vali Acc: 0.794 Test Loss: 1.047 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9108777046203613
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.102 Vali Acc: 0.783 Test Loss: 1.102 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9087655544281006
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.070 Vali Acc: 0.783 Test Loss: 1.070 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9813685417175293
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.080 Vali Acc: 0.778 Test Loss: 1.080 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 242575
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7864508628845215
Epoch: 1, Steps: 12 | Train Loss: 2.886 Vali Loss: 2.709 Vali Acc: 0.128 Test Loss: 2.709 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.9603731632232666
Epoch: 2, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.342 Vali Acc: 0.272 Test Loss: 2.342 Test Acc: 0.272
Validation loss decreased (-0.127751 --> -0.272199).  Saving model ...
Epoch: 3 cost time: 0.9922072887420654
Epoch: 3, Steps: 12 | Train Loss: 2.266 Vali Loss: 1.988 Vali Acc: 0.439 Test Loss: 1.988 Test Acc: 0.439
Validation loss decreased (-0.272199 --> -0.438869).  Saving model ...
Epoch: 4 cost time: 1.001265287399292
Epoch: 4, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.722 Vali Acc: 0.494 Test Loss: 1.722 Test Acc: 0.494
Validation loss decreased (-0.438869 --> -0.494427).  Saving model ...
Epoch: 5 cost time: 0.8526589870452881
Epoch: 5, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.516 Vali Acc: 0.561 Test Loss: 1.516 Test Acc: 0.561
Validation loss decreased (-0.494427 --> -0.561096).  Saving model ...
Epoch: 6 cost time: 0.8947584629058838
Epoch: 6, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.401 Vali Acc: 0.600 Test Loss: 1.401 Test Acc: 0.600
Validation loss decreased (-0.561096 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 0.9717652797698975
Epoch: 7, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.273 Vali Acc: 0.633 Test Loss: 1.273 Test Acc: 0.633
Validation loss decreased (-0.599986 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 0.8635456562042236
Epoch: 8, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.182 Vali Acc: 0.661 Test Loss: 1.182 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 0.9138052463531494
Epoch: 9, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 0.8305246829986572
Epoch: 10, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.040 Vali Acc: 0.683 Test Loss: 1.040 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 0.9269311428070068
Epoch: 11, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.990 Vali Acc: 0.689 Test Loss: 0.990 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 12 cost time: 0.8791272640228271
Epoch: 12, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.898 Vali Acc: 0.717 Test Loss: 0.898 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716658).  Saving model ...
Epoch: 13 cost time: 0.9730737209320068
Epoch: 13, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.845 Vali Acc: 0.744 Test Loss: 0.845 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744436).  Saving model ...
Epoch: 14 cost time: 1.015758991241455
Epoch: 14, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.831 Vali Acc: 0.733 Test Loss: 0.831 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.935521125793457
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 0.9300050735473633
Epoch: 16, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9232087135314941
Epoch: 17, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.779 Vali Acc: 0.783 Test Loss: 0.779 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 18 cost time: 1.005007028579712
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9953763484954834
Epoch: 19, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9270467758178711
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.800 Vali Acc: 0.772 Test Loss: 0.800 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.980201244354248
Epoch: 21, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.868 Vali Acc: 0.739 Test Loss: 0.868 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9668121337890625
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.807 Vali Acc: 0.772 Test Loss: 0.807 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.928581714630127
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.809 Vali Acc: 0.772 Test Loss: 0.809 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9962708950042725
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.841 Vali Acc: 0.767 Test Loss: 0.841 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9941811561584473
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.862 Vali Acc: 0.772 Test Loss: 0.862 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.008831262588501
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0546655654907227
Epoch: 27, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.899 Vali Acc: 0.744 Test Loss: 0.899 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 235151
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3540282249450684
Epoch: 1, Steps: 12 | Train Loss: 2.929 Vali Loss: 2.769 Vali Acc: 0.100 Test Loss: 2.769 Test Acc: 0.100
Validation loss decreased (inf --> -0.099972).  Saving model ...
Epoch: 2 cost time: 0.9286918640136719
Epoch: 2, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.453 Vali Acc: 0.244 Test Loss: 2.453 Test Acc: 0.244
Validation loss decreased (-0.099972 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 0.9376621246337891
Epoch: 3, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.115 Vali Acc: 0.389 Test Loss: 2.115 Test Acc: 0.389
Validation loss decreased (-0.244420 --> -0.388868).  Saving model ...
Epoch: 4 cost time: 0.8877503871917725
Epoch: 4, Steps: 12 | Train Loss: 1.935 Vali Loss: 1.837 Vali Acc: 0.456 Test Loss: 1.837 Test Acc: 0.456
Validation loss decreased (-0.388868 --> -0.455537).  Saving model ...
Epoch: 5 cost time: 0.8818113803863525
Epoch: 5, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.652 Vali Acc: 0.522 Test Loss: 1.652 Test Acc: 0.522
Validation loss decreased (-0.455537 --> -0.522206).  Saving model ...
Epoch: 6 cost time: 0.84157395362854
Epoch: 6, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.491 Vali Acc: 0.544 Test Loss: 1.491 Test Acc: 0.544
Validation loss decreased (-0.522206 --> -0.544430).  Saving model ...
Epoch: 7 cost time: 0.9343435764312744
Epoch: 7, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.351 Vali Acc: 0.611 Test Loss: 1.351 Test Acc: 0.611
Validation loss decreased (-0.544430 --> -0.611098).  Saving model ...
Epoch: 8 cost time: 0.9247961044311523
Epoch: 8, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.240 Vali Acc: 0.628 Test Loss: 1.240 Test Acc: 0.628
Validation loss decreased (-0.611098 --> -0.627765).  Saving model ...
Epoch: 9 cost time: 0.9591307640075684
Epoch: 9, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.123 Vali Acc: 0.633 Test Loss: 1.123 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633322).  Saving model ...
Epoch: 10 cost time: 1.066157341003418
Epoch: 10, Steps: 12 | Train Loss: 0.737 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
Validation loss decreased (-0.633322 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.9836914539337158
Epoch: 11, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.9700019359588623
Epoch: 12, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.969 Vali Acc: 0.661 Test Loss: 0.969 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661101).  Saving model ...
Epoch: 13 cost time: 1.0305380821228027
Epoch: 13, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.892 Vali Acc: 0.706 Test Loss: 0.892 Test Acc: 0.706
Validation loss decreased (-0.661101 --> -0.705547).  Saving model ...
Epoch: 14 cost time: 0.9544734954833984
Epoch: 14, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.878 Vali Acc: 0.717 Test Loss: 0.878 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716658).  Saving model ...
Epoch: 15 cost time: 0.9491803646087646
Epoch: 15, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.832 Vali Acc: 0.717 Test Loss: 0.832 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 16 cost time: 0.9964442253112793
Epoch: 16, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.840 Vali Acc: 0.744 Test Loss: 0.840 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 0.9524712562561035
Epoch: 17, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9760942459106445
Epoch: 18, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.788 Vali Acc: 0.733 Test Loss: 0.788 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9180507659912109
Epoch: 19, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.837 Vali Acc: 0.744 Test Loss: 0.837 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 20 cost time: 0.9800169467926025
Epoch: 20, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.825 Vali Acc: 0.772 Test Loss: 0.825 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772214).  Saving model ...
Epoch: 21 cost time: 0.9453144073486328
Epoch: 21, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.833 Vali Acc: 0.761 Test Loss: 0.833 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9413104057312012
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.827 Vali Acc: 0.778 Test Loss: 0.827 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 1.0162725448608398
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.818 Vali Acc: 0.756 Test Loss: 0.818 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9756345748901367
Epoch: 24, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.847 Vali Acc: 0.761 Test Loss: 0.847 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.059809923171997
Epoch: 25, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.843 Vali Acc: 0.756 Test Loss: 0.843 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0195257663726807
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9681887626647949
Epoch: 27, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0107872486114502
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.841 Vali Acc: 0.756 Test Loss: 0.841 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0882647037506104
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9951860904693604
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.892 Vali Acc: 0.767 Test Loss: 0.892 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9342246055603027
Epoch: 31, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.922 Vali Acc: 0.761 Test Loss: 0.922 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9773769378662109
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.925 Vali Acc: 0.772 Test Loss: 0.925 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 227855
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.084092617034912
Epoch: 1, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.319 Vali Acc: 0.306 Test Loss: 2.319 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 1.5976829528808594
Epoch: 2, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.635 Vali Acc: 0.539 Test Loss: 1.635 Test Acc: 0.539
Validation loss decreased (-0.305532 --> -0.538873).  Saving model ...
Epoch: 3 cost time: 1.3245677947998047
Epoch: 3, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.358 Vali Acc: 0.611 Test Loss: 1.358 Test Acc: 0.611
Validation loss decreased (-0.538873 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 1.4888432025909424
Epoch: 4, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.324 Vali Acc: 0.622 Test Loss: 1.324 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 5 cost time: 1.5845417976379395
Epoch: 5, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.247 Vali Acc: 0.628 Test Loss: 1.247 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 6 cost time: 1.2516098022460938
Epoch: 6, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.170 Vali Acc: 0.672 Test Loss: 1.170 Test Acc: 0.672
Validation loss decreased (-0.627765 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 1.3235750198364258
Epoch: 7, Steps: 12 | Train Loss: 0.521 Vali Loss: 1.249 Vali Acc: 0.656 Test Loss: 1.249 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3440616130828857
Epoch: 8, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.108 Vali Acc: 0.689 Test Loss: 1.108 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 1.5076391696929932
Epoch: 9, Steps: 12 | Train Loss: 0.389 Vali Loss: 1.149 Vali Acc: 0.706 Test Loss: 1.149 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705544).  Saving model ...
Epoch: 10 cost time: 1.5039241313934326
Epoch: 10, Steps: 12 | Train Loss: 0.340 Vali Loss: 1.151 Vali Acc: 0.706 Test Loss: 1.151 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4752390384674072
Epoch: 11, Steps: 12 | Train Loss: 0.284 Vali Loss: 1.183 Vali Acc: 0.711 Test Loss: 1.183 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711099).  Saving model ...
Epoch: 12 cost time: 1.55275297164917
Epoch: 12, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.242 Vali Acc: 0.722 Test Loss: 1.242 Test Acc: 0.722
Validation loss decreased (-0.711099 --> -0.722210).  Saving model ...
Epoch: 13 cost time: 1.3864006996154785
Epoch: 13, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.404 Vali Acc: 0.728 Test Loss: 1.404 Test Acc: 0.728
Validation loss decreased (-0.722210 --> -0.727764).  Saving model ...
Epoch: 14 cost time: 1.5284991264343262
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.307 Vali Acc: 0.728 Test Loss: 1.307 Test Acc: 0.728
Validation loss decreased (-0.727764 --> -0.727765).  Saving model ...
Epoch: 15 cost time: 1.4679813385009766
Epoch: 15, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.402 Vali Acc: 0.733 Test Loss: 1.402 Test Acc: 0.733
Validation loss decreased (-0.727765 --> -0.733319).  Saving model ...
Epoch: 16 cost time: 1.5083649158477783
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.500 Vali Acc: 0.744 Test Loss: 1.500 Test Acc: 0.744
Validation loss decreased (-0.733319 --> -0.744429).  Saving model ...
Epoch: 17 cost time: 1.5650815963745117
Epoch: 17, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.643 Vali Acc: 0.694 Test Loss: 1.643 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5151021480560303
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.612 Vali Acc: 0.750 Test Loss: 1.612 Test Acc: 0.750
Validation loss decreased (-0.744429 --> -0.749984).  Saving model ...
Epoch: 19 cost time: 1.1245148181915283
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.723 Vali Acc: 0.706 Test Loss: 1.723 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1688826084136963
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.841 Vali Acc: 0.728 Test Loss: 1.841 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1652376651763916
Epoch: 21, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.745 Vali Acc: 0.711 Test Loss: 1.745 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3498132228851318
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.958 Vali Acc: 0.706 Test Loss: 1.958 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.334505319595337
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.856 Vali Acc: 0.733 Test Loss: 1.856 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4702956676483154
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 2.059 Vali Acc: 0.739 Test Loss: 2.059 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4985921382904053
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 2.111 Vali Acc: 0.717 Test Loss: 2.111 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.476536512374878
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.980 Vali Acc: 0.739 Test Loss: 1.980 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3452832698822021
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 2.037 Vali Acc: 0.772 Test Loss: 2.037 Test Acc: 0.772
Validation loss decreased (-0.749984 --> -0.772202).  Saving model ...
Epoch: 28 cost time: 1.4364659786224365
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 2.139 Vali Acc: 0.728 Test Loss: 2.139 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3711063861846924
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 2.231 Vali Acc: 0.717 Test Loss: 2.231 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4489777088165283
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 2.068 Vali Acc: 0.739 Test Loss: 2.068 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5675811767578125
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 2.098 Vali Acc: 0.756 Test Loss: 2.098 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4704105854034424
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.187 Vali Acc: 0.744 Test Loss: 2.187 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5946295261383057
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 2.160 Vali Acc: 0.750 Test Loss: 2.160 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5790655612945557
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 2.186 Vali Acc: 0.767 Test Loss: 2.186 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4435052871704102
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 2.162 Vali Acc: 0.767 Test Loss: 2.162 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4828104972839355
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 2.157 Vali Acc: 0.767 Test Loss: 2.157 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4763760566711426
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 2.155 Vali Acc: 0.767 Test Loss: 2.155 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 339599
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5019688606262207
Epoch: 1, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.412 Vali Acc: 0.217 Test Loss: 2.412 Test Acc: 0.217
Validation loss decreased (inf --> -0.216643).  Saving model ...
Epoch: 2 cost time: 0.8684852123260498
Epoch: 2, Steps: 12 | Train Loss: 2.222 Vali Loss: 1.916 Vali Acc: 0.422 Test Loss: 1.916 Test Acc: 0.422
Validation loss decreased (-0.216643 --> -0.422203).  Saving model ...
Epoch: 3 cost time: 1.0520200729370117
Epoch: 3, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.619 Vali Acc: 0.500 Test Loss: 1.619 Test Acc: 0.500
Validation loss decreased (-0.422203 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 1.0233936309814453
Epoch: 4, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.429 Vali Acc: 0.567 Test Loss: 1.429 Test Acc: 0.567
Validation loss decreased (-0.499984 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 0.9395439624786377
Epoch: 5, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.307 Vali Acc: 0.600 Test Loss: 1.307 Test Acc: 0.600
Validation loss decreased (-0.566652 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 0.969510555267334
Epoch: 6, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.253 Vali Acc: 0.644 Test Loss: 1.253 Test Acc: 0.644
Validation loss decreased (-0.599987 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 0.9205009937286377
Epoch: 7, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.173 Vali Acc: 0.661 Test Loss: 1.173 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 8 cost time: 0.968442440032959
Epoch: 8, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.145 Vali Acc: 0.656 Test Loss: 1.145 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8439021110534668
Epoch: 9, Steps: 12 | Train Loss: 0.526 Vali Loss: 1.079 Vali Acc: 0.689 Test Loss: 1.079 Test Acc: 0.689
Validation loss decreased (-0.661099 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 0.9104876518249512
Epoch: 10, Steps: 12 | Train Loss: 0.460 Vali Loss: 1.041 Vali Acc: 0.717 Test Loss: 1.041 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716656).  Saving model ...
Epoch: 11 cost time: 0.9663448333740234
Epoch: 11, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.999 Vali Acc: 0.733 Test Loss: 0.999 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 0.9859347343444824
Epoch: 12, Steps: 12 | Train Loss: 0.288 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.934983491897583
Epoch: 13, Steps: 12 | Train Loss: 0.293 Vali Loss: 1.025 Vali Acc: 0.739 Test Loss: 1.025 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 14 cost time: 0.959108829498291
Epoch: 14, Steps: 12 | Train Loss: 0.207 Vali Loss: 1.090 Vali Acc: 0.739 Test Loss: 1.090 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9102323055267334
Epoch: 15, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.153 Vali Acc: 0.689 Test Loss: 1.153 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9490277767181396
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.106 Vali Acc: 0.739 Test Loss: 1.106 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8989763259887695
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.133 Vali Acc: 0.739 Test Loss: 1.133 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9618964195251465
Epoch: 18, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.209 Vali Acc: 0.733 Test Loss: 1.209 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9992921352386475
Epoch: 19, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.237 Vali Acc: 0.739 Test Loss: 1.237 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9451768398284912
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.288 Vali Acc: 0.750 Test Loss: 1.288 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749987).  Saving model ...
Epoch: 21 cost time: 1.0251820087432861
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.298 Vali Acc: 0.744 Test Loss: 1.298 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9891548156738281
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.415 Vali Acc: 0.733 Test Loss: 1.415 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9792940616607666
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.341 Vali Acc: 0.744 Test Loss: 1.341 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8347342014312744
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.328 Vali Acc: 0.756 Test Loss: 1.328 Test Acc: 0.756
Validation loss decreased (-0.749987 --> -0.755542).  Saving model ...
Epoch: 25 cost time: 0.927607536315918
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.376 Vali Acc: 0.750 Test Loss: 1.376 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9611630439758301
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.423 Vali Acc: 0.733 Test Loss: 1.423 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0096023082733154
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.414 Vali Acc: 0.744 Test Loss: 1.414 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9904167652130127
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.391 Vali Acc: 0.750 Test Loss: 1.391 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8946776390075684
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.427 Vali Acc: 0.761 Test Loss: 1.427 Test Acc: 0.761
Validation loss decreased (-0.755542 --> -0.761097).  Saving model ...
Epoch: 30 cost time: 0.9412369728088379
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.454 Vali Acc: 0.761 Test Loss: 1.454 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8668398857116699
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.497 Vali Acc: 0.750 Test Loss: 1.497 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9534664154052734
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.504 Vali Acc: 0.744 Test Loss: 1.504 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8776724338531494
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.484 Vali Acc: 0.744 Test Loss: 1.484 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9706056118011475
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.515 Vali Acc: 0.756 Test Loss: 1.515 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9616236686706543
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.532 Vali Acc: 0.744 Test Loss: 1.532 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8745725154876709
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.517 Vali Acc: 0.756 Test Loss: 1.517 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9250836372375488
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.539 Vali Acc: 0.761 Test Loss: 1.539 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8472821712493896
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.540 Vali Acc: 0.761 Test Loss: 1.540 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9973018169403076
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.542 Vali Acc: 0.744 Test Loss: 1.542 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 255247
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4229683876037598
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.484 Vali Acc: 0.244 Test Loss: 2.484 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 0.8992481231689453
Epoch: 2, Steps: 12 | Train Loss: 2.246 Vali Loss: 1.972 Vali Acc: 0.456 Test Loss: 1.972 Test Acc: 0.456
Validation loss decreased (-0.244420 --> -0.455536).  Saving model ...
Epoch: 3 cost time: 0.8137307167053223
Epoch: 3, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.626 Vali Acc: 0.544 Test Loss: 1.626 Test Acc: 0.544
Validation loss decreased (-0.455536 --> -0.544428).  Saving model ...
Epoch: 4 cost time: 0.902167558670044
Epoch: 4, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.463 Vali Acc: 0.550 Test Loss: 1.463 Test Acc: 0.550
Validation loss decreased (-0.544428 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 0.8139784336090088
Epoch: 5, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.343 Vali Acc: 0.572 Test Loss: 1.343 Test Acc: 0.572
Validation loss decreased (-0.549985 --> -0.572209).  Saving model ...
Epoch: 6 cost time: 0.8902294635772705
Epoch: 6, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.296 Vali Acc: 0.617 Test Loss: 1.296 Test Acc: 0.617
Validation loss decreased (-0.572209 --> -0.616654).  Saving model ...
Epoch: 7 cost time: 0.9336283206939697
Epoch: 7, Steps: 12 | Train Loss: 0.745 Vali Loss: 1.255 Vali Acc: 0.644 Test Loss: 1.255 Test Acc: 0.644
Validation loss decreased (-0.616654 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.9204142093658447
Epoch: 8, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.138 Vali Acc: 0.672 Test Loss: 1.138 Test Acc: 0.672
Validation loss decreased (-0.644432 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 0.9634640216827393
Epoch: 9, Steps: 12 | Train Loss: 0.599 Vali Loss: 1.132 Vali Acc: 0.656 Test Loss: 1.132 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.83612060546875
Epoch: 10, Steps: 12 | Train Loss: 0.487 Vali Loss: 1.033 Vali Acc: 0.717 Test Loss: 1.033 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716656).  Saving model ...
Epoch: 11 cost time: 0.8791499137878418
Epoch: 11, Steps: 12 | Train Loss: 0.404 Vali Loss: 1.051 Vali Acc: 0.717 Test Loss: 1.051 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8624258041381836
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 1.029 Vali Acc: 0.728 Test Loss: 1.029 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727767).  Saving model ...
Epoch: 13 cost time: 0.8460297584533691
Epoch: 13, Steps: 12 | Train Loss: 0.283 Vali Loss: 1.006 Vali Acc: 0.728 Test Loss: 1.006 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 14 cost time: 1.022996425628662
Epoch: 14, Steps: 12 | Train Loss: 0.239 Vali Loss: 1.012 Vali Acc: 0.739 Test Loss: 1.012 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.8383841514587402
Epoch: 15, Steps: 12 | Train Loss: 0.191 Vali Loss: 1.086 Vali Acc: 0.711 Test Loss: 1.086 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8850839138031006
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.021 Vali Acc: 0.750 Test Loss: 1.021 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.957348108291626
Epoch: 17, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.195 Vali Acc: 0.722 Test Loss: 1.195 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9327297210693359
Epoch: 18, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.058 Vali Acc: 0.744 Test Loss: 1.058 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9004848003387451
Epoch: 19, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.147 Vali Acc: 0.722 Test Loss: 1.147 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.934788703918457
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.156 Vali Acc: 0.783 Test Loss: 1.156 Test Acc: 0.783
Validation loss decreased (-0.749990 --> -0.783322).  Saving model ...
Epoch: 21 cost time: 1.0113005638122559
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.238 Vali Acc: 0.750 Test Loss: 1.238 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9959959983825684
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.168 Vali Acc: 0.778 Test Loss: 1.168 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0513339042663574
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.207 Vali Acc: 0.761 Test Loss: 1.207 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9877641201019287
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.274 Vali Acc: 0.750 Test Loss: 1.274 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9237051010131836
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.236 Vali Acc: 0.767 Test Loss: 1.236 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9906063079833984
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.303 Vali Acc: 0.739 Test Loss: 1.303 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9592139720916748
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.290 Vali Acc: 0.761 Test Loss: 1.290 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9207518100738525
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.310 Vali Acc: 0.778 Test Loss: 1.310 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9561715126037598
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.353 Vali Acc: 0.772 Test Loss: 1.353 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9409675598144531
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.322 Vali Acc: 0.794 Test Loss: 1.322 Test Acc: 0.794
Validation loss decreased (-0.783322 --> -0.794431).  Saving model ...
Epoch: 31 cost time: 0.8915414810180664
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.357 Vali Acc: 0.794 Test Loss: 1.357 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8673198223114014
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.423 Vali Acc: 0.772 Test Loss: 1.423 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9631979465484619
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.411 Vali Acc: 0.772 Test Loss: 1.411 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8832736015319824
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.420 Vali Acc: 0.772 Test Loss: 1.420 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0141792297363281
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.458 Vali Acc: 0.772 Test Loss: 1.458 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8263406753540039
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.464 Vali Acc: 0.767 Test Loss: 1.464 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8683526515960693
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.480 Vali Acc: 0.767 Test Loss: 1.480 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8762023448944092
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.478 Vali Acc: 0.767 Test Loss: 1.478 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8786923885345459
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.510 Vali Acc: 0.778 Test Loss: 1.510 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8653864860534668
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.500 Vali Acc: 0.778 Test Loss: 1.500 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 251535
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4451067447662354
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.497 Vali Acc: 0.200 Test Loss: 2.497 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 0.8632521629333496
Epoch: 2, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.063 Vali Acc: 0.456 Test Loss: 2.063 Test Acc: 0.456
Validation loss decreased (-0.199975 --> -0.455535).  Saving model ...
Epoch: 3 cost time: 0.8924634456634521
Epoch: 3, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.713 Vali Acc: 0.528 Test Loss: 1.713 Test Acc: 0.528
Validation loss decreased (-0.455535 --> -0.527761).  Saving model ...
Epoch: 4 cost time: 0.8767623901367188
Epoch: 4, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.505 Vali Acc: 0.561 Test Loss: 1.505 Test Acc: 0.561
Validation loss decreased (-0.527761 --> -0.561096).  Saving model ...
Epoch: 5 cost time: 0.8195641040802002
Epoch: 5, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.366 Vali Acc: 0.594 Test Loss: 1.366 Test Acc: 0.594
Validation loss decreased (-0.561096 --> -0.594431).  Saving model ...
Epoch: 6 cost time: 0.922553300857544
Epoch: 6, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.278 Vali Acc: 0.644 Test Loss: 1.278 Test Acc: 0.644
Validation loss decreased (-0.594431 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 0.9224324226379395
Epoch: 7, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.201 Vali Acc: 0.661 Test Loss: 1.201 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 8 cost time: 0.7718327045440674
Epoch: 8, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.133 Vali Acc: 0.683 Test Loss: 1.133 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683322).  Saving model ...
Epoch: 9 cost time: 0.9186456203460693
Epoch: 9, Steps: 12 | Train Loss: 0.622 Vali Loss: 1.074 Vali Acc: 0.678 Test Loss: 1.074 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8851966857910156
Epoch: 10, Steps: 12 | Train Loss: 0.557 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 0.817795991897583
Epoch: 11, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.961 Vali Acc: 0.744 Test Loss: 0.961 Test Acc: 0.744
Validation loss decreased (-0.699990 --> -0.744435).  Saving model ...
Epoch: 12 cost time: 0.8520364761352539
Epoch: 12, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.965 Vali Acc: 0.767 Test Loss: 0.965 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766657).  Saving model ...
Epoch: 13 cost time: 0.9041404724121094
Epoch: 13, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.947 Vali Acc: 0.772 Test Loss: 0.947 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772213).  Saving model ...
Epoch: 14 cost time: 0.862004280090332
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8620510101318359
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.944 Vali Acc: 0.761 Test Loss: 0.944 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9420592784881592
Epoch: 16, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.936 Vali Acc: 0.778 Test Loss: 0.936 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777768).  Saving model ...
Epoch: 17 cost time: 0.9164714813232422
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.973 Vali Acc: 0.767 Test Loss: 0.973 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9173736572265625
Epoch: 18, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.980 Vali Acc: 0.739 Test Loss: 0.980 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8627779483795166
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.994 Vali Acc: 0.783 Test Loss: 0.994 Test Acc: 0.783
Validation loss decreased (-0.777768 --> -0.783323).  Saving model ...
Epoch: 20 cost time: 0.8657629489898682
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.012 Vali Acc: 0.778 Test Loss: 1.012 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9223184585571289
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.021 Vali Acc: 0.761 Test Loss: 1.021 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8975942134857178
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.119 Vali Acc: 0.750 Test Loss: 1.119 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9081878662109375
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.083 Vali Acc: 0.772 Test Loss: 1.083 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8266992568969727
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.074 Vali Acc: 0.761 Test Loss: 1.074 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8606791496276855
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.075 Vali Acc: 0.767 Test Loss: 1.075 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8671095371246338
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.134 Vali Acc: 0.767 Test Loss: 1.134 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9657070636749268
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.093 Vali Acc: 0.778 Test Loss: 1.093 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8327248096466064
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.163 Vali Acc: 0.772 Test Loss: 1.163 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8520839214324951
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.130 Vali Acc: 0.783 Test Loss: 1.130 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 224783
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.363168716430664
Epoch: 1, Steps: 12 | Train Loss: 2.862 Vali Loss: 2.693 Vali Acc: 0.194 Test Loss: 2.693 Test Acc: 0.194
Validation loss decreased (inf --> -0.194418).  Saving model ...
Epoch: 2 cost time: 0.8580992221832275
Epoch: 2, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.273 Vali Acc: 0.361 Test Loss: 2.273 Test Acc: 0.361
Validation loss decreased (-0.194418 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 0.9039232730865479
Epoch: 3, Steps: 12 | Train Loss: 2.098 Vali Loss: 1.910 Vali Acc: 0.506 Test Loss: 1.910 Test Acc: 0.506
Validation loss decreased (-0.361088 --> -0.505536).  Saving model ...
Epoch: 4 cost time: 0.8562898635864258
Epoch: 4, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.631 Vali Acc: 0.556 Test Loss: 1.631 Test Acc: 0.556
Validation loss decreased (-0.505536 --> -0.555539).  Saving model ...
Epoch: 5 cost time: 0.9455583095550537
Epoch: 5, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.453 Vali Acc: 0.561 Test Loss: 1.453 Test Acc: 0.561
Validation loss decreased (-0.555539 --> -0.561097).  Saving model ...
Epoch: 6 cost time: 0.9324097633361816
Epoch: 6, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.333 Vali Acc: 0.617 Test Loss: 1.333 Test Acc: 0.617
Validation loss decreased (-0.561097 --> -0.616653).  Saving model ...
Epoch: 7 cost time: 0.8167579174041748
Epoch: 7, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.258 Vali Acc: 0.628 Test Loss: 1.258 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627765).  Saving model ...
Epoch: 8 cost time: 0.9220199584960938
Epoch: 8, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.202 Vali Acc: 0.639 Test Loss: 1.202 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 0.8516755104064941
Epoch: 9, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.139 Vali Acc: 0.661 Test Loss: 1.139 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 10 cost time: 0.811504602432251
Epoch: 10, Steps: 12 | Train Loss: 0.702 Vali Loss: 1.068 Vali Acc: 0.667 Test Loss: 1.068 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 0.816253662109375
Epoch: 11, Steps: 12 | Train Loss: 0.543 Vali Loss: 1.020 Vali Acc: 0.689 Test Loss: 1.020 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688879).  Saving model ...
Epoch: 12 cost time: 0.9283199310302734
Epoch: 12, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.8698091506958008
Epoch: 13, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.940 Vali Acc: 0.722 Test Loss: 0.940 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 14 cost time: 0.8537459373474121
Epoch: 14, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.887 Vali Acc: 0.739 Test Loss: 0.887 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 15 cost time: 0.8609933853149414
Epoch: 15, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.864 Vali Acc: 0.772 Test Loss: 0.864 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772214).  Saving model ...
Epoch: 16 cost time: 0.8424601554870605
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.899 Vali Acc: 0.767 Test Loss: 0.899 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8155817985534668
Epoch: 17, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.850 Vali Acc: 0.756 Test Loss: 0.850 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.906503438949585
Epoch: 18, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.868 Vali Acc: 0.783 Test Loss: 0.868 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783325).  Saving model ...
Epoch: 19 cost time: 0.820504903793335
Epoch: 19, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.842 Vali Acc: 0.767 Test Loss: 0.842 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8258814811706543
Epoch: 20, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.877 Vali Acc: 0.772 Test Loss: 0.877 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8733038902282715
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.860 Vali Acc: 0.767 Test Loss: 0.860 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8644363880157471
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7827918529510498
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.915 Vali Acc: 0.767 Test Loss: 0.915 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.825261116027832
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7935464382171631
Epoch: 25, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.927 Vali Acc: 0.783 Test Loss: 0.927 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8982088565826416
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.963 Vali Acc: 0.772 Test Loss: 0.963 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8346209526062012
Epoch: 27, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.974 Vali Acc: 0.761 Test Loss: 0.974 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8142156600952148
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.019 Vali Acc: 0.778 Test Loss: 1.019 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 209679
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5273983478546143
Epoch: 1, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.621 Vali Acc: 0.128 Test Loss: 2.621 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 0.9223909378051758
Epoch: 2, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.284 Vali Acc: 0.333 Test Loss: 2.284 Test Acc: 0.333
Validation loss decreased (-0.127752 --> -0.333310).  Saving model ...
Epoch: 3 cost time: 0.8915743827819824
Epoch: 3, Steps: 12 | Train Loss: 2.177 Vali Loss: 1.939 Vali Acc: 0.433 Test Loss: 1.939 Test Acc: 0.433
Validation loss decreased (-0.333310 --> -0.433314).  Saving model ...
Epoch: 4 cost time: 0.9028420448303223
Epoch: 4, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.691 Vali Acc: 0.539 Test Loss: 1.691 Test Acc: 0.539
Validation loss decreased (-0.433314 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 0.8063788414001465
Epoch: 5, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.526 Vali Acc: 0.589 Test Loss: 1.526 Test Acc: 0.589
Validation loss decreased (-0.538872 --> -0.588874).  Saving model ...
Epoch: 6 cost time: 0.8766250610351562
Epoch: 6, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.412 Vali Acc: 0.622 Test Loss: 1.412 Test Acc: 0.622
Validation loss decreased (-0.588874 --> -0.622208).  Saving model ...
Epoch: 7 cost time: 0.8709156513214111
Epoch: 7, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.315 Vali Acc: 0.611 Test Loss: 1.315 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8016030788421631
Epoch: 8, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.225 Vali Acc: 0.650 Test Loss: 1.225 Test Acc: 0.650
Validation loss decreased (-0.622208 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 0.9112710952758789
Epoch: 9, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.162 Vali Acc: 0.650 Test Loss: 1.162 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.8107583522796631
Epoch: 10, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.106 Vali Acc: 0.667 Test Loss: 1.106 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 0.8991703987121582
Epoch: 11, Steps: 12 | Train Loss: 0.651 Vali Loss: 1.053 Vali Acc: 0.644 Test Loss: 1.053 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.868950605392456
Epoch: 12, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.038 Vali Acc: 0.678 Test Loss: 1.038 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 0.907372236251831
Epoch: 13, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.942 Vali Acc: 0.717 Test Loss: 0.942 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716657).  Saving model ...
Epoch: 14 cost time: 0.9270772933959961
Epoch: 14, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.892 Vali Acc: 0.728 Test Loss: 0.892 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 15 cost time: 0.8208127021789551
Epoch: 15, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 16 cost time: 0.829808235168457
Epoch: 16, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.858 Vali Acc: 0.739 Test Loss: 0.858 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738880).  Saving model ...
Epoch: 17 cost time: 0.8946254253387451
Epoch: 17, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 18 cost time: 0.8874099254608154
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8411004543304443
Epoch: 19, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.841 Vali Acc: 0.728 Test Loss: 0.841 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8594744205474854
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.875 Vali Acc: 0.728 Test Loss: 0.875 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9016880989074707
Epoch: 21, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.819 Vali Acc: 0.750 Test Loss: 0.819 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8824377059936523
Epoch: 22, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.885 Vali Acc: 0.761 Test Loss: 0.885 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 23 cost time: 0.8840420246124268
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.881 Vali Acc: 0.739 Test Loss: 0.881 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8870840072631836
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.868664026260376
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8665773868560791
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.868 Vali Acc: 0.767 Test Loss: 0.868 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 27 cost time: 0.8599863052368164
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.907 Vali Acc: 0.756 Test Loss: 0.907 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8761935234069824
Epoch: 28, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777769).  Saving model ...
Epoch: 29 cost time: 0.8187563419342041
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8941731452941895
Epoch: 30, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.900 Vali Acc: 0.778 Test Loss: 0.900 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8214411735534668
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.943 Vali Acc: 0.756 Test Loss: 0.943 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8982739448547363
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.922 Vali Acc: 0.778 Test Loss: 0.922 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0024611949920654
Epoch: 33, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.962 Vali Acc: 0.772 Test Loss: 0.962 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9145190715789795
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.954 Vali Acc: 0.778 Test Loss: 0.954 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8676583766937256
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.014 Vali Acc: 0.772 Test Loss: 1.014 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0013389587402344
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.991 Vali Acc: 0.772 Test Loss: 0.991 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9026250839233398
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.980 Vali Acc: 0.778 Test Loss: 0.980 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8734703063964844
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.998 Vali Acc: 0.772 Test Loss: 0.998 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 202255
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.134310245513916
Epoch: 1, Steps: 12 | Train Loss: 2.820 Vali Loss: 2.718 Vali Acc: 0.050 Test Loss: 2.718 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 0.8772413730621338
Epoch: 2, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.409 Vali Acc: 0.256 Test Loss: 2.409 Test Acc: 0.256
Validation loss decreased (-0.049973 --> -0.255531).  Saving model ...
Epoch: 3 cost time: 0.9326856136322021
Epoch: 3, Steps: 12 | Train Loss: 2.283 Vali Loss: 2.097 Vali Acc: 0.389 Test Loss: 2.097 Test Acc: 0.389
Validation loss decreased (-0.255531 --> -0.388868).  Saving model ...
Epoch: 4 cost time: 0.9548864364624023
Epoch: 4, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.847 Vali Acc: 0.489 Test Loss: 1.847 Test Acc: 0.489
Validation loss decreased (-0.388868 --> -0.488870).  Saving model ...
Epoch: 5 cost time: 0.9058260917663574
Epoch: 5, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.659 Vali Acc: 0.533 Test Loss: 1.659 Test Acc: 0.533
Validation loss decreased (-0.488870 --> -0.533317).  Saving model ...
Epoch: 6 cost time: 0.9015600681304932
Epoch: 6, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.487 Vali Acc: 0.550 Test Loss: 1.487 Test Acc: 0.550
Validation loss decreased (-0.533317 --> -0.549985).  Saving model ...
Epoch: 7 cost time: 0.9152238368988037
Epoch: 7, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.363 Vali Acc: 0.578 Test Loss: 1.363 Test Acc: 0.578
Validation loss decreased (-0.549985 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 0.9001328945159912
Epoch: 8, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.235 Vali Acc: 0.578 Test Loss: 1.235 Test Acc: 0.578
Validation loss decreased (-0.577764 --> -0.577765).  Saving model ...
Epoch: 9 cost time: 0.8549520969390869
Epoch: 9, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.113 Vali Acc: 0.606 Test Loss: 1.113 Test Acc: 0.606
Validation loss decreased (-0.577765 --> -0.605544).  Saving model ...
Epoch: 10 cost time: 1.022712230682373
Epoch: 10, Steps: 12 | Train Loss: 0.701 Vali Loss: 1.022 Vali Acc: 0.628 Test Loss: 1.022 Test Acc: 0.628
Validation loss decreased (-0.605544 --> -0.627768).  Saving model ...
Epoch: 11 cost time: 0.8763167858123779
Epoch: 11, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.946 Vali Acc: 0.656 Test Loss: 0.946 Test Acc: 0.656
Validation loss decreased (-0.627768 --> -0.655546).  Saving model ...
Epoch: 12 cost time: 0.8843104839324951
Epoch: 12, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.933 Vali Acc: 0.661 Test Loss: 0.933 Test Acc: 0.661
Validation loss decreased (-0.655546 --> -0.661102).  Saving model ...
Epoch: 13 cost time: 0.9901416301727295
Epoch: 13, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.906 Vali Acc: 0.667 Test Loss: 0.906 Test Acc: 0.667
Validation loss decreased (-0.661102 --> -0.666658).  Saving model ...
Epoch: 14 cost time: 0.96394944190979
Epoch: 14, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.870 Vali Acc: 0.667 Test Loss: 0.870 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 15 cost time: 0.8873426914215088
Epoch: 15, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.850 Vali Acc: 0.683 Test Loss: 0.850 Test Acc: 0.683
Validation loss decreased (-0.666658 --> -0.683325).  Saving model ...
Epoch: 16 cost time: 0.8807032108306885
Epoch: 16, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
Validation loss decreased (-0.683325 --> -0.716658).  Saving model ...
Epoch: 17 cost time: 0.8935797214508057
Epoch: 17, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.829 Vali Acc: 0.722 Test Loss: 0.829 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 18 cost time: 1.0004150867462158
Epoch: 18, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 19 cost time: 0.8834874629974365
Epoch: 19, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.794 Vali Acc: 0.733 Test Loss: 0.794 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733325).  Saving model ...
Epoch: 20 cost time: 0.9560976028442383
Epoch: 20, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.763 Vali Acc: 0.739 Test Loss: 0.763 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 21 cost time: 0.9857254028320312
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.761 Vali Acc: 0.750 Test Loss: 0.761 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.9852805137634277
Epoch: 22, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.807 Vali Acc: 0.772 Test Loss: 0.807 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772214).  Saving model ...
Epoch: 23 cost time: 0.8915116786956787
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.797 Vali Acc: 0.778 Test Loss: 0.797 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 24 cost time: 0.9543280601501465
Epoch: 24, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9562106132507324
Epoch: 25, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.823 Vali Acc: 0.739 Test Loss: 0.823 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.934175968170166
Epoch: 26, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9774024486541748
Epoch: 27, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.825 Vali Acc: 0.772 Test Loss: 0.825 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9710338115692139
Epoch: 28, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.840 Vali Acc: 0.756 Test Loss: 0.840 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0069701671600342
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.863 Vali Acc: 0.756 Test Loss: 0.863 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9273412227630615
Epoch: 30, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9803333282470703
Epoch: 31, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.853 Vali Acc: 0.767 Test Loss: 0.853 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9847719669342041
Epoch: 32, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.876 Vali Acc: 0.767 Test Loss: 0.876 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0074071884155273
Epoch: 33, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.842 Vali Acc: 0.783 Test Loss: 0.842 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 34 cost time: 0.9460155963897705
Epoch: 34, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.903 Vali Acc: 0.789 Test Loss: 0.903 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788880).  Saving model ...
Epoch: 35 cost time: 1.048424482345581
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.959 Vali Acc: 0.778 Test Loss: 0.959 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0083129405975342
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.887 Vali Acc: 0.772 Test Loss: 0.887 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9352591037750244
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.922 Vali Acc: 0.767 Test Loss: 0.922 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9493508338928223
Epoch: 38, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.926 Vali Acc: 0.761 Test Loss: 0.926 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9624056816101074
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.001 Vali Acc: 0.772 Test Loss: 1.001 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9238085746765137
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.928 Vali Acc: 0.789 Test Loss: 0.928 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9346137046813965
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.936 Vali Acc: 0.767 Test Loss: 0.936 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9920480251312256
Epoch: 42, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.982 Vali Acc: 0.761 Test Loss: 0.982 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9387357234954834
Epoch: 43, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.962 Vali Acc: 0.794 Test Loss: 0.962 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794435).  Saving model ...
Epoch: 44 cost time: 0.7280759811401367
Epoch: 44, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.970 Vali Acc: 0.800 Test Loss: 0.970 Test Acc: 0.800
Validation loss decreased (-0.794435 --> -0.799990).  Saving model ...
Epoch: 45 cost time: 0.8477208614349365
Epoch: 45, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.007 Vali Acc: 0.767 Test Loss: 1.007 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9034252166748047
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.001 Vali Acc: 0.772 Test Loss: 1.001 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.885974645614624
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.005 Vali Acc: 0.778 Test Loss: 1.005 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9727053642272949
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.006 Vali Acc: 0.789 Test Loss: 1.006 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8718397617340088
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.030 Vali Acc: 0.789 Test Loss: 1.030 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8606624603271484
Epoch: 50, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.047 Vali Acc: 0.800 Test Loss: 1.047 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.8785004615783691
Epoch: 51, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.070 Vali Acc: 0.794 Test Loss: 1.070 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.8389461040496826
Epoch: 52, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.085 Vali Acc: 0.806 Test Loss: 1.085 Test Acc: 0.806
Validation loss decreased (-0.799990 --> -0.805545).  Saving model ...
Epoch: 53 cost time: 0.8718173503875732
Epoch: 53, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.094 Vali Acc: 0.778 Test Loss: 1.094 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8893756866455078
Epoch: 54, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.094 Vali Acc: 0.794 Test Loss: 1.094 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9220919609069824
Epoch: 55, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.060 Vali Acc: 0.783 Test Loss: 1.060 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8670492172241211
Epoch: 56, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.026 Vali Acc: 0.767 Test Loss: 1.026 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.951225996017456
Epoch: 57, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.067 Vali Acc: 0.772 Test Loss: 1.067 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9713501930236816
Epoch: 58, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.143 Vali Acc: 0.767 Test Loss: 1.143 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.900550365447998
Epoch: 59, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.141 Vali Acc: 0.767 Test Loss: 1.141 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.907578706741333
Epoch: 60, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.168 Vali Acc: 0.789 Test Loss: 1.168 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.9112794399261475
Epoch: 61, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.150 Vali Acc: 0.789 Test Loss: 1.150 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.8423624038696289
Epoch: 62, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.138 Vali Acc: 0.800 Test Loss: 1.138 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm128_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 194959
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2680552005767822
Epoch: 1, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.563 Vali Acc: 0.244 Test Loss: 2.563 Test Acc: 0.244
Validation loss decreased (inf --> -0.244419).  Saving model ...
Epoch: 2 cost time: 0.8151721954345703
Epoch: 2, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.067 Vali Acc: 0.456 Test Loss: 2.067 Test Acc: 0.456
Validation loss decreased (-0.244419 --> -0.455535).  Saving model ...
Epoch: 3 cost time: 0.815075159072876
Epoch: 3, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.710 Vali Acc: 0.511 Test Loss: 1.710 Test Acc: 0.511
Validation loss decreased (-0.455535 --> -0.511094).  Saving model ...
Epoch: 4 cost time: 0.8303241729736328
Epoch: 4, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.463 Vali Acc: 0.561 Test Loss: 1.463 Test Acc: 0.561
Validation loss decreased (-0.511094 --> -0.561096).  Saving model ...
Epoch: 5 cost time: 0.8484642505645752
Epoch: 5, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.395 Vali Acc: 0.600 Test Loss: 1.395 Test Acc: 0.600
Validation loss decreased (-0.561096 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 0.8339869976043701
Epoch: 6, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.256 Vali Acc: 0.622 Test Loss: 1.256 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622210).  Saving model ...
Epoch: 7 cost time: 0.7714109420776367
Epoch: 7, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.202 Vali Acc: 0.644 Test Loss: 1.202 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.8422291278839111
Epoch: 8, Steps: 12 | Train Loss: 0.692 Vali Loss: 1.194 Vali Acc: 0.644 Test Loss: 1.194 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644433).  Saving model ...
Epoch: 9 cost time: 0.8305845260620117
Epoch: 9, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.085 Vali Acc: 0.700 Test Loss: 1.085 Test Acc: 0.700
Validation loss decreased (-0.644433 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.7908689975738525
Epoch: 10, Steps: 12 | Train Loss: 0.443 Vali Loss: 1.053 Vali Acc: 0.711 Test Loss: 1.053 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 11 cost time: 0.8685283660888672
Epoch: 11, Steps: 12 | Train Loss: 0.386 Vali Loss: 1.094 Vali Acc: 0.711 Test Loss: 1.094 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8815813064575195
Epoch: 12, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 0.8646879196166992
Epoch: 13, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.171 Vali Acc: 0.728 Test Loss: 1.171 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9039967060089111
Epoch: 14, Steps: 12 | Train Loss: 0.247 Vali Loss: 1.109 Vali Acc: 0.711 Test Loss: 1.109 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9172611236572266
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 1.092 Vali Acc: 0.733 Test Loss: 1.092 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9026689529418945
Epoch: 16, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.147 Vali Acc: 0.717 Test Loss: 1.147 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8922164440155029
Epoch: 17, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.229 Vali Acc: 0.733 Test Loss: 1.229 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7897331714630127
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.214 Vali Acc: 0.739 Test Loss: 1.214 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738877).  Saving model ...
Epoch: 19 cost time: 0.8752286434173584
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.247 Vali Acc: 0.739 Test Loss: 1.247 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9084200859069824
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.288 Vali Acc: 0.722 Test Loss: 1.288 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8448662757873535
Epoch: 21, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.294 Vali Acc: 0.739 Test Loss: 1.294 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.81770920753479
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.326 Vali Acc: 0.739 Test Loss: 1.326 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8351240158081055
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.434 Vali Acc: 0.722 Test Loss: 1.434 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8306469917297363
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.406 Vali Acc: 0.750 Test Loss: 1.406 Test Acc: 0.750
Validation loss decreased (-0.738877 --> -0.749986).  Saving model ...
Epoch: 25 cost time: 0.8240840435028076
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.404 Vali Acc: 0.756 Test Loss: 1.404 Test Acc: 0.756
Validation loss decreased (-0.749986 --> -0.755542).  Saving model ...
Epoch: 26 cost time: 0.8740370273590088
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.485 Vali Acc: 0.739 Test Loss: 1.485 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8320660591125488
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.484 Vali Acc: 0.733 Test Loss: 1.484 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7943036556243896
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.500 Vali Acc: 0.744 Test Loss: 1.500 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7903509140014648
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.477 Vali Acc: 0.750 Test Loss: 1.477 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8268916606903076
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.520 Vali Acc: 0.744 Test Loss: 1.520 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8392734527587891
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.532 Vali Acc: 0.750 Test Loss: 1.532 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8602280616760254
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.601 Vali Acc: 0.728 Test Loss: 1.601 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.709099292755127
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.570 Vali Acc: 0.744 Test Loss: 1.570 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8123292922973633
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.550 Vali Acc: 0.750 Test Loss: 1.550 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8714499473571777
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.578 Vali Acc: 0.744 Test Loss: 1.578 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 186639
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2539124488830566
Epoch: 1, Steps: 12 | Train Loss: 2.819 Vali Loss: 2.632 Vali Acc: 0.122 Test Loss: 2.632 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.8356764316558838
Epoch: 2, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.251 Vali Acc: 0.333 Test Loss: 2.251 Test Acc: 0.333
Validation loss decreased (-0.122196 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 0.8068876266479492
Epoch: 3, Steps: 12 | Train Loss: 2.136 Vali Loss: 1.901 Vali Acc: 0.483 Test Loss: 1.901 Test Acc: 0.483
Validation loss decreased (-0.333311 --> -0.483314).  Saving model ...
Epoch: 4 cost time: 0.8667721748352051
Epoch: 4, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.660 Vali Acc: 0.539 Test Loss: 1.660 Test Acc: 0.539
Validation loss decreased (-0.483314 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 0.8478102684020996
Epoch: 5, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.485 Vali Acc: 0.550 Test Loss: 1.485 Test Acc: 0.550
Validation loss decreased (-0.538872 --> -0.549985).  Saving model ...
Epoch: 6 cost time: 0.8749639987945557
Epoch: 6, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.359 Vali Acc: 0.561 Test Loss: 1.359 Test Acc: 0.561
Validation loss decreased (-0.549985 --> -0.561098).  Saving model ...
Epoch: 7 cost time: 0.9926080703735352
Epoch: 7, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.298 Vali Acc: 0.617 Test Loss: 1.298 Test Acc: 0.617
Validation loss decreased (-0.561098 --> -0.616654).  Saving model ...
Epoch: 8 cost time: 0.8865554332733154
Epoch: 8, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.211 Vali Acc: 0.628 Test Loss: 1.211 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627766).  Saving model ...
Epoch: 9 cost time: 0.8686754703521729
Epoch: 9, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.165 Vali Acc: 0.628 Test Loss: 1.165 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627766).  Saving model ...
Epoch: 10 cost time: 0.8009078502655029
Epoch: 10, Steps: 12 | Train Loss: 0.678 Vali Loss: 1.173 Vali Acc: 0.650 Test Loss: 1.173 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.8458812236785889
Epoch: 11, Steps: 12 | Train Loss: 0.604 Vali Loss: 1.083 Vali Acc: 0.678 Test Loss: 1.083 Test Acc: 0.678
Validation loss decreased (-0.649988 --> -0.677767).  Saving model ...
Epoch: 12 cost time: 0.9041240215301514
Epoch: 12, Steps: 12 | Train Loss: 0.506 Vali Loss: 1.035 Vali Acc: 0.711 Test Loss: 1.035 Test Acc: 0.711
Validation loss decreased (-0.677767 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 0.8061153888702393
Epoch: 13, Steps: 12 | Train Loss: 0.479 Vali Loss: 1.095 Vali Acc: 0.689 Test Loss: 1.095 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8020246028900146
Epoch: 14, Steps: 12 | Train Loss: 0.390 Vali Loss: 1.010 Vali Acc: 0.739 Test Loss: 1.010 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.8774747848510742
Epoch: 15, Steps: 12 | Train Loss: 0.378 Vali Loss: 1.048 Vali Acc: 0.717 Test Loss: 1.048 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8242251873016357
Epoch: 16, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.992 Vali Acc: 0.761 Test Loss: 0.992 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761101).  Saving model ...
Epoch: 17 cost time: 0.8587508201599121
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 1.055 Vali Acc: 0.711 Test Loss: 1.055 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.873053789138794
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.002 Vali Acc: 0.750 Test Loss: 1.002 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8837952613830566
Epoch: 19, Steps: 12 | Train Loss: 0.220 Vali Loss: 1.040 Vali Acc: 0.744 Test Loss: 1.040 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9091098308563232
Epoch: 20, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.043 Vali Acc: 0.744 Test Loss: 1.043 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9017488956451416
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.078 Vali Acc: 0.756 Test Loss: 1.078 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8122730255126953
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.073 Vali Acc: 0.728 Test Loss: 1.073 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8630523681640625
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.083 Vali Acc: 0.750 Test Loss: 1.083 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7906415462493896
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.131 Vali Acc: 0.739 Test Loss: 1.131 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7989728450775146
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.148 Vali Acc: 0.733 Test Loss: 1.148 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8008971214294434
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.126 Vali Acc: 0.767 Test Loss: 1.126 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766655).  Saving model ...
Epoch: 27 cost time: 0.8549396991729736
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.179 Vali Acc: 0.744 Test Loss: 1.179 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.926379919052124
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.192 Vali Acc: 0.744 Test Loss: 1.192 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8527894020080566
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.211 Vali Acc: 0.761 Test Loss: 1.211 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8891663551330566
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.217 Vali Acc: 0.767 Test Loss: 1.217 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8946413993835449
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.205 Vali Acc: 0.767 Test Loss: 1.205 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8224296569824219
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.269 Vali Acc: 0.756 Test Loss: 1.269 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.951512336730957
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.258 Vali Acc: 0.761 Test Loss: 1.258 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9173564910888672
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.272 Vali Acc: 0.761 Test Loss: 1.272 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.893620491027832
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.237 Vali Acc: 0.767 Test Loss: 1.237 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8219804763793945
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.277 Vali Acc: 0.756 Test Loss: 1.277 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 144463
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.403099775314331
Epoch: 1, Steps: 12 | Train Loss: 2.861 Vali Loss: 2.674 Vali Acc: 0.117 Test Loss: 2.674 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.8657586574554443
Epoch: 2, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.310 Vali Acc: 0.261 Test Loss: 2.310 Test Acc: 0.261
Validation loss decreased (-0.116640 --> -0.261088).  Saving model ...
Epoch: 3 cost time: 0.830747127532959
Epoch: 3, Steps: 12 | Train Loss: 2.146 Vali Loss: 1.963 Vali Acc: 0.406 Test Loss: 1.963 Test Acc: 0.406
Validation loss decreased (-0.261088 --> -0.405536).  Saving model ...
Epoch: 4 cost time: 0.7991733551025391
Epoch: 4, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.685 Vali Acc: 0.467 Test Loss: 1.685 Test Acc: 0.467
Validation loss decreased (-0.405536 --> -0.466650).  Saving model ...
Epoch: 5 cost time: 0.8914504051208496
Epoch: 5, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.523 Vali Acc: 0.533 Test Loss: 1.523 Test Acc: 0.533
Validation loss decreased (-0.466650 --> -0.533318).  Saving model ...
Epoch: 6 cost time: 0.7036170959472656
Epoch: 6, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.431 Vali Acc: 0.561 Test Loss: 1.431 Test Acc: 0.561
Validation loss decreased (-0.533318 --> -0.561097).  Saving model ...
Epoch: 7 cost time: 0.9136176109313965
Epoch: 7, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.348 Vali Acc: 0.578 Test Loss: 1.348 Test Acc: 0.578
Validation loss decreased (-0.561097 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 0.9189753532409668
Epoch: 8, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.268 Vali Acc: 0.633 Test Loss: 1.268 Test Acc: 0.633
Validation loss decreased (-0.577764 --> -0.633321).  Saving model ...
Epoch: 9 cost time: 0.8761298656463623
Epoch: 9, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.241 Vali Acc: 0.628 Test Loss: 1.241 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8650944232940674
Epoch: 10, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.200 Vali Acc: 0.633 Test Loss: 1.200 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 0.8683440685272217
Epoch: 11, Steps: 12 | Train Loss: 0.587 Vali Loss: 1.153 Vali Acc: 0.633 Test Loss: 1.153 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633322).  Saving model ...
Epoch: 12 cost time: 0.8256020545959473
Epoch: 12, Steps: 12 | Train Loss: 0.530 Vali Loss: 1.127 Vali Acc: 0.667 Test Loss: 1.127 Test Acc: 0.667
Validation loss decreased (-0.633322 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.8540856838226318
Epoch: 13, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.074 Vali Acc: 0.689 Test Loss: 1.074 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 14 cost time: 0.9101510047912598
Epoch: 14, Steps: 12 | Train Loss: 0.443 Vali Loss: 1.001 Vali Acc: 0.717 Test Loss: 1.001 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716657).  Saving model ...
Epoch: 15 cost time: 0.8664860725402832
Epoch: 15, Steps: 12 | Train Loss: 0.313 Vali Loss: 1.023 Vali Acc: 0.706 Test Loss: 1.023 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8124644756317139
Epoch: 16, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
Validation loss decreased (-0.716657 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.8370926380157471
Epoch: 17, Steps: 12 | Train Loss: 0.237 Vali Loss: 1.003 Vali Acc: 0.733 Test Loss: 1.003 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8610217571258545
Epoch: 18, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.995 Vali Acc: 0.744 Test Loss: 0.995 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8680374622344971
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 1.006 Vali Acc: 0.739 Test Loss: 1.006 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.893207311630249
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.022 Vali Acc: 0.733 Test Loss: 1.022 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8895235061645508
Epoch: 21, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.048 Vali Acc: 0.733 Test Loss: 1.048 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9271399974822998
Epoch: 22, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.084 Vali Acc: 0.744 Test Loss: 1.084 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8535115718841553
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.076 Vali Acc: 0.739 Test Loss: 1.076 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9158444404602051
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.130 Vali Acc: 0.750 Test Loss: 1.130 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.853116512298584
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.122 Vali Acc: 0.756 Test Loss: 1.122 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755544).  Saving model ...
Epoch: 26 cost time: 0.902437686920166
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.134 Vali Acc: 0.750 Test Loss: 1.134 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8525364398956299
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.148 Vali Acc: 0.761 Test Loss: 1.148 Test Acc: 0.761
Validation loss decreased (-0.755544 --> -0.761100).  Saving model ...
Epoch: 28 cost time: 0.8905785083770752
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.182 Vali Acc: 0.750 Test Loss: 1.182 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8960559368133545
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.201 Vali Acc: 0.761 Test Loss: 1.201 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8382821083068848
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.216 Vali Acc: 0.750 Test Loss: 1.216 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8656861782073975
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.236 Vali Acc: 0.756 Test Loss: 1.236 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8381204605102539
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.243 Vali Acc: 0.767 Test Loss: 1.243 Test Acc: 0.767
Validation loss decreased (-0.761100 --> -0.766654).  Saving model ...
Epoch: 33 cost time: 0.9037284851074219
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.238 Vali Acc: 0.750 Test Loss: 1.238 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8954861164093018
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.245 Vali Acc: 0.756 Test Loss: 1.245 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8724496364593506
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.303 Vali Acc: 0.750 Test Loss: 1.303 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8777203559875488
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.303 Vali Acc: 0.756 Test Loss: 1.303 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.878079891204834
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.299 Vali Acc: 0.756 Test Loss: 1.299 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9230763912200928
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.355 Vali Acc: 0.717 Test Loss: 1.355 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9130630493164062
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.360 Vali Acc: 0.744 Test Loss: 1.360 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.856712818145752
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.350 Vali Acc: 0.772 Test Loss: 1.350 Test Acc: 0.772
Validation loss decreased (-0.766654 --> -0.772209).  Saving model ...
Epoch: 41 cost time: 0.870948076248169
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.410 Vali Acc: 0.739 Test Loss: 1.410 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8813536167144775
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.374 Vali Acc: 0.756 Test Loss: 1.374 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.842012882232666
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.380 Vali Acc: 0.767 Test Loss: 1.380 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8027017116546631
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.402 Vali Acc: 0.761 Test Loss: 1.402 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8356430530548096
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.371 Vali Acc: 0.756 Test Loss: 1.371 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8949534893035889
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.399 Vali Acc: 0.756 Test Loss: 1.399 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9284331798553467
Epoch: 47, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.417 Vali Acc: 0.756 Test Loss: 1.417 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8116235733032227
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.417 Vali Acc: 0.761 Test Loss: 1.417 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8166978359222412
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.429 Vali Acc: 0.756 Test Loss: 1.429 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9111433029174805
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.437 Vali Acc: 0.750 Test Loss: 1.437 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 142607
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.555232286453247
Epoch: 1, Steps: 12 | Train Loss: 2.922 Vali Loss: 2.746 Vali Acc: 0.133 Test Loss: 2.746 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.9461700916290283
Epoch: 2, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.452 Vali Acc: 0.311 Test Loss: 2.452 Test Acc: 0.311
Validation loss decreased (-0.133306 --> -0.311087).  Saving model ...
Epoch: 3 cost time: 0.8539547920227051
Epoch: 3, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.139 Vali Acc: 0.428 Test Loss: 2.139 Test Acc: 0.428
Validation loss decreased (-0.311087 --> -0.427756).  Saving model ...
Epoch: 4 cost time: 0.8992924690246582
Epoch: 4, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.881 Vali Acc: 0.494 Test Loss: 1.881 Test Acc: 0.494
Validation loss decreased (-0.427756 --> -0.494426).  Saving model ...
Epoch: 5 cost time: 0.8882174491882324
Epoch: 5, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.675 Vali Acc: 0.556 Test Loss: 1.675 Test Acc: 0.556
Validation loss decreased (-0.494426 --> -0.555539).  Saving model ...
Epoch: 6 cost time: 0.896693229675293
Epoch: 6, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.546 Vali Acc: 0.556 Test Loss: 1.546 Test Acc: 0.556
Validation loss decreased (-0.555539 --> -0.555540).  Saving model ...
Epoch: 7 cost time: 0.915581464767456
Epoch: 7, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.432 Vali Acc: 0.567 Test Loss: 1.432 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566652).  Saving model ...
Epoch: 8 cost time: 0.8470025062561035
Epoch: 8, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.350 Vali Acc: 0.583 Test Loss: 1.350 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583320).  Saving model ...
Epoch: 9 cost time: 0.8126437664031982
Epoch: 9, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.289 Vali Acc: 0.611 Test Loss: 1.289 Test Acc: 0.611
Validation loss decreased (-0.583320 --> -0.611098).  Saving model ...
Epoch: 10 cost time: 0.8993518352508545
Epoch: 10, Steps: 12 | Train Loss: 0.886 Vali Loss: 1.220 Vali Acc: 0.661 Test Loss: 1.220 Test Acc: 0.661
Validation loss decreased (-0.611098 --> -0.661099).  Saving model ...
Epoch: 11 cost time: 0.8275737762451172
Epoch: 11, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.175 Vali Acc: 0.650 Test Loss: 1.175 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8594100475311279
Epoch: 12, Steps: 12 | Train Loss: 0.689 Vali Loss: 1.145 Vali Acc: 0.672 Test Loss: 1.145 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 0.8171863555908203
Epoch: 13, Steps: 12 | Train Loss: 0.681 Vali Loss: 1.130 Vali Acc: 0.672 Test Loss: 1.130 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 14 cost time: 0.7957830429077148
Epoch: 14, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.050 Vali Acc: 0.717 Test Loss: 1.050 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716656).  Saving model ...
Epoch: 15 cost time: 0.8169271945953369
Epoch: 15, Steps: 12 | Train Loss: 0.547 Vali Loss: 1.005 Vali Acc: 0.706 Test Loss: 1.005 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9004354476928711
Epoch: 16, Steps: 12 | Train Loss: 0.467 Vali Loss: 1.017 Vali Acc: 0.689 Test Loss: 1.017 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8146998882293701
Epoch: 17, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.967 Vali Acc: 0.744 Test Loss: 0.967 Test Acc: 0.744
Validation loss decreased (-0.716656 --> -0.744435).  Saving model ...
Epoch: 18 cost time: 0.9044559001922607
Epoch: 18, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8114867210388184
Epoch: 19, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.963 Vali Acc: 0.706 Test Loss: 0.963 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8653502464294434
Epoch: 20, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.920 Vali Acc: 0.783 Test Loss: 0.920 Test Acc: 0.783
Validation loss decreased (-0.744435 --> -0.783324).  Saving model ...
Epoch: 21 cost time: 0.8453695774078369
Epoch: 21, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.959 Vali Acc: 0.722 Test Loss: 0.959 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8417253494262695
Epoch: 22, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8374972343444824
Epoch: 23, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.946 Vali Acc: 0.756 Test Loss: 0.946 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8260238170623779
Epoch: 24, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.942 Vali Acc: 0.761 Test Loss: 0.942 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8083937168121338
Epoch: 25, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.948 Vali Acc: 0.739 Test Loss: 0.948 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8182475566864014
Epoch: 26, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.980 Vali Acc: 0.739 Test Loss: 0.980 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7811946868896484
Epoch: 27, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.980 Vali Acc: 0.739 Test Loss: 0.980 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.890000581741333
Epoch: 28, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.981 Vali Acc: 0.761 Test Loss: 0.981 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7487490177154541
Epoch: 29, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.998 Vali Acc: 0.756 Test Loss: 0.998 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7591145038604736
Epoch: 30, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.000 Vali Acc: 0.750 Test Loss: 1.000 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 129231
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5788843631744385
Epoch: 1, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.744 Vali Acc: 0.106 Test Loss: 2.744 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 0.8891527652740479
Epoch: 2, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.510 Vali Acc: 0.244 Test Loss: 2.510 Test Acc: 0.244
Validation loss decreased (-0.105528 --> -0.244419).  Saving model ...
Epoch: 3 cost time: 0.8161220550537109
Epoch: 3, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.246 Vali Acc: 0.367 Test Loss: 2.246 Test Acc: 0.367
Validation loss decreased (-0.244419 --> -0.366644).  Saving model ...
Epoch: 4 cost time: 0.878098726272583
Epoch: 4, Steps: 12 | Train Loss: 2.107 Vali Loss: 1.979 Vali Acc: 0.428 Test Loss: 1.979 Test Acc: 0.428
Validation loss decreased (-0.366644 --> -0.427758).  Saving model ...
Epoch: 5 cost time: 0.8511102199554443
Epoch: 5, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.768 Vali Acc: 0.544 Test Loss: 1.768 Test Acc: 0.544
Validation loss decreased (-0.427758 --> -0.544427).  Saving model ...
Epoch: 6 cost time: 0.8075175285339355
Epoch: 6, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.610 Vali Acc: 0.533 Test Loss: 1.610 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8116512298583984
Epoch: 7, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.505 Vali Acc: 0.567 Test Loss: 1.505 Test Acc: 0.567
Validation loss decreased (-0.544427 --> -0.566652).  Saving model ...
Epoch: 8 cost time: 0.816399335861206
Epoch: 8, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.412 Vali Acc: 0.606 Test Loss: 1.412 Test Acc: 0.606
Validation loss decreased (-0.566652 --> -0.605541).  Saving model ...
Epoch: 9 cost time: 0.8367841243743896
Epoch: 9, Steps: 12 | Train Loss: 1.136 Vali Loss: 1.368 Vali Acc: 0.594 Test Loss: 1.368 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8842482566833496
Epoch: 10, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.305 Vali Acc: 0.622 Test Loss: 1.305 Test Acc: 0.622
Validation loss decreased (-0.605541 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 0.8229944705963135
Epoch: 11, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.228 Vali Acc: 0.650 Test Loss: 1.228 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.8474338054656982
Epoch: 12, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.209 Vali Acc: 0.628 Test Loss: 1.209 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9009263515472412
Epoch: 13, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.175 Vali Acc: 0.639 Test Loss: 1.175 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9175970554351807
Epoch: 14, Steps: 12 | Train Loss: 0.727 Vali Loss: 1.092 Vali Acc: 0.672 Test Loss: 1.092 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.672211).  Saving model ...
Epoch: 15 cost time: 0.8528399467468262
Epoch: 15, Steps: 12 | Train Loss: 0.605 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.790471076965332
Epoch: 16, Steps: 12 | Train Loss: 0.510 Vali Loss: 1.029 Vali Acc: 0.689 Test Loss: 1.029 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688879).  Saving model ...
Epoch: 17 cost time: 0.8603506088256836
Epoch: 17, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.991 Vali Acc: 0.706 Test Loss: 0.991 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 18 cost time: 0.7901406288146973
Epoch: 18, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.918 Vali Acc: 0.739 Test Loss: 0.918 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738880).  Saving model ...
Epoch: 19 cost time: 0.8449904918670654
Epoch: 19, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.936 Vali Acc: 0.717 Test Loss: 0.936 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8406646251678467
Epoch: 20, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.899 Vali Acc: 0.717 Test Loss: 0.899 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8806893825531006
Epoch: 21, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.876 Vali Acc: 0.756 Test Loss: 0.876 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 22 cost time: 0.8861746788024902
Epoch: 22, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.879 Vali Acc: 0.744 Test Loss: 0.879 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9212493896484375
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8592474460601807
Epoch: 24, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.886 Vali Acc: 0.744 Test Loss: 0.886 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9053494930267334
Epoch: 25, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.857 Vali Acc: 0.739 Test Loss: 0.857 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8074078559875488
Epoch: 26, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9342644214630127
Epoch: 27, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.847 Vali Acc: 0.761 Test Loss: 0.847 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 28 cost time: 0.8109195232391357
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.844 Vali Acc: 0.744 Test Loss: 0.844 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8133914470672607
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.867 Vali Acc: 0.733 Test Loss: 0.867 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8486964702606201
Epoch: 30, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.858 Vali Acc: 0.744 Test Loss: 0.858 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8440594673156738
Epoch: 31, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.842 Vali Acc: 0.739 Test Loss: 0.842 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.808772087097168
Epoch: 32, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.887 Vali Acc: 0.739 Test Loss: 0.887 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8200719356536865
Epoch: 33, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.939 Vali Acc: 0.711 Test Loss: 0.939 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8461353778839111
Epoch: 34, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.897 Vali Acc: 0.756 Test Loss: 0.897 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8874614238739014
Epoch: 35, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.892 Vali Acc: 0.728 Test Loss: 0.892 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8422808647155762
Epoch: 36, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.900 Vali Acc: 0.778 Test Loss: 0.900 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777769).  Saving model ...
Epoch: 37 cost time: 0.8444182872772217
Epoch: 37, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.920 Vali Acc: 0.756 Test Loss: 0.920 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8162837028503418
Epoch: 38, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.921 Vali Acc: 0.767 Test Loss: 0.921 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8240573406219482
Epoch: 39, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.919 Vali Acc: 0.772 Test Loss: 0.919 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8191063404083252
Epoch: 40, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.920 Vali Acc: 0.761 Test Loss: 0.920 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8312966823577881
Epoch: 41, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.936 Vali Acc: 0.778 Test Loss: 0.936 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8199098110198975
Epoch: 42, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.960 Vali Acc: 0.756 Test Loss: 0.960 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.854193925857544
Epoch: 43, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.965 Vali Acc: 0.761 Test Loss: 0.965 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8402352333068848
Epoch: 44, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.973 Vali Acc: 0.761 Test Loss: 0.973 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8512434959411621
Epoch: 45, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.931 Vali Acc: 0.772 Test Loss: 0.931 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8171634674072266
Epoch: 46, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.933 Vali Acc: 0.772 Test Loss: 0.933 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 121679
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.399799108505249
Epoch: 1, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.706 Vali Acc: 0.111 Test Loss: 2.706 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.9423902034759521
Epoch: 2, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.508 Vali Acc: 0.211 Test Loss: 2.508 Test Acc: 0.211
Validation loss decreased (-0.111084 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 0.9448845386505127
Epoch: 3, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.253 Vali Acc: 0.328 Test Loss: 2.253 Test Acc: 0.328
Validation loss decreased (-0.211086 --> -0.327755).  Saving model ...
Epoch: 4 cost time: 0.8186852931976318
Epoch: 4, Steps: 12 | Train Loss: 2.103 Vali Loss: 2.009 Vali Acc: 0.472 Test Loss: 2.009 Test Acc: 0.472
Validation loss decreased (-0.327755 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 0.8743574619293213
Epoch: 5, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.813 Vali Acc: 0.483 Test Loss: 1.813 Test Acc: 0.483
Validation loss decreased (-0.472202 --> -0.483315).  Saving model ...
Epoch: 6 cost time: 0.8238012790679932
Epoch: 6, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.656 Vali Acc: 0.506 Test Loss: 1.656 Test Acc: 0.506
Validation loss decreased (-0.483315 --> -0.505539).  Saving model ...
Epoch: 7 cost time: 0.8721954822540283
Epoch: 7, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.536 Vali Acc: 0.578 Test Loss: 1.536 Test Acc: 0.578
Validation loss decreased (-0.505539 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 0.8841390609741211
Epoch: 8, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.456 Vali Acc: 0.589 Test Loss: 1.456 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588874).  Saving model ...
Epoch: 9 cost time: 0.8317182064056396
Epoch: 9, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.381 Vali Acc: 0.594 Test Loss: 1.381 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594431).  Saving model ...
Epoch: 10 cost time: 0.9088013172149658
Epoch: 10, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.303 Vali Acc: 0.606 Test Loss: 1.303 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 11 cost time: 0.8874683380126953
Epoch: 11, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.226 Vali Acc: 0.656 Test Loss: 1.226 Test Acc: 0.656
Validation loss decreased (-0.605543 --> -0.655543).  Saving model ...
Epoch: 12 cost time: 0.8982875347137451
Epoch: 12, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.168 Vali Acc: 0.639 Test Loss: 1.168 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.822333812713623
Epoch: 13, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.138 Vali Acc: 0.661 Test Loss: 1.138 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 0.8712766170501709
Epoch: 14, Steps: 12 | Train Loss: 0.752 Vali Loss: 1.068 Vali Acc: 0.672 Test Loss: 1.068 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 15 cost time: 0.9063467979431152
Epoch: 15, Steps: 12 | Train Loss: 0.607 Vali Loss: 1.050 Vali Acc: 0.656 Test Loss: 1.050 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.930717945098877
Epoch: 16, Steps: 12 | Train Loss: 0.562 Vali Loss: 1.018 Vali Acc: 0.667 Test Loss: 1.018 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9009735584259033
Epoch: 17, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.965 Vali Acc: 0.706 Test Loss: 0.965 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705546).  Saving model ...
Epoch: 18 cost time: 0.9750258922576904
Epoch: 18, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.907 Vali Acc: 0.706 Test Loss: 0.907 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705546).  Saving model ...
Epoch: 19 cost time: 0.8523173332214355
Epoch: 19, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.895 Vali Acc: 0.711 Test Loss: 0.895 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 20 cost time: 0.8404147624969482
Epoch: 20, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.879 Vali Acc: 0.717 Test Loss: 0.879 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 21 cost time: 0.8686208724975586
Epoch: 21, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.853 Vali Acc: 0.717 Test Loss: 0.853 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 22 cost time: 0.8907139301300049
Epoch: 22, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.825 Vali Acc: 0.728 Test Loss: 0.825 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 23 cost time: 0.8640005588531494
Epoch: 23, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.817 Vali Acc: 0.744 Test Loss: 0.817 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 0.8552007675170898
Epoch: 24, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.834 Vali Acc: 0.744 Test Loss: 0.834 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7814421653747559
Epoch: 25, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.833 Vali Acc: 0.744 Test Loss: 0.833 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8854465484619141
Epoch: 26, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.810 Vali Acc: 0.733 Test Loss: 0.810 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8178460597991943
Epoch: 27, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.843 Vali Acc: 0.739 Test Loss: 0.843 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8859665393829346
Epoch: 28, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9446816444396973
Epoch: 29, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.819 Vali Acc: 0.761 Test Loss: 0.819 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 30 cost time: 0.8535661697387695
Epoch: 30, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.813 Vali Acc: 0.756 Test Loss: 0.813 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8898460865020752
Epoch: 31, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.830 Vali Acc: 0.739 Test Loss: 0.830 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8663818836212158
Epoch: 32, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.820 Vali Acc: 0.722 Test Loss: 0.820 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9240038394927979
Epoch: 33, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.909080982208252
Epoch: 34, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.812 Vali Acc: 0.761 Test Loss: 0.812 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 35 cost time: 0.8985228538513184
Epoch: 35, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.837 Vali Acc: 0.744 Test Loss: 0.837 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8373353481292725
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.883 Vali Acc: 0.717 Test Loss: 0.883 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9060723781585693
Epoch: 37, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.841 Vali Acc: 0.744 Test Loss: 0.841 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8459663391113281
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8973197937011719
Epoch: 39, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.903 Vali Acc: 0.728 Test Loss: 0.903 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.836169958114624
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.916 Vali Acc: 0.756 Test Loss: 0.916 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8254129886627197
Epoch: 41, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.910 Vali Acc: 0.767 Test Loss: 0.910 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 42 cost time: 0.932891845703125
Epoch: 42, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.886 Vali Acc: 0.744 Test Loss: 0.886 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0422194004058838
Epoch: 43, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.918 Vali Acc: 0.733 Test Loss: 0.918 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9214680194854736
Epoch: 44, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.913 Vali Acc: 0.728 Test Loss: 0.913 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8675744533538818
Epoch: 45, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.940 Vali Acc: 0.739 Test Loss: 0.940 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8675549030303955
Epoch: 46, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.941 Vali Acc: 0.750 Test Loss: 0.941 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8447887897491455
Epoch: 47, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.930 Vali Acc: 0.761 Test Loss: 0.930 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.864858865737915
Epoch: 48, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9035305976867676
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8843233585357666
Epoch: 50, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.929 Vali Acc: 0.778 Test Loss: 0.929 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777768).  Saving model ...
Epoch: 51 cost time: 0.836406946182251
Epoch: 51, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.968 Vali Acc: 0.756 Test Loss: 0.968 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8217887878417969
Epoch: 52, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.989 Vali Acc: 0.761 Test Loss: 0.989 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8913533687591553
Epoch: 53, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.980 Vali Acc: 0.744 Test Loss: 0.980 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8287465572357178
Epoch: 54, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.964 Vali Acc: 0.761 Test Loss: 0.964 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8932549953460693
Epoch: 55, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.964 Vali Acc: 0.761 Test Loss: 0.964 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.8520541191101074
Epoch: 56, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.979 Vali Acc: 0.767 Test Loss: 0.979 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.7985327243804932
Epoch: 57, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.056 Vali Acc: 0.728 Test Loss: 1.056 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.8086023330688477
Epoch: 58, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.039 Vali Acc: 0.767 Test Loss: 1.039 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8192276954650879
Epoch: 59, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.017 Vali Acc: 0.744 Test Loss: 1.017 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.7910974025726318
Epoch: 60, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.053 Vali Acc: 0.756 Test Loss: 1.053 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 117967
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.241528272628784
Epoch: 1, Steps: 12 | Train Loss: 2.869 Vali Loss: 2.726 Vali Acc: 0.056 Test Loss: 2.726 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.8150308132171631
Epoch: 2, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.545 Vali Acc: 0.156 Test Loss: 2.545 Test Acc: 0.156
Validation loss decreased (-0.055528 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 0.8334832191467285
Epoch: 3, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.317 Vali Acc: 0.294 Test Loss: 2.317 Test Acc: 0.294
Validation loss decreased (-0.155530 --> -0.294421).  Saving model ...
Epoch: 4 cost time: 0.8490848541259766
Epoch: 4, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.101 Vali Acc: 0.406 Test Loss: 2.101 Test Acc: 0.406
Validation loss decreased (-0.294421 --> -0.405535).  Saving model ...
Epoch: 5 cost time: 0.797278642654419
Epoch: 5, Steps: 12 | Train Loss: 1.988 Vali Loss: 1.916 Vali Acc: 0.450 Test Loss: 1.916 Test Acc: 0.450
Validation loss decreased (-0.405535 --> -0.449981).  Saving model ...
Epoch: 6 cost time: 0.8320925235748291
Epoch: 6, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.765 Vali Acc: 0.528 Test Loss: 1.765 Test Acc: 0.528
Validation loss decreased (-0.449981 --> -0.527760).  Saving model ...
Epoch: 7 cost time: 0.8190329074859619
Epoch: 7, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.631 Vali Acc: 0.544 Test Loss: 1.631 Test Acc: 0.544
Validation loss decreased (-0.527760 --> -0.544428).  Saving model ...
Epoch: 8 cost time: 0.8372337818145752
Epoch: 8, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.530 Vali Acc: 0.561 Test Loss: 1.530 Test Acc: 0.561
Validation loss decreased (-0.544428 --> -0.561096).  Saving model ...
Epoch: 9 cost time: 0.8316004276275635
Epoch: 9, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.446 Vali Acc: 0.572 Test Loss: 1.446 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 10 cost time: 0.8615701198577881
Epoch: 10, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.366 Vali Acc: 0.583 Test Loss: 1.366 Test Acc: 0.583
Validation loss decreased (-0.572208 --> -0.583320).  Saving model ...
Epoch: 11 cost time: 0.8065366744995117
Epoch: 11, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.296 Vali Acc: 0.594 Test Loss: 1.296 Test Acc: 0.594
Validation loss decreased (-0.583320 --> -0.594431).  Saving model ...
Epoch: 12 cost time: 0.8018655776977539
Epoch: 12, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.242 Vali Acc: 0.633 Test Loss: 1.242 Test Acc: 0.633
Validation loss decreased (-0.594431 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 0.8222765922546387
Epoch: 13, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.183 Vali Acc: 0.639 Test Loss: 1.183 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 14 cost time: 0.8151674270629883
Epoch: 14, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.121 Vali Acc: 0.639 Test Loss: 1.121 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638878).  Saving model ...
Epoch: 15 cost time: 0.7837255001068115
Epoch: 15, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 0.7680351734161377
Epoch: 16, Steps: 12 | Train Loss: 0.679 Vali Loss: 1.023 Vali Acc: 0.678 Test Loss: 1.023 Test Acc: 0.678
Validation loss decreased (-0.649989 --> -0.677768).  Saving model ...
Epoch: 17 cost time: 0.7661533355712891
Epoch: 17, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.953 Vali Acc: 0.694 Test Loss: 0.953 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 18 cost time: 0.790351152420044
Epoch: 18, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.933 Vali Acc: 0.694 Test Loss: 0.933 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 19 cost time: 0.7593443393707275
Epoch: 19, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.904 Vali Acc: 0.706 Test Loss: 0.904 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 20 cost time: 0.7943897247314453
Epoch: 20, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.874 Vali Acc: 0.717 Test Loss: 0.874 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716658).  Saving model ...
Epoch: 21 cost time: 0.7378051280975342
Epoch: 21, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.867 Vali Acc: 0.733 Test Loss: 0.867 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733325).  Saving model ...
Epoch: 22 cost time: 0.8034079074859619
Epoch: 22, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.865 Vali Acc: 0.711 Test Loss: 0.865 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8161389827728271
Epoch: 23, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.823 Vali Acc: 0.744 Test Loss: 0.823 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 0.7877354621887207
Epoch: 24, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.816 Vali Acc: 0.744 Test Loss: 0.816 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 25 cost time: 0.8001406192779541
Epoch: 25, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8565409183502197
Epoch: 26, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 27 cost time: 0.8045773506164551
Epoch: 27, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.808 Vali Acc: 0.761 Test Loss: 0.808 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 28 cost time: 0.8412206172943115
Epoch: 28, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.804 Vali Acc: 0.772 Test Loss: 0.804 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 29 cost time: 0.8026468753814697
Epoch: 29, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.799 Vali Acc: 0.772 Test Loss: 0.799 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 30 cost time: 0.9189128875732422
Epoch: 30, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.807 Vali Acc: 0.761 Test Loss: 0.807 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8929297924041748
Epoch: 31, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7204773426055908
Epoch: 32, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.803 Vali Acc: 0.772 Test Loss: 0.803 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8681466579437256
Epoch: 33, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.830 Vali Acc: 0.772 Test Loss: 0.830 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7757976055145264
Epoch: 34, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8360915184020996
Epoch: 35, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.813 Vali Acc: 0.767 Test Loss: 0.813 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8336367607116699
Epoch: 36, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.820 Vali Acc: 0.778 Test Loss: 0.820 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 37 cost time: 0.8548696041107178
Epoch: 37, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.816 Vali Acc: 0.783 Test Loss: 0.816 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 38 cost time: 0.8795573711395264
Epoch: 38, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.830 Vali Acc: 0.778 Test Loss: 0.830 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8221392631530762
Epoch: 39, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8011696338653564
Epoch: 40, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.812 Vali Acc: 0.778 Test Loss: 0.812 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7856435775756836
Epoch: 41, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.841 Vali Acc: 0.767 Test Loss: 0.841 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6610915660858154
Epoch: 42, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.848 Vali Acc: 0.772 Test Loss: 0.848 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7638101577758789
Epoch: 43, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.859 Vali Acc: 0.767 Test Loss: 0.859 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8162243366241455
Epoch: 44, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.900 Vali Acc: 0.761 Test Loss: 0.900 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8603613376617432
Epoch: 45, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.894 Vali Acc: 0.767 Test Loss: 0.894 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.793126106262207
Epoch: 46, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.868 Vali Acc: 0.772 Test Loss: 0.868 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7875025272369385
Epoch: 47, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.881 Vali Acc: 0.761 Test Loss: 0.881 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 114319
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3592443466186523
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.517 Vali Acc: 0.133 Test Loss: 2.517 Test Acc: 0.133
Validation loss decreased (inf --> -0.133308).  Saving model ...
Epoch: 2 cost time: 0.8704128265380859
Epoch: 2, Steps: 12 | Train Loss: 2.263 Vali Loss: 1.995 Vali Acc: 0.411 Test Loss: 1.995 Test Acc: 0.411
Validation loss decreased (-0.133308 --> -0.411091).  Saving model ...
Epoch: 3 cost time: 0.7706856727600098
Epoch: 3, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.656 Vali Acc: 0.467 Test Loss: 1.656 Test Acc: 0.467
Validation loss decreased (-0.411091 --> -0.466650).  Saving model ...
Epoch: 4 cost time: 0.7956862449645996
Epoch: 4, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.440 Vali Acc: 0.556 Test Loss: 1.440 Test Acc: 0.556
Validation loss decreased (-0.466650 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 0.8118884563446045
Epoch: 5, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.325 Vali Acc: 0.583 Test Loss: 1.325 Test Acc: 0.583
Validation loss decreased (-0.555541 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 0.7777285575866699
Epoch: 6, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.279 Vali Acc: 0.622 Test Loss: 1.279 Test Acc: 0.622
Validation loss decreased (-0.583320 --> -0.622209).  Saving model ...
Epoch: 7 cost time: 0.8521926403045654
Epoch: 7, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.228 Vali Acc: 0.628 Test Loss: 1.228 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 8 cost time: 0.8655483722686768
Epoch: 8, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.144 Vali Acc: 0.683 Test Loss: 1.144 Test Acc: 0.683
Validation loss decreased (-0.627765 --> -0.683322).  Saving model ...
Epoch: 9 cost time: 0.7593677043914795
Epoch: 9, Steps: 12 | Train Loss: 0.588 Vali Loss: 1.147 Vali Acc: 0.678 Test Loss: 1.147 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7235629558563232
Epoch: 10, Steps: 12 | Train Loss: 0.517 Vali Loss: 1.046 Vali Acc: 0.683 Test Loss: 1.046 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 0.737694501876831
Epoch: 11, Steps: 12 | Train Loss: 0.448 Vali Loss: 1.040 Vali Acc: 0.683 Test Loss: 1.040 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 12 cost time: 0.7839088439941406
Epoch: 12, Steps: 12 | Train Loss: 0.348 Vali Loss: 1.061 Vali Acc: 0.711 Test Loss: 1.061 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 0.7913722991943359
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 1.082 Vali Acc: 0.694 Test Loss: 1.082 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.746497631072998
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.040 Vali Acc: 0.722 Test Loss: 1.040 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 15 cost time: 0.8142764568328857
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.099 Vali Acc: 0.733 Test Loss: 1.099 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733322).  Saving model ...
Epoch: 16 cost time: 0.7732858657836914
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 1.112 Vali Acc: 0.722 Test Loss: 1.112 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.759453535079956
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.154 Vali Acc: 0.750 Test Loss: 1.154 Test Acc: 0.750
Validation loss decreased (-0.733322 --> -0.749988).  Saving model ...
Epoch: 18 cost time: 0.7610878944396973
Epoch: 18, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.178 Vali Acc: 0.728 Test Loss: 1.178 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8284204006195068
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.185 Vali Acc: 0.739 Test Loss: 1.185 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8576650619506836
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.214 Vali Acc: 0.733 Test Loss: 1.214 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8577795028686523
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.330 Vali Acc: 0.733 Test Loss: 1.330 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7584891319274902
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.340 Vali Acc: 0.733 Test Loss: 1.340 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8430936336517334
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.349 Vali Acc: 0.728 Test Loss: 1.349 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7884650230407715
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.416 Vali Acc: 0.728 Test Loss: 1.416 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.829700231552124
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.408 Vali Acc: 0.739 Test Loss: 1.408 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.840585470199585
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.407 Vali Acc: 0.739 Test Loss: 1.407 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8813538551330566
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.455 Vali Acc: 0.744 Test Loss: 1.455 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 153615
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.317599058151245
Epoch: 1, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.545 Vali Acc: 0.211 Test Loss: 2.545 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 0.808112382888794
Epoch: 2, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.200 Vali Acc: 0.378 Test Loss: 2.200 Test Acc: 0.378
Validation loss decreased (-0.211086 --> -0.377756).  Saving model ...
Epoch: 3 cost time: 0.7633569240570068
Epoch: 3, Steps: 12 | Train Loss: 2.025 Vali Loss: 1.886 Vali Acc: 0.422 Test Loss: 1.886 Test Acc: 0.422
Validation loss decreased (-0.377756 --> -0.422203).  Saving model ...
Epoch: 4 cost time: 0.8498268127441406
Epoch: 4, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.663 Vali Acc: 0.517 Test Loss: 1.663 Test Acc: 0.517
Validation loss decreased (-0.422203 --> -0.516650).  Saving model ...
Epoch: 5 cost time: 0.7966134548187256
Epoch: 5, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.499 Vali Acc: 0.550 Test Loss: 1.499 Test Acc: 0.550
Validation loss decreased (-0.516650 --> -0.549985).  Saving model ...
Epoch: 6 cost time: 0.8668661117553711
Epoch: 6, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.373 Vali Acc: 0.600 Test Loss: 1.373 Test Acc: 0.600
Validation loss decreased (-0.549985 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 0.7564270496368408
Epoch: 7, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.322 Vali Acc: 0.589 Test Loss: 1.322 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.798992395401001
Epoch: 8, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.235 Vali Acc: 0.639 Test Loss: 1.235 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 0.7991254329681396
Epoch: 9, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.179 Vali Acc: 0.639 Test Loss: 1.179 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 10 cost time: 0.7881689071655273
Epoch: 10, Steps: 12 | Train Loss: 0.731 Vali Loss: 1.132 Vali Acc: 0.644 Test Loss: 1.132 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 11 cost time: 0.7843818664550781
Epoch: 11, Steps: 12 | Train Loss: 0.625 Vali Loss: 1.099 Vali Acc: 0.689 Test Loss: 1.099 Test Acc: 0.689
Validation loss decreased (-0.644433 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 0.8277835845947266
Epoch: 12, Steps: 12 | Train Loss: 0.563 Vali Loss: 1.090 Vali Acc: 0.672 Test Loss: 1.090 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7438840866088867
Epoch: 13, Steps: 12 | Train Loss: 0.475 Vali Loss: 1.044 Vali Acc: 0.672 Test Loss: 1.044 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8411581516265869
Epoch: 14, Steps: 12 | Train Loss: 0.429 Vali Loss: 1.014 Vali Acc: 0.711 Test Loss: 1.014 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711101).  Saving model ...
Epoch: 15 cost time: 0.8321826457977295
Epoch: 15, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8482239246368408
Epoch: 16, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.995 Vali Acc: 0.728 Test Loss: 0.995 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 17 cost time: 0.8234331607818604
Epoch: 17, Steps: 12 | Train Loss: 0.279 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8824784755706787
Epoch: 18, Steps: 12 | Train Loss: 0.246 Vali Loss: 1.016 Vali Acc: 0.694 Test Loss: 1.016 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8278534412384033
Epoch: 19, Steps: 12 | Train Loss: 0.230 Vali Loss: 1.015 Vali Acc: 0.750 Test Loss: 1.015 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 0.8244102001190186
Epoch: 20, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.044 Vali Acc: 0.750 Test Loss: 1.044 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8543257713317871
Epoch: 21, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.054 Vali Acc: 0.739 Test Loss: 1.054 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9038586616516113
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.081 Vali Acc: 0.739 Test Loss: 1.081 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8487913608551025
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.074 Vali Acc: 0.756 Test Loss: 1.074 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755545).  Saving model ...
Epoch: 24 cost time: 0.8640058040618896
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.138 Vali Acc: 0.717 Test Loss: 1.138 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9179821014404297
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.084 Vali Acc: 0.761 Test Loss: 1.084 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761100).  Saving model ...
Epoch: 26 cost time: 0.8519599437713623
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.105 Vali Acc: 0.756 Test Loss: 1.105 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8519306182861328
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.105 Vali Acc: 0.756 Test Loss: 1.105 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8390729427337646
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.200 Vali Acc: 0.739 Test Loss: 1.200 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8845577239990234
Epoch: 29, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.190 Vali Acc: 0.744 Test Loss: 1.190 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8586516380310059
Epoch: 30, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.197 Vali Acc: 0.744 Test Loss: 1.197 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9053859710693359
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.200 Vali Acc: 0.750 Test Loss: 1.200 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9386732578277588
Epoch: 32, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.215 Vali Acc: 0.750 Test Loss: 1.215 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8690919876098633
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.224 Vali Acc: 0.756 Test Loss: 1.224 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9797263145446777
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.273 Vali Acc: 0.739 Test Loss: 1.273 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8803651332855225
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.279 Vali Acc: 0.750 Test Loss: 1.279 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 111439
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.36189866065979
Epoch: 1, Steps: 12 | Train Loss: 2.833 Vali Loss: 2.679 Vali Acc: 0.089 Test Loss: 2.679 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.8436827659606934
Epoch: 2, Steps: 12 | Train Loss: 2.488 Vali Loss: 2.310 Vali Acc: 0.311 Test Loss: 2.310 Test Acc: 0.311
Validation loss decreased (-0.088862 --> -0.311088).  Saving model ...
Epoch: 3 cost time: 0.8518731594085693
Epoch: 3, Steps: 12 | Train Loss: 2.139 Vali Loss: 1.973 Vali Acc: 0.433 Test Loss: 1.973 Test Acc: 0.433
Validation loss decreased (-0.311088 --> -0.433314).  Saving model ...
Epoch: 4 cost time: 0.8882513046264648
Epoch: 4, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.741 Vali Acc: 0.511 Test Loss: 1.741 Test Acc: 0.511
Validation loss decreased (-0.433314 --> -0.511094).  Saving model ...
Epoch: 5 cost time: 0.8649189472198486
Epoch: 5, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.548 Vali Acc: 0.567 Test Loss: 1.548 Test Acc: 0.567
Validation loss decreased (-0.511094 --> -0.566651).  Saving model ...
Epoch: 6 cost time: 0.8307147026062012
Epoch: 6, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.430 Vali Acc: 0.583 Test Loss: 1.430 Test Acc: 0.583
Validation loss decreased (-0.566651 --> -0.583319).  Saving model ...
Epoch: 7 cost time: 0.9158592224121094
Epoch: 7, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.361 Vali Acc: 0.611 Test Loss: 1.361 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 0.8872535228729248
Epoch: 8, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.305 Vali Acc: 0.639 Test Loss: 1.305 Test Acc: 0.639
Validation loss decreased (-0.611097 --> -0.638876).  Saving model ...
Epoch: 9 cost time: 0.8213386535644531
Epoch: 9, Steps: 12 | Train Loss: 0.803 Vali Loss: 1.260 Vali Acc: 0.628 Test Loss: 1.260 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8286440372467041
Epoch: 10, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.218 Vali Acc: 0.644 Test Loss: 1.218 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 11 cost time: 0.787966251373291
Epoch: 11, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.181 Vali Acc: 0.644 Test Loss: 1.181 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644433).  Saving model ...
Epoch: 12 cost time: 0.7793965339660645
Epoch: 12, Steps: 12 | Train Loss: 0.574 Vali Loss: 1.134 Vali Acc: 0.667 Test Loss: 1.134 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.807767391204834
Epoch: 13, Steps: 12 | Train Loss: 0.502 Vali Loss: 1.078 Vali Acc: 0.661 Test Loss: 1.078 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8668613433837891
Epoch: 14, Steps: 12 | Train Loss: 0.504 Vali Loss: 1.008 Vali Acc: 0.739 Test Loss: 1.008 Test Acc: 0.739
Validation loss decreased (-0.666655 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.8228518962860107
Epoch: 15, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.968 Vali Acc: 0.728 Test Loss: 0.968 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8067307472229004
Epoch: 16, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.980 Vali Acc: 0.728 Test Loss: 0.980 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9789445400238037
Epoch: 17, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.940 Vali Acc: 0.750 Test Loss: 0.940 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.8132801055908203
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.962 Vali Acc: 0.733 Test Loss: 0.962 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7982578277587891
Epoch: 19, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.984 Vali Acc: 0.761 Test Loss: 0.984 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761101).  Saving model ...
Epoch: 20 cost time: 0.866553783416748
Epoch: 20, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.987 Vali Acc: 0.744 Test Loss: 0.987 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9071173667907715
Epoch: 21, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.020 Vali Acc: 0.750 Test Loss: 1.020 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.908158540725708
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.028 Vali Acc: 0.756 Test Loss: 1.028 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8118994235992432
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.033 Vali Acc: 0.756 Test Loss: 1.033 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8555324077606201
Epoch: 24, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.039 Vali Acc: 0.733 Test Loss: 1.039 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8998725414276123
Epoch: 25, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.076 Vali Acc: 0.750 Test Loss: 1.076 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7937095165252686
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.057 Vali Acc: 0.772 Test Loss: 1.057 Test Acc: 0.772
Validation loss decreased (-0.761101 --> -0.772212).  Saving model ...
Epoch: 27 cost time: 0.7623066902160645
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.111 Vali Acc: 0.756 Test Loss: 1.111 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7924370765686035
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.152 Vali Acc: 0.750 Test Loss: 1.152 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8113453388214111
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.162 Vali Acc: 0.750 Test Loss: 1.162 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8334145545959473
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.138 Vali Acc: 0.756 Test Loss: 1.138 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8564629554748535
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.164 Vali Acc: 0.750 Test Loss: 1.164 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8461208343505859
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.178 Vali Acc: 0.756 Test Loss: 1.178 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8523702621459961
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.206 Vali Acc: 0.750 Test Loss: 1.206 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9206447601318359
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.197 Vali Acc: 0.783 Test Loss: 1.197 Test Acc: 0.783
Validation loss decreased (-0.772212 --> -0.783321).  Saving model ...
Epoch: 35 cost time: 0.8984334468841553
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.236 Vali Acc: 0.767 Test Loss: 1.236 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.905867338180542
Epoch: 36, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.267 Vali Acc: 0.756 Test Loss: 1.267 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9115426540374756
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.265 Vali Acc: 0.756 Test Loss: 1.265 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9161324501037598
Epoch: 38, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.285 Vali Acc: 0.750 Test Loss: 1.285 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8362562656402588
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.249 Vali Acc: 0.739 Test Loss: 1.249 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8910059928894043
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.296 Vali Acc: 0.750 Test Loss: 1.296 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8560137748718262
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.349 Vali Acc: 0.739 Test Loss: 1.349 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9107415676116943
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.314 Vali Acc: 0.744 Test Loss: 1.314 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8400101661682129
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.313 Vali Acc: 0.744 Test Loss: 1.313 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9679536819458008
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.330 Vali Acc: 0.750 Test Loss: 1.330 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 109583
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3026278018951416
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.667 Vali Acc: 0.078 Test Loss: 2.667 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.7875046730041504
Epoch: 2, Steps: 12 | Train Loss: 2.531 Vali Loss: 2.368 Vali Acc: 0.206 Test Loss: 2.368 Test Acc: 0.206
Validation loss decreased (-0.077751 --> -0.205532).  Saving model ...
Epoch: 3 cost time: 0.798858642578125
Epoch: 3, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.045 Vali Acc: 0.422 Test Loss: 2.045 Test Acc: 0.422
Validation loss decreased (-0.205532 --> -0.422202).  Saving model ...
Epoch: 4 cost time: 0.8944764137268066
Epoch: 4, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.792 Vali Acc: 0.517 Test Loss: 1.792 Test Acc: 0.517
Validation loss decreased (-0.422202 --> -0.516649).  Saving model ...
Epoch: 5 cost time: 0.9267258644104004
Epoch: 5, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.617 Vali Acc: 0.556 Test Loss: 1.617 Test Acc: 0.556
Validation loss decreased (-0.516649 --> -0.555539).  Saving model ...
Epoch: 6 cost time: 0.7836325168609619
Epoch: 6, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.492 Vali Acc: 0.567 Test Loss: 1.492 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566652).  Saving model ...
Epoch: 7 cost time: 0.8051111698150635
Epoch: 7, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.401 Vali Acc: 0.611 Test Loss: 1.401 Test Acc: 0.611
Validation loss decreased (-0.566652 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 0.7590789794921875
Epoch: 8, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.357 Vali Acc: 0.628 Test Loss: 1.357 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627764).  Saving model ...
Epoch: 9 cost time: 0.7905592918395996
Epoch: 9, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.313 Vali Acc: 0.622 Test Loss: 1.313 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8649313449859619
Epoch: 10, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.252 Vali Acc: 0.633 Test Loss: 1.252 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 0.875093936920166
Epoch: 11, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.205 Vali Acc: 0.667 Test Loss: 1.205 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 0.8664219379425049
Epoch: 12, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.168 Vali Acc: 0.667 Test Loss: 1.168 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.8655610084533691
Epoch: 13, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.139 Vali Acc: 0.694 Test Loss: 1.139 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694433).  Saving model ...
Epoch: 14 cost time: 0.9014678001403809
Epoch: 14, Steps: 12 | Train Loss: 0.590 Vali Loss: 1.102 Vali Acc: 0.667 Test Loss: 1.102 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0000171661376953
Epoch: 15, Steps: 12 | Train Loss: 0.549 Vali Loss: 1.065 Vali Acc: 0.689 Test Loss: 1.065 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8915469646453857
Epoch: 16, Steps: 12 | Train Loss: 0.450 Vali Loss: 1.020 Vali Acc: 0.706 Test Loss: 1.020 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705545).  Saving model ...
Epoch: 17 cost time: 0.8905105590820312
Epoch: 17, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.992 Vali Acc: 0.739 Test Loss: 0.992 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738879).  Saving model ...
Epoch: 18 cost time: 0.8376502990722656
Epoch: 18, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.990 Vali Acc: 0.722 Test Loss: 0.990 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9603173732757568
Epoch: 19, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.8522036075592041
Epoch: 20, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.939 Vali Acc: 0.767 Test Loss: 0.939 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766657).  Saving model ...
Epoch: 21 cost time: 0.9243927001953125
Epoch: 21, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.942 Vali Acc: 0.744 Test Loss: 0.942 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8477394580841064
Epoch: 22, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.977 Vali Acc: 0.744 Test Loss: 0.977 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8657505512237549
Epoch: 23, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.987 Vali Acc: 0.733 Test Loss: 0.987 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8108212947845459
Epoch: 24, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.964 Vali Acc: 0.739 Test Loss: 0.964 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8295750617980957
Epoch: 25, Steps: 12 | Train Loss: 0.171 Vali Loss: 1.006 Vali Acc: 0.756 Test Loss: 1.006 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.773956298828125
Epoch: 26, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.004 Vali Acc: 0.744 Test Loss: 1.004 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7774393558502197
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.982 Vali Acc: 0.756 Test Loss: 0.982 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8512756824493408
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.023 Vali Acc: 0.750 Test Loss: 1.023 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8853495121002197
Epoch: 29, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.015 Vali Acc: 0.772 Test Loss: 1.015 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772212).  Saving model ...
Epoch: 30 cost time: 0.8327174186706543
Epoch: 30, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.011 Vali Acc: 0.761 Test Loss: 1.011 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9359681606292725
Epoch: 31, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8483800888061523
Epoch: 32, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.018 Vali Acc: 0.761 Test Loss: 1.018 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7832887172698975
Epoch: 33, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.015 Vali Acc: 0.772 Test Loss: 1.015 Test Acc: 0.772
Validation loss decreased (-0.772212 --> -0.772212).  Saving model ...
Epoch: 34 cost time: 0.8645949363708496
Epoch: 34, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.043 Vali Acc: 0.767 Test Loss: 1.043 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8787441253662109
Epoch: 35, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.073 Vali Acc: 0.756 Test Loss: 1.073 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8365423679351807
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.051 Vali Acc: 0.778 Test Loss: 1.051 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777767).  Saving model ...
Epoch: 37 cost time: 0.871016263961792
Epoch: 37, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.071 Vali Acc: 0.783 Test Loss: 1.071 Test Acc: 0.783
Validation loss decreased (-0.777767 --> -0.783323).  Saving model ...
Epoch: 38 cost time: 0.8753070831298828
Epoch: 38, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.122 Vali Acc: 0.772 Test Loss: 1.122 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8911721706390381
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.085 Vali Acc: 0.783 Test Loss: 1.085 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8466224670410156
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.107 Vali Acc: 0.756 Test Loss: 1.107 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8025166988372803
Epoch: 41, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.125 Vali Acc: 0.767 Test Loss: 1.125 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7892653942108154
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.160 Vali Acc: 0.761 Test Loss: 1.160 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8359019756317139
Epoch: 43, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.126 Vali Acc: 0.778 Test Loss: 1.126 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.845116376876831
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.150 Vali Acc: 0.778 Test Loss: 1.150 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8535254001617432
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.179 Vali Acc: 0.761 Test Loss: 1.179 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9331107139587402
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.176 Vali Acc: 0.761 Test Loss: 1.176 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8655774593353271
Epoch: 47, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.210 Vali Acc: 0.761 Test Loss: 1.210 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 96207
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1904914379119873
Epoch: 1, Steps: 12 | Train Loss: 2.886 Vali Loss: 2.697 Vali Acc: 0.139 Test Loss: 2.697 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.8372001647949219
Epoch: 2, Steps: 12 | Train Loss: 2.676 Vali Loss: 2.487 Vali Acc: 0.189 Test Loss: 2.487 Test Acc: 0.189
Validation loss decreased (-0.138862 --> -0.188864).  Saving model ...
Epoch: 3 cost time: 0.820711612701416
Epoch: 3, Steps: 12 | Train Loss: 2.365 Vali Loss: 2.235 Vali Acc: 0.344 Test Loss: 2.235 Test Acc: 0.344
Validation loss decreased (-0.188864 --> -0.344422).  Saving model ...
Epoch: 4 cost time: 0.8763480186462402
Epoch: 4, Steps: 12 | Train Loss: 2.086 Vali Loss: 2.000 Vali Acc: 0.428 Test Loss: 2.000 Test Acc: 0.428
Validation loss decreased (-0.344422 --> -0.427758).  Saving model ...
Epoch: 5 cost time: 0.8405921459197998
Epoch: 5, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.814 Vali Acc: 0.506 Test Loss: 1.814 Test Acc: 0.506
Validation loss decreased (-0.427758 --> -0.505537).  Saving model ...
Epoch: 6 cost time: 0.9245889186859131
Epoch: 6, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.664 Vali Acc: 0.544 Test Loss: 1.664 Test Acc: 0.544
Validation loss decreased (-0.505537 --> -0.544428).  Saving model ...
Epoch: 7 cost time: 0.9056587219238281
Epoch: 7, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.533 Vali Acc: 0.578 Test Loss: 1.533 Test Acc: 0.578
Validation loss decreased (-0.544428 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 0.8552210330963135
Epoch: 8, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.438 Vali Acc: 0.589 Test Loss: 1.438 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588875).  Saving model ...
Epoch: 9 cost time: 0.928823709487915
Epoch: 9, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.392 Vali Acc: 0.578 Test Loss: 1.392 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7999470233917236
Epoch: 10, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.346 Vali Acc: 0.606 Test Loss: 1.346 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605542).  Saving model ...
Epoch: 11 cost time: 0.7886552810668945
Epoch: 11, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.275 Vali Acc: 0.622 Test Loss: 1.275 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 12 cost time: 0.8267643451690674
Epoch: 12, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.234 Vali Acc: 0.644 Test Loss: 1.234 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644432).  Saving model ...
Epoch: 13 cost time: 0.832878828048706
Epoch: 13, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.193 Vali Acc: 0.656 Test Loss: 1.193 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 0.7798123359680176
Epoch: 14, Steps: 12 | Train Loss: 0.745 Vali Loss: 1.158 Vali Acc: 0.639 Test Loss: 1.158 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7763683795928955
Epoch: 15, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.096 Vali Acc: 0.661 Test Loss: 1.096 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 16 cost time: 0.8439757823944092
Epoch: 16, Steps: 12 | Train Loss: 0.582 Vali Loss: 1.061 Vali Acc: 0.683 Test Loss: 1.061 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683323).  Saving model ...
Epoch: 17 cost time: 0.7781610488891602
Epoch: 17, Steps: 12 | Train Loss: 0.515 Vali Loss: 1.045 Vali Acc: 0.678 Test Loss: 1.045 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8528263568878174
Epoch: 18, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.984 Vali Acc: 0.706 Test Loss: 0.984 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 19 cost time: 0.7966043949127197
Epoch: 19, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.950 Vali Acc: 0.711 Test Loss: 0.950 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 20 cost time: 0.8509297370910645
Epoch: 20, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.937 Vali Acc: 0.706 Test Loss: 0.937 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8872866630554199
Epoch: 21, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.893 Vali Acc: 0.733 Test Loss: 0.893 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733324).  Saving model ...
Epoch: 22 cost time: 0.8853187561035156
Epoch: 22, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.873 Vali Acc: 0.744 Test Loss: 0.873 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 23 cost time: 0.909031867980957
Epoch: 23, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.882 Vali Acc: 0.744 Test Loss: 0.882 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9409041404724121
Epoch: 24, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.859 Vali Acc: 0.756 Test Loss: 0.859 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 25 cost time: 0.8111152648925781
Epoch: 25, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.850 Vali Acc: 0.744 Test Loss: 0.850 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8023092746734619
Epoch: 26, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.876 Vali Acc: 0.744 Test Loss: 0.876 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8674159049987793
Epoch: 27, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.875 Vali Acc: 0.761 Test Loss: 0.875 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 28 cost time: 0.9141368865966797
Epoch: 28, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.862 Vali Acc: 0.767 Test Loss: 0.862 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 29 cost time: 0.8196361064910889
Epoch: 29, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.871 Vali Acc: 0.772 Test Loss: 0.871 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 30 cost time: 0.8423476219177246
Epoch: 30, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.864 Vali Acc: 0.756 Test Loss: 0.864 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8754599094390869
Epoch: 31, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.910 Vali Acc: 0.739 Test Loss: 0.910 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7486586570739746
Epoch: 32, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8248717784881592
Epoch: 33, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.896 Vali Acc: 0.767 Test Loss: 0.896 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.825268030166626
Epoch: 34, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.900 Vali Acc: 0.761 Test Loss: 0.900 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.867992639541626
Epoch: 35, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.924 Vali Acc: 0.750 Test Loss: 0.924 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8977236747741699
Epoch: 36, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.934 Vali Acc: 0.767 Test Loss: 0.934 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8488328456878662
Epoch: 37, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.951 Vali Acc: 0.756 Test Loss: 0.951 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8950319290161133
Epoch: 38, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.954 Vali Acc: 0.756 Test Loss: 0.954 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9066760540008545
Epoch: 39, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.963 Vali Acc: 0.756 Test Loss: 0.963 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 88655
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4037506580352783
Epoch: 1, Steps: 12 | Train Loss: 2.888 Vali Loss: 2.736 Vali Acc: 0.022 Test Loss: 2.736 Test Acc: 0.022
Validation loss decreased (inf --> -0.022195).  Saving model ...
Epoch: 2 cost time: 0.814805269241333
Epoch: 2, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.527 Vali Acc: 0.150 Test Loss: 2.527 Test Acc: 0.150
Validation loss decreased (-0.022195 --> -0.149975).  Saving model ...
Epoch: 3 cost time: 0.8175818920135498
Epoch: 3, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.289 Vali Acc: 0.356 Test Loss: 2.289 Test Acc: 0.356
Validation loss decreased (-0.149975 --> -0.355533).  Saving model ...
Epoch: 4 cost time: 0.7792856693267822
Epoch: 4, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.054 Vali Acc: 0.494 Test Loss: 2.054 Test Acc: 0.494
Validation loss decreased (-0.355533 --> -0.494424).  Saving model ...
Epoch: 5 cost time: 0.8039541244506836
Epoch: 5, Steps: 12 | Train Loss: 1.963 Vali Loss: 1.865 Vali Acc: 0.500 Test Loss: 1.865 Test Acc: 0.500
Validation loss decreased (-0.494424 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 0.7628459930419922
Epoch: 6, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.706 Vali Acc: 0.572 Test Loss: 1.706 Test Acc: 0.572
Validation loss decreased (-0.499981 --> -0.572205).  Saving model ...
Epoch: 7 cost time: 0.8242995738983154
Epoch: 7, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.564 Vali Acc: 0.583 Test Loss: 1.564 Test Acc: 0.583
Validation loss decreased (-0.572205 --> -0.583318).  Saving model ...
Epoch: 8 cost time: 0.7958652973175049
Epoch: 8, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.469 Vali Acc: 0.572 Test Loss: 1.469 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7612133026123047
Epoch: 9, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.393 Vali Acc: 0.594 Test Loss: 1.393 Test Acc: 0.594
Validation loss decreased (-0.583318 --> -0.594431).  Saving model ...
Epoch: 10 cost time: 0.7562727928161621
Epoch: 10, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.301 Vali Acc: 0.606 Test Loss: 1.301 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 11 cost time: 0.7951931953430176
Epoch: 11, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.252 Vali Acc: 0.644 Test Loss: 1.252 Test Acc: 0.644
Validation loss decreased (-0.605543 --> -0.644432).  Saving model ...
Epoch: 12 cost time: 0.8308732509613037
Epoch: 12, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.193 Vali Acc: 0.639 Test Loss: 1.193 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8275690078735352
Epoch: 13, Steps: 12 | Train Loss: 0.806 Vali Loss: 1.147 Vali Acc: 0.661 Test Loss: 1.147 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 0.7820611000061035
Epoch: 14, Steps: 12 | Train Loss: 0.762 Vali Loss: 1.095 Vali Acc: 0.650 Test Loss: 1.095 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7788755893707275
Epoch: 15, Steps: 12 | Train Loss: 0.655 Vali Loss: 1.031 Vali Acc: 0.672 Test Loss: 1.031 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 16 cost time: 0.787700891494751
Epoch: 16, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.980 Vali Acc: 0.683 Test Loss: 0.980 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 17 cost time: 0.7884798049926758
Epoch: 17, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.995 Vali Acc: 0.672 Test Loss: 0.995 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.828885555267334
Epoch: 18, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.934 Vali Acc: 0.700 Test Loss: 0.934 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 0.8229422569274902
Epoch: 19, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.890 Vali Acc: 0.728 Test Loss: 0.890 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 20 cost time: 0.8019311428070068
Epoch: 20, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.885 Vali Acc: 0.739 Test Loss: 0.885 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 21 cost time: 0.7479043006896973
Epoch: 21, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.845 Vali Acc: 0.733 Test Loss: 0.845 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7443673610687256
Epoch: 22, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 0.8787038326263428
Epoch: 23, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.831 Vali Acc: 0.733 Test Loss: 0.831 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7867863178253174
Epoch: 24, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.736088752746582
Epoch: 25, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 26 cost time: 0.7982883453369141
Epoch: 26, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 0.8628771305084229
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.827 Vali Acc: 0.739 Test Loss: 0.827 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7755069732666016
Epoch: 28, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.825 Vali Acc: 0.739 Test Loss: 0.825 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7969317436218262
Epoch: 29, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.814 Vali Acc: 0.728 Test Loss: 0.814 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7784581184387207
Epoch: 30, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.874 Vali Acc: 0.722 Test Loss: 0.874 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.841921329498291
Epoch: 31, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.811 Vali Acc: 0.733 Test Loss: 0.811 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7953965663909912
Epoch: 32, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.804 Vali Acc: 0.761 Test Loss: 0.804 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 33 cost time: 0.7977766990661621
Epoch: 33, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8067107200622559
Epoch: 34, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.828 Vali Acc: 0.739 Test Loss: 0.828 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8254456520080566
Epoch: 35, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8175222873687744
Epoch: 36, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.836 Vali Acc: 0.744 Test Loss: 0.836 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7361671924591064
Epoch: 37, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.857 Vali Acc: 0.739 Test Loss: 0.857 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7644143104553223
Epoch: 38, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.853 Vali Acc: 0.744 Test Loss: 0.853 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.846837043762207
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.870 Vali Acc: 0.733 Test Loss: 0.870 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8443276882171631
Epoch: 40, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.882 Vali Acc: 0.733 Test Loss: 0.882 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7854592800140381
Epoch: 41, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.888 Vali Acc: 0.739 Test Loss: 0.888 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7769854068756104
Epoch: 42, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.906 Vali Acc: 0.744 Test Loss: 0.906 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 84943
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1789028644561768
Epoch: 1, Steps: 12 | Train Loss: 2.826 Vali Loss: 2.701 Vali Acc: 0.117 Test Loss: 2.701 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.7503883838653564
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.569 Vali Acc: 0.178 Test Loss: 2.569 Test Acc: 0.178
Validation loss decreased (-0.116640 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 0.7499375343322754
Epoch: 3, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.389 Vali Acc: 0.261 Test Loss: 2.389 Test Acc: 0.261
Validation loss decreased (-0.177752 --> -0.261087).  Saving model ...
Epoch: 4 cost time: 0.7907929420471191
Epoch: 4, Steps: 12 | Train Loss: 2.352 Vali Loss: 2.193 Vali Acc: 0.344 Test Loss: 2.193 Test Acc: 0.344
Validation loss decreased (-0.261087 --> -0.344423).  Saving model ...
Epoch: 5 cost time: 0.7587985992431641
Epoch: 5, Steps: 12 | Train Loss: 2.048 Vali Loss: 1.999 Vali Acc: 0.394 Test Loss: 1.999 Test Acc: 0.394
Validation loss decreased (-0.344423 --> -0.394424).  Saving model ...
Epoch: 6 cost time: 0.7342584133148193
Epoch: 6, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.840 Vali Acc: 0.494 Test Loss: 1.840 Test Acc: 0.494
Validation loss decreased (-0.394424 --> -0.494426).  Saving model ...
Epoch: 7 cost time: 0.7707211971282959
Epoch: 7, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.712 Vali Acc: 0.528 Test Loss: 1.712 Test Acc: 0.528
Validation loss decreased (-0.494426 --> -0.527761).  Saving model ...
Epoch: 8 cost time: 0.7586183547973633
Epoch: 8, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.625 Vali Acc: 0.539 Test Loss: 1.625 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 9 cost time: 0.8820936679840088
Epoch: 9, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.530 Vali Acc: 0.589 Test Loss: 1.530 Test Acc: 0.589
Validation loss decreased (-0.538873 --> -0.588874).  Saving model ...
Epoch: 10 cost time: 0.8026347160339355
Epoch: 10, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.436 Vali Acc: 0.589 Test Loss: 1.436 Test Acc: 0.589
Validation loss decreased (-0.588874 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.8081526756286621
Epoch: 11, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.360 Vali Acc: 0.617 Test Loss: 1.360 Test Acc: 0.617
Validation loss decreased (-0.588875 --> -0.616653).  Saving model ...
Epoch: 12 cost time: 0.7612965106964111
Epoch: 12, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.258 Vali Acc: 0.617 Test Loss: 1.258 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 0.8122782707214355
Epoch: 13, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.183 Vali Acc: 0.656 Test Loss: 1.183 Test Acc: 0.656
Validation loss decreased (-0.616654 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 0.8067221641540527
Epoch: 14, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.113 Vali Acc: 0.667 Test Loss: 1.113 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 15 cost time: 0.7301995754241943
Epoch: 15, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.059 Vali Acc: 0.667 Test Loss: 1.059 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 0.8296322822570801
Epoch: 16, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 17 cost time: 0.807715654373169
Epoch: 17, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.942 Vali Acc: 0.678 Test Loss: 0.942 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677768).  Saving model ...
Epoch: 18 cost time: 0.7457294464111328
Epoch: 18, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.918 Vali Acc: 0.683 Test Loss: 0.918 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 19 cost time: 0.707761287689209
Epoch: 19, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.894 Vali Acc: 0.694 Test Loss: 0.894 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694436).  Saving model ...
Epoch: 20 cost time: 0.7680282592773438
Epoch: 20, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.891 Vali Acc: 0.711 Test Loss: 0.891 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711102).  Saving model ...
Epoch: 21 cost time: 0.7956831455230713
Epoch: 21, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.865 Vali Acc: 0.717 Test Loss: 0.865 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 22 cost time: 0.8109943866729736
Epoch: 22, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.847 Vali Acc: 0.717 Test Loss: 0.847 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 23 cost time: 0.7842812538146973
Epoch: 23, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.824 Vali Acc: 0.733 Test Loss: 0.824 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733325).  Saving model ...
Epoch: 24 cost time: 0.7112598419189453
Epoch: 24, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.812 Vali Acc: 0.756 Test Loss: 0.812 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755547).  Saving model ...
Epoch: 25 cost time: 0.7532236576080322
Epoch: 25, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7502124309539795
Epoch: 26, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 0.7759809494018555
Epoch: 27, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.798 Vali Acc: 0.744 Test Loss: 0.798 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8105247020721436
Epoch: 28, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8169615268707275
Epoch: 29, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.783 Vali Acc: 0.761 Test Loss: 0.783 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 30 cost time: 0.7461690902709961
Epoch: 30, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 31 cost time: 0.7267601490020752
Epoch: 31, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.795 Vali Acc: 0.767 Test Loss: 0.795 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 32 cost time: 0.7199203968048096
Epoch: 32, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.783 Vali Acc: 0.744 Test Loss: 0.783 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.816436767578125
Epoch: 33, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.807 Vali Acc: 0.756 Test Loss: 0.807 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7560250759124756
Epoch: 34, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.826 Vali Acc: 0.761 Test Loss: 0.826 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8075816631317139
Epoch: 35, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.833 Vali Acc: 0.767 Test Loss: 0.833 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7464137077331543
Epoch: 36, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.833 Vali Acc: 0.767 Test Loss: 0.833 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7523229122161865
Epoch: 37, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.794497013092041
Epoch: 38, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.853 Vali Acc: 0.756 Test Loss: 0.853 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7565217018127441
Epoch: 39, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.878 Vali Acc: 0.756 Test Loss: 0.878 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7687296867370605
Epoch: 40, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.851 Vali Acc: 0.761 Test Loss: 0.851 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7302694320678711
Epoch: 41, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.865 Vali Acc: 0.772 Test Loss: 0.865 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 42 cost time: 0.715571403503418
Epoch: 42, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.891 Vali Acc: 0.761 Test Loss: 0.891 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7931361198425293
Epoch: 43, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.850 Vali Acc: 0.761 Test Loss: 0.850 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.76416015625
Epoch: 44, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.914 Vali Acc: 0.767 Test Loss: 0.914 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7654900550842285
Epoch: 45, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.904 Vali Acc: 0.767 Test Loss: 0.904 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8057522773742676
Epoch: 46, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.926 Vali Acc: 0.767 Test Loss: 0.926 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7984306812286377
Epoch: 47, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.924 Vali Acc: 0.756 Test Loss: 0.924 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8233559131622314
Epoch: 48, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8072774410247803
Epoch: 49, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.967 Vali Acc: 0.739 Test Loss: 0.967 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8498530387878418
Epoch: 50, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.901 Vali Acc: 0.739 Test Loss: 0.901 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.7310090065002441
Epoch: 51, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.997 Vali Acc: 0.767 Test Loss: 0.997 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 81295
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.242532968521118
Epoch: 1, Steps: 12 | Train Loss: 2.783 Vali Loss: 2.541 Vali Acc: 0.144 Test Loss: 2.541 Test Acc: 0.144
Validation loss decreased (inf --> -0.144419).  Saving model ...
Epoch: 2 cost time: 0.7942917346954346
Epoch: 2, Steps: 12 | Train Loss: 2.307 Vali Loss: 1.993 Vali Acc: 0.483 Test Loss: 1.993 Test Acc: 0.483
Validation loss decreased (-0.144419 --> -0.483313).  Saving model ...
Epoch: 3 cost time: 0.8849601745605469
Epoch: 3, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.652 Vali Acc: 0.561 Test Loss: 1.652 Test Acc: 0.561
Validation loss decreased (-0.483313 --> -0.561095).  Saving model ...
Epoch: 4 cost time: 0.821136474609375
Epoch: 4, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.446 Vali Acc: 0.589 Test Loss: 1.446 Test Acc: 0.589
Validation loss decreased (-0.561095 --> -0.588874).  Saving model ...
Epoch: 5 cost time: 0.8325550556182861
Epoch: 5, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.333 Vali Acc: 0.606 Test Loss: 1.333 Test Acc: 0.606
Validation loss decreased (-0.588874 --> -0.605542).  Saving model ...
Epoch: 6 cost time: 0.8544390201568604
Epoch: 6, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.254 Vali Acc: 0.611 Test Loss: 1.254 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611099).  Saving model ...
Epoch: 7 cost time: 0.8087270259857178
Epoch: 7, Steps: 12 | Train Loss: 0.834 Vali Loss: 1.212 Vali Acc: 0.650 Test Loss: 1.212 Test Acc: 0.650
Validation loss decreased (-0.611099 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.8117139339447021
Epoch: 8, Steps: 12 | Train Loss: 0.681 Vali Loss: 1.161 Vali Acc: 0.639 Test Loss: 1.161 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7982900142669678
Epoch: 9, Steps: 12 | Train Loss: 0.619 Vali Loss: 1.179 Vali Acc: 0.656 Test Loss: 1.179 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 0.7949202060699463
Epoch: 10, Steps: 12 | Train Loss: 0.589 Vali Loss: 1.036 Vali Acc: 0.706 Test Loss: 1.036 Test Acc: 0.706
Validation loss decreased (-0.655544 --> -0.705545).  Saving model ...
Epoch: 11 cost time: 0.8688178062438965
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 1.037 Vali Acc: 0.694 Test Loss: 1.037 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7640085220336914
Epoch: 12, Steps: 12 | Train Loss: 0.377 Vali Loss: 1.100 Vali Acc: 0.711 Test Loss: 1.100 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711100).  Saving model ...
Epoch: 13 cost time: 0.8260228633880615
Epoch: 13, Steps: 12 | Train Loss: 0.286 Vali Loss: 1.050 Vali Acc: 0.711 Test Loss: 1.050 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 0.8565263748168945
Epoch: 14, Steps: 12 | Train Loss: 0.316 Vali Loss: 1.074 Vali Acc: 0.728 Test Loss: 1.074 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727767).  Saving model ...
Epoch: 15 cost time: 0.9163670539855957
Epoch: 15, Steps: 12 | Train Loss: 0.252 Vali Loss: 1.132 Vali Acc: 0.717 Test Loss: 1.132 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9283270835876465
Epoch: 16, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.088 Vali Acc: 0.744 Test Loss: 1.088 Test Acc: 0.744
Validation loss decreased (-0.727767 --> -0.744434).  Saving model ...
Epoch: 17 cost time: 0.8115546703338623
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.186 Vali Acc: 0.711 Test Loss: 1.186 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8595037460327148
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.190 Vali Acc: 0.722 Test Loss: 1.190 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9303286075592041
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.220 Vali Acc: 0.728 Test Loss: 1.220 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8641314506530762
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.289 Vali Acc: 0.700 Test Loss: 1.289 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7819046974182129
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.305 Vali Acc: 0.717 Test Loss: 1.305 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8507006168365479
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.351 Vali Acc: 0.717 Test Loss: 1.351 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8867626190185547
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.365 Vali Acc: 0.717 Test Loss: 1.365 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8319962024688721
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.365 Vali Acc: 0.733 Test Loss: 1.365 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8906209468841553
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.405 Vali Acc: 0.728 Test Loss: 1.405 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8516371250152588
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.371 Vali Acc: 0.733 Test Loss: 1.371 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 137103
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5292224884033203
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.577 Vali Acc: 0.189 Test Loss: 2.577 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 0.7379276752471924
Epoch: 2, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.244 Vali Acc: 0.378 Test Loss: 2.244 Test Acc: 0.378
Validation loss decreased (-0.188863 --> -0.377755).  Saving model ...
Epoch: 3 cost time: 0.832068920135498
Epoch: 3, Steps: 12 | Train Loss: 2.079 Vali Loss: 1.918 Vali Acc: 0.489 Test Loss: 1.918 Test Acc: 0.489
Validation loss decreased (-0.377755 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 0.8718957901000977
Epoch: 4, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.673 Vali Acc: 0.528 Test Loss: 1.673 Test Acc: 0.528
Validation loss decreased (-0.488870 --> -0.527761).  Saving model ...
Epoch: 5 cost time: 0.8342537879943848
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.531 Vali Acc: 0.544 Test Loss: 1.531 Test Acc: 0.544
Validation loss decreased (-0.527761 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 0.8718674182891846
Epoch: 6, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.409 Vali Acc: 0.583 Test Loss: 1.409 Test Acc: 0.583
Validation loss decreased (-0.544429 --> -0.583319).  Saving model ...
Epoch: 7 cost time: 0.9288253784179688
Epoch: 7, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.323 Vali Acc: 0.633 Test Loss: 1.323 Test Acc: 0.633
Validation loss decreased (-0.583319 --> -0.633320).  Saving model ...
Epoch: 8 cost time: 0.7708873748779297
Epoch: 8, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.245 Vali Acc: 0.617 Test Loss: 1.245 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8279473781585693
Epoch: 9, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.246 Vali Acc: 0.600 Test Loss: 1.246 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7797186374664307
Epoch: 10, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.170 Vali Acc: 0.667 Test Loss: 1.170 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666655).  Saving model ...
Epoch: 11 cost time: 0.7317550182342529
Epoch: 11, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.147 Vali Acc: 0.656 Test Loss: 1.147 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7531883716583252
Epoch: 12, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.088 Vali Acc: 0.678 Test Loss: 1.088 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 0.7367115020751953
Epoch: 13, Steps: 12 | Train Loss: 0.482 Vali Loss: 1.023 Vali Acc: 0.694 Test Loss: 1.023 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 14 cost time: 0.7818512916564941
Epoch: 14, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.991 Vali Acc: 0.700 Test Loss: 0.991 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.6775379180908203
Epoch: 15, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.963 Vali Acc: 0.739 Test Loss: 0.963 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738879).  Saving model ...
Epoch: 16 cost time: 0.6849839687347412
Epoch: 16, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.978 Vali Acc: 0.728 Test Loss: 0.978 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6719233989715576
Epoch: 17, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.983 Vali Acc: 0.722 Test Loss: 0.983 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7132968902587891
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.993 Vali Acc: 0.744 Test Loss: 0.993 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 19 cost time: 0.7619953155517578
Epoch: 19, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7668366432189941
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.998 Vali Acc: 0.739 Test Loss: 0.998 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7876489162445068
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.016 Vali Acc: 0.739 Test Loss: 1.016 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8075985908508301
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.036 Vali Acc: 0.756 Test Loss: 1.036 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755545).  Saving model ...
Epoch: 23 cost time: 0.8005425930023193
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.040 Vali Acc: 0.756 Test Loss: 1.040 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8055243492126465
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.092 Vali Acc: 0.761 Test Loss: 1.092 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761100).  Saving model ...
Epoch: 25 cost time: 0.8448052406311035
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.104 Vali Acc: 0.767 Test Loss: 1.104 Test Acc: 0.767
Validation loss decreased (-0.761100 --> -0.766656).  Saving model ...
Epoch: 26 cost time: 0.8160316944122314
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.163 Vali Acc: 0.739 Test Loss: 1.163 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9203846454620361
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.117 Vali Acc: 0.778 Test Loss: 1.117 Test Acc: 0.778
Validation loss decreased (-0.766656 --> -0.777767).  Saving model ...
Epoch: 28 cost time: 0.7860093116760254
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.160 Vali Acc: 0.756 Test Loss: 1.160 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.887580394744873
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.169 Vali Acc: 0.767 Test Loss: 1.169 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8421673774719238
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.186 Vali Acc: 0.756 Test Loss: 1.186 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7813746929168701
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.203 Vali Acc: 0.761 Test Loss: 1.203 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8635485172271729
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.202 Vali Acc: 0.756 Test Loss: 1.202 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8729326725006104
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.233 Vali Acc: 0.744 Test Loss: 1.233 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8710741996765137
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.231 Vali Acc: 0.761 Test Loss: 1.231 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8539397716522217
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.231 Vali Acc: 0.767 Test Loss: 1.231 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8919351100921631
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.260 Vali Acc: 0.767 Test Loss: 1.260 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8788607120513916
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.281 Vali Acc: 0.761 Test Loss: 1.281 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 94927
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2854349613189697
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.546 Vali Acc: 0.100 Test Loss: 2.546 Test Acc: 0.100
Validation loss decreased (inf --> -0.099975).  Saving model ...
Epoch: 2 cost time: 0.851475715637207
Epoch: 2, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.241 Vali Acc: 0.333 Test Loss: 2.241 Test Acc: 0.333
Validation loss decreased (-0.099975 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 0.8409273624420166
Epoch: 3, Steps: 12 | Train Loss: 2.108 Vali Loss: 1.941 Vali Acc: 0.428 Test Loss: 1.941 Test Acc: 0.428
Validation loss decreased (-0.333311 --> -0.427758).  Saving model ...
Epoch: 4 cost time: 0.8657577037811279
Epoch: 4, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.722 Vali Acc: 0.478 Test Loss: 1.722 Test Acc: 0.478
Validation loss decreased (-0.427758 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 0.9463119506835938
Epoch: 5, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.557 Vali Acc: 0.533 Test Loss: 1.557 Test Acc: 0.533
Validation loss decreased (-0.477761 --> -0.533318).  Saving model ...
Epoch: 6 cost time: 0.9315087795257568
Epoch: 6, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.440 Vali Acc: 0.589 Test Loss: 1.440 Test Acc: 0.589
Validation loss decreased (-0.533318 --> -0.588874).  Saving model ...
Epoch: 7 cost time: 0.8362185955047607
Epoch: 7, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.343 Vali Acc: 0.617 Test Loss: 1.343 Test Acc: 0.617
Validation loss decreased (-0.588874 --> -0.616653).  Saving model ...
Epoch: 8 cost time: 0.8751709461212158
Epoch: 8, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.313 Vali Acc: 0.606 Test Loss: 1.313 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8838531970977783
Epoch: 9, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.282 Vali Acc: 0.628 Test Loss: 1.282 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627765).  Saving model ...
Epoch: 10 cost time: 0.9109125137329102
Epoch: 10, Steps: 12 | Train Loss: 0.812 Vali Loss: 1.217 Vali Acc: 0.628 Test Loss: 1.217 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627766).  Saving model ...
Epoch: 11 cost time: 0.8846123218536377
Epoch: 11, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.186 Vali Acc: 0.656 Test Loss: 1.186 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655544).  Saving model ...
Epoch: 12 cost time: 0.8232872486114502
Epoch: 12, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.164 Vali Acc: 0.667 Test Loss: 1.164 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.8468239307403564
Epoch: 13, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.078 Vali Acc: 0.678 Test Loss: 1.078 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 14 cost time: 0.8550629615783691
Epoch: 14, Steps: 12 | Train Loss: 0.486 Vali Loss: 1.055 Vali Acc: 0.678 Test Loss: 1.055 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 15 cost time: 0.8724532127380371
Epoch: 15, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.025 Vali Acc: 0.717 Test Loss: 1.025 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716656).  Saving model ...
Epoch: 16 cost time: 0.8203730583190918
Epoch: 16, Steps: 12 | Train Loss: 0.387 Vali Loss: 1.000 Vali Acc: 0.717 Test Loss: 1.000 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716657).  Saving model ...
Epoch: 17 cost time: 0.823845624923706
Epoch: 17, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
Validation loss decreased (-0.716657 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.8149535655975342
Epoch: 18, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.976 Vali Acc: 0.733 Test Loss: 0.976 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7951939105987549
Epoch: 19, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.990 Vali Acc: 0.728 Test Loss: 0.990 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8991315364837646
Epoch: 20, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.967 Vali Acc: 0.733 Test Loss: 0.967 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8081557750701904
Epoch: 21, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.021 Vali Acc: 0.722 Test Loss: 1.021 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.878183126449585
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8027372360229492
Epoch: 23, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.019 Vali Acc: 0.706 Test Loss: 1.019 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8597383499145508
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.029 Vali Acc: 0.733 Test Loss: 1.029 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8993644714355469
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.062 Vali Acc: 0.728 Test Loss: 1.062 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8799633979797363
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.040 Vali Acc: 0.750 Test Loss: 1.040 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8761787414550781
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.103 Vali Acc: 0.717 Test Loss: 1.103 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 93071
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.323988676071167
Epoch: 1, Steps: 12 | Train Loss: 2.845 Vali Loss: 2.673 Vali Acc: 0.061 Test Loss: 2.673 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.8694415092468262
Epoch: 2, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.385 Vali Acc: 0.222 Test Loss: 2.385 Test Acc: 0.222
Validation loss decreased (-0.061084 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 0.8255248069763184
Epoch: 3, Steps: 12 | Train Loss: 2.171 Vali Loss: 2.103 Vali Acc: 0.406 Test Loss: 2.103 Test Acc: 0.406
Validation loss decreased (-0.222198 --> -0.405535).  Saving model ...
Epoch: 4 cost time: 0.832360029220581
Epoch: 4, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.858 Vali Acc: 0.478 Test Loss: 1.858 Test Acc: 0.478
Validation loss decreased (-0.405535 --> -0.477759).  Saving model ...
Epoch: 5 cost time: 0.8019711971282959
Epoch: 5, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.657 Vali Acc: 0.556 Test Loss: 1.657 Test Acc: 0.556
Validation loss decreased (-0.477759 --> -0.555539).  Saving model ...
Epoch: 6 cost time: 0.8493847846984863
Epoch: 6, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.526 Vali Acc: 0.572 Test Loss: 1.526 Test Acc: 0.572
Validation loss decreased (-0.555539 --> -0.572207).  Saving model ...
Epoch: 7 cost time: 0.8745877742767334
Epoch: 7, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.437 Vali Acc: 0.589 Test Loss: 1.437 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 0.8295586109161377
Epoch: 8, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.373 Vali Acc: 0.600 Test Loss: 1.373 Test Acc: 0.600
Validation loss decreased (-0.588875 --> -0.599986).  Saving model ...
Epoch: 9 cost time: 0.8204524517059326
Epoch: 9, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.321 Vali Acc: 0.622 Test Loss: 1.321 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 10 cost time: 0.8000292778015137
Epoch: 10, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.276 Vali Acc: 0.628 Test Loss: 1.276 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 11 cost time: 0.8484768867492676
Epoch: 11, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.239 Vali Acc: 0.644 Test Loss: 1.239 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644432).  Saving model ...
Epoch: 12 cost time: 0.840831995010376
Epoch: 12, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.185 Vali Acc: 0.656 Test Loss: 1.185 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 13 cost time: 0.8436522483825684
Epoch: 13, Steps: 12 | Train Loss: 0.753 Vali Loss: 1.143 Vali Acc: 0.661 Test Loss: 1.143 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 0.8296644687652588
Epoch: 14, Steps: 12 | Train Loss: 0.649 Vali Loss: 1.155 Vali Acc: 0.667 Test Loss: 1.155 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 0.9332320690155029
Epoch: 15, Steps: 12 | Train Loss: 0.580 Vali Loss: 1.097 Vali Acc: 0.656 Test Loss: 1.097 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7459287643432617
Epoch: 16, Steps: 12 | Train Loss: 0.497 Vali Loss: 1.040 Vali Acc: 0.678 Test Loss: 1.040 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 17 cost time: 0.7941441535949707
Epoch: 17, Steps: 12 | Train Loss: 0.459 Vali Loss: 1.030 Vali Acc: 0.711 Test Loss: 1.030 Test Acc: 0.711
Validation loss decreased (-0.677767 --> -0.711101).  Saving model ...
Epoch: 18 cost time: 0.8263444900512695
Epoch: 18, Steps: 12 | Train Loss: 0.409 Vali Loss: 1.008 Vali Acc: 0.717 Test Loss: 1.008 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 19 cost time: 0.7703142166137695
Epoch: 19, Steps: 12 | Train Loss: 0.388 Vali Loss: 1.034 Vali Acc: 0.689 Test Loss: 1.034 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7392368316650391
Epoch: 20, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.963 Vali Acc: 0.717 Test Loss: 0.963 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 21 cost time: 0.7958731651306152
Epoch: 21, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.961 Vali Acc: 0.733 Test Loss: 0.961 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 22 cost time: 0.8586814403533936
Epoch: 22, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.976 Vali Acc: 0.722 Test Loss: 0.976 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8482813835144043
Epoch: 23, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.960 Vali Acc: 0.761 Test Loss: 0.960 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761102).  Saving model ...
Epoch: 24 cost time: 0.8257138729095459
Epoch: 24, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.964 Vali Acc: 0.778 Test Loss: 0.964 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777768).  Saving model ...
Epoch: 25 cost time: 0.7672431468963623
Epoch: 25, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.984 Vali Acc: 0.733 Test Loss: 0.984 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7622251510620117
Epoch: 26, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.931 Vali Acc: 0.767 Test Loss: 0.931 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7328224182128906
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.970 Vali Acc: 0.750 Test Loss: 0.970 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.811784029006958
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.955 Vali Acc: 0.761 Test Loss: 0.955 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8178219795227051
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.991 Vali Acc: 0.761 Test Loss: 0.991 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8104908466339111
Epoch: 30, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.988 Vali Acc: 0.756 Test Loss: 0.988 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8471279144287109
Epoch: 31, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.989 Vali Acc: 0.772 Test Loss: 0.989 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8579752445220947
Epoch: 32, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.993 Vali Acc: 0.761 Test Loss: 0.993 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8888266086578369
Epoch: 33, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.027 Vali Acc: 0.772 Test Loss: 1.027 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.833585262298584
Epoch: 34, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.034 Vali Acc: 0.772 Test Loss: 1.034 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 79695
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.522723913192749
Epoch: 1, Steps: 12 | Train Loss: 2.889 Vali Loss: 2.794 Vali Acc: 0.117 Test Loss: 2.794 Test Acc: 0.117
Validation loss decreased (inf --> -0.116639).  Saving model ...
Epoch: 2 cost time: 0.7949123382568359
Epoch: 2, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.591 Vali Acc: 0.183 Test Loss: 2.591 Test Acc: 0.183
Validation loss decreased (-0.116639 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 0.8448960781097412
Epoch: 3, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.336 Vali Acc: 0.333 Test Loss: 2.336 Test Acc: 0.333
Validation loss decreased (-0.183307 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 0.846724271774292
Epoch: 4, Steps: 12 | Train Loss: 2.195 Vali Loss: 2.090 Vali Acc: 0.472 Test Loss: 2.090 Test Acc: 0.472
Validation loss decreased (-0.333310 --> -0.472201).  Saving model ...
Epoch: 5 cost time: 0.8084726333618164
Epoch: 5, Steps: 12 | Train Loss: 1.935 Vali Loss: 1.876 Vali Acc: 0.489 Test Loss: 1.876 Test Acc: 0.489
Validation loss decreased (-0.472201 --> -0.488870).  Saving model ...
Epoch: 6 cost time: 0.7711942195892334
Epoch: 6, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.710 Vali Acc: 0.528 Test Loss: 1.710 Test Acc: 0.528
Validation loss decreased (-0.488870 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 0.8736329078674316
Epoch: 7, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.598 Vali Acc: 0.583 Test Loss: 1.598 Test Acc: 0.583
Validation loss decreased (-0.527761 --> -0.583317).  Saving model ...
Epoch: 8 cost time: 0.8587443828582764
Epoch: 8, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.510 Vali Acc: 0.578 Test Loss: 1.510 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8022289276123047
Epoch: 9, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.434 Vali Acc: 0.600 Test Loss: 1.434 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.7510924339294434
Epoch: 10, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.384 Vali Acc: 0.617 Test Loss: 1.384 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616653).  Saving model ...
Epoch: 11 cost time: 0.7852249145507812
Epoch: 11, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.327 Vali Acc: 0.628 Test Loss: 1.327 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627765).  Saving model ...
Epoch: 12 cost time: 0.8351809978485107
Epoch: 12, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.271 Vali Acc: 0.639 Test Loss: 1.271 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638876).  Saving model ...
Epoch: 13 cost time: 0.8169920444488525
Epoch: 13, Steps: 12 | Train Loss: 0.835 Vali Loss: 1.243 Vali Acc: 0.661 Test Loss: 1.243 Test Acc: 0.661
Validation loss decreased (-0.638876 --> -0.661099).  Saving model ...
Epoch: 14 cost time: 0.7949867248535156
Epoch: 14, Steps: 12 | Train Loss: 0.744 Vali Loss: 1.200 Vali Acc: 0.672 Test Loss: 1.200 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672210).  Saving model ...
Epoch: 15 cost time: 0.8030095100402832
Epoch: 15, Steps: 12 | Train Loss: 0.712 Vali Loss: 1.136 Vali Acc: 0.672 Test Loss: 1.136 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 16 cost time: 0.7921733856201172
Epoch: 16, Steps: 12 | Train Loss: 0.702 Vali Loss: 1.105 Vali Acc: 0.672 Test Loss: 1.105 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 0.7974216938018799
Epoch: 17, Steps: 12 | Train Loss: 0.547 Vali Loss: 1.074 Vali Acc: 0.683 Test Loss: 1.074 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 18 cost time: 0.8137490749359131
Epoch: 18, Steps: 12 | Train Loss: 0.520 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.812330961227417
Epoch: 19, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.991 Vali Acc: 0.694 Test Loss: 0.991 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 20 cost time: 0.8066589832305908
Epoch: 20, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.952 Vali Acc: 0.722 Test Loss: 0.952 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722213).  Saving model ...
Epoch: 21 cost time: 0.8135888576507568
Epoch: 21, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.912 Vali Acc: 0.706 Test Loss: 0.912 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8134975433349609
Epoch: 22, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.899 Vali Acc: 0.711 Test Loss: 0.899 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8282051086425781
Epoch: 23, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.883 Vali Acc: 0.733 Test Loss: 0.883 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 24 cost time: 0.8176596164703369
Epoch: 24, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.872 Vali Acc: 0.767 Test Loss: 0.872 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 25 cost time: 0.7985348701477051
Epoch: 25, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.845 Vali Acc: 0.756 Test Loss: 0.845 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7688395977020264
Epoch: 26, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.841 Vali Acc: 0.744 Test Loss: 0.841 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7914304733276367
Epoch: 27, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.875 Vali Acc: 0.744 Test Loss: 0.875 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9055156707763672
Epoch: 28, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.873 Vali Acc: 0.761 Test Loss: 0.873 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7105145454406738
Epoch: 29, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.912 Vali Acc: 0.744 Test Loss: 0.912 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.720299482345581
Epoch: 30, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7926342487335205
Epoch: 31, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.886 Vali Acc: 0.750 Test Loss: 0.886 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7381203174591064
Epoch: 32, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.891 Vali Acc: 0.761 Test Loss: 0.891 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7916469573974609
Epoch: 33, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7602686882019043
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 72143
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.258082151412964
Epoch: 1, Steps: 12 | Train Loss: 2.943 Vali Loss: 2.870 Vali Acc: 0.050 Test Loss: 2.870 Test Acc: 0.050
Validation loss decreased (inf --> -0.049971).  Saving model ...
Epoch: 2 cost time: 0.7654833793640137
Epoch: 2, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.678 Vali Acc: 0.061 Test Loss: 2.678 Test Acc: 0.061
Validation loss decreased (-0.049971 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 0.856778621673584
Epoch: 3, Steps: 12 | Train Loss: 2.618 Vali Loss: 2.437 Vali Acc: 0.222 Test Loss: 2.437 Test Acc: 0.222
Validation loss decreased (-0.061084 --> -0.222198).  Saving model ...
Epoch: 4 cost time: 0.7691812515258789
Epoch: 4, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.209 Vali Acc: 0.322 Test Loss: 2.209 Test Acc: 0.322
Validation loss decreased (-0.222198 --> -0.322200).  Saving model ...
Epoch: 5 cost time: 0.7866008281707764
Epoch: 5, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.008 Vali Acc: 0.411 Test Loss: 2.008 Test Acc: 0.411
Validation loss decreased (-0.322200 --> -0.411091).  Saving model ...
Epoch: 6 cost time: 0.7437937259674072
Epoch: 6, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.849 Vali Acc: 0.456 Test Loss: 1.849 Test Acc: 0.456
Validation loss decreased (-0.411091 --> -0.455537).  Saving model ...
Epoch: 7 cost time: 0.7507696151733398
Epoch: 7, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.719 Vali Acc: 0.483 Test Loss: 1.719 Test Acc: 0.483
Validation loss decreased (-0.455537 --> -0.483316).  Saving model ...
Epoch: 8 cost time: 0.7188482284545898
Epoch: 8, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.589 Vali Acc: 0.567 Test Loss: 1.589 Test Acc: 0.567
Validation loss decreased (-0.483316 --> -0.566651).  Saving model ...
Epoch: 9 cost time: 0.697474479675293
Epoch: 9, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.514 Vali Acc: 0.556 Test Loss: 1.514 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7167425155639648
Epoch: 10, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.420 Vali Acc: 0.578 Test Loss: 1.420 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577764).  Saving model ...
Epoch: 11 cost time: 0.7831807136535645
Epoch: 11, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.350 Vali Acc: 0.606 Test Loss: 1.350 Test Acc: 0.606
Validation loss decreased (-0.577764 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 0.7535345554351807
Epoch: 12, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.290 Vali Acc: 0.617 Test Loss: 1.290 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 0.774742841720581
Epoch: 13, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.243 Vali Acc: 0.633 Test Loss: 1.243 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 14 cost time: 0.7499122619628906
Epoch: 14, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.183 Vali Acc: 0.633 Test Loss: 1.183 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633322).  Saving model ...
Epoch: 15 cost time: 0.7650985717773438
Epoch: 15, Steps: 12 | Train Loss: 0.737 Vali Loss: 1.111 Vali Acc: 0.639 Test Loss: 1.111 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638878).  Saving model ...
Epoch: 16 cost time: 0.7456984519958496
Epoch: 16, Steps: 12 | Train Loss: 0.717 Vali Loss: 1.067 Vali Acc: 0.650 Test Loss: 1.067 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 0.8152933120727539
Epoch: 17, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.025 Vali Acc: 0.667 Test Loss: 1.025 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666656).  Saving model ...
Epoch: 18 cost time: 0.7243549823760986
Epoch: 18, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.977 Vali Acc: 0.672 Test Loss: 0.977 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 19 cost time: 0.7646980285644531
Epoch: 19, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.926 Vali Acc: 0.678 Test Loss: 0.926 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677769).  Saving model ...
Epoch: 20 cost time: 0.8082253932952881
Epoch: 20, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.930 Vali Acc: 0.656 Test Loss: 0.930 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7489955425262451
Epoch: 21, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.885 Vali Acc: 0.728 Test Loss: 0.885 Test Acc: 0.728
Validation loss decreased (-0.677769 --> -0.727769).  Saving model ...
Epoch: 22 cost time: 0.7163786888122559
Epoch: 22, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.899 Vali Acc: 0.694 Test Loss: 0.899 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5921494960784912
Epoch: 23, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.7590768337249756
Epoch: 24, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7736554145812988
Epoch: 25, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.856 Vali Acc: 0.728 Test Loss: 0.856 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7386846542358398
Epoch: 26, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.824 Vali Acc: 0.739 Test Loss: 0.824 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7907731533050537
Epoch: 27, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7430949211120605
Epoch: 28, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.830 Vali Acc: 0.744 Test Loss: 0.830 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7163693904876709
Epoch: 29, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.821 Vali Acc: 0.767 Test Loss: 0.821 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766658).  Saving model ...
Epoch: 30 cost time: 0.794952392578125
Epoch: 30, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.834 Vali Acc: 0.744 Test Loss: 0.834 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7482600212097168
Epoch: 31, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.844 Vali Acc: 0.733 Test Loss: 0.844 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7865166664123535
Epoch: 32, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7229557037353516
Epoch: 33, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.803 Vali Acc: 0.744 Test Loss: 0.803 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7644064426422119
Epoch: 34, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.844 Vali Acc: 0.761 Test Loss: 0.844 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7450234889984131
Epoch: 35, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7526826858520508
Epoch: 36, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.838 Vali Acc: 0.756 Test Loss: 0.838 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7873811721801758
Epoch: 37, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.846 Vali Acc: 0.739 Test Loss: 0.846 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7209901809692383
Epoch: 38, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.823 Vali Acc: 0.722 Test Loss: 0.823 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7789530754089355
Epoch: 39, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 68431
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1005454063415527
Epoch: 1, Steps: 12 | Train Loss: 2.790 Vali Loss: 2.693 Vali Acc: 0.139 Test Loss: 2.693 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.7016065120697021
Epoch: 2, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.517 Vali Acc: 0.217 Test Loss: 2.517 Test Acc: 0.217
Validation loss decreased (-0.138862 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 0.8016691207885742
Epoch: 3, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.319 Vali Acc: 0.300 Test Loss: 2.319 Test Acc: 0.300
Validation loss decreased (-0.216641 --> -0.299977).  Saving model ...
Epoch: 4 cost time: 0.7147707939147949
Epoch: 4, Steps: 12 | Train Loss: 2.282 Vali Loss: 2.114 Vali Acc: 0.389 Test Loss: 2.114 Test Acc: 0.389
Validation loss decreased (-0.299977 --> -0.388868).  Saving model ...
Epoch: 5 cost time: 0.6902868747711182
Epoch: 5, Steps: 12 | Train Loss: 2.077 Vali Loss: 1.939 Vali Acc: 0.478 Test Loss: 1.939 Test Acc: 0.478
Validation loss decreased (-0.388868 --> -0.477758).  Saving model ...
Epoch: 6 cost time: 0.7102658748626709
Epoch: 6, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.797 Vali Acc: 0.511 Test Loss: 1.797 Test Acc: 0.511
Validation loss decreased (-0.477758 --> -0.511093).  Saving model ...
Epoch: 7 cost time: 0.7578332424163818
Epoch: 7, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.672 Vali Acc: 0.511 Test Loss: 1.672 Test Acc: 0.511
Validation loss decreased (-0.511093 --> -0.511094).  Saving model ...
Epoch: 8 cost time: 0.7689914703369141
Epoch: 8, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.572 Vali Acc: 0.550 Test Loss: 1.572 Test Acc: 0.550
Validation loss decreased (-0.511094 --> -0.549984).  Saving model ...
Epoch: 9 cost time: 0.7786788940429688
Epoch: 9, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.493 Vali Acc: 0.544 Test Loss: 1.493 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7599599361419678
Epoch: 10, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.412 Vali Acc: 0.561 Test Loss: 1.412 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561097).  Saving model ...
Epoch: 11 cost time: 0.7274394035339355
Epoch: 11, Steps: 12 | Train Loss: 1.073 Vali Loss: 1.344 Vali Acc: 0.611 Test Loss: 1.344 Test Acc: 0.611
Validation loss decreased (-0.561097 --> -0.611098).  Saving model ...
Epoch: 12 cost time: 0.7151620388031006
Epoch: 12, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.284 Vali Acc: 0.622 Test Loss: 1.284 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 13 cost time: 0.7700698375701904
Epoch: 13, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.216 Vali Acc: 0.633 Test Loss: 1.216 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 14 cost time: 0.8002610206604004
Epoch: 14, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.155 Vali Acc: 0.633 Test Loss: 1.155 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633322).  Saving model ...
Epoch: 15 cost time: 0.7303247451782227
Epoch: 15, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.106 Vali Acc: 0.622 Test Loss: 1.106 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8084819316864014
Epoch: 16, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.020 Vali Acc: 0.656 Test Loss: 1.020 Test Acc: 0.656
Validation loss decreased (-0.633322 --> -0.655545).  Saving model ...
Epoch: 17 cost time: 0.7830948829650879
Epoch: 17, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.963 Vali Acc: 0.672 Test Loss: 0.963 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672213).  Saving model ...
Epoch: 18 cost time: 0.7873430252075195
Epoch: 18, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.918 Vali Acc: 0.683 Test Loss: 0.918 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683324).  Saving model ...
Epoch: 19 cost time: 0.8276073932647705
Epoch: 19, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.881 Vali Acc: 0.683 Test Loss: 0.881 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683325).  Saving model ...
Epoch: 20 cost time: 0.8014435768127441
Epoch: 20, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.864 Vali Acc: 0.694 Test Loss: 0.864 Test Acc: 0.694
Validation loss decreased (-0.683325 --> -0.694436).  Saving model ...
Epoch: 21 cost time: 0.8527212142944336
Epoch: 21, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.870 Vali Acc: 0.706 Test Loss: 0.870 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705547).  Saving model ...
Epoch: 22 cost time: 0.8047046661376953
Epoch: 22, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.866 Vali Acc: 0.706 Test Loss: 0.866 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 23 cost time: 0.8242542743682861
Epoch: 23, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.830 Vali Acc: 0.706 Test Loss: 0.830 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 24 cost time: 0.810152530670166
Epoch: 24, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.816 Vali Acc: 0.717 Test Loss: 0.816 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 25 cost time: 0.8625738620758057
Epoch: 25, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.811 Vali Acc: 0.728 Test Loss: 0.811 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727770).  Saving model ...
Epoch: 26 cost time: 0.858945369720459
Epoch: 26, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.808 Vali Acc: 0.739 Test Loss: 0.808 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 27 cost time: 0.8519408702850342
Epoch: 27, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 28 cost time: 0.8083462715148926
Epoch: 28, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.787 Vali Acc: 0.739 Test Loss: 0.787 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7905938625335693
Epoch: 29, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 30 cost time: 0.754500150680542
Epoch: 30, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8029015064239502
Epoch: 31, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 32 cost time: 0.7727596759796143
Epoch: 32, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8501627445220947
Epoch: 33, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.799 Vali Acc: 0.728 Test Loss: 0.799 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7535507678985596
Epoch: 34, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.795 Vali Acc: 0.744 Test Loss: 0.795 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7791476249694824
Epoch: 35, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.811 Vali Acc: 0.744 Test Loss: 0.811 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8784823417663574
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.844 Vali Acc: 0.728 Test Loss: 0.844 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8740808963775635
Epoch: 37, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8670530319213867
Epoch: 38, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 39 cost time: 0.8701126575469971
Epoch: 39, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.835 Vali Acc: 0.744 Test Loss: 0.835 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7909572124481201
Epoch: 40, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8235905170440674
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7650840282440186
Epoch: 42, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7868790626525879
Epoch: 43, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8420453071594238
Epoch: 44, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7660956382751465
Epoch: 45, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.874 Vali Acc: 0.739 Test Loss: 0.874 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.756627082824707
Epoch: 46, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.860398530960083
Epoch: 47, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.866 Vali Acc: 0.756 Test Loss: 0.866 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.844517707824707
Epoch: 48, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.861 Vali Acc: 0.767 Test Loss: 0.861 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766658).  Saving model ...
Epoch: 49 cost time: 0.8692288398742676
Epoch: 49, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.925 Vali Acc: 0.761 Test Loss: 0.925 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.772104024887085
Epoch: 50, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.873 Vali Acc: 0.761 Test Loss: 0.873 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9102182388305664
Epoch: 51, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.885 Vali Acc: 0.767 Test Loss: 0.885 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7953519821166992
Epoch: 52, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.924 Vali Acc: 0.772 Test Loss: 0.924 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772213).  Saving model ...
Epoch: 53 cost time: 0.7987041473388672
Epoch: 53, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.900 Vali Acc: 0.778 Test Loss: 0.900 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 54 cost time: 0.8066771030426025
Epoch: 54, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.948 Vali Acc: 0.761 Test Loss: 0.948 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8455970287322998
Epoch: 55, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.901 Vali Acc: 0.783 Test Loss: 0.901 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783324).  Saving model ...
Epoch: 56 cost time: 0.9154880046844482
Epoch: 56, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.900 Vali Acc: 0.767 Test Loss: 0.900 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9207916259765625
Epoch: 57, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.942 Vali Acc: 0.761 Test Loss: 0.942 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.822516679763794
Epoch: 58, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.956 Vali Acc: 0.772 Test Loss: 0.956 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7399811744689941
Epoch: 59, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.965 Vali Acc: 0.778 Test Loss: 0.965 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9305286407470703
Epoch: 60, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.969 Vali Acc: 0.772 Test Loss: 0.969 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9003241062164307
Epoch: 61, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.957 Vali Acc: 0.767 Test Loss: 0.957 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.8086967468261719
Epoch: 62, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.980 Vali Acc: 0.767 Test Loss: 0.980 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.8852529525756836
Epoch: 63, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.945 Vali Acc: 0.767 Test Loss: 0.945 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.8744022846221924
Epoch: 64, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.952 Vali Acc: 0.778 Test Loss: 0.952 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.8498489856719971
Epoch: 65, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.990 Vali Acc: 0.789 Test Loss: 0.990 Test Acc: 0.789
Validation loss decreased (-0.783324 --> -0.788879).  Saving model ...
Epoch: 66 cost time: 0.8971724510192871
Epoch: 66, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.985 Vali Acc: 0.778 Test Loss: 0.985 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8007321357727051
Epoch: 67, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.023 Vali Acc: 0.778 Test Loss: 1.023 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8774359226226807
Epoch: 68, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.009 Vali Acc: 0.767 Test Loss: 1.009 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7969529628753662
Epoch: 69, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.021 Vali Acc: 0.767 Test Loss: 1.021 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.8735873699188232
Epoch: 70, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.982 Vali Acc: 0.772 Test Loss: 0.982 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.7906796932220459
Epoch: 71, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.968 Vali Acc: 0.783 Test Loss: 0.968 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8662242889404297
Epoch: 72, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.012 Vali Acc: 0.767 Test Loss: 1.012 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.8628556728363037
Epoch: 73, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.043 Vali Acc: 0.772 Test Loss: 1.043 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.9427919387817383
Epoch: 74, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.984 Vali Acc: 0.772 Test Loss: 0.984 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.8686292171478271
Epoch: 75, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.967 Vali Acc: 0.767 Test Loss: 0.967 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm64_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 64783
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2895009517669678
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.618 Vali Acc: 0.150 Test Loss: 2.618 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 0.8072671890258789
Epoch: 2, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.289 Vali Acc: 0.317 Test Loss: 2.289 Test Acc: 0.317
Validation loss decreased (-0.149974 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 0.8283867835998535
Epoch: 3, Steps: 12 | Train Loss: 2.160 Vali Loss: 1.957 Vali Acc: 0.450 Test Loss: 1.957 Test Acc: 0.450
Validation loss decreased (-0.316644 --> -0.449980).  Saving model ...
Epoch: 4 cost time: 0.8389585018157959
Epoch: 4, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.706 Vali Acc: 0.494 Test Loss: 1.706 Test Acc: 0.494
Validation loss decreased (-0.449980 --> -0.494427).  Saving model ...
Epoch: 5 cost time: 0.8377504348754883
Epoch: 5, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.557 Vali Acc: 0.528 Test Loss: 1.557 Test Acc: 0.528
Validation loss decreased (-0.494427 --> -0.527762).  Saving model ...
Epoch: 6 cost time: 0.9112398624420166
Epoch: 6, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.400 Vali Acc: 0.567 Test Loss: 1.400 Test Acc: 0.567
Validation loss decreased (-0.527762 --> -0.566653).  Saving model ...
Epoch: 7 cost time: 0.8610296249389648
Epoch: 7, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.326 Vali Acc: 0.578 Test Loss: 1.326 Test Acc: 0.578
Validation loss decreased (-0.566653 --> -0.577765).  Saving model ...
Epoch: 8 cost time: 0.906604528427124
Epoch: 8, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.263 Vali Acc: 0.606 Test Loss: 1.263 Test Acc: 0.606
Validation loss decreased (-0.577765 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 0.8681769371032715
Epoch: 9, Steps: 12 | Train Loss: 0.829 Vali Loss: 1.250 Vali Acc: 0.622 Test Loss: 1.250 Test Acc: 0.622
Validation loss decreased (-0.605543 --> -0.622210).  Saving model ...
Epoch: 10 cost time: 0.8835346698760986
Epoch: 10, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.183 Vali Acc: 0.633 Test Loss: 1.183 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633322).  Saving model ...
Epoch: 11 cost time: 0.8692314624786377
Epoch: 11, Steps: 12 | Train Loss: 0.709 Vali Loss: 1.129 Vali Acc: 0.683 Test Loss: 1.129 Test Acc: 0.683
Validation loss decreased (-0.633322 --> -0.683322).  Saving model ...
Epoch: 12 cost time: 0.7886621952056885
Epoch: 12, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.102 Vali Acc: 0.667 Test Loss: 1.102 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8539519309997559
Epoch: 13, Steps: 12 | Train Loss: 0.535 Vali Loss: 1.057 Vali Acc: 0.694 Test Loss: 1.057 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 14 cost time: 0.8624739646911621
Epoch: 14, Steps: 12 | Train Loss: 0.451 Vali Loss: 1.075 Vali Acc: 0.706 Test Loss: 1.075 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 15 cost time: 0.8303165435791016
Epoch: 15, Steps: 12 | Train Loss: 0.399 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.837526798248291
Epoch: 16, Steps: 12 | Train Loss: 0.352 Vali Loss: 1.014 Vali Acc: 0.728 Test Loss: 1.014 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727768).  Saving model ...
Epoch: 17 cost time: 0.8690962791442871
Epoch: 17, Steps: 12 | Train Loss: 0.280 Vali Loss: 1.060 Vali Acc: 0.711 Test Loss: 1.060 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.875342845916748
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 1.023 Vali Acc: 0.728 Test Loss: 1.023 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8930938243865967
Epoch: 19, Steps: 12 | Train Loss: 0.241 Vali Loss: 1.033 Vali Acc: 0.750 Test Loss: 1.033 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 0.9730117321014404
Epoch: 20, Steps: 12 | Train Loss: 0.173 Vali Loss: 1.096 Vali Acc: 0.694 Test Loss: 1.096 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8727476596832275
Epoch: 21, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.091 Vali Acc: 0.728 Test Loss: 1.091 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8642354011535645
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.131 Vali Acc: 0.694 Test Loss: 1.131 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.864509105682373
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.147 Vali Acc: 0.733 Test Loss: 1.147 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8645093441009521
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.165 Vali Acc: 0.733 Test Loss: 1.165 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8480021953582764
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.125 Vali Acc: 0.728 Test Loss: 1.125 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8799736499786377
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.186 Vali Acc: 0.733 Test Loss: 1.186 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8683288097381592
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.247 Vali Acc: 0.722 Test Loss: 1.247 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8290691375732422
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.231 Vali Acc: 0.728 Test Loss: 1.231 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8410465717315674
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.286 Vali Acc: 0.728 Test Loss: 1.286 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 85391
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.194737434387207
Epoch: 1, Steps: 12 | Train Loss: 2.887 Vali Loss: 2.815 Vali Acc: 0.056 Test Loss: 2.815 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 0.7836320400238037
Epoch: 2, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.591 Vali Acc: 0.172 Test Loss: 2.591 Test Acc: 0.172
Validation loss decreased (-0.055527 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 0.8712100982666016
Epoch: 3, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.339 Vali Acc: 0.322 Test Loss: 2.339 Test Acc: 0.322
Validation loss decreased (-0.172196 --> -0.322199).  Saving model ...
Epoch: 4 cost time: 0.8297116756439209
Epoch: 4, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.099 Vali Acc: 0.433 Test Loss: 2.099 Test Acc: 0.433
Validation loss decreased (-0.322199 --> -0.433312).  Saving model ...
Epoch: 5 cost time: 0.9192056655883789
Epoch: 5, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.890 Vali Acc: 0.489 Test Loss: 1.890 Test Acc: 0.489
Validation loss decreased (-0.433312 --> -0.488870).  Saving model ...
Epoch: 6 cost time: 0.8313279151916504
Epoch: 6, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.717 Vali Acc: 0.533 Test Loss: 1.717 Test Acc: 0.533
Validation loss decreased (-0.488870 --> -0.533316).  Saving model ...
Epoch: 7 cost time: 0.793959379196167
Epoch: 7, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.578 Vali Acc: 0.533 Test Loss: 1.578 Test Acc: 0.533
Validation loss decreased (-0.533316 --> -0.533318).  Saving model ...
Epoch: 8 cost time: 0.8914341926574707
Epoch: 8, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.472 Vali Acc: 0.583 Test Loss: 1.472 Test Acc: 0.583
Validation loss decreased (-0.533318 --> -0.583319).  Saving model ...
Epoch: 9 cost time: 0.8795664310455322
Epoch: 9, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.375 Vali Acc: 0.600 Test Loss: 1.375 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.9210295677185059
Epoch: 10, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.326 Vali Acc: 0.611 Test Loss: 1.326 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 11 cost time: 0.9530739784240723
Epoch: 11, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.271 Vali Acc: 0.639 Test Loss: 1.271 Test Acc: 0.639
Validation loss decreased (-0.611098 --> -0.638876).  Saving model ...
Epoch: 12 cost time: 0.8909518718719482
Epoch: 12, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.213 Vali Acc: 0.628 Test Loss: 1.213 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8612253665924072
Epoch: 13, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.177 Vali Acc: 0.667 Test Loss: 1.177 Test Acc: 0.667
Validation loss decreased (-0.638876 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 0.9477715492248535
Epoch: 14, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.139 Vali Acc: 0.667 Test Loss: 1.139 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 0.8385915756225586
Epoch: 15, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.104 Vali Acc: 0.678 Test Loss: 1.104 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 16 cost time: 0.7849738597869873
Epoch: 16, Steps: 12 | Train Loss: 0.556 Vali Loss: 1.049 Vali Acc: 0.717 Test Loss: 1.049 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716656).  Saving model ...
Epoch: 17 cost time: 0.8699476718902588
Epoch: 17, Steps: 12 | Train Loss: 0.512 Vali Loss: 1.028 Vali Acc: 0.706 Test Loss: 1.028 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8301501274108887
Epoch: 18, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.998 Vali Acc: 0.711 Test Loss: 0.998 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8413419723510742
Epoch: 19, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.967 Vali Acc: 0.728 Test Loss: 0.967 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727768).  Saving model ...
Epoch: 20 cost time: 0.929673433303833
Epoch: 20, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 21 cost time: 0.8839466571807861
Epoch: 21, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.972 Vali Acc: 0.728 Test Loss: 0.972 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8415184020996094
Epoch: 22, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8661766052246094
Epoch: 23, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.955 Vali Acc: 0.744 Test Loss: 0.955 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 24 cost time: 0.8525035381317139
Epoch: 24, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.957 Vali Acc: 0.739 Test Loss: 0.957 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0697455406188965
Epoch: 25, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.979 Vali Acc: 0.739 Test Loss: 0.979 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.99918532371521
Epoch: 26, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.985 Vali Acc: 0.733 Test Loss: 0.985 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9263076782226562
Epoch: 27, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.010 Vali Acc: 0.728 Test Loss: 1.010 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.934476375579834
Epoch: 28, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.999 Vali Acc: 0.733 Test Loss: 0.999 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8546407222747803
Epoch: 29, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.999 Vali Acc: 0.733 Test Loss: 0.999 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7890095710754395
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.015 Vali Acc: 0.722 Test Loss: 1.015 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8464198112487793
Epoch: 31, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.021 Vali Acc: 0.722 Test Loss: 1.021 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8386430740356445
Epoch: 32, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.036 Vali Acc: 0.717 Test Loss: 1.036 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7916078567504883
Epoch: 33, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.052 Vali Acc: 0.733 Test Loss: 1.052 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 64303
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.158761501312256
Epoch: 1, Steps: 12 | Train Loss: 2.914 Vali Loss: 2.695 Vali Acc: 0.083 Test Loss: 2.695 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.7878208160400391
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.464 Vali Acc: 0.272 Test Loss: 2.464 Test Acc: 0.272
Validation loss decreased (-0.083306 --> -0.272198).  Saving model ...
Epoch: 3 cost time: 0.7576885223388672
Epoch: 3, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.205 Vali Acc: 0.372 Test Loss: 2.205 Test Acc: 0.372
Validation loss decreased (-0.272198 --> -0.372200).  Saving model ...
Epoch: 4 cost time: 0.8276350498199463
Epoch: 4, Steps: 12 | Train Loss: 2.133 Vali Loss: 1.973 Vali Acc: 0.444 Test Loss: 1.973 Test Acc: 0.444
Validation loss decreased (-0.372200 --> -0.444425).  Saving model ...
Epoch: 5 cost time: 0.8678879737854004
Epoch: 5, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.784 Vali Acc: 0.522 Test Loss: 1.784 Test Acc: 0.522
Validation loss decreased (-0.444425 --> -0.522204).  Saving model ...
Epoch: 6 cost time: 0.8651857376098633
Epoch: 6, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.622 Vali Acc: 0.550 Test Loss: 1.622 Test Acc: 0.550
Validation loss decreased (-0.522204 --> -0.549984).  Saving model ...
Epoch: 7 cost time: 0.8401737213134766
Epoch: 7, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.494 Vali Acc: 0.578 Test Loss: 1.494 Test Acc: 0.578
Validation loss decreased (-0.549984 --> -0.577763).  Saving model ...
Epoch: 8 cost time: 0.8782494068145752
Epoch: 8, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.402 Vali Acc: 0.606 Test Loss: 1.402 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605542).  Saving model ...
Epoch: 9 cost time: 0.8722143173217773
Epoch: 9, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.316 Vali Acc: 0.617 Test Loss: 1.316 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 10 cost time: 0.8017380237579346
Epoch: 10, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.269 Vali Acc: 0.633 Test Loss: 1.269 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 0.8052313327789307
Epoch: 11, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.212 Vali Acc: 0.639 Test Loss: 1.212 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 12 cost time: 0.7846040725708008
Epoch: 12, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.156 Vali Acc: 0.639 Test Loss: 1.156 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 13 cost time: 0.8254001140594482
Epoch: 13, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.139 Vali Acc: 0.661 Test Loss: 1.139 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 0.7686996459960938
Epoch: 14, Steps: 12 | Train Loss: 0.715 Vali Loss: 1.080 Vali Acc: 0.678 Test Loss: 1.080 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 15 cost time: 0.767733097076416
Epoch: 15, Steps: 12 | Train Loss: 0.629 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7870802879333496
Epoch: 16, Steps: 12 | Train Loss: 0.542 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.9243063926696777
Epoch: 17, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.004 Vali Acc: 0.717 Test Loss: 1.004 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 18 cost time: 0.8567764759063721
Epoch: 18, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.983 Vali Acc: 0.733 Test Loss: 0.983 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 0.8795828819274902
Epoch: 19, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.948 Vali Acc: 0.739 Test Loss: 0.948 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 20 cost time: 0.7867734432220459
Epoch: 20, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.954 Vali Acc: 0.744 Test Loss: 0.954 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 21 cost time: 0.8647527694702148
Epoch: 21, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.954 Vali Acc: 0.739 Test Loss: 0.954 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7954599857330322
Epoch: 22, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.932 Vali Acc: 0.733 Test Loss: 0.932 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9512722492218018
Epoch: 23, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.948 Vali Acc: 0.722 Test Loss: 0.948 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.79547119140625
Epoch: 24, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.965 Vali Acc: 0.739 Test Loss: 0.965 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8659539222717285
Epoch: 25, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.939 Vali Acc: 0.744 Test Loss: 0.939 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 26 cost time: 0.8257851600646973
Epoch: 26, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8013384342193604
Epoch: 27, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.966 Vali Acc: 0.733 Test Loss: 0.966 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8148503303527832
Epoch: 28, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.995 Vali Acc: 0.739 Test Loss: 0.995 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8533670902252197
Epoch: 29, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.999 Vali Acc: 0.739 Test Loss: 0.999 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.795982837677002
Epoch: 30, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.996 Vali Acc: 0.744 Test Loss: 0.996 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7979485988616943
Epoch: 31, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.026 Vali Acc: 0.756 Test Loss: 1.026 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755545).  Saving model ...
Epoch: 32 cost time: 0.8276140689849854
Epoch: 32, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.033 Vali Acc: 0.756 Test Loss: 1.033 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8720200061798096
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.047 Vali Acc: 0.756 Test Loss: 1.047 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.83809494972229
Epoch: 34, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.050 Vali Acc: 0.739 Test Loss: 1.050 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9013569355010986
Epoch: 35, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.065 Vali Acc: 0.739 Test Loss: 1.065 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7664532661437988
Epoch: 36, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.101 Vali Acc: 0.750 Test Loss: 1.101 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8217170238494873
Epoch: 37, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.087 Vali Acc: 0.744 Test Loss: 1.087 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7793283462524414
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.108 Vali Acc: 0.761 Test Loss: 1.108 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761100).  Saving model ...
Epoch: 39 cost time: 0.8292768001556396
Epoch: 39, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.129 Vali Acc: 0.744 Test Loss: 1.129 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8473875522613525
Epoch: 40, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.155 Vali Acc: 0.756 Test Loss: 1.155 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8310749530792236
Epoch: 41, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.140 Vali Acc: 0.756 Test Loss: 1.140 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8393383026123047
Epoch: 42, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.133 Vali Acc: 0.744 Test Loss: 1.133 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8103382587432861
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.180 Vali Acc: 0.728 Test Loss: 1.180 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7585864067077637
Epoch: 44, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.201 Vali Acc: 0.728 Test Loss: 1.201 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7851748466491699
Epoch: 45, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.203 Vali Acc: 0.739 Test Loss: 1.203 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8036947250366211
Epoch: 46, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.184 Vali Acc: 0.750 Test Loss: 1.184 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9198207855224609
Epoch: 47, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.211 Vali Acc: 0.750 Test Loss: 1.211 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8459632396697998
Epoch: 48, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.207 Vali Acc: 0.756 Test Loss: 1.207 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 63375
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.225576162338257
Epoch: 1, Steps: 12 | Train Loss: 2.849 Vali Loss: 2.733 Vali Acc: 0.094 Test Loss: 2.733 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.797447681427002
Epoch: 2, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.554 Vali Acc: 0.139 Test Loss: 2.554 Test Acc: 0.139
Validation loss decreased (-0.094417 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 0.7140054702758789
Epoch: 3, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.344 Vali Acc: 0.283 Test Loss: 2.344 Test Acc: 0.283
Validation loss decreased (-0.138863 --> -0.283310).  Saving model ...
Epoch: 4 cost time: 0.8132421970367432
Epoch: 4, Steps: 12 | Train Loss: 2.283 Vali Loss: 2.147 Vali Acc: 0.400 Test Loss: 2.147 Test Acc: 0.400
Validation loss decreased (-0.283310 --> -0.399979).  Saving model ...
Epoch: 5 cost time: 0.7440876960754395
Epoch: 5, Steps: 12 | Train Loss: 2.035 Vali Loss: 1.965 Vali Acc: 0.483 Test Loss: 1.965 Test Acc: 0.483
Validation loss decreased (-0.399979 --> -0.483314).  Saving model ...
Epoch: 6 cost time: 0.7232067584991455
Epoch: 6, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.808 Vali Acc: 0.511 Test Loss: 1.808 Test Acc: 0.511
Validation loss decreased (-0.483314 --> -0.511093).  Saving model ...
Epoch: 7 cost time: 0.7489645481109619
Epoch: 7, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.695 Vali Acc: 0.533 Test Loss: 1.695 Test Acc: 0.533
Validation loss decreased (-0.511093 --> -0.533316).  Saving model ...
Epoch: 8 cost time: 0.7952418327331543
Epoch: 8, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.606 Vali Acc: 0.544 Test Loss: 1.606 Test Acc: 0.544
Validation loss decreased (-0.533316 --> -0.544428).  Saving model ...
Epoch: 9 cost time: 0.7626340389251709
Epoch: 9, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.509 Vali Acc: 0.550 Test Loss: 1.509 Test Acc: 0.550
Validation loss decreased (-0.544428 --> -0.549985).  Saving model ...
Epoch: 10 cost time: 0.7572011947631836
Epoch: 10, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.433 Vali Acc: 0.556 Test Loss: 1.433 Test Acc: 0.556
Validation loss decreased (-0.549985 --> -0.555541).  Saving model ...
Epoch: 11 cost time: 0.76902174949646
Epoch: 11, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.375 Vali Acc: 0.561 Test Loss: 1.375 Test Acc: 0.561
Validation loss decreased (-0.555541 --> -0.561097).  Saving model ...
Epoch: 12 cost time: 0.7571110725402832
Epoch: 12, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.329 Vali Acc: 0.617 Test Loss: 1.329 Test Acc: 0.617
Validation loss decreased (-0.561097 --> -0.616653).  Saving model ...
Epoch: 13 cost time: 0.816335916519165
Epoch: 13, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.266 Vali Acc: 0.628 Test Loss: 1.266 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627765).  Saving model ...
Epoch: 14 cost time: 0.7294230461120605
Epoch: 14, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.229 Vali Acc: 0.639 Test Loss: 1.229 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 15 cost time: 0.8485202789306641
Epoch: 15, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.189 Vali Acc: 0.644 Test Loss: 1.189 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 16 cost time: 0.6040105819702148
Epoch: 16, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.160 Vali Acc: 0.639 Test Loss: 1.160 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7481663227081299
Epoch: 17, Steps: 12 | Train Loss: 0.647 Vali Loss: 1.130 Vali Acc: 0.667 Test Loss: 1.130 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666655).  Saving model ...
Epoch: 18 cost time: 0.7202224731445312
Epoch: 18, Steps: 12 | Train Loss: 0.624 Vali Loss: 1.076 Vali Acc: 0.661 Test Loss: 1.076 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8246493339538574
Epoch: 19, Steps: 12 | Train Loss: 0.574 Vali Loss: 1.043 Vali Acc: 0.683 Test Loss: 1.043 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 20 cost time: 0.7085633277893066
Epoch: 20, Steps: 12 | Train Loss: 0.526 Vali Loss: 1.010 Vali Acc: 0.689 Test Loss: 1.010 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 21 cost time: 0.7666699886322021
Epoch: 21, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.989 Vali Acc: 0.694 Test Loss: 0.989 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 22 cost time: 0.7974131107330322
Epoch: 22, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.977 Vali Acc: 0.678 Test Loss: 0.977 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8817331790924072
Epoch: 23, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.941 Vali Acc: 0.722 Test Loss: 0.941 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722213).  Saving model ...
Epoch: 24 cost time: 0.9486939907073975
Epoch: 24, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.918 Vali Acc: 0.756 Test Loss: 0.918 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755546).  Saving model ...
Epoch: 25 cost time: 0.8111827373504639
Epoch: 25, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.922 Vali Acc: 0.744 Test Loss: 0.922 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8207118511199951
Epoch: 26, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.918 Vali Acc: 0.744 Test Loss: 0.918 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8037967681884766
Epoch: 27, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.899 Vali Acc: 0.772 Test Loss: 0.899 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772213).  Saving model ...
Epoch: 28 cost time: 0.8576719760894775
Epoch: 28, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.890 Vali Acc: 0.756 Test Loss: 0.890 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8258702754974365
Epoch: 29, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8105051517486572
Epoch: 30, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.904 Vali Acc: 0.750 Test Loss: 0.904 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8435454368591309
Epoch: 31, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.872 Vali Acc: 0.761 Test Loss: 0.872 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.792381763458252
Epoch: 32, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.887 Vali Acc: 0.772 Test Loss: 0.887 Test Acc: 0.772
Validation loss decreased (-0.772213 --> -0.772213).  Saving model ...
Epoch: 33 cost time: 0.8598721027374268
Epoch: 33, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.910 Vali Acc: 0.761 Test Loss: 0.910 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8281927108764648
Epoch: 34, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8311312198638916
Epoch: 35, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.899 Vali Acc: 0.772 Test Loss: 0.899 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8200681209564209
Epoch: 36, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.905 Vali Acc: 0.767 Test Loss: 0.905 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8156821727752686
Epoch: 37, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.911 Vali Acc: 0.794 Test Loss: 0.911 Test Acc: 0.794
Validation loss decreased (-0.772213 --> -0.794435).  Saving model ...
Epoch: 38 cost time: 0.8327615261077881
Epoch: 38, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.902 Vali Acc: 0.778 Test Loss: 0.902 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7737836837768555
Epoch: 39, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7585315704345703
Epoch: 40, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7321233749389648
Epoch: 41, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.934 Vali Acc: 0.761 Test Loss: 0.934 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8856818675994873
Epoch: 42, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.927 Vali Acc: 0.778 Test Loss: 0.927 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7593214511871338
Epoch: 43, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.944 Vali Acc: 0.761 Test Loss: 0.944 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8448758125305176
Epoch: 44, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.941 Vali Acc: 0.778 Test Loss: 0.941 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8261103630065918
Epoch: 45, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.935 Vali Acc: 0.756 Test Loss: 0.935 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8489742279052734
Epoch: 46, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.959 Vali Acc: 0.750 Test Loss: 0.959 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8654963970184326
Epoch: 47, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.982 Vali Acc: 0.756 Test Loss: 0.982 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 56687
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4045796394348145
Epoch: 1, Steps: 12 | Train Loss: 2.974 Vali Loss: 2.859 Vali Acc: 0.039 Test Loss: 2.859 Test Acc: 0.039
Validation loss decreased (inf --> -0.038860).  Saving model ...
Epoch: 2 cost time: 0.8272004127502441
Epoch: 2, Steps: 12 | Train Loss: 2.853 Vali Loss: 2.757 Vali Acc: 0.067 Test Loss: 2.757 Test Acc: 0.067
Validation loss decreased (-0.038860 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 0.8580145835876465
Epoch: 3, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.593 Vali Acc: 0.189 Test Loss: 2.593 Test Acc: 0.189
Validation loss decreased (-0.066639 --> -0.188863).  Saving model ...
Epoch: 4 cost time: 0.82135009765625
Epoch: 4, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.408 Vali Acc: 0.239 Test Loss: 2.408 Test Acc: 0.239
Validation loss decreased (-0.188863 --> -0.238865).  Saving model ...
Epoch: 5 cost time: 0.9010133743286133
Epoch: 5, Steps: 12 | Train Loss: 2.276 Vali Loss: 2.232 Vali Acc: 0.322 Test Loss: 2.232 Test Acc: 0.322
Validation loss decreased (-0.238865 --> -0.322200).  Saving model ...
Epoch: 6 cost time: 0.8805675506591797
Epoch: 6, Steps: 12 | Train Loss: 2.165 Vali Loss: 2.067 Vali Acc: 0.356 Test Loss: 2.067 Test Acc: 0.356
Validation loss decreased (-0.322200 --> -0.355535).  Saving model ...
Epoch: 7 cost time: 0.9543440341949463
Epoch: 7, Steps: 12 | Train Loss: 1.980 Vali Loss: 1.921 Vali Acc: 0.428 Test Loss: 1.921 Test Acc: 0.428
Validation loss decreased (-0.355535 --> -0.427759).  Saving model ...
Epoch: 8 cost time: 0.8235611915588379
Epoch: 8, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.784 Vali Acc: 0.489 Test Loss: 1.784 Test Acc: 0.489
Validation loss decreased (-0.427759 --> -0.488871).  Saving model ...
Epoch: 9 cost time: 0.8351716995239258
Epoch: 9, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.666 Vali Acc: 0.528 Test Loss: 1.666 Test Acc: 0.528
Validation loss decreased (-0.488871 --> -0.527761).  Saving model ...
Epoch: 10 cost time: 0.971538782119751
Epoch: 10, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.572 Vali Acc: 0.544 Test Loss: 1.572 Test Acc: 0.544
Validation loss decreased (-0.527761 --> -0.544429).  Saving model ...
Epoch: 11 cost time: 0.8201048374176025
Epoch: 11, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.490 Vali Acc: 0.544 Test Loss: 1.490 Test Acc: 0.544
Validation loss decreased (-0.544429 --> -0.544430).  Saving model ...
Epoch: 12 cost time: 0.7961053848266602
Epoch: 12, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.427 Vali Acc: 0.567 Test Loss: 1.427 Test Acc: 0.567
Validation loss decreased (-0.544430 --> -0.566652).  Saving model ...
Epoch: 13 cost time: 0.8801784515380859
Epoch: 13, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.361 Vali Acc: 0.606 Test Loss: 1.361 Test Acc: 0.606
Validation loss decreased (-0.566652 --> -0.605542).  Saving model ...
Epoch: 14 cost time: 1.1138899326324463
Epoch: 14, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.299 Vali Acc: 0.633 Test Loss: 1.299 Test Acc: 0.633
Validation loss decreased (-0.605542 --> -0.633320).  Saving model ...
Epoch: 15 cost time: 0.9682352542877197
Epoch: 15, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.247 Vali Acc: 0.628 Test Loss: 1.247 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8919577598571777
Epoch: 16, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.213 Vali Acc: 0.639 Test Loss: 1.213 Test Acc: 0.639
Validation loss decreased (-0.633320 --> -0.638877).  Saving model ...
Epoch: 17 cost time: 0.9277470111846924
Epoch: 17, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.179 Vali Acc: 0.667 Test Loss: 1.179 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666655).  Saving model ...
Epoch: 18 cost time: 0.9248263835906982
Epoch: 18, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.127 Vali Acc: 0.667 Test Loss: 1.127 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 19 cost time: 0.8819704055786133
Epoch: 19, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.084 Vali Acc: 0.683 Test Loss: 1.084 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 20 cost time: 0.8392839431762695
Epoch: 20, Steps: 12 | Train Loss: 0.692 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699990).  Saving model ...
Epoch: 21 cost time: 0.9250776767730713
Epoch: 21, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.8771617412567139
Epoch: 22, Steps: 12 | Train Loss: 0.576 Vali Loss: 1.002 Vali Acc: 0.722 Test Loss: 1.002 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722212).  Saving model ...
Epoch: 23 cost time: 0.8894374370574951
Epoch: 23, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.964 Vali Acc: 0.717 Test Loss: 0.964 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8512372970581055
Epoch: 24, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.938 Vali Acc: 0.717 Test Loss: 0.938 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8751449584960938
Epoch: 25, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.919 Vali Acc: 0.706 Test Loss: 0.919 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8946120738983154
Epoch: 26, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.902 Vali Acc: 0.733 Test Loss: 0.902 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 27 cost time: 0.9317276477813721
Epoch: 27, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.879 Vali Acc: 0.744 Test Loss: 0.879 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 28 cost time: 0.9487500190734863
Epoch: 28, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8610754013061523
Epoch: 29, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.848 Vali Acc: 0.756 Test Loss: 0.848 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 30 cost time: 0.8505775928497314
Epoch: 30, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9226303100585938
Epoch: 31, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.812 Vali Acc: 0.756 Test Loss: 0.812 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 32 cost time: 0.9770035743713379
Epoch: 32, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.812 Vali Acc: 0.756 Test Loss: 0.812 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 33 cost time: 0.9492926597595215
Epoch: 33, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 34 cost time: 0.9290034770965576
Epoch: 34, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.799 Vali Acc: 0.744 Test Loss: 0.799 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9486355781555176
Epoch: 35, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.809 Vali Acc: 0.772 Test Loss: 0.809 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772214).  Saving model ...
Epoch: 36 cost time: 0.9353165626525879
Epoch: 36, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9110119342803955
Epoch: 37, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8972647190093994
Epoch: 38, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.803 Vali Acc: 0.744 Test Loss: 0.803 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0187556743621826
Epoch: 39, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9275245666503906
Epoch: 40, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9087178707122803
Epoch: 41, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.812 Vali Acc: 0.733 Test Loss: 0.812 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9371538162231445
Epoch: 42, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.817 Vali Acc: 0.772 Test Loss: 0.817 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9516010284423828
Epoch: 43, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.811 Vali Acc: 0.772 Test Loss: 0.811 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0188665390014648
Epoch: 44, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.805 Vali Acc: 0.744 Test Loss: 0.805 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9100849628448486
Epoch: 45, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.825 Vali Acc: 0.772 Test Loss: 0.825 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 52911
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.302025079727173
Epoch: 1, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.626 Vali Acc: 0.128 Test Loss: 2.626 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 0.9170589447021484
Epoch: 2, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.522 Vali Acc: 0.172 Test Loss: 2.522 Test Acc: 0.172
Validation loss decreased (-0.127752 --> -0.172197).  Saving model ...
Epoch: 3 cost time: 0.8520174026489258
Epoch: 3, Steps: 12 | Train Loss: 2.483 Vali Loss: 2.391 Vali Acc: 0.256 Test Loss: 2.391 Test Acc: 0.256
Validation loss decreased (-0.172197 --> -0.255532).  Saving model ...
Epoch: 4 cost time: 0.8751981258392334
Epoch: 4, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.244 Vali Acc: 0.317 Test Loss: 2.244 Test Acc: 0.317
Validation loss decreased (-0.255532 --> -0.316644).  Saving model ...
Epoch: 5 cost time: 0.8591175079345703
Epoch: 5, Steps: 12 | Train Loss: 2.127 Vali Loss: 2.104 Vali Acc: 0.372 Test Loss: 2.104 Test Acc: 0.372
Validation loss decreased (-0.316644 --> -0.372201).  Saving model ...
Epoch: 6 cost time: 0.7874834537506104
Epoch: 6, Steps: 12 | Train Loss: 2.004 Vali Loss: 1.955 Vali Acc: 0.450 Test Loss: 1.955 Test Acc: 0.450
Validation loss decreased (-0.372201 --> -0.449980).  Saving model ...
Epoch: 7 cost time: 0.7859704494476318
Epoch: 7, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.837 Vali Acc: 0.489 Test Loss: 1.837 Test Acc: 0.489
Validation loss decreased (-0.449980 --> -0.488871).  Saving model ...
Epoch: 8 cost time: 0.8922417163848877
Epoch: 8, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.731 Vali Acc: 0.517 Test Loss: 1.731 Test Acc: 0.517
Validation loss decreased (-0.488871 --> -0.516649).  Saving model ...
Epoch: 9 cost time: 1.0220887660980225
Epoch: 9, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.642 Vali Acc: 0.533 Test Loss: 1.642 Test Acc: 0.533
Validation loss decreased (-0.516649 --> -0.533317).  Saving model ...
Epoch: 10 cost time: 0.8709542751312256
Epoch: 10, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.554 Vali Acc: 0.572 Test Loss: 1.554 Test Acc: 0.572
Validation loss decreased (-0.533317 --> -0.572207).  Saving model ...
Epoch: 11 cost time: 0.9196889400482178
Epoch: 11, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.497 Vali Acc: 0.572 Test Loss: 1.497 Test Acc: 0.572
Validation loss decreased (-0.572207 --> -0.572207).  Saving model ...
Epoch: 12 cost time: 0.8109331130981445
Epoch: 12, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.439 Vali Acc: 0.606 Test Loss: 1.439 Test Acc: 0.606
Validation loss decreased (-0.572207 --> -0.605541).  Saving model ...
Epoch: 13 cost time: 0.9784805774688721
Epoch: 13, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.393 Vali Acc: 0.600 Test Loss: 1.393 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8700673580169678
Epoch: 14, Steps: 12 | Train Loss: 1.090 Vali Loss: 1.338 Vali Acc: 0.617 Test Loss: 1.338 Test Acc: 0.617
Validation loss decreased (-0.605541 --> -0.616653).  Saving model ...
Epoch: 15 cost time: 1.0251679420471191
Epoch: 15, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.289 Vali Acc: 0.633 Test Loss: 1.289 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633320).  Saving model ...
Epoch: 16 cost time: 0.8586328029632568
Epoch: 16, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.247 Vali Acc: 0.633 Test Loss: 1.247 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 17 cost time: 0.8678991794586182
Epoch: 17, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.199 Vali Acc: 0.644 Test Loss: 1.199 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644432).  Saving model ...
Epoch: 18 cost time: 0.8537001609802246
Epoch: 18, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.146 Vali Acc: 0.667 Test Loss: 1.146 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 19 cost time: 0.7964446544647217
Epoch: 19, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.109 Vali Acc: 0.650 Test Loss: 1.109 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9193520545959473
Epoch: 20, Steps: 12 | Train Loss: 0.731 Vali Loss: 1.080 Vali Acc: 0.661 Test Loss: 1.080 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8239259719848633
Epoch: 21, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.032 Vali Acc: 0.661 Test Loss: 1.032 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8195436000823975
Epoch: 22, Steps: 12 | Train Loss: 0.648 Vali Loss: 1.001 Vali Acc: 0.683 Test Loss: 1.001 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 23 cost time: 0.8200562000274658
Epoch: 23, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 0.882986307144165
Epoch: 24, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.946 Vali Acc: 0.706 Test Loss: 0.946 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 25 cost time: 0.8426868915557861
Epoch: 25, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.916 Vali Acc: 0.672 Test Loss: 0.916 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9473423957824707
Epoch: 26, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.891 Vali Acc: 0.689 Test Loss: 0.891 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8382391929626465
Epoch: 27, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.885 Vali Acc: 0.711 Test Loss: 0.885 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 28 cost time: 0.7920830249786377
Epoch: 28, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.865 Vali Acc: 0.733 Test Loss: 0.865 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 29 cost time: 0.8463661670684814
Epoch: 29, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.844 Vali Acc: 0.733 Test Loss: 0.844 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 30 cost time: 0.884296178817749
Epoch: 30, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.832 Vali Acc: 0.717 Test Loss: 0.832 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8545753955841064
Epoch: 31, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.850 Vali Acc: 0.711 Test Loss: 0.850 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.799823522567749
Epoch: 32, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.823 Vali Acc: 0.711 Test Loss: 0.823 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8520638942718506
Epoch: 33, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.819 Vali Acc: 0.728 Test Loss: 0.819 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8224318027496338
Epoch: 34, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.802 Vali Acc: 0.733 Test Loss: 0.802 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 35 cost time: 0.8145198822021484
Epoch: 35, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.803 Vali Acc: 0.717 Test Loss: 0.803 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9108846187591553
Epoch: 36, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.831 Vali Acc: 0.733 Test Loss: 0.831 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8380823135375977
Epoch: 37, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.795 Vali Acc: 0.733 Test Loss: 0.795 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 38 cost time: 0.9264819622039795
Epoch: 38, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.804 Vali Acc: 0.739 Test Loss: 0.804 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 39 cost time: 0.905148983001709
Epoch: 39, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 40 cost time: 0.8288478851318359
Epoch: 40, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.810 Vali Acc: 0.744 Test Loss: 0.810 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7752554416656494
Epoch: 41, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.816889762878418
Epoch: 42, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.809 Vali Acc: 0.728 Test Loss: 0.809 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8295612335205078
Epoch: 43, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.780 Vali Acc: 0.744 Test Loss: 0.780 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7655234336853027
Epoch: 44, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.822 Vali Acc: 0.744 Test Loss: 0.822 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8619868755340576
Epoch: 45, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.799 Vali Acc: 0.733 Test Loss: 0.799 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9858248233795166
Epoch: 46, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.809 Vali Acc: 0.722 Test Loss: 0.809 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8264636993408203
Epoch: 47, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.834 Vali Acc: 0.739 Test Loss: 0.834 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8350105285644531
Epoch: 48, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.809 Vali Acc: 0.733 Test Loss: 0.809 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8358550071716309
Epoch: 49, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.824 Vali Acc: 0.739 Test Loss: 0.824 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 51055
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1531076431274414
Epoch: 1, Steps: 12 | Train Loss: 2.901 Vali Loss: 2.761 Vali Acc: 0.044 Test Loss: 2.761 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 0.7922625541687012
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.652 Vali Acc: 0.061 Test Loss: 2.652 Test Acc: 0.061
Validation loss decreased (-0.044417 --> -0.061085).  Saving model ...
Epoch: 3 cost time: 0.9590048789978027
Epoch: 3, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.523 Vali Acc: 0.122 Test Loss: 2.523 Test Acc: 0.122
Validation loss decreased (-0.061085 --> -0.122197).  Saving model ...
Epoch: 4 cost time: 0.9341535568237305
Epoch: 4, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.384 Vali Acc: 0.194 Test Loss: 2.384 Test Acc: 0.194
Validation loss decreased (-0.122197 --> -0.194421).  Saving model ...
Epoch: 5 cost time: 0.7989785671234131
Epoch: 5, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.248 Vali Acc: 0.272 Test Loss: 2.248 Test Acc: 0.272
Validation loss decreased (-0.194421 --> -0.272200).  Saving model ...
Epoch: 6 cost time: 0.9194610118865967
Epoch: 6, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.111 Vali Acc: 0.367 Test Loss: 2.111 Test Acc: 0.367
Validation loss decreased (-0.272200 --> -0.366646).  Saving model ...
Epoch: 7 cost time: 0.86202073097229
Epoch: 7, Steps: 12 | Train Loss: 2.070 Vali Loss: 1.995 Vali Acc: 0.428 Test Loss: 1.995 Test Acc: 0.428
Validation loss decreased (-0.366646 --> -0.427758).  Saving model ...
Epoch: 8 cost time: 0.9211459159851074
Epoch: 8, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.888 Vali Acc: 0.444 Test Loss: 1.888 Test Acc: 0.444
Validation loss decreased (-0.427758 --> -0.444426).  Saving model ...
Epoch: 9 cost time: 0.951286792755127
Epoch: 9, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.779 Vali Acc: 0.472 Test Loss: 1.779 Test Acc: 0.472
Validation loss decreased (-0.444426 --> -0.472204).  Saving model ...
Epoch: 10 cost time: 1.0108084678649902
Epoch: 10, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.697 Vali Acc: 0.500 Test Loss: 1.697 Test Acc: 0.500
Validation loss decreased (-0.472204 --> -0.499983).  Saving model ...
Epoch: 11 cost time: 0.8633880615234375
Epoch: 11, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.615 Vali Acc: 0.544 Test Loss: 1.615 Test Acc: 0.544
Validation loss decreased (-0.499983 --> -0.544428).  Saving model ...
Epoch: 12 cost time: 0.8629093170166016
Epoch: 12, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.557 Vali Acc: 0.550 Test Loss: 1.557 Test Acc: 0.550
Validation loss decreased (-0.544428 --> -0.549984).  Saving model ...
Epoch: 13 cost time: 0.9597625732421875
Epoch: 13, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.482 Vali Acc: 0.572 Test Loss: 1.482 Test Acc: 0.572
Validation loss decreased (-0.549984 --> -0.572207).  Saving model ...
Epoch: 14 cost time: 0.9106409549713135
Epoch: 14, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.418 Vali Acc: 0.594 Test Loss: 1.418 Test Acc: 0.594
Validation loss decreased (-0.572207 --> -0.594430).  Saving model ...
Epoch: 15 cost time: 0.8180234432220459
Epoch: 15, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.373 Vali Acc: 0.600 Test Loss: 1.373 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 0.8149173259735107
Epoch: 16, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.324 Vali Acc: 0.611 Test Loss: 1.324 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 17 cost time: 0.9506981372833252
Epoch: 17, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.292 Vali Acc: 0.611 Test Loss: 1.292 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 18 cost time: 0.8091819286346436
Epoch: 18, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.255 Vali Acc: 0.617 Test Loss: 1.255 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616654).  Saving model ...
Epoch: 19 cost time: 0.9183449745178223
Epoch: 19, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.206 Vali Acc: 0.622 Test Loss: 1.206 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 20 cost time: 0.833916187286377
Epoch: 20, Steps: 12 | Train Loss: 0.785 Vali Loss: 1.152 Vali Acc: 0.650 Test Loss: 1.152 Test Acc: 0.650
Validation loss decreased (-0.622210 --> -0.649988).  Saving model ...
Epoch: 21 cost time: 0.8446958065032959
Epoch: 21, Steps: 12 | Train Loss: 0.751 Vali Loss: 1.119 Vali Acc: 0.656 Test Loss: 1.119 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 22 cost time: 0.9263894557952881
Epoch: 22, Steps: 12 | Train Loss: 0.709 Vali Loss: 1.080 Vali Acc: 0.633 Test Loss: 1.080 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7312619686126709
Epoch: 23, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.032 Vali Acc: 0.656 Test Loss: 1.032 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 24 cost time: 0.7621152400970459
Epoch: 24, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.013 Vali Acc: 0.656 Test Loss: 1.013 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 25 cost time: 0.8511373996734619
Epoch: 25, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 26 cost time: 0.8105800151824951
Epoch: 26, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.954 Vali Acc: 0.694 Test Loss: 0.954 Test Acc: 0.694
Validation loss decreased (-0.666657 --> -0.694435).  Saving model ...
Epoch: 27 cost time: 0.7511894702911377
Epoch: 27, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.940 Vali Acc: 0.689 Test Loss: 0.940 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9543700218200684
Epoch: 28, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.909 Vali Acc: 0.706 Test Loss: 0.909 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705546).  Saving model ...
Epoch: 29 cost time: 0.944528341293335
Epoch: 29, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.889 Vali Acc: 0.711 Test Loss: 0.889 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 30 cost time: 0.8709356784820557
Epoch: 30, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.890 Vali Acc: 0.706 Test Loss: 0.890 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9377760887145996
Epoch: 31, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8324265480041504
Epoch: 32, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.864 Vali Acc: 0.711 Test Loss: 0.864 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 33 cost time: 0.9152588844299316
Epoch: 33, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.864 Vali Acc: 0.717 Test Loss: 0.864 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 34 cost time: 0.9576478004455566
Epoch: 34, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 35 cost time: 0.9459414482116699
Epoch: 35, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.847 Vali Acc: 0.739 Test Loss: 0.847 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738880).  Saving model ...
Epoch: 36 cost time: 0.9486546516418457
Epoch: 36, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.862 Vali Acc: 0.711 Test Loss: 0.862 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0447556972503662
Epoch: 37, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.838 Vali Acc: 0.728 Test Loss: 0.838 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8761112689971924
Epoch: 38, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.829 Vali Acc: 0.711 Test Loss: 0.829 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8581428527832031
Epoch: 39, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.814 Vali Acc: 0.733 Test Loss: 0.814 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8483402729034424
Epoch: 40, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.819 Vali Acc: 0.728 Test Loss: 0.819 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8897056579589844
Epoch: 41, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.800 Vali Acc: 0.722 Test Loss: 0.800 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8209285736083984
Epoch: 42, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.806 Vali Acc: 0.722 Test Loss: 0.806 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7919366359710693
Epoch: 43, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.800 Vali Acc: 0.739 Test Loss: 0.800 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 44 cost time: 0.8676102161407471
Epoch: 44, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.812 Vali Acc: 0.728 Test Loss: 0.812 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8391308784484863
Epoch: 45, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.808 Vali Acc: 0.733 Test Loss: 0.808 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8627002239227295
Epoch: 46, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.805 Vali Acc: 0.728 Test Loss: 0.805 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8706772327423096
Epoch: 47, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.799 Vali Acc: 0.733 Test Loss: 0.799 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7944223880767822
Epoch: 48, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.818 Vali Acc: 0.756 Test Loss: 0.818 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755547).  Saving model ...
Epoch: 49 cost time: 0.9416418075561523
Epoch: 49, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.820 Vali Acc: 0.744 Test Loss: 0.820 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.963395357131958
Epoch: 50, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.815 Vali Acc: 0.744 Test Loss: 0.815 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8726391792297363
Epoch: 51, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.794 Vali Acc: 0.744 Test Loss: 0.794 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8677117824554443
Epoch: 52, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8675668239593506
Epoch: 53, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8667194843292236
Epoch: 54, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.825 Vali Acc: 0.739 Test Loss: 0.825 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8102495670318604
Epoch: 55, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.8681728839874268
Epoch: 56, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 57 cost time: 0.834017276763916
Epoch: 57, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.891577959060669
Epoch: 58, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.835 Vali Acc: 0.761 Test Loss: 0.835 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 59 cost time: 0.9265785217285156
Epoch: 59, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8235540390014648
Epoch: 60, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9166319370269775
Epoch: 61, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.87235426902771
Epoch: 62, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.820 Vali Acc: 0.767 Test Loss: 0.820 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 63 cost time: 0.9581031799316406
Epoch: 63, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8797986507415771
Epoch: 64, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.834 Vali Acc: 0.756 Test Loss: 0.834 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9867146015167236
Epoch: 65, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8437743186950684
Epoch: 66, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.834 Vali Acc: 0.733 Test Loss: 0.834 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.848085880279541
Epoch: 67, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.8082001209259033
Epoch: 68, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.870 Vali Acc: 0.739 Test Loss: 0.870 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.8344173431396484
Epoch: 69, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.896 Vali Acc: 0.744 Test Loss: 0.896 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.860790491104126
Epoch: 70, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.866 Vali Acc: 0.744 Test Loss: 0.866 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.9367475509643555
Epoch: 71, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.854 Vali Acc: 0.761 Test Loss: 0.854 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.9896547794342041
Epoch: 72, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.898 Vali Acc: 0.756 Test Loss: 0.898 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 49231
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2608673572540283
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.551 Vali Acc: 0.139 Test Loss: 2.551 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.893718957901001
Epoch: 2, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.252 Vali Acc: 0.383 Test Loss: 2.252 Test Acc: 0.383
Validation loss decreased (-0.138863 --> -0.383311).  Saving model ...
Epoch: 3 cost time: 0.8868856430053711
Epoch: 3, Steps: 12 | Train Loss: 2.148 Vali Loss: 1.941 Vali Acc: 0.461 Test Loss: 1.941 Test Acc: 0.461
Validation loss decreased (-0.383311 --> -0.461092).  Saving model ...
Epoch: 4 cost time: 0.8486871719360352
Epoch: 4, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.721 Vali Acc: 0.550 Test Loss: 1.721 Test Acc: 0.550
Validation loss decreased (-0.461092 --> -0.549983).  Saving model ...
Epoch: 5 cost time: 0.831169605255127
Epoch: 5, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.554 Vali Acc: 0.533 Test Loss: 1.554 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.860349178314209
Epoch: 6, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.441 Vali Acc: 0.556 Test Loss: 1.441 Test Acc: 0.556
Validation loss decreased (-0.549983 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 0.7182087898254395
Epoch: 7, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.353 Vali Acc: 0.572 Test Loss: 1.353 Test Acc: 0.572
Validation loss decreased (-0.555541 --> -0.572209).  Saving model ...
Epoch: 8 cost time: 0.8640515804290771
Epoch: 8, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.303 Vali Acc: 0.617 Test Loss: 1.303 Test Acc: 0.617
Validation loss decreased (-0.572209 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 0.8857221603393555
Epoch: 9, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.284 Vali Acc: 0.611 Test Loss: 1.284 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8538734912872314
Epoch: 10, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.222 Vali Acc: 0.622 Test Loss: 1.222 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 11 cost time: 0.9121356010437012
Epoch: 11, Steps: 12 | Train Loss: 0.717 Vali Loss: 1.188 Vali Acc: 0.661 Test Loss: 1.188 Test Acc: 0.661
Validation loss decreased (-0.622210 --> -0.661099).  Saving model ...
Epoch: 12 cost time: 0.8777356147766113
Epoch: 12, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.118 Vali Acc: 0.678 Test Loss: 1.118 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 0.8742251396179199
Epoch: 13, Steps: 12 | Train Loss: 0.584 Vali Loss: 1.092 Vali Acc: 0.661 Test Loss: 1.092 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8750438690185547
Epoch: 14, Steps: 12 | Train Loss: 0.519 Vali Loss: 1.045 Vali Acc: 0.694 Test Loss: 1.045 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 15 cost time: 0.8646013736724854
Epoch: 15, Steps: 12 | Train Loss: 0.471 Vali Loss: 1.055 Vali Acc: 0.694 Test Loss: 1.055 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9927644729614258
Epoch: 16, Steps: 12 | Train Loss: 0.368 Vali Loss: 1.003 Vali Acc: 0.739 Test Loss: 1.003 Test Acc: 0.739
Validation loss decreased (-0.694434 --> -0.738879).  Saving model ...
Epoch: 17 cost time: 0.9862611293792725
Epoch: 17, Steps: 12 | Train Loss: 0.321 Vali Loss: 1.034 Vali Acc: 0.728 Test Loss: 1.034 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.915672779083252
Epoch: 18, Steps: 12 | Train Loss: 0.299 Vali Loss: 1.023 Vali Acc: 0.728 Test Loss: 1.023 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9323804378509521
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 1.036 Vali Acc: 0.744 Test Loss: 1.036 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744434).  Saving model ...
Epoch: 20 cost time: 0.9277915954589844
Epoch: 20, Steps: 12 | Train Loss: 0.262 Vali Loss: 1.082 Vali Acc: 0.722 Test Loss: 1.082 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9732508659362793
Epoch: 21, Steps: 12 | Train Loss: 0.217 Vali Loss: 1.055 Vali Acc: 0.744 Test Loss: 1.055 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9954302310943604
Epoch: 22, Steps: 12 | Train Loss: 0.190 Vali Loss: 1.097 Vali Acc: 0.739 Test Loss: 1.097 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9794585704803467
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.104 Vali Acc: 0.750 Test Loss: 1.104 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749989).  Saving model ...
Epoch: 24 cost time: 0.9275050163269043
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.096 Vali Acc: 0.750 Test Loss: 1.096 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 25 cost time: 0.9097704887390137
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.136 Vali Acc: 0.728 Test Loss: 1.136 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8989641666412354
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.217 Vali Acc: 0.717 Test Loss: 1.217 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9297792911529541
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.152 Vali Acc: 0.739 Test Loss: 1.152 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9190659523010254
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.176 Vali Acc: 0.739 Test Loss: 1.176 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8278000354766846
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.230 Vali Acc: 0.722 Test Loss: 1.230 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8951623439788818
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.235 Vali Acc: 0.744 Test Loss: 1.235 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9445343017578125
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.259 Vali Acc: 0.722 Test Loss: 1.259 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9029176235198975
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.281 Vali Acc: 0.739 Test Loss: 1.281 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9414019584655762
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.323 Vali Acc: 0.728 Test Loss: 1.323 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9135587215423584
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.293 Vali Acc: 0.739 Test Loss: 1.293 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 68751
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4701731204986572
Epoch: 1, Steps: 12 | Train Loss: 2.851 Vali Loss: 2.731 Vali Acc: 0.083 Test Loss: 2.731 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.9056074619293213
Epoch: 2, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.508 Vali Acc: 0.194 Test Loss: 2.508 Test Acc: 0.194
Validation loss decreased (-0.083306 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 0.9121372699737549
Epoch: 3, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.277 Vali Acc: 0.283 Test Loss: 2.277 Test Acc: 0.283
Validation loss decreased (-0.194419 --> -0.283311).  Saving model ...
Epoch: 4 cost time: 0.9233014583587646
Epoch: 4, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.053 Vali Acc: 0.478 Test Loss: 2.053 Test Acc: 0.478
Validation loss decreased (-0.283311 --> -0.477757).  Saving model ...
Epoch: 5 cost time: 0.8893165588378906
Epoch: 5, Steps: 12 | Train Loss: 1.928 Vali Loss: 1.855 Vali Acc: 0.500 Test Loss: 1.855 Test Acc: 0.500
Validation loss decreased (-0.477757 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 0.7767994403839111
Epoch: 6, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.690 Vali Acc: 0.528 Test Loss: 1.690 Test Acc: 0.528
Validation loss decreased (-0.499981 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 0.9175245761871338
Epoch: 7, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.558 Vali Acc: 0.583 Test Loss: 1.558 Test Acc: 0.583
Validation loss decreased (-0.527761 --> -0.583318).  Saving model ...
Epoch: 8 cost time: 0.9909803867340088
Epoch: 8, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.447 Vali Acc: 0.600 Test Loss: 1.447 Test Acc: 0.600
Validation loss decreased (-0.583318 --> -0.599986).  Saving model ...
Epoch: 9 cost time: 0.9665586948394775
Epoch: 9, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.371 Vali Acc: 0.622 Test Loss: 1.371 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 10 cost time: 1.0147130489349365
Epoch: 10, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.326 Vali Acc: 0.611 Test Loss: 1.326 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9870710372924805
Epoch: 11, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.256 Vali Acc: 0.650 Test Loss: 1.256 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649987).  Saving model ...
Epoch: 12 cost time: 0.9247527122497559
Epoch: 12, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.237 Vali Acc: 0.667 Test Loss: 1.237 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666654).  Saving model ...
Epoch: 13 cost time: 0.9026508331298828
Epoch: 13, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.193 Vali Acc: 0.694 Test Loss: 1.193 Test Acc: 0.694
Validation loss decreased (-0.666654 --> -0.694433).  Saving model ...
Epoch: 14 cost time: 0.9893162250518799
Epoch: 14, Steps: 12 | Train Loss: 0.751 Vali Loss: 1.143 Vali Acc: 0.683 Test Loss: 1.143 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.923408031463623
Epoch: 15, Steps: 12 | Train Loss: 0.614 Vali Loss: 1.120 Vali Acc: 0.672 Test Loss: 1.120 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9227719306945801
Epoch: 16, Steps: 12 | Train Loss: 0.550 Vali Loss: 1.070 Vali Acc: 0.706 Test Loss: 1.070 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705545).  Saving model ...
Epoch: 17 cost time: 0.962890625
Epoch: 17, Steps: 12 | Train Loss: 0.506 Vali Loss: 1.064 Vali Acc: 0.717 Test Loss: 1.064 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716656).  Saving model ...
Epoch: 18 cost time: 0.9976251125335693
Epoch: 18, Steps: 12 | Train Loss: 0.469 Vali Loss: 1.041 Vali Acc: 0.733 Test Loss: 1.041 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733323).  Saving model ...
Epoch: 19 cost time: 0.9538791179656982
Epoch: 19, Steps: 12 | Train Loss: 0.434 Vali Loss: 1.021 Vali Acc: 0.717 Test Loss: 1.021 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8894495964050293
Epoch: 20, Steps: 12 | Train Loss: 0.367 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9342200756072998
Epoch: 21, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.993 Vali Acc: 0.756 Test Loss: 0.993 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 22 cost time: 1.0351910591125488
Epoch: 22, Steps: 12 | Train Loss: 0.329 Vali Loss: 1.014 Vali Acc: 0.728 Test Loss: 1.014 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8134346008300781
Epoch: 23, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.976 Vali Acc: 0.733 Test Loss: 0.976 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8639523983001709
Epoch: 24, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9472551345825195
Epoch: 25, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.970 Vali Acc: 0.739 Test Loss: 0.970 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9508414268493652
Epoch: 26, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.006 Vali Acc: 0.717 Test Loss: 1.006 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0269157886505127
Epoch: 27, Steps: 12 | Train Loss: 0.203 Vali Loss: 1.000 Vali Acc: 0.744 Test Loss: 1.000 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9761373996734619
Epoch: 28, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.005 Vali Acc: 0.733 Test Loss: 1.005 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.02693510055542
Epoch: 29, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.013 Vali Acc: 0.711 Test Loss: 1.013 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9980628490447998
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.049 Vali Acc: 0.706 Test Loss: 1.049 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9503397941589355
Epoch: 31, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.064 Vali Acc: 0.722 Test Loss: 1.064 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 47663
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.460096597671509
Epoch: 1, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.653 Vali Acc: 0.128 Test Loss: 2.653 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.9647097587585449
Epoch: 2, Steps: 12 | Train Loss: 2.555 Vali Loss: 2.454 Vali Acc: 0.222 Test Loss: 2.454 Test Acc: 0.222
Validation loss decreased (-0.127751 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 1.0457308292388916
Epoch: 3, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.220 Vali Acc: 0.344 Test Loss: 2.220 Test Acc: 0.344
Validation loss decreased (-0.222198 --> -0.344422).  Saving model ...
Epoch: 4 cost time: 0.9289178848266602
Epoch: 4, Steps: 12 | Train Loss: 2.094 Vali Loss: 2.021 Vali Acc: 0.417 Test Loss: 2.021 Test Acc: 0.417
Validation loss decreased (-0.344422 --> -0.416646).  Saving model ...
Epoch: 5 cost time: 0.9282557964324951
Epoch: 5, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.852 Vali Acc: 0.444 Test Loss: 1.852 Test Acc: 0.444
Validation loss decreased (-0.416646 --> -0.444426).  Saving model ...
Epoch: 6 cost time: 0.9992430210113525
Epoch: 6, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.698 Vali Acc: 0.494 Test Loss: 1.698 Test Acc: 0.494
Validation loss decreased (-0.444426 --> -0.494427).  Saving model ...
Epoch: 7 cost time: 0.917264461517334
Epoch: 7, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.585 Vali Acc: 0.511 Test Loss: 1.585 Test Acc: 0.511
Validation loss decreased (-0.494427 --> -0.511095).  Saving model ...
Epoch: 8 cost time: 0.9231081008911133
Epoch: 8, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.477 Vali Acc: 0.544 Test Loss: 1.477 Test Acc: 0.544
Validation loss decreased (-0.511095 --> -0.544430).  Saving model ...
Epoch: 9 cost time: 0.906235933303833
Epoch: 9, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.410 Vali Acc: 0.567 Test Loss: 1.410 Test Acc: 0.567
Validation loss decreased (-0.544430 --> -0.566653).  Saving model ...
Epoch: 10 cost time: 0.7801921367645264
Epoch: 10, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.335 Vali Acc: 0.600 Test Loss: 1.335 Test Acc: 0.600
Validation loss decreased (-0.566653 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 0.8483927249908447
Epoch: 11, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.283 Vali Acc: 0.600 Test Loss: 1.283 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.8757147789001465
Epoch: 12, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.250 Vali Acc: 0.628 Test Loss: 1.250 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 0.813298225402832
Epoch: 13, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.185 Vali Acc: 0.650 Test Loss: 1.185 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.9054174423217773
Epoch: 14, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.136 Vali Acc: 0.656 Test Loss: 1.136 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 0.9847903251647949
Epoch: 15, Steps: 12 | Train Loss: 0.663 Vali Loss: 1.130 Vali Acc: 0.656 Test Loss: 1.130 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 16 cost time: 0.8999478816986084
Epoch: 16, Steps: 12 | Train Loss: 0.567 Vali Loss: 1.085 Vali Acc: 0.683 Test Loss: 1.085 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683322).  Saving model ...
Epoch: 17 cost time: 0.9981865882873535
Epoch: 17, Steps: 12 | Train Loss: 0.534 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.8838460445404053
Epoch: 18, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.8597385883331299
Epoch: 19, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722212).  Saving model ...
Epoch: 20 cost time: 0.9667229652404785
Epoch: 20, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.986 Vali Acc: 0.717 Test Loss: 0.986 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9127902984619141
Epoch: 21, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.970 Vali Acc: 0.722 Test Loss: 0.970 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 22 cost time: 0.8666768074035645
Epoch: 22, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.949 Vali Acc: 0.717 Test Loss: 0.949 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9952921867370605
Epoch: 23, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.949 Vali Acc: 0.717 Test Loss: 0.949 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9887363910675049
Epoch: 24, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.966 Vali Acc: 0.728 Test Loss: 0.966 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727768).  Saving model ...
Epoch: 25 cost time: 0.9463634490966797
Epoch: 25, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.952 Vali Acc: 0.717 Test Loss: 0.952 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8812201023101807
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.937 Vali Acc: 0.744 Test Loss: 0.937 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 27 cost time: 0.8100879192352295
Epoch: 27, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.975 Vali Acc: 0.733 Test Loss: 0.975 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8503878116607666
Epoch: 28, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.976 Vali Acc: 0.739 Test Loss: 0.976 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9301483631134033
Epoch: 29, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.975 Vali Acc: 0.722 Test Loss: 0.975 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8563244342803955
Epoch: 30, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.990 Vali Acc: 0.739 Test Loss: 0.990 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8354947566986084
Epoch: 31, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.011 Vali Acc: 0.744 Test Loss: 1.011 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8009998798370361
Epoch: 32, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.026 Vali Acc: 0.744 Test Loss: 1.026 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8898704051971436
Epoch: 33, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.044 Vali Acc: 0.733 Test Loss: 1.044 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8154680728912354
Epoch: 34, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.065 Vali Acc: 0.733 Test Loss: 1.065 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8641324043273926
Epoch: 35, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.041 Vali Acc: 0.744 Test Loss: 1.041 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9244847297668457
Epoch: 36, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.083 Vali Acc: 0.728 Test Loss: 1.083 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 46735
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6880359649658203
Epoch: 1, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.790 Vali Acc: 0.100 Test Loss: 2.790 Test Acc: 0.100
Validation loss decreased (inf --> -0.099972).  Saving model ...
Epoch: 2 cost time: 0.9624772071838379
Epoch: 2, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.613 Vali Acc: 0.128 Test Loss: 2.613 Test Acc: 0.128
Validation loss decreased (-0.099972 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 0.8962509632110596
Epoch: 3, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.398 Vali Acc: 0.200 Test Loss: 2.398 Test Acc: 0.200
Validation loss decreased (-0.127752 --> -0.199976).  Saving model ...
Epoch: 4 cost time: 0.9996337890625
Epoch: 4, Steps: 12 | Train Loss: 2.332 Vali Loss: 2.188 Vali Acc: 0.328 Test Loss: 2.188 Test Acc: 0.328
Validation loss decreased (-0.199976 --> -0.327756).  Saving model ...
Epoch: 5 cost time: 1.0082440376281738
Epoch: 5, Steps: 12 | Train Loss: 2.029 Vali Loss: 1.996 Vali Acc: 0.400 Test Loss: 1.996 Test Acc: 0.400
Validation loss decreased (-0.327756 --> -0.399980).  Saving model ...
Epoch: 6 cost time: 1.0471503734588623
Epoch: 6, Steps: 12 | Train Loss: 1.874 Vali Loss: 1.835 Vali Acc: 0.461 Test Loss: 1.835 Test Acc: 0.461
Validation loss decreased (-0.399980 --> -0.461093).  Saving model ...
Epoch: 7 cost time: 0.9993071556091309
Epoch: 7, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.691 Vali Acc: 0.528 Test Loss: 1.691 Test Acc: 0.528
Validation loss decreased (-0.461093 --> -0.527761).  Saving model ...
Epoch: 8 cost time: 0.8796586990356445
Epoch: 8, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.594 Vali Acc: 0.550 Test Loss: 1.594 Test Acc: 0.550
Validation loss decreased (-0.527761 --> -0.549984).  Saving model ...
Epoch: 9 cost time: 0.9214756488800049
Epoch: 9, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.501 Vali Acc: 0.561 Test Loss: 1.501 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561096).  Saving model ...
Epoch: 10 cost time: 0.8956148624420166
Epoch: 10, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.436 Vali Acc: 0.561 Test Loss: 1.436 Test Acc: 0.561
Validation loss decreased (-0.561096 --> -0.561097).  Saving model ...
Epoch: 11 cost time: 0.9772543907165527
Epoch: 11, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.370 Vali Acc: 0.578 Test Loss: 1.370 Test Acc: 0.578
Validation loss decreased (-0.561097 --> -0.577764).  Saving model ...
Epoch: 12 cost time: 0.8532376289367676
Epoch: 12, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.311 Vali Acc: 0.594 Test Loss: 1.311 Test Acc: 0.594
Validation loss decreased (-0.577764 --> -0.594431).  Saving model ...
Epoch: 13 cost time: 0.9076287746429443
Epoch: 13, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.270 Vali Acc: 0.600 Test Loss: 1.270 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 0.8450090885162354
Epoch: 14, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.233 Vali Acc: 0.622 Test Loss: 1.233 Test Acc: 0.622
Validation loss decreased (-0.599987 --> -0.622210).  Saving model ...
Epoch: 15 cost time: 0.9269025325775146
Epoch: 15, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.185 Vali Acc: 0.628 Test Loss: 1.185 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 16 cost time: 0.8651330471038818
Epoch: 16, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.142 Vali Acc: 0.650 Test Loss: 1.142 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 0.8952541351318359
Epoch: 17, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.109 Vali Acc: 0.650 Test Loss: 1.109 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 0.8924705982208252
Epoch: 18, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.097 Vali Acc: 0.644 Test Loss: 1.097 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9539368152618408
Epoch: 19, Steps: 12 | Train Loss: 0.626 Vali Loss: 1.070 Vali Acc: 0.667 Test Loss: 1.070 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666656).  Saving model ...
Epoch: 20 cost time: 0.9064862728118896
Epoch: 20, Steps: 12 | Train Loss: 0.550 Vali Loss: 1.033 Vali Acc: 0.656 Test Loss: 1.033 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9124174118041992
Epoch: 21, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.988 Vali Acc: 0.678 Test Loss: 0.988 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 22 cost time: 0.9302322864532471
Epoch: 22, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.976 Vali Acc: 0.694 Test Loss: 0.976 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 23 cost time: 0.8901946544647217
Epoch: 23, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.983 Vali Acc: 0.683 Test Loss: 0.983 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8177962303161621
Epoch: 24, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.962 Vali Acc: 0.689 Test Loss: 0.962 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8600437641143799
Epoch: 25, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.943 Vali Acc: 0.717 Test Loss: 0.943 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716657).  Saving model ...
Epoch: 26 cost time: 0.9599490165710449
Epoch: 26, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.929 Vali Acc: 0.711 Test Loss: 0.929 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0928878784179688
Epoch: 27, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.924 Vali Acc: 0.728 Test Loss: 0.924 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 28 cost time: 0.9350137710571289
Epoch: 28, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.909 Vali Acc: 0.739 Test Loss: 0.909 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 29 cost time: 0.9351792335510254
Epoch: 29, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.906 Vali Acc: 0.739 Test Loss: 0.906 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 30 cost time: 0.921022891998291
Epoch: 30, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.913 Vali Acc: 0.733 Test Loss: 0.913 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9055054187774658
Epoch: 31, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.908 Vali Acc: 0.739 Test Loss: 0.908 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.029557466506958
Epoch: 32, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.908 Vali Acc: 0.739 Test Loss: 0.908 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9030916690826416
Epoch: 33, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.923 Vali Acc: 0.733 Test Loss: 0.923 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9182798862457275
Epoch: 34, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749991).  Saving model ...
Epoch: 35 cost time: 0.9475939273834229
Epoch: 35, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.920 Vali Acc: 0.761 Test Loss: 0.920 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761102).  Saving model ...
Epoch: 36 cost time: 1.0036463737487793
Epoch: 36, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.941 Vali Acc: 0.744 Test Loss: 0.941 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8855609893798828
Epoch: 37, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.941 Vali Acc: 0.756 Test Loss: 0.941 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9032196998596191
Epoch: 38, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.937 Vali Acc: 0.772 Test Loss: 0.937 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772213).  Saving model ...
Epoch: 39 cost time: 0.933762788772583
Epoch: 39, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.949 Vali Acc: 0.767 Test Loss: 0.949 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8723509311676025
Epoch: 40, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.965 Vali Acc: 0.750 Test Loss: 0.965 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8633031845092773
Epoch: 41, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.949 Vali Acc: 0.761 Test Loss: 0.949 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7999961376190186
Epoch: 42, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.949 Vali Acc: 0.767 Test Loss: 0.949 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9213161468505859
Epoch: 43, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.977 Vali Acc: 0.756 Test Loss: 0.977 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0032153129577637
Epoch: 44, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.980 Vali Acc: 0.756 Test Loss: 0.980 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8629169464111328
Epoch: 45, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.003 Vali Acc: 0.744 Test Loss: 1.003 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8836655616760254
Epoch: 46, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.004 Vali Acc: 0.750 Test Loss: 1.004 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8767712116241455
Epoch: 47, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.980 Vali Acc: 0.761 Test Loss: 0.980 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8781888484954834
Epoch: 48, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.973 Vali Acc: 0.744 Test Loss: 0.973 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 40047
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2700793743133545
Epoch: 1, Steps: 12 | Train Loss: 2.872 Vali Loss: 2.799 Vali Acc: 0.067 Test Loss: 2.799 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.7682194709777832
Epoch: 2, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.682 Vali Acc: 0.139 Test Loss: 2.682 Test Acc: 0.139
Validation loss decreased (-0.066639 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 0.8790140151977539
Epoch: 3, Steps: 12 | Train Loss: 2.555 Vali Loss: 2.537 Vali Acc: 0.261 Test Loss: 2.537 Test Acc: 0.261
Validation loss decreased (-0.138862 --> -0.261086).  Saving model ...
Epoch: 4 cost time: 0.7882075309753418
Epoch: 4, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.375 Vali Acc: 0.372 Test Loss: 2.375 Test Acc: 0.372
Validation loss decreased (-0.261086 --> -0.372198).  Saving model ...
Epoch: 5 cost time: 0.8234450817108154
Epoch: 5, Steps: 12 | Train Loss: 2.230 Vali Loss: 2.225 Vali Acc: 0.439 Test Loss: 2.225 Test Acc: 0.439
Validation loss decreased (-0.372198 --> -0.438867).  Saving model ...
Epoch: 6 cost time: 0.83547043800354
Epoch: 6, Steps: 12 | Train Loss: 1.994 Vali Loss: 2.088 Vali Acc: 0.456 Test Loss: 2.088 Test Acc: 0.456
Validation loss decreased (-0.438867 --> -0.455535).  Saving model ...
Epoch: 7 cost time: 0.8084652423858643
Epoch: 7, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.945 Vali Acc: 0.461 Test Loss: 1.945 Test Acc: 0.461
Validation loss decreased (-0.455535 --> -0.461092).  Saving model ...
Epoch: 8 cost time: 0.8573076725006104
Epoch: 8, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.837 Vali Acc: 0.489 Test Loss: 1.837 Test Acc: 0.489
Validation loss decreased (-0.461092 --> -0.488871).  Saving model ...
Epoch: 9 cost time: 0.8286244869232178
Epoch: 9, Steps: 12 | Train Loss: 1.606 Vali Loss: 1.740 Vali Acc: 0.506 Test Loss: 1.740 Test Acc: 0.506
Validation loss decreased (-0.488871 --> -0.505538).  Saving model ...
Epoch: 10 cost time: 0.8180210590362549
Epoch: 10, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.657 Vali Acc: 0.511 Test Loss: 1.657 Test Acc: 0.511
Validation loss decreased (-0.505538 --> -0.511095).  Saving model ...
Epoch: 11 cost time: 0.8577291965484619
Epoch: 11, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.587 Vali Acc: 0.539 Test Loss: 1.587 Test Acc: 0.539
Validation loss decreased (-0.511095 --> -0.538873).  Saving model ...
Epoch: 12 cost time: 0.8408665657043457
Epoch: 12, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.534 Vali Acc: 0.561 Test Loss: 1.534 Test Acc: 0.561
Validation loss decreased (-0.538873 --> -0.561096).  Saving model ...
Epoch: 13 cost time: 0.8290121555328369
Epoch: 13, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.482 Vali Acc: 0.561 Test Loss: 1.482 Test Acc: 0.561
Validation loss decreased (-0.561096 --> -0.561096).  Saving model ...
Epoch: 14 cost time: 0.8104090690612793
Epoch: 14, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.418 Vali Acc: 0.583 Test Loss: 1.418 Test Acc: 0.583
Validation loss decreased (-0.561096 --> -0.583319).  Saving model ...
Epoch: 15 cost time: 0.798147439956665
Epoch: 15, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.369 Vali Acc: 0.606 Test Loss: 1.369 Test Acc: 0.606
Validation loss decreased (-0.583319 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 0.9071323871612549
Epoch: 16, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8455450534820557
Epoch: 17, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.303 Vali Acc: 0.622 Test Loss: 1.303 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 18 cost time: 0.9450645446777344
Epoch: 18, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.252 Vali Acc: 0.650 Test Loss: 1.252 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649987).  Saving model ...
Epoch: 19 cost time: 0.8536171913146973
Epoch: 19, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.233 Vali Acc: 0.644 Test Loss: 1.233 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.906355619430542
Epoch: 20, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.198 Vali Acc: 0.667 Test Loss: 1.198 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666655).  Saving model ...
Epoch: 21 cost time: 0.8289196491241455
Epoch: 21, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.167 Vali Acc: 0.656 Test Loss: 1.167 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9317820072174072
Epoch: 22, Steps: 12 | Train Loss: 0.649 Vali Loss: 1.145 Vali Acc: 0.661 Test Loss: 1.145 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9016773700714111
Epoch: 23, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.132 Vali Acc: 0.678 Test Loss: 1.132 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677766).  Saving model ...
Epoch: 24 cost time: 0.8232786655426025
Epoch: 24, Steps: 12 | Train Loss: 0.611 Vali Loss: 1.098 Vali Acc: 0.667 Test Loss: 1.098 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8645346164703369
Epoch: 25, Steps: 12 | Train Loss: 0.595 Vali Loss: 1.075 Vali Acc: 0.678 Test Loss: 1.075 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677767).  Saving model ...
Epoch: 26 cost time: 0.7771420478820801
Epoch: 26, Steps: 12 | Train Loss: 0.534 Vali Loss: 1.031 Vali Acc: 0.689 Test Loss: 1.031 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 27 cost time: 0.8146810531616211
Epoch: 27, Steps: 12 | Train Loss: 0.496 Vali Loss: 1.003 Vali Acc: 0.694 Test Loss: 1.003 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694434).  Saving model ...
Epoch: 28 cost time: 0.8528878688812256
Epoch: 28, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.989 Vali Acc: 0.706 Test Loss: 0.989 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 29 cost time: 0.7829463481903076
Epoch: 29, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.963 Vali Acc: 0.717 Test Loss: 0.963 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 30 cost time: 0.8202404975891113
Epoch: 30, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 31 cost time: 0.7276115417480469
Epoch: 31, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.921 Vali Acc: 0.744 Test Loss: 0.921 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 32 cost time: 0.7953813076019287
Epoch: 32, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.906 Vali Acc: 0.733 Test Loss: 0.906 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7772462368011475
Epoch: 33, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.904 Vali Acc: 0.733 Test Loss: 0.904 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8404080867767334
Epoch: 34, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.909 Vali Acc: 0.750 Test Loss: 0.909 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 35 cost time: 0.9047935009002686
Epoch: 35, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761102).  Saving model ...
Epoch: 36 cost time: 0.882122278213501
Epoch: 36, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.877 Vali Acc: 0.772 Test Loss: 0.877 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772213).  Saving model ...
Epoch: 37 cost time: 0.8243975639343262
Epoch: 37, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.873 Vali Acc: 0.772 Test Loss: 0.873 Test Acc: 0.772
Validation loss decreased (-0.772213 --> -0.772213).  Saving model ...
Epoch: 38 cost time: 0.8383750915527344
Epoch: 38, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.878 Vali Acc: 0.756 Test Loss: 0.878 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8597369194030762
Epoch: 39, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.887 Vali Acc: 0.783 Test Loss: 0.887 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783324).  Saving model ...
Epoch: 40 cost time: 0.8282370567321777
Epoch: 40, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.876 Vali Acc: 0.778 Test Loss: 0.876 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8163998126983643
Epoch: 41, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.845 Vali Acc: 0.772 Test Loss: 0.845 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8055324554443359
Epoch: 42, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8212828636169434
Epoch: 43, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.865 Vali Acc: 0.761 Test Loss: 0.865 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.820178747177124
Epoch: 44, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.867 Vali Acc: 0.783 Test Loss: 0.867 Test Acc: 0.783
Validation loss decreased (-0.783324 --> -0.783325).  Saving model ...
Epoch: 45 cost time: 0.8283224105834961
Epoch: 45, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.841 Vali Acc: 0.756 Test Loss: 0.841 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.90582275390625
Epoch: 46, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.839 Vali Acc: 0.783 Test Loss: 0.839 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783325).  Saving model ...
Epoch: 47 cost time: 0.8426787853240967
Epoch: 47, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.857 Vali Acc: 0.761 Test Loss: 0.857 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7519662380218506
Epoch: 48, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.866 Vali Acc: 0.767 Test Loss: 0.866 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9255199432373047
Epoch: 49, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.846 Vali Acc: 0.789 Test Loss: 0.846 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788880).  Saving model ...
Epoch: 50 cost time: 0.8680267333984375
Epoch: 50, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8205149173736572
Epoch: 51, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.846 Vali Acc: 0.778 Test Loss: 0.846 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.882911205291748
Epoch: 52, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.869 Vali Acc: 0.761 Test Loss: 0.869 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9001967906951904
Epoch: 53, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.867 Vali Acc: 0.778 Test Loss: 0.867 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8148820400238037
Epoch: 54, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.878 Vali Acc: 0.778 Test Loss: 0.878 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.7400949001312256
Epoch: 55, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.876 Vali Acc: 0.761 Test Loss: 0.876 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.812481164932251
Epoch: 56, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.891 Vali Acc: 0.772 Test Loss: 0.891 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.8486390113830566
Epoch: 57, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.903 Vali Acc: 0.778 Test Loss: 0.903 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.8716080188751221
Epoch: 58, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.889 Vali Acc: 0.783 Test Loss: 0.889 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.7616004943847656
Epoch: 59, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.897 Vali Acc: 0.772 Test Loss: 0.897 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 36271
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.39258074760437
Epoch: 1, Steps: 12 | Train Loss: 2.945 Vali Loss: 2.838 Vali Acc: 0.044 Test Loss: 2.838 Test Acc: 0.044
Validation loss decreased (inf --> -0.044416).  Saving model ...
Epoch: 2 cost time: 0.7414767742156982
Epoch: 2, Steps: 12 | Train Loss: 2.814 Vali Loss: 2.724 Vali Acc: 0.072 Test Loss: 2.724 Test Acc: 0.072
Validation loss decreased (-0.044416 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.9095156192779541
Epoch: 3, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.574 Vali Acc: 0.089 Test Loss: 2.574 Test Acc: 0.089
Validation loss decreased (-0.072195 --> -0.088863).  Saving model ...
Epoch: 4 cost time: 0.859673023223877
Epoch: 4, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.416 Vali Acc: 0.211 Test Loss: 2.416 Test Acc: 0.211
Validation loss decreased (-0.088863 --> -0.211087).  Saving model ...
Epoch: 5 cost time: 0.849433183670044
Epoch: 5, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.254 Vali Acc: 0.361 Test Loss: 2.254 Test Acc: 0.361
Validation loss decreased (-0.211087 --> -0.361089).  Saving model ...
Epoch: 6 cost time: 0.8686795234680176
Epoch: 6, Steps: 12 | Train Loss: 2.171 Vali Loss: 2.093 Vali Acc: 0.400 Test Loss: 2.093 Test Acc: 0.400
Validation loss decreased (-0.361089 --> -0.399979).  Saving model ...
Epoch: 7 cost time: 0.9301624298095703
Epoch: 7, Steps: 12 | Train Loss: 2.026 Vali Loss: 1.959 Vali Acc: 0.444 Test Loss: 1.959 Test Acc: 0.444
Validation loss decreased (-0.399979 --> -0.444425).  Saving model ...
Epoch: 8 cost time: 0.8988351821899414
Epoch: 8, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.843 Vali Acc: 0.500 Test Loss: 1.843 Test Acc: 0.500
Validation loss decreased (-0.444425 --> -0.499982).  Saving model ...
Epoch: 9 cost time: 0.888671875
Epoch: 9, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.734 Vali Acc: 0.500 Test Loss: 1.734 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499983).  Saving model ...
Epoch: 10 cost time: 0.8651423454284668
Epoch: 10, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.637 Vali Acc: 0.550 Test Loss: 1.637 Test Acc: 0.550
Validation loss decreased (-0.499983 --> -0.549984).  Saving model ...
Epoch: 11 cost time: 0.8739478588104248
Epoch: 11, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.556 Vali Acc: 0.567 Test Loss: 1.556 Test Acc: 0.567
Validation loss decreased (-0.549984 --> -0.566651).  Saving model ...
Epoch: 12 cost time: 0.8459196090698242
Epoch: 12, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.492 Vali Acc: 0.567 Test Loss: 1.492 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566652).  Saving model ...
Epoch: 13 cost time: 0.8591852188110352
Epoch: 13, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.445 Vali Acc: 0.572 Test Loss: 1.445 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 14 cost time: 0.888331413269043
Epoch: 14, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.405 Vali Acc: 0.594 Test Loss: 1.405 Test Acc: 0.594
Validation loss decreased (-0.572208 --> -0.594430).  Saving model ...
Epoch: 15 cost time: 0.8532595634460449
Epoch: 15, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.361 Vali Acc: 0.617 Test Loss: 1.361 Test Acc: 0.617
Validation loss decreased (-0.594430 --> -0.616653).  Saving model ...
Epoch: 16 cost time: 0.8236210346221924
Epoch: 16, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.308 Vali Acc: 0.600 Test Loss: 1.308 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.914539098739624
Epoch: 17, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.264 Vali Acc: 0.628 Test Loss: 1.264 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627765).  Saving model ...
Epoch: 18 cost time: 0.9002838134765625
Epoch: 18, Steps: 12 | Train Loss: 0.934 Vali Loss: 1.226 Vali Acc: 0.628 Test Loss: 1.226 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627766).  Saving model ...
Epoch: 19 cost time: 0.8912234306335449
Epoch: 19, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.211 Vali Acc: 0.617 Test Loss: 1.211 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8480401039123535
Epoch: 20, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.173 Vali Acc: 0.633 Test Loss: 1.173 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633322).  Saving model ...
Epoch: 21 cost time: 0.9289681911468506
Epoch: 21, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.142 Vali Acc: 0.678 Test Loss: 1.142 Test Acc: 0.678
Validation loss decreased (-0.633322 --> -0.677766).  Saving model ...
Epoch: 22 cost time: 0.8651058673858643
Epoch: 22, Steps: 12 | Train Loss: 0.728 Vali Loss: 1.130 Vali Acc: 0.656 Test Loss: 1.130 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8947458267211914
Epoch: 23, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.095 Vali Acc: 0.661 Test Loss: 1.095 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8839573860168457
Epoch: 24, Steps: 12 | Train Loss: 0.604 Vali Loss: 1.059 Vali Acc: 0.672 Test Loss: 1.059 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.913985013961792
Epoch: 25, Steps: 12 | Train Loss: 0.572 Vali Loss: 1.017 Vali Acc: 0.689 Test Loss: 1.017 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688879).  Saving model ...
Epoch: 26 cost time: 0.889944314956665
Epoch: 26, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 27 cost time: 0.8021929264068604
Epoch: 27, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.985 Vali Acc: 0.689 Test Loss: 0.985 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8576419353485107
Epoch: 28, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.950 Vali Acc: 0.706 Test Loss: 0.950 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 29 cost time: 0.8737788200378418
Epoch: 29, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.923 Vali Acc: 0.717 Test Loss: 0.923 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 30 cost time: 0.8669209480285645
Epoch: 30, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.931 Vali Acc: 0.711 Test Loss: 0.931 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9377486705780029
Epoch: 31, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.905 Vali Acc: 0.700 Test Loss: 0.905 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.903313159942627
Epoch: 32, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.888 Vali Acc: 0.706 Test Loss: 0.888 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9005024433135986
Epoch: 33, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.889 Vali Acc: 0.706 Test Loss: 0.889 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9215424060821533
Epoch: 34, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.856 Vali Acc: 0.717 Test Loss: 0.856 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716658).  Saving model ...
Epoch: 35 cost time: 0.9653770923614502
Epoch: 35, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.860 Vali Acc: 0.728 Test Loss: 0.860 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727769).  Saving model ...
Epoch: 36 cost time: 0.8848710060119629
Epoch: 36, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 37 cost time: 0.9356534481048584
Epoch: 37, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.827 Vali Acc: 0.744 Test Loss: 0.827 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 38 cost time: 0.8686811923980713
Epoch: 38, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.836 Vali Acc: 0.744 Test Loss: 0.836 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.969714879989624
Epoch: 39, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.842 Vali Acc: 0.739 Test Loss: 0.842 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9214754104614258
Epoch: 40, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.854 Vali Acc: 0.711 Test Loss: 0.854 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8808798789978027
Epoch: 41, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.852 Vali Acc: 0.711 Test Loss: 0.852 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9310338497161865
Epoch: 42, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.839 Vali Acc: 0.744 Test Loss: 0.839 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9727563858032227
Epoch: 43, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.847 Vali Acc: 0.733 Test Loss: 0.847 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9349997043609619
Epoch: 44, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8565983772277832
Epoch: 45, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8863472938537598
Epoch: 46, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.825 Vali Acc: 0.733 Test Loss: 0.825 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9104959964752197
Epoch: 47, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.845 Vali Acc: 0.733 Test Loss: 0.845 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 34415
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5276663303375244
Epoch: 1, Steps: 12 | Train Loss: 2.946 Vali Loss: 2.882 Vali Acc: 0.067 Test Loss: 2.882 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 0.971930980682373
Epoch: 2, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.805 Vali Acc: 0.122 Test Loss: 2.805 Test Acc: 0.122
Validation loss decreased (-0.066638 --> -0.122194).  Saving model ...
Epoch: 3 cost time: 0.8384923934936523
Epoch: 3, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.696 Vali Acc: 0.161 Test Loss: 2.696 Test Acc: 0.161
Validation loss decreased (-0.122194 --> -0.161084).  Saving model ...
Epoch: 4 cost time: 0.9350614547729492
Epoch: 4, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.566 Vali Acc: 0.256 Test Loss: 2.566 Test Acc: 0.256
Validation loss decreased (-0.161084 --> -0.255530).  Saving model ...
Epoch: 5 cost time: 0.9351069927215576
Epoch: 5, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.431 Vali Acc: 0.311 Test Loss: 2.431 Test Acc: 0.311
Validation loss decreased (-0.255530 --> -0.311087).  Saving model ...
Epoch: 6 cost time: 0.8749356269836426
Epoch: 6, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.295 Vali Acc: 0.350 Test Loss: 2.295 Test Acc: 0.350
Validation loss decreased (-0.311087 --> -0.349977).  Saving model ...
Epoch: 7 cost time: 0.8495900630950928
Epoch: 7, Steps: 12 | Train Loss: 2.159 Vali Loss: 2.161 Vali Acc: 0.378 Test Loss: 2.161 Test Acc: 0.378
Validation loss decreased (-0.349977 --> -0.377756).  Saving model ...
Epoch: 8 cost time: 0.8303048610687256
Epoch: 8, Steps: 12 | Train Loss: 1.979 Vali Loss: 2.035 Vali Acc: 0.428 Test Loss: 2.035 Test Acc: 0.428
Validation loss decreased (-0.377756 --> -0.427757).  Saving model ...
Epoch: 9 cost time: 0.888918399810791
Epoch: 9, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.915 Vali Acc: 0.467 Test Loss: 1.915 Test Acc: 0.467
Validation loss decreased (-0.427757 --> -0.466648).  Saving model ...
Epoch: 10 cost time: 0.8647356033325195
Epoch: 10, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.814 Vali Acc: 0.506 Test Loss: 1.814 Test Acc: 0.506
Validation loss decreased (-0.466648 --> -0.505537).  Saving model ...
Epoch: 11 cost time: 0.8371627330780029
Epoch: 11, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.720 Vali Acc: 0.533 Test Loss: 1.720 Test Acc: 0.533
Validation loss decreased (-0.505537 --> -0.533316).  Saving model ...
Epoch: 12 cost time: 0.8836872577667236
Epoch: 12, Steps: 12 | Train Loss: 1.475 Vali Loss: 1.644 Vali Acc: 0.522 Test Loss: 1.644 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8359313011169434
Epoch: 13, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.570 Vali Acc: 0.578 Test Loss: 1.570 Test Acc: 0.578
Validation loss decreased (-0.533316 --> -0.577762).  Saving model ...
Epoch: 14 cost time: 0.8510525226593018
Epoch: 14, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.497 Vali Acc: 0.583 Test Loss: 1.497 Test Acc: 0.583
Validation loss decreased (-0.577762 --> -0.583318).  Saving model ...
Epoch: 15 cost time: 0.9939429759979248
Epoch: 15, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.436 Vali Acc: 0.583 Test Loss: 1.436 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 16 cost time: 0.8707654476165771
Epoch: 16, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.380 Vali Acc: 0.583 Test Loss: 1.380 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583320).  Saving model ...
Epoch: 17 cost time: 0.9109253883361816
Epoch: 17, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.321 Vali Acc: 0.589 Test Loss: 1.321 Test Acc: 0.589
Validation loss decreased (-0.583320 --> -0.588876).  Saving model ...
Epoch: 18 cost time: 0.8807787895202637
Epoch: 18, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.265 Vali Acc: 0.589 Test Loss: 1.265 Test Acc: 0.589
Validation loss decreased (-0.588876 --> -0.588876).  Saving model ...
Epoch: 19 cost time: 0.833751916885376
Epoch: 19, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
Validation loss decreased (-0.588876 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.8526263236999512
Epoch: 20, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.145 Vali Acc: 0.611 Test Loss: 1.145 Test Acc: 0.611
Validation loss decreased (-0.599988 --> -0.611100).  Saving model ...
Epoch: 21 cost time: 0.9201691150665283
Epoch: 21, Steps: 12 | Train Loss: 0.806 Vali Loss: 1.100 Vali Acc: 0.633 Test Loss: 1.100 Test Acc: 0.633
Validation loss decreased (-0.611100 --> -0.633322).  Saving model ...
Epoch: 22 cost time: 0.7819778919219971
Epoch: 22, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.053 Vali Acc: 0.644 Test Loss: 1.053 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644434).  Saving model ...
Epoch: 23 cost time: 1.0067944526672363
Epoch: 23, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.024 Vali Acc: 0.628 Test Loss: 1.024 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7949905395507812
Epoch: 24, Steps: 12 | Train Loss: 0.690 Vali Loss: 1.002 Vali Acc: 0.661 Test Loss: 1.002 Test Acc: 0.661
Validation loss decreased (-0.644434 --> -0.661101).  Saving model ...
Epoch: 25 cost time: 0.8850646018981934
Epoch: 25, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.965 Vali Acc: 0.683 Test Loss: 0.965 Test Acc: 0.683
Validation loss decreased (-0.661101 --> -0.683324).  Saving model ...
Epoch: 26 cost time: 0.8526430130004883
Epoch: 26, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.956 Vali Acc: 0.672 Test Loss: 0.956 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8860270977020264
Epoch: 27, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.931 Vali Acc: 0.700 Test Loss: 0.931 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699991).  Saving model ...
Epoch: 28 cost time: 0.8941595554351807
Epoch: 28, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.909 Vali Acc: 0.694 Test Loss: 0.909 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8608465194702148
Epoch: 29, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.885 Vali Acc: 0.711 Test Loss: 0.885 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 30 cost time: 0.8690128326416016
Epoch: 30, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.887 Vali Acc: 0.694 Test Loss: 0.887 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9032227993011475
Epoch: 31, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.874 Vali Acc: 0.733 Test Loss: 0.874 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 32 cost time: 0.8276715278625488
Epoch: 32, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.865 Vali Acc: 0.733 Test Loss: 0.865 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 33 cost time: 0.8680477142333984
Epoch: 33, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.856 Vali Acc: 0.722 Test Loss: 0.856 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9005868434906006
Epoch: 34, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.844 Vali Acc: 0.717 Test Loss: 0.844 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.903437614440918
Epoch: 35, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.843 Vali Acc: 0.733 Test Loss: 0.843 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 36 cost time: 0.9356470108032227
Epoch: 36, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.830 Vali Acc: 0.728 Test Loss: 0.830 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8678042888641357
Epoch: 37, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.829 Vali Acc: 0.728 Test Loss: 0.829 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9290957450866699
Epoch: 38, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 39 cost time: 0.8958687782287598
Epoch: 39, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.821 Vali Acc: 0.739 Test Loss: 0.821 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8980538845062256
Epoch: 40, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.827 Vali Acc: 0.733 Test Loss: 0.827 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8082356452941895
Epoch: 41, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 42 cost time: 0.8689911365509033
Epoch: 42, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8853552341461182
Epoch: 43, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.815 Vali Acc: 0.739 Test Loss: 0.815 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8731732368469238
Epoch: 44, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.794 Vali Acc: 0.744 Test Loss: 0.794 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9242269992828369
Epoch: 45, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.798 Vali Acc: 0.744 Test Loss: 0.798 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8933999538421631
Epoch: 46, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.811 Vali Acc: 0.739 Test Loss: 0.811 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9011414051055908
Epoch: 47, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.821 Vali Acc: 0.739 Test Loss: 0.821 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8537983894348145
Epoch: 48, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.802 Vali Acc: 0.739 Test Loss: 0.802 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9099819660186768
Epoch: 49, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8738048076629639
Epoch: 50, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.9369587898254395
Epoch: 51, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 32591
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.362121105194092
Epoch: 1, Steps: 12 | Train Loss: 2.877 Vali Loss: 2.622 Vali Acc: 0.161 Test Loss: 2.622 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 0.8471977710723877
Epoch: 2, Steps: 12 | Train Loss: 2.554 Vali Loss: 2.279 Vali Acc: 0.333 Test Loss: 2.279 Test Acc: 0.333
Validation loss decreased (-0.161085 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 0.8635873794555664
Epoch: 3, Steps: 12 | Train Loss: 2.170 Vali Loss: 1.947 Vali Acc: 0.417 Test Loss: 1.947 Test Acc: 0.417
Validation loss decreased (-0.333311 --> -0.416647).  Saving model ...
Epoch: 4 cost time: 0.8875513076782227
Epoch: 4, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.710 Vali Acc: 0.489 Test Loss: 1.710 Test Acc: 0.489
Validation loss decreased (-0.416647 --> -0.488872).  Saving model ...
Epoch: 5 cost time: 0.9069192409515381
Epoch: 5, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.556 Vali Acc: 0.544 Test Loss: 1.556 Test Acc: 0.544
Validation loss decreased (-0.488872 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 0.8551619052886963
Epoch: 6, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.434 Vali Acc: 0.572 Test Loss: 1.434 Test Acc: 0.572
Validation loss decreased (-0.544429 --> -0.572208).  Saving model ...
Epoch: 7 cost time: 0.83854079246521
Epoch: 7, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.365 Vali Acc: 0.600 Test Loss: 1.365 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 0.8168120384216309
Epoch: 8, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.303 Vali Acc: 0.606 Test Loss: 1.303 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 0.837454080581665
Epoch: 9, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.236 Vali Acc: 0.611 Test Loss: 1.236 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611099).  Saving model ...
Epoch: 10 cost time: 0.8371424674987793
Epoch: 10, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.212 Vali Acc: 0.633 Test Loss: 1.212 Test Acc: 0.633
Validation loss decreased (-0.611099 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 0.9055445194244385
Epoch: 11, Steps: 12 | Train Loss: 0.761 Vali Loss: 1.188 Vali Acc: 0.656 Test Loss: 1.188 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 12 cost time: 0.9055547714233398
Epoch: 12, Steps: 12 | Train Loss: 0.609 Vali Loss: 1.137 Vali Acc: 0.667 Test Loss: 1.137 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.8526747226715088
Epoch: 13, Steps: 12 | Train Loss: 0.556 Vali Loss: 1.090 Vali Acc: 0.683 Test Loss: 1.090 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 14 cost time: 0.8760571479797363
Epoch: 14, Steps: 12 | Train Loss: 0.505 Vali Loss: 1.070 Vali Acc: 0.689 Test Loss: 1.070 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 15 cost time: 0.8749864101409912
Epoch: 15, Steps: 12 | Train Loss: 0.452 Vali Loss: 1.042 Vali Acc: 0.717 Test Loss: 1.042 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716656).  Saving model ...
Epoch: 16 cost time: 0.930368185043335
Epoch: 16, Steps: 12 | Train Loss: 0.357 Vali Loss: 1.028 Vali Acc: 0.717 Test Loss: 1.028 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716656).  Saving model ...
Epoch: 17 cost time: 0.9565837383270264
Epoch: 17, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.031 Vali Acc: 0.694 Test Loss: 1.031 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9260437488555908
Epoch: 18, Steps: 12 | Train Loss: 0.322 Vali Loss: 1.031 Vali Acc: 0.739 Test Loss: 1.031 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738879).  Saving model ...
Epoch: 19 cost time: 0.8144547939300537
Epoch: 19, Steps: 12 | Train Loss: 0.248 Vali Loss: 1.031 Vali Acc: 0.722 Test Loss: 1.031 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.942439079284668
Epoch: 20, Steps: 12 | Train Loss: 0.255 Vali Loss: 1.070 Vali Acc: 0.722 Test Loss: 1.070 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.898521900177002
Epoch: 21, Steps: 12 | Train Loss: 0.239 Vali Loss: 1.041 Vali Acc: 0.722 Test Loss: 1.041 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8353359699249268
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.039 Vali Acc: 0.739 Test Loss: 1.039 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.850846529006958
Epoch: 23, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.126 Vali Acc: 0.728 Test Loss: 1.126 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9309980869293213
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.102 Vali Acc: 0.750 Test Loss: 1.102 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749989).  Saving model ...
Epoch: 25 cost time: 0.7739973068237305
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.171 Vali Acc: 0.717 Test Loss: 1.171 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8994548320770264
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.195 Vali Acc: 0.722 Test Loss: 1.195 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8424384593963623
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.204 Vali Acc: 0.722 Test Loss: 1.204 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8295173645019531
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.204 Vali Acc: 0.739 Test Loss: 1.204 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7934787273406982
Epoch: 29, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.225 Vali Acc: 0.722 Test Loss: 1.225 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9753189086914062
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.246 Vali Acc: 0.728 Test Loss: 1.246 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.836458683013916
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.254 Vali Acc: 0.739 Test Loss: 1.254 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8752014636993408
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.304 Vali Acc: 0.739 Test Loss: 1.304 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9337348937988281
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.323 Vali Acc: 0.728 Test Loss: 1.323 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.865753173828125
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.371 Vali Acc: 0.739 Test Loss: 1.371 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 60431
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3902390003204346
Epoch: 1, Steps: 12 | Train Loss: 2.855 Vali Loss: 2.699 Vali Acc: 0.111 Test Loss: 2.699 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.7111630439758301
Epoch: 2, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.522 Vali Acc: 0.178 Test Loss: 2.522 Test Acc: 0.178
Validation loss decreased (-0.111084 --> -0.177753).  Saving model ...
Epoch: 3 cost time: 0.8882079124450684
Epoch: 3, Steps: 12 | Train Loss: 2.473 Vali Loss: 2.310 Vali Acc: 0.272 Test Loss: 2.310 Test Acc: 0.272
Validation loss decreased (-0.177753 --> -0.272199).  Saving model ...
Epoch: 4 cost time: 0.8341856002807617
Epoch: 4, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.107 Vali Acc: 0.406 Test Loss: 2.107 Test Acc: 0.406
Validation loss decreased (-0.272199 --> -0.405534).  Saving model ...
Epoch: 5 cost time: 0.8363125324249268
Epoch: 5, Steps: 12 | Train Loss: 2.016 Vali Loss: 1.917 Vali Acc: 0.483 Test Loss: 1.917 Test Acc: 0.483
Validation loss decreased (-0.405534 --> -0.483314).  Saving model ...
Epoch: 6 cost time: 0.7532267570495605
Epoch: 6, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.757 Vali Acc: 0.506 Test Loss: 1.757 Test Acc: 0.506
Validation loss decreased (-0.483314 --> -0.505538).  Saving model ...
Epoch: 7 cost time: 0.8089532852172852
Epoch: 7, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.619 Vali Acc: 0.539 Test Loss: 1.619 Test Acc: 0.539
Validation loss decreased (-0.505538 --> -0.538873).  Saving model ...
Epoch: 8 cost time: 0.8030157089233398
Epoch: 8, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.520 Vali Acc: 0.572 Test Loss: 1.520 Test Acc: 0.572
Validation loss decreased (-0.538873 --> -0.572207).  Saving model ...
Epoch: 9 cost time: 0.8147635459899902
Epoch: 9, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.439 Vali Acc: 0.600 Test Loss: 1.439 Test Acc: 0.600
Validation loss decreased (-0.572207 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.8116006851196289
Epoch: 10, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.364 Vali Acc: 0.622 Test Loss: 1.364 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 0.8358054161071777
Epoch: 11, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.317 Vali Acc: 0.650 Test Loss: 1.317 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649987).  Saving model ...
Epoch: 12 cost time: 0.7962610721588135
Epoch: 12, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.277 Vali Acc: 0.644 Test Loss: 1.277 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7342336177825928
Epoch: 13, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.233 Vali Acc: 0.656 Test Loss: 1.233 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 0.8647668361663818
Epoch: 14, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.156 Vali Acc: 0.661 Test Loss: 1.156 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661100).  Saving model ...
Epoch: 15 cost time: 0.7866208553314209
Epoch: 15, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.144 Vali Acc: 0.700 Test Loss: 1.144 Test Acc: 0.700
Validation loss decreased (-0.661100 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.8154327869415283
Epoch: 16, Steps: 12 | Train Loss: 0.678 Vali Loss: 1.132 Vali Acc: 0.672 Test Loss: 1.132 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8001258373260498
Epoch: 17, Steps: 12 | Train Loss: 0.627 Vali Loss: 1.101 Vali Acc: 0.689 Test Loss: 1.101 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8161625862121582
Epoch: 18, Steps: 12 | Train Loss: 0.575 Vali Loss: 1.039 Vali Acc: 0.689 Test Loss: 1.039 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9263575077056885
Epoch: 19, Steps: 12 | Train Loss: 0.496 Vali Loss: 1.020 Vali Acc: 0.706 Test Loss: 1.020 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 20 cost time: 0.7570159435272217
Epoch: 20, Steps: 12 | Train Loss: 0.436 Vali Loss: 1.024 Vali Acc: 0.722 Test Loss: 1.024 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722212).  Saving model ...
Epoch: 21 cost time: 0.8475985527038574
Epoch: 21, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.995 Vali Acc: 0.717 Test Loss: 0.995 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.816098690032959
Epoch: 22, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.984 Vali Acc: 0.711 Test Loss: 0.984 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.825584888458252
Epoch: 23, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.977 Vali Acc: 0.739 Test Loss: 0.977 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 24 cost time: 0.8927714824676514
Epoch: 24, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.977 Vali Acc: 0.733 Test Loss: 0.977 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8049447536468506
Epoch: 25, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.934 Vali Acc: 0.756 Test Loss: 0.934 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 26 cost time: 0.8191773891448975
Epoch: 26, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.989 Vali Acc: 0.744 Test Loss: 0.989 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.867790699005127
Epoch: 27, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.975 Vali Acc: 0.744 Test Loss: 0.975 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8312714099884033
Epoch: 28, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.998 Vali Acc: 0.744 Test Loss: 0.998 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9072012901306152
Epoch: 29, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8566696643829346
Epoch: 30, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.984 Vali Acc: 0.739 Test Loss: 0.984 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7765438556671143
Epoch: 31, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.022 Vali Acc: 0.739 Test Loss: 1.022 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.676140546798706
Epoch: 32, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.030 Vali Acc: 0.744 Test Loss: 1.030 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7846856117248535
Epoch: 33, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.022 Vali Acc: 0.739 Test Loss: 1.022 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7298402786254883
Epoch: 34, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.065 Vali Acc: 0.767 Test Loss: 1.065 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766656).  Saving model ...
Epoch: 35 cost time: 0.7175517082214355
Epoch: 35, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.072 Vali Acc: 0.733 Test Loss: 1.072 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7249317169189453
Epoch: 36, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.084 Vali Acc: 0.733 Test Loss: 1.084 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7719511985778809
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.084 Vali Acc: 0.744 Test Loss: 1.084 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8366243839263916
Epoch: 38, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.111 Vali Acc: 0.744 Test Loss: 1.111 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8434486389160156
Epoch: 39, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.136 Vali Acc: 0.733 Test Loss: 1.136 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.756638765335083
Epoch: 40, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.100 Vali Acc: 0.744 Test Loss: 1.100 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8411474227905273
Epoch: 41, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.117 Vali Acc: 0.756 Test Loss: 1.117 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8113706111907959
Epoch: 42, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.178 Vali Acc: 0.744 Test Loss: 1.178 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8650999069213867
Epoch: 43, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.174 Vali Acc: 0.756 Test Loss: 1.174 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7933745384216309
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.163 Vali Acc: 0.733 Test Loss: 1.163 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 39343
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3088390827178955
Epoch: 1, Steps: 12 | Train Loss: 2.982 Vali Loss: 2.755 Vali Acc: 0.133 Test Loss: 2.755 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.9206175804138184
Epoch: 2, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.551 Vali Acc: 0.189 Test Loss: 2.551 Test Acc: 0.189
Validation loss decreased (-0.133306 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 0.759239673614502
Epoch: 3, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.311 Vali Acc: 0.256 Test Loss: 2.311 Test Acc: 0.256
Validation loss decreased (-0.188863 --> -0.255532).  Saving model ...
Epoch: 4 cost time: 0.7888002395629883
Epoch: 4, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.084 Vali Acc: 0.400 Test Loss: 2.084 Test Acc: 0.400
Validation loss decreased (-0.255532 --> -0.399979).  Saving model ...
Epoch: 5 cost time: 0.7944517135620117
Epoch: 5, Steps: 12 | Train Loss: 1.988 Vali Loss: 1.903 Vali Acc: 0.467 Test Loss: 1.903 Test Acc: 0.467
Validation loss decreased (-0.399979 --> -0.466648).  Saving model ...
Epoch: 6 cost time: 0.825430154800415
Epoch: 6, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.752 Vali Acc: 0.522 Test Loss: 1.752 Test Acc: 0.522
Validation loss decreased (-0.466648 --> -0.522205).  Saving model ...
Epoch: 7 cost time: 0.7555828094482422
Epoch: 7, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.618 Vali Acc: 0.561 Test Loss: 1.618 Test Acc: 0.561
Validation loss decreased (-0.522205 --> -0.561095).  Saving model ...
Epoch: 8 cost time: 0.8695557117462158
Epoch: 8, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.513 Vali Acc: 0.567 Test Loss: 1.513 Test Acc: 0.567
Validation loss decreased (-0.561095 --> -0.566652).  Saving model ...
Epoch: 9 cost time: 0.9306237697601318
Epoch: 9, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.450 Vali Acc: 0.572 Test Loss: 1.450 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 10 cost time: 0.8623740673065186
Epoch: 10, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.364 Vali Acc: 0.567 Test Loss: 1.364 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7878844738006592
Epoch: 11, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.330 Vali Acc: 0.606 Test Loss: 1.330 Test Acc: 0.606
Validation loss decreased (-0.572208 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 0.8347749710083008
Epoch: 12, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.278 Vali Acc: 0.628 Test Loss: 1.278 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 0.7902281284332275
Epoch: 13, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.227 Vali Acc: 0.622 Test Loss: 1.227 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9030892848968506
Epoch: 14, Steps: 12 | Train Loss: 0.795 Vali Loss: 1.225 Vali Acc: 0.628 Test Loss: 1.225 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627766).  Saving model ...
Epoch: 15 cost time: 0.9044311046600342
Epoch: 15, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.173 Vali Acc: 0.633 Test Loss: 1.173 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633322).  Saving model ...
Epoch: 16 cost time: 0.8841028213500977
Epoch: 16, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.154 Vali Acc: 0.644 Test Loss: 1.154 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644433).  Saving model ...
Epoch: 17 cost time: 0.8392887115478516
Epoch: 17, Steps: 12 | Train Loss: 0.603 Vali Loss: 1.074 Vali Acc: 0.661 Test Loss: 1.074 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661100).  Saving model ...
Epoch: 18 cost time: 0.8734524250030518
Epoch: 18, Steps: 12 | Train Loss: 0.569 Vali Loss: 1.059 Vali Acc: 0.678 Test Loss: 1.059 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 19 cost time: 0.9438486099243164
Epoch: 19, Steps: 12 | Train Loss: 0.506 Vali Loss: 1.030 Vali Acc: 0.683 Test Loss: 1.030 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 20 cost time: 0.8428902626037598
Epoch: 20, Steps: 12 | Train Loss: 0.469 Vali Loss: 1.018 Vali Acc: 0.689 Test Loss: 1.018 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 21 cost time: 0.9536867141723633
Epoch: 21, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.990 Vali Acc: 0.711 Test Loss: 0.990 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711101).  Saving model ...
Epoch: 22 cost time: 0.873563289642334
Epoch: 22, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.970 Vali Acc: 0.706 Test Loss: 0.970 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8638689517974854
Epoch: 23, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.952 Vali Acc: 0.728 Test Loss: 0.952 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 24 cost time: 0.7649047374725342
Epoch: 24, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.977 Vali Acc: 0.739 Test Loss: 0.977 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 25 cost time: 0.8719794750213623
Epoch: 25, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.953 Vali Acc: 0.733 Test Loss: 0.953 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0589513778686523
Epoch: 26, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.937 Vali Acc: 0.744 Test Loss: 0.937 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 27 cost time: 0.8532025814056396
Epoch: 27, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 28 cost time: 0.9260110855102539
Epoch: 28, Steps: 12 | Train Loss: 0.231 Vali Loss: 1.001 Vali Acc: 0.722 Test Loss: 1.001 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8186166286468506
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.977 Vali Acc: 0.728 Test Loss: 0.977 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8483912944793701
Epoch: 30, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.004 Vali Acc: 0.739 Test Loss: 1.004 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8595821857452393
Epoch: 31, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9855265617370605
Epoch: 32, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.016 Vali Acc: 0.744 Test Loss: 1.016 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0005600452423096
Epoch: 33, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.010 Vali Acc: 0.739 Test Loss: 1.010 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8743267059326172
Epoch: 34, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.018 Vali Acc: 0.722 Test Loss: 1.018 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8933513164520264
Epoch: 35, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.059 Vali Acc: 0.728 Test Loss: 1.059 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8784947395324707
Epoch: 36, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.045 Vali Acc: 0.739 Test Loss: 1.045 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8865938186645508
Epoch: 37, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.070 Vali Acc: 0.728 Test Loss: 1.070 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 38415
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.350595235824585
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.631 Vali Acc: 0.078 Test Loss: 2.631 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.9140918254852295
Epoch: 2, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.489 Vali Acc: 0.161 Test Loss: 2.489 Test Acc: 0.161
Validation loss decreased (-0.077751 --> -0.161086).  Saving model ...
Epoch: 3 cost time: 0.8217229843139648
Epoch: 3, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.306 Vali Acc: 0.317 Test Loss: 2.306 Test Acc: 0.317
Validation loss decreased (-0.161086 --> -0.316644).  Saving model ...
Epoch: 4 cost time: 0.8465914726257324
Epoch: 4, Steps: 12 | Train Loss: 2.200 Vali Loss: 2.111 Vali Acc: 0.450 Test Loss: 2.111 Test Acc: 0.450
Validation loss decreased (-0.316644 --> -0.449979).  Saving model ...
Epoch: 5 cost time: 0.8014554977416992
Epoch: 5, Steps: 12 | Train Loss: 2.000 Vali Loss: 1.948 Vali Acc: 0.500 Test Loss: 1.948 Test Acc: 0.500
Validation loss decreased (-0.449979 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 0.9356780052185059
Epoch: 6, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.798 Vali Acc: 0.533 Test Loss: 1.798 Test Acc: 0.533
Validation loss decreased (-0.499981 --> -0.533315).  Saving model ...
Epoch: 7 cost time: 0.9041025638580322
Epoch: 7, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.683 Vali Acc: 0.533 Test Loss: 1.683 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533317).  Saving model ...
Epoch: 8 cost time: 0.8521530628204346
Epoch: 8, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.583 Vali Acc: 0.583 Test Loss: 1.583 Test Acc: 0.583
Validation loss decreased (-0.533317 --> -0.583318).  Saving model ...
Epoch: 9 cost time: 0.8605694770812988
Epoch: 9, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.509 Vali Acc: 0.583 Test Loss: 1.509 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583318).  Saving model ...
Epoch: 10 cost time: 0.8847706317901611
Epoch: 10, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.440 Vali Acc: 0.583 Test Loss: 1.440 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 11 cost time: 0.898798942565918
Epoch: 11, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.398 Vali Acc: 0.589 Test Loss: 1.398 Test Acc: 0.589
Validation loss decreased (-0.583319 --> -0.588875).  Saving model ...
Epoch: 12 cost time: 0.7357001304626465
Epoch: 12, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.351 Vali Acc: 0.594 Test Loss: 1.351 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594431).  Saving model ...
Epoch: 13 cost time: 0.7391781806945801
Epoch: 13, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.301 Vali Acc: 0.611 Test Loss: 1.301 Test Acc: 0.611
Validation loss decreased (-0.594431 --> -0.611098).  Saving model ...
Epoch: 14 cost time: 0.8963813781738281
Epoch: 14, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.271 Vali Acc: 0.611 Test Loss: 1.271 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 15 cost time: 0.8433394432067871
Epoch: 15, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.238 Vali Acc: 0.644 Test Loss: 1.238 Test Acc: 0.644
Validation loss decreased (-0.611098 --> -0.644432).  Saving model ...
Epoch: 16 cost time: 0.7963979244232178
Epoch: 16, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.231 Vali Acc: 0.656 Test Loss: 1.231 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655543).  Saving model ...
Epoch: 17 cost time: 0.8992109298706055
Epoch: 17, Steps: 12 | Train Loss: 0.752 Vali Loss: 1.212 Vali Acc: 0.650 Test Loss: 1.212 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8345589637756348
Epoch: 18, Steps: 12 | Train Loss: 0.689 Vali Loss: 1.166 Vali Acc: 0.672 Test Loss: 1.166 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672211).  Saving model ...
Epoch: 19 cost time: 0.8931879997253418
Epoch: 19, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.138 Vali Acc: 0.644 Test Loss: 1.138 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8740110397338867
Epoch: 20, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.119 Vali Acc: 0.678 Test Loss: 1.119 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 21 cost time: 0.9202735424041748
Epoch: 21, Steps: 12 | Train Loss: 0.550 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7472877502441406
Epoch: 22, Steps: 12 | Train Loss: 0.526 Vali Loss: 1.058 Vali Acc: 0.661 Test Loss: 1.058 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8574204444885254
Epoch: 23, Steps: 12 | Train Loss: 0.476 Vali Loss: 1.039 Vali Acc: 0.672 Test Loss: 1.039 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8227458000183105
Epoch: 24, Steps: 12 | Train Loss: 0.510 Vali Loss: 1.028 Vali Acc: 0.678 Test Loss: 1.028 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 25 cost time: 0.8242909908294678
Epoch: 25, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.993 Vali Acc: 0.722 Test Loss: 0.993 Test Acc: 0.722
Validation loss decreased (-0.677767 --> -0.722212).  Saving model ...
Epoch: 26 cost time: 0.7627637386322021
Epoch: 26, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.989 Vali Acc: 0.711 Test Loss: 0.989 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8909142017364502
Epoch: 27, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.993 Vali Acc: 0.711 Test Loss: 0.993 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7999405860900879
Epoch: 28, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8148927688598633
Epoch: 29, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.964 Vali Acc: 0.728 Test Loss: 0.964 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 30 cost time: 0.8016715049743652
Epoch: 30, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.965 Vali Acc: 0.733 Test Loss: 0.965 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 31 cost time: 0.801682710647583
Epoch: 31, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.956 Vali Acc: 0.728 Test Loss: 0.956 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7777876853942871
Epoch: 32, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.972 Vali Acc: 0.733 Test Loss: 0.972 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8261797428131104
Epoch: 33, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.990 Vali Acc: 0.717 Test Loss: 0.990 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.793724775314331
Epoch: 34, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.963 Vali Acc: 0.739 Test Loss: 0.963 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 35 cost time: 0.8343567848205566
Epoch: 35, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.978 Vali Acc: 0.744 Test Loss: 0.978 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 36 cost time: 0.8721959590911865
Epoch: 36, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.988 Vali Acc: 0.739 Test Loss: 0.988 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.903501033782959
Epoch: 37, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8892695903778076
Epoch: 38, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.979 Vali Acc: 0.733 Test Loss: 0.979 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8429102897644043
Epoch: 39, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.022 Vali Acc: 0.728 Test Loss: 1.022 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8737697601318359
Epoch: 40, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.014 Vali Acc: 0.733 Test Loss: 1.014 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8017971515655518
Epoch: 41, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.009 Vali Acc: 0.744 Test Loss: 1.009 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8385481834411621
Epoch: 42, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.013 Vali Acc: 0.744 Test Loss: 1.013 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7835924625396729
Epoch: 43, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8878474235534668
Epoch: 44, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.020 Vali Acc: 0.744 Test Loss: 1.020 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8296582698822021
Epoch: 45, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.016 Vali Acc: 0.739 Test Loss: 1.016 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 31727
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.426447868347168
Epoch: 1, Steps: 12 | Train Loss: 2.866 Vali Loss: 2.764 Vali Acc: 0.133 Test Loss: 2.764 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.853672981262207
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.639 Vali Acc: 0.161 Test Loss: 2.639 Test Acc: 0.161
Validation loss decreased (-0.133306 --> -0.161085).  Saving model ...
Epoch: 3 cost time: 0.8901073932647705
Epoch: 3, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.495 Vali Acc: 0.239 Test Loss: 2.495 Test Acc: 0.239
Validation loss decreased (-0.161085 --> -0.238864).  Saving model ...
Epoch: 4 cost time: 0.827176570892334
Epoch: 4, Steps: 12 | Train Loss: 2.483 Vali Loss: 2.334 Vali Acc: 0.333 Test Loss: 2.334 Test Acc: 0.333
Validation loss decreased (-0.238864 --> -0.333310).  Saving model ...
Epoch: 5 cost time: 0.8924713134765625
Epoch: 5, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.181 Vali Acc: 0.417 Test Loss: 2.181 Test Acc: 0.417
Validation loss decreased (-0.333310 --> -0.416645).  Saving model ...
Epoch: 6 cost time: 0.8511416912078857
Epoch: 6, Steps: 12 | Train Loss: 2.099 Vali Loss: 2.037 Vali Acc: 0.467 Test Loss: 2.037 Test Acc: 0.467
Validation loss decreased (-0.416645 --> -0.466646).  Saving model ...
Epoch: 7 cost time: 0.8243129253387451
Epoch: 7, Steps: 12 | Train Loss: 1.965 Vali Loss: 1.905 Vali Acc: 0.483 Test Loss: 1.905 Test Acc: 0.483
Validation loss decreased (-0.466646 --> -0.483314).  Saving model ...
Epoch: 8 cost time: 0.8471851348876953
Epoch: 8, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.790 Vali Acc: 0.506 Test Loss: 1.790 Test Acc: 0.506
Validation loss decreased (-0.483314 --> -0.505538).  Saving model ...
Epoch: 9 cost time: 0.8841750621795654
Epoch: 9, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.694 Vali Acc: 0.522 Test Loss: 1.694 Test Acc: 0.522
Validation loss decreased (-0.505538 --> -0.522205).  Saving model ...
Epoch: 10 cost time: 0.8178176879882812
Epoch: 10, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.612 Vali Acc: 0.544 Test Loss: 1.612 Test Acc: 0.544
Validation loss decreased (-0.522205 --> -0.544428).  Saving model ...
Epoch: 11 cost time: 0.8889474868774414
Epoch: 11, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.542 Vali Acc: 0.539 Test Loss: 1.542 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8061323165893555
Epoch: 12, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.486 Vali Acc: 0.539 Test Loss: 1.486 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8391475677490234
Epoch: 13, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.438 Vali Acc: 0.550 Test Loss: 1.438 Test Acc: 0.550
Validation loss decreased (-0.544428 --> -0.549986).  Saving model ...
Epoch: 14 cost time: 0.8215377330780029
Epoch: 14, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.388 Vali Acc: 0.561 Test Loss: 1.388 Test Acc: 0.561
Validation loss decreased (-0.549986 --> -0.561097).  Saving model ...
Epoch: 15 cost time: 0.7596912384033203
Epoch: 15, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.340 Vali Acc: 0.572 Test Loss: 1.340 Test Acc: 0.572
Validation loss decreased (-0.561097 --> -0.572209).  Saving model ...
Epoch: 16 cost time: 0.8856756687164307
Epoch: 16, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.315 Vali Acc: 0.589 Test Loss: 1.315 Test Acc: 0.589
Validation loss decreased (-0.572209 --> -0.588876).  Saving model ...
Epoch: 17 cost time: 0.8106527328491211
Epoch: 17, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.278 Vali Acc: 0.589 Test Loss: 1.278 Test Acc: 0.589
Validation loss decreased (-0.588876 --> -0.588876).  Saving model ...
Epoch: 18 cost time: 0.8159112930297852
Epoch: 18, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.234 Vali Acc: 0.600 Test Loss: 1.234 Test Acc: 0.600
Validation loss decreased (-0.588876 --> -0.599988).  Saving model ...
Epoch: 19 cost time: 0.7911624908447266
Epoch: 19, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.192 Vali Acc: 0.639 Test Loss: 1.192 Test Acc: 0.639
Validation loss decreased (-0.599988 --> -0.638877).  Saving model ...
Epoch: 20 cost time: 0.8471348285675049
Epoch: 20, Steps: 12 | Train Loss: 0.775 Vali Loss: 1.159 Vali Acc: 0.644 Test Loss: 1.159 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 21 cost time: 0.8811142444610596
Epoch: 21, Steps: 12 | Train Loss: 0.779 Vali Loss: 1.143 Vali Acc: 0.656 Test Loss: 1.143 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655544).  Saving model ...
Epoch: 22 cost time: 0.870445966720581
Epoch: 22, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.097 Vali Acc: 0.639 Test Loss: 1.097 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8912563323974609
Epoch: 23, Steps: 12 | Train Loss: 0.646 Vali Loss: 1.080 Vali Acc: 0.661 Test Loss: 1.080 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 24 cost time: 0.8887441158294678
Epoch: 24, Steps: 12 | Train Loss: 0.660 Vali Loss: 1.048 Vali Acc: 0.667 Test Loss: 1.048 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 25 cost time: 0.9159286022186279
Epoch: 25, Steps: 12 | Train Loss: 0.569 Vali Loss: 1.022 Vali Acc: 0.667 Test Loss: 1.022 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 26 cost time: 0.841956377029419
Epoch: 26, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.977 Vali Acc: 0.678 Test Loss: 0.977 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 27 cost time: 0.8267848491668701
Epoch: 27, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.983 Vali Acc: 0.689 Test Loss: 0.983 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 28 cost time: 0.8484735488891602
Epoch: 28, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.8592910766601562
Epoch: 29, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.928 Vali Acc: 0.678 Test Loss: 0.928 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.811589241027832
Epoch: 30, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.910 Vali Acc: 0.722 Test Loss: 0.910 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 31 cost time: 0.8510255813598633
Epoch: 31, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.902 Vali Acc: 0.733 Test Loss: 0.902 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 32 cost time: 0.8439450263977051
Epoch: 32, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 33 cost time: 0.9313478469848633
Epoch: 33, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749991).  Saving model ...
Epoch: 34 cost time: 0.8857486248016357
Epoch: 34, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.868 Vali Acc: 0.767 Test Loss: 0.868 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766658).  Saving model ...
Epoch: 35 cost time: 0.8245956897735596
Epoch: 35, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9186389446258545
Epoch: 36, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.865 Vali Acc: 0.739 Test Loss: 0.865 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8006575107574463
Epoch: 37, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.861 Vali Acc: 0.744 Test Loss: 0.861 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8521649837493896
Epoch: 38, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8298299312591553
Epoch: 39, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.846 Vali Acc: 0.744 Test Loss: 0.846 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8851356506347656
Epoch: 40, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.874 Vali Acc: 0.728 Test Loss: 0.874 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8839244842529297
Epoch: 41, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.859 Vali Acc: 0.728 Test Loss: 0.859 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8948707580566406
Epoch: 42, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.859 Vali Acc: 0.756 Test Loss: 0.859 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8043971061706543
Epoch: 43, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.862 Vali Acc: 0.744 Test Loss: 0.862 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8069212436676025
Epoch: 44, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.872 Vali Acc: 0.733 Test Loss: 0.872 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 27951
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2924015522003174
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.833 Vali Acc: 0.128 Test Loss: 2.833 Test Acc: 0.128
Validation loss decreased (inf --> -0.127749).  Saving model ...
Epoch: 2 cost time: 0.7714362144470215
Epoch: 2, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.721 Vali Acc: 0.172 Test Loss: 2.721 Test Acc: 0.172
Validation loss decreased (-0.127749 --> -0.172195).  Saving model ...
Epoch: 3 cost time: 0.7765235900878906
Epoch: 3, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.572 Vali Acc: 0.206 Test Loss: 2.572 Test Acc: 0.206
Validation loss decreased (-0.172195 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 0.814967155456543
Epoch: 4, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.416 Vali Acc: 0.228 Test Loss: 2.416 Test Acc: 0.228
Validation loss decreased (-0.205530 --> -0.227754).  Saving model ...
Epoch: 5 cost time: 0.8859817981719971
Epoch: 5, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.255 Vali Acc: 0.278 Test Loss: 2.255 Test Acc: 0.278
Validation loss decreased (-0.227754 --> -0.277755).  Saving model ...
Epoch: 6 cost time: 0.8352193832397461
Epoch: 6, Steps: 12 | Train Loss: 2.174 Vali Loss: 2.108 Vali Acc: 0.394 Test Loss: 2.108 Test Acc: 0.394
Validation loss decreased (-0.277755 --> -0.394423).  Saving model ...
Epoch: 7 cost time: 0.8153207302093506
Epoch: 7, Steps: 12 | Train Loss: 2.012 Vali Loss: 1.975 Vali Acc: 0.461 Test Loss: 1.975 Test Acc: 0.461
Validation loss decreased (-0.394423 --> -0.461091).  Saving model ...
Epoch: 8 cost time: 0.7955400943756104
Epoch: 8, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.854 Vali Acc: 0.489 Test Loss: 1.854 Test Acc: 0.489
Validation loss decreased (-0.461091 --> -0.488870).  Saving model ...
Epoch: 9 cost time: 0.7668015956878662
Epoch: 9, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.743 Vali Acc: 0.522 Test Loss: 1.743 Test Acc: 0.522
Validation loss decreased (-0.488870 --> -0.522205).  Saving model ...
Epoch: 10 cost time: 0.7980906963348389
Epoch: 10, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.656 Vali Acc: 0.550 Test Loss: 1.656 Test Acc: 0.550
Validation loss decreased (-0.522205 --> -0.549983).  Saving model ...
Epoch: 11 cost time: 0.7399673461914062
Epoch: 11, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.582 Vali Acc: 0.567 Test Loss: 1.582 Test Acc: 0.567
Validation loss decreased (-0.549983 --> -0.566651).  Saving model ...
Epoch: 12 cost time: 0.7825994491577148
Epoch: 12, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.525 Vali Acc: 0.578 Test Loss: 1.525 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577763).  Saving model ...
Epoch: 13 cost time: 0.8739500045776367
Epoch: 13, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.462 Vali Acc: 0.583 Test Loss: 1.462 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 14 cost time: 0.8206567764282227
Epoch: 14, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.404 Vali Acc: 0.611 Test Loss: 1.404 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 0.7569291591644287
Epoch: 15, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.353 Vali Acc: 0.622 Test Loss: 1.353 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 16 cost time: 0.8091452121734619
Epoch: 16, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.307 Vali Acc: 0.617 Test Loss: 1.307 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7765054702758789
Epoch: 17, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.267 Vali Acc: 0.633 Test Loss: 1.267 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 18 cost time: 0.7802248001098633
Epoch: 18, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.233 Vali Acc: 0.633 Test Loss: 1.233 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 19 cost time: 0.7409515380859375
Epoch: 19, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.182 Vali Acc: 0.650 Test Loss: 1.182 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649988).  Saving model ...
Epoch: 20 cost time: 0.8010282516479492
Epoch: 20, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.146 Vali Acc: 0.672 Test Loss: 1.146 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.672211).  Saving model ...
Epoch: 21 cost time: 0.8012392520904541
Epoch: 21, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.117 Vali Acc: 0.656 Test Loss: 1.117 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8633155822753906
Epoch: 22, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.082 Vali Acc: 0.678 Test Loss: 1.082 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 23 cost time: 0.8759641647338867
Epoch: 23, Steps: 12 | Train Loss: 0.608 Vali Loss: 1.038 Vali Acc: 0.683 Test Loss: 1.038 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 24 cost time: 0.7963728904724121
Epoch: 24, Steps: 12 | Train Loss: 0.608 Vali Loss: 1.011 Vali Acc: 0.678 Test Loss: 1.011 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8000180721282959
Epoch: 25, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.976 Vali Acc: 0.694 Test Loss: 0.976 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 26 cost time: 0.6350266933441162
Epoch: 26, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.941 Vali Acc: 0.706 Test Loss: 0.941 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705546).  Saving model ...
Epoch: 27 cost time: 0.8149054050445557
Epoch: 27, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.917 Vali Acc: 0.717 Test Loss: 0.917 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716658).  Saving model ...
Epoch: 28 cost time: 0.7621939182281494
Epoch: 28, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.902 Vali Acc: 0.717 Test Loss: 0.902 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 29 cost time: 0.7114887237548828
Epoch: 29, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.897 Vali Acc: 0.722 Test Loss: 0.897 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722213).  Saving model ...
Epoch: 30 cost time: 0.7667117118835449
Epoch: 30, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.874 Vali Acc: 0.728 Test Loss: 0.874 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 31 cost time: 0.7453374862670898
Epoch: 31, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.864 Vali Acc: 0.711 Test Loss: 0.864 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7569663524627686
Epoch: 32, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.853 Vali Acc: 0.722 Test Loss: 0.853 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7825822830200195
Epoch: 33, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.837 Vali Acc: 0.722 Test Loss: 0.837 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7454068660736084
Epoch: 34, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.838 Vali Acc: 0.728 Test Loss: 0.838 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 35 cost time: 0.7880058288574219
Epoch: 35, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.824 Vali Acc: 0.739 Test Loss: 0.824 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738881).  Saving model ...
Epoch: 36 cost time: 0.7574508190155029
Epoch: 36, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.834 Vali Acc: 0.739 Test Loss: 0.834 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7901275157928467
Epoch: 37, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 38 cost time: 0.7895047664642334
Epoch: 38, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 39 cost time: 0.8843903541564941
Epoch: 39, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.818 Vali Acc: 0.733 Test Loss: 0.818 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7690107822418213
Epoch: 40, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7647762298583984
Epoch: 41, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.803 Vali Acc: 0.733 Test Loss: 0.803 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8027946949005127
Epoch: 42, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.800 Vali Acc: 0.733 Test Loss: 0.800 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6810789108276367
Epoch: 43, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.802 Vali Acc: 0.739 Test Loss: 0.802 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7369067668914795
Epoch: 44, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.813 Vali Acc: 0.722 Test Loss: 0.813 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6968326568603516
Epoch: 45, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.826 Vali Acc: 0.717 Test Loss: 0.826 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7608168125152588
Epoch: 46, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.839 Vali Acc: 0.739 Test Loss: 0.839 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7459743022918701
Epoch: 47, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.839 Vali Acc: 0.739 Test Loss: 0.839 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8168585300445557
Epoch: 48, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.832 Vali Acc: 0.728 Test Loss: 0.832 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 26095
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2245802879333496
Epoch: 1, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.691 Vali Acc: 0.072 Test Loss: 2.691 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.7532751560211182
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.617 Vali Acc: 0.067 Test Loss: 2.617 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7821378707885742
Epoch: 3, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.512 Vali Acc: 0.111 Test Loss: 2.512 Test Acc: 0.111
Validation loss decreased (-0.072195 --> -0.111086).  Saving model ...
Epoch: 4 cost time: 0.6995015144348145
Epoch: 4, Steps: 12 | Train Loss: 2.557 Vali Loss: 2.392 Vali Acc: 0.244 Test Loss: 2.392 Test Acc: 0.244
Validation loss decreased (-0.111086 --> -0.244421).  Saving model ...
Epoch: 5 cost time: 0.7350180149078369
Epoch: 5, Steps: 12 | Train Loss: 2.392 Vali Loss: 2.265 Vali Acc: 0.328 Test Loss: 2.265 Test Acc: 0.328
Validation loss decreased (-0.244421 --> -0.327755).  Saving model ...
Epoch: 6 cost time: 0.7403964996337891
Epoch: 6, Steps: 12 | Train Loss: 2.277 Vali Loss: 2.144 Vali Acc: 0.361 Test Loss: 2.144 Test Acc: 0.361
Validation loss decreased (-0.327755 --> -0.361090).  Saving model ...
Epoch: 7 cost time: 0.6746273040771484
Epoch: 7, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.027 Vali Acc: 0.400 Test Loss: 2.027 Test Acc: 0.400
Validation loss decreased (-0.361090 --> -0.399980).  Saving model ...
Epoch: 8 cost time: 0.736283540725708
Epoch: 8, Steps: 12 | Train Loss: 1.941 Vali Loss: 1.910 Vali Acc: 0.444 Test Loss: 1.910 Test Acc: 0.444
Validation loss decreased (-0.399980 --> -0.444425).  Saving model ...
Epoch: 9 cost time: 0.7108738422393799
Epoch: 9, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.807 Vali Acc: 0.472 Test Loss: 1.807 Test Acc: 0.472
Validation loss decreased (-0.444425 --> -0.472204).  Saving model ...
Epoch: 10 cost time: 0.7342805862426758
Epoch: 10, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.715 Vali Acc: 0.506 Test Loss: 1.715 Test Acc: 0.506
Validation loss decreased (-0.472204 --> -0.505538).  Saving model ...
Epoch: 11 cost time: 0.7282567024230957
Epoch: 11, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.636 Vali Acc: 0.550 Test Loss: 1.636 Test Acc: 0.550
Validation loss decreased (-0.505538 --> -0.549984).  Saving model ...
Epoch: 12 cost time: 0.6753087043762207
Epoch: 12, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.569 Vali Acc: 0.589 Test Loss: 1.569 Test Acc: 0.589
Validation loss decreased (-0.549984 --> -0.588873).  Saving model ...
Epoch: 13 cost time: 0.7502458095550537
Epoch: 13, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.503 Vali Acc: 0.594 Test Loss: 1.503 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594429).  Saving model ...
Epoch: 14 cost time: 0.6687920093536377
Epoch: 14, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.445 Vali Acc: 0.622 Test Loss: 1.445 Test Acc: 0.622
Validation loss decreased (-0.594429 --> -0.622208).  Saving model ...
Epoch: 15 cost time: 0.7819240093231201
Epoch: 15, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.406 Vali Acc: 0.617 Test Loss: 1.406 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7992939949035645
Epoch: 16, Steps: 12 | Train Loss: 1.136 Vali Loss: 1.347 Vali Acc: 0.611 Test Loss: 1.347 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7152173519134521
Epoch: 17, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.289 Vali Acc: 0.622 Test Loss: 1.289 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 18 cost time: 0.7488274574279785
Epoch: 18, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.236 Vali Acc: 0.639 Test Loss: 1.236 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638877).  Saving model ...
Epoch: 19 cost time: 0.7914912700653076
Epoch: 19, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.199 Vali Acc: 0.617 Test Loss: 1.199 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7357113361358643
Epoch: 20, Steps: 12 | Train Loss: 0.816 Vali Loss: 1.143 Vali Acc: 0.628 Test Loss: 1.143 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7412455081939697
Epoch: 21, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.102 Vali Acc: 0.644 Test Loss: 1.102 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 22 cost time: 0.7681503295898438
Epoch: 22, Steps: 12 | Train Loss: 0.744 Vali Loss: 1.065 Vali Acc: 0.639 Test Loss: 1.065 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7637491226196289
Epoch: 23, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.030 Vali Acc: 0.656 Test Loss: 1.030 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655545).  Saving model ...
Epoch: 24 cost time: 0.7950625419616699
Epoch: 24, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7301571369171143
Epoch: 25, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.975 Vali Acc: 0.667 Test Loss: 0.975 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 26 cost time: 0.7955291271209717
Epoch: 26, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.963 Vali Acc: 0.683 Test Loss: 0.963 Test Acc: 0.683
Validation loss decreased (-0.666657 --> -0.683324).  Saving model ...
Epoch: 27 cost time: 0.7448608875274658
Epoch: 27, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.937 Vali Acc: 0.700 Test Loss: 0.937 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699991).  Saving model ...
Epoch: 28 cost time: 0.7852985858917236
Epoch: 28, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.914 Vali Acc: 0.689 Test Loss: 0.914 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7947180271148682
Epoch: 29, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.884 Vali Acc: 0.728 Test Loss: 0.884 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 30 cost time: 0.7079038619995117
Epoch: 30, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.879 Vali Acc: 0.711 Test Loss: 0.879 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7939350605010986
Epoch: 31, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.867 Vali Acc: 0.711 Test Loss: 0.867 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8110628128051758
Epoch: 32, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.856 Vali Acc: 0.694 Test Loss: 0.856 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7631704807281494
Epoch: 33, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.863 Vali Acc: 0.711 Test Loss: 0.863 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8370363712310791
Epoch: 34, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.850 Vali Acc: 0.728 Test Loss: 0.850 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 35 cost time: 0.7808387279510498
Epoch: 35, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.835 Vali Acc: 0.733 Test Loss: 0.835 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 36 cost time: 0.7866086959838867
Epoch: 36, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.823 Vali Acc: 0.728 Test Loss: 0.823 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7841689586639404
Epoch: 37, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.813 Vali Acc: 0.706 Test Loss: 0.813 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7997658252716064
Epoch: 38, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 0.9077107906341553
Epoch: 39, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.834 Vali Acc: 0.756 Test Loss: 0.834 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 40 cost time: 0.8059530258178711
Epoch: 40, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.793 Vali Acc: 0.744 Test Loss: 0.793 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8482081890106201
Epoch: 41, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.824333667755127
Epoch: 42, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.810 Vali Acc: 0.756 Test Loss: 0.810 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 43 cost time: 0.930464506149292
Epoch: 43, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.726219892501831
Epoch: 44, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 45 cost time: 0.9141669273376465
Epoch: 45, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8214685916900635
Epoch: 46, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7613489627838135
Epoch: 47, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.786 Vali Acc: 0.761 Test Loss: 0.786 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 48 cost time: 0.7858355045318604
Epoch: 48, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8701009750366211
Epoch: 49, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.795 Vali Acc: 0.767 Test Loss: 0.795 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 50 cost time: 0.8671021461486816
Epoch: 50, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8234314918518066
Epoch: 51, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.807 Vali Acc: 0.756 Test Loss: 0.807 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.753307580947876
Epoch: 52, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.821 Vali Acc: 0.778 Test Loss: 0.821 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 53 cost time: 0.834367036819458
Epoch: 53, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.794 Vali Acc: 0.772 Test Loss: 0.794 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8331253528594971
Epoch: 54, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.788 Vali Acc: 0.778 Test Loss: 0.788 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 55 cost time: 0.779555082321167
Epoch: 55, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.790 Vali Acc: 0.772 Test Loss: 0.790 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.805293083190918
Epoch: 56, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.801 Vali Acc: 0.761 Test Loss: 0.801 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8672118186950684
Epoch: 57, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.810 Vali Acc: 0.756 Test Loss: 0.810 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8570570945739746
Epoch: 58, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.801 Vali Acc: 0.772 Test Loss: 0.801 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8341100215911865
Epoch: 59, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.810 Vali Acc: 0.778 Test Loss: 0.810 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8129663467407227
Epoch: 60, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8869247436523438
Epoch: 61, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8697261810302734
Epoch: 62, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.797 Vali Acc: 0.767 Test Loss: 0.797 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8187263011932373
Epoch: 63, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.805 Vali Acc: 0.778 Test Loss: 0.805 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.9260954856872559
Epoch: 64, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.828 Vali Acc: 0.783 Test Loss: 0.828 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 65 cost time: 0.7665009498596191
Epoch: 65, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.833 Vali Acc: 0.767 Test Loss: 0.833 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8342986106872559
Epoch: 66, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.846 Vali Acc: 0.767 Test Loss: 0.846 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8242886066436768
Epoch: 67, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.859 Vali Acc: 0.772 Test Loss: 0.859 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7516345977783203
Epoch: 68, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.861 Vali Acc: 0.756 Test Loss: 0.861 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.8419437408447266
Epoch: 69, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.870 Vali Acc: 0.767 Test Loss: 0.870 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.8301846981048584
Epoch: 70, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.874 Vali Acc: 0.772 Test Loss: 0.874 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.8483545780181885
Epoch: 71, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.865 Vali Acc: 0.772 Test Loss: 0.865 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.8483443260192871
Epoch: 72, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.861 Vali Acc: 0.767 Test Loss: 0.861 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.8391153812408447
Epoch: 73, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.944810152053833
Epoch: 74, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.856 Vali Acc: 0.772 Test Loss: 0.856 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm32_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 24271
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.286667823791504
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.662 Vali Acc: 0.194 Test Loss: 2.662 Test Acc: 0.194
Validation loss decreased (inf --> -0.194418).  Saving model ...
Epoch: 2 cost time: 0.8276822566986084
Epoch: 2, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.488 Vali Acc: 0.311 Test Loss: 2.488 Test Acc: 0.311
Validation loss decreased (-0.194418 --> -0.311086).  Saving model ...
Epoch: 3 cost time: 0.8003928661346436
Epoch: 3, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.273 Vali Acc: 0.361 Test Loss: 2.273 Test Acc: 0.361
Validation loss decreased (-0.311086 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 0.9035186767578125
Epoch: 4, Steps: 12 | Train Loss: 2.131 Vali Loss: 2.075 Vali Acc: 0.389 Test Loss: 2.075 Test Acc: 0.389
Validation loss decreased (-0.361088 --> -0.388868).  Saving model ...
Epoch: 5 cost time: 0.9113788604736328
Epoch: 5, Steps: 12 | Train Loss: 1.909 Vali Loss: 1.886 Vali Acc: 0.478 Test Loss: 1.886 Test Acc: 0.478
Validation loss decreased (-0.388868 --> -0.477759).  Saving model ...
Epoch: 6 cost time: 0.8899862766265869
Epoch: 6, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.728 Vali Acc: 0.528 Test Loss: 1.728 Test Acc: 0.528
Validation loss decreased (-0.477759 --> -0.527760).  Saving model ...
Epoch: 7 cost time: 0.8932778835296631
Epoch: 7, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.600 Vali Acc: 0.528 Test Loss: 1.600 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527762).  Saving model ...
Epoch: 8 cost time: 0.8327875137329102
Epoch: 8, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.495 Vali Acc: 0.556 Test Loss: 1.495 Test Acc: 0.556
Validation loss decreased (-0.527762 --> -0.555541).  Saving model ...
Epoch: 9 cost time: 0.8740129470825195
Epoch: 9, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.417 Vali Acc: 0.567 Test Loss: 1.417 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 0.9469912052154541
Epoch: 10, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
Validation loss decreased (-0.566652 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 0.8672065734863281
Epoch: 11, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.280 Vali Acc: 0.622 Test Loss: 1.280 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 12 cost time: 0.8917253017425537
Epoch: 12, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.242 Vali Acc: 0.633 Test Loss: 1.242 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 0.9306368827819824
Epoch: 13, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.185 Vali Acc: 0.656 Test Loss: 1.185 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 0.8412160873413086
Epoch: 14, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.150 Vali Acc: 0.661 Test Loss: 1.150 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 15 cost time: 0.8267476558685303
Epoch: 15, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.112 Vali Acc: 0.644 Test Loss: 1.112 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8829481601715088
Epoch: 16, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.097 Vali Acc: 0.683 Test Loss: 1.097 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683322).  Saving model ...
Epoch: 17 cost time: 0.7906732559204102
Epoch: 17, Steps: 12 | Train Loss: 0.553 Vali Loss: 1.073 Vali Acc: 0.694 Test Loss: 1.073 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 18 cost time: 0.8496778011322021
Epoch: 18, Steps: 12 | Train Loss: 0.513 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.8290472030639648
Epoch: 19, Steps: 12 | Train Loss: 0.480 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.8219068050384521
Epoch: 20, Steps: 12 | Train Loss: 0.452 Vali Loss: 1.000 Vali Acc: 0.739 Test Loss: 1.000 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738879).  Saving model ...
Epoch: 21 cost time: 0.820347785949707
Epoch: 21, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.995 Vali Acc: 0.744 Test Loss: 0.995 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744434).  Saving model ...
Epoch: 22 cost time: 0.8136835098266602
Epoch: 22, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.984 Vali Acc: 0.733 Test Loss: 0.984 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8583681583404541
Epoch: 23, Steps: 12 | Train Loss: 0.302 Vali Loss: 1.001 Vali Acc: 0.750 Test Loss: 1.001 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749990).  Saving model ...
Epoch: 24 cost time: 0.8080790042877197
Epoch: 24, Steps: 12 | Train Loss: 0.289 Vali Loss: 1.003 Vali Acc: 0.733 Test Loss: 1.003 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8396205902099609
Epoch: 25, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.005 Vali Acc: 0.767 Test Loss: 1.005 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766657).  Saving model ...
Epoch: 26 cost time: 0.9582412242889404
Epoch: 26, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.987 Vali Acc: 0.744 Test Loss: 0.987 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0224568843841553
Epoch: 27, Steps: 12 | Train Loss: 0.255 Vali Loss: 1.000 Vali Acc: 0.728 Test Loss: 1.000 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9341871738433838
Epoch: 28, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.011 Vali Acc: 0.739 Test Loss: 1.011 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9664576053619385
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.032 Vali Acc: 0.739 Test Loss: 1.032 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9142858982086182
Epoch: 30, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.019 Vali Acc: 0.761 Test Loss: 1.019 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8857231140136719
Epoch: 31, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.056 Vali Acc: 0.739 Test Loss: 1.056 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.842414379119873
Epoch: 32, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.033 Vali Acc: 0.750 Test Loss: 1.033 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.885934591293335
Epoch: 33, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.057 Vali Acc: 0.739 Test Loss: 1.057 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8839421272277832
Epoch: 34, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.094 Vali Acc: 0.744 Test Loss: 1.094 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.855525016784668
Epoch: 35, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.091 Vali Acc: 0.761 Test Loss: 1.091 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 40911
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.39339542388916
Epoch: 1, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.558 Vali Acc: 0.206 Test Loss: 2.558 Test Acc: 0.206
Validation loss decreased (inf --> -0.205530).  Saving model ...
Epoch: 2 cost time: 0.8346619606018066
Epoch: 2, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.457 Vali Acc: 0.222 Test Loss: 2.457 Test Acc: 0.222
Validation loss decreased (-0.205530 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 0.8645329475402832
Epoch: 3, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.320 Vali Acc: 0.283 Test Loss: 2.320 Test Acc: 0.283
Validation loss decreased (-0.222198 --> -0.283310).  Saving model ...
Epoch: 4 cost time: 0.9328634738922119
Epoch: 4, Steps: 12 | Train Loss: 2.275 Vali Loss: 2.172 Vali Acc: 0.350 Test Loss: 2.172 Test Acc: 0.350
Validation loss decreased (-0.283310 --> -0.349978).  Saving model ...
Epoch: 5 cost time: 0.9170198440551758
Epoch: 5, Steps: 12 | Train Loss: 2.068 Vali Loss: 2.031 Vali Acc: 0.428 Test Loss: 2.031 Test Acc: 0.428
Validation loss decreased (-0.349978 --> -0.427757).  Saving model ...
Epoch: 6 cost time: 0.7848300933837891
Epoch: 6, Steps: 12 | Train Loss: 1.949 Vali Loss: 1.905 Vali Acc: 0.444 Test Loss: 1.905 Test Acc: 0.444
Validation loss decreased (-0.427757 --> -0.444425).  Saving model ...
Epoch: 7 cost time: 0.8662283420562744
Epoch: 7, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.794 Vali Acc: 0.483 Test Loss: 1.794 Test Acc: 0.483
Validation loss decreased (-0.444425 --> -0.483315).  Saving model ...
Epoch: 8 cost time: 0.8715310096740723
Epoch: 8, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.687 Vali Acc: 0.500 Test Loss: 1.687 Test Acc: 0.500
Validation loss decreased (-0.483315 --> -0.499983).  Saving model ...
Epoch: 9 cost time: 0.8934612274169922
Epoch: 9, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.596 Vali Acc: 0.550 Test Loss: 1.596 Test Acc: 0.550
Validation loss decreased (-0.499983 --> -0.549984).  Saving model ...
Epoch: 10 cost time: 0.9057230949401855
Epoch: 10, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.520 Vali Acc: 0.556 Test Loss: 1.520 Test Acc: 0.556
Validation loss decreased (-0.549984 --> -0.555540).  Saving model ...
Epoch: 11 cost time: 0.8540406227111816
Epoch: 11, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.460 Vali Acc: 0.567 Test Loss: 1.460 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566652).  Saving model ...
Epoch: 12 cost time: 0.8556849956512451
Epoch: 12, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.390 Vali Acc: 0.606 Test Loss: 1.390 Test Acc: 0.606
Validation loss decreased (-0.566652 --> -0.605542).  Saving model ...
Epoch: 13 cost time: 0.7975971698760986
Epoch: 13, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.351 Vali Acc: 0.606 Test Loss: 1.351 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605542).  Saving model ...
Epoch: 14 cost time: 0.8654916286468506
Epoch: 14, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.308 Vali Acc: 0.611 Test Loss: 1.308 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 15 cost time: 0.8608410358428955
Epoch: 15, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.270 Vali Acc: 0.617 Test Loss: 1.270 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616654).  Saving model ...
Epoch: 16 cost time: 0.8016998767852783
Epoch: 16, Steps: 12 | Train Loss: 0.894 Vali Loss: 1.234 Vali Acc: 0.644 Test Loss: 1.234 Test Acc: 0.644
Validation loss decreased (-0.616654 --> -0.644432).  Saving model ...
Epoch: 17 cost time: 0.9675157070159912
Epoch: 17, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.200 Vali Acc: 0.656 Test Loss: 1.200 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 18 cost time: 0.8464462757110596
Epoch: 18, Steps: 12 | Train Loss: 0.762 Vali Loss: 1.172 Vali Acc: 0.661 Test Loss: 1.172 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661099).  Saving model ...
Epoch: 19 cost time: 0.7521495819091797
Epoch: 19, Steps: 12 | Train Loss: 0.728 Vali Loss: 1.136 Vali Acc: 0.667 Test Loss: 1.136 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 20 cost time: 0.8116271495819092
Epoch: 20, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.121 Vali Acc: 0.650 Test Loss: 1.121 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8104846477508545
Epoch: 21, Steps: 12 | Train Loss: 0.588 Vali Loss: 1.096 Vali Acc: 0.672 Test Loss: 1.096 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 22 cost time: 0.7790689468383789
Epoch: 22, Steps: 12 | Train Loss: 0.563 Vali Loss: 1.067 Vali Acc: 0.683 Test Loss: 1.067 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 23 cost time: 0.8769006729125977
Epoch: 23, Steps: 12 | Train Loss: 0.525 Vali Loss: 1.037 Vali Acc: 0.678 Test Loss: 1.037 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8038392066955566
Epoch: 24, Steps: 12 | Train Loss: 0.490 Vali Loss: 1.018 Vali Acc: 0.694 Test Loss: 1.018 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694434).  Saving model ...
Epoch: 25 cost time: 0.8236417770385742
Epoch: 25, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.994 Vali Acc: 0.722 Test Loss: 0.994 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 26 cost time: 0.8822424411773682
Epoch: 26, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.989 Vali Acc: 0.706 Test Loss: 0.989 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8923459053039551
Epoch: 27, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.974 Vali Acc: 0.706 Test Loss: 0.974 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8677067756652832
Epoch: 28, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.960 Vali Acc: 0.711 Test Loss: 0.960 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7978267669677734
Epoch: 29, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 30 cost time: 0.8402585983276367
Epoch: 30, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.982 Vali Acc: 0.733 Test Loss: 0.982 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 31 cost time: 0.9401895999908447
Epoch: 31, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.970 Vali Acc: 0.728 Test Loss: 0.970 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8739073276519775
Epoch: 32, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9000804424285889
Epoch: 33, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8866512775421143
Epoch: 34, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.965 Vali Acc: 0.717 Test Loss: 0.965 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9569447040557861
Epoch: 35, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8868396282196045
Epoch: 36, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8831567764282227
Epoch: 37, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.965 Vali Acc: 0.739 Test Loss: 0.965 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 38 cost time: 0.7886731624603271
Epoch: 38, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.812340259552002
Epoch: 39, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7760317325592041
Epoch: 40, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.002 Vali Acc: 0.739 Test Loss: 1.002 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8673441410064697
Epoch: 41, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.996 Vali Acc: 0.739 Test Loss: 0.996 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7853665351867676
Epoch: 42, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7903521060943604
Epoch: 43, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.001 Vali Acc: 0.744 Test Loss: 1.001 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744434).  Saving model ...
Epoch: 44 cost time: 0.7792696952819824
Epoch: 44, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.004 Vali Acc: 0.739 Test Loss: 1.004 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8014371395111084
Epoch: 45, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.013 Vali Acc: 0.733 Test Loss: 1.013 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.845205545425415
Epoch: 46, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.014 Vali Acc: 0.739 Test Loss: 1.014 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8767366409301758
Epoch: 47, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.020 Vali Acc: 0.744 Test Loss: 1.020 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7852516174316406
Epoch: 48, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.030 Vali Acc: 0.744 Test Loss: 1.030 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8590915203094482
Epoch: 49, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.037 Vali Acc: 0.750 Test Loss: 1.037 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749990).  Saving model ...
Epoch: 50 cost time: 0.8314845561981201
Epoch: 50, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.043 Vali Acc: 0.739 Test Loss: 1.043 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8211157321929932
Epoch: 51, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.048 Vali Acc: 0.739 Test Loss: 1.048 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9230067729949951
Epoch: 52, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.049 Vali Acc: 0.739 Test Loss: 1.049 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.912684440612793
Epoch: 53, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.069 Vali Acc: 0.744 Test Loss: 1.069 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9588840007781982
Epoch: 54, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.088 Vali Acc: 0.728 Test Loss: 1.088 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9131176471710205
Epoch: 55, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.100 Vali Acc: 0.728 Test Loss: 1.100 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8815608024597168
Epoch: 56, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.076 Vali Acc: 0.733 Test Loss: 1.076 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.7898476123809814
Epoch: 57, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.082 Vali Acc: 0.733 Test Loss: 1.082 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.7837562561035156
Epoch: 58, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.102 Vali Acc: 0.722 Test Loss: 1.102 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.7685952186584473
Epoch: 59, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.151 Vali Acc: 0.717 Test Loss: 1.151 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 30367
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1512482166290283
Epoch: 1, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.753 Vali Acc: 0.117 Test Loss: 2.753 Test Acc: 0.117
Validation loss decreased (inf --> -0.116639).  Saving model ...
Epoch: 2 cost time: 0.7541327476501465
Epoch: 2, Steps: 12 | Train Loss: 2.742 Vali Loss: 2.648 Vali Acc: 0.150 Test Loss: 2.648 Test Acc: 0.150
Validation loss decreased (-0.116639 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 0.7028124332427979
Epoch: 3, Steps: 12 | Train Loss: 2.684 Vali Loss: 2.516 Vali Acc: 0.183 Test Loss: 2.516 Test Acc: 0.183
Validation loss decreased (-0.149974 --> -0.183308).  Saving model ...
Epoch: 4 cost time: 0.8301286697387695
Epoch: 4, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.372 Vali Acc: 0.294 Test Loss: 2.372 Test Acc: 0.294
Validation loss decreased (-0.183308 --> -0.294421).  Saving model ...
Epoch: 5 cost time: 0.776810884475708
Epoch: 5, Steps: 12 | Train Loss: 2.318 Vali Loss: 2.221 Vali Acc: 0.372 Test Loss: 2.221 Test Acc: 0.372
Validation loss decreased (-0.294421 --> -0.372200).  Saving model ...
Epoch: 6 cost time: 0.7691054344177246
Epoch: 6, Steps: 12 | Train Loss: 2.188 Vali Loss: 2.080 Vali Acc: 0.406 Test Loss: 2.080 Test Acc: 0.406
Validation loss decreased (-0.372200 --> -0.405535).  Saving model ...
Epoch: 7 cost time: 0.8679909706115723
Epoch: 7, Steps: 12 | Train Loss: 1.998 Vali Loss: 1.941 Vali Acc: 0.467 Test Loss: 1.941 Test Acc: 0.467
Validation loss decreased (-0.405535 --> -0.466647).  Saving model ...
Epoch: 8 cost time: 0.7566492557525635
Epoch: 8, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.816 Vali Acc: 0.506 Test Loss: 1.816 Test Acc: 0.506
Validation loss decreased (-0.466647 --> -0.505537).  Saving model ...
Epoch: 9 cost time: 0.7267522811889648
Epoch: 9, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.708 Vali Acc: 0.561 Test Loss: 1.708 Test Acc: 0.561
Validation loss decreased (-0.505537 --> -0.561094).  Saving model ...
Epoch: 10 cost time: 0.7306866645812988
Epoch: 10, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.624 Vali Acc: 0.578 Test Loss: 1.624 Test Acc: 0.578
Validation loss decreased (-0.561094 --> -0.577762).  Saving model ...
Epoch: 11 cost time: 0.8613240718841553
Epoch: 11, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.545 Vali Acc: 0.589 Test Loss: 1.545 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588873).  Saving model ...
Epoch: 12 cost time: 0.6672823429107666
Epoch: 12, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.486 Vali Acc: 0.606 Test Loss: 1.486 Test Acc: 0.606
Validation loss decreased (-0.588873 --> -0.605541).  Saving model ...
Epoch: 13 cost time: 0.7313475608825684
Epoch: 13, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.436 Vali Acc: 0.600 Test Loss: 1.436 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6727075576782227
Epoch: 14, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.389 Vali Acc: 0.611 Test Loss: 1.389 Test Acc: 0.611
Validation loss decreased (-0.605541 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 0.7276871204376221
Epoch: 15, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.347 Vali Acc: 0.628 Test Loss: 1.347 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627764).  Saving model ...
Epoch: 16 cost time: 0.6932845115661621
Epoch: 16, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.299 Vali Acc: 0.628 Test Loss: 1.299 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627765).  Saving model ...
Epoch: 17 cost time: 0.7430953979492188
Epoch: 17, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.235 Vali Acc: 0.683 Test Loss: 1.235 Test Acc: 0.683
Validation loss decreased (-0.627765 --> -0.683321).  Saving model ...
Epoch: 18 cost time: 0.7562458515167236
Epoch: 18, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.215 Vali Acc: 0.672 Test Loss: 1.215 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8381397724151611
Epoch: 19, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.182 Vali Acc: 0.678 Test Loss: 1.182 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.78656005859375
Epoch: 20, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.154 Vali Acc: 0.689 Test Loss: 1.154 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688877).  Saving model ...
Epoch: 21 cost time: 0.7527203559875488
Epoch: 21, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.098 Vali Acc: 0.706 Test Loss: 1.098 Test Acc: 0.706
Validation loss decreased (-0.688877 --> -0.705545).  Saving model ...
Epoch: 22 cost time: 0.7131199836730957
Epoch: 22, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7194702625274658
Epoch: 23, Steps: 12 | Train Loss: 0.580 Vali Loss: 1.056 Vali Acc: 0.711 Test Loss: 1.056 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 24 cost time: 0.7331089973449707
Epoch: 24, Steps: 12 | Train Loss: 0.556 Vali Loss: 1.035 Vali Acc: 0.694 Test Loss: 1.035 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7213261127471924
Epoch: 25, Steps: 12 | Train Loss: 0.476 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7047502994537354
Epoch: 26, Steps: 12 | Train Loss: 0.410 Vali Loss: 1.005 Vali Acc: 0.689 Test Loss: 1.005 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7820785045623779
Epoch: 27, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.992 Vali Acc: 0.689 Test Loss: 0.992 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.762143611907959
Epoch: 28, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.985 Vali Acc: 0.700 Test Loss: 0.985 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8432760238647461
Epoch: 29, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.966 Vali Acc: 0.711 Test Loss: 0.966 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 30 cost time: 0.6446294784545898
Epoch: 30, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.957 Vali Acc: 0.717 Test Loss: 0.957 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 31 cost time: 0.8434364795684814
Epoch: 31, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.953 Vali Acc: 0.717 Test Loss: 0.953 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 32 cost time: 0.8607454299926758
Epoch: 32, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.961 Vali Acc: 0.728 Test Loss: 0.961 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 33 cost time: 0.7447733879089355
Epoch: 33, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.951 Vali Acc: 0.728 Test Loss: 0.951 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 34 cost time: 0.8317601680755615
Epoch: 34, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.962 Vali Acc: 0.733 Test Loss: 0.962 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 35 cost time: 0.7334811687469482
Epoch: 35, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.969 Vali Acc: 0.733 Test Loss: 0.969 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8133959770202637
Epoch: 36, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.966 Vali Acc: 0.728 Test Loss: 0.966 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7724826335906982
Epoch: 37, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.984 Vali Acc: 0.733 Test Loss: 0.984 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7797222137451172
Epoch: 38, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.975 Vali Acc: 0.728 Test Loss: 0.975 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8627011775970459
Epoch: 39, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.979 Vali Acc: 0.728 Test Loss: 0.979 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7609758377075195
Epoch: 40, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.971 Vali Acc: 0.750 Test Loss: 0.971 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749990).  Saving model ...
Epoch: 41 cost time: 0.8028914928436279
Epoch: 41, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.970 Vali Acc: 0.728 Test Loss: 0.970 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7685370445251465
Epoch: 42, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.981 Vali Acc: 0.744 Test Loss: 0.981 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8062613010406494
Epoch: 43, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.002 Vali Acc: 0.750 Test Loss: 1.002 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7518477439880371
Epoch: 44, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.000 Vali Acc: 0.750 Test Loss: 1.000 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7872951030731201
Epoch: 45, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7640106678009033
Epoch: 46, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.027 Vali Acc: 0.744 Test Loss: 1.027 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7612109184265137
Epoch: 47, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.008 Vali Acc: 0.728 Test Loss: 1.008 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7235336303710938
Epoch: 48, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.000 Vali Acc: 0.728 Test Loss: 1.000 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7616915702819824
Epoch: 49, Steps: 12 | Train Loss: 0.138 Vali Loss: 1.006 Vali Acc: 0.756 Test Loss: 1.006 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755545).  Saving model ...
Epoch: 50 cost time: 0.725783109664917
Epoch: 50, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.024 Vali Acc: 0.756 Test Loss: 1.024 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7169497013092041
Epoch: 51, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.039 Vali Acc: 0.744 Test Loss: 1.039 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7263553142547607
Epoch: 52, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.032 Vali Acc: 0.761 Test Loss: 1.032 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761101).  Saving model ...
Epoch: 53 cost time: 0.7138316631317139
Epoch: 53, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.033 Vali Acc: 0.750 Test Loss: 1.033 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7681982517242432
Epoch: 54, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.043 Vali Acc: 0.728 Test Loss: 1.043 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7870001792907715
Epoch: 55, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.067 Vali Acc: 0.733 Test Loss: 1.067 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7908861637115479
Epoch: 56, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.089 Vali Acc: 0.756 Test Loss: 1.089 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.7739737033843994
Epoch: 57, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.077 Vali Acc: 0.750 Test Loss: 1.077 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.8021841049194336
Epoch: 58, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.099 Vali Acc: 0.761 Test Loss: 1.099 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.7293403148651123
Epoch: 59, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.094 Vali Acc: 0.761 Test Loss: 1.094 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7226989269256592
Epoch: 60, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.085 Vali Acc: 0.761 Test Loss: 1.085 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.8267412185668945
Epoch: 61, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.094 Vali Acc: 0.750 Test Loss: 1.094 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.8611624240875244
Epoch: 62, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.111 Vali Acc: 0.756 Test Loss: 1.111 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 29903
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6596598625183105
Epoch: 1, Steps: 12 | Train Loss: 2.884 Vali Loss: 2.912 Vali Acc: 0.111 Test Loss: 2.912 Test Acc: 0.111
Validation loss decreased (inf --> -0.111082).  Saving model ...
Epoch: 2 cost time: 0.9103116989135742
Epoch: 2, Steps: 12 | Train Loss: 2.914 Vali Loss: 2.802 Vali Acc: 0.106 Test Loss: 2.802 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8310339450836182
Epoch: 3, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.675 Vali Acc: 0.117 Test Loss: 2.675 Test Acc: 0.117
Validation loss decreased (-0.111082 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 0.7716379165649414
Epoch: 4, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.530 Vali Acc: 0.167 Test Loss: 2.530 Test Acc: 0.167
Validation loss decreased (-0.116640 --> -0.166641).  Saving model ...
Epoch: 5 cost time: 0.8255867958068848
Epoch: 5, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.391 Vali Acc: 0.244 Test Loss: 2.391 Test Acc: 0.244
Validation loss decreased (-0.166641 --> -0.244421).  Saving model ...
Epoch: 6 cost time: 0.886887788772583
Epoch: 6, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.250 Vali Acc: 0.289 Test Loss: 2.250 Test Acc: 0.289
Validation loss decreased (-0.244421 --> -0.288866).  Saving model ...
Epoch: 7 cost time: 0.8374748229980469
Epoch: 7, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.125 Vali Acc: 0.367 Test Loss: 2.125 Test Acc: 0.367
Validation loss decreased (-0.288866 --> -0.366645).  Saving model ...
Epoch: 8 cost time: 0.843482255935669
Epoch: 8, Steps: 12 | Train Loss: 2.033 Vali Loss: 2.011 Vali Acc: 0.422 Test Loss: 2.011 Test Acc: 0.422
Validation loss decreased (-0.366645 --> -0.422202).  Saving model ...
Epoch: 9 cost time: 0.8625898361206055
Epoch: 9, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.903 Vali Acc: 0.467 Test Loss: 1.903 Test Acc: 0.467
Validation loss decreased (-0.422202 --> -0.466648).  Saving model ...
Epoch: 10 cost time: 0.813136100769043
Epoch: 10, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.811 Vali Acc: 0.456 Test Loss: 1.811 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8407187461853027
Epoch: 11, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.723 Vali Acc: 0.489 Test Loss: 1.723 Test Acc: 0.489
Validation loss decreased (-0.466648 --> -0.488872).  Saving model ...
Epoch: 12 cost time: 0.847447395324707
Epoch: 12, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.658 Vali Acc: 0.550 Test Loss: 1.658 Test Acc: 0.550
Validation loss decreased (-0.488872 --> -0.549983).  Saving model ...
Epoch: 13 cost time: 0.8215134143829346
Epoch: 13, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.587 Vali Acc: 0.550 Test Loss: 1.587 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549984).  Saving model ...
Epoch: 14 cost time: 0.8436872959136963
Epoch: 14, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.524 Vali Acc: 0.567 Test Loss: 1.524 Test Acc: 0.567
Validation loss decreased (-0.549984 --> -0.566651).  Saving model ...
Epoch: 15 cost time: 0.8537459373474121
Epoch: 15, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.477 Vali Acc: 0.556 Test Loss: 1.477 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8712663650512695
Epoch: 16, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.434 Vali Acc: 0.589 Test Loss: 1.434 Test Acc: 0.589
Validation loss decreased (-0.566651 --> -0.588875).  Saving model ...
Epoch: 17 cost time: 0.8220789432525635
Epoch: 17, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.396 Vali Acc: 0.589 Test Loss: 1.396 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588875).  Saving model ...
Epoch: 18 cost time: 0.8468194007873535
Epoch: 18, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.350 Vali Acc: 0.606 Test Loss: 1.350 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605542).  Saving model ...
Epoch: 19 cost time: 0.9343862533569336
Epoch: 19, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.332 Vali Acc: 0.611 Test Loss: 1.332 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 20 cost time: 0.9165282249450684
Epoch: 20, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.289 Vali Acc: 0.644 Test Loss: 1.289 Test Acc: 0.644
Validation loss decreased (-0.611098 --> -0.644432).  Saving model ...
Epoch: 21 cost time: 0.9025871753692627
Epoch: 21, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.262 Vali Acc: 0.650 Test Loss: 1.262 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649987).  Saving model ...
Epoch: 22 cost time: 0.8877148628234863
Epoch: 22, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 23 cost time: 0.8022499084472656
Epoch: 23, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.213 Vali Acc: 0.650 Test Loss: 1.213 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 24 cost time: 0.8868565559387207
Epoch: 24, Steps: 12 | Train Loss: 0.768 Vali Loss: 1.187 Vali Acc: 0.667 Test Loss: 1.187 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666655).  Saving model ...
Epoch: 25 cost time: 0.8137173652648926
Epoch: 25, Steps: 12 | Train Loss: 0.728 Vali Loss: 1.165 Vali Acc: 0.678 Test Loss: 1.165 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677766).  Saving model ...
Epoch: 26 cost time: 0.826479434967041
Epoch: 26, Steps: 12 | Train Loss: 0.656 Vali Loss: 1.137 Vali Acc: 0.656 Test Loss: 1.137 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8857369422912598
Epoch: 27, Steps: 12 | Train Loss: 0.627 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8559074401855469
Epoch: 28, Steps: 12 | Train Loss: 0.577 Vali Loss: 1.104 Vali Acc: 0.683 Test Loss: 1.104 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683322).  Saving model ...
Epoch: 29 cost time: 0.9273407459259033
Epoch: 29, Steps: 12 | Train Loss: 0.570 Vali Loss: 1.088 Vali Acc: 0.683 Test Loss: 1.088 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 30 cost time: 0.8378710746765137
Epoch: 30, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.076 Vali Acc: 0.678 Test Loss: 1.076 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8197896480560303
Epoch: 31, Steps: 12 | Train Loss: 0.505 Vali Loss: 1.060 Vali Acc: 0.683 Test Loss: 1.060 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683323).  Saving model ...
Epoch: 32 cost time: 0.7990248203277588
Epoch: 32, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.043 Vali Acc: 0.694 Test Loss: 1.043 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694434).  Saving model ...
Epoch: 33 cost time: 0.8755230903625488
Epoch: 33, Steps: 12 | Train Loss: 0.480 Vali Loss: 1.023 Vali Acc: 0.694 Test Loss: 1.023 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 34 cost time: 0.8679773807525635
Epoch: 34, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.997 Vali Acc: 0.711 Test Loss: 0.997 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 35 cost time: 0.8683187961578369
Epoch: 35, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.987 Vali Acc: 0.706 Test Loss: 0.987 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7595736980438232
Epoch: 36, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.969 Vali Acc: 0.728 Test Loss: 0.969 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 37 cost time: 0.8120615482330322
Epoch: 37, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.974 Vali Acc: 0.711 Test Loss: 0.974 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8633153438568115
Epoch: 38, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.989 Vali Acc: 0.706 Test Loss: 0.989 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8523874282836914
Epoch: 39, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.970 Vali Acc: 0.722 Test Loss: 0.970 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7902894020080566
Epoch: 40, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.959 Vali Acc: 0.722 Test Loss: 0.959 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8394830226898193
Epoch: 41, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.952 Vali Acc: 0.717 Test Loss: 0.952 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9976356029510498
Epoch: 42, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.948 Vali Acc: 0.717 Test Loss: 0.948 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9496476650238037
Epoch: 43, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.951 Vali Acc: 0.717 Test Loss: 0.951 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.887319803237915
Epoch: 44, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.954 Vali Acc: 0.728 Test Loss: 0.954 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 45 cost time: 0.8469610214233398
Epoch: 45, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.955 Vali Acc: 0.728 Test Loss: 0.955 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8374497890472412
Epoch: 46, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8775434494018555
Epoch: 47, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.970 Vali Acc: 0.728 Test Loss: 0.970 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9150822162628174
Epoch: 48, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.959 Vali Acc: 0.722 Test Loss: 0.959 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8900856971740723
Epoch: 49, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.956 Vali Acc: 0.739 Test Loss: 0.956 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 50 cost time: 0.8096528053283691
Epoch: 50, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8331246376037598
Epoch: 51, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.963 Vali Acc: 0.728 Test Loss: 0.963 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.8507542610168457
Epoch: 52, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.967 Vali Acc: 0.733 Test Loss: 0.967 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8479020595550537
Epoch: 53, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.959 Vali Acc: 0.717 Test Loss: 0.959 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8157939910888672
Epoch: 54, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.975 Vali Acc: 0.739 Test Loss: 0.975 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9055819511413574
Epoch: 55, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.968 Vali Acc: 0.739 Test Loss: 0.968 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8591609001159668
Epoch: 56, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.967 Vali Acc: 0.728 Test Loss: 0.967 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.9109904766082764
Epoch: 57, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.965 Vali Acc: 0.739 Test Loss: 0.965 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.8561780452728271
Epoch: 58, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.963 Vali Acc: 0.767 Test Loss: 0.963 Test Acc: 0.767
Validation loss decreased (-0.738879 --> -0.766657).  Saving model ...
Epoch: 59 cost time: 0.7985811233520508
Epoch: 59, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.962 Vali Acc: 0.750 Test Loss: 0.962 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8866870403289795
Epoch: 60, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.964 Vali Acc: 0.756 Test Loss: 0.964 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8387067317962646
Epoch: 61, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.979 Vali Acc: 0.739 Test Loss: 0.979 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8451313972473145
Epoch: 62, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.976 Vali Acc: 0.744 Test Loss: 0.976 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8958542346954346
Epoch: 63, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.975 Vali Acc: 0.739 Test Loss: 0.975 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9361584186553955
Epoch: 64, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.982 Vali Acc: 0.744 Test Loss: 0.982 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.8574299812316895
Epoch: 65, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.989 Vali Acc: 0.733 Test Loss: 0.989 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.7981679439544678
Epoch: 66, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.007 Vali Acc: 0.728 Test Loss: 1.007 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.884427547454834
Epoch: 67, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.003 Vali Acc: 0.733 Test Loss: 1.003 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.8211946487426758
Epoch: 68, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 26559
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.321537494659424
Epoch: 1, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.744 Vali Acc: 0.089 Test Loss: 2.744 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 0.8232157230377197
Epoch: 2, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.681 Vali Acc: 0.128 Test Loss: 2.681 Test Acc: 0.128
Validation loss decreased (-0.088861 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.8096010684967041
Epoch: 3, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.602 Vali Acc: 0.144 Test Loss: 2.602 Test Acc: 0.144
Validation loss decreased (-0.127751 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 0.8230328559875488
Epoch: 4, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.513 Vali Acc: 0.189 Test Loss: 2.513 Test Acc: 0.189
Validation loss decreased (-0.144418 --> -0.188864).  Saving model ...
Epoch: 5 cost time: 0.8180201053619385
Epoch: 5, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.411 Vali Acc: 0.261 Test Loss: 2.411 Test Acc: 0.261
Validation loss decreased (-0.188864 --> -0.261087).  Saving model ...
Epoch: 6 cost time: 0.8213121891021729
Epoch: 6, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.310 Vali Acc: 0.328 Test Loss: 2.310 Test Acc: 0.328
Validation loss decreased (-0.261087 --> -0.327755).  Saving model ...
Epoch: 7 cost time: 0.7894823551177979
Epoch: 7, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.203 Vali Acc: 0.389 Test Loss: 2.203 Test Acc: 0.389
Validation loss decreased (-0.327755 --> -0.388867).  Saving model ...
Epoch: 8 cost time: 0.8263399600982666
Epoch: 8, Steps: 12 | Train Loss: 2.153 Vali Loss: 2.098 Vali Acc: 0.444 Test Loss: 2.098 Test Acc: 0.444
Validation loss decreased (-0.388867 --> -0.444423).  Saving model ...
Epoch: 9 cost time: 0.8391828536987305
Epoch: 9, Steps: 12 | Train Loss: 1.986 Vali Loss: 1.991 Vali Acc: 0.461 Test Loss: 1.991 Test Acc: 0.461
Validation loss decreased (-0.444423 --> -0.461091).  Saving model ...
Epoch: 10 cost time: 0.8809850215911865
Epoch: 10, Steps: 12 | Train Loss: 1.902 Vali Loss: 1.891 Vali Acc: 0.500 Test Loss: 1.891 Test Acc: 0.500
Validation loss decreased (-0.461091 --> -0.499981).  Saving model ...
Epoch: 11 cost time: 0.8084444999694824
Epoch: 11, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.804 Vali Acc: 0.511 Test Loss: 1.804 Test Acc: 0.511
Validation loss decreased (-0.499981 --> -0.511093).  Saving model ...
Epoch: 12 cost time: 0.841552734375
Epoch: 12, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.723 Vali Acc: 0.528 Test Loss: 1.723 Test Acc: 0.528
Validation loss decreased (-0.511093 --> -0.527761).  Saving model ...
Epoch: 13 cost time: 0.8084523677825928
Epoch: 13, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.646 Vali Acc: 0.539 Test Loss: 1.646 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538872).  Saving model ...
Epoch: 14 cost time: 0.8318493366241455
Epoch: 14, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.573 Vali Acc: 0.567 Test Loss: 1.573 Test Acc: 0.567
Validation loss decreased (-0.538872 --> -0.566651).  Saving model ...
Epoch: 15 cost time: 0.8549671173095703
Epoch: 15, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.517 Vali Acc: 0.567 Test Loss: 1.517 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 16 cost time: 0.7986676692962646
Epoch: 16, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.471 Vali Acc: 0.567 Test Loss: 1.471 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566652).  Saving model ...
Epoch: 17 cost time: 0.8554704189300537
Epoch: 17, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.422 Vali Acc: 0.583 Test Loss: 1.422 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583319).  Saving model ...
Epoch: 18 cost time: 0.7916343212127686
Epoch: 18, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.379 Vali Acc: 0.594 Test Loss: 1.379 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594431).  Saving model ...
Epoch: 19 cost time: 0.8357288837432861
Epoch: 19, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.338 Vali Acc: 0.606 Test Loss: 1.338 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605542).  Saving model ...
Epoch: 20 cost time: 0.7416205406188965
Epoch: 20, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.301 Vali Acc: 0.617 Test Loss: 1.301 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 21 cost time: 0.8816564083099365
Epoch: 21, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.261 Vali Acc: 0.611 Test Loss: 1.261 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7794673442840576
Epoch: 22, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.223 Vali Acc: 0.622 Test Loss: 1.223 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 23 cost time: 0.8281285762786865
Epoch: 23, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.198 Vali Acc: 0.628 Test Loss: 1.198 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 24 cost time: 0.8023271560668945
Epoch: 24, Steps: 12 | Train Loss: 0.816 Vali Loss: 1.164 Vali Acc: 0.639 Test Loss: 1.164 Test Acc: 0.639
Validation loss decreased (-0.627766 --> -0.638877).  Saving model ...
Epoch: 25 cost time: 0.8685462474822998
Epoch: 25, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.137 Vali Acc: 0.644 Test Loss: 1.137 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 26 cost time: 0.7876672744750977
Epoch: 26, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.126 Vali Acc: 0.644 Test Loss: 1.126 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 27 cost time: 0.84580397605896
Epoch: 27, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.081 Vali Acc: 0.667 Test Loss: 1.081 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666656).  Saving model ...
Epoch: 28 cost time: 0.7715466022491455
Epoch: 28, Steps: 12 | Train Loss: 0.719 Vali Loss: 1.058 Vali Acc: 0.661 Test Loss: 1.058 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8422582149505615
Epoch: 29, Steps: 12 | Train Loss: 0.654 Vali Loss: 1.023 Vali Acc: 0.678 Test Loss: 1.023 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 30 cost time: 0.9229352474212646
Epoch: 30, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.001 Vali Acc: 0.683 Test Loss: 1.001 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683323).  Saving model ...
Epoch: 31 cost time: 0.9041774272918701
Epoch: 31, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.991 Vali Acc: 0.689 Test Loss: 0.991 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 32 cost time: 0.8885281085968018
Epoch: 32, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.978 Vali Acc: 0.694 Test Loss: 0.978 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 33 cost time: 0.8721680641174316
Epoch: 33, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.9206433296203613
Epoch: 34, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.935 Vali Acc: 0.700 Test Loss: 0.935 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 35 cost time: 0.7788126468658447
Epoch: 35, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.928 Vali Acc: 0.717 Test Loss: 0.928 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716657).  Saving model ...
Epoch: 36 cost time: 0.9337799549102783
Epoch: 36, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.912 Vali Acc: 0.739 Test Loss: 0.912 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738880).  Saving model ...
Epoch: 37 cost time: 0.8385090827941895
Epoch: 37, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.887 Vali Acc: 0.728 Test Loss: 0.887 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8193695545196533
Epoch: 38, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.878 Vali Acc: 0.711 Test Loss: 0.878 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8775136470794678
Epoch: 39, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.823664665222168
Epoch: 40, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.860 Vali Acc: 0.733 Test Loss: 0.860 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8891620635986328
Epoch: 41, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.849 Vali Acc: 0.728 Test Loss: 0.849 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8541910648345947
Epoch: 42, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.844 Vali Acc: 0.733 Test Loss: 0.844 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8955042362213135
Epoch: 43, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.839 Vali Acc: 0.739 Test Loss: 0.839 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 44 cost time: 0.803917646408081
Epoch: 44, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.804 Vali Acc: 0.756 Test Loss: 0.804 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755548).  Saving model ...
Epoch: 45 cost time: 0.8890824317932129
Epoch: 45, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9021944999694824
Epoch: 46, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.834 Vali Acc: 0.722 Test Loss: 0.834 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8581292629241943
Epoch: 47, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.815 Vali Acc: 0.733 Test Loss: 0.815 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.822911262512207
Epoch: 48, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.809 Vali Acc: 0.739 Test Loss: 0.809 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7899892330169678
Epoch: 49, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8928790092468262
Epoch: 50, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.774 Vali Acc: 0.778 Test Loss: 0.774 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 51 cost time: 0.8103137016296387
Epoch: 51, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.780 Vali Acc: 0.772 Test Loss: 0.780 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7694129943847656
Epoch: 52, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.795 Vali Acc: 0.767 Test Loss: 0.795 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7780921459197998
Epoch: 53, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.789 Vali Acc: 0.778 Test Loss: 0.789 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.904263973236084
Epoch: 54, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.773 Vali Acc: 0.778 Test Loss: 0.773 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 55 cost time: 0.8660333156585693
Epoch: 55, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.755 Vali Acc: 0.789 Test Loss: 0.755 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 56 cost time: 0.806222677230835
Epoch: 56, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.750 Vali Acc: 0.811 Test Loss: 0.750 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 57 cost time: 0.8793487548828125
Epoch: 57, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.753 Vali Acc: 0.817 Test Loss: 0.753 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 58 cost time: 0.808255672454834
Epoch: 58, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8660109043121338
Epoch: 59, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7620899677276611
Epoch: 60, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.750 Vali Acc: 0.811 Test Loss: 0.750 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.7911515235900879
Epoch: 61, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.7848002910614014
Epoch: 62, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.751 Vali Acc: 0.811 Test Loss: 0.751 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.7644867897033691
Epoch: 63, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.753 Vali Acc: 0.800 Test Loss: 0.753 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8403923511505127
Epoch: 64, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.753 Vali Acc: 0.806 Test Loss: 0.753 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7943723201751709
Epoch: 65, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.9145593643188477
Epoch: 66, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.7980778217315674
Epoch: 67, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 24671
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2023813724517822
Epoch: 1, Steps: 12 | Train Loss: 2.895 Vali Loss: 2.850 Vali Acc: 0.028 Test Loss: 2.850 Test Acc: 0.028
Validation loss decreased (inf --> -0.027749).  Saving model ...
Epoch: 2 cost time: 0.7566001415252686
Epoch: 2, Steps: 12 | Train Loss: 2.846 Vali Loss: 2.795 Vali Acc: 0.033 Test Loss: 2.795 Test Acc: 0.033
Validation loss decreased (-0.027749 --> -0.033305).  Saving model ...
Epoch: 3 cost time: 0.743135929107666
Epoch: 3, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.708 Vali Acc: 0.050 Test Loss: 2.708 Test Acc: 0.050
Validation loss decreased (-0.033305 --> -0.049973).  Saving model ...
Epoch: 4 cost time: 0.7865190505981445
Epoch: 4, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.607 Vali Acc: 0.144 Test Loss: 2.607 Test Acc: 0.144
Validation loss decreased (-0.049973 --> -0.144418).  Saving model ...
Epoch: 5 cost time: 0.8148634433746338
Epoch: 5, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.500 Vali Acc: 0.206 Test Loss: 2.500 Test Acc: 0.206
Validation loss decreased (-0.144418 --> -0.205531).  Saving model ...
Epoch: 6 cost time: 0.7160699367523193
Epoch: 6, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.392 Vali Acc: 0.289 Test Loss: 2.392 Test Acc: 0.289
Validation loss decreased (-0.205531 --> -0.288865).  Saving model ...
Epoch: 7 cost time: 0.7918658256530762
Epoch: 7, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.289 Vali Acc: 0.344 Test Loss: 2.289 Test Acc: 0.344
Validation loss decreased (-0.288865 --> -0.344422).  Saving model ...
Epoch: 8 cost time: 0.7633576393127441
Epoch: 8, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.196 Vali Acc: 0.394 Test Loss: 2.196 Test Acc: 0.394
Validation loss decreased (-0.344422 --> -0.394422).  Saving model ...
Epoch: 9 cost time: 0.7361733913421631
Epoch: 9, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.105 Vali Acc: 0.433 Test Loss: 2.105 Test Acc: 0.433
Validation loss decreased (-0.394422 --> -0.433312).  Saving model ...
Epoch: 10 cost time: 0.750464677810669
Epoch: 10, Steps: 12 | Train Loss: 2.028 Vali Loss: 2.022 Vali Acc: 0.422 Test Loss: 2.022 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7173006534576416
Epoch: 11, Steps: 12 | Train Loss: 1.928 Vali Loss: 1.939 Vali Acc: 0.422 Test Loss: 1.939 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7868571281433105
Epoch: 12, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.870 Vali Acc: 0.422 Test Loss: 1.870 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7965691089630127
Epoch: 13, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.809 Vali Acc: 0.467 Test Loss: 1.809 Test Acc: 0.467
Validation loss decreased (-0.433312 --> -0.466649).  Saving model ...
Epoch: 14 cost time: 0.7516202926635742
Epoch: 14, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.745 Vali Acc: 0.494 Test Loss: 1.745 Test Acc: 0.494
Validation loss decreased (-0.466649 --> -0.494427).  Saving model ...
Epoch: 15 cost time: 0.8060259819030762
Epoch: 15, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.693 Vali Acc: 0.511 Test Loss: 1.693 Test Acc: 0.511
Validation loss decreased (-0.494427 --> -0.511094).  Saving model ...
Epoch: 16 cost time: 0.7738838195800781
Epoch: 16, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.631 Vali Acc: 0.517 Test Loss: 1.631 Test Acc: 0.517
Validation loss decreased (-0.511094 --> -0.516650).  Saving model ...
Epoch: 17 cost time: 0.7872347831726074
Epoch: 17, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.588 Vali Acc: 0.528 Test Loss: 1.588 Test Acc: 0.528
Validation loss decreased (-0.516650 --> -0.527762).  Saving model ...
Epoch: 18 cost time: 0.8700594902038574
Epoch: 18, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.548 Vali Acc: 0.544 Test Loss: 1.548 Test Acc: 0.544
Validation loss decreased (-0.527762 --> -0.544429).  Saving model ...
Epoch: 19 cost time: 0.8532991409301758
Epoch: 19, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.491 Vali Acc: 0.561 Test Loss: 1.491 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561096).  Saving model ...
Epoch: 20 cost time: 0.859534502029419
Epoch: 20, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.454 Vali Acc: 0.567 Test Loss: 1.454 Test Acc: 0.567
Validation loss decreased (-0.561096 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 0.8849911689758301
Epoch: 21, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.414 Vali Acc: 0.594 Test Loss: 1.414 Test Acc: 0.594
Validation loss decreased (-0.566652 --> -0.594430).  Saving model ...
Epoch: 22 cost time: 0.8067200183868408
Epoch: 22, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.375 Vali Acc: 0.606 Test Loss: 1.375 Test Acc: 0.606
Validation loss decreased (-0.594430 --> -0.605542).  Saving model ...
Epoch: 23 cost time: 0.8382914066314697
Epoch: 23, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.339 Vali Acc: 0.628 Test Loss: 1.339 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627764).  Saving model ...
Epoch: 24 cost time: 0.7184832096099854
Epoch: 24, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.301 Vali Acc: 0.633 Test Loss: 1.301 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633320).  Saving model ...
Epoch: 25 cost time: 0.812685489654541
Epoch: 25, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.262 Vali Acc: 0.633 Test Loss: 1.262 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 26 cost time: 0.8490519523620605
Epoch: 26, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.225 Vali Acc: 0.622 Test Loss: 1.225 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7742140293121338
Epoch: 27, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.190 Vali Acc: 0.628 Test Loss: 1.190 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.807426929473877
Epoch: 28, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.170 Vali Acc: 0.628 Test Loss: 1.170 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8329625129699707
Epoch: 29, Steps: 12 | Train Loss: 0.795 Vali Loss: 1.140 Vali Acc: 0.661 Test Loss: 1.140 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 30 cost time: 0.8522992134094238
Epoch: 30, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.107 Vali Acc: 0.644 Test Loss: 1.107 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8456757068634033
Epoch: 31, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.080 Vali Acc: 0.656 Test Loss: 1.080 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7923963069915771
Epoch: 32, Steps: 12 | Train Loss: 0.721 Vali Loss: 1.053 Vali Acc: 0.661 Test Loss: 1.053 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661101).  Saving model ...
Epoch: 33 cost time: 0.8547472953796387
Epoch: 33, Steps: 12 | Train Loss: 0.692 Vali Loss: 1.036 Vali Acc: 0.667 Test Loss: 1.036 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666656).  Saving model ...
Epoch: 34 cost time: 0.7978067398071289
Epoch: 34, Steps: 12 | Train Loss: 0.662 Vali Loss: 1.015 Vali Acc: 0.672 Test Loss: 1.015 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 35 cost time: 0.7992973327636719
Epoch: 35, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.999 Vali Acc: 0.678 Test Loss: 0.999 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 36 cost time: 0.8053667545318604
Epoch: 36, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.980 Vali Acc: 0.689 Test Loss: 0.980 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 37 cost time: 0.848644495010376
Epoch: 37, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.973 Vali Acc: 0.683 Test Loss: 0.973 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7977290153503418
Epoch: 38, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.959 Vali Acc: 0.689 Test Loss: 0.959 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 39 cost time: 0.748633861541748
Epoch: 39, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 40 cost time: 0.7037625312805176
Epoch: 40, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.916 Vali Acc: 0.717 Test Loss: 0.916 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 41 cost time: 0.7585146427154541
Epoch: 41, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722213).  Saving model ...
Epoch: 42 cost time: 0.8554544448852539
Epoch: 42, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.879 Vali Acc: 0.728 Test Loss: 0.879 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 43 cost time: 0.7499635219573975
Epoch: 43, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.867 Vali Acc: 0.728 Test Loss: 0.867 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 44 cost time: 0.8432676792144775
Epoch: 44, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.867 Vali Acc: 0.711 Test Loss: 0.867 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8041436672210693
Epoch: 45, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.856 Vali Acc: 0.733 Test Loss: 0.856 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 46 cost time: 0.8441929817199707
Epoch: 46, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.856 Vali Acc: 0.739 Test Loss: 0.856 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738880).  Saving model ...
Epoch: 47 cost time: 0.8799574375152588
Epoch: 47, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.860 Vali Acc: 0.728 Test Loss: 0.860 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8145899772644043
Epoch: 48, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.852 Vali Acc: 0.744 Test Loss: 0.852 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 49 cost time: 0.7569470405578613
Epoch: 49, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.853 Vali Acc: 0.756 Test Loss: 0.853 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 50 cost time: 0.8169488906860352
Epoch: 50, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8633358478546143
Epoch: 51, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.820 Vali Acc: 0.744 Test Loss: 0.820 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7794198989868164
Epoch: 52, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8260331153869629
Epoch: 53, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.827 Vali Acc: 0.733 Test Loss: 0.827 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8066723346710205
Epoch: 54, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.813 Vali Acc: 0.761 Test Loss: 0.813 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 55 cost time: 0.8025045394897461
Epoch: 55, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.811 Vali Acc: 0.767 Test Loss: 0.811 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 56 cost time: 0.8880901336669922
Epoch: 56, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.840 Vali Acc: 0.728 Test Loss: 0.840 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9168977737426758
Epoch: 57, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.838 Vali Acc: 0.728 Test Loss: 0.838 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.8672504425048828
Epoch: 58, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.826 Vali Acc: 0.761 Test Loss: 0.826 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8959834575653076
Epoch: 59, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.820 Vali Acc: 0.750 Test Loss: 0.820 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9058792591094971
Epoch: 60, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.818 Vali Acc: 0.739 Test Loss: 0.818 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9124147891998291
Epoch: 61, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.824 Vali Acc: 0.739 Test Loss: 0.824 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.8581218719482422
Epoch: 62, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.820 Vali Acc: 0.750 Test Loss: 0.820 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.8878109455108643
Epoch: 63, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.834 Vali Acc: 0.756 Test Loss: 0.834 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.8465192317962646
Epoch: 64, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.844 Vali Acc: 0.750 Test Loss: 0.844 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.8908734321594238
Epoch: 65, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.845 Vali Acc: 0.744 Test Loss: 0.845 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 23743
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.370821237564087
Epoch: 1, Steps: 12 | Train Loss: 2.909 Vali Loss: 2.803 Vali Acc: 0.100 Test Loss: 2.803 Test Acc: 0.100
Validation loss decreased (inf --> -0.099972).  Saving model ...
Epoch: 2 cost time: 0.899888277053833
Epoch: 2, Steps: 12 | Train Loss: 2.950 Vali Loss: 2.765 Vali Acc: 0.089 Test Loss: 2.765 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8618390560150146
Epoch: 3, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.705 Vali Acc: 0.133 Test Loss: 2.705 Test Acc: 0.133
Validation loss decreased (-0.099972 --> -0.133306).  Saving model ...
Epoch: 4 cost time: 0.8299472332000732
Epoch: 4, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.633 Vali Acc: 0.172 Test Loss: 2.633 Test Acc: 0.172
Validation loss decreased (-0.133306 --> -0.172196).  Saving model ...
Epoch: 5 cost time: 0.8781936168670654
Epoch: 5, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.546 Vali Acc: 0.250 Test Loss: 2.546 Test Acc: 0.250
Validation loss decreased (-0.172196 --> -0.249975).  Saving model ...
Epoch: 6 cost time: 0.8888411521911621
Epoch: 6, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.462 Vali Acc: 0.311 Test Loss: 2.462 Test Acc: 0.311
Validation loss decreased (-0.249975 --> -0.311086).  Saving model ...
Epoch: 7 cost time: 0.8407113552093506
Epoch: 7, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.370 Vali Acc: 0.333 Test Loss: 2.370 Test Acc: 0.333
Validation loss decreased (-0.311086 --> -0.333310).  Saving model ...
Epoch: 8 cost time: 0.8798689842224121
Epoch: 8, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.274 Vali Acc: 0.356 Test Loss: 2.274 Test Acc: 0.356
Validation loss decreased (-0.333310 --> -0.355533).  Saving model ...
Epoch: 9 cost time: 0.7971882820129395
Epoch: 9, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.186 Vali Acc: 0.372 Test Loss: 2.186 Test Acc: 0.372
Validation loss decreased (-0.355533 --> -0.372200).  Saving model ...
Epoch: 10 cost time: 0.961763858795166
Epoch: 10, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.099 Vali Acc: 0.389 Test Loss: 2.099 Test Acc: 0.389
Validation loss decreased (-0.372200 --> -0.388868).  Saving model ...
Epoch: 11 cost time: 0.9354393482208252
Epoch: 11, Steps: 12 | Train Loss: 2.019 Vali Loss: 2.003 Vali Acc: 0.400 Test Loss: 2.003 Test Acc: 0.400
Validation loss decreased (-0.388868 --> -0.399980).  Saving model ...
Epoch: 12 cost time: 0.9034228324890137
Epoch: 12, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.917 Vali Acc: 0.450 Test Loss: 1.917 Test Acc: 0.450
Validation loss decreased (-0.399980 --> -0.449981).  Saving model ...
Epoch: 13 cost time: 0.8407909870147705
Epoch: 13, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.841 Vali Acc: 0.456 Test Loss: 1.841 Test Acc: 0.456
Validation loss decreased (-0.449981 --> -0.455537).  Saving model ...
Epoch: 14 cost time: 0.903264045715332
Epoch: 14, Steps: 12 | Train Loss: 1.727 Vali Loss: 1.760 Vali Acc: 0.483 Test Loss: 1.760 Test Acc: 0.483
Validation loss decreased (-0.455537 --> -0.483316).  Saving model ...
Epoch: 15 cost time: 0.8570518493652344
Epoch: 15, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.687 Vali Acc: 0.544 Test Loss: 1.687 Test Acc: 0.544
Validation loss decreased (-0.483316 --> -0.544428).  Saving model ...
Epoch: 16 cost time: 0.8818998336791992
Epoch: 16, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.625 Vali Acc: 0.550 Test Loss: 1.625 Test Acc: 0.550
Validation loss decreased (-0.544428 --> -0.549984).  Saving model ...
Epoch: 17 cost time: 0.7963387966156006
Epoch: 17, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.569 Vali Acc: 0.550 Test Loss: 1.569 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 18 cost time: 0.8262546062469482
Epoch: 18, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.521 Vali Acc: 0.594 Test Loss: 1.521 Test Acc: 0.594
Validation loss decreased (-0.549984 --> -0.594429).  Saving model ...
Epoch: 19 cost time: 0.865415096282959
Epoch: 19, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.470 Vali Acc: 0.578 Test Loss: 1.470 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8628404140472412
Epoch: 20, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.424 Vali Acc: 0.600 Test Loss: 1.424 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599986).  Saving model ...
Epoch: 21 cost time: 0.8412814140319824
Epoch: 21, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.367 Vali Acc: 0.606 Test Loss: 1.367 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 22 cost time: 0.8397219181060791
Epoch: 22, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.326 Vali Acc: 0.606 Test Loss: 1.326 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605542).  Saving model ...
Epoch: 23 cost time: 0.8885104656219482
Epoch: 23, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.283 Vali Acc: 0.622 Test Loss: 1.283 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 24 cost time: 0.7733514308929443
Epoch: 24, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.245 Vali Acc: 0.611 Test Loss: 1.245 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8072640895843506
Epoch: 25, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.214 Vali Acc: 0.617 Test Loss: 1.214 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8632733821868896
Epoch: 26, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.182 Vali Acc: 0.622 Test Loss: 1.182 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 27 cost time: 0.8179645538330078
Epoch: 27, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.156 Vali Acc: 0.633 Test Loss: 1.156 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633322).  Saving model ...
Epoch: 28 cost time: 0.8529915809631348
Epoch: 28, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.122 Vali Acc: 0.633 Test Loss: 1.122 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 29 cost time: 0.8736071586608887
Epoch: 29, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.095 Vali Acc: 0.633 Test Loss: 1.095 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 30 cost time: 0.9444949626922607
Epoch: 30, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.074 Vali Acc: 0.644 Test Loss: 1.074 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644434).  Saving model ...
Epoch: 31 cost time: 0.9126584529876709
Epoch: 31, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.050 Vali Acc: 0.633 Test Loss: 1.050 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9245343208312988
Epoch: 32, Steps: 12 | Train Loss: 0.705 Vali Loss: 1.036 Vali Acc: 0.644 Test Loss: 1.036 Test Acc: 0.644
Validation loss decreased (-0.644434 --> -0.644434).  Saving model ...
Epoch: 33 cost time: 0.8881111145019531
Epoch: 33, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.009 Vali Acc: 0.661 Test Loss: 1.009 Test Acc: 0.661
Validation loss decreased (-0.644434 --> -0.661101).  Saving model ...
Epoch: 34 cost time: 0.9039466381072998
Epoch: 34, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.997 Vali Acc: 0.656 Test Loss: 0.997 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9240326881408691
Epoch: 35, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.967 Vali Acc: 0.667 Test Loss: 0.967 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666657).  Saving model ...
Epoch: 36 cost time: 0.8579597473144531
Epoch: 36, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.961 Vali Acc: 0.661 Test Loss: 0.961 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.844437837600708
Epoch: 37, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.958 Vali Acc: 0.667 Test Loss: 0.958 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 38 cost time: 0.8923554420471191
Epoch: 38, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.946 Vali Acc: 0.661 Test Loss: 0.946 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8397471904754639
Epoch: 39, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.927 Vali Acc: 0.678 Test Loss: 0.927 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 40 cost time: 0.8921945095062256
Epoch: 40, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.921 Vali Acc: 0.667 Test Loss: 0.921 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8700759410858154
Epoch: 41, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.883 Vali Acc: 0.706 Test Loss: 0.883 Test Acc: 0.706
Validation loss decreased (-0.677769 --> -0.705547).  Saving model ...
Epoch: 42 cost time: 0.8863992691040039
Epoch: 42, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.872 Vali Acc: 0.706 Test Loss: 0.872 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 43 cost time: 0.8628380298614502
Epoch: 43, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.868 Vali Acc: 0.700 Test Loss: 0.868 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.901996374130249
Epoch: 44, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.855 Vali Acc: 0.717 Test Loss: 0.855 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716658).  Saving model ...
Epoch: 45 cost time: 0.8354573249816895
Epoch: 45, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.853 Vali Acc: 0.711 Test Loss: 0.853 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8771872520446777
Epoch: 46, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.850 Vali Acc: 0.717 Test Loss: 0.850 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 47 cost time: 0.8986234664916992
Epoch: 47, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.837 Vali Acc: 0.717 Test Loss: 0.837 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 48 cost time: 0.9112496376037598
Epoch: 48, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.831 Vali Acc: 0.717 Test Loss: 0.831 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 49 cost time: 0.8448810577392578
Epoch: 49, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.822 Vali Acc: 0.711 Test Loss: 0.822 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8908224105834961
Epoch: 50, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.823 Vali Acc: 0.728 Test Loss: 0.823 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 51 cost time: 0.890697717666626
Epoch: 51, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.809 Vali Acc: 0.744 Test Loss: 0.809 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744436).  Saving model ...
Epoch: 52 cost time: 0.8291676044464111
Epoch: 52, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.852057933807373
Epoch: 53, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.813 Vali Acc: 0.739 Test Loss: 0.813 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8350341320037842
Epoch: 54, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.799 Vali Acc: 0.744 Test Loss: 0.799 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 55 cost time: 0.8829424381256104
Epoch: 55, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.800 Vali Acc: 0.744 Test Loss: 0.800 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8404743671417236
Epoch: 56, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 57 cost time: 0.9195997714996338
Epoch: 57, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.785 Vali Acc: 0.761 Test Loss: 0.785 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 58 cost time: 0.9810934066772461
Epoch: 58, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8337156772613525
Epoch: 59, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.776 Vali Acc: 0.767 Test Loss: 0.776 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 60 cost time: 0.9069483280181885
Epoch: 60, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.785 Vali Acc: 0.772 Test Loss: 0.785 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 61 cost time: 0.865807294845581
Epoch: 61, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9747447967529297
Epoch: 62, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.770 Vali Acc: 0.761 Test Loss: 0.770 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8746387958526611
Epoch: 63, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.781 Vali Acc: 0.767 Test Loss: 0.781 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8776617050170898
Epoch: 64, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.9031369686126709
Epoch: 65, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.771 Vali Acc: 0.772 Test Loss: 0.771 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 66 cost time: 0.7703995704650879
Epoch: 66, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.772 Vali Acc: 0.772 Test Loss: 0.772 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8137614727020264
Epoch: 67, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.774 Vali Acc: 0.767 Test Loss: 0.774 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8323185443878174
Epoch: 68, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.772 Vali Acc: 0.761 Test Loss: 0.772 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8265039920806885
Epoch: 69, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.778 Vali Acc: 0.778 Test Loss: 0.778 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 70 cost time: 0.888115406036377
Epoch: 70, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.774 Vali Acc: 0.772 Test Loss: 0.774 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.800849199295044
Epoch: 71, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.820227861404419
Epoch: 72, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.774 Vali Acc: 0.772 Test Loss: 0.774 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.8561761379241943
Epoch: 73, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 74 cost time: 0.8171341419219971
Epoch: 74, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.82137131690979
Epoch: 75, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.793 Vali Acc: 0.761 Test Loss: 0.793 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8488509654998779
Epoch: 76, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.797 Vali Acc: 0.756 Test Loss: 0.797 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.8755652904510498
Epoch: 77, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.8659765720367432
Epoch: 78, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.784 Vali Acc: 0.761 Test Loss: 0.784 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.83709716796875
Epoch: 79, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.800 Vali Acc: 0.761 Test Loss: 0.800 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.8862712383270264
Epoch: 80, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.797 Vali Acc: 0.761 Test Loss: 0.797 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.8974730968475342
Epoch: 81, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.790 Vali Acc: 0.778 Test Loss: 0.790 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.9555163383483887
Epoch: 82, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.793 Vali Acc: 0.761 Test Loss: 0.793 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.8895509243011475
Epoch: 83, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.811 Vali Acc: 0.772 Test Loss: 0.811 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 22831
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1844658851623535
Epoch: 1, Steps: 12 | Train Loss: 2.894 Vali Loss: 2.756 Vali Acc: 0.061 Test Loss: 2.756 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.8245038986206055
Epoch: 2, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.583 Vali Acc: 0.156 Test Loss: 2.583 Test Acc: 0.156
Validation loss decreased (-0.061084 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 0.8475985527038574
Epoch: 3, Steps: 12 | Train Loss: 2.557 Vali Loss: 2.379 Vali Acc: 0.256 Test Loss: 2.379 Test Acc: 0.256
Validation loss decreased (-0.155530 --> -0.255532).  Saving model ...
Epoch: 4 cost time: 0.884406566619873
Epoch: 4, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.176 Vali Acc: 0.333 Test Loss: 2.176 Test Acc: 0.333
Validation loss decreased (-0.255532 --> -0.333312).  Saving model ...
Epoch: 5 cost time: 0.7796008586883545
Epoch: 5, Steps: 12 | Train Loss: 2.090 Vali Loss: 1.978 Vali Acc: 0.456 Test Loss: 1.978 Test Acc: 0.456
Validation loss decreased (-0.333312 --> -0.455536).  Saving model ...
Epoch: 6 cost time: 0.7935919761657715
Epoch: 6, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.806 Vali Acc: 0.533 Test Loss: 1.806 Test Acc: 0.533
Validation loss decreased (-0.455536 --> -0.533315).  Saving model ...
Epoch: 7 cost time: 0.7934277057647705
Epoch: 7, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.662 Vali Acc: 0.556 Test Loss: 1.662 Test Acc: 0.556
Validation loss decreased (-0.533315 --> -0.555539).  Saving model ...
Epoch: 8 cost time: 0.8114795684814453
Epoch: 8, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.548 Vali Acc: 0.583 Test Loss: 1.548 Test Acc: 0.583
Validation loss decreased (-0.555539 --> -0.583318).  Saving model ...
Epoch: 9 cost time: 0.7543554306030273
Epoch: 9, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.449 Vali Acc: 0.606 Test Loss: 1.449 Test Acc: 0.606
Validation loss decreased (-0.583318 --> -0.605541).  Saving model ...
Epoch: 10 cost time: 0.7848703861236572
Epoch: 10, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.366 Vali Acc: 0.583 Test Loss: 1.366 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7907721996307373
Epoch: 11, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.302 Vali Acc: 0.606 Test Loss: 1.302 Test Acc: 0.606
Validation loss decreased (-0.605541 --> -0.605543).  Saving model ...
Epoch: 12 cost time: 0.8097515106201172
Epoch: 12, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.255 Vali Acc: 0.650 Test Loss: 1.255 Test Acc: 0.650
Validation loss decreased (-0.605543 --> -0.649987).  Saving model ...
Epoch: 13 cost time: 0.7889184951782227
Epoch: 13, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.209 Vali Acc: 0.633 Test Loss: 1.209 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.845407247543335
Epoch: 14, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.192 Vali Acc: 0.633 Test Loss: 1.192 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8410947322845459
Epoch: 15, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.150 Vali Acc: 0.661 Test Loss: 1.150 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661100).  Saving model ...
Epoch: 16 cost time: 0.824211835861206
Epoch: 16, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.109 Vali Acc: 0.644 Test Loss: 1.109 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8231785297393799
Epoch: 17, Steps: 12 | Train Loss: 0.600 Vali Loss: 1.078 Vali Acc: 0.694 Test Loss: 1.078 Test Acc: 0.694
Validation loss decreased (-0.661100 --> -0.694434).  Saving model ...
Epoch: 18 cost time: 0.8167574405670166
Epoch: 18, Steps: 12 | Train Loss: 0.583 Vali Loss: 1.068 Vali Acc: 0.678 Test Loss: 1.068 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7960515022277832
Epoch: 19, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.056 Vali Acc: 0.683 Test Loss: 1.056 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8288247585296631
Epoch: 20, Steps: 12 | Train Loss: 0.468 Vali Loss: 1.015 Vali Acc: 0.706 Test Loss: 1.015 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 21 cost time: 0.8372306823730469
Epoch: 21, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.993 Vali Acc: 0.728 Test Loss: 0.993 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727768).  Saving model ...
Epoch: 22 cost time: 0.7622194290161133
Epoch: 22, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.999 Vali Acc: 0.728 Test Loss: 0.999 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8962843418121338
Epoch: 23, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.984 Vali Acc: 0.733 Test Loss: 0.984 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733323).  Saving model ...
Epoch: 24 cost time: 0.8185877799987793
Epoch: 24, Steps: 12 | Train Loss: 0.324 Vali Loss: 1.000 Vali Acc: 0.722 Test Loss: 1.000 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7874088287353516
Epoch: 25, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8090798854827881
Epoch: 26, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.012 Vali Acc: 0.717 Test Loss: 1.012 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7628812789916992
Epoch: 27, Steps: 12 | Train Loss: 0.247 Vali Loss: 1.003 Vali Acc: 0.728 Test Loss: 1.003 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8260800838470459
Epoch: 28, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.986 Vali Acc: 0.744 Test Loss: 0.986 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 29 cost time: 0.8442623615264893
Epoch: 29, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.008 Vali Acc: 0.733 Test Loss: 1.008 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9176993370056152
Epoch: 30, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.004 Vali Acc: 0.739 Test Loss: 1.004 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8325314521789551
Epoch: 31, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.039 Vali Acc: 0.739 Test Loss: 1.039 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7683014869689941
Epoch: 32, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.054 Vali Acc: 0.711 Test Loss: 1.054 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8942766189575195
Epoch: 33, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.047 Vali Acc: 0.728 Test Loss: 1.047 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8849074840545654
Epoch: 34, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.062 Vali Acc: 0.733 Test Loss: 1.062 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7983670234680176
Epoch: 35, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.081 Vali Acc: 0.728 Test Loss: 1.081 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7780117988586426
Epoch: 36, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.104 Vali Acc: 0.722 Test Loss: 1.104 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8037805557250977
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.105 Vali Acc: 0.756 Test Loss: 1.105 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755545).  Saving model ...
Epoch: 38 cost time: 0.817089319229126
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.116 Vali Acc: 0.744 Test Loss: 1.116 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8865504264831543
Epoch: 39, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.111 Vali Acc: 0.722 Test Loss: 1.111 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9337613582611084
Epoch: 40, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.111 Vali Acc: 0.739 Test Loss: 1.111 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8797321319580078
Epoch: 41, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.142 Vali Acc: 0.739 Test Loss: 1.142 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8240816593170166
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.164 Vali Acc: 0.744 Test Loss: 1.164 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9033157825469971
Epoch: 43, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.180 Vali Acc: 0.728 Test Loss: 1.180 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8086264133453369
Epoch: 44, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.174 Vali Acc: 0.733 Test Loss: 1.174 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7787554264068604
Epoch: 45, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.182 Vali Acc: 0.744 Test Loss: 1.182 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8229324817657471
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.213 Vali Acc: 0.739 Test Loss: 1.213 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8566508293151855
Epoch: 47, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.183 Vali Acc: 0.722 Test Loss: 1.183 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 32463
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3378193378448486
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.691 Vali Acc: 0.089 Test Loss: 2.691 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.8851408958435059
Epoch: 2, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.585 Vali Acc: 0.122 Test Loss: 2.585 Test Acc: 0.122
Validation loss decreased (-0.088862 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 0.7434849739074707
Epoch: 3, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.439 Vali Acc: 0.167 Test Loss: 2.439 Test Acc: 0.167
Validation loss decreased (-0.122196 --> -0.166642).  Saving model ...
Epoch: 4 cost time: 0.746098518371582
Epoch: 4, Steps: 12 | Train Loss: 2.432 Vali Loss: 2.282 Vali Acc: 0.344 Test Loss: 2.282 Test Acc: 0.344
Validation loss decreased (-0.166642 --> -0.344422).  Saving model ...
Epoch: 5 cost time: 0.7604787349700928
Epoch: 5, Steps: 12 | Train Loss: 2.189 Vali Loss: 2.125 Vali Acc: 0.422 Test Loss: 2.125 Test Acc: 0.422
Validation loss decreased (-0.344422 --> -0.422201).  Saving model ...
Epoch: 6 cost time: 0.7289628982543945
Epoch: 6, Steps: 12 | Train Loss: 2.097 Vali Loss: 1.973 Vali Acc: 0.500 Test Loss: 1.973 Test Acc: 0.500
Validation loss decreased (-0.422201 --> -0.499980).  Saving model ...
Epoch: 7 cost time: 0.7535796165466309
Epoch: 7, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.828 Vali Acc: 0.533 Test Loss: 1.828 Test Acc: 0.533
Validation loss decreased (-0.499980 --> -0.533315).  Saving model ...
Epoch: 8 cost time: 0.7385609149932861
Epoch: 8, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.704 Vali Acc: 0.539 Test Loss: 1.704 Test Acc: 0.539
Validation loss decreased (-0.533315 --> -0.538872).  Saving model ...
Epoch: 9 cost time: 0.7649471759796143
Epoch: 9, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.595 Vali Acc: 0.578 Test Loss: 1.595 Test Acc: 0.578
Validation loss decreased (-0.538872 --> -0.577762).  Saving model ...
Epoch: 10 cost time: 0.7679128646850586
Epoch: 10, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.506 Vali Acc: 0.583 Test Loss: 1.506 Test Acc: 0.583
Validation loss decreased (-0.577762 --> -0.583318).  Saving model ...
Epoch: 11 cost time: 0.8391697406768799
Epoch: 11, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.430 Vali Acc: 0.583 Test Loss: 1.430 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 12 cost time: 0.7660186290740967
Epoch: 12, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.365 Vali Acc: 0.600 Test Loss: 1.365 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 0.7756962776184082
Epoch: 13, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.308 Vali Acc: 0.617 Test Loss: 1.308 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 14 cost time: 0.8109462261199951
Epoch: 14, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.268 Vali Acc: 0.622 Test Loss: 1.268 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 15 cost time: 0.789802074432373
Epoch: 15, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.220 Vali Acc: 0.633 Test Loss: 1.220 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 0.8236792087554932
Epoch: 16, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.178 Vali Acc: 0.633 Test Loss: 1.178 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633322).  Saving model ...
Epoch: 17 cost time: 0.8249478340148926
Epoch: 17, Steps: 12 | Train Loss: 0.863 Vali Loss: 1.147 Vali Acc: 0.639 Test Loss: 1.147 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638877).  Saving model ...
Epoch: 18 cost time: 0.8132460117340088
Epoch: 18, Steps: 12 | Train Loss: 0.760 Vali Loss: 1.116 Vali Acc: 0.644 Test Loss: 1.116 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 19 cost time: 0.8163516521453857
Epoch: 19, Steps: 12 | Train Loss: 0.692 Vali Loss: 1.090 Vali Acc: 0.650 Test Loss: 1.090 Test Acc: 0.650
Validation loss decreased (-0.644433 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.8150091171264648
Epoch: 20, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.060 Vali Acc: 0.667 Test Loss: 1.060 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666656).  Saving model ...
Epoch: 21 cost time: 0.849123477935791
Epoch: 21, Steps: 12 | Train Loss: 0.650 Vali Loss: 1.045 Vali Acc: 0.683 Test Loss: 1.045 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683323).  Saving model ...
Epoch: 22 cost time: 0.7453978061676025
Epoch: 22, Steps: 12 | Train Loss: 0.558 Vali Loss: 1.015 Vali Acc: 0.689 Test Loss: 1.015 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 23 cost time: 0.8152525424957275
Epoch: 23, Steps: 12 | Train Loss: 0.506 Vali Loss: 1.009 Vali Acc: 0.678 Test Loss: 1.009 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8258926868438721
Epoch: 24, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.984 Vali Acc: 0.706 Test Loss: 0.984 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 25 cost time: 0.879335880279541
Epoch: 25, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8311648368835449
Epoch: 26, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8121721744537354
Epoch: 27, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.944 Vali Acc: 0.711 Test Loss: 0.944 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 28 cost time: 0.825056791305542
Epoch: 28, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.932 Vali Acc: 0.739 Test Loss: 0.932 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738880).  Saving model ...
Epoch: 29 cost time: 0.7901575565338135
Epoch: 29, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.938 Vali Acc: 0.694 Test Loss: 0.938 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.786212682723999
Epoch: 30, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.932 Vali Acc: 0.694 Test Loss: 0.932 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8756499290466309
Epoch: 31, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.921 Vali Acc: 0.739 Test Loss: 0.921 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 32 cost time: 0.8429980278015137
Epoch: 32, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.921 Vali Acc: 0.733 Test Loss: 0.921 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.844050407409668
Epoch: 33, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.935 Vali Acc: 0.722 Test Loss: 0.935 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7994742393493652
Epoch: 34, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.935 Vali Acc: 0.728 Test Loss: 0.935 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7853741645812988
Epoch: 35, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.926 Vali Acc: 0.739 Test Loss: 0.926 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8201329708099365
Epoch: 36, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.927 Vali Acc: 0.728 Test Loss: 0.927 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9430742263793945
Epoch: 37, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.933 Vali Acc: 0.728 Test Loss: 0.933 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9098896980285645
Epoch: 38, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.952 Vali Acc: 0.728 Test Loss: 0.952 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7851495742797852
Epoch: 39, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.938 Vali Acc: 0.744 Test Loss: 0.938 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744435).  Saving model ...
Epoch: 40 cost time: 0.7777924537658691
Epoch: 40, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8517632484436035
Epoch: 41, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.957 Vali Acc: 0.728 Test Loss: 0.957 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7051165103912354
Epoch: 42, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.954 Vali Acc: 0.728 Test Loss: 0.954 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7841854095458984
Epoch: 43, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.926 Vali Acc: 0.722 Test Loss: 0.926 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8482491970062256
Epoch: 44, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8077738285064697
Epoch: 45, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.954 Vali Acc: 0.733 Test Loss: 0.954 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8259577751159668
Epoch: 46, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.980 Vali Acc: 0.739 Test Loss: 0.980 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8373165130615234
Epoch: 47, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.981 Vali Acc: 0.744 Test Loss: 0.981 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9205813407897949
Epoch: 48, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.989 Vali Acc: 0.733 Test Loss: 0.989 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8771765232086182
Epoch: 49, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.975 Vali Acc: 0.744 Test Loss: 0.975 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 21919
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.403860092163086
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.733 Vali Acc: 0.072 Test Loss: 2.733 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.8160641193389893
Epoch: 2, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.645 Vali Acc: 0.128 Test Loss: 2.645 Test Acc: 0.128
Validation loss decreased (-0.072195 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.8191859722137451
Epoch: 3, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.529 Vali Acc: 0.161 Test Loss: 2.529 Test Acc: 0.161
Validation loss decreased (-0.127751 --> -0.161086).  Saving model ...
Epoch: 4 cost time: 0.785330057144165
Epoch: 4, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.399 Vali Acc: 0.250 Test Loss: 2.399 Test Acc: 0.250
Validation loss decreased (-0.161086 --> -0.249976).  Saving model ...
Epoch: 5 cost time: 0.8096435070037842
Epoch: 5, Steps: 12 | Train Loss: 2.362 Vali Loss: 2.268 Vali Acc: 0.339 Test Loss: 2.268 Test Acc: 0.339
Validation loss decreased (-0.249976 --> -0.338866).  Saving model ...
Epoch: 6 cost time: 0.8511409759521484
Epoch: 6, Steps: 12 | Train Loss: 2.184 Vali Loss: 2.140 Vali Acc: 0.350 Test Loss: 2.140 Test Acc: 0.350
Validation loss decreased (-0.338866 --> -0.349979).  Saving model ...
Epoch: 7 cost time: 0.932805061340332
Epoch: 7, Steps: 12 | Train Loss: 1.994 Vali Loss: 2.018 Vali Acc: 0.400 Test Loss: 2.018 Test Acc: 0.400
Validation loss decreased (-0.349979 --> -0.399980).  Saving model ...
Epoch: 8 cost time: 0.8625364303588867
Epoch: 8, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.891 Vali Acc: 0.439 Test Loss: 1.891 Test Acc: 0.439
Validation loss decreased (-0.399980 --> -0.438870).  Saving model ...
Epoch: 9 cost time: 0.7682905197143555
Epoch: 9, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.787 Vali Acc: 0.461 Test Loss: 1.787 Test Acc: 0.461
Validation loss decreased (-0.438870 --> -0.461093).  Saving model ...
Epoch: 10 cost time: 0.9165377616882324
Epoch: 10, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.701 Vali Acc: 0.450 Test Loss: 1.701 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8131973743438721
Epoch: 11, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.630 Vali Acc: 0.494 Test Loss: 1.630 Test Acc: 0.494
Validation loss decreased (-0.461093 --> -0.494428).  Saving model ...
Epoch: 12 cost time: 0.7890932559967041
Epoch: 12, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.556 Vali Acc: 0.539 Test Loss: 1.556 Test Acc: 0.539
Validation loss decreased (-0.494428 --> -0.538873).  Saving model ...
Epoch: 13 cost time: 1.0074281692504883
Epoch: 13, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.507 Vali Acc: 0.567 Test Loss: 1.507 Test Acc: 0.567
Validation loss decreased (-0.538873 --> -0.566652).  Saving model ...
Epoch: 14 cost time: 0.8964781761169434
Epoch: 14, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.477 Vali Acc: 0.550 Test Loss: 1.477 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.970606803894043
Epoch: 15, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.431 Vali Acc: 0.544 Test Loss: 1.431 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.878424882888794
Epoch: 16, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.392 Vali Acc: 0.567 Test Loss: 1.392 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566653).  Saving model ...
Epoch: 17 cost time: 0.8338606357574463
Epoch: 17, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.357 Vali Acc: 0.578 Test Loss: 1.357 Test Acc: 0.578
Validation loss decreased (-0.566653 --> -0.577764).  Saving model ...
Epoch: 18 cost time: 0.9453215599060059
Epoch: 18, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.339 Vali Acc: 0.583 Test Loss: 1.339 Test Acc: 0.583
Validation loss decreased (-0.577764 --> -0.583320).  Saving model ...
Epoch: 19 cost time: 0.8385615348815918
Epoch: 19, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.300 Vali Acc: 0.594 Test Loss: 1.300 Test Acc: 0.594
Validation loss decreased (-0.583320 --> -0.594431).  Saving model ...
Epoch: 20 cost time: 0.8021717071533203
Epoch: 20, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.289 Vali Acc: 0.611 Test Loss: 1.289 Test Acc: 0.611
Validation loss decreased (-0.594431 --> -0.611098).  Saving model ...
Epoch: 21 cost time: 0.8544681072235107
Epoch: 21, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.261 Vali Acc: 0.617 Test Loss: 1.261 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616654).  Saving model ...
Epoch: 22 cost time: 0.8914394378662109
Epoch: 22, Steps: 12 | Train Loss: 0.756 Vali Loss: 1.232 Vali Acc: 0.639 Test Loss: 1.232 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 23 cost time: 0.9046554565429688
Epoch: 23, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.198 Vali Acc: 0.656 Test Loss: 1.198 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 24 cost time: 0.8601713180541992
Epoch: 24, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.186 Vali Acc: 0.639 Test Loss: 1.186 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8427014350891113
Epoch: 25, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.160 Vali Acc: 0.639 Test Loss: 1.160 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8645839691162109
Epoch: 26, Steps: 12 | Train Loss: 0.573 Vali Loss: 1.128 Vali Acc: 0.656 Test Loss: 1.128 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 27 cost time: 0.8540675640106201
Epoch: 27, Steps: 12 | Train Loss: 0.583 Vali Loss: 1.112 Vali Acc: 0.656 Test Loss: 1.112 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 28 cost time: 0.7996892929077148
Epoch: 28, Steps: 12 | Train Loss: 0.553 Vali Loss: 1.093 Vali Acc: 0.667 Test Loss: 1.093 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 29 cost time: 0.8135435581207275
Epoch: 29, Steps: 12 | Train Loss: 0.494 Vali Loss: 1.064 Vali Acc: 0.656 Test Loss: 1.064 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8883368968963623
Epoch: 30, Steps: 12 | Train Loss: 0.428 Vali Loss: 1.054 Vali Acc: 0.672 Test Loss: 1.054 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 31 cost time: 0.879051685333252
Epoch: 31, Steps: 12 | Train Loss: 0.456 Vali Loss: 1.058 Vali Acc: 0.672 Test Loss: 1.058 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.831951379776001
Epoch: 32, Steps: 12 | Train Loss: 0.390 Vali Loss: 1.039 Vali Acc: 0.683 Test Loss: 1.039 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683323).  Saving model ...
Epoch: 33 cost time: 0.81325364112854
Epoch: 33, Steps: 12 | Train Loss: 0.409 Vali Loss: 1.029 Vali Acc: 0.672 Test Loss: 1.029 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.867809534072876
Epoch: 34, Steps: 12 | Train Loss: 0.387 Vali Loss: 1.018 Vali Acc: 0.689 Test Loss: 1.018 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 35 cost time: 0.7867612838745117
Epoch: 35, Steps: 12 | Train Loss: 0.311 Vali Loss: 1.019 Vali Acc: 0.689 Test Loss: 1.019 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8249068260192871
Epoch: 36, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.008 Vali Acc: 0.689 Test Loss: 1.008 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 37 cost time: 0.8552842140197754
Epoch: 37, Steps: 12 | Train Loss: 0.309 Vali Loss: 1.002 Vali Acc: 0.683 Test Loss: 1.002 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8099143505096436
Epoch: 38, Steps: 12 | Train Loss: 0.290 Vali Loss: 1.002 Vali Acc: 0.706 Test Loss: 1.002 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 39 cost time: 0.903162956237793
Epoch: 39, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.994 Vali Acc: 0.694 Test Loss: 0.994 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7955989837646484
Epoch: 40, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.999 Vali Acc: 0.694 Test Loss: 0.999 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8680453300476074
Epoch: 41, Steps: 12 | Train Loss: 0.248 Vali Loss: 1.018 Vali Acc: 0.694 Test Loss: 1.018 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8553948402404785
Epoch: 42, Steps: 12 | Train Loss: 0.208 Vali Loss: 1.019 Vali Acc: 0.706 Test Loss: 1.019 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9816930294036865
Epoch: 43, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.009 Vali Acc: 0.694 Test Loss: 1.009 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9626286029815674
Epoch: 44, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.001 Vali Acc: 0.706 Test Loss: 1.001 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705546).  Saving model ...
Epoch: 45 cost time: 0.9554109573364258
Epoch: 45, Steps: 12 | Train Loss: 0.203 Vali Loss: 1.006 Vali Acc: 0.717 Test Loss: 1.006 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 46 cost time: 0.9179716110229492
Epoch: 46, Steps: 12 | Train Loss: 0.193 Vali Loss: 1.019 Vali Acc: 0.711 Test Loss: 1.019 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9876577854156494
Epoch: 47, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.019 Vali Acc: 0.728 Test Loss: 1.019 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 48 cost time: 0.7714564800262451
Epoch: 48, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8494281768798828
Epoch: 49, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.011 Vali Acc: 0.728 Test Loss: 1.011 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 50 cost time: 0.9359862804412842
Epoch: 50, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.029 Vali Acc: 0.706 Test Loss: 1.029 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9314053058624268
Epoch: 51, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.042 Vali Acc: 0.722 Test Loss: 1.042 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9579989910125732
Epoch: 52, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.041 Vali Acc: 0.739 Test Loss: 1.041 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738878).  Saving model ...
Epoch: 53 cost time: 0.9696993827819824
Epoch: 53, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.045 Vali Acc: 0.733 Test Loss: 1.045 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9508347511291504
Epoch: 54, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.051 Vali Acc: 0.733 Test Loss: 1.051 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9987490177154541
Epoch: 55, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.072 Vali Acc: 0.733 Test Loss: 1.072 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.958773136138916
Epoch: 56, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.091 Vali Acc: 0.722 Test Loss: 1.091 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9191970825195312
Epoch: 57, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.079 Vali Acc: 0.733 Test Loss: 1.079 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9021191596984863
Epoch: 58, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.081 Vali Acc: 0.728 Test Loss: 1.081 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9580979347229004
Epoch: 59, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.100 Vali Acc: 0.722 Test Loss: 1.100 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.943122148513794
Epoch: 60, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.097 Vali Acc: 0.728 Test Loss: 1.097 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.9062507152557373
Epoch: 61, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.109 Vali Acc: 0.733 Test Loss: 1.109 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.9149725437164307
Epoch: 62, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.106 Vali Acc: 0.728 Test Loss: 1.106 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 21455
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.354827404022217
Epoch: 1, Steps: 12 | Train Loss: 2.876 Vali Loss: 2.829 Vali Acc: 0.050 Test Loss: 2.829 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 0.8542094230651855
Epoch: 2, Steps: 12 | Train Loss: 2.785 Vali Loss: 2.735 Vali Acc: 0.078 Test Loss: 2.735 Test Acc: 0.078
Validation loss decreased (-0.049972 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 0.8225250244140625
Epoch: 3, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.620 Vali Acc: 0.128 Test Loss: 2.620 Test Acc: 0.128
Validation loss decreased (-0.077750 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 0.7878141403198242
Epoch: 4, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.487 Vali Acc: 0.189 Test Loss: 2.487 Test Acc: 0.189
Validation loss decreased (-0.127752 --> -0.188864).  Saving model ...
Epoch: 5 cost time: 0.8091413974761963
Epoch: 5, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.354 Vali Acc: 0.272 Test Loss: 2.354 Test Acc: 0.272
Validation loss decreased (-0.188864 --> -0.272199).  Saving model ...
Epoch: 6 cost time: 0.9017984867095947
Epoch: 6, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.220 Vali Acc: 0.361 Test Loss: 2.220 Test Acc: 0.361
Validation loss decreased (-0.272199 --> -0.361089).  Saving model ...
Epoch: 7 cost time: 0.7848656177520752
Epoch: 7, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.098 Vali Acc: 0.411 Test Loss: 2.098 Test Acc: 0.411
Validation loss decreased (-0.361089 --> -0.411090).  Saving model ...
Epoch: 8 cost time: 0.7928216457366943
Epoch: 8, Steps: 12 | Train Loss: 1.991 Vali Loss: 1.979 Vali Acc: 0.428 Test Loss: 1.979 Test Acc: 0.428
Validation loss decreased (-0.411090 --> -0.427758).  Saving model ...
Epoch: 9 cost time: 0.7941179275512695
Epoch: 9, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.876 Vali Acc: 0.467 Test Loss: 1.876 Test Acc: 0.467
Validation loss decreased (-0.427758 --> -0.466648).  Saving model ...
Epoch: 10 cost time: 0.8143084049224854
Epoch: 10, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.788 Vali Acc: 0.472 Test Loss: 1.788 Test Acc: 0.472
Validation loss decreased (-0.466648 --> -0.472204).  Saving model ...
Epoch: 11 cost time: 0.8523833751678467
Epoch: 11, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.705 Vali Acc: 0.494 Test Loss: 1.705 Test Acc: 0.494
Validation loss decreased (-0.472204 --> -0.494427).  Saving model ...
Epoch: 12 cost time: 0.7447021007537842
Epoch: 12, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.639 Vali Acc: 0.511 Test Loss: 1.639 Test Acc: 0.511
Validation loss decreased (-0.494427 --> -0.511095).  Saving model ...
Epoch: 13 cost time: 0.8650374412536621
Epoch: 13, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.579 Vali Acc: 0.544 Test Loss: 1.579 Test Acc: 0.544
Validation loss decreased (-0.511095 --> -0.544429).  Saving model ...
Epoch: 14 cost time: 0.9029810428619385
Epoch: 14, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.525 Vali Acc: 0.561 Test Loss: 1.525 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561096).  Saving model ...
Epoch: 15 cost time: 0.6882455348968506
Epoch: 15, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.474 Vali Acc: 0.578 Test Loss: 1.474 Test Acc: 0.578
Validation loss decreased (-0.561096 --> -0.577763).  Saving model ...
Epoch: 16 cost time: 0.7727780342102051
Epoch: 16, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.412 Vali Acc: 0.578 Test Loss: 1.412 Test Acc: 0.578
Validation loss decreased (-0.577763 --> -0.577764).  Saving model ...
Epoch: 17 cost time: 0.7992870807647705
Epoch: 17, Steps: 12 | Train Loss: 1.090 Vali Loss: 1.381 Vali Acc: 0.606 Test Loss: 1.381 Test Acc: 0.606
Validation loss decreased (-0.577764 --> -0.605542).  Saving model ...
Epoch: 18 cost time: 0.7866308689117432
Epoch: 18, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.356 Vali Acc: 0.617 Test Loss: 1.356 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616653).  Saving model ...
Epoch: 19 cost time: 0.8293249607086182
Epoch: 19, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.317 Vali Acc: 0.633 Test Loss: 1.317 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 0.7354657649993896
Epoch: 20, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.287 Vali Acc: 0.656 Test Loss: 1.287 Test Acc: 0.656
Validation loss decreased (-0.633320 --> -0.655543).  Saving model ...
Epoch: 21 cost time: 0.7310528755187988
Epoch: 21, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.267 Vali Acc: 0.661 Test Loss: 1.267 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661098).  Saving model ...
Epoch: 22 cost time: 0.7199161052703857
Epoch: 22, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.252 Vali Acc: 0.672 Test Loss: 1.252 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672210).  Saving model ...
Epoch: 23 cost time: 0.7834889888763428
Epoch: 23, Steps: 12 | Train Loss: 0.825 Vali Loss: 1.226 Vali Acc: 0.689 Test Loss: 1.226 Test Acc: 0.689
Validation loss decreased (-0.672210 --> -0.688877).  Saving model ...
Epoch: 24 cost time: 0.8265471458435059
Epoch: 24, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.210 Vali Acc: 0.683 Test Loss: 1.210 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7242231369018555
Epoch: 25, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.182 Vali Acc: 0.689 Test Loss: 1.182 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 26 cost time: 0.8031325340270996
Epoch: 26, Steps: 12 | Train Loss: 0.756 Vali Loss: 1.168 Vali Acc: 0.694 Test Loss: 1.168 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694433).  Saving model ...
Epoch: 27 cost time: 0.8107142448425293
Epoch: 27, Steps: 12 | Train Loss: 0.721 Vali Loss: 1.152 Vali Acc: 0.711 Test Loss: 1.152 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711100).  Saving model ...
Epoch: 28 cost time: 0.820955753326416
Epoch: 28, Steps: 12 | Train Loss: 0.650 Vali Loss: 1.131 Vali Acc: 0.700 Test Loss: 1.131 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7891733646392822
Epoch: 29, Steps: 12 | Train Loss: 0.618 Vali Loss: 1.114 Vali Acc: 0.694 Test Loss: 1.114 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.721186637878418
Epoch: 30, Steps: 12 | Train Loss: 0.586 Vali Loss: 1.094 Vali Acc: 0.711 Test Loss: 1.094 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711100).  Saving model ...
Epoch: 31 cost time: 0.8630707263946533
Epoch: 31, Steps: 12 | Train Loss: 0.577 Vali Loss: 1.075 Vali Acc: 0.717 Test Loss: 1.075 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716656).  Saving model ...
Epoch: 32 cost time: 0.7916259765625
Epoch: 32, Steps: 12 | Train Loss: 0.536 Vali Loss: 1.066 Vali Acc: 0.739 Test Loss: 1.066 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738878).  Saving model ...
Epoch: 33 cost time: 0.7691595554351807
Epoch: 33, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.042 Vali Acc: 0.733 Test Loss: 1.042 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7593870162963867
Epoch: 34, Steps: 12 | Train Loss: 0.494 Vali Loss: 1.032 Vali Acc: 0.733 Test Loss: 1.032 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7527585029602051
Epoch: 35, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.014 Vali Acc: 0.739 Test Loss: 1.014 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738879).  Saving model ...
Epoch: 36 cost time: 0.7451016902923584
Epoch: 36, Steps: 12 | Train Loss: 0.446 Vali Loss: 1.006 Vali Acc: 0.744 Test Loss: 1.006 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744434).  Saving model ...
Epoch: 37 cost time: 0.8134641647338867
Epoch: 37, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.990 Vali Acc: 0.744 Test Loss: 0.990 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744435).  Saving model ...
Epoch: 38 cost time: 0.8019371032714844
Epoch: 38, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.986 Vali Acc: 0.733 Test Loss: 0.986 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8283088207244873
Epoch: 39, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.998 Vali Acc: 0.722 Test Loss: 0.998 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.795539140701294
Epoch: 40, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.969 Vali Acc: 0.744 Test Loss: 0.969 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 41 cost time: 0.7824358940124512
Epoch: 41, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.961 Vali Acc: 0.739 Test Loss: 0.961 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7480223178863525
Epoch: 42, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.967 Vali Acc: 0.739 Test Loss: 0.967 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7625782489776611
Epoch: 43, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.977 Vali Acc: 0.744 Test Loss: 0.977 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7727439403533936
Epoch: 44, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.962 Vali Acc: 0.744 Test Loss: 0.962 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 45 cost time: 0.7891974449157715
Epoch: 45, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.969 Vali Acc: 0.750 Test Loss: 0.969 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 46 cost time: 0.8137271404266357
Epoch: 46, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.961 Vali Acc: 0.744 Test Loss: 0.961 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7574231624603271
Epoch: 47, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.961 Vali Acc: 0.750 Test Loss: 0.961 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 48 cost time: 0.7450933456420898
Epoch: 48, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 49 cost time: 0.805713415145874
Epoch: 49, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.973 Vali Acc: 0.756 Test Loss: 0.973 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 50 cost time: 0.7950224876403809
Epoch: 50, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.957 Vali Acc: 0.756 Test Loss: 0.957 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 51 cost time: 0.801912784576416
Epoch: 51, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.942 Vali Acc: 0.756 Test Loss: 0.942 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 52 cost time: 0.7942624092102051
Epoch: 52, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.807687520980835
Epoch: 53, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.962 Vali Acc: 0.750 Test Loss: 0.962 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9076731204986572
Epoch: 54, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.971 Vali Acc: 0.756 Test Loss: 0.971 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8059201240539551
Epoch: 55, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.974 Vali Acc: 0.756 Test Loss: 0.974 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.7950949668884277
Epoch: 56, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.8072614669799805
Epoch: 57, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.7737607955932617
Epoch: 58, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.988 Vali Acc: 0.761 Test Loss: 0.988 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761101).  Saving model ...
Epoch: 59 cost time: 0.7561626434326172
Epoch: 59, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7721965312957764
Epoch: 60, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.984 Vali Acc: 0.756 Test Loss: 0.984 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7493863105773926
Epoch: 61, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.004 Vali Acc: 0.756 Test Loss: 1.004 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8045089244842529
Epoch: 62, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.001 Vali Acc: 0.744 Test Loss: 1.001 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.7349765300750732
Epoch: 63, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.991 Vali Acc: 0.761 Test Loss: 0.991 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.751460075378418
Epoch: 64, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.999 Vali Acc: 0.767 Test Loss: 0.999 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766657).  Saving model ...
Epoch: 65 cost time: 0.7487156391143799
Epoch: 65, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.015 Vali Acc: 0.739 Test Loss: 1.015 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8304281234741211
Epoch: 66, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.009 Vali Acc: 0.767 Test Loss: 1.009 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7604203224182129
Epoch: 67, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.014 Vali Acc: 0.756 Test Loss: 1.014 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7740902900695801
Epoch: 68, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.023 Vali Acc: 0.750 Test Loss: 1.023 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.7857785224914551
Epoch: 69, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.041 Vali Acc: 0.761 Test Loss: 1.041 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.8360183238983154
Epoch: 70, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.050 Vali Acc: 0.756 Test Loss: 1.050 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.8002901077270508
Epoch: 71, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.051 Vali Acc: 0.761 Test Loss: 1.051 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.788276195526123
Epoch: 72, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.049 Vali Acc: 0.772 Test Loss: 1.049 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772212).  Saving model ...
Epoch: 73 cost time: 0.7650737762451172
Epoch: 73, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.050 Vali Acc: 0.761 Test Loss: 1.050 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.8448412418365479
Epoch: 74, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.044 Vali Acc: 0.761 Test Loss: 1.044 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.7442550659179688
Epoch: 75, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.057 Vali Acc: 0.756 Test Loss: 1.057 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.7355995178222656
Epoch: 76, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.057 Vali Acc: 0.772 Test Loss: 1.057 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.8318724632263184
Epoch: 77, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.053 Vali Acc: 0.778 Test Loss: 1.053 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777767).  Saving model ...
Epoch: 78 cost time: 0.7810404300689697
Epoch: 78, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.086 Vali Acc: 0.767 Test Loss: 1.086 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.741936206817627
Epoch: 79, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.096 Vali Acc: 0.750 Test Loss: 1.096 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.7831211090087891
Epoch: 80, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.074 Vali Acc: 0.767 Test Loss: 1.074 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.7480041980743408
Epoch: 81, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.088 Vali Acc: 0.750 Test Loss: 1.088 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.7320895195007324
Epoch: 82, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.076 Vali Acc: 0.756 Test Loss: 1.076 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.7715306282043457
Epoch: 83, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.090 Vali Acc: 0.767 Test Loss: 1.090 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.7812252044677734
Epoch: 84, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.110 Vali Acc: 0.744 Test Loss: 1.110 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.8903734683990479
Epoch: 85, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.103 Vali Acc: 0.772 Test Loss: 1.103 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.7899961471557617
Epoch: 86, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.100 Vali Acc: 0.767 Test Loss: 1.100 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.823725700378418
Epoch: 87, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.111 Vali Acc: 0.739 Test Loss: 1.111 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 18111
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.235989570617676
Epoch: 1, Steps: 12 | Train Loss: 2.933 Vali Loss: 2.802 Vali Acc: 0.039 Test Loss: 2.802 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 0.7548224925994873
Epoch: 2, Steps: 12 | Train Loss: 2.959 Vali Loss: 2.748 Vali Acc: 0.061 Test Loss: 2.748 Test Acc: 0.061
Validation loss decreased (-0.038861 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 0.7611181735992432
Epoch: 3, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.660 Vali Acc: 0.067 Test Loss: 2.660 Test Acc: 0.067
Validation loss decreased (-0.061084 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 0.7368323802947998
Epoch: 4, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.556 Vali Acc: 0.161 Test Loss: 2.556 Test Acc: 0.161
Validation loss decreased (-0.066640 --> -0.161086).  Saving model ...
Epoch: 5 cost time: 0.751654863357544
Epoch: 5, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.444 Vali Acc: 0.233 Test Loss: 2.444 Test Acc: 0.233
Validation loss decreased (-0.161086 --> -0.233309).  Saving model ...
Epoch: 6 cost time: 0.7165975570678711
Epoch: 6, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.328 Vali Acc: 0.317 Test Loss: 2.328 Test Acc: 0.317
Validation loss decreased (-0.233309 --> -0.316643).  Saving model ...
Epoch: 7 cost time: 0.7810368537902832
Epoch: 7, Steps: 12 | Train Loss: 2.309 Vali Loss: 2.219 Vali Acc: 0.356 Test Loss: 2.219 Test Acc: 0.356
Validation loss decreased (-0.316643 --> -0.355533).  Saving model ...
Epoch: 8 cost time: 0.7668585777282715
Epoch: 8, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.115 Vali Acc: 0.394 Test Loss: 2.115 Test Acc: 0.394
Validation loss decreased (-0.355533 --> -0.394423).  Saving model ...
Epoch: 9 cost time: 0.8563611507415771
Epoch: 9, Steps: 12 | Train Loss: 2.040 Vali Loss: 2.014 Vali Acc: 0.417 Test Loss: 2.014 Test Acc: 0.417
Validation loss decreased (-0.394423 --> -0.416647).  Saving model ...
Epoch: 10 cost time: 0.7785897254943848
Epoch: 10, Steps: 12 | Train Loss: 1.985 Vali Loss: 1.925 Vali Acc: 0.439 Test Loss: 1.925 Test Acc: 0.439
Validation loss decreased (-0.416647 --> -0.438870).  Saving model ...
Epoch: 11 cost time: 0.8070855140686035
Epoch: 11, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.842 Vali Acc: 0.456 Test Loss: 1.842 Test Acc: 0.456
Validation loss decreased (-0.438870 --> -0.455537).  Saving model ...
Epoch: 12 cost time: 0.8387055397033691
Epoch: 12, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.764 Vali Acc: 0.500 Test Loss: 1.764 Test Acc: 0.500
Validation loss decreased (-0.455537 --> -0.499982).  Saving model ...
Epoch: 13 cost time: 0.7474732398986816
Epoch: 13, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.692 Vali Acc: 0.528 Test Loss: 1.692 Test Acc: 0.528
Validation loss decreased (-0.499982 --> -0.527761).  Saving model ...
Epoch: 14 cost time: 0.8229296207427979
Epoch: 14, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.640 Vali Acc: 0.517 Test Loss: 1.640 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.805537223815918
Epoch: 15, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.582 Vali Acc: 0.556 Test Loss: 1.582 Test Acc: 0.556
Validation loss decreased (-0.527761 --> -0.555540).  Saving model ...
Epoch: 16 cost time: 0.8385510444641113
Epoch: 16, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.527 Vali Acc: 0.561 Test Loss: 1.527 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561096).  Saving model ...
Epoch: 17 cost time: 0.7354505062103271
Epoch: 17, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.482 Vali Acc: 0.589 Test Loss: 1.482 Test Acc: 0.589
Validation loss decreased (-0.561096 --> -0.588874).  Saving model ...
Epoch: 18 cost time: 0.7448995113372803
Epoch: 18, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.445 Vali Acc: 0.594 Test Loss: 1.445 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594430).  Saving model ...
Epoch: 19 cost time: 0.7753903865814209
Epoch: 19, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.400 Vali Acc: 0.606 Test Loss: 1.400 Test Acc: 0.606
Validation loss decreased (-0.594430 --> -0.605542).  Saving model ...
Epoch: 20 cost time: 0.7560060024261475
Epoch: 20, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.362 Vali Acc: 0.611 Test Loss: 1.362 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611097).  Saving model ...
Epoch: 21 cost time: 0.7516224384307861
Epoch: 21, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.325 Vali Acc: 0.622 Test Loss: 1.325 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 22 cost time: 0.7500154972076416
Epoch: 22, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.295 Vali Acc: 0.622 Test Loss: 1.295 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622209).  Saving model ...
Epoch: 23 cost time: 0.7581672668457031
Epoch: 23, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.276 Vali Acc: 0.622 Test Loss: 1.276 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622209).  Saving model ...
Epoch: 24 cost time: 0.766319751739502
Epoch: 24, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.239 Vali Acc: 0.628 Test Loss: 1.239 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 25 cost time: 0.7972393035888672
Epoch: 25, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.212 Vali Acc: 0.633 Test Loss: 1.212 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 26 cost time: 0.7304661273956299
Epoch: 26, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.186 Vali Acc: 0.639 Test Loss: 1.186 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 27 cost time: 0.7700667381286621
Epoch: 27, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.152 Vali Acc: 0.661 Test Loss: 1.152 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 28 cost time: 0.8086845874786377
Epoch: 28, Steps: 12 | Train Loss: 0.753 Vali Loss: 1.129 Vali Acc: 0.650 Test Loss: 1.129 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.830604076385498
Epoch: 29, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.113 Vali Acc: 0.672 Test Loss: 1.113 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672211).  Saving model ...
Epoch: 30 cost time: 0.7136526107788086
Epoch: 30, Steps: 12 | Train Loss: 0.660 Vali Loss: 1.094 Vali Acc: 0.672 Test Loss: 1.094 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 31 cost time: 0.7932348251342773
Epoch: 31, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.068 Vali Acc: 0.672 Test Loss: 1.068 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672212).  Saving model ...
Epoch: 32 cost time: 0.7284986972808838
Epoch: 32, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.059 Vali Acc: 0.683 Test Loss: 1.059 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683323).  Saving model ...
Epoch: 33 cost time: 0.7991483211517334
Epoch: 33, Steps: 12 | Train Loss: 0.638 Vali Loss: 1.038 Vali Acc: 0.689 Test Loss: 1.038 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 34 cost time: 0.8503868579864502
Epoch: 34, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.020 Vali Acc: 0.683 Test Loss: 1.020 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8081121444702148
Epoch: 35, Steps: 12 | Train Loss: 0.582 Vali Loss: 1.007 Vali Acc: 0.700 Test Loss: 1.007 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 36 cost time: 0.80645751953125
Epoch: 36, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.999 Vali Acc: 0.700 Test Loss: 0.999 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 37 cost time: 0.7680423259735107
Epoch: 37, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.981 Vali Acc: 0.722 Test Loss: 0.981 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722212).  Saving model ...
Epoch: 38 cost time: 0.81180739402771
Epoch: 38, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.979 Vali Acc: 0.722 Test Loss: 0.979 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 39 cost time: 0.7762589454650879
Epoch: 39, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.968 Vali Acc: 0.733 Test Loss: 0.968 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 40 cost time: 0.7789204120635986
Epoch: 40, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.940 Vali Acc: 0.733 Test Loss: 0.940 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 41 cost time: 0.8274490833282471
Epoch: 41, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 42 cost time: 0.8079748153686523
Epoch: 42, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.903 Vali Acc: 0.744 Test Loss: 0.903 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 43 cost time: 0.7672755718231201
Epoch: 43, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.900 Vali Acc: 0.744 Test Loss: 0.900 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 44 cost time: 0.7468729019165039
Epoch: 44, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.888 Vali Acc: 0.761 Test Loss: 0.888 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761102).  Saving model ...
Epoch: 45 cost time: 0.8227319717407227
Epoch: 45, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.869 Vali Acc: 0.744 Test Loss: 0.869 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8504805564880371
Epoch: 46, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.865 Vali Acc: 0.744 Test Loss: 0.865 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8135702610015869
Epoch: 47, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8341302871704102
Epoch: 48, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.845 Vali Acc: 0.767 Test Loss: 0.845 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 49 cost time: 0.8169865608215332
Epoch: 49, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.838 Vali Acc: 0.756 Test Loss: 0.838 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8144359588623047
Epoch: 50, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.836 Vali Acc: 0.761 Test Loss: 0.836 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8032145500183105
Epoch: 51, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.836 Vali Acc: 0.761 Test Loss: 0.836 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7470123767852783
Epoch: 52, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.842 Vali Acc: 0.756 Test Loss: 0.842 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7271280288696289
Epoch: 53, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.845 Vali Acc: 0.761 Test Loss: 0.845 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7499825954437256
Epoch: 54, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.846 Vali Acc: 0.756 Test Loss: 0.846 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.7980737686157227
Epoch: 55, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.827 Vali Acc: 0.756 Test Loss: 0.827 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.7574396133422852
Epoch: 56, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.819 Vali Acc: 0.756 Test Loss: 0.819 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7706592082977295
Epoch: 57, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.828 Vali Acc: 0.761 Test Loss: 0.828 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.7930965423583984
Epoch: 58, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.823 Vali Acc: 0.767 Test Loss: 0.823 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766658).  Saving model ...
Epoch: 59 cost time: 0.7891247272491455
Epoch: 59, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.821 Vali Acc: 0.761 Test Loss: 0.821 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7753505706787109
Epoch: 60, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.821 Vali Acc: 0.756 Test Loss: 0.821 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7874400615692139
Epoch: 61, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.7910292148590088
Epoch: 62, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.821 Vali Acc: 0.756 Test Loss: 0.821 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.9052059650421143
Epoch: 63, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.8798434734344482
Epoch: 64, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.828 Vali Acc: 0.767 Test Loss: 0.828 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.8413276672363281
Epoch: 65, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.828 Vali Acc: 0.778 Test Loss: 0.828 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777769).  Saving model ...
Epoch: 66 cost time: 0.7971792221069336
Epoch: 66, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.835 Vali Acc: 0.767 Test Loss: 0.835 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8135607242584229
Epoch: 67, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.837 Vali Acc: 0.761 Test Loss: 0.837 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8260540962219238
Epoch: 68, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.838 Vali Acc: 0.744 Test Loss: 0.838 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7778222560882568
Epoch: 69, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.8189480304718018
Epoch: 70, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.836 Vali Acc: 0.756 Test Loss: 0.836 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.7941813468933105
Epoch: 71, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8100368976593018
Epoch: 72, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.818 Vali Acc: 0.761 Test Loss: 0.818 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.8338813781738281
Epoch: 73, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.833 Vali Acc: 0.761 Test Loss: 0.833 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.834000825881958
Epoch: 74, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.8775219917297363
Epoch: 75, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 16223
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2530434131622314
Epoch: 1, Steps: 12 | Train Loss: 2.854 Vali Loss: 2.766 Vali Acc: 0.156 Test Loss: 2.766 Test Acc: 0.156
Validation loss decreased (inf --> -0.155528).  Saving model ...
Epoch: 2 cost time: 0.8640322685241699
Epoch: 2, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.700 Vali Acc: 0.189 Test Loss: 2.700 Test Acc: 0.189
Validation loss decreased (-0.155528 --> -0.188862).  Saving model ...
Epoch: 3 cost time: 0.8447666168212891
Epoch: 3, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.616 Vali Acc: 0.233 Test Loss: 2.616 Test Acc: 0.233
Validation loss decreased (-0.188862 --> -0.233307).  Saving model ...
Epoch: 4 cost time: 0.8512506484985352
Epoch: 4, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.522 Vali Acc: 0.267 Test Loss: 2.522 Test Acc: 0.267
Validation loss decreased (-0.233307 --> -0.266641).  Saving model ...
Epoch: 5 cost time: 0.8436136245727539
Epoch: 5, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.430 Vali Acc: 0.278 Test Loss: 2.430 Test Acc: 0.278
Validation loss decreased (-0.266641 --> -0.277753).  Saving model ...
Epoch: 6 cost time: 0.7758660316467285
Epoch: 6, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.329 Vali Acc: 0.317 Test Loss: 2.329 Test Acc: 0.317
Validation loss decreased (-0.277753 --> -0.316643).  Saving model ...
Epoch: 7 cost time: 0.8202521800994873
Epoch: 7, Steps: 12 | Train Loss: 2.306 Vali Loss: 2.229 Vali Acc: 0.367 Test Loss: 2.229 Test Acc: 0.367
Validation loss decreased (-0.316643 --> -0.366644).  Saving model ...
Epoch: 8 cost time: 0.8359911441802979
Epoch: 8, Steps: 12 | Train Loss: 2.182 Vali Loss: 2.135 Vali Acc: 0.383 Test Loss: 2.135 Test Acc: 0.383
Validation loss decreased (-0.366644 --> -0.383312).  Saving model ...
Epoch: 9 cost time: 0.8349325656890869
Epoch: 9, Steps: 12 | Train Loss: 2.069 Vali Loss: 2.045 Vali Acc: 0.367 Test Loss: 2.045 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8589482307434082
Epoch: 10, Steps: 12 | Train Loss: 1.999 Vali Loss: 1.957 Vali Acc: 0.422 Test Loss: 1.957 Test Acc: 0.422
Validation loss decreased (-0.383312 --> -0.422203).  Saving model ...
Epoch: 11 cost time: 0.8252480030059814
Epoch: 11, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.869 Vali Acc: 0.433 Test Loss: 1.869 Test Acc: 0.433
Validation loss decreased (-0.422203 --> -0.433315).  Saving model ...
Epoch: 12 cost time: 0.8538622856140137
Epoch: 12, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.784 Vali Acc: 0.450 Test Loss: 1.784 Test Acc: 0.450
Validation loss decreased (-0.433315 --> -0.449982).  Saving model ...
Epoch: 13 cost time: 0.8172404766082764
Epoch: 13, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.717 Vali Acc: 0.478 Test Loss: 1.717 Test Acc: 0.478
Validation loss decreased (-0.449982 --> -0.477761).  Saving model ...
Epoch: 14 cost time: 0.7804892063140869
Epoch: 14, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.647 Vali Acc: 0.506 Test Loss: 1.647 Test Acc: 0.506
Validation loss decreased (-0.477761 --> -0.505539).  Saving model ...
Epoch: 15 cost time: 0.8879847526550293
Epoch: 15, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.580 Vali Acc: 0.528 Test Loss: 1.580 Test Acc: 0.528
Validation loss decreased (-0.505539 --> -0.527762).  Saving model ...
Epoch: 16 cost time: 0.8229002952575684
Epoch: 16, Steps: 12 | Train Loss: 1.394 Vali Loss: 1.524 Vali Acc: 0.539 Test Loss: 1.524 Test Acc: 0.539
Validation loss decreased (-0.527762 --> -0.538874).  Saving model ...
Epoch: 17 cost time: 0.827653169631958
Epoch: 17, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.462 Vali Acc: 0.533 Test Loss: 1.462 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8072924613952637
Epoch: 18, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.403 Vali Acc: 0.572 Test Loss: 1.403 Test Acc: 0.572
Validation loss decreased (-0.538874 --> -0.572208).  Saving model ...
Epoch: 19 cost time: 0.8557054996490479
Epoch: 19, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.345 Vali Acc: 0.550 Test Loss: 1.345 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7863776683807373
Epoch: 20, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.293 Vali Acc: 0.583 Test Loss: 1.293 Test Acc: 0.583
Validation loss decreased (-0.572208 --> -0.583320).  Saving model ...
Epoch: 21 cost time: 0.7589824199676514
Epoch: 21, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.247 Vali Acc: 0.594 Test Loss: 1.247 Test Acc: 0.594
Validation loss decreased (-0.583320 --> -0.594432).  Saving model ...
Epoch: 22 cost time: 0.781531572341919
Epoch: 22, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.210 Vali Acc: 0.606 Test Loss: 1.210 Test Acc: 0.606
Validation loss decreased (-0.594432 --> -0.605543).  Saving model ...
Epoch: 23 cost time: 0.7529127597808838
Epoch: 23, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.170 Vali Acc: 0.617 Test Loss: 1.170 Test Acc: 0.617
Validation loss decreased (-0.605543 --> -0.616655).  Saving model ...
Epoch: 24 cost time: 0.7725627422332764
Epoch: 24, Steps: 12 | Train Loss: 0.913 Vali Loss: 1.147 Vali Acc: 0.622 Test Loss: 1.147 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622211).  Saving model ...
Epoch: 25 cost time: 0.731285572052002
Epoch: 25, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.112 Vali Acc: 0.628 Test Loss: 1.112 Test Acc: 0.628
Validation loss decreased (-0.622211 --> -0.627767).  Saving model ...
Epoch: 26 cost time: 0.7243554592132568
Epoch: 26, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.083 Vali Acc: 0.639 Test Loss: 1.083 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638878).  Saving model ...
Epoch: 27 cost time: 0.7927966117858887
Epoch: 27, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.059 Vali Acc: 0.628 Test Loss: 1.059 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.754035234451294
Epoch: 28, Steps: 12 | Train Loss: 0.745 Vali Loss: 1.034 Vali Acc: 0.644 Test Loss: 1.034 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644434).  Saving model ...
Epoch: 29 cost time: 0.7978489398956299
Epoch: 29, Steps: 12 | Train Loss: 0.755 Vali Loss: 1.012 Vali Acc: 0.661 Test Loss: 1.012 Test Acc: 0.661
Validation loss decreased (-0.644434 --> -0.661101).  Saving model ...
Epoch: 30 cost time: 0.7789602279663086
Epoch: 30, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.997 Vali Acc: 0.678 Test Loss: 0.997 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 31 cost time: 0.7719733715057373
Epoch: 31, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.973 Vali Acc: 0.678 Test Loss: 0.973 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 32 cost time: 0.7485346794128418
Epoch: 32, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.955 Vali Acc: 0.672 Test Loss: 0.955 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7774462699890137
Epoch: 33, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.948 Vali Acc: 0.694 Test Loss: 0.948 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 34 cost time: 0.7930693626403809
Epoch: 34, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.935 Vali Acc: 0.678 Test Loss: 0.935 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8023278713226318
Epoch: 35, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.921 Vali Acc: 0.700 Test Loss: 0.921 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 36 cost time: 0.7330615520477295
Epoch: 36, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.915 Vali Acc: 0.694 Test Loss: 0.915 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7596049308776855
Epoch: 37, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.900 Vali Acc: 0.706 Test Loss: 0.900 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 38 cost time: 0.8320603370666504
Epoch: 38, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.883 Vali Acc: 0.706 Test Loss: 0.883 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 39 cost time: 0.756547212600708
Epoch: 39, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.876 Vali Acc: 0.706 Test Loss: 0.876 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 40 cost time: 0.7887279987335205
Epoch: 40, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7849252223968506
Epoch: 41, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.863 Vali Acc: 0.711 Test Loss: 0.863 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711102).  Saving model ...
Epoch: 42 cost time: 0.7488365173339844
Epoch: 42, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.849 Vali Acc: 0.733 Test Loss: 0.849 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 43 cost time: 0.7766032218933105
Epoch: 43, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.842 Vali Acc: 0.728 Test Loss: 0.842 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7427213191986084
Epoch: 44, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.844 Vali Acc: 0.733 Test Loss: 0.844 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 45 cost time: 0.7658538818359375
Epoch: 45, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.843 Vali Acc: 0.733 Test Loss: 0.843 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 46 cost time: 0.7701971530914307
Epoch: 46, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6979835033416748
Epoch: 47, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.836 Vali Acc: 0.733 Test Loss: 0.836 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 48 cost time: 0.7856795787811279
Epoch: 48, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.836 Vali Acc: 0.733 Test Loss: 0.836 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8212993144989014
Epoch: 49, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.819 Vali Acc: 0.739 Test Loss: 0.819 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 50 cost time: 0.7846450805664062
Epoch: 50, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744436).  Saving model ...
Epoch: 51 cost time: 0.7294154167175293
Epoch: 51, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.815 Vali Acc: 0.744 Test Loss: 0.815 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7962245941162109
Epoch: 52, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 53 cost time: 0.7417194843292236
Epoch: 53, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.821 Vali Acc: 0.756 Test Loss: 0.821 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 54 cost time: 0.6254477500915527
Epoch: 54, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.804 Vali Acc: 0.761 Test Loss: 0.804 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 55 cost time: 0.7572207450866699
Epoch: 55, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.805 Vali Acc: 0.767 Test Loss: 0.805 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 56 cost time: 0.843001127243042
Epoch: 56, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.805 Vali Acc: 0.756 Test Loss: 0.805 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7610175609588623
Epoch: 57, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.804 Vali Acc: 0.756 Test Loss: 0.804 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.749765157699585
Epoch: 58, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.810 Vali Acc: 0.739 Test Loss: 0.810 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8378019332885742
Epoch: 59, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7655527591705322
Epoch: 60, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.809 Vali Acc: 0.739 Test Loss: 0.809 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7796626091003418
Epoch: 61, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.820 Vali Acc: 0.739 Test Loss: 0.820 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7873964309692383
Epoch: 62, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.7446684837341309
Epoch: 63, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.7972667217254639
Epoch: 64, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.829 Vali Acc: 0.761 Test Loss: 0.829 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.669499397277832
Epoch: 65, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.834 Vali Acc: 0.767 Test Loss: 0.834 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 15295
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.056870460510254
Epoch: 1, Steps: 12 | Train Loss: 2.867 Vali Loss: 2.805 Vali Acc: 0.139 Test Loss: 2.805 Test Acc: 0.139
Validation loss decreased (inf --> -0.138861).  Saving model ...
Epoch: 2 cost time: 0.7114081382751465
Epoch: 2, Steps: 12 | Train Loss: 2.783 Vali Loss: 2.766 Vali Acc: 0.139 Test Loss: 2.766 Test Acc: 0.139
Validation loss decreased (-0.138861 --> -0.138861).  Saving model ...
Epoch: 3 cost time: 0.7076930999755859
Epoch: 3, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.702 Vali Acc: 0.150 Test Loss: 2.702 Test Acc: 0.150
Validation loss decreased (-0.138861 --> -0.149973).  Saving model ...
Epoch: 4 cost time: 0.716684103012085
Epoch: 4, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.625 Vali Acc: 0.200 Test Loss: 2.625 Test Acc: 0.200
Validation loss decreased (-0.149973 --> -0.199974).  Saving model ...
Epoch: 5 cost time: 0.7682662010192871
Epoch: 5, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.538 Vali Acc: 0.233 Test Loss: 2.538 Test Acc: 0.233
Validation loss decreased (-0.199974 --> -0.233308).  Saving model ...
Epoch: 6 cost time: 0.7671222686767578
Epoch: 6, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.447 Vali Acc: 0.283 Test Loss: 2.447 Test Acc: 0.283
Validation loss decreased (-0.233308 --> -0.283309).  Saving model ...
Epoch: 7 cost time: 0.7092876434326172
Epoch: 7, Steps: 12 | Train Loss: 2.333 Vali Loss: 2.354 Vali Acc: 0.344 Test Loss: 2.354 Test Acc: 0.344
Validation loss decreased (-0.283309 --> -0.344421).  Saving model ...
Epoch: 8 cost time: 0.684192419052124
Epoch: 8, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.261 Vali Acc: 0.389 Test Loss: 2.261 Test Acc: 0.389
Validation loss decreased (-0.344421 --> -0.388866).  Saving model ...
Epoch: 9 cost time: 0.7494931221008301
Epoch: 9, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.174 Vali Acc: 0.433 Test Loss: 2.174 Test Acc: 0.433
Validation loss decreased (-0.388866 --> -0.433312).  Saving model ...
Epoch: 10 cost time: 0.7204873561859131
Epoch: 10, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.091 Vali Acc: 0.467 Test Loss: 2.091 Test Acc: 0.467
Validation loss decreased (-0.433312 --> -0.466646).  Saving model ...
Epoch: 11 cost time: 0.7415807247161865
Epoch: 11, Steps: 12 | Train Loss: 1.981 Vali Loss: 2.009 Vali Acc: 0.483 Test Loss: 2.009 Test Acc: 0.483
Validation loss decreased (-0.466646 --> -0.483313).  Saving model ...
Epoch: 12 cost time: 0.7723195552825928
Epoch: 12, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.940 Vali Acc: 0.494 Test Loss: 1.940 Test Acc: 0.494
Validation loss decreased (-0.483313 --> -0.494425).  Saving model ...
Epoch: 13 cost time: 0.7014822959899902
Epoch: 13, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.877 Vali Acc: 0.506 Test Loss: 1.877 Test Acc: 0.506
Validation loss decreased (-0.494425 --> -0.505537).  Saving model ...
Epoch: 14 cost time: 0.7061071395874023
Epoch: 14, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.816 Vali Acc: 0.533 Test Loss: 1.816 Test Acc: 0.533
Validation loss decreased (-0.505537 --> -0.533315).  Saving model ...
Epoch: 15 cost time: 0.7439045906066895
Epoch: 15, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.763 Vali Acc: 0.528 Test Loss: 1.763 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7413434982299805
Epoch: 16, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.709 Vali Acc: 0.533 Test Loss: 1.709 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533316).  Saving model ...
Epoch: 17 cost time: 0.6957888603210449
Epoch: 17, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.663 Vali Acc: 0.528 Test Loss: 1.663 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8418910503387451
Epoch: 18, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.616 Vali Acc: 0.544 Test Loss: 1.616 Test Acc: 0.544
Validation loss decreased (-0.533316 --> -0.544428).  Saving model ...
Epoch: 19 cost time: 0.7862834930419922
Epoch: 19, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.570 Vali Acc: 0.550 Test Loss: 1.570 Test Acc: 0.550
Validation loss decreased (-0.544428 --> -0.549984).  Saving model ...
Epoch: 20 cost time: 0.6948418617248535
Epoch: 20, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.519 Vali Acc: 0.578 Test Loss: 1.519 Test Acc: 0.578
Validation loss decreased (-0.549984 --> -0.577763).  Saving model ...
Epoch: 21 cost time: 0.617642879486084
Epoch: 21, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.479 Vali Acc: 0.583 Test Loss: 1.479 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 22 cost time: 0.6594889163970947
Epoch: 22, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.443 Vali Acc: 0.589 Test Loss: 1.443 Test Acc: 0.589
Validation loss decreased (-0.583319 --> -0.588874).  Saving model ...
Epoch: 23 cost time: 0.6910879611968994
Epoch: 23, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.410 Vali Acc: 0.589 Test Loss: 1.410 Test Acc: 0.589
Validation loss decreased (-0.588874 --> -0.588875).  Saving model ...
Epoch: 24 cost time: 0.7001941204071045
Epoch: 24, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.363 Vali Acc: 0.606 Test Loss: 1.363 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605542).  Saving model ...
Epoch: 25 cost time: 0.7174570560455322
Epoch: 25, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.325 Vali Acc: 0.611 Test Loss: 1.325 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 26 cost time: 0.7169685363769531
Epoch: 26, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.290 Vali Acc: 0.611 Test Loss: 1.290 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 27 cost time: 0.6530983448028564
Epoch: 27, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.252 Vali Acc: 0.611 Test Loss: 1.252 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611099).  Saving model ...
Epoch: 28 cost time: 0.696042537689209
Epoch: 28, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.212 Vali Acc: 0.617 Test Loss: 1.212 Test Acc: 0.617
Validation loss decreased (-0.611099 --> -0.616655).  Saving model ...
Epoch: 29 cost time: 0.7221930027008057
Epoch: 29, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.178 Vali Acc: 0.628 Test Loss: 1.178 Test Acc: 0.628
Validation loss decreased (-0.616655 --> -0.627766).  Saving model ...
Epoch: 30 cost time: 0.8005983829498291
Epoch: 30, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.150 Vali Acc: 0.622 Test Loss: 1.150 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8340380191802979
Epoch: 31, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.128 Vali Acc: 0.611 Test Loss: 1.128 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7374050617218018
Epoch: 32, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.096 Vali Acc: 0.633 Test Loss: 1.096 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633322).  Saving model ...
Epoch: 33 cost time: 0.772092342376709
Epoch: 33, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.067 Vali Acc: 0.656 Test Loss: 1.067 Test Acc: 0.656
Validation loss decreased (-0.633322 --> -0.655545).  Saving model ...
Epoch: 34 cost time: 0.8284382820129395
Epoch: 34, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.058 Vali Acc: 0.644 Test Loss: 1.058 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7696120738983154
Epoch: 35, Steps: 12 | Train Loss: 0.757 Vali Loss: 1.034 Vali Acc: 0.656 Test Loss: 1.034 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 36 cost time: 0.7983312606811523
Epoch: 36, Steps: 12 | Train Loss: 0.726 Vali Loss: 1.023 Vali Acc: 0.650 Test Loss: 1.023 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7813289165496826
Epoch: 37, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.001 Vali Acc: 0.656 Test Loss: 1.001 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655546).  Saving model ...
Epoch: 38 cost time: 0.7493178844451904
Epoch: 38, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.976 Vali Acc: 0.678 Test Loss: 0.976 Test Acc: 0.678
Validation loss decreased (-0.655546 --> -0.677768).  Saving model ...
Epoch: 39 cost time: 0.71822190284729
Epoch: 39, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.965 Vali Acc: 0.678 Test Loss: 0.965 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 40 cost time: 0.7490379810333252
Epoch: 40, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.953 Vali Acc: 0.694 Test Loss: 0.953 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 41 cost time: 0.7186837196350098
Epoch: 41, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.931 Vali Acc: 0.694 Test Loss: 0.931 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 42 cost time: 0.7735490798950195
Epoch: 42, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.926 Vali Acc: 0.683 Test Loss: 0.926 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7614998817443848
Epoch: 43, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.923 Vali Acc: 0.700 Test Loss: 0.923 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 44 cost time: 0.745067834854126
Epoch: 44, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.916 Vali Acc: 0.700 Test Loss: 0.916 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 45 cost time: 0.8093616962432861
Epoch: 45, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.911 Vali Acc: 0.694 Test Loss: 0.911 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7553069591522217
Epoch: 46, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.902 Vali Acc: 0.694 Test Loss: 0.902 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7909107208251953
Epoch: 47, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.896 Vali Acc: 0.722 Test Loss: 0.896 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722213).  Saving model ...
Epoch: 48 cost time: 0.7613465785980225
Epoch: 48, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.889 Vali Acc: 0.711 Test Loss: 0.889 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7193014621734619
Epoch: 49, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.880 Vali Acc: 0.706 Test Loss: 0.880 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6999237537384033
Epoch: 50, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.861 Vali Acc: 0.722 Test Loss: 0.861 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 51 cost time: 0.6841518878936768
Epoch: 51, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 52 cost time: 0.7818844318389893
Epoch: 52, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.843 Vali Acc: 0.728 Test Loss: 0.843 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727769).  Saving model ...
Epoch: 53 cost time: 0.745729923248291
Epoch: 53, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.841 Vali Acc: 0.728 Test Loss: 0.841 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 54 cost time: 0.7389488220214844
Epoch: 54, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.833 Vali Acc: 0.722 Test Loss: 0.833 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8029766082763672
Epoch: 55, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.843 Vali Acc: 0.722 Test Loss: 0.843 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8295750617980957
Epoch: 56, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.846 Vali Acc: 0.717 Test Loss: 0.846 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7606902122497559
Epoch: 57, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.8439509868621826
Epoch: 58, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.836 Vali Acc: 0.728 Test Loss: 0.836 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 59 cost time: 0.7968494892120361
Epoch: 59, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.827 Vali Acc: 0.744 Test Loss: 0.827 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 60 cost time: 0.7569034099578857
Epoch: 60, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.73537278175354
Epoch: 61, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.825 Vali Acc: 0.728 Test Loss: 0.825 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.740471601486206
Epoch: 62, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.7553701400756836
Epoch: 63, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.816 Vali Acc: 0.744 Test Loss: 0.816 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 64 cost time: 0.7518970966339111
Epoch: 64, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.810 Vali Acc: 0.733 Test Loss: 0.810 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7532055377960205
Epoch: 65, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.7285315990447998
Epoch: 66, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.811 Vali Acc: 0.744 Test Loss: 0.811 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 67 cost time: 0.7441949844360352
Epoch: 67, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 68 cost time: 0.7388637065887451
Epoch: 68, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 69 cost time: 0.8051187992095947
Epoch: 69, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.807 Vali Acc: 0.744 Test Loss: 0.807 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7521121501922607
Epoch: 70, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.821 Vali Acc: 0.750 Test Loss: 0.821 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.7749502658843994
Epoch: 71, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.827 Vali Acc: 0.739 Test Loss: 0.827 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7844722270965576
Epoch: 72, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.7789261341094971
Epoch: 73, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.817 Vali Acc: 0.744 Test Loss: 0.817 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.7807285785675049
Epoch: 74, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.823 Vali Acc: 0.744 Test Loss: 0.823 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.7176992893218994
Epoch: 75, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 76 cost time: 0.7812128067016602
Epoch: 76, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7754883766174316
Epoch: 77, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.7440307140350342
Epoch: 78, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 79 cost time: 0.7710545063018799
Epoch: 79, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.7955751419067383
Epoch: 80, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.808 Vali Acc: 0.744 Test Loss: 0.808 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.7421789169311523
Epoch: 81, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.7483422756195068
Epoch: 82, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.6909897327423096
Epoch: 83, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.820 Vali Acc: 0.744 Test Loss: 0.820 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.8138232231140137
Epoch: 84, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.7908217906951904
Epoch: 85, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.829 Vali Acc: 0.739 Test Loss: 0.829 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.7845425605773926
Epoch: 86, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.8248779773712158
Epoch: 87, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.8979442119598389
Epoch: 88, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.825 Vali Acc: 0.761 Test Loss: 0.825 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 14383
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.265367031097412
Epoch: 1, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.645 Vali Acc: 0.117 Test Loss: 2.645 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.8340353965759277
Epoch: 2, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.469 Vali Acc: 0.233 Test Loss: 2.469 Test Acc: 0.233
Validation loss decreased (-0.116640 --> -0.233309).  Saving model ...
Epoch: 3 cost time: 0.8582406044006348
Epoch: 3, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.273 Vali Acc: 0.306 Test Loss: 2.273 Test Acc: 0.306
Validation loss decreased (-0.233309 --> -0.305533).  Saving model ...
Epoch: 4 cost time: 0.7842297554016113
Epoch: 4, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.080 Vali Acc: 0.411 Test Loss: 2.080 Test Acc: 0.411
Validation loss decreased (-0.305533 --> -0.411090).  Saving model ...
Epoch: 5 cost time: 0.8633131980895996
Epoch: 5, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.913 Vali Acc: 0.467 Test Loss: 1.913 Test Acc: 0.467
Validation loss decreased (-0.411090 --> -0.466648).  Saving model ...
Epoch: 6 cost time: 0.7506558895111084
Epoch: 6, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.765 Vali Acc: 0.511 Test Loss: 1.765 Test Acc: 0.511
Validation loss decreased (-0.466648 --> -0.511093).  Saving model ...
Epoch: 7 cost time: 0.7828631401062012
Epoch: 7, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.636 Vali Acc: 0.550 Test Loss: 1.636 Test Acc: 0.550
Validation loss decreased (-0.511093 --> -0.549984).  Saving model ...
Epoch: 8 cost time: 0.8173635005950928
Epoch: 8, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.537 Vali Acc: 0.578 Test Loss: 1.537 Test Acc: 0.578
Validation loss decreased (-0.549984 --> -0.577762).  Saving model ...
Epoch: 9 cost time: 0.8119485378265381
Epoch: 9, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.441 Vali Acc: 0.572 Test Loss: 1.441 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.863044023513794
Epoch: 10, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.386 Vali Acc: 0.572 Test Loss: 1.386 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8721072673797607
Epoch: 11, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.333 Vali Acc: 0.589 Test Loss: 1.333 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588876).  Saving model ...
Epoch: 12 cost time: 0.8011972904205322
Epoch: 12, Steps: 12 | Train Loss: 0.973 Vali Loss: 1.278 Vali Acc: 0.589 Test Loss: 1.278 Test Acc: 0.589
Validation loss decreased (-0.588876 --> -0.588876).  Saving model ...
Epoch: 13 cost time: 0.8186917304992676
Epoch: 13, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.244 Vali Acc: 0.633 Test Loss: 1.244 Test Acc: 0.633
Validation loss decreased (-0.588876 --> -0.633321).  Saving model ...
Epoch: 14 cost time: 0.8544294834136963
Epoch: 14, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.216 Vali Acc: 0.644 Test Loss: 1.216 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644432).  Saving model ...
Epoch: 15 cost time: 0.7856972217559814
Epoch: 15, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.168 Vali Acc: 0.622 Test Loss: 1.168 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8651509284973145
Epoch: 16, Steps: 12 | Train Loss: 0.719 Vali Loss: 1.149 Vali Acc: 0.656 Test Loss: 1.149 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 17 cost time: 0.86421799659729
Epoch: 17, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.114 Vali Acc: 0.683 Test Loss: 1.114 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683322).  Saving model ...
Epoch: 18 cost time: 0.8255205154418945
Epoch: 18, Steps: 12 | Train Loss: 0.619 Vali Loss: 1.095 Vali Acc: 0.661 Test Loss: 1.095 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8128712177276611
Epoch: 19, Steps: 12 | Train Loss: 0.525 Vali Loss: 1.054 Vali Acc: 0.689 Test Loss: 1.054 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 20 cost time: 0.8757002353668213
Epoch: 20, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.064 Vali Acc: 0.689 Test Loss: 1.064 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8627884387969971
Epoch: 21, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.990 Vali Acc: 0.744 Test Loss: 0.990 Test Acc: 0.744
Validation loss decreased (-0.688878 --> -0.744435).  Saving model ...
Epoch: 22 cost time: 0.838747501373291
Epoch: 22, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.998 Vali Acc: 0.733 Test Loss: 0.998 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8111960887908936
Epoch: 23, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.986 Vali Acc: 0.739 Test Loss: 0.986 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9079766273498535
Epoch: 24, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.988 Vali Acc: 0.744 Test Loss: 0.988 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 25 cost time: 0.8041033744812012
Epoch: 25, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.981 Vali Acc: 0.744 Test Loss: 0.981 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 26 cost time: 0.7671241760253906
Epoch: 26, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8034379482269287
Epoch: 27, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.990 Vali Acc: 0.739 Test Loss: 0.990 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8944036960601807
Epoch: 28, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.959 Vali Acc: 0.767 Test Loss: 0.959 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766657).  Saving model ...
Epoch: 29 cost time: 0.8111279010772705
Epoch: 29, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.974 Vali Acc: 0.733 Test Loss: 0.974 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8009343147277832
Epoch: 30, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.985 Vali Acc: 0.750 Test Loss: 0.985 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.843071699142456
Epoch: 31, Steps: 12 | Train Loss: 0.201 Vali Loss: 1.005 Vali Acc: 0.722 Test Loss: 1.005 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7362873554229736
Epoch: 32, Steps: 12 | Train Loss: 0.191 Vali Loss: 1.014 Vali Acc: 0.733 Test Loss: 1.014 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7655832767486572
Epoch: 33, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.008 Vali Acc: 0.744 Test Loss: 1.008 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7660822868347168
Epoch: 34, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.996 Vali Acc: 0.756 Test Loss: 0.996 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7870738506317139
Epoch: 35, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.031 Vali Acc: 0.728 Test Loss: 1.031 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7831013202667236
Epoch: 36, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.046 Vali Acc: 0.722 Test Loss: 1.046 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.811821699142456
Epoch: 37, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.039 Vali Acc: 0.733 Test Loss: 1.039 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.808849573135376
Epoch: 38, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.045 Vali Acc: 0.744 Test Loss: 1.045 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 28239
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.374265432357788
Epoch: 1, Steps: 12 | Train Loss: 2.924 Vali Loss: 2.871 Vali Acc: 0.006 Test Loss: 2.871 Test Acc: 0.006
Validation loss decreased (inf --> -0.005527).  Saving model ...
Epoch: 2 cost time: 0.7913074493408203
Epoch: 2, Steps: 12 | Train Loss: 2.874 Vali Loss: 2.724 Vali Acc: 0.039 Test Loss: 2.724 Test Acc: 0.039
Validation loss decreased (-0.005527 --> -0.038862).  Saving model ...
Epoch: 3 cost time: 0.8382878303527832
Epoch: 3, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.558 Vali Acc: 0.167 Test Loss: 2.558 Test Acc: 0.167
Validation loss decreased (-0.038862 --> -0.166641).  Saving model ...
Epoch: 4 cost time: 0.9115467071533203
Epoch: 4, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.392 Vali Acc: 0.328 Test Loss: 2.392 Test Acc: 0.328
Validation loss decreased (-0.166641 --> -0.327754).  Saving model ...
Epoch: 5 cost time: 0.8200209140777588
Epoch: 5, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.230 Vali Acc: 0.394 Test Loss: 2.230 Test Acc: 0.394
Validation loss decreased (-0.327754 --> -0.394422).  Saving model ...
Epoch: 6 cost time: 0.8934428691864014
Epoch: 6, Steps: 12 | Train Loss: 2.188 Vali Loss: 2.078 Vali Acc: 0.483 Test Loss: 2.078 Test Acc: 0.483
Validation loss decreased (-0.394422 --> -0.483313).  Saving model ...
Epoch: 7 cost time: 0.8829283714294434
Epoch: 7, Steps: 12 | Train Loss: 2.067 Vali Loss: 1.947 Vali Acc: 0.472 Test Loss: 1.947 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.967432975769043
Epoch: 8, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.819 Vali Acc: 0.494 Test Loss: 1.819 Test Acc: 0.494
Validation loss decreased (-0.483313 --> -0.494426).  Saving model ...
Epoch: 9 cost time: 0.9439687728881836
Epoch: 9, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.716 Vali Acc: 0.522 Test Loss: 1.716 Test Acc: 0.522
Validation loss decreased (-0.494426 --> -0.522205).  Saving model ...
Epoch: 10 cost time: 0.7932033538818359
Epoch: 10, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.635 Vali Acc: 0.539 Test Loss: 1.635 Test Acc: 0.539
Validation loss decreased (-0.522205 --> -0.538873).  Saving model ...
Epoch: 11 cost time: 0.7960939407348633
Epoch: 11, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.552 Vali Acc: 0.556 Test Loss: 1.552 Test Acc: 0.556
Validation loss decreased (-0.538873 --> -0.555540).  Saving model ...
Epoch: 12 cost time: 0.8506608009338379
Epoch: 12, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.487 Vali Acc: 0.567 Test Loss: 1.487 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566652).  Saving model ...
Epoch: 13 cost time: 0.7454569339752197
Epoch: 13, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.434 Vali Acc: 0.594 Test Loss: 1.434 Test Acc: 0.594
Validation loss decreased (-0.566652 --> -0.594430).  Saving model ...
Epoch: 14 cost time: 0.753375768661499
Epoch: 14, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.387 Vali Acc: 0.594 Test Loss: 1.387 Test Acc: 0.594
Validation loss decreased (-0.594430 --> -0.594431).  Saving model ...
Epoch: 15 cost time: 0.7385737895965576
Epoch: 15, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.360 Vali Acc: 0.617 Test Loss: 1.360 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616653).  Saving model ...
Epoch: 16 cost time: 0.8245511054992676
Epoch: 16, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.314 Vali Acc: 0.617 Test Loss: 1.314 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 17 cost time: 0.7792079448699951
Epoch: 17, Steps: 12 | Train Loss: 0.984 Vali Loss: 1.299 Vali Acc: 0.628 Test Loss: 1.299 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627765).  Saving model ...
Epoch: 18 cost time: 0.794813871383667
Epoch: 18, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.259 Vali Acc: 0.622 Test Loss: 1.259 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7601797580718994
Epoch: 19, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.235 Vali Acc: 0.644 Test Loss: 1.235 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644432).  Saving model ...
Epoch: 20 cost time: 0.7740790843963623
Epoch: 20, Steps: 12 | Train Loss: 0.784 Vali Loss: 1.214 Vali Acc: 0.644 Test Loss: 1.214 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 21 cost time: 0.806626558303833
Epoch: 21, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.198 Vali Acc: 0.644 Test Loss: 1.198 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 22 cost time: 0.7880868911743164
Epoch: 22, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.165 Vali Acc: 0.661 Test Loss: 1.165 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 23 cost time: 0.7681689262390137
Epoch: 23, Steps: 12 | Train Loss: 0.690 Vali Loss: 1.145 Vali Acc: 0.672 Test Loss: 1.145 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 24 cost time: 0.7721705436706543
Epoch: 24, Steps: 12 | Train Loss: 0.650 Vali Loss: 1.132 Vali Acc: 0.678 Test Loss: 1.132 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677766).  Saving model ...
Epoch: 25 cost time: 0.7976477146148682
Epoch: 25, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7756917476654053
Epoch: 26, Steps: 12 | Train Loss: 0.563 Vali Loss: 1.103 Vali Acc: 0.667 Test Loss: 1.103 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7413113117218018
Epoch: 27, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.077 Vali Acc: 0.683 Test Loss: 1.077 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683323).  Saving model ...
Epoch: 28 cost time: 0.7749900817871094
Epoch: 28, Steps: 12 | Train Loss: 0.471 Vali Loss: 1.057 Vali Acc: 0.678 Test Loss: 1.057 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8398480415344238
Epoch: 29, Steps: 12 | Train Loss: 0.460 Vali Loss: 1.048 Vali Acc: 0.683 Test Loss: 1.048 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 30 cost time: 0.7852494716644287
Epoch: 30, Steps: 12 | Train Loss: 0.424 Vali Loss: 1.047 Vali Acc: 0.711 Test Loss: 1.047 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 31 cost time: 0.8267481327056885
Epoch: 31, Steps: 12 | Train Loss: 0.425 Vali Loss: 1.030 Vali Acc: 0.728 Test Loss: 1.030 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727767).  Saving model ...
Epoch: 32 cost time: 0.8022317886352539
Epoch: 32, Steps: 12 | Train Loss: 0.415 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733323).  Saving model ...
Epoch: 33 cost time: 0.8001949787139893
Epoch: 33, Steps: 12 | Train Loss: 0.340 Vali Loss: 1.022 Vali Acc: 0.728 Test Loss: 1.022 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7319726943969727
Epoch: 34, Steps: 12 | Train Loss: 0.341 Vali Loss: 1.021 Vali Acc: 0.733 Test Loss: 1.021 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 35 cost time: 0.794748067855835
Epoch: 35, Steps: 12 | Train Loss: 0.341 Vali Loss: 1.007 Vali Acc: 0.744 Test Loss: 1.007 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744434).  Saving model ...
Epoch: 36 cost time: 0.9078705310821533
Epoch: 36, Steps: 12 | Train Loss: 0.283 Vali Loss: 1.013 Vali Acc: 0.733 Test Loss: 1.013 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8416433334350586
Epoch: 37, Steps: 12 | Train Loss: 0.307 Vali Loss: 1.013 Vali Acc: 0.733 Test Loss: 1.013 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7704367637634277
Epoch: 38, Steps: 12 | Train Loss: 0.263 Vali Loss: 1.005 Vali Acc: 0.728 Test Loss: 1.005 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7708842754364014
Epoch: 39, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.000 Vali Acc: 0.739 Test Loss: 1.000 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7829320430755615
Epoch: 40, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8548450469970703
Epoch: 41, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.013 Vali Acc: 0.744 Test Loss: 1.013 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7233462333679199
Epoch: 42, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.028 Vali Acc: 0.728 Test Loss: 1.028 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7561030387878418
Epoch: 43, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.031 Vali Acc: 0.722 Test Loss: 1.031 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7889223098754883
Epoch: 44, Steps: 12 | Train Loss: 0.190 Vali Loss: 1.026 Vali Acc: 0.722 Test Loss: 1.026 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7894752025604248
Epoch: 45, Steps: 12 | Train Loss: 0.201 Vali Loss: 1.023 Vali Acc: 0.733 Test Loss: 1.023 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 17695
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.445307731628418
Epoch: 1, Steps: 12 | Train Loss: 2.867 Vali Loss: 2.771 Vali Acc: 0.061 Test Loss: 2.771 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 0.7720232009887695
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.681 Vali Acc: 0.117 Test Loss: 2.681 Test Acc: 0.117
Validation loss decreased (-0.061083 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 0.8331315517425537
Epoch: 3, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.554 Vali Acc: 0.178 Test Loss: 2.554 Test Acc: 0.178
Validation loss decreased (-0.116640 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 0.7278487682342529
Epoch: 4, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.406 Vali Acc: 0.244 Test Loss: 2.406 Test Acc: 0.244
Validation loss decreased (-0.177752 --> -0.244420).  Saving model ...
Epoch: 5 cost time: 0.8262264728546143
Epoch: 5, Steps: 12 | Train Loss: 2.409 Vali Loss: 2.262 Vali Acc: 0.350 Test Loss: 2.262 Test Acc: 0.350
Validation loss decreased (-0.244420 --> -0.349977).  Saving model ...
Epoch: 6 cost time: 0.7205071449279785
Epoch: 6, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.127 Vali Acc: 0.422 Test Loss: 2.127 Test Acc: 0.422
Validation loss decreased (-0.349977 --> -0.422201).  Saving model ...
Epoch: 7 cost time: 0.7891364097595215
Epoch: 7, Steps: 12 | Train Loss: 2.004 Vali Loss: 1.996 Vali Acc: 0.444 Test Loss: 1.996 Test Acc: 0.444
Validation loss decreased (-0.422201 --> -0.444424).  Saving model ...
Epoch: 8 cost time: 0.7264614105224609
Epoch: 8, Steps: 12 | Train Loss: 1.937 Vali Loss: 1.867 Vali Acc: 0.511 Test Loss: 1.867 Test Acc: 0.511
Validation loss decreased (-0.444424 --> -0.511092).  Saving model ...
Epoch: 9 cost time: 0.7639937400817871
Epoch: 9, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.766 Vali Acc: 0.539 Test Loss: 1.766 Test Acc: 0.539
Validation loss decreased (-0.511092 --> -0.538871).  Saving model ...
Epoch: 10 cost time: 0.7595925331115723
Epoch: 10, Steps: 12 | Train Loss: 1.603 Vali Loss: 1.667 Vali Acc: 0.578 Test Loss: 1.667 Test Acc: 0.578
Validation loss decreased (-0.538871 --> -0.577761).  Saving model ...
Epoch: 11 cost time: 0.7488508224487305
Epoch: 11, Steps: 12 | Train Loss: 1.475 Vali Loss: 1.590 Vali Acc: 0.600 Test Loss: 1.590 Test Acc: 0.600
Validation loss decreased (-0.577761 --> -0.599984).  Saving model ...
Epoch: 12 cost time: 0.8193411827087402
Epoch: 12, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.518 Vali Acc: 0.606 Test Loss: 1.518 Test Acc: 0.606
Validation loss decreased (-0.599984 --> -0.605540).  Saving model ...
Epoch: 13 cost time: 0.8182740211486816
Epoch: 13, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.458 Vali Acc: 0.594 Test Loss: 1.458 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7893774509429932
Epoch: 14, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.421 Vali Acc: 0.600 Test Loss: 1.421 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7589461803436279
Epoch: 15, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.382 Vali Acc: 0.594 Test Loss: 1.382 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.741248369216919
Epoch: 16, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.350 Vali Acc: 0.628 Test Loss: 1.350 Test Acc: 0.628
Validation loss decreased (-0.605540 --> -0.627764).  Saving model ...
Epoch: 17 cost time: 0.7583596706390381
Epoch: 17, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.310 Vali Acc: 0.639 Test Loss: 1.310 Test Acc: 0.639
Validation loss decreased (-0.627764 --> -0.638876).  Saving model ...
Epoch: 18 cost time: 0.8066952228546143
Epoch: 18, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.294 Vali Acc: 0.644 Test Loss: 1.294 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 19 cost time: 0.7682626247406006
Epoch: 19, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.254 Vali Acc: 0.656 Test Loss: 1.254 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655543).  Saving model ...
Epoch: 20 cost time: 0.7274308204650879
Epoch: 20, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.223 Vali Acc: 0.650 Test Loss: 1.223 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7933015823364258
Epoch: 21, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.201 Vali Acc: 0.678 Test Loss: 1.201 Test Acc: 0.678
Validation loss decreased (-0.655543 --> -0.677766).  Saving model ...
Epoch: 22 cost time: 0.7529926300048828
Epoch: 22, Steps: 12 | Train Loss: 0.734 Vali Loss: 1.206 Vali Acc: 0.672 Test Loss: 1.206 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7905919551849365
Epoch: 23, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.186 Vali Acc: 0.672 Test Loss: 1.186 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8078014850616455
Epoch: 24, Steps: 12 | Train Loss: 0.664 Vali Loss: 1.168 Vali Acc: 0.672 Test Loss: 1.168 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.813145637512207
Epoch: 25, Steps: 12 | Train Loss: 0.624 Vali Loss: 1.148 Vali Acc: 0.700 Test Loss: 1.148 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699989).  Saving model ...
Epoch: 26 cost time: 0.786005973815918
Epoch: 26, Steps: 12 | Train Loss: 0.590 Vali Loss: 1.127 Vali Acc: 0.711 Test Loss: 1.127 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711100).  Saving model ...
Epoch: 27 cost time: 0.759331226348877
Epoch: 27, Steps: 12 | Train Loss: 0.559 Vali Loss: 1.100 Vali Acc: 0.694 Test Loss: 1.100 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7898726463317871
Epoch: 28, Steps: 12 | Train Loss: 0.527 Vali Loss: 1.082 Vali Acc: 0.678 Test Loss: 1.082 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7489056587219238
Epoch: 29, Steps: 12 | Train Loss: 0.500 Vali Loss: 1.086 Vali Acc: 0.694 Test Loss: 1.086 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7372739315032959
Epoch: 30, Steps: 12 | Train Loss: 0.498 Vali Loss: 1.080 Vali Acc: 0.700 Test Loss: 1.080 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8234405517578125
Epoch: 31, Steps: 12 | Train Loss: 0.469 Vali Loss: 1.066 Vali Acc: 0.706 Test Loss: 1.066 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8173091411590576
Epoch: 32, Steps: 12 | Train Loss: 0.432 Vali Loss: 1.030 Vali Acc: 0.728 Test Loss: 1.030 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727767).  Saving model ...
Epoch: 33 cost time: 0.7437732219696045
Epoch: 33, Steps: 12 | Train Loss: 0.422 Vali Loss: 1.022 Vali Acc: 0.733 Test Loss: 1.022 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733323).  Saving model ...
Epoch: 34 cost time: 0.7524352073669434
Epoch: 34, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.991 Vali Acc: 0.739 Test Loss: 0.991 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 35 cost time: 0.7365164756774902
Epoch: 35, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.991 Vali Acc: 0.756 Test Loss: 0.991 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 36 cost time: 0.7939443588256836
Epoch: 36, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.979 Vali Acc: 0.744 Test Loss: 0.979 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7495236396789551
Epoch: 37, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.789639949798584
Epoch: 38, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.968 Vali Acc: 0.744 Test Loss: 0.968 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8053231239318848
Epoch: 39, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.959 Vali Acc: 0.744 Test Loss: 0.959 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7096848487854004
Epoch: 40, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.950 Vali Acc: 0.744 Test Loss: 0.950 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.716778039932251
Epoch: 41, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.956 Vali Acc: 0.744 Test Loss: 0.956 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7815265655517578
Epoch: 42, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.961 Vali Acc: 0.744 Test Loss: 0.961 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7594590187072754
Epoch: 43, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.962 Vali Acc: 0.744 Test Loss: 0.962 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7706830501556396
Epoch: 44, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.984 Vali Acc: 0.744 Test Loss: 0.984 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7333652973175049
Epoch: 45, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.982 Vali Acc: 0.761 Test Loss: 0.982 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761101).  Saving model ...
Epoch: 46 cost time: 0.738682746887207
Epoch: 46, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.984 Vali Acc: 0.733 Test Loss: 0.984 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7825381755828857
Epoch: 47, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.985 Vali Acc: 0.750 Test Loss: 0.985 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8910748958587646
Epoch: 48, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.990 Vali Acc: 0.761 Test Loss: 0.990 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7505753040313721
Epoch: 49, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.985 Vali Acc: 0.767 Test Loss: 0.985 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766657).  Saving model ...
Epoch: 50 cost time: 0.7681214809417725
Epoch: 50, Steps: 12 | Train Loss: 0.164 Vali Loss: 1.015 Vali Acc: 0.722 Test Loss: 1.015 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7225923538208008
Epoch: 51, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.017 Vali Acc: 0.722 Test Loss: 1.017 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7436375617980957
Epoch: 52, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.002 Vali Acc: 0.750 Test Loss: 1.002 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8482747077941895
Epoch: 53, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.996 Vali Acc: 0.756 Test Loss: 0.996 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8309731483459473
Epoch: 54, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.021 Vali Acc: 0.756 Test Loss: 1.021 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9062285423278809
Epoch: 55, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.015 Vali Acc: 0.756 Test Loss: 1.015 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8235204219818115
Epoch: 56, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.002 Vali Acc: 0.756 Test Loss: 1.002 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.8467392921447754
Epoch: 57, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.004 Vali Acc: 0.756 Test Loss: 1.004 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.8345115184783936
Epoch: 58, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.015 Vali Acc: 0.767 Test Loss: 1.015 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.8440392017364502
Epoch: 59, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.016 Vali Acc: 0.756 Test Loss: 1.016 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 17231
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.244985342025757
Epoch: 1, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.821 Vali Acc: 0.056 Test Loss: 2.821 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 0.7953982353210449
Epoch: 2, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.736 Vali Acc: 0.094 Test Loss: 2.736 Test Acc: 0.094
Validation loss decreased (-0.055527 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 0.9049935340881348
Epoch: 3, Steps: 12 | Train Loss: 2.635 Vali Loss: 2.620 Vali Acc: 0.172 Test Loss: 2.620 Test Acc: 0.172
Validation loss decreased (-0.094417 --> -0.172196).  Saving model ...
Epoch: 4 cost time: 0.8220226764678955
Epoch: 4, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.490 Vali Acc: 0.211 Test Loss: 2.490 Test Acc: 0.211
Validation loss decreased (-0.172196 --> -0.211086).  Saving model ...
Epoch: 5 cost time: 0.8475782871246338
Epoch: 5, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.352 Vali Acc: 0.300 Test Loss: 2.352 Test Acc: 0.300
Validation loss decreased (-0.211086 --> -0.299976).  Saving model ...
Epoch: 6 cost time: 0.7562394142150879
Epoch: 6, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.222 Vali Acc: 0.389 Test Loss: 2.222 Test Acc: 0.389
Validation loss decreased (-0.299976 --> -0.388867).  Saving model ...
Epoch: 7 cost time: 0.8219454288482666
Epoch: 7, Steps: 12 | Train Loss: 2.103 Vali Loss: 2.093 Vali Acc: 0.428 Test Loss: 2.093 Test Acc: 0.428
Validation loss decreased (-0.388867 --> -0.427757).  Saving model ...
Epoch: 8 cost time: 0.8001546859741211
Epoch: 8, Steps: 12 | Train Loss: 1.950 Vali Loss: 1.981 Vali Acc: 0.489 Test Loss: 1.981 Test Acc: 0.489
Validation loss decreased (-0.427757 --> -0.488869).  Saving model ...
Epoch: 9 cost time: 0.8130435943603516
Epoch: 9, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.886 Vali Acc: 0.478 Test Loss: 1.886 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.894127368927002
Epoch: 10, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.798 Vali Acc: 0.511 Test Loss: 1.798 Test Acc: 0.511
Validation loss decreased (-0.488869 --> -0.511093).  Saving model ...
Epoch: 11 cost time: 0.8774054050445557
Epoch: 11, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.725 Vali Acc: 0.511 Test Loss: 1.725 Test Acc: 0.511
Validation loss decreased (-0.511093 --> -0.511094).  Saving model ...
Epoch: 12 cost time: 0.871652364730835
Epoch: 12, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.656 Vali Acc: 0.528 Test Loss: 1.656 Test Acc: 0.528
Validation loss decreased (-0.511094 --> -0.527761).  Saving model ...
Epoch: 13 cost time: 0.849102258682251
Epoch: 13, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.601 Vali Acc: 0.539 Test Loss: 1.601 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 14 cost time: 0.7858550548553467
Epoch: 14, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.551 Vali Acc: 0.550 Test Loss: 1.551 Test Acc: 0.550
Validation loss decreased (-0.538873 --> -0.549984).  Saving model ...
Epoch: 15 cost time: 0.8755655288696289
Epoch: 15, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.499 Vali Acc: 0.578 Test Loss: 1.499 Test Acc: 0.578
Validation loss decreased (-0.549984 --> -0.577763).  Saving model ...
Epoch: 16 cost time: 0.7778534889221191
Epoch: 16, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.476 Vali Acc: 0.567 Test Loss: 1.476 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8097283840179443
Epoch: 17, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.438 Vali Acc: 0.589 Test Loss: 1.438 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588875).  Saving model ...
Epoch: 18 cost time: 0.9370856285095215
Epoch: 18, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.412 Vali Acc: 0.611 Test Loss: 1.412 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611097).  Saving model ...
Epoch: 19 cost time: 0.7852473258972168
Epoch: 19, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.383 Vali Acc: 0.622 Test Loss: 1.383 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622208).  Saving model ...
Epoch: 20 cost time: 0.8779218196868896
Epoch: 20, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.356 Vali Acc: 0.622 Test Loss: 1.356 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 21 cost time: 0.8384137153625488
Epoch: 21, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.342 Vali Acc: 0.628 Test Loss: 1.342 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627764).  Saving model ...
Epoch: 22 cost time: 0.7800157070159912
Epoch: 22, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.320 Vali Acc: 0.628 Test Loss: 1.320 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627765).  Saving model ...
Epoch: 23 cost time: 0.8194789886474609
Epoch: 23, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.300 Vali Acc: 0.650 Test Loss: 1.300 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649987).  Saving model ...
Epoch: 24 cost time: 0.8080594539642334
Epoch: 24, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.276 Vali Acc: 0.656 Test Loss: 1.276 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655543).  Saving model ...
Epoch: 25 cost time: 0.8374910354614258
Epoch: 25, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.260 Vali Acc: 0.644 Test Loss: 1.260 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8627810478210449
Epoch: 26, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.252 Vali Acc: 0.667 Test Loss: 1.252 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666654).  Saving model ...
Epoch: 27 cost time: 0.9067013263702393
Epoch: 27, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.227 Vali Acc: 0.672 Test Loss: 1.227 Test Acc: 0.672
Validation loss decreased (-0.666654 --> -0.672210).  Saving model ...
Epoch: 28 cost time: 0.8366959095001221
Epoch: 28, Steps: 12 | Train Loss: 0.684 Vali Loss: 1.207 Vali Acc: 0.672 Test Loss: 1.207 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672210).  Saving model ...
Epoch: 29 cost time: 0.7488055229187012
Epoch: 29, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.187 Vali Acc: 0.678 Test Loss: 1.187 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677766).  Saving model ...
Epoch: 30 cost time: 0.9381868839263916
Epoch: 30, Steps: 12 | Train Loss: 0.658 Vali Loss: 1.176 Vali Acc: 0.683 Test Loss: 1.176 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683322).  Saving model ...
Epoch: 31 cost time: 0.7838542461395264
Epoch: 31, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.152 Vali Acc: 0.694 Test Loss: 1.152 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694433).  Saving model ...
Epoch: 32 cost time: 0.8879847526550293
Epoch: 32, Steps: 12 | Train Loss: 0.561 Vali Loss: 1.130 Vali Acc: 0.683 Test Loss: 1.130 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7725443840026855
Epoch: 33, Steps: 12 | Train Loss: 0.577 Vali Loss: 1.123 Vali Acc: 0.689 Test Loss: 1.123 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7960720062255859
Epoch: 34, Steps: 12 | Train Loss: 0.477 Vali Loss: 1.110 Vali Acc: 0.689 Test Loss: 1.110 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7764296531677246
Epoch: 35, Steps: 12 | Train Loss: 0.502 Vali Loss: 1.096 Vali Acc: 0.689 Test Loss: 1.096 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7486546039581299
Epoch: 36, Steps: 12 | Train Loss: 0.463 Vali Loss: 1.083 Vali Acc: 0.700 Test Loss: 1.083 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699989).  Saving model ...
Epoch: 37 cost time: 0.9318163394927979
Epoch: 37, Steps: 12 | Train Loss: 0.428 Vali Loss: 1.073 Vali Acc: 0.700 Test Loss: 1.073 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 38 cost time: 0.9696645736694336
Epoch: 38, Steps: 12 | Train Loss: 0.412 Vali Loss: 1.047 Vali Acc: 0.711 Test Loss: 1.047 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 39 cost time: 0.7551019191741943
Epoch: 39, Steps: 12 | Train Loss: 0.414 Vali Loss: 1.036 Vali Acc: 0.711 Test Loss: 1.036 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 40 cost time: 0.8156301975250244
Epoch: 40, Steps: 12 | Train Loss: 0.364 Vali Loss: 1.050 Vali Acc: 0.711 Test Loss: 1.050 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.838545560836792
Epoch: 41, Steps: 12 | Train Loss: 0.409 Vali Loss: 1.033 Vali Acc: 0.733 Test Loss: 1.033 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733323).  Saving model ...
Epoch: 42 cost time: 0.893975019454956
Epoch: 42, Steps: 12 | Train Loss: 0.343 Vali Loss: 1.020 Vali Acc: 0.722 Test Loss: 1.020 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8178520202636719
Epoch: 43, Steps: 12 | Train Loss: 0.361 Vali Loss: 1.012 Vali Acc: 0.744 Test Loss: 1.012 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744434).  Saving model ...
Epoch: 44 cost time: 0.8797440528869629
Epoch: 44, Steps: 12 | Train Loss: 0.322 Vali Loss: 1.000 Vali Acc: 0.744 Test Loss: 1.000 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744434).  Saving model ...
Epoch: 45 cost time: 0.8528871536254883
Epoch: 45, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.999 Vali Acc: 0.756 Test Loss: 0.999 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 46 cost time: 0.8188185691833496
Epoch: 46, Steps: 12 | Train Loss: 0.339 Vali Loss: 1.008 Vali Acc: 0.744 Test Loss: 1.008 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8641767501831055
Epoch: 47, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.999 Vali Acc: 0.744 Test Loss: 0.999 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8230471611022949
Epoch: 48, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.995 Vali Acc: 0.744 Test Loss: 0.995 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8240940570831299
Epoch: 49, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.991 Vali Acc: 0.739 Test Loss: 0.991 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7809145450592041
Epoch: 50, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.981 Vali Acc: 0.761 Test Loss: 0.981 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761101).  Saving model ...
Epoch: 51 cost time: 0.8557555675506592
Epoch: 51, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.978 Vali Acc: 0.756 Test Loss: 0.978 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.784675121307373
Epoch: 52, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.993 Vali Acc: 0.739 Test Loss: 0.993 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8418469429016113
Epoch: 53, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.989 Vali Acc: 0.750 Test Loss: 0.989 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.7833113670349121
Epoch: 54, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.998 Vali Acc: 0.750 Test Loss: 0.998 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8762133121490479
Epoch: 55, Steps: 12 | Train Loss: 0.225 Vali Loss: 1.003 Vali Acc: 0.744 Test Loss: 1.003 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.844069242477417
Epoch: 56, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.007 Vali Acc: 0.756 Test Loss: 1.007 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.7978451251983643
Epoch: 57, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.023 Vali Acc: 0.744 Test Loss: 1.023 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.8476564884185791
Epoch: 58, Steps: 12 | Train Loss: 0.198 Vali Loss: 1.023 Vali Acc: 0.739 Test Loss: 1.023 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8488633632659912
Epoch: 59, Steps: 12 | Train Loss: 0.176 Vali Loss: 1.011 Vali Acc: 0.744 Test Loss: 1.011 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.8169262409210205
Epoch: 60, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.006 Vali Acc: 0.767 Test Loss: 1.006 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766657).  Saving model ...
Epoch: 61 cost time: 0.7621266841888428
Epoch: 61, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.022 Vali Acc: 0.761 Test Loss: 1.022 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8642022609710693
Epoch: 62, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.025 Vali Acc: 0.767 Test Loss: 1.025 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8264274597167969
Epoch: 63, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.025 Vali Acc: 0.761 Test Loss: 1.025 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7450296878814697
Epoch: 64, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.016 Vali Acc: 0.756 Test Loss: 1.016 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8823940753936768
Epoch: 65, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.017 Vali Acc: 0.767 Test Loss: 1.017 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.8632090091705322
Epoch: 66, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.013 Vali Acc: 0.767 Test Loss: 1.013 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.8083779811859131
Epoch: 67, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.041 Vali Acc: 0.744 Test Loss: 1.041 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.8126537799835205
Epoch: 68, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.056 Vali Acc: 0.756 Test Loss: 1.056 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.8812518119812012
Epoch: 69, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.047 Vali Acc: 0.756 Test Loss: 1.047 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.8526191711425781
Epoch: 70, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.061 Vali Acc: 0.750 Test Loss: 1.061 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 13887
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1975650787353516
Epoch: 1, Steps: 12 | Train Loss: 2.926 Vali Loss: 2.802 Vali Acc: 0.028 Test Loss: 2.802 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 0.8049652576446533
Epoch: 2, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.757 Vali Acc: 0.044 Test Loss: 2.757 Test Acc: 0.044
Validation loss decreased (-0.027750 --> -0.044417).  Saving model ...
Epoch: 3 cost time: 0.7913014888763428
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.678 Vali Acc: 0.050 Test Loss: 2.678 Test Acc: 0.050
Validation loss decreased (-0.044417 --> -0.049973).  Saving model ...
Epoch: 4 cost time: 0.8064534664154053
Epoch: 4, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.589 Vali Acc: 0.072 Test Loss: 2.589 Test Acc: 0.072
Validation loss decreased (-0.049973 --> -0.072196).  Saving model ...
Epoch: 5 cost time: 0.7971727848052979
Epoch: 5, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.486 Vali Acc: 0.206 Test Loss: 2.486 Test Acc: 0.206
Validation loss decreased (-0.072196 --> -0.205531).  Saving model ...
Epoch: 6 cost time: 0.7948238849639893
Epoch: 6, Steps: 12 | Train Loss: 2.419 Vali Loss: 2.385 Vali Acc: 0.289 Test Loss: 2.385 Test Acc: 0.289
Validation loss decreased (-0.205531 --> -0.288865).  Saving model ...
Epoch: 7 cost time: 0.8133409023284912
Epoch: 7, Steps: 12 | Train Loss: 2.296 Vali Loss: 2.281 Vali Acc: 0.322 Test Loss: 2.281 Test Acc: 0.322
Validation loss decreased (-0.288865 --> -0.322199).  Saving model ...
Epoch: 8 cost time: 0.7647995948791504
Epoch: 8, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.176 Vali Acc: 0.356 Test Loss: 2.176 Test Acc: 0.356
Validation loss decreased (-0.322199 --> -0.355534).  Saving model ...
Epoch: 9 cost time: 0.7553989887237549
Epoch: 9, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.084 Vali Acc: 0.411 Test Loss: 2.084 Test Acc: 0.411
Validation loss decreased (-0.355534 --> -0.411090).  Saving model ...
Epoch: 10 cost time: 0.7963590621948242
Epoch: 10, Steps: 12 | Train Loss: 1.994 Vali Loss: 1.993 Vali Acc: 0.456 Test Loss: 1.993 Test Acc: 0.456
Validation loss decreased (-0.411090 --> -0.455536).  Saving model ...
Epoch: 11 cost time: 0.8279149532318115
Epoch: 11, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.911 Vali Acc: 0.494 Test Loss: 1.911 Test Acc: 0.494
Validation loss decreased (-0.455536 --> -0.494425).  Saving model ...
Epoch: 12 cost time: 0.7466723918914795
Epoch: 12, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.835 Vali Acc: 0.500 Test Loss: 1.835 Test Acc: 0.500
Validation loss decreased (-0.494425 --> -0.499982).  Saving model ...
Epoch: 13 cost time: 0.7806403636932373
Epoch: 13, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.775 Vali Acc: 0.511 Test Loss: 1.775 Test Acc: 0.511
Validation loss decreased (-0.499982 --> -0.511093).  Saving model ...
Epoch: 14 cost time: 0.7922024726867676
Epoch: 14, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.717 Vali Acc: 0.511 Test Loss: 1.717 Test Acc: 0.511
Validation loss decreased (-0.511093 --> -0.511094).  Saving model ...
Epoch: 15 cost time: 0.7743425369262695
Epoch: 15, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.658 Vali Acc: 0.544 Test Loss: 1.658 Test Acc: 0.544
Validation loss decreased (-0.511094 --> -0.544428).  Saving model ...
Epoch: 16 cost time: 0.7600047588348389
Epoch: 16, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.617 Vali Acc: 0.550 Test Loss: 1.617 Test Acc: 0.550
Validation loss decreased (-0.544428 --> -0.549984).  Saving model ...
Epoch: 17 cost time: 0.8500392436981201
Epoch: 17, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.573 Vali Acc: 0.572 Test Loss: 1.573 Test Acc: 0.572
Validation loss decreased (-0.549984 --> -0.572206).  Saving model ...
Epoch: 18 cost time: 0.8149881362915039
Epoch: 18, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.541 Vali Acc: 0.578 Test Loss: 1.541 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577762).  Saving model ...
Epoch: 19 cost time: 0.800025224685669
Epoch: 19, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.508 Vali Acc: 0.578 Test Loss: 1.508 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577763).  Saving model ...
Epoch: 20 cost time: 0.765648603439331
Epoch: 20, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.477 Vali Acc: 0.594 Test Loss: 1.477 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594430).  Saving model ...
Epoch: 21 cost time: 0.8329126834869385
Epoch: 21, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.448 Vali Acc: 0.600 Test Loss: 1.448 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 0.7170586585998535
Epoch: 22, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.422 Vali Acc: 0.611 Test Loss: 1.422 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611097).  Saving model ...
Epoch: 23 cost time: 0.7898094654083252
Epoch: 23, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.403 Vali Acc: 0.611 Test Loss: 1.403 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611097).  Saving model ...
Epoch: 24 cost time: 0.8221015930175781
Epoch: 24, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.377 Vali Acc: 0.611 Test Loss: 1.377 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611097).  Saving model ...
Epoch: 25 cost time: 0.7952120304107666
Epoch: 25, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.371 Vali Acc: 0.622 Test Loss: 1.371 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 26 cost time: 0.8219306468963623
Epoch: 26, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.347 Vali Acc: 0.617 Test Loss: 1.347 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8361473083496094
Epoch: 27, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.327 Vali Acc: 0.622 Test Loss: 1.327 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622209).  Saving model ...
Epoch: 28 cost time: 0.8118972778320312
Epoch: 28, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.303 Vali Acc: 0.633 Test Loss: 1.303 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 0.8307220935821533
Epoch: 29, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.278 Vali Acc: 0.650 Test Loss: 1.278 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649987).  Saving model ...
Epoch: 30 cost time: 0.8345675468444824
Epoch: 30, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.267 Vali Acc: 0.644 Test Loss: 1.267 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8564102649688721
Epoch: 31, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.249 Vali Acc: 0.656 Test Loss: 1.249 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655543).  Saving model ...
Epoch: 32 cost time: 0.8979103565216064
Epoch: 32, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.233 Vali Acc: 0.656 Test Loss: 1.233 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 33 cost time: 0.8064768314361572
Epoch: 33, Steps: 12 | Train Loss: 0.716 Vali Loss: 1.219 Vali Acc: 0.656 Test Loss: 1.219 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 34 cost time: 0.8040721416473389
Epoch: 34, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.208 Vali Acc: 0.667 Test Loss: 1.208 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 35 cost time: 0.8449275493621826
Epoch: 35, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.200 Vali Acc: 0.656 Test Loss: 1.200 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8385288715362549
Epoch: 36, Steps: 12 | Train Loss: 0.600 Vali Loss: 1.184 Vali Acc: 0.667 Test Loss: 1.184 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 37 cost time: 0.7847421169281006
Epoch: 37, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.150 Vali Acc: 0.667 Test Loss: 1.150 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 38 cost time: 0.7586517333984375
Epoch: 38, Steps: 12 | Train Loss: 0.580 Vali Loss: 1.136 Vali Acc: 0.667 Test Loss: 1.136 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 39 cost time: 0.9219579696655273
Epoch: 39, Steps: 12 | Train Loss: 0.637 Vali Loss: 1.128 Vali Acc: 0.667 Test Loss: 1.128 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 40 cost time: 0.8555529117584229
Epoch: 40, Steps: 12 | Train Loss: 0.558 Vali Loss: 1.113 Vali Acc: 0.672 Test Loss: 1.113 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 41 cost time: 0.8701698780059814
Epoch: 41, Steps: 12 | Train Loss: 0.582 Vali Loss: 1.096 Vali Acc: 0.656 Test Loss: 1.096 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8497395515441895
Epoch: 42, Steps: 12 | Train Loss: 0.502 Vali Loss: 1.073 Vali Acc: 0.689 Test Loss: 1.073 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 43 cost time: 0.8754684925079346
Epoch: 43, Steps: 12 | Train Loss: 0.478 Vali Loss: 1.060 Vali Acc: 0.689 Test Loss: 1.060 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 44 cost time: 0.8051478862762451
Epoch: 44, Steps: 12 | Train Loss: 0.468 Vali Loss: 1.049 Vali Acc: 0.706 Test Loss: 1.049 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705545).  Saving model ...
Epoch: 45 cost time: 0.8335394859313965
Epoch: 45, Steps: 12 | Train Loss: 0.448 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6974987983703613
Epoch: 46, Steps: 12 | Train Loss: 0.431 Vali Loss: 1.035 Vali Acc: 0.706 Test Loss: 1.035 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705545).  Saving model ...
Epoch: 47 cost time: 0.7396996021270752
Epoch: 47, Steps: 12 | Train Loss: 0.407 Vali Loss: 1.020 Vali Acc: 0.711 Test Loss: 1.020 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 48 cost time: 0.8052711486816406
Epoch: 48, Steps: 12 | Train Loss: 0.379 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7444472312927246
Epoch: 49, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.995 Vali Acc: 0.706 Test Loss: 0.995 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7646260261535645
Epoch: 50, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.987 Vali Acc: 0.722 Test Loss: 0.987 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 51 cost time: 0.7404735088348389
Epoch: 51, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.972 Vali Acc: 0.739 Test Loss: 0.972 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 52 cost time: 0.788811445236206
Epoch: 52, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.969 Vali Acc: 0.739 Test Loss: 0.969 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 53 cost time: 0.8056793212890625
Epoch: 53, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.956 Vali Acc: 0.733 Test Loss: 0.956 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8265407085418701
Epoch: 54, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.963 Vali Acc: 0.706 Test Loss: 0.963 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7424631118774414
Epoch: 55, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.954 Vali Acc: 0.767 Test Loss: 0.954 Test Acc: 0.767
Validation loss decreased (-0.738879 --> -0.766657).  Saving model ...
Epoch: 56 cost time: 0.7671380043029785
Epoch: 56, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.950 Vali Acc: 0.761 Test Loss: 0.950 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7775664329528809
Epoch: 57, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7687177658081055
Epoch: 58, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.949 Vali Acc: 0.717 Test Loss: 0.949 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8326857089996338
Epoch: 59, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.938 Vali Acc: 0.733 Test Loss: 0.938 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8691344261169434
Epoch: 60, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.935 Vali Acc: 0.739 Test Loss: 0.935 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7889869213104248
Epoch: 61, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.940 Vali Acc: 0.739 Test Loss: 0.940 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.8356480598449707
Epoch: 62, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.922 Vali Acc: 0.739 Test Loss: 0.922 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.7778348922729492
Epoch: 63, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.918 Vali Acc: 0.756 Test Loss: 0.918 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.9023258686065674
Epoch: 64, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.913 Vali Acc: 0.761 Test Loss: 0.913 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.7433264255523682
Epoch: 65, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 11999
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2099874019622803
Epoch: 1, Steps: 12 | Train Loss: 2.878 Vali Loss: 2.831 Vali Acc: 0.044 Test Loss: 2.831 Test Acc: 0.044
Validation loss decreased (inf --> -0.044416).  Saving model ...
Epoch: 2 cost time: 0.7613048553466797
Epoch: 2, Steps: 12 | Train Loss: 2.876 Vali Loss: 2.780 Vali Acc: 0.050 Test Loss: 2.780 Test Acc: 0.050
Validation loss decreased (-0.044416 --> -0.049972).  Saving model ...
Epoch: 3 cost time: 0.7606906890869141
Epoch: 3, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.706 Vali Acc: 0.083 Test Loss: 2.706 Test Acc: 0.083
Validation loss decreased (-0.049972 --> -0.083306).  Saving model ...
Epoch: 4 cost time: 0.8129675388336182
Epoch: 4, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.622 Vali Acc: 0.117 Test Loss: 2.622 Test Acc: 0.117
Validation loss decreased (-0.083306 --> -0.116640).  Saving model ...
Epoch: 5 cost time: 0.7197012901306152
Epoch: 5, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.528 Vali Acc: 0.133 Test Loss: 2.528 Test Acc: 0.133
Validation loss decreased (-0.116640 --> -0.133308).  Saving model ...
Epoch: 6 cost time: 0.7784137725830078
Epoch: 6, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.434 Vali Acc: 0.211 Test Loss: 2.434 Test Acc: 0.211
Validation loss decreased (-0.133308 --> -0.211087).  Saving model ...
Epoch: 7 cost time: 0.7930116653442383
Epoch: 7, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.334 Vali Acc: 0.317 Test Loss: 2.334 Test Acc: 0.317
Validation loss decreased (-0.211087 --> -0.316643).  Saving model ...
Epoch: 8 cost time: 0.9123258590698242
Epoch: 8, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.239 Vali Acc: 0.372 Test Loss: 2.239 Test Acc: 0.372
Validation loss decreased (-0.316643 --> -0.372200).  Saving model ...
Epoch: 9 cost time: 0.713181734085083
Epoch: 9, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.144 Vali Acc: 0.428 Test Loss: 2.144 Test Acc: 0.428
Validation loss decreased (-0.372200 --> -0.427756).  Saving model ...
Epoch: 10 cost time: 0.7637715339660645
Epoch: 10, Steps: 12 | Train Loss: 2.105 Vali Loss: 2.052 Vali Acc: 0.456 Test Loss: 2.052 Test Acc: 0.456
Validation loss decreased (-0.427756 --> -0.455535).  Saving model ...
Epoch: 11 cost time: 0.8819265365600586
Epoch: 11, Steps: 12 | Train Loss: 1.969 Vali Loss: 1.964 Vali Acc: 0.483 Test Loss: 1.964 Test Acc: 0.483
Validation loss decreased (-0.455535 --> -0.483314).  Saving model ...
Epoch: 12 cost time: 0.7735695838928223
Epoch: 12, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.879 Vali Acc: 0.494 Test Loss: 1.879 Test Acc: 0.494
Validation loss decreased (-0.483314 --> -0.494426).  Saving model ...
Epoch: 13 cost time: 0.8063075542449951
Epoch: 13, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.806 Vali Acc: 0.533 Test Loss: 1.806 Test Acc: 0.533
Validation loss decreased (-0.494426 --> -0.533315).  Saving model ...
Epoch: 14 cost time: 0.8234724998474121
Epoch: 14, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.749 Vali Acc: 0.561 Test Loss: 1.749 Test Acc: 0.561
Validation loss decreased (-0.533315 --> -0.561094).  Saving model ...
Epoch: 15 cost time: 0.8246967792510986
Epoch: 15, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.691 Vali Acc: 0.578 Test Loss: 1.691 Test Acc: 0.578
Validation loss decreased (-0.561094 --> -0.577761).  Saving model ...
Epoch: 16 cost time: 0.7368021011352539
Epoch: 16, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.629 Vali Acc: 0.589 Test Loss: 1.629 Test Acc: 0.589
Validation loss decreased (-0.577761 --> -0.588873).  Saving model ...
Epoch: 17 cost time: 0.7379710674285889
Epoch: 17, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.582 Vali Acc: 0.583 Test Loss: 1.582 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.804363489151001
Epoch: 18, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.539 Vali Acc: 0.583 Test Loss: 1.539 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8115818500518799
Epoch: 19, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.504 Vali Acc: 0.578 Test Loss: 1.504 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.76808762550354
Epoch: 20, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.467 Vali Acc: 0.589 Test Loss: 1.467 Test Acc: 0.589
Validation loss decreased (-0.588873 --> -0.588874).  Saving model ...
Epoch: 21 cost time: 0.8170464038848877
Epoch: 21, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.434 Vali Acc: 0.583 Test Loss: 1.434 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8102824687957764
Epoch: 22, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.410 Vali Acc: 0.606 Test Loss: 1.410 Test Acc: 0.606
Validation loss decreased (-0.588874 --> -0.605541).  Saving model ...
Epoch: 23 cost time: 0.806633472442627
Epoch: 23, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.377 Vali Acc: 0.589 Test Loss: 1.377 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7752914428710938
Epoch: 24, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.356 Vali Acc: 0.594 Test Loss: 1.356 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7143886089324951
Epoch: 25, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.332 Vali Acc: 0.600 Test Loss: 1.332 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7437798976898193
Epoch: 26, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.307 Vali Acc: 0.594 Test Loss: 1.307 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7065248489379883
Epoch: 27, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.279 Vali Acc: 0.622 Test Loss: 1.279 Test Acc: 0.622
Validation loss decreased (-0.605541 --> -0.622209).  Saving model ...
Epoch: 28 cost time: 0.7307925224304199
Epoch: 28, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.253 Vali Acc: 0.628 Test Loss: 1.253 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 29 cost time: 0.7756624221801758
Epoch: 29, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.230 Vali Acc: 0.644 Test Loss: 1.230 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644432).  Saving model ...
Epoch: 30 cost time: 0.7847111225128174
Epoch: 30, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.197 Vali Acc: 0.656 Test Loss: 1.197 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 31 cost time: 0.7275283336639404
Epoch: 31, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.177 Vali Acc: 0.644 Test Loss: 1.177 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8330438137054443
Epoch: 32, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.146 Vali Acc: 0.656 Test Loss: 1.146 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 33 cost time: 0.8140742778778076
Epoch: 33, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.119 Vali Acc: 0.656 Test Loss: 1.119 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 34 cost time: 0.7996089458465576
Epoch: 34, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.107 Vali Acc: 0.656 Test Loss: 1.107 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 35 cost time: 0.8690097332000732
Epoch: 35, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.080 Vali Acc: 0.661 Test Loss: 1.080 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 36 cost time: 0.7914187908172607
Epoch: 36, Steps: 12 | Train Loss: 0.667 Vali Loss: 1.058 Vali Acc: 0.656 Test Loss: 1.058 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7991690635681152
Epoch: 37, Steps: 12 | Train Loss: 0.644 Vali Loss: 1.045 Vali Acc: 0.661 Test Loss: 1.045 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661101).  Saving model ...
Epoch: 38 cost time: 0.8949253559112549
Epoch: 38, Steps: 12 | Train Loss: 0.607 Vali Loss: 1.022 Vali Acc: 0.678 Test Loss: 1.022 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 39 cost time: 0.769395112991333
Epoch: 39, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.010 Vali Acc: 0.694 Test Loss: 1.010 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694434).  Saving model ...
Epoch: 40 cost time: 0.8420870304107666
Epoch: 40, Steps: 12 | Train Loss: 0.593 Vali Loss: 1.005 Vali Acc: 0.683 Test Loss: 1.005 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7979943752288818
Epoch: 41, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.995 Vali Acc: 0.678 Test Loss: 0.995 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7971596717834473
Epoch: 42, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.973 Vali Acc: 0.683 Test Loss: 0.973 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8335223197937012
Epoch: 43, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.950 Vali Acc: 0.711 Test Loss: 0.950 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711102).  Saving model ...
Epoch: 44 cost time: 0.8222296237945557
Epoch: 44, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.934 Vali Acc: 0.706 Test Loss: 0.934 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7855644226074219
Epoch: 45, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.908 Vali Acc: 0.717 Test Loss: 0.908 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 46 cost time: 0.8399360179901123
Epoch: 46, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.906 Vali Acc: 0.717 Test Loss: 0.906 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 47 cost time: 0.6908535957336426
Epoch: 47, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722213).  Saving model ...
Epoch: 48 cost time: 0.815640926361084
Epoch: 48, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.872 Vali Acc: 0.711 Test Loss: 0.872 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8625626564025879
Epoch: 49, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.877 Vali Acc: 0.706 Test Loss: 0.877 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7959949970245361
Epoch: 50, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.863 Vali Acc: 0.711 Test Loss: 0.863 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7169029712677002
Epoch: 51, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.842 Vali Acc: 0.722 Test Loss: 0.842 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 52 cost time: 0.8896040916442871
Epoch: 52, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.839 Vali Acc: 0.739 Test Loss: 0.839 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738881).  Saving model ...
Epoch: 53 cost time: 0.7932102680206299
Epoch: 53, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.833 Vali Acc: 0.739 Test Loss: 0.833 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 54 cost time: 0.7886745929718018
Epoch: 54, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755547).  Saving model ...
Epoch: 55 cost time: 0.8398420810699463
Epoch: 55, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.844 Vali Acc: 0.750 Test Loss: 0.844 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7870340347290039
Epoch: 56, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.815 Vali Acc: 0.733 Test Loss: 0.815 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8430402278900146
Epoch: 57, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.823 Vali Acc: 0.722 Test Loss: 0.823 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.7954607009887695
Epoch: 58, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.819 Vali Acc: 0.733 Test Loss: 0.819 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7988917827606201
Epoch: 59, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8191437721252441
Epoch: 60, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.795 Vali Acc: 0.744 Test Loss: 0.795 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8044424057006836
Epoch: 61, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8077399730682373
Epoch: 62, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.796 Vali Acc: 0.733 Test Loss: 0.796 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8235199451446533
Epoch: 63, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.804 Vali Acc: 0.733 Test Loss: 0.804 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.8248066902160645
Epoch: 64, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.800 Vali Acc: 0.733 Test Loss: 0.800 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 11071
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.407770872116089
Epoch: 1, Steps: 12 | Train Loss: 2.828 Vali Loss: 2.811 Vali Acc: 0.072 Test Loss: 2.811 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 0.7913568019866943
Epoch: 2, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.785 Vali Acc: 0.094 Test Loss: 2.785 Test Acc: 0.094
Validation loss decreased (-0.072194 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 0.7731280326843262
Epoch: 3, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.738 Vali Acc: 0.128 Test Loss: 2.738 Test Acc: 0.128
Validation loss decreased (-0.094417 --> -0.127750).  Saving model ...
Epoch: 4 cost time: 0.8313858509063721
Epoch: 4, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.672 Vali Acc: 0.139 Test Loss: 2.672 Test Acc: 0.139
Validation loss decreased (-0.127750 --> -0.138862).  Saving model ...
Epoch: 5 cost time: 0.8097090721130371
Epoch: 5, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.602 Vali Acc: 0.178 Test Loss: 2.602 Test Acc: 0.178
Validation loss decreased (-0.138862 --> -0.177752).  Saving model ...
Epoch: 6 cost time: 0.7957887649536133
Epoch: 6, Steps: 12 | Train Loss: 2.561 Vali Loss: 2.530 Vali Acc: 0.239 Test Loss: 2.530 Test Acc: 0.239
Validation loss decreased (-0.177752 --> -0.238864).  Saving model ...
Epoch: 7 cost time: 0.8127996921539307
Epoch: 7, Steps: 12 | Train Loss: 2.488 Vali Loss: 2.454 Vali Acc: 0.267 Test Loss: 2.454 Test Acc: 0.267
Validation loss decreased (-0.238864 --> -0.266642).  Saving model ...
Epoch: 8 cost time: 0.8026242256164551
Epoch: 8, Steps: 12 | Train Loss: 2.417 Vali Loss: 2.374 Vali Acc: 0.278 Test Loss: 2.374 Test Acc: 0.278
Validation loss decreased (-0.266642 --> -0.277754).  Saving model ...
Epoch: 9 cost time: 0.8554561138153076
Epoch: 9, Steps: 12 | Train Loss: 2.318 Vali Loss: 2.295 Vali Acc: 0.306 Test Loss: 2.295 Test Acc: 0.306
Validation loss decreased (-0.277754 --> -0.305533).  Saving model ...
Epoch: 10 cost time: 0.8005778789520264
Epoch: 10, Steps: 12 | Train Loss: 2.174 Vali Loss: 2.216 Vali Acc: 0.361 Test Loss: 2.216 Test Acc: 0.361
Validation loss decreased (-0.305533 --> -0.361089).  Saving model ...
Epoch: 11 cost time: 0.8549933433532715
Epoch: 11, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.133 Vali Acc: 0.400 Test Loss: 2.133 Test Acc: 0.400
Validation loss decreased (-0.361089 --> -0.399979).  Saving model ...
Epoch: 12 cost time: 0.8215687274932861
Epoch: 12, Steps: 12 | Train Loss: 2.038 Vali Loss: 2.052 Vali Acc: 0.428 Test Loss: 2.052 Test Acc: 0.428
Validation loss decreased (-0.399979 --> -0.427757).  Saving model ...
Epoch: 13 cost time: 0.8388478755950928
Epoch: 13, Steps: 12 | Train Loss: 1.966 Vali Loss: 1.974 Vali Acc: 0.433 Test Loss: 1.974 Test Acc: 0.433
Validation loss decreased (-0.427757 --> -0.433314).  Saving model ...
Epoch: 14 cost time: 0.8058469295501709
Epoch: 14, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.896 Vali Acc: 0.456 Test Loss: 1.896 Test Acc: 0.456
Validation loss decreased (-0.433314 --> -0.455537).  Saving model ...
Epoch: 15 cost time: 0.824908971786499
Epoch: 15, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.832 Vali Acc: 0.478 Test Loss: 1.832 Test Acc: 0.478
Validation loss decreased (-0.455537 --> -0.477759).  Saving model ...
Epoch: 16 cost time: 0.8333616256713867
Epoch: 16, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.761 Vali Acc: 0.517 Test Loss: 1.761 Test Acc: 0.517
Validation loss decreased (-0.477759 --> -0.516649).  Saving model ...
Epoch: 17 cost time: 0.8343796730041504
Epoch: 17, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.705 Vali Acc: 0.522 Test Loss: 1.705 Test Acc: 0.522
Validation loss decreased (-0.516649 --> -0.522205).  Saving model ...
Epoch: 18 cost time: 0.7014622688293457
Epoch: 18, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.642 Vali Acc: 0.544 Test Loss: 1.642 Test Acc: 0.544
Validation loss decreased (-0.522205 --> -0.544428).  Saving model ...
Epoch: 19 cost time: 0.7660577297210693
Epoch: 19, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.587 Vali Acc: 0.544 Test Loss: 1.587 Test Acc: 0.544
Validation loss decreased (-0.544428 --> -0.544429).  Saving model ...
Epoch: 20 cost time: 0.7774636745452881
Epoch: 20, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.539 Vali Acc: 0.539 Test Loss: 1.539 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8597638607025146
Epoch: 21, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.490 Vali Acc: 0.556 Test Loss: 1.490 Test Acc: 0.556
Validation loss decreased (-0.544429 --> -0.555541).  Saving model ...
Epoch: 22 cost time: 0.7685399055480957
Epoch: 22, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.444 Vali Acc: 0.550 Test Loss: 1.444 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7888071537017822
Epoch: 23, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.393 Vali Acc: 0.572 Test Loss: 1.393 Test Acc: 0.572
Validation loss decreased (-0.555541 --> -0.572208).  Saving model ...
Epoch: 24 cost time: 0.7799415588378906
Epoch: 24, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.351 Vali Acc: 0.589 Test Loss: 1.351 Test Acc: 0.589
Validation loss decreased (-0.572208 --> -0.588875).  Saving model ...
Epoch: 25 cost time: 0.7945175170898438
Epoch: 25, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.318 Vali Acc: 0.594 Test Loss: 1.318 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594431).  Saving model ...
Epoch: 26 cost time: 0.847313404083252
Epoch: 26, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.277 Vali Acc: 0.611 Test Loss: 1.277 Test Acc: 0.611
Validation loss decreased (-0.594431 --> -0.611098).  Saving model ...
Epoch: 27 cost time: 0.8437786102294922
Epoch: 27, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.234 Vali Acc: 0.611 Test Loss: 1.234 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611099).  Saving model ...
Epoch: 28 cost time: 0.8048350811004639
Epoch: 28, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.196 Vali Acc: 0.606 Test Loss: 1.196 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8150825500488281
Epoch: 29, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.167 Vali Acc: 0.622 Test Loss: 1.167 Test Acc: 0.622
Validation loss decreased (-0.611099 --> -0.622211).  Saving model ...
Epoch: 30 cost time: 0.8279533386230469
Epoch: 30, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.143 Vali Acc: 0.617 Test Loss: 1.143 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8164682388305664
Epoch: 31, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.119 Vali Acc: 0.633 Test Loss: 1.119 Test Acc: 0.633
Validation loss decreased (-0.622211 --> -0.633322).  Saving model ...
Epoch: 32 cost time: 0.7565920352935791
Epoch: 32, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.088 Vali Acc: 0.633 Test Loss: 1.088 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 33 cost time: 0.8131046295166016
Epoch: 33, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.066 Vali Acc: 0.639 Test Loss: 1.066 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638878).  Saving model ...
Epoch: 34 cost time: 0.7925703525543213
Epoch: 34, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.044 Vali Acc: 0.644 Test Loss: 1.044 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644434).  Saving model ...
Epoch: 35 cost time: 0.7252659797668457
Epoch: 35, Steps: 12 | Train Loss: 0.779 Vali Loss: 1.024 Vali Acc: 0.639 Test Loss: 1.024 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7806844711303711
Epoch: 36, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.006 Vali Acc: 0.644 Test Loss: 1.006 Test Acc: 0.644
Validation loss decreased (-0.644434 --> -0.644434).  Saving model ...
Epoch: 37 cost time: 0.764336109161377
Epoch: 37, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.988 Vali Acc: 0.656 Test Loss: 0.988 Test Acc: 0.656
Validation loss decreased (-0.644434 --> -0.655546).  Saving model ...
Epoch: 38 cost time: 0.8114922046661377
Epoch: 38, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.972 Vali Acc: 0.661 Test Loss: 0.972 Test Acc: 0.661
Validation loss decreased (-0.655546 --> -0.661101).  Saving model ...
Epoch: 39 cost time: 0.8767285346984863
Epoch: 39, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.956 Vali Acc: 0.661 Test Loss: 0.956 Test Acc: 0.661
Validation loss decreased (-0.661101 --> -0.661102).  Saving model ...
Epoch: 40 cost time: 0.8001437187194824
Epoch: 40, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.946 Vali Acc: 0.661 Test Loss: 0.946 Test Acc: 0.661
Validation loss decreased (-0.661102 --> -0.661102).  Saving model ...
Epoch: 41 cost time: 0.7726187705993652
Epoch: 41, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.930 Vali Acc: 0.667 Test Loss: 0.930 Test Acc: 0.667
Validation loss decreased (-0.661102 --> -0.666657).  Saving model ...
Epoch: 42 cost time: 0.7737460136413574
Epoch: 42, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.922 Vali Acc: 0.667 Test Loss: 0.922 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 43 cost time: 0.7741248607635498
Epoch: 43, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.912 Vali Acc: 0.689 Test Loss: 0.912 Test Acc: 0.689
Validation loss decreased (-0.666657 --> -0.688880).  Saving model ...
Epoch: 44 cost time: 0.7724957466125488
Epoch: 44, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.910 Vali Acc: 0.678 Test Loss: 0.910 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8076915740966797
Epoch: 45, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.904 Vali Acc: 0.661 Test Loss: 0.904 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7463946342468262
Epoch: 46, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.899 Vali Acc: 0.678 Test Loss: 0.899 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7470149993896484
Epoch: 47, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.883 Vali Acc: 0.689 Test Loss: 0.883 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 48 cost time: 0.835991621017456
Epoch: 48, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.874 Vali Acc: 0.689 Test Loss: 0.874 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 49 cost time: 0.7812826633453369
Epoch: 49, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.869 Vali Acc: 0.700 Test Loss: 0.869 Test Acc: 0.700
Validation loss decreased (-0.688880 --> -0.699991).  Saving model ...
Epoch: 50 cost time: 0.8931021690368652
Epoch: 50, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.866 Vali Acc: 0.722 Test Loss: 0.866 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 51 cost time: 0.7934050559997559
Epoch: 51, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9425537586212158
Epoch: 52, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.778914213180542
Epoch: 53, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.837 Vali Acc: 0.706 Test Loss: 0.837 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8830370903015137
Epoch: 54, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.840 Vali Acc: 0.728 Test Loss: 0.840 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727769).  Saving model ...
Epoch: 55 cost time: 0.8530704975128174
Epoch: 55, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.841 Vali Acc: 0.728 Test Loss: 0.841 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8482556343078613
Epoch: 56, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.836 Vali Acc: 0.744 Test Loss: 0.836 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 57 cost time: 0.8566656112670898
Epoch: 57, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 58 cost time: 0.9140818119049072
Epoch: 58, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.819 Vali Acc: 0.722 Test Loss: 0.819 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7841064929962158
Epoch: 59, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.823 Vali Acc: 0.739 Test Loss: 0.823 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8696706295013428
Epoch: 60, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 61 cost time: 0.8742778301239014
Epoch: 61, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.829 Vali Acc: 0.761 Test Loss: 0.829 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 62 cost time: 0.706287145614624
Epoch: 62, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.814 Vali Acc: 0.756 Test Loss: 0.814 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9772651195526123
Epoch: 63, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.804 Vali Acc: 0.728 Test Loss: 0.804 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8279805183410645
Epoch: 64, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7420411109924316
Epoch: 65, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.8121147155761719
Epoch: 66, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.7745444774627686
Epoch: 67, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.783 Vali Acc: 0.767 Test Loss: 0.783 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 68 cost time: 0.8493638038635254
Epoch: 68, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.791 Vali Acc: 0.744 Test Loss: 0.791 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7309517860412598
Epoch: 69, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.781 Vali Acc: 0.767 Test Loss: 0.781 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 70 cost time: 0.9110984802246094
Epoch: 70, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.774 Vali Acc: 0.761 Test Loss: 0.774 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.913440465927124
Epoch: 71, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.778 Vali Acc: 0.767 Test Loss: 0.778 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 72 cost time: 0.8424317836761475
Epoch: 72, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.775 Vali Acc: 0.772 Test Loss: 0.775 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 73 cost time: 0.8164017200469971
Epoch: 73, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.767 Vali Acc: 0.783 Test Loss: 0.767 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 74 cost time: 0.9520955085754395
Epoch: 74, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8509154319763184
Epoch: 75, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.782 Vali Acc: 0.761 Test Loss: 0.782 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.7650902271270752
Epoch: 76, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.779 Vali Acc: 0.772 Test Loss: 0.779 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.7342019081115723
Epoch: 77, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.7594027519226074
Epoch: 78, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.7487282752990723
Epoch: 79, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.7858850955963135
Epoch: 80, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.781 Vali Acc: 0.794 Test Loss: 0.781 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 81 cost time: 0.846980094909668
Epoch: 81, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.785 Vali Acc: 0.789 Test Loss: 0.785 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8376877307891846
Epoch: 82, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.826878547668457
Epoch: 83, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.800 Vali Acc: 0.772 Test Loss: 0.800 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.803877592086792
Epoch: 84, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.797 Vali Acc: 0.789 Test Loss: 0.797 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.7641701698303223
Epoch: 85, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.794 Vali Acc: 0.794 Test Loss: 0.794 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.7857677936553955
Epoch: 86, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.8132903575897217
Epoch: 87, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.793 Vali Acc: 0.789 Test Loss: 0.793 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.8441407680511475
Epoch: 88, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.793 Vali Acc: 0.794 Test Loss: 0.793 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.8572807312011719
Epoch: 89, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.793 Vali Acc: 0.794 Test Loss: 0.793 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.7977912425994873
Epoch: 90, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.797 Vali Acc: 0.789 Test Loss: 0.797 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el2_dm16_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 10159
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.197659969329834
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.280 Vali Acc: 0.344 Test Loss: 2.280 Test Acc: 0.344
Validation loss decreased (inf --> -0.344422).  Saving model ...
Epoch: 2 cost time: 0.8005590438842773
Epoch: 2, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.663 Vali Acc: 0.517 Test Loss: 1.663 Test Acc: 0.517
Validation loss decreased (-0.344422 --> -0.516650).  Saving model ...
Epoch: 3 cost time: 0.8189804553985596
Epoch: 3, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.403 Vali Acc: 0.556 Test Loss: 1.403 Test Acc: 0.556
Validation loss decreased (-0.516650 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 0.7964339256286621
Epoch: 4, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.316 Vali Acc: 0.628 Test Loss: 1.316 Test Acc: 0.628
Validation loss decreased (-0.555542 --> -0.627765).  Saving model ...
Epoch: 5 cost time: 0.9018783569335938
Epoch: 5, Steps: 12 | Train Loss: 0.833 Vali Loss: 1.259 Vali Acc: 0.617 Test Loss: 1.259 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8054835796356201
Epoch: 6, Steps: 12 | Train Loss: 0.661 Vali Loss: 1.200 Vali Acc: 0.639 Test Loss: 1.200 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 0.8771445751190186
Epoch: 7, Steps: 12 | Train Loss: 0.529 Vali Loss: 1.206 Vali Acc: 0.694 Test Loss: 1.206 Test Acc: 0.694
Validation loss decreased (-0.638877 --> -0.694432).  Saving model ...
Epoch: 8 cost time: 0.803504467010498
Epoch: 8, Steps: 12 | Train Loss: 0.408 Vali Loss: 1.100 Vali Acc: 0.711 Test Loss: 1.100 Test Acc: 0.711
Validation loss decreased (-0.694432 --> -0.711100).  Saving model ...
Epoch: 9 cost time: 0.8031961917877197
Epoch: 9, Steps: 12 | Train Loss: 0.394 Vali Loss: 1.173 Vali Acc: 0.722 Test Loss: 1.173 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722210).  Saving model ...
Epoch: 10 cost time: 0.9071033000946045
Epoch: 10, Steps: 12 | Train Loss: 0.346 Vali Loss: 1.124 Vali Acc: 0.739 Test Loss: 1.124 Test Acc: 0.739
Validation loss decreased (-0.722210 --> -0.738878).  Saving model ...
Epoch: 11 cost time: 0.8270902633666992
Epoch: 11, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.252 Vali Acc: 0.711 Test Loss: 1.252 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7486505508422852
Epoch: 12, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.385 Vali Acc: 0.694 Test Loss: 1.385 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7820396423339844
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.427 Vali Acc: 0.711 Test Loss: 1.427 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8763887882232666
Epoch: 14, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.457 Vali Acc: 0.706 Test Loss: 1.457 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7800946235656738
Epoch: 15, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.445 Vali Acc: 0.722 Test Loss: 1.445 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8226625919342041
Epoch: 16, Steps: 12 | Train Loss: 0.210 Vali Loss: 1.451 Vali Acc: 0.733 Test Loss: 1.451 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8263289928436279
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.519 Vali Acc: 0.756 Test Loss: 1.519 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755540).  Saving model ...
Epoch: 18 cost time: 0.7791693210601807
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.757 Vali Acc: 0.711 Test Loss: 1.757 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8319251537322998
Epoch: 19, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.698 Vali Acc: 0.717 Test Loss: 1.698 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6632728576660156
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.764 Vali Acc: 0.739 Test Loss: 1.764 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7760860919952393
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.767 Vali Acc: 0.733 Test Loss: 1.767 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8288190364837646
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.857 Vali Acc: 0.728 Test Loss: 1.857 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7757725715637207
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.927 Vali Acc: 0.728 Test Loss: 1.927 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7881908416748047
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.892 Vali Acc: 0.744 Test Loss: 1.892 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8159987926483154
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.940 Vali Acc: 0.722 Test Loss: 1.940 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7749652862548828
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 2.029 Vali Acc: 0.733 Test Loss: 2.029 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8077800273895264
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 2.043 Vali Acc: 0.744 Test Loss: 2.043 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 305807
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9623596668243408
Epoch: 1, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.479 Vali Acc: 0.278 Test Loss: 2.479 Test Acc: 0.278
Validation loss decreased (inf --> -0.277753).  Saving model ...
Epoch: 2 cost time: 0.5815465450286865
Epoch: 2, Steps: 12 | Train Loss: 2.188 Vali Loss: 1.943 Vali Acc: 0.394 Test Loss: 1.943 Test Acc: 0.394
Validation loss decreased (-0.277753 --> -0.394425).  Saving model ...
Epoch: 3 cost time: 0.6480176448822021
Epoch: 3, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.591 Vali Acc: 0.517 Test Loss: 1.591 Test Acc: 0.517
Validation loss decreased (-0.394425 --> -0.516651).  Saving model ...
Epoch: 4 cost time: 0.6994857788085938
Epoch: 4, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.379 Vali Acc: 0.606 Test Loss: 1.379 Test Acc: 0.606
Validation loss decreased (-0.516651 --> -0.605542).  Saving model ...
Epoch: 5 cost time: 0.6073281764984131
Epoch: 5, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.289 Vali Acc: 0.617 Test Loss: 1.289 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 6 cost time: 0.782764196395874
Epoch: 6, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.207 Vali Acc: 0.611 Test Loss: 1.207 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5954151153564453
Epoch: 7, Steps: 12 | Train Loss: 0.726 Vali Loss: 1.166 Vali Acc: 0.678 Test Loss: 1.166 Test Acc: 0.678
Validation loss decreased (-0.616654 --> -0.677766).  Saving model ...
Epoch: 8 cost time: 0.7087581157684326
Epoch: 8, Steps: 12 | Train Loss: 0.613 Vali Loss: 1.122 Vali Acc: 0.678 Test Loss: 1.122 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 0.6963479518890381
Epoch: 9, Steps: 12 | Train Loss: 0.557 Vali Loss: 1.063 Vali Acc: 0.689 Test Loss: 1.063 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 0.6744265556335449
Epoch: 10, Steps: 12 | Train Loss: 0.400 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 0.7204685211181641
Epoch: 11, Steps: 12 | Train Loss: 0.364 Vali Loss: 1.022 Vali Acc: 0.722 Test Loss: 1.022 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 0.6407525539398193
Epoch: 12, Steps: 12 | Train Loss: 0.343 Vali Loss: 1.044 Vali Acc: 0.744 Test Loss: 1.044 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744434).  Saving model ...
Epoch: 13 cost time: 0.6501574516296387
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 1.040 Vali Acc: 0.756 Test Loss: 1.040 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755545).  Saving model ...
Epoch: 14 cost time: 0.7538619041442871
Epoch: 14, Steps: 12 | Train Loss: 0.241 Vali Loss: 1.104 Vali Acc: 0.728 Test Loss: 1.104 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6393122673034668
Epoch: 15, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.117 Vali Acc: 0.739 Test Loss: 1.117 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6614742279052734
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.096 Vali Acc: 0.750 Test Loss: 1.096 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6363058090209961
Epoch: 17, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.166 Vali Acc: 0.761 Test Loss: 1.166 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761099).  Saving model ...
Epoch: 18 cost time: 0.6448473930358887
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.205 Vali Acc: 0.739 Test Loss: 1.205 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6140971183776855
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.224 Vali Acc: 0.761 Test Loss: 1.224 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.639531135559082
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.312 Vali Acc: 0.750 Test Loss: 1.312 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6715261936187744
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.268 Vali Acc: 0.750 Test Loss: 1.268 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6313900947570801
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.375 Vali Acc: 0.750 Test Loss: 1.375 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5950820446014404
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.382 Vali Acc: 0.744 Test Loss: 1.382 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6530778408050537
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.418 Vali Acc: 0.733 Test Loss: 1.418 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6863720417022705
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.389 Vali Acc: 0.756 Test Loss: 1.389 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6769487857818604
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.484 Vali Acc: 0.739 Test Loss: 1.484 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6513638496398926
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.465 Vali Acc: 0.744 Test Loss: 1.465 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 221455
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.090606689453125
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.444 Vali Acc: 0.228 Test Loss: 2.444 Test Acc: 0.228
Validation loss decreased (inf --> -0.227753).  Saving model ...
Epoch: 2 cost time: 0.7330842018127441
Epoch: 2, Steps: 12 | Train Loss: 2.193 Vali Loss: 1.923 Vali Acc: 0.467 Test Loss: 1.923 Test Acc: 0.467
Validation loss decreased (-0.227753 --> -0.466647).  Saving model ...
Epoch: 3 cost time: 0.6047415733337402
Epoch: 3, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.639 Vali Acc: 0.517 Test Loss: 1.639 Test Acc: 0.517
Validation loss decreased (-0.466647 --> -0.516650).  Saving model ...
Epoch: 4 cost time: 0.5810897350311279
Epoch: 4, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.415 Vali Acc: 0.572 Test Loss: 1.415 Test Acc: 0.572
Validation loss decreased (-0.516650 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 0.7119114398956299
Epoch: 5, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.302 Vali Acc: 0.628 Test Loss: 1.302 Test Acc: 0.628
Validation loss decreased (-0.572208 --> -0.627765).  Saving model ...
Epoch: 6 cost time: 0.6296031475067139
Epoch: 6, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.264 Vali Acc: 0.628 Test Loss: 1.264 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 0.7198195457458496
Epoch: 7, Steps: 12 | Train Loss: 0.731 Vali Loss: 1.249 Vali Acc: 0.639 Test Loss: 1.249 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638876).  Saving model ...
Epoch: 8 cost time: 0.6343975067138672
Epoch: 8, Steps: 12 | Train Loss: 0.642 Vali Loss: 1.143 Vali Acc: 0.656 Test Loss: 1.143 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 0.7474489212036133
Epoch: 9, Steps: 12 | Train Loss: 0.562 Vali Loss: 1.132 Vali Acc: 0.656 Test Loss: 1.132 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 0.6139249801635742
Epoch: 10, Steps: 12 | Train Loss: 0.471 Vali Loss: 1.087 Vali Acc: 0.722 Test Loss: 1.087 Test Acc: 0.722
Validation loss decreased (-0.655544 --> -0.722211).  Saving model ...
Epoch: 11 cost time: 0.6262164115905762
Epoch: 11, Steps: 12 | Train Loss: 0.419 Vali Loss: 1.022 Vali Acc: 0.728 Test Loss: 1.022 Test Acc: 0.728
Validation loss decreased (-0.722211 --> -0.727768).  Saving model ...
Epoch: 12 cost time: 0.7257328033447266
Epoch: 12, Steps: 12 | Train Loss: 0.347 Vali Loss: 1.003 Vali Acc: 0.739 Test Loss: 1.003 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 0.631727933883667
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 1.063 Vali Acc: 0.722 Test Loss: 1.063 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6307651996612549
Epoch: 14, Steps: 12 | Train Loss: 0.283 Vali Loss: 1.039 Vali Acc: 0.722 Test Loss: 1.039 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6057937145233154
Epoch: 15, Steps: 12 | Train Loss: 0.207 Vali Loss: 1.017 Vali Acc: 0.750 Test Loss: 1.017 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.6329901218414307
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 1.073 Vali Acc: 0.722 Test Loss: 1.073 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7007637023925781
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.107 Vali Acc: 0.744 Test Loss: 1.107 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6588358879089355
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.127 Vali Acc: 0.739 Test Loss: 1.127 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6834733486175537
Epoch: 19, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.251 Vali Acc: 0.728 Test Loss: 1.251 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6669459342956543
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.188 Vali Acc: 0.739 Test Loss: 1.188 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6308317184448242
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.357 Vali Acc: 0.694 Test Loss: 1.357 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.744438886642456
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.217 Vali Acc: 0.739 Test Loss: 1.217 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6263701915740967
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.310 Vali Acc: 0.756 Test Loss: 1.310 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755542).  Saving model ...
Epoch: 24 cost time: 0.6429438591003418
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.324 Vali Acc: 0.744 Test Loss: 1.324 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.66843581199646
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.374 Vali Acc: 0.744 Test Loss: 1.374 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7079460620880127
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.403 Vali Acc: 0.750 Test Loss: 1.403 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6395816802978516
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.519 Vali Acc: 0.728 Test Loss: 1.519 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6203899383544922
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.387 Vali Acc: 0.750 Test Loss: 1.387 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6221208572387695
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.507 Vali Acc: 0.739 Test Loss: 1.507 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.653414249420166
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.472 Vali Acc: 0.739 Test Loss: 1.472 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6636819839477539
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.476 Vali Acc: 0.750 Test Loss: 1.476 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6038258075714111
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.531 Vali Acc: 0.756 Test Loss: 1.531 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6256206035614014
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.535 Vali Acc: 0.756 Test Loss: 1.535 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 217743
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9691879749298096
Epoch: 1, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.572 Vali Acc: 0.128 Test Loss: 2.572 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 0.6593725681304932
Epoch: 2, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.130 Vali Acc: 0.361 Test Loss: 2.130 Test Acc: 0.361
Validation loss decreased (-0.127752 --> -0.361090).  Saving model ...
Epoch: 3 cost time: 0.5748834609985352
Epoch: 3, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.767 Vali Acc: 0.556 Test Loss: 1.767 Test Acc: 0.556
Validation loss decreased (-0.361090 --> -0.555538).  Saving model ...
Epoch: 4 cost time: 0.6351385116577148
Epoch: 4, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.532 Vali Acc: 0.511 Test Loss: 1.532 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6522974967956543
Epoch: 5, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.404 Vali Acc: 0.583 Test Loss: 1.404 Test Acc: 0.583
Validation loss decreased (-0.555538 --> -0.583319).  Saving model ...
Epoch: 6 cost time: 0.6035993099212646
Epoch: 6, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.314 Vali Acc: 0.628 Test Loss: 1.314 Test Acc: 0.628
Validation loss decreased (-0.583319 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 0.6472887992858887
Epoch: 7, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.278 Vali Acc: 0.589 Test Loss: 1.278 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6565718650817871
Epoch: 8, Steps: 12 | Train Loss: 0.756 Vali Loss: 1.193 Vali Acc: 0.622 Test Loss: 1.193 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.610647439956665
Epoch: 9, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.6611027717590332
Epoch: 10, Steps: 12 | Train Loss: 0.563 Vali Loss: 1.064 Vali Acc: 0.678 Test Loss: 1.064 Test Acc: 0.678
Validation loss decreased (-0.649988 --> -0.677767).  Saving model ...
Epoch: 11 cost time: 0.6191754341125488
Epoch: 11, Steps: 12 | Train Loss: 0.498 Vali Loss: 1.053 Vali Acc: 0.694 Test Loss: 1.053 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 0.6906929016113281
Epoch: 12, Steps: 12 | Train Loss: 0.437 Vali Loss: 1.021 Vali Acc: 0.717 Test Loss: 1.021 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 0.6390688419342041
Epoch: 13, Steps: 12 | Train Loss: 0.411 Vali Loss: 1.033 Vali Acc: 0.689 Test Loss: 1.033 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6137588024139404
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.992 Vali Acc: 0.728 Test Loss: 0.992 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727768).  Saving model ...
Epoch: 15 cost time: 0.6130506992340088
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 1.027 Vali Acc: 0.750 Test Loss: 1.027 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.6131854057312012
Epoch: 16, Steps: 12 | Train Loss: 0.201 Vali Loss: 1.018 Vali Acc: 0.711 Test Loss: 1.018 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5681772232055664
Epoch: 17, Steps: 12 | Train Loss: 0.209 Vali Loss: 1.033 Vali Acc: 0.750 Test Loss: 1.033 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5937371253967285
Epoch: 18, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.037 Vali Acc: 0.739 Test Loss: 1.037 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5971932411193848
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.152 Vali Acc: 0.739 Test Loss: 1.152 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.619225025177002
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.084 Vali Acc: 0.733 Test Loss: 1.084 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6196308135986328
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.109 Vali Acc: 0.728 Test Loss: 1.109 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7089462280273438
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.106 Vali Acc: 0.750 Test Loss: 1.106 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6705198287963867
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.152 Vali Acc: 0.739 Test Loss: 1.152 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.599998950958252
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.137 Vali Acc: 0.733 Test Loss: 1.137 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6048829555511475
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.261 Vali Acc: 0.744 Test Loss: 1.261 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 190991
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0540308952331543
Epoch: 1, Steps: 12 | Train Loss: 2.826 Vali Loss: 2.679 Vali Acc: 0.161 Test Loss: 2.679 Test Acc: 0.161
Validation loss decreased (inf --> -0.161084).  Saving model ...
Epoch: 2 cost time: 0.6823287010192871
Epoch: 2, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.286 Vali Acc: 0.372 Test Loss: 2.286 Test Acc: 0.372
Validation loss decreased (-0.161084 --> -0.372199).  Saving model ...
Epoch: 3 cost time: 0.6988539695739746
Epoch: 3, Steps: 12 | Train Loss: 2.057 Vali Loss: 1.942 Vali Acc: 0.450 Test Loss: 1.942 Test Acc: 0.450
Validation loss decreased (-0.372199 --> -0.449981).  Saving model ...
Epoch: 4 cost time: 0.6572539806365967
Epoch: 4, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.686 Vali Acc: 0.511 Test Loss: 1.686 Test Acc: 0.511
Validation loss decreased (-0.449981 --> -0.511094).  Saving model ...
Epoch: 5 cost time: 0.736548662185669
Epoch: 5, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.520 Vali Acc: 0.572 Test Loss: 1.520 Test Acc: 0.572
Validation loss decreased (-0.511094 --> -0.572207).  Saving model ...
Epoch: 6 cost time: 0.6898453235626221
Epoch: 6, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.387 Vali Acc: 0.589 Test Loss: 1.387 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 0.6446261405944824
Epoch: 7, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.291 Vali Acc: 0.622 Test Loss: 1.291 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 0.6714975833892822
Epoch: 8, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.247 Vali Acc: 0.656 Test Loss: 1.247 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 0.704399824142456
Epoch: 9, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.190 Vali Acc: 0.656 Test Loss: 1.190 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 0.6211214065551758
Epoch: 10, Steps: 12 | Train Loss: 0.690 Vali Loss: 1.180 Vali Acc: 0.661 Test Loss: 1.180 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661099).  Saving model ...
Epoch: 11 cost time: 0.6878468990325928
Epoch: 11, Steps: 12 | Train Loss: 0.621 Vali Loss: 1.118 Vali Acc: 0.667 Test Loss: 1.118 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 0.6227304935455322
Epoch: 12, Steps: 12 | Train Loss: 0.503 Vali Loss: 1.050 Vali Acc: 0.683 Test Loss: 1.050 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 13 cost time: 0.6466615200042725
Epoch: 13, Steps: 12 | Train Loss: 0.500 Vali Loss: 1.027 Vali Acc: 0.706 Test Loss: 1.027 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 0.6559345722198486
Epoch: 14, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.974 Vali Acc: 0.739 Test Loss: 0.974 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.6520278453826904
Epoch: 15, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.978 Vali Acc: 0.728 Test Loss: 0.978 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6742148399353027
Epoch: 16, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.949 Vali Acc: 0.728 Test Loss: 0.949 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6690962314605713
Epoch: 17, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.940 Vali Acc: 0.728 Test Loss: 0.940 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.719294548034668
Epoch: 18, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 19 cost time: 0.6618332862854004
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.924 Vali Acc: 0.756 Test Loss: 0.924 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.664670467376709
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6420307159423828
Epoch: 21, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6366727352142334
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.953 Vali Acc: 0.739 Test Loss: 0.953 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6979398727416992
Epoch: 23, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.972 Vali Acc: 0.778 Test Loss: 0.972 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777768).  Saving model ...
Epoch: 24 cost time: 0.6559534072875977
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.984 Vali Acc: 0.756 Test Loss: 0.984 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6158292293548584
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.973 Vali Acc: 0.756 Test Loss: 0.973 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7037405967712402
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6525499820709229
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.031 Vali Acc: 0.739 Test Loss: 1.031 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6546289920806885
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6548526287078857
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.048 Vali Acc: 0.750 Test Loss: 1.048 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6094071865081787
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.105 Vali Acc: 0.750 Test Loss: 1.105 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6692233085632324
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.059 Vali Acc: 0.756 Test Loss: 1.059 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8282051086425781
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.059 Vali Acc: 0.756 Test Loss: 1.059 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7170112133026123
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.121 Vali Acc: 0.744 Test Loss: 1.121 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 175887
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0540831089019775
Epoch: 1, Steps: 12 | Train Loss: 2.884 Vali Loss: 2.708 Vali Acc: 0.100 Test Loss: 2.708 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.6431787014007568
Epoch: 2, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.350 Vali Acc: 0.339 Test Loss: 2.350 Test Acc: 0.339
Validation loss decreased (-0.099973 --> -0.338865).  Saving model ...
Epoch: 3 cost time: 0.6646807193756104
Epoch: 3, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.007 Vali Acc: 0.472 Test Loss: 2.007 Test Acc: 0.472
Validation loss decreased (-0.338865 --> -0.472202).  Saving model ...
Epoch: 4 cost time: 0.6166491508483887
Epoch: 4, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.736 Vali Acc: 0.544 Test Loss: 1.736 Test Acc: 0.544
Validation loss decreased (-0.472202 --> -0.544427).  Saving model ...
Epoch: 5 cost time: 0.6171250343322754
Epoch: 5, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.551 Vali Acc: 0.572 Test Loss: 1.551 Test Acc: 0.572
Validation loss decreased (-0.544427 --> -0.572207).  Saving model ...
Epoch: 6 cost time: 0.7105152606964111
Epoch: 6, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.435 Vali Acc: 0.578 Test Loss: 1.435 Test Acc: 0.578
Validation loss decreased (-0.572207 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 0.6594250202178955
Epoch: 7, Steps: 12 | Train Loss: 1.103 Vali Loss: 1.339 Vali Acc: 0.606 Test Loss: 1.339 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605542).  Saving model ...
Epoch: 8 cost time: 0.7052040100097656
Epoch: 8, Steps: 12 | Train Loss: 1.022 Vali Loss: 1.259 Vali Acc: 0.617 Test Loss: 1.259 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 0.6873397827148438
Epoch: 9, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.180 Vali Acc: 0.639 Test Loss: 1.180 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 10 cost time: 0.6881306171417236
Epoch: 10, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.146 Vali Acc: 0.667 Test Loss: 1.146 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666655).  Saving model ...
Epoch: 11 cost time: 0.7059981822967529
Epoch: 11, Steps: 12 | Train Loss: 0.615 Vali Loss: 1.091 Vali Acc: 0.667 Test Loss: 1.091 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 12 cost time: 0.6628897190093994
Epoch: 12, Steps: 12 | Train Loss: 0.561 Vali Loss: 1.014 Vali Acc: 0.694 Test Loss: 1.014 Test Acc: 0.694
Validation loss decreased (-0.666656 --> -0.694434).  Saving model ...
Epoch: 13 cost time: 0.6248857975006104
Epoch: 13, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.956 Vali Acc: 0.694 Test Loss: 0.956 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 14 cost time: 0.6636679172515869
Epoch: 14, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.912 Vali Acc: 0.711 Test Loss: 0.912 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 15 cost time: 0.797189474105835
Epoch: 15, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.885 Vali Acc: 0.717 Test Loss: 0.885 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 16 cost time: 0.5896484851837158
Epoch: 16, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.867 Vali Acc: 0.767 Test Loss: 0.867 Test Acc: 0.767
Validation loss decreased (-0.716658 --> -0.766658).  Saving model ...
Epoch: 17 cost time: 0.6938905715942383
Epoch: 17, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.864 Vali Acc: 0.739 Test Loss: 0.864 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6084983348846436
Epoch: 18, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.850 Vali Acc: 0.739 Test Loss: 0.850 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6591711044311523
Epoch: 19, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6230387687683105
Epoch: 20, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.850 Vali Acc: 0.761 Test Loss: 0.850 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6874680519104004
Epoch: 21, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.882 Vali Acc: 0.761 Test Loss: 0.882 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7281336784362793
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.908 Vali Acc: 0.711 Test Loss: 0.908 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6680679321289062
Epoch: 23, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6150927543640137
Epoch: 24, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.866 Vali Acc: 0.756 Test Loss: 0.866 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6183478832244873
Epoch: 25, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.911 Vali Acc: 0.733 Test Loss: 0.911 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6310408115386963
Epoch: 26, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 168463
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9339358806610107
Epoch: 1, Steps: 12 | Train Loss: 2.874 Vali Loss: 2.654 Vali Acc: 0.067 Test Loss: 2.654 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.67836594581604
Epoch: 2, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.355 Vali Acc: 0.294 Test Loss: 2.355 Test Acc: 0.294
Validation loss decreased (-0.066640 --> -0.294421).  Saving model ...
Epoch: 3 cost time: 0.6665928363800049
Epoch: 3, Steps: 12 | Train Loss: 2.256 Vali Loss: 2.036 Vali Acc: 0.478 Test Loss: 2.036 Test Acc: 0.478
Validation loss decreased (-0.294421 --> -0.477757).  Saving model ...
Epoch: 4 cost time: 0.6151416301727295
Epoch: 4, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.781 Vali Acc: 0.556 Test Loss: 1.781 Test Acc: 0.556
Validation loss decreased (-0.477757 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 0.7056982517242432
Epoch: 5, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.601 Vali Acc: 0.578 Test Loss: 1.601 Test Acc: 0.578
Validation loss decreased (-0.555538 --> -0.577762).  Saving model ...
Epoch: 6 cost time: 0.6136987209320068
Epoch: 6, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.476 Vali Acc: 0.600 Test Loss: 1.476 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599985).  Saving model ...
Epoch: 7 cost time: 0.6605749130249023
Epoch: 7, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.376 Vali Acc: 0.600 Test Loss: 1.376 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 0.6338069438934326
Epoch: 8, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.319 Vali Acc: 0.600 Test Loss: 1.319 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 0.6657605171203613
Epoch: 9, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.232 Vali Acc: 0.628 Test Loss: 1.232 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627765).  Saving model ...
Epoch: 10 cost time: 0.6140804290771484
Epoch: 10, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.162 Vali Acc: 0.661 Test Loss: 1.162 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661099).  Saving model ...
Epoch: 11 cost time: 0.6350510120391846
Epoch: 11, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.100 Vali Acc: 0.656 Test Loss: 1.100 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5910181999206543
Epoch: 12, Steps: 12 | Train Loss: 0.702 Vali Loss: 1.050 Vali Acc: 0.661 Test Loss: 1.050 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661101).  Saving model ...
Epoch: 13 cost time: 0.5675721168518066
Epoch: 13, Steps: 12 | Train Loss: 0.591 Vali Loss: 1.001 Vali Acc: 0.672 Test Loss: 1.001 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672212).  Saving model ...
Epoch: 14 cost time: 0.6109869480133057
Epoch: 14, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.944 Vali Acc: 0.722 Test Loss: 0.944 Test Acc: 0.722
Validation loss decreased (-0.672212 --> -0.722213).  Saving model ...
Epoch: 15 cost time: 0.6862483024597168
Epoch: 15, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.930 Vali Acc: 0.711 Test Loss: 0.930 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6459190845489502
Epoch: 16, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.888 Vali Acc: 0.717 Test Loss: 0.888 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6499269008636475
Epoch: 17, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.865 Vali Acc: 0.733 Test Loss: 0.865 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 18 cost time: 0.7362768650054932
Epoch: 18, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.877 Vali Acc: 0.761 Test Loss: 0.877 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761102).  Saving model ...
Epoch: 19 cost time: 0.6712377071380615
Epoch: 19, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.852 Vali Acc: 0.728 Test Loss: 0.852 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6690025329589844
Epoch: 20, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.842 Vali Acc: 0.739 Test Loss: 0.842 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6617639064788818
Epoch: 21, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6968340873718262
Epoch: 22, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6360836029052734
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7066245079040527
Epoch: 24, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6652367115020752
Epoch: 25, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.846 Vali Acc: 0.744 Test Loss: 0.846 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5988204479217529
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.860 Vali Acc: 0.772 Test Loss: 0.860 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 27 cost time: 0.7200896739959717
Epoch: 27, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.854 Vali Acc: 0.756 Test Loss: 0.854 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7095823287963867
Epoch: 28, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.874 Vali Acc: 0.756 Test Loss: 0.874 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6067898273468018
Epoch: 29, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5963361263275146
Epoch: 30, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.860 Vali Acc: 0.778 Test Loss: 0.860 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777769).  Saving model ...
Epoch: 31 cost time: 0.6307640075683594
Epoch: 31, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.894 Vali Acc: 0.778 Test Loss: 0.894 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6577925682067871
Epoch: 32, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.903 Vali Acc: 0.778 Test Loss: 0.903 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6637592315673828
Epoch: 33, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.942 Vali Acc: 0.761 Test Loss: 0.942 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6189289093017578
Epoch: 34, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.625389575958252
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.923 Vali Acc: 0.756 Test Loss: 0.923 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5867311954498291
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.956 Vali Acc: 0.767 Test Loss: 0.956 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6492416858673096
Epoch: 37, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.959 Vali Acc: 0.767 Test Loss: 0.959 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6105766296386719
Epoch: 38, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6312098503112793
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.000 Vali Acc: 0.756 Test Loss: 1.000 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5618939399719238
Epoch: 40, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.996 Vali Acc: 0.767 Test Loss: 0.996 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 161167
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3439748287200928
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.282 Vali Acc: 0.300 Test Loss: 2.282 Test Acc: 0.300
Validation loss decreased (inf --> -0.299977).  Saving model ...
Epoch: 2 cost time: 0.9881694316864014
Epoch: 2, Steps: 12 | Train Loss: 1.928 Vali Loss: 1.663 Vali Acc: 0.517 Test Loss: 1.663 Test Acc: 0.517
Validation loss decreased (-0.299977 --> -0.516650).  Saving model ...
Epoch: 3 cost time: 1.0026700496673584
Epoch: 3, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.412 Vali Acc: 0.589 Test Loss: 1.412 Test Acc: 0.589
Validation loss decreased (-0.516650 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 0.8971915245056152
Epoch: 4, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.278 Vali Acc: 0.628 Test Loss: 1.278 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 5 cost time: 0.8634543418884277
Epoch: 5, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.290 Vali Acc: 0.628 Test Loss: 1.290 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8539206981658936
Epoch: 6, Steps: 12 | Train Loss: 0.654 Vali Loss: 1.224 Vali Acc: 0.667 Test Loss: 1.224 Test Acc: 0.667
Validation loss decreased (-0.627765 --> -0.666654).  Saving model ...
Epoch: 7 cost time: 0.8517053127288818
Epoch: 7, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.110 Vali Acc: 0.706 Test Loss: 1.110 Test Acc: 0.706
Validation loss decreased (-0.666654 --> -0.705544).  Saving model ...
Epoch: 8 cost time: 0.8670861721038818
Epoch: 8, Steps: 12 | Train Loss: 0.565 Vali Loss: 1.107 Vali Acc: 0.711 Test Loss: 1.107 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711100).  Saving model ...
Epoch: 9 cost time: 0.8244953155517578
Epoch: 9, Steps: 12 | Train Loss: 0.419 Vali Loss: 1.061 Vali Acc: 0.722 Test Loss: 1.061 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 0.9388601779937744
Epoch: 10, Steps: 12 | Train Loss: 0.336 Vali Loss: 1.145 Vali Acc: 0.733 Test Loss: 1.145 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 0.9059040546417236
Epoch: 11, Steps: 12 | Train Loss: 0.278 Vali Loss: 1.226 Vali Acc: 0.706 Test Loss: 1.226 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8890902996063232
Epoch: 12, Steps: 12 | Train Loss: 0.308 Vali Loss: 1.266 Vali Acc: 0.706 Test Loss: 1.266 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8888366222381592
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.220 Vali Acc: 0.722 Test Loss: 1.220 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9108932018280029
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.445 Vali Acc: 0.739 Test Loss: 1.445 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738874).  Saving model ...
Epoch: 15 cost time: 0.9667658805847168
Epoch: 15, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.329 Vali Acc: 0.756 Test Loss: 1.329 Test Acc: 0.756
Validation loss decreased (-0.738874 --> -0.755542).  Saving model ...
Epoch: 16 cost time: 0.8537511825561523
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.679 Vali Acc: 0.722 Test Loss: 1.679 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8914954662322998
Epoch: 17, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.500 Vali Acc: 0.733 Test Loss: 1.500 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7848443984985352
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.569 Vali Acc: 0.761 Test Loss: 1.569 Test Acc: 0.761
Validation loss decreased (-0.755542 --> -0.761095).  Saving model ...
Epoch: 19 cost time: 0.8706395626068115
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.728 Vali Acc: 0.733 Test Loss: 1.728 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8828887939453125
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.633 Vali Acc: 0.750 Test Loss: 1.633 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8390307426452637
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.771 Vali Acc: 0.739 Test Loss: 1.771 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9698190689086914
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.756 Vali Acc: 0.728 Test Loss: 1.756 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9573142528533936
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.783 Vali Acc: 0.756 Test Loss: 1.783 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9866628646850586
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.898 Vali Acc: 0.739 Test Loss: 1.898 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8971965312957764
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.862 Vali Acc: 0.756 Test Loss: 1.862 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9453866481781006
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.936 Vali Acc: 0.756 Test Loss: 1.936 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8897349834442139
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.997 Vali Acc: 0.733 Test Loss: 1.997 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8550574779510498
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.932 Vali Acc: 0.756 Test Loss: 1.932 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 272911
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.052628755569458
Epoch: 1, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.403 Vali Acc: 0.256 Test Loss: 2.403 Test Acc: 0.256
Validation loss decreased (inf --> -0.255532).  Saving model ...
Epoch: 2 cost time: 0.7308425903320312
Epoch: 2, Steps: 12 | Train Loss: 2.156 Vali Loss: 1.930 Vali Acc: 0.472 Test Loss: 1.930 Test Acc: 0.472
Validation loss decreased (-0.255532 --> -0.472203).  Saving model ...
Epoch: 3 cost time: 0.7035059928894043
Epoch: 3, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.544 Vali Acc: 0.583 Test Loss: 1.544 Test Acc: 0.583
Validation loss decreased (-0.472203 --> -0.583318).  Saving model ...
Epoch: 4 cost time: 0.6797463893890381
Epoch: 4, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.372 Vali Acc: 0.606 Test Loss: 1.372 Test Acc: 0.606
Validation loss decreased (-0.583318 --> -0.605542).  Saving model ...
Epoch: 5 cost time: 0.7608635425567627
Epoch: 5, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.285 Vali Acc: 0.611 Test Loss: 1.285 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 6 cost time: 0.6758849620819092
Epoch: 6, Steps: 12 | Train Loss: 0.894 Vali Loss: 1.291 Vali Acc: 0.622 Test Loss: 1.291 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 7 cost time: 0.6898915767669678
Epoch: 7, Steps: 12 | Train Loss: 0.756 Vali Loss: 1.234 Vali Acc: 0.622 Test Loss: 1.234 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 8 cost time: 0.6889321804046631
Epoch: 8, Steps: 12 | Train Loss: 0.652 Vali Loss: 1.165 Vali Acc: 0.661 Test Loss: 1.165 Test Acc: 0.661
Validation loss decreased (-0.622210 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 0.6574263572692871
Epoch: 9, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.087 Vali Acc: 0.711 Test Loss: 1.087 Test Acc: 0.711
Validation loss decreased (-0.661099 --> -0.711100).  Saving model ...
Epoch: 10 cost time: 0.6623482704162598
Epoch: 10, Steps: 12 | Train Loss: 0.484 Vali Loss: 1.047 Vali Acc: 0.694 Test Loss: 1.047 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5318968296051025
Epoch: 11, Steps: 12 | Train Loss: 0.410 Vali Loss: 1.057 Vali Acc: 0.706 Test Loss: 1.057 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6857938766479492
Epoch: 12, Steps: 12 | Train Loss: 0.311 Vali Loss: 1.048 Vali Acc: 0.728 Test Loss: 1.048 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727767).  Saving model ...
Epoch: 13 cost time: 0.6962404251098633
Epoch: 13, Steps: 12 | Train Loss: 0.287 Vali Loss: 1.063 Vali Acc: 0.717 Test Loss: 1.063 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6904397010803223
Epoch: 14, Steps: 12 | Train Loss: 0.264 Vali Loss: 1.023 Vali Acc: 0.733 Test Loss: 1.023 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 0.7095146179199219
Epoch: 15, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.118 Vali Acc: 0.739 Test Loss: 1.118 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738878).  Saving model ...
Epoch: 16 cost time: 0.6824781894683838
Epoch: 16, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.135 Vali Acc: 0.728 Test Loss: 1.135 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.737602710723877
Epoch: 17, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.161 Vali Acc: 0.733 Test Loss: 1.161 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7074308395385742
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.211 Vali Acc: 0.733 Test Loss: 1.211 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6773872375488281
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.209 Vali Acc: 0.756 Test Loss: 1.209 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755543).  Saving model ...
Epoch: 20 cost time: 0.6419210433959961
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.293 Vali Acc: 0.750 Test Loss: 1.293 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6839432716369629
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.260 Vali Acc: 0.756 Test Loss: 1.260 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7221620082855225
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.297 Vali Acc: 0.761 Test Loss: 1.297 Test Acc: 0.761
Validation loss decreased (-0.755543 --> -0.761098).  Saving model ...
Epoch: 23 cost time: 0.641303539276123
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.317 Vali Acc: 0.761 Test Loss: 1.317 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7907998561859131
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.370 Vali Acc: 0.756 Test Loss: 1.370 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6609780788421631
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.376 Vali Acc: 0.744 Test Loss: 1.376 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6814587116241455
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.391 Vali Acc: 0.739 Test Loss: 1.391 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7300732135772705
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.417 Vali Acc: 0.767 Test Loss: 1.417 Test Acc: 0.767
Validation loss decreased (-0.761098 --> -0.766653).  Saving model ...
Epoch: 28 cost time: 0.6501483917236328
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.467 Vali Acc: 0.761 Test Loss: 1.467 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7275948524475098
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.489 Vali Acc: 0.750 Test Loss: 1.489 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6750462055206299
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.468 Vali Acc: 0.756 Test Loss: 1.468 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7099707126617432
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.486 Vali Acc: 0.767 Test Loss: 1.486 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6387841701507568
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.485 Vali Acc: 0.756 Test Loss: 1.485 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6587283611297607
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.516 Vali Acc: 0.750 Test Loss: 1.516 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6558992862701416
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.517 Vali Acc: 0.744 Test Loss: 1.517 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6340198516845703
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.537 Vali Acc: 0.750 Test Loss: 1.537 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6209759712219238
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.589 Vali Acc: 0.744 Test Loss: 1.589 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7241299152374268
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.541 Vali Acc: 0.761 Test Loss: 1.541 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 188559
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.012223482131958
Epoch: 1, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.415 Vali Acc: 0.256 Test Loss: 2.415 Test Acc: 0.256
Validation loss decreased (inf --> -0.255531).  Saving model ...
Epoch: 2 cost time: 0.643742561340332
Epoch: 2, Steps: 12 | Train Loss: 2.175 Vali Loss: 1.956 Vali Acc: 0.444 Test Loss: 1.956 Test Acc: 0.444
Validation loss decreased (-0.255531 --> -0.444425).  Saving model ...
Epoch: 3 cost time: 0.7231578826904297
Epoch: 3, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.609 Vali Acc: 0.539 Test Loss: 1.609 Test Acc: 0.539
Validation loss decreased (-0.444425 --> -0.538873).  Saving model ...
Epoch: 4 cost time: 0.7076270580291748
Epoch: 4, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.413 Vali Acc: 0.583 Test Loss: 1.413 Test Acc: 0.583
Validation loss decreased (-0.538873 --> -0.583319).  Saving model ...
Epoch: 5 cost time: 0.7390375137329102
Epoch: 5, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.330 Vali Acc: 0.606 Test Loss: 1.330 Test Acc: 0.606
Validation loss decreased (-0.583319 --> -0.605542).  Saving model ...
Epoch: 6 cost time: 0.6753661632537842
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.228 Vali Acc: 0.644 Test Loss: 1.228 Test Acc: 0.644
Validation loss decreased (-0.605542 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 0.650580644607544
Epoch: 7, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.213 Vali Acc: 0.617 Test Loss: 1.213 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.678947925567627
Epoch: 8, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.209 Vali Acc: 0.650 Test Loss: 1.209 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 0.796790361404419
Epoch: 9, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.124 Vali Acc: 0.689 Test Loss: 1.124 Test Acc: 0.689
Validation loss decreased (-0.649988 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 0.7774620056152344
Epoch: 10, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.080 Vali Acc: 0.683 Test Loss: 1.080 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7480249404907227
Epoch: 11, Steps: 12 | Train Loss: 0.423 Vali Loss: 1.056 Vali Acc: 0.700 Test Loss: 1.056 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.6867437362670898
Epoch: 12, Steps: 12 | Train Loss: 0.332 Vali Loss: 1.013 Vali Acc: 0.756 Test Loss: 1.013 Test Acc: 0.756
Validation loss decreased (-0.699989 --> -0.755545).  Saving model ...
Epoch: 13 cost time: 0.7457132339477539
Epoch: 13, Steps: 12 | Train Loss: 0.289 Vali Loss: 1.054 Vali Acc: 0.733 Test Loss: 1.054 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6780152320861816
Epoch: 14, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.026 Vali Acc: 0.733 Test Loss: 1.026 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7342000007629395
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 1.054 Vali Acc: 0.717 Test Loss: 1.054 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7987709045410156
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.086 Vali Acc: 0.739 Test Loss: 1.086 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6991133689880371
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.089 Vali Acc: 0.722 Test Loss: 1.089 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7649438381195068
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.220 Vali Acc: 0.761 Test Loss: 1.220 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761099).  Saving model ...
Epoch: 19 cost time: 0.7890808582305908
Epoch: 19, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.170 Vali Acc: 0.750 Test Loss: 1.170 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6968338489532471
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.275 Vali Acc: 0.728 Test Loss: 1.275 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8372924327850342
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.291 Vali Acc: 0.744 Test Loss: 1.291 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6968643665313721
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.284 Vali Acc: 0.739 Test Loss: 1.284 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8211789131164551
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.435 Vali Acc: 0.717 Test Loss: 1.435 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7368259429931641
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.345 Vali Acc: 0.756 Test Loss: 1.345 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6998786926269531
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.426 Vali Acc: 0.739 Test Loss: 1.426 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7930901050567627
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.392 Vali Acc: 0.761 Test Loss: 1.392 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8135993480682373
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.450 Vali Acc: 0.739 Test Loss: 1.450 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7815723419189453
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.440 Vali Acc: 0.744 Test Loss: 1.440 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 184847
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.14121675491333
Epoch: 1, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.549 Vali Acc: 0.144 Test Loss: 2.549 Test Acc: 0.144
Validation loss decreased (inf --> -0.144419).  Saving model ...
Epoch: 2 cost time: 0.6663691997528076
Epoch: 2, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.074 Vali Acc: 0.417 Test Loss: 2.074 Test Acc: 0.417
Validation loss decreased (-0.144419 --> -0.416646).  Saving model ...
Epoch: 3 cost time: 0.7425596714019775
Epoch: 3, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.721 Vali Acc: 0.550 Test Loss: 1.721 Test Acc: 0.550
Validation loss decreased (-0.416646 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 0.6522574424743652
Epoch: 4, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.519 Vali Acc: 0.578 Test Loss: 1.519 Test Acc: 0.578
Validation loss decreased (-0.549983 --> -0.577763).  Saving model ...
Epoch: 5 cost time: 0.736802339553833
Epoch: 5, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.352 Vali Acc: 0.572 Test Loss: 1.352 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6789956092834473
Epoch: 6, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.259 Vali Acc: 0.628 Test Loss: 1.259 Test Acc: 0.628
Validation loss decreased (-0.577763 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 0.7046427726745605
Epoch: 7, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.210 Vali Acc: 0.656 Test Loss: 1.210 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655543).  Saving model ...
Epoch: 8 cost time: 0.7601699829101562
Epoch: 8, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.169 Vali Acc: 0.667 Test Loss: 1.169 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 0.6991946697235107
Epoch: 9, Steps: 12 | Train Loss: 0.663 Vali Loss: 1.123 Vali Acc: 0.667 Test Loss: 1.123 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 0.7009649276733398
Epoch: 10, Steps: 12 | Train Loss: 0.537 Vali Loss: 1.088 Vali Acc: 0.672 Test Loss: 1.088 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 0.6933162212371826
Epoch: 11, Steps: 12 | Train Loss: 0.460 Vali Loss: 1.021 Vali Acc: 0.683 Test Loss: 1.021 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 12 cost time: 0.6769759654998779
Epoch: 12, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 0.7216963768005371
Epoch: 13, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 0.7157394886016846
Epoch: 14, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.966 Vali Acc: 0.744 Test Loss: 0.966 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 15 cost time: 0.7392642498016357
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.944 Vali Acc: 0.744 Test Loss: 0.944 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 16 cost time: 0.7193970680236816
Epoch: 16, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.994 Vali Acc: 0.722 Test Loss: 0.994 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7231040000915527
Epoch: 17, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.7243936061859131
Epoch: 18, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.008 Vali Acc: 0.739 Test Loss: 1.008 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.705092191696167
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.044 Vali Acc: 0.711 Test Loss: 1.044 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7178006172180176
Epoch: 20, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.994 Vali Acc: 0.761 Test Loss: 0.994 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 21 cost time: 0.7432069778442383
Epoch: 21, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.076 Vali Acc: 0.733 Test Loss: 1.076 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.742293119430542
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.035 Vali Acc: 0.778 Test Loss: 1.035 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777767).  Saving model ...
Epoch: 23 cost time: 0.7365796566009521
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.063 Vali Acc: 0.728 Test Loss: 1.063 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6402652263641357
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.118 Vali Acc: 0.750 Test Loss: 1.118 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7478313446044922
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.115 Vali Acc: 0.744 Test Loss: 1.115 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6906566619873047
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.125 Vali Acc: 0.767 Test Loss: 1.125 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6605234146118164
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.200 Vali Acc: 0.756 Test Loss: 1.200 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.68768310546875
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.157 Vali Acc: 0.772 Test Loss: 1.157 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7462553977966309
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.143 Vali Acc: 0.767 Test Loss: 1.143 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7582201957702637
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.196 Vali Acc: 0.767 Test Loss: 1.196 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7850327491760254
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.190 Vali Acc: 0.756 Test Loss: 1.190 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7556443214416504
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.201 Vali Acc: 0.767 Test Loss: 1.201 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 158095
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1621110439300537
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.587 Vali Acc: 0.100 Test Loss: 2.587 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 0.6142609119415283
Epoch: 2, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.234 Vali Acc: 0.289 Test Loss: 2.234 Test Acc: 0.289
Validation loss decreased (-0.099974 --> -0.288867).  Saving model ...
Epoch: 3 cost time: 0.6879527568817139
Epoch: 3, Steps: 12 | Train Loss: 2.071 Vali Loss: 1.902 Vali Acc: 0.439 Test Loss: 1.902 Test Acc: 0.439
Validation loss decreased (-0.288867 --> -0.438870).  Saving model ...
Epoch: 4 cost time: 0.6762599945068359
Epoch: 4, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.662 Vali Acc: 0.511 Test Loss: 1.662 Test Acc: 0.511
Validation loss decreased (-0.438870 --> -0.511094).  Saving model ...
Epoch: 5 cost time: 0.7100048065185547
Epoch: 5, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.506 Vali Acc: 0.550 Test Loss: 1.506 Test Acc: 0.550
Validation loss decreased (-0.511094 --> -0.549985).  Saving model ...
Epoch: 6 cost time: 0.7466800212860107
Epoch: 6, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.391 Vali Acc: 0.578 Test Loss: 1.391 Test Acc: 0.578
Validation loss decreased (-0.549985 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 0.7177174091339111
Epoch: 7, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.294 Vali Acc: 0.633 Test Loss: 1.294 Test Acc: 0.633
Validation loss decreased (-0.577764 --> -0.633320).  Saving model ...
Epoch: 8 cost time: 0.707700252532959
Epoch: 8, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.237 Vali Acc: 0.644 Test Loss: 1.237 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 0.6991431713104248
Epoch: 9, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.188 Vali Acc: 0.650 Test Loss: 1.188 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.7068867683410645
Epoch: 10, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.180 Vali Acc: 0.672 Test Loss: 1.180 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 0.6914281845092773
Epoch: 11, Steps: 12 | Train Loss: 0.655 Vali Loss: 1.136 Vali Acc: 0.678 Test Loss: 1.136 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 0.7103188037872314
Epoch: 12, Steps: 12 | Train Loss: 0.590 Vali Loss: 1.072 Vali Acc: 0.689 Test Loss: 1.072 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 13 cost time: 0.5756072998046875
Epoch: 13, Steps: 12 | Train Loss: 0.502 Vali Loss: 1.032 Vali Acc: 0.706 Test Loss: 1.032 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 0.6587603092193604
Epoch: 14, Steps: 12 | Train Loss: 0.444 Vali Loss: 1.004 Vali Acc: 0.717 Test Loss: 1.004 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 15 cost time: 0.7437260150909424
Epoch: 15, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.986 Vali Acc: 0.739 Test Loss: 0.986 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738879).  Saving model ...
Epoch: 16 cost time: 0.6918148994445801
Epoch: 16, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.986 Vali Acc: 0.739 Test Loss: 0.986 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6434810161590576
Epoch: 17, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6744935512542725
Epoch: 18, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.924 Vali Acc: 0.756 Test Loss: 0.924 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 19 cost time: 0.6316204071044922
Epoch: 19, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.948 Vali Acc: 0.756 Test Loss: 0.948 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7519419193267822
Epoch: 20, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.956 Vali Acc: 0.756 Test Loss: 0.956 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7444515228271484
Epoch: 21, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.971 Vali Acc: 0.744 Test Loss: 0.971 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6749215126037598
Epoch: 22, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.996 Vali Acc: 0.739 Test Loss: 0.996 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7621004581451416
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.951 Vali Acc: 0.756 Test Loss: 0.951 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6544620990753174
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.033 Vali Acc: 0.761 Test Loss: 1.033 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761101).  Saving model ...
Epoch: 25 cost time: 0.7248377799987793
Epoch: 25, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.002 Vali Acc: 0.728 Test Loss: 1.002 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7136495113372803
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.979 Vali Acc: 0.772 Test Loss: 0.979 Test Acc: 0.772
Validation loss decreased (-0.761101 --> -0.772212).  Saving model ...
Epoch: 27 cost time: 0.712993860244751
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.000 Vali Acc: 0.733 Test Loss: 1.000 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6343324184417725
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.998 Vali Acc: 0.772 Test Loss: 0.998 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6701929569244385
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.034 Vali Acc: 0.778 Test Loss: 1.034 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777767).  Saving model ...
Epoch: 30 cost time: 0.7200396060943604
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.032 Vali Acc: 0.761 Test Loss: 1.032 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.683466911315918
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.043 Vali Acc: 0.761 Test Loss: 1.043 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6686632633209229
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.043 Vali Acc: 0.772 Test Loss: 1.043 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6407902240753174
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.057 Vali Acc: 0.778 Test Loss: 1.057 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.705803632736206
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.120 Vali Acc: 0.772 Test Loss: 1.120 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6334857940673828
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.136 Vali Acc: 0.783 Test Loss: 1.136 Test Acc: 0.783
Validation loss decreased (-0.777767 --> -0.783322).  Saving model ...
Epoch: 36 cost time: 0.7454006671905518
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.119 Vali Acc: 0.756 Test Loss: 1.119 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7271177768707275
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.164 Vali Acc: 0.789 Test Loss: 1.164 Test Acc: 0.789
Validation loss decreased (-0.783322 --> -0.788877).  Saving model ...
Epoch: 38 cost time: 0.6839094161987305
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.188 Vali Acc: 0.756 Test Loss: 1.188 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7323722839355469
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.167 Vali Acc: 0.756 Test Loss: 1.167 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6880245208740234
Epoch: 40, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.146 Vali Acc: 0.761 Test Loss: 1.146 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6927106380462646
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.171 Vali Acc: 0.783 Test Loss: 1.171 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7049565315246582
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.185 Vali Acc: 0.778 Test Loss: 1.185 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6139140129089355
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.177 Vali Acc: 0.744 Test Loss: 1.177 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6608078479766846
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.230 Vali Acc: 0.761 Test Loss: 1.230 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.70054030418396
Epoch: 45, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.198 Vali Acc: 0.756 Test Loss: 1.198 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7222280502319336
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.263 Vali Acc: 0.767 Test Loss: 1.263 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.659543514251709
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.234 Vali Acc: 0.794 Test Loss: 1.234 Test Acc: 0.794
Validation loss decreased (-0.788877 --> -0.794432).  Saving model ...
Epoch: 48 cost time: 0.6512746810913086
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.194 Vali Acc: 0.772 Test Loss: 1.194 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6713964939117432
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.205 Vali Acc: 0.789 Test Loss: 1.205 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6536633968353271
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.202 Vali Acc: 0.783 Test Loss: 1.202 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6802031993865967
Epoch: 51, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.214 Vali Acc: 0.783 Test Loss: 1.214 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7076990604400635
Epoch: 52, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.210 Vali Acc: 0.783 Test Loss: 1.210 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.7016909122467041
Epoch: 53, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.215 Vali Acc: 0.772 Test Loss: 1.215 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6920804977416992
Epoch: 54, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.218 Vali Acc: 0.767 Test Loss: 1.218 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6586654186248779
Epoch: 55, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.235 Vali Acc: 0.772 Test Loss: 1.235 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6586050987243652
Epoch: 56, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.219 Vali Acc: 0.783 Test Loss: 1.219 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6707620620727539
Epoch: 57, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.252 Vali Acc: 0.789 Test Loss: 1.252 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 142991
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.184126853942871
Epoch: 1, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.527 Vali Acc: 0.172 Test Loss: 2.527 Test Acc: 0.172
Validation loss decreased (inf --> -0.172197).  Saving model ...
Epoch: 2 cost time: 0.7443206310272217
Epoch: 2, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.220 Vali Acc: 0.350 Test Loss: 2.220 Test Acc: 0.350
Validation loss decreased (-0.172197 --> -0.349978).  Saving model ...
Epoch: 3 cost time: 0.7212662696838379
Epoch: 3, Steps: 12 | Train Loss: 2.109 Vali Loss: 1.920 Vali Acc: 0.500 Test Loss: 1.920 Test Acc: 0.500
Validation loss decreased (-0.349978 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 0.8029806613922119
Epoch: 4, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.694 Vali Acc: 0.556 Test Loss: 1.694 Test Acc: 0.556
Validation loss decreased (-0.499981 --> -0.555539).  Saving model ...
Epoch: 5 cost time: 0.7402315139770508
Epoch: 5, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.529 Vali Acc: 0.594 Test Loss: 1.529 Test Acc: 0.594
Validation loss decreased (-0.555539 --> -0.594429).  Saving model ...
Epoch: 6 cost time: 0.8216161727905273
Epoch: 6, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.423 Vali Acc: 0.617 Test Loss: 1.423 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616652).  Saving model ...
Epoch: 7 cost time: 0.7417047023773193
Epoch: 7, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.342 Vali Acc: 0.600 Test Loss: 1.342 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.703427791595459
Epoch: 8, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.286 Vali Acc: 0.639 Test Loss: 1.286 Test Acc: 0.639
Validation loss decreased (-0.616652 --> -0.638876).  Saving model ...
Epoch: 9 cost time: 0.6283996105194092
Epoch: 9, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.218 Vali Acc: 0.650 Test Loss: 1.218 Test Acc: 0.650
Validation loss decreased (-0.638876 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.8421177864074707
Epoch: 10, Steps: 12 | Train Loss: 0.761 Vali Loss: 1.143 Vali Acc: 0.644 Test Loss: 1.143 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6179099082946777
Epoch: 11, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.105 Vali Acc: 0.661 Test Loss: 1.105 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 12 cost time: 0.69746994972229
Epoch: 12, Steps: 12 | Train Loss: 0.573 Vali Loss: 1.055 Vali Acc: 0.667 Test Loss: 1.055 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 0.7519559860229492
Epoch: 13, Steps: 12 | Train Loss: 0.499 Vali Loss: 1.007 Vali Acc: 0.661 Test Loss: 1.007 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7255897521972656
Epoch: 14, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.716657).  Saving model ...
Epoch: 15 cost time: 0.7141995429992676
Epoch: 15, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.925 Vali Acc: 0.700 Test Loss: 0.925 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7517268657684326
Epoch: 16, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.918 Vali Acc: 0.711 Test Loss: 0.918 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7676293849945068
Epoch: 17, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.916 Vali Acc: 0.744 Test Loss: 0.916 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744435).  Saving model ...
Epoch: 18 cost time: 0.7199819087982178
Epoch: 18, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.901 Vali Acc: 0.739 Test Loss: 0.901 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6795828342437744
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.883 Vali Acc: 0.744 Test Loss: 0.883 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744436).  Saving model ...
Epoch: 20 cost time: 0.6830370426177979
Epoch: 20, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.909 Vali Acc: 0.733 Test Loss: 0.909 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7143981456756592
Epoch: 21, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.895 Vali Acc: 0.756 Test Loss: 0.895 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 22 cost time: 0.6752872467041016
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7960586547851562
Epoch: 23, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.882 Vali Acc: 0.728 Test Loss: 0.882 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6668505668640137
Epoch: 24, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.890 Vali Acc: 0.756 Test Loss: 0.890 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 25 cost time: 0.7079715728759766
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.914 Vali Acc: 0.728 Test Loss: 0.914 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6020047664642334
Epoch: 26, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6251165866851807
Epoch: 27, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.903 Vali Acc: 0.744 Test Loss: 0.903 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6590292453765869
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.968 Vali Acc: 0.744 Test Loss: 0.968 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6600749492645264
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.943 Vali Acc: 0.711 Test Loss: 0.943 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6735093593597412
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6492509841918945
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.969 Vali Acc: 0.744 Test Loss: 0.969 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6824519634246826
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.033 Vali Acc: 0.739 Test Loss: 1.033 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6886279582977295
Epoch: 33, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.069 Vali Acc: 0.706 Test Loss: 1.069 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.738903284072876
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.042 Vali Acc: 0.733 Test Loss: 1.042 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 135567
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.930116891860962
Epoch: 1, Steps: 12 | Train Loss: 2.885 Vali Loss: 2.818 Vali Acc: 0.083 Test Loss: 2.818 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 0.6004669666290283
Epoch: 2, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.515 Vali Acc: 0.167 Test Loss: 2.515 Test Acc: 0.167
Validation loss decreased (-0.083305 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 0.6439187526702881
Epoch: 3, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.170 Vali Acc: 0.333 Test Loss: 2.170 Test Acc: 0.333
Validation loss decreased (-0.166642 --> -0.333312).  Saving model ...
Epoch: 4 cost time: 0.625194787979126
Epoch: 4, Steps: 12 | Train Loss: 1.967 Vali Loss: 1.890 Vali Acc: 0.478 Test Loss: 1.890 Test Acc: 0.478
Validation loss decreased (-0.333312 --> -0.477759).  Saving model ...
Epoch: 5 cost time: 0.6390297412872314
Epoch: 5, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.690 Vali Acc: 0.533 Test Loss: 1.690 Test Acc: 0.533
Validation loss decreased (-0.477759 --> -0.533316).  Saving model ...
Epoch: 6 cost time: 0.6516087055206299
Epoch: 6, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.515 Vali Acc: 0.561 Test Loss: 1.515 Test Acc: 0.561
Validation loss decreased (-0.533316 --> -0.561096).  Saving model ...
Epoch: 7 cost time: 0.6779258251190186
Epoch: 7, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.411 Vali Acc: 0.600 Test Loss: 1.411 Test Acc: 0.600
Validation loss decreased (-0.561096 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 0.6454176902770996
Epoch: 8, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.334 Vali Acc: 0.600 Test Loss: 1.334 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 0.637568473815918
Epoch: 9, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.240 Vali Acc: 0.633 Test Loss: 1.240 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 0.624622106552124
Epoch: 10, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.182 Vali Acc: 0.639 Test Loss: 1.182 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 11 cost time: 0.6212778091430664
Epoch: 11, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.116 Vali Acc: 0.678 Test Loss: 1.116 Test Acc: 0.678
Validation loss decreased (-0.638877 --> -0.677767).  Saving model ...
Epoch: 12 cost time: 0.6827325820922852
Epoch: 12, Steps: 12 | Train Loss: 0.625 Vali Loss: 1.037 Vali Acc: 0.661 Test Loss: 1.037 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6557538509368896
Epoch: 13, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.016 Vali Acc: 0.672 Test Loss: 1.016 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6839401721954346
Epoch: 14, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.986 Vali Acc: 0.672 Test Loss: 0.986 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6737961769104004
Epoch: 15, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.934 Vali Acc: 0.700 Test Loss: 0.934 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 0.6578056812286377
Epoch: 16, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.890 Vali Acc: 0.711 Test Loss: 0.890 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 17 cost time: 0.6061887741088867
Epoch: 17, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.882 Vali Acc: 0.694 Test Loss: 0.882 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5611522197723389
Epoch: 18, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.877 Vali Acc: 0.722 Test Loss: 0.877 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722213).  Saving model ...
Epoch: 19 cost time: 0.6795759201049805
Epoch: 19, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 20 cost time: 0.675239086151123
Epoch: 20, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.856 Vali Acc: 0.706 Test Loss: 0.856 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6046552658081055
Epoch: 21, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 22 cost time: 0.6694905757904053
Epoch: 22, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6860573291778564
Epoch: 23, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.821 Vali Acc: 0.761 Test Loss: 0.821 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 24 cost time: 0.6850614547729492
Epoch: 24, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.814 Vali Acc: 0.744 Test Loss: 0.814 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6902456283569336
Epoch: 25, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.848 Vali Acc: 0.756 Test Loss: 0.848 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6161050796508789
Epoch: 26, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6484031677246094
Epoch: 27, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6957104206085205
Epoch: 28, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.837 Vali Acc: 0.761 Test Loss: 0.837 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6981644630432129
Epoch: 29, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.851 Vali Acc: 0.772 Test Loss: 0.851 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 30 cost time: 0.6926069259643555
Epoch: 30, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.870 Vali Acc: 0.756 Test Loss: 0.870 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6724300384521484
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.928 Vali Acc: 0.767 Test Loss: 0.928 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6402263641357422
Epoch: 32, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.916 Vali Acc: 0.756 Test Loss: 0.916 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6868062019348145
Epoch: 33, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.914 Vali Acc: 0.772 Test Loss: 0.914 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6384122371673584
Epoch: 34, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.913 Vali Acc: 0.756 Test Loss: 0.913 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6982412338256836
Epoch: 35, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.913 Vali Acc: 0.778 Test Loss: 0.913 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777769).  Saving model ...
Epoch: 36 cost time: 0.6750421524047852
Epoch: 36, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7316429615020752
Epoch: 37, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.988 Vali Acc: 0.761 Test Loss: 0.988 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5996448993682861
Epoch: 38, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.966 Vali Acc: 0.761 Test Loss: 0.966 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6704168319702148
Epoch: 39, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.026 Vali Acc: 0.750 Test Loss: 1.026 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7035155296325684
Epoch: 40, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.995 Vali Acc: 0.756 Test Loss: 0.995 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6989970207214355
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.990 Vali Acc: 0.756 Test Loss: 0.990 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5837557315826416
Epoch: 42, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.970 Vali Acc: 0.756 Test Loss: 0.970 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6227295398712158
Epoch: 43, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.008 Vali Acc: 0.761 Test Loss: 1.008 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6386055946350098
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.041 Vali Acc: 0.756 Test Loss: 1.041 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6383969783782959
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.082 Vali Acc: 0.750 Test Loss: 1.082 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 128271
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.323582410812378
Epoch: 1, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.254 Vali Acc: 0.394 Test Loss: 2.254 Test Acc: 0.394
Validation loss decreased (inf --> -0.394422).  Saving model ...
Epoch: 2 cost time: 0.851309061050415
Epoch: 2, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.617 Vali Acc: 0.528 Test Loss: 1.617 Test Acc: 0.528
Validation loss decreased (-0.394422 --> -0.527762).  Saving model ...
Epoch: 3 cost time: 0.8491353988647461
Epoch: 3, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.434 Vali Acc: 0.600 Test Loss: 1.434 Test Acc: 0.600
Validation loss decreased (-0.527762 --> -0.599986).  Saving model ...
Epoch: 4 cost time: 0.8138365745544434
Epoch: 4, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.292 Vali Acc: 0.633 Test Loss: 1.292 Test Acc: 0.633
Validation loss decreased (-0.599986 --> -0.633320).  Saving model ...
Epoch: 5 cost time: 0.789276123046875
Epoch: 5, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.248 Vali Acc: 0.667 Test Loss: 1.248 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666654).  Saving model ...
Epoch: 6 cost time: 0.8099513053894043
Epoch: 6, Steps: 12 | Train Loss: 0.666 Vali Loss: 1.188 Vali Acc: 0.650 Test Loss: 1.188 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8605127334594727
Epoch: 7, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.122 Vali Acc: 0.700 Test Loss: 1.122 Test Acc: 0.700
Validation loss decreased (-0.666654 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.8073804378509521
Epoch: 8, Steps: 12 | Train Loss: 0.477 Vali Loss: 1.061 Vali Acc: 0.750 Test Loss: 1.061 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 0.7823693752288818
Epoch: 9, Steps: 12 | Train Loss: 0.433 Vali Loss: 1.071 Vali Acc: 0.750 Test Loss: 1.071 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7485065460205078
Epoch: 10, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.115 Vali Acc: 0.733 Test Loss: 1.115 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8464436531066895
Epoch: 11, Steps: 12 | Train Loss: 0.257 Vali Loss: 1.167 Vali Acc: 0.711 Test Loss: 1.167 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8284764289855957
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 1.214 Vali Acc: 0.728 Test Loss: 1.214 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.853888988494873
Epoch: 13, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.404 Vali Acc: 0.717 Test Loss: 1.404 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7987816333770752
Epoch: 14, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.329 Vali Acc: 0.711 Test Loss: 1.329 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8684277534484863
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.388 Vali Acc: 0.722 Test Loss: 1.388 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8091793060302734
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.674 Vali Acc: 0.678 Test Loss: 1.674 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8264956474304199
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.556 Vali Acc: 0.717 Test Loss: 1.556 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8084185123443604
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.578 Vali Acc: 0.739 Test Loss: 1.578 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 256463
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.819443941116333
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.469 Vali Acc: 0.256 Test Loss: 2.469 Test Acc: 0.256
Validation loss decreased (inf --> -0.255531).  Saving model ...
Epoch: 2 cost time: 0.6422755718231201
Epoch: 2, Steps: 12 | Train Loss: 2.279 Vali Loss: 1.904 Vali Acc: 0.511 Test Loss: 1.904 Test Acc: 0.511
Validation loss decreased (-0.255531 --> -0.511092).  Saving model ...
Epoch: 3 cost time: 0.646533727645874
Epoch: 3, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.569 Vali Acc: 0.550 Test Loss: 1.569 Test Acc: 0.550
Validation loss decreased (-0.511092 --> -0.549984).  Saving model ...
Epoch: 4 cost time: 0.6806817054748535
Epoch: 4, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.362 Vali Acc: 0.589 Test Loss: 1.362 Test Acc: 0.589
Validation loss decreased (-0.549984 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 0.6447927951812744
Epoch: 5, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.275 Vali Acc: 0.600 Test Loss: 1.275 Test Acc: 0.600
Validation loss decreased (-0.588875 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 0.6475377082824707
Epoch: 6, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.167 Vali Acc: 0.628 Test Loss: 1.167 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627766).  Saving model ...
Epoch: 7 cost time: 0.6266710758209229
Epoch: 7, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.159 Vali Acc: 0.639 Test Loss: 1.159 Test Acc: 0.639
Validation loss decreased (-0.627766 --> -0.638877).  Saving model ...
Epoch: 8 cost time: 0.6966872215270996
Epoch: 8, Steps: 12 | Train Loss: 0.683 Vali Loss: 1.171 Vali Acc: 0.656 Test Loss: 1.171 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 0.6162495613098145
Epoch: 9, Steps: 12 | Train Loss: 0.583 Vali Loss: 1.060 Vali Acc: 0.672 Test Loss: 1.060 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 0.6346104145050049
Epoch: 10, Steps: 12 | Train Loss: 0.468 Vali Loss: 1.086 Vali Acc: 0.711 Test Loss: 1.086 Test Acc: 0.711
Validation loss decreased (-0.672212 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 0.6095821857452393
Epoch: 11, Steps: 12 | Train Loss: 0.394 Vali Loss: 1.056 Vali Acc: 0.678 Test Loss: 1.056 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6012988090515137
Epoch: 12, Steps: 12 | Train Loss: 0.366 Vali Loss: 1.005 Vali Acc: 0.733 Test Loss: 1.005 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 0.6220641136169434
Epoch: 13, Steps: 12 | Train Loss: 0.280 Vali Loss: 1.012 Vali Acc: 0.744 Test Loss: 1.012 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744434).  Saving model ...
Epoch: 14 cost time: 0.6166048049926758
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.045 Vali Acc: 0.761 Test Loss: 1.045 Test Acc: 0.761
Validation loss decreased (-0.744434 --> -0.761101).  Saving model ...
Epoch: 15 cost time: 0.6361913681030273
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 1.051 Vali Acc: 0.722 Test Loss: 1.051 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6159782409667969
Epoch: 16, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.078 Vali Acc: 0.750 Test Loss: 1.078 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6786239147186279
Epoch: 17, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.077 Vali Acc: 0.739 Test Loss: 1.077 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6653192043304443
Epoch: 18, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.145 Vali Acc: 0.739 Test Loss: 1.145 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7253310680389404
Epoch: 19, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.196 Vali Acc: 0.744 Test Loss: 1.196 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6198215484619141
Epoch: 20, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.221 Vali Acc: 0.756 Test Loss: 1.221 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6554703712463379
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.269 Vali Acc: 0.739 Test Loss: 1.269 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6456358432769775
Epoch: 22, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.352 Vali Acc: 0.733 Test Loss: 1.352 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6697607040405273
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.374 Vali Acc: 0.761 Test Loss: 1.374 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6062908172607422
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.380 Vali Acc: 0.761 Test Loss: 1.380 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 172111
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.115189790725708
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.474 Vali Acc: 0.167 Test Loss: 2.474 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.621307373046875
Epoch: 2, Steps: 12 | Train Loss: 2.170 Vali Loss: 1.954 Vali Acc: 0.417 Test Loss: 1.954 Test Acc: 0.417
Validation loss decreased (-0.166642 --> -0.416647).  Saving model ...
Epoch: 3 cost time: 0.6982779502868652
Epoch: 3, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.595 Vali Acc: 0.544 Test Loss: 1.595 Test Acc: 0.544
Validation loss decreased (-0.416647 --> -0.544428).  Saving model ...
Epoch: 4 cost time: 0.7113502025604248
Epoch: 4, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.414 Vali Acc: 0.578 Test Loss: 1.414 Test Acc: 0.578
Validation loss decreased (-0.544428 --> -0.577764).  Saving model ...
Epoch: 5 cost time: 0.6253271102905273
Epoch: 5, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.311 Vali Acc: 0.611 Test Loss: 1.311 Test Acc: 0.611
Validation loss decreased (-0.577764 --> -0.611098).  Saving model ...
Epoch: 6 cost time: 0.6816182136535645
Epoch: 6, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.267 Vali Acc: 0.611 Test Loss: 1.267 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 0.6747627258300781
Epoch: 7, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.190 Vali Acc: 0.656 Test Loss: 1.190 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655544).  Saving model ...
Epoch: 8 cost time: 0.6654653549194336
Epoch: 8, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.123 Vali Acc: 0.667 Test Loss: 1.123 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 0.6571953296661377
Epoch: 9, Steps: 12 | Train Loss: 0.566 Vali Loss: 1.143 Vali Acc: 0.650 Test Loss: 1.143 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6642591953277588
Epoch: 10, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.059 Vali Acc: 0.700 Test Loss: 1.059 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.6749138832092285
Epoch: 11, Steps: 12 | Train Loss: 0.424 Vali Loss: 1.046 Vali Acc: 0.711 Test Loss: 1.046 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 12 cost time: 0.6502394676208496
Epoch: 12, Steps: 12 | Train Loss: 0.351 Vali Loss: 1.022 Vali Acc: 0.739 Test Loss: 1.022 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 0.6801168918609619
Epoch: 13, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.993 Vali Acc: 0.761 Test Loss: 0.993 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761101).  Saving model ...
Epoch: 14 cost time: 0.6749944686889648
Epoch: 14, Steps: 12 | Train Loss: 0.285 Vali Loss: 1.026 Vali Acc: 0.728 Test Loss: 1.026 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6686229705810547
Epoch: 15, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.032 Vali Acc: 0.733 Test Loss: 1.032 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6577668190002441
Epoch: 16, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.030 Vali Acc: 0.750 Test Loss: 1.030 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5844690799713135
Epoch: 17, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.102 Vali Acc: 0.744 Test Loss: 1.102 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6139774322509766
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.080 Vali Acc: 0.739 Test Loss: 1.080 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7527003288269043
Epoch: 19, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.157 Vali Acc: 0.778 Test Loss: 1.157 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777766).  Saving model ...
Epoch: 20 cost time: 0.7128384113311768
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.195 Vali Acc: 0.761 Test Loss: 1.195 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.645073652267456
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.236 Vali Acc: 0.761 Test Loss: 1.236 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7099969387054443
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.248 Vali Acc: 0.756 Test Loss: 1.248 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.744865894317627
Epoch: 23, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.308 Vali Acc: 0.750 Test Loss: 1.308 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6800487041473389
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.267 Vali Acc: 0.772 Test Loss: 1.267 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6397898197174072
Epoch: 25, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.414 Vali Acc: 0.739 Test Loss: 1.414 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6553859710693359
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.392 Vali Acc: 0.750 Test Loss: 1.392 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6575114727020264
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.408 Vali Acc: 0.744 Test Loss: 1.408 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6536433696746826
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.408 Vali Acc: 0.767 Test Loss: 1.408 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6587066650390625
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.397 Vali Acc: 0.761 Test Loss: 1.397 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 168399
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1823792457580566
Epoch: 1, Steps: 12 | Train Loss: 2.897 Vali Loss: 2.558 Vali Acc: 0.139 Test Loss: 2.558 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.6681437492370605
Epoch: 2, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.103 Vali Acc: 0.456 Test Loss: 2.103 Test Acc: 0.456
Validation loss decreased (-0.138863 --> -0.455535).  Saving model ...
Epoch: 3 cost time: 0.6904747486114502
Epoch: 3, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.747 Vali Acc: 0.500 Test Loss: 1.747 Test Acc: 0.500
Validation loss decreased (-0.455535 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 0.742835521697998
Epoch: 4, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.539 Vali Acc: 0.594 Test Loss: 1.539 Test Acc: 0.594
Validation loss decreased (-0.499983 --> -0.594429).  Saving model ...
Epoch: 5 cost time: 0.7588000297546387
Epoch: 5, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.405 Vali Acc: 0.617 Test Loss: 1.405 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616653).  Saving model ...
Epoch: 6 cost time: 0.6221132278442383
Epoch: 6, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.310 Vali Acc: 0.622 Test Loss: 1.310 Test Acc: 0.622
Validation loss decreased (-0.616653 --> -0.622209).  Saving model ...
Epoch: 7 cost time: 0.7278439998626709
Epoch: 7, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.247 Vali Acc: 0.644 Test Loss: 1.247 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.6614596843719482
Epoch: 8, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.210 Vali Acc: 0.661 Test Loss: 1.210 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 0.6832482814788818
Epoch: 9, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.174 Vali Acc: 0.672 Test Loss: 1.174 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672210).  Saving model ...
Epoch: 10 cost time: 0.6963670253753662
Epoch: 10, Steps: 12 | Train Loss: 0.680 Vali Loss: 1.148 Vali Acc: 0.672 Test Loss: 1.148 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 0.6253292560577393
Epoch: 11, Steps: 12 | Train Loss: 0.592 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.6707193851470947
Epoch: 12, Steps: 12 | Train Loss: 0.441 Vali Loss: 1.026 Vali Acc: 0.717 Test Loss: 1.026 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 0.6639044284820557
Epoch: 13, Steps: 12 | Train Loss: 0.472 Vali Loss: 1.005 Vali Acc: 0.689 Test Loss: 1.005 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.637706995010376
Epoch: 14, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.981 Vali Acc: 0.733 Test Loss: 0.981 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.6164119243621826
Epoch: 15, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.975 Vali Acc: 0.750 Test Loss: 0.975 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.6736359596252441
Epoch: 16, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.964 Vali Acc: 0.744 Test Loss: 0.964 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7446048259735107
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.954 Vali Acc: 0.744 Test Loss: 0.954 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6624376773834229
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.986 Vali Acc: 0.744 Test Loss: 0.986 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7632179260253906
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.010 Vali Acc: 0.733 Test Loss: 1.010 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6519722938537598
Epoch: 20, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.999 Vali Acc: 0.739 Test Loss: 0.999 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7770979404449463
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.988 Vali Acc: 0.772 Test Loss: 0.988 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772212).  Saving model ...
Epoch: 22 cost time: 0.6811673641204834
Epoch: 22, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.049 Vali Acc: 0.761 Test Loss: 1.049 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6410164833068848
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.036 Vali Acc: 0.750 Test Loss: 1.036 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6599082946777344
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.044 Vali Acc: 0.756 Test Loss: 1.044 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6291444301605225
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.111 Vali Acc: 0.744 Test Loss: 1.111 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5885176658630371
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.051 Vali Acc: 0.767 Test Loss: 1.051 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7078194618225098
Epoch: 27, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.117 Vali Acc: 0.767 Test Loss: 1.117 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6358323097229004
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.133 Vali Acc: 0.756 Test Loss: 1.133 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6800053119659424
Epoch: 29, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.156 Vali Acc: 0.756 Test Loss: 1.156 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6408224105834961
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.204 Vali Acc: 0.739 Test Loss: 1.204 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6691553592681885
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.180 Vali Acc: 0.772 Test Loss: 1.180 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 141647
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.206998825073242
Epoch: 1, Steps: 12 | Train Loss: 2.839 Vali Loss: 2.633 Vali Acc: 0.128 Test Loss: 2.633 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.5954804420471191
Epoch: 2, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.270 Vali Acc: 0.356 Test Loss: 2.270 Test Acc: 0.356
Validation loss decreased (-0.127751 --> -0.355533).  Saving model ...
Epoch: 3 cost time: 0.6222584247589111
Epoch: 3, Steps: 12 | Train Loss: 2.069 Vali Loss: 1.908 Vali Acc: 0.467 Test Loss: 1.908 Test Acc: 0.467
Validation loss decreased (-0.355533 --> -0.466648).  Saving model ...
Epoch: 4 cost time: 0.6707193851470947
Epoch: 4, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.651 Vali Acc: 0.550 Test Loss: 1.651 Test Acc: 0.550
Validation loss decreased (-0.466648 --> -0.549983).  Saving model ...
Epoch: 5 cost time: 0.6494486331939697
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.476 Vali Acc: 0.594 Test Loss: 1.476 Test Acc: 0.594
Validation loss decreased (-0.549983 --> -0.594430).  Saving model ...
Epoch: 6 cost time: 0.5854873657226562
Epoch: 6, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.376 Vali Acc: 0.611 Test Loss: 1.376 Test Acc: 0.611
Validation loss decreased (-0.594430 --> -0.611097).  Saving model ...
Epoch: 7 cost time: 0.6284198760986328
Epoch: 7, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.312 Vali Acc: 0.628 Test Loss: 1.312 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627765).  Saving model ...
Epoch: 8 cost time: 0.646660566329956
Epoch: 8, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.281 Vali Acc: 0.622 Test Loss: 1.281 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6308808326721191
Epoch: 9, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.210 Vali Acc: 0.639 Test Loss: 1.210 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 10 cost time: 0.6383090019226074
Epoch: 10, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.160 Vali Acc: 0.650 Test Loss: 1.160 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.679973840713501
Epoch: 11, Steps: 12 | Train Loss: 0.727 Vali Loss: 1.151 Vali Acc: 0.667 Test Loss: 1.151 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 0.6593842506408691
Epoch: 12, Steps: 12 | Train Loss: 0.574 Vali Loss: 1.098 Vali Acc: 0.700 Test Loss: 1.098 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.7229259014129639
Epoch: 13, Steps: 12 | Train Loss: 0.519 Vali Loss: 1.066 Vali Acc: 0.700 Test Loss: 1.066 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.6326208114624023
Epoch: 14, Steps: 12 | Train Loss: 0.492 Vali Loss: 1.047 Vali Acc: 0.706 Test Loss: 1.047 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 15 cost time: 0.5780332088470459
Epoch: 15, Steps: 12 | Train Loss: 0.386 Vali Loss: 1.034 Vali Acc: 0.700 Test Loss: 1.034 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6522006988525391
Epoch: 16, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.937 Vali Acc: 0.744 Test Loss: 0.937 Test Acc: 0.744
Validation loss decreased (-0.705545 --> -0.744435).  Saving model ...
Epoch: 17 cost time: 0.6570215225219727
Epoch: 17, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.968 Vali Acc: 0.711 Test Loss: 0.968 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6449441909790039
Epoch: 18, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 19 cost time: 0.6670928001403809
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.660947322845459
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.947 Vali Acc: 0.756 Test Loss: 0.947 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755546).  Saving model ...
Epoch: 21 cost time: 0.664147138595581
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.935 Vali Acc: 0.767 Test Loss: 0.935 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766657).  Saving model ...
Epoch: 22 cost time: 0.6320226192474365
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.917 Vali Acc: 0.722 Test Loss: 0.917 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6612308025360107
Epoch: 23, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.945 Vali Acc: 0.761 Test Loss: 0.945 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.603649377822876
Epoch: 24, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.967 Vali Acc: 0.744 Test Loss: 0.967 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6288964748382568
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.964 Vali Acc: 0.767 Test Loss: 0.964 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6143920421600342
Epoch: 26, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6122145652770996
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.013 Vali Acc: 0.739 Test Loss: 1.013 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6571907997131348
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.979 Vali Acc: 0.761 Test Loss: 0.979 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7017371654510498
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.021 Vali Acc: 0.772 Test Loss: 1.021 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772212).  Saving model ...
Epoch: 30 cost time: 0.6825025081634521
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.061 Vali Acc: 0.744 Test Loss: 1.061 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6783182621002197
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.043 Vali Acc: 0.772 Test Loss: 1.043 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5979733467102051
Epoch: 32, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.063 Vali Acc: 0.767 Test Loss: 1.063 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6287779808044434
Epoch: 33, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.020 Vali Acc: 0.772 Test Loss: 1.020 Test Acc: 0.772
Validation loss decreased (-0.772212 --> -0.772212).  Saving model ...
Epoch: 34 cost time: 0.6329264640808105
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.064 Vali Acc: 0.750 Test Loss: 1.064 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5648388862609863
Epoch: 35, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.087 Vali Acc: 0.761 Test Loss: 1.087 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5898041725158691
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.099 Vali Acc: 0.772 Test Loss: 1.099 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6221497058868408
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.118 Vali Acc: 0.767 Test Loss: 1.118 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7335770130157471
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.115 Vali Acc: 0.772 Test Loss: 1.115 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6517565250396729
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.160 Vali Acc: 0.772 Test Loss: 1.160 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7028253078460693
Epoch: 40, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.158 Vali Acc: 0.750 Test Loss: 1.158 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6767990589141846
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.172 Vali Acc: 0.761 Test Loss: 1.172 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6465551853179932
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.194 Vali Acc: 0.772 Test Loss: 1.194 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6495950222015381
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.231 Vali Acc: 0.778 Test Loss: 1.231 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777765).  Saving model ...
Epoch: 44 cost time: 0.6849715709686279
Epoch: 44, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.211 Vali Acc: 0.756 Test Loss: 1.211 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6753830909729004
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.209 Vali Acc: 0.767 Test Loss: 1.209 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5888721942901611
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.213 Vali Acc: 0.744 Test Loss: 1.213 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6680417060852051
Epoch: 47, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.211 Vali Acc: 0.767 Test Loss: 1.211 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.653364896774292
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.220 Vali Acc: 0.767 Test Loss: 1.220 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7176568508148193
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.228 Vali Acc: 0.772 Test Loss: 1.228 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6595604419708252
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.227 Vali Acc: 0.767 Test Loss: 1.227 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7419257164001465
Epoch: 51, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.218 Vali Acc: 0.783 Test Loss: 1.218 Test Acc: 0.783
Validation loss decreased (-0.777765 --> -0.783321).  Saving model ...
Epoch: 52 cost time: 0.6412248611450195
Epoch: 52, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.225 Vali Acc: 0.783 Test Loss: 1.225 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6468713283538818
Epoch: 53, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.275 Vali Acc: 0.772 Test Loss: 1.275 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6638047695159912
Epoch: 54, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.259 Vali Acc: 0.772 Test Loss: 1.259 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6308066844940186
Epoch: 55, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.325 Vali Acc: 0.767 Test Loss: 1.325 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.7232873439788818
Epoch: 56, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.272 Vali Acc: 0.778 Test Loss: 1.272 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.6712687015533447
Epoch: 57, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.288 Vali Acc: 0.778 Test Loss: 1.288 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.7435195446014404
Epoch: 58, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.393 Vali Acc: 0.767 Test Loss: 1.393 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.6692774295806885
Epoch: 59, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.366 Vali Acc: 0.772 Test Loss: 1.366 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.6136207580566406
Epoch: 60, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.353 Vali Acc: 0.772 Test Loss: 1.353 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.7356932163238525
Epoch: 61, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.431 Vali Acc: 0.778 Test Loss: 1.431 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 126543
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9932787418365479
Epoch: 1, Steps: 12 | Train Loss: 2.843 Vali Loss: 2.604 Vali Acc: 0.144 Test Loss: 2.604 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 0.641639232635498
Epoch: 2, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.259 Vali Acc: 0.317 Test Loss: 2.259 Test Acc: 0.317
Validation loss decreased (-0.144418 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 0.6333127021789551
Epoch: 3, Steps: 12 | Train Loss: 2.155 Vali Loss: 1.923 Vali Acc: 0.483 Test Loss: 1.923 Test Acc: 0.483
Validation loss decreased (-0.316644 --> -0.483314).  Saving model ...
Epoch: 4 cost time: 0.6037566661834717
Epoch: 4, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.687 Vali Acc: 0.539 Test Loss: 1.687 Test Acc: 0.539
Validation loss decreased (-0.483314 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 0.5746276378631592
Epoch: 5, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.533 Vali Acc: 0.561 Test Loss: 1.533 Test Acc: 0.561
Validation loss decreased (-0.538872 --> -0.561096).  Saving model ...
Epoch: 6 cost time: 0.5808541774749756
Epoch: 6, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.423 Vali Acc: 0.589 Test Loss: 1.423 Test Acc: 0.589
Validation loss decreased (-0.561096 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 0.6214308738708496
Epoch: 7, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.316 Vali Acc: 0.594 Test Loss: 1.316 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594431).  Saving model ...
Epoch: 8 cost time: 0.6406910419464111
Epoch: 8, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.234 Vali Acc: 0.611 Test Loss: 1.234 Test Acc: 0.611
Validation loss decreased (-0.594431 --> -0.611099).  Saving model ...
Epoch: 9 cost time: 0.624744176864624
Epoch: 9, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.167 Vali Acc: 0.639 Test Loss: 1.167 Test Acc: 0.639
Validation loss decreased (-0.611099 --> -0.638877).  Saving model ...
Epoch: 10 cost time: 0.620495080947876
Epoch: 10, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.082 Vali Acc: 0.656 Test Loss: 1.082 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655545).  Saving model ...
Epoch: 11 cost time: 0.6431090831756592
Epoch: 11, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.020 Vali Acc: 0.678 Test Loss: 1.020 Test Acc: 0.678
Validation loss decreased (-0.655545 --> -0.677768).  Saving model ...
Epoch: 12 cost time: 0.6603968143463135
Epoch: 12, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.969 Vali Acc: 0.683 Test Loss: 0.969 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 13 cost time: 0.599311351776123
Epoch: 13, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.951 Vali Acc: 0.689 Test Loss: 0.951 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688879).  Saving model ...
Epoch: 14 cost time: 0.6708805561065674
Epoch: 14, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 15 cost time: 0.6499457359313965
Epoch: 15, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.907 Vali Acc: 0.711 Test Loss: 0.907 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 16 cost time: 0.649867057800293
Epoch: 16, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.855 Vali Acc: 0.744 Test Loss: 0.855 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 0.6383705139160156
Epoch: 17, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.828 Vali Acc: 0.733 Test Loss: 0.828 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5782990455627441
Epoch: 18, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.816 Vali Acc: 0.761 Test Loss: 0.816 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 19 cost time: 0.6255111694335938
Epoch: 19, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.817 Vali Acc: 0.733 Test Loss: 0.817 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6933169364929199
Epoch: 20, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.834 Vali Acc: 0.761 Test Loss: 0.834 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5998106002807617
Epoch: 21, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6757326126098633
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.844 Vali Acc: 0.722 Test Loss: 0.844 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6086652278900146
Epoch: 23, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.838 Vali Acc: 0.756 Test Loss: 0.838 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5867829322814941
Epoch: 24, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.867 Vali Acc: 0.756 Test Loss: 0.867 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6283071041107178
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.866 Vali Acc: 0.767 Test Loss: 0.866 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 26 cost time: 0.591465950012207
Epoch: 26, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5852475166320801
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.909 Vali Acc: 0.733 Test Loss: 0.909 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7323927879333496
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.62091064453125
Epoch: 29, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.897 Vali Acc: 0.756 Test Loss: 0.897 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.677485466003418
Epoch: 30, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.911 Vali Acc: 0.739 Test Loss: 0.911 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6791963577270508
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.914 Vali Acc: 0.756 Test Loss: 0.914 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.707007646560669
Epoch: 32, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.924 Vali Acc: 0.728 Test Loss: 0.924 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5674405097961426
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.968 Vali Acc: 0.739 Test Loss: 0.968 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6313958168029785
Epoch: 34, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.950 Vali Acc: 0.767 Test Loss: 0.950 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6497530937194824
Epoch: 35, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.979 Vali Acc: 0.756 Test Loss: 0.979 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 119119
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.070976495742798
Epoch: 1, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.588 Vali Acc: 0.183 Test Loss: 2.588 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 0.6677861213684082
Epoch: 2, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.328 Vali Acc: 0.328 Test Loss: 2.328 Test Acc: 0.328
Validation loss decreased (-0.183307 --> -0.327754).  Saving model ...
Epoch: 3 cost time: 0.7598330974578857
Epoch: 3, Steps: 12 | Train Loss: 2.185 Vali Loss: 2.051 Vali Acc: 0.450 Test Loss: 2.051 Test Acc: 0.450
Validation loss decreased (-0.327754 --> -0.449979).  Saving model ...
Epoch: 4 cost time: 0.5712590217590332
Epoch: 4, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.828 Vali Acc: 0.511 Test Loss: 1.828 Test Acc: 0.511
Validation loss decreased (-0.449979 --> -0.511093).  Saving model ...
Epoch: 5 cost time: 0.7315738201141357
Epoch: 5, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.663 Vali Acc: 0.533 Test Loss: 1.663 Test Acc: 0.533
Validation loss decreased (-0.511093 --> -0.533317).  Saving model ...
Epoch: 6 cost time: 0.6150078773498535
Epoch: 6, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.539 Vali Acc: 0.561 Test Loss: 1.539 Test Acc: 0.561
Validation loss decreased (-0.533317 --> -0.561096).  Saving model ...
Epoch: 7 cost time: 0.6373765468597412
Epoch: 7, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.447 Vali Acc: 0.594 Test Loss: 1.447 Test Acc: 0.594
Validation loss decreased (-0.561096 --> -0.594430).  Saving model ...
Epoch: 8 cost time: 0.6304161548614502
Epoch: 8, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.370 Vali Acc: 0.594 Test Loss: 1.370 Test Acc: 0.594
Validation loss decreased (-0.594430 --> -0.594431).  Saving model ...
Epoch: 9 cost time: 0.6879236698150635
Epoch: 9, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.277 Vali Acc: 0.600 Test Loss: 1.277 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599987).  Saving model ...
Epoch: 10 cost time: 0.7042036056518555
Epoch: 10, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.218 Vali Acc: 0.633 Test Loss: 1.218 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 0.683964729309082
Epoch: 11, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.135 Vali Acc: 0.633 Test Loss: 1.135 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633322).  Saving model ...
Epoch: 12 cost time: 0.6135964393615723
Epoch: 12, Steps: 12 | Train Loss: 0.719 Vali Loss: 1.065 Vali Acc: 0.667 Test Loss: 1.065 Test Acc: 0.667
Validation loss decreased (-0.633322 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 0.6662077903747559
Epoch: 13, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.979 Vali Acc: 0.683 Test Loss: 0.979 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683324).  Saving model ...
Epoch: 14 cost time: 0.6964397430419922
Epoch: 14, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.928 Vali Acc: 0.694 Test Loss: 0.928 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694435).  Saving model ...
Epoch: 15 cost time: 0.6318633556365967
Epoch: 15, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.915 Vali Acc: 0.694 Test Loss: 0.915 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 16 cost time: 0.6883280277252197
Epoch: 16, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722213).  Saving model ...
Epoch: 17 cost time: 0.7273969650268555
Epoch: 17, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 18 cost time: 0.7244040966033936
Epoch: 18, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.858 Vali Acc: 0.706 Test Loss: 0.858 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6410636901855469
Epoch: 19, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.870 Vali Acc: 0.717 Test Loss: 0.870 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7302460670471191
Epoch: 20, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5993573665618896
Epoch: 21, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.876 Vali Acc: 0.722 Test Loss: 0.876 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6800968647003174
Epoch: 22, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.871 Vali Acc: 0.728 Test Loss: 0.871 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6828403472900391
Epoch: 23, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.821 Vali Acc: 0.744 Test Loss: 0.821 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 0.644249439239502
Epoch: 24, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.845 Vali Acc: 0.739 Test Loss: 0.845 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7096817493438721
Epoch: 25, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.857 Vali Acc: 0.756 Test Loss: 0.857 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 26 cost time: 0.6705591678619385
Epoch: 26, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.862 Vali Acc: 0.761 Test Loss: 0.862 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 27 cost time: 0.6566390991210938
Epoch: 27, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6461355686187744
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.844 Vali Acc: 0.761 Test Loss: 0.844 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761103).  Saving model ...
Epoch: 29 cost time: 0.5882043838500977
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.823 Vali Acc: 0.756 Test Loss: 0.823 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6251552104949951
Epoch: 30, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.830 Vali Acc: 0.767 Test Loss: 0.830 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 31 cost time: 0.682997465133667
Epoch: 31, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.856 Vali Acc: 0.772 Test Loss: 0.856 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 32 cost time: 0.6728527545928955
Epoch: 32, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.851 Vali Acc: 0.767 Test Loss: 0.851 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6949765682220459
Epoch: 33, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.904 Vali Acc: 0.756 Test Loss: 0.904 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6826872825622559
Epoch: 34, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.903 Vali Acc: 0.761 Test Loss: 0.903 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.789165735244751
Epoch: 35, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.925 Vali Acc: 0.756 Test Loss: 0.925 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.687220573425293
Epoch: 36, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6041464805603027
Epoch: 37, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.917 Vali Acc: 0.772 Test Loss: 0.917 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.690772533416748
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.931 Vali Acc: 0.778 Test Loss: 0.931 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777768).  Saving model ...
Epoch: 39 cost time: 0.6430563926696777
Epoch: 39, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.921 Vali Acc: 0.789 Test Loss: 0.921 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788880).  Saving model ...
Epoch: 40 cost time: 0.6572377681732178
Epoch: 40, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.881 Vali Acc: 0.772 Test Loss: 0.881 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6698567867279053
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.953 Vali Acc: 0.772 Test Loss: 0.953 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5837640762329102
Epoch: 42, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.926 Vali Acc: 0.794 Test Loss: 0.926 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794435).  Saving model ...
Epoch: 43 cost time: 0.6458420753479004
Epoch: 43, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.942 Vali Acc: 0.789 Test Loss: 0.942 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6595363616943359
Epoch: 44, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.972 Vali Acc: 0.772 Test Loss: 0.972 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6295342445373535
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.966 Vali Acc: 0.794 Test Loss: 0.966 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7068030834197998
Epoch: 46, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.984 Vali Acc: 0.789 Test Loss: 0.984 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6158571243286133
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.957 Vali Acc: 0.778 Test Loss: 0.957 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8141913414001465
Epoch: 48, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.986 Vali Acc: 0.789 Test Loss: 0.986 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7608740329742432
Epoch: 49, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.012 Vali Acc: 0.794 Test Loss: 1.012 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6521685123443604
Epoch: 50, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.008 Vali Acc: 0.794 Test Loss: 1.008 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7550749778747559
Epoch: 51, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.006 Vali Acc: 0.800 Test Loss: 1.006 Test Acc: 0.800
Validation loss decreased (-0.794435 --> -0.799990).  Saving model ...
Epoch: 52 cost time: 0.690056562423706
Epoch: 52, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.021 Vali Acc: 0.806 Test Loss: 1.021 Test Acc: 0.806
Validation loss decreased (-0.799990 --> -0.805545).  Saving model ...
Epoch: 53 cost time: 0.658165693283081
Epoch: 53, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.043 Vali Acc: 0.800 Test Loss: 1.043 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6568078994750977
Epoch: 54, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.022 Vali Acc: 0.789 Test Loss: 1.022 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6194157600402832
Epoch: 55, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.031 Vali Acc: 0.794 Test Loss: 1.031 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6058568954467773
Epoch: 56, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.066 Vali Acc: 0.800 Test Loss: 1.066 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.673067569732666
Epoch: 57, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.066 Vali Acc: 0.800 Test Loss: 1.066 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6630041599273682
Epoch: 58, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.060 Vali Acc: 0.789 Test Loss: 1.060 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6501917839050293
Epoch: 59, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.056 Vali Acc: 0.789 Test Loss: 1.056 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7075755596160889
Epoch: 60, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.093 Vali Acc: 0.789 Test Loss: 1.093 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.6545760631561279
Epoch: 61, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.099 Vali Acc: 0.794 Test Loss: 1.099 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.6269798278808594
Epoch: 62, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.041 Vali Acc: 0.817 Test Loss: 1.041 Test Acc: 0.817
Validation loss decreased (-0.805545 --> -0.816656).  Saving model ...
Epoch: 63 cost time: 0.7092874050140381
Epoch: 63, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.053 Vali Acc: 0.817 Test Loss: 1.053 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5881643295288086
Epoch: 64, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.077 Vali Acc: 0.800 Test Loss: 1.077 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.6360874176025391
Epoch: 65, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.085 Vali Acc: 0.794 Test Loss: 1.085 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.7129414081573486
Epoch: 66, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.080 Vali Acc: 0.800 Test Loss: 1.080 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7136819362640381
Epoch: 67, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.072 Vali Acc: 0.794 Test Loss: 1.072 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.6932437419891357
Epoch: 68, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.105 Vali Acc: 0.806 Test Loss: 1.105 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.642545223236084
Epoch: 69, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.107 Vali Acc: 0.806 Test Loss: 1.107 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5883619785308838
Epoch: 70, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.183 Vali Acc: 0.800 Test Loss: 1.183 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6576848030090332
Epoch: 71, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.153 Vali Acc: 0.794 Test Loss: 1.153 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.6267902851104736
Epoch: 72, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.138 Vali Acc: 0.806 Test Loss: 1.138 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm128_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 111823
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9855906963348389
Epoch: 1, Steps: 12 | Train Loss: 2.784 Vali Loss: 2.527 Vali Acc: 0.217 Test Loss: 2.527 Test Acc: 0.217
Validation loss decreased (inf --> -0.216641).  Saving model ...
Epoch: 2 cost time: 0.7223296165466309
Epoch: 2, Steps: 12 | Train Loss: 2.228 Vali Loss: 1.966 Vali Acc: 0.422 Test Loss: 1.966 Test Acc: 0.422
Validation loss decreased (-0.216641 --> -0.422203).  Saving model ...
Epoch: 3 cost time: 0.6815710067749023
Epoch: 3, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.609 Vali Acc: 0.539 Test Loss: 1.609 Test Acc: 0.539
Validation loss decreased (-0.422203 --> -0.538873).  Saving model ...
Epoch: 4 cost time: 0.7234272956848145
Epoch: 4, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.419 Vali Acc: 0.578 Test Loss: 1.419 Test Acc: 0.578
Validation loss decreased (-0.538873 --> -0.577764).  Saving model ...
Epoch: 5 cost time: 0.6995089054107666
Epoch: 5, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.326 Vali Acc: 0.600 Test Loss: 1.326 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 0.7149372100830078
Epoch: 6, Steps: 12 | Train Loss: 0.901 Vali Loss: 1.281 Vali Acc: 0.617 Test Loss: 1.281 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 7 cost time: 0.6961946487426758
Epoch: 7, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.238 Vali Acc: 0.639 Test Loss: 1.238 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 8 cost time: 0.6838772296905518
Epoch: 8, Steps: 12 | Train Loss: 0.651 Vali Loss: 1.158 Vali Acc: 0.672 Test Loss: 1.158 Test Acc: 0.672
Validation loss decreased (-0.638877 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 0.6244156360626221
Epoch: 9, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.073 Vali Acc: 0.661 Test Loss: 1.073 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6381821632385254
Epoch: 10, Steps: 12 | Train Loss: 0.517 Vali Loss: 1.099 Vali Acc: 0.656 Test Loss: 1.099 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6660242080688477
Epoch: 11, Steps: 12 | Train Loss: 0.432 Vali Loss: 1.051 Vali Acc: 0.694 Test Loss: 1.051 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 0.6743793487548828
Epoch: 12, Steps: 12 | Train Loss: 0.394 Vali Loss: 1.040 Vali Acc: 0.728 Test Loss: 1.040 Test Acc: 0.728
Validation loss decreased (-0.694434 --> -0.727767).  Saving model ...
Epoch: 13 cost time: 0.7687227725982666
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 1.059 Vali Acc: 0.728 Test Loss: 1.059 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.712824821472168
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.031 Vali Acc: 0.711 Test Loss: 1.031 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6453135013580322
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 1.090 Vali Acc: 0.706 Test Loss: 1.090 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6846935749053955
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.091 Vali Acc: 0.739 Test Loss: 1.091 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738878).  Saving model ...
Epoch: 17 cost time: 0.6908988952636719
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.201 Vali Acc: 0.733 Test Loss: 1.201 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7048037052154541
Epoch: 18, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.213 Vali Acc: 0.694 Test Loss: 1.213 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7247977256774902
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.235 Vali Acc: 0.733 Test Loss: 1.235 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6814162731170654
Epoch: 20, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.253 Vali Acc: 0.728 Test Loss: 1.253 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7481508255004883
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.247 Vali Acc: 0.756 Test Loss: 1.247 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755543).  Saving model ...
Epoch: 22 cost time: 0.7171101570129395
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.351 Vali Acc: 0.706 Test Loss: 1.351 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7193231582641602
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.305 Vali Acc: 0.750 Test Loss: 1.305 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6580288410186768
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.394 Vali Acc: 0.739 Test Loss: 1.394 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6935732364654541
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.388 Vali Acc: 0.717 Test Loss: 1.388 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6526377201080322
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.464 Vali Acc: 0.728 Test Loss: 1.464 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6268119812011719
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.440 Vali Acc: 0.733 Test Loss: 1.440 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6580972671508789
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.518 Vali Acc: 0.739 Test Loss: 1.518 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7268712520599365
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.469 Vali Acc: 0.733 Test Loss: 1.469 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7596206665039062
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.518 Vali Acc: 0.744 Test Loss: 1.518 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6725006103515625
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.641 Vali Acc: 0.728 Test Loss: 1.641 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 136655
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.043140411376953
Epoch: 1, Steps: 12 | Train Loss: 2.771 Vali Loss: 2.657 Vali Acc: 0.133 Test Loss: 2.657 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 0.5914254188537598
Epoch: 2, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.306 Vali Acc: 0.306 Test Loss: 2.306 Test Acc: 0.306
Validation loss decreased (-0.133307 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 0.6575160026550293
Epoch: 3, Steps: 12 | Train Loss: 2.040 Vali Loss: 1.972 Vali Acc: 0.444 Test Loss: 1.972 Test Acc: 0.444
Validation loss decreased (-0.305532 --> -0.444425).  Saving model ...
Epoch: 4 cost time: 0.6044430732727051
Epoch: 4, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.720 Vali Acc: 0.517 Test Loss: 1.720 Test Acc: 0.517
Validation loss decreased (-0.444425 --> -0.516649).  Saving model ...
Epoch: 5 cost time: 0.6170525550842285
Epoch: 5, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.542 Vali Acc: 0.556 Test Loss: 1.542 Test Acc: 0.556
Validation loss decreased (-0.516649 --> -0.555540).  Saving model ...
Epoch: 6 cost time: 0.6270177364349365
Epoch: 6, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.422 Vali Acc: 0.578 Test Loss: 1.422 Test Acc: 0.578
Validation loss decreased (-0.555540 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 0.6015639305114746
Epoch: 7, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.338 Vali Acc: 0.606 Test Loss: 1.338 Test Acc: 0.606
Validation loss decreased (-0.577764 --> -0.605542).  Saving model ...
Epoch: 8 cost time: 0.6272087097167969
Epoch: 8, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.283 Vali Acc: 0.611 Test Loss: 1.283 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 9 cost time: 0.6544086933135986
Epoch: 9, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.220 Vali Acc: 0.650 Test Loss: 1.220 Test Acc: 0.650
Validation loss decreased (-0.611098 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.5932137966156006
Epoch: 10, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.149 Vali Acc: 0.667 Test Loss: 1.149 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666655).  Saving model ...
Epoch: 11 cost time: 0.6105117797851562
Epoch: 11, Steps: 12 | Train Loss: 0.637 Vali Loss: 1.104 Vali Acc: 0.689 Test Loss: 1.104 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 0.6354598999023438
Epoch: 12, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.093 Vali Acc: 0.678 Test Loss: 1.093 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6188061237335205
Epoch: 13, Steps: 12 | Train Loss: 0.538 Vali Loss: 1.066 Vali Acc: 0.694 Test Loss: 1.066 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 14 cost time: 0.6275849342346191
Epoch: 14, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.990 Vali Acc: 0.706 Test Loss: 0.990 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 15 cost time: 0.6113977432250977
Epoch: 15, Steps: 12 | Train Loss: 0.375 Vali Loss: 1.015 Vali Acc: 0.717 Test Loss: 1.015 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 16 cost time: 0.6316814422607422
Epoch: 16, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.992 Vali Acc: 0.722 Test Loss: 0.992 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 0.6233170032501221
Epoch: 17, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.981 Vali Acc: 0.722 Test Loss: 0.981 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 18 cost time: 0.6393246650695801
Epoch: 18, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.996 Vali Acc: 0.733 Test Loss: 0.996 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 19 cost time: 0.6413946151733398
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 1.037 Vali Acc: 0.744 Test Loss: 1.037 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744434).  Saving model ...
Epoch: 20 cost time: 0.6164181232452393
Epoch: 20, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.005 Vali Acc: 0.739 Test Loss: 1.005 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6255497932434082
Epoch: 21, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.998 Vali Acc: 0.739 Test Loss: 0.998 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.622525691986084
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.066 Vali Acc: 0.739 Test Loss: 1.066 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6437644958496094
Epoch: 23, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.063 Vali Acc: 0.750 Test Loss: 1.063 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749989).  Saving model ...
Epoch: 24 cost time: 0.6523692607879639
Epoch: 24, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.070 Vali Acc: 0.767 Test Loss: 1.070 Test Acc: 0.767
Validation loss decreased (-0.749989 --> -0.766656).  Saving model ...
Epoch: 25 cost time: 0.627173900604248
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.111 Vali Acc: 0.739 Test Loss: 1.111 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6276729106903076
Epoch: 26, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.105 Vali Acc: 0.744 Test Loss: 1.105 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6900730133056641
Epoch: 27, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.157 Vali Acc: 0.744 Test Loss: 1.157 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6553146839141846
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.219 Vali Acc: 0.733 Test Loss: 1.219 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5827412605285645
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.195 Vali Acc: 0.750 Test Loss: 1.195 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6409893035888672
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.211 Vali Acc: 0.750 Test Loss: 1.211 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5934567451477051
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.232 Vali Acc: 0.756 Test Loss: 1.232 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6023550033569336
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.203 Vali Acc: 0.772 Test Loss: 1.203 Test Acc: 0.772
Validation loss decreased (-0.766656 --> -0.772210).  Saving model ...
Epoch: 33 cost time: 0.5954375267028809
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.291 Vali Acc: 0.739 Test Loss: 1.291 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6551268100738525
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.230 Vali Acc: 0.767 Test Loss: 1.230 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6413486003875732
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.277 Vali Acc: 0.761 Test Loss: 1.277 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6106457710266113
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.282 Vali Acc: 0.761 Test Loss: 1.282 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5239593982696533
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.291 Vali Acc: 0.756 Test Loss: 1.291 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5439412593841553
Epoch: 38, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.297 Vali Acc: 0.750 Test Loss: 1.297 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6356608867645264
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.289 Vali Acc: 0.756 Test Loss: 1.289 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7091224193572998
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.348 Vali Acc: 0.756 Test Loss: 1.348 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6270413398742676
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.364 Vali Acc: 0.739 Test Loss: 1.364 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6328005790710449
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.345 Vali Acc: 0.767 Test Loss: 1.345 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 94479
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9540655612945557
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.637 Vali Acc: 0.222 Test Loss: 2.637 Test Acc: 0.222
Validation loss decreased (inf --> -0.222196).  Saving model ...
Epoch: 2 cost time: 0.5999510288238525
Epoch: 2, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.244 Vali Acc: 0.394 Test Loss: 2.244 Test Acc: 0.394
Validation loss decreased (-0.222196 --> -0.394422).  Saving model ...
Epoch: 3 cost time: 0.560133695602417
Epoch: 3, Steps: 12 | Train Loss: 2.005 Vali Loss: 1.916 Vali Acc: 0.478 Test Loss: 1.916 Test Acc: 0.478
Validation loss decreased (-0.394422 --> -0.477759).  Saving model ...
Epoch: 4 cost time: 0.6317489147186279
Epoch: 4, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.679 Vali Acc: 0.522 Test Loss: 1.679 Test Acc: 0.522
Validation loss decreased (-0.477759 --> -0.522205).  Saving model ...
Epoch: 5 cost time: 0.6209404468536377
Epoch: 5, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.517 Vali Acc: 0.583 Test Loss: 1.517 Test Acc: 0.583
Validation loss decreased (-0.522205 --> -0.583318).  Saving model ...
Epoch: 6 cost time: 0.5643143653869629
Epoch: 6, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.424 Vali Acc: 0.589 Test Loss: 1.424 Test Acc: 0.589
Validation loss decreased (-0.583318 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 0.6048738956451416
Epoch: 7, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.367 Vali Acc: 0.583 Test Loss: 1.367 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5955440998077393
Epoch: 8, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.291 Vali Acc: 0.600 Test Loss: 1.291 Test Acc: 0.600
Validation loss decreased (-0.588875 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 0.6412763595581055
Epoch: 9, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.267 Vali Acc: 0.628 Test Loss: 1.267 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627765).  Saving model ...
Epoch: 10 cost time: 0.6363489627838135
Epoch: 10, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.204 Vali Acc: 0.650 Test Loss: 1.204 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.6265218257904053
Epoch: 11, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.190 Vali Acc: 0.656 Test Loss: 1.190 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 12 cost time: 0.5946321487426758
Epoch: 12, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.152 Vali Acc: 0.650 Test Loss: 1.152 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6167571544647217
Epoch: 13, Steps: 12 | Train Loss: 0.551 Vali Loss: 1.089 Vali Acc: 0.689 Test Loss: 1.089 Test Acc: 0.689
Validation loss decreased (-0.655544 --> -0.688878).  Saving model ...
Epoch: 14 cost time: 0.6266980171203613
Epoch: 14, Steps: 12 | Train Loss: 0.550 Vali Loss: 1.040 Vali Acc: 0.689 Test Loss: 1.040 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 15 cost time: 0.5898065567016602
Epoch: 15, Steps: 12 | Train Loss: 0.456 Vali Loss: 1.014 Vali Acc: 0.711 Test Loss: 1.014 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711101).  Saving model ...
Epoch: 16 cost time: 0.6312496662139893
Epoch: 16, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.960 Vali Acc: 0.733 Test Loss: 0.960 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.5720789432525635
Epoch: 17, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.961 Vali Acc: 0.733 Test Loss: 0.961 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5708785057067871
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.953 Vali Acc: 0.728 Test Loss: 0.953 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6037895679473877
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6242802143096924
Epoch: 20, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749990).  Saving model ...
Epoch: 21 cost time: 0.6107304096221924
Epoch: 21, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.974 Vali Acc: 0.711 Test Loss: 0.974 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6258811950683594
Epoch: 22, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.000 Vali Acc: 0.739 Test Loss: 1.000 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6260335445404053
Epoch: 23, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.040 Vali Acc: 0.728 Test Loss: 1.040 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5926735401153564
Epoch: 24, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.061 Vali Acc: 0.761 Test Loss: 1.061 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 25 cost time: 0.5747246742248535
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.033 Vali Acc: 0.722 Test Loss: 1.033 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6103637218475342
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.074 Vali Acc: 0.750 Test Loss: 1.074 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6370584964752197
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.096 Vali Acc: 0.750 Test Loss: 1.096 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6634089946746826
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.133 Vali Acc: 0.739 Test Loss: 1.133 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.689995527267456
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.090 Vali Acc: 0.756 Test Loss: 1.090 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7203803062438965
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.116 Vali Acc: 0.761 Test Loss: 1.116 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6767008304595947
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.129 Vali Acc: 0.761 Test Loss: 1.129 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6423964500427246
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.138 Vali Acc: 0.761 Test Loss: 1.138 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6286466121673584
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.180 Vali Acc: 0.756 Test Loss: 1.180 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6254446506500244
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.209 Vali Acc: 0.767 Test Loss: 1.209 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766655).  Saving model ...
Epoch: 35 cost time: 0.6255569458007812
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.197 Vali Acc: 0.744 Test Loss: 1.197 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5866513252258301
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.227 Vali Acc: 0.761 Test Loss: 1.227 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6605663299560547
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.237 Vali Acc: 0.767 Test Loss: 1.237 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6399388313293457
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.240 Vali Acc: 0.750 Test Loss: 1.240 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6411299705505371
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.245 Vali Acc: 0.761 Test Loss: 1.245 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6236100196838379
Epoch: 40, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.263 Vali Acc: 0.772 Test Loss: 1.263 Test Acc: 0.772
Validation loss decreased (-0.766655 --> -0.772210).  Saving model ...
Epoch: 41 cost time: 0.6973867416381836
Epoch: 41, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.269 Vali Acc: 0.761 Test Loss: 1.269 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.727874755859375
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.300 Vali Acc: 0.750 Test Loss: 1.300 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7083306312561035
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.340 Vali Acc: 0.761 Test Loss: 1.340 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.673973560333252
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.327 Vali Acc: 0.778 Test Loss: 1.327 Test Acc: 0.778
Validation loss decreased (-0.772210 --> -0.777765).  Saving model ...
Epoch: 45 cost time: 0.6482248306274414
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.330 Vali Acc: 0.778 Test Loss: 1.330 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6841452121734619
Epoch: 46, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.350 Vali Acc: 0.783 Test Loss: 1.350 Test Acc: 0.783
Validation loss decreased (-0.777765 --> -0.783320).  Saving model ...
Epoch: 47 cost time: 0.6281847953796387
Epoch: 47, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.358 Vali Acc: 0.778 Test Loss: 1.358 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5664615631103516
Epoch: 48, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.352 Vali Acc: 0.778 Test Loss: 1.352 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6373975276947021
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.390 Vali Acc: 0.767 Test Loss: 1.390 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5958220958709717
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.385 Vali Acc: 0.756 Test Loss: 1.385 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5894889831542969
Epoch: 51, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.356 Vali Acc: 0.778 Test Loss: 1.356 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6204020977020264
Epoch: 52, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.369 Vali Acc: 0.778 Test Loss: 1.369 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5622689723968506
Epoch: 53, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.409 Vali Acc: 0.778 Test Loss: 1.409 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7119648456573486
Epoch: 54, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.402 Vali Acc: 0.789 Test Loss: 1.402 Test Acc: 0.789
Validation loss decreased (-0.783320 --> -0.788875).  Saving model ...
Epoch: 55 cost time: 0.6451349258422852
Epoch: 55, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.411 Vali Acc: 0.767 Test Loss: 1.411 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6447429656982422
Epoch: 56, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.430 Vali Acc: 0.761 Test Loss: 1.430 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6362795829772949
Epoch: 57, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.430 Vali Acc: 0.767 Test Loss: 1.430 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6867952346801758
Epoch: 58, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.449 Vali Acc: 0.767 Test Loss: 1.449 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.626013994216919
Epoch: 59, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.492 Vali Acc: 0.778 Test Loss: 1.492 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6050469875335693
Epoch: 60, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.445 Vali Acc: 0.772 Test Loss: 1.445 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.6572554111480713
Epoch: 61, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.421 Vali Acc: 0.778 Test Loss: 1.421 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.6069834232330322
Epoch: 62, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.432 Vali Acc: 0.767 Test Loss: 1.432 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.5933430194854736
Epoch: 63, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.449 Vali Acc: 0.767 Test Loss: 1.449 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.6915905475616455
Epoch: 64, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.465 Vali Acc: 0.783 Test Loss: 1.465 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 92623
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.155323028564453
Epoch: 1, Steps: 12 | Train Loss: 2.936 Vali Loss: 2.768 Vali Acc: 0.056 Test Loss: 2.768 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.6824116706848145
Epoch: 2, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.463 Vali Acc: 0.206 Test Loss: 2.463 Test Acc: 0.206
Validation loss decreased (-0.055528 --> -0.205531).  Saving model ...
Epoch: 3 cost time: 0.6599459648132324
Epoch: 3, Steps: 12 | Train Loss: 2.315 Vali Loss: 2.141 Vali Acc: 0.406 Test Loss: 2.141 Test Acc: 0.406
Validation loss decreased (-0.205531 --> -0.405534).  Saving model ...
Epoch: 4 cost time: 0.6440334320068359
Epoch: 4, Steps: 12 | Train Loss: 1.980 Vali Loss: 1.868 Vali Acc: 0.483 Test Loss: 1.868 Test Acc: 0.483
Validation loss decreased (-0.405534 --> -0.483315).  Saving model ...
Epoch: 5 cost time: 0.6727948188781738
Epoch: 5, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.669 Vali Acc: 0.561 Test Loss: 1.669 Test Acc: 0.561
Validation loss decreased (-0.483315 --> -0.561094).  Saving model ...
Epoch: 6 cost time: 0.6425454616546631
Epoch: 6, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.547 Vali Acc: 0.550 Test Loss: 1.547 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6512894630432129
Epoch: 7, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.455 Vali Acc: 0.567 Test Loss: 1.455 Test Acc: 0.567
Validation loss decreased (-0.561094 --> -0.566652).  Saving model ...
Epoch: 8 cost time: 0.6247339248657227
Epoch: 8, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.385 Vali Acc: 0.600 Test Loss: 1.385 Test Acc: 0.600
Validation loss decreased (-0.566652 --> -0.599986).  Saving model ...
Epoch: 9 cost time: 0.6550495624542236
Epoch: 9, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.312 Vali Acc: 0.606 Test Loss: 1.312 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 10 cost time: 0.6578750610351562
Epoch: 10, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.238 Vali Acc: 0.633 Test Loss: 1.238 Test Acc: 0.633
Validation loss decreased (-0.605542 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 0.6948742866516113
Epoch: 11, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.185 Vali Acc: 0.650 Test Loss: 1.185 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.6764357089996338
Epoch: 12, Steps: 12 | Train Loss: 0.717 Vali Loss: 1.177 Vali Acc: 0.639 Test Loss: 1.177 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6347990036010742
Epoch: 13, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.143 Vali Acc: 0.650 Test Loss: 1.143 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.7269892692565918
Epoch: 14, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.082 Vali Acc: 0.656 Test Loss: 1.082 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 15 cost time: 0.6661078929901123
Epoch: 15, Steps: 12 | Train Loss: 0.560 Vali Loss: 1.065 Vali Acc: 0.678 Test Loss: 1.065 Test Acc: 0.678
Validation loss decreased (-0.655545 --> -0.677767).  Saving model ...
Epoch: 16 cost time: 0.6351585388183594
Epoch: 16, Steps: 12 | Train Loss: 0.476 Vali Loss: 1.040 Vali Acc: 0.672 Test Loss: 1.040 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.709895133972168
Epoch: 17, Steps: 12 | Train Loss: 0.452 Vali Loss: 1.001 Vali Acc: 0.694 Test Loss: 1.001 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 18 cost time: 0.7156126499176025
Epoch: 18, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.957 Vali Acc: 0.722 Test Loss: 0.957 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722213).  Saving model ...
Epoch: 19 cost time: 0.6212573051452637
Epoch: 19, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.961 Vali Acc: 0.733 Test Loss: 0.961 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 20 cost time: 0.6655478477478027
Epoch: 20, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.6401219367980957
Epoch: 21, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.960 Vali Acc: 0.728 Test Loss: 0.960 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6143028736114502
Epoch: 22, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.918 Vali Acc: 0.761 Test Loss: 0.918 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761102).  Saving model ...
Epoch: 23 cost time: 0.6475014686584473
Epoch: 23, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.936 Vali Acc: 0.767 Test Loss: 0.936 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766657).  Saving model ...
Epoch: 24 cost time: 0.6288585662841797
Epoch: 24, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.956 Vali Acc: 0.767 Test Loss: 0.956 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6662917137145996
Epoch: 25, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.974 Vali Acc: 0.744 Test Loss: 0.974 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7029190063476562
Epoch: 26, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.000 Vali Acc: 0.761 Test Loss: 1.000 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6337101459503174
Epoch: 27, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.020 Vali Acc: 0.750 Test Loss: 1.020 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.641608715057373
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.018 Vali Acc: 0.756 Test Loss: 1.018 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.650827169418335
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.025 Vali Acc: 0.744 Test Loss: 1.025 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6717722415924072
Epoch: 30, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.036 Vali Acc: 0.756 Test Loss: 1.036 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.696495532989502
Epoch: 31, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.047 Vali Acc: 0.744 Test Loss: 1.047 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6697437763214111
Epoch: 32, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.021 Vali Acc: 0.761 Test Loss: 1.021 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6840431690216064
Epoch: 33, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.080 Vali Acc: 0.739 Test Loss: 1.080 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 79247
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8627066612243652
Epoch: 1, Steps: 12 | Train Loss: 3.019 Vali Loss: 2.862 Vali Acc: 0.072 Test Loss: 2.862 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 0.5986766815185547
Epoch: 2, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.637 Vali Acc: 0.139 Test Loss: 2.637 Test Acc: 0.139
Validation loss decreased (-0.072194 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 0.6330087184906006
Epoch: 3, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.357 Vali Acc: 0.300 Test Loss: 2.357 Test Acc: 0.300
Validation loss decreased (-0.138863 --> -0.299976).  Saving model ...
Epoch: 4 cost time: 0.7339818477630615
Epoch: 4, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.097 Vali Acc: 0.400 Test Loss: 2.097 Test Acc: 0.400
Validation loss decreased (-0.299976 --> -0.399979).  Saving model ...
Epoch: 5 cost time: 0.6342236995697021
Epoch: 5, Steps: 12 | Train Loss: 1.949 Vali Loss: 1.889 Vali Acc: 0.489 Test Loss: 1.889 Test Acc: 0.489
Validation loss decreased (-0.399979 --> -0.488870).  Saving model ...
Epoch: 6 cost time: 0.6944284439086914
Epoch: 6, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.717 Vali Acc: 0.533 Test Loss: 1.717 Test Acc: 0.533
Validation loss decreased (-0.488870 --> -0.533316).  Saving model ...
Epoch: 7 cost time: 0.5994000434875488
Epoch: 7, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.603 Vali Acc: 0.539 Test Loss: 1.603 Test Acc: 0.539
Validation loss decreased (-0.533316 --> -0.538873).  Saving model ...
Epoch: 8 cost time: 0.7038774490356445
Epoch: 8, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.502 Vali Acc: 0.567 Test Loss: 1.502 Test Acc: 0.567
Validation loss decreased (-0.538873 --> -0.566652).  Saving model ...
Epoch: 9 cost time: 0.628976583480835
Epoch: 9, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.423 Vali Acc: 0.583 Test Loss: 1.423 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583319).  Saving model ...
Epoch: 10 cost time: 0.7304577827453613
Epoch: 10, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.345 Vali Acc: 0.600 Test Loss: 1.345 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 0.6483199596405029
Epoch: 11, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.306 Vali Acc: 0.600 Test Loss: 1.306 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.6511104106903076
Epoch: 12, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.260 Vali Acc: 0.650 Test Loss: 1.260 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649987).  Saving model ...
Epoch: 13 cost time: 0.6929199695587158
Epoch: 13, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.216 Vali Acc: 0.644 Test Loss: 1.216 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7234537601470947
Epoch: 14, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.172 Vali Acc: 0.661 Test Loss: 1.172 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661099).  Saving model ...
Epoch: 15 cost time: 0.6650872230529785
Epoch: 15, Steps: 12 | Train Loss: 0.655 Vali Loss: 1.125 Vali Acc: 0.700 Test Loss: 1.125 Test Acc: 0.700
Validation loss decreased (-0.661099 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.7222640514373779
Epoch: 16, Steps: 12 | Train Loss: 0.679 Vali Loss: 1.121 Vali Acc: 0.667 Test Loss: 1.121 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6774046421051025
Epoch: 17, Steps: 12 | Train Loss: 0.581 Vali Loss: 1.086 Vali Acc: 0.694 Test Loss: 1.086 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6400942802429199
Epoch: 18, Steps: 12 | Train Loss: 0.569 Vali Loss: 1.055 Vali Acc: 0.700 Test Loss: 1.055 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.6925430297851562
Epoch: 19, Steps: 12 | Train Loss: 0.492 Vali Loss: 1.024 Vali Acc: 0.728 Test Loss: 1.024 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727768).  Saving model ...
Epoch: 20 cost time: 0.6755335330963135
Epoch: 20, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.984 Vali Acc: 0.744 Test Loss: 0.984 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 21 cost time: 0.7111697196960449
Epoch: 21, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.960 Vali Acc: 0.767 Test Loss: 0.960 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766657).  Saving model ...
Epoch: 22 cost time: 0.6965785026550293
Epoch: 22, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.980 Vali Acc: 0.733 Test Loss: 0.980 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7187848091125488
Epoch: 23, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.970 Vali Acc: 0.744 Test Loss: 0.970 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6520566940307617
Epoch: 24, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.965 Vali Acc: 0.750 Test Loss: 0.965 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7208764553070068
Epoch: 25, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.998 Vali Acc: 0.733 Test Loss: 0.998 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7024519443511963
Epoch: 26, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.969 Vali Acc: 0.728 Test Loss: 0.969 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6769757270812988
Epoch: 27, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.947 Vali Acc: 0.744 Test Loss: 0.947 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6553893089294434
Epoch: 28, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.972 Vali Acc: 0.739 Test Loss: 0.972 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.768873929977417
Epoch: 29, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.973 Vali Acc: 0.739 Test Loss: 0.973 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7330348491668701
Epoch: 30, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6811733245849609
Epoch: 31, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.995 Vali Acc: 0.767 Test Loss: 0.995 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 71695
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.229351282119751
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.715 Vali Acc: 0.133 Test Loss: 2.715 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.6574156284332275
Epoch: 2, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.497 Vali Acc: 0.250 Test Loss: 2.497 Test Acc: 0.250
Validation loss decreased (-0.133306 --> -0.249975).  Saving model ...
Epoch: 3 cost time: 0.6929397583007812
Epoch: 3, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.251 Vali Acc: 0.394 Test Loss: 2.251 Test Acc: 0.394
Validation loss decreased (-0.249975 --> -0.394422).  Saving model ...
Epoch: 4 cost time: 0.6441423892974854
Epoch: 4, Steps: 12 | Train Loss: 2.136 Vali Loss: 2.022 Vali Acc: 0.456 Test Loss: 2.022 Test Acc: 0.456
Validation loss decreased (-0.394422 --> -0.455535).  Saving model ...
Epoch: 5 cost time: 0.6842000484466553
Epoch: 5, Steps: 12 | Train Loss: 1.915 Vali Loss: 1.831 Vali Acc: 0.517 Test Loss: 1.831 Test Acc: 0.517
Validation loss decreased (-0.455535 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 0.7036197185516357
Epoch: 6, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.668 Vali Acc: 0.539 Test Loss: 1.668 Test Acc: 0.539
Validation loss decreased (-0.516648 --> -0.538872).  Saving model ...
Epoch: 7 cost time: 0.621375560760498
Epoch: 7, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.552 Vali Acc: 0.578 Test Loss: 1.552 Test Acc: 0.578
Validation loss decreased (-0.538872 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 0.6964073181152344
Epoch: 8, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.460 Vali Acc: 0.589 Test Loss: 1.460 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588874).  Saving model ...
Epoch: 9 cost time: 0.6671886444091797
Epoch: 9, Steps: 12 | Train Loss: 1.235 Vali Loss: 1.392 Vali Acc: 0.606 Test Loss: 1.392 Test Acc: 0.606
Validation loss decreased (-0.588874 --> -0.605542).  Saving model ...
Epoch: 10 cost time: 0.6314914226531982
Epoch: 10, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.327 Vali Acc: 0.611 Test Loss: 1.327 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 11 cost time: 0.674224853515625
Epoch: 11, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.280 Vali Acc: 0.633 Test Loss: 1.280 Test Acc: 0.633
Validation loss decreased (-0.611098 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 0.6581368446350098
Epoch: 12, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.223 Vali Acc: 0.644 Test Loss: 1.223 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644432).  Saving model ...
Epoch: 13 cost time: 0.6704680919647217
Epoch: 13, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.207 Vali Acc: 0.639 Test Loss: 1.207 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6564199924468994
Epoch: 14, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.142 Vali Acc: 0.656 Test Loss: 1.142 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 0.6637930870056152
Epoch: 15, Steps: 12 | Train Loss: 0.689 Vali Loss: 1.105 Vali Acc: 0.656 Test Loss: 1.105 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 16 cost time: 0.698725700378418
Epoch: 16, Steps: 12 | Train Loss: 0.683 Vali Loss: 1.070 Vali Acc: 0.672 Test Loss: 1.070 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672212).  Saving model ...
Epoch: 17 cost time: 0.6525824069976807
Epoch: 17, Steps: 12 | Train Loss: 0.615 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.6614396572113037
Epoch: 18, Steps: 12 | Train Loss: 0.534 Vali Loss: 1.007 Vali Acc: 0.694 Test Loss: 1.007 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5973355770111084
Epoch: 19, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.980 Vali Acc: 0.700 Test Loss: 0.980 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.6132681369781494
Epoch: 20, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.940 Vali Acc: 0.722 Test Loss: 0.940 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 21 cost time: 0.6417880058288574
Epoch: 21, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.914 Vali Acc: 0.722 Test Loss: 0.914 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 22 cost time: 0.6583750247955322
Epoch: 22, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6670610904693604
Epoch: 23, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.877 Vali Acc: 0.711 Test Loss: 0.877 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6284739971160889
Epoch: 24, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6399972438812256
Epoch: 25, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.860 Vali Acc: 0.733 Test Loss: 0.860 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 26 cost time: 0.6331019401550293
Epoch: 26, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.857 Vali Acc: 0.733 Test Loss: 0.857 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 27 cost time: 0.6825776100158691
Epoch: 27, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.811 Vali Acc: 0.739 Test Loss: 0.811 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 28 cost time: 0.6967425346374512
Epoch: 28, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.827 Vali Acc: 0.744 Test Loss: 0.827 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744436).  Saving model ...
Epoch: 29 cost time: 0.6849663257598877
Epoch: 29, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6946110725402832
Epoch: 30, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.841 Vali Acc: 0.744 Test Loss: 0.841 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6839451789855957
Epoch: 31, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.853 Vali Acc: 0.733 Test Loss: 0.853 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6814775466918945
Epoch: 32, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.844 Vali Acc: 0.728 Test Loss: 0.844 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6359236240386963
Epoch: 33, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.851 Vali Acc: 0.728 Test Loss: 0.851 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6391644477844238
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.863 Vali Acc: 0.739 Test Loss: 0.863 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6931912899017334
Epoch: 35, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6641240119934082
Epoch: 36, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.914 Vali Acc: 0.700 Test Loss: 0.914 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6834719181060791
Epoch: 37, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.897 Vali Acc: 0.728 Test Loss: 0.897 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6489677429199219
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.864 Vali Acc: 0.744 Test Loss: 0.864 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 67983
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9707391262054443
Epoch: 1, Steps: 12 | Train Loss: 2.941 Vali Loss: 2.748 Vali Acc: 0.100 Test Loss: 2.748 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.6738359928131104
Epoch: 2, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.579 Vali Acc: 0.144 Test Loss: 2.579 Test Acc: 0.144
Validation loss decreased (-0.099973 --> -0.144419).  Saving model ...
Epoch: 3 cost time: 0.6111671924591064
Epoch: 3, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.365 Vali Acc: 0.256 Test Loss: 2.365 Test Acc: 0.256
Validation loss decreased (-0.144419 --> -0.255532).  Saving model ...
Epoch: 4 cost time: 0.637026309967041
Epoch: 4, Steps: 12 | Train Loss: 2.313 Vali Loss: 2.166 Vali Acc: 0.383 Test Loss: 2.166 Test Acc: 0.383
Validation loss decreased (-0.255532 --> -0.383312).  Saving model ...
Epoch: 5 cost time: 0.6818175315856934
Epoch: 5, Steps: 12 | Train Loss: 2.019 Vali Loss: 1.981 Vali Acc: 0.422 Test Loss: 1.981 Test Acc: 0.422
Validation loss decreased (-0.383312 --> -0.422202).  Saving model ...
Epoch: 6 cost time: 0.6724021434783936
Epoch: 6, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.822 Vali Acc: 0.461 Test Loss: 1.822 Test Acc: 0.461
Validation loss decreased (-0.422202 --> -0.461093).  Saving model ...
Epoch: 7 cost time: 0.7189834117889404
Epoch: 7, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.686 Vali Acc: 0.511 Test Loss: 1.686 Test Acc: 0.511
Validation loss decreased (-0.461093 --> -0.511094).  Saving model ...
Epoch: 8 cost time: 0.7055671215057373
Epoch: 8, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.592 Vali Acc: 0.556 Test Loss: 1.592 Test Acc: 0.556
Validation loss decreased (-0.511094 --> -0.555540).  Saving model ...
Epoch: 9 cost time: 0.6664705276489258
Epoch: 9, Steps: 12 | Train Loss: 1.399 Vali Loss: 1.511 Vali Acc: 0.556 Test Loss: 1.511 Test Acc: 0.556
Validation loss decreased (-0.555540 --> -0.555540).  Saving model ...
Epoch: 10 cost time: 0.6478357315063477
Epoch: 10, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.445 Vali Acc: 0.572 Test Loss: 1.445 Test Acc: 0.572
Validation loss decreased (-0.555540 --> -0.572208).  Saving model ...
Epoch: 11 cost time: 0.6626760959625244
Epoch: 11, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.386 Vali Acc: 0.578 Test Loss: 1.386 Test Acc: 0.578
Validation loss decreased (-0.572208 --> -0.577764).  Saving model ...
Epoch: 12 cost time: 0.6919050216674805
Epoch: 12, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.334 Vali Acc: 0.583 Test Loss: 1.334 Test Acc: 0.583
Validation loss decreased (-0.577764 --> -0.583320).  Saving model ...
Epoch: 13 cost time: 0.6675982475280762
Epoch: 13, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.267 Vali Acc: 0.617 Test Loss: 1.267 Test Acc: 0.617
Validation loss decreased (-0.583320 --> -0.616654).  Saving model ...
Epoch: 14 cost time: 0.6694080829620361
Epoch: 14, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.229 Vali Acc: 0.617 Test Loss: 1.229 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 15 cost time: 0.6617860794067383
Epoch: 15, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.177 Vali Acc: 0.633 Test Loss: 1.177 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633322).  Saving model ...
Epoch: 16 cost time: 0.625246524810791
Epoch: 16, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.111 Vali Acc: 0.644 Test Loss: 1.111 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644433).  Saving model ...
Epoch: 17 cost time: 0.6718215942382812
Epoch: 17, Steps: 12 | Train Loss: 0.664 Vali Loss: 1.071 Vali Acc: 0.667 Test Loss: 1.071 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666656).  Saving model ...
Epoch: 18 cost time: 0.639197587966919
Epoch: 18, Steps: 12 | Train Loss: 0.624 Vali Loss: 1.024 Vali Acc: 0.667 Test Loss: 1.024 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 19 cost time: 0.7108185291290283
Epoch: 19, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.993 Vali Acc: 0.683 Test Loss: 0.993 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683323).  Saving model ...
Epoch: 20 cost time: 0.6417422294616699
Epoch: 20, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.954 Vali Acc: 0.694 Test Loss: 0.954 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 21 cost time: 0.6524209976196289
Epoch: 21, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.943 Vali Acc: 0.683 Test Loss: 0.943 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6409487724304199
Epoch: 22, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.919 Vali Acc: 0.694 Test Loss: 0.919 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 23 cost time: 0.6185126304626465
Epoch: 23, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.891 Vali Acc: 0.706 Test Loss: 0.891 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 24 cost time: 0.6132538318634033
Epoch: 24, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.889 Vali Acc: 0.717 Test Loss: 0.889 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716658).  Saving model ...
Epoch: 25 cost time: 0.6424212455749512
Epoch: 25, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.862 Vali Acc: 0.739 Test Loss: 0.862 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738880).  Saving model ...
Epoch: 26 cost time: 0.6785717010498047
Epoch: 26, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.860 Vali Acc: 0.733 Test Loss: 0.860 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7021918296813965
Epoch: 27, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.833 Vali Acc: 0.722 Test Loss: 0.833 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6901392936706543
Epoch: 28, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.836 Vali Acc: 0.728 Test Loss: 0.836 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6138103008270264
Epoch: 29, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.826 Vali Acc: 0.728 Test Loss: 0.826 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6983602046966553
Epoch: 30, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.826 Vali Acc: 0.739 Test Loss: 0.826 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 31 cost time: 0.6163160800933838
Epoch: 31, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.837 Vali Acc: 0.756 Test Loss: 0.837 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755547).  Saving model ...
Epoch: 32 cost time: 0.679332971572876
Epoch: 32, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6950876712799072
Epoch: 33, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.835 Vali Acc: 0.739 Test Loss: 0.835 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.626641035079956
Epoch: 34, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6063463687896729
Epoch: 35, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.857 Vali Acc: 0.744 Test Loss: 0.857 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5733113288879395
Epoch: 36, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6333122253417969
Epoch: 37, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6426312923431396
Epoch: 38, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.843 Vali Acc: 0.744 Test Loss: 0.843 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5866484642028809
Epoch: 39, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5975475311279297
Epoch: 40, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.877 Vali Acc: 0.756 Test Loss: 0.877 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6240618228912354
Epoch: 41, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.883 Vali Acc: 0.756 Test Loss: 0.883 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 64335
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0465199947357178
Epoch: 1, Steps: 12 | Train Loss: 2.589 Vali Loss: 2.411 Vali Acc: 0.250 Test Loss: 2.411 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 0.6110973358154297
Epoch: 2, Steps: 12 | Train Loss: 2.218 Vali Loss: 1.944 Vali Acc: 0.483 Test Loss: 1.944 Test Acc: 0.483
Validation loss decreased (-0.249976 --> -0.483314).  Saving model ...
Epoch: 3 cost time: 0.5970008373260498
Epoch: 3, Steps: 12 | Train Loss: 1.683 Vali Loss: 1.573 Vali Acc: 0.589 Test Loss: 1.573 Test Acc: 0.589
Validation loss decreased (-0.483314 --> -0.588873).  Saving model ...
Epoch: 4 cost time: 0.651484489440918
Epoch: 4, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.401 Vali Acc: 0.606 Test Loss: 1.401 Test Acc: 0.606
Validation loss decreased (-0.588873 --> -0.605542).  Saving model ...
Epoch: 5 cost time: 0.6603691577911377
Epoch: 5, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.300 Vali Acc: 0.644 Test Loss: 1.300 Test Acc: 0.644
Validation loss decreased (-0.605542 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 0.6244347095489502
Epoch: 6, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.241 Vali Acc: 0.611 Test Loss: 1.241 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6336822509765625
Epoch: 7, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.197 Vali Acc: 0.628 Test Loss: 1.197 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5915348529815674
Epoch: 8, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.140 Vali Acc: 0.644 Test Loss: 1.140 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644433).  Saving model ...
Epoch: 9 cost time: 0.6011524200439453
Epoch: 9, Steps: 12 | Train Loss: 0.615 Vali Loss: 1.136 Vali Acc: 0.689 Test Loss: 1.136 Test Acc: 0.689
Validation loss decreased (-0.644433 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 0.6204056739807129
Epoch: 10, Steps: 12 | Train Loss: 0.545 Vali Loss: 1.122 Vali Acc: 0.672 Test Loss: 1.122 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6022839546203613
Epoch: 11, Steps: 12 | Train Loss: 0.437 Vali Loss: 1.055 Vali Acc: 0.694 Test Loss: 1.055 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 0.5904209613800049
Epoch: 12, Steps: 12 | Train Loss: 0.417 Vali Loss: 1.091 Vali Acc: 0.689 Test Loss: 1.091 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5854570865631104
Epoch: 13, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.999 Vali Acc: 0.722 Test Loss: 0.999 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 0.6361629962921143
Epoch: 14, Steps: 12 | Train Loss: 0.336 Vali Loss: 1.065 Vali Acc: 0.717 Test Loss: 1.065 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6674346923828125
Epoch: 15, Steps: 12 | Train Loss: 0.215 Vali Loss: 1.068 Vali Acc: 0.728 Test Loss: 1.068 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727767).  Saving model ...
Epoch: 16 cost time: 0.6683294773101807
Epoch: 16, Steps: 12 | Train Loss: 0.206 Vali Loss: 1.127 Vali Acc: 0.739 Test Loss: 1.127 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738878).  Saving model ...
Epoch: 17 cost time: 0.6370315551757812
Epoch: 17, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.124 Vali Acc: 0.739 Test Loss: 1.124 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738878).  Saving model ...
Epoch: 18 cost time: 0.6414365768432617
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 1.146 Vali Acc: 0.761 Test Loss: 1.146 Test Acc: 0.761
Validation loss decreased (-0.738878 --> -0.761100).  Saving model ...
Epoch: 19 cost time: 0.6972875595092773
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.214 Vali Acc: 0.750 Test Loss: 1.214 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6586894989013672
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.286 Vali Acc: 0.722 Test Loss: 1.286 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5853919982910156
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.285 Vali Acc: 0.728 Test Loss: 1.285 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5724010467529297
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.355 Vali Acc: 0.728 Test Loss: 1.355 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6318681240081787
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.325 Vali Acc: 0.744 Test Loss: 1.325 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.672670841217041
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.348 Vali Acc: 0.756 Test Loss: 1.348 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5961861610412598
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.402 Vali Acc: 0.739 Test Loss: 1.402 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6201355457305908
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.393 Vali Acc: 0.744 Test Loss: 1.393 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5965728759765625
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.427 Vali Acc: 0.739 Test Loss: 1.427 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.627692699432373
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.447 Vali Acc: 0.761 Test Loss: 1.447 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 120143
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.018601655960083
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.650 Vali Acc: 0.067 Test Loss: 2.650 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.6491312980651855
Epoch: 2, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.330 Vali Acc: 0.267 Test Loss: 2.330 Test Acc: 0.267
Validation loss decreased (-0.066640 --> -0.266643).  Saving model ...
Epoch: 3 cost time: 0.6640067100524902
Epoch: 3, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.004 Vali Acc: 0.394 Test Loss: 2.004 Test Acc: 0.394
Validation loss decreased (-0.266643 --> -0.394424).  Saving model ...
Epoch: 4 cost time: 0.6073763370513916
Epoch: 4, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.764 Vali Acc: 0.494 Test Loss: 1.764 Test Acc: 0.494
Validation loss decreased (-0.394424 --> -0.494427).  Saving model ...
Epoch: 5 cost time: 0.6038296222686768
Epoch: 5, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.586 Vali Acc: 0.533 Test Loss: 1.586 Test Acc: 0.533
Validation loss decreased (-0.494427 --> -0.533317).  Saving model ...
Epoch: 6 cost time: 0.5929226875305176
Epoch: 6, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.448 Vali Acc: 0.561 Test Loss: 1.448 Test Acc: 0.561
Validation loss decreased (-0.533317 --> -0.561097).  Saving model ...
Epoch: 7 cost time: 0.6578989028930664
Epoch: 7, Steps: 12 | Train Loss: 1.103 Vali Loss: 1.381 Vali Acc: 0.611 Test Loss: 1.381 Test Acc: 0.611
Validation loss decreased (-0.561097 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 0.6438891887664795
Epoch: 8, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.282 Vali Acc: 0.656 Test Loss: 1.282 Test Acc: 0.656
Validation loss decreased (-0.611097 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 0.5834932327270508
Epoch: 9, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.239 Vali Acc: 0.639 Test Loss: 1.239 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.566394567489624
Epoch: 10, Steps: 12 | Train Loss: 0.707 Vali Loss: 1.205 Vali Acc: 0.667 Test Loss: 1.205 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 11 cost time: 0.5525839328765869
Epoch: 11, Steps: 12 | Train Loss: 0.675 Vali Loss: 1.160 Vali Acc: 0.650 Test Loss: 1.160 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.745596170425415
Epoch: 12, Steps: 12 | Train Loss: 0.555 Vali Loss: 1.127 Vali Acc: 0.656 Test Loss: 1.127 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5970110893249512
Epoch: 13, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.102 Vali Acc: 0.683 Test Loss: 1.102 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 14 cost time: 0.6935453414916992
Epoch: 14, Steps: 12 | Train Loss: 0.494 Vali Loss: 1.055 Vali Acc: 0.733 Test Loss: 1.055 Test Acc: 0.733
Validation loss decreased (-0.683322 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 0.6212430000305176
Epoch: 15, Steps: 12 | Train Loss: 0.395 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 16 cost time: 0.6566779613494873
Epoch: 16, Steps: 12 | Train Loss: 0.351 Vali Loss: 1.023 Vali Acc: 0.722 Test Loss: 1.023 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6828055381774902
Epoch: 17, Steps: 12 | Train Loss: 0.290 Vali Loss: 1.011 Vali Acc: 0.756 Test Loss: 1.011 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755545).  Saving model ...
Epoch: 18 cost time: 0.6495368480682373
Epoch: 18, Steps: 12 | Train Loss: 0.273 Vali Loss: 1.007 Vali Acc: 0.744 Test Loss: 1.007 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6679141521453857
Epoch: 19, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.035 Vali Acc: 0.722 Test Loss: 1.035 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6707541942596436
Epoch: 20, Steps: 12 | Train Loss: 0.220 Vali Loss: 1.043 Vali Acc: 0.761 Test Loss: 1.043 Test Acc: 0.761
Validation loss decreased (-0.755545 --> -0.761101).  Saving model ...
Epoch: 21 cost time: 0.7030975818634033
Epoch: 21, Steps: 12 | Train Loss: 0.171 Vali Loss: 1.072 Vali Acc: 0.750 Test Loss: 1.072 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6802139282226562
Epoch: 22, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.051 Vali Acc: 0.761 Test Loss: 1.051 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6113464832305908
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.166 Vali Acc: 0.739 Test Loss: 1.166 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6923778057098389
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.132 Vali Acc: 0.739 Test Loss: 1.132 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6003096103668213
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.142 Vali Acc: 0.744 Test Loss: 1.142 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6115913391113281
Epoch: 26, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.170 Vali Acc: 0.756 Test Loss: 1.170 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6177113056182861
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.189 Vali Acc: 0.761 Test Loss: 1.189 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6638686656951904
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.224 Vali Acc: 0.761 Test Loss: 1.224 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5915265083312988
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.266 Vali Acc: 0.767 Test Loss: 1.266 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766654).  Saving model ...
Epoch: 30 cost time: 0.6303520202636719
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.261 Vali Acc: 0.756 Test Loss: 1.261 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6699066162109375
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.284 Vali Acc: 0.767 Test Loss: 1.284 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6528446674346924
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.301 Vali Acc: 0.761 Test Loss: 1.301 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6993401050567627
Epoch: 33, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.323 Vali Acc: 0.750 Test Loss: 1.323 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6639528274536133
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.316 Vali Acc: 0.772 Test Loss: 1.316 Test Acc: 0.772
Validation loss decreased (-0.766654 --> -0.772209).  Saving model ...
Epoch: 35 cost time: 0.6754934787750244
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.319 Vali Acc: 0.767 Test Loss: 1.319 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7018446922302246
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.352 Vali Acc: 0.783 Test Loss: 1.352 Test Acc: 0.783
Validation loss decreased (-0.772209 --> -0.783320).  Saving model ...
Epoch: 37 cost time: 0.6422314643859863
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.389 Vali Acc: 0.767 Test Loss: 1.389 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6795039176940918
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.366 Vali Acc: 0.767 Test Loss: 1.366 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6154656410217285
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.358 Vali Acc: 0.761 Test Loss: 1.358 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6866798400878906
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.385 Vali Acc: 0.761 Test Loss: 1.385 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.66398024559021
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.414 Vali Acc: 0.761 Test Loss: 1.414 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6643080711364746
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.428 Vali Acc: 0.772 Test Loss: 1.428 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.593773603439331
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.411 Vali Acc: 0.767 Test Loss: 1.411 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6199162006378174
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.437 Vali Acc: 0.772 Test Loss: 1.437 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5927848815917969
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.453 Vali Acc: 0.778 Test Loss: 1.453 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.4875614643096924
Epoch: 46, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.482 Vali Acc: 0.772 Test Loss: 1.482 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 77967
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1216514110565186
Epoch: 1, Steps: 12 | Train Loss: 3.025 Vali Loss: 2.833 Vali Acc: 0.033 Test Loss: 2.833 Test Acc: 0.033
Validation loss decreased (inf --> -0.033305).  Saving model ...
Epoch: 2 cost time: 0.48949551582336426
Epoch: 2, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.438 Vali Acc: 0.283 Test Loss: 2.438 Test Acc: 0.283
Validation loss decreased (-0.033305 --> -0.283309).  Saving model ...
Epoch: 3 cost time: 0.5859935283660889
Epoch: 3, Steps: 12 | Train Loss: 2.208 Vali Loss: 2.051 Vali Acc: 0.444 Test Loss: 2.051 Test Acc: 0.444
Validation loss decreased (-0.283309 --> -0.444424).  Saving model ...
Epoch: 4 cost time: 0.5381388664245605
Epoch: 4, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.782 Vali Acc: 0.511 Test Loss: 1.782 Test Acc: 0.511
Validation loss decreased (-0.444424 --> -0.511093).  Saving model ...
Epoch: 5 cost time: 0.536933183670044
Epoch: 5, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.598 Vali Acc: 0.522 Test Loss: 1.598 Test Acc: 0.522
Validation loss decreased (-0.511093 --> -0.522206).  Saving model ...
Epoch: 6 cost time: 0.49622130393981934
Epoch: 6, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.432 Vali Acc: 0.589 Test Loss: 1.432 Test Acc: 0.589
Validation loss decreased (-0.522206 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 0.6371612548828125
Epoch: 7, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.355 Vali Acc: 0.583 Test Loss: 1.355 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6555111408233643
Epoch: 8, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.316 Vali Acc: 0.622 Test Loss: 1.316 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 9 cost time: 0.6579756736755371
Epoch: 9, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.275 Vali Acc: 0.633 Test Loss: 1.275 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 0.6720623970031738
Epoch: 10, Steps: 12 | Train Loss: 0.768 Vali Loss: 1.208 Vali Acc: 0.656 Test Loss: 1.208 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 0.6735341548919678
Epoch: 11, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.157 Vali Acc: 0.661 Test Loss: 1.157 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661100).  Saving model ...
Epoch: 12 cost time: 0.6636240482330322
Epoch: 12, Steps: 12 | Train Loss: 0.631 Vali Loss: 1.124 Vali Acc: 0.672 Test Loss: 1.124 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 0.7049891948699951
Epoch: 13, Steps: 12 | Train Loss: 0.557 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.651496171951294
Epoch: 14, Steps: 12 | Train Loss: 0.507 Vali Loss: 1.090 Vali Acc: 0.683 Test Loss: 1.090 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6885178089141846
Epoch: 15, Steps: 12 | Train Loss: 0.437 Vali Loss: 1.023 Vali Acc: 0.700 Test Loss: 1.023 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.6920390129089355
Epoch: 16, Steps: 12 | Train Loss: 0.403 Vali Loss: 1.021 Vali Acc: 0.711 Test Loss: 1.021 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 17 cost time: 0.6784591674804688
Epoch: 17, Steps: 12 | Train Loss: 0.344 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733323).  Saving model ...
Epoch: 18 cost time: 0.6917717456817627
Epoch: 18, Steps: 12 | Train Loss: 0.342 Vali Loss: 1.039 Vali Acc: 0.722 Test Loss: 1.039 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6643850803375244
Epoch: 19, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.974 Vali Acc: 0.744 Test Loss: 0.974 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 20 cost time: 0.7346885204315186
Epoch: 20, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.970 Vali Acc: 0.744 Test Loss: 0.970 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 21 cost time: 0.6695797443389893
Epoch: 21, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.993 Vali Acc: 0.739 Test Loss: 0.993 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6711790561676025
Epoch: 22, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.984 Vali Acc: 0.739 Test Loss: 0.984 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6862471103668213
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.000 Vali Acc: 0.756 Test Loss: 1.000 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 24 cost time: 0.7282733917236328
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.014 Vali Acc: 0.750 Test Loss: 1.014 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6473889350891113
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.037 Vali Acc: 0.739 Test Loss: 1.037 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6555328369140625
Epoch: 26, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.045 Vali Acc: 0.761 Test Loss: 1.045 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761101).  Saving model ...
Epoch: 27 cost time: 0.6368741989135742
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.066 Vali Acc: 0.739 Test Loss: 1.066 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6868462562561035
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.081 Vali Acc: 0.756 Test Loss: 1.081 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7737646102905273
Epoch: 29, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.106 Vali Acc: 0.750 Test Loss: 1.106 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.722165584564209
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.142 Vali Acc: 0.744 Test Loss: 1.142 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6704537868499756
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.136 Vali Acc: 0.756 Test Loss: 1.136 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6613025665283203
Epoch: 32, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.130 Vali Acc: 0.772 Test Loss: 1.130 Test Acc: 0.772
Validation loss decreased (-0.761101 --> -0.772211).  Saving model ...
Epoch: 33 cost time: 0.693645715713501
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.207 Vali Acc: 0.756 Test Loss: 1.207 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7214875221252441
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.194 Vali Acc: 0.767 Test Loss: 1.194 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7767696380615234
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.212 Vali Acc: 0.772 Test Loss: 1.212 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7638745307922363
Epoch: 36, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.253 Vali Acc: 0.761 Test Loss: 1.253 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7118730545043945
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.226 Vali Acc: 0.761 Test Loss: 1.226 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7272803783416748
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.231 Vali Acc: 0.756 Test Loss: 1.231 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6655881404876709
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.228 Vali Acc: 0.767 Test Loss: 1.228 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6809313297271729
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.248 Vali Acc: 0.778 Test Loss: 1.248 Test Acc: 0.778
Validation loss decreased (-0.772211 --> -0.777765).  Saving model ...
Epoch: 41 cost time: 0.6830053329467773
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.274 Vali Acc: 0.767 Test Loss: 1.274 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6707913875579834
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.276 Vali Acc: 0.772 Test Loss: 1.276 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7539463043212891
Epoch: 43, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.323 Vali Acc: 0.733 Test Loss: 1.323 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7641828060150146
Epoch: 44, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.321 Vali Acc: 0.767 Test Loss: 1.321 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6754493713378906
Epoch: 45, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.356 Vali Acc: 0.744 Test Loss: 1.356 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6598634719848633
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.359 Vali Acc: 0.767 Test Loss: 1.359 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6429586410522461
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.365 Vali Acc: 0.750 Test Loss: 1.365 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6689484119415283
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.346 Vali Acc: 0.750 Test Loss: 1.346 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6247777938842773
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.371 Vali Acc: 0.767 Test Loss: 1.371 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7039203643798828
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.367 Vali Acc: 0.767 Test Loss: 1.367 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 76111
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1679821014404297
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.738 Vali Acc: 0.122 Test Loss: 2.738 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 0.6735126972198486
Epoch: 2, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.444 Vali Acc: 0.300 Test Loss: 2.444 Test Acc: 0.300
Validation loss decreased (-0.122195 --> -0.299976).  Saving model ...
Epoch: 3 cost time: 0.7234690189361572
Epoch: 3, Steps: 12 | Train Loss: 2.237 Vali Loss: 2.124 Vali Acc: 0.422 Test Loss: 2.124 Test Acc: 0.422
Validation loss decreased (-0.299976 --> -0.422201).  Saving model ...
Epoch: 4 cost time: 0.7541344165802002
Epoch: 4, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.857 Vali Acc: 0.500 Test Loss: 1.857 Test Acc: 0.500
Validation loss decreased (-0.422201 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 0.6828076839447021
Epoch: 5, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.675 Vali Acc: 0.544 Test Loss: 1.675 Test Acc: 0.544
Validation loss decreased (-0.499981 --> -0.544428).  Saving model ...
Epoch: 6 cost time: 0.6903207302093506
Epoch: 6, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.556 Vali Acc: 0.572 Test Loss: 1.556 Test Acc: 0.572
Validation loss decreased (-0.544428 --> -0.572207).  Saving model ...
Epoch: 7 cost time: 0.6734399795532227
Epoch: 7, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.458 Vali Acc: 0.594 Test Loss: 1.458 Test Acc: 0.594
Validation loss decreased (-0.572207 --> -0.594430).  Saving model ...
Epoch: 8 cost time: 0.6637022495269775
Epoch: 8, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.371 Vali Acc: 0.600 Test Loss: 1.371 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 9 cost time: 0.6231017112731934
Epoch: 9, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.294 Vali Acc: 0.628 Test Loss: 1.294 Test Acc: 0.628
Validation loss decreased (-0.599986 --> -0.627765).  Saving model ...
Epoch: 10 cost time: 0.68375563621521
Epoch: 10, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.242 Vali Acc: 0.650 Test Loss: 1.242 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.6217629909515381
Epoch: 11, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.6312260627746582
Epoch: 12, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.199 Vali Acc: 0.644 Test Loss: 1.199 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6371898651123047
Epoch: 13, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.163 Vali Acc: 0.656 Test Loss: 1.163 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 0.6727442741394043
Epoch: 14, Steps: 12 | Train Loss: 0.649 Vali Loss: 1.089 Vali Acc: 0.667 Test Loss: 1.089 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 15 cost time: 0.6609368324279785
Epoch: 15, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.064 Vali Acc: 0.683 Test Loss: 1.064 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683323).  Saving model ...
Epoch: 16 cost time: 0.700636625289917
Epoch: 16, Steps: 12 | Train Loss: 0.523 Vali Loss: 1.042 Vali Acc: 0.689 Test Loss: 1.042 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688878).  Saving model ...
Epoch: 17 cost time: 0.6377968788146973
Epoch: 17, Steps: 12 | Train Loss: 0.458 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.7069730758666992
Epoch: 18, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.979 Vali Acc: 0.700 Test Loss: 0.979 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.7329974174499512
Epoch: 19, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.982 Vali Acc: 0.694 Test Loss: 0.982 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6858189105987549
Epoch: 20, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.954 Vali Acc: 0.717 Test Loss: 0.954 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 21 cost time: 0.6656198501586914
Epoch: 21, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.948 Vali Acc: 0.722 Test Loss: 0.948 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 22 cost time: 0.6491439342498779
Epoch: 22, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.971 Vali Acc: 0.733 Test Loss: 0.971 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 23 cost time: 0.6478672027587891
Epoch: 23, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.955 Vali Acc: 0.744 Test Loss: 0.955 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 24 cost time: 0.6084232330322266
Epoch: 24, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.970 Vali Acc: 0.744 Test Loss: 0.970 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6580674648284912
Epoch: 25, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6884860992431641
Epoch: 26, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.967 Vali Acc: 0.756 Test Loss: 0.967 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 27 cost time: 0.6117715835571289
Epoch: 27, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.008 Vali Acc: 0.750 Test Loss: 1.008 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6026685237884521
Epoch: 28, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.017 Vali Acc: 0.739 Test Loss: 1.017 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6230664253234863
Epoch: 29, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.987 Vali Acc: 0.761 Test Loss: 0.987 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761101).  Saving model ...
Epoch: 30 cost time: 0.6111352443695068
Epoch: 30, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.025 Vali Acc: 0.761 Test Loss: 1.025 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5803732872009277
Epoch: 31, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.045 Vali Acc: 0.739 Test Loss: 1.045 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.685154914855957
Epoch: 32, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.040 Vali Acc: 0.739 Test Loss: 1.040 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6085073947906494
Epoch: 33, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.042 Vali Acc: 0.750 Test Loss: 1.042 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6674072742462158
Epoch: 34, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.101 Vali Acc: 0.733 Test Loss: 1.101 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6346020698547363
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.069 Vali Acc: 0.739 Test Loss: 1.069 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6644923686981201
Epoch: 36, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.079 Vali Acc: 0.722 Test Loss: 1.079 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7100305557250977
Epoch: 37, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.060 Vali Acc: 0.756 Test Loss: 1.060 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6450588703155518
Epoch: 38, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.104 Vali Acc: 0.739 Test Loss: 1.104 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6783106327056885
Epoch: 39, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.121 Vali Acc: 0.756 Test Loss: 1.121 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 62735
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9901466369628906
Epoch: 1, Steps: 12 | Train Loss: 2.765 Vali Loss: 2.677 Vali Acc: 0.061 Test Loss: 2.677 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.6382358074188232
Epoch: 2, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.462 Vali Acc: 0.161 Test Loss: 2.462 Test Acc: 0.161
Validation loss decreased (-0.061084 --> -0.161086).  Saving model ...
Epoch: 3 cost time: 0.6458775997161865
Epoch: 3, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.208 Vali Acc: 0.333 Test Loss: 2.208 Test Acc: 0.333
Validation loss decreased (-0.161086 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 0.710695743560791
Epoch: 4, Steps: 12 | Train Loss: 2.112 Vali Loss: 1.983 Vali Acc: 0.422 Test Loss: 1.983 Test Acc: 0.422
Validation loss decreased (-0.333311 --> -0.422202).  Saving model ...
Epoch: 5 cost time: 0.663217306137085
Epoch: 5, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.813 Vali Acc: 0.478 Test Loss: 1.813 Test Acc: 0.478
Validation loss decreased (-0.422202 --> -0.477760).  Saving model ...
Epoch: 6 cost time: 0.5921456813812256
Epoch: 6, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.655 Vali Acc: 0.572 Test Loss: 1.655 Test Acc: 0.572
Validation loss decreased (-0.477760 --> -0.572206).  Saving model ...
Epoch: 7 cost time: 0.6955091953277588
Epoch: 7, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.544 Vali Acc: 0.567 Test Loss: 1.544 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6639273166656494
Epoch: 8, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.464 Vali Acc: 0.572 Test Loss: 1.464 Test Acc: 0.572
Validation loss decreased (-0.572206 --> -0.572208).  Saving model ...
Epoch: 9 cost time: 0.7354116439819336
Epoch: 9, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.398 Vali Acc: 0.578 Test Loss: 1.398 Test Acc: 0.578
Validation loss decreased (-0.572208 --> -0.577764).  Saving model ...
Epoch: 10 cost time: 0.680077314376831
Epoch: 10, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.350 Vali Acc: 0.600 Test Loss: 1.350 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 0.6499943733215332
Epoch: 11, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.306 Vali Acc: 0.622 Test Loss: 1.306 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 12 cost time: 0.6013228893280029
Epoch: 12, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.256 Vali Acc: 0.628 Test Loss: 1.256 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 0.6553301811218262
Epoch: 13, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.202 Vali Acc: 0.639 Test Loss: 1.202 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 14 cost time: 0.6204922199249268
Epoch: 14, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.190 Vali Acc: 0.656 Test Loss: 1.190 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 0.6107385158538818
Epoch: 15, Steps: 12 | Train Loss: 0.717 Vali Loss: 1.140 Vali Acc: 0.661 Test Loss: 1.140 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 16 cost time: 0.6466987133026123
Epoch: 16, Steps: 12 | Train Loss: 0.645 Vali Loss: 1.102 Vali Acc: 0.678 Test Loss: 1.102 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 17 cost time: 0.638962984085083
Epoch: 17, Steps: 12 | Train Loss: 0.605 Vali Loss: 1.086 Vali Acc: 0.672 Test Loss: 1.086 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8008742332458496
Epoch: 18, Steps: 12 | Train Loss: 0.516 Vali Loss: 1.041 Vali Acc: 0.683 Test Loss: 1.041 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 19 cost time: 0.732839822769165
Epoch: 19, Steps: 12 | Train Loss: 0.503 Vali Loss: 1.006 Vali Acc: 0.694 Test Loss: 1.006 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694434).  Saving model ...
Epoch: 20 cost time: 0.6386373043060303
Epoch: 20, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.992 Vali Acc: 0.694 Test Loss: 0.992 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 21 cost time: 0.6266450881958008
Epoch: 21, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.991 Vali Acc: 0.711 Test Loss: 0.991 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711101).  Saving model ...
Epoch: 22 cost time: 0.6085350513458252
Epoch: 22, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.973 Vali Acc: 0.722 Test Loss: 0.973 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 23 cost time: 0.5778133869171143
Epoch: 23, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.930 Vali Acc: 0.722 Test Loss: 0.930 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 24 cost time: 0.663970947265625
Epoch: 24, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.918 Vali Acc: 0.733 Test Loss: 0.918 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 25 cost time: 0.6375150680541992
Epoch: 25, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.909 Vali Acc: 0.744 Test Loss: 0.909 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 26 cost time: 0.5858554840087891
Epoch: 26, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.889 Vali Acc: 0.767 Test Loss: 0.889 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 27 cost time: 0.6038765907287598
Epoch: 27, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.928 Vali Acc: 0.756 Test Loss: 0.928 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7089641094207764
Epoch: 28, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.905 Vali Acc: 0.772 Test Loss: 0.905 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772213).  Saving model ...
Epoch: 29 cost time: 0.7656147480010986
Epoch: 29, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.888 Vali Acc: 0.772 Test Loss: 0.888 Test Acc: 0.772
Validation loss decreased (-0.772213 --> -0.772213).  Saving model ...
Epoch: 30 cost time: 0.6485838890075684
Epoch: 30, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.906 Vali Acc: 0.750 Test Loss: 0.906 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7396597862243652
Epoch: 31, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6732144355773926
Epoch: 32, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.932 Vali Acc: 0.739 Test Loss: 0.932 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7279024124145508
Epoch: 33, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.929 Vali Acc: 0.761 Test Loss: 0.929 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7606239318847656
Epoch: 34, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.941 Vali Acc: 0.756 Test Loss: 0.941 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7589216232299805
Epoch: 35, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.929 Vali Acc: 0.761 Test Loss: 0.929 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6835641860961914
Epoch: 36, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.926 Vali Acc: 0.756 Test Loss: 0.926 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6441662311553955
Epoch: 37, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.960 Vali Acc: 0.761 Test Loss: 0.960 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7227442264556885
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.965 Vali Acc: 0.761 Test Loss: 0.965 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6731843948364258
Epoch: 39, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.010 Vali Acc: 0.733 Test Loss: 1.010 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 55183
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.12550950050354
Epoch: 1, Steps: 12 | Train Loss: 2.862 Vali Loss: 2.766 Vali Acc: 0.067 Test Loss: 2.766 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.5950078964233398
Epoch: 2, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.568 Vali Acc: 0.122 Test Loss: 2.568 Test Acc: 0.122
Validation loss decreased (-0.066639 --> -0.122197).  Saving model ...
Epoch: 3 cost time: 0.6233859062194824
Epoch: 3, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.330 Vali Acc: 0.378 Test Loss: 2.330 Test Acc: 0.378
Validation loss decreased (-0.122197 --> -0.377754).  Saving model ...
Epoch: 4 cost time: 0.6006076335906982
Epoch: 4, Steps: 12 | Train Loss: 2.168 Vali Loss: 2.106 Vali Acc: 0.444 Test Loss: 2.106 Test Acc: 0.444
Validation loss decreased (-0.377754 --> -0.444423).  Saving model ...
Epoch: 5 cost time: 0.6269707679748535
Epoch: 5, Steps: 12 | Train Loss: 1.995 Vali Loss: 1.914 Vali Acc: 0.483 Test Loss: 1.914 Test Acc: 0.483
Validation loss decreased (-0.444423 --> -0.483314).  Saving model ...
Epoch: 6 cost time: 0.5745406150817871
Epoch: 6, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.759 Vali Acc: 0.517 Test Loss: 1.759 Test Acc: 0.517
Validation loss decreased (-0.483314 --> -0.516649).  Saving model ...
Epoch: 7 cost time: 0.6317505836486816
Epoch: 7, Steps: 12 | Train Loss: 1.537 Vali Loss: 1.638 Vali Acc: 0.556 Test Loss: 1.638 Test Acc: 0.556
Validation loss decreased (-0.516649 --> -0.555539).  Saving model ...
Epoch: 8 cost time: 0.6412661075592041
Epoch: 8, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.544 Vali Acc: 0.561 Test Loss: 1.544 Test Acc: 0.561
Validation loss decreased (-0.555539 --> -0.561096).  Saving model ...
Epoch: 9 cost time: 0.6151766777038574
Epoch: 9, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.466 Vali Acc: 0.583 Test Loss: 1.466 Test Acc: 0.583
Validation loss decreased (-0.561096 --> -0.583319).  Saving model ...
Epoch: 10 cost time: 0.5979688167572021
Epoch: 10, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.406 Vali Acc: 0.600 Test Loss: 1.406 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 0.5726833343505859
Epoch: 11, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.365 Vali Acc: 0.594 Test Loss: 1.365 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6294972896575928
Epoch: 12, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.311 Vali Acc: 0.639 Test Loss: 1.311 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638876).  Saving model ...
Epoch: 13 cost time: 0.6389322280883789
Epoch: 13, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.266 Vali Acc: 0.633 Test Loss: 1.266 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6460714340209961
Epoch: 14, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.237 Vali Acc: 0.644 Test Loss: 1.237 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 15 cost time: 0.6641736030578613
Epoch: 15, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.193 Vali Acc: 0.656 Test Loss: 1.193 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 16 cost time: 0.6364026069641113
Epoch: 16, Steps: 12 | Train Loss: 0.684 Vali Loss: 1.152 Vali Acc: 0.667 Test Loss: 1.152 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666655).  Saving model ...
Epoch: 17 cost time: 0.6488356590270996
Epoch: 17, Steps: 12 | Train Loss: 0.609 Vali Loss: 1.113 Vali Acc: 0.672 Test Loss: 1.113 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 18 cost time: 0.6358857154846191
Epoch: 18, Steps: 12 | Train Loss: 0.571 Vali Loss: 1.104 Vali Acc: 0.678 Test Loss: 1.104 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 19 cost time: 0.6677534580230713
Epoch: 19, Steps: 12 | Train Loss: 0.536 Vali Loss: 1.046 Vali Acc: 0.678 Test Loss: 1.046 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 20 cost time: 0.5950677394866943
Epoch: 20, Steps: 12 | Train Loss: 0.473 Vali Loss: 1.005 Vali Acc: 0.694 Test Loss: 1.005 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 21 cost time: 0.6262154579162598
Epoch: 21, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.5541369915008545
Epoch: 22, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.964 Vali Acc: 0.706 Test Loss: 0.964 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 23 cost time: 0.6186420917510986
Epoch: 23, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.939 Vali Acc: 0.717 Test Loss: 0.939 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 24 cost time: 0.6181473731994629
Epoch: 24, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.924 Vali Acc: 0.728 Test Loss: 0.924 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 25 cost time: 0.7180063724517822
Epoch: 25, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.922 Vali Acc: 0.722 Test Loss: 0.922 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5988738536834717
Epoch: 26, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 27 cost time: 0.5316400527954102
Epoch: 27, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.880 Vali Acc: 0.733 Test Loss: 0.880 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6032559871673584
Epoch: 28, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.901 Vali Acc: 0.756 Test Loss: 0.901 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 29 cost time: 0.6088988780975342
Epoch: 29, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 30 cost time: 0.6243846416473389
Epoch: 30, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.893 Vali Acc: 0.744 Test Loss: 0.893 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.598114013671875
Epoch: 31, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.860 Vali Acc: 0.739 Test Loss: 0.860 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6365218162536621
Epoch: 32, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.897 Vali Acc: 0.739 Test Loss: 0.897 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6193175315856934
Epoch: 33, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.919 Vali Acc: 0.722 Test Loss: 0.919 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6565566062927246
Epoch: 34, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.890 Vali Acc: 0.728 Test Loss: 0.890 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6934618949890137
Epoch: 35, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.912 Vali Acc: 0.722 Test Loss: 0.912 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6809332370758057
Epoch: 36, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.916 Vali Acc: 0.722 Test Loss: 0.916 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6539778709411621
Epoch: 37, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.937 Vali Acc: 0.761 Test Loss: 0.937 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5910742282867432
Epoch: 38, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.934 Vali Acc: 0.739 Test Loss: 0.934 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6142873764038086
Epoch: 39, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.933 Vali Acc: 0.728 Test Loss: 0.933 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 51471
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8464281558990479
Epoch: 1, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.698 Vali Acc: 0.139 Test Loss: 2.698 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.6027259826660156
Epoch: 2, Steps: 12 | Train Loss: 2.679 Vali Loss: 2.544 Vali Acc: 0.167 Test Loss: 2.544 Test Acc: 0.167
Validation loss decreased (-0.138862 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 0.6037216186523438
Epoch: 3, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.346 Vali Acc: 0.267 Test Loss: 2.346 Test Acc: 0.267
Validation loss decreased (-0.166641 --> -0.266643).  Saving model ...
Epoch: 4 cost time: 0.6349911689758301
Epoch: 4, Steps: 12 | Train Loss: 2.273 Vali Loss: 2.146 Vali Acc: 0.356 Test Loss: 2.146 Test Acc: 0.356
Validation loss decreased (-0.266643 --> -0.355534).  Saving model ...
Epoch: 5 cost time: 0.6835918426513672
Epoch: 5, Steps: 12 | Train Loss: 2.065 Vali Loss: 1.959 Vali Acc: 0.461 Test Loss: 1.959 Test Acc: 0.461
Validation loss decreased (-0.355534 --> -0.461092).  Saving model ...
Epoch: 6 cost time: 0.612001895904541
Epoch: 6, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.798 Vali Acc: 0.467 Test Loss: 1.798 Test Acc: 0.467
Validation loss decreased (-0.461092 --> -0.466649).  Saving model ...
Epoch: 7 cost time: 0.6353044509887695
Epoch: 7, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.663 Vali Acc: 0.539 Test Loss: 1.663 Test Acc: 0.539
Validation loss decreased (-0.466649 --> -0.538872).  Saving model ...
Epoch: 8 cost time: 0.6213762760162354
Epoch: 8, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.575 Vali Acc: 0.556 Test Loss: 1.575 Test Acc: 0.556
Validation loss decreased (-0.538872 --> -0.555540).  Saving model ...
Epoch: 9 cost time: 0.6824109554290771
Epoch: 9, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.495 Vali Acc: 0.583 Test Loss: 1.495 Test Acc: 0.583
Validation loss decreased (-0.555540 --> -0.583318).  Saving model ...
Epoch: 10 cost time: 0.5784382820129395
Epoch: 10, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.439 Vali Acc: 0.594 Test Loss: 1.439 Test Acc: 0.594
Validation loss decreased (-0.583318 --> -0.594430).  Saving model ...
Epoch: 11 cost time: 0.6005914211273193
Epoch: 11, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.385 Vali Acc: 0.606 Test Loss: 1.385 Test Acc: 0.606
Validation loss decreased (-0.594430 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 0.6131939888000488
Epoch: 12, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.337 Vali Acc: 0.611 Test Loss: 1.337 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 13 cost time: 0.6575157642364502
Epoch: 13, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.287 Vali Acc: 0.617 Test Loss: 1.287 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616654).  Saving model ...
Epoch: 14 cost time: 0.6565704345703125
Epoch: 14, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.256 Vali Acc: 0.628 Test Loss: 1.256 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627765).  Saving model ...
Epoch: 15 cost time: 0.5638031959533691
Epoch: 15, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.199 Vali Acc: 0.633 Test Loss: 1.199 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 0.5891056060791016
Epoch: 16, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.160 Vali Acc: 0.622 Test Loss: 1.160 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6348896026611328
Epoch: 17, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 0.6481454372406006
Epoch: 18, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.061 Vali Acc: 0.656 Test Loss: 1.061 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 19 cost time: 0.59488844871521
Epoch: 19, Steps: 12 | Train Loss: 0.614 Vali Loss: 1.044 Vali Acc: 0.656 Test Loss: 1.044 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 20 cost time: 0.5779712200164795
Epoch: 20, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.999 Vali Acc: 0.661 Test Loss: 0.999 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661101).  Saving model ...
Epoch: 21 cost time: 0.655855655670166
Epoch: 21, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.968 Vali Acc: 0.672 Test Loss: 0.968 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672213).  Saving model ...
Epoch: 22 cost time: 0.604701042175293
Epoch: 22, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.944 Vali Acc: 0.672 Test Loss: 0.944 Test Acc: 0.672
Validation loss decreased (-0.672213 --> -0.672213).  Saving model ...
Epoch: 23 cost time: 0.6057865619659424
Epoch: 23, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.922 Vali Acc: 0.689 Test Loss: 0.922 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688880).  Saving model ...
Epoch: 24 cost time: 0.5744345188140869
Epoch: 24, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.902 Vali Acc: 0.694 Test Loss: 0.902 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694435).  Saving model ...
Epoch: 25 cost time: 0.6245157718658447
Epoch: 25, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.894 Vali Acc: 0.711 Test Loss: 0.894 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 26 cost time: 0.624300479888916
Epoch: 26, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.874 Vali Acc: 0.728 Test Loss: 0.874 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 27 cost time: 0.5840940475463867
Epoch: 27, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.858 Vali Acc: 0.717 Test Loss: 0.858 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6254408359527588
Epoch: 28, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.849 Vali Acc: 0.711 Test Loss: 0.849 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6205222606658936
Epoch: 29, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.846 Vali Acc: 0.739 Test Loss: 0.846 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 30 cost time: 0.6475656032562256
Epoch: 30, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.839 Vali Acc: 0.722 Test Loss: 0.839 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6306946277618408
Epoch: 31, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.848 Vali Acc: 0.728 Test Loss: 0.848 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5907328128814697
Epoch: 32, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.849 Vali Acc: 0.733 Test Loss: 0.849 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6320266723632812
Epoch: 33, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.864 Vali Acc: 0.739 Test Loss: 0.864 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6663258075714111
Epoch: 34, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.836 Vali Acc: 0.756 Test Loss: 0.836 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 35 cost time: 0.6470150947570801
Epoch: 35, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.843 Vali Acc: 0.756 Test Loss: 0.843 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6093297004699707
Epoch: 36, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5826022624969482
Epoch: 37, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.868 Vali Acc: 0.767 Test Loss: 0.868 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766658).  Saving model ...
Epoch: 38 cost time: 0.6541979312896729
Epoch: 38, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7067990303039551
Epoch: 39, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6527218818664551
Epoch: 40, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.913 Vali Acc: 0.761 Test Loss: 0.913 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7000155448913574
Epoch: 41, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.639357328414917
Epoch: 42, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.866 Vali Acc: 0.756 Test Loss: 0.866 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6102306842803955
Epoch: 43, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.871 Vali Acc: 0.756 Test Loss: 0.871 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6204140186309814
Epoch: 44, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.899 Vali Acc: 0.756 Test Loss: 0.899 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6147329807281494
Epoch: 45, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.910 Vali Acc: 0.761 Test Loss: 0.910 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6083598136901855
Epoch: 46, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.892 Vali Acc: 0.767 Test Loss: 0.892 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6295790672302246
Epoch: 47, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.885 Vali Acc: 0.761 Test Loss: 0.885 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 47823
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.956939458847046
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.474 Vali Acc: 0.194 Test Loss: 2.474 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.6929140090942383
Epoch: 2, Steps: 12 | Train Loss: 2.329 Vali Loss: 1.978 Vali Acc: 0.428 Test Loss: 1.978 Test Acc: 0.428
Validation loss decreased (-0.194420 --> -0.427758).  Saving model ...
Epoch: 3 cost time: 0.6127498149871826
Epoch: 3, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.658 Vali Acc: 0.517 Test Loss: 1.658 Test Acc: 0.517
Validation loss decreased (-0.427758 --> -0.516650).  Saving model ...
Epoch: 4 cost time: 0.5870323181152344
Epoch: 4, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.506 Vali Acc: 0.528 Test Loss: 1.506 Test Acc: 0.528
Validation loss decreased (-0.516650 --> -0.527763).  Saving model ...
Epoch: 5 cost time: 0.6282753944396973
Epoch: 5, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.351 Vali Acc: 0.572 Test Loss: 1.351 Test Acc: 0.572
Validation loss decreased (-0.527763 --> -0.572209).  Saving model ...
Epoch: 6 cost time: 0.6208710670471191
Epoch: 6, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.278 Vali Acc: 0.633 Test Loss: 1.278 Test Acc: 0.633
Validation loss decreased (-0.572209 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 0.6830213069915771
Epoch: 7, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.277 Vali Acc: 0.650 Test Loss: 1.277 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.6472060680389404
Epoch: 8, Steps: 12 | Train Loss: 0.750 Vali Loss: 1.218 Vali Acc: 0.667 Test Loss: 1.218 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666654).  Saving model ...
Epoch: 9 cost time: 0.5833561420440674
Epoch: 9, Steps: 12 | Train Loss: 0.689 Vali Loss: 1.195 Vali Acc: 0.656 Test Loss: 1.195 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6732888221740723
Epoch: 10, Steps: 12 | Train Loss: 0.530 Vali Loss: 1.120 Vali Acc: 0.683 Test Loss: 1.120 Test Acc: 0.683
Validation loss decreased (-0.666654 --> -0.683322).  Saving model ...
Epoch: 11 cost time: 0.7020819187164307
Epoch: 11, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.187 Vali Acc: 0.650 Test Loss: 1.187 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6559333801269531
Epoch: 12, Steps: 12 | Train Loss: 0.402 Vali Loss: 1.118 Vali Acc: 0.706 Test Loss: 1.118 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705544).  Saving model ...
Epoch: 13 cost time: 0.6720454692840576
Epoch: 13, Steps: 12 | Train Loss: 0.386 Vali Loss: 1.151 Vali Acc: 0.717 Test Loss: 1.151 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716655).  Saving model ...
Epoch: 14 cost time: 0.602877140045166
Epoch: 14, Steps: 12 | Train Loss: 0.319 Vali Loss: 1.159 Vali Acc: 0.672 Test Loss: 1.159 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6286582946777344
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 1.087 Vali Acc: 0.733 Test Loss: 1.087 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733322).  Saving model ...
Epoch: 16 cost time: 0.6254489421844482
Epoch: 16, Steps: 12 | Train Loss: 0.249 Vali Loss: 1.148 Vali Acc: 0.706 Test Loss: 1.148 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6291251182556152
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.137 Vali Acc: 0.717 Test Loss: 1.137 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7312216758728027
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.233 Vali Acc: 0.717 Test Loss: 1.233 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5857272148132324
Epoch: 19, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.218 Vali Acc: 0.733 Test Loss: 1.218 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6160094738006592
Epoch: 20, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.284 Vali Acc: 0.722 Test Loss: 1.284 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6155922412872314
Epoch: 21, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.266 Vali Acc: 0.711 Test Loss: 1.266 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6514983177185059
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.380 Vali Acc: 0.733 Test Loss: 1.380 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6692922115325928
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.364 Vali Acc: 0.722 Test Loss: 1.364 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5999565124511719
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.419 Vali Acc: 0.717 Test Loss: 1.419 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6396973133087158
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.411 Vali Acc: 0.739 Test Loss: 1.411 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738875).  Saving model ...
Epoch: 26 cost time: 0.6240239143371582
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.435 Vali Acc: 0.739 Test Loss: 1.435 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6907458305358887
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.497 Vali Acc: 0.728 Test Loss: 1.497 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6496686935424805
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.520 Vali Acc: 0.744 Test Loss: 1.520 Test Acc: 0.744
Validation loss decreased (-0.738875 --> -0.744429).  Saving model ...
Epoch: 29 cost time: 0.6874456405639648
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.515 Vali Acc: 0.756 Test Loss: 1.515 Test Acc: 0.756
Validation loss decreased (-0.744429 --> -0.755540).  Saving model ...
Epoch: 30 cost time: 0.6307334899902344
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.560 Vali Acc: 0.739 Test Loss: 1.560 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6738576889038086
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.541 Vali Acc: 0.756 Test Loss: 1.541 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.628199577331543
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.546 Vali Acc: 0.761 Test Loss: 1.546 Test Acc: 0.761
Validation loss decreased (-0.755540 --> -0.761096).  Saving model ...
Epoch: 33 cost time: 0.6434381008148193
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.582 Vali Acc: 0.744 Test Loss: 1.582 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6763036251068115
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.566 Vali Acc: 0.739 Test Loss: 1.566 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6695330142974854
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.606 Vali Acc: 0.756 Test Loss: 1.606 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6636703014373779
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.657 Vali Acc: 0.744 Test Loss: 1.657 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6081438064575195
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.691 Vali Acc: 0.744 Test Loss: 1.691 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6365649700164795
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.671 Vali Acc: 0.750 Test Loss: 1.671 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6292827129364014
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.682 Vali Acc: 0.733 Test Loss: 1.682 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6785385608673096
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.680 Vali Acc: 0.750 Test Loss: 1.680 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.634695291519165
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.695 Vali Acc: 0.739 Test Loss: 1.695 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6786925792694092
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.698 Vali Acc: 0.744 Test Loss: 1.698 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 111887
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9948539733886719
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.612 Vali Acc: 0.089 Test Loss: 2.612 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 0.6376829147338867
Epoch: 2, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.309 Vali Acc: 0.250 Test Loss: 2.309 Test Acc: 0.250
Validation loss decreased (-0.088863 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 0.6011233329772949
Epoch: 3, Steps: 12 | Train Loss: 2.122 Vali Loss: 1.974 Vali Acc: 0.456 Test Loss: 1.974 Test Acc: 0.456
Validation loss decreased (-0.249977 --> -0.455536).  Saving model ...
Epoch: 4 cost time: 0.6465106010437012
Epoch: 4, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.725 Vali Acc: 0.539 Test Loss: 1.725 Test Acc: 0.539
Validation loss decreased (-0.455536 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 0.5817246437072754
Epoch: 5, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.542 Vali Acc: 0.583 Test Loss: 1.542 Test Acc: 0.583
Validation loss decreased (-0.538872 --> -0.583318).  Saving model ...
Epoch: 6 cost time: 0.5931580066680908
Epoch: 6, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.446 Vali Acc: 0.589 Test Loss: 1.446 Test Acc: 0.589
Validation loss decreased (-0.583318 --> -0.588874).  Saving model ...
Epoch: 7 cost time: 0.590834379196167
Epoch: 7, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.363 Vali Acc: 0.600 Test Loss: 1.363 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 0.5943636894226074
Epoch: 8, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.307 Vali Acc: 0.617 Test Loss: 1.307 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 0.6498148441314697
Epoch: 9, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.243 Vali Acc: 0.639 Test Loss: 1.243 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638876).  Saving model ...
Epoch: 10 cost time: 0.6009740829467773
Epoch: 10, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.182 Vali Acc: 0.644 Test Loss: 1.182 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644433).  Saving model ...
Epoch: 11 cost time: 0.6328792572021484
Epoch: 11, Steps: 12 | Train Loss: 0.658 Vali Loss: 1.189 Vali Acc: 0.672 Test Loss: 1.189 Test Acc: 0.672
Validation loss decreased (-0.644433 --> -0.672210).  Saving model ...
Epoch: 12 cost time: 0.5125961303710938
Epoch: 12, Steps: 12 | Train Loss: 0.586 Vali Loss: 1.134 Vali Acc: 0.661 Test Loss: 1.134 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.600656270980835
Epoch: 13, Steps: 12 | Train Loss: 0.530 Vali Loss: 1.121 Vali Acc: 0.672 Test Loss: 1.121 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 14 cost time: 0.5985207557678223
Epoch: 14, Steps: 12 | Train Loss: 0.492 Vali Loss: 1.054 Vali Acc: 0.694 Test Loss: 1.054 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 15 cost time: 0.5946533679962158
Epoch: 15, Steps: 12 | Train Loss: 0.425 Vali Loss: 1.014 Vali Acc: 0.717 Test Loss: 1.014 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 16 cost time: 0.6197834014892578
Epoch: 16, Steps: 12 | Train Loss: 0.413 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
Validation loss decreased (-0.716657 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.5924489498138428
Epoch: 17, Steps: 12 | Train Loss: 0.336 Vali Loss: 1.004 Vali Acc: 0.717 Test Loss: 1.004 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6252868175506592
Epoch: 18, Steps: 12 | Train Loss: 0.336 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6306233406066895
Epoch: 19, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.965 Vali Acc: 0.767 Test Loss: 0.965 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766657).  Saving model ...
Epoch: 20 cost time: 0.633307695388794
Epoch: 20, Steps: 12 | Train Loss: 0.270 Vali Loss: 1.060 Vali Acc: 0.722 Test Loss: 1.060 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5888068675994873
Epoch: 21, Steps: 12 | Train Loss: 0.207 Vali Loss: 1.000 Vali Acc: 0.756 Test Loss: 1.000 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.591825008392334
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.040 Vali Acc: 0.756 Test Loss: 1.040 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5749192237854004
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.045 Vali Acc: 0.744 Test Loss: 1.045 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5688316822052002
Epoch: 24, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.065 Vali Acc: 0.739 Test Loss: 1.065 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5991804599761963
Epoch: 25, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.081 Vali Acc: 0.756 Test Loss: 1.081 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5916135311126709
Epoch: 26, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.103 Vali Acc: 0.744 Test Loss: 1.103 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6044127941131592
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.166 Vali Acc: 0.733 Test Loss: 1.166 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5515625476837158
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.126 Vali Acc: 0.750 Test Loss: 1.126 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5778965950012207
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.177 Vali Acc: 0.744 Test Loss: 1.177 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 69711
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0758514404296875
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.643 Vali Acc: 0.122 Test Loss: 2.643 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.6984078884124756
Epoch: 2, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.293 Vali Acc: 0.328 Test Loss: 2.293 Test Acc: 0.328
Validation loss decreased (-0.122196 --> -0.327755).  Saving model ...
Epoch: 3 cost time: 0.6188442707061768
Epoch: 3, Steps: 12 | Train Loss: 2.096 Vali Loss: 1.970 Vali Acc: 0.439 Test Loss: 1.970 Test Acc: 0.439
Validation loss decreased (-0.327755 --> -0.438869).  Saving model ...
Epoch: 4 cost time: 0.6234862804412842
Epoch: 4, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.705 Vali Acc: 0.550 Test Loss: 1.705 Test Acc: 0.550
Validation loss decreased (-0.438869 --> -0.549983).  Saving model ...
Epoch: 5 cost time: 0.6249265670776367
Epoch: 5, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.552 Vali Acc: 0.600 Test Loss: 1.552 Test Acc: 0.600
Validation loss decreased (-0.549983 --> -0.599984).  Saving model ...
Epoch: 6 cost time: 0.6228561401367188
Epoch: 6, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.423 Vali Acc: 0.600 Test Loss: 1.423 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 0.6730966567993164
Epoch: 7, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.341 Vali Acc: 0.628 Test Loss: 1.341 Test Acc: 0.628
Validation loss decreased (-0.599986 --> -0.627764).  Saving model ...
Epoch: 8 cost time: 0.5778615474700928
Epoch: 8, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.292 Vali Acc: 0.633 Test Loss: 1.292 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633320).  Saving model ...
Epoch: 9 cost time: 0.6097171306610107
Epoch: 9, Steps: 12 | Train Loss: 0.834 Vali Loss: 1.250 Vali Acc: 0.656 Test Loss: 1.250 Test Acc: 0.656
Validation loss decreased (-0.633320 --> -0.655543).  Saving model ...
Epoch: 10 cost time: 0.555140495300293
Epoch: 10, Steps: 12 | Train Loss: 0.740 Vali Loss: 1.244 Vali Acc: 0.628 Test Loss: 1.244 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5752661228179932
Epoch: 11, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.223 Vali Acc: 0.656 Test Loss: 1.223 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 12 cost time: 0.6548750400543213
Epoch: 12, Steps: 12 | Train Loss: 0.675 Vali Loss: 1.126 Vali Acc: 0.683 Test Loss: 1.126 Test Acc: 0.683
Validation loss decreased (-0.655543 --> -0.683322).  Saving model ...
Epoch: 13 cost time: 0.5955793857574463
Epoch: 13, Steps: 12 | Train Loss: 0.561 Vali Loss: 1.143 Vali Acc: 0.678 Test Loss: 1.143 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5578100681304932
Epoch: 14, Steps: 12 | Train Loss: 0.494 Vali Loss: 1.067 Vali Acc: 0.683 Test Loss: 1.067 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683323).  Saving model ...
Epoch: 15 cost time: 0.5789930820465088
Epoch: 15, Steps: 12 | Train Loss: 0.418 Vali Loss: 1.054 Vali Acc: 0.711 Test Loss: 1.054 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 16 cost time: 0.6173622608184814
Epoch: 16, Steps: 12 | Train Loss: 0.394 Vali Loss: 1.035 Vali Acc: 0.722 Test Loss: 1.035 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 0.594484806060791
Epoch: 17, Steps: 12 | Train Loss: 0.419 Vali Loss: 1.055 Vali Acc: 0.689 Test Loss: 1.055 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5829582214355469
Epoch: 18, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.968 Vali Acc: 0.728 Test Loss: 0.968 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 19 cost time: 0.6922180652618408
Epoch: 19, Steps: 12 | Train Loss: 0.260 Vali Loss: 1.008 Vali Acc: 0.733 Test Loss: 1.008 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733323).  Saving model ...
Epoch: 20 cost time: 0.564232349395752
Epoch: 20, Steps: 12 | Train Loss: 0.231 Vali Loss: 1.026 Vali Acc: 0.733 Test Loss: 1.026 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6633720397949219
Epoch: 21, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.980 Vali Acc: 0.739 Test Loss: 0.980 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 22 cost time: 0.5910980701446533
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.037 Vali Acc: 0.728 Test Loss: 1.037 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6486327648162842
Epoch: 23, Steps: 12 | Train Loss: 0.164 Vali Loss: 1.068 Vali Acc: 0.728 Test Loss: 1.068 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5949246883392334
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 1.037 Vali Acc: 0.739 Test Loss: 1.037 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5904674530029297
Epoch: 25, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.074 Vali Acc: 0.733 Test Loss: 1.074 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6409609317779541
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.106 Vali Acc: 0.728 Test Loss: 1.106 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5713961124420166
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.081 Vali Acc: 0.733 Test Loss: 1.081 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5764198303222656
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.107 Vali Acc: 0.733 Test Loss: 1.107 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5682661533355713
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.123 Vali Acc: 0.750 Test Loss: 1.123 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749989).  Saving model ...
Epoch: 30 cost time: 0.5776689052581787
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.158 Vali Acc: 0.717 Test Loss: 1.158 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6194279193878174
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.149 Vali Acc: 0.761 Test Loss: 1.149 Test Acc: 0.761
Validation loss decreased (-0.749989 --> -0.761100).  Saving model ...
Epoch: 32 cost time: 0.6337933540344238
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.183 Vali Acc: 0.761 Test Loss: 1.183 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6370856761932373
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.208 Vali Acc: 0.744 Test Loss: 1.208 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5858364105224609
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.251 Vali Acc: 0.761 Test Loss: 1.251 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6024994850158691
Epoch: 35, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.223 Vali Acc: 0.733 Test Loss: 1.223 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6072888374328613
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.237 Vali Acc: 0.733 Test Loss: 1.237 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6721584796905518
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.272 Vali Acc: 0.750 Test Loss: 1.272 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6386489868164062
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.283 Vali Acc: 0.744 Test Loss: 1.283 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6771728992462158
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.279 Vali Acc: 0.744 Test Loss: 1.279 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5966815948486328
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.270 Vali Acc: 0.750 Test Loss: 1.270 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.629631519317627
Epoch: 41, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.290 Vali Acc: 0.750 Test Loss: 1.290 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 67855
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9668419361114502
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.718 Vali Acc: 0.122 Test Loss: 2.718 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 0.5883889198303223
Epoch: 2, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.432 Vali Acc: 0.222 Test Loss: 2.432 Test Acc: 0.222
Validation loss decreased (-0.122195 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 0.6787676811218262
Epoch: 3, Steps: 12 | Train Loss: 2.258 Vali Loss: 2.146 Vali Acc: 0.350 Test Loss: 2.146 Test Acc: 0.350
Validation loss decreased (-0.222198 --> -0.349979).  Saving model ...
Epoch: 4 cost time: 0.6224713325500488
Epoch: 4, Steps: 12 | Train Loss: 1.996 Vali Loss: 1.897 Vali Acc: 0.467 Test Loss: 1.897 Test Acc: 0.467
Validation loss decreased (-0.349979 --> -0.466648).  Saving model ...
Epoch: 5 cost time: 0.5826907157897949
Epoch: 5, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.728 Vali Acc: 0.511 Test Loss: 1.728 Test Acc: 0.511
Validation loss decreased (-0.466648 --> -0.511094).  Saving model ...
Epoch: 6 cost time: 0.6643455028533936
Epoch: 6, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.573 Vali Acc: 0.544 Test Loss: 1.573 Test Acc: 0.544
Validation loss decreased (-0.511094 --> -0.544429).  Saving model ...
Epoch: 7 cost time: 0.6091115474700928
Epoch: 7, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.489 Vali Acc: 0.544 Test Loss: 1.489 Test Acc: 0.544
Validation loss decreased (-0.544429 --> -0.544430).  Saving model ...
Epoch: 8 cost time: 0.612372875213623
Epoch: 8, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.405 Vali Acc: 0.583 Test Loss: 1.405 Test Acc: 0.583
Validation loss decreased (-0.544430 --> -0.583319).  Saving model ...
Epoch: 9 cost time: 0.5759191513061523
Epoch: 9, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.359 Vali Acc: 0.594 Test Loss: 1.359 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594431).  Saving model ...
Epoch: 10 cost time: 0.6088283061981201
Epoch: 10, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.300 Vali Acc: 0.622 Test Loss: 1.300 Test Acc: 0.622
Validation loss decreased (-0.594431 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 0.6709082126617432
Epoch: 11, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.234 Vali Acc: 0.639 Test Loss: 1.234 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638877).  Saving model ...
Epoch: 12 cost time: 0.6450395584106445
Epoch: 12, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.205 Vali Acc: 0.650 Test Loss: 1.205 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649988).  Saving model ...
Epoch: 13 cost time: 0.5898399353027344
Epoch: 13, Steps: 12 | Train Loss: 0.703 Vali Loss: 1.183 Vali Acc: 0.667 Test Loss: 1.183 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 0.6377978324890137
Epoch: 14, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.171 Vali Acc: 0.656 Test Loss: 1.171 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6163129806518555
Epoch: 15, Steps: 12 | Train Loss: 0.621 Vali Loss: 1.094 Vali Acc: 0.678 Test Loss: 1.094 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 16 cost time: 0.724393367767334
Epoch: 16, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.060 Vali Acc: 0.683 Test Loss: 1.060 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 17 cost time: 0.6091208457946777
Epoch: 17, Steps: 12 | Train Loss: 0.495 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.5838651657104492
Epoch: 18, Steps: 12 | Train Loss: 0.463 Vali Loss: 1.005 Vali Acc: 0.711 Test Loss: 1.005 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 19 cost time: 0.5832865238189697
Epoch: 19, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.976 Vali Acc: 0.733 Test Loss: 0.976 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 20 cost time: 0.606426477432251
Epoch: 20, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.963 Vali Acc: 0.739 Test Loss: 0.963 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 21 cost time: 0.6197538375854492
Epoch: 21, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.949 Vali Acc: 0.700 Test Loss: 0.949 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6423389911651611
Epoch: 22, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.992 Vali Acc: 0.728 Test Loss: 0.992 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6249692440032959
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.976 Vali Acc: 0.756 Test Loss: 0.976 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 24 cost time: 0.669274091720581
Epoch: 24, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.979 Vali Acc: 0.722 Test Loss: 0.979 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5797679424285889
Epoch: 25, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.961 Vali Acc: 0.744 Test Loss: 0.961 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6290905475616455
Epoch: 26, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.979 Vali Acc: 0.711 Test Loss: 0.979 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6095640659332275
Epoch: 27, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6574900150299072
Epoch: 28, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.980 Vali Acc: 0.772 Test Loss: 0.980 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772212).  Saving model ...
Epoch: 29 cost time: 0.6229467391967773
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5921289920806885
Epoch: 30, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.046 Vali Acc: 0.744 Test Loss: 1.046 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7374281883239746
Epoch: 31, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.047 Vali Acc: 0.744 Test Loss: 1.047 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6077909469604492
Epoch: 32, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.048 Vali Acc: 0.756 Test Loss: 1.048 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6457946300506592
Epoch: 33, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.053 Vali Acc: 0.750 Test Loss: 1.053 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5872406959533691
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.065 Vali Acc: 0.739 Test Loss: 1.065 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5729594230651855
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.099 Vali Acc: 0.744 Test Loss: 1.099 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5876038074493408
Epoch: 36, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.109 Vali Acc: 0.750 Test Loss: 1.109 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.621605396270752
Epoch: 37, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.120 Vali Acc: 0.744 Test Loss: 1.120 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6313979625701904
Epoch: 38, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.094 Vali Acc: 0.772 Test Loss: 1.094 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 54479
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9577033519744873
Epoch: 1, Steps: 12 | Train Loss: 2.898 Vali Loss: 2.763 Vali Acc: 0.072 Test Loss: 2.763 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.6486928462982178
Epoch: 2, Steps: 12 | Train Loss: 2.797 Vali Loss: 2.539 Vali Acc: 0.200 Test Loss: 2.539 Test Acc: 0.200
Validation loss decreased (-0.072195 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 0.6106054782867432
Epoch: 3, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.294 Vali Acc: 0.333 Test Loss: 2.294 Test Acc: 0.333
Validation loss decreased (-0.199975 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 0.5833718776702881
Epoch: 4, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.063 Vali Acc: 0.411 Test Loss: 2.063 Test Acc: 0.411
Validation loss decreased (-0.333310 --> -0.411090).  Saving model ...
Epoch: 5 cost time: 0.6056954860687256
Epoch: 5, Steps: 12 | Train Loss: 1.899 Vali Loss: 1.872 Vali Acc: 0.489 Test Loss: 1.872 Test Acc: 0.489
Validation loss decreased (-0.411090 --> -0.488870).  Saving model ...
Epoch: 6 cost time: 0.5824694633483887
Epoch: 6, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.721 Vali Acc: 0.511 Test Loss: 1.721 Test Acc: 0.511
Validation loss decreased (-0.488870 --> -0.511094).  Saving model ...
Epoch: 7 cost time: 0.6352272033691406
Epoch: 7, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.616 Vali Acc: 0.544 Test Loss: 1.616 Test Acc: 0.544
Validation loss decreased (-0.511094 --> -0.544428).  Saving model ...
Epoch: 8 cost time: 0.585045576095581
Epoch: 8, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.535 Vali Acc: 0.533 Test Loss: 1.535 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5958447456359863
Epoch: 9, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.474 Vali Acc: 0.567 Test Loss: 1.474 Test Acc: 0.567
Validation loss decreased (-0.544428 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 0.580146312713623
Epoch: 10, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.383 Vali Acc: 0.589 Test Loss: 1.383 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.6129658222198486
Epoch: 11, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.334 Vali Acc: 0.600 Test Loss: 1.334 Test Acc: 0.600
Validation loss decreased (-0.588875 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.5806541442871094
Epoch: 12, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.303 Vali Acc: 0.622 Test Loss: 1.303 Test Acc: 0.622
Validation loss decreased (-0.599987 --> -0.622209).  Saving model ...
Epoch: 13 cost time: 0.5734963417053223
Epoch: 13, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.277 Vali Acc: 0.633 Test Loss: 1.277 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 14 cost time: 0.5705604553222656
Epoch: 14, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.236 Vali Acc: 0.639 Test Loss: 1.236 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 15 cost time: 0.5660653114318848
Epoch: 15, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.203 Vali Acc: 0.639 Test Loss: 1.203 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 16 cost time: 0.5978794097900391
Epoch: 16, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.190 Vali Acc: 0.667 Test Loss: 1.190 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666655).  Saving model ...
Epoch: 17 cost time: 0.6006944179534912
Epoch: 17, Steps: 12 | Train Loss: 0.695 Vali Loss: 1.187 Vali Acc: 0.628 Test Loss: 1.187 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5460078716278076
Epoch: 18, Steps: 12 | Train Loss: 0.591 Vali Loss: 1.103 Vali Acc: 0.683 Test Loss: 1.103 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 19 cost time: 0.6172714233398438
Epoch: 19, Steps: 12 | Train Loss: 0.535 Vali Loss: 1.072 Vali Acc: 0.672 Test Loss: 1.072 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5796988010406494
Epoch: 20, Steps: 12 | Train Loss: 0.531 Vali Loss: 1.077 Vali Acc: 0.689 Test Loss: 1.077 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 21 cost time: 0.694366455078125
Epoch: 21, Steps: 12 | Train Loss: 0.440 Vali Loss: 1.043 Vali Acc: 0.683 Test Loss: 1.043 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5993592739105225
Epoch: 22, Steps: 12 | Train Loss: 0.424 Vali Loss: 1.004 Vali Acc: 0.722 Test Loss: 1.004 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722212).  Saving model ...
Epoch: 23 cost time: 0.5796244144439697
Epoch: 23, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.988 Vali Acc: 0.689 Test Loss: 0.988 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5862817764282227
Epoch: 24, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.988 Vali Acc: 0.717 Test Loss: 0.988 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5557518005371094
Epoch: 25, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.982 Vali Acc: 0.717 Test Loss: 0.982 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6393740177154541
Epoch: 26, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.945 Vali Acc: 0.739 Test Loss: 0.945 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 27 cost time: 0.5782668590545654
Epoch: 27, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.961 Vali Acc: 0.733 Test Loss: 0.961 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6001474857330322
Epoch: 28, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.949 Vali Acc: 0.722 Test Loss: 0.949 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.642265796661377
Epoch: 29, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.957 Vali Acc: 0.728 Test Loss: 0.957 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6024072170257568
Epoch: 30, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.957 Vali Acc: 0.728 Test Loss: 0.957 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5721414089202881
Epoch: 31, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.945 Vali Acc: 0.750 Test Loss: 0.945 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 0.5995852947235107
Epoch: 32, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.972 Vali Acc: 0.733 Test Loss: 0.972 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5528674125671387
Epoch: 33, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.984 Vali Acc: 0.739 Test Loss: 0.984 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.584369421005249
Epoch: 34, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.995 Vali Acc: 0.739 Test Loss: 0.995 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5846381187438965
Epoch: 35, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.992 Vali Acc: 0.733 Test Loss: 0.992 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5860626697540283
Epoch: 36, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.977 Vali Acc: 0.722 Test Loss: 0.977 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.585503101348877
Epoch: 37, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.008 Vali Acc: 0.717 Test Loss: 1.008 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5862948894500732
Epoch: 38, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.016 Vali Acc: 0.717 Test Loss: 1.016 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5981230735778809
Epoch: 39, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.030 Vali Acc: 0.722 Test Loss: 1.030 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6030533313751221
Epoch: 40, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.036 Vali Acc: 0.728 Test Loss: 1.036 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6342265605926514
Epoch: 41, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.046 Vali Acc: 0.744 Test Loss: 1.046 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 46927
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9554636478424072
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.669 Vali Acc: 0.122 Test Loss: 2.669 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.6541991233825684
Epoch: 2, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.487 Vali Acc: 0.228 Test Loss: 2.487 Test Acc: 0.228
Validation loss decreased (-0.122196 --> -0.227753).  Saving model ...
Epoch: 3 cost time: 0.6059131622314453
Epoch: 3, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.270 Vali Acc: 0.322 Test Loss: 2.270 Test Acc: 0.322
Validation loss decreased (-0.227753 --> -0.322200).  Saving model ...
Epoch: 4 cost time: 0.6312301158905029
Epoch: 4, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.061 Vali Acc: 0.456 Test Loss: 2.061 Test Acc: 0.456
Validation loss decreased (-0.322200 --> -0.455535).  Saving model ...
Epoch: 5 cost time: 0.6469824314117432
Epoch: 5, Steps: 12 | Train Loss: 1.946 Vali Loss: 1.877 Vali Acc: 0.517 Test Loss: 1.877 Test Acc: 0.517
Validation loss decreased (-0.455535 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 0.6077187061309814
Epoch: 6, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.730 Vali Acc: 0.539 Test Loss: 1.730 Test Acc: 0.539
Validation loss decreased (-0.516648 --> -0.538872).  Saving model ...
Epoch: 7 cost time: 0.576890230178833
Epoch: 7, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.615 Vali Acc: 0.572 Test Loss: 1.615 Test Acc: 0.572
Validation loss decreased (-0.538872 --> -0.572206).  Saving model ...
Epoch: 8 cost time: 0.5831258296966553
Epoch: 8, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.526 Vali Acc: 0.594 Test Loss: 1.526 Test Acc: 0.594
Validation loss decreased (-0.572206 --> -0.594429).  Saving model ...
Epoch: 9 cost time: 0.5745546817779541
Epoch: 9, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.453 Vali Acc: 0.594 Test Loss: 1.453 Test Acc: 0.594
Validation loss decreased (-0.594429 --> -0.594430).  Saving model ...
Epoch: 10 cost time: 0.6621713638305664
Epoch: 10, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.388 Vali Acc: 0.611 Test Loss: 1.388 Test Acc: 0.611
Validation loss decreased (-0.594430 --> -0.611097).  Saving model ...
Epoch: 11 cost time: 0.7133326530456543
Epoch: 11, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.348 Vali Acc: 0.606 Test Loss: 1.348 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6351659297943115
Epoch: 12, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.309 Vali Acc: 0.606 Test Loss: 1.309 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6407866477966309
Epoch: 13, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.262 Vali Acc: 0.628 Test Loss: 1.262 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627765).  Saving model ...
Epoch: 14 cost time: 0.65195631980896
Epoch: 14, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.247 Vali Acc: 0.617 Test Loss: 1.247 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6176178455352783
Epoch: 15, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.220 Vali Acc: 0.639 Test Loss: 1.220 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 16 cost time: 0.5734503269195557
Epoch: 16, Steps: 12 | Train Loss: 0.712 Vali Loss: 1.175 Vali Acc: 0.644 Test Loss: 1.175 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 17 cost time: 0.5891273021697998
Epoch: 17, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.131 Vali Acc: 0.644 Test Loss: 1.131 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 18 cost time: 0.5753700733184814
Epoch: 18, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.095 Vali Acc: 0.656 Test Loss: 1.095 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655545).  Saving model ...
Epoch: 19 cost time: 0.6184985637664795
Epoch: 19, Steps: 12 | Train Loss: 0.550 Vali Loss: 1.058 Vali Acc: 0.678 Test Loss: 1.058 Test Acc: 0.678
Validation loss decreased (-0.655545 --> -0.677767).  Saving model ...
Epoch: 20 cost time: 0.655573844909668
Epoch: 20, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.015 Vali Acc: 0.689 Test Loss: 1.015 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 21 cost time: 0.6702408790588379
Epoch: 21, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.956 Vali Acc: 0.694 Test Loss: 0.956 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 22 cost time: 0.6059484481811523
Epoch: 22, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716657).  Saving model ...
Epoch: 23 cost time: 0.5431997776031494
Epoch: 23, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.947 Vali Acc: 0.694 Test Loss: 0.947 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5852274894714355
Epoch: 24, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.934 Vali Acc: 0.706 Test Loss: 0.934 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6116068363189697
Epoch: 25, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.907 Vali Acc: 0.728 Test Loss: 0.907 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 26 cost time: 0.6025009155273438
Epoch: 26, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.890 Vali Acc: 0.722 Test Loss: 0.890 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5978546142578125
Epoch: 27, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.887 Vali Acc: 0.722 Test Loss: 0.887 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5764141082763672
Epoch: 28, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.877 Vali Acc: 0.728 Test Loss: 0.877 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 29 cost time: 0.5987193584442139
Epoch: 29, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.881 Vali Acc: 0.717 Test Loss: 0.881 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5861165523529053
Epoch: 30, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755547).  Saving model ...
Epoch: 31 cost time: 0.6455144882202148
Epoch: 31, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.882 Vali Acc: 0.711 Test Loss: 0.882 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5998806953430176
Epoch: 32, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.863 Vali Acc: 0.733 Test Loss: 0.863 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6496584415435791
Epoch: 33, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5979516506195068
Epoch: 34, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 35 cost time: 0.633272647857666
Epoch: 35, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5606436729431152
Epoch: 36, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.869 Vali Acc: 0.733 Test Loss: 0.869 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6016547679901123
Epoch: 37, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.870 Vali Acc: 0.744 Test Loss: 0.870 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6815142631530762
Epoch: 38, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.893 Vali Acc: 0.744 Test Loss: 0.893 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5824737548828125
Epoch: 39, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.890 Vali Acc: 0.739 Test Loss: 0.890 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5995633602142334
Epoch: 40, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5686137676239014
Epoch: 41, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6621458530426025
Epoch: 42, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.922 Vali Acc: 0.739 Test Loss: 0.922 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6175570487976074
Epoch: 43, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.603034496307373
Epoch: 44, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.917 Vali Acc: 0.739 Test Loss: 0.917 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 43215
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.16025447845459
Epoch: 1, Steps: 12 | Train Loss: 2.947 Vali Loss: 2.859 Vali Acc: 0.028 Test Loss: 2.859 Test Acc: 0.028
Validation loss decreased (inf --> -0.027749).  Saving model ...
Epoch: 2 cost time: 0.5311915874481201
Epoch: 2, Steps: 12 | Train Loss: 2.820 Vali Loss: 2.685 Vali Acc: 0.067 Test Loss: 2.685 Test Acc: 0.067
Validation loss decreased (-0.027749 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 0.6078925132751465
Epoch: 3, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.479 Vali Acc: 0.244 Test Loss: 2.479 Test Acc: 0.244
Validation loss decreased (-0.066640 --> -0.244420).  Saving model ...
Epoch: 4 cost time: 0.5672762393951416
Epoch: 4, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.270 Vali Acc: 0.356 Test Loss: 2.270 Test Acc: 0.356
Validation loss decreased (-0.244420 --> -0.355533).  Saving model ...
Epoch: 5 cost time: 0.6187551021575928
Epoch: 5, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.076 Vali Acc: 0.461 Test Loss: 2.076 Test Acc: 0.461
Validation loss decreased (-0.355533 --> -0.461090).  Saving model ...
Epoch: 6 cost time: 0.6074440479278564
Epoch: 6, Steps: 12 | Train Loss: 1.956 Vali Loss: 1.907 Vali Acc: 0.506 Test Loss: 1.907 Test Acc: 0.506
Validation loss decreased (-0.461090 --> -0.505536).  Saving model ...
Epoch: 7 cost time: 0.6292381286621094
Epoch: 7, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.765 Vali Acc: 0.539 Test Loss: 1.765 Test Acc: 0.539
Validation loss decreased (-0.505536 --> -0.538871).  Saving model ...
Epoch: 8 cost time: 0.5642666816711426
Epoch: 8, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.646 Vali Acc: 0.594 Test Loss: 1.646 Test Acc: 0.594
Validation loss decreased (-0.538871 --> -0.594428).  Saving model ...
Epoch: 9 cost time: 0.6629655361175537
Epoch: 9, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.553 Vali Acc: 0.594 Test Loss: 1.553 Test Acc: 0.594
Validation loss decreased (-0.594428 --> -0.594429).  Saving model ...
Epoch: 10 cost time: 0.5979588031768799
Epoch: 10, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.464 Vali Acc: 0.600 Test Loss: 1.464 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599985).  Saving model ...
Epoch: 11 cost time: 0.5575311183929443
Epoch: 11, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.405 Vali Acc: 0.622 Test Loss: 1.405 Test Acc: 0.622
Validation loss decreased (-0.599985 --> -0.622208).  Saving model ...
Epoch: 12 cost time: 0.5508413314819336
Epoch: 12, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.331 Vali Acc: 0.622 Test Loss: 1.331 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 13 cost time: 0.5478813648223877
Epoch: 13, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.281 Vali Acc: 0.633 Test Loss: 1.281 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 14 cost time: 0.6203885078430176
Epoch: 14, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.226 Vali Acc: 0.650 Test Loss: 1.226 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 0.5973422527313232
Epoch: 15, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.184 Vali Acc: 0.650 Test Loss: 1.184 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 0.6917788982391357
Epoch: 16, Steps: 12 | Train Loss: 0.812 Vali Loss: 1.116 Vali Acc: 0.656 Test Loss: 1.116 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 17 cost time: 0.66168212890625
Epoch: 17, Steps: 12 | Train Loss: 0.707 Vali Loss: 1.066 Vali Acc: 0.667 Test Loss: 1.066 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 18 cost time: 0.6364974975585938
Epoch: 18, Steps: 12 | Train Loss: 0.618 Vali Loss: 1.014 Vali Acc: 0.656 Test Loss: 1.014 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6142890453338623
Epoch: 19, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.983 Vali Acc: 0.678 Test Loss: 0.983 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 20 cost time: 0.5681209564208984
Epoch: 20, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.931 Vali Acc: 0.711 Test Loss: 0.931 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711102).  Saving model ...
Epoch: 21 cost time: 0.6154205799102783
Epoch: 21, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.908 Vali Acc: 0.689 Test Loss: 0.908 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5669341087341309
Epoch: 22, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.914 Vali Acc: 0.700 Test Loss: 0.914 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5411028861999512
Epoch: 23, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.887 Vali Acc: 0.717 Test Loss: 0.887 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 24 cost time: 0.54852294921875
Epoch: 24, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.862 Vali Acc: 0.722 Test Loss: 0.862 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 25 cost time: 0.6116816997528076
Epoch: 25, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.869 Vali Acc: 0.728 Test Loss: 0.869 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727769).  Saving model ...
Epoch: 26 cost time: 0.6036026477813721
Epoch: 26, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.866 Vali Acc: 0.722 Test Loss: 0.866 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5754621028900146
Epoch: 27, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.846 Vali Acc: 0.728 Test Loss: 0.846 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 28 cost time: 0.6399745941162109
Epoch: 28, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.825 Vali Acc: 0.750 Test Loss: 0.825 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 29 cost time: 0.6253747940063477
Epoch: 29, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7597305774688721
Epoch: 30, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.830 Vali Acc: 0.761 Test Loss: 0.830 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 31 cost time: 0.642805814743042
Epoch: 31, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.841 Vali Acc: 0.756 Test Loss: 0.841 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5853660106658936
Epoch: 32, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 33 cost time: 0.5768580436706543
Epoch: 33, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.829 Vali Acc: 0.761 Test Loss: 0.829 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5638527870178223
Epoch: 34, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6227405071258545
Epoch: 35, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.833 Vali Acc: 0.767 Test Loss: 0.833 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 36 cost time: 0.656806230545044
Epoch: 36, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.820 Vali Acc: 0.767 Test Loss: 0.820 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766658).  Saving model ...
Epoch: 37 cost time: 0.6470625400543213
Epoch: 37, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.850 Vali Acc: 0.756 Test Loss: 0.850 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6300919055938721
Epoch: 38, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.863 Vali Acc: 0.761 Test Loss: 0.863 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6223175525665283
Epoch: 39, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6151523590087891
Epoch: 40, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.887 Vali Acc: 0.761 Test Loss: 0.887 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6243958473205566
Epoch: 41, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6478426456451416
Epoch: 42, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.886 Vali Acc: 0.761 Test Loss: 0.886 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7608790397644043
Epoch: 43, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.873 Vali Acc: 0.767 Test Loss: 0.873 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6240329742431641
Epoch: 44, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.588634729385376
Epoch: 45, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.867 Vali Acc: 0.767 Test Loss: 0.867 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6819791793823242
Epoch: 46, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.866 Vali Acc: 0.761 Test Loss: 0.866 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm64_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 39567
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.991039514541626
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.539 Vali Acc: 0.117 Test Loss: 2.539 Test Acc: 0.117
Validation loss decreased (inf --> -0.116641).  Saving model ...
Epoch: 2 cost time: 0.7670600414276123
Epoch: 2, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.205 Vali Acc: 0.344 Test Loss: 2.205 Test Acc: 0.344
Validation loss decreased (-0.116641 --> -0.344422).  Saving model ...
Epoch: 3 cost time: 0.681290864944458
Epoch: 3, Steps: 12 | Train Loss: 2.077 Vali Loss: 1.892 Vali Acc: 0.467 Test Loss: 1.892 Test Acc: 0.467
Validation loss decreased (-0.344422 --> -0.466648).  Saving model ...
Epoch: 4 cost time: 0.7025580406188965
Epoch: 4, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.671 Vali Acc: 0.533 Test Loss: 1.671 Test Acc: 0.533
Validation loss decreased (-0.466648 --> -0.533317).  Saving model ...
Epoch: 5 cost time: 0.692706823348999
Epoch: 5, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.527 Vali Acc: 0.567 Test Loss: 1.527 Test Acc: 0.567
Validation loss decreased (-0.533317 --> -0.566651).  Saving model ...
Epoch: 6 cost time: 0.6337547302246094
Epoch: 6, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.405 Vali Acc: 0.589 Test Loss: 1.405 Test Acc: 0.589
Validation loss decreased (-0.566651 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 0.6462247371673584
Epoch: 7, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.342 Vali Acc: 0.622 Test Loss: 1.342 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 0.6581435203552246
Epoch: 8, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.288 Vali Acc: 0.644 Test Loss: 1.288 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 0.7150843143463135
Epoch: 9, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.256 Vali Acc: 0.644 Test Loss: 1.256 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 10 cost time: 0.7059736251831055
Epoch: 10, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.227 Vali Acc: 0.644 Test Loss: 1.227 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 11 cost time: 0.6434259414672852
Epoch: 11, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.159 Vali Acc: 0.678 Test Loss: 1.159 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 0.6003613471984863
Epoch: 12, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.101 Vali Acc: 0.689 Test Loss: 1.101 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 13 cost time: 0.6065647602081299
Epoch: 13, Steps: 12 | Train Loss: 0.525 Vali Loss: 1.096 Vali Acc: 0.683 Test Loss: 1.096 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6813592910766602
Epoch: 14, Steps: 12 | Train Loss: 0.475 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.6337583065032959
Epoch: 15, Steps: 12 | Train Loss: 0.456 Vali Loss: 1.027 Vali Acc: 0.694 Test Loss: 1.027 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6591372489929199
Epoch: 16, Steps: 12 | Train Loss: 0.370 Vali Loss: 1.036 Vali Acc: 0.728 Test Loss: 1.036 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727767).  Saving model ...
Epoch: 17 cost time: 0.7528078556060791
Epoch: 17, Steps: 12 | Train Loss: 0.357 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6346285343170166
Epoch: 18, Steps: 12 | Train Loss: 0.271 Vali Loss: 1.012 Vali Acc: 0.739 Test Loss: 1.012 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 19 cost time: 0.6342332363128662
Epoch: 19, Steps: 12 | Train Loss: 0.237 Vali Loss: 1.048 Vali Acc: 0.728 Test Loss: 1.048 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7021217346191406
Epoch: 20, Steps: 12 | Train Loss: 0.218 Vali Loss: 1.053 Vali Acc: 0.728 Test Loss: 1.053 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.623939037322998
Epoch: 21, Steps: 12 | Train Loss: 0.205 Vali Loss: 1.067 Vali Acc: 0.739 Test Loss: 1.067 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5522830486297607
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.086 Vali Acc: 0.739 Test Loss: 1.086 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5823373794555664
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.106 Vali Acc: 0.733 Test Loss: 1.106 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6101675033569336
Epoch: 24, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.159 Vali Acc: 0.739 Test Loss: 1.159 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6211719512939453
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.173 Vali Acc: 0.722 Test Loss: 1.173 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6831841468811035
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.193 Vali Acc: 0.744 Test Loss: 1.193 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744433).  Saving model ...
Epoch: 27 cost time: 0.6412229537963867
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.201 Vali Acc: 0.744 Test Loss: 1.201 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6968896389007568
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.205 Vali Acc: 0.756 Test Loss: 1.205 Test Acc: 0.756
Validation loss decreased (-0.744433 --> -0.755544).  Saving model ...
Epoch: 29 cost time: 0.6925840377807617
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.262 Vali Acc: 0.761 Test Loss: 1.262 Test Acc: 0.761
Validation loss decreased (-0.755544 --> -0.761098).  Saving model ...
Epoch: 30 cost time: 0.5977656841278076
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.270 Vali Acc: 0.761 Test Loss: 1.270 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6338632106781006
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.298 Vali Acc: 0.744 Test Loss: 1.298 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6538681983947754
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.305 Vali Acc: 0.750 Test Loss: 1.305 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6457452774047852
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.319 Vali Acc: 0.733 Test Loss: 1.319 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.723468542098999
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.357 Vali Acc: 0.750 Test Loss: 1.357 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7508807182312012
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.326 Vali Acc: 0.756 Test Loss: 1.326 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7381830215454102
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.334 Vali Acc: 0.772 Test Loss: 1.334 Test Acc: 0.772
Validation loss decreased (-0.761098 --> -0.772209).  Saving model ...
Epoch: 37 cost time: 0.5976192951202393
Epoch: 37, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.401 Vali Acc: 0.744 Test Loss: 1.401 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6606905460357666
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.432 Vali Acc: 0.750 Test Loss: 1.432 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6272463798522949
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.404 Vali Acc: 0.756 Test Loss: 1.404 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6866073608398438
Epoch: 40, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.425 Vali Acc: 0.750 Test Loss: 1.425 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6475310325622559
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.432 Vali Acc: 0.750 Test Loss: 1.432 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6500272750854492
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.436 Vali Acc: 0.767 Test Loss: 1.436 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6310849189758301
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.484 Vali Acc: 0.744 Test Loss: 1.484 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6201996803283691
Epoch: 44, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.477 Vali Acc: 0.761 Test Loss: 1.477 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6662857532501221
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.478 Vali Acc: 0.761 Test Loss: 1.478 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6503288745880127
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.485 Vali Acc: 0.750 Test Loss: 1.485 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 64367
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.044806480407715
Epoch: 1, Steps: 12 | Train Loss: 2.860 Vali Loss: 2.716 Vali Acc: 0.044 Test Loss: 2.716 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 0.60516357421875
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.522 Vali Acc: 0.211 Test Loss: 2.522 Test Acc: 0.211
Validation loss decreased (-0.044417 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 0.6626768112182617
Epoch: 3, Steps: 12 | Train Loss: 2.527 Vali Loss: 2.284 Vali Acc: 0.367 Test Loss: 2.284 Test Acc: 0.367
Validation loss decreased (-0.211086 --> -0.366644).  Saving model ...
Epoch: 4 cost time: 0.6962559223175049
Epoch: 4, Steps: 12 | Train Loss: 2.153 Vali Loss: 2.060 Vali Acc: 0.400 Test Loss: 2.060 Test Acc: 0.400
Validation loss decreased (-0.366644 --> -0.399979).  Saving model ...
Epoch: 5 cost time: 0.6189126968383789
Epoch: 5, Steps: 12 | Train Loss: 1.988 Vali Loss: 1.856 Vali Acc: 0.472 Test Loss: 1.856 Test Acc: 0.472
Validation loss decreased (-0.399979 --> -0.472204).  Saving model ...
Epoch: 6 cost time: 0.5748991966247559
Epoch: 6, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.714 Vali Acc: 0.500 Test Loss: 1.714 Test Acc: 0.500
Validation loss decreased (-0.472204 --> -0.499983).  Saving model ...
Epoch: 7 cost time: 0.6550710201263428
Epoch: 7, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.591 Vali Acc: 0.533 Test Loss: 1.591 Test Acc: 0.533
Validation loss decreased (-0.499983 --> -0.533317).  Saving model ...
Epoch: 8 cost time: 0.6314771175384521
Epoch: 8, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.488 Vali Acc: 0.556 Test Loss: 1.488 Test Acc: 0.556
Validation loss decreased (-0.533317 --> -0.555541).  Saving model ...
Epoch: 9 cost time: 0.6469001770019531
Epoch: 9, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.389 Vali Acc: 0.600 Test Loss: 1.389 Test Acc: 0.600
Validation loss decreased (-0.555541 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.6049842834472656
Epoch: 10, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.349 Vali Acc: 0.583 Test Loss: 1.349 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5912106037139893
Epoch: 11, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.294 Vali Acc: 0.600 Test Loss: 1.294 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.6176581382751465
Epoch: 12, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.244 Vali Acc: 0.644 Test Loss: 1.244 Test Acc: 0.644
Validation loss decreased (-0.599987 --> -0.644432).  Saving model ...
Epoch: 13 cost time: 0.6402125358581543
Epoch: 13, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.204 Vali Acc: 0.656 Test Loss: 1.204 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 0.6310286521911621
Epoch: 14, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.165 Vali Acc: 0.656 Test Loss: 1.165 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 0.6151382923126221
Epoch: 15, Steps: 12 | Train Loss: 0.737 Vali Loss: 1.162 Vali Acc: 0.678 Test Loss: 1.162 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677766).  Saving model ...
Epoch: 16 cost time: 0.6447291374206543
Epoch: 16, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.110 Vali Acc: 0.689 Test Loss: 1.110 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 17 cost time: 0.5854897499084473
Epoch: 17, Steps: 12 | Train Loss: 0.584 Vali Loss: 1.080 Vali Acc: 0.683 Test Loss: 1.080 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6334586143493652
Epoch: 18, Steps: 12 | Train Loss: 0.585 Vali Loss: 1.073 Vali Acc: 0.694 Test Loss: 1.073 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 19 cost time: 0.5760431289672852
Epoch: 19, Steps: 12 | Train Loss: 0.540 Vali Loss: 1.050 Vali Acc: 0.722 Test Loss: 1.050 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 20 cost time: 0.6375072002410889
Epoch: 20, Steps: 12 | Train Loss: 0.520 Vali Loss: 1.046 Vali Acc: 0.683 Test Loss: 1.046 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6275169849395752
Epoch: 21, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.981 Vali Acc: 0.739 Test Loss: 0.981 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 22 cost time: 0.6599771976470947
Epoch: 22, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.973 Vali Acc: 0.744 Test Loss: 0.973 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 23 cost time: 0.6795096397399902
Epoch: 23, Steps: 12 | Train Loss: 0.333 Vali Loss: 1.007 Vali Acc: 0.717 Test Loss: 1.007 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6104683876037598
Epoch: 24, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.958 Vali Acc: 0.739 Test Loss: 0.958 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5999729633331299
Epoch: 25, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 26 cost time: 0.5963113307952881
Epoch: 26, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.976 Vali Acc: 0.739 Test Loss: 0.976 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6583251953125
Epoch: 27, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.988 Vali Acc: 0.728 Test Loss: 0.988 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.663992166519165
Epoch: 28, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.988 Vali Acc: 0.739 Test Loss: 0.988 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6766407489776611
Epoch: 29, Steps: 12 | Train Loss: 0.198 Vali Loss: 1.003 Vali Acc: 0.761 Test Loss: 1.003 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 30 cost time: 0.6317856311798096
Epoch: 30, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6602506637573242
Epoch: 31, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.004 Vali Acc: 0.744 Test Loss: 1.004 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6279876232147217
Epoch: 32, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.039 Vali Acc: 0.733 Test Loss: 1.039 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5997040271759033
Epoch: 33, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.037 Vali Acc: 0.733 Test Loss: 1.037 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6586995124816895
Epoch: 34, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.040 Vali Acc: 0.728 Test Loss: 1.040 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6646106243133545
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.058 Vali Acc: 0.744 Test Loss: 1.058 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6587460041046143
Epoch: 36, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.068 Vali Acc: 0.739 Test Loss: 1.068 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.661545991897583
Epoch: 37, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.056 Vali Acc: 0.739 Test Loss: 1.056 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6997723579406738
Epoch: 38, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.087 Vali Acc: 0.750 Test Loss: 1.087 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6309487819671631
Epoch: 39, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.112 Vali Acc: 0.744 Test Loss: 1.112 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 43279
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.130239963531494
Epoch: 1, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.777 Vali Acc: 0.061 Test Loss: 2.777 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 0.5942904949188232
Epoch: 2, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.550 Vali Acc: 0.194 Test Loss: 2.550 Test Acc: 0.194
Validation loss decreased (-0.061083 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 0.6847302913665771
Epoch: 3, Steps: 12 | Train Loss: 2.412 Vali Loss: 2.285 Vali Acc: 0.350 Test Loss: 2.285 Test Acc: 0.350
Validation loss decreased (-0.194419 --> -0.349977).  Saving model ...
Epoch: 4 cost time: 0.5945258140563965
Epoch: 4, Steps: 12 | Train Loss: 2.175 Vali Loss: 2.045 Vali Acc: 0.422 Test Loss: 2.045 Test Acc: 0.422
Validation loss decreased (-0.349977 --> -0.422202).  Saving model ...
Epoch: 5 cost time: 0.5948286056518555
Epoch: 5, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.839 Vali Acc: 0.489 Test Loss: 1.839 Test Acc: 0.489
Validation loss decreased (-0.422202 --> -0.488870).  Saving model ...
Epoch: 6 cost time: 0.6351935863494873
Epoch: 6, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.708 Vali Acc: 0.517 Test Loss: 1.708 Test Acc: 0.517
Validation loss decreased (-0.488870 --> -0.516650).  Saving model ...
Epoch: 7 cost time: 0.5815351009368896
Epoch: 7, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.581 Vali Acc: 0.528 Test Loss: 1.581 Test Acc: 0.528
Validation loss decreased (-0.516650 --> -0.527762).  Saving model ...
Epoch: 8 cost time: 0.6982712745666504
Epoch: 8, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.484 Vali Acc: 0.556 Test Loss: 1.484 Test Acc: 0.556
Validation loss decreased (-0.527762 --> -0.555541).  Saving model ...
Epoch: 9 cost time: 0.6302523612976074
Epoch: 9, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.413 Vali Acc: 0.572 Test Loss: 1.413 Test Acc: 0.572
Validation loss decreased (-0.555541 --> -0.572208).  Saving model ...
Epoch: 10 cost time: 0.6461095809936523
Epoch: 10, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.369 Vali Acc: 0.561 Test Loss: 1.369 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7250478267669678
Epoch: 11, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.309 Vali Acc: 0.589 Test Loss: 1.309 Test Acc: 0.589
Validation loss decreased (-0.572208 --> -0.588876).  Saving model ...
Epoch: 12 cost time: 0.6261551380157471
Epoch: 12, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.273 Vali Acc: 0.628 Test Loss: 1.273 Test Acc: 0.628
Validation loss decreased (-0.588876 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 0.575782060623169
Epoch: 13, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.253 Vali Acc: 0.633 Test Loss: 1.253 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 14 cost time: 0.6162786483764648
Epoch: 14, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.201 Vali Acc: 0.667 Test Loss: 1.201 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 0.565739631652832
Epoch: 15, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.160 Vali Acc: 0.639 Test Loss: 1.160 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5986096858978271
Epoch: 16, Steps: 12 | Train Loss: 0.618 Vali Loss: 1.161 Vali Acc: 0.667 Test Loss: 1.161 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 17 cost time: 0.5856916904449463
Epoch: 17, Steps: 12 | Train Loss: 0.603 Vali Loss: 1.129 Vali Acc: 0.689 Test Loss: 1.129 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 18 cost time: 0.638512372970581
Epoch: 18, Steps: 12 | Train Loss: 0.550 Vali Loss: 1.067 Vali Acc: 0.672 Test Loss: 1.067 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5577163696289062
Epoch: 19, Steps: 12 | Train Loss: 0.525 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.5656542778015137
Epoch: 20, Steps: 12 | Train Loss: 0.500 Vali Loss: 1.037 Vali Acc: 0.706 Test Loss: 1.037 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705545).  Saving model ...
Epoch: 21 cost time: 0.6034984588623047
Epoch: 21, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.975 Vali Acc: 0.739 Test Loss: 0.975 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738879).  Saving model ...
Epoch: 22 cost time: 0.6170601844787598
Epoch: 22, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.992 Vali Acc: 0.733 Test Loss: 0.992 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6237564086914062
Epoch: 23, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.980 Vali Acc: 0.728 Test Loss: 0.980 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5971431732177734
Epoch: 24, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.970 Vali Acc: 0.739 Test Loss: 0.970 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 25 cost time: 0.5958952903747559
Epoch: 25, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.604097843170166
Epoch: 26, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.959 Vali Acc: 0.733 Test Loss: 0.959 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.589942455291748
Epoch: 27, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.964 Vali Acc: 0.733 Test Loss: 0.964 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6271481513977051
Epoch: 28, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.664417028427124
Epoch: 29, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.989 Vali Acc: 0.728 Test Loss: 0.989 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6471583843231201
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6546919345855713
Epoch: 31, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.022 Vali Acc: 0.728 Test Loss: 1.022 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5465755462646484
Epoch: 32, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.025 Vali Acc: 0.744 Test Loss: 1.025 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744434).  Saving model ...
Epoch: 33 cost time: 0.5764679908752441
Epoch: 33, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.035 Vali Acc: 0.733 Test Loss: 1.035 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6539220809936523
Epoch: 34, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.043 Vali Acc: 0.739 Test Loss: 1.043 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5670619010925293
Epoch: 35, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.054 Vali Acc: 0.756 Test Loss: 1.054 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755545).  Saving model ...
Epoch: 36 cost time: 0.6007277965545654
Epoch: 36, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.049 Vali Acc: 0.722 Test Loss: 1.049 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5969352722167969
Epoch: 37, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.083 Vali Acc: 0.733 Test Loss: 1.083 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5990769863128662
Epoch: 38, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.098 Vali Acc: 0.750 Test Loss: 1.098 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.525540828704834
Epoch: 39, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.114 Vali Acc: 0.739 Test Loss: 1.114 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6028571128845215
Epoch: 40, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.098 Vali Acc: 0.722 Test Loss: 1.098 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6203281879425049
Epoch: 41, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.124 Vali Acc: 0.728 Test Loss: 1.124 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6299355030059814
Epoch: 42, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.167 Vali Acc: 0.744 Test Loss: 1.167 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6619408130645752
Epoch: 43, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.149 Vali Acc: 0.733 Test Loss: 1.149 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6121323108673096
Epoch: 44, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.156 Vali Acc: 0.733 Test Loss: 1.156 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5855381488800049
Epoch: 45, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.157 Vali Acc: 0.739 Test Loss: 1.157 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 42351
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.944096326828003
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.705 Vali Acc: 0.078 Test Loss: 2.705 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.64349365234375
Epoch: 2, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.556 Vali Acc: 0.167 Test Loss: 2.556 Test Acc: 0.167
Validation loss decreased (-0.077751 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 0.5904786586761475
Epoch: 3, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.366 Vali Acc: 0.267 Test Loss: 2.366 Test Acc: 0.267
Validation loss decreased (-0.166641 --> -0.266643).  Saving model ...
Epoch: 4 cost time: 0.5930933952331543
Epoch: 4, Steps: 12 | Train Loss: 2.276 Vali Loss: 2.180 Vali Acc: 0.344 Test Loss: 2.180 Test Acc: 0.344
Validation loss decreased (-0.266643 --> -0.344423).  Saving model ...
Epoch: 5 cost time: 0.6377828121185303
Epoch: 5, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.010 Vali Acc: 0.433 Test Loss: 2.010 Test Acc: 0.433
Validation loss decreased (-0.344423 --> -0.433313).  Saving model ...
Epoch: 6 cost time: 0.6126618385314941
Epoch: 6, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.866 Vali Acc: 0.472 Test Loss: 1.866 Test Acc: 0.472
Validation loss decreased (-0.433313 --> -0.472204).  Saving model ...
Epoch: 7 cost time: 0.6633453369140625
Epoch: 7, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.754 Vali Acc: 0.522 Test Loss: 1.754 Test Acc: 0.522
Validation loss decreased (-0.472204 --> -0.522205).  Saving model ...
Epoch: 8 cost time: 0.6477944850921631
Epoch: 8, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.648 Vali Acc: 0.528 Test Loss: 1.648 Test Acc: 0.528
Validation loss decreased (-0.522205 --> -0.527761).  Saving model ...
Epoch: 9 cost time: 0.5651769638061523
Epoch: 9, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.552 Vali Acc: 0.556 Test Loss: 1.552 Test Acc: 0.556
Validation loss decreased (-0.527761 --> -0.555540).  Saving model ...
Epoch: 10 cost time: 0.5884037017822266
Epoch: 10, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.482 Vali Acc: 0.583 Test Loss: 1.482 Test Acc: 0.583
Validation loss decreased (-0.555540 --> -0.583319).  Saving model ...
Epoch: 11 cost time: 0.6630454063415527
Epoch: 11, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.437 Vali Acc: 0.589 Test Loss: 1.437 Test Acc: 0.589
Validation loss decreased (-0.583319 --> -0.588875).  Saving model ...
Epoch: 12 cost time: 0.5967667102813721
Epoch: 12, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.404 Vali Acc: 0.583 Test Loss: 1.404 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5919508934020996
Epoch: 13, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.340 Vali Acc: 0.622 Test Loss: 1.340 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 14 cost time: 0.6156144142150879
Epoch: 14, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.305 Vali Acc: 0.628 Test Loss: 1.305 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 15 cost time: 0.6145868301391602
Epoch: 15, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.289 Vali Acc: 0.628 Test Loss: 1.289 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 16 cost time: 0.6032044887542725
Epoch: 16, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.241 Vali Acc: 0.639 Test Loss: 1.241 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638876).  Saving model ...
Epoch: 17 cost time: 0.6595916748046875
Epoch: 17, Steps: 12 | Train Loss: 0.812 Vali Loss: 1.207 Vali Acc: 0.639 Test Loss: 1.207 Test Acc: 0.639
Validation loss decreased (-0.638876 --> -0.638877).  Saving model ...
Epoch: 18 cost time: 0.62447190284729
Epoch: 18, Steps: 12 | Train Loss: 0.756 Vali Loss: 1.180 Vali Acc: 0.650 Test Loss: 1.180 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649988).  Saving model ...
Epoch: 19 cost time: 0.7118275165557861
Epoch: 19, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.172 Vali Acc: 0.661 Test Loss: 1.172 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661099).  Saving model ...
Epoch: 20 cost time: 0.5519382953643799
Epoch: 20, Steps: 12 | Train Loss: 0.618 Vali Loss: 1.151 Vali Acc: 0.656 Test Loss: 1.151 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6232435703277588
Epoch: 21, Steps: 12 | Train Loss: 0.587 Vali Loss: 1.125 Vali Acc: 0.672 Test Loss: 1.125 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 22 cost time: 0.6269614696502686
Epoch: 22, Steps: 12 | Train Loss: 0.544 Vali Loss: 1.079 Vali Acc: 0.678 Test Loss: 1.079 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 23 cost time: 0.6181478500366211
Epoch: 23, Steps: 12 | Train Loss: 0.483 Vali Loss: 1.060 Vali Acc: 0.689 Test Loss: 1.060 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688878).  Saving model ...
Epoch: 24 cost time: 0.6219544410705566
Epoch: 24, Steps: 12 | Train Loss: 0.450 Vali Loss: 1.044 Vali Acc: 0.706 Test Loss: 1.044 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705545).  Saving model ...
Epoch: 25 cost time: 0.653644323348999
Epoch: 25, Steps: 12 | Train Loss: 0.436 Vali Loss: 1.037 Vali Acc: 0.672 Test Loss: 1.037 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6335372924804688
Epoch: 26, Steps: 12 | Train Loss: 0.430 Vali Loss: 1.025 Vali Acc: 0.694 Test Loss: 1.025 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6464605331420898
Epoch: 27, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.992 Vali Acc: 0.717 Test Loss: 0.992 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 28 cost time: 0.6492905616760254
Epoch: 28, Steps: 12 | Train Loss: 0.385 Vali Loss: 1.005 Vali Acc: 0.728 Test Loss: 1.005 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 29 cost time: 0.6384792327880859
Epoch: 29, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.994 Vali Acc: 0.739 Test Loss: 0.994 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 30 cost time: 0.5770676136016846
Epoch: 30, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.978 Vali Acc: 0.722 Test Loss: 0.978 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6043117046356201
Epoch: 31, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.961 Vali Acc: 0.744 Test Loss: 0.961 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 32 cost time: 0.6254978179931641
Epoch: 32, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.960 Vali Acc: 0.750 Test Loss: 0.960 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 33 cost time: 0.6215434074401855
Epoch: 33, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.968 Vali Acc: 0.739 Test Loss: 0.968 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5854260921478271
Epoch: 34, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6234266757965088
Epoch: 35, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.984 Vali Acc: 0.744 Test Loss: 0.984 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6676268577575684
Epoch: 36, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.993 Vali Acc: 0.744 Test Loss: 0.993 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6069822311401367
Epoch: 37, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.990 Vali Acc: 0.739 Test Loss: 0.990 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6589055061340332
Epoch: 38, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.997 Vali Acc: 0.728 Test Loss: 0.997 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6429975032806396
Epoch: 39, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.999 Vali Acc: 0.739 Test Loss: 0.999 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6398653984069824
Epoch: 40, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.015 Vali Acc: 0.744 Test Loss: 1.015 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5906391143798828
Epoch: 41, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6111156940460205
Epoch: 42, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.012 Vali Acc: 0.739 Test Loss: 1.012 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 35663
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.067173480987549
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.704 Vali Acc: 0.094 Test Loss: 2.704 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.5854966640472412
Epoch: 2, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.591 Vali Acc: 0.172 Test Loss: 2.591 Test Acc: 0.172
Validation loss decreased (-0.094417 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 0.5895233154296875
Epoch: 3, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.448 Vali Acc: 0.211 Test Loss: 2.448 Test Acc: 0.211
Validation loss decreased (-0.172196 --> -0.211087).  Saving model ...
Epoch: 4 cost time: 0.7117087841033936
Epoch: 4, Steps: 12 | Train Loss: 2.409 Vali Loss: 2.298 Vali Acc: 0.317 Test Loss: 2.298 Test Acc: 0.317
Validation loss decreased (-0.211087 --> -0.316644).  Saving model ...
Epoch: 5 cost time: 0.6245667934417725
Epoch: 5, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.139 Vali Acc: 0.389 Test Loss: 2.139 Test Acc: 0.389
Validation loss decreased (-0.316644 --> -0.388867).  Saving model ...
Epoch: 6 cost time: 0.6270668506622314
Epoch: 6, Steps: 12 | Train Loss: 2.044 Vali Loss: 1.992 Vali Acc: 0.422 Test Loss: 1.992 Test Acc: 0.422
Validation loss decreased (-0.388867 --> -0.422202).  Saving model ...
Epoch: 7 cost time: 0.6817409992218018
Epoch: 7, Steps: 12 | Train Loss: 1.918 Vali Loss: 1.864 Vali Acc: 0.456 Test Loss: 1.864 Test Acc: 0.456
Validation loss decreased (-0.422202 --> -0.455537).  Saving model ...
Epoch: 8 cost time: 0.6503446102142334
Epoch: 8, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.759 Vali Acc: 0.472 Test Loss: 1.759 Test Acc: 0.472
Validation loss decreased (-0.455537 --> -0.472205).  Saving model ...
Epoch: 9 cost time: 0.6383097171783447
Epoch: 9, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.680 Vali Acc: 0.478 Test Loss: 1.680 Test Acc: 0.478
Validation loss decreased (-0.472205 --> -0.477761).  Saving model ...
Epoch: 10 cost time: 0.6194109916687012
Epoch: 10, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.621 Vali Acc: 0.517 Test Loss: 1.621 Test Acc: 0.517
Validation loss decreased (-0.477761 --> -0.516650).  Saving model ...
Epoch: 11 cost time: 0.619635820388794
Epoch: 11, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.542 Vali Acc: 0.550 Test Loss: 1.542 Test Acc: 0.550
Validation loss decreased (-0.516650 --> -0.549985).  Saving model ...
Epoch: 12 cost time: 0.6396622657775879
Epoch: 12, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.486 Vali Acc: 0.561 Test Loss: 1.486 Test Acc: 0.561
Validation loss decreased (-0.549985 --> -0.561096).  Saving model ...
Epoch: 13 cost time: 0.615966796875
Epoch: 13, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.427 Vali Acc: 0.561 Test Loss: 1.427 Test Acc: 0.561
Validation loss decreased (-0.561096 --> -0.561097).  Saving model ...
Epoch: 14 cost time: 0.6164951324462891
Epoch: 14, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.391 Vali Acc: 0.594 Test Loss: 1.391 Test Acc: 0.594
Validation loss decreased (-0.561097 --> -0.594431).  Saving model ...
Epoch: 15 cost time: 0.6531417369842529
Epoch: 15, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.355 Vali Acc: 0.583 Test Loss: 1.355 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6131656169891357
Epoch: 16, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.311 Vali Acc: 0.594 Test Loss: 1.311 Test Acc: 0.594
Validation loss decreased (-0.594431 --> -0.594431).  Saving model ...
Epoch: 17 cost time: 0.6678903102874756
Epoch: 17, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.272 Vali Acc: 0.628 Test Loss: 1.272 Test Acc: 0.628
Validation loss decreased (-0.594431 --> -0.627765).  Saving model ...
Epoch: 18 cost time: 0.5747578144073486
Epoch: 18, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.241 Vali Acc: 0.633 Test Loss: 1.241 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 19 cost time: 0.6301491260528564
Epoch: 19, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.207 Vali Acc: 0.628 Test Loss: 1.207 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6399843692779541
Epoch: 20, Steps: 12 | Train Loss: 0.753 Vali Loss: 1.181 Vali Acc: 0.633 Test Loss: 1.181 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633322).  Saving model ...
Epoch: 21 cost time: 0.6186161041259766
Epoch: 21, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.162 Vali Acc: 0.644 Test Loss: 1.162 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644433).  Saving model ...
Epoch: 22 cost time: 0.6779744625091553
Epoch: 22, Steps: 12 | Train Loss: 0.677 Vali Loss: 1.128 Vali Acc: 0.661 Test Loss: 1.128 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661100).  Saving model ...
Epoch: 23 cost time: 0.6778862476348877
Epoch: 23, Steps: 12 | Train Loss: 0.665 Vali Loss: 1.106 Vali Acc: 0.667 Test Loss: 1.106 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 24 cost time: 0.6061687469482422
Epoch: 24, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.057 Vali Acc: 0.706 Test Loss: 1.057 Test Acc: 0.706
Validation loss decreased (-0.666656 --> -0.705545).  Saving model ...
Epoch: 25 cost time: 0.7078611850738525
Epoch: 25, Steps: 12 | Train Loss: 0.521 Vali Loss: 1.041 Vali Acc: 0.711 Test Loss: 1.041 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 26 cost time: 0.6932122707366943
Epoch: 26, Steps: 12 | Train Loss: 0.494 Vali Loss: 1.025 Vali Acc: 0.711 Test Loss: 1.025 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 27 cost time: 0.6634178161621094
Epoch: 27, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.996 Vali Acc: 0.717 Test Loss: 0.996 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 28 cost time: 0.5952224731445312
Epoch: 28, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6241369247436523
Epoch: 29, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.958 Vali Acc: 0.728 Test Loss: 0.958 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 30 cost time: 0.6343252658843994
Epoch: 30, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.941 Vali Acc: 0.744 Test Loss: 0.941 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 31 cost time: 0.601205587387085
Epoch: 31, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.923 Vali Acc: 0.750 Test Loss: 0.923 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 0.6126244068145752
Epoch: 32, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.923 Vali Acc: 0.750 Test Loss: 0.923 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6473188400268555
Epoch: 33, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 34 cost time: 0.6606056690216064
Epoch: 34, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.908 Vali Acc: 0.744 Test Loss: 0.908 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6682431697845459
Epoch: 35, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 0.6289865970611572
Epoch: 36, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.893 Vali Acc: 0.756 Test Loss: 0.893 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 37 cost time: 0.6349141597747803
Epoch: 37, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6184554100036621
Epoch: 38, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6177554130554199
Epoch: 39, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.876 Vali Acc: 0.756 Test Loss: 0.876 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 40 cost time: 0.6323938369750977
Epoch: 40, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.878 Vali Acc: 0.756 Test Loss: 0.878 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6736307144165039
Epoch: 41, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.666766881942749
Epoch: 42, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.892 Vali Acc: 0.772 Test Loss: 0.892 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772213).  Saving model ...
Epoch: 43 cost time: 0.6469345092773438
Epoch: 43, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.891 Vali Acc: 0.761 Test Loss: 0.891 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6540446281433105
Epoch: 44, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.895 Vali Acc: 0.744 Test Loss: 0.895 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6476283073425293
Epoch: 45, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.895 Vali Acc: 0.739 Test Loss: 0.895 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6573989391326904
Epoch: 46, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.885 Vali Acc: 0.756 Test Loss: 0.885 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6756939888000488
Epoch: 47, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.915 Vali Acc: 0.767 Test Loss: 0.915 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6525039672851562
Epoch: 48, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.919 Vali Acc: 0.756 Test Loss: 0.919 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6524436473846436
Epoch: 49, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6658897399902344
Epoch: 50, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.931 Vali Acc: 0.761 Test Loss: 0.931 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6344301700592041
Epoch: 51, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.924 Vali Acc: 0.750 Test Loss: 0.924 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6390376091003418
Epoch: 52, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.910 Vali Acc: 0.756 Test Loss: 0.910 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 31887
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9654695987701416
Epoch: 1, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.679 Vali Acc: 0.106 Test Loss: 2.679 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.5989274978637695
Epoch: 2, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.575 Vali Acc: 0.150 Test Loss: 2.575 Test Acc: 0.150
Validation loss decreased (-0.105529 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 0.6252098083496094
Epoch: 3, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.438 Vali Acc: 0.211 Test Loss: 2.438 Test Acc: 0.211
Validation loss decreased (-0.149974 --> -0.211087).  Saving model ...
Epoch: 4 cost time: 0.6415238380432129
Epoch: 4, Steps: 12 | Train Loss: 2.357 Vali Loss: 2.293 Vali Acc: 0.300 Test Loss: 2.293 Test Acc: 0.300
Validation loss decreased (-0.211087 --> -0.299977).  Saving model ...
Epoch: 5 cost time: 0.6019744873046875
Epoch: 5, Steps: 12 | Train Loss: 2.152 Vali Loss: 2.150 Vali Acc: 0.378 Test Loss: 2.150 Test Acc: 0.378
Validation loss decreased (-0.299977 --> -0.377756).  Saving model ...
Epoch: 6 cost time: 0.603950023651123
Epoch: 6, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.022 Vali Acc: 0.433 Test Loss: 2.022 Test Acc: 0.433
Validation loss decreased (-0.377756 --> -0.433313).  Saving model ...
Epoch: 7 cost time: 0.6022472381591797
Epoch: 7, Steps: 12 | Train Loss: 1.928 Vali Loss: 1.903 Vali Acc: 0.489 Test Loss: 1.903 Test Acc: 0.489
Validation loss decreased (-0.433313 --> -0.488870).  Saving model ...
Epoch: 8 cost time: 0.6540865898132324
Epoch: 8, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.791 Vali Acc: 0.511 Test Loss: 1.791 Test Acc: 0.511
Validation loss decreased (-0.488870 --> -0.511093).  Saving model ...
Epoch: 9 cost time: 0.675485372543335
Epoch: 9, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.697 Vali Acc: 0.544 Test Loss: 1.697 Test Acc: 0.544
Validation loss decreased (-0.511093 --> -0.544427).  Saving model ...
Epoch: 10 cost time: 0.6032383441925049
Epoch: 10, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.618 Vali Acc: 0.539 Test Loss: 1.618 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6149277687072754
Epoch: 11, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.554 Vali Acc: 0.550 Test Loss: 1.554 Test Acc: 0.550
Validation loss decreased (-0.544427 --> -0.549984).  Saving model ...
Epoch: 12 cost time: 0.6036777496337891
Epoch: 12, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.504 Vali Acc: 0.561 Test Loss: 1.504 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561096).  Saving model ...
Epoch: 13 cost time: 0.6073935031890869
Epoch: 13, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.451 Vali Acc: 0.572 Test Loss: 1.451 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 14 cost time: 0.703233003616333
Epoch: 14, Steps: 12 | Train Loss: 1.119 Vali Loss: 1.408 Vali Acc: 0.606 Test Loss: 1.408 Test Acc: 0.606
Validation loss decreased (-0.572208 --> -0.605541).  Saving model ...
Epoch: 15 cost time: 0.6003334522247314
Epoch: 15, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.372 Vali Acc: 0.606 Test Loss: 1.372 Test Acc: 0.606
Validation loss decreased (-0.605541 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 0.5896544456481934
Epoch: 16, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.341 Vali Acc: 0.611 Test Loss: 1.341 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 17 cost time: 0.679133415222168
Epoch: 17, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.308 Vali Acc: 0.633 Test Loss: 1.308 Test Acc: 0.633
Validation loss decreased (-0.611098 --> -0.633320).  Saving model ...
Epoch: 18 cost time: 0.6010739803314209
Epoch: 18, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.268 Vali Acc: 0.650 Test Loss: 1.268 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649987).  Saving model ...
Epoch: 19 cost time: 0.5611767768859863
Epoch: 19, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.244 Vali Acc: 0.644 Test Loss: 1.244 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.599848747253418
Epoch: 20, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.221 Vali Acc: 0.650 Test Loss: 1.221 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 21 cost time: 0.5494880676269531
Epoch: 21, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.185 Vali Acc: 0.656 Test Loss: 1.185 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 22 cost time: 0.5545272827148438
Epoch: 22, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.174 Vali Acc: 0.644 Test Loss: 1.174 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6527252197265625
Epoch: 23, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.147 Vali Acc: 0.656 Test Loss: 1.147 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 24 cost time: 0.5790398120880127
Epoch: 24, Steps: 12 | Train Loss: 0.640 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 25 cost time: 0.6214001178741455
Epoch: 25, Steps: 12 | Train Loss: 0.624 Vali Loss: 1.091 Vali Acc: 0.678 Test Loss: 1.091 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 26 cost time: 0.6064624786376953
Epoch: 26, Steps: 12 | Train Loss: 0.584 Vali Loss: 1.073 Vali Acc: 0.678 Test Loss: 1.073 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 27 cost time: 0.6151189804077148
Epoch: 27, Steps: 12 | Train Loss: 0.559 Vali Loss: 1.053 Vali Acc: 0.694 Test Loss: 1.053 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 28 cost time: 0.6311838626861572
Epoch: 28, Steps: 12 | Train Loss: 0.503 Vali Loss: 1.012 Vali Acc: 0.683 Test Loss: 1.012 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.649888277053833
Epoch: 29, Steps: 12 | Train Loss: 0.488 Vali Loss: 1.001 Vali Acc: 0.683 Test Loss: 1.001 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6521379947662354
Epoch: 30, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.981 Vali Acc: 0.706 Test Loss: 0.981 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 31 cost time: 0.5670466423034668
Epoch: 31, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.968 Vali Acc: 0.711 Test Loss: 0.968 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711101).  Saving model ...
Epoch: 32 cost time: 0.6721253395080566
Epoch: 32, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.965 Vali Acc: 0.706 Test Loss: 0.965 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5773229598999023
Epoch: 33, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.948 Vali Acc: 0.694 Test Loss: 0.948 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5766546726226807
Epoch: 34, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5877001285552979
Epoch: 35, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.922 Vali Acc: 0.711 Test Loss: 0.922 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711102).  Saving model ...
Epoch: 36 cost time: 0.6723146438598633
Epoch: 36, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.914 Vali Acc: 0.711 Test Loss: 0.914 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 37 cost time: 0.5702893733978271
Epoch: 37, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.904 Vali Acc: 0.722 Test Loss: 0.904 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722213).  Saving model ...
Epoch: 38 cost time: 0.6527469158172607
Epoch: 38, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.910 Vali Acc: 0.717 Test Loss: 0.910 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6639058589935303
Epoch: 39, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.895 Vali Acc: 0.722 Test Loss: 0.895 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 40 cost time: 0.6062395572662354
Epoch: 40, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.886 Vali Acc: 0.733 Test Loss: 0.886 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 41 cost time: 0.6048927307128906
Epoch: 41, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 42 cost time: 0.6253416538238525
Epoch: 42, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.894 Vali Acc: 0.728 Test Loss: 0.894 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5875074863433838
Epoch: 43, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.898 Vali Acc: 0.722 Test Loss: 0.898 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6474714279174805
Epoch: 44, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.909 Vali Acc: 0.728 Test Loss: 0.909 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5865318775177002
Epoch: 45, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.904 Vali Acc: 0.733 Test Loss: 0.904 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5969431400299072
Epoch: 46, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.894 Vali Acc: 0.728 Test Loss: 0.894 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.583423376083374
Epoch: 47, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.917 Vali Acc: 0.717 Test Loss: 0.917 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5825748443603516
Epoch: 48, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.906 Vali Acc: 0.711 Test Loss: 0.906 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5978920459747314
Epoch: 49, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6106650829315186
Epoch: 50, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.919 Vali Acc: 0.722 Test Loss: 0.919 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6476998329162598
Epoch: 51, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.920 Vali Acc: 0.717 Test Loss: 0.920 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 30031
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0752034187316895
Epoch: 1, Steps: 12 | Train Loss: 2.874 Vali Loss: 2.770 Vali Acc: 0.044 Test Loss: 2.770 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 0.6246433258056641
Epoch: 2, Steps: 12 | Train Loss: 2.807 Vali Loss: 2.693 Vali Acc: 0.078 Test Loss: 2.693 Test Acc: 0.078
Validation loss decreased (-0.044417 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 0.614476203918457
Epoch: 3, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.585 Vali Acc: 0.100 Test Loss: 2.585 Test Acc: 0.100
Validation loss decreased (-0.077751 --> -0.099974).  Saving model ...
Epoch: 4 cost time: 0.5912678241729736
Epoch: 4, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.461 Vali Acc: 0.217 Test Loss: 2.461 Test Acc: 0.217
Validation loss decreased (-0.099974 --> -0.216642).  Saving model ...
Epoch: 5 cost time: 0.5209212303161621
Epoch: 5, Steps: 12 | Train Loss: 2.431 Vali Loss: 2.332 Vali Acc: 0.289 Test Loss: 2.332 Test Acc: 0.289
Validation loss decreased (-0.216642 --> -0.288866).  Saving model ...
Epoch: 6 cost time: 0.5908362865447998
Epoch: 6, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.191 Vali Acc: 0.372 Test Loss: 2.191 Test Acc: 0.372
Validation loss decreased (-0.288866 --> -0.372200).  Saving model ...
Epoch: 7 cost time: 0.571941614151001
Epoch: 7, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.071 Vali Acc: 0.400 Test Loss: 2.071 Test Acc: 0.400
Validation loss decreased (-0.372200 --> -0.399979).  Saving model ...
Epoch: 8 cost time: 0.6516497135162354
Epoch: 8, Steps: 12 | Train Loss: 1.979 Vali Loss: 1.958 Vali Acc: 0.456 Test Loss: 1.958 Test Acc: 0.456
Validation loss decreased (-0.399979 --> -0.455536).  Saving model ...
Epoch: 9 cost time: 0.6193864345550537
Epoch: 9, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.852 Vali Acc: 0.494 Test Loss: 1.852 Test Acc: 0.494
Validation loss decreased (-0.455536 --> -0.494426).  Saving model ...
Epoch: 10 cost time: 0.6541335582733154
Epoch: 10, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.755 Vali Acc: 0.511 Test Loss: 1.755 Test Acc: 0.511
Validation loss decreased (-0.494426 --> -0.511094).  Saving model ...
Epoch: 11 cost time: 0.5881295204162598
Epoch: 11, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.681 Vali Acc: 0.533 Test Loss: 1.681 Test Acc: 0.533
Validation loss decreased (-0.511094 --> -0.533317).  Saving model ...
Epoch: 12 cost time: 0.6052966117858887
Epoch: 12, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.609 Vali Acc: 0.550 Test Loss: 1.609 Test Acc: 0.550
Validation loss decreased (-0.533317 --> -0.549984).  Saving model ...
Epoch: 13 cost time: 0.5933060646057129
Epoch: 13, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.543 Vali Acc: 0.550 Test Loss: 1.543 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549985).  Saving model ...
Epoch: 14 cost time: 0.581202507019043
Epoch: 14, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.488 Vali Acc: 0.583 Test Loss: 1.488 Test Acc: 0.583
Validation loss decreased (-0.549985 --> -0.583318).  Saving model ...
Epoch: 15 cost time: 0.5778040885925293
Epoch: 15, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.438 Vali Acc: 0.572 Test Loss: 1.438 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6022641658782959
Epoch: 16, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.391 Vali Acc: 0.611 Test Loss: 1.391 Test Acc: 0.611
Validation loss decreased (-0.583318 --> -0.611097).  Saving model ...
Epoch: 17 cost time: 0.5936532020568848
Epoch: 17, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.341 Vali Acc: 0.589 Test Loss: 1.341 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6532621383666992
Epoch: 18, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.305 Vali Acc: 0.594 Test Loss: 1.305 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6177341938018799
Epoch: 19, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.267 Vali Acc: 0.594 Test Loss: 1.267 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5701467990875244
Epoch: 20, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.219 Vali Acc: 0.600 Test Loss: 1.219 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.592078685760498
Epoch: 21, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.185 Vali Acc: 0.611 Test Loss: 1.185 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611099).  Saving model ...
Epoch: 22 cost time: 0.5858206748962402
Epoch: 22, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.145 Vali Acc: 0.633 Test Loss: 1.145 Test Acc: 0.633
Validation loss decreased (-0.611099 --> -0.633322).  Saving model ...
Epoch: 23 cost time: 0.6179852485656738
Epoch: 23, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.108 Vali Acc: 0.633 Test Loss: 1.108 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 24 cost time: 0.6718575954437256
Epoch: 24, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.088 Vali Acc: 0.650 Test Loss: 1.088 Test Acc: 0.650
Validation loss decreased (-0.633322 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 0.6324479579925537
Epoch: 25, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.058 Vali Acc: 0.650 Test Loss: 1.058 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.5975723266601562
Epoch: 26, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.043 Vali Acc: 0.661 Test Loss: 1.043 Test Acc: 0.661
Validation loss decreased (-0.649989 --> -0.661101).  Saving model ...
Epoch: 27 cost time: 0.563601016998291
Epoch: 27, Steps: 12 | Train Loss: 0.601 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6122193336486816
Epoch: 28, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.017 Vali Acc: 0.650 Test Loss: 1.017 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6232926845550537
Epoch: 29, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.987 Vali Acc: 0.656 Test Loss: 0.987 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6120419502258301
Epoch: 30, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.980 Vali Acc: 0.678 Test Loss: 0.980 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 31 cost time: 0.6272072792053223
Epoch: 31, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.963 Vali Acc: 0.689 Test Loss: 0.963 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 32 cost time: 0.5924508571624756
Epoch: 32, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.960 Vali Acc: 0.694 Test Loss: 0.960 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 33 cost time: 0.6463181972503662
Epoch: 33, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.949 Vali Acc: 0.694 Test Loss: 0.949 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 34 cost time: 0.5600056648254395
Epoch: 34, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.939 Vali Acc: 0.706 Test Loss: 0.939 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705546).  Saving model ...
Epoch: 35 cost time: 0.5693764686584473
Epoch: 35, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.933 Vali Acc: 0.694 Test Loss: 0.933 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5974855422973633
Epoch: 36, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.931 Vali Acc: 0.694 Test Loss: 0.931 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6397628784179688
Epoch: 37, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.927 Vali Acc: 0.694 Test Loss: 0.927 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5938358306884766
Epoch: 38, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.924 Vali Acc: 0.722 Test Loss: 0.924 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 39 cost time: 0.5277831554412842
Epoch: 39, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.913 Vali Acc: 0.711 Test Loss: 0.913 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6386055946350098
Epoch: 40, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.914 Vali Acc: 0.717 Test Loss: 0.914 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6625101566314697
Epoch: 41, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.903 Vali Acc: 0.733 Test Loss: 0.903 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 42 cost time: 0.634570837020874
Epoch: 42, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 43 cost time: 0.6057732105255127
Epoch: 43, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749991).  Saving model ...
Epoch: 44 cost time: 0.6558408737182617
Epoch: 44, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.892 Vali Acc: 0.756 Test Loss: 0.892 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 45 cost time: 0.635979175567627
Epoch: 45, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.882 Vali Acc: 0.761 Test Loss: 0.882 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 46 cost time: 0.7005629539489746
Epoch: 46, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.879 Vali Acc: 0.767 Test Loss: 0.879 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 47 cost time: 0.6265404224395752
Epoch: 47, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.883 Vali Acc: 0.761 Test Loss: 0.883 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6642868518829346
Epoch: 48, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.881 Vali Acc: 0.761 Test Loss: 0.881 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6653478145599365
Epoch: 49, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6487703323364258
Epoch: 50, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6166293621063232
Epoch: 51, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.897 Vali Acc: 0.756 Test Loss: 0.897 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6085140705108643
Epoch: 52, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.912 Vali Acc: 0.756 Test Loss: 0.912 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5961940288543701
Epoch: 53, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.896 Vali Acc: 0.750 Test Loss: 0.896 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.70414137840271
Epoch: 54, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.914 Vali Acc: 0.739 Test Loss: 0.914 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.6238431930541992
Epoch: 55, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.911 Vali Acc: 0.767 Test Loss: 0.911 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.6022140979766846
Epoch: 56, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 28207
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0107314586639404
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.640 Vali Acc: 0.133 Test Loss: 2.640 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 0.6461427211761475
Epoch: 2, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.286 Vali Acc: 0.283 Test Loss: 2.286 Test Acc: 0.283
Validation loss decreased (-0.133307 --> -0.283310).  Saving model ...
Epoch: 3 cost time: 0.6365528106689453
Epoch: 3, Steps: 12 | Train Loss: 2.109 Vali Loss: 1.956 Vali Acc: 0.450 Test Loss: 1.956 Test Acc: 0.450
Validation loss decreased (-0.283310 --> -0.449980).  Saving model ...
Epoch: 4 cost time: 0.5955355167388916
Epoch: 4, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.725 Vali Acc: 0.489 Test Loss: 1.725 Test Acc: 0.489
Validation loss decreased (-0.449980 --> -0.488872).  Saving model ...
Epoch: 5 cost time: 0.616187572479248
Epoch: 5, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.569 Vali Acc: 0.533 Test Loss: 1.569 Test Acc: 0.533
Validation loss decreased (-0.488872 --> -0.533318).  Saving model ...
Epoch: 6 cost time: 0.5920331478118896
Epoch: 6, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.456 Vali Acc: 0.539 Test Loss: 1.456 Test Acc: 0.539
Validation loss decreased (-0.533318 --> -0.538874).  Saving model ...
Epoch: 7 cost time: 0.6313648223876953
Epoch: 7, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.411 Vali Acc: 0.556 Test Loss: 1.411 Test Acc: 0.556
Validation loss decreased (-0.538874 --> -0.555541).  Saving model ...
Epoch: 8 cost time: 0.6242458820343018
Epoch: 8, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.335 Vali Acc: 0.611 Test Loss: 1.335 Test Acc: 0.611
Validation loss decreased (-0.555541 --> -0.611098).  Saving model ...
Epoch: 9 cost time: 0.6117434501647949
Epoch: 9, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.274 Vali Acc: 0.622 Test Loss: 1.274 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 10 cost time: 0.6342983245849609
Epoch: 10, Steps: 12 | Train Loss: 0.797 Vali Loss: 1.229 Vali Acc: 0.617 Test Loss: 1.229 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6590836048126221
Epoch: 11, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.211 Vali Acc: 0.650 Test Loss: 1.211 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.6252086162567139
Epoch: 12, Steps: 12 | Train Loss: 0.710 Vali Loss: 1.184 Vali Acc: 0.644 Test Loss: 1.184 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.590869665145874
Epoch: 13, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.156 Vali Acc: 0.667 Test Loss: 1.156 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 0.5694780349731445
Epoch: 14, Steps: 12 | Train Loss: 0.553 Vali Loss: 1.160 Vali Acc: 0.656 Test Loss: 1.160 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5891902446746826
Epoch: 15, Steps: 12 | Train Loss: 0.474 Vali Loss: 1.091 Vali Acc: 0.667 Test Loss: 1.091 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 0.614720344543457
Epoch: 16, Steps: 12 | Train Loss: 0.443 Vali Loss: 1.049 Vali Acc: 0.711 Test Loss: 1.049 Test Acc: 0.711
Validation loss decreased (-0.666656 --> -0.711101).  Saving model ...
Epoch: 17 cost time: 0.590491771697998
Epoch: 17, Steps: 12 | Train Loss: 0.376 Vali Loss: 1.080 Vali Acc: 0.728 Test Loss: 1.080 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727767).  Saving model ...
Epoch: 18 cost time: 0.6102359294891357
Epoch: 18, Steps: 12 | Train Loss: 0.307 Vali Loss: 1.027 Vali Acc: 0.739 Test Loss: 1.027 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 19 cost time: 0.6072597503662109
Epoch: 19, Steps: 12 | Train Loss: 0.285 Vali Loss: 1.025 Vali Acc: 0.756 Test Loss: 1.025 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755545).  Saving model ...
Epoch: 20 cost time: 0.5946125984191895
Epoch: 20, Steps: 12 | Train Loss: 0.246 Vali Loss: 1.074 Vali Acc: 0.728 Test Loss: 1.074 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5837874412536621
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 1.067 Vali Acc: 0.744 Test Loss: 1.067 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5706589221954346
Epoch: 22, Steps: 12 | Train Loss: 0.203 Vali Loss: 1.085 Vali Acc: 0.739 Test Loss: 1.085 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5828001499176025
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.133 Vali Acc: 0.722 Test Loss: 1.133 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6012790203094482
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.108 Vali Acc: 0.744 Test Loss: 1.108 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6084098815917969
Epoch: 25, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.150 Vali Acc: 0.728 Test Loss: 1.150 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6220362186431885
Epoch: 26, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.171 Vali Acc: 0.728 Test Loss: 1.171 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6214578151702881
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.157 Vali Acc: 0.750 Test Loss: 1.157 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5941154956817627
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.193 Vali Acc: 0.717 Test Loss: 1.193 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5527245998382568
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.250 Vali Acc: 0.733 Test Loss: 1.250 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 56047
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9073102474212646
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.687 Vali Acc: 0.083 Test Loss: 2.687 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.5961391925811768
Epoch: 2, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.474 Vali Acc: 0.194 Test Loss: 2.474 Test Acc: 0.194
Validation loss decreased (-0.083306 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.6197514533996582
Epoch: 3, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.244 Vali Acc: 0.378 Test Loss: 2.244 Test Acc: 0.378
Validation loss decreased (-0.194420 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 0.6092026233673096
Epoch: 4, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.020 Vali Acc: 0.444 Test Loss: 2.020 Test Acc: 0.444
Validation loss decreased (-0.377755 --> -0.444424).  Saving model ...
Epoch: 5 cost time: 0.5814907550811768
Epoch: 5, Steps: 12 | Train Loss: 1.918 Vali Loss: 1.833 Vali Acc: 0.494 Test Loss: 1.833 Test Acc: 0.494
Validation loss decreased (-0.444424 --> -0.494426).  Saving model ...
Epoch: 6 cost time: 0.5786144733428955
Epoch: 6, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.679 Vali Acc: 0.528 Test Loss: 1.679 Test Acc: 0.528
Validation loss decreased (-0.494426 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 0.6176741123199463
Epoch: 7, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.554 Vali Acc: 0.550 Test Loss: 1.554 Test Acc: 0.550
Validation loss decreased (-0.527761 --> -0.549984).  Saving model ...
Epoch: 8 cost time: 0.5677096843719482
Epoch: 8, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.464 Vali Acc: 0.589 Test Loss: 1.464 Test Acc: 0.589
Validation loss decreased (-0.549984 --> -0.588874).  Saving model ...
Epoch: 9 cost time: 0.6136744022369385
Epoch: 9, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.398 Vali Acc: 0.583 Test Loss: 1.398 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.664121150970459
Epoch: 10, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.336 Vali Acc: 0.600 Test Loss: 1.336 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 0.6647071838378906
Epoch: 11, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.289 Vali Acc: 0.617 Test Loss: 1.289 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 12 cost time: 0.6654934883117676
Epoch: 12, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.248 Vali Acc: 0.622 Test Loss: 1.248 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 13 cost time: 0.6411349773406982
Epoch: 13, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.226 Vali Acc: 0.633 Test Loss: 1.226 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633321).  Saving model ...
Epoch: 14 cost time: 0.661978006362915
Epoch: 14, Steps: 12 | Train Loss: 0.765 Vali Loss: 1.197 Vali Acc: 0.672 Test Loss: 1.197 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672210).  Saving model ...
Epoch: 15 cost time: 0.6376686096191406
Epoch: 15, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.136 Vali Acc: 0.672 Test Loss: 1.136 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 16 cost time: 0.6472704410552979
Epoch: 16, Steps: 12 | Train Loss: 0.629 Vali Loss: 1.112 Vali Acc: 0.667 Test Loss: 1.112 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6192507743835449
Epoch: 17, Steps: 12 | Train Loss: 0.569 Vali Loss: 1.103 Vali Acc: 0.689 Test Loss: 1.103 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 18 cost time: 0.6165316104888916
Epoch: 18, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.075 Vali Acc: 0.689 Test Loss: 1.075 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 19 cost time: 0.6551051139831543
Epoch: 19, Steps: 12 | Train Loss: 0.469 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699989).  Saving model ...
Epoch: 20 cost time: 0.6054556369781494
Epoch: 20, Steps: 12 | Train Loss: 0.438 Vali Loss: 1.023 Vali Acc: 0.722 Test Loss: 1.023 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722212).  Saving model ...
Epoch: 21 cost time: 0.6174707412719727
Epoch: 21, Steps: 12 | Train Loss: 0.434 Vali Loss: 1.018 Vali Acc: 0.733 Test Loss: 1.018 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 22 cost time: 0.5973002910614014
Epoch: 22, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.985 Vali Acc: 0.717 Test Loss: 0.985 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6165525913238525
Epoch: 23, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.993 Vali Acc: 0.733 Test Loss: 0.993 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 24 cost time: 0.638615608215332
Epoch: 24, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.966 Vali Acc: 0.711 Test Loss: 0.966 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6398582458496094
Epoch: 25, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.985 Vali Acc: 0.756 Test Loss: 0.985 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 26 cost time: 0.6485068798065186
Epoch: 26, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.976 Vali Acc: 0.744 Test Loss: 0.976 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6517472267150879
Epoch: 27, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.972 Vali Acc: 0.739 Test Loss: 0.972 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.627549409866333
Epoch: 28, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.992 Vali Acc: 0.717 Test Loss: 0.992 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6047642230987549
Epoch: 29, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.997 Vali Acc: 0.744 Test Loss: 0.997 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6618895530700684
Epoch: 30, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.999 Vali Acc: 0.722 Test Loss: 0.999 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6502096652984619
Epoch: 31, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.984 Vali Acc: 0.733 Test Loss: 0.984 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6327714920043945
Epoch: 32, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.029 Vali Acc: 0.717 Test Loss: 1.029 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.614203691482544
Epoch: 33, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.031 Vali Acc: 0.733 Test Loss: 1.031 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5961592197418213
Epoch: 34, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.031 Vali Acc: 0.728 Test Loss: 1.031 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5862715244293213
Epoch: 35, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.037 Vali Acc: 0.733 Test Loss: 1.037 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 34959
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0293490886688232
Epoch: 1, Steps: 12 | Train Loss: 2.988 Vali Loss: 2.864 Vali Acc: 0.050 Test Loss: 2.864 Test Acc: 0.050
Validation loss decreased (inf --> -0.049971).  Saving model ...
Epoch: 2 cost time: 0.6109843254089355
Epoch: 2, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.630 Vali Acc: 0.133 Test Loss: 2.630 Test Acc: 0.133
Validation loss decreased (-0.049971 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 0.6240794658660889
Epoch: 3, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.367 Vali Acc: 0.272 Test Loss: 2.367 Test Acc: 0.272
Validation loss decreased (-0.133307 --> -0.272199).  Saving model ...
Epoch: 4 cost time: 0.5984985828399658
Epoch: 4, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.116 Vali Acc: 0.378 Test Loss: 2.116 Test Acc: 0.378
Validation loss decreased (-0.272199 --> -0.377757).  Saving model ...
Epoch: 5 cost time: 0.599473237991333
Epoch: 5, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.897 Vali Acc: 0.439 Test Loss: 1.897 Test Acc: 0.439
Validation loss decreased (-0.377757 --> -0.438870).  Saving model ...
Epoch: 6 cost time: 0.6080677509307861
Epoch: 6, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.721 Vali Acc: 0.483 Test Loss: 1.721 Test Acc: 0.483
Validation loss decreased (-0.438870 --> -0.483316).  Saving model ...
Epoch: 7 cost time: 0.5895862579345703
Epoch: 7, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.593 Vali Acc: 0.511 Test Loss: 1.593 Test Acc: 0.511
Validation loss decreased (-0.483316 --> -0.511095).  Saving model ...
Epoch: 8 cost time: 0.5897619724273682
Epoch: 8, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.499 Vali Acc: 0.533 Test Loss: 1.499 Test Acc: 0.533
Validation loss decreased (-0.511095 --> -0.533318).  Saving model ...
Epoch: 9 cost time: 0.5868017673492432
Epoch: 9, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.415 Vali Acc: 0.567 Test Loss: 1.415 Test Acc: 0.567
Validation loss decreased (-0.533318 --> -0.566653).  Saving model ...
Epoch: 10 cost time: 0.6109158992767334
Epoch: 10, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.355 Vali Acc: 0.600 Test Loss: 1.355 Test Acc: 0.600
Validation loss decreased (-0.566653 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 0.6779143810272217
Epoch: 11, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.314 Vali Acc: 0.617 Test Loss: 1.314 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 12 cost time: 0.6369459629058838
Epoch: 12, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.250 Vali Acc: 0.622 Test Loss: 1.250 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 13 cost time: 0.6133105754852295
Epoch: 13, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.215 Vali Acc: 0.622 Test Loss: 1.215 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 14 cost time: 0.6026136875152588
Epoch: 14, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.179 Vali Acc: 0.633 Test Loss: 1.179 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633322).  Saving model ...
Epoch: 15 cost time: 0.5264928340911865
Epoch: 15, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.145 Vali Acc: 0.639 Test Loss: 1.145 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638877).  Saving model ...
Epoch: 16 cost time: 0.5462558269500732
Epoch: 16, Steps: 12 | Train Loss: 0.610 Vali Loss: 1.112 Vali Acc: 0.656 Test Loss: 1.112 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 17 cost time: 0.5695674419403076
Epoch: 17, Steps: 12 | Train Loss: 0.571 Vali Loss: 1.098 Vali Acc: 0.656 Test Loss: 1.098 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 18 cost time: 0.573354959487915
Epoch: 18, Steps: 12 | Train Loss: 0.545 Vali Loss: 1.090 Vali Acc: 0.644 Test Loss: 1.090 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6404972076416016
Epoch: 19, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.055 Vali Acc: 0.694 Test Loss: 1.055 Test Acc: 0.694
Validation loss decreased (-0.655545 --> -0.694434).  Saving model ...
Epoch: 20 cost time: 0.6181833744049072
Epoch: 20, Steps: 12 | Train Loss: 0.460 Vali Loss: 1.025 Vali Acc: 0.706 Test Loss: 1.025 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 21 cost time: 0.5862789154052734
Epoch: 21, Steps: 12 | Train Loss: 0.382 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722212).  Saving model ...
Epoch: 22 cost time: 0.5912280082702637
Epoch: 22, Steps: 12 | Train Loss: 0.359 Vali Loss: 1.000 Vali Acc: 0.722 Test Loss: 1.000 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 23 cost time: 0.6301524639129639
Epoch: 23, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.975 Vali Acc: 0.728 Test Loss: 0.975 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 24 cost time: 0.5766260623931885
Epoch: 24, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.983 Vali Acc: 0.739 Test Loss: 0.983 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 25 cost time: 0.5682203769683838
Epoch: 25, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.990 Vali Acc: 0.711 Test Loss: 0.990 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5558643341064453
Epoch: 26, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.008 Vali Acc: 0.711 Test Loss: 1.008 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5937950611114502
Epoch: 27, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.992 Vali Acc: 0.711 Test Loss: 0.992 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6235370635986328
Epoch: 28, Steps: 12 | Train Loss: 0.206 Vali Loss: 1.005 Vali Acc: 0.717 Test Loss: 1.005 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6253743171691895
Epoch: 29, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.022 Vali Acc: 0.733 Test Loss: 1.022 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6218767166137695
Epoch: 30, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.017 Vali Acc: 0.739 Test Loss: 1.017 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6509315967559814
Epoch: 31, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.022 Vali Acc: 0.733 Test Loss: 1.022 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6178841590881348
Epoch: 32, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.032 Vali Acc: 0.722 Test Loss: 1.032 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.592766284942627
Epoch: 33, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.070 Vali Acc: 0.717 Test Loss: 1.070 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5658729076385498
Epoch: 34, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.067 Vali Acc: 0.711 Test Loss: 1.067 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 34031
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.13979172706604
Epoch: 1, Steps: 12 | Train Loss: 2.942 Vali Loss: 2.746 Vali Acc: 0.083 Test Loss: 2.746 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.5876352787017822
Epoch: 2, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.599 Vali Acc: 0.150 Test Loss: 2.599 Test Acc: 0.150
Validation loss decreased (-0.083306 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 0.6443345546722412
Epoch: 3, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.407 Vali Acc: 0.250 Test Loss: 2.407 Test Acc: 0.250
Validation loss decreased (-0.149974 --> -0.249976).  Saving model ...
Epoch: 4 cost time: 0.598156213760376
Epoch: 4, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.217 Vali Acc: 0.339 Test Loss: 2.217 Test Acc: 0.339
Validation loss decreased (-0.249976 --> -0.338867).  Saving model ...
Epoch: 5 cost time: 0.5563709735870361
Epoch: 5, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.041 Vali Acc: 0.444 Test Loss: 2.041 Test Acc: 0.444
Validation loss decreased (-0.338867 --> -0.444424).  Saving model ...
Epoch: 6 cost time: 0.5880095958709717
Epoch: 6, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.892 Vali Acc: 0.461 Test Loss: 1.892 Test Acc: 0.461
Validation loss decreased (-0.444424 --> -0.461092).  Saving model ...
Epoch: 7 cost time: 0.6276497840881348
Epoch: 7, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.755 Vali Acc: 0.517 Test Loss: 1.755 Test Acc: 0.517
Validation loss decreased (-0.461092 --> -0.516649).  Saving model ...
Epoch: 8 cost time: 0.6414704322814941
Epoch: 8, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.653 Vali Acc: 0.528 Test Loss: 1.653 Test Acc: 0.528
Validation loss decreased (-0.516649 --> -0.527761).  Saving model ...
Epoch: 9 cost time: 0.6860237121582031
Epoch: 9, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.552 Vali Acc: 0.533 Test Loss: 1.552 Test Acc: 0.533
Validation loss decreased (-0.527761 --> -0.533318).  Saving model ...
Epoch: 10 cost time: 0.6794612407684326
Epoch: 10, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.482 Vali Acc: 0.567 Test Loss: 1.482 Test Acc: 0.567
Validation loss decreased (-0.533318 --> -0.566652).  Saving model ...
Epoch: 11 cost time: 0.616081953048706
Epoch: 11, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.424 Vali Acc: 0.567 Test Loss: 1.424 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 12 cost time: 0.6273152828216553
Epoch: 12, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.360 Vali Acc: 0.583 Test Loss: 1.360 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583320).  Saving model ...
Epoch: 13 cost time: 0.6324925422668457
Epoch: 13, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.326 Vali Acc: 0.606 Test Loss: 1.326 Test Acc: 0.606
Validation loss decreased (-0.583320 --> -0.605542).  Saving model ...
Epoch: 14 cost time: 0.6251797676086426
Epoch: 14, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.284 Vali Acc: 0.600 Test Loss: 1.284 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6772618293762207
Epoch: 15, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.255 Vali Acc: 0.622 Test Loss: 1.255 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622210).  Saving model ...
Epoch: 16 cost time: 0.6299591064453125
Epoch: 16, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.239 Vali Acc: 0.633 Test Loss: 1.239 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633321).  Saving model ...
Epoch: 17 cost time: 0.5801966190338135
Epoch: 17, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.208 Vali Acc: 0.644 Test Loss: 1.208 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644432).  Saving model ...
Epoch: 18 cost time: 0.5796890258789062
Epoch: 18, Steps: 12 | Train Loss: 0.730 Vali Loss: 1.149 Vali Acc: 0.656 Test Loss: 1.149 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 19 cost time: 0.6148843765258789
Epoch: 19, Steps: 12 | Train Loss: 0.665 Vali Loss: 1.130 Vali Acc: 0.661 Test Loss: 1.130 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 20 cost time: 0.5505216121673584
Epoch: 20, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.105 Vali Acc: 0.661 Test Loss: 1.105 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661100).  Saving model ...
Epoch: 21 cost time: 0.5845949649810791
Epoch: 21, Steps: 12 | Train Loss: 0.582 Vali Loss: 1.082 Vali Acc: 0.667 Test Loss: 1.082 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 22 cost time: 0.5944688320159912
Epoch: 22, Steps: 12 | Train Loss: 0.600 Vali Loss: 1.069 Vali Acc: 0.667 Test Loss: 1.069 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 23 cost time: 0.5976107120513916
Epoch: 23, Steps: 12 | Train Loss: 0.555 Vali Loss: 1.042 Vali Acc: 0.672 Test Loss: 1.042 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 24 cost time: 0.6404209136962891
Epoch: 24, Steps: 12 | Train Loss: 0.469 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.6565940380096436
Epoch: 25, Steps: 12 | Train Loss: 0.444 Vali Loss: 1.008 Vali Acc: 0.711 Test Loss: 1.008 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 26 cost time: 0.6496694087982178
Epoch: 26, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.982 Vali Acc: 0.722 Test Loss: 0.982 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 27 cost time: 0.6096899509429932
Epoch: 27, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.996 Vali Acc: 0.694 Test Loss: 0.996 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.576383113861084
Epoch: 28, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.987 Vali Acc: 0.694 Test Loss: 0.987 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.646202564239502
Epoch: 29, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6124505996704102
Epoch: 30, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.980 Vali Acc: 0.728 Test Loss: 0.980 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 31 cost time: 0.5945804119110107
Epoch: 31, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.956 Vali Acc: 0.733 Test Loss: 0.956 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 32 cost time: 0.5971965789794922
Epoch: 32, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.962 Vali Acc: 0.739 Test Loss: 0.962 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 33 cost time: 0.5630011558532715
Epoch: 33, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.956 Vali Acc: 0.728 Test Loss: 0.956 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6158525943756104
Epoch: 34, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.965 Vali Acc: 0.733 Test Loss: 0.965 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6028928756713867
Epoch: 35, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.954 Vali Acc: 0.739 Test Loss: 0.954 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 36 cost time: 0.5696296691894531
Epoch: 36, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.975 Vali Acc: 0.728 Test Loss: 0.975 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5824158191680908
Epoch: 37, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.986 Vali Acc: 0.722 Test Loss: 0.986 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5656561851501465
Epoch: 38, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.990 Vali Acc: 0.733 Test Loss: 0.990 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5963354110717773
Epoch: 39, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.994 Vali Acc: 0.728 Test Loss: 0.994 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.604116678237915
Epoch: 40, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.009 Vali Acc: 0.728 Test Loss: 1.009 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6293237209320068
Epoch: 41, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.026 Vali Acc: 0.733 Test Loss: 1.026 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5944638252258301
Epoch: 42, Steps: 12 | Train Loss: 0.171 Vali Loss: 1.041 Vali Acc: 0.733 Test Loss: 1.041 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5573780536651611
Epoch: 43, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.020 Vali Acc: 0.733 Test Loss: 1.020 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6718907356262207
Epoch: 44, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6511716842651367
Epoch: 45, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.031 Vali Acc: 0.739 Test Loss: 1.031 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 27343
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.008582830429077
Epoch: 1, Steps: 12 | Train Loss: 2.831 Vali Loss: 2.760 Vali Acc: 0.100 Test Loss: 2.760 Test Acc: 0.100
Validation loss decreased (inf --> -0.099972).  Saving model ...
Epoch: 2 cost time: 0.5961058139801025
Epoch: 2, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.637 Vali Acc: 0.156 Test Loss: 2.637 Test Acc: 0.156
Validation loss decreased (-0.099972 --> -0.155529).  Saving model ...
Epoch: 3 cost time: 0.6368224620819092
Epoch: 3, Steps: 12 | Train Loss: 2.561 Vali Loss: 2.479 Vali Acc: 0.194 Test Loss: 2.479 Test Acc: 0.194
Validation loss decreased (-0.155529 --> -0.194420).  Saving model ...
Epoch: 4 cost time: 0.6228749752044678
Epoch: 4, Steps: 12 | Train Loss: 2.435 Vali Loss: 2.310 Vali Acc: 0.294 Test Loss: 2.310 Test Acc: 0.294
Validation loss decreased (-0.194420 --> -0.294421).  Saving model ...
Epoch: 5 cost time: 0.6547398567199707
Epoch: 5, Steps: 12 | Train Loss: 2.177 Vali Loss: 2.154 Vali Acc: 0.378 Test Loss: 2.154 Test Acc: 0.378
Validation loss decreased (-0.294421 --> -0.377756).  Saving model ...
Epoch: 6 cost time: 0.6552433967590332
Epoch: 6, Steps: 12 | Train Loss: 1.979 Vali Loss: 2.021 Vali Acc: 0.444 Test Loss: 2.021 Test Acc: 0.444
Validation loss decreased (-0.377756 --> -0.444424).  Saving model ...
Epoch: 7 cost time: 0.6208226680755615
Epoch: 7, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.899 Vali Acc: 0.472 Test Loss: 1.899 Test Acc: 0.472
Validation loss decreased (-0.444424 --> -0.472203).  Saving model ...
Epoch: 8 cost time: 0.6153163909912109
Epoch: 8, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.799 Vali Acc: 0.506 Test Loss: 1.799 Test Acc: 0.506
Validation loss decreased (-0.472203 --> -0.505538).  Saving model ...
Epoch: 9 cost time: 0.6474592685699463
Epoch: 9, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.709 Vali Acc: 0.506 Test Loss: 1.709 Test Acc: 0.506
Validation loss decreased (-0.505538 --> -0.505538).  Saving model ...
Epoch: 10 cost time: 0.5932185649871826
Epoch: 10, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.642 Vali Acc: 0.539 Test Loss: 1.642 Test Acc: 0.539
Validation loss decreased (-0.505538 --> -0.538872).  Saving model ...
Epoch: 11 cost time: 0.5720827579498291
Epoch: 11, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.581 Vali Acc: 0.539 Test Loss: 1.581 Test Acc: 0.539
Validation loss decreased (-0.538872 --> -0.538873).  Saving model ...
Epoch: 12 cost time: 0.6700115203857422
Epoch: 12, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.529 Vali Acc: 0.583 Test Loss: 1.529 Test Acc: 0.583
Validation loss decreased (-0.538873 --> -0.583318).  Saving model ...
Epoch: 13 cost time: 0.6111388206481934
Epoch: 13, Steps: 12 | Train Loss: 1.203 Vali Loss: 1.481 Vali Acc: 0.572 Test Loss: 1.481 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6277763843536377
Epoch: 14, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.445 Vali Acc: 0.567 Test Loss: 1.445 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.62384033203125
Epoch: 15, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.411 Vali Acc: 0.578 Test Loss: 1.411 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7519636154174805
Epoch: 16, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.384 Vali Acc: 0.578 Test Loss: 1.384 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6486549377441406
Epoch: 17, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.352 Vali Acc: 0.628 Test Loss: 1.352 Test Acc: 0.628
Validation loss decreased (-0.583318 --> -0.627764).  Saving model ...
Epoch: 18 cost time: 0.7349350452423096
Epoch: 18, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.307 Vali Acc: 0.628 Test Loss: 1.307 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627765).  Saving model ...
Epoch: 19 cost time: 0.698728084564209
Epoch: 19, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.287 Vali Acc: 0.622 Test Loss: 1.287 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7966921329498291
Epoch: 20, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.264 Vali Acc: 0.633 Test Loss: 1.264 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 21 cost time: 0.6755199432373047
Epoch: 21, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.229 Vali Acc: 0.661 Test Loss: 1.229 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661099).  Saving model ...
Epoch: 22 cost time: 0.6947646141052246
Epoch: 22, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.195 Vali Acc: 0.667 Test Loss: 1.195 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 23 cost time: 0.6943683624267578
Epoch: 23, Steps: 12 | Train Loss: 0.680 Vali Loss: 1.171 Vali Acc: 0.656 Test Loss: 1.171 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7066547870635986
Epoch: 24, Steps: 12 | Train Loss: 0.667 Vali Loss: 1.156 Vali Acc: 0.667 Test Loss: 1.156 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 25 cost time: 0.7612133026123047
Epoch: 25, Steps: 12 | Train Loss: 0.609 Vali Loss: 1.125 Vali Acc: 0.683 Test Loss: 1.125 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 26 cost time: 0.6934061050415039
Epoch: 26, Steps: 12 | Train Loss: 0.566 Vali Loss: 1.081 Vali Acc: 0.672 Test Loss: 1.081 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6681380271911621
Epoch: 27, Steps: 12 | Train Loss: 0.541 Vali Loss: 1.054 Vali Acc: 0.683 Test Loss: 1.054 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683323).  Saving model ...
Epoch: 28 cost time: 0.6353027820587158
Epoch: 28, Steps: 12 | Train Loss: 0.507 Vali Loss: 1.036 Vali Acc: 0.683 Test Loss: 1.036 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 29 cost time: 0.6654279232025146
Epoch: 29, Steps: 12 | Train Loss: 0.449 Vali Loss: 1.000 Vali Acc: 0.711 Test Loss: 1.000 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 30 cost time: 0.6908597946166992
Epoch: 30, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.990 Vali Acc: 0.706 Test Loss: 0.990 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7638373374938965
Epoch: 31, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.971 Vali Acc: 0.711 Test Loss: 0.971 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 32 cost time: 0.6608331203460693
Epoch: 32, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 33 cost time: 0.6877725124359131
Epoch: 33, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.945 Vali Acc: 0.711 Test Loss: 0.945 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.732994556427002
Epoch: 34, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.928 Vali Acc: 0.722 Test Loss: 0.928 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 35 cost time: 0.7140903472900391
Epoch: 35, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.921 Vali Acc: 0.733 Test Loss: 0.921 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 36 cost time: 0.6979501247406006
Epoch: 36, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.914 Vali Acc: 0.744 Test Loss: 0.914 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 37 cost time: 0.7359130382537842
Epoch: 37, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.899 Vali Acc: 0.744 Test Loss: 0.899 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 38 cost time: 0.7211675643920898
Epoch: 38, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.890 Vali Acc: 0.733 Test Loss: 0.890 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6977880001068115
Epoch: 39, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.888 Vali Acc: 0.733 Test Loss: 0.888 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6814320087432861
Epoch: 40, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.887 Vali Acc: 0.767 Test Loss: 0.887 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 41 cost time: 0.7191126346588135
Epoch: 41, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.885 Vali Acc: 0.739 Test Loss: 0.885 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7107763290405273
Epoch: 42, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7639167308807373
Epoch: 43, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.893 Vali Acc: 0.744 Test Loss: 0.893 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.705233097076416
Epoch: 44, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.902 Vali Acc: 0.739 Test Loss: 0.902 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7316968441009521
Epoch: 45, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.887 Vali Acc: 0.739 Test Loss: 0.887 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7875759601593018
Epoch: 46, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7540457248687744
Epoch: 47, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6878066062927246
Epoch: 48, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.727332592010498
Epoch: 49, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.883 Vali Acc: 0.739 Test Loss: 0.883 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7649316787719727
Epoch: 50, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.901 Vali Acc: 0.739 Test Loss: 0.901 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 23567
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0405683517456055
Epoch: 1, Steps: 12 | Train Loss: 2.906 Vali Loss: 2.712 Vali Acc: 0.078 Test Loss: 2.712 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.6833903789520264
Epoch: 2, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.610 Vali Acc: 0.128 Test Loss: 2.610 Test Acc: 0.128
Validation loss decreased (-0.077751 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 0.7132065296173096
Epoch: 3, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.484 Vali Acc: 0.178 Test Loss: 2.484 Test Acc: 0.178
Validation loss decreased (-0.127752 --> -0.177753).  Saving model ...
Epoch: 4 cost time: 0.6732203960418701
Epoch: 4, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.341 Vali Acc: 0.256 Test Loss: 2.341 Test Acc: 0.256
Validation loss decreased (-0.177753 --> -0.255532).  Saving model ...
Epoch: 5 cost time: 0.6202914714813232
Epoch: 5, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.192 Vali Acc: 0.311 Test Loss: 2.192 Test Acc: 0.311
Validation loss decreased (-0.255532 --> -0.311089).  Saving model ...
Epoch: 6 cost time: 0.6781594753265381
Epoch: 6, Steps: 12 | Train Loss: 2.156 Vali Loss: 2.057 Vali Acc: 0.328 Test Loss: 2.057 Test Acc: 0.328
Validation loss decreased (-0.311089 --> -0.327757).  Saving model ...
Epoch: 7 cost time: 0.6320943832397461
Epoch: 7, Steps: 12 | Train Loss: 1.984 Vali Loss: 1.941 Vali Acc: 0.394 Test Loss: 1.941 Test Acc: 0.394
Validation loss decreased (-0.327757 --> -0.394425).  Saving model ...
Epoch: 8 cost time: 0.6965088844299316
Epoch: 8, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.829 Vali Acc: 0.478 Test Loss: 1.829 Test Acc: 0.478
Validation loss decreased (-0.394425 --> -0.477759).  Saving model ...
Epoch: 9 cost time: 0.6401312351226807
Epoch: 9, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.739 Vali Acc: 0.472 Test Loss: 1.739 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6364457607269287
Epoch: 10, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.663 Vali Acc: 0.494 Test Loss: 1.663 Test Acc: 0.494
Validation loss decreased (-0.477759 --> -0.494428).  Saving model ...
Epoch: 11 cost time: 0.6444993019104004
Epoch: 11, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.593 Vali Acc: 0.539 Test Loss: 1.593 Test Acc: 0.539
Validation loss decreased (-0.494428 --> -0.538873).  Saving model ...
Epoch: 12 cost time: 0.7955365180969238
Epoch: 12, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.532 Vali Acc: 0.583 Test Loss: 1.532 Test Acc: 0.583
Validation loss decreased (-0.538873 --> -0.583318).  Saving model ...
Epoch: 13 cost time: 0.7062861919403076
Epoch: 13, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.484 Vali Acc: 0.578 Test Loss: 1.484 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7514746189117432
Epoch: 14, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.447 Vali Acc: 0.594 Test Loss: 1.447 Test Acc: 0.594
Validation loss decreased (-0.583318 --> -0.594430).  Saving model ...
Epoch: 15 cost time: 0.7061259746551514
Epoch: 15, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.400 Vali Acc: 0.600 Test Loss: 1.400 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 0.7907133102416992
Epoch: 16, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.362 Vali Acc: 0.606 Test Loss: 1.362 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 17 cost time: 0.6603851318359375
Epoch: 17, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.321 Vali Acc: 0.628 Test Loss: 1.321 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627765).  Saving model ...
Epoch: 18 cost time: 0.6936812400817871
Epoch: 18, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.291 Vali Acc: 0.628 Test Loss: 1.291 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 19 cost time: 0.6798458099365234
Epoch: 19, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.255 Vali Acc: 0.644 Test Loss: 1.255 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644432).  Saving model ...
Epoch: 20 cost time: 0.6778397560119629
Epoch: 20, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.228 Vali Acc: 0.667 Test Loss: 1.228 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666654).  Saving model ...
Epoch: 21 cost time: 0.6553568840026855
Epoch: 21, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.188 Vali Acc: 0.672 Test Loss: 1.188 Test Acc: 0.672
Validation loss decreased (-0.666654 --> -0.672210).  Saving model ...
Epoch: 22 cost time: 0.6922140121459961
Epoch: 22, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.166 Vali Acc: 0.650 Test Loss: 1.166 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6080315113067627
Epoch: 23, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.143 Vali Acc: 0.656 Test Loss: 1.143 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6628363132476807
Epoch: 24, Steps: 12 | Train Loss: 0.683 Vali Loss: 1.099 Vali Acc: 0.667 Test Loss: 1.099 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7076640129089355
Epoch: 25, Steps: 12 | Train Loss: 0.685 Vali Loss: 1.071 Vali Acc: 0.672 Test Loss: 1.071 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672212).  Saving model ...
Epoch: 26 cost time: 0.7290022373199463
Epoch: 26, Steps: 12 | Train Loss: 0.585 Vali Loss: 1.052 Vali Acc: 0.678 Test Loss: 1.052 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677767).  Saving model ...
Epoch: 27 cost time: 0.7000880241394043
Epoch: 27, Steps: 12 | Train Loss: 0.537 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.6763536930084229
Epoch: 28, Steps: 12 | Train Loss: 0.502 Vali Loss: 1.008 Vali Acc: 0.689 Test Loss: 1.008 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6681323051452637
Epoch: 29, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.986 Vali Acc: 0.694 Test Loss: 0.986 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6740751266479492
Epoch: 30, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.981 Vali Acc: 0.700 Test Loss: 0.981 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 31 cost time: 0.6563222408294678
Epoch: 31, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.6939268112182617
Epoch: 32, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.962 Vali Acc: 0.711 Test Loss: 0.962 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 33 cost time: 0.7013249397277832
Epoch: 33, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7663342952728271
Epoch: 34, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 35 cost time: 0.7342298030853271
Epoch: 35, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.929 Vali Acc: 0.717 Test Loss: 0.929 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7308053970336914
Epoch: 36, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.913 Vali Acc: 0.722 Test Loss: 0.913 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 37 cost time: 0.7197780609130859
Epoch: 37, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 38 cost time: 0.7888026237487793
Epoch: 38, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.913 Vali Acc: 0.733 Test Loss: 0.913 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 39 cost time: 0.7179520130157471
Epoch: 39, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.900 Vali Acc: 0.722 Test Loss: 0.900 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6973214149475098
Epoch: 40, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.894 Vali Acc: 0.717 Test Loss: 0.894 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6908164024353027
Epoch: 41, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.875 Vali Acc: 0.744 Test Loss: 0.875 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 42 cost time: 0.6899247169494629
Epoch: 42, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.889 Vali Acc: 0.733 Test Loss: 0.889 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7174551486968994
Epoch: 43, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.884 Vali Acc: 0.728 Test Loss: 0.884 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6984050273895264
Epoch: 44, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.902 Vali Acc: 0.717 Test Loss: 0.902 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7225432395935059
Epoch: 45, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.898 Vali Acc: 0.722 Test Loss: 0.898 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6952371597290039
Epoch: 46, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.893 Vali Acc: 0.722 Test Loss: 0.893 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6942834854125977
Epoch: 47, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7412807941436768
Epoch: 48, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.895 Vali Acc: 0.706 Test Loss: 0.895 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6874973773956299
Epoch: 49, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.871 Vali Acc: 0.728 Test Loss: 0.871 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7166409492492676
Epoch: 50, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.897 Vali Acc: 0.717 Test Loss: 0.897 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.65445876121521
Epoch: 51, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.928 Vali Acc: 0.717 Test Loss: 0.928 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 21711
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1478335857391357
Epoch: 1, Steps: 12 | Train Loss: 2.888 Vali Loss: 2.825 Vali Acc: 0.106 Test Loss: 2.825 Test Acc: 0.106
Validation loss decreased (inf --> -0.105527).  Saving model ...
Epoch: 2 cost time: 0.6358308792114258
Epoch: 2, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.726 Vali Acc: 0.100 Test Loss: 2.726 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.615229606628418
Epoch: 3, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.611 Vali Acc: 0.150 Test Loss: 2.611 Test Acc: 0.150
Validation loss decreased (-0.105527 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 0.6611998081207275
Epoch: 4, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.486 Vali Acc: 0.211 Test Loss: 2.486 Test Acc: 0.211
Validation loss decreased (-0.149974 --> -0.211086).  Saving model ...
Epoch: 5 cost time: 0.6185476779937744
Epoch: 5, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.354 Vali Acc: 0.333 Test Loss: 2.354 Test Acc: 0.333
Validation loss decreased (-0.211086 --> -0.333310).  Saving model ...
Epoch: 6 cost time: 0.615433931350708
Epoch: 6, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.221 Vali Acc: 0.367 Test Loss: 2.221 Test Acc: 0.367
Validation loss decreased (-0.333310 --> -0.366644).  Saving model ...
Epoch: 7 cost time: 0.6465744972229004
Epoch: 7, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.096 Vali Acc: 0.411 Test Loss: 2.096 Test Acc: 0.411
Validation loss decreased (-0.366644 --> -0.411090).  Saving model ...
Epoch: 8 cost time: 0.6366403102874756
Epoch: 8, Steps: 12 | Train Loss: 1.985 Vali Loss: 1.981 Vali Acc: 0.456 Test Loss: 1.981 Test Acc: 0.456
Validation loss decreased (-0.411090 --> -0.455536).  Saving model ...
Epoch: 9 cost time: 0.5922966003417969
Epoch: 9, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.871 Vali Acc: 0.478 Test Loss: 1.871 Test Acc: 0.478
Validation loss decreased (-0.455536 --> -0.477759).  Saving model ...
Epoch: 10 cost time: 0.6456203460693359
Epoch: 10, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.777 Vali Acc: 0.500 Test Loss: 1.777 Test Acc: 0.500
Validation loss decreased (-0.477759 --> -0.499982).  Saving model ...
Epoch: 11 cost time: 0.622286319732666
Epoch: 11, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.703 Vali Acc: 0.517 Test Loss: 1.703 Test Acc: 0.517
Validation loss decreased (-0.499982 --> -0.516650).  Saving model ...
Epoch: 12 cost time: 0.5946242809295654
Epoch: 12, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.633 Vali Acc: 0.528 Test Loss: 1.633 Test Acc: 0.528
Validation loss decreased (-0.516650 --> -0.527761).  Saving model ...
Epoch: 13 cost time: 0.612011194229126
Epoch: 13, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.575 Vali Acc: 0.539 Test Loss: 1.575 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 14 cost time: 0.6328353881835938
Epoch: 14, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.516 Vali Acc: 0.567 Test Loss: 1.516 Test Acc: 0.567
Validation loss decreased (-0.538873 --> -0.566652).  Saving model ...
Epoch: 15 cost time: 0.5784258842468262
Epoch: 15, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.480 Vali Acc: 0.578 Test Loss: 1.480 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577763).  Saving model ...
Epoch: 16 cost time: 0.6262249946594238
Epoch: 16, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.438 Vali Acc: 0.594 Test Loss: 1.438 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594430).  Saving model ...
Epoch: 17 cost time: 0.6687157154083252
Epoch: 17, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.405 Vali Acc: 0.594 Test Loss: 1.405 Test Acc: 0.594
Validation loss decreased (-0.594430 --> -0.594430).  Saving model ...
Epoch: 18 cost time: 0.6381022930145264
Epoch: 18, Steps: 12 | Train Loss: 1.090 Vali Loss: 1.374 Vali Acc: 0.600 Test Loss: 1.374 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 0.6588644981384277
Epoch: 19, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.326 Vali Acc: 0.600 Test Loss: 1.326 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 20 cost time: 0.676084041595459
Epoch: 20, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.288 Vali Acc: 0.633 Test Loss: 1.288 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633320).  Saving model ...
Epoch: 21 cost time: 0.6275534629821777
Epoch: 21, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.254 Vali Acc: 0.633 Test Loss: 1.254 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 22 cost time: 0.6014344692230225
Epoch: 22, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.231 Vali Acc: 0.622 Test Loss: 1.231 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6686851978302002
Epoch: 23, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.183 Vali Acc: 0.644 Test Loss: 1.183 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644433).  Saving model ...
Epoch: 24 cost time: 0.553903341293335
Epoch: 24, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.146 Vali Acc: 0.656 Test Loss: 1.146 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655544).  Saving model ...
Epoch: 25 cost time: 0.5840349197387695
Epoch: 25, Steps: 12 | Train Loss: 0.734 Vali Loss: 1.120 Vali Acc: 0.650 Test Loss: 1.120 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7278647422790527
Epoch: 26, Steps: 12 | Train Loss: 0.740 Vali Loss: 1.090 Vali Acc: 0.639 Test Loss: 1.090 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6640644073486328
Epoch: 27, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.068 Vali Acc: 0.633 Test Loss: 1.068 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.617112398147583
Epoch: 28, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.037 Vali Acc: 0.650 Test Loss: 1.037 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6678061485290527
Epoch: 29, Steps: 12 | Train Loss: 0.538 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6915600299835205
Epoch: 30, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.996 Vali Acc: 0.667 Test Loss: 0.996 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666657).  Saving model ...
Epoch: 31 cost time: 0.6108675003051758
Epoch: 31, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.978 Vali Acc: 0.683 Test Loss: 0.978 Test Acc: 0.683
Validation loss decreased (-0.666657 --> -0.683324).  Saving model ...
Epoch: 32 cost time: 0.6216466426849365
Epoch: 32, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.956 Vali Acc: 0.689 Test Loss: 0.956 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688879).  Saving model ...
Epoch: 33 cost time: 0.6323189735412598
Epoch: 33, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 0.6247506141662598
Epoch: 34, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.929 Vali Acc: 0.694 Test Loss: 0.929 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6087250709533691
Epoch: 35, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.924 Vali Acc: 0.683 Test Loss: 0.924 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6430478096008301
Epoch: 36, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.911 Vali Acc: 0.706 Test Loss: 0.911 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705546).  Saving model ...
Epoch: 37 cost time: 0.5621628761291504
Epoch: 37, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.895 Vali Acc: 0.722 Test Loss: 0.895 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 38 cost time: 0.7721188068389893
Epoch: 38, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.894 Vali Acc: 0.717 Test Loss: 0.894 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7516319751739502
Epoch: 39, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.894 Vali Acc: 0.717 Test Loss: 0.894 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6832592487335205
Epoch: 40, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.883 Vali Acc: 0.728 Test Loss: 0.883 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 41 cost time: 0.5872981548309326
Epoch: 41, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.885 Vali Acc: 0.711 Test Loss: 0.885 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6592235565185547
Epoch: 42, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.894 Vali Acc: 0.683 Test Loss: 0.894 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6345303058624268
Epoch: 43, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.875 Vali Acc: 0.700 Test Loss: 0.875 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6054551601409912
Epoch: 44, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.873 Vali Acc: 0.717 Test Loss: 0.873 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6052994728088379
Epoch: 45, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 46 cost time: 0.558936595916748
Epoch: 46, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.870 Vali Acc: 0.706 Test Loss: 0.870 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6179981231689453
Epoch: 47, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.858 Vali Acc: 0.722 Test Loss: 0.858 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6233606338500977
Epoch: 48, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.853 Vali Acc: 0.728 Test Loss: 0.853 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 49 cost time: 0.6011843681335449
Epoch: 49, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.849 Vali Acc: 0.728 Test Loss: 0.849 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 50 cost time: 0.6864120960235596
Epoch: 50, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.853 Vali Acc: 0.733 Test Loss: 0.853 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 51 cost time: 0.673825740814209
Epoch: 51, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.883 Vali Acc: 0.733 Test Loss: 0.883 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6162290573120117
Epoch: 52, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.867 Vali Acc: 0.728 Test Loss: 0.867 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6039977073669434
Epoch: 53, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.866 Vali Acc: 0.728 Test Loss: 0.866 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6278915405273438
Epoch: 54, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.617556095123291
Epoch: 55, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.859 Vali Acc: 0.744 Test Loss: 0.859 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 56 cost time: 0.6421809196472168
Epoch: 56, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.873 Vali Acc: 0.739 Test Loss: 0.873 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6649081707000732
Epoch: 57, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.875 Vali Acc: 0.739 Test Loss: 0.875 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6207225322723389
Epoch: 58, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.884 Vali Acc: 0.733 Test Loss: 0.884 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6564569473266602
Epoch: 59, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.903 Vali Acc: 0.728 Test Loss: 0.903 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5920069217681885
Epoch: 60, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.907 Vali Acc: 0.728 Test Loss: 0.907 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.579787015914917
Epoch: 61, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.901 Vali Acc: 0.717 Test Loss: 0.901 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.6400997638702393
Epoch: 62, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.924 Vali Acc: 0.739 Test Loss: 0.924 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6894612312316895
Epoch: 63, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.6451749801635742
Epoch: 64, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.921 Vali Acc: 0.728 Test Loss: 0.921 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.6769547462463379
Epoch: 65, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 19887
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.044398069381714
Epoch: 1, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.624 Vali Acc: 0.144 Test Loss: 2.624 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 0.6395843029022217
Epoch: 2, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.321 Vali Acc: 0.239 Test Loss: 2.321 Test Acc: 0.239
Validation loss decreased (-0.144418 --> -0.238866).  Saving model ...
Epoch: 3 cost time: 0.7427768707275391
Epoch: 3, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.000 Vali Acc: 0.394 Test Loss: 2.000 Test Acc: 0.394
Validation loss decreased (-0.238866 --> -0.394424).  Saving model ...
Epoch: 4 cost time: 0.6638407707214355
Epoch: 4, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.755 Vali Acc: 0.483 Test Loss: 1.755 Test Acc: 0.483
Validation loss decreased (-0.394424 --> -0.483316).  Saving model ...
Epoch: 5 cost time: 0.6683063507080078
Epoch: 5, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.579 Vali Acc: 0.528 Test Loss: 1.579 Test Acc: 0.528
Validation loss decreased (-0.483316 --> -0.527762).  Saving model ...
Epoch: 6 cost time: 0.6839878559112549
Epoch: 6, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.482 Vali Acc: 0.539 Test Loss: 1.482 Test Acc: 0.539
Validation loss decreased (-0.527762 --> -0.538874).  Saving model ...
Epoch: 7 cost time: 0.6478695869445801
Epoch: 7, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.373 Vali Acc: 0.572 Test Loss: 1.373 Test Acc: 0.572
Validation loss decreased (-0.538874 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 0.6422159671783447
Epoch: 8, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.316 Vali Acc: 0.594 Test Loss: 1.316 Test Acc: 0.594
Validation loss decreased (-0.572208 --> -0.594431).  Saving model ...
Epoch: 9 cost time: 0.6554560661315918
Epoch: 9, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.298 Vali Acc: 0.617 Test Loss: 1.298 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616654).  Saving model ...
Epoch: 10 cost time: 0.6586654186248779
Epoch: 10, Steps: 12 | Train Loss: 0.833 Vali Loss: 1.231 Vali Acc: 0.644 Test Loss: 1.231 Test Acc: 0.644
Validation loss decreased (-0.616654 --> -0.644432).  Saving model ...
Epoch: 11 cost time: 0.6413352489471436
Epoch: 11, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.208 Vali Acc: 0.611 Test Loss: 1.208 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6515941619873047
Epoch: 12, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.186 Vali Acc: 0.667 Test Loss: 1.186 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.6194090843200684
Epoch: 13, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.184 Vali Acc: 0.667 Test Loss: 1.184 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 0.6153619289398193
Epoch: 14, Steps: 12 | Train Loss: 0.565 Vali Loss: 1.111 Vali Acc: 0.678 Test Loss: 1.111 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 15 cost time: 0.6716692447662354
Epoch: 15, Steps: 12 | Train Loss: 0.543 Vali Loss: 1.093 Vali Acc: 0.656 Test Loss: 1.093 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6181929111480713
Epoch: 16, Steps: 12 | Train Loss: 0.470 Vali Loss: 1.028 Vali Acc: 0.728 Test Loss: 1.028 Test Acc: 0.728
Validation loss decreased (-0.677767 --> -0.727767).  Saving model ...
Epoch: 17 cost time: 0.6267218589782715
Epoch: 17, Steps: 12 | Train Loss: 0.472 Vali Loss: 1.077 Vali Acc: 0.706 Test Loss: 1.077 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6459836959838867
Epoch: 18, Steps: 12 | Train Loss: 0.334 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
Validation loss decreased (-0.727767 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 0.6435098648071289
Epoch: 19, Steps: 12 | Train Loss: 0.305 Vali Loss: 1.009 Vali Acc: 0.739 Test Loss: 1.009 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.659508466720581
Epoch: 20, Steps: 12 | Train Loss: 0.285 Vali Loss: 1.034 Vali Acc: 0.722 Test Loss: 1.034 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5614683628082275
Epoch: 21, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.064 Vali Acc: 0.744 Test Loss: 1.064 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6683876514434814
Epoch: 22, Steps: 12 | Train Loss: 0.239 Vali Loss: 1.077 Vali Acc: 0.733 Test Loss: 1.077 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6880824565887451
Epoch: 23, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.102 Vali Acc: 0.728 Test Loss: 1.102 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6538879871368408
Epoch: 24, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.130 Vali Acc: 0.706 Test Loss: 1.130 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6883537769317627
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.111 Vali Acc: 0.728 Test Loss: 1.111 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6480953693389893
Epoch: 26, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.189 Vali Acc: 0.722 Test Loss: 1.189 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6070556640625
Epoch: 27, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.188 Vali Acc: 0.722 Test Loss: 1.188 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6384813785552979
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.196 Vali Acc: 0.728 Test Loss: 1.196 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 51887
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8662497997283936
Epoch: 1, Steps: 12 | Train Loss: 2.860 Vali Loss: 2.653 Vali Acc: 0.033 Test Loss: 2.653 Test Acc: 0.033
Validation loss decreased (inf --> -0.033307).  Saving model ...
Epoch: 2 cost time: 0.6614236831665039
Epoch: 2, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.471 Vali Acc: 0.161 Test Loss: 2.471 Test Acc: 0.161
Validation loss decreased (-0.033307 --> -0.161086).  Saving model ...
Epoch: 3 cost time: 0.6751270294189453
Epoch: 3, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.262 Vali Acc: 0.389 Test Loss: 2.262 Test Acc: 0.389
Validation loss decreased (-0.161086 --> -0.388866).  Saving model ...
Epoch: 4 cost time: 0.6968615055084229
Epoch: 4, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.058 Vali Acc: 0.472 Test Loss: 2.058 Test Acc: 0.472
Validation loss decreased (-0.388866 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 0.6130228042602539
Epoch: 5, Steps: 12 | Train Loss: 2.023 Vali Loss: 1.873 Vali Acc: 0.478 Test Loss: 1.873 Test Acc: 0.478
Validation loss decreased (-0.472202 --> -0.477759).  Saving model ...
Epoch: 6 cost time: 0.6563448905944824
Epoch: 6, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.733 Vali Acc: 0.500 Test Loss: 1.733 Test Acc: 0.500
Validation loss decreased (-0.477759 --> -0.499983).  Saving model ...
Epoch: 7 cost time: 0.6500580310821533
Epoch: 7, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.613 Vali Acc: 0.522 Test Loss: 1.613 Test Acc: 0.522
Validation loss decreased (-0.499983 --> -0.522206).  Saving model ...
Epoch: 8 cost time: 0.7092788219451904
Epoch: 8, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.523 Vali Acc: 0.539 Test Loss: 1.523 Test Acc: 0.539
Validation loss decreased (-0.522206 --> -0.538874).  Saving model ...
Epoch: 9 cost time: 0.6893057823181152
Epoch: 9, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.425 Vali Acc: 0.572 Test Loss: 1.425 Test Acc: 0.572
Validation loss decreased (-0.538874 --> -0.572208).  Saving model ...
Epoch: 10 cost time: 0.7050042152404785
Epoch: 10, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.373 Vali Acc: 0.572 Test Loss: 1.373 Test Acc: 0.572
Validation loss decreased (-0.572208 --> -0.572208).  Saving model ...
Epoch: 11 cost time: 0.7276380062103271
Epoch: 11, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.315 Vali Acc: 0.594 Test Loss: 1.315 Test Acc: 0.594
Validation loss decreased (-0.572208 --> -0.594431).  Saving model ...
Epoch: 12 cost time: 0.7392115592956543
Epoch: 12, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.260 Vali Acc: 0.617 Test Loss: 1.260 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 0.6768150329589844
Epoch: 13, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.215 Vali Acc: 0.639 Test Loss: 1.215 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 14 cost time: 0.6761233806610107
Epoch: 14, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.181 Vali Acc: 0.639 Test Loss: 1.181 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 15 cost time: 0.69754958152771
Epoch: 15, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.143 Vali Acc: 0.661 Test Loss: 1.143 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 16 cost time: 0.7032248973846436
Epoch: 16, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.135 Vali Acc: 0.656 Test Loss: 1.135 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7019641399383545
Epoch: 17, Steps: 12 | Train Loss: 0.604 Vali Loss: 1.099 Vali Acc: 0.661 Test Loss: 1.099 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661100).  Saving model ...
Epoch: 18 cost time: 0.7807610034942627
Epoch: 18, Steps: 12 | Train Loss: 0.581 Vali Loss: 1.085 Vali Acc: 0.689 Test Loss: 1.085 Test Acc: 0.689
Validation loss decreased (-0.661100 --> -0.688878).  Saving model ...
Epoch: 19 cost time: 0.7170116901397705
Epoch: 19, Steps: 12 | Train Loss: 0.498 Vali Loss: 1.042 Vali Acc: 0.711 Test Loss: 1.042 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711101).  Saving model ...
Epoch: 20 cost time: 0.720545768737793
Epoch: 20, Steps: 12 | Train Loss: 0.475 Vali Loss: 1.034 Vali Acc: 0.722 Test Loss: 1.034 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 21 cost time: 0.7416627407073975
Epoch: 21, Steps: 12 | Train Loss: 0.448 Vali Loss: 1.020 Vali Acc: 0.733 Test Loss: 1.020 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 22 cost time: 0.736976146697998
Epoch: 22, Steps: 12 | Train Loss: 0.403 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7248067855834961
Epoch: 23, Steps: 12 | Train Loss: 0.420 Vali Loss: 1.011 Vali Acc: 0.733 Test Loss: 1.011 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 24 cost time: 0.7054922580718994
Epoch: 24, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.962 Vali Acc: 0.744 Test Loss: 0.962 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 25 cost time: 0.6528210639953613
Epoch: 25, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.969 Vali Acc: 0.733 Test Loss: 0.969 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7292904853820801
Epoch: 26, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.985 Vali Acc: 0.739 Test Loss: 0.985 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7189924716949463
Epoch: 27, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.998 Vali Acc: 0.744 Test Loss: 0.998 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6751165390014648
Epoch: 28, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.998 Vali Acc: 0.744 Test Loss: 0.998 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7096948623657227
Epoch: 29, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.004 Vali Acc: 0.744 Test Loss: 1.004 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7635283470153809
Epoch: 30, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.996 Vali Acc: 0.750 Test Loss: 0.996 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 31 cost time: 0.6807451248168945
Epoch: 31, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.991 Vali Acc: 0.733 Test Loss: 0.991 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7426862716674805
Epoch: 32, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.023 Vali Acc: 0.739 Test Loss: 1.023 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6815638542175293
Epoch: 33, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.024 Vali Acc: 0.744 Test Loss: 1.024 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6838283538818359
Epoch: 34, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.010 Vali Acc: 0.728 Test Loss: 1.010 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6866836547851562
Epoch: 35, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.043 Vali Acc: 0.750 Test Loss: 1.043 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7446043491363525
Epoch: 36, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.069 Vali Acc: 0.744 Test Loss: 1.069 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6410045623779297
Epoch: 37, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.083 Vali Acc: 0.733 Test Loss: 1.083 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6986103057861328
Epoch: 38, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.082 Vali Acc: 0.750 Test Loss: 1.082 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.719475507736206
Epoch: 39, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.072 Vali Acc: 0.744 Test Loss: 1.072 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7202026844024658
Epoch: 40, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.108 Vali Acc: 0.744 Test Loss: 1.108 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 30799
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1643171310424805
Epoch: 1, Steps: 12 | Train Loss: 2.953 Vali Loss: 2.745 Vali Acc: 0.078 Test Loss: 2.745 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 0.6693625450134277
Epoch: 2, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.532 Vali Acc: 0.206 Test Loss: 2.532 Test Acc: 0.206
Validation loss decreased (-0.077750 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 0.6592717170715332
Epoch: 3, Steps: 12 | Train Loss: 2.471 Vali Loss: 2.281 Vali Acc: 0.294 Test Loss: 2.281 Test Acc: 0.294
Validation loss decreased (-0.205530 --> -0.294422).  Saving model ...
Epoch: 4 cost time: 0.6679279804229736
Epoch: 4, Steps: 12 | Train Loss: 2.198 Vali Loss: 2.051 Vali Acc: 0.361 Test Loss: 2.051 Test Acc: 0.361
Validation loss decreased (-0.294422 --> -0.361091).  Saving model ...
Epoch: 5 cost time: 0.6370062828063965
Epoch: 5, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.852 Vali Acc: 0.478 Test Loss: 1.852 Test Acc: 0.478
Validation loss decreased (-0.361091 --> -0.477759).  Saving model ...
Epoch: 6 cost time: 0.7145195007324219
Epoch: 6, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.714 Vali Acc: 0.511 Test Loss: 1.714 Test Acc: 0.511
Validation loss decreased (-0.477759 --> -0.511094).  Saving model ...
Epoch: 7 cost time: 0.6235034465789795
Epoch: 7, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.603 Vali Acc: 0.528 Test Loss: 1.603 Test Acc: 0.528
Validation loss decreased (-0.511094 --> -0.527762).  Saving model ...
Epoch: 8 cost time: 0.621229887008667
Epoch: 8, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.521 Vali Acc: 0.561 Test Loss: 1.521 Test Acc: 0.561
Validation loss decreased (-0.527762 --> -0.561096).  Saving model ...
Epoch: 9 cost time: 0.6659030914306641
Epoch: 9, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.452 Vali Acc: 0.572 Test Loss: 1.452 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 10 cost time: 0.6773698329925537
Epoch: 10, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.388 Vali Acc: 0.589 Test Loss: 1.388 Test Acc: 0.589
Validation loss decreased (-0.572208 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.6473538875579834
Epoch: 11, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.353 Vali Acc: 0.594 Test Loss: 1.353 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594431).  Saving model ...
Epoch: 12 cost time: 0.6363685131072998
Epoch: 12, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.301 Vali Acc: 0.639 Test Loss: 1.301 Test Acc: 0.639
Validation loss decreased (-0.594431 --> -0.638876).  Saving model ...
Epoch: 13 cost time: 0.6201848983764648
Epoch: 13, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.270 Vali Acc: 0.628 Test Loss: 1.270 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6527836322784424
Epoch: 14, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.260 Vali Acc: 0.594 Test Loss: 1.260 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6349945068359375
Epoch: 15, Steps: 12 | Train Loss: 0.757 Vali Loss: 1.231 Vali Acc: 0.650 Test Loss: 1.231 Test Acc: 0.650
Validation loss decreased (-0.638876 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 0.6296737194061279
Epoch: 16, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.192 Vali Acc: 0.661 Test Loss: 1.192 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661099).  Saving model ...
Epoch: 17 cost time: 0.7445888519287109
Epoch: 17, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.167 Vali Acc: 0.633 Test Loss: 1.167 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6142218112945557
Epoch: 18, Steps: 12 | Train Loss: 0.643 Vali Loss: 1.139 Vali Acc: 0.667 Test Loss: 1.139 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 19 cost time: 0.6107616424560547
Epoch: 19, Steps: 12 | Train Loss: 0.568 Vali Loss: 1.136 Vali Acc: 0.622 Test Loss: 1.136 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7161478996276855
Epoch: 20, Steps: 12 | Train Loss: 0.502 Vali Loss: 1.095 Vali Acc: 0.678 Test Loss: 1.095 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 21 cost time: 0.5860071182250977
Epoch: 21, Steps: 12 | Train Loss: 0.505 Vali Loss: 1.068 Vali Acc: 0.689 Test Loss: 1.068 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688878).  Saving model ...
Epoch: 22 cost time: 0.6138725280761719
Epoch: 22, Steps: 12 | Train Loss: 0.432 Vali Loss: 1.034 Vali Acc: 0.722 Test Loss: 1.034 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722212).  Saving model ...
Epoch: 23 cost time: 0.6320047378540039
Epoch: 23, Steps: 12 | Train Loss: 0.372 Vali Loss: 1.031 Vali Acc: 0.717 Test Loss: 1.031 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6595470905303955
Epoch: 24, Steps: 12 | Train Loss: 0.386 Vali Loss: 1.028 Vali Acc: 0.711 Test Loss: 1.028 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6868889331817627
Epoch: 25, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.974 Vali Acc: 0.744 Test Loss: 0.974 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 26 cost time: 0.6476058959960938
Epoch: 26, Steps: 12 | Train Loss: 0.304 Vali Loss: 1.006 Vali Acc: 0.744 Test Loss: 1.006 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7483153343200684
Epoch: 27, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.994 Vali Acc: 0.728 Test Loss: 0.994 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.718935489654541
Epoch: 28, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.998 Vali Acc: 0.728 Test Loss: 0.998 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5811951160430908
Epoch: 29, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.961 Vali Acc: 0.739 Test Loss: 0.961 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6198840141296387
Epoch: 30, Steps: 12 | Train Loss: 0.231 Vali Loss: 1.005 Vali Acc: 0.739 Test Loss: 1.005 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6184635162353516
Epoch: 31, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.015 Vali Acc: 0.733 Test Loss: 1.015 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.627976655960083
Epoch: 32, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.018 Vali Acc: 0.744 Test Loss: 1.018 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6382327079772949
Epoch: 33, Steps: 12 | Train Loss: 0.186 Vali Loss: 1.026 Vali Acc: 0.728 Test Loss: 1.026 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6239240169525146
Epoch: 34, Steps: 12 | Train Loss: 0.138 Vali Loss: 1.052 Vali Acc: 0.739 Test Loss: 1.052 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6147408485412598
Epoch: 35, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.063 Vali Acc: 0.728 Test Loss: 1.063 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 29871
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.7549214363098145
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.808 Vali Acc: 0.100 Test Loss: 2.808 Test Acc: 0.100
Validation loss decreased (inf --> -0.099972).  Saving model ...
Epoch: 2 cost time: 0.6172740459442139
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.638 Vali Acc: 0.122 Test Loss: 2.638 Test Acc: 0.122
Validation loss decreased (-0.099972 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 0.6115500926971436
Epoch: 3, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.438 Vali Acc: 0.189 Test Loss: 2.438 Test Acc: 0.189
Validation loss decreased (-0.122196 --> -0.188865).  Saving model ...
Epoch: 4 cost time: 0.5948677062988281
Epoch: 4, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.233 Vali Acc: 0.294 Test Loss: 2.233 Test Acc: 0.294
Validation loss decreased (-0.188865 --> -0.294422).  Saving model ...
Epoch: 5 cost time: 0.6468133926391602
Epoch: 5, Steps: 12 | Train Loss: 2.172 Vali Loss: 2.056 Vali Acc: 0.394 Test Loss: 2.056 Test Acc: 0.394
Validation loss decreased (-0.294422 --> -0.394424).  Saving model ...
Epoch: 6 cost time: 0.7095496654510498
Epoch: 6, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.908 Vali Acc: 0.456 Test Loss: 1.908 Test Acc: 0.456
Validation loss decreased (-0.394424 --> -0.455536).  Saving model ...
Epoch: 7 cost time: 0.6107401847839355
Epoch: 7, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.773 Vali Acc: 0.506 Test Loss: 1.773 Test Acc: 0.506
Validation loss decreased (-0.455536 --> -0.505538).  Saving model ...
Epoch: 8 cost time: 0.5927531719207764
Epoch: 8, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.668 Vali Acc: 0.556 Test Loss: 1.668 Test Acc: 0.556
Validation loss decreased (-0.505538 --> -0.555539).  Saving model ...
Epoch: 9 cost time: 0.5965909957885742
Epoch: 9, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.560 Vali Acc: 0.578 Test Loss: 1.560 Test Acc: 0.578
Validation loss decreased (-0.555539 --> -0.577762).  Saving model ...
Epoch: 10 cost time: 0.6082267761230469
Epoch: 10, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.489 Vali Acc: 0.572 Test Loss: 1.489 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6471192836761475
Epoch: 11, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.445 Vali Acc: 0.589 Test Loss: 1.445 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588874).  Saving model ...
Epoch: 12 cost time: 0.6443977355957031
Epoch: 12, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.385 Vali Acc: 0.600 Test Loss: 1.385 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 0.6018743515014648
Epoch: 13, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.342 Vali Acc: 0.611 Test Loss: 1.342 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 14 cost time: 0.6217811107635498
Epoch: 14, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.288 Vali Acc: 0.644 Test Loss: 1.288 Test Acc: 0.644
Validation loss decreased (-0.611098 --> -0.644432).  Saving model ...
Epoch: 15 cost time: 0.6212270259857178
Epoch: 15, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.257 Vali Acc: 0.644 Test Loss: 1.257 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 16 cost time: 0.619295597076416
Epoch: 16, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.243 Vali Acc: 0.656 Test Loss: 1.243 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655543).  Saving model ...
Epoch: 17 cost time: 0.6262564659118652
Epoch: 17, Steps: 12 | Train Loss: 0.768 Vali Loss: 1.212 Vali Acc: 0.644 Test Loss: 1.212 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.611752986907959
Epoch: 18, Steps: 12 | Train Loss: 0.757 Vali Loss: 1.173 Vali Acc: 0.672 Test Loss: 1.173 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672210).  Saving model ...
Epoch: 19 cost time: 0.611504316329956
Epoch: 19, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.154 Vali Acc: 0.672 Test Loss: 1.154 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 20 cost time: 0.6354858875274658
Epoch: 20, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6743803024291992
Epoch: 21, Steps: 12 | Train Loss: 0.590 Vali Loss: 1.083 Vali Acc: 0.672 Test Loss: 1.083 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 22 cost time: 0.5726621150970459
Epoch: 22, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.075 Vali Acc: 0.678 Test Loss: 1.075 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 23 cost time: 0.5871133804321289
Epoch: 23, Steps: 12 | Train Loss: 0.566 Vali Loss: 1.050 Vali Acc: 0.683 Test Loss: 1.050 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 24 cost time: 0.6550219058990479
Epoch: 24, Steps: 12 | Train Loss: 0.489 Vali Loss: 1.027 Vali Acc: 0.689 Test Loss: 1.027 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 25 cost time: 0.5617349147796631
Epoch: 25, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 26 cost time: 0.5606019496917725
Epoch: 26, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.994 Vali Acc: 0.728 Test Loss: 0.994 Test Acc: 0.728
Validation loss decreased (-0.699990 --> -0.727768).  Saving model ...
Epoch: 27 cost time: 0.5304656028747559
Epoch: 27, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.980 Vali Acc: 0.722 Test Loss: 0.980 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6568796634674072
Epoch: 28, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.975 Vali Acc: 0.728 Test Loss: 0.975 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 29 cost time: 0.5771987438201904
Epoch: 29, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.984 Vali Acc: 0.733 Test Loss: 0.984 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733323).  Saving model ...
Epoch: 30 cost time: 0.5229744911193848
Epoch: 30, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5768938064575195
Epoch: 31, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.968 Vali Acc: 0.728 Test Loss: 0.968 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5535407066345215
Epoch: 32, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.970 Vali Acc: 0.739 Test Loss: 0.970 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 33 cost time: 0.57267165184021
Epoch: 33, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.979 Vali Acc: 0.750 Test Loss: 0.979 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749990).  Saving model ...
Epoch: 34 cost time: 0.5848507881164551
Epoch: 34, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.981 Vali Acc: 0.744 Test Loss: 0.981 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5853159427642822
Epoch: 35, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.003 Vali Acc: 0.739 Test Loss: 1.003 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5674886703491211
Epoch: 36, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.003 Vali Acc: 0.717 Test Loss: 1.003 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5616204738616943
Epoch: 37, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.998 Vali Acc: 0.744 Test Loss: 0.998 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5932273864746094
Epoch: 38, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.006 Vali Acc: 0.744 Test Loss: 1.006 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6288704872131348
Epoch: 39, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.016 Vali Acc: 0.739 Test Loss: 1.016 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5578391551971436
Epoch: 40, Steps: 12 | Train Loss: 0.173 Vali Loss: 1.024 Vali Acc: 0.739 Test Loss: 1.024 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5725867748260498
Epoch: 41, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5921974182128906
Epoch: 42, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.030 Vali Acc: 0.728 Test Loss: 1.030 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5552463531494141
Epoch: 43, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.030 Vali Acc: 0.733 Test Loss: 1.030 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 23183
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9327030181884766
Epoch: 1, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.700 Vali Acc: 0.094 Test Loss: 2.700 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.6169278621673584
Epoch: 2, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.584 Vali Acc: 0.172 Test Loss: 2.584 Test Acc: 0.172
Validation loss decreased (-0.094417 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 0.6264176368713379
Epoch: 3, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.435 Vali Acc: 0.261 Test Loss: 2.435 Test Acc: 0.261
Validation loss decreased (-0.172196 --> -0.261087).  Saving model ...
Epoch: 4 cost time: 0.5645184516906738
Epoch: 4, Steps: 12 | Train Loss: 2.350 Vali Loss: 2.285 Vali Acc: 0.344 Test Loss: 2.285 Test Acc: 0.344
Validation loss decreased (-0.261087 --> -0.344422).  Saving model ...
Epoch: 5 cost time: 0.5910561084747314
Epoch: 5, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.136 Vali Acc: 0.417 Test Loss: 2.136 Test Acc: 0.417
Validation loss decreased (-0.344422 --> -0.416645).  Saving model ...
Epoch: 6 cost time: 0.5943136215209961
Epoch: 6, Steps: 12 | Train Loss: 2.081 Vali Loss: 2.002 Vali Acc: 0.450 Test Loss: 2.002 Test Acc: 0.450
Validation loss decreased (-0.416645 --> -0.449980).  Saving model ...
Epoch: 7 cost time: 0.5916645526885986
Epoch: 7, Steps: 12 | Train Loss: 1.907 Vali Loss: 1.880 Vali Acc: 0.494 Test Loss: 1.880 Test Acc: 0.494
Validation loss decreased (-0.449980 --> -0.494426).  Saving model ...
Epoch: 8 cost time: 0.563471794128418
Epoch: 8, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.782 Vali Acc: 0.522 Test Loss: 1.782 Test Acc: 0.522
Validation loss decreased (-0.494426 --> -0.522204).  Saving model ...
Epoch: 9 cost time: 0.6159193515777588
Epoch: 9, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.690 Vali Acc: 0.550 Test Loss: 1.690 Test Acc: 0.550
Validation loss decreased (-0.522204 --> -0.549983).  Saving model ...
Epoch: 10 cost time: 0.5976316928863525
Epoch: 10, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.624 Vali Acc: 0.589 Test Loss: 1.624 Test Acc: 0.589
Validation loss decreased (-0.549983 --> -0.588873).  Saving model ...
Epoch: 11 cost time: 0.5722191333770752
Epoch: 11, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.557 Vali Acc: 0.578 Test Loss: 1.557 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5434403419494629
Epoch: 12, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.504 Vali Acc: 0.589 Test Loss: 1.504 Test Acc: 0.589
Validation loss decreased (-0.588873 --> -0.588874).  Saving model ...
Epoch: 13 cost time: 0.5483663082122803
Epoch: 13, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.460 Vali Acc: 0.600 Test Loss: 1.460 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599985).  Saving model ...
Epoch: 14 cost time: 0.6282272338867188
Epoch: 14, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.405 Vali Acc: 0.611 Test Loss: 1.405 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 0.6287248134613037
Epoch: 15, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.369 Vali Acc: 0.622 Test Loss: 1.369 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 16 cost time: 0.634967565536499
Epoch: 16, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.325 Vali Acc: 0.606 Test Loss: 1.325 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6111762523651123
Epoch: 17, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.289 Vali Acc: 0.633 Test Loss: 1.289 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 18 cost time: 0.6351971626281738
Epoch: 18, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.277 Vali Acc: 0.628 Test Loss: 1.277 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6180014610290527
Epoch: 19, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.238 Vali Acc: 0.633 Test Loss: 1.238 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 20 cost time: 0.582221269607544
Epoch: 20, Steps: 12 | Train Loss: 0.752 Vali Loss: 1.218 Vali Acc: 0.650 Test Loss: 1.218 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649988).  Saving model ...
Epoch: 21 cost time: 0.4985542297363281
Epoch: 21, Steps: 12 | Train Loss: 0.773 Vali Loss: 1.171 Vali Acc: 0.650 Test Loss: 1.171 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 22 cost time: 0.6470019817352295
Epoch: 22, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.147 Vali Acc: 0.678 Test Loss: 1.147 Test Acc: 0.678
Validation loss decreased (-0.649988 --> -0.677766).  Saving model ...
Epoch: 23 cost time: 0.6272561550140381
Epoch: 23, Steps: 12 | Train Loss: 0.703 Vali Loss: 1.120 Vali Acc: 0.656 Test Loss: 1.120 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6948277950286865
Epoch: 24, Steps: 12 | Train Loss: 0.609 Vali Loss: 1.099 Vali Acc: 0.689 Test Loss: 1.099 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 25 cost time: 0.6672561168670654
Epoch: 25, Steps: 12 | Train Loss: 0.622 Vali Loss: 1.086 Vali Acc: 0.683 Test Loss: 1.086 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.754263162612915
Epoch: 26, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.070 Vali Acc: 0.689 Test Loss: 1.070 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 27 cost time: 0.6045033931732178
Epoch: 27, Steps: 12 | Train Loss: 0.514 Vali Loss: 1.042 Vali Acc: 0.678 Test Loss: 1.042 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6038942337036133
Epoch: 28, Steps: 12 | Train Loss: 0.502 Vali Loss: 1.020 Vali Acc: 0.694 Test Loss: 1.020 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 29 cost time: 0.7092418670654297
Epoch: 29, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.995 Vali Acc: 0.694 Test Loss: 0.995 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 30 cost time: 0.5669341087341309
Epoch: 30, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 31 cost time: 0.6101415157318115
Epoch: 31, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 32 cost time: 0.6384952068328857
Epoch: 32, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.956 Vali Acc: 0.722 Test Loss: 0.956 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 33 cost time: 0.6208550930023193
Epoch: 33, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.930 Vali Acc: 0.722 Test Loss: 0.930 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 34 cost time: 0.6026480197906494
Epoch: 34, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.921 Vali Acc: 0.744 Test Loss: 0.921 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744435).  Saving model ...
Epoch: 35 cost time: 0.6025254726409912
Epoch: 35, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.911 Vali Acc: 0.767 Test Loss: 0.911 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 36 cost time: 0.6144278049468994
Epoch: 36, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.906 Vali Acc: 0.739 Test Loss: 0.906 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5920689105987549
Epoch: 37, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.893 Vali Acc: 0.744 Test Loss: 0.893 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5996568202972412
Epoch: 38, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5962285995483398
Epoch: 39, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6112008094787598
Epoch: 40, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.890 Vali Acc: 0.761 Test Loss: 0.890 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6008181571960449
Epoch: 41, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.892 Vali Acc: 0.739 Test Loss: 0.892 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6649138927459717
Epoch: 42, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.883 Vali Acc: 0.733 Test Loss: 0.883 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6120345592498779
Epoch: 43, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.872 Vali Acc: 0.739 Test Loss: 0.872 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6663131713867188
Epoch: 44, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.892 Vali Acc: 0.733 Test Loss: 0.892 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6255385875701904
Epoch: 45, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.883 Vali Acc: 0.739 Test Loss: 0.883 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 19407
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0122554302215576
Epoch: 1, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.723 Vali Acc: 0.078 Test Loss: 2.723 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.5697000026702881
Epoch: 2, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.627 Vali Acc: 0.111 Test Loss: 2.627 Test Acc: 0.111
Validation loss decreased (-0.077751 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 0.5793085098266602
Epoch: 3, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.492 Vali Acc: 0.206 Test Loss: 2.492 Test Acc: 0.206
Validation loss decreased (-0.111085 --> -0.205531).  Saving model ...
Epoch: 4 cost time: 0.6152138710021973
Epoch: 4, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.341 Vali Acc: 0.244 Test Loss: 2.341 Test Acc: 0.244
Validation loss decreased (-0.205531 --> -0.244421).  Saving model ...
Epoch: 5 cost time: 0.6126971244812012
Epoch: 5, Steps: 12 | Train Loss: 2.249 Vali Loss: 2.193 Vali Acc: 0.272 Test Loss: 2.193 Test Acc: 0.272
Validation loss decreased (-0.244421 --> -0.272200).  Saving model ...
Epoch: 6 cost time: 0.5726830959320068
Epoch: 6, Steps: 12 | Train Loss: 2.075 Vali Loss: 2.056 Vali Acc: 0.344 Test Loss: 2.056 Test Acc: 0.344
Validation loss decreased (-0.272200 --> -0.344424).  Saving model ...
Epoch: 7 cost time: 0.6197123527526855
Epoch: 7, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.930 Vali Acc: 0.389 Test Loss: 1.930 Test Acc: 0.389
Validation loss decreased (-0.344424 --> -0.388870).  Saving model ...
Epoch: 8 cost time: 0.6122391223907471
Epoch: 8, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.831 Vali Acc: 0.422 Test Loss: 1.831 Test Acc: 0.422
Validation loss decreased (-0.388870 --> -0.422204).  Saving model ...
Epoch: 9 cost time: 0.6508524417877197
Epoch: 9, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.739 Vali Acc: 0.506 Test Loss: 1.739 Test Acc: 0.506
Validation loss decreased (-0.422204 --> -0.505538).  Saving model ...
Epoch: 10 cost time: 0.633143424987793
Epoch: 10, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.663 Vali Acc: 0.528 Test Loss: 1.663 Test Acc: 0.528
Validation loss decreased (-0.505538 --> -0.527761).  Saving model ...
Epoch: 11 cost time: 0.6095714569091797
Epoch: 11, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.594 Vali Acc: 0.556 Test Loss: 1.594 Test Acc: 0.556
Validation loss decreased (-0.527761 --> -0.555540).  Saving model ...
Epoch: 12 cost time: 0.621192216873169
Epoch: 12, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.550 Vali Acc: 0.561 Test Loss: 1.550 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561096).  Saving model ...
Epoch: 13 cost time: 0.5682129859924316
Epoch: 13, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.496 Vali Acc: 0.567 Test Loss: 1.496 Test Acc: 0.567
Validation loss decreased (-0.561096 --> -0.566652).  Saving model ...
Epoch: 14 cost time: 0.5627658367156982
Epoch: 14, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.450 Vali Acc: 0.583 Test Loss: 1.450 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583319).  Saving model ...
Epoch: 15 cost time: 0.6082978248596191
Epoch: 15, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.415 Vali Acc: 0.600 Test Loss: 1.415 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 0.5684707164764404
Epoch: 16, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.389 Vali Acc: 0.594 Test Loss: 1.389 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5675797462463379
Epoch: 17, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.358 Vali Acc: 0.606 Test Loss: 1.358 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 18 cost time: 0.5691323280334473
Epoch: 18, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.328 Vali Acc: 0.622 Test Loss: 1.328 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 19 cost time: 0.5881199836730957
Epoch: 19, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.304 Vali Acc: 0.633 Test Loss: 1.304 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 0.6311581134796143
Epoch: 20, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.270 Vali Acc: 0.628 Test Loss: 1.270 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6633625030517578
Epoch: 21, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.252 Vali Acc: 0.617 Test Loss: 1.252 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6250746250152588
Epoch: 22, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.229 Vali Acc: 0.633 Test Loss: 1.229 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 23 cost time: 0.5987579822540283
Epoch: 23, Steps: 12 | Train Loss: 0.753 Vali Loss: 1.183 Vali Acc: 0.650 Test Loss: 1.183 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649988).  Saving model ...
Epoch: 24 cost time: 0.6017849445343018
Epoch: 24, Steps: 12 | Train Loss: 0.727 Vali Loss: 1.160 Vali Acc: 0.656 Test Loss: 1.160 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 25 cost time: 0.6302058696746826
Epoch: 25, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.120 Vali Acc: 0.661 Test Loss: 1.120 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 26 cost time: 0.5751068592071533
Epoch: 26, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.090 Vali Acc: 0.650 Test Loss: 1.090 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7303392887115479
Epoch: 27, Steps: 12 | Train Loss: 0.601 Vali Loss: 1.068 Vali Acc: 0.667 Test Loss: 1.068 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 28 cost time: 0.5623226165771484
Epoch: 28, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.038 Vali Acc: 0.678 Test Loss: 1.038 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 29 cost time: 0.5778584480285645
Epoch: 29, Steps: 12 | Train Loss: 0.536 Vali Loss: 1.017 Vali Acc: 0.678 Test Loss: 1.017 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677768).  Saving model ...
Epoch: 30 cost time: 0.6128191947937012
Epoch: 30, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.001 Vali Acc: 0.667 Test Loss: 1.001 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5866532325744629
Epoch: 31, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.5578219890594482
Epoch: 32, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.967 Vali Acc: 0.717 Test Loss: 0.967 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 33 cost time: 0.6415867805480957
Epoch: 33, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.945 Vali Acc: 0.717 Test Loss: 0.945 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 34 cost time: 0.5845234394073486
Epoch: 34, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.924 Vali Acc: 0.694 Test Loss: 0.924 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5848100185394287
Epoch: 35, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.905 Vali Acc: 0.700 Test Loss: 0.905 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6262080669403076
Epoch: 36, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.894 Vali Acc: 0.700 Test Loss: 0.894 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6311297416687012
Epoch: 37, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.902 Vali Acc: 0.700 Test Loss: 0.902 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5973541736602783
Epoch: 38, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 39 cost time: 0.6047122478485107
Epoch: 39, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.863 Vali Acc: 0.744 Test Loss: 0.863 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 40 cost time: 0.5887589454650879
Epoch: 40, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.874 Vali Acc: 0.744 Test Loss: 0.874 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.625781774520874
Epoch: 41, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.871 Vali Acc: 0.711 Test Loss: 0.871 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5916585922241211
Epoch: 42, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.849 Vali Acc: 0.728 Test Loss: 0.849 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6597719192504883
Epoch: 43, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 44 cost time: 0.6412928104400635
Epoch: 44, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.857 Vali Acc: 0.739 Test Loss: 0.857 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6570165157318115
Epoch: 45, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.851 Vali Acc: 0.739 Test Loss: 0.851 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6695733070373535
Epoch: 46, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.852 Vali Acc: 0.733 Test Loss: 0.852 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5904366970062256
Epoch: 47, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6024374961853027
Epoch: 48, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.838 Vali Acc: 0.739 Test Loss: 0.838 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5594854354858398
Epoch: 49, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.827 Vali Acc: 0.744 Test Loss: 0.827 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6348638534545898
Epoch: 50, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.825 Vali Acc: 0.733 Test Loss: 0.825 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5805339813232422
Epoch: 51, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 0.5823688507080078
Epoch: 52, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.851 Vali Acc: 0.761 Test Loss: 0.851 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 53 cost time: 0.7256600856781006
Epoch: 53, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.851 Vali Acc: 0.744 Test Loss: 0.851 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5901710987091064
Epoch: 54, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.842 Vali Acc: 0.739 Test Loss: 0.842 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5947449207305908
Epoch: 55, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6429686546325684
Epoch: 56, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6106698513031006
Epoch: 57, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6967711448669434
Epoch: 58, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6011011600494385
Epoch: 59, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.852 Vali Acc: 0.733 Test Loss: 0.852 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.649465799331665
Epoch: 60, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.851 Vali Acc: 0.739 Test Loss: 0.851 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.598482608795166
Epoch: 61, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.838 Vali Acc: 0.756 Test Loss: 0.838 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.6203291416168213
Epoch: 62, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 17551
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0317938327789307
Epoch: 1, Steps: 12 | Train Loss: 2.865 Vali Loss: 2.683 Vali Acc: 0.106 Test Loss: 2.683 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.6399641036987305
Epoch: 2, Steps: 12 | Train Loss: 2.832 Vali Loss: 2.600 Vali Acc: 0.167 Test Loss: 2.600 Test Acc: 0.167
Validation loss decreased (-0.105529 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 0.6916618347167969
Epoch: 3, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.496 Vali Acc: 0.244 Test Loss: 2.496 Test Acc: 0.244
Validation loss decreased (-0.166641 --> -0.244419).  Saving model ...
Epoch: 4 cost time: 0.6098363399505615
Epoch: 4, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.387 Vali Acc: 0.256 Test Loss: 2.387 Test Acc: 0.256
Validation loss decreased (-0.244419 --> -0.255532).  Saving model ...
Epoch: 5 cost time: 0.6230401992797852
Epoch: 5, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.270 Vali Acc: 0.311 Test Loss: 2.270 Test Acc: 0.311
Validation loss decreased (-0.255532 --> -0.311088).  Saving model ...
Epoch: 6 cost time: 0.5551807880401611
Epoch: 6, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.157 Vali Acc: 0.356 Test Loss: 2.157 Test Acc: 0.356
Validation loss decreased (-0.311088 --> -0.355534).  Saving model ...
Epoch: 7 cost time: 0.636857271194458
Epoch: 7, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.048 Vali Acc: 0.433 Test Loss: 2.048 Test Acc: 0.433
Validation loss decreased (-0.355534 --> -0.433313).  Saving model ...
Epoch: 8 cost time: 0.6302447319030762
Epoch: 8, Steps: 12 | Train Loss: 2.072 Vali Loss: 1.953 Vali Acc: 0.433 Test Loss: 1.953 Test Acc: 0.433
Validation loss decreased (-0.433313 --> -0.433314).  Saving model ...
Epoch: 9 cost time: 0.6679725646972656
Epoch: 9, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.858 Vali Acc: 0.467 Test Loss: 1.858 Test Acc: 0.467
Validation loss decreased (-0.433314 --> -0.466648).  Saving model ...
Epoch: 10 cost time: 0.6140143871307373
Epoch: 10, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.778 Vali Acc: 0.489 Test Loss: 1.778 Test Acc: 0.489
Validation loss decreased (-0.466648 --> -0.488871).  Saving model ...
Epoch: 11 cost time: 0.6179895401000977
Epoch: 11, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.700 Vali Acc: 0.533 Test Loss: 1.700 Test Acc: 0.533
Validation loss decreased (-0.488871 --> -0.533316).  Saving model ...
Epoch: 12 cost time: 0.6064684391021729
Epoch: 12, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.636 Vali Acc: 0.544 Test Loss: 1.636 Test Acc: 0.544
Validation loss decreased (-0.533316 --> -0.544428).  Saving model ...
Epoch: 13 cost time: 0.4865756034851074
Epoch: 13, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.583 Vali Acc: 0.544 Test Loss: 1.583 Test Acc: 0.544
Validation loss decreased (-0.544428 --> -0.544429).  Saving model ...
Epoch: 14 cost time: 0.5519928932189941
Epoch: 14, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.522 Vali Acc: 0.550 Test Loss: 1.522 Test Acc: 0.550
Validation loss decreased (-0.544429 --> -0.549985).  Saving model ...
Epoch: 15 cost time: 0.6457538604736328
Epoch: 15, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.473 Vali Acc: 0.561 Test Loss: 1.473 Test Acc: 0.561
Validation loss decreased (-0.549985 --> -0.561096).  Saving model ...
Epoch: 16 cost time: 0.6821625232696533
Epoch: 16, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.433 Vali Acc: 0.567 Test Loss: 1.433 Test Acc: 0.567
Validation loss decreased (-0.561096 --> -0.566652).  Saving model ...
Epoch: 17 cost time: 0.7119455337524414
Epoch: 17, Steps: 12 | Train Loss: 1.174 Vali Loss: 1.381 Vali Acc: 0.594 Test Loss: 1.381 Test Acc: 0.594
Validation loss decreased (-0.566652 --> -0.594431).  Saving model ...
Epoch: 18 cost time: 0.6846804618835449
Epoch: 18, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.335 Vali Acc: 0.600 Test Loss: 1.335 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599987).  Saving model ...
Epoch: 19 cost time: 0.6254618167877197
Epoch: 19, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.287 Vali Acc: 0.589 Test Loss: 1.287 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6306326389312744
Epoch: 20, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.248 Vali Acc: 0.589 Test Loss: 1.248 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5689029693603516
Epoch: 21, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.208 Vali Acc: 0.589 Test Loss: 1.208 Test Acc: 0.589
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6275384426116943
Epoch: 22, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 23 cost time: 0.5994131565093994
Epoch: 23, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.114 Vali Acc: 0.606 Test Loss: 1.114 Test Acc: 0.606
Validation loss decreased (-0.599988 --> -0.605544).  Saving model ...
Epoch: 24 cost time: 0.6010980606079102
Epoch: 24, Steps: 12 | Train Loss: 0.768 Vali Loss: 1.083 Vali Acc: 0.633 Test Loss: 1.083 Test Acc: 0.633
Validation loss decreased (-0.605544 --> -0.633323).  Saving model ...
Epoch: 25 cost time: 0.5568337440490723
Epoch: 25, Steps: 12 | Train Loss: 0.721 Vali Loss: 1.049 Vali Acc: 0.633 Test Loss: 1.049 Test Acc: 0.633
Validation loss decreased (-0.633323 --> -0.633323).  Saving model ...
Epoch: 26 cost time: 0.586317777633667
Epoch: 26, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.022 Vali Acc: 0.639 Test Loss: 1.022 Test Acc: 0.639
Validation loss decreased (-0.633323 --> -0.638879).  Saving model ...
Epoch: 27 cost time: 0.6110868453979492
Epoch: 27, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.998 Vali Acc: 0.656 Test Loss: 0.998 Test Acc: 0.656
Validation loss decreased (-0.638879 --> -0.655546).  Saving model ...
Epoch: 28 cost time: 0.678236722946167
Epoch: 28, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.978 Vali Acc: 0.656 Test Loss: 0.978 Test Acc: 0.656
Validation loss decreased (-0.655546 --> -0.655546).  Saving model ...
Epoch: 29 cost time: 0.6543457508087158
Epoch: 29, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.971 Vali Acc: 0.661 Test Loss: 0.971 Test Acc: 0.661
Validation loss decreased (-0.655546 --> -0.661101).  Saving model ...
Epoch: 30 cost time: 0.6071691513061523
Epoch: 30, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.949 Vali Acc: 0.667 Test Loss: 0.949 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666657).  Saving model ...
Epoch: 31 cost time: 0.6568970680236816
Epoch: 31, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.942 Vali Acc: 0.678 Test Loss: 0.942 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677768).  Saving model ...
Epoch: 32 cost time: 0.6772713661193848
Epoch: 32, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.920 Vali Acc: 0.683 Test Loss: 0.920 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 33 cost time: 0.6089873313903809
Epoch: 33, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.919 Vali Acc: 0.672 Test Loss: 0.919 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5999741554260254
Epoch: 34, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.911 Vali Acc: 0.694 Test Loss: 0.911 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694435).  Saving model ...
Epoch: 35 cost time: 0.5732526779174805
Epoch: 35, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.902 Vali Acc: 0.672 Test Loss: 0.902 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.614537239074707
Epoch: 36, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.898 Vali Acc: 0.700 Test Loss: 0.898 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 37 cost time: 0.6047630310058594
Epoch: 37, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.877 Vali Acc: 0.728 Test Loss: 0.877 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 38 cost time: 0.608269453048706
Epoch: 38, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.875 Vali Acc: 0.733 Test Loss: 0.875 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 39 cost time: 0.5925924777984619
Epoch: 39, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.872 Vali Acc: 0.739 Test Loss: 0.872 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738880).  Saving model ...
Epoch: 40 cost time: 0.673936128616333
Epoch: 40, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.872 Vali Acc: 0.711 Test Loss: 0.872 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6727705001831055
Epoch: 41, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6244289875030518
Epoch: 42, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.874 Vali Acc: 0.728 Test Loss: 0.874 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6179983615875244
Epoch: 43, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6053438186645508
Epoch: 44, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6248767375946045
Epoch: 45, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.569812536239624
Epoch: 46, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.856 Vali Acc: 0.728 Test Loss: 0.856 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6000001430511475
Epoch: 47, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.854 Vali Acc: 0.733 Test Loss: 0.854 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6221897602081299
Epoch: 48, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.856 Vali Acc: 0.733 Test Loss: 0.856 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.56642746925354
Epoch: 49, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.861 Vali Acc: 0.728 Test Loss: 0.861 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm32_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 15727
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0721864700317383
Epoch: 1, Steps: 12 | Train Loss: 2.849 Vali Loss: 2.789 Vali Acc: 0.067 Test Loss: 2.789 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.5899693965911865
Epoch: 2, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.592 Vali Acc: 0.189 Test Loss: 2.592 Test Acc: 0.189
Validation loss decreased (-0.066639 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 0.6965343952178955
Epoch: 3, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.357 Vali Acc: 0.328 Test Loss: 2.357 Test Acc: 0.328
Validation loss decreased (-0.188863 --> -0.327754).  Saving model ...
Epoch: 4 cost time: 0.6258859634399414
Epoch: 4, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.146 Vali Acc: 0.378 Test Loss: 2.146 Test Acc: 0.378
Validation loss decreased (-0.327754 --> -0.377756).  Saving model ...
Epoch: 5 cost time: 0.7082712650299072
Epoch: 5, Steps: 12 | Train Loss: 2.059 Vali Loss: 1.945 Vali Acc: 0.411 Test Loss: 1.945 Test Acc: 0.411
Validation loss decreased (-0.377756 --> -0.411092).  Saving model ...
Epoch: 6 cost time: 0.623297929763794
Epoch: 6, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.777 Vali Acc: 0.506 Test Loss: 1.777 Test Acc: 0.506
Validation loss decreased (-0.411092 --> -0.505538).  Saving model ...
Epoch: 7 cost time: 0.6303026676177979
Epoch: 7, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.647 Vali Acc: 0.506 Test Loss: 1.647 Test Acc: 0.506
Validation loss decreased (-0.505538 --> -0.505539).  Saving model ...
Epoch: 8 cost time: 0.6976320743560791
Epoch: 8, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.523 Vali Acc: 0.550 Test Loss: 1.523 Test Acc: 0.550
Validation loss decreased (-0.505539 --> -0.549985).  Saving model ...
Epoch: 9 cost time: 0.7303688526153564
Epoch: 9, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.442 Vali Acc: 0.583 Test Loss: 1.442 Test Acc: 0.583
Validation loss decreased (-0.549985 --> -0.583319).  Saving model ...
Epoch: 10 cost time: 0.6956634521484375
Epoch: 10, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.378 Vali Acc: 0.589 Test Loss: 1.378 Test Acc: 0.589
Validation loss decreased (-0.583319 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.6309983730316162
Epoch: 11, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.307 Vali Acc: 0.606 Test Loss: 1.307 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 0.6565766334533691
Epoch: 12, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.265 Vali Acc: 0.583 Test Loss: 1.265 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6512746810913086
Epoch: 13, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.235 Vali Acc: 0.611 Test Loss: 1.235 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611099).  Saving model ...
Epoch: 14 cost time: 0.5955085754394531
Epoch: 14, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.198 Vali Acc: 0.678 Test Loss: 1.198 Test Acc: 0.678
Validation loss decreased (-0.611099 --> -0.677766).  Saving model ...
Epoch: 15 cost time: 0.6135377883911133
Epoch: 15, Steps: 12 | Train Loss: 0.750 Vali Loss: 1.165 Vali Acc: 0.633 Test Loss: 1.165 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6041789054870605
Epoch: 16, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.141 Vali Acc: 0.650 Test Loss: 1.141 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6449258327484131
Epoch: 17, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.109 Vali Acc: 0.667 Test Loss: 1.109 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.621854305267334
Epoch: 18, Steps: 12 | Train Loss: 0.537 Vali Loss: 1.084 Vali Acc: 0.683 Test Loss: 1.084 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683322).  Saving model ...
Epoch: 19 cost time: 0.6413378715515137
Epoch: 19, Steps: 12 | Train Loss: 0.517 Vali Loss: 1.035 Vali Acc: 0.678 Test Loss: 1.035 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7059972286224365
Epoch: 20, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.028 Vali Acc: 0.694 Test Loss: 1.028 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 21 cost time: 0.7321171760559082
Epoch: 21, Steps: 12 | Train Loss: 0.443 Vali Loss: 1.002 Vali Acc: 0.706 Test Loss: 1.002 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 22 cost time: 0.773594856262207
Epoch: 22, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.967 Vali Acc: 0.722 Test Loss: 0.967 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 23 cost time: 0.6537811756134033
Epoch: 23, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.978 Vali Acc: 0.717 Test Loss: 0.978 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6520180702209473
Epoch: 24, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.970 Vali Acc: 0.750 Test Loss: 0.970 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.6454696655273438
Epoch: 25, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6980092525482178
Epoch: 26, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.964 Vali Acc: 0.739 Test Loss: 0.964 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6512284278869629
Epoch: 27, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6598751544952393
Epoch: 28, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.988 Vali Acc: 0.744 Test Loss: 0.988 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7112312316894531
Epoch: 29, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.969 Vali Acc: 0.767 Test Loss: 0.969 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766657).  Saving model ...
Epoch: 30 cost time: 0.6791763305664062
Epoch: 30, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.996 Vali Acc: 0.733 Test Loss: 0.996 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6446690559387207
Epoch: 31, Steps: 12 | Train Loss: 0.176 Vali Loss: 1.001 Vali Acc: 0.750 Test Loss: 1.001 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6639134883880615
Epoch: 32, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.997 Vali Acc: 0.744 Test Loss: 0.997 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7001438140869141
Epoch: 33, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.039 Vali Acc: 0.744 Test Loss: 1.039 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7453536987304688
Epoch: 34, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.022 Vali Acc: 0.739 Test Loss: 1.022 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6984131336212158
Epoch: 35, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.033 Vali Acc: 0.733 Test Loss: 1.033 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7015573978424072
Epoch: 36, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.068 Vali Acc: 0.728 Test Loss: 1.068 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6811699867248535
Epoch: 37, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.070 Vali Acc: 0.733 Test Loss: 1.070 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6815299987792969
Epoch: 38, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.069 Vali Acc: 0.739 Test Loss: 1.069 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6770296096801758
Epoch: 39, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.100 Vali Acc: 0.739 Test Loss: 1.100 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 31295
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.99281644821167
Epoch: 1, Steps: 12 | Train Loss: 2.784 Vali Loss: 2.713 Vali Acc: 0.039 Test Loss: 2.713 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 0.599846363067627
Epoch: 2, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.591 Vali Acc: 0.111 Test Loss: 2.591 Test Acc: 0.111
Validation loss decreased (-0.038862 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 0.6779773235321045
Epoch: 3, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.437 Vali Acc: 0.211 Test Loss: 2.437 Test Acc: 0.211
Validation loss decreased (-0.111085 --> -0.211087).  Saving model ...
Epoch: 4 cost time: 0.636152982711792
Epoch: 4, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.278 Vali Acc: 0.317 Test Loss: 2.278 Test Acc: 0.317
Validation loss decreased (-0.211087 --> -0.316644).  Saving model ...
Epoch: 5 cost time: 0.5857408046722412
Epoch: 5, Steps: 12 | Train Loss: 2.238 Vali Loss: 2.122 Vali Acc: 0.389 Test Loss: 2.122 Test Acc: 0.389
Validation loss decreased (-0.316644 --> -0.388868).  Saving model ...
Epoch: 6 cost time: 0.7241573333740234
Epoch: 6, Steps: 12 | Train Loss: 2.058 Vali Loss: 1.981 Vali Acc: 0.450 Test Loss: 1.981 Test Acc: 0.450
Validation loss decreased (-0.388868 --> -0.449980).  Saving model ...
Epoch: 7 cost time: 0.6530890464782715
Epoch: 7, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.850 Vali Acc: 0.472 Test Loss: 1.850 Test Acc: 0.472
Validation loss decreased (-0.449980 --> -0.472204).  Saving model ...
Epoch: 8 cost time: 0.663275957107544
Epoch: 8, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.723 Vali Acc: 0.517 Test Loss: 1.723 Test Acc: 0.517
Validation loss decreased (-0.472204 --> -0.516649).  Saving model ...
Epoch: 9 cost time: 0.6357541084289551
Epoch: 9, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.625 Vali Acc: 0.556 Test Loss: 1.625 Test Acc: 0.556
Validation loss decreased (-0.516649 --> -0.555539).  Saving model ...
Epoch: 10 cost time: 0.6805109977722168
Epoch: 10, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.536 Vali Acc: 0.583 Test Loss: 1.536 Test Acc: 0.583
Validation loss decreased (-0.555539 --> -0.583318).  Saving model ...
Epoch: 11 cost time: 0.5834200382232666
Epoch: 11, Steps: 12 | Train Loss: 1.394 Vali Loss: 1.462 Vali Acc: 0.583 Test Loss: 1.462 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 12 cost time: 0.6157639026641846
Epoch: 12, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.403 Vali Acc: 0.611 Test Loss: 1.403 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611097).  Saving model ...
Epoch: 13 cost time: 0.6352431774139404
Epoch: 13, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.344 Vali Acc: 0.606 Test Loss: 1.344 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6643824577331543
Epoch: 14, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.302 Vali Acc: 0.633 Test Loss: 1.302 Test Acc: 0.633
Validation loss decreased (-0.611097 --> -0.633320).  Saving model ...
Epoch: 15 cost time: 0.6100869178771973
Epoch: 15, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.256 Vali Acc: 0.617 Test Loss: 1.256 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5927438735961914
Epoch: 16, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.221 Vali Acc: 0.617 Test Loss: 1.221 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6733160018920898
Epoch: 17, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.190 Vali Acc: 0.650 Test Loss: 1.190 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649988).  Saving model ...
Epoch: 18 cost time: 0.6761271953582764
Epoch: 18, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.153 Vali Acc: 0.661 Test Loss: 1.153 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 19 cost time: 0.6711997985839844
Epoch: 19, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.133 Vali Acc: 0.661 Test Loss: 1.133 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661100).  Saving model ...
Epoch: 20 cost time: 0.6978621482849121
Epoch: 20, Steps: 12 | Train Loss: 0.662 Vali Loss: 1.105 Vali Acc: 0.672 Test Loss: 1.105 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672211).  Saving model ...
Epoch: 21 cost time: 0.6852593421936035
Epoch: 21, Steps: 12 | Train Loss: 0.618 Vali Loss: 1.079 Vali Acc: 0.683 Test Loss: 1.079 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 22 cost time: 0.701056718826294
Epoch: 22, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.057 Vali Acc: 0.672 Test Loss: 1.057 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6291050910949707
Epoch: 23, Steps: 12 | Train Loss: 0.586 Vali Loss: 1.023 Vali Acc: 0.689 Test Loss: 1.023 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 24 cost time: 0.6424548625946045
Epoch: 24, Steps: 12 | Train Loss: 0.563 Vali Loss: 1.008 Vali Acc: 0.700 Test Loss: 1.008 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.6156721115112305
Epoch: 25, Steps: 12 | Train Loss: 0.516 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7121691703796387
Epoch: 26, Steps: 12 | Train Loss: 0.477 Vali Loss: 1.002 Vali Acc: 0.683 Test Loss: 1.002 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6528785228729248
Epoch: 27, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.977 Vali Acc: 0.717 Test Loss: 0.977 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 28 cost time: 0.6554903984069824
Epoch: 28, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 29 cost time: 0.7074165344238281
Epoch: 29, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749990).  Saving model ...
Epoch: 30 cost time: 0.7467117309570312
Epoch: 30, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6913712024688721
Epoch: 31, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.946 Vali Acc: 0.744 Test Loss: 0.946 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6514182090759277
Epoch: 32, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.944 Vali Acc: 0.761 Test Loss: 0.944 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761102).  Saving model ...
Epoch: 33 cost time: 0.6733760833740234
Epoch: 33, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.940 Vali Acc: 0.761 Test Loss: 0.940 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 34 cost time: 0.6765286922454834
Epoch: 34, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.923 Vali Acc: 0.756 Test Loss: 0.923 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7658915519714355
Epoch: 35, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.947 Vali Acc: 0.744 Test Loss: 0.947 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7243552207946777
Epoch: 36, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.645146369934082
Epoch: 37, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.950 Vali Acc: 0.756 Test Loss: 0.950 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6595406532287598
Epoch: 38, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.944 Vali Acc: 0.761 Test Loss: 0.944 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6973311901092529
Epoch: 39, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6400096416473389
Epoch: 40, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.961 Vali Acc: 0.761 Test Loss: 0.961 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6333773136138916
Epoch: 41, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.956 Vali Acc: 0.744 Test Loss: 0.956 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5998232364654541
Epoch: 42, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.963 Vali Acc: 0.739 Test Loss: 0.963 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.665825366973877
Epoch: 43, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.970 Vali Acc: 0.733 Test Loss: 0.970 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 20751
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0771901607513428
Epoch: 1, Steps: 12 | Train Loss: 2.949 Vali Loss: 2.777 Vali Acc: 0.089 Test Loss: 2.777 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 0.6495568752288818
Epoch: 2, Steps: 12 | Train Loss: 2.884 Vali Loss: 2.673 Vali Acc: 0.117 Test Loss: 2.673 Test Acc: 0.117
Validation loss decreased (-0.088861 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 0.7200188636779785
Epoch: 3, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.536 Vali Acc: 0.194 Test Loss: 2.536 Test Acc: 0.194
Validation loss decreased (-0.116640 --> -0.194419).  Saving model ...
Epoch: 4 cost time: 0.657564640045166
Epoch: 4, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.383 Vali Acc: 0.306 Test Loss: 2.383 Test Acc: 0.306
Validation loss decreased (-0.194419 --> -0.305532).  Saving model ...
Epoch: 5 cost time: 0.6000819206237793
Epoch: 5, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.213 Vali Acc: 0.406 Test Loss: 2.213 Test Acc: 0.406
Validation loss decreased (-0.305532 --> -0.405533).  Saving model ...
Epoch: 6 cost time: 0.7311141490936279
Epoch: 6, Steps: 12 | Train Loss: 2.200 Vali Loss: 2.059 Vali Acc: 0.439 Test Loss: 2.059 Test Acc: 0.439
Validation loss decreased (-0.405533 --> -0.438868).  Saving model ...
Epoch: 7 cost time: 0.6323070526123047
Epoch: 7, Steps: 12 | Train Loss: 2.114 Vali Loss: 1.915 Vali Acc: 0.489 Test Loss: 1.915 Test Acc: 0.489
Validation loss decreased (-0.438868 --> -0.488870).  Saving model ...
Epoch: 8 cost time: 0.6651630401611328
Epoch: 8, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.800 Vali Acc: 0.539 Test Loss: 1.800 Test Acc: 0.539
Validation loss decreased (-0.488870 --> -0.538871).  Saving model ...
Epoch: 9 cost time: 0.5961041450500488
Epoch: 9, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.697 Vali Acc: 0.556 Test Loss: 1.697 Test Acc: 0.556
Validation loss decreased (-0.538871 --> -0.555539).  Saving model ...
Epoch: 10 cost time: 0.6197607517242432
Epoch: 10, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.619 Vali Acc: 0.544 Test Loss: 1.619 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6704080104827881
Epoch: 11, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.541 Vali Acc: 0.550 Test Loss: 1.541 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5953662395477295
Epoch: 12, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.475 Vali Acc: 0.567 Test Loss: 1.475 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566652).  Saving model ...
Epoch: 13 cost time: 0.6170845031738281
Epoch: 13, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.419 Vali Acc: 0.567 Test Loss: 1.419 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 14 cost time: 0.625546932220459
Epoch: 14, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.396 Vali Acc: 0.561 Test Loss: 1.396 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6431117057800293
Epoch: 15, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.359 Vali Acc: 0.606 Test Loss: 1.359 Test Acc: 0.606
Validation loss decreased (-0.566652 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 0.6779792308807373
Epoch: 16, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.320 Vali Acc: 0.622 Test Loss: 1.320 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 17 cost time: 0.6369602680206299
Epoch: 17, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.291 Vali Acc: 0.617 Test Loss: 1.291 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7316818237304688
Epoch: 18, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.252 Vali Acc: 0.639 Test Loss: 1.252 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638876).  Saving model ...
Epoch: 19 cost time: 0.6769468784332275
Epoch: 19, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.230 Vali Acc: 0.656 Test Loss: 1.230 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655543).  Saving model ...
Epoch: 20 cost time: 0.6611754894256592
Epoch: 20, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.215 Vali Acc: 0.650 Test Loss: 1.215 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5961177349090576
Epoch: 21, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.188 Vali Acc: 0.661 Test Loss: 1.188 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 22 cost time: 0.5889389514923096
Epoch: 22, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.141 Vali Acc: 0.672 Test Loss: 1.141 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 23 cost time: 0.6011919975280762
Epoch: 23, Steps: 12 | Train Loss: 0.655 Vali Loss: 1.120 Vali Acc: 0.672 Test Loss: 1.120 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 24 cost time: 0.6301369667053223
Epoch: 24, Steps: 12 | Train Loss: 0.621 Vali Loss: 1.091 Vali Acc: 0.689 Test Loss: 1.091 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 25 cost time: 0.6333961486816406
Epoch: 25, Steps: 12 | Train Loss: 0.549 Vali Loss: 1.095 Vali Acc: 0.683 Test Loss: 1.095 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6047449111938477
Epoch: 26, Steps: 12 | Train Loss: 0.548 Vali Loss: 1.074 Vali Acc: 0.689 Test Loss: 1.074 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 27 cost time: 0.6244759559631348
Epoch: 27, Steps: 12 | Train Loss: 0.473 Vali Loss: 1.054 Vali Acc: 0.683 Test Loss: 1.054 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6696515083312988
Epoch: 28, Steps: 12 | Train Loss: 0.495 Vali Loss: 1.045 Vali Acc: 0.694 Test Loss: 1.045 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 29 cost time: 0.6100540161132812
Epoch: 29, Steps: 12 | Train Loss: 0.427 Vali Loss: 1.028 Vali Acc: 0.706 Test Loss: 1.028 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 30 cost time: 0.6083142757415771
Epoch: 30, Steps: 12 | Train Loss: 0.433 Vali Loss: 1.000 Vali Acc: 0.722 Test Loss: 1.000 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722212).  Saving model ...
Epoch: 31 cost time: 0.614621639251709
Epoch: 31, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.992 Vali Acc: 0.706 Test Loss: 0.992 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6062593460083008
Epoch: 32, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.973 Vali Acc: 0.722 Test Loss: 0.973 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 33 cost time: 0.6543869972229004
Epoch: 33, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 34 cost time: 0.5937752723693848
Epoch: 34, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.958 Vali Acc: 0.717 Test Loss: 0.958 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5875122547149658
Epoch: 35, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 36 cost time: 0.6414556503295898
Epoch: 36, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.961 Vali Acc: 0.728 Test Loss: 0.961 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6278443336486816
Epoch: 37, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.949 Vali Acc: 0.744 Test Loss: 0.949 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 38 cost time: 0.648979902267456
Epoch: 38, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.948 Vali Acc: 0.733 Test Loss: 0.948 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5854978561401367
Epoch: 39, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.979 Vali Acc: 0.739 Test Loss: 0.979 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5611059665679932
Epoch: 40, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.977 Vali Acc: 0.717 Test Loss: 0.977 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6280083656311035
Epoch: 41, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.966 Vali Acc: 0.711 Test Loss: 0.966 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6621308326721191
Epoch: 42, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.971 Vali Acc: 0.733 Test Loss: 0.971 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.639697790145874
Epoch: 43, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.978 Vali Acc: 0.711 Test Loss: 0.978 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.564730167388916
Epoch: 44, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.961 Vali Acc: 0.739 Test Loss: 0.961 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5756912231445312
Epoch: 45, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.960 Vali Acc: 0.744 Test Loss: 0.960 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6606135368347168
Epoch: 46, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.981 Vali Acc: 0.733 Test Loss: 0.981 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6279244422912598
Epoch: 47, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.972 Vali Acc: 0.761 Test Loss: 0.972 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761101).  Saving model ...
Epoch: 48 cost time: 0.596482515335083
Epoch: 48, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.998 Vali Acc: 0.744 Test Loss: 0.998 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6002662181854248
Epoch: 49, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.016 Vali Acc: 0.739 Test Loss: 1.016 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.630678653717041
Epoch: 50, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.037 Vali Acc: 0.717 Test Loss: 1.037 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6023709774017334
Epoch: 51, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.041 Vali Acc: 0.722 Test Loss: 1.041 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7431907653808594
Epoch: 52, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.033 Vali Acc: 0.733 Test Loss: 1.033 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.575775146484375
Epoch: 53, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.040 Vali Acc: 0.744 Test Loss: 1.040 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6183962821960449
Epoch: 54, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.053 Vali Acc: 0.728 Test Loss: 1.053 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6397531032562256
Epoch: 55, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.072 Vali Acc: 0.711 Test Loss: 1.072 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.7144711017608643
Epoch: 56, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.056 Vali Acc: 0.739 Test Loss: 1.056 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6205935478210449
Epoch: 57, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.060 Vali Acc: 0.744 Test Loss: 1.060 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 20287
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.155622959136963
Epoch: 1, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.663 Vali Acc: 0.161 Test Loss: 2.663 Test Acc: 0.161
Validation loss decreased (inf --> -0.161084).  Saving model ...
Epoch: 2 cost time: 0.6264731884002686
Epoch: 2, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.566 Vali Acc: 0.200 Test Loss: 2.566 Test Acc: 0.200
Validation loss decreased (-0.161084 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 0.5773000717163086
Epoch: 3, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.455 Vali Acc: 0.261 Test Loss: 2.455 Test Acc: 0.261
Validation loss decreased (-0.199974 --> -0.261087).  Saving model ...
Epoch: 4 cost time: 0.6404054164886475
Epoch: 4, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.337 Vali Acc: 0.367 Test Loss: 2.337 Test Acc: 0.367
Validation loss decreased (-0.261087 --> -0.366643).  Saving model ...
Epoch: 5 cost time: 0.6241025924682617
Epoch: 5, Steps: 12 | Train Loss: 2.418 Vali Loss: 2.210 Vali Acc: 0.383 Test Loss: 2.210 Test Acc: 0.383
Validation loss decreased (-0.366643 --> -0.383311).  Saving model ...
Epoch: 6 cost time: 0.6134493350982666
Epoch: 6, Steps: 12 | Train Loss: 2.238 Vali Loss: 2.092 Vali Acc: 0.444 Test Loss: 2.092 Test Acc: 0.444
Validation loss decreased (-0.383311 --> -0.444424).  Saving model ...
Epoch: 7 cost time: 0.6199567317962646
Epoch: 7, Steps: 12 | Train Loss: 2.134 Vali Loss: 1.979 Vali Acc: 0.500 Test Loss: 1.979 Test Acc: 0.500
Validation loss decreased (-0.444424 --> -0.499980).  Saving model ...
Epoch: 8 cost time: 0.6249692440032959
Epoch: 8, Steps: 12 | Train Loss: 2.018 Vali Loss: 1.880 Vali Acc: 0.561 Test Loss: 1.880 Test Acc: 0.561
Validation loss decreased (-0.499980 --> -0.561092).  Saving model ...
Epoch: 9 cost time: 0.6831307411193848
Epoch: 9, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.793 Vali Acc: 0.578 Test Loss: 1.793 Test Acc: 0.578
Validation loss decreased (-0.561092 --> -0.577760).  Saving model ...
Epoch: 10 cost time: 0.5666451454162598
Epoch: 10, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.712 Vali Acc: 0.611 Test Loss: 1.712 Test Acc: 0.611
Validation loss decreased (-0.577760 --> -0.611094).  Saving model ...
Epoch: 11 cost time: 0.6095993518829346
Epoch: 11, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.646 Vali Acc: 0.611 Test Loss: 1.646 Test Acc: 0.611
Validation loss decreased (-0.611094 --> -0.611095).  Saving model ...
Epoch: 12 cost time: 0.6499857902526855
Epoch: 12, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.584 Vali Acc: 0.617 Test Loss: 1.584 Test Acc: 0.617
Validation loss decreased (-0.611095 --> -0.616651).  Saving model ...
Epoch: 13 cost time: 0.6277205944061279
Epoch: 13, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.528 Vali Acc: 0.622 Test Loss: 1.528 Test Acc: 0.622
Validation loss decreased (-0.616651 --> -0.622207).  Saving model ...
Epoch: 14 cost time: 0.6139063835144043
Epoch: 14, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.484 Vali Acc: 0.633 Test Loss: 1.484 Test Acc: 0.633
Validation loss decreased (-0.622207 --> -0.633318).  Saving model ...
Epoch: 15 cost time: 0.6498379707336426
Epoch: 15, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.436 Vali Acc: 0.633 Test Loss: 1.436 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633319).  Saving model ...
Epoch: 16 cost time: 0.5968527793884277
Epoch: 16, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.392 Vali Acc: 0.633 Test Loss: 1.392 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 17 cost time: 0.6184964179992676
Epoch: 17, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.356 Vali Acc: 0.633 Test Loss: 1.356 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633320).  Saving model ...
Epoch: 18 cost time: 0.5735769271850586
Epoch: 18, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.339 Vali Acc: 0.639 Test Loss: 1.339 Test Acc: 0.639
Validation loss decreased (-0.633320 --> -0.638875).  Saving model ...
Epoch: 19 cost time: 0.5928122997283936
Epoch: 19, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.321 Vali Acc: 0.644 Test Loss: 1.321 Test Acc: 0.644
Validation loss decreased (-0.638875 --> -0.644431).  Saving model ...
Epoch: 20 cost time: 0.6253063678741455
Epoch: 20, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.285 Vali Acc: 0.633 Test Loss: 1.285 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6423254013061523
Epoch: 21, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.272 Vali Acc: 0.633 Test Loss: 1.272 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5834345817565918
Epoch: 22, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.238 Vali Acc: 0.656 Test Loss: 1.238 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 23 cost time: 0.6525516510009766
Epoch: 23, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.228 Vali Acc: 0.661 Test Loss: 1.228 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 24 cost time: 0.5822598934173584
Epoch: 24, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.205 Vali Acc: 0.667 Test Loss: 1.205 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 25 cost time: 0.6449809074401855
Epoch: 25, Steps: 12 | Train Loss: 0.744 Vali Loss: 1.201 Vali Acc: 0.672 Test Loss: 1.201 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672210).  Saving model ...
Epoch: 26 cost time: 0.6345183849334717
Epoch: 26, Steps: 12 | Train Loss: 0.712 Vali Loss: 1.181 Vali Acc: 0.667 Test Loss: 1.181 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5766634941101074
Epoch: 27, Steps: 12 | Train Loss: 0.677 Vali Loss: 1.171 Vali Acc: 0.672 Test Loss: 1.171 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 28 cost time: 0.5826900005340576
Epoch: 28, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.151 Vali Acc: 0.672 Test Loss: 1.151 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 29 cost time: 0.5801820755004883
Epoch: 29, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.139 Vali Acc: 0.689 Test Loss: 1.139 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688877).  Saving model ...
Epoch: 30 cost time: 0.6068782806396484
Epoch: 30, Steps: 12 | Train Loss: 0.592 Vali Loss: 1.120 Vali Acc: 0.683 Test Loss: 1.120 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5825450420379639
Epoch: 31, Steps: 12 | Train Loss: 0.583 Vali Loss: 1.100 Vali Acc: 0.700 Test Loss: 1.100 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699989).  Saving model ...
Epoch: 32 cost time: 0.5948326587677002
Epoch: 32, Steps: 12 | Train Loss: 0.522 Vali Loss: 1.086 Vali Acc: 0.694 Test Loss: 1.086 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6173005104064941
Epoch: 33, Steps: 12 | Train Loss: 0.573 Vali Loss: 1.074 Vali Acc: 0.689 Test Loss: 1.074 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6457757949829102
Epoch: 34, Steps: 12 | Train Loss: 0.527 Vali Loss: 1.075 Vali Acc: 0.672 Test Loss: 1.075 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5973050594329834
Epoch: 35, Steps: 12 | Train Loss: 0.474 Vali Loss: 1.067 Vali Acc: 0.689 Test Loss: 1.067 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6355996131896973
Epoch: 36, Steps: 12 | Train Loss: 0.474 Vali Loss: 1.049 Vali Acc: 0.683 Test Loss: 1.049 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6311914920806885
Epoch: 37, Steps: 12 | Train Loss: 0.438 Vali Loss: 1.047 Vali Acc: 0.694 Test Loss: 1.047 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5120165348052979
Epoch: 38, Steps: 12 | Train Loss: 0.412 Vali Loss: 1.035 Vali Acc: 0.694 Test Loss: 1.035 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6386563777923584
Epoch: 39, Steps: 12 | Train Loss: 0.426 Vali Loss: 1.032 Vali Acc: 0.706 Test Loss: 1.032 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 40 cost time: 0.6202514171600342
Epoch: 40, Steps: 12 | Train Loss: 0.382 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6138641834259033
Epoch: 41, Steps: 12 | Train Loss: 0.371 Vali Loss: 1.009 Vali Acc: 0.711 Test Loss: 1.009 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 42 cost time: 0.5732557773590088
Epoch: 42, Steps: 12 | Train Loss: 0.357 Vali Loss: 1.001 Vali Acc: 0.711 Test Loss: 1.001 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 43 cost time: 0.6357204914093018
Epoch: 43, Steps: 12 | Train Loss: 0.367 Vali Loss: 1.003 Vali Acc: 0.706 Test Loss: 1.003 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6415972709655762
Epoch: 44, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 45 cost time: 0.6350445747375488
Epoch: 45, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.986 Vali Acc: 0.717 Test Loss: 0.986 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5997722148895264
Epoch: 46, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.986 Vali Acc: 0.722 Test Loss: 0.986 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 47 cost time: 0.6769664287567139
Epoch: 47, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.974 Vali Acc: 0.733 Test Loss: 0.974 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 48 cost time: 0.6619739532470703
Epoch: 48, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.980 Vali Acc: 0.728 Test Loss: 0.980 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6258101463317871
Epoch: 49, Steps: 12 | Train Loss: 0.249 Vali Loss: 1.000 Vali Acc: 0.750 Test Loss: 1.000 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749990).  Saving model ...
Epoch: 50 cost time: 0.6604843139648438
Epoch: 50, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.994 Vali Acc: 0.739 Test Loss: 0.994 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6625669002532959
Epoch: 51, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.993 Vali Acc: 0.733 Test Loss: 0.993 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.648186206817627
Epoch: 52, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.988 Vali Acc: 0.728 Test Loss: 0.988 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5748145580291748
Epoch: 53, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.993 Vali Acc: 0.722 Test Loss: 0.993 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7439649105072021
Epoch: 54, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.990 Vali Acc: 0.744 Test Loss: 0.990 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.6633315086364746
Epoch: 55, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 56 cost time: 0.6494314670562744
Epoch: 56, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.994 Vali Acc: 0.744 Test Loss: 0.994 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6640849113464355
Epoch: 57, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.005 Vali Acc: 0.739 Test Loss: 1.005 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5722510814666748
Epoch: 58, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.002 Vali Acc: 0.756 Test Loss: 1.002 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 59 cost time: 0.6220855712890625
Epoch: 59, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.000 Vali Acc: 0.739 Test Loss: 1.000 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5838210582733154
Epoch: 60, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.013 Vali Acc: 0.750 Test Loss: 1.013 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5841925144195557
Epoch: 61, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.029 Vali Acc: 0.750 Test Loss: 1.029 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5643789768218994
Epoch: 62, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.016 Vali Acc: 0.750 Test Loss: 1.016 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.6180417537689209
Epoch: 63, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.021 Vali Acc: 0.722 Test Loss: 1.021 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.5822641849517822
Epoch: 64, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.034 Vali Acc: 0.733 Test Loss: 1.034 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.6169726848602295
Epoch: 65, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.029 Vali Acc: 0.744 Test Loss: 1.029 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.5520575046539307
Epoch: 66, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.018 Vali Acc: 0.744 Test Loss: 1.018 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.5956859588623047
Epoch: 67, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.030 Vali Acc: 0.756 Test Loss: 1.030 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.5850143432617188
Epoch: 68, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.031 Vali Acc: 0.750 Test Loss: 1.031 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 16943
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.7290897369384766
Epoch: 1, Steps: 12 | Train Loss: 2.906 Vali Loss: 2.714 Vali Acc: 0.106 Test Loss: 2.714 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 0.6005370616912842
Epoch: 2, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.644 Vali Acc: 0.150 Test Loss: 2.644 Test Acc: 0.150
Validation loss decreased (-0.105528 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 0.5984766483306885
Epoch: 3, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.565 Vali Acc: 0.161 Test Loss: 2.565 Test Acc: 0.161
Validation loss decreased (-0.149974 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 0.6155955791473389
Epoch: 4, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.472 Vali Acc: 0.256 Test Loss: 2.472 Test Acc: 0.256
Validation loss decreased (-0.161085 --> -0.255531).  Saving model ...
Epoch: 5 cost time: 0.6192514896392822
Epoch: 5, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.374 Vali Acc: 0.306 Test Loss: 2.374 Test Acc: 0.306
Validation loss decreased (-0.255531 --> -0.305532).  Saving model ...
Epoch: 6 cost time: 0.5964908599853516
Epoch: 6, Steps: 12 | Train Loss: 2.424 Vali Loss: 2.279 Vali Acc: 0.344 Test Loss: 2.279 Test Acc: 0.344
Validation loss decreased (-0.305532 --> -0.344422).  Saving model ...
Epoch: 7 cost time: 0.582211971282959
Epoch: 7, Steps: 12 | Train Loss: 2.321 Vali Loss: 2.179 Vali Acc: 0.406 Test Loss: 2.179 Test Acc: 0.406
Validation loss decreased (-0.344422 --> -0.405534).  Saving model ...
Epoch: 8 cost time: 0.6295914649963379
Epoch: 8, Steps: 12 | Train Loss: 2.271 Vali Loss: 2.085 Vali Acc: 0.478 Test Loss: 2.085 Test Acc: 0.478
Validation loss decreased (-0.405534 --> -0.477757).  Saving model ...
Epoch: 9 cost time: 0.5913498401641846
Epoch: 9, Steps: 12 | Train Loss: 2.107 Vali Loss: 1.991 Vali Acc: 0.511 Test Loss: 1.991 Test Acc: 0.511
Validation loss decreased (-0.477757 --> -0.511091).  Saving model ...
Epoch: 10 cost time: 0.5655097961425781
Epoch: 10, Steps: 12 | Train Loss: 2.010 Vali Loss: 1.899 Vali Acc: 0.533 Test Loss: 1.899 Test Acc: 0.533
Validation loss decreased (-0.511091 --> -0.533314).  Saving model ...
Epoch: 11 cost time: 0.5856926441192627
Epoch: 11, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.825 Vali Acc: 0.533 Test Loss: 1.825 Test Acc: 0.533
Validation loss decreased (-0.533314 --> -0.533315).  Saving model ...
Epoch: 12 cost time: 0.6133017539978027
Epoch: 12, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.752 Vali Acc: 0.522 Test Loss: 1.752 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6027755737304688
Epoch: 13, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.689 Vali Acc: 0.528 Test Loss: 1.689 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5798313617706299
Epoch: 14, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.628 Vali Acc: 0.533 Test Loss: 1.628 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533317).  Saving model ...
Epoch: 15 cost time: 0.5852627754211426
Epoch: 15, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.565 Vali Acc: 0.561 Test Loss: 1.565 Test Acc: 0.561
Validation loss decreased (-0.533317 --> -0.561095).  Saving model ...
Epoch: 16 cost time: 0.5846340656280518
Epoch: 16, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.526 Vali Acc: 0.567 Test Loss: 1.526 Test Acc: 0.567
Validation loss decreased (-0.561095 --> -0.566651).  Saving model ...
Epoch: 17 cost time: 0.6007077693939209
Epoch: 17, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.482 Vali Acc: 0.600 Test Loss: 1.482 Test Acc: 0.600
Validation loss decreased (-0.566651 --> -0.599985).  Saving model ...
Epoch: 18 cost time: 0.6103978157043457
Epoch: 18, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.450 Vali Acc: 0.617 Test Loss: 1.450 Test Acc: 0.617
Validation loss decreased (-0.599985 --> -0.616652).  Saving model ...
Epoch: 19 cost time: 0.6596043109893799
Epoch: 19, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.412 Vali Acc: 0.617 Test Loss: 1.412 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616653).  Saving model ...
Epoch: 20 cost time: 0.639007568359375
Epoch: 20, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.389 Vali Acc: 0.617 Test Loss: 1.389 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 21 cost time: 0.625354528427124
Epoch: 21, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.360 Vali Acc: 0.606 Test Loss: 1.360 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5994162559509277
Epoch: 22, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.333 Vali Acc: 0.611 Test Loss: 1.333 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.616649866104126
Epoch: 23, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.310 Vali Acc: 0.606 Test Loss: 1.310 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.659153938293457
Epoch: 24, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.289 Vali Acc: 0.617 Test Loss: 1.289 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 25 cost time: 0.6406705379486084
Epoch: 25, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.256 Vali Acc: 0.628 Test Loss: 1.256 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627765).  Saving model ...
Epoch: 26 cost time: 0.6146206855773926
Epoch: 26, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.229 Vali Acc: 0.644 Test Loss: 1.229 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644432).  Saving model ...
Epoch: 27 cost time: 0.5807504653930664
Epoch: 27, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.222 Vali Acc: 0.661 Test Loss: 1.222 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 28 cost time: 0.6187224388122559
Epoch: 28, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.195 Vali Acc: 0.656 Test Loss: 1.195 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5990667343139648
Epoch: 29, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.174 Vali Acc: 0.661 Test Loss: 1.174 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661099).  Saving model ...
Epoch: 30 cost time: 0.5676186084747314
Epoch: 30, Steps: 12 | Train Loss: 0.721 Vali Loss: 1.149 Vali Acc: 0.661 Test Loss: 1.149 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661100).  Saving model ...
Epoch: 31 cost time: 0.5804235935211182
Epoch: 31, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.131 Vali Acc: 0.672 Test Loss: 1.131 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672211).  Saving model ...
Epoch: 32 cost time: 0.5518836975097656
Epoch: 32, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.119 Vali Acc: 0.678 Test Loss: 1.119 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 33 cost time: 0.5794117450714111
Epoch: 33, Steps: 12 | Train Loss: 0.684 Vali Loss: 1.099 Vali Acc: 0.661 Test Loss: 1.099 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5867302417755127
Epoch: 34, Steps: 12 | Train Loss: 0.646 Vali Loss: 1.077 Vali Acc: 0.661 Test Loss: 1.077 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5453381538391113
Epoch: 35, Steps: 12 | Train Loss: 0.577 Vali Loss: 1.052 Vali Acc: 0.683 Test Loss: 1.052 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 36 cost time: 0.567922830581665
Epoch: 36, Steps: 12 | Train Loss: 0.583 Vali Loss: 1.038 Vali Acc: 0.678 Test Loss: 1.038 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5351159572601318
Epoch: 37, Steps: 12 | Train Loss: 0.553 Vali Loss: 1.013 Vali Acc: 0.683 Test Loss: 1.013 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 38 cost time: 0.6386973857879639
Epoch: 38, Steps: 12 | Train Loss: 0.545 Vali Loss: 1.016 Vali Acc: 0.694 Test Loss: 1.016 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694434).  Saving model ...
Epoch: 39 cost time: 0.602508544921875
Epoch: 39, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.999 Vali Acc: 0.700 Test Loss: 0.999 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 40 cost time: 0.6034574508666992
Epoch: 40, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.975 Vali Acc: 0.711 Test Loss: 0.975 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 41 cost time: 0.6202960014343262
Epoch: 41, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.954 Vali Acc: 0.689 Test Loss: 0.954 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6240420341491699
Epoch: 42, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.949 Vali Acc: 0.700 Test Loss: 0.949 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5795042514801025
Epoch: 43, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.936 Vali Acc: 0.706 Test Loss: 0.936 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5994515419006348
Epoch: 44, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.932 Vali Acc: 0.711 Test Loss: 0.932 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711102).  Saving model ...
Epoch: 45 cost time: 0.7133042812347412
Epoch: 45, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.917 Vali Acc: 0.711 Test Loss: 0.917 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 46 cost time: 0.5674710273742676
Epoch: 46, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.620445966720581
Epoch: 47, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.902 Vali Acc: 0.711 Test Loss: 0.902 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 48 cost time: 0.5942468643188477
Epoch: 48, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.890 Vali Acc: 0.728 Test Loss: 0.890 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 49 cost time: 0.6034600734710693
Epoch: 49, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.885 Vali Acc: 0.744 Test Loss: 0.885 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 50 cost time: 0.5686266422271729
Epoch: 50, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.885 Vali Acc: 0.756 Test Loss: 0.885 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 51 cost time: 0.6497416496276855
Epoch: 51, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5804994106292725
Epoch: 52, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.851 Vali Acc: 0.739 Test Loss: 0.851 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6458227634429932
Epoch: 53, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.853 Vali Acc: 0.739 Test Loss: 0.853 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6346774101257324
Epoch: 54, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.856 Vali Acc: 0.744 Test Loss: 0.856 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.6203804016113281
Epoch: 55, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.866 Vali Acc: 0.756 Test Loss: 0.866 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 56 cost time: 0.644503116607666
Epoch: 56, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.874 Vali Acc: 0.744 Test Loss: 0.874 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6208798885345459
Epoch: 57, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.857 Vali Acc: 0.761 Test Loss: 0.857 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 58 cost time: 0.6144325733184814
Epoch: 58, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.851 Vali Acc: 0.761 Test Loss: 0.851 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 59 cost time: 0.6360471248626709
Epoch: 59, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6044809818267822
Epoch: 60, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.847 Vali Acc: 0.744 Test Loss: 0.847 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5945286750793457
Epoch: 61, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.857 Vali Acc: 0.739 Test Loss: 0.857 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.6129999160766602
Epoch: 62, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.6198265552520752
Epoch: 63, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.839 Vali Acc: 0.728 Test Loss: 0.839 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.6292550563812256
Epoch: 64, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.838 Vali Acc: 0.728 Test Loss: 0.838 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.5801818370819092
Epoch: 65, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.5713460445404053
Epoch: 66, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.5464785099029541
Epoch: 67, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.6113772392272949
Epoch: 68, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 15055
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0591330528259277
Epoch: 1, Steps: 12 | Train Loss: 2.849 Vali Loss: 2.839 Vali Acc: 0.072 Test Loss: 2.839 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 0.6083040237426758
Epoch: 2, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.801 Vali Acc: 0.078 Test Loss: 2.801 Test Acc: 0.078
Validation loss decreased (-0.072194 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 0.6095256805419922
Epoch: 3, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.728 Vali Acc: 0.078 Test Loss: 2.728 Test Acc: 0.078
Validation loss decreased (-0.077750 --> -0.077750).  Saving model ...
Epoch: 4 cost time: 0.5550763607025146
Epoch: 4, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.639 Vali Acc: 0.133 Test Loss: 2.639 Test Acc: 0.133
Validation loss decreased (-0.077750 --> -0.133307).  Saving model ...
Epoch: 5 cost time: 0.5853440761566162
Epoch: 5, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.535 Vali Acc: 0.183 Test Loss: 2.535 Test Acc: 0.183
Validation loss decreased (-0.133307 --> -0.183308).  Saving model ...
Epoch: 6 cost time: 0.6174256801605225
Epoch: 6, Steps: 12 | Train Loss: 2.433 Vali Loss: 2.429 Vali Acc: 0.267 Test Loss: 2.429 Test Acc: 0.267
Validation loss decreased (-0.183308 --> -0.266642).  Saving model ...
Epoch: 7 cost time: 0.6015570163726807
Epoch: 7, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.325 Vali Acc: 0.322 Test Loss: 2.325 Test Acc: 0.322
Validation loss decreased (-0.266642 --> -0.322199).  Saving model ...
Epoch: 8 cost time: 0.6193840503692627
Epoch: 8, Steps: 12 | Train Loss: 2.240 Vali Loss: 2.224 Vali Acc: 0.378 Test Loss: 2.224 Test Acc: 0.378
Validation loss decreased (-0.322199 --> -0.377756).  Saving model ...
Epoch: 9 cost time: 0.6079046726226807
Epoch: 9, Steps: 12 | Train Loss: 2.096 Vali Loss: 2.128 Vali Acc: 0.433 Test Loss: 2.128 Test Acc: 0.433
Validation loss decreased (-0.377756 --> -0.433312).  Saving model ...
Epoch: 10 cost time: 0.6415424346923828
Epoch: 10, Steps: 12 | Train Loss: 2.020 Vali Loss: 2.036 Vali Acc: 0.444 Test Loss: 2.036 Test Acc: 0.444
Validation loss decreased (-0.433312 --> -0.444424).  Saving model ...
Epoch: 11 cost time: 0.618269681930542
Epoch: 11, Steps: 12 | Train Loss: 1.933 Vali Loss: 1.946 Vali Acc: 0.472 Test Loss: 1.946 Test Acc: 0.472
Validation loss decreased (-0.444424 --> -0.472203).  Saving model ...
Epoch: 12 cost time: 0.5853745937347412
Epoch: 12, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.861 Vali Acc: 0.500 Test Loss: 1.861 Test Acc: 0.500
Validation loss decreased (-0.472203 --> -0.499981).  Saving model ...
Epoch: 13 cost time: 0.6260850429534912
Epoch: 13, Steps: 12 | Train Loss: 1.705 Vali Loss: 1.786 Vali Acc: 0.539 Test Loss: 1.786 Test Acc: 0.539
Validation loss decreased (-0.499981 --> -0.538871).  Saving model ...
Epoch: 14 cost time: 0.6480574607849121
Epoch: 14, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.726 Vali Acc: 0.539 Test Loss: 1.726 Test Acc: 0.539
Validation loss decreased (-0.538871 --> -0.538872).  Saving model ...
Epoch: 15 cost time: 0.5820479393005371
Epoch: 15, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.669 Vali Acc: 0.572 Test Loss: 1.669 Test Acc: 0.572
Validation loss decreased (-0.538872 --> -0.572206).  Saving model ...
Epoch: 16 cost time: 0.6051409244537354
Epoch: 16, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.619 Vali Acc: 0.572 Test Loss: 1.619 Test Acc: 0.572
Validation loss decreased (-0.572206 --> -0.572206).  Saving model ...
Epoch: 17 cost time: 0.6043522357940674
Epoch: 17, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.572 Vali Acc: 0.600 Test Loss: 1.572 Test Acc: 0.600
Validation loss decreased (-0.572206 --> -0.599984).  Saving model ...
Epoch: 18 cost time: 0.6814594268798828
Epoch: 18, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.528 Vali Acc: 0.611 Test Loss: 1.528 Test Acc: 0.611
Validation loss decreased (-0.599984 --> -0.611096).  Saving model ...
Epoch: 19 cost time: 0.6651782989501953
Epoch: 19, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.493 Vali Acc: 0.617 Test Loss: 1.493 Test Acc: 0.617
Validation loss decreased (-0.611096 --> -0.616652).  Saving model ...
Epoch: 20 cost time: 0.6443877220153809
Epoch: 20, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.464 Vali Acc: 0.611 Test Loss: 1.464 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5785045623779297
Epoch: 21, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.431 Vali Acc: 0.628 Test Loss: 1.431 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627763).  Saving model ...
Epoch: 22 cost time: 0.5949592590332031
Epoch: 22, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.401 Vali Acc: 0.633 Test Loss: 1.401 Test Acc: 0.633
Validation loss decreased (-0.627763 --> -0.633319).  Saving model ...
Epoch: 23 cost time: 0.6341748237609863
Epoch: 23, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.373 Vali Acc: 0.633 Test Loss: 1.373 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633320).  Saving model ...
Epoch: 24 cost time: 0.5844597816467285
Epoch: 24, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.346 Vali Acc: 0.617 Test Loss: 1.346 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6249794960021973
Epoch: 25, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.325 Vali Acc: 0.617 Test Loss: 1.325 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6511240005493164
Epoch: 26, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.304 Vali Acc: 0.628 Test Loss: 1.304 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6256580352783203
Epoch: 27, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.282 Vali Acc: 0.633 Test Loss: 1.282 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 28 cost time: 0.5888433456420898
Epoch: 28, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.254 Vali Acc: 0.633 Test Loss: 1.254 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 29 cost time: 0.5925788879394531
Epoch: 29, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.239 Vali Acc: 0.639 Test Loss: 1.239 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 30 cost time: 0.6251428127288818
Epoch: 30, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.213 Vali Acc: 0.639 Test Loss: 1.213 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 31 cost time: 0.595109224319458
Epoch: 31, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.182 Vali Acc: 0.633 Test Loss: 1.182 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6008303165435791
Epoch: 32, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.155 Vali Acc: 0.628 Test Loss: 1.155 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5882916450500488
Epoch: 33, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.137 Vali Acc: 0.644 Test Loss: 1.137 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 34 cost time: 0.6033828258514404
Epoch: 34, Steps: 12 | Train Loss: 0.712 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
Validation loss decreased (-0.644433 --> -0.649989).  Saving model ...
Epoch: 35 cost time: 0.6004903316497803
Epoch: 35, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.111 Vali Acc: 0.639 Test Loss: 1.111 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5640616416931152
Epoch: 36, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.095 Vali Acc: 0.639 Test Loss: 1.095 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5513434410095215
Epoch: 37, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.080 Vali Acc: 0.656 Test Loss: 1.080 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 38 cost time: 0.6073317527770996
Epoch: 38, Steps: 12 | Train Loss: 0.610 Vali Loss: 1.056 Vali Acc: 0.656 Test Loss: 1.056 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 39 cost time: 0.6100666522979736
Epoch: 39, Steps: 12 | Train Loss: 0.596 Vali Loss: 1.039 Vali Acc: 0.656 Test Loss: 1.039 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 40 cost time: 0.6055946350097656
Epoch: 40, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.012 Vali Acc: 0.672 Test Loss: 1.012 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672212).  Saving model ...
Epoch: 41 cost time: 0.6120471954345703
Epoch: 41, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.001 Vali Acc: 0.678 Test Loss: 1.001 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 42 cost time: 0.6073548793792725
Epoch: 42, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.988 Vali Acc: 0.683 Test Loss: 0.988 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683323).  Saving model ...
Epoch: 43 cost time: 0.6307599544525146
Epoch: 43, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.981 Vali Acc: 0.672 Test Loss: 0.981 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.562178373336792
Epoch: 44, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.971 Vali Acc: 0.694 Test Loss: 0.971 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 45 cost time: 0.588482141494751
Epoch: 45, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.953 Vali Acc: 0.722 Test Loss: 0.953 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722213).  Saving model ...
Epoch: 46 cost time: 0.6085617542266846
Epoch: 46, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.932 Vali Acc: 0.728 Test Loss: 0.932 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727768).  Saving model ...
Epoch: 47 cost time: 0.6017298698425293
Epoch: 47, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.924 Vali Acc: 0.728 Test Loss: 0.924 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 48 cost time: 0.5759706497192383
Epoch: 48, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.917 Vali Acc: 0.711 Test Loss: 0.917 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5301122665405273
Epoch: 49, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.909 Vali Acc: 0.733 Test Loss: 0.909 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733324).  Saving model ...
Epoch: 50 cost time: 0.5694172382354736
Epoch: 50, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6195633411407471
Epoch: 51, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.900 Vali Acc: 0.733 Test Loss: 0.900 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 52 cost time: 0.5666136741638184
Epoch: 52, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.896 Vali Acc: 0.728 Test Loss: 0.896 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6725144386291504
Epoch: 53, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.889 Vali Acc: 0.739 Test Loss: 0.889 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 54 cost time: 0.6561229228973389
Epoch: 54, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.876 Vali Acc: 0.744 Test Loss: 0.876 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 55 cost time: 0.6008856296539307
Epoch: 55, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6079883575439453
Epoch: 56, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.866 Vali Acc: 0.739 Test Loss: 0.866 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.599057674407959
Epoch: 57, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.854 Vali Acc: 0.744 Test Loss: 0.854 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 58 cost time: 0.5472524166107178
Epoch: 58, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.862 Vali Acc: 0.739 Test Loss: 0.862 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5654420852661133
Epoch: 59, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749991).  Saving model ...
Epoch: 60 cost time: 0.5728209018707275
Epoch: 60, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.860 Vali Acc: 0.744 Test Loss: 0.860 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5460934638977051
Epoch: 61, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.857 Vali Acc: 0.744 Test Loss: 0.857 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5439870357513428
Epoch: 62, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5593364238739014
Epoch: 63, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.845 Vali Acc: 0.744 Test Loss: 0.845 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.5811543464660645
Epoch: 64, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.836 Vali Acc: 0.756 Test Loss: 0.836 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 65 cost time: 0.5582191944122314
Epoch: 65, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.835 Vali Acc: 0.756 Test Loss: 0.835 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 66 cost time: 0.5903325080871582
Epoch: 66, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.836 Vali Acc: 0.756 Test Loss: 0.836 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6848270893096924
Epoch: 67, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.844 Vali Acc: 0.750 Test Loss: 0.844 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6791508197784424
Epoch: 68, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5577726364135742
Epoch: 69, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5900278091430664
Epoch: 70, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.854 Vali Acc: 0.733 Test Loss: 0.854 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.657231330871582
Epoch: 71, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.842 Vali Acc: 0.739 Test Loss: 0.842 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.6228759288787842
Epoch: 72, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.850 Vali Acc: 0.761 Test Loss: 0.850 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 73 cost time: 0.6206674575805664
Epoch: 73, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.853 Vali Acc: 0.756 Test Loss: 0.853 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.6667459011077881
Epoch: 74, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.854 Vali Acc: 0.744 Test Loss: 0.854 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5674457550048828
Epoch: 75, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.6554338932037354
Epoch: 76, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.851 Vali Acc: 0.739 Test Loss: 0.851 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.610745906829834
Epoch: 77, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.870 Vali Acc: 0.733 Test Loss: 0.870 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.627129077911377
Epoch: 78, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.6479828357696533
Epoch: 79, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.863 Vali Acc: 0.756 Test Loss: 0.863 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.6269130706787109
Epoch: 80, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.851 Vali Acc: 0.756 Test Loss: 0.851 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.6296408176422119
Epoch: 81, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.869 Vali Acc: 0.761 Test Loss: 0.869 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.6643130779266357
Epoch: 82, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 14127
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0443239212036133
Epoch: 1, Steps: 12 | Train Loss: 2.863 Vali Loss: 2.837 Vali Acc: 0.083 Test Loss: 2.837 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 0.6521878242492676
Epoch: 2, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.792 Vali Acc: 0.089 Test Loss: 2.792 Test Acc: 0.089
Validation loss decreased (-0.083305 --> -0.088861).  Saving model ...
Epoch: 3 cost time: 0.6034722328186035
Epoch: 3, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.734 Vali Acc: 0.122 Test Loss: 2.734 Test Acc: 0.122
Validation loss decreased (-0.088861 --> -0.122195).  Saving model ...
Epoch: 4 cost time: 0.5916750431060791
Epoch: 4, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.656 Vali Acc: 0.139 Test Loss: 2.656 Test Acc: 0.139
Validation loss decreased (-0.122195 --> -0.138862).  Saving model ...
Epoch: 5 cost time: 0.5914733409881592
Epoch: 5, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.577 Vali Acc: 0.206 Test Loss: 2.577 Test Acc: 0.206
Validation loss decreased (-0.138862 --> -0.205530).  Saving model ...
Epoch: 6 cost time: 0.6285455226898193
Epoch: 6, Steps: 12 | Train Loss: 2.569 Vali Loss: 2.493 Vali Acc: 0.239 Test Loss: 2.493 Test Acc: 0.239
Validation loss decreased (-0.205530 --> -0.238864).  Saving model ...
Epoch: 7 cost time: 0.6828641891479492
Epoch: 7, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.405 Vali Acc: 0.278 Test Loss: 2.405 Test Acc: 0.278
Validation loss decreased (-0.238864 --> -0.277754).  Saving model ...
Epoch: 8 cost time: 0.636415958404541
Epoch: 8, Steps: 12 | Train Loss: 2.306 Vali Loss: 2.320 Vali Acc: 0.300 Test Loss: 2.320 Test Acc: 0.300
Validation loss decreased (-0.277754 --> -0.299977).  Saving model ...
Epoch: 9 cost time: 0.6052455902099609
Epoch: 9, Steps: 12 | Train Loss: 2.249 Vali Loss: 2.239 Vali Acc: 0.333 Test Loss: 2.239 Test Acc: 0.333
Validation loss decreased (-0.299977 --> -0.333311).  Saving model ...
Epoch: 10 cost time: 0.6165235042572021
Epoch: 10, Steps: 12 | Train Loss: 2.182 Vali Loss: 2.156 Vali Acc: 0.350 Test Loss: 2.156 Test Acc: 0.350
Validation loss decreased (-0.333311 --> -0.349978).  Saving model ...
Epoch: 11 cost time: 0.599926233291626
Epoch: 11, Steps: 12 | Train Loss: 2.053 Vali Loss: 2.074 Vali Acc: 0.383 Test Loss: 2.074 Test Acc: 0.383
Validation loss decreased (-0.349978 --> -0.383313).  Saving model ...
Epoch: 12 cost time: 0.6111674308776855
Epoch: 12, Steps: 12 | Train Loss: 1.980 Vali Loss: 1.998 Vali Acc: 0.411 Test Loss: 1.998 Test Acc: 0.411
Validation loss decreased (-0.383313 --> -0.411091).  Saving model ...
Epoch: 13 cost time: 0.6163828372955322
Epoch: 13, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.919 Vali Acc: 0.428 Test Loss: 1.919 Test Acc: 0.428
Validation loss decreased (-0.411091 --> -0.427759).  Saving model ...
Epoch: 14 cost time: 0.6010475158691406
Epoch: 14, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.847 Vali Acc: 0.461 Test Loss: 1.847 Test Acc: 0.461
Validation loss decreased (-0.427759 --> -0.461093).  Saving model ...
Epoch: 15 cost time: 0.5751960277557373
Epoch: 15, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.782 Vali Acc: 0.461 Test Loss: 1.782 Test Acc: 0.461
Validation loss decreased (-0.461093 --> -0.461093).  Saving model ...
Epoch: 16 cost time: 0.5743072032928467
Epoch: 16, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.724 Vali Acc: 0.489 Test Loss: 1.724 Test Acc: 0.489
Validation loss decreased (-0.461093 --> -0.488872).  Saving model ...
Epoch: 17 cost time: 0.6093392372131348
Epoch: 17, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.670 Vali Acc: 0.500 Test Loss: 1.670 Test Acc: 0.500
Validation loss decreased (-0.488872 --> -0.499983).  Saving model ...
Epoch: 18 cost time: 0.552875280380249
Epoch: 18, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.618 Vali Acc: 0.550 Test Loss: 1.618 Test Acc: 0.550
Validation loss decreased (-0.499983 --> -0.549984).  Saving model ...
Epoch: 19 cost time: 0.6283342838287354
Epoch: 19, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.569 Vali Acc: 0.544 Test Loss: 1.569 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6310908794403076
Epoch: 20, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.518 Vali Acc: 0.561 Test Loss: 1.518 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561096).  Saving model ...
Epoch: 21 cost time: 0.6409802436828613
Epoch: 21, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.474 Vali Acc: 0.578 Test Loss: 1.474 Test Acc: 0.578
Validation loss decreased (-0.561096 --> -0.577763).  Saving model ...
Epoch: 22 cost time: 0.6356203556060791
Epoch: 22, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.427 Vali Acc: 0.572 Test Loss: 1.427 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6518354415893555
Epoch: 23, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.388 Vali Acc: 0.572 Test Loss: 1.388 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6494321823120117
Epoch: 24, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.352 Vali Acc: 0.594 Test Loss: 1.352 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594431).  Saving model ...
Epoch: 25 cost time: 0.6281929016113281
Epoch: 25, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599987).  Saving model ...
Epoch: 26 cost time: 0.5639441013336182
Epoch: 26, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.288 Vali Acc: 0.606 Test Loss: 1.288 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605543).  Saving model ...
Epoch: 27 cost time: 0.6401653289794922
Epoch: 27, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.248 Vali Acc: 0.611 Test Loss: 1.248 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611099).  Saving model ...
Epoch: 28 cost time: 0.6113307476043701
Epoch: 28, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.205 Vali Acc: 0.622 Test Loss: 1.205 Test Acc: 0.622
Validation loss decreased (-0.611099 --> -0.622210).  Saving model ...
Epoch: 29 cost time: 0.6081068515777588
Epoch: 29, Steps: 12 | Train Loss: 0.913 Vali Loss: 1.177 Vali Acc: 0.628 Test Loss: 1.177 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 30 cost time: 0.5880658626556396
Epoch: 30, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.156 Vali Acc: 0.633 Test Loss: 1.156 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633322).  Saving model ...
Epoch: 31 cost time: 0.6004805564880371
Epoch: 31, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.129 Vali Acc: 0.633 Test Loss: 1.129 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 32 cost time: 0.615800142288208
Epoch: 32, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.111 Vali Acc: 0.633 Test Loss: 1.111 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 33 cost time: 0.5981957912445068
Epoch: 33, Steps: 12 | Train Loss: 0.837 Vali Loss: 1.086 Vali Acc: 0.628 Test Loss: 1.086 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5639533996582031
Epoch: 34, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.069 Vali Acc: 0.633 Test Loss: 1.069 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633323).  Saving model ...
Epoch: 35 cost time: 0.589324951171875
Epoch: 35, Steps: 12 | Train Loss: 0.756 Vali Loss: 1.048 Vali Acc: 0.639 Test Loss: 1.048 Test Acc: 0.639
Validation loss decreased (-0.633323 --> -0.638878).  Saving model ...
Epoch: 36 cost time: 0.633781909942627
Epoch: 36, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.026 Vali Acc: 0.644 Test Loss: 1.026 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644434).  Saving model ...
Epoch: 37 cost time: 0.6109201908111572
Epoch: 37, Steps: 12 | Train Loss: 0.751 Vali Loss: 1.007 Vali Acc: 0.639 Test Loss: 1.007 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6371643543243408
Epoch: 38, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.987 Vali Acc: 0.644 Test Loss: 0.987 Test Acc: 0.644
Validation loss decreased (-0.644434 --> -0.644435).  Saving model ...
Epoch: 39 cost time: 0.6129498481750488
Epoch: 39, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.969 Vali Acc: 0.656 Test Loss: 0.969 Test Acc: 0.656
Validation loss decreased (-0.644435 --> -0.655546).  Saving model ...
Epoch: 40 cost time: 0.6217472553253174
Epoch: 40, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.957 Vali Acc: 0.661 Test Loss: 0.957 Test Acc: 0.661
Validation loss decreased (-0.655546 --> -0.661102).  Saving model ...
Epoch: 41 cost time: 0.5995047092437744
Epoch: 41, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.950 Vali Acc: 0.678 Test Loss: 0.950 Test Acc: 0.678
Validation loss decreased (-0.661102 --> -0.677768).  Saving model ...
Epoch: 42 cost time: 0.60249924659729
Epoch: 42, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.944 Vali Acc: 0.689 Test Loss: 0.944 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 43 cost time: 0.6145660877227783
Epoch: 43, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.928 Vali Acc: 0.672 Test Loss: 0.928 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6347157955169678
Epoch: 44, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.912 Vali Acc: 0.683 Test Loss: 0.912 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6134884357452393
Epoch: 45, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.892 Vali Acc: 0.678 Test Loss: 0.892 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6202552318572998
Epoch: 46, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.879 Vali Acc: 0.683 Test Loss: 0.879 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6034905910491943
Epoch: 47, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.895 Vali Acc: 0.672 Test Loss: 0.895 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6142475605010986
Epoch: 48, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.885 Vali Acc: 0.678 Test Loss: 0.885 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6054470539093018
Epoch: 49, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.875 Vali Acc: 0.683 Test Loss: 0.875 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6000564098358154
Epoch: 50, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.863 Vali Acc: 0.683 Test Loss: 0.863 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6189219951629639
Epoch: 51, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.849 Vali Acc: 0.683 Test Loss: 0.849 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6041092872619629
Epoch: 52, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.848 Vali Acc: 0.694 Test Loss: 0.848 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694436).  Saving model ...
Epoch: 53 cost time: 0.6599655151367188
Epoch: 53, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.862 Vali Acc: 0.683 Test Loss: 0.862 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.608656644821167
Epoch: 54, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.854 Vali Acc: 0.689 Test Loss: 0.854 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6464149951934814
Epoch: 55, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.848 Vali Acc: 0.694 Test Loss: 0.848 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6702017784118652
Epoch: 56, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.837 Vali Acc: 0.694 Test Loss: 0.837 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694436).  Saving model ...
Epoch: 57 cost time: 0.574641227722168
Epoch: 57, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.829 Vali Acc: 0.700 Test Loss: 0.829 Test Acc: 0.700
Validation loss decreased (-0.694436 --> -0.699992).  Saving model ...
Epoch: 58 cost time: 0.6478264331817627
Epoch: 58, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.826 Vali Acc: 0.706 Test Loss: 0.826 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705547).  Saving model ...
Epoch: 59 cost time: 0.5962347984313965
Epoch: 59, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.823 Vali Acc: 0.711 Test Loss: 0.823 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
Epoch: 60 cost time: 0.6033329963684082
Epoch: 60, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.604372501373291
Epoch: 61, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.834 Vali Acc: 0.717 Test Loss: 0.834 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716658).  Saving model ...
Epoch: 62 cost time: 0.601799726486206
Epoch: 62, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.828 Vali Acc: 0.711 Test Loss: 0.828 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.586000919342041
Epoch: 63, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.820 Vali Acc: 0.728 Test Loss: 0.820 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 64 cost time: 0.6401796340942383
Epoch: 64, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 65 cost time: 0.5737242698669434
Epoch: 65, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.812 Vali Acc: 0.728 Test Loss: 0.812 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5752835273742676
Epoch: 66, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.818 Vali Acc: 0.728 Test Loss: 0.818 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6084520816802979
Epoch: 67, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.816 Vali Acc: 0.728 Test Loss: 0.816 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.636345624923706
Epoch: 68, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.824 Vali Acc: 0.722 Test Loss: 0.824 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.6301953792572021
Epoch: 69, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.822 Vali Acc: 0.728 Test Loss: 0.822 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.6428611278533936
Epoch: 70, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.818 Vali Acc: 0.717 Test Loss: 0.818 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.6043908596038818
Epoch: 71, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.824 Vali Acc: 0.728 Test Loss: 0.824 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.5978541374206543
Epoch: 72, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.831 Vali Acc: 0.733 Test Loss: 0.831 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733325).  Saving model ...
Epoch: 73 cost time: 0.6003255844116211
Epoch: 73, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.826 Vali Acc: 0.728 Test Loss: 0.826 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5901932716369629
Epoch: 74, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.818 Vali Acc: 0.744 Test Loss: 0.818 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 75 cost time: 0.588153600692749
Epoch: 75, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.822 Vali Acc: 0.722 Test Loss: 0.822 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6478033065795898
Epoch: 76, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.815 Vali Acc: 0.728 Test Loss: 0.815 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.5782778263092041
Epoch: 77, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.837 Vali Acc: 0.722 Test Loss: 0.837 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.6239092350006104
Epoch: 78, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.828 Vali Acc: 0.717 Test Loss: 0.828 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6227538585662842
Epoch: 79, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.822 Vali Acc: 0.733 Test Loss: 0.822 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.56781005859375
Epoch: 80, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.822 Vali Acc: 0.739 Test Loss: 0.822 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.5773589611053467
Epoch: 81, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.831 Vali Acc: 0.733 Test Loss: 0.831 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.6120412349700928
Epoch: 82, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.825 Vali Acc: 0.733 Test Loss: 0.825 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.6658732891082764
Epoch: 83, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.6261131763458252
Epoch: 84, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.837 Vali Acc: 0.733 Test Loss: 0.837 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 13215
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9887309074401855
Epoch: 1, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.716 Vali Acc: 0.117 Test Loss: 2.716 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.615272045135498
Epoch: 2, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.512 Vali Acc: 0.194 Test Loss: 2.512 Test Acc: 0.194
Validation loss decreased (-0.116640 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 0.6515026092529297
Epoch: 3, Steps: 12 | Train Loss: 2.442 Vali Loss: 2.306 Vali Acc: 0.322 Test Loss: 2.306 Test Acc: 0.322
Validation loss decreased (-0.194419 --> -0.322199).  Saving model ...
Epoch: 4 cost time: 0.6478676795959473
Epoch: 4, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.120 Vali Acc: 0.417 Test Loss: 2.120 Test Acc: 0.417
Validation loss decreased (-0.322199 --> -0.416645).  Saving model ...
Epoch: 5 cost time: 0.6947774887084961
Epoch: 5, Steps: 12 | Train Loss: 2.018 Vali Loss: 1.946 Vali Acc: 0.517 Test Loss: 1.946 Test Acc: 0.517
Validation loss decreased (-0.416645 --> -0.516647).  Saving model ...
Epoch: 6 cost time: 0.628363847732544
Epoch: 6, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.780 Vali Acc: 0.517 Test Loss: 1.780 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516649).  Saving model ...
Epoch: 7 cost time: 0.6698858737945557
Epoch: 7, Steps: 12 | Train Loss: 1.574 Vali Loss: 1.657 Vali Acc: 0.567 Test Loss: 1.657 Test Acc: 0.567
Validation loss decreased (-0.516649 --> -0.566650).  Saving model ...
Epoch: 8 cost time: 0.594506025314331
Epoch: 8, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.571 Vali Acc: 0.556 Test Loss: 1.571 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7799263000488281
Epoch: 9, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.468 Vali Acc: 0.583 Test Loss: 1.468 Test Acc: 0.583
Validation loss decreased (-0.566650 --> -0.583319).  Saving model ...
Epoch: 10 cost time: 0.584402322769165
Epoch: 10, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.377 Vali Acc: 0.600 Test Loss: 1.377 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 0.5641939640045166
Epoch: 11, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.331 Vali Acc: 0.594 Test Loss: 1.331 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5758593082427979
Epoch: 12, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.287 Vali Acc: 0.622 Test Loss: 1.287 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 13 cost time: 0.5730621814727783
Epoch: 13, Steps: 12 | Train Loss: 0.973 Vali Loss: 1.253 Vali Acc: 0.628 Test Loss: 1.253 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 14 cost time: 0.6975064277648926
Epoch: 14, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.218 Vali Acc: 0.617 Test Loss: 1.218 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6381027698516846
Epoch: 15, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.188 Vali Acc: 0.633 Test Loss: 1.188 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 0.6371612548828125
Epoch: 16, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.147 Vali Acc: 0.656 Test Loss: 1.147 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 17 cost time: 0.6058962345123291
Epoch: 17, Steps: 12 | Train Loss: 0.687 Vali Loss: 1.118 Vali Acc: 0.661 Test Loss: 1.118 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 18 cost time: 0.6134612560272217
Epoch: 18, Steps: 12 | Train Loss: 0.628 Vali Loss: 1.101 Vali Acc: 0.672 Test Loss: 1.101 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672211).  Saving model ...
Epoch: 19 cost time: 0.6452255249023438
Epoch: 19, Steps: 12 | Train Loss: 0.613 Vali Loss: 1.118 Vali Acc: 0.667 Test Loss: 1.118 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6233270168304443
Epoch: 20, Steps: 12 | Train Loss: 0.575 Vali Loss: 1.071 Vali Acc: 0.689 Test Loss: 1.071 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 21 cost time: 0.6308891773223877
Epoch: 21, Steps: 12 | Train Loss: 0.501 Vali Loss: 1.033 Vali Acc: 0.706 Test Loss: 1.033 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705545).  Saving model ...
Epoch: 22 cost time: 0.6155593395233154
Epoch: 22, Steps: 12 | Train Loss: 0.510 Vali Loss: 1.080 Vali Acc: 0.678 Test Loss: 1.080 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6631765365600586
Epoch: 23, Steps: 12 | Train Loss: 0.425 Vali Loss: 1.037 Vali Acc: 0.722 Test Loss: 1.037 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722212).  Saving model ...
Epoch: 24 cost time: 0.6496610641479492
Epoch: 24, Steps: 12 | Train Loss: 0.406 Vali Loss: 1.018 Vali Acc: 0.733 Test Loss: 1.018 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 25 cost time: 0.6726706027984619
Epoch: 25, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.992 Vali Acc: 0.750 Test Loss: 0.992 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 26 cost time: 0.5460109710693359
Epoch: 26, Steps: 12 | Train Loss: 0.374 Vali Loss: 1.020 Vali Acc: 0.728 Test Loss: 1.020 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5966956615447998
Epoch: 27, Steps: 12 | Train Loss: 0.316 Vali Loss: 1.024 Vali Acc: 0.733 Test Loss: 1.024 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6608290672302246
Epoch: 28, Steps: 12 | Train Loss: 0.295 Vali Loss: 1.050 Vali Acc: 0.733 Test Loss: 1.050 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7019824981689453
Epoch: 29, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5549442768096924
Epoch: 30, Steps: 12 | Train Loss: 0.252 Vali Loss: 1.012 Vali Acc: 0.756 Test Loss: 1.012 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755545).  Saving model ...
Epoch: 31 cost time: 0.626218318939209
Epoch: 31, Steps: 12 | Train Loss: 0.255 Vali Loss: 1.028 Vali Acc: 0.750 Test Loss: 1.028 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7050120830535889
Epoch: 32, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.047 Vali Acc: 0.733 Test Loss: 1.047 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6421937942504883
Epoch: 33, Steps: 12 | Train Loss: 0.202 Vali Loss: 1.061 Vali Acc: 0.739 Test Loss: 1.061 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7772564888000488
Epoch: 34, Steps: 12 | Train Loss: 0.202 Vali Loss: 1.061 Vali Acc: 0.767 Test Loss: 1.061 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766656).  Saving model ...
Epoch: 35 cost time: 0.629551887512207
Epoch: 35, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.076 Vali Acc: 0.739 Test Loss: 1.076 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.686352014541626
Epoch: 36, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.059 Vali Acc: 0.750 Test Loss: 1.059 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6367576122283936
Epoch: 37, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.084 Vali Acc: 0.744 Test Loss: 1.084 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6602342128753662
Epoch: 38, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.135 Vali Acc: 0.739 Test Loss: 1.135 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6355500221252441
Epoch: 39, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.113 Vali Acc: 0.744 Test Loss: 1.113 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7251832485198975
Epoch: 40, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.135 Vali Acc: 0.739 Test Loss: 1.135 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6481692790985107
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.148 Vali Acc: 0.739 Test Loss: 1.148 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.717888593673706
Epoch: 42, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.126 Vali Acc: 0.750 Test Loss: 1.126 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6798007488250732
Epoch: 43, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.155 Vali Acc: 0.722 Test Loss: 1.155 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6939957141876221
Epoch: 44, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.181 Vali Acc: 0.739 Test Loss: 1.181 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 27071
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1305763721466064
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.709 Vali Acc: 0.094 Test Loss: 2.709 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.6710638999938965
Epoch: 2, Steps: 12 | Train Loss: 2.833 Vali Loss: 2.616 Vali Acc: 0.150 Test Loss: 2.616 Test Acc: 0.150
Validation loss decreased (-0.094417 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 0.6673719882965088
Epoch: 3, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.478 Vali Acc: 0.183 Test Loss: 2.478 Test Acc: 0.183
Validation loss decreased (-0.149974 --> -0.183309).  Saving model ...
Epoch: 4 cost time: 0.749626874923706
Epoch: 4, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.329 Vali Acc: 0.244 Test Loss: 2.329 Test Acc: 0.244
Validation loss decreased (-0.183309 --> -0.244421).  Saving model ...
Epoch: 5 cost time: 0.6374099254608154
Epoch: 5, Steps: 12 | Train Loss: 2.319 Vali Loss: 2.178 Vali Acc: 0.378 Test Loss: 2.178 Test Acc: 0.378
Validation loss decreased (-0.244421 --> -0.377756).  Saving model ...
Epoch: 6 cost time: 0.5947744846343994
Epoch: 6, Steps: 12 | Train Loss: 2.177 Vali Loss: 2.035 Vali Acc: 0.461 Test Loss: 2.035 Test Acc: 0.461
Validation loss decreased (-0.377756 --> -0.461091).  Saving model ...
Epoch: 7 cost time: 0.6471142768859863
Epoch: 7, Steps: 12 | Train Loss: 1.965 Vali Loss: 1.908 Vali Acc: 0.522 Test Loss: 1.908 Test Acc: 0.522
Validation loss decreased (-0.461091 --> -0.522203).  Saving model ...
Epoch: 8 cost time: 0.6604130268096924
Epoch: 8, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.793 Vali Acc: 0.528 Test Loss: 1.793 Test Acc: 0.528
Validation loss decreased (-0.522203 --> -0.527760).  Saving model ...
Epoch: 9 cost time: 0.6307895183563232
Epoch: 9, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.685 Vali Acc: 0.561 Test Loss: 1.685 Test Acc: 0.561
Validation loss decreased (-0.527760 --> -0.561094).  Saving model ...
Epoch: 10 cost time: 0.6544957160949707
Epoch: 10, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.587 Vali Acc: 0.583 Test Loss: 1.587 Test Acc: 0.583
Validation loss decreased (-0.561094 --> -0.583317).  Saving model ...
Epoch: 11 cost time: 0.6685764789581299
Epoch: 11, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.529 Vali Acc: 0.578 Test Loss: 1.529 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6662676334381104
Epoch: 12, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.471 Vali Acc: 0.600 Test Loss: 1.471 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599985).  Saving model ...
Epoch: 13 cost time: 0.6542181968688965
Epoch: 13, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.408 Vali Acc: 0.600 Test Loss: 1.408 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599986).  Saving model ...
Epoch: 14 cost time: 0.6419732570648193
Epoch: 14, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.370 Vali Acc: 0.594 Test Loss: 1.370 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.515068531036377
Epoch: 15, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.335 Vali Acc: 0.606 Test Loss: 1.335 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 0.6466286182403564
Epoch: 16, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.306 Vali Acc: 0.622 Test Loss: 1.306 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 17 cost time: 0.683234453201294
Epoch: 17, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.278 Vali Acc: 0.617 Test Loss: 1.278 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6992490291595459
Epoch: 18, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.255 Vali Acc: 0.622 Test Loss: 1.255 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 19 cost time: 0.6121485233306885
Epoch: 19, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.229 Vali Acc: 0.639 Test Loss: 1.229 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638877).  Saving model ...
Epoch: 20 cost time: 0.6881115436553955
Epoch: 20, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.220 Vali Acc: 0.628 Test Loss: 1.220 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6981213092803955
Epoch: 21, Steps: 12 | Train Loss: 0.732 Vali Loss: 1.190 Vali Acc: 0.656 Test Loss: 1.190 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 22 cost time: 0.7365176677703857
Epoch: 22, Steps: 12 | Train Loss: 0.679 Vali Loss: 1.168 Vali Acc: 0.661 Test Loss: 1.168 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661099).  Saving model ...
Epoch: 23 cost time: 0.73421311378479
Epoch: 23, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.142 Vali Acc: 0.656 Test Loss: 1.142 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6338458061218262
Epoch: 24, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.123 Vali Acc: 0.644 Test Loss: 1.123 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7000072002410889
Epoch: 25, Steps: 12 | Train Loss: 0.560 Vali Loss: 1.103 Vali Acc: 0.667 Test Loss: 1.103 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666656).  Saving model ...
Epoch: 26 cost time: 0.7022218704223633
Epoch: 26, Steps: 12 | Train Loss: 0.546 Vali Loss: 1.077 Vali Acc: 0.678 Test Loss: 1.077 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 27 cost time: 0.6817519664764404
Epoch: 27, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.056 Vali Acc: 0.672 Test Loss: 1.056 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.696544885635376
Epoch: 28, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.060 Vali Acc: 0.667 Test Loss: 1.060 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6698458194732666
Epoch: 29, Steps: 12 | Train Loss: 0.486 Vali Loss: 1.048 Vali Acc: 0.672 Test Loss: 1.048 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6898214817047119
Epoch: 30, Steps: 12 | Train Loss: 0.431 Vali Loss: 1.037 Vali Acc: 0.678 Test Loss: 1.037 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 31 cost time: 0.6320059299468994
Epoch: 31, Steps: 12 | Train Loss: 0.391 Vali Loss: 1.019 Vali Acc: 0.700 Test Loss: 1.019 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.6966474056243896
Epoch: 32, Steps: 12 | Train Loss: 0.394 Vali Loss: 1.012 Vali Acc: 0.722 Test Loss: 1.012 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722212).  Saving model ...
Epoch: 33 cost time: 0.7045161724090576
Epoch: 33, Steps: 12 | Train Loss: 0.358 Vali Loss: 1.008 Vali Acc: 0.694 Test Loss: 1.008 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7126741409301758
Epoch: 34, Steps: 12 | Train Loss: 0.356 Vali Loss: 1.004 Vali Acc: 0.711 Test Loss: 1.004 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7105419635772705
Epoch: 35, Steps: 12 | Train Loss: 0.313 Vali Loss: 1.007 Vali Acc: 0.711 Test Loss: 1.007 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7181062698364258
Epoch: 36, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.999 Vali Acc: 0.728 Test Loss: 0.999 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 37 cost time: 0.6860921382904053
Epoch: 37, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.992 Vali Acc: 0.717 Test Loss: 0.992 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7281899452209473
Epoch: 38, Steps: 12 | Train Loss: 0.308 Vali Loss: 1.006 Vali Acc: 0.728 Test Loss: 1.006 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7102851867675781
Epoch: 39, Steps: 12 | Train Loss: 0.256 Vali Loss: 1.004 Vali Acc: 0.717 Test Loss: 1.004 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7317168712615967
Epoch: 40, Steps: 12 | Train Loss: 0.264 Vali Loss: 1.004 Vali Acc: 0.711 Test Loss: 1.004 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7089071273803711
Epoch: 41, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.004 Vali Acc: 0.733 Test Loss: 1.004 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733323).  Saving model ...
Epoch: 42 cost time: 0.7679088115692139
Epoch: 42, Steps: 12 | Train Loss: 0.232 Vali Loss: 1.000 Vali Acc: 0.744 Test Loss: 1.000 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744434).  Saving model ...
Epoch: 43 cost time: 0.7229459285736084
Epoch: 43, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.999 Vali Acc: 0.722 Test Loss: 0.999 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6803820133209229
Epoch: 44, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.004 Vali Acc: 0.722 Test Loss: 1.004 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7765381336212158
Epoch: 45, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.998 Vali Acc: 0.728 Test Loss: 0.998 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6153669357299805
Epoch: 46, Steps: 12 | Train Loss: 0.206 Vali Loss: 1.010 Vali Acc: 0.728 Test Loss: 1.010 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7456376552581787
Epoch: 47, Steps: 12 | Train Loss: 0.202 Vali Loss: 1.018 Vali Acc: 0.744 Test Loss: 1.018 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6333639621734619
Epoch: 48, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.024 Vali Acc: 0.733 Test Loss: 1.024 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6886789798736572
Epoch: 49, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.050 Vali Acc: 0.728 Test Loss: 1.050 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7370567321777344
Epoch: 50, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.046 Vali Acc: 0.728 Test Loss: 1.046 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6752822399139404
Epoch: 51, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.049 Vali Acc: 0.744 Test Loss: 1.049 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7290112972259521
Epoch: 52, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.035 Vali Acc: 0.728 Test Loss: 1.035 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 16527
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9916353225708008
Epoch: 1, Steps: 12 | Train Loss: 2.867 Vali Loss: 2.722 Vali Acc: 0.083 Test Loss: 2.722 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.6598529815673828
Epoch: 2, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.626 Vali Acc: 0.167 Test Loss: 2.626 Test Acc: 0.167
Validation loss decreased (-0.083306 --> -0.166640).  Saving model ...
Epoch: 3 cost time: 0.6239681243896484
Epoch: 3, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.510 Vali Acc: 0.289 Test Loss: 2.510 Test Acc: 0.289
Validation loss decreased (-0.166640 --> -0.288864).  Saving model ...
Epoch: 4 cost time: 0.6480753421783447
Epoch: 4, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.379 Vali Acc: 0.361 Test Loss: 2.379 Test Acc: 0.361
Validation loss decreased (-0.288864 --> -0.361087).  Saving model ...
Epoch: 5 cost time: 0.6513721942901611
Epoch: 5, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.252 Vali Acc: 0.394 Test Loss: 2.252 Test Acc: 0.394
Validation loss decreased (-0.361087 --> -0.394422).  Saving model ...
Epoch: 6 cost time: 0.6742031574249268
Epoch: 6, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.125 Vali Acc: 0.389 Test Loss: 2.125 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6506855487823486
Epoch: 7, Steps: 12 | Train Loss: 2.093 Vali Loss: 2.000 Vali Acc: 0.433 Test Loss: 2.000 Test Acc: 0.433
Validation loss decreased (-0.394422 --> -0.433313).  Saving model ...
Epoch: 8 cost time: 0.6713933944702148
Epoch: 8, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.880 Vali Acc: 0.483 Test Loss: 1.880 Test Acc: 0.483
Validation loss decreased (-0.433313 --> -0.483315).  Saving model ...
Epoch: 9 cost time: 0.6569216251373291
Epoch: 9, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.786 Vali Acc: 0.494 Test Loss: 1.786 Test Acc: 0.494
Validation loss decreased (-0.483315 --> -0.494427).  Saving model ...
Epoch: 10 cost time: 0.6548440456390381
Epoch: 10, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.695 Vali Acc: 0.528 Test Loss: 1.695 Test Acc: 0.528
Validation loss decreased (-0.494427 --> -0.527761).  Saving model ...
Epoch: 11 cost time: 0.7145504951477051
Epoch: 11, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.617 Vali Acc: 0.567 Test Loss: 1.617 Test Acc: 0.567
Validation loss decreased (-0.527761 --> -0.566650).  Saving model ...
Epoch: 12 cost time: 0.654935359954834
Epoch: 12, Steps: 12 | Train Loss: 1.434 Vali Loss: 1.543 Vali Acc: 0.578 Test Loss: 1.543 Test Acc: 0.578
Validation loss decreased (-0.566650 --> -0.577762).  Saving model ...
Epoch: 13 cost time: 0.653914213180542
Epoch: 13, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.472 Vali Acc: 0.600 Test Loss: 1.472 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599985).  Saving model ...
Epoch: 14 cost time: 0.6391105651855469
Epoch: 14, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.433 Vali Acc: 0.617 Test Loss: 1.433 Test Acc: 0.617
Validation loss decreased (-0.599985 --> -0.616652).  Saving model ...
Epoch: 15 cost time: 0.6789278984069824
Epoch: 15, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.389 Vali Acc: 0.617 Test Loss: 1.389 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616653).  Saving model ...
Epoch: 16 cost time: 0.6417577266693115
Epoch: 16, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.347 Vali Acc: 0.611 Test Loss: 1.347 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.699976921081543
Epoch: 17, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.303 Vali Acc: 0.644 Test Loss: 1.303 Test Acc: 0.644
Validation loss decreased (-0.616653 --> -0.644431).  Saving model ...
Epoch: 18 cost time: 0.638113260269165
Epoch: 18, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.267 Vali Acc: 0.661 Test Loss: 1.267 Test Acc: 0.661
Validation loss decreased (-0.644431 --> -0.661098).  Saving model ...
Epoch: 19 cost time: 0.6394057273864746
Epoch: 19, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.242 Vali Acc: 0.650 Test Loss: 1.242 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6722025871276855
Epoch: 20, Steps: 12 | Train Loss: 0.894 Vali Loss: 1.225 Vali Acc: 0.661 Test Loss: 1.225 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661099).  Saving model ...
Epoch: 21 cost time: 0.6424000263214111
Epoch: 21, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.188 Vali Acc: 0.672 Test Loss: 1.188 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672210).  Saving model ...
Epoch: 22 cost time: 0.6281180381774902
Epoch: 22, Steps: 12 | Train Loss: 0.748 Vali Loss: 1.171 Vali Acc: 0.667 Test Loss: 1.171 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6486866474151611
Epoch: 23, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.159 Vali Acc: 0.672 Test Loss: 1.159 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 24 cost time: 0.7355036735534668
Epoch: 24, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.125 Vali Acc: 0.667 Test Loss: 1.125 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6643412113189697
Epoch: 25, Steps: 12 | Train Loss: 0.582 Vali Loss: 1.085 Vali Acc: 0.672 Test Loss: 1.085 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 26 cost time: 0.630364179611206
Epoch: 26, Steps: 12 | Train Loss: 0.580 Vali Loss: 1.070 Vali Acc: 0.678 Test Loss: 1.070 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 27 cost time: 0.6663463115692139
Epoch: 27, Steps: 12 | Train Loss: 0.565 Vali Loss: 1.044 Vali Acc: 0.683 Test Loss: 1.044 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 28 cost time: 0.7273144721984863
Epoch: 28, Steps: 12 | Train Loss: 0.462 Vali Loss: 1.031 Vali Acc: 0.672 Test Loss: 1.031 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6547009944915771
Epoch: 29, Steps: 12 | Train Loss: 0.531 Vali Loss: 1.014 Vali Acc: 0.678 Test Loss: 1.014 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6822443008422852
Epoch: 30, Steps: 12 | Train Loss: 0.478 Vali Loss: 1.009 Vali Acc: 0.683 Test Loss: 1.009 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 31 cost time: 0.7182865142822266
Epoch: 31, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.986 Vali Acc: 0.728 Test Loss: 0.986 Test Acc: 0.728
Validation loss decreased (-0.683323 --> -0.727768).  Saving model ...
Epoch: 32 cost time: 0.700493574142456
Epoch: 32, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.974 Vali Acc: 0.706 Test Loss: 0.974 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6893203258514404
Epoch: 33, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.962 Vali Acc: 0.717 Test Loss: 0.962 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6938655376434326
Epoch: 34, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.950 Vali Acc: 0.717 Test Loss: 0.950 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6416375637054443
Epoch: 35, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.958 Vali Acc: 0.722 Test Loss: 0.958 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6822035312652588
Epoch: 36, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.949 Vali Acc: 0.728 Test Loss: 0.949 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 37 cost time: 0.645305871963501
Epoch: 37, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.954 Vali Acc: 0.722 Test Loss: 0.954 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6949448585510254
Epoch: 38, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.949 Vali Acc: 0.717 Test Loss: 0.949 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6835873126983643
Epoch: 39, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.935 Vali Acc: 0.739 Test Loss: 0.935 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738880).  Saving model ...
Epoch: 40 cost time: 0.6247107982635498
Epoch: 40, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.951 Vali Acc: 0.728 Test Loss: 0.951 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.679945707321167
Epoch: 41, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.958 Vali Acc: 0.728 Test Loss: 0.958 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6859884262084961
Epoch: 42, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.957 Vali Acc: 0.756 Test Loss: 0.957 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755546).  Saving model ...
Epoch: 43 cost time: 0.681494951248169
Epoch: 43, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.663625955581665
Epoch: 44, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.975 Vali Acc: 0.756 Test Loss: 0.975 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.670647144317627
Epoch: 45, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6469628810882568
Epoch: 46, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6646854877471924
Epoch: 47, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.981 Vali Acc: 0.744 Test Loss: 0.981 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6612179279327393
Epoch: 48, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.977 Vali Acc: 0.756 Test Loss: 0.977 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7115786075592041
Epoch: 49, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6559271812438965
Epoch: 50, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.999 Vali Acc: 0.744 Test Loss: 0.999 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6438062191009521
Epoch: 51, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.998 Vali Acc: 0.750 Test Loss: 0.998 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6886706352233887
Epoch: 52, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.013 Vali Acc: 0.744 Test Loss: 1.013 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 16063
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0701792240142822
Epoch: 1, Steps: 12 | Train Loss: 2.875 Vali Loss: 2.777 Vali Acc: 0.067 Test Loss: 2.777 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.6986041069030762
Epoch: 2, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.685 Vali Acc: 0.067 Test Loss: 2.685 Test Acc: 0.067
Validation loss decreased (-0.066639 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 0.7089083194732666
Epoch: 3, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.568 Vali Acc: 0.089 Test Loss: 2.568 Test Acc: 0.089
Validation loss decreased (-0.066640 --> -0.088863).  Saving model ...
Epoch: 4 cost time: 0.6531808376312256
Epoch: 4, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.439 Vali Acc: 0.172 Test Loss: 2.439 Test Acc: 0.172
Validation loss decreased (-0.088863 --> -0.172198).  Saving model ...
Epoch: 5 cost time: 0.6956887245178223
Epoch: 5, Steps: 12 | Train Loss: 2.376 Vali Loss: 2.307 Vali Acc: 0.256 Test Loss: 2.307 Test Acc: 0.256
Validation loss decreased (-0.172198 --> -0.255532).  Saving model ...
Epoch: 6 cost time: 0.7084352970123291
Epoch: 6, Steps: 12 | Train Loss: 2.275 Vali Loss: 2.174 Vali Acc: 0.317 Test Loss: 2.174 Test Acc: 0.317
Validation loss decreased (-0.255532 --> -0.316645).  Saving model ...
Epoch: 7 cost time: 0.7395269870758057
Epoch: 7, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.048 Vali Acc: 0.383 Test Loss: 2.048 Test Acc: 0.383
Validation loss decreased (-0.316645 --> -0.383313).  Saving model ...
Epoch: 8 cost time: 0.639578104019165
Epoch: 8, Steps: 12 | Train Loss: 1.925 Vali Loss: 1.939 Vali Acc: 0.444 Test Loss: 1.939 Test Acc: 0.444
Validation loss decreased (-0.383313 --> -0.444425).  Saving model ...
Epoch: 9 cost time: 0.6672916412353516
Epoch: 9, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.838 Vali Acc: 0.478 Test Loss: 1.838 Test Acc: 0.478
Validation loss decreased (-0.444425 --> -0.477759).  Saving model ...
Epoch: 10 cost time: 0.6942276954650879
Epoch: 10, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.751 Vali Acc: 0.533 Test Loss: 1.751 Test Acc: 0.533
Validation loss decreased (-0.477759 --> -0.533316).  Saving model ...
Epoch: 11 cost time: 0.7563550472259521
Epoch: 11, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.675 Vali Acc: 0.556 Test Loss: 1.675 Test Acc: 0.556
Validation loss decreased (-0.533316 --> -0.555539).  Saving model ...
Epoch: 12 cost time: 0.696925163269043
Epoch: 12, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.607 Vali Acc: 0.556 Test Loss: 1.607 Test Acc: 0.556
Validation loss decreased (-0.555539 --> -0.555539).  Saving model ...
Epoch: 13 cost time: 0.684180736541748
Epoch: 13, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.559 Vali Acc: 0.561 Test Loss: 1.559 Test Acc: 0.561
Validation loss decreased (-0.555539 --> -0.561096).  Saving model ...
Epoch: 14 cost time: 0.6922299861907959
Epoch: 14, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.495 Vali Acc: 0.550 Test Loss: 1.495 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7195489406585693
Epoch: 15, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.455 Vali Acc: 0.567 Test Loss: 1.455 Test Acc: 0.567
Validation loss decreased (-0.561096 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 0.6665940284729004
Epoch: 16, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.416 Vali Acc: 0.572 Test Loss: 1.416 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 17 cost time: 0.7229721546173096
Epoch: 17, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.390 Vali Acc: 0.583 Test Loss: 1.390 Test Acc: 0.583
Validation loss decreased (-0.572208 --> -0.583319).  Saving model ...
Epoch: 18 cost time: 0.6639237403869629
Epoch: 18, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.366 Vali Acc: 0.606 Test Loss: 1.366 Test Acc: 0.606
Validation loss decreased (-0.583319 --> -0.605542).  Saving model ...
Epoch: 19 cost time: 0.6481533050537109
Epoch: 19, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.336 Vali Acc: 0.622 Test Loss: 1.336 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622209).  Saving model ...
Epoch: 20 cost time: 0.7099719047546387
Epoch: 20, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.314 Vali Acc: 0.622 Test Loss: 1.314 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622209).  Saving model ...
Epoch: 21 cost time: 0.7380795478820801
Epoch: 21, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.282 Vali Acc: 0.633 Test Loss: 1.282 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 22 cost time: 0.7111532688140869
Epoch: 22, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.253 Vali Acc: 0.650 Test Loss: 1.253 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649987).  Saving model ...
Epoch: 23 cost time: 0.6423230171203613
Epoch: 23, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.251 Vali Acc: 0.650 Test Loss: 1.251 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 24 cost time: 0.5888545513153076
Epoch: 24, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.235 Vali Acc: 0.661 Test Loss: 1.235 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661099).  Saving model ...
Epoch: 25 cost time: 0.6366763114929199
Epoch: 25, Steps: 12 | Train Loss: 0.784 Vali Loss: 1.208 Vali Acc: 0.667 Test Loss: 1.208 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 26 cost time: 0.6554882526397705
Epoch: 26, Steps: 12 | Train Loss: 0.753 Vali Loss: 1.188 Vali Acc: 0.672 Test Loss: 1.188 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672210).  Saving model ...
Epoch: 27 cost time: 0.7010147571563721
Epoch: 27, Steps: 12 | Train Loss: 0.696 Vali Loss: 1.195 Vali Acc: 0.672 Test Loss: 1.195 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6533544063568115
Epoch: 28, Steps: 12 | Train Loss: 0.651 Vali Loss: 1.163 Vali Acc: 0.661 Test Loss: 1.163 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6685209274291992
Epoch: 29, Steps: 12 | Train Loss: 0.642 Vali Loss: 1.139 Vali Acc: 0.683 Test Loss: 1.139 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 30 cost time: 0.6468212604522705
Epoch: 30, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.116 Vali Acc: 0.694 Test Loss: 1.116 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694433).  Saving model ...
Epoch: 31 cost time: 0.7074768543243408
Epoch: 31, Steps: 12 | Train Loss: 0.585 Vali Loss: 1.115 Vali Acc: 0.689 Test Loss: 1.115 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6943197250366211
Epoch: 32, Steps: 12 | Train Loss: 0.591 Vali Loss: 1.101 Vali Acc: 0.694 Test Loss: 1.101 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694433).  Saving model ...
Epoch: 33 cost time: 0.6437335014343262
Epoch: 33, Steps: 12 | Train Loss: 0.544 Vali Loss: 1.091 Vali Acc: 0.689 Test Loss: 1.091 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.654242992401123
Epoch: 34, Steps: 12 | Train Loss: 0.549 Vali Loss: 1.097 Vali Acc: 0.689 Test Loss: 1.097 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6469516754150391
Epoch: 35, Steps: 12 | Train Loss: 0.497 Vali Loss: 1.066 Vali Acc: 0.689 Test Loss: 1.066 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6251220703125
Epoch: 36, Steps: 12 | Train Loss: 0.517 Vali Loss: 1.043 Vali Acc: 0.706 Test Loss: 1.043 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705545).  Saving model ...
Epoch: 37 cost time: 0.6329967975616455
Epoch: 37, Steps: 12 | Train Loss: 0.438 Vali Loss: 1.035 Vali Acc: 0.706 Test Loss: 1.035 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705545).  Saving model ...
Epoch: 38 cost time: 0.650625467300415
Epoch: 38, Steps: 12 | Train Loss: 0.424 Vali Loss: 1.033 Vali Acc: 0.706 Test Loss: 1.033 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705545).  Saving model ...
Epoch: 39 cost time: 0.6648738384246826
Epoch: 39, Steps: 12 | Train Loss: 0.423 Vali Loss: 1.023 Vali Acc: 0.689 Test Loss: 1.023 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6535096168518066
Epoch: 40, Steps: 12 | Train Loss: 0.395 Vali Loss: 1.015 Vali Acc: 0.706 Test Loss: 1.015 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705545).  Saving model ...
Epoch: 41 cost time: 0.6531407833099365
Epoch: 41, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.996 Vali Acc: 0.717 Test Loss: 0.996 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 42 cost time: 0.6809256076812744
Epoch: 42, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722212).  Saving model ...
Epoch: 43 cost time: 0.6628494262695312
Epoch: 43, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.999 Vali Acc: 0.717 Test Loss: 0.999 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6786739826202393
Epoch: 44, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.988 Vali Acc: 0.722 Test Loss: 0.988 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6368944644927979
Epoch: 45, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.965 Vali Acc: 0.728 Test Loss: 0.965 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 46 cost time: 0.6708784103393555
Epoch: 46, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.956 Vali Acc: 0.739 Test Loss: 0.956 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 47 cost time: 0.645801305770874
Epoch: 47, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.940 Vali Acc: 0.744 Test Loss: 0.940 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 48 cost time: 0.6812224388122559
Epoch: 48, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.937 Vali Acc: 0.756 Test Loss: 0.937 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 49 cost time: 0.6359889507293701
Epoch: 49, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7412047386169434
Epoch: 50, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.939 Vali Acc: 0.744 Test Loss: 0.939 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6418354511260986
Epoch: 51, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6825885772705078
Epoch: 52, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.946 Vali Acc: 0.761 Test Loss: 0.946 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 53 cost time: 0.6886091232299805
Epoch: 53, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.944 Vali Acc: 0.756 Test Loss: 0.944 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6757092475891113
Epoch: 54, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.936 Vali Acc: 0.761 Test Loss: 0.936 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 55 cost time: 0.6215100288391113
Epoch: 55, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.936 Vali Acc: 0.756 Test Loss: 0.936 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6168723106384277
Epoch: 56, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.942 Vali Acc: 0.767 Test Loss: 0.942 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766657).  Saving model ...
Epoch: 57 cost time: 0.6370701789855957
Epoch: 57, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.954 Vali Acc: 0.761 Test Loss: 0.954 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6775891780853271
Epoch: 58, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.954 Vali Acc: 0.756 Test Loss: 0.954 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6629209518432617
Epoch: 59, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.6967437267303467
Epoch: 60, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.6503682136535645
Epoch: 61, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.965 Vali Acc: 0.756 Test Loss: 0.965 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.7211620807647705
Epoch: 62, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.959 Vali Acc: 0.756 Test Loss: 0.959 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.6942989826202393
Epoch: 63, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.969 Vali Acc: 0.761 Test Loss: 0.969 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.7068262100219727
Epoch: 64, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.966 Vali Acc: 0.767 Test Loss: 0.966 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.6543393135070801
Epoch: 65, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.991 Vali Acc: 0.756 Test Loss: 0.991 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.656400203704834
Epoch: 66, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.986 Vali Acc: 0.761 Test Loss: 0.986 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 12719
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0613222122192383
Epoch: 1, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.768 Vali Acc: 0.067 Test Loss: 2.768 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.679241418838501
Epoch: 2, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.708 Vali Acc: 0.089 Test Loss: 2.708 Test Acc: 0.089
Validation loss decreased (-0.066639 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 0.6947686672210693
Epoch: 3, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.620 Vali Acc: 0.106 Test Loss: 2.620 Test Acc: 0.106
Validation loss decreased (-0.088862 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 0.5851528644561768
Epoch: 4, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.519 Vali Acc: 0.144 Test Loss: 2.519 Test Acc: 0.144
Validation loss decreased (-0.105529 --> -0.144419).  Saving model ...
Epoch: 5 cost time: 0.6702418327331543
Epoch: 5, Steps: 12 | Train Loss: 2.526 Vali Loss: 2.413 Vali Acc: 0.194 Test Loss: 2.413 Test Acc: 0.194
Validation loss decreased (-0.144419 --> -0.194420).  Saving model ...
Epoch: 6 cost time: 0.6510767936706543
Epoch: 6, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.299 Vali Acc: 0.228 Test Loss: 2.299 Test Acc: 0.228
Validation loss decreased (-0.194420 --> -0.227755).  Saving model ...
Epoch: 7 cost time: 0.6774792671203613
Epoch: 7, Steps: 12 | Train Loss: 2.288 Vali Loss: 2.191 Vali Acc: 0.300 Test Loss: 2.191 Test Acc: 0.300
Validation loss decreased (-0.227755 --> -0.299978).  Saving model ...
Epoch: 8 cost time: 0.6450483798980713
Epoch: 8, Steps: 12 | Train Loss: 2.165 Vali Loss: 2.092 Vali Acc: 0.372 Test Loss: 2.092 Test Acc: 0.372
Validation loss decreased (-0.299978 --> -0.372201).  Saving model ...
Epoch: 9 cost time: 0.7171363830566406
Epoch: 9, Steps: 12 | Train Loss: 2.013 Vali Loss: 2.004 Vali Acc: 0.444 Test Loss: 2.004 Test Acc: 0.444
Validation loss decreased (-0.372201 --> -0.444424).  Saving model ...
Epoch: 10 cost time: 0.6292891502380371
Epoch: 10, Steps: 12 | Train Loss: 1.915 Vali Loss: 1.919 Vali Acc: 0.472 Test Loss: 1.919 Test Acc: 0.472
Validation loss decreased (-0.444424 --> -0.472203).  Saving model ...
Epoch: 11 cost time: 0.639777660369873
Epoch: 11, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.844 Vali Acc: 0.506 Test Loss: 1.844 Test Acc: 0.506
Validation loss decreased (-0.472203 --> -0.505537).  Saving model ...
Epoch: 12 cost time: 0.6753420829772949
Epoch: 12, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.776 Vali Acc: 0.506 Test Loss: 1.776 Test Acc: 0.506
Validation loss decreased (-0.505537 --> -0.505538).  Saving model ...
Epoch: 13 cost time: 0.6692838668823242
Epoch: 13, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.714 Vali Acc: 0.528 Test Loss: 1.714 Test Acc: 0.528
Validation loss decreased (-0.505538 --> -0.527761).  Saving model ...
Epoch: 14 cost time: 0.6598644256591797
Epoch: 14, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.655 Vali Acc: 0.556 Test Loss: 1.655 Test Acc: 0.556
Validation loss decreased (-0.527761 --> -0.555539).  Saving model ...
Epoch: 15 cost time: 0.6922049522399902
Epoch: 15, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.609 Vali Acc: 0.572 Test Loss: 1.609 Test Acc: 0.572
Validation loss decreased (-0.555539 --> -0.572206).  Saving model ...
Epoch: 16 cost time: 0.623082160949707
Epoch: 16, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.565 Vali Acc: 0.600 Test Loss: 1.565 Test Acc: 0.600
Validation loss decreased (-0.572206 --> -0.599984).  Saving model ...
Epoch: 17 cost time: 0.6714532375335693
Epoch: 17, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.528 Vali Acc: 0.589 Test Loss: 1.528 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6856486797332764
Epoch: 18, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.484 Vali Acc: 0.622 Test Loss: 1.484 Test Acc: 0.622
Validation loss decreased (-0.599984 --> -0.622207).  Saving model ...
Epoch: 19 cost time: 0.7108111381530762
Epoch: 19, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.458 Vali Acc: 0.606 Test Loss: 1.458 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6063356399536133
Epoch: 20, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.430 Vali Acc: 0.622 Test Loss: 1.430 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622208).  Saving model ...
Epoch: 21 cost time: 0.6884419918060303
Epoch: 21, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.397 Vali Acc: 0.617 Test Loss: 1.397 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6795024871826172
Epoch: 22, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.366 Vali Acc: 0.628 Test Loss: 1.366 Test Acc: 0.628
Validation loss decreased (-0.622208 --> -0.627764).  Saving model ...
Epoch: 23 cost time: 0.6202859878540039
Epoch: 23, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.339 Vali Acc: 0.639 Test Loss: 1.339 Test Acc: 0.639
Validation loss decreased (-0.627764 --> -0.638875).  Saving model ...
Epoch: 24 cost time: 0.6909396648406982
Epoch: 24, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.321 Vali Acc: 0.650 Test Loss: 1.321 Test Acc: 0.650
Validation loss decreased (-0.638875 --> -0.649987).  Saving model ...
Epoch: 25 cost time: 0.7448606491088867
Epoch: 25, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.295 Vali Acc: 0.661 Test Loss: 1.295 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661098).  Saving model ...
Epoch: 26 cost time: 0.6465606689453125
Epoch: 26, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.281 Vali Acc: 0.644 Test Loss: 1.281 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.770855188369751
Epoch: 27, Steps: 12 | Train Loss: 0.838 Vali Loss: 1.263 Vali Acc: 0.661 Test Loss: 1.263 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 28 cost time: 0.6950032711029053
Epoch: 28, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.244 Vali Acc: 0.672 Test Loss: 1.244 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672210).  Saving model ...
Epoch: 29 cost time: 0.6944072246551514
Epoch: 29, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.225 Vali Acc: 0.661 Test Loss: 1.225 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6593666076660156
Epoch: 30, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.210 Vali Acc: 0.672 Test Loss: 1.210 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672210).  Saving model ...
Epoch: 31 cost time: 0.6695435047149658
Epoch: 31, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.198 Vali Acc: 0.672 Test Loss: 1.198 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672210).  Saving model ...
Epoch: 32 cost time: 0.7449142932891846
Epoch: 32, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.175 Vali Acc: 0.667 Test Loss: 1.175 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7761545181274414
Epoch: 33, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.159 Vali Acc: 0.683 Test Loss: 1.159 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 34 cost time: 0.7282094955444336
Epoch: 34, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.137 Vali Acc: 0.672 Test Loss: 1.137 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6855607032775879
Epoch: 35, Steps: 12 | Train Loss: 0.625 Vali Loss: 1.123 Vali Acc: 0.683 Test Loss: 1.123 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 36 cost time: 0.7855305671691895
Epoch: 36, Steps: 12 | Train Loss: 0.590 Vali Loss: 1.117 Vali Acc: 0.661 Test Loss: 1.117 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7476284503936768
Epoch: 37, Steps: 12 | Train Loss: 0.548 Vali Loss: 1.102 Vali Acc: 0.672 Test Loss: 1.102 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6868124008178711
Epoch: 38, Steps: 12 | Train Loss: 0.570 Vali Loss: 1.088 Vali Acc: 0.667 Test Loss: 1.088 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7492036819458008
Epoch: 39, Steps: 12 | Train Loss: 0.532 Vali Loss: 1.067 Vali Acc: 0.678 Test Loss: 1.067 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7074120044708252
Epoch: 40, Steps: 12 | Train Loss: 0.530 Vali Loss: 1.051 Vali Acc: 0.678 Test Loss: 1.051 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6758081912994385
Epoch: 41, Steps: 12 | Train Loss: 0.499 Vali Loss: 1.038 Vali Acc: 0.689 Test Loss: 1.038 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688879).  Saving model ...
Epoch: 42 cost time: 0.6890251636505127
Epoch: 42, Steps: 12 | Train Loss: 0.497 Vali Loss: 1.029 Vali Acc: 0.689 Test Loss: 1.029 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 43 cost time: 0.7060770988464355
Epoch: 43, Steps: 12 | Train Loss: 0.438 Vali Loss: 1.037 Vali Acc: 0.694 Test Loss: 1.037 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694434).  Saving model ...
Epoch: 44 cost time: 0.6598293781280518
Epoch: 44, Steps: 12 | Train Loss: 0.468 Vali Loss: 1.016 Vali Acc: 0.689 Test Loss: 1.016 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.709205150604248
Epoch: 45, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.997 Vali Acc: 0.683 Test Loss: 0.997 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7367715835571289
Epoch: 46, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.996 Vali Acc: 0.683 Test Loss: 0.996 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7636106014251709
Epoch: 47, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 48 cost time: 0.7274167537689209
Epoch: 48, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.987 Vali Acc: 0.722 Test Loss: 0.987 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722212).  Saving model ...
Epoch: 49 cost time: 0.7123987674713135
Epoch: 49, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.967 Vali Acc: 0.728 Test Loss: 0.967 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 50 cost time: 0.7008254528045654
Epoch: 50, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.957 Vali Acc: 0.739 Test Loss: 0.957 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 51 cost time: 0.7155358791351318
Epoch: 51, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749990).  Saving model ...
Epoch: 52 cost time: 0.6998744010925293
Epoch: 52, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.965 Vali Acc: 0.728 Test Loss: 0.965 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7116396427154541
Epoch: 53, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.967 Vali Acc: 0.739 Test Loss: 0.967 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7309668064117432
Epoch: 54, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.947 Vali Acc: 0.744 Test Loss: 0.947 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7134745121002197
Epoch: 55, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.944 Vali Acc: 0.733 Test Loss: 0.944 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.7627627849578857
Epoch: 56, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.7239785194396973
Epoch: 57, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.941 Vali Acc: 0.750 Test Loss: 0.941 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 58 cost time: 0.7265963554382324
Epoch: 58, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.941 Vali Acc: 0.756 Test Loss: 0.941 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755546).  Saving model ...
Epoch: 59 cost time: 0.6786961555480957
Epoch: 59, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.942 Vali Acc: 0.756 Test Loss: 0.942 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6867258548736572
Epoch: 60, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.71653151512146
Epoch: 61, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.955 Vali Acc: 0.739 Test Loss: 0.955 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.6829679012298584
Epoch: 62, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.950 Vali Acc: 0.744 Test Loss: 0.950 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.6897203922271729
Epoch: 63, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.746190071105957
Epoch: 64, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.8572039604187012
Epoch: 65, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.7963154315948486
Epoch: 66, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.929 Vali Acc: 0.750 Test Loss: 0.929 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.6945061683654785
Epoch: 67, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.934 Vali Acc: 0.761 Test Loss: 0.934 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 68 cost time: 0.66575026512146
Epoch: 68, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.952 Vali Acc: 0.744 Test Loss: 0.952 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7128305435180664
Epoch: 69, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.962 Vali Acc: 0.744 Test Loss: 0.962 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6894888877868652
Epoch: 70, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.945 Vali Acc: 0.739 Test Loss: 0.945 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7443866729736328
Epoch: 71, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.942 Vali Acc: 0.744 Test Loss: 0.942 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.6676983833312988
Epoch: 72, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.946 Vali Acc: 0.756 Test Loss: 0.946 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7256126403808594
Epoch: 73, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.942 Vali Acc: 0.756 Test Loss: 0.942 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.8341109752655029
Epoch: 74, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.945 Vali Acc: 0.761 Test Loss: 0.945 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.684218168258667
Epoch: 75, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.940 Vali Acc: 0.761 Test Loss: 0.940 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.7776191234588623
Epoch: 76, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.945 Vali Acc: 0.756 Test Loss: 0.945 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.733515739440918
Epoch: 77, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.954 Vali Acc: 0.744 Test Loss: 0.954 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 10831
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1591432094573975
Epoch: 1, Steps: 12 | Train Loss: 2.921 Vali Loss: 2.874 Vali Acc: 0.028 Test Loss: 2.874 Test Acc: 0.028
Validation loss decreased (inf --> -0.027749).  Saving model ...
Epoch: 2 cost time: 0.7434558868408203
Epoch: 2, Steps: 12 | Train Loss: 2.908 Vali Loss: 2.826 Vali Acc: 0.039 Test Loss: 2.826 Test Acc: 0.039
Validation loss decreased (-0.027749 --> -0.038861).  Saving model ...
Epoch: 3 cost time: 0.6441957950592041
Epoch: 3, Steps: 12 | Train Loss: 2.837 Vali Loss: 2.751 Vali Acc: 0.067 Test Loss: 2.751 Test Acc: 0.067
Validation loss decreased (-0.038861 --> -0.066639).  Saving model ...
Epoch: 4 cost time: 0.7092545032501221
Epoch: 4, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.662 Vali Acc: 0.078 Test Loss: 2.662 Test Acc: 0.078
Validation loss decreased (-0.066639 --> -0.077751).  Saving model ...
Epoch: 5 cost time: 0.7023715972900391
Epoch: 5, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.564 Vali Acc: 0.139 Test Loss: 2.564 Test Acc: 0.139
Validation loss decreased (-0.077751 --> -0.138863).  Saving model ...
Epoch: 6 cost time: 0.7855319976806641
Epoch: 6, Steps: 12 | Train Loss: 2.522 Vali Loss: 2.464 Vali Acc: 0.261 Test Loss: 2.464 Test Acc: 0.261
Validation loss decreased (-0.138863 --> -0.261086).  Saving model ...
Epoch: 7 cost time: 0.6927363872528076
Epoch: 7, Steps: 12 | Train Loss: 2.442 Vali Loss: 2.372 Vali Acc: 0.278 Test Loss: 2.372 Test Acc: 0.278
Validation loss decreased (-0.261086 --> -0.277754).  Saving model ...
Epoch: 8 cost time: 0.6633729934692383
Epoch: 8, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.274 Vali Acc: 0.322 Test Loss: 2.274 Test Acc: 0.322
Validation loss decreased (-0.277754 --> -0.322199).  Saving model ...
Epoch: 9 cost time: 0.6977858543395996
Epoch: 9, Steps: 12 | Train Loss: 2.238 Vali Loss: 2.174 Vali Acc: 0.372 Test Loss: 2.174 Test Acc: 0.372
Validation loss decreased (-0.322199 --> -0.372200).  Saving model ...
Epoch: 10 cost time: 0.6610558032989502
Epoch: 10, Steps: 12 | Train Loss: 2.115 Vali Loss: 2.082 Vali Acc: 0.411 Test Loss: 2.082 Test Acc: 0.411
Validation loss decreased (-0.372200 --> -0.411090).  Saving model ...
Epoch: 11 cost time: 0.693516731262207
Epoch: 11, Steps: 12 | Train Loss: 2.023 Vali Loss: 1.995 Vali Acc: 0.450 Test Loss: 1.995 Test Acc: 0.450
Validation loss decreased (-0.411090 --> -0.449980).  Saving model ...
Epoch: 12 cost time: 0.7253422737121582
Epoch: 12, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.912 Vali Acc: 0.456 Test Loss: 1.912 Test Acc: 0.456
Validation loss decreased (-0.449980 --> -0.455536).  Saving model ...
Epoch: 13 cost time: 0.712329626083374
Epoch: 13, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.842 Vali Acc: 0.467 Test Loss: 1.842 Test Acc: 0.467
Validation loss decreased (-0.455536 --> -0.466648).  Saving model ...
Epoch: 14 cost time: 0.6761713027954102
Epoch: 14, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.774 Vali Acc: 0.539 Test Loss: 1.774 Test Acc: 0.539
Validation loss decreased (-0.466648 --> -0.538871).  Saving model ...
Epoch: 15 cost time: 0.6846573352813721
Epoch: 15, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.711 Vali Acc: 0.539 Test Loss: 1.711 Test Acc: 0.539
Validation loss decreased (-0.538871 --> -0.538872).  Saving model ...
Epoch: 16 cost time: 0.6554112434387207
Epoch: 16, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.658 Vali Acc: 0.528 Test Loss: 1.658 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6975939273834229
Epoch: 17, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.613 Vali Acc: 0.556 Test Loss: 1.613 Test Acc: 0.556
Validation loss decreased (-0.538872 --> -0.555539).  Saving model ...
Epoch: 18 cost time: 0.7051832675933838
Epoch: 18, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.572 Vali Acc: 0.567 Test Loss: 1.572 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566651).  Saving model ...
Epoch: 19 cost time: 0.5965104103088379
Epoch: 19, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.532 Vali Acc: 0.578 Test Loss: 1.532 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577762).  Saving model ...
Epoch: 20 cost time: 0.6732852458953857
Epoch: 20, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.490 Vali Acc: 0.572 Test Loss: 1.490 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7779960632324219
Epoch: 21, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.465 Vali Acc: 0.567 Test Loss: 1.465 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7068676948547363
Epoch: 22, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.438 Vali Acc: 0.589 Test Loss: 1.438 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588875).  Saving model ...
Epoch: 23 cost time: 0.7028062343597412
Epoch: 23, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.411 Vali Acc: 0.583 Test Loss: 1.411 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6663806438446045
Epoch: 24, Steps: 12 | Train Loss: 1.136 Vali Loss: 1.385 Vali Acc: 0.606 Test Loss: 1.385 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605542).  Saving model ...
Epoch: 25 cost time: 0.6766884326934814
Epoch: 25, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.363 Vali Acc: 0.583 Test Loss: 1.363 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6860694885253906
Epoch: 26, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.335 Vali Acc: 0.606 Test Loss: 1.335 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605542).  Saving model ...
Epoch: 27 cost time: 0.7076804637908936
Epoch: 27, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.313 Vali Acc: 0.617 Test Loss: 1.313 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 28 cost time: 0.7187752723693848
Epoch: 28, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.286 Vali Acc: 0.606 Test Loss: 1.286 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6893620491027832
Epoch: 29, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.263 Vali Acc: 0.633 Test Loss: 1.263 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 30 cost time: 0.6900112628936768
Epoch: 30, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.241 Vali Acc: 0.622 Test Loss: 1.241 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.670140266418457
Epoch: 31, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.220 Vali Acc: 0.639 Test Loss: 1.220 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 32 cost time: 0.7515316009521484
Epoch: 32, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.203 Vali Acc: 0.639 Test Loss: 1.203 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 33 cost time: 0.7563934326171875
Epoch: 33, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.176 Vali Acc: 0.650 Test Loss: 1.176 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649988).  Saving model ...
Epoch: 34 cost time: 0.7628676891326904
Epoch: 34, Steps: 12 | Train Loss: 0.731 Vali Loss: 1.156 Vali Acc: 0.650 Test Loss: 1.156 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 35 cost time: 0.736771821975708
Epoch: 35, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.130 Vali Acc: 0.656 Test Loss: 1.130 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 36 cost time: 0.6621596813201904
Epoch: 36, Steps: 12 | Train Loss: 0.733 Vali Loss: 1.112 Vali Acc: 0.661 Test Loss: 1.112 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 37 cost time: 0.6786043643951416
Epoch: 37, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.101 Vali Acc: 0.667 Test Loss: 1.101 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 38 cost time: 0.7165927886962891
Epoch: 38, Steps: 12 | Train Loss: 0.644 Vali Loss: 1.084 Vali Acc: 0.667 Test Loss: 1.084 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 39 cost time: 0.7247166633605957
Epoch: 39, Steps: 12 | Train Loss: 0.667 Vali Loss: 1.056 Vali Acc: 0.678 Test Loss: 1.056 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 40 cost time: 0.7278130054473877
Epoch: 40, Steps: 12 | Train Loss: 0.605 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 41 cost time: 0.6871354579925537
Epoch: 41, Steps: 12 | Train Loss: 0.588 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 42 cost time: 0.6904213428497314
Epoch: 42, Steps: 12 | Train Loss: 0.650 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 43 cost time: 0.6839215755462646
Epoch: 43, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.994 Vali Acc: 0.711 Test Loss: 0.994 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 44 cost time: 0.6737692356109619
Epoch: 44, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.980 Vali Acc: 0.706 Test Loss: 0.980 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6923470497131348
Epoch: 45, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.965 Vali Acc: 0.706 Test Loss: 0.965 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6611337661743164
Epoch: 46, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 47 cost time: 0.6784648895263672
Epoch: 47, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.942 Vali Acc: 0.728 Test Loss: 0.942 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 48 cost time: 0.6927502155303955
Epoch: 48, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 49 cost time: 0.6782999038696289
Epoch: 49, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.931 Vali Acc: 0.733 Test Loss: 0.931 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 50 cost time: 0.7159035205841064
Epoch: 50, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.924 Vali Acc: 0.722 Test Loss: 0.924 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7003443241119385
Epoch: 51, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.911 Vali Acc: 0.739 Test Loss: 0.911 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 52 cost time: 0.6954150199890137
Epoch: 52, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.907 Vali Acc: 0.744 Test Loss: 0.907 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744435).  Saving model ...
Epoch: 53 cost time: 0.7489743232727051
Epoch: 53, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.904 Vali Acc: 0.728 Test Loss: 0.904 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6886107921600342
Epoch: 54, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 55 cost time: 0.6644268035888672
Epoch: 55, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.895 Vali Acc: 0.756 Test Loss: 0.895 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 56 cost time: 0.6969435214996338
Epoch: 56, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.885 Vali Acc: 0.733 Test Loss: 0.885 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6954958438873291
Epoch: 57, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.896 Vali Acc: 0.733 Test Loss: 0.896 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.671699047088623
Epoch: 58, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.889 Vali Acc: 0.733 Test Loss: 0.889 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7270314693450928
Epoch: 59, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.886 Vali Acc: 0.728 Test Loss: 0.886 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7078917026519775
Epoch: 60, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.885 Vali Acc: 0.739 Test Loss: 0.885 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.758965253829956
Epoch: 61, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.6586487293243408
Epoch: 62, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.876 Vali Acc: 0.739 Test Loss: 0.876 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6863358020782471
Epoch: 63, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.873 Vali Acc: 0.717 Test Loss: 0.873 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.6770176887512207
Epoch: 64, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.877 Vali Acc: 0.744 Test Loss: 0.877 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.6740531921386719
Epoch: 65, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.882 Vali Acc: 0.761 Test Loss: 0.882 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 66 cost time: 0.7186567783355713
Epoch: 66, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.888 Vali Acc: 0.744 Test Loss: 0.888 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6646144390106201
Epoch: 67, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.873 Vali Acc: 0.733 Test Loss: 0.873 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6779029369354248
Epoch: 68, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.881 Vali Acc: 0.733 Test Loss: 0.881 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7207214832305908
Epoch: 69, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.883 Vali Acc: 0.744 Test Loss: 0.883 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.7352406978607178
Epoch: 70, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.898 Vali Acc: 0.756 Test Loss: 0.898 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6788177490234375
Epoch: 71, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.900 Vali Acc: 0.739 Test Loss: 0.900 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.7154569625854492
Epoch: 72, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.890 Vali Acc: 0.722 Test Loss: 0.890 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.6478970050811768
Epoch: 73, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.870 Vali Acc: 0.744 Test Loss: 0.870 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.6903994083404541
Epoch: 74, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.705305814743042
Epoch: 75, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.873 Vali Acc: 0.733 Test Loss: 0.873 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 9903
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0737133026123047
Epoch: 1, Steps: 12 | Train Loss: 2.771 Vali Loss: 2.703 Vali Acc: 0.083 Test Loss: 2.703 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.6290154457092285
Epoch: 2, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.642 Vali Acc: 0.106 Test Loss: 2.642 Test Acc: 0.106
Validation loss decreased (-0.083306 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 0.6658897399902344
Epoch: 3, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.584 Vali Acc: 0.133 Test Loss: 2.584 Test Acc: 0.133
Validation loss decreased (-0.105529 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 0.6434028148651123
Epoch: 4, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.520 Vali Acc: 0.200 Test Loss: 2.520 Test Acc: 0.200
Validation loss decreased (-0.133307 --> -0.199975).  Saving model ...
Epoch: 5 cost time: 0.6760146617889404
Epoch: 5, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.452 Vali Acc: 0.239 Test Loss: 2.452 Test Acc: 0.239
Validation loss decreased (-0.199975 --> -0.238864).  Saving model ...
Epoch: 6 cost time: 0.6433563232421875
Epoch: 6, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.380 Vali Acc: 0.306 Test Loss: 2.380 Test Acc: 0.306
Validation loss decreased (-0.238864 --> -0.305532).  Saving model ...
Epoch: 7 cost time: 0.6434924602508545
Epoch: 7, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.301 Vali Acc: 0.333 Test Loss: 2.301 Test Acc: 0.333
Validation loss decreased (-0.305532 --> -0.333310).  Saving model ...
Epoch: 8 cost time: 0.6301736831665039
Epoch: 8, Steps: 12 | Train Loss: 2.348 Vali Loss: 2.232 Vali Acc: 0.372 Test Loss: 2.232 Test Acc: 0.372
Validation loss decreased (-0.333310 --> -0.372200).  Saving model ...
Epoch: 9 cost time: 0.7019739151000977
Epoch: 9, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.156 Vali Acc: 0.406 Test Loss: 2.156 Test Acc: 0.406
Validation loss decreased (-0.372200 --> -0.405534).  Saving model ...
Epoch: 10 cost time: 0.6041245460510254
Epoch: 10, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.082 Vali Acc: 0.444 Test Loss: 2.082 Test Acc: 0.444
Validation loss decreased (-0.405534 --> -0.444424).  Saving model ...
Epoch: 11 cost time: 0.6477248668670654
Epoch: 11, Steps: 12 | Train Loss: 2.059 Vali Loss: 2.010 Vali Acc: 0.461 Test Loss: 2.010 Test Acc: 0.461
Validation loss decreased (-0.444424 --> -0.461091).  Saving model ...
Epoch: 12 cost time: 0.6364762783050537
Epoch: 12, Steps: 12 | Train Loss: 1.988 Vali Loss: 1.939 Vali Acc: 0.472 Test Loss: 1.939 Test Acc: 0.472
Validation loss decreased (-0.461091 --> -0.472203).  Saving model ...
Epoch: 13 cost time: 0.6461856365203857
Epoch: 13, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.880 Vali Acc: 0.478 Test Loss: 1.880 Test Acc: 0.478
Validation loss decreased (-0.472203 --> -0.477759).  Saving model ...
Epoch: 14 cost time: 0.6447904109954834
Epoch: 14, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.821 Vali Acc: 0.483 Test Loss: 1.821 Test Acc: 0.483
Validation loss decreased (-0.477759 --> -0.483315).  Saving model ...
Epoch: 15 cost time: 0.7813735008239746
Epoch: 15, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.756 Vali Acc: 0.511 Test Loss: 1.756 Test Acc: 0.511
Validation loss decreased (-0.483315 --> -0.511094).  Saving model ...
Epoch: 16 cost time: 0.6070549488067627
Epoch: 16, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.708 Vali Acc: 0.528 Test Loss: 1.708 Test Acc: 0.528
Validation loss decreased (-0.511094 --> -0.527761).  Saving model ...
Epoch: 17 cost time: 0.690117597579956
Epoch: 17, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.666 Vali Acc: 0.522 Test Loss: 1.666 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6672635078430176
Epoch: 18, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.626 Vali Acc: 0.539 Test Loss: 1.626 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 19 cost time: 0.6280994415283203
Epoch: 19, Steps: 12 | Train Loss: 1.485 Vali Loss: 1.589 Vali Acc: 0.539 Test Loss: 1.589 Test Acc: 0.539
Validation loss decreased (-0.538873 --> -0.538873).  Saving model ...
Epoch: 20 cost time: 0.6539499759674072
Epoch: 20, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.549 Vali Acc: 0.539 Test Loss: 1.549 Test Acc: 0.539
Validation loss decreased (-0.538873 --> -0.538873).  Saving model ...
Epoch: 21 cost time: 0.6953599452972412
Epoch: 21, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.516 Vali Acc: 0.556 Test Loss: 1.516 Test Acc: 0.556
Validation loss decreased (-0.538873 --> -0.555540).  Saving model ...
Epoch: 22 cost time: 0.5988354682922363
Epoch: 22, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.478 Vali Acc: 0.556 Test Loss: 1.478 Test Acc: 0.556
Validation loss decreased (-0.555540 --> -0.555541).  Saving model ...
Epoch: 23 cost time: 0.6217250823974609
Epoch: 23, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.453 Vali Acc: 0.567 Test Loss: 1.453 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566652).  Saving model ...
Epoch: 24 cost time: 0.6737062931060791
Epoch: 24, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.428 Vali Acc: 0.572 Test Loss: 1.428 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 25 cost time: 0.6628117561340332
Epoch: 25, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.401 Vali Acc: 0.572 Test Loss: 1.401 Test Acc: 0.572
Validation loss decreased (-0.572208 --> -0.572208).  Saving model ...
Epoch: 26 cost time: 0.6813170909881592
Epoch: 26, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.368 Vali Acc: 0.583 Test Loss: 1.368 Test Acc: 0.583
Validation loss decreased (-0.572208 --> -0.583320).  Saving model ...
Epoch: 27 cost time: 0.683720588684082
Epoch: 27, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.342 Vali Acc: 0.628 Test Loss: 1.342 Test Acc: 0.628
Validation loss decreased (-0.583320 --> -0.627764).  Saving model ...
Epoch: 28 cost time: 0.658843994140625
Epoch: 28, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.322 Vali Acc: 0.628 Test Loss: 1.322 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627765).  Saving model ...
Epoch: 29 cost time: 0.6741163730621338
Epoch: 29, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.299 Vali Acc: 0.628 Test Loss: 1.299 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 30 cost time: 0.642474889755249
Epoch: 30, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.278 Vali Acc: 0.633 Test Loss: 1.278 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 31 cost time: 0.6698527336120605
Epoch: 31, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.257 Vali Acc: 0.611 Test Loss: 1.257 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6582934856414795
Epoch: 32, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.231 Vali Acc: 0.639 Test Loss: 1.231 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 33 cost time: 0.7377965450286865
Epoch: 33, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.211 Vali Acc: 0.633 Test Loss: 1.211 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7084517478942871
Epoch: 34, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.201 Vali Acc: 0.644 Test Loss: 1.201 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644432).  Saving model ...
Epoch: 35 cost time: 0.6567656993865967
Epoch: 35, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.189 Vali Acc: 0.633 Test Loss: 1.189 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6883485317230225
Epoch: 36, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.163 Vali Acc: 0.639 Test Loss: 1.163 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6612257957458496
Epoch: 37, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.148 Vali Acc: 0.644 Test Loss: 1.148 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644433).  Saving model ...
Epoch: 38 cost time: 0.6811904907226562
Epoch: 38, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.134 Vali Acc: 0.644 Test Loss: 1.134 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 39 cost time: 0.6940743923187256
Epoch: 39, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
Validation loss decreased (-0.644433 --> -0.649989).  Saving model ...
Epoch: 40 cost time: 0.6479566097259521
Epoch: 40, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.098 Vali Acc: 0.644 Test Loss: 1.098 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6428771018981934
Epoch: 41, Steps: 12 | Train Loss: 0.701 Vali Loss: 1.086 Vali Acc: 0.650 Test Loss: 1.086 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 42 cost time: 0.6390228271484375
Epoch: 42, Steps: 12 | Train Loss: 0.670 Vali Loss: 1.068 Vali Acc: 0.656 Test Loss: 1.068 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 43 cost time: 0.6575477123260498
Epoch: 43, Steps: 12 | Train Loss: 0.652 Vali Loss: 1.054 Vali Acc: 0.672 Test Loss: 1.054 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672212).  Saving model ...
Epoch: 44 cost time: 0.6451506614685059
Epoch: 44, Steps: 12 | Train Loss: 0.598 Vali Loss: 1.039 Vali Acc: 0.661 Test Loss: 1.039 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6975395679473877
Epoch: 45, Steps: 12 | Train Loss: 0.620 Vali Loss: 1.026 Vali Acc: 0.661 Test Loss: 1.026 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6533980369567871
Epoch: 46, Steps: 12 | Train Loss: 0.600 Vali Loss: 1.014 Vali Acc: 0.661 Test Loss: 1.014 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.711991548538208
Epoch: 47, Steps: 12 | Train Loss: 0.560 Vali Loss: 1.000 Vali Acc: 0.667 Test Loss: 1.000 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6845693588256836
Epoch: 48, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.995 Vali Acc: 0.667 Test Loss: 0.995 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6536633968353271
Epoch: 49, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.989 Vali Acc: 0.656 Test Loss: 0.989 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6499447822570801
Epoch: 50, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.986 Vali Acc: 0.661 Test Loss: 0.986 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5721478462219238
Epoch: 51, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.969 Vali Acc: 0.683 Test Loss: 0.969 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 52 cost time: 0.705613374710083
Epoch: 52, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.958 Vali Acc: 0.678 Test Loss: 0.958 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6517655849456787
Epoch: 53, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.947 Vali Acc: 0.683 Test Loss: 0.947 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
Epoch: 54 cost time: 0.7740306854248047
Epoch: 54, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.940 Vali Acc: 0.683 Test Loss: 0.940 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
Epoch: 55 cost time: 0.6689293384552002
Epoch: 55, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.935 Vali Acc: 0.683 Test Loss: 0.935 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
Epoch: 56 cost time: 0.627159833908081
Epoch: 56, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.923 Vali Acc: 0.683 Test Loss: 0.923 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
Epoch: 57 cost time: 0.7407608032226562
Epoch: 57, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.911 Vali Acc: 0.689 Test Loss: 0.911 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 58 cost time: 0.721027135848999
Epoch: 58, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.900 Vali Acc: 0.689 Test Loss: 0.900 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 59 cost time: 0.7251472473144531
Epoch: 59, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.899 Vali Acc: 0.683 Test Loss: 0.899 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6789088249206543
Epoch: 60, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.899 Vali Acc: 0.689 Test Loss: 0.899 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 61 cost time: 0.7082881927490234
Epoch: 61, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.898 Vali Acc: 0.694 Test Loss: 0.898 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694435).  Saving model ...
Epoch: 62 cost time: 0.6937079429626465
Epoch: 62, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.895 Vali Acc: 0.694 Test Loss: 0.895 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 63 cost time: 0.7124710083007812
Epoch: 63, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.894 Vali Acc: 0.694 Test Loss: 0.894 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 64 cost time: 0.7339355945587158
Epoch: 64, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.890 Vali Acc: 0.706 Test Loss: 0.890 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 65 cost time: 0.7162714004516602
Epoch: 65, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.881 Vali Acc: 0.722 Test Loss: 0.881 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722213).  Saving model ...
Epoch: 66 cost time: 0.6797239780426025
Epoch: 66, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7380592823028564
Epoch: 67, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.866 Vali Acc: 0.722 Test Loss: 0.866 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 68 cost time: 0.7719008922576904
Epoch: 68, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.879 Vali Acc: 0.728 Test Loss: 0.879 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727769).  Saving model ...
Epoch: 69 cost time: 0.7138183116912842
Epoch: 69, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.887 Vali Acc: 0.728 Test Loss: 0.887 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6764280796051025
Epoch: 70, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.885 Vali Acc: 0.739 Test Loss: 0.885 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 71 cost time: 0.6964635848999023
Epoch: 71, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.890 Vali Acc: 0.722 Test Loss: 0.890 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7048838138580322
Epoch: 72, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.870 Vali Acc: 0.728 Test Loss: 0.870 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6792399883270264
Epoch: 73, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.872 Vali Acc: 0.728 Test Loss: 0.872 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.7019240856170654
Epoch: 74, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.6953158378601074
Epoch: 75, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.868 Vali Acc: 0.733 Test Loss: 0.868 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.7681257724761963
Epoch: 76, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.871 Vali Acc: 0.739 Test Loss: 0.871 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 77 cost time: 0.7514519691467285
Epoch: 77, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.875 Vali Acc: 0.739 Test Loss: 0.875 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7103409767150879
Epoch: 78, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.880 Vali Acc: 0.728 Test Loss: 0.880 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.7752895355224609
Epoch: 79, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.865 Vali Acc: 0.733 Test Loss: 0.865 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.7178387641906738
Epoch: 80, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.873 Vali Acc: 0.739 Test Loss: 0.873 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.781174898147583
Epoch: 81, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 82 cost time: 0.752382755279541
Epoch: 82, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749991).  Saving model ...
Epoch: 83 cost time: 0.7306149005889893
Epoch: 83, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7054102420806885
Epoch: 84, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.6330125331878662
Epoch: 85, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.874 Vali Acc: 0.739 Test Loss: 0.874 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.6951510906219482
Epoch: 86, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.871 Vali Acc: 0.744 Test Loss: 0.871 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.6876156330108643
Epoch: 87, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.869 Vali Acc: 0.744 Test Loss: 0.869 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.7467284202575684
Epoch: 88, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.858 Vali Acc: 0.761 Test Loss: 0.858 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761103).  Saving model ...
Epoch: 89 cost time: 0.7418055534362793
Epoch: 89, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.6811413764953613
Epoch: 90, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.864 Vali Acc: 0.761 Test Loss: 0.864 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.7199945449829102
Epoch: 91, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.882 Vali Acc: 0.744 Test Loss: 0.882 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.6963756084442139
Epoch: 92, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.882 Vali Acc: 0.744 Test Loss: 0.882 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.7182779312133789
Epoch: 93, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.881 Vali Acc: 0.756 Test Loss: 0.881 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.7441089153289795
Epoch: 94, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.885 Vali Acc: 0.756 Test Loss: 0.885 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.7798030376434326
Epoch: 95, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.893 Vali Acc: 0.756 Test Loss: 0.893 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.6850581169128418
Epoch: 96, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.912 Vali Acc: 0.761 Test Loss: 0.912 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 0.6956617832183838
Epoch: 97, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.915 Vali Acc: 0.767 Test Loss: 0.915 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 98 cost time: 0.7513141632080078
Epoch: 98, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.899 Vali Acc: 0.756 Test Loss: 0.899 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.7863905429840088
Epoch: 99, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.7662832736968994
Epoch: 100, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.923 Vali Acc: 0.761 Test Loss: 0.923 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 8991
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9307100772857666
Epoch: 1, Steps: 12 | Train Loss: 2.892 Vali Loss: 2.756 Vali Acc: 0.089 Test Loss: 2.756 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 0.6306228637695312
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.556 Vali Acc: 0.172 Test Loss: 2.556 Test Acc: 0.172
Validation loss decreased (-0.088861 --> -0.172197).  Saving model ...
Epoch: 3 cost time: 0.6378107070922852
Epoch: 3, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.332 Vali Acc: 0.356 Test Loss: 2.332 Test Acc: 0.356
Validation loss decreased (-0.172197 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 0.6299026012420654
Epoch: 4, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.128 Vali Acc: 0.361 Test Loss: 2.128 Test Acc: 0.361
Validation loss decreased (-0.355532 --> -0.361090).  Saving model ...
Epoch: 5 cost time: 0.6220097541809082
Epoch: 5, Steps: 12 | Train Loss: 2.040 Vali Loss: 1.958 Vali Acc: 0.411 Test Loss: 1.958 Test Acc: 0.411
Validation loss decreased (-0.361090 --> -0.411092).  Saving model ...
Epoch: 6 cost time: 0.6373608112335205
Epoch: 6, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.806 Vali Acc: 0.456 Test Loss: 1.806 Test Acc: 0.456
Validation loss decreased (-0.411092 --> -0.455537).  Saving model ...
Epoch: 7 cost time: 0.6433675289154053
Epoch: 7, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.689 Vali Acc: 0.500 Test Loss: 1.689 Test Acc: 0.500
Validation loss decreased (-0.455537 --> -0.499983).  Saving model ...
Epoch: 8 cost time: 0.6709508895874023
Epoch: 8, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.586 Vali Acc: 0.533 Test Loss: 1.586 Test Acc: 0.533
Validation loss decreased (-0.499983 --> -0.533317).  Saving model ...
Epoch: 9 cost time: 0.5872633457183838
Epoch: 9, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.507 Vali Acc: 0.561 Test Loss: 1.507 Test Acc: 0.561
Validation loss decreased (-0.533317 --> -0.561096).  Saving model ...
Epoch: 10 cost time: 0.5869791507720947
Epoch: 10, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.442 Vali Acc: 0.572 Test Loss: 1.442 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 11 cost time: 0.6243913173675537
Epoch: 11, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.382 Vali Acc: 0.606 Test Loss: 1.382 Test Acc: 0.606
Validation loss decreased (-0.572208 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 0.6017119884490967
Epoch: 12, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.318 Vali Acc: 0.617 Test Loss: 1.318 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616653).  Saving model ...
Epoch: 13 cost time: 0.6157069206237793
Epoch: 13, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.290 Vali Acc: 0.600 Test Loss: 1.290 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5850389003753662
Epoch: 14, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.248 Vali Acc: 0.644 Test Loss: 1.248 Test Acc: 0.644
Validation loss decreased (-0.616653 --> -0.644432).  Saving model ...
Epoch: 15 cost time: 0.7633538246154785
Epoch: 15, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.219 Vali Acc: 0.661 Test Loss: 1.219 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 16 cost time: 0.6229715347290039
Epoch: 16, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.183 Vali Acc: 0.644 Test Loss: 1.183 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6133253574371338
Epoch: 17, Steps: 12 | Train Loss: 0.678 Vali Loss: 1.158 Vali Acc: 0.650 Test Loss: 1.158 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5693719387054443
Epoch: 18, Steps: 12 | Train Loss: 0.621 Vali Loss: 1.149 Vali Acc: 0.672 Test Loss: 1.149 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 19 cost time: 0.6850531101226807
Epoch: 19, Steps: 12 | Train Loss: 0.625 Vali Loss: 1.163 Vali Acc: 0.672 Test Loss: 1.163 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.675037145614624
Epoch: 20, Steps: 12 | Train Loss: 0.585 Vali Loss: 1.093 Vali Acc: 0.678 Test Loss: 1.093 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 21 cost time: 0.6601963043212891
Epoch: 21, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.078 Vali Acc: 0.700 Test Loss: 1.078 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699989).  Saving model ...
Epoch: 22 cost time: 0.6212739944458008
Epoch: 22, Steps: 12 | Train Loss: 0.466 Vali Loss: 1.078 Vali Acc: 0.661 Test Loss: 1.078 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6519694328308105
Epoch: 23, Steps: 12 | Train Loss: 0.464 Vali Loss: 1.049 Vali Acc: 0.706 Test Loss: 1.049 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 24 cost time: 0.6304559707641602
Epoch: 24, Steps: 12 | Train Loss: 0.462 Vali Loss: 1.029 Vali Acc: 0.717 Test Loss: 1.029 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716656).  Saving model ...
Epoch: 25 cost time: 0.6371276378631592
Epoch: 25, Steps: 12 | Train Loss: 0.454 Vali Loss: 1.011 Vali Acc: 0.744 Test Loss: 1.011 Test Acc: 0.744
Validation loss decreased (-0.716656 --> -0.744434).  Saving model ...
Epoch: 26 cost time: 0.6262950897216797
Epoch: 26, Steps: 12 | Train Loss: 0.329 Vali Loss: 1.021 Vali Acc: 0.744 Test Loss: 1.021 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7045590877532959
Epoch: 27, Steps: 12 | Train Loss: 0.348 Vali Loss: 1.011 Vali Acc: 0.756 Test Loss: 1.011 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755545).  Saving model ...
Epoch: 28 cost time: 0.6812872886657715
Epoch: 28, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.999 Vali Acc: 0.756 Test Loss: 0.999 Test Acc: 0.756
Validation loss decreased (-0.755545 --> -0.755546).  Saving model ...
Epoch: 29 cost time: 0.6824843883514404
Epoch: 29, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.023 Vali Acc: 0.733 Test Loss: 1.023 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6345272064208984
Epoch: 30, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.011 Vali Acc: 0.767 Test Loss: 1.011 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766657).  Saving model ...
Epoch: 31 cost time: 0.6288294792175293
Epoch: 31, Steps: 12 | Train Loss: 0.237 Vali Loss: 1.012 Vali Acc: 0.761 Test Loss: 1.012 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6073391437530518
Epoch: 32, Steps: 12 | Train Loss: 0.220 Vali Loss: 1.017 Vali Acc: 0.756 Test Loss: 1.017 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6377310752868652
Epoch: 33, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.025 Vali Acc: 0.767 Test Loss: 1.025 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6517684459686279
Epoch: 34, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.054 Vali Acc: 0.744 Test Loss: 1.054 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6861231327056885
Epoch: 35, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.067 Vali Acc: 0.744 Test Loss: 1.067 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6364824771881104
Epoch: 36, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.048 Vali Acc: 0.761 Test Loss: 1.048 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6697442531585693
Epoch: 37, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.073 Vali Acc: 0.733 Test Loss: 1.073 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6390073299407959
Epoch: 38, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.077 Vali Acc: 0.744 Test Loss: 1.077 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6503119468688965
Epoch: 39, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.106 Vali Acc: 0.733 Test Loss: 1.106 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.622797966003418
Epoch: 40, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.092 Vali Acc: 0.733 Test Loss: 1.092 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 24959
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8795361518859863
Epoch: 1, Steps: 12 | Train Loss: 2.762 Vali Loss: 2.746 Vali Acc: 0.061 Test Loss: 2.746 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.7056789398193359
Epoch: 2, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.645 Vali Acc: 0.111 Test Loss: 2.645 Test Acc: 0.111
Validation loss decreased (-0.061084 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 0.662400484085083
Epoch: 3, Steps: 12 | Train Loss: 2.522 Vali Loss: 2.505 Vali Acc: 0.194 Test Loss: 2.505 Test Acc: 0.194
Validation loss decreased (-0.111085 --> -0.194419).  Saving model ...
Epoch: 4 cost time: 0.689338207244873
Epoch: 4, Steps: 12 | Train Loss: 2.349 Vali Loss: 2.355 Vali Acc: 0.272 Test Loss: 2.355 Test Acc: 0.272
Validation loss decreased (-0.194419 --> -0.272199).  Saving model ...
Epoch: 5 cost time: 0.6186306476593018
Epoch: 5, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.208 Vali Acc: 0.356 Test Loss: 2.208 Test Acc: 0.356
Validation loss decreased (-0.272199 --> -0.355533).  Saving model ...
Epoch: 6 cost time: 0.6712620258331299
Epoch: 6, Steps: 12 | Train Loss: 2.043 Vali Loss: 2.071 Vali Acc: 0.428 Test Loss: 2.071 Test Acc: 0.428
Validation loss decreased (-0.355533 --> -0.427757).  Saving model ...
Epoch: 7 cost time: 0.5961213111877441
Epoch: 7, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.944 Vali Acc: 0.461 Test Loss: 1.944 Test Acc: 0.461
Validation loss decreased (-0.427757 --> -0.461092).  Saving model ...
Epoch: 8 cost time: 0.6616213321685791
Epoch: 8, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.824 Vali Acc: 0.483 Test Loss: 1.824 Test Acc: 0.483
Validation loss decreased (-0.461092 --> -0.483315).  Saving model ...
Epoch: 9 cost time: 0.6281425952911377
Epoch: 9, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.727 Vali Acc: 0.528 Test Loss: 1.727 Test Acc: 0.528
Validation loss decreased (-0.483315 --> -0.527761).  Saving model ...
Epoch: 10 cost time: 0.6822445392608643
Epoch: 10, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.655 Vali Acc: 0.522 Test Loss: 1.655 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7197391986846924
Epoch: 11, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.592 Vali Acc: 0.544 Test Loss: 1.592 Test Acc: 0.544
Validation loss decreased (-0.527761 --> -0.544429).  Saving model ...
Epoch: 12 cost time: 0.6194407939910889
Epoch: 12, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.520 Vali Acc: 0.556 Test Loss: 1.520 Test Acc: 0.556
Validation loss decreased (-0.544429 --> -0.555540).  Saving model ...
Epoch: 13 cost time: 0.6448984146118164
Epoch: 13, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.470 Vali Acc: 0.567 Test Loss: 1.470 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566652).  Saving model ...
Epoch: 14 cost time: 0.6566195487976074
Epoch: 14, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.429 Vali Acc: 0.594 Test Loss: 1.429 Test Acc: 0.594
Validation loss decreased (-0.566652 --> -0.594430).  Saving model ...
Epoch: 15 cost time: 0.7230582237243652
Epoch: 15, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.395 Vali Acc: 0.600 Test Loss: 1.395 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 0.6016480922698975
Epoch: 16, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.361 Vali Acc: 0.606 Test Loss: 1.361 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 17 cost time: 0.6114668846130371
Epoch: 17, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.319 Vali Acc: 0.617 Test Loss: 1.319 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616653).  Saving model ...
Epoch: 18 cost time: 0.6507570743560791
Epoch: 18, Steps: 12 | Train Loss: 0.863 Vali Loss: 1.291 Vali Acc: 0.611 Test Loss: 1.291 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6870603561401367
Epoch: 19, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.286 Vali Acc: 0.628 Test Loss: 1.286 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627765).  Saving model ...
Epoch: 20 cost time: 0.6085994243621826
Epoch: 20, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.250 Vali Acc: 0.644 Test Loss: 1.250 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644432).  Saving model ...
Epoch: 21 cost time: 0.7020814418792725
Epoch: 21, Steps: 12 | Train Loss: 0.761 Vali Loss: 1.225 Vali Acc: 0.639 Test Loss: 1.225 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6290686130523682
Epoch: 22, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.224 Vali Acc: 0.661 Test Loss: 1.224 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 23 cost time: 0.6020328998565674
Epoch: 23, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.182 Vali Acc: 0.661 Test Loss: 1.182 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661099).  Saving model ...
Epoch: 24 cost time: 0.6384983062744141
Epoch: 24, Steps: 12 | Train Loss: 0.665 Vali Loss: 1.160 Vali Acc: 0.667 Test Loss: 1.160 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 25 cost time: 0.6261694431304932
Epoch: 25, Steps: 12 | Train Loss: 0.611 Vali Loss: 1.146 Vali Acc: 0.683 Test Loss: 1.146 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 26 cost time: 0.5921428203582764
Epoch: 26, Steps: 12 | Train Loss: 0.571 Vali Loss: 1.116 Vali Acc: 0.689 Test Loss: 1.116 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 27 cost time: 0.6140985488891602
Epoch: 27, Steps: 12 | Train Loss: 0.602 Vali Loss: 1.109 Vali Acc: 0.683 Test Loss: 1.109 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7118220329284668
Epoch: 28, Steps: 12 | Train Loss: 0.520 Vali Loss: 1.085 Vali Acc: 0.683 Test Loss: 1.085 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6746218204498291
Epoch: 29, Steps: 12 | Train Loss: 0.478 Vali Loss: 1.056 Vali Acc: 0.689 Test Loss: 1.056 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 30 cost time: 0.6288914680480957
Epoch: 30, Steps: 12 | Train Loss: 0.455 Vali Loss: 1.049 Vali Acc: 0.717 Test Loss: 1.049 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716656).  Saving model ...
Epoch: 31 cost time: 0.6270387172698975
Epoch: 31, Steps: 12 | Train Loss: 0.450 Vali Loss: 1.036 Vali Acc: 0.711 Test Loss: 1.036 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6238512992858887
Epoch: 32, Steps: 12 | Train Loss: 0.428 Vali Loss: 1.015 Vali Acc: 0.739 Test Loss: 1.015 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738879).  Saving model ...
Epoch: 33 cost time: 0.6346790790557861
Epoch: 33, Steps: 12 | Train Loss: 0.367 Vali Loss: 1.024 Vali Acc: 0.733 Test Loss: 1.024 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6310479640960693
Epoch: 34, Steps: 12 | Train Loss: 0.408 Vali Loss: 1.018 Vali Acc: 0.722 Test Loss: 1.018 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6583304405212402
Epoch: 35, Steps: 12 | Train Loss: 0.381 Vali Loss: 1.003 Vali Acc: 0.744 Test Loss: 1.003 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744434).  Saving model ...
Epoch: 36 cost time: 0.6281981468200684
Epoch: 36, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.991 Vali Acc: 0.750 Test Loss: 0.991 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749990).  Saving model ...
Epoch: 37 cost time: 0.668238639831543
Epoch: 37, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6405189037322998
Epoch: 38, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.984 Vali Acc: 0.756 Test Loss: 0.984 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 39 cost time: 0.6005330085754395
Epoch: 39, Steps: 12 | Train Loss: 0.284 Vali Loss: 1.004 Vali Acc: 0.739 Test Loss: 1.004 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6735177040100098
Epoch: 40, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.994 Vali Acc: 0.750 Test Loss: 0.994 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6324455738067627
Epoch: 41, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6719295978546143
Epoch: 42, Steps: 12 | Train Loss: 0.264 Vali Loss: 1.000 Vali Acc: 0.756 Test Loss: 1.000 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7156054973602295
Epoch: 43, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.013 Vali Acc: 0.728 Test Loss: 1.013 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6777019500732422
Epoch: 44, Steps: 12 | Train Loss: 0.214 Vali Loss: 1.012 Vali Acc: 0.744 Test Loss: 1.012 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6749098300933838
Epoch: 45, Steps: 12 | Train Loss: 0.226 Vali Loss: 1.019 Vali Acc: 0.761 Test Loss: 1.019 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761101).  Saving model ...
Epoch: 46 cost time: 0.6733119487762451
Epoch: 46, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.025 Vali Acc: 0.733 Test Loss: 1.025 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6118621826171875
Epoch: 47, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.028 Vali Acc: 0.750 Test Loss: 1.028 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6524930000305176
Epoch: 48, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.038 Vali Acc: 0.739 Test Loss: 1.038 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5932488441467285
Epoch: 49, Steps: 12 | Train Loss: 0.190 Vali Loss: 1.038 Vali Acc: 0.744 Test Loss: 1.038 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6305108070373535
Epoch: 50, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.037 Vali Acc: 0.750 Test Loss: 1.037 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.651813268661499
Epoch: 51, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.045 Vali Acc: 0.756 Test Loss: 1.045 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6629507541656494
Epoch: 52, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.057 Vali Acc: 0.733 Test Loss: 1.057 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.6479268074035645
Epoch: 53, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.078 Vali Acc: 0.722 Test Loss: 1.078 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.7402732372283936
Epoch: 54, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.086 Vali Acc: 0.733 Test Loss: 1.086 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.7091860771179199
Epoch: 55, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.078 Vali Acc: 0.744 Test Loss: 1.078 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 14415
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1077725887298584
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.756 Vali Acc: 0.094 Test Loss: 2.756 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.5821409225463867
Epoch: 2, Steps: 12 | Train Loss: 2.845 Vali Loss: 2.673 Vali Acc: 0.133 Test Loss: 2.673 Test Acc: 0.133
Validation loss decreased (-0.094417 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 0.5802819728851318
Epoch: 3, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.557 Vali Acc: 0.178 Test Loss: 2.557 Test Acc: 0.178
Validation loss decreased (-0.133307 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 0.6457312107086182
Epoch: 4, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.429 Vali Acc: 0.228 Test Loss: 2.429 Test Acc: 0.228
Validation loss decreased (-0.177752 --> -0.227753).  Saving model ...
Epoch: 5 cost time: 0.6698129177093506
Epoch: 5, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.300 Vali Acc: 0.317 Test Loss: 2.300 Test Acc: 0.317
Validation loss decreased (-0.227753 --> -0.316644).  Saving model ...
Epoch: 6 cost time: 0.6236271858215332
Epoch: 6, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.169 Vali Acc: 0.361 Test Loss: 2.169 Test Acc: 0.361
Validation loss decreased (-0.316644 --> -0.361089).  Saving model ...
Epoch: 7 cost time: 0.6217422485351562
Epoch: 7, Steps: 12 | Train Loss: 2.103 Vali Loss: 2.042 Vali Acc: 0.439 Test Loss: 2.042 Test Acc: 0.439
Validation loss decreased (-0.361089 --> -0.438868).  Saving model ...
Epoch: 8 cost time: 0.6696586608886719
Epoch: 8, Steps: 12 | Train Loss: 1.942 Vali Loss: 1.920 Vali Acc: 0.483 Test Loss: 1.920 Test Acc: 0.483
Validation loss decreased (-0.438868 --> -0.483314).  Saving model ...
Epoch: 9 cost time: 0.7036635875701904
Epoch: 9, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.810 Vali Acc: 0.511 Test Loss: 1.810 Test Acc: 0.511
Validation loss decreased (-0.483314 --> -0.511093).  Saving model ...
Epoch: 10 cost time: 0.6201257705688477
Epoch: 10, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.726 Vali Acc: 0.544 Test Loss: 1.726 Test Acc: 0.544
Validation loss decreased (-0.511093 --> -0.544427).  Saving model ...
Epoch: 11 cost time: 0.5784451961517334
Epoch: 11, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.640 Vali Acc: 0.578 Test Loss: 1.640 Test Acc: 0.578
Validation loss decreased (-0.544427 --> -0.577761).  Saving model ...
Epoch: 12 cost time: 0.6426799297332764
Epoch: 12, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.569 Vali Acc: 0.578 Test Loss: 1.569 Test Acc: 0.578
Validation loss decreased (-0.577761 --> -0.577762).  Saving model ...
Epoch: 13 cost time: 0.6109144687652588
Epoch: 13, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.519 Vali Acc: 0.589 Test Loss: 1.519 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588874).  Saving model ...
Epoch: 14 cost time: 0.6311323642730713
Epoch: 14, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.479 Vali Acc: 0.578 Test Loss: 1.479 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5399918556213379
Epoch: 15, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.434 Vali Acc: 0.600 Test Loss: 1.434 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 0.5948529243469238
Epoch: 16, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.390 Vali Acc: 0.639 Test Loss: 1.390 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638875).  Saving model ...
Epoch: 17 cost time: 0.5932340621948242
Epoch: 17, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.367 Vali Acc: 0.633 Test Loss: 1.367 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5715832710266113
Epoch: 18, Steps: 12 | Train Loss: 0.934 Vali Loss: 1.341 Vali Acc: 0.622 Test Loss: 1.341 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6131458282470703
Epoch: 19, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.323 Vali Acc: 0.639 Test Loss: 1.323 Test Acc: 0.639
Validation loss decreased (-0.638875 --> -0.638876).  Saving model ...
Epoch: 20 cost time: 0.5880444049835205
Epoch: 20, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.301 Vali Acc: 0.628 Test Loss: 1.301 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6756031513214111
Epoch: 21, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.273 Vali Acc: 0.633 Test Loss: 1.273 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6407747268676758
Epoch: 22, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.242 Vali Acc: 0.639 Test Loss: 1.242 Test Acc: 0.639
Validation loss decreased (-0.638876 --> -0.638876).  Saving model ...
Epoch: 23 cost time: 0.6147704124450684
Epoch: 23, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.218 Vali Acc: 0.644 Test Loss: 1.218 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 24 cost time: 0.6036458015441895
Epoch: 24, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.216 Vali Acc: 0.639 Test Loss: 1.216 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6398355960845947
Epoch: 25, Steps: 12 | Train Loss: 0.680 Vali Loss: 1.184 Vali Acc: 0.667 Test Loss: 1.184 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 26 cost time: 0.579777717590332
Epoch: 26, Steps: 12 | Train Loss: 0.652 Vali Loss: 1.161 Vali Acc: 0.667 Test Loss: 1.161 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 27 cost time: 0.6352107524871826
Epoch: 27, Steps: 12 | Train Loss: 0.622 Vali Loss: 1.144 Vali Acc: 0.656 Test Loss: 1.144 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6534848213195801
Epoch: 28, Steps: 12 | Train Loss: 0.554 Vali Loss: 1.110 Vali Acc: 0.667 Test Loss: 1.110 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 29 cost time: 0.6675889492034912
Epoch: 29, Steps: 12 | Train Loss: 0.521 Vali Loss: 1.084 Vali Acc: 0.683 Test Loss: 1.084 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683322).  Saving model ...
Epoch: 30 cost time: 0.6639406681060791
Epoch: 30, Steps: 12 | Train Loss: 0.529 Vali Loss: 1.085 Vali Acc: 0.683 Test Loss: 1.085 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6242611408233643
Epoch: 31, Steps: 12 | Train Loss: 0.484 Vali Loss: 1.073 Vali Acc: 0.667 Test Loss: 1.073 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.629723310470581
Epoch: 32, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.065 Vali Acc: 0.694 Test Loss: 1.065 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 33 cost time: 0.6147079467773438
Epoch: 33, Steps: 12 | Train Loss: 0.452 Vali Loss: 1.040 Vali Acc: 0.694 Test Loss: 1.040 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 34 cost time: 0.6125588417053223
Epoch: 34, Steps: 12 | Train Loss: 0.422 Vali Loss: 1.016 Vali Acc: 0.706 Test Loss: 1.016 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 35 cost time: 0.5960743427276611
Epoch: 35, Steps: 12 | Train Loss: 0.394 Vali Loss: 1.007 Vali Acc: 0.728 Test Loss: 1.007 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727768).  Saving model ...
Epoch: 36 cost time: 0.6365759372711182
Epoch: 36, Steps: 12 | Train Loss: 0.328 Vali Loss: 1.018 Vali Acc: 0.739 Test Loss: 1.018 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 37 cost time: 0.6668550968170166
Epoch: 37, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.008 Vali Acc: 0.722 Test Loss: 1.008 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6740453243255615
Epoch: 38, Steps: 12 | Train Loss: 0.316 Vali Loss: 1.017 Vali Acc: 0.717 Test Loss: 1.017 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6637072563171387
Epoch: 39, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.007 Vali Acc: 0.711 Test Loss: 1.007 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6404447555541992
Epoch: 40, Steps: 12 | Train Loss: 0.286 Vali Loss: 1.000 Vali Acc: 0.728 Test Loss: 1.000 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7181887626647949
Epoch: 41, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6138701438903809
Epoch: 42, Steps: 12 | Train Loss: 0.279 Vali Loss: 1.000 Vali Acc: 0.728 Test Loss: 1.000 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.629115104675293
Epoch: 43, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.992 Vali Acc: 0.744 Test Loss: 0.992 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 44 cost time: 0.6450676918029785
Epoch: 44, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.990 Vali Acc: 0.744 Test Loss: 0.990 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 45 cost time: 0.6359965801239014
Epoch: 45, Steps: 12 | Train Loss: 0.227 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6711323261260986
Epoch: 46, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6563558578491211
Epoch: 47, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.013 Vali Acc: 0.733 Test Loss: 1.013 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.669590950012207
Epoch: 48, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.015 Vali Acc: 0.733 Test Loss: 1.015 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6349005699157715
Epoch: 49, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.024 Vali Acc: 0.744 Test Loss: 1.024 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6610186100006104
Epoch: 50, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.018 Vali Acc: 0.744 Test Loss: 1.018 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6917099952697754
Epoch: 51, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.039 Vali Acc: 0.744 Test Loss: 1.039 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7206971645355225
Epoch: 52, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.047 Vali Acc: 0.750 Test Loss: 1.047 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 53 cost time: 0.7111234664916992
Epoch: 53, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.050 Vali Acc: 0.733 Test Loss: 1.050 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7499973773956299
Epoch: 54, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.055 Vali Acc: 0.733 Test Loss: 1.055 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6865479946136475
Epoch: 55, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.054 Vali Acc: 0.733 Test Loss: 1.054 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6551947593688965
Epoch: 56, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.054 Vali Acc: 0.744 Test Loss: 1.054 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6403915882110596
Epoch: 57, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.078 Vali Acc: 0.744 Test Loss: 1.078 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6373410224914551
Epoch: 58, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.074 Vali Acc: 0.733 Test Loss: 1.074 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6201717853546143
Epoch: 59, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.081 Vali Acc: 0.739 Test Loss: 1.081 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6215798854827881
Epoch: 60, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.092 Vali Acc: 0.739 Test Loss: 1.092 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.636509895324707
Epoch: 61, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.113 Vali Acc: 0.733 Test Loss: 1.113 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.64119553565979
Epoch: 62, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.142 Vali Acc: 0.733 Test Loss: 1.142 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 13951
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0023574829101562
Epoch: 1, Steps: 12 | Train Loss: 2.920 Vali Loss: 2.814 Vali Acc: 0.083 Test Loss: 2.814 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 0.662327766418457
Epoch: 2, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.723 Vali Acc: 0.111 Test Loss: 2.723 Test Acc: 0.111
Validation loss decreased (-0.083305 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 0.6273870468139648
Epoch: 3, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.603 Vali Acc: 0.189 Test Loss: 2.603 Test Acc: 0.189
Validation loss decreased (-0.111084 --> -0.188863).  Saving model ...
Epoch: 4 cost time: 0.6571152210235596
Epoch: 4, Steps: 12 | Train Loss: 2.568 Vali Loss: 2.467 Vali Acc: 0.244 Test Loss: 2.467 Test Acc: 0.244
Validation loss decreased (-0.188863 --> -0.244420).  Saving model ...
Epoch: 5 cost time: 0.7232749462127686
Epoch: 5, Steps: 12 | Train Loss: 2.460 Vali Loss: 2.335 Vali Acc: 0.294 Test Loss: 2.335 Test Acc: 0.294
Validation loss decreased (-0.244420 --> -0.294421).  Saving model ...
Epoch: 6 cost time: 0.7199604511260986
Epoch: 6, Steps: 12 | Train Loss: 2.285 Vali Loss: 2.203 Vali Acc: 0.367 Test Loss: 2.203 Test Acc: 0.367
Validation loss decreased (-0.294421 --> -0.366645).  Saving model ...
Epoch: 7 cost time: 0.6554462909698486
Epoch: 7, Steps: 12 | Train Loss: 2.098 Vali Loss: 2.081 Vali Acc: 0.422 Test Loss: 2.081 Test Acc: 0.422
Validation loss decreased (-0.366645 --> -0.422201).  Saving model ...
Epoch: 8 cost time: 0.6336090564727783
Epoch: 8, Steps: 12 | Train Loss: 2.015 Vali Loss: 1.971 Vali Acc: 0.472 Test Loss: 1.971 Test Acc: 0.472
Validation loss decreased (-0.422201 --> -0.472203).  Saving model ...
Epoch: 9 cost time: 0.7065689563751221
Epoch: 9, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.869 Vali Acc: 0.522 Test Loss: 1.869 Test Acc: 0.522
Validation loss decreased (-0.472203 --> -0.522204).  Saving model ...
Epoch: 10 cost time: 0.6297900676727295
Epoch: 10, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.778 Vali Acc: 0.539 Test Loss: 1.778 Test Acc: 0.539
Validation loss decreased (-0.522204 --> -0.538871).  Saving model ...
Epoch: 11 cost time: 0.6370923519134521
Epoch: 11, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.712 Vali Acc: 0.550 Test Loss: 1.712 Test Acc: 0.550
Validation loss decreased (-0.538871 --> -0.549983).  Saving model ...
Epoch: 12 cost time: 0.666048526763916
Epoch: 12, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.639 Vali Acc: 0.550 Test Loss: 1.639 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549984).  Saving model ...
Epoch: 13 cost time: 0.6425912380218506
Epoch: 13, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.586 Vali Acc: 0.544 Test Loss: 1.586 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6572816371917725
Epoch: 14, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.535 Vali Acc: 0.578 Test Loss: 1.535 Test Acc: 0.578
Validation loss decreased (-0.549984 --> -0.577762).  Saving model ...
Epoch: 15 cost time: 0.6523311138153076
Epoch: 15, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.503 Vali Acc: 0.561 Test Loss: 1.503 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6695678234100342
Epoch: 16, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.458 Vali Acc: 0.561 Test Loss: 1.458 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6415932178497314
Epoch: 17, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.418 Vali Acc: 0.594 Test Loss: 1.418 Test Acc: 0.594
Validation loss decreased (-0.577762 --> -0.594430).  Saving model ...
Epoch: 18 cost time: 0.6327064037322998
Epoch: 18, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.396 Vali Acc: 0.578 Test Loss: 1.396 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6420407295227051
Epoch: 19, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.371 Vali Acc: 0.611 Test Loss: 1.371 Test Acc: 0.611
Validation loss decreased (-0.594430 --> -0.611097).  Saving model ...
Epoch: 20 cost time: 0.6617107391357422
Epoch: 20, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.348 Vali Acc: 0.617 Test Loss: 1.348 Test Acc: 0.617
Validation loss decreased (-0.611097 --> -0.616653).  Saving model ...
Epoch: 21 cost time: 0.6318964958190918
Epoch: 21, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.331 Vali Acc: 0.611 Test Loss: 1.331 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6773381233215332
Epoch: 22, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.312 Vali Acc: 0.622 Test Loss: 1.312 Test Acc: 0.622
Validation loss decreased (-0.616653 --> -0.622209).  Saving model ...
Epoch: 23 cost time: 0.6816778182983398
Epoch: 23, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.289 Vali Acc: 0.633 Test Loss: 1.289 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 24 cost time: 0.6126463413238525
Epoch: 24, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.259 Vali Acc: 0.633 Test Loss: 1.259 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 25 cost time: 0.6596906185150146
Epoch: 25, Steps: 12 | Train Loss: 0.826 Vali Loss: 1.254 Vali Acc: 0.639 Test Loss: 1.254 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638876).  Saving model ...
Epoch: 26 cost time: 0.6827075481414795
Epoch: 26, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.256 Vali Acc: 0.639 Test Loss: 1.256 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.695554256439209
Epoch: 27, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.225 Vali Acc: 0.672 Test Loss: 1.225 Test Acc: 0.672
Validation loss decreased (-0.638876 --> -0.672210).  Saving model ...
Epoch: 28 cost time: 0.7461433410644531
Epoch: 28, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.209 Vali Acc: 0.650 Test Loss: 1.209 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6713805198669434
Epoch: 29, Steps: 12 | Train Loss: 0.687 Vali Loss: 1.201 Vali Acc: 0.650 Test Loss: 1.201 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6467854976654053
Epoch: 30, Steps: 12 | Train Loss: 0.670 Vali Loss: 1.197 Vali Acc: 0.661 Test Loss: 1.197 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6163685321807861
Epoch: 31, Steps: 12 | Train Loss: 0.621 Vali Loss: 1.175 Vali Acc: 0.672 Test Loss: 1.175 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672210).  Saving model ...
Epoch: 32 cost time: 0.6546049118041992
Epoch: 32, Steps: 12 | Train Loss: 0.628 Vali Loss: 1.166 Vali Acc: 0.678 Test Loss: 1.166 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677766).  Saving model ...
Epoch: 33 cost time: 0.6450660228729248
Epoch: 33, Steps: 12 | Train Loss: 0.575 Vali Loss: 1.145 Vali Acc: 0.678 Test Loss: 1.145 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677766).  Saving model ...
Epoch: 34 cost time: 0.6987001895904541
Epoch: 34, Steps: 12 | Train Loss: 0.581 Vali Loss: 1.133 Vali Acc: 0.689 Test Loss: 1.133 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 35 cost time: 0.61507248878479
Epoch: 35, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.123 Vali Acc: 0.683 Test Loss: 1.123 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6400966644287109
Epoch: 36, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.125 Vali Acc: 0.672 Test Loss: 1.125 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6285111904144287
Epoch: 37, Steps: 12 | Train Loss: 0.484 Vali Loss: 1.106 Vali Acc: 0.683 Test Loss: 1.106 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6118550300598145
Epoch: 38, Steps: 12 | Train Loss: 0.526 Vali Loss: 1.111 Vali Acc: 0.678 Test Loss: 1.111 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6376559734344482
Epoch: 39, Steps: 12 | Train Loss: 0.473 Vali Loss: 1.095 Vali Acc: 0.672 Test Loss: 1.095 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.614750862121582
Epoch: 40, Steps: 12 | Train Loss: 0.409 Vali Loss: 1.089 Vali Acc: 0.689 Test Loss: 1.089 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 41 cost time: 0.6196036338806152
Epoch: 41, Steps: 12 | Train Loss: 0.409 Vali Loss: 1.085 Vali Acc: 0.678 Test Loss: 1.085 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6080708503723145
Epoch: 42, Steps: 12 | Train Loss: 0.417 Vali Loss: 1.072 Vali Acc: 0.689 Test Loss: 1.072 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 43 cost time: 0.6819348335266113
Epoch: 43, Steps: 12 | Train Loss: 0.390 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699989).  Saving model ...
Epoch: 44 cost time: 0.6698343753814697
Epoch: 44, Steps: 12 | Train Loss: 0.365 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 45 cost time: 0.6461000442504883
Epoch: 45, Steps: 12 | Train Loss: 0.350 Vali Loss: 1.072 Vali Acc: 0.694 Test Loss: 1.072 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6846122741699219
Epoch: 46, Steps: 12 | Train Loss: 0.330 Vali Loss: 1.050 Vali Acc: 0.711 Test Loss: 1.050 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 47 cost time: 0.5858447551727295
Epoch: 47, Steps: 12 | Train Loss: 0.314 Vali Loss: 1.065 Vali Acc: 0.689 Test Loss: 1.065 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6987760066986084
Epoch: 48, Steps: 12 | Train Loss: 0.297 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5923056602478027
Epoch: 49, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.619312047958374
Epoch: 50, Steps: 12 | Train Loss: 0.316 Vali Loss: 1.044 Vali Acc: 0.711 Test Loss: 1.044 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 51 cost time: 0.5763301849365234
Epoch: 51, Steps: 12 | Train Loss: 0.277 Vali Loss: 1.046 Vali Acc: 0.706 Test Loss: 1.046 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.638862133026123
Epoch: 52, Steps: 12 | Train Loss: 0.262 Vali Loss: 1.059 Vali Acc: 0.717 Test Loss: 1.059 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716656).  Saving model ...
Epoch: 53 cost time: 0.5879511833190918
Epoch: 53, Steps: 12 | Train Loss: 0.259 Vali Loss: 1.054 Vali Acc: 0.711 Test Loss: 1.054 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6196944713592529
Epoch: 54, Steps: 12 | Train Loss: 0.238 Vali Loss: 1.064 Vali Acc: 0.706 Test Loss: 1.064 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5791268348693848
Epoch: 55, Steps: 12 | Train Loss: 0.274 Vali Loss: 1.059 Vali Acc: 0.711 Test Loss: 1.059 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5917563438415527
Epoch: 56, Steps: 12 | Train Loss: 0.232 Vali Loss: 1.060 Vali Acc: 0.728 Test Loss: 1.060 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727767).  Saving model ...
Epoch: 57 cost time: 0.568856954574585
Epoch: 57, Steps: 12 | Train Loss: 0.193 Vali Loss: 1.055 Vali Acc: 0.711 Test Loss: 1.055 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.580303430557251
Epoch: 58, Steps: 12 | Train Loss: 0.210 Vali Loss: 1.057 Vali Acc: 0.728 Test Loss: 1.057 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727767).  Saving model ...
Epoch: 59 cost time: 0.60945725440979
Epoch: 59, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.064 Vali Acc: 0.728 Test Loss: 1.064 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5839831829071045
Epoch: 60, Steps: 12 | Train Loss: 0.198 Vali Loss: 1.091 Vali Acc: 0.689 Test Loss: 1.091 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5836429595947266
Epoch: 61, Steps: 12 | Train Loss: 0.210 Vali Loss: 1.076 Vali Acc: 0.711 Test Loss: 1.076 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5540852546691895
Epoch: 62, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.059 Vali Acc: 0.722 Test Loss: 1.059 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.5896134376525879
Epoch: 63, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.085 Vali Acc: 0.706 Test Loss: 1.085 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.6169741153717041
Epoch: 64, Steps: 12 | Train Loss: 0.196 Vali Loss: 1.102 Vali Acc: 0.700 Test Loss: 1.102 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.605712890625
Epoch: 65, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.091 Vali Acc: 0.711 Test Loss: 1.091 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.5701379776000977
Epoch: 66, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.102 Vali Acc: 0.717 Test Loss: 1.102 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.5639092922210693
Epoch: 67, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.090 Vali Acc: 0.711 Test Loss: 1.090 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.622556209564209
Epoch: 68, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.092 Vali Acc: 0.717 Test Loss: 1.092 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7277777777777777
model parameter : 10607
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8463690280914307
Epoch: 1, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.661 Vali Acc: 0.100 Test Loss: 2.661 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.6310031414031982
Epoch: 2, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.606 Vali Acc: 0.128 Test Loss: 2.606 Test Acc: 0.128
Validation loss decreased (-0.099973 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 0.5816102027893066
Epoch: 3, Steps: 12 | Train Loss: 2.684 Vali Loss: 2.529 Vali Acc: 0.172 Test Loss: 2.529 Test Acc: 0.172
Validation loss decreased (-0.127752 --> -0.172197).  Saving model ...
Epoch: 4 cost time: 0.57177734375
Epoch: 4, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.441 Vali Acc: 0.239 Test Loss: 2.441 Test Acc: 0.239
Validation loss decreased (-0.172197 --> -0.238864).  Saving model ...
Epoch: 5 cost time: 0.6137666702270508
Epoch: 5, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.345 Vali Acc: 0.289 Test Loss: 2.345 Test Acc: 0.289
Validation loss decreased (-0.238864 --> -0.288865).  Saving model ...
Epoch: 6 cost time: 0.6311914920806885
Epoch: 6, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.254 Vali Acc: 0.306 Test Loss: 2.254 Test Acc: 0.306
Validation loss decreased (-0.288865 --> -0.305533).  Saving model ...
Epoch: 7 cost time: 0.6199543476104736
Epoch: 7, Steps: 12 | Train Loss: 2.210 Vali Loss: 2.160 Vali Acc: 0.344 Test Loss: 2.160 Test Acc: 0.344
Validation loss decreased (-0.305533 --> -0.344423).  Saving model ...
Epoch: 8 cost time: 0.5752136707305908
Epoch: 8, Steps: 12 | Train Loss: 2.168 Vali Loss: 2.068 Vali Acc: 0.383 Test Loss: 2.068 Test Acc: 0.383
Validation loss decreased (-0.344423 --> -0.383313).  Saving model ...
Epoch: 9 cost time: 0.5836477279663086
Epoch: 9, Steps: 12 | Train Loss: 2.070 Vali Loss: 1.981 Vali Acc: 0.433 Test Loss: 1.981 Test Acc: 0.433
Validation loss decreased (-0.383313 --> -0.433314).  Saving model ...
Epoch: 10 cost time: 0.5980038642883301
Epoch: 10, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.905 Vali Acc: 0.439 Test Loss: 1.905 Test Acc: 0.439
Validation loss decreased (-0.433314 --> -0.438870).  Saving model ...
Epoch: 11 cost time: 0.5573437213897705
Epoch: 11, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.829 Vali Acc: 0.478 Test Loss: 1.829 Test Acc: 0.478
Validation loss decreased (-0.438870 --> -0.477759).  Saving model ...
Epoch: 12 cost time: 0.5789079666137695
Epoch: 12, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.765 Vali Acc: 0.500 Test Loss: 1.765 Test Acc: 0.500
Validation loss decreased (-0.477759 --> -0.499982).  Saving model ...
Epoch: 13 cost time: 0.6010048389434814
Epoch: 13, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.708 Vali Acc: 0.528 Test Loss: 1.708 Test Acc: 0.528
Validation loss decreased (-0.499982 --> -0.527761).  Saving model ...
Epoch: 14 cost time: 0.5979173183441162
Epoch: 14, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.657 Vali Acc: 0.539 Test Loss: 1.657 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538872).  Saving model ...
Epoch: 15 cost time: 0.5811202526092529
Epoch: 15, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.605 Vali Acc: 0.556 Test Loss: 1.605 Test Acc: 0.556
Validation loss decreased (-0.538872 --> -0.555540).  Saving model ...
Epoch: 16 cost time: 0.5845053195953369
Epoch: 16, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.560 Vali Acc: 0.561 Test Loss: 1.560 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561096).  Saving model ...
Epoch: 17 cost time: 0.5677351951599121
Epoch: 17, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.521 Vali Acc: 0.583 Test Loss: 1.521 Test Acc: 0.583
Validation loss decreased (-0.561096 --> -0.583318).  Saving model ...
Epoch: 18 cost time: 0.5948567390441895
Epoch: 18, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.483 Vali Acc: 0.589 Test Loss: 1.483 Test Acc: 0.589
Validation loss decreased (-0.583318 --> -0.588874).  Saving model ...
Epoch: 19 cost time: 0.6238255500793457
Epoch: 19, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.458 Vali Acc: 0.578 Test Loss: 1.458 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.580885648727417
Epoch: 20, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.432 Vali Acc: 0.578 Test Loss: 1.432 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.577988862991333
Epoch: 21, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.401 Vali Acc: 0.600 Test Loss: 1.401 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 0.5876390933990479
Epoch: 22, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.377 Vali Acc: 0.606 Test Loss: 1.377 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 23 cost time: 0.5891733169555664
Epoch: 23, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.344 Vali Acc: 0.617 Test Loss: 1.344 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616653).  Saving model ...
Epoch: 24 cost time: 0.5245730876922607
Epoch: 24, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.325 Vali Acc: 0.622 Test Loss: 1.325 Test Acc: 0.622
Validation loss decreased (-0.616653 --> -0.622209).  Saving model ...
Epoch: 25 cost time: 0.6125869750976562
Epoch: 25, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.304 Vali Acc: 0.639 Test Loss: 1.304 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638876).  Saving model ...
Epoch: 26 cost time: 0.6590561866760254
Epoch: 26, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.297 Vali Acc: 0.639 Test Loss: 1.297 Test Acc: 0.639
Validation loss decreased (-0.638876 --> -0.638876).  Saving model ...
Epoch: 27 cost time: 0.5881085395812988
Epoch: 27, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.286 Vali Acc: 0.633 Test Loss: 1.286 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5804014205932617
Epoch: 28, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.273 Vali Acc: 0.622 Test Loss: 1.273 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6297781467437744
Epoch: 29, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.254 Vali Acc: 0.628 Test Loss: 1.254 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6409311294555664
Epoch: 30, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.233 Vali Acc: 0.633 Test Loss: 1.233 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5885007381439209
Epoch: 31, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.218 Vali Acc: 0.644 Test Loss: 1.218 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 32 cost time: 0.5809357166290283
Epoch: 32, Steps: 12 | Train Loss: 0.803 Vali Loss: 1.205 Vali Acc: 0.633 Test Loss: 1.205 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.637047529220581
Epoch: 33, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.196 Vali Acc: 0.650 Test Loss: 1.196 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649988).  Saving model ...
Epoch: 34 cost time: 0.6450519561767578
Epoch: 34, Steps: 12 | Train Loss: 0.733 Vali Loss: 1.183 Vali Acc: 0.656 Test Loss: 1.183 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 35 cost time: 0.6220130920410156
Epoch: 35, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.173 Vali Acc: 0.656 Test Loss: 1.173 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 36 cost time: 0.5892372131347656
Epoch: 36, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.156 Vali Acc: 0.656 Test Loss: 1.156 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 37 cost time: 0.5947260856628418
Epoch: 37, Steps: 12 | Train Loss: 0.694 Vali Loss: 1.140 Vali Acc: 0.661 Test Loss: 1.140 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 38 cost time: 0.5978641510009766
Epoch: 38, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.136 Vali Acc: 0.656 Test Loss: 1.136 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6017038822174072
Epoch: 39, Steps: 12 | Train Loss: 0.598 Vali Loss: 1.119 Vali Acc: 0.656 Test Loss: 1.119 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6292431354522705
Epoch: 40, Steps: 12 | Train Loss: 0.620 Vali Loss: 1.113 Vali Acc: 0.678 Test Loss: 1.113 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 41 cost time: 0.5990030765533447
Epoch: 41, Steps: 12 | Train Loss: 0.542 Vali Loss: 1.087 Vali Acc: 0.678 Test Loss: 1.087 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 42 cost time: 0.6209676265716553
Epoch: 42, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.072 Vali Acc: 0.678 Test Loss: 1.072 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 43 cost time: 0.6479110717773438
Epoch: 43, Steps: 12 | Train Loss: 0.559 Vali Loss: 1.057 Vali Acc: 0.683 Test Loss: 1.057 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 44 cost time: 0.6187937259674072
Epoch: 44, Steps: 12 | Train Loss: 0.559 Vali Loss: 1.052 Vali Acc: 0.672 Test Loss: 1.052 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6780335903167725
Epoch: 45, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.042 Vali Acc: 0.678 Test Loss: 1.042 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6369297504425049
Epoch: 46, Steps: 12 | Train Loss: 0.536 Vali Loss: 1.032 Vali Acc: 0.683 Test Loss: 1.032 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 47 cost time: 0.5924103260040283
Epoch: 47, Steps: 12 | Train Loss: 0.483 Vali Loss: 1.018 Vali Acc: 0.706 Test Loss: 1.018 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705545).  Saving model ...
Epoch: 48 cost time: 0.6096343994140625
Epoch: 48, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.996 Vali Acc: 0.694 Test Loss: 0.996 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.56884765625
Epoch: 49, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.996 Vali Acc: 0.711 Test Loss: 0.996 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 50 cost time: 0.6050186157226562
Epoch: 50, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.990 Vali Acc: 0.728 Test Loss: 0.990 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 51 cost time: 0.6468758583068848
Epoch: 51, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 52 cost time: 0.5977005958557129
Epoch: 52, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5972080230712891
Epoch: 53, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.972 Vali Acc: 0.728 Test Loss: 0.972 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 54 cost time: 0.5828876495361328
Epoch: 54, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.961 Vali Acc: 0.733 Test Loss: 0.961 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 55 cost time: 0.5929865837097168
Epoch: 55, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.943 Vali Acc: 0.728 Test Loss: 0.943 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6006743907928467
Epoch: 56, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.945 Vali Acc: 0.728 Test Loss: 0.945 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.663959264755249
Epoch: 57, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.952 Vali Acc: 0.728 Test Loss: 0.952 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5953915119171143
Epoch: 58, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.954 Vali Acc: 0.728 Test Loss: 0.954 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6191446781158447
Epoch: 59, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.940 Vali Acc: 0.728 Test Loss: 0.940 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.661982536315918
Epoch: 60, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.926 Vali Acc: 0.717 Test Loss: 0.926 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.5937821865081787
Epoch: 61, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.918 Vali Acc: 0.733 Test Loss: 0.918 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 62 cost time: 0.5730373859405518
Epoch: 62, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.933 Vali Acc: 0.722 Test Loss: 0.933 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5810215473175049
Epoch: 63, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.925 Vali Acc: 0.733 Test Loss: 0.925 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6031942367553711
Epoch: 64, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.931 Vali Acc: 0.728 Test Loss: 0.931 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.634392261505127
Epoch: 65, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.930 Vali Acc: 0.717 Test Loss: 0.930 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6145989894866943
Epoch: 66, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.919 Vali Acc: 0.733 Test Loss: 0.919 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.6630358695983887
Epoch: 67, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.929 Vali Acc: 0.733 Test Loss: 0.929 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.5898826122283936
Epoch: 68, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.931 Vali Acc: 0.739 Test Loss: 0.931 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 69 cost time: 0.5817477703094482
Epoch: 69, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749991).  Saving model ...
Epoch: 70 cost time: 0.6428043842315674
Epoch: 70, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.932 Vali Acc: 0.728 Test Loss: 0.932 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6135556697845459
Epoch: 71, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.943 Vali Acc: 0.733 Test Loss: 0.943 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.6477947235107422
Epoch: 72, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.935 Vali Acc: 0.744 Test Loss: 0.935 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.5965838432312012
Epoch: 73, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.5885918140411377
Epoch: 74, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.948 Vali Acc: 0.744 Test Loss: 0.948 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.5536811351776123
Epoch: 75, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.954 Vali Acc: 0.739 Test Loss: 0.954 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.5569403171539307
Epoch: 76, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.949 Vali Acc: 0.744 Test Loss: 0.949 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.5880053043365479
Epoch: 77, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.955 Vali Acc: 0.744 Test Loss: 0.955 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.5608601570129395
Epoch: 78, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.951 Vali Acc: 0.728 Test Loss: 0.951 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.5886297225952148
Epoch: 79, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 8719
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.783506155014038
Epoch: 1, Steps: 12 | Train Loss: 2.892 Vali Loss: 2.816 Vali Acc: 0.072 Test Loss: 2.816 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 0.6378130912780762
Epoch: 2, Steps: 12 | Train Loss: 2.861 Vali Loss: 2.787 Vali Acc: 0.067 Test Loss: 2.787 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6272938251495361
Epoch: 3, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.727 Vali Acc: 0.111 Test Loss: 2.727 Test Acc: 0.111
Validation loss decreased (-0.072194 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 0.6228876113891602
Epoch: 4, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.649 Vali Acc: 0.161 Test Loss: 2.649 Test Acc: 0.161
Validation loss decreased (-0.111084 --> -0.161085).  Saving model ...
Epoch: 5 cost time: 0.6080117225646973
Epoch: 5, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.562 Vali Acc: 0.183 Test Loss: 2.562 Test Acc: 0.183
Validation loss decreased (-0.161085 --> -0.183308).  Saving model ...
Epoch: 6 cost time: 0.6003947257995605
Epoch: 6, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.469 Vali Acc: 0.222 Test Loss: 2.469 Test Acc: 0.222
Validation loss decreased (-0.183308 --> -0.222198).  Saving model ...
Epoch: 7 cost time: 0.6025731563568115
Epoch: 7, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.373 Vali Acc: 0.289 Test Loss: 2.373 Test Acc: 0.289
Validation loss decreased (-0.222198 --> -0.288865).  Saving model ...
Epoch: 8 cost time: 0.5892608165740967
Epoch: 8, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.284 Vali Acc: 0.322 Test Loss: 2.284 Test Acc: 0.322
Validation loss decreased (-0.288865 --> -0.322199).  Saving model ...
Epoch: 9 cost time: 0.6125426292419434
Epoch: 9, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.193 Vali Acc: 0.378 Test Loss: 2.193 Test Acc: 0.378
Validation loss decreased (-0.322199 --> -0.377756).  Saving model ...
Epoch: 10 cost time: 0.6078877449035645
Epoch: 10, Steps: 12 | Train Loss: 2.157 Vali Loss: 2.107 Vali Acc: 0.389 Test Loss: 2.107 Test Acc: 0.389
Validation loss decreased (-0.377756 --> -0.388868).  Saving model ...
Epoch: 11 cost time: 0.6064333915710449
Epoch: 11, Steps: 12 | Train Loss: 1.976 Vali Loss: 2.028 Vali Acc: 0.417 Test Loss: 2.028 Test Acc: 0.417
Validation loss decreased (-0.388868 --> -0.416646).  Saving model ...
Epoch: 12 cost time: 0.5789628028869629
Epoch: 12, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.952 Vali Acc: 0.439 Test Loss: 1.952 Test Acc: 0.439
Validation loss decreased (-0.416646 --> -0.438869).  Saving model ...
Epoch: 13 cost time: 0.5783092975616455
Epoch: 13, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.879 Vali Acc: 0.456 Test Loss: 1.879 Test Acc: 0.456
Validation loss decreased (-0.438869 --> -0.455537).  Saving model ...
Epoch: 14 cost time: 0.585780143737793
Epoch: 14, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.814 Vali Acc: 0.483 Test Loss: 1.814 Test Acc: 0.483
Validation loss decreased (-0.455537 --> -0.483315).  Saving model ...
Epoch: 15 cost time: 0.6026859283447266
Epoch: 15, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.756 Vali Acc: 0.500 Test Loss: 1.756 Test Acc: 0.500
Validation loss decreased (-0.483315 --> -0.499982).  Saving model ...
Epoch: 16 cost time: 0.6137816905975342
Epoch: 16, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.706 Vali Acc: 0.511 Test Loss: 1.706 Test Acc: 0.511
Validation loss decreased (-0.499982 --> -0.511094).  Saving model ...
Epoch: 17 cost time: 0.6218171119689941
Epoch: 17, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.656 Vali Acc: 0.533 Test Loss: 1.656 Test Acc: 0.533
Validation loss decreased (-0.511094 --> -0.533317).  Saving model ...
Epoch: 18 cost time: 0.5917313098907471
Epoch: 18, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.612 Vali Acc: 0.550 Test Loss: 1.612 Test Acc: 0.550
Validation loss decreased (-0.533317 --> -0.549984).  Saving model ...
Epoch: 19 cost time: 0.6212565898895264
Epoch: 19, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.569 Vali Acc: 0.572 Test Loss: 1.569 Test Acc: 0.572
Validation loss decreased (-0.549984 --> -0.572207).  Saving model ...
Epoch: 20 cost time: 0.6339294910430908
Epoch: 20, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.529 Vali Acc: 0.578 Test Loss: 1.529 Test Acc: 0.578
Validation loss decreased (-0.572207 --> -0.577762).  Saving model ...
Epoch: 21 cost time: 0.5641820430755615
Epoch: 21, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.494 Vali Acc: 0.572 Test Loss: 1.494 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6701302528381348
Epoch: 22, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.456 Vali Acc: 0.600 Test Loss: 1.456 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599985).  Saving model ...
Epoch: 23 cost time: 0.5853357315063477
Epoch: 23, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.417 Vali Acc: 0.611 Test Loss: 1.417 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 24 cost time: 0.6103701591491699
Epoch: 24, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.391 Vali Acc: 0.611 Test Loss: 1.391 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611097).  Saving model ...
Epoch: 25 cost time: 0.5921957492828369
Epoch: 25, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.358 Vali Acc: 0.622 Test Loss: 1.358 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 26 cost time: 0.7053301334381104
Epoch: 26, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.327 Vali Acc: 0.611 Test Loss: 1.327 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6236505508422852
Epoch: 27, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.293 Vali Acc: 0.639 Test Loss: 1.293 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638876).  Saving model ...
Epoch: 28 cost time: 0.6023373603820801
Epoch: 28, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.262 Vali Acc: 0.656 Test Loss: 1.262 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655543).  Saving model ...
Epoch: 29 cost time: 0.6793627738952637
Epoch: 29, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.224 Vali Acc: 0.650 Test Loss: 1.224 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7394649982452393
Epoch: 30, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.189 Vali Acc: 0.633 Test Loss: 1.189 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6586098670959473
Epoch: 31, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.164 Vali Acc: 0.644 Test Loss: 1.164 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6674203872680664
Epoch: 32, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.143 Vali Acc: 0.650 Test Loss: 1.143 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6867878437042236
Epoch: 33, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.114 Vali Acc: 0.644 Test Loss: 1.114 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5808780193328857
Epoch: 34, Steps: 12 | Train Loss: 0.748 Vali Loss: 1.092 Vali Acc: 0.672 Test Loss: 1.092 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672211).  Saving model ...
Epoch: 35 cost time: 0.656334638595581
Epoch: 35, Steps: 12 | Train Loss: 0.710 Vali Loss: 1.074 Vali Acc: 0.672 Test Loss: 1.074 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 36 cost time: 0.6276872158050537
Epoch: 36, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.048 Vali Acc: 0.672 Test Loss: 1.048 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672212).  Saving model ...
Epoch: 37 cost time: 0.6256027221679688
Epoch: 37, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.028 Vali Acc: 0.661 Test Loss: 1.028 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6187727451324463
Epoch: 38, Steps: 12 | Train Loss: 0.654 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6726639270782471
Epoch: 39, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.999 Vali Acc: 0.667 Test Loss: 0.999 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6315743923187256
Epoch: 40, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.979 Vali Acc: 0.656 Test Loss: 0.979 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6258378028869629
Epoch: 41, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.961 Vali Acc: 0.672 Test Loss: 0.961 Test Acc: 0.672
Validation loss decreased (-0.672212 --> -0.672213).  Saving model ...
Epoch: 42 cost time: 0.5974540710449219
Epoch: 42, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.963 Vali Acc: 0.678 Test Loss: 0.963 Test Acc: 0.678
Validation loss decreased (-0.672213 --> -0.677768).  Saving model ...
Epoch: 43 cost time: 0.6333622932434082
Epoch: 43, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.950 Vali Acc: 0.678 Test Loss: 0.950 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 44 cost time: 0.6340575218200684
Epoch: 44, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.936 Vali Acc: 0.694 Test Loss: 0.936 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 45 cost time: 0.6122696399688721
Epoch: 45, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.915 Vali Acc: 0.711 Test Loss: 0.915 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 46 cost time: 0.5891191959381104
Epoch: 46, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.901 Vali Acc: 0.711 Test Loss: 0.901 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 47 cost time: 0.6026558876037598
Epoch: 47, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.901 Vali Acc: 0.711 Test Loss: 0.901 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 48 cost time: 0.7365550994873047
Epoch: 48, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.892 Vali Acc: 0.722 Test Loss: 0.892 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722213).  Saving model ...
Epoch: 49 cost time: 0.6120302677154541
Epoch: 49, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.881 Vali Acc: 0.733 Test Loss: 0.881 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 50 cost time: 0.6095619201660156
Epoch: 50, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.891 Vali Acc: 0.678 Test Loss: 0.891 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6061193943023682
Epoch: 51, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.885 Vali Acc: 0.689 Test Loss: 0.885 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6114025115966797
Epoch: 52, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.875 Vali Acc: 0.711 Test Loss: 0.875 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.6092970371246338
Epoch: 53, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.861 Vali Acc: 0.733 Test Loss: 0.861 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 54 cost time: 0.5592513084411621
Epoch: 54, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.858 Vali Acc: 0.739 Test Loss: 0.858 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738880).  Saving model ...
Epoch: 55 cost time: 0.638786792755127
Epoch: 55, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.853 Vali Acc: 0.744 Test Loss: 0.853 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 56 cost time: 0.6560111045837402
Epoch: 56, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 57 cost time: 0.6395719051361084
Epoch: 57, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5911881923675537
Epoch: 58, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.839 Vali Acc: 0.733 Test Loss: 0.839 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5785408020019531
Epoch: 59, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.840 Vali Acc: 0.739 Test Loss: 0.840 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.6228723526000977
Epoch: 60, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.827 Vali Acc: 0.739 Test Loss: 0.827 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.612229585647583
Epoch: 61, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.827 Vali Acc: 0.744 Test Loss: 0.827 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5860579013824463
Epoch: 62, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.840 Vali Acc: 0.744 Test Loss: 0.840 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.6311428546905518
Epoch: 63, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.834 Vali Acc: 0.739 Test Loss: 0.834 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.6650254726409912
Epoch: 64, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.6254322528839111
Epoch: 65, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.829 Vali Acc: 0.739 Test Loss: 0.829 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.6603598594665527
Epoch: 66, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.817 Vali Acc: 0.744 Test Loss: 0.817 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 7791
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.121734857559204
Epoch: 1, Steps: 12 | Train Loss: 2.948 Vali Loss: 2.906 Vali Acc: 0.067 Test Loss: 2.906 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 0.655043363571167
Epoch: 2, Steps: 12 | Train Loss: 2.903 Vali Loss: 2.866 Vali Acc: 0.072 Test Loss: 2.866 Test Acc: 0.072
Validation loss decreased (-0.066638 --> -0.072194).  Saving model ...
Epoch: 3 cost time: 0.6679766178131104
Epoch: 3, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.811 Vali Acc: 0.117 Test Loss: 2.811 Test Acc: 0.117
Validation loss decreased (-0.072194 --> -0.116639).  Saving model ...
Epoch: 4 cost time: 0.6075699329376221
Epoch: 4, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.744 Vali Acc: 0.156 Test Loss: 2.744 Test Acc: 0.156
Validation loss decreased (-0.116639 --> -0.155528).  Saving model ...
Epoch: 5 cost time: 0.5832178592681885
Epoch: 5, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.671 Vali Acc: 0.183 Test Loss: 2.671 Test Acc: 0.183
Validation loss decreased (-0.155528 --> -0.183307).  Saving model ...
Epoch: 6 cost time: 0.6826801300048828
Epoch: 6, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.592 Vali Acc: 0.233 Test Loss: 2.592 Test Acc: 0.233
Validation loss decreased (-0.183307 --> -0.233307).  Saving model ...
Epoch: 7 cost time: 0.6822292804718018
Epoch: 7, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.510 Vali Acc: 0.278 Test Loss: 2.510 Test Acc: 0.278
Validation loss decreased (-0.233307 --> -0.277753).  Saving model ...
Epoch: 8 cost time: 0.6082007884979248
Epoch: 8, Steps: 12 | Train Loss: 2.442 Vali Loss: 2.428 Vali Acc: 0.300 Test Loss: 2.428 Test Acc: 0.300
Validation loss decreased (-0.277753 --> -0.299976).  Saving model ...
Epoch: 9 cost time: 0.5892865657806396
Epoch: 9, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.349 Vali Acc: 0.333 Test Loss: 2.349 Test Acc: 0.333
Validation loss decreased (-0.299976 --> -0.333310).  Saving model ...
Epoch: 10 cost time: 0.5582811832427979
Epoch: 10, Steps: 12 | Train Loss: 2.230 Vali Loss: 2.265 Vali Acc: 0.372 Test Loss: 2.265 Test Acc: 0.372
Validation loss decreased (-0.333310 --> -0.372200).  Saving model ...
Epoch: 11 cost time: 0.6596090793609619
Epoch: 11, Steps: 12 | Train Loss: 2.172 Vali Loss: 2.187 Vali Acc: 0.389 Test Loss: 2.187 Test Acc: 0.389
Validation loss decreased (-0.372200 --> -0.388867).  Saving model ...
Epoch: 12 cost time: 0.5429317951202393
Epoch: 12, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.106 Vali Acc: 0.406 Test Loss: 2.106 Test Acc: 0.406
Validation loss decreased (-0.388867 --> -0.405534).  Saving model ...
Epoch: 13 cost time: 0.6125731468200684
Epoch: 13, Steps: 12 | Train Loss: 2.031 Vali Loss: 2.034 Vali Acc: 0.406 Test Loss: 2.034 Test Acc: 0.406
Validation loss decreased (-0.405534 --> -0.405535).  Saving model ...
Epoch: 14 cost time: 0.6262545585632324
Epoch: 14, Steps: 12 | Train Loss: 1.942 Vali Loss: 1.970 Vali Acc: 0.433 Test Loss: 1.970 Test Acc: 0.433
Validation loss decreased (-0.405535 --> -0.433314).  Saving model ...
Epoch: 15 cost time: 0.5774381160736084
Epoch: 15, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.907 Vali Acc: 0.461 Test Loss: 1.907 Test Acc: 0.461
Validation loss decreased (-0.433314 --> -0.461092).  Saving model ...
Epoch: 16 cost time: 0.60845947265625
Epoch: 16, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.847 Vali Acc: 0.500 Test Loss: 1.847 Test Acc: 0.500
Validation loss decreased (-0.461092 --> -0.499982).  Saving model ...
Epoch: 17 cost time: 0.6001710891723633
Epoch: 17, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.791 Vali Acc: 0.517 Test Loss: 1.791 Test Acc: 0.517
Validation loss decreased (-0.499982 --> -0.516649).  Saving model ...
Epoch: 18 cost time: 0.5518782138824463
Epoch: 18, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.742 Vali Acc: 0.528 Test Loss: 1.742 Test Acc: 0.528
Validation loss decreased (-0.516649 --> -0.527760).  Saving model ...
Epoch: 19 cost time: 0.5691618919372559
Epoch: 19, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.696 Vali Acc: 0.539 Test Loss: 1.696 Test Acc: 0.539
Validation loss decreased (-0.527760 --> -0.538872).  Saving model ...
Epoch: 20 cost time: 0.5887477397918701
Epoch: 20, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.650 Vali Acc: 0.539 Test Loss: 1.650 Test Acc: 0.539
Validation loss decreased (-0.538872 --> -0.538872).  Saving model ...
Epoch: 21 cost time: 0.5915412902832031
Epoch: 21, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.608 Vali Acc: 0.550 Test Loss: 1.608 Test Acc: 0.550
Validation loss decreased (-0.538872 --> -0.549984).  Saving model ...
Epoch: 22 cost time: 0.590195894241333
Epoch: 22, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.571 Vali Acc: 0.556 Test Loss: 1.571 Test Acc: 0.556
Validation loss decreased (-0.549984 --> -0.555540).  Saving model ...
Epoch: 23 cost time: 0.5580079555511475
Epoch: 23, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.536 Vali Acc: 0.561 Test Loss: 1.536 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561096).  Saving model ...
Epoch: 24 cost time: 0.5457360744476318
Epoch: 24, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.502 Vali Acc: 0.567 Test Loss: 1.502 Test Acc: 0.567
Validation loss decreased (-0.561096 --> -0.566652).  Saving model ...
Epoch: 25 cost time: 0.6049249172210693
Epoch: 25, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.467 Vali Acc: 0.567 Test Loss: 1.467 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 26 cost time: 0.5468113422393799
Epoch: 26, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.434 Vali Acc: 0.567 Test Loss: 1.434 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 27 cost time: 0.5978198051452637
Epoch: 27, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.409 Vali Acc: 0.583 Test Loss: 1.409 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583319).  Saving model ...
Epoch: 28 cost time: 0.5700697898864746
Epoch: 28, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.381 Vali Acc: 0.589 Test Loss: 1.381 Test Acc: 0.589
Validation loss decreased (-0.583319 --> -0.588875).  Saving model ...
Epoch: 29 cost time: 0.5987935066223145
Epoch: 29, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.348 Vali Acc: 0.606 Test Loss: 1.348 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605542).  Saving model ...
Epoch: 30 cost time: 0.5861330032348633
Epoch: 30, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.327 Vali Acc: 0.611 Test Loss: 1.327 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611098).  Saving model ...
Epoch: 31 cost time: 0.5733487606048584
Epoch: 31, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.300 Vali Acc: 0.617 Test Loss: 1.300 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616654).  Saving model ...
Epoch: 32 cost time: 0.6012527942657471
Epoch: 32, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.279 Vali Acc: 0.617 Test Loss: 1.279 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 33 cost time: 0.5607903003692627
Epoch: 33, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.249 Vali Acc: 0.622 Test Loss: 1.249 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 34 cost time: 0.60019850730896
Epoch: 34, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.220 Vali Acc: 0.611 Test Loss: 1.220 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5430285930633545
Epoch: 35, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.196 Vali Acc: 0.628 Test Loss: 1.196 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 36 cost time: 0.5539860725402832
Epoch: 36, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.168 Vali Acc: 0.639 Test Loss: 1.168 Test Acc: 0.639
Validation loss decreased (-0.627766 --> -0.638877).  Saving model ...
Epoch: 37 cost time: 0.48607897758483887
Epoch: 37, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.154 Vali Acc: 0.633 Test Loss: 1.154 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5801701545715332
Epoch: 38, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.122 Vali Acc: 0.644 Test Loss: 1.122 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 39 cost time: 0.5676620006561279
Epoch: 39, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.101 Vali Acc: 0.672 Test Loss: 1.101 Test Acc: 0.672
Validation loss decreased (-0.644433 --> -0.672211).  Saving model ...
Epoch: 40 cost time: 0.7115767002105713
Epoch: 40, Steps: 12 | Train Loss: 0.699 Vali Loss: 1.078 Vali Acc: 0.672 Test Loss: 1.078 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 41 cost time: 0.6025428771972656
Epoch: 41, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.061 Vali Acc: 0.689 Test Loss: 1.061 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 42 cost time: 0.6226537227630615
Epoch: 42, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.047 Vali Acc: 0.689 Test Loss: 1.047 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 43 cost time: 0.6035473346710205
Epoch: 43, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 0.592832088470459
Epoch: 44, Steps: 12 | Train Loss: 0.573 Vali Loss: 1.010 Vali Acc: 0.706 Test Loss: 1.010 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705545).  Saving model ...
Epoch: 45 cost time: 0.5862524509429932
Epoch: 45, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 46 cost time: 0.5878722667694092
Epoch: 46, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.992 Vali Acc: 0.706 Test Loss: 0.992 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5549468994140625
Epoch: 47, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.980 Vali Acc: 0.689 Test Loss: 0.980 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6396245956420898
Epoch: 48, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.972 Vali Acc: 0.694 Test Loss: 0.972 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6286439895629883
Epoch: 49, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.962 Vali Acc: 0.689 Test Loss: 0.962 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.676386833190918
Epoch: 50, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.951 Vali Acc: 0.694 Test Loss: 0.951 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6303074359893799
Epoch: 51, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.940 Vali Acc: 0.694 Test Loss: 0.940 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5487208366394043
Epoch: 52, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.928 Vali Acc: 0.689 Test Loss: 0.928 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.5988197326660156
Epoch: 53, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.927 Vali Acc: 0.694 Test Loss: 0.927 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.6211888790130615
Epoch: 54, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.922 Vali Acc: 0.706 Test Loss: 0.922 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.5989937782287598
Epoch: 55, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.907 Vali Acc: 0.717 Test Loss: 0.907 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716658).  Saving model ...
Epoch: 56 cost time: 0.635176420211792
Epoch: 56, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5862777233123779
Epoch: 57, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.916 Vali Acc: 0.717 Test Loss: 0.916 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6363906860351562
Epoch: 58, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.909 Vali Acc: 0.722 Test Loss: 0.909 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722213).  Saving model ...
Epoch: 59 cost time: 0.635045051574707
Epoch: 59, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.892 Vali Acc: 0.728 Test Loss: 0.892 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 60 cost time: 0.5964071750640869
Epoch: 60, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.893 Vali Acc: 0.728 Test Loss: 0.893 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5810551643371582
Epoch: 61, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.888 Vali Acc: 0.744 Test Loss: 0.888 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 62 cost time: 0.6764283180236816
Epoch: 62, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.884 Vali Acc: 0.728 Test Loss: 0.884 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6302580833435059
Epoch: 63, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.886 Vali Acc: 0.722 Test Loss: 0.886 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6687135696411133
Epoch: 64, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.877 Vali Acc: 0.733 Test Loss: 0.877 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6089868545532227
Epoch: 65, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.886 Vali Acc: 0.728 Test Loss: 0.886 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6462395191192627
Epoch: 66, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.885 Vali Acc: 0.739 Test Loss: 0.885 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.637413740158081
Epoch: 67, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.882 Vali Acc: 0.744 Test Loss: 0.882 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 68 cost time: 0.6652369499206543
Epoch: 68, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.875 Vali Acc: 0.728 Test Loss: 0.875 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6692874431610107
Epoch: 69, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749991).  Saving model ...
Epoch: 70 cost time: 0.6475317478179932
Epoch: 70, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 71 cost time: 0.6485071182250977
Epoch: 71, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6487026214599609
Epoch: 72, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.874 Vali Acc: 0.744 Test Loss: 0.874 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5913820266723633
Epoch: 73, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.879 Vali Acc: 0.756 Test Loss: 0.879 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 74 cost time: 0.6898088455200195
Epoch: 74, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.875 Vali Acc: 0.728 Test Loss: 0.875 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.6156022548675537
Epoch: 75, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.881 Vali Acc: 0.728 Test Loss: 0.881 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.6629579067230225
Epoch: 76, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.881 Vali Acc: 0.717 Test Loss: 0.881 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.6748127937316895
Epoch: 77, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.870 Vali Acc: 0.744 Test Loss: 0.870 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.602041482925415
Epoch: 78, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.862 Vali Acc: 0.739 Test Loss: 0.862 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.5870227813720703
Epoch: 79, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.869 Vali Acc: 0.739 Test Loss: 0.869 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.6308515071868896
Epoch: 80, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.876 Vali Acc: 0.744 Test Loss: 0.876 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.6086246967315674
Epoch: 81, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.5904049873352051
Epoch: 82, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.875 Vali Acc: 0.722 Test Loss: 0.875 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.6450040340423584
Epoch: 83, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.888 Vali Acc: 0.733 Test Loss: 0.888 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_PatchTST_UEA_ftM_sl45_ll0_pl0_el1_dm16_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 6879
model size : 0.34MB
