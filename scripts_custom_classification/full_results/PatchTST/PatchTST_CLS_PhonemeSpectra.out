Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8741612
	speed: 0.2469s/iter; left time: 5111.8899s
	iters: 200, epoch: 1 | loss: 4.1018424
	speed: 0.2308s/iter; left time: 4755.0205s
Epoch: 1 cost time: 49.39423990249634
Epoch: 1, Steps: 208 | Train Loss: 4.589 Vali Loss: 4.324 Vali Acc: 0.047 Test Loss: 4.324 Test Acc: 0.047
Validation loss decreased (inf --> -0.047377).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9456000
	speed: 0.6364s/iter; left time: 13041.6458s
	iters: 200, epoch: 2 | loss: 4.4744625
	speed: 0.2731s/iter; left time: 5568.5988s
Epoch: 2 cost time: 55.70340347290039
Epoch: 2, Steps: 208 | Train Loss: 4.289 Vali Loss: 5.001 Vali Acc: 0.053 Test Loss: 5.001 Test Acc: 0.053
Validation loss decreased (-0.047377 --> -0.052739).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.7029200
	speed: 0.7366s/iter; left time: 14941.8933s
	iters: 200, epoch: 3 | loss: 6.0830297
	speed: 0.2616s/iter; left time: 5280.2144s
Epoch: 3 cost time: 54.82945489883423
Epoch: 3, Steps: 208 | Train Loss: 5.069 Vali Loss: 3.932 Vali Acc: 0.099 Test Loss: 3.932 Test Acc: 0.099
Validation loss decreased (-0.052739 --> -0.098976).  Saving model ...
	iters: 100, epoch: 4 | loss: 5.1354980
	speed: 0.6478s/iter; left time: 13006.7513s
	iters: 200, epoch: 4 | loss: 5.7506285
	speed: 0.2264s/iter; left time: 4521.8272s
Epoch: 4 cost time: 47.65182614326477
Epoch: 4, Steps: 208 | Train Loss: 5.608 Vali Loss: 7.732 Vali Acc: 0.057 Test Loss: 7.732 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 6.4724975
	speed: 0.6304s/iter; left time: 12524.9476s
	iters: 200, epoch: 5 | loss: 4.2915001
	speed: 0.2692s/iter; left time: 5321.2859s
Epoch: 5 cost time: 52.11199998855591
Epoch: 5, Steps: 208 | Train Loss: 5.861 Vali Loss: 6.937 Vali Acc: 0.118 Test Loss: 6.937 Test Acc: 0.118
Validation loss decreased (-0.098976 --> -0.117437).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.1359844
	speed: 0.6971s/iter; left time: 13704.7002s
	iters: 200, epoch: 6 | loss: 8.3865728
	speed: 0.2356s/iter; left time: 4608.8896s
Epoch: 6 cost time: 51.09324645996094
Epoch: 6, Steps: 208 | Train Loss: 6.015 Vali Loss: 8.952 Vali Acc: 0.070 Test Loss: 8.952 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 6.1873970
	speed: 0.6941s/iter; left time: 13501.4898s
	iters: 200, epoch: 7 | loss: 4.4097295
	speed: 0.2256s/iter; left time: 4365.2350s
Epoch: 7 cost time: 52.059303283691406
Epoch: 7, Steps: 208 | Train Loss: 5.579 Vali Loss: 6.089 Vali Acc: 0.108 Test Loss: 6.089 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 7.3904462
	speed: 0.7821s/iter; left time: 15051.7971s
	iters: 200, epoch: 8 | loss: 7.1025271
	speed: 0.2637s/iter; left time: 5049.4477s
Epoch: 8 cost time: 58.95572113990784
Epoch: 8, Steps: 208 | Train Loss: 5.067 Vali Loss: 6.879 Vali Acc: 0.108 Test Loss: 6.879 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.5339653
	speed: 0.7795s/iter; left time: 14839.1915s
	iters: 200, epoch: 9 | loss: 4.1522179
	speed: 0.2380s/iter; left time: 4507.1378s
Epoch: 9 cost time: 54.96881937980652
Epoch: 9, Steps: 208 | Train Loss: 4.196 Vali Loss: 8.953 Vali Acc: 0.076 Test Loss: 8.953 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.1690176
	speed: 0.6886s/iter; left time: 12965.1907s
	iters: 200, epoch: 10 | loss: 2.2305896
	speed: 0.2546s/iter; left time: 4769.3148s
Epoch: 10 cost time: 54.61603283882141
Epoch: 10, Steps: 208 | Train Loss: 2.926 Vali Loss: 8.066 Vali Acc: 0.108 Test Loss: 8.066 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.8179227
	speed: 0.6439s/iter; left time: 11990.3190s
	iters: 200, epoch: 11 | loss: 1.5734465
	speed: 0.2511s/iter; left time: 4650.3984s
Epoch: 11 cost time: 51.12620401382446
Epoch: 11, Steps: 208 | Train Loss: 2.076 Vali Loss: 7.902 Vali Acc: 0.072 Test Loss: 7.902 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.4955747
	speed: 0.6839s/iter; left time: 12592.8627s
	iters: 200, epoch: 12 | loss: 2.1467433
	speed: 0.2821s/iter; left time: 5166.5563s
Epoch: 12 cost time: 57.826414585113525
Epoch: 12, Steps: 208 | Train Loss: 1.582 Vali Loss: 6.902 Vali Acc: 0.119 Test Loss: 6.902 Test Acc: 0.119
Validation loss decreased (-0.117437 --> -0.119227).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2272413
	speed: 0.7487s/iter; left time: 13629.5927s
	iters: 200, epoch: 13 | loss: 1.6728175
	speed: 0.3014s/iter; left time: 5456.1125s
Epoch: 13 cost time: 61.592180013656616
Epoch: 13, Steps: 208 | Train Loss: 1.283 Vali Loss: 5.352 Vali Acc: 0.118 Test Loss: 5.352 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3347363
	speed: 0.6952s/iter; left time: 12510.8092s
	iters: 200, epoch: 14 | loss: 1.2519575
	speed: 0.2947s/iter; left time: 5274.3563s
Epoch: 14 cost time: 57.588414430618286
Epoch: 14, Steps: 208 | Train Loss: 1.043 Vali Loss: 6.525 Vali Acc: 0.127 Test Loss: 6.525 Test Acc: 0.127
Validation loss decreased (-0.119227 --> -0.127283).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4565784
	speed: 0.6761s/iter; left time: 12027.2536s
	iters: 200, epoch: 15 | loss: 0.3180232
	speed: 0.2581s/iter; left time: 4564.9397s
Epoch: 15 cost time: 50.969754457473755
Epoch: 15, Steps: 208 | Train Loss: 0.843 Vali Loss: 8.524 Vali Acc: 0.124 Test Loss: 8.524 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7998703
	speed: 0.6535s/iter; left time: 11489.8799s
	iters: 200, epoch: 16 | loss: 0.2773124
	speed: 0.2699s/iter; left time: 4718.8256s
Epoch: 16 cost time: 53.08104944229126
Epoch: 16, Steps: 208 | Train Loss: 0.727 Vali Loss: 6.585 Vali Acc: 0.121 Test Loss: 6.585 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3249464
	speed: 0.6693s/iter; left time: 11628.1261s
	iters: 200, epoch: 17 | loss: 0.8216652
	speed: 0.2504s/iter; left time: 4325.0061s
Epoch: 17 cost time: 50.476293325424194
Epoch: 17, Steps: 208 | Train Loss: 0.603 Vali Loss: 6.687 Vali Acc: 0.117 Test Loss: 6.687 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4889334
	speed: 0.6480s/iter; left time: 11122.4692s
	iters: 200, epoch: 18 | loss: 1.0001624
	speed: 0.2306s/iter; left time: 3934.6101s
Epoch: 18 cost time: 48.38055109977722
Epoch: 18, Steps: 208 | Train Loss: 0.471 Vali Loss: 8.194 Vali Acc: 0.129 Test Loss: 8.194 Test Acc: 0.129
Validation loss decreased (-0.127283 --> -0.129056).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1654280
	speed: 0.6590s/iter; left time: 11174.2251s
	iters: 200, epoch: 19 | loss: 0.6832219
	speed: 0.2331s/iter; left time: 3929.2868s
Epoch: 19 cost time: 49.890891790390015
Epoch: 19, Steps: 208 | Train Loss: 0.420 Vali Loss: 9.456 Vali Acc: 0.118 Test Loss: 9.456 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.2478119
	speed: 0.7380s/iter; left time: 12361.4748s
	iters: 200, epoch: 20 | loss: 0.3486739
	speed: 0.3223s/iter; left time: 5366.1640s
Epoch: 20 cost time: 64.06563711166382
Epoch: 20, Steps: 208 | Train Loss: 0.351 Vali Loss: 8.972 Vali Acc: 0.126 Test Loss: 8.972 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0404854
	speed: 0.8204s/iter; left time: 13570.5832s
	iters: 200, epoch: 21 | loss: 0.7155269
	speed: 0.2463s/iter; left time: 4048.6324s
Epoch: 21 cost time: 59.71514296531677
Epoch: 21, Steps: 208 | Train Loss: 0.283 Vali Loss: 9.075 Vali Acc: 0.126 Test Loss: 9.075 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0867044
	speed: 0.7748s/iter; left time: 12654.8517s
	iters: 200, epoch: 22 | loss: 0.5887870
	speed: 0.2694s/iter; left time: 4373.0875s
Epoch: 22 cost time: 60.27264618873596
Epoch: 22, Steps: 208 | Train Loss: 0.243 Vali Loss: 10.316 Vali Acc: 0.126 Test Loss: 10.316 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.2320535
	speed: 0.7527s/iter; left time: 12137.8074s
	iters: 200, epoch: 23 | loss: 0.4516591
	speed: 0.2903s/iter; left time: 4652.6199s
Epoch: 23 cost time: 61.945610761642456
Epoch: 23, Steps: 208 | Train Loss: 0.229 Vali Loss: 9.749 Vali Acc: 0.126 Test Loss: 9.749 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0027796
	speed: 0.7447s/iter; left time: 11853.7925s
	iters: 200, epoch: 24 | loss: 0.1672690
	speed: 0.2734s/iter; left time: 4324.3125s
Epoch: 24 cost time: 59.015246868133545
Epoch: 24, Steps: 208 | Train Loss: 0.231 Vali Loss: 10.149 Vali Acc: 0.109 Test Loss: 10.149 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0793690
	speed: 0.6507s/iter; left time: 10221.6724s
	iters: 200, epoch: 25 | loss: 0.1103387
	speed: 0.2561s/iter; left time: 3997.2071s
Epoch: 25 cost time: 52.95336079597473
Epoch: 25, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.957 Vali Acc: 0.118 Test Loss: 10.957 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.6920936
	speed: 0.6327s/iter; left time: 9806.7097s
	iters: 200, epoch: 26 | loss: 0.1414757
	speed: 0.2388s/iter; left time: 3677.9110s
Epoch: 26 cost time: 49.36637210845947
Epoch: 26, Steps: 208 | Train Loss: 0.186 Vali Loss: 10.790 Vali Acc: 0.119 Test Loss: 10.790 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1326120
	speed: 0.6944s/iter; left time: 10618.8146s
	iters: 200, epoch: 27 | loss: 0.0279734
	speed: 0.2733s/iter; left time: 4151.5095s
Epoch: 27 cost time: 56.69295072555542
Epoch: 27, Steps: 208 | Train Loss: 0.185 Vali Loss: 11.316 Vali Acc: 0.125 Test Loss: 11.316 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0159888
	speed: 0.6995s/iter; left time: 10551.2346s
	iters: 200, epoch: 28 | loss: 0.2034634
	speed: 0.2607s/iter; left time: 3906.5286s
Epoch: 28 cost time: 54.56015372276306
Epoch: 28, Steps: 208 | Train Loss: 0.185 Vali Loss: 12.874 Vali Acc: 0.129 Test Loss: 12.874 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12913808529674917
model parameter : 4352167
model size : 19.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1036096
	speed: 0.2141s/iter; left time: 4432.8587s
	iters: 200, epoch: 1 | loss: 3.9564078
	speed: 0.1792s/iter; left time: 3691.7978s
Epoch: 1 cost time: 40.92970633506775
Epoch: 1, Steps: 208 | Train Loss: 4.291 Vali Loss: 3.440 Vali Acc: 0.065 Test Loss: 3.440 Test Acc: 0.065
Validation loss decreased (inf --> -0.064982).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9526975
	speed: 0.4850s/iter; left time: 9938.9790s
	iters: 200, epoch: 2 | loss: 4.1871758
	speed: 0.1223s/iter; left time: 2494.8767s
Epoch: 2 cost time: 30.61871886253357
Epoch: 2, Steps: 208 | Train Loss: 3.673 Vali Loss: 4.843 Vali Acc: 0.063 Test Loss: 4.843 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.5294170
	speed: 0.4466s/iter; left time: 9059.6314s
	iters: 200, epoch: 3 | loss: 4.4209170
	speed: 0.1625s/iter; left time: 3279.8310s
Epoch: 3 cost time: 34.76701855659485
Epoch: 3, Steps: 208 | Train Loss: 4.027 Vali Loss: 3.817 Vali Acc: 0.110 Test Loss: 3.817 Test Acc: 0.110
Validation loss decreased (-0.064982 --> -0.110013).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.7322340
	speed: 0.4282s/iter; left time: 8596.6001s
	iters: 200, epoch: 4 | loss: 4.7432165
	speed: 0.1920s/iter; left time: 3836.1466s
Epoch: 4 cost time: 36.02350950241089
Epoch: 4, Steps: 208 | Train Loss: 4.361 Vali Loss: 6.162 Vali Acc: 0.086 Test Loss: 6.162 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.4348702
	speed: 0.4682s/iter; left time: 9303.1594s
	iters: 200, epoch: 5 | loss: 4.7396936
	speed: 0.1570s/iter; left time: 3102.8508s
Epoch: 5 cost time: 34.90041947364807
Epoch: 5, Steps: 208 | Train Loss: 4.551 Vali Loss: 4.999 Vali Acc: 0.095 Test Loss: 4.999 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 4.2502465
	speed: 0.4530s/iter; left time: 8905.7663s
	iters: 200, epoch: 6 | loss: 4.5439124
	speed: 0.1681s/iter; left time: 3287.6174s
Epoch: 6 cost time: 35.762481689453125
Epoch: 6, Steps: 208 | Train Loss: 4.594 Vali Loss: 6.658 Vali Acc: 0.106 Test Loss: 6.658 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.4759865
	speed: 0.4352s/iter; left time: 8465.7632s
	iters: 200, epoch: 7 | loss: 3.9295747
	speed: 0.1676s/iter; left time: 3243.7549s
Epoch: 7 cost time: 33.398237228393555
Epoch: 7, Steps: 208 | Train Loss: 4.251 Vali Loss: 6.315 Vali Acc: 0.109 Test Loss: 6.315 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 4.1762943
	speed: 0.4617s/iter; left time: 8886.2741s
	iters: 200, epoch: 8 | loss: 4.2665911
	speed: 0.1513s/iter; left time: 2897.3468s
Epoch: 8 cost time: 32.480401277542114
Epoch: 8, Steps: 208 | Train Loss: 4.031 Vali Loss: 5.176 Vali Acc: 0.126 Test Loss: 5.176 Test Acc: 0.126
Validation loss decreased (-0.110013 --> -0.125806).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2430692
	speed: 0.3698s/iter; left time: 7040.1346s
	iters: 200, epoch: 9 | loss: 5.4796820
	speed: 0.1496s/iter; left time: 2833.3143s
Epoch: 9 cost time: 28.119468927383423
Epoch: 9, Steps: 208 | Train Loss: 3.517 Vali Loss: 5.076 Vali Acc: 0.119 Test Loss: 5.076 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.5346880
	speed: 0.4137s/iter; left time: 7789.9174s
	iters: 200, epoch: 10 | loss: 2.4721086
	speed: 0.1043s/iter; left time: 1954.1002s
Epoch: 10 cost time: 25.792649507522583
Epoch: 10, Steps: 208 | Train Loss: 2.860 Vali Loss: 6.451 Vali Acc: 0.114 Test Loss: 6.451 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8740326
	speed: 0.3804s/iter; left time: 7082.6621s
	iters: 200, epoch: 11 | loss: 2.9551814
	speed: 0.1314s/iter; left time: 2433.7451s
Epoch: 11 cost time: 28.104917526245117
Epoch: 11, Steps: 208 | Train Loss: 2.158 Vali Loss: 6.599 Vali Acc: 0.127 Test Loss: 6.599 Test Acc: 0.127
Validation loss decreased (-0.125806 --> -0.126984).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9279473
	speed: 0.3656s/iter; left time: 6732.3291s
	iters: 200, epoch: 12 | loss: 1.6590151
	speed: 0.1325s/iter; left time: 2426.5566s
Epoch: 12 cost time: 27.6091570854187
Epoch: 12, Steps: 208 | Train Loss: 1.650 Vali Loss: 5.260 Vali Acc: 0.127 Test Loss: 5.260 Test Acc: 0.127
Validation loss decreased (-0.126984 --> -0.127296).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6648747
	speed: 0.3789s/iter; left time: 6898.6279s
	iters: 200, epoch: 13 | loss: 1.7173270
	speed: 0.1282s/iter; left time: 2320.9520s
Epoch: 13 cost time: 26.939127922058105
Epoch: 13, Steps: 208 | Train Loss: 1.341 Vali Loss: 5.450 Vali Acc: 0.135 Test Loss: 5.450 Test Acc: 0.135
Validation loss decreased (-0.127296 --> -0.135347).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7863598
	speed: 0.3667s/iter; left time: 6599.3710s
	iters: 200, epoch: 14 | loss: 1.5180672
	speed: 0.1215s/iter; left time: 2174.7240s
Epoch: 14 cost time: 25.7610285282135
Epoch: 14, Steps: 208 | Train Loss: 1.094 Vali Loss: 5.787 Vali Acc: 0.139 Test Loss: 5.787 Test Acc: 0.139
Validation loss decreased (-0.135347 --> -0.138922).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5605009
	speed: 0.3728s/iter; left time: 6632.0251s
	iters: 200, epoch: 15 | loss: 1.8705428
	speed: 0.1245s/iter; left time: 2201.5120s
Epoch: 15 cost time: 27.208750247955322
Epoch: 15, Steps: 208 | Train Loss: 0.933 Vali Loss: 6.489 Vali Acc: 0.126 Test Loss: 6.489 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8475602
	speed: 0.3735s/iter; left time: 6566.0791s
	iters: 200, epoch: 16 | loss: 0.4321993
	speed: 0.1340s/iter; left time: 2342.0797s
Epoch: 16 cost time: 28.76863169670105
Epoch: 16, Steps: 208 | Train Loss: 0.764 Vali Loss: 6.310 Vali Acc: 0.129 Test Loss: 6.310 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9257681
	speed: 0.3900s/iter; left time: 6774.6143s
	iters: 200, epoch: 17 | loss: 0.8796818
	speed: 0.1305s/iter; left time: 2253.7435s
Epoch: 17 cost time: 27.732195138931274
Epoch: 17, Steps: 208 | Train Loss: 0.673 Vali Loss: 6.972 Vali Acc: 0.129 Test Loss: 6.972 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5814036
	speed: 0.3933s/iter; left time: 6750.6373s
	iters: 200, epoch: 18 | loss: 0.3517787
	speed: 0.1334s/iter; left time: 2276.3221s
Epoch: 18 cost time: 28.97256374359131
Epoch: 18, Steps: 208 | Train Loss: 0.551 Vali Loss: 7.071 Vali Acc: 0.133 Test Loss: 7.071 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5147896
	speed: 0.3866s/iter; left time: 6555.6298s
	iters: 200, epoch: 19 | loss: 0.3413052
	speed: 0.1674s/iter; left time: 2821.2225s
Epoch: 19 cost time: 32.7704701423645
Epoch: 19, Steps: 208 | Train Loss: 0.481 Vali Loss: 7.393 Vali Acc: 0.136 Test Loss: 7.393 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3168644
	speed: 0.4268s/iter; left time: 7148.4263s
	iters: 200, epoch: 20 | loss: 0.2183705
	speed: 0.1745s/iter; left time: 2904.4643s
Epoch: 20 cost time: 33.85480713844299
Epoch: 20, Steps: 208 | Train Loss: 0.416 Vali Loss: 7.941 Vali Acc: 0.135 Test Loss: 7.941 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2677161
	speed: 0.4800s/iter; left time: 7940.4916s
	iters: 200, epoch: 21 | loss: 0.8186713
	speed: 0.1800s/iter; left time: 2960.0836s
Epoch: 21 cost time: 36.96704840660095
Epoch: 21, Steps: 208 | Train Loss: 0.365 Vali Loss: 8.379 Vali Acc: 0.140 Test Loss: 8.379 Test Acc: 0.140
Validation loss decreased (-0.138922 --> -0.140387).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0250105
	speed: 0.4510s/iter; left time: 7366.2324s
	iters: 200, epoch: 22 | loss: 0.1185224
	speed: 0.1547s/iter; left time: 2511.2396s
Epoch: 22 cost time: 32.96843361854553
Epoch: 22, Steps: 208 | Train Loss: 0.297 Vali Loss: 8.611 Vali Acc: 0.137 Test Loss: 8.611 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0873605
	speed: 0.4300s/iter; left time: 6933.2732s
	iters: 200, epoch: 23 | loss: 0.1968116
	speed: 0.1465s/iter; left time: 2347.5001s
Epoch: 23 cost time: 31.924669981002808
Epoch: 23, Steps: 208 | Train Loss: 0.292 Vali Loss: 8.917 Vali Acc: 0.148 Test Loss: 8.917 Test Acc: 0.148
Validation loss decreased (-0.140387 --> -0.148136).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.5977361
	speed: 0.3923s/iter; left time: 6243.6819s
	iters: 200, epoch: 24 | loss: 1.3115176
	speed: 0.1404s/iter; left time: 2219.9343s
Epoch: 24 cost time: 28.123109579086304
Epoch: 24, Steps: 208 | Train Loss: 0.288 Vali Loss: 8.131 Vali Acc: 0.148 Test Loss: 8.131 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1409700
	speed: 0.4202s/iter; left time: 6600.5244s
	iters: 200, epoch: 25 | loss: 1.3491642
	speed: 0.1410s/iter; left time: 2200.6137s
Epoch: 25 cost time: 30.125183820724487
Epoch: 25, Steps: 208 | Train Loss: 0.259 Vali Loss: 9.991 Vali Acc: 0.129 Test Loss: 9.991 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3857988
	speed: 0.4157s/iter; left time: 6444.3722s
	iters: 200, epoch: 26 | loss: 0.5072368
	speed: 0.1426s/iter; left time: 2195.7821s
Epoch: 26 cost time: 30.596141815185547
Epoch: 26, Steps: 208 | Train Loss: 0.254 Vali Loss: 9.026 Vali Acc: 0.131 Test Loss: 9.026 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0721705
	speed: 0.3744s/iter; left time: 5725.7947s
	iters: 200, epoch: 27 | loss: 0.4000965
	speed: 0.1398s/iter; left time: 2124.5392s
Epoch: 27 cost time: 28.61686873435974
Epoch: 27, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.333 Vali Acc: 0.143 Test Loss: 10.333 Test Acc: 0.143
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0343632
	speed: 0.4079s/iter; left time: 6153.3507s
	iters: 200, epoch: 28 | loss: 0.1043657
	speed: 0.1367s/iter; left time: 2047.9408s
Epoch: 28 cost time: 29.49626874923706
Epoch: 28, Steps: 208 | Train Loss: 0.218 Vali Loss: 10.032 Vali Acc: 0.132 Test Loss: 10.032 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0197946
	speed: 0.4061s/iter; left time: 6040.9072s
	iters: 200, epoch: 29 | loss: 0.4338399
	speed: 0.1433s/iter; left time: 2117.3167s
Epoch: 29 cost time: 30.527106761932373
Epoch: 29, Steps: 208 | Train Loss: 0.191 Vali Loss: 9.598 Vali Acc: 0.133 Test Loss: 9.598 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.8298984
	speed: 0.3991s/iter; left time: 5853.6732s
	iters: 200, epoch: 30 | loss: 0.1336487
	speed: 0.1441s/iter; left time: 2098.6917s
Epoch: 30 cost time: 30.243160247802734
Epoch: 30, Steps: 208 | Train Loss: 0.223 Vali Loss: 11.157 Vali Acc: 0.120 Test Loss: 11.157 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.1597547
	speed: 0.4160s/iter; left time: 6016.0427s
	iters: 200, epoch: 31 | loss: 0.1243348
	speed: 0.1531s/iter; left time: 2199.1404s
Epoch: 31 cost time: 31.742931604385376
Epoch: 31, Steps: 208 | Train Loss: 0.188 Vali Loss: 11.724 Vali Acc: 0.125 Test Loss: 11.724 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0049686
	speed: 0.3851s/iter; left time: 5488.5470s
	iters: 200, epoch: 32 | loss: 0.2689874
	speed: 0.1306s/iter; left time: 1848.4797s
Epoch: 32 cost time: 27.204508304595947
Epoch: 32, Steps: 208 | Train Loss: 0.210 Vali Loss: 10.702 Vali Acc: 0.137 Test Loss: 10.702 Test Acc: 0.137
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.8599884
	speed: 0.3900s/iter; left time: 5477.2348s
	iters: 200, epoch: 33 | loss: 0.3933200
	speed: 0.1268s/iter; left time: 1767.8624s
Epoch: 33 cost time: 27.920790910720825
Epoch: 33, Steps: 208 | Train Loss: 0.227 Vali Loss: 11.443 Vali Acc: 0.133 Test Loss: 11.443 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14822546972860126
model parameter : 2375975
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2954955
	speed: 0.1382s/iter; left time: 2860.8369s
	iters: 200, epoch: 1 | loss: 3.3781891
	speed: 0.0972s/iter; left time: 2003.0011s
Epoch: 1 cost time: 24.621687173843384
Epoch: 1, Steps: 208 | Train Loss: 4.090 Vali Loss: 3.450 Vali Acc: 0.074 Test Loss: 3.450 Test Acc: 0.074
Validation loss decreased (inf --> -0.074227).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6201508
	speed: 0.3358s/iter; left time: 6881.2060s
	iters: 200, epoch: 2 | loss: 3.7273197
	speed: 0.1289s/iter; left time: 2628.3669s
Epoch: 2 cost time: 27.125641584396362
Epoch: 2, Steps: 208 | Train Loss: 3.568 Vali Loss: 4.235 Vali Acc: 0.072 Test Loss: 4.235 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.1547670
	speed: 0.3639s/iter; left time: 7381.0901s
	iters: 200, epoch: 3 | loss: 3.8373122
	speed: 0.1304s/iter; left time: 2632.7089s
Epoch: 3 cost time: 27.30909538269043
Epoch: 3, Steps: 208 | Train Loss: 3.732 Vali Loss: 5.335 Vali Acc: 0.065 Test Loss: 5.335 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.6170809
	speed: 0.3398s/iter; left time: 6822.3922s
	iters: 200, epoch: 4 | loss: 4.2870674
	speed: 0.1267s/iter; left time: 2530.4583s
Epoch: 4 cost time: 25.327895641326904
Epoch: 4, Steps: 208 | Train Loss: 3.858 Vali Loss: 5.521 Vali Acc: 0.081 Test Loss: 5.521 Test Acc: 0.081
Validation loss decreased (-0.074227 --> -0.080768).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.4796410
	speed: 0.3512s/iter; left time: 6978.9690s
	iters: 200, epoch: 5 | loss: 5.4517484
	speed: 0.1179s/iter; left time: 2331.5933s
Epoch: 5 cost time: 25.493826866149902
Epoch: 5, Steps: 208 | Train Loss: 4.093 Vali Loss: 4.387 Vali Acc: 0.092 Test Loss: 4.387 Test Acc: 0.092
Validation loss decreased (-0.080768 --> -0.091516).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6782711
	speed: 0.3389s/iter; left time: 6662.6164s
	iters: 200, epoch: 6 | loss: 4.5378852
	speed: 0.1269s/iter; left time: 2482.5448s
Epoch: 6 cost time: 26.470233917236328
Epoch: 6, Steps: 208 | Train Loss: 4.069 Vali Loss: 5.385 Vali Acc: 0.094 Test Loss: 5.385 Test Acc: 0.094
Validation loss decreased (-0.091516 --> -0.093892).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.7702439
	speed: 0.3270s/iter; left time: 6361.8661s
	iters: 200, epoch: 7 | loss: 3.1908197
	speed: 0.1093s/iter; left time: 2115.7846s
Epoch: 7 cost time: 22.056555032730103
Epoch: 7, Steps: 208 | Train Loss: 3.822 Vali Loss: 5.310 Vali Acc: 0.091 Test Loss: 5.310 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.2549150
	speed: 0.3167s/iter; left time: 6094.9944s
	iters: 200, epoch: 8 | loss: 3.4719362
	speed: 0.1041s/iter; left time: 1992.9304s
Epoch: 8 cost time: 22.88017249107361
Epoch: 8, Steps: 208 | Train Loss: 3.355 Vali Loss: 4.496 Vali Acc: 0.130 Test Loss: 4.496 Test Acc: 0.130
Validation loss decreased (-0.093892 --> -0.130286).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7187593
	speed: 0.3209s/iter; left time: 6108.8217s
	iters: 200, epoch: 9 | loss: 2.9818273
	speed: 0.1058s/iter; left time: 2003.9389s
Epoch: 9 cost time: 23.080946683883667
Epoch: 9, Steps: 208 | Train Loss: 3.120 Vali Loss: 6.262 Vali Acc: 0.124 Test Loss: 6.262 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.9210973
	speed: 0.3227s/iter; left time: 6076.2347s
	iters: 200, epoch: 10 | loss: 1.9049501
	speed: 0.1253s/iter; left time: 2347.4779s
Epoch: 10 cost time: 25.21533703804016
Epoch: 10, Steps: 208 | Train Loss: 2.637 Vali Loss: 6.212 Vali Acc: 0.108 Test Loss: 6.212 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.4025381
	speed: 0.3214s/iter; left time: 5985.4930s
	iters: 200, epoch: 11 | loss: 3.1757193
	speed: 0.0924s/iter; left time: 1711.3046s
Epoch: 11 cost time: 21.08068346977234
Epoch: 11, Steps: 208 | Train Loss: 2.035 Vali Loss: 6.121 Vali Acc: 0.123 Test Loss: 6.121 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3118293
	speed: 0.3394s/iter; left time: 6249.2622s
	iters: 200, epoch: 12 | loss: 1.3127575
	speed: 0.1244s/iter; left time: 2277.7036s
Epoch: 12 cost time: 26.12799644470215
Epoch: 12, Steps: 208 | Train Loss: 1.582 Vali Loss: 6.951 Vali Acc: 0.122 Test Loss: 6.951 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6071934
	speed: 0.3121s/iter; left time: 5682.5396s
	iters: 200, epoch: 13 | loss: 1.0110168
	speed: 0.1140s/iter; left time: 2063.1426s
Epoch: 13 cost time: 22.471815824508667
Epoch: 13, Steps: 208 | Train Loss: 1.271 Vali Loss: 6.336 Vali Acc: 0.122 Test Loss: 6.336 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3069552
	speed: 0.3307s/iter; left time: 5952.0154s
	iters: 200, epoch: 14 | loss: 1.7704118
	speed: 0.1031s/iter; left time: 1845.5069s
Epoch: 14 cost time: 22.706233024597168
Epoch: 14, Steps: 208 | Train Loss: 1.008 Vali Loss: 6.956 Vali Acc: 0.130 Test Loss: 6.956 Test Acc: 0.130
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.9944730
	speed: 0.3423s/iter; left time: 6089.2435s
	iters: 200, epoch: 15 | loss: 1.0595446
	speed: 0.1249s/iter; left time: 2210.0334s
Epoch: 15 cost time: 25.75360679626465
Epoch: 15, Steps: 208 | Train Loss: 0.769 Vali Loss: 6.942 Vali Acc: 0.138 Test Loss: 6.942 Test Acc: 0.138
Validation loss decreased (-0.130286 --> -0.138314).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9712626
	speed: 0.3424s/iter; left time: 6018.8721s
	iters: 200, epoch: 16 | loss: 1.3132545
	speed: 0.1265s/iter; left time: 2211.4082s
Epoch: 16 cost time: 27.197304487228394
Epoch: 16, Steps: 208 | Train Loss: 0.643 Vali Loss: 6.912 Vali Acc: 0.141 Test Loss: 6.912 Test Acc: 0.141
Validation loss decreased (-0.138314 --> -0.140700).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4114122
	speed: 0.3410s/iter; left time: 5923.7051s
	iters: 200, epoch: 17 | loss: 0.3050689
	speed: 0.1181s/iter; left time: 2039.6624s
Epoch: 17 cost time: 24.905001640319824
Epoch: 17, Steps: 208 | Train Loss: 0.533 Vali Loss: 7.871 Vali Acc: 0.125 Test Loss: 7.871 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2320891
	speed: 0.3408s/iter; left time: 5849.3399s
	iters: 200, epoch: 18 | loss: 0.4668850
	speed: 0.1269s/iter; left time: 2164.9290s
Epoch: 18 cost time: 27.259361505508423
Epoch: 18, Steps: 208 | Train Loss: 0.443 Vali Loss: 7.484 Vali Acc: 0.132 Test Loss: 7.484 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0811338
	speed: 0.3437s/iter; left time: 5828.1020s
	iters: 200, epoch: 19 | loss: 0.6634510
	speed: 0.1024s/iter; left time: 1725.8009s
Epoch: 19 cost time: 23.143946409225464
Epoch: 19, Steps: 208 | Train Loss: 0.388 Vali Loss: 8.615 Vali Acc: 0.132 Test Loss: 8.615 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.7873483
	speed: 0.3273s/iter; left time: 5482.2593s
	iters: 200, epoch: 20 | loss: 0.7247278
	speed: 0.1071s/iter; left time: 1783.6697s
Epoch: 20 cost time: 23.395354747772217
Epoch: 20, Steps: 208 | Train Loss: 0.375 Vali Loss: 8.790 Vali Acc: 0.137 Test Loss: 8.790 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1098818
	speed: 0.3017s/iter; left time: 4990.8272s
	iters: 200, epoch: 21 | loss: 0.6125569
	speed: 0.1226s/iter; left time: 2015.0250s
Epoch: 21 cost time: 24.522987604141235
Epoch: 21, Steps: 208 | Train Loss: 0.357 Vali Loss: 9.518 Vali Acc: 0.124 Test Loss: 9.518 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3035674
	speed: 0.3587s/iter; left time: 5858.4311s
	iters: 200, epoch: 22 | loss: 0.4782684
	speed: 0.1220s/iter; left time: 1980.0734s
Epoch: 22 cost time: 26.12660813331604
Epoch: 22, Steps: 208 | Train Loss: 0.314 Vali Loss: 9.309 Vali Acc: 0.127 Test Loss: 9.309 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2111508
	speed: 0.3423s/iter; left time: 5518.8404s
	iters: 200, epoch: 23 | loss: 0.3045107
	speed: 0.1265s/iter; left time: 2026.4348s
Epoch: 23 cost time: 26.396480560302734
Epoch: 23, Steps: 208 | Train Loss: 0.285 Vali Loss: 9.135 Vali Acc: 0.121 Test Loss: 9.135 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0290812
	speed: 0.3841s/iter; left time: 6113.9004s
	iters: 200, epoch: 24 | loss: 0.2055647
	speed: 0.1347s/iter; left time: 2129.9503s
Epoch: 24 cost time: 29.38250184059143
Epoch: 24, Steps: 208 | Train Loss: 0.264 Vali Loss: 9.617 Vali Acc: 0.125 Test Loss: 9.617 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.3215266
	speed: 0.3674s/iter; left time: 5770.7299s
	iters: 200, epoch: 25 | loss: 0.2719879
	speed: 0.1368s/iter; left time: 2135.2690s
Epoch: 25 cost time: 28.451951265335083
Epoch: 25, Steps: 208 | Train Loss: 0.270 Vali Loss: 9.849 Vali Acc: 0.129 Test Loss: 9.849 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0571567
	speed: 0.3670s/iter; left time: 5688.3410s
	iters: 200, epoch: 26 | loss: 0.3954262
	speed: 0.1343s/iter; left time: 2067.8964s
Epoch: 26 cost time: 28.02328324317932
Epoch: 26, Steps: 208 | Train Loss: 0.223 Vali Loss: 9.996 Vali Acc: 0.123 Test Loss: 9.996 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14076946018490905
model parameter : 1717799
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1011281
	speed: 0.1500s/iter; left time: 3105.5335s
	iters: 200, epoch: 1 | loss: 3.9205320
	speed: 0.1318s/iter; left time: 2715.5627s
Epoch: 1 cost time: 29.14456272125244
Epoch: 1, Steps: 208 | Train Loss: 4.067 Vali Loss: 3.540 Vali Acc: 0.062 Test Loss: 3.540 Test Acc: 0.062
Validation loss decreased (inf --> -0.062297).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6218600
	speed: 0.3368s/iter; left time: 6901.3663s
	iters: 200, epoch: 2 | loss: 3.4149046
	speed: 0.1300s/iter; left time: 2650.4223s
Epoch: 2 cost time: 27.53826594352722
Epoch: 2, Steps: 208 | Train Loss: 3.555 Vali Loss: 4.178 Vali Acc: 0.059 Test Loss: 4.178 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3359177
	speed: 0.3367s/iter; left time: 6830.7814s
	iters: 200, epoch: 3 | loss: 4.2491837
	speed: 0.1284s/iter; left time: 2592.5464s
Epoch: 3 cost time: 26.890674591064453
Epoch: 3, Steps: 208 | Train Loss: 3.595 Vali Loss: 3.655 Vali Acc: 0.094 Test Loss: 3.655 Test Acc: 0.094
Validation loss decreased (-0.062297 --> -0.093909).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0508828
	speed: 0.3165s/iter; left time: 6354.7283s
	iters: 200, epoch: 4 | loss: 4.4839411
	speed: 0.1161s/iter; left time: 2319.1509s
Epoch: 4 cost time: 23.853841543197632
Epoch: 4, Steps: 208 | Train Loss: 3.767 Vali Loss: 4.888 Vali Acc: 0.103 Test Loss: 4.888 Test Acc: 0.103
Validation loss decreased (-0.093909 --> -0.103441).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.7807269
	speed: 0.3400s/iter; left time: 6756.4312s
	iters: 200, epoch: 5 | loss: 3.4787621
	speed: 0.1207s/iter; left time: 2385.9182s
Epoch: 5 cost time: 26.53610634803772
Epoch: 5, Steps: 208 | Train Loss: 3.854 Vali Loss: 5.085 Vali Acc: 0.101 Test Loss: 5.085 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.0980325
	speed: 0.3362s/iter; left time: 6609.8229s
	iters: 200, epoch: 6 | loss: 5.7534676
	speed: 0.1295s/iter; left time: 2532.4457s
Epoch: 6 cost time: 27.464805364608765
Epoch: 6, Steps: 208 | Train Loss: 3.826 Vali Loss: 6.059 Vali Acc: 0.086 Test Loss: 6.059 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.8955903
	speed: 0.3304s/iter; left time: 6427.2438s
	iters: 200, epoch: 7 | loss: 4.1335130
	speed: 0.1245s/iter; left time: 2409.0366s
Epoch: 7 cost time: 26.10931372642517
Epoch: 7, Steps: 208 | Train Loss: 3.743 Vali Loss: 5.097 Vali Acc: 0.116 Test Loss: 5.097 Test Acc: 0.116
Validation loss decreased (-0.103441 --> -0.115666).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.3359745
	speed: 0.3322s/iter; left time: 6392.5438s
	iters: 200, epoch: 8 | loss: 3.2629960
	speed: 0.1280s/iter; left time: 2450.0930s
Epoch: 8 cost time: 27.18653655052185
Epoch: 8, Steps: 208 | Train Loss: 3.384 Vali Loss: 5.122 Vali Acc: 0.129 Test Loss: 5.122 Test Acc: 0.129
Validation loss decreased (-0.115666 --> -0.128789).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2958372
	speed: 0.3108s/iter; left time: 5916.8871s
	iters: 200, epoch: 9 | loss: 4.4413981
	speed: 0.1123s/iter; left time: 2127.5615s
Epoch: 9 cost time: 23.331881761550903
Epoch: 9, Steps: 208 | Train Loss: 3.086 Vali Loss: 5.106 Vali Acc: 0.130 Test Loss: 5.106 Test Acc: 0.130
Validation loss decreased (-0.128789 --> -0.130280).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.1512370
	speed: 0.2980s/iter; left time: 5611.9220s
	iters: 200, epoch: 10 | loss: 3.6200449
	speed: 0.1180s/iter; left time: 2209.5043s
Epoch: 10 cost time: 23.683887481689453
Epoch: 10, Steps: 208 | Train Loss: 2.660 Vali Loss: 5.038 Vali Acc: 0.124 Test Loss: 5.038 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.4305096
	speed: 0.3060s/iter; left time: 5698.0336s
	iters: 200, epoch: 11 | loss: 2.7925465
	speed: 0.1093s/iter; left time: 2023.8326s
Epoch: 11 cost time: 23.227648973464966
Epoch: 11, Steps: 208 | Train Loss: 2.243 Vali Loss: 6.161 Vali Acc: 0.116 Test Loss: 6.161 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.9921674
	speed: 0.2909s/iter; left time: 5356.6755s
	iters: 200, epoch: 12 | loss: 2.9136512
	speed: 0.0985s/iter; left time: 1803.9734s
Epoch: 12 cost time: 21.3701171875
Epoch: 12, Steps: 208 | Train Loss: 1.762 Vali Loss: 5.340 Vali Acc: 0.116 Test Loss: 5.340 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9098082
	speed: 0.3007s/iter; left time: 5474.6983s
	iters: 200, epoch: 13 | loss: 1.7864189
	speed: 0.0996s/iter; left time: 1803.6908s
Epoch: 13 cost time: 21.874191761016846
Epoch: 13, Steps: 208 | Train Loss: 1.438 Vali Loss: 5.847 Vali Acc: 0.140 Test Loss: 5.847 Test Acc: 0.140
Validation loss decreased (-0.130280 --> -0.139816).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4251783
	speed: 0.2794s/iter; left time: 5029.1833s
	iters: 200, epoch: 14 | loss: 1.0137573
	speed: 0.0951s/iter; left time: 1701.6024s
Epoch: 14 cost time: 19.84919500350952
Epoch: 14, Steps: 208 | Train Loss: 1.127 Vali Loss: 6.276 Vali Acc: 0.129 Test Loss: 6.276 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4444247
	speed: 0.2936s/iter; left time: 5223.2013s
	iters: 200, epoch: 15 | loss: 1.0733999
	speed: 0.0931s/iter; left time: 1647.0975s
Epoch: 15 cost time: 21.895691871643066
Epoch: 15, Steps: 208 | Train Loss: 0.914 Vali Loss: 6.643 Vali Acc: 0.137 Test Loss: 6.643 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7618034
	speed: 0.2856s/iter; left time: 5020.9345s
	iters: 200, epoch: 16 | loss: 0.8380342
	speed: 0.1017s/iter; left time: 1777.1817s
Epoch: 16 cost time: 21.6860830783844
Epoch: 16, Steps: 208 | Train Loss: 0.756 Vali Loss: 7.289 Vali Acc: 0.135 Test Loss: 7.289 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2592409
	speed: 0.3063s/iter; left time: 5321.2506s
	iters: 200, epoch: 17 | loss: 0.7117453
	speed: 0.1030s/iter; left time: 1778.5132s
Epoch: 17 cost time: 22.496061325073242
Epoch: 17, Steps: 208 | Train Loss: 0.644 Vali Loss: 6.738 Vali Acc: 0.131 Test Loss: 6.738 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5264370
	speed: 0.2724s/iter; left time: 4676.4079s
	iters: 200, epoch: 18 | loss: 1.1824100
	speed: 0.0841s/iter; left time: 1435.4430s
Epoch: 18 cost time: 18.46724534034729
Epoch: 18, Steps: 208 | Train Loss: 0.524 Vali Loss: 7.247 Vali Acc: 0.136 Test Loss: 7.247 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.5913563
	speed: 0.2961s/iter; left time: 5020.4862s
	iters: 200, epoch: 19 | loss: 0.5874044
	speed: 0.1092s/iter; left time: 1840.6262s
Epoch: 19 cost time: 23.320148229599
Epoch: 19, Steps: 208 | Train Loss: 0.457 Vali Loss: 8.057 Vali Acc: 0.132 Test Loss: 8.057 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3963753
	speed: 0.3155s/iter; left time: 5283.9260s
	iters: 200, epoch: 20 | loss: 0.3083909
	speed: 0.1066s/iter; left time: 1774.7964s
Epoch: 20 cost time: 23.20326542854309
Epoch: 20, Steps: 208 | Train Loss: 0.420 Vali Loss: 8.029 Vali Acc: 0.129 Test Loss: 8.029 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0460530
	speed: 0.3038s/iter; left time: 5025.1487s
	iters: 200, epoch: 21 | loss: 0.8280412
	speed: 0.1113s/iter; left time: 1829.5076s
Epoch: 21 cost time: 23.766758918762207
Epoch: 21, Steps: 208 | Train Loss: 0.384 Vali Loss: 8.034 Vali Acc: 0.130 Test Loss: 8.034 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2212968
	speed: 0.2764s/iter; left time: 4513.9354s
	iters: 200, epoch: 22 | loss: 0.1484771
	speed: 0.1009s/iter; left time: 1638.6853s
Epoch: 22 cost time: 20.117708444595337
Epoch: 22, Steps: 208 | Train Loss: 0.355 Vali Loss: 9.086 Vali Acc: 0.126 Test Loss: 9.086 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.8734829
	speed: 0.3139s/iter; left time: 5062.3394s
	iters: 200, epoch: 23 | loss: 0.1859378
	speed: 0.1172s/iter; left time: 1878.0981s
Epoch: 23 cost time: 25.04310965538025
Epoch: 23, Steps: 208 | Train Loss: 0.321 Vali Loss: 9.191 Vali Acc: 0.142 Test Loss: 9.191 Test Acc: 0.142
Validation loss decreased (-0.139816 --> -0.142169).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.4214922
	speed: 0.3095s/iter; left time: 4925.6199s
	iters: 200, epoch: 24 | loss: 0.3797427
	speed: 0.1103s/iter; left time: 1744.5249s
Epoch: 24 cost time: 23.76319169998169
Epoch: 24, Steps: 208 | Train Loss: 0.278 Vali Loss: 9.307 Vali Acc: 0.124 Test Loss: 9.307 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.2809222
	speed: 0.2952s/iter; left time: 4637.1251s
	iters: 200, epoch: 25 | loss: 0.7711739
	speed: 0.1070s/iter; left time: 1670.4333s
Epoch: 25 cost time: 22.85910964012146
Epoch: 25, Steps: 208 | Train Loss: 0.271 Vali Loss: 10.178 Vali Acc: 0.129 Test Loss: 10.178 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0526547
	speed: 0.3287s/iter; left time: 5095.5333s
	iters: 200, epoch: 26 | loss: 0.3898449
	speed: 0.1201s/iter; left time: 1849.0096s
Epoch: 26 cost time: 25.725314378738403
Epoch: 26, Steps: 208 | Train Loss: 0.276 Vali Loss: 9.133 Vali Acc: 0.124 Test Loss: 9.133 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.7221020
	speed: 0.2967s/iter; left time: 4536.7032s
	iters: 200, epoch: 27 | loss: 0.2256483
	speed: 0.1075s/iter; left time: 1633.3070s
Epoch: 27 cost time: 21.579244375228882
Epoch: 27, Steps: 208 | Train Loss: 0.263 Vali Loss: 9.680 Vali Acc: 0.128 Test Loss: 9.680 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.5903550
	speed: 0.2996s/iter; left time: 4518.8615s
	iters: 200, epoch: 28 | loss: 0.4957604
	speed: 0.0927s/iter; left time: 1389.4371s
Epoch: 28 cost time: 21.279643297195435
Epoch: 28, Steps: 208 | Train Loss: 0.237 Vali Loss: 10.314 Vali Acc: 0.134 Test Loss: 10.314 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.9004838
	speed: 0.3061s/iter; left time: 4554.4751s
	iters: 200, epoch: 29 | loss: 0.1907226
	speed: 0.0962s/iter; left time: 1421.2312s
Epoch: 29 cost time: 21.689852237701416
Epoch: 29, Steps: 208 | Train Loss: 0.264 Vali Loss: 10.409 Vali Acc: 0.131 Test Loss: 10.409 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0127962
	speed: 0.2975s/iter; left time: 4363.3369s
	iters: 200, epoch: 30 | loss: 0.0610787
	speed: 0.1053s/iter; left time: 1533.4793s
Epoch: 30 cost time: 22.44396662712097
Epoch: 30, Steps: 208 | Train Loss: 0.280 Vali Loss: 11.102 Vali Acc: 0.125 Test Loss: 11.102 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.7629635
	speed: 0.2973s/iter; left time: 4298.9746s
	iters: 200, epoch: 31 | loss: 0.4571730
	speed: 0.1031s/iter; left time: 1481.2616s
Epoch: 31 cost time: 22.372584104537964
Epoch: 31, Steps: 208 | Train Loss: 0.236 Vali Loss: 11.251 Vali Acc: 0.128 Test Loss: 11.251 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.2475560
	speed: 0.3039s/iter; left time: 4331.2330s
	iters: 200, epoch: 32 | loss: 0.2209647
	speed: 0.1137s/iter; left time: 1609.1771s
Epoch: 32 cost time: 24.033742666244507
Epoch: 32, Steps: 208 | Train Loss: 0.243 Vali Loss: 10.479 Vali Acc: 0.133 Test Loss: 10.479 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.1207397
	speed: 0.3207s/iter; left time: 4504.8215s
	iters: 200, epoch: 33 | loss: 0.4441056
	speed: 0.0977s/iter; left time: 1362.9293s
Epoch: 33 cost time: 22.32936692237854
Epoch: 33, Steps: 208 | Train Loss: 0.206 Vali Loss: 10.436 Vali Acc: 0.123 Test Loss: 10.436 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1422606620936475
model parameter : 1443879
model size : 7.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8763218
	speed: 0.1144s/iter; left time: 2367.7775s
	iters: 200, epoch: 1 | loss: 3.7139175
	speed: 0.0837s/iter; left time: 1724.5670s
Epoch: 1 cost time: 20.683465480804443
Epoch: 1, Steps: 208 | Train Loss: 4.041 Vali Loss: 3.528 Vali Acc: 0.068 Test Loss: 3.528 Test Acc: 0.068
Validation loss decreased (inf --> -0.068262).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7007980
	speed: 0.2695s/iter; left time: 5522.6130s
	iters: 200, epoch: 2 | loss: 3.8377371
	speed: 0.0999s/iter; left time: 2037.5512s
Epoch: 2 cost time: 21.087347269058228
Epoch: 2, Steps: 208 | Train Loss: 3.428 Vali Loss: 3.535 Vali Acc: 0.083 Test Loss: 3.535 Test Acc: 0.083
Validation loss decreased (-0.068262 --> -0.082577).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4487307
	speed: 0.2727s/iter; left time: 5530.9162s
	iters: 200, epoch: 3 | loss: 3.7948151
	speed: 0.0927s/iter; left time: 1870.7911s
Epoch: 3 cost time: 19.607755184173584
Epoch: 3, Steps: 208 | Train Loss: 3.367 Vali Loss: 4.905 Vali Acc: 0.056 Test Loss: 4.905 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3147755
	speed: 0.2591s/iter; left time: 5202.1287s
	iters: 200, epoch: 4 | loss: 3.9359851
	speed: 0.0945s/iter; left time: 1888.7535s
Epoch: 4 cost time: 19.820242166519165
Epoch: 4, Steps: 208 | Train Loss: 3.428 Vali Loss: 3.856 Vali Acc: 0.104 Test Loss: 3.856 Test Acc: 0.104
Validation loss decreased (-0.082577 --> -0.104047).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.3812332
	speed: 0.2960s/iter; left time: 5881.7124s
	iters: 200, epoch: 5 | loss: 3.4966364
	speed: 0.0973s/iter; left time: 1922.7907s
Epoch: 5 cost time: 21.757548332214355
Epoch: 5, Steps: 208 | Train Loss: 3.414 Vali Loss: 4.583 Vali Acc: 0.107 Test Loss: 4.583 Test Acc: 0.107
Validation loss decreased (-0.104047 --> -0.107321).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9777532
	speed: 0.2721s/iter; left time: 5350.7381s
	iters: 200, epoch: 6 | loss: 2.8925452
	speed: 0.0908s/iter; left time: 1775.5401s
Epoch: 6 cost time: 18.717804193496704
Epoch: 6, Steps: 208 | Train Loss: 3.328 Vali Loss: 4.385 Vali Acc: 0.087 Test Loss: 4.385 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0931695
	speed: 0.2738s/iter; left time: 5326.8143s
	iters: 200, epoch: 7 | loss: 4.0725832
	speed: 0.0893s/iter; left time: 1727.5201s
Epoch: 7 cost time: 20.413830995559692
Epoch: 7, Steps: 208 | Train Loss: 3.213 Vali Loss: 4.511 Vali Acc: 0.106 Test Loss: 4.511 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.1645613
	speed: 0.2726s/iter; left time: 5246.1093s
	iters: 200, epoch: 8 | loss: 2.7386336
	speed: 0.0859s/iter; left time: 1644.4085s
Epoch: 8 cost time: 20.10508418083191
Epoch: 8, Steps: 208 | Train Loss: 2.982 Vali Loss: 5.219 Vali Acc: 0.118 Test Loss: 5.219 Test Acc: 0.118
Validation loss decreased (-0.107321 --> -0.117753).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7948279
	speed: 0.2701s/iter; left time: 5142.5748s
	iters: 200, epoch: 9 | loss: 2.3695455
	speed: 0.0845s/iter; left time: 1599.6067s
Epoch: 9 cost time: 19.031737089157104
Epoch: 9, Steps: 208 | Train Loss: 2.608 Vali Loss: 5.329 Vali Acc: 0.105 Test Loss: 5.329 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.8989441
	speed: 0.2420s/iter; left time: 4557.0423s
	iters: 200, epoch: 10 | loss: 1.8898737
	speed: 0.0900s/iter; left time: 1686.0129s
Epoch: 10 cost time: 17.745028257369995
Epoch: 10, Steps: 208 | Train Loss: 2.367 Vali Loss: 5.234 Vali Acc: 0.113 Test Loss: 5.234 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 3.0783889
	speed: 0.2682s/iter; left time: 4994.5201s
	iters: 200, epoch: 11 | loss: 2.9961829
	speed: 0.0935s/iter; left time: 1731.2259s
Epoch: 11 cost time: 20.181663036346436
Epoch: 11, Steps: 208 | Train Loss: 1.996 Vali Loss: 5.398 Vali Acc: 0.122 Test Loss: 5.398 Test Acc: 0.122
Validation loss decreased (-0.117753 --> -0.121926).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3544416
	speed: 0.2557s/iter; left time: 4708.9341s
	iters: 200, epoch: 12 | loss: 2.5607228
	speed: 0.0878s/iter; left time: 1607.8984s
Epoch: 12 cost time: 18.821062088012695
Epoch: 12, Steps: 208 | Train Loss: 1.672 Vali Loss: 6.150 Vali Acc: 0.125 Test Loss: 6.150 Test Acc: 0.125
Validation loss decreased (-0.121926 --> -0.124603).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5078847
	speed: 0.2600s/iter; left time: 4734.1848s
	iters: 200, epoch: 13 | loss: 0.9920421
	speed: 0.0863s/iter; left time: 1563.0757s
Epoch: 13 cost time: 18.88444495201111
Epoch: 13, Steps: 208 | Train Loss: 1.351 Vali Loss: 6.731 Vali Acc: 0.129 Test Loss: 6.731 Test Acc: 0.129
Validation loss decreased (-0.124603 --> -0.128773).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0932497
	speed: 0.2464s/iter; left time: 4433.6317s
	iters: 200, epoch: 14 | loss: 1.2822617
	speed: 0.0857s/iter; left time: 1532.9793s
Epoch: 14 cost time: 17.176815032958984
Epoch: 14, Steps: 208 | Train Loss: 1.142 Vali Loss: 7.563 Vali Acc: 0.112 Test Loss: 7.563 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0082101
	speed: 0.2434s/iter; left time: 4330.4621s
	iters: 200, epoch: 15 | loss: 0.2119917
	speed: 0.0712s/iter; left time: 1260.2017s
Epoch: 15 cost time: 16.240794897079468
Epoch: 15, Steps: 208 | Train Loss: 0.952 Vali Loss: 7.650 Vali Acc: 0.125 Test Loss: 7.650 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5675849
	speed: 0.2367s/iter; left time: 4160.7494s
	iters: 200, epoch: 16 | loss: 1.0783278
	speed: 0.0789s/iter; left time: 1379.2840s
Epoch: 16 cost time: 17.33234739303589
Epoch: 16, Steps: 208 | Train Loss: 0.799 Vali Loss: 7.488 Vali Acc: 0.123 Test Loss: 7.488 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6947297
	speed: 0.2423s/iter; left time: 4209.1258s
	iters: 200, epoch: 17 | loss: 0.3350755
	speed: 0.0843s/iter; left time: 1456.8539s
Epoch: 17 cost time: 16.541640281677246
Epoch: 17, Steps: 208 | Train Loss: 0.679 Vali Loss: 7.834 Vali Acc: 0.123 Test Loss: 7.834 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4979844
	speed: 0.2242s/iter; left time: 3849.0749s
	iters: 200, epoch: 18 | loss: 0.7054025
	speed: 0.0869s/iter; left time: 1483.6530s
Epoch: 18 cost time: 16.520874500274658
Epoch: 18, Steps: 208 | Train Loss: 0.577 Vali Loss: 8.140 Vali Acc: 0.133 Test Loss: 8.140 Test Acc: 0.133
Validation loss decreased (-0.128773 --> -0.132934).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9308885
	speed: 0.2630s/iter; left time: 4460.0968s
	iters: 200, epoch: 19 | loss: 0.1576717
	speed: 0.0834s/iter; left time: 1406.0530s
Epoch: 19 cost time: 18.570505142211914
Epoch: 19, Steps: 208 | Train Loss: 0.504 Vali Loss: 8.507 Vali Acc: 0.124 Test Loss: 8.507 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.3441064
	speed: 0.2433s/iter; left time: 4075.1796s
	iters: 200, epoch: 20 | loss: 0.3528142
	speed: 0.0710s/iter; left time: 1182.1836s
Epoch: 20 cost time: 15.999120473861694
Epoch: 20, Steps: 208 | Train Loss: 0.469 Vali Loss: 8.636 Vali Acc: 0.121 Test Loss: 8.636 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0250549
	speed: 0.2474s/iter; left time: 4091.9749s
	iters: 200, epoch: 21 | loss: 0.1376363
	speed: 0.0770s/iter; left time: 1266.4265s
Epoch: 21 cost time: 16.969722032546997
Epoch: 21, Steps: 208 | Train Loss: 0.415 Vali Loss: 9.244 Vali Acc: 0.120 Test Loss: 9.244 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.2356861
	speed: 0.2411s/iter; left time: 3937.6833s
	iters: 200, epoch: 22 | loss: 0.2671716
	speed: 0.0756s/iter; left time: 1227.7667s
Epoch: 22 cost time: 16.23224902153015
Epoch: 22, Steps: 208 | Train Loss: 0.424 Vali Loss: 9.304 Vali Acc: 0.124 Test Loss: 9.304 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.3589848
	speed: 0.2453s/iter; left time: 3956.2392s
	iters: 200, epoch: 23 | loss: 0.6614046
	speed: 0.0886s/iter; left time: 1420.0112s
Epoch: 23 cost time: 19.07004737854004
Epoch: 23, Steps: 208 | Train Loss: 0.346 Vali Loss: 9.080 Vali Acc: 0.122 Test Loss: 9.080 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.6240208
	speed: 0.2674s/iter; left time: 4256.1655s
	iters: 200, epoch: 24 | loss: 0.8899614
	speed: 0.0860s/iter; left time: 1360.2004s
Epoch: 24 cost time: 19.185291051864624
Epoch: 24, Steps: 208 | Train Loss: 0.362 Vali Loss: 9.629 Vali Acc: 0.120 Test Loss: 9.629 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.3585976
	speed: 0.2525s/iter; left time: 3965.9398s
	iters: 200, epoch: 25 | loss: 0.8315804
	speed: 0.0737s/iter; left time: 1150.5817s
Epoch: 25 cost time: 15.846457242965698
Epoch: 25, Steps: 208 | Train Loss: 0.345 Vali Loss: 9.861 Vali Acc: 0.109 Test Loss: 9.861 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0365912
	speed: 0.2904s/iter; left time: 4501.2967s
	iters: 200, epoch: 26 | loss: 0.5183513
	speed: 0.1130s/iter; left time: 1740.2184s
Epoch: 26 cost time: 23.85488486289978
Epoch: 26, Steps: 208 | Train Loss: 0.294 Vali Loss: 10.082 Vali Acc: 0.117 Test Loss: 10.082 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.3252768
	speed: 0.3009s/iter; left time: 4601.0750s
	iters: 200, epoch: 27 | loss: 0.2906563
	speed: 0.1118s/iter; left time: 1698.3334s
Epoch: 27 cost time: 23.729423999786377
Epoch: 27, Steps: 208 | Train Loss: 0.304 Vali Loss: 10.555 Vali Acc: 0.109 Test Loss: 10.555 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.5478596
	speed: 0.2561s/iter; left time: 3863.7196s
	iters: 200, epoch: 28 | loss: 0.1230486
	speed: 0.0951s/iter; left time: 1425.0962s
Epoch: 28 cost time: 19.83069610595703
Epoch: 28, Steps: 208 | Train Loss: 0.284 Vali Loss: 10.351 Vali Acc: 0.127 Test Loss: 10.351 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13301521025946914
model parameter : 1060903
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5358629
	speed: 0.1113s/iter; left time: 2303.7105s
	iters: 200, epoch: 1 | loss: 3.6820240
	speed: 0.1079s/iter; left time: 2222.0405s
Epoch: 1 cost time: 23.13477635383606
Epoch: 1, Steps: 208 | Train Loss: 4.029 Vali Loss: 3.770 Vali Acc: 0.069 Test Loss: 3.770 Test Acc: 0.069
Validation loss decreased (inf --> -0.069154).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5298362
	speed: 0.2877s/iter; left time: 5895.9806s
	iters: 200, epoch: 2 | loss: 3.3615606
	speed: 0.1034s/iter; left time: 2109.0843s
Epoch: 2 cost time: 22.691980361938477
Epoch: 2, Steps: 208 | Train Loss: 3.425 Vali Loss: 3.717 Vali Acc: 0.072 Test Loss: 3.717 Test Acc: 0.072
Validation loss decreased (-0.069154 --> -0.072137).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9489124
	speed: 0.2926s/iter; left time: 5936.3291s
	iters: 200, epoch: 3 | loss: 3.2249212
	speed: 0.1106s/iter; left time: 2232.7812s
Epoch: 3 cost time: 23.36725664138794
Epoch: 3, Steps: 208 | Train Loss: 3.333 Vali Loss: 3.892 Vali Acc: 0.074 Test Loss: 3.892 Test Acc: 0.074
Validation loss decreased (-0.072137 --> -0.074223).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2843888
	speed: 0.2500s/iter; left time: 5019.9797s
	iters: 200, epoch: 4 | loss: 2.4484806
	speed: 0.1041s/iter; left time: 2079.7881s
Epoch: 4 cost time: 20.366050004959106
Epoch: 4, Steps: 208 | Train Loss: 3.289 Vali Loss: 4.026 Vali Acc: 0.095 Test Loss: 4.026 Test Acc: 0.095
Validation loss decreased (-0.074223 --> -0.095397).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6837053
	speed: 0.3039s/iter; left time: 6038.8791s
	iters: 200, epoch: 5 | loss: 3.4165742
	speed: 0.1258s/iter; left time: 2487.7297s
Epoch: 5 cost time: 25.66392683982849
Epoch: 5, Steps: 208 | Train Loss: 3.291 Vali Loss: 4.109 Vali Acc: 0.115 Test Loss: 4.109 Test Acc: 0.115
Validation loss decreased (-0.095397 --> -0.114781).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2325253
	speed: 0.2651s/iter; left time: 5211.2283s
	iters: 200, epoch: 6 | loss: 3.3122134
	speed: 0.0843s/iter; left time: 1649.3516s
Epoch: 6 cost time: 18.18164849281311
Epoch: 6, Steps: 208 | Train Loss: 3.177 Vali Loss: 4.443 Vali Acc: 0.101 Test Loss: 4.443 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0237181
	speed: 0.2792s/iter; left time: 5431.1293s
	iters: 200, epoch: 7 | loss: 2.9391494
	speed: 0.1018s/iter; left time: 1969.2257s
Epoch: 7 cost time: 22.001192808151245
Epoch: 7, Steps: 208 | Train Loss: 2.993 Vali Loss: 4.560 Vali Acc: 0.106 Test Loss: 4.560 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.4895198
	speed: 0.2849s/iter; left time: 5482.7825s
	iters: 200, epoch: 8 | loss: 3.3869467
	speed: 0.0871s/iter; left time: 1667.1360s
Epoch: 8 cost time: 20.778738737106323
Epoch: 8, Steps: 208 | Train Loss: 2.778 Vali Loss: 5.197 Vali Acc: 0.112 Test Loss: 5.197 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.0851622
	speed: 0.2748s/iter; left time: 5231.0481s
	iters: 200, epoch: 9 | loss: 2.4090772
	speed: 0.1001s/iter; left time: 1896.1912s
Epoch: 9 cost time: 21.863805055618286
Epoch: 9, Steps: 208 | Train Loss: 2.475 Vali Loss: 5.041 Vali Acc: 0.108 Test Loss: 5.041 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5480753
	speed: 0.2721s/iter; left time: 5123.4265s
	iters: 200, epoch: 10 | loss: 1.8078712
	speed: 0.0929s/iter; left time: 1739.9439s
Epoch: 10 cost time: 20.1093487739563
Epoch: 10, Steps: 208 | Train Loss: 2.115 Vali Loss: 6.930 Vali Acc: 0.109 Test Loss: 6.930 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.1767788
	speed: 0.2731s/iter; left time: 5086.2109s
	iters: 200, epoch: 11 | loss: 2.3177023
	speed: 0.0986s/iter; left time: 1826.5740s
Epoch: 11 cost time: 21.280210256576538
Epoch: 11, Steps: 208 | Train Loss: 1.875 Vali Loss: 6.408 Vali Acc: 0.107 Test Loss: 6.408 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3622928
	speed: 0.2654s/iter; left time: 4886.7217s
	iters: 200, epoch: 12 | loss: 2.4975152
	speed: 0.0882s/iter; left time: 1614.8515s
Epoch: 12 cost time: 19.15709662437439
Epoch: 12, Steps: 208 | Train Loss: 1.530 Vali Loss: 5.975 Vali Acc: 0.111 Test Loss: 5.975 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.9159447
	speed: 0.2755s/iter; left time: 5014.7607s
	iters: 200, epoch: 13 | loss: 1.0975924
	speed: 0.0927s/iter; left time: 1678.4942s
Epoch: 13 cost time: 19.92218852043152
Epoch: 13, Steps: 208 | Train Loss: 1.240 Vali Loss: 7.148 Vali Acc: 0.115 Test Loss: 7.148 Test Acc: 0.115
Validation loss decreased (-0.114781 --> -0.115049).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9424071
	speed: 0.2537s/iter; left time: 4565.1381s
	iters: 200, epoch: 14 | loss: 0.8973511
	speed: 0.0880s/iter; left time: 1574.5271s
Epoch: 14 cost time: 18.461161136627197
Epoch: 14, Steps: 208 | Train Loss: 1.094 Vali Loss: 7.112 Vali Acc: 0.108 Test Loss: 7.112 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7140306
	speed: 0.2609s/iter; left time: 4641.8348s
	iters: 200, epoch: 15 | loss: 0.6792986
	speed: 0.0848s/iter; left time: 1499.5188s
Epoch: 15 cost time: 18.54322862625122
Epoch: 15, Steps: 208 | Train Loss: 0.895 Vali Loss: 8.071 Vali Acc: 0.116 Test Loss: 8.071 Test Acc: 0.116
Validation loss decreased (-0.115049 --> -0.115935).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7303408
	speed: 0.2499s/iter; left time: 4393.9101s
	iters: 200, epoch: 16 | loss: 1.1019027
	speed: 0.0707s/iter; left time: 1235.8945s
Epoch: 16 cost time: 14.988839864730835
Epoch: 16, Steps: 208 | Train Loss: 0.786 Vali Loss: 8.489 Vali Acc: 0.117 Test Loss: 8.489 Test Acc: 0.117
Validation loss decreased (-0.115935 --> -0.117124).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4233282
	speed: 0.2832s/iter; left time: 4920.5368s
	iters: 200, epoch: 17 | loss: 1.1734184
	speed: 0.0970s/iter; left time: 1674.6346s
Epoch: 17 cost time: 21.333905935287476
Epoch: 17, Steps: 208 | Train Loss: 0.699 Vali Loss: 8.069 Vali Acc: 0.108 Test Loss: 8.069 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2477399
	speed: 0.2837s/iter; left time: 4869.0508s
	iters: 200, epoch: 18 | loss: 0.2274584
	speed: 0.1013s/iter; left time: 1728.1199s
Epoch: 18 cost time: 21.679405689239502
Epoch: 18, Steps: 208 | Train Loss: 0.640 Vali Loss: 8.337 Vali Acc: 0.104 Test Loss: 8.337 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.7664828
	speed: 0.2641s/iter; left time: 4478.2242s
	iters: 200, epoch: 19 | loss: 0.8300020
	speed: 0.0869s/iter; left time: 1464.1200s
Epoch: 19 cost time: 18.845442056655884
Epoch: 19, Steps: 208 | Train Loss: 0.546 Vali Loss: 8.770 Vali Acc: 0.112 Test Loss: 8.770 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3212145
	speed: 0.2682s/iter; left time: 4491.5925s
	iters: 200, epoch: 20 | loss: 0.3162478
	speed: 0.0854s/iter; left time: 1421.4146s
Epoch: 20 cost time: 18.357996463775635
Epoch: 20, Steps: 208 | Train Loss: 0.523 Vali Loss: 8.820 Vali Acc: 0.108 Test Loss: 8.820 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.7108619
	speed: 0.2913s/iter; left time: 4817.8824s
	iters: 200, epoch: 21 | loss: 0.3751516
	speed: 0.0724s/iter; left time: 1189.5790s
Epoch: 21 cost time: 18.353310108184814
Epoch: 21, Steps: 208 | Train Loss: 0.485 Vali Loss: 8.726 Vali Acc: 0.110 Test Loss: 8.726 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.8088174
	speed: 0.2590s/iter; left time: 4230.2102s
	iters: 200, epoch: 22 | loss: 0.6233486
	speed: 0.0783s/iter; left time: 1270.8401s
Epoch: 22 cost time: 17.14110517501831
Epoch: 22, Steps: 208 | Train Loss: 0.420 Vali Loss: 9.788 Vali Acc: 0.110 Test Loss: 9.788 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.1336506
	speed: 0.2816s/iter; left time: 4540.0446s
	iters: 200, epoch: 23 | loss: 0.4884287
	speed: 0.0955s/iter; left time: 1530.0588s
Epoch: 23 cost time: 20.792057037353516
Epoch: 23, Steps: 208 | Train Loss: 0.419 Vali Loss: 9.426 Vali Acc: 0.100 Test Loss: 9.426 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.3138074
	speed: 0.2826s/iter; left time: 4498.9383s
	iters: 200, epoch: 24 | loss: 0.2808427
	speed: 0.0899s/iter; left time: 1422.6365s
Epoch: 24 cost time: 19.749770402908325
Epoch: 24, Steps: 208 | Train Loss: 0.389 Vali Loss: 9.460 Vali Acc: 0.117 Test Loss: 9.460 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1484571
	speed: 0.2633s/iter; left time: 4135.8421s
	iters: 200, epoch: 25 | loss: 0.4625998
	speed: 0.0848s/iter; left time: 1324.1801s
Epoch: 25 cost time: 18.257148504257202
Epoch: 25, Steps: 208 | Train Loss: 0.340 Vali Loss: 9.843 Vali Acc: 0.106 Test Loss: 9.843 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0346615
	speed: 0.2611s/iter; left time: 4046.8662s
	iters: 200, epoch: 26 | loss: 0.4757716
	speed: 0.0910s/iter; left time: 1401.7152s
Epoch: 26 cost time: 19.885052919387817
Epoch: 26, Steps: 208 | Train Loss: 0.334 Vali Loss: 10.254 Vali Acc: 0.120 Test Loss: 10.254 Test Acc: 0.120
Validation loss decreased (-0.117124 --> -0.119492).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.5008352
	speed: 0.2537s/iter; left time: 3880.4526s
	iters: 200, epoch: 27 | loss: 0.3809613
	speed: 0.0735s/iter; left time: 1116.1693s
Epoch: 27 cost time: 17.435568809509277
Epoch: 27, Steps: 208 | Train Loss: 0.314 Vali Loss: 10.022 Vali Acc: 0.111 Test Loss: 10.022 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.2631308
	speed: 0.2570s/iter; left time: 3877.4436s
	iters: 200, epoch: 28 | loss: 0.5370374
	speed: 0.0748s/iter; left time: 1121.5127s
Epoch: 28 cost time: 17.409345626831055
Epoch: 28, Steps: 208 | Train Loss: 0.325 Vali Loss: 10.948 Vali Acc: 0.110 Test Loss: 10.948 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.7030891
	speed: 0.3150s/iter; left time: 4685.9571s
	iters: 200, epoch: 29 | loss: 0.3590945
	speed: 0.1221s/iter; left time: 1804.4895s
Epoch: 29 cost time: 27.5330228805542
Epoch: 29, Steps: 208 | Train Loss: 0.343 Vali Loss: 10.909 Vali Acc: 0.105 Test Loss: 10.909 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0022532
	speed: 0.2994s/iter; left time: 4392.2291s
	iters: 200, epoch: 30 | loss: 0.1424116
	speed: 0.1057s/iter; left time: 1540.6300s
Epoch: 30 cost time: 22.333783864974976
Epoch: 30, Steps: 208 | Train Loss: 0.315 Vali Loss: 11.680 Vali Acc: 0.108 Test Loss: 11.680 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.2217386
	speed: 0.3167s/iter; left time: 4579.2866s
	iters: 200, epoch: 31 | loss: 0.0961069
	speed: 0.1212s/iter; left time: 1739.8873s
Epoch: 31 cost time: 25.257118701934814
Epoch: 31, Steps: 208 | Train Loss: 0.314 Vali Loss: 11.394 Vali Acc: 0.119 Test Loss: 11.394 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.2262042
	speed: 0.2997s/iter; left time: 4271.8527s
	iters: 200, epoch: 32 | loss: 0.3256235
	speed: 0.1173s/iter; left time: 1659.4927s
Epoch: 32 cost time: 25.02537512779236
Epoch: 32, Steps: 208 | Train Loss: 0.318 Vali Loss: 11.978 Vali Acc: 0.110 Test Loss: 11.978 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.7586758
	speed: 0.3100s/iter; left time: 4353.9310s
	iters: 200, epoch: 33 | loss: 0.0189761
	speed: 0.1114s/iter; left time: 1552.8042s
Epoch: 33 cost time: 23.961647748947144
Epoch: 33, Steps: 208 | Train Loss: 0.289 Vali Loss: 11.270 Vali Acc: 0.106 Test Loss: 11.270 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0563935
	speed: 0.3168s/iter; left time: 4383.4942s
	iters: 200, epoch: 34 | loss: 0.1977714
	speed: 0.1345s/iter; left time: 1847.7232s
Epoch: 34 cost time: 28.13739824295044
Epoch: 34, Steps: 208 | Train Loss: 0.285 Vali Loss: 11.340 Vali Acc: 0.108 Test Loss: 11.340 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.2317384
	speed: 0.2961s/iter; left time: 4035.8295s
	iters: 200, epoch: 35 | loss: 0.3320681
	speed: 0.1267s/iter; left time: 1714.3981s
Epoch: 35 cost time: 24.479607820510864
Epoch: 35, Steps: 208 | Train Loss: 0.293 Vali Loss: 11.570 Vali Acc: 0.112 Test Loss: 11.570 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0647660
	speed: 0.3197s/iter; left time: 4290.6053s
	iters: 200, epoch: 36 | loss: 0.0234044
	speed: 0.1124s/iter; left time: 1497.6751s
Epoch: 36 cost time: 25.41834306716919
Epoch: 36, Steps: 208 | Train Loss: 0.262 Vali Loss: 11.851 Vali Acc: 0.112 Test Loss: 11.851 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11959439308082315
model parameter : 897575
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1985416
	speed: 0.1392s/iter; left time: 2882.3076s
	iters: 200, epoch: 1 | loss: 4.3533192
	speed: 0.1070s/iter; left time: 2204.7977s
Epoch: 1 cost time: 25.606513738632202
Epoch: 1, Steps: 208 | Train Loss: 3.963 Vali Loss: 3.854 Vali Acc: 0.055 Test Loss: 3.854 Test Acc: 0.055
Validation loss decreased (inf --> -0.055136).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6857662
	speed: 0.2882s/iter; left time: 5905.2224s
	iters: 200, epoch: 2 | loss: 3.3977599
	speed: 0.1180s/iter; left time: 2405.8113s
Epoch: 2 cost time: 24.249584674835205
Epoch: 2, Steps: 208 | Train Loss: 3.473 Vali Loss: 3.643 Vali Acc: 0.083 Test Loss: 3.643 Test Acc: 0.083
Validation loss decreased (-0.055136 --> -0.083173).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8851328
	speed: 0.3255s/iter; left time: 6602.1071s
	iters: 200, epoch: 3 | loss: 3.6069484
	speed: 0.1148s/iter; left time: 2316.7745s
Epoch: 3 cost time: 25.78584384918213
Epoch: 3, Steps: 208 | Train Loss: 3.340 Vali Loss: 3.773 Vali Acc: 0.079 Test Loss: 3.773 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7798765
	speed: 0.3331s/iter; left time: 6688.4111s
	iters: 200, epoch: 4 | loss: 3.6147983
	speed: 0.1318s/iter; left time: 2632.8289s
Epoch: 4 cost time: 27.730644941329956
Epoch: 4, Steps: 208 | Train Loss: 3.235 Vali Loss: 3.721 Vali Acc: 0.089 Test Loss: 3.721 Test Acc: 0.089
Validation loss decreased (-0.083173 --> -0.089435).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0920398
	speed: 0.2821s/iter; left time: 5605.8194s
	iters: 200, epoch: 5 | loss: 4.0306759
	speed: 0.1236s/iter; left time: 2442.7414s
Epoch: 5 cost time: 23.292121171951294
Epoch: 5, Steps: 208 | Train Loss: 3.160 Vali Loss: 3.616 Vali Acc: 0.113 Test Loss: 3.616 Test Acc: 0.113
Validation loss decreased (-0.089435 --> -0.112699).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.9069533
	speed: 0.3209s/iter; left time: 6309.0781s
	iters: 200, epoch: 6 | loss: 2.7910616
	speed: 0.1202s/iter; left time: 2350.7401s
Epoch: 6 cost time: 25.72265887260437
Epoch: 6, Steps: 208 | Train Loss: 3.017 Vali Loss: 5.074 Vali Acc: 0.111 Test Loss: 5.074 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4626799
	speed: 0.2938s/iter; left time: 5715.0365s
	iters: 200, epoch: 7 | loss: 2.5796590
	speed: 0.1266s/iter; left time: 2450.6723s
Epoch: 7 cost time: 26.0602285861969
Epoch: 7, Steps: 208 | Train Loss: 2.898 Vali Loss: 4.454 Vali Acc: 0.109 Test Loss: 4.454 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0585768
	speed: 0.3070s/iter; left time: 5907.4195s
	iters: 200, epoch: 8 | loss: 2.7485929
	speed: 0.1044s/iter; left time: 1998.9242s
Epoch: 8 cost time: 22.483405351638794
Epoch: 8, Steps: 208 | Train Loss: 2.638 Vali Loss: 5.202 Vali Acc: 0.111 Test Loss: 5.202 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3334174
	speed: 0.3011s/iter; left time: 5731.8113s
	iters: 200, epoch: 9 | loss: 2.1776187
	speed: 0.1301s/iter; left time: 2464.0148s
Epoch: 9 cost time: 26.817291975021362
Epoch: 9, Steps: 208 | Train Loss: 2.355 Vali Loss: 5.560 Vali Acc: 0.113 Test Loss: 5.560 Test Acc: 0.113
Validation loss decreased (-0.112699 --> -0.112978).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8365594
	speed: 0.2945s/iter; left time: 5544.7873s
	iters: 200, epoch: 10 | loss: 2.8008449
	speed: 0.1129s/iter; left time: 2113.5690s
Epoch: 10 cost time: 23.15582799911499
Epoch: 10, Steps: 208 | Train Loss: 2.061 Vali Loss: 6.217 Vali Acc: 0.106 Test Loss: 6.217 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.5777822
	speed: 0.3123s/iter; left time: 5815.6443s
	iters: 200, epoch: 11 | loss: 1.8688527
	speed: 0.1006s/iter; left time: 1862.8563s
Epoch: 11 cost time: 23.597174406051636
Epoch: 11, Steps: 208 | Train Loss: 1.750 Vali Loss: 6.266 Vali Acc: 0.106 Test Loss: 6.266 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4559615
	speed: 0.2991s/iter; left time: 5507.3317s
	iters: 200, epoch: 12 | loss: 2.2876987
	speed: 0.1161s/iter; left time: 2125.6757s
Epoch: 12 cost time: 24.80543303489685
Epoch: 12, Steps: 208 | Train Loss: 1.449 Vali Loss: 6.545 Vali Acc: 0.110 Test Loss: 6.545 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5026861
	speed: 0.2924s/iter; left time: 5322.5305s
	iters: 200, epoch: 13 | loss: 0.6784072
	speed: 0.1107s/iter; left time: 2004.7236s
Epoch: 13 cost time: 22.903034925460815
Epoch: 13, Steps: 208 | Train Loss: 1.222 Vali Loss: 7.436 Vali Acc: 0.101 Test Loss: 7.436 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3277992
	speed: 0.3113s/iter; left time: 5603.3174s
	iters: 200, epoch: 14 | loss: 0.8212812
	speed: 0.1137s/iter; left time: 2034.9433s
Epoch: 14 cost time: 25.002054691314697
Epoch: 14, Steps: 208 | Train Loss: 1.028 Vali Loss: 7.562 Vali Acc: 0.103 Test Loss: 7.562 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.1920171
	speed: 0.2686s/iter; left time: 4778.5994s
	iters: 200, epoch: 15 | loss: 0.3317303
	speed: 0.0742s/iter; left time: 1311.7652s
Epoch: 15 cost time: 17.10752511024475
Epoch: 15, Steps: 208 | Train Loss: 0.858 Vali Loss: 7.882 Vali Acc: 0.115 Test Loss: 7.882 Test Acc: 0.115
Validation loss decreased (-0.112978 --> -0.114445).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9076951
	speed: 0.2703s/iter; left time: 4752.7813s
	iters: 200, epoch: 16 | loss: 0.8466665
	speed: 0.0910s/iter; left time: 1590.2051s
Epoch: 16 cost time: 19.24702477455139
Epoch: 16, Steps: 208 | Train Loss: 0.774 Vali Loss: 8.060 Vali Acc: 0.101 Test Loss: 8.060 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3179398
	speed: 0.2920s/iter; left time: 5072.1707s
	iters: 200, epoch: 17 | loss: 1.2013994
	speed: 0.1099s/iter; left time: 1897.6113s
Epoch: 17 cost time: 23.433492183685303
Epoch: 17, Steps: 208 | Train Loss: 0.665 Vali Loss: 8.448 Vali Acc: 0.103 Test Loss: 8.448 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4604755
	speed: 0.3018s/iter; left time: 5180.1241s
	iters: 200, epoch: 18 | loss: 1.2714682
	speed: 0.1109s/iter; left time: 1892.0697s
Epoch: 18 cost time: 23.644384145736694
Epoch: 18, Steps: 208 | Train Loss: 0.589 Vali Loss: 8.835 Vali Acc: 0.104 Test Loss: 8.835 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6729639
	speed: 0.3032s/iter; left time: 5141.8737s
	iters: 200, epoch: 19 | loss: 0.4393859
	speed: 0.1116s/iter; left time: 1881.9946s
Epoch: 19 cost time: 24.259947061538696
Epoch: 19, Steps: 208 | Train Loss: 0.559 Vali Loss: 8.860 Vali Acc: 0.106 Test Loss: 8.860 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9876785
	speed: 0.2821s/iter; left time: 4725.0558s
	iters: 200, epoch: 20 | loss: 0.2691593
	speed: 0.1003s/iter; left time: 1670.0289s
Epoch: 20 cost time: 21.3009033203125
Epoch: 20, Steps: 208 | Train Loss: 0.471 Vali Loss: 9.667 Vali Acc: 0.107 Test Loss: 9.667 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5036724
	speed: 0.2692s/iter; left time: 4453.0437s
	iters: 200, epoch: 21 | loss: 0.7956778
	speed: 0.0799s/iter; left time: 1313.4606s
Epoch: 21 cost time: 16.849146366119385
Epoch: 21, Steps: 208 | Train Loss: 0.501 Vali Loss: 10.126 Vali Acc: 0.100 Test Loss: 10.126 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3793897
	speed: 0.2753s/iter; left time: 4495.9415s
	iters: 200, epoch: 22 | loss: 0.9495078
	speed: 0.0898s/iter; left time: 1458.0402s
Epoch: 22 cost time: 20.26673936843872
Epoch: 22, Steps: 208 | Train Loss: 0.456 Vali Loss: 9.691 Vali Acc: 0.107 Test Loss: 9.691 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.4067062
	speed: 0.2703s/iter; left time: 4358.8049s
	iters: 200, epoch: 23 | loss: 0.2005419
	speed: 0.0807s/iter; left time: 1293.3292s
Epoch: 23 cost time: 18.73688793182373
Epoch: 23, Steps: 208 | Train Loss: 0.416 Vali Loss: 9.964 Vali Acc: 0.098 Test Loss: 9.964 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2713053
	speed: 0.2733s/iter; left time: 4350.3460s
	iters: 200, epoch: 24 | loss: 0.9753607
	speed: 0.0971s/iter; left time: 1535.2246s
Epoch: 24 cost time: 20.612102270126343
Epoch: 24, Steps: 208 | Train Loss: 0.375 Vali Loss: 10.811 Vali Acc: 0.095 Test Loss: 10.811 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.8173490
	speed: 0.2827s/iter; left time: 4441.3144s
	iters: 200, epoch: 25 | loss: 0.9441037
	speed: 0.0760s/iter; left time: 1185.9707s
Epoch: 25 cost time: 18.66990041732788
Epoch: 25, Steps: 208 | Train Loss: 0.415 Vali Loss: 10.287 Vali Acc: 0.101 Test Loss: 10.287 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11452430659111244
model parameter : 789159
model size : 5.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8304536
	speed: 0.2026s/iter; left time: 4193.2321s
	iters: 200, epoch: 1 | loss: 4.1180449
	speed: 0.1746s/iter; left time: 3597.3455s
Epoch: 1 cost time: 39.27159905433655
Epoch: 1, Steps: 208 | Train Loss: 4.700 Vali Loss: 4.745 Vali Acc: 0.048 Test Loss: 4.745 Test Acc: 0.048
Validation loss decreased (inf --> -0.048267).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3471770
	speed: 0.5110s/iter; left time: 10472.2137s
	iters: 200, epoch: 2 | loss: 4.9948072
	speed: 0.1886s/iter; left time: 3847.0686s
Epoch: 2 cost time: 39.63405728340149
Epoch: 2, Steps: 208 | Train Loss: 4.312 Vali Loss: 3.744 Vali Acc: 0.081 Test Loss: 3.744 Test Acc: 0.081
Validation loss decreased (-0.048267 --> -0.080487).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.4749250
	speed: 0.5229s/iter; left time: 10607.6785s
	iters: 200, epoch: 3 | loss: 6.3933239
	speed: 0.1849s/iter; left time: 3732.0782s
Epoch: 3 cost time: 37.779818534851074
Epoch: 3, Steps: 208 | Train Loss: 5.076 Vali Loss: 9.073 Vali Acc: 0.030 Test Loss: 9.073 Test Acc: 0.030
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.2418823
	speed: 0.5336s/iter; left time: 10712.1888s
	iters: 200, epoch: 4 | loss: 6.4989285
	speed: 0.1891s/iter; left time: 3778.3972s
Epoch: 4 cost time: 38.65462350845337
Epoch: 4, Steps: 208 | Train Loss: 5.798 Vali Loss: 7.531 Vali Acc: 0.061 Test Loss: 7.531 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 5.7728720
	speed: 0.5240s/iter; left time: 10410.4288s
	iters: 200, epoch: 5 | loss: 7.2732229
	speed: 0.1814s/iter; left time: 3585.3699s
Epoch: 5 cost time: 37.65308499336243
Epoch: 5, Steps: 208 | Train Loss: 5.921 Vali Loss: 5.420 Vali Acc: 0.097 Test Loss: 5.420 Test Acc: 0.097
Validation loss decreased (-0.080487 --> -0.097172).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.4189291
	speed: 0.5348s/iter; left time: 10515.2508s
	iters: 200, epoch: 6 | loss: 5.5217681
	speed: 0.2085s/iter; left time: 4079.3992s
Epoch: 6 cost time: 43.35170817375183
Epoch: 6, Steps: 208 | Train Loss: 5.887 Vali Loss: 5.968 Vali Acc: 0.101 Test Loss: 5.968 Test Acc: 0.101
Validation loss decreased (-0.097172 --> -0.100447).  Saving model ...
	iters: 100, epoch: 7 | loss: 5.4314432
	speed: 0.6305s/iter; left time: 12265.3812s
	iters: 200, epoch: 7 | loss: 5.0573916
	speed: 0.2317s/iter; left time: 4483.3127s
Epoch: 7 cost time: 48.73754072189331
Epoch: 7, Steps: 208 | Train Loss: 5.698 Vali Loss: 6.191 Vali Acc: 0.093 Test Loss: 6.191 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 5.3254476
	speed: 0.5833s/iter; left time: 11225.3331s
	iters: 200, epoch: 8 | loss: 4.2535958
	speed: 0.2035s/iter; left time: 3895.5707s
Epoch: 8 cost time: 41.29230713844299
Epoch: 8, Steps: 208 | Train Loss: 4.931 Vali Loss: 6.928 Vali Acc: 0.129 Test Loss: 6.928 Test Acc: 0.129
Validation loss decreased (-0.100447 --> -0.129069).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.9521651
	speed: 0.5561s/iter; left time: 10587.0944s
	iters: 200, epoch: 9 | loss: 4.2908378
	speed: 0.2069s/iter; left time: 3918.5153s
Epoch: 9 cost time: 41.347824573516846
Epoch: 9, Steps: 208 | Train Loss: 4.086 Vali Loss: 14.538 Vali Acc: 0.037 Test Loss: 14.538 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.3589876
	speed: 0.5446s/iter; left time: 10254.1982s
	iters: 200, epoch: 10 | loss: 2.7447846
	speed: 0.1863s/iter; left time: 3488.5569s
Epoch: 10 cost time: 37.63383340835571
Epoch: 10, Steps: 208 | Train Loss: 2.907 Vali Loss: 10.922 Vali Acc: 0.059 Test Loss: 10.922 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.6154587
	speed: 0.5311s/iter; left time: 9889.2566s
	iters: 200, epoch: 11 | loss: 2.6052620
	speed: 0.1961s/iter; left time: 3632.1882s
Epoch: 11 cost time: 39.67170786857605
Epoch: 11, Steps: 208 | Train Loss: 1.915 Vali Loss: 6.568 Vali Acc: 0.085 Test Loss: 6.568 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7680635
	speed: 0.5531s/iter; left time: 10183.7679s
	iters: 200, epoch: 12 | loss: 1.6569319
	speed: 0.1824s/iter; left time: 3340.5344s
Epoch: 12 cost time: 38.6002082824707
Epoch: 12, Steps: 208 | Train Loss: 1.459 Vali Loss: 7.709 Vali Acc: 0.077 Test Loss: 7.709 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.5833139
	speed: 0.5519s/iter; left time: 10047.6942s
	iters: 200, epoch: 13 | loss: 1.7203708
	speed: 0.1784s/iter; left time: 3230.2359s
Epoch: 13 cost time: 38.61146378517151
Epoch: 13, Steps: 208 | Train Loss: 1.233 Vali Loss: 6.409 Vali Acc: 0.139 Test Loss: 6.409 Test Acc: 0.139
Validation loss decreased (-0.129069 --> -0.139214).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4240029
	speed: 0.5351s/iter; left time: 9629.3161s
	iters: 200, epoch: 14 | loss: 1.0319450
	speed: 0.1803s/iter; left time: 3225.9926s
Epoch: 14 cost time: 38.15652537345886
Epoch: 14, Steps: 208 | Train Loss: 1.017 Vali Loss: 6.876 Vali Acc: 0.121 Test Loss: 6.876 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4238970
	speed: 0.5185s/iter; left time: 9223.8023s
	iters: 200, epoch: 15 | loss: 1.1045344
	speed: 0.2008s/iter; left time: 3551.2102s
Epoch: 15 cost time: 39.94521927833557
Epoch: 15, Steps: 208 | Train Loss: 0.851 Vali Loss: 7.218 Vali Acc: 0.124 Test Loss: 7.218 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4672363
	speed: 0.5615s/iter; left time: 9872.5786s
	iters: 200, epoch: 16 | loss: 0.9252935
	speed: 0.1654s/iter; left time: 2890.8459s
Epoch: 16 cost time: 37.69064450263977
Epoch: 16, Steps: 208 | Train Loss: 0.707 Vali Loss: 7.091 Vali Acc: 0.124 Test Loss: 7.091 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3074011
	speed: 0.5199s/iter; left time: 9032.4124s
	iters: 200, epoch: 17 | loss: 1.0510842
	speed: 0.1862s/iter; left time: 3216.1512s
Epoch: 17 cost time: 38.530425786972046
Epoch: 17, Steps: 208 | Train Loss: 0.526 Vali Loss: 8.058 Vali Acc: 0.140 Test Loss: 8.058 Test Acc: 0.140
Validation loss decreased (-0.139214 --> -0.140391).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4119390
	speed: 0.5010s/iter; left time: 8599.2688s
	iters: 200, epoch: 18 | loss: 0.4224006
	speed: 0.1730s/iter; left time: 2952.2481s
Epoch: 18 cost time: 37.369017601013184
Epoch: 18, Steps: 208 | Train Loss: 0.465 Vali Loss: 8.930 Vali Acc: 0.122 Test Loss: 8.930 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.7988390
	speed: 0.5241s/iter; left time: 8887.9064s
	iters: 200, epoch: 19 | loss: 0.5151811
	speed: 0.1795s/iter; left time: 3025.1903s
Epoch: 19 cost time: 38.379913568496704
Epoch: 19, Steps: 208 | Train Loss: 0.382 Vali Loss: 7.649 Vali Acc: 0.120 Test Loss: 7.649 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.9726831
	speed: 0.5288s/iter; left time: 8857.2453s
	iters: 200, epoch: 20 | loss: 0.4156608
	speed: 0.2015s/iter; left time: 3353.9759s
Epoch: 20 cost time: 41.28798484802246
Epoch: 20, Steps: 208 | Train Loss: 0.339 Vali Loss: 9.966 Vali Acc: 0.127 Test Loss: 9.966 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.3859876
	speed: 0.5223s/iter; left time: 8638.7953s
	iters: 200, epoch: 21 | loss: 0.1106010
	speed: 0.1760s/iter; left time: 2893.9176s
Epoch: 21 cost time: 36.974605083465576
Epoch: 21, Steps: 208 | Train Loss: 0.276 Vali Loss: 8.617 Vali Acc: 0.133 Test Loss: 8.617 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0859540
	speed: 0.4763s/iter; left time: 7779.0148s
	iters: 200, epoch: 22 | loss: 0.2021124
	speed: 0.1667s/iter; left time: 2705.6062s
Epoch: 22 cost time: 34.19867253303528
Epoch: 22, Steps: 208 | Train Loss: 0.262 Vali Loss: 9.294 Vali Acc: 0.120 Test Loss: 9.294 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0037109
	speed: 0.4853s/iter; left time: 7825.6003s
	iters: 200, epoch: 23 | loss: 0.0655387
	speed: 0.1476s/iter; left time: 2365.5195s
Epoch: 23 cost time: 33.07296824455261
Epoch: 23, Steps: 208 | Train Loss: 0.223 Vali Loss: 11.678 Vali Acc: 0.126 Test Loss: 11.678 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.4394480
	speed: 0.4673s/iter; left time: 7438.6835s
	iters: 200, epoch: 24 | loss: 0.0589022
	speed: 0.1616s/iter; left time: 2556.3304s
Epoch: 24 cost time: 33.913928508758545
Epoch: 24, Steps: 208 | Train Loss: 0.217 Vali Loss: 8.830 Vali Acc: 0.118 Test Loss: 8.830 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.6077965
	speed: 0.4537s/iter; left time: 7126.7565s
	iters: 200, epoch: 25 | loss: 0.0787880
	speed: 0.1531s/iter; left time: 2389.3685s
Epoch: 25 cost time: 32.65229916572571
Epoch: 25, Steps: 208 | Train Loss: 0.163 Vali Loss: 10.830 Vali Acc: 0.122 Test Loss: 10.830 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.6326172
	speed: 0.4987s/iter; left time: 7730.5481s
	iters: 200, epoch: 26 | loss: 0.0851369
	speed: 0.1861s/iter; left time: 2866.3753s
Epoch: 26 cost time: 37.86145496368408
Epoch: 26, Steps: 208 | Train Loss: 0.195 Vali Loss: 12.406 Vali Acc: 0.120 Test Loss: 12.406 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0067766
	speed: 0.5378s/iter; left time: 8224.3346s
	iters: 200, epoch: 27 | loss: 0.0172106
	speed: 0.1822s/iter; left time: 2768.8568s
Epoch: 27 cost time: 37.31753754615784
Epoch: 27, Steps: 208 | Train Loss: 0.179 Vali Loss: 11.236 Vali Acc: 0.108 Test Loss: 11.236 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14047121980316135
model parameter : 4253479
model size : 18.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4750676
	speed: 0.0361s/iter; left time: 747.4291s
	iters: 200, epoch: 1 | loss: 3.9545016
	speed: 0.0210s/iter; left time: 432.7448s
Epoch: 1 cost time: 5.97487735748291
Epoch: 1, Steps: 208 | Train Loss: 4.255 Vali Loss: 3.649 Vali Acc: 0.067 Test Loss: 3.649 Test Acc: 0.067
Validation loss decreased (inf --> -0.066769).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4727941
	speed: 0.0721s/iter; left time: 1478.1616s
	iters: 200, epoch: 2 | loss: 4.8569012
	speed: 0.0205s/iter; left time: 418.4194s
Epoch: 2 cost time: 4.524653673171997
Epoch: 2, Steps: 208 | Train Loss: 3.766 Vali Loss: 3.601 Vali Acc: 0.074 Test Loss: 3.601 Test Acc: 0.074
Validation loss decreased (-0.066769 --> -0.074226).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.6625333
	speed: 0.0699s/iter; left time: 1418.2945s
	iters: 200, epoch: 3 | loss: 5.1166520
	speed: 0.0202s/iter; left time: 407.4925s
Epoch: 3 cost time: 4.468896865844727
Epoch: 3, Steps: 208 | Train Loss: 4.046 Vali Loss: 4.004 Vali Acc: 0.090 Test Loss: 4.004 Test Acc: 0.090
Validation loss decreased (-0.074226 --> -0.090327).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5032146
	speed: 0.0710s/iter; left time: 1425.9000s
	iters: 200, epoch: 4 | loss: 4.5874052
	speed: 0.0215s/iter; left time: 429.1888s
Epoch: 4 cost time: 4.738874435424805
Epoch: 4, Steps: 208 | Train Loss: 4.471 Vali Loss: 6.208 Vali Acc: 0.047 Test Loss: 6.208 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5596948
	speed: 0.0709s/iter; left time: 1407.8206s
	iters: 200, epoch: 5 | loss: 6.4857311
	speed: 0.0198s/iter; left time: 391.7178s
Epoch: 5 cost time: 4.501149415969849
Epoch: 5, Steps: 208 | Train Loss: 4.583 Vali Loss: 4.919 Vali Acc: 0.111 Test Loss: 4.919 Test Acc: 0.111
Validation loss decreased (-0.090327 --> -0.110598).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.1918974
	speed: 0.0679s/iter; left time: 1334.0686s
	iters: 200, epoch: 6 | loss: 3.9550381
	speed: 0.0209s/iter; left time: 408.7269s
Epoch: 6 cost time: 4.636948347091675
Epoch: 6, Steps: 208 | Train Loss: 4.547 Vali Loss: 5.411 Vali Acc: 0.106 Test Loss: 5.411 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.8176427
	speed: 0.0706s/iter; left time: 1374.2619s
	iters: 200, epoch: 7 | loss: 6.6715717
	speed: 0.0202s/iter; left time: 389.9724s
Epoch: 7 cost time: 4.5402796268463135
Epoch: 7, Steps: 208 | Train Loss: 4.306 Vali Loss: 4.458 Vali Acc: 0.114 Test Loss: 4.458 Test Acc: 0.114
Validation loss decreased (-0.110598 --> -0.113585).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9842556
	speed: 0.0713s/iter; left time: 1371.8561s
	iters: 200, epoch: 8 | loss: 5.5227804
	speed: 0.0196s/iter; left time: 375.9795s
Epoch: 8 cost time: 4.558775424957275
Epoch: 8, Steps: 208 | Train Loss: 3.875 Vali Loss: 5.465 Vali Acc: 0.109 Test Loss: 5.465 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.3459744
	speed: 0.0691s/iter; left time: 1315.0083s
	iters: 200, epoch: 9 | loss: 3.0980542
	speed: 0.0187s/iter; left time: 353.3923s
Epoch: 9 cost time: 4.461720943450928
Epoch: 9, Steps: 208 | Train Loss: 3.370 Vali Loss: 5.711 Vali Acc: 0.104 Test Loss: 5.711 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0093586
	speed: 0.0689s/iter; left time: 1297.3785s
	iters: 200, epoch: 10 | loss: 1.7773569
	speed: 0.0204s/iter; left time: 382.0653s
Epoch: 10 cost time: 4.579639434814453
Epoch: 10, Steps: 208 | Train Loss: 2.668 Vali Loss: 6.366 Vali Acc: 0.113 Test Loss: 6.366 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.8592401
	speed: 0.0655s/iter; left time: 1220.1803s
	iters: 200, epoch: 11 | loss: 2.9111645
	speed: 0.0216s/iter; left time: 399.8563s
Epoch: 11 cost time: 4.726830005645752
Epoch: 11, Steps: 208 | Train Loss: 2.126 Vali Loss: 5.572 Vali Acc: 0.130 Test Loss: 5.572 Test Acc: 0.130
Validation loss decreased (-0.113585 --> -0.130275).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5028920
	speed: 0.0666s/iter; left time: 1225.4556s
	iters: 200, epoch: 12 | loss: 2.1667933
	speed: 0.0186s/iter; left time: 340.5292s
Epoch: 12 cost time: 4.413598299026489
Epoch: 12, Steps: 208 | Train Loss: 1.523 Vali Loss: 6.084 Vali Acc: 0.128 Test Loss: 6.084 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3512844
	speed: 0.0662s/iter; left time: 1206.0702s
	iters: 200, epoch: 13 | loss: 0.8532549
	speed: 0.0192s/iter; left time: 347.1711s
Epoch: 13 cost time: 4.4002907276153564
Epoch: 13, Steps: 208 | Train Loss: 1.212 Vali Loss: 5.819 Vali Acc: 0.134 Test Loss: 5.819 Test Acc: 0.134
Validation loss decreased (-0.130275 --> -0.133554).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9591306
	speed: 0.0662s/iter; left time: 1190.5976s
	iters: 200, epoch: 14 | loss: 1.2164084
	speed: 0.0200s/iter; left time: 357.0505s
Epoch: 14 cost time: 4.345941781997681
Epoch: 14, Steps: 208 | Train Loss: 1.022 Vali Loss: 6.412 Vali Acc: 0.137 Test Loss: 6.412 Test Acc: 0.137
Validation loss decreased (-0.133554 --> -0.136530).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4584249
	speed: 0.0664s/iter; left time: 1181.2163s
	iters: 200, epoch: 15 | loss: 1.1785319
	speed: 0.0200s/iter; left time: 353.3561s
Epoch: 15 cost time: 4.493819236755371
Epoch: 15, Steps: 208 | Train Loss: 0.804 Vali Loss: 6.458 Vali Acc: 0.143 Test Loss: 6.458 Test Acc: 0.143
Validation loss decreased (-0.136530 --> -0.143389).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2731590
	speed: 0.0705s/iter; left time: 1240.1793s
	iters: 200, epoch: 16 | loss: 1.2624407
	speed: 0.0200s/iter; left time: 350.2803s
Epoch: 16 cost time: 4.677774429321289
Epoch: 16, Steps: 208 | Train Loss: 0.632 Vali Loss: 7.793 Vali Acc: 0.136 Test Loss: 7.793 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6277283
	speed: 0.0675s/iter; left time: 1173.5060s
	iters: 200, epoch: 17 | loss: 1.2162423
	speed: 0.0203s/iter; left time: 350.9300s
Epoch: 17 cost time: 4.590325832366943
Epoch: 17, Steps: 208 | Train Loss: 0.566 Vali Loss: 7.186 Vali Acc: 0.143 Test Loss: 7.186 Test Acc: 0.143
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7577720
	speed: 0.0704s/iter; left time: 1207.6823s
	iters: 200, epoch: 18 | loss: 0.5713205
	speed: 0.0213s/iter; left time: 363.9375s
Epoch: 18 cost time: 4.92103910446167
Epoch: 18, Steps: 208 | Train Loss: 0.472 Vali Loss: 7.473 Vali Acc: 0.143 Test Loss: 7.473 Test Acc: 0.143
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1895834
	speed: 0.0718s/iter; left time: 1217.0286s
	iters: 200, epoch: 19 | loss: 0.0761552
	speed: 0.0219s/iter; left time: 369.7608s
Epoch: 19 cost time: 5.007710218429565
Epoch: 19, Steps: 208 | Train Loss: 0.388 Vali Loss: 8.402 Vali Acc: 0.134 Test Loss: 8.402 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5582226
	speed: 0.0732s/iter; left time: 1226.3822s
	iters: 200, epoch: 20 | loss: 0.4501689
	speed: 0.0196s/iter; left time: 326.2188s
Epoch: 20 cost time: 4.72784948348999
Epoch: 20, Steps: 208 | Train Loss: 0.382 Vali Loss: 8.419 Vali Acc: 0.139 Test Loss: 8.419 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3728344
	speed: 0.0686s/iter; left time: 1135.4547s
	iters: 200, epoch: 21 | loss: 0.5577896
	speed: 0.0195s/iter; left time: 319.9062s
Epoch: 21 cost time: 4.577024459838867
Epoch: 21, Steps: 208 | Train Loss: 0.320 Vali Loss: 9.681 Vali Acc: 0.138 Test Loss: 9.681 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1019601
	speed: 0.0759s/iter; left time: 1239.4964s
	iters: 200, epoch: 22 | loss: 0.2575467
	speed: 0.0200s/iter; left time: 325.2511s
Epoch: 22 cost time: 4.671191215515137
Epoch: 22, Steps: 208 | Train Loss: 0.267 Vali Loss: 8.713 Vali Acc: 0.133 Test Loss: 8.713 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0174110
	speed: 0.0735s/iter; left time: 1184.7112s
	iters: 200, epoch: 23 | loss: 1.0888793
	speed: 0.0198s/iter; left time: 317.7139s
Epoch: 23 cost time: 4.687825679779053
Epoch: 23, Steps: 208 | Train Loss: 0.298 Vali Loss: 7.351 Vali Acc: 0.145 Test Loss: 7.351 Test Acc: 0.145
Validation loss decreased (-0.143389 --> -0.145170).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.5334638
	speed: 0.0734s/iter; left time: 1168.9025s
	iters: 200, epoch: 24 | loss: 0.7239058
	speed: 0.0208s/iter; left time: 329.6225s
Epoch: 24 cost time: 4.869491815567017
Epoch: 24, Steps: 208 | Train Loss: 0.242 Vali Loss: 9.849 Vali Acc: 0.136 Test Loss: 9.849 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1549487
	speed: 0.0702s/iter; left time: 1102.8162s
	iters: 200, epoch: 25 | loss: 0.1827745
	speed: 0.0200s/iter; left time: 312.3633s
Epoch: 25 cost time: 4.652779817581177
Epoch: 25, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.552 Vali Acc: 0.127 Test Loss: 9.552 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.4790786
	speed: 0.0711s/iter; left time: 1102.4958s
	iters: 200, epoch: 26 | loss: 0.2654563
	speed: 0.0204s/iter; left time: 314.3821s
Epoch: 26 cost time: 4.832150936126709
Epoch: 26, Steps: 208 | Train Loss: 0.219 Vali Loss: 10.946 Vali Acc: 0.135 Test Loss: 10.946 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0693574
	speed: 0.0727s/iter; left time: 1111.7919s
	iters: 200, epoch: 27 | loss: 0.0216182
	speed: 0.0206s/iter; left time: 312.6169s
Epoch: 27 cost time: 4.779184341430664
Epoch: 27, Steps: 208 | Train Loss: 0.225 Vali Loss: 10.390 Vali Acc: 0.132 Test Loss: 10.390 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.5789767
	speed: 0.0686s/iter; left time: 1034.2530s
	iters: 200, epoch: 28 | loss: 0.3846447
	speed: 0.0205s/iter; left time: 306.6140s
Epoch: 28 cost time: 4.7952799797058105
Epoch: 28, Steps: 208 | Train Loss: 0.207 Vali Loss: 10.589 Vali Acc: 0.132 Test Loss: 10.589 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0068889
	speed: 0.0725s/iter; left time: 1077.9712s
	iters: 200, epoch: 29 | loss: 0.0089960
	speed: 0.0218s/iter; left time: 322.4996s
Epoch: 29 cost time: 4.906654119491577
Epoch: 29, Steps: 208 | Train Loss: 0.181 Vali Loss: 10.460 Vali Acc: 0.134 Test Loss: 10.460 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.2636591
	speed: 0.0727s/iter; left time: 1066.3170s
	iters: 200, epoch: 30 | loss: 0.1431016
	speed: 0.0197s/iter; left time: 287.2838s
Epoch: 30 cost time: 4.792144060134888
Epoch: 30, Steps: 208 | Train Loss: 0.160 Vali Loss: 11.269 Vali Acc: 0.134 Test Loss: 11.269 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.1261501
	speed: 0.0683s/iter; left time: 988.1688s
	iters: 200, epoch: 31 | loss: 0.4213214
	speed: 0.0207s/iter; left time: 296.9833s
Epoch: 31 cost time: 4.717780113220215
Epoch: 31, Steps: 208 | Train Loss: 0.177 Vali Loss: 11.668 Vali Acc: 0.130 Test Loss: 11.668 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.4152167
	speed: 0.0718s/iter; left time: 1023.8208s
	iters: 200, epoch: 32 | loss: 0.1086775
	speed: 0.0217s/iter; left time: 306.8689s
Epoch: 32 cost time: 4.8894944190979
Epoch: 32, Steps: 208 | Train Loss: 0.193 Vali Loss: 12.349 Vali Acc: 0.135 Test Loss: 12.349 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0029123
	speed: 0.0716s/iter; left time: 1006.1621s
	iters: 200, epoch: 33 | loss: 0.2942904
	speed: 0.0203s/iter; left time: 283.5958s
Epoch: 33 cost time: 4.717668771743774
Epoch: 33, Steps: 208 | Train Loss: 0.214 Vali Loss: 11.164 Vali Acc: 0.120 Test Loss: 11.164 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14524306591112437
model parameter : 2277287
model size : 11.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8975666
	speed: 0.1533s/iter; left time: 3174.2721s
	iters: 200, epoch: 1 | loss: 4.0553012
	speed: 0.1320s/iter; left time: 2718.8586s
Epoch: 1 cost time: 30.097328186035156
Epoch: 1, Steps: 208 | Train Loss: 4.165 Vali Loss: 3.601 Vali Acc: 0.062 Test Loss: 3.601 Test Acc: 0.062
Validation loss decreased (inf --> -0.061700).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3955319
	speed: 0.4402s/iter; left time: 9021.2559s
	iters: 200, epoch: 2 | loss: 3.7500308
	speed: 0.2023s/iter; left time: 4126.1386s
Epoch: 2 cost time: 42.60942077636719
Epoch: 2, Steps: 208 | Train Loss: 3.568 Vali Loss: 3.879 Vali Acc: 0.073 Test Loss: 3.879 Test Acc: 0.073
Validation loss decreased (-0.061700 --> -0.073030).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9704626
	speed: 0.4311s/iter; left time: 8745.8260s
	iters: 200, epoch: 3 | loss: 3.6158109
	speed: 0.1897s/iter; left time: 3829.1797s
Epoch: 3 cost time: 39.67555522918701
Epoch: 3, Steps: 208 | Train Loss: 3.748 Vali Loss: 4.691 Vali Acc: 0.084 Test Loss: 4.691 Test Acc: 0.084
Validation loss decreased (-0.073030 --> -0.083759).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0693245
	speed: 0.4299s/iter; left time: 8631.4626s
	iters: 200, epoch: 4 | loss: 4.3546906
	speed: 0.1819s/iter; left time: 3633.0141s
Epoch: 4 cost time: 38.0957555770874
Epoch: 4, Steps: 208 | Train Loss: 3.954 Vali Loss: 4.534 Vali Acc: 0.103 Test Loss: 4.534 Test Acc: 0.103
Validation loss decreased (-0.083759 --> -0.103444).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0062222
	speed: 0.4611s/iter; left time: 9162.0358s
	iters: 200, epoch: 5 | loss: 3.8153925
	speed: 0.1898s/iter; left time: 3751.4227s
Epoch: 5 cost time: 41.92737150192261
Epoch: 5, Steps: 208 | Train Loss: 4.016 Vali Loss: 4.871 Vali Acc: 0.100 Test Loss: 4.871 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.2201762
	speed: 0.3957s/iter; left time: 7780.1697s
	iters: 200, epoch: 6 | loss: 5.6545691
	speed: 0.1881s/iter; left time: 3678.8043s
Epoch: 6 cost time: 38.53853392601013
Epoch: 6, Steps: 208 | Train Loss: 4.071 Vali Loss: 5.388 Vali Acc: 0.090 Test Loss: 5.388 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.2174788
	speed: 0.4621s/iter; left time: 8989.1482s
	iters: 200, epoch: 7 | loss: 6.1340065
	speed: 0.2019s/iter; left time: 3907.7571s
Epoch: 7 cost time: 43.083187103271484
Epoch: 7, Steps: 208 | Train Loss: 3.793 Vali Loss: 5.172 Vali Acc: 0.114 Test Loss: 5.172 Test Acc: 0.114
Validation loss decreased (-0.103444 --> -0.113578).  Saving model ...
	iters: 100, epoch: 8 | loss: 4.4462671
	speed: 0.4333s/iter; left time: 8339.6740s
	iters: 200, epoch: 8 | loss: 4.7678223
	speed: 0.1435s/iter; left time: 2747.4395s
Epoch: 8 cost time: 34.806870222091675
Epoch: 8, Steps: 208 | Train Loss: 3.545 Vali Loss: 5.397 Vali Acc: 0.116 Test Loss: 5.397 Test Acc: 0.116
Validation loss decreased (-0.113578 --> -0.115962).  Saving model ...
	iters: 100, epoch: 9 | loss: 4.1046815
	speed: 0.4284s/iter; left time: 8155.2673s
	iters: 200, epoch: 9 | loss: 4.2603536
	speed: 0.1939s/iter; left time: 3672.5329s
Epoch: 9 cost time: 39.92457151412964
Epoch: 9, Steps: 208 | Train Loss: 3.123 Vali Loss: 5.046 Vali Acc: 0.127 Test Loss: 5.046 Test Acc: 0.127
Validation loss decreased (-0.115962 --> -0.127298).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.8489134
	speed: 0.4206s/iter; left time: 7919.1987s
	iters: 200, epoch: 10 | loss: 3.2252440
	speed: 0.1556s/iter; left time: 2913.3070s
Epoch: 10 cost time: 35.68192768096924
Epoch: 10, Steps: 208 | Train Loss: 2.605 Vali Loss: 5.421 Vali Acc: 0.127 Test Loss: 5.421 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1329827
	speed: 0.3619s/iter; left time: 6738.0369s
	iters: 200, epoch: 11 | loss: 2.4620171
	speed: 0.1643s/iter; left time: 3042.6595s
Epoch: 11 cost time: 31.860755681991577
Epoch: 11, Steps: 208 | Train Loss: 2.115 Vali Loss: 5.194 Vali Acc: 0.117 Test Loss: 5.194 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2572596
	speed: 0.4194s/iter; left time: 7721.6930s
	iters: 200, epoch: 12 | loss: 1.1816639
	speed: 0.1655s/iter; left time: 3031.1846s
Epoch: 12 cost time: 35.487889528274536
Epoch: 12, Steps: 208 | Train Loss: 1.672 Vali Loss: 5.809 Vali Acc: 0.126 Test Loss: 5.809 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4407603
	speed: 0.3720s/iter; left time: 6772.6551s
	iters: 200, epoch: 13 | loss: 1.5714643
	speed: 0.1611s/iter; left time: 2917.2750s
Epoch: 13 cost time: 31.13173508644104
Epoch: 13, Steps: 208 | Train Loss: 1.319 Vali Loss: 6.032 Vali Acc: 0.127 Test Loss: 6.032 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3098131
	speed: 0.4003s/iter; left time: 7204.0290s
	iters: 200, epoch: 14 | loss: 1.4122765
	speed: 0.1636s/iter; left time: 2927.3372s
Epoch: 14 cost time: 35.2839469909668
Epoch: 14, Steps: 208 | Train Loss: 1.119 Vali Loss: 6.750 Vali Acc: 0.125 Test Loss: 6.750 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8621892
	speed: 0.4120s/iter; left time: 7329.3465s
	iters: 200, epoch: 15 | loss: 1.3298755
	speed: 0.1352s/iter; left time: 2390.8573s
Epoch: 15 cost time: 33.211023807525635
Epoch: 15, Steps: 208 | Train Loss: 0.852 Vali Loss: 6.686 Vali Acc: 0.127 Test Loss: 6.686 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.7549591
	speed: 0.3549s/iter; left time: 6239.3415s
	iters: 200, epoch: 16 | loss: 0.9653354
	speed: 0.1462s/iter; left time: 2555.8394s
Epoch: 16 cost time: 31.247944831848145
Epoch: 16, Steps: 208 | Train Loss: 0.698 Vali Loss: 6.300 Vali Acc: 0.129 Test Loss: 6.300 Test Acc: 0.129
Validation loss decreased (-0.127298 --> -0.129075).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6821948
	speed: 0.3351s/iter; left time: 5821.9890s
	iters: 200, epoch: 17 | loss: 0.4949424
	speed: 0.1341s/iter; left time: 2315.4538s
Epoch: 17 cost time: 27.36484408378601
Epoch: 17, Steps: 208 | Train Loss: 0.595 Vali Loss: 7.298 Vali Acc: 0.129 Test Loss: 7.298 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1684390
	speed: 0.3592s/iter; left time: 6166.1721s
	iters: 200, epoch: 18 | loss: 0.7108904
	speed: 0.1394s/iter; left time: 2378.6687s
Epoch: 18 cost time: 29.941749572753906
Epoch: 18, Steps: 208 | Train Loss: 0.476 Vali Loss: 7.344 Vali Acc: 0.134 Test Loss: 7.344 Test Acc: 0.134
Validation loss decreased (-0.129075 --> -0.134135).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5254225
	speed: 0.3860s/iter; left time: 6545.7051s
	iters: 200, epoch: 19 | loss: 0.2700868
	speed: 0.1747s/iter; left time: 2944.4983s
Epoch: 19 cost time: 38.31325626373291
Epoch: 19, Steps: 208 | Train Loss: 0.405 Vali Loss: 7.970 Vali Acc: 0.140 Test Loss: 7.970 Test Acc: 0.140
Validation loss decreased (-0.134135 --> -0.139497).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3472155
	speed: 0.3955s/iter; left time: 6624.1659s
	iters: 200, epoch: 20 | loss: 0.6848407
	speed: 0.1777s/iter; left time: 2957.7302s
Epoch: 20 cost time: 37.18142342567444
Epoch: 20, Steps: 208 | Train Loss: 0.390 Vali Loss: 8.799 Vali Acc: 0.128 Test Loss: 8.799 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2532850
	speed: 0.3991s/iter; left time: 6601.8531s
	iters: 200, epoch: 21 | loss: 0.5897047
	speed: 0.1669s/iter; left time: 2743.6533s
Epoch: 21 cost time: 36.12293004989624
Epoch: 21, Steps: 208 | Train Loss: 0.353 Vali Loss: 8.363 Vali Acc: 0.124 Test Loss: 8.363 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1212471
	speed: 0.3899s/iter; left time: 6368.9070s
	iters: 200, epoch: 22 | loss: 0.4114032
	speed: 0.1717s/iter; left time: 2787.4849s
Epoch: 22 cost time: 35.36712384223938
Epoch: 22, Steps: 208 | Train Loss: 0.331 Vali Loss: 8.656 Vali Acc: 0.138 Test Loss: 8.656 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.2037208
	speed: 0.3273s/iter; left time: 5278.0257s
	iters: 200, epoch: 23 | loss: 0.4109372
	speed: 0.1660s/iter; left time: 2660.5494s
Epoch: 23 cost time: 31.759660482406616
Epoch: 23, Steps: 208 | Train Loss: 0.301 Vali Loss: 8.765 Vali Acc: 0.138 Test Loss: 8.765 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.3256033
	speed: 0.3840s/iter; left time: 6112.4700s
	iters: 200, epoch: 24 | loss: 0.3130885
	speed: 0.1585s/iter; left time: 2507.4501s
Epoch: 24 cost time: 33.486652851104736
Epoch: 24, Steps: 208 | Train Loss: 0.270 Vali Loss: 9.310 Vali Acc: 0.139 Test Loss: 9.310 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.2667613
	speed: 0.3734s/iter; left time: 5864.9808s
	iters: 200, epoch: 25 | loss: 0.1612325
	speed: 0.1345s/iter; left time: 2099.2248s
Epoch: 25 cost time: 28.88223385810852
Epoch: 25, Steps: 208 | Train Loss: 0.257 Vali Loss: 9.376 Vali Acc: 0.134 Test Loss: 9.376 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2735679
	speed: 0.3792s/iter; left time: 5877.5151s
	iters: 200, epoch: 26 | loss: 0.6060949
	speed: 0.1515s/iter; left time: 2332.5587s
Epoch: 26 cost time: 32.754271268844604
Epoch: 26, Steps: 208 | Train Loss: 0.226 Vali Loss: 9.698 Vali Acc: 0.140 Test Loss: 9.698 Test Acc: 0.140
Validation loss decreased (-0.139497 --> -0.140374).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0949499
	speed: 0.3469s/iter; left time: 5304.6661s
	iters: 200, epoch: 27 | loss: 0.1875619
	speed: 0.0990s/iter; left time: 1503.7059s
Epoch: 27 cost time: 24.083618879318237
Epoch: 27, Steps: 208 | Train Loss: 0.247 Vali Loss: 9.311 Vali Acc: 0.131 Test Loss: 9.311 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0612651
	speed: 0.3297s/iter; left time: 4973.6565s
	iters: 200, epoch: 28 | loss: 0.1054785
	speed: 0.1254s/iter; left time: 1878.8358s
Epoch: 28 cost time: 26.86382508277893
Epoch: 28, Steps: 208 | Train Loss: 0.239 Vali Loss: 10.028 Vali Acc: 0.131 Test Loss: 10.028 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.2034526
	speed: 0.3479s/iter; left time: 5176.0553s
	iters: 200, epoch: 29 | loss: 0.0769268
	speed: 0.1134s/iter; left time: 1675.5548s
Epoch: 29 cost time: 26.347177505493164
Epoch: 29, Steps: 208 | Train Loss: 0.254 Vali Loss: 10.732 Vali Acc: 0.134 Test Loss: 10.732 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.2300227
	speed: 0.3460s/iter; left time: 5074.8710s
	iters: 200, epoch: 30 | loss: 0.2640416
	speed: 0.1325s/iter; left time: 1930.3511s
Epoch: 30 cost time: 28.392757177352905
Epoch: 30, Steps: 208 | Train Loss: 0.217 Vali Loss: 10.612 Vali Acc: 0.124 Test Loss: 10.612 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.4884841
	speed: 0.3299s/iter; left time: 4771.1293s
	iters: 200, epoch: 31 | loss: 0.1463451
	speed: 0.1334s/iter; left time: 1915.5054s
Epoch: 31 cost time: 28.66573143005371
Epoch: 31, Steps: 208 | Train Loss: 0.228 Vali Loss: 10.264 Vali Acc: 0.128 Test Loss: 10.264 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0468353
	speed: 0.3113s/iter; left time: 4436.5307s
	iters: 200, epoch: 32 | loss: 0.2387311
	speed: 0.1387s/iter; left time: 1963.3748s
Epoch: 32 cost time: 28.68418526649475
Epoch: 32, Steps: 208 | Train Loss: 0.205 Vali Loss: 11.859 Vali Acc: 0.134 Test Loss: 11.859 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.2282591
	speed: 0.3160s/iter; left time: 4438.2900s
	iters: 200, epoch: 33 | loss: 0.0921677
	speed: 0.1202s/iter; left time: 1675.6643s
Epoch: 33 cost time: 26.523011207580566
Epoch: 33, Steps: 208 | Train Loss: 0.250 Vali Loss: 11.447 Vali Acc: 0.123 Test Loss: 11.447 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.1892093
	speed: 0.3334s/iter; left time: 4613.0540s
	iters: 200, epoch: 34 | loss: 0.1510248
	speed: 0.1445s/iter; left time: 1984.8023s
Epoch: 34 cost time: 30.429125785827637
Epoch: 34, Steps: 208 | Train Loss: 0.193 Vali Loss: 10.429 Vali Acc: 0.118 Test Loss: 10.429 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0045328
	speed: 0.3089s/iter; left time: 4210.0838s
	iters: 200, epoch: 35 | loss: 0.4270138
	speed: 0.1787s/iter; left time: 2418.2246s
Epoch: 35 cost time: 31.92297387123108
Epoch: 35, Steps: 208 | Train Loss: 0.221 Vali Loss: 11.603 Vali Acc: 0.128 Test Loss: 11.603 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.2020735
	speed: 0.4682s/iter; left time: 6283.3491s
	iters: 200, epoch: 36 | loss: 0.1076333
	speed: 0.2052s/iter; left time: 2733.3264s
Epoch: 36 cost time: 44.87173128128052
Epoch: 36, Steps: 208 | Train Loss: 0.180 Vali Loss: 12.218 Vali Acc: 0.134 Test Loss: 12.218 Test Acc: 0.134
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14047121980316135
model parameter : 1619111
model size : 8.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5520639
	speed: 0.2185s/iter; left time: 4523.4654s
	iters: 200, epoch: 1 | loss: 3.6921782
	speed: 0.2028s/iter; left time: 4177.5028s
Epoch: 1 cost time: 43.988966941833496
Epoch: 1, Steps: 208 | Train Loss: 4.065 Vali Loss: 3.419 Vali Acc: 0.078 Test Loss: 3.419 Test Acc: 0.078
Validation loss decreased (inf --> -0.077807).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5134630
	speed: 0.4587s/iter; left time: 9400.4899s
	iters: 200, epoch: 2 | loss: 3.6575298
	speed: 0.2164s/iter; left time: 4414.0302s
Epoch: 2 cost time: 45.370243549346924
Epoch: 2, Steps: 208 | Train Loss: 3.473 Vali Loss: 3.542 Vali Acc: 0.090 Test Loss: 3.542 Test Acc: 0.090
Validation loss decreased (-0.077807 --> -0.090033).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2509136
	speed: 0.4495s/iter; left time: 9117.7659s
	iters: 200, epoch: 3 | loss: 3.2709410
	speed: 0.1952s/iter; left time: 3940.4549s
Epoch: 3 cost time: 40.57131314277649
Epoch: 3, Steps: 208 | Train Loss: 3.594 Vali Loss: 4.423 Vali Acc: 0.098 Test Loss: 4.423 Test Acc: 0.098
Validation loss decreased (-0.090033 --> -0.097480).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7943983
	speed: 0.3965s/iter; left time: 7959.7054s
	iters: 200, epoch: 4 | loss: 3.5881696
	speed: 0.2014s/iter; left time: 4023.1813s
Epoch: 4 cost time: 41.48409390449524
Epoch: 4, Steps: 208 | Train Loss: 3.779 Vali Loss: 4.766 Vali Acc: 0.077 Test Loss: 4.766 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.7797904
	speed: 0.4101s/iter; left time: 8148.0591s
	iters: 200, epoch: 5 | loss: 4.4591975
	speed: 0.1860s/iter; left time: 3677.0003s
Epoch: 5 cost time: 38.74551177024841
Epoch: 5, Steps: 208 | Train Loss: 3.814 Vali Loss: 4.158 Vali Acc: 0.113 Test Loss: 4.158 Test Acc: 0.113
Validation loss decreased (-0.097480 --> -0.113290).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.1683741
	speed: 0.4399s/iter; left time: 8649.6899s
	iters: 200, epoch: 6 | loss: 4.7010684
	speed: 0.1612s/iter; left time: 3153.6929s
Epoch: 6 cost time: 38.1960506439209
Epoch: 6, Steps: 208 | Train Loss: 3.857 Vali Loss: 4.023 Vali Acc: 0.103 Test Loss: 4.023 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.5560999
	speed: 0.3726s/iter; left time: 7247.3985s
	iters: 200, epoch: 7 | loss: 3.4373240
	speed: 0.1778s/iter; left time: 3441.7812s
Epoch: 7 cost time: 36.093833923339844
Epoch: 7, Steps: 208 | Train Loss: 3.692 Vali Loss: 5.506 Vali Acc: 0.109 Test Loss: 5.506 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7947321
	speed: 0.3859s/iter; left time: 7427.1873s
	iters: 200, epoch: 8 | loss: 3.2699587
	speed: 0.1558s/iter; left time: 2983.0200s
Epoch: 8 cost time: 34.408775091171265
Epoch: 8, Steps: 208 | Train Loss: 3.378 Vali Loss: 5.857 Vali Acc: 0.122 Test Loss: 5.857 Test Acc: 0.122
Validation loss decreased (-0.113290 --> -0.121922).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6447549
	speed: 0.3363s/iter; left time: 6402.8053s
	iters: 200, epoch: 9 | loss: 2.2152030
	speed: 0.1560s/iter; left time: 2954.7025s
Epoch: 9 cost time: 32.78543424606323
Epoch: 9, Steps: 208 | Train Loss: 2.917 Vali Loss: 5.470 Vali Acc: 0.141 Test Loss: 5.470 Test Acc: 0.141
Validation loss decreased (-0.121922 --> -0.141311).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.4284308
	speed: 0.3520s/iter; left time: 6628.1708s
	iters: 200, epoch: 10 | loss: 2.9710455
	speed: 0.1330s/iter; left time: 2491.4301s
Epoch: 10 cost time: 28.612691640853882
Epoch: 10, Steps: 208 | Train Loss: 2.547 Vali Loss: 5.391 Vali Acc: 0.138 Test Loss: 5.391 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1052182
	speed: 0.3671s/iter; left time: 6835.4186s
	iters: 200, epoch: 11 | loss: 2.5706570
	speed: 0.1516s/iter; left time: 2808.3554s
Epoch: 11 cost time: 32.64276623725891
Epoch: 11, Steps: 208 | Train Loss: 2.087 Vali Loss: 6.071 Vali Acc: 0.128 Test Loss: 6.071 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8446183
	speed: 0.3334s/iter; left time: 6139.3895s
	iters: 200, epoch: 12 | loss: 2.3158154
	speed: 0.1271s/iter; left time: 2327.7278s
Epoch: 12 cost time: 26.99998664855957
Epoch: 12, Steps: 208 | Train Loss: 1.691 Vali Loss: 6.073 Vali Acc: 0.133 Test Loss: 6.073 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1452686
	speed: 0.3664s/iter; left time: 6669.9589s
	iters: 200, epoch: 13 | loss: 1.8140049
	speed: 0.1391s/iter; left time: 2518.4741s
Epoch: 13 cost time: 30.11898970603943
Epoch: 13, Steps: 208 | Train Loss: 1.343 Vali Loss: 5.509 Vali Acc: 0.141 Test Loss: 5.509 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.5266432
	speed: 0.3064s/iter; left time: 5514.6804s
	iters: 200, epoch: 14 | loss: 0.8403148
	speed: 0.1207s/iter; left time: 2159.4437s
Epoch: 14 cost time: 27.85550570487976
Epoch: 14, Steps: 208 | Train Loss: 1.065 Vali Loss: 6.666 Vali Acc: 0.138 Test Loss: 6.666 Test Acc: 0.138
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.5829464
	speed: 0.3572s/iter; left time: 6354.7965s
	iters: 200, epoch: 15 | loss: 0.8473130
	speed: 0.1216s/iter; left time: 2151.5946s
Epoch: 15 cost time: 27.557347774505615
Epoch: 15, Steps: 208 | Train Loss: 0.860 Vali Loss: 7.367 Vali Acc: 0.138 Test Loss: 7.367 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.1937292
	speed: 0.2891s/iter; left time: 5082.9557s
	iters: 200, epoch: 16 | loss: 0.7418838
	speed: 0.1324s/iter; left time: 2315.2668s
Epoch: 16 cost time: 25.09724998474121
Epoch: 16, Steps: 208 | Train Loss: 0.706 Vali Loss: 7.209 Vali Acc: 0.132 Test Loss: 7.209 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8725330
	speed: 0.3073s/iter; left time: 5339.3911s
	iters: 200, epoch: 17 | loss: 0.0938327
	speed: 0.1291s/iter; left time: 2229.4980s
Epoch: 17 cost time: 26.254649877548218
Epoch: 17, Steps: 208 | Train Loss: 0.612 Vali Loss: 7.056 Vali Acc: 0.132 Test Loss: 7.056 Test Acc: 0.132
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.6353605
	speed: 0.3409s/iter; left time: 5852.0579s
	iters: 200, epoch: 18 | loss: 0.4160730
	speed: 0.1623s/iter; left time: 2770.0937s
Epoch: 18 cost time: 33.596291303634644
Epoch: 18, Steps: 208 | Train Loss: 0.542 Vali Loss: 7.700 Vali Acc: 0.127 Test Loss: 7.700 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.2879647
	speed: 0.3821s/iter; left time: 6479.5537s
	iters: 200, epoch: 19 | loss: 0.7043812
	speed: 0.1673s/iter; left time: 2819.6585s
Epoch: 19 cost time: 34.285255432128906
Epoch: 19, Steps: 208 | Train Loss: 0.460 Vali Loss: 7.589 Vali Acc: 0.136 Test Loss: 7.589 Test Acc: 0.136
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1413659409484044
model parameter : 1345191
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5471568
	speed: 0.1728s/iter; left time: 3576.9698s
	iters: 200, epoch: 1 | loss: 3.7064939
	speed: 0.1496s/iter; left time: 3081.7951s
Epoch: 1 cost time: 33.65480089187622
Epoch: 1, Steps: 208 | Train Loss: 4.028 Vali Loss: 3.565 Vali Acc: 0.056 Test Loss: 3.565 Test Acc: 0.056
Validation loss decreased (inf --> -0.056332).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0946221
	speed: 0.3130s/iter; left time: 6414.2345s
	iters: 200, epoch: 2 | loss: 3.9943938
	speed: 0.0810s/iter; left time: 1650.8818s
Epoch: 2 cost time: 20.84958505630493
Epoch: 2, Steps: 208 | Train Loss: 3.509 Vali Loss: 3.629 Vali Acc: 0.081 Test Loss: 3.629 Test Acc: 0.081
Validation loss decreased (-0.056332 --> -0.080489).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7214260
	speed: 0.3188s/iter; left time: 6467.1701s
	iters: 200, epoch: 3 | loss: 3.0371864
	speed: 0.1263s/iter; left time: 2550.2066s
Epoch: 3 cost time: 28.026988983154297
Epoch: 3, Steps: 208 | Train Loss: 3.439 Vali Loss: 4.086 Vali Acc: 0.089 Test Loss: 4.086 Test Acc: 0.089
Validation loss decreased (-0.080489 --> -0.088537).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.2076349
	speed: 0.3391s/iter; left time: 6807.4913s
	iters: 200, epoch: 4 | loss: 4.2211208
	speed: 0.1497s/iter; left time: 2990.6500s
Epoch: 4 cost time: 30.979989528656006
Epoch: 4, Steps: 208 | Train Loss: 3.494 Vali Loss: 3.954 Vali Acc: 0.107 Test Loss: 3.954 Test Acc: 0.107
Validation loss decreased (-0.088537 --> -0.107327).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8705907
	speed: 0.3440s/iter; left time: 6834.5356s
	iters: 200, epoch: 5 | loss: 3.3366411
	speed: 0.1349s/iter; left time: 2666.9385s
Epoch: 5 cost time: 30.487159490585327
Epoch: 5, Steps: 208 | Train Loss: 3.471 Vali Loss: 3.970 Vali Acc: 0.103 Test Loss: 3.970 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6694236
	speed: 0.3079s/iter; left time: 6053.0774s
	iters: 200, epoch: 6 | loss: 2.9478655
	speed: 0.1364s/iter; left time: 2668.2833s
Epoch: 6 cost time: 29.3060142993927
Epoch: 6, Steps: 208 | Train Loss: 3.360 Vali Loss: 3.886 Vali Acc: 0.109 Test Loss: 3.886 Test Acc: 0.109
Validation loss decreased (-0.107327 --> -0.109117).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9496655
	speed: 0.3713s/iter; left time: 7222.0467s
	iters: 200, epoch: 7 | loss: 3.3295667
	speed: 0.1621s/iter; left time: 3137.7698s
Epoch: 7 cost time: 35.230369567871094
Epoch: 7, Steps: 208 | Train Loss: 3.271 Vali Loss: 5.046 Vali Acc: 0.102 Test Loss: 5.046 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.6972444
	speed: 0.3302s/iter; left time: 6354.4529s
	iters: 200, epoch: 8 | loss: 3.1398880
	speed: 0.1726s/iter; left time: 3304.8557s
Epoch: 8 cost time: 32.197906255722046
Epoch: 8, Steps: 208 | Train Loss: 2.956 Vali Loss: 4.582 Vali Acc: 0.117 Test Loss: 4.582 Test Acc: 0.117
Validation loss decreased (-0.109117 --> -0.116566).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2907848
	speed: 0.3628s/iter; left time: 6906.8315s
	iters: 200, epoch: 9 | loss: 3.3541832
	speed: 0.1397s/iter; left time: 2644.5528s
Epoch: 9 cost time: 31.12192726135254
Epoch: 9, Steps: 208 | Train Loss: 2.668 Vali Loss: 4.981 Vali Acc: 0.103 Test Loss: 4.981 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.0936959
	speed: 0.3427s/iter; left time: 6452.5216s
	iters: 200, epoch: 10 | loss: 2.0013876
	speed: 0.1422s/iter; left time: 2663.9563s
Epoch: 10 cost time: 30.633041381835938
Epoch: 10, Steps: 208 | Train Loss: 2.358 Vali Loss: 5.070 Vali Acc: 0.115 Test Loss: 5.070 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.7779083
	speed: 0.3023s/iter; left time: 5628.5469s
	iters: 200, epoch: 11 | loss: 2.3817713
	speed: 0.1401s/iter; left time: 2594.5098s
Epoch: 11 cost time: 28.188316583633423
Epoch: 11, Steps: 208 | Train Loss: 2.013 Vali Loss: 5.762 Vali Acc: 0.121 Test Loss: 5.762 Test Acc: 0.121
Validation loss decreased (-0.116566 --> -0.121326).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7366031
	speed: 0.3358s/iter; left time: 6183.8581s
	iters: 200, epoch: 12 | loss: 1.8432477
	speed: 0.1156s/iter; left time: 2116.6241s
Epoch: 12 cost time: 27.326814889907837
Epoch: 12, Steps: 208 | Train Loss: 1.671 Vali Loss: 5.561 Vali Acc: 0.119 Test Loss: 5.561 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9854962
	speed: 0.3108s/iter; left time: 5657.8027s
	iters: 200, epoch: 13 | loss: 1.8776783
	speed: 0.1314s/iter; left time: 2379.5668s
Epoch: 13 cost time: 28.43751549720764
Epoch: 13, Steps: 208 | Train Loss: 1.416 Vali Loss: 6.557 Vali Acc: 0.111 Test Loss: 6.557 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.9589013
	speed: 0.3061s/iter; left time: 5508.8823s
	iters: 200, epoch: 14 | loss: 1.7976691
	speed: 0.1462s/iter; left time: 2616.3991s
Epoch: 14 cost time: 28.04628825187683
Epoch: 14, Steps: 208 | Train Loss: 1.149 Vali Loss: 7.045 Vali Acc: 0.116 Test Loss: 7.045 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7795523
	speed: 0.3558s/iter; left time: 6330.0500s
	iters: 200, epoch: 15 | loss: 1.1531942
	speed: 0.1388s/iter; left time: 2455.5719s
Epoch: 15 cost time: 31.34062433242798
Epoch: 15, Steps: 208 | Train Loss: 0.997 Vali Loss: 7.336 Vali Acc: 0.128 Test Loss: 7.336 Test Acc: 0.128
Validation loss decreased (-0.121326 --> -0.127574).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7139890
	speed: 0.3514s/iter; left time: 6178.6032s
	iters: 200, epoch: 16 | loss: 1.0851095
	speed: 0.1802s/iter; left time: 3150.9411s
Epoch: 16 cost time: 38.09649181365967
Epoch: 16, Steps: 208 | Train Loss: 0.809 Vali Loss: 7.018 Vali Acc: 0.118 Test Loss: 7.018 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6855255
	speed: 0.3946s/iter; left time: 6856.1535s
	iters: 200, epoch: 17 | loss: 0.8612200
	speed: 0.1743s/iter; left time: 3010.7165s
Epoch: 17 cost time: 35.89724254608154
Epoch: 17, Steps: 208 | Train Loss: 0.680 Vali Loss: 7.916 Vali Acc: 0.122 Test Loss: 7.916 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8612347
	speed: 0.3654s/iter; left time: 6272.4157s
	iters: 200, epoch: 18 | loss: 0.7921424
	speed: 0.1705s/iter; left time: 2908.7552s
Epoch: 18 cost time: 33.801610708236694
Epoch: 18, Steps: 208 | Train Loss: 0.588 Vali Loss: 8.094 Vali Acc: 0.121 Test Loss: 8.094 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4402736
	speed: 0.3941s/iter; left time: 6682.2851s
	iters: 200, epoch: 19 | loss: 1.0871333
	speed: 0.1625s/iter; left time: 2739.9326s
Epoch: 19 cost time: 35.29916286468506
Epoch: 19, Steps: 208 | Train Loss: 0.531 Vali Loss: 8.509 Vali Acc: 0.117 Test Loss: 8.509 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1883431
	speed: 0.3219s/iter; left time: 5390.9471s
	iters: 200, epoch: 20 | loss: 0.5678350
	speed: 0.1371s/iter; left time: 2282.3898s
Epoch: 20 cost time: 26.64454483985901
Epoch: 20, Steps: 208 | Train Loss: 0.501 Vali Loss: 8.165 Vali Acc: 0.106 Test Loss: 8.165 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4340010
	speed: 0.3629s/iter; left time: 6002.5588s
	iters: 200, epoch: 21 | loss: 0.9564586
	speed: 0.1364s/iter; left time: 2242.8521s
Epoch: 21 cost time: 30.614935874938965
Epoch: 21, Steps: 208 | Train Loss: 0.462 Vali Loss: 8.389 Vali Acc: 0.116 Test Loss: 8.389 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.5408103
	speed: 0.3227s/iter; left time: 5271.1466s
	iters: 200, epoch: 22 | loss: 0.7876844
	speed: 0.0802s/iter; left time: 1301.6732s
Epoch: 22 cost time: 21.734428644180298
Epoch: 22, Steps: 208 | Train Loss: 0.403 Vali Loss: 8.772 Vali Acc: 0.126 Test Loss: 8.772 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3444751
	speed: 0.2981s/iter; left time: 4806.6815s
	iters: 200, epoch: 23 | loss: 0.1864414
	speed: 0.1234s/iter; left time: 1977.6181s
Epoch: 23 cost time: 26.973061084747314
Epoch: 23, Steps: 208 | Train Loss: 0.347 Vali Loss: 9.942 Vali Acc: 0.119 Test Loss: 9.942 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1708177
	speed: 0.3104s/iter; left time: 4941.3861s
	iters: 200, epoch: 24 | loss: 0.3555318
	speed: 0.1118s/iter; left time: 1768.3781s
Epoch: 24 cost time: 24.162476301193237
Epoch: 24, Steps: 208 | Train Loss: 0.384 Vali Loss: 9.977 Vali Acc: 0.117 Test Loss: 9.977 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0875888
	speed: 0.2865s/iter; left time: 4500.6829s
	iters: 200, epoch: 25 | loss: 0.2327703
	speed: 0.1136s/iter; left time: 1772.6031s
Epoch: 25 cost time: 24.371609687805176
Epoch: 25, Steps: 208 | Train Loss: 0.367 Vali Loss: 9.634 Vali Acc: 0.126 Test Loss: 9.634 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12764688338801072
model parameter : 962215
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3569393
	speed: 0.1119s/iter; left time: 2317.0249s
	iters: 200, epoch: 1 | loss: 3.8752341
	speed: 0.0953s/iter; left time: 1963.2091s
Epoch: 1 cost time: 21.937283754348755
Epoch: 1, Steps: 208 | Train Loss: 4.015 Vali Loss: 3.666 Vali Acc: 0.052 Test Loss: 3.666 Test Acc: 0.052
Validation loss decreased (inf --> -0.051559).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2969429
	speed: 0.2744s/iter; left time: 5622.4490s
	iters: 200, epoch: 2 | loss: 3.3293648
	speed: 0.1032s/iter; left time: 2104.6173s
Epoch: 2 cost time: 21.077283143997192
Epoch: 2, Steps: 208 | Train Loss: 3.484 Vali Loss: 3.573 Vali Acc: 0.086 Test Loss: 3.573 Test Acc: 0.086
Validation loss decreased (-0.051559 --> -0.086454).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3615479
	speed: 0.2354s/iter; left time: 4776.0567s
	iters: 200, epoch: 3 | loss: 3.3892820
	speed: 0.0810s/iter; left time: 1634.3964s
Epoch: 3 cost time: 16.75089740753174
Epoch: 3, Steps: 208 | Train Loss: 3.355 Vali Loss: 3.673 Vali Acc: 0.085 Test Loss: 3.673 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.8318515
	speed: 0.2657s/iter; left time: 5334.3850s
	iters: 200, epoch: 4 | loss: 4.2741957
	speed: 0.0922s/iter; left time: 1841.4634s
Epoch: 4 cost time: 20.425030946731567
Epoch: 4, Steps: 208 | Train Loss: 3.361 Vali Loss: 4.095 Vali Acc: 0.098 Test Loss: 4.095 Test Acc: 0.098
Validation loss decreased (-0.086454 --> -0.098080).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1863971
	speed: 0.2346s/iter; left time: 4661.3677s
	iters: 200, epoch: 5 | loss: 3.3018677
	speed: 0.0830s/iter; left time: 1641.6096s
Epoch: 5 cost time: 17.007007598876953
Epoch: 5, Steps: 208 | Train Loss: 3.229 Vali Loss: 3.980 Vali Acc: 0.097 Test Loss: 3.980 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8186269
	speed: 0.2509s/iter; left time: 4933.7151s
	iters: 200, epoch: 6 | loss: 3.1104493
	speed: 0.0952s/iter; left time: 1862.3659s
Epoch: 6 cost time: 19.77313232421875
Epoch: 6, Steps: 208 | Train Loss: 3.212 Vali Loss: 4.684 Vali Acc: 0.098 Test Loss: 4.684 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.1916914
	speed: 0.2416s/iter; left time: 4700.0725s
	iters: 200, epoch: 7 | loss: 3.8814805
	speed: 0.0858s/iter; left time: 1660.2432s
Epoch: 7 cost time: 17.61299228668213
Epoch: 7, Steps: 208 | Train Loss: 3.092 Vali Loss: 4.719 Vali Acc: 0.103 Test Loss: 4.719 Test Acc: 0.103
Validation loss decreased (-0.098080 --> -0.102846).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2663708
	speed: 0.3307s/iter; left time: 6363.3892s
	iters: 200, epoch: 8 | loss: 2.1771214
	speed: 0.1475s/iter; left time: 2824.5368s
Epoch: 8 cost time: 31.024720430374146
Epoch: 8, Steps: 208 | Train Loss: 2.797 Vali Loss: 5.774 Vali Acc: 0.109 Test Loss: 5.774 Test Acc: 0.109
Validation loss decreased (-0.102846 --> -0.108502).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7586029
	speed: 0.3126s/iter; left time: 5950.0975s
	iters: 200, epoch: 9 | loss: 3.2939329
	speed: 0.1476s/iter; left time: 2794.9291s
Epoch: 9 cost time: 30.37876582145691
Epoch: 9, Steps: 208 | Train Loss: 2.626 Vali Loss: 4.835 Vali Acc: 0.107 Test Loss: 4.835 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7247295
	speed: 0.3475s/iter; left time: 6542.4078s
	iters: 200, epoch: 10 | loss: 2.7321835
	speed: 0.1616s/iter; left time: 3027.0726s
Epoch: 10 cost time: 33.69968605041504
Epoch: 10, Steps: 208 | Train Loss: 2.297 Vali Loss: 5.478 Vali Acc: 0.112 Test Loss: 5.478 Test Acc: 0.112
Validation loss decreased (-0.108502 --> -0.111487).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1934628
	speed: 0.3376s/iter; left time: 6285.9101s
	iters: 200, epoch: 11 | loss: 2.4696071
	speed: 0.1540s/iter; left time: 2852.1090s
Epoch: 11 cost time: 31.98435926437378
Epoch: 11, Steps: 208 | Train Loss: 1.994 Vali Loss: 5.658 Vali Acc: 0.112 Test Loss: 5.658 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0484126
	speed: 0.2989s/iter; left time: 5504.4504s
	iters: 200, epoch: 12 | loss: 0.8905487
	speed: 0.1272s/iter; left time: 2329.4890s
Epoch: 12 cost time: 25.86124587059021
Epoch: 12, Steps: 208 | Train Loss: 1.709 Vali Loss: 6.449 Vali Acc: 0.105 Test Loss: 6.449 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2724609
	speed: 0.3272s/iter; left time: 5957.0434s
	iters: 200, epoch: 13 | loss: 1.4841658
	speed: 0.1396s/iter; left time: 2526.6393s
Epoch: 13 cost time: 29.450042247772217
Epoch: 13, Steps: 208 | Train Loss: 1.429 Vali Loss: 6.954 Vali Acc: 0.111 Test Loss: 6.954 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6101366
	speed: 0.3171s/iter; left time: 5707.5195s
	iters: 200, epoch: 14 | loss: 0.6406498
	speed: 0.1263s/iter; left time: 2261.1290s
Epoch: 14 cost time: 27.439194202423096
Epoch: 14, Steps: 208 | Train Loss: 1.179 Vali Loss: 7.247 Vali Acc: 0.119 Test Loss: 7.247 Test Acc: 0.119
Validation loss decreased (-0.111487 --> -0.118925).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4771112
	speed: 0.3164s/iter; left time: 5629.1141s
	iters: 200, epoch: 15 | loss: 0.9058932
	speed: 0.1306s/iter; left time: 2310.6091s
Epoch: 15 cost time: 29.185604572296143
Epoch: 15, Steps: 208 | Train Loss: 0.966 Vali Loss: 7.286 Vali Acc: 0.115 Test Loss: 7.286 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2707244
	speed: 0.3425s/iter; left time: 6021.3015s
	iters: 200, epoch: 16 | loss: 1.3337135
	speed: 0.1414s/iter; left time: 2471.8328s
Epoch: 16 cost time: 30.587252616882324
Epoch: 16, Steps: 208 | Train Loss: 0.851 Vali Loss: 7.821 Vali Acc: 0.109 Test Loss: 7.821 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6636956
	speed: 0.3202s/iter; left time: 5562.9989s
	iters: 200, epoch: 17 | loss: 1.1275479
	speed: 0.1397s/iter; left time: 2413.1836s
Epoch: 17 cost time: 28.50270390510559
Epoch: 17, Steps: 208 | Train Loss: 0.732 Vali Loss: 8.328 Vali Acc: 0.110 Test Loss: 8.328 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3475573
	speed: 0.3349s/iter; left time: 5749.2872s
	iters: 200, epoch: 18 | loss: 0.7938915
	speed: 0.1186s/iter; left time: 2024.5059s
Epoch: 18 cost time: 27.86684823036194
Epoch: 18, Steps: 208 | Train Loss: 0.618 Vali Loss: 8.763 Vali Acc: 0.102 Test Loss: 8.763 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5544071
	speed: 0.3066s/iter; left time: 5199.6271s
	iters: 200, epoch: 19 | loss: 1.7124007
	speed: 0.1408s/iter; left time: 2374.2870s
Epoch: 19 cost time: 29.615880727767944
Epoch: 19, Steps: 208 | Train Loss: 0.585 Vali Loss: 8.450 Vali Acc: 0.117 Test Loss: 8.450 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5709687
	speed: 0.3290s/iter; left time: 5510.0433s
	iters: 200, epoch: 20 | loss: 1.0354916
	speed: 0.1394s/iter; left time: 2321.5382s
Epoch: 20 cost time: 29.11904239654541
Epoch: 20, Steps: 208 | Train Loss: 0.505 Vali Loss: 8.285 Vali Acc: 0.115 Test Loss: 8.285 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.5456324
	speed: 0.3012s/iter; left time: 4981.8992s
	iters: 200, epoch: 21 | loss: 0.7303122
	speed: 0.1237s/iter; left time: 2033.5065s
Epoch: 21 cost time: 26.673542976379395
Epoch: 21, Steps: 208 | Train Loss: 0.498 Vali Loss: 9.152 Vali Acc: 0.114 Test Loss: 9.152 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6504609
	speed: 0.2996s/iter; left time: 4892.6469s
	iters: 200, epoch: 22 | loss: 0.7924473
	speed: 0.1126s/iter; left time: 1828.1470s
Epoch: 22 cost time: 24.232324600219727
Epoch: 22, Steps: 208 | Train Loss: 0.440 Vali Loss: 9.577 Vali Acc: 0.103 Test Loss: 9.577 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.9278921
	speed: 0.2946s/iter; left time: 4749.8111s
	iters: 200, epoch: 23 | loss: 0.6538567
	speed: 0.1123s/iter; left time: 1799.2817s
Epoch: 23 cost time: 24.266725778579712
Epoch: 23, Steps: 208 | Train Loss: 0.431 Vali Loss: 10.000 Vali Acc: 0.110 Test Loss: 10.000 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2243177
	speed: 0.3031s/iter; left time: 4823.7997s
	iters: 200, epoch: 24 | loss: 0.3799368
	speed: 0.1060s/iter; left time: 1677.0884s
Epoch: 24 cost time: 24.182264804840088
Epoch: 24, Steps: 208 | Train Loss: 0.381 Vali Loss: 10.011 Vali Acc: 0.094 Test Loss: 10.011 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11899791231732777
model parameter : 798887
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8011746
	speed: 0.1395s/iter; left time: 2886.9881s
	iters: 200, epoch: 1 | loss: 4.5856090
	speed: 0.0685s/iter; left time: 1410.4971s
Epoch: 1 cost time: 21.60574460029602
Epoch: 1, Steps: 208 | Train Loss: 3.949 Vali Loss: 3.910 Vali Acc: 0.054 Test Loss: 3.910 Test Acc: 0.054
Validation loss decreased (inf --> -0.053942).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8082535
	speed: 0.2784s/iter; left time: 5706.1981s
	iters: 200, epoch: 2 | loss: 3.7405729
	speed: 0.1103s/iter; left time: 2250.1626s
Epoch: 2 cost time: 23.77752947807312
Epoch: 2, Steps: 208 | Train Loss: 3.550 Vali Loss: 3.903 Vali Acc: 0.070 Test Loss: 3.903 Test Acc: 0.070
Validation loss decreased (-0.053942 --> -0.069749).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6974418
	speed: 0.2920s/iter; left time: 5923.8726s
	iters: 200, epoch: 3 | loss: 3.4142358
	speed: 0.1103s/iter; left time: 2226.9307s
Epoch: 3 cost time: 23.697412729263306
Epoch: 3, Steps: 208 | Train Loss: 3.345 Vali Loss: 3.535 Vali Acc: 0.088 Test Loss: 3.535 Test Acc: 0.088
Validation loss decreased (-0.069749 --> -0.087946).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0157456
	speed: 0.3344s/iter; left time: 6712.9010s
	iters: 200, epoch: 4 | loss: 3.0720165
	speed: 0.1239s/iter; left time: 2474.2698s
Epoch: 4 cost time: 30.08106279373169
Epoch: 4, Steps: 208 | Train Loss: 3.336 Vali Loss: 3.601 Vali Acc: 0.092 Test Loss: 3.601 Test Acc: 0.092
Validation loss decreased (-0.087946 --> -0.091822).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9404304
	speed: 0.3150s/iter; left time: 6258.1067s
	iters: 200, epoch: 5 | loss: 4.3432531
	speed: 0.1580s/iter; left time: 3123.3528s
Epoch: 5 cost time: 30.131122827529907
Epoch: 5, Steps: 208 | Train Loss: 3.203 Vali Loss: 3.605 Vali Acc: 0.106 Test Loss: 3.605 Test Acc: 0.106
Validation loss decreased (-0.091822 --> -0.105839).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0831447
	speed: 0.2992s/iter; left time: 5882.4782s
	iters: 200, epoch: 6 | loss: 3.6860962
	speed: 0.0867s/iter; left time: 1695.0377s
Epoch: 6 cost time: 21.073599576950073
Epoch: 6, Steps: 208 | Train Loss: 3.073 Vali Loss: 4.178 Vali Acc: 0.101 Test Loss: 4.178 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.8152952
	speed: 0.3262s/iter; left time: 6346.3385s
	iters: 200, epoch: 7 | loss: 2.6708829
	speed: 0.1348s/iter; left time: 2608.1664s
Epoch: 7 cost time: 28.846729040145874
Epoch: 7, Steps: 208 | Train Loss: 2.899 Vali Loss: 4.352 Vali Acc: 0.092 Test Loss: 4.352 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.7336495
	speed: 0.3014s/iter; left time: 5800.2048s
	iters: 200, epoch: 8 | loss: 3.0278459
	speed: 0.1445s/iter; left time: 2765.6582s
Epoch: 8 cost time: 28.868014097213745
Epoch: 8, Steps: 208 | Train Loss: 2.757 Vali Loss: 5.148 Vali Acc: 0.104 Test Loss: 5.148 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.9686118
	speed: 0.3149s/iter; left time: 5994.8755s
	iters: 200, epoch: 9 | loss: 1.7556245
	speed: 0.1186s/iter; left time: 2245.8805s
Epoch: 9 cost time: 25.180088996887207
Epoch: 9, Steps: 208 | Train Loss: 2.387 Vali Loss: 5.210 Vali Acc: 0.096 Test Loss: 5.210 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.3952138
	speed: 0.3269s/iter; left time: 6156.0778s
	iters: 200, epoch: 10 | loss: 2.6883149
	speed: 0.1086s/iter; left time: 2033.0487s
Epoch: 10 cost time: 26.10356116294861
Epoch: 10, Steps: 208 | Train Loss: 2.119 Vali Loss: 6.481 Vali Acc: 0.112 Test Loss: 6.481 Test Acc: 0.112
Validation loss decreased (-0.105839 --> -0.111477).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4578688
	speed: 0.3152s/iter; left time: 5868.4222s
	iters: 200, epoch: 11 | loss: 1.7134420
	speed: 0.1399s/iter; left time: 2591.4576s
Epoch: 11 cost time: 28.47484016418457
Epoch: 11, Steps: 208 | Train Loss: 1.774 Vali Loss: 5.834 Vali Acc: 0.113 Test Loss: 5.834 Test Acc: 0.113
Validation loss decreased (-0.111477 --> -0.112975).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1990106
	speed: 0.3046s/iter; left time: 5607.8680s
	iters: 200, epoch: 12 | loss: 1.8732744
	speed: 0.1102s/iter; left time: 2017.7895s
Epoch: 12 cost time: 25.087307453155518
Epoch: 12, Steps: 208 | Train Loss: 1.516 Vali Loss: 6.351 Vali Acc: 0.111 Test Loss: 6.351 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4973912
	speed: 0.2779s/iter; left time: 5060.0128s
	iters: 200, epoch: 13 | loss: 1.4851764
	speed: 0.1242s/iter; left time: 2247.9273s
Epoch: 13 cost time: 23.48162317276001
Epoch: 13, Steps: 208 | Train Loss: 1.274 Vali Loss: 7.917 Vali Acc: 0.108 Test Loss: 7.917 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7914055
	speed: 0.3038s/iter; left time: 5467.2652s
	iters: 200, epoch: 14 | loss: 1.2959660
	speed: 0.0820s/iter; left time: 1467.0022s
Epoch: 14 cost time: 21.239217281341553
Epoch: 14, Steps: 208 | Train Loss: 1.108 Vali Loss: 7.524 Vali Acc: 0.103 Test Loss: 7.524 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2677091
	speed: 0.3587s/iter; left time: 6381.3340s
	iters: 200, epoch: 15 | loss: 1.4099303
	speed: 0.1651s/iter; left time: 2920.1085s
Epoch: 15 cost time: 35.83921408653259
Epoch: 15, Steps: 208 | Train Loss: 0.917 Vali Loss: 8.207 Vali Acc: 0.108 Test Loss: 8.207 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.9162213
	speed: 0.3613s/iter; left time: 6351.3036s
	iters: 200, epoch: 16 | loss: 1.3996087
	speed: 0.1407s/iter; left time: 2458.7431s
Epoch: 16 cost time: 32.2707085609436
Epoch: 16, Steps: 208 | Train Loss: 0.816 Vali Loss: 8.121 Vali Acc: 0.106 Test Loss: 8.121 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2051234
	speed: 0.3363s/iter; left time: 5842.4754s
	iters: 200, epoch: 17 | loss: 1.4658341
	speed: 0.1493s/iter; left time: 2578.9471s
Epoch: 17 cost time: 31.48389768600464
Epoch: 17, Steps: 208 | Train Loss: 0.701 Vali Loss: 8.364 Vali Acc: 0.106 Test Loss: 8.364 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2629466
	speed: 0.3285s/iter; left time: 5639.4248s
	iters: 200, epoch: 18 | loss: 0.3244548
	speed: 0.1410s/iter; left time: 2406.1107s
Epoch: 18 cost time: 29.682602643966675
Epoch: 18, Steps: 208 | Train Loss: 0.618 Vali Loss: 8.732 Vali Acc: 0.105 Test Loss: 8.732 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.4372566
	speed: 0.3319s/iter; left time: 5627.4182s
	iters: 200, epoch: 19 | loss: 0.1252249
	speed: 0.1436s/iter; left time: 2420.1552s
Epoch: 19 cost time: 30.814522743225098
Epoch: 19, Steps: 208 | Train Loss: 0.604 Vali Loss: 8.890 Vali Acc: 0.115 Test Loss: 8.890 Test Acc: 0.115
Validation loss decreased (-0.112975 --> -0.115330).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2657739
	speed: 0.3189s/iter; left time: 5342.0846s
	iters: 200, epoch: 20 | loss: 0.7478796
	speed: 0.1424s/iter; left time: 2370.8960s
Epoch: 20 cost time: 29.50951051712036
Epoch: 20, Steps: 208 | Train Loss: 0.543 Vali Loss: 9.374 Vali Acc: 0.103 Test Loss: 9.374 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3026975
	speed: 0.3013s/iter; left time: 4983.9311s
	iters: 200, epoch: 21 | loss: 0.2250844
	speed: 0.1144s/iter; left time: 1880.0411s
Epoch: 21 cost time: 25.020658254623413
Epoch: 21, Steps: 208 | Train Loss: 0.491 Vali Loss: 10.024 Vali Acc: 0.101 Test Loss: 10.024 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2408653
	speed: 0.3192s/iter; left time: 5213.2292s
	iters: 200, epoch: 22 | loss: 0.9175999
	speed: 0.1297s/iter; left time: 2105.0410s
Epoch: 22 cost time: 28.475459575653076
Epoch: 22, Steps: 208 | Train Loss: 0.454 Vali Loss: 9.601 Vali Acc: 0.106 Test Loss: 9.601 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.9170664
	speed: 0.3007s/iter; left time: 4849.5820s
	iters: 200, epoch: 23 | loss: 0.4073035
	speed: 0.1412s/iter; left time: 2261.9918s
Epoch: 23 cost time: 29.456671953201294
Epoch: 23, Steps: 208 | Train Loss: 0.388 Vali Loss: 10.202 Vali Acc: 0.111 Test Loss: 10.202 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.3964540
	speed: 0.2842s/iter; left time: 4524.3771s
	iters: 200, epoch: 24 | loss: 0.6711966
	speed: 0.1341s/iter; left time: 2121.7874s
Epoch: 24 cost time: 26.380195379257202
Epoch: 24, Steps: 208 | Train Loss: 0.426 Vali Loss: 10.316 Vali Acc: 0.110 Test Loss: 10.316 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.2388924
	speed: 0.3079s/iter; left time: 4836.4042s
	iters: 200, epoch: 25 | loss: 0.0791958
	speed: 0.1216s/iter; left time: 1897.9540s
Epoch: 25 cost time: 27.764692544937134
Epoch: 25, Steps: 208 | Train Loss: 0.404 Vali Loss: 10.196 Vali Acc: 0.106 Test Loss: 10.196 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.7241609
	speed: 0.3378s/iter; left time: 5236.7306s
	iters: 200, epoch: 26 | loss: 1.0032437
	speed: 0.1647s/iter; left time: 2537.2207s
Epoch: 26 cost time: 34.79586696624756
Epoch: 26, Steps: 208 | Train Loss: 0.402 Vali Loss: 10.724 Vali Acc: 0.105 Test Loss: 10.724 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.2101608
	speed: 0.3469s/iter; left time: 5305.2732s
	iters: 200, epoch: 27 | loss: 0.1136344
	speed: 0.1750s/iter; left time: 2659.1287s
Epoch: 27 cost time: 35.9309720993042
Epoch: 27, Steps: 208 | Train Loss: 0.360 Vali Loss: 10.942 Vali Acc: 0.102 Test Loss: 10.942 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.7029934
	speed: 0.3198s/iter; left time: 4823.9001s
	iters: 200, epoch: 28 | loss: 0.0907277
	speed: 0.1388s/iter; left time: 2079.1874s
Epoch: 28 cost time: 30.009043216705322
Epoch: 28, Steps: 208 | Train Loss: 0.380 Vali Loss: 11.031 Vali Acc: 0.102 Test Loss: 11.031 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.3820452
	speed: 0.3224s/iter; left time: 4796.2675s
	iters: 200, epoch: 29 | loss: 0.2106519
	speed: 0.1348s/iter; left time: 1991.8225s
Epoch: 29 cost time: 29.772458791732788
Epoch: 29, Steps: 208 | Train Loss: 0.336 Vali Loss: 11.655 Vali Acc: 0.108 Test Loss: 11.655 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1154190277363555
model parameter : 690471
model size : 5.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1149535
	speed: 0.2177s/iter; left time: 4506.7773s
	iters: 200, epoch: 1 | loss: 3.9365170
	speed: 0.1836s/iter; left time: 3781.6121s
Epoch: 1 cost time: 41.49516272544861
Epoch: 1, Steps: 208 | Train Loss: 4.700 Vali Loss: 3.823 Vali Acc: 0.052 Test Loss: 3.823 Test Acc: 0.052
Validation loss decreased (inf --> -0.052452).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.7604980
	speed: 0.5410s/iter; left time: 11087.1226s
	iters: 200, epoch: 2 | loss: 4.2477212
	speed: 0.1894s/iter; left time: 3862.2574s
Epoch: 2 cost time: 39.53258728981018
Epoch: 2, Steps: 208 | Train Loss: 4.314 Vali Loss: 4.069 Vali Acc: 0.069 Test Loss: 4.069 Test Acc: 0.069
Validation loss decreased (-0.052452 --> -0.069449).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5987463
	speed: 0.5302s/iter; left time: 10754.7641s
	iters: 200, epoch: 3 | loss: 5.0565052
	speed: 0.1717s/iter; left time: 3465.8425s
Epoch: 3 cost time: 37.6132378578186
Epoch: 3, Steps: 208 | Train Loss: 5.108 Vali Loss: 4.987 Vali Acc: 0.082 Test Loss: 4.987 Test Acc: 0.082
Validation loss decreased (-0.069449 --> -0.081668).  Saving model ...
	iters: 100, epoch: 4 | loss: 5.7984829
	speed: 0.5120s/iter; left time: 10280.3540s
	iters: 200, epoch: 4 | loss: 5.5788031
	speed: 0.1837s/iter; left time: 3669.8308s
Epoch: 4 cost time: 38.129098415374756
Epoch: 4, Steps: 208 | Train Loss: 5.775 Vali Loss: 6.124 Vali Acc: 0.078 Test Loss: 6.124 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 6.4502325
	speed: 0.5217s/iter; left time: 10365.3278s
	iters: 200, epoch: 5 | loss: 7.2709565
	speed: 0.1889s/iter; left time: 3734.6431s
Epoch: 5 cost time: 39.52369666099548
Epoch: 5, Steps: 208 | Train Loss: 5.944 Vali Loss: 8.239 Vali Acc: 0.071 Test Loss: 8.239 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 7.8757486
	speed: 0.4790s/iter; left time: 9418.0215s
	iters: 200, epoch: 6 | loss: 7.3571539
	speed: 0.1976s/iter; left time: 3864.7375s
Epoch: 6 cost time: 39.99114966392517
Epoch: 6, Steps: 208 | Train Loss: 5.948 Vali Loss: 9.265 Vali Acc: 0.078 Test Loss: 9.265 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 5.7304206
	speed: 0.5668s/iter; left time: 11025.8847s
	iters: 200, epoch: 7 | loss: 6.8623829
	speed: 0.1530s/iter; left time: 2960.7327s
Epoch: 7 cost time: 36.337475299835205
Epoch: 7, Steps: 208 | Train Loss: 5.496 Vali Loss: 9.356 Vali Acc: 0.103 Test Loss: 9.356 Test Acc: 0.103
Validation loss decreased (-0.081668 --> -0.102799).  Saving model ...
	iters: 100, epoch: 8 | loss: 5.6753449
	speed: 0.5365s/iter; left time: 10324.7711s
	iters: 200, epoch: 8 | loss: 5.3526134
	speed: 0.1922s/iter; left time: 3679.6658s
Epoch: 8 cost time: 39.53635358810425
Epoch: 8, Steps: 208 | Train Loss: 4.789 Vali Loss: 7.283 Vali Acc: 0.100 Test Loss: 7.283 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.3314300
	speed: 0.5271s/iter; left time: 10034.0932s
	iters: 200, epoch: 9 | loss: 3.7565951
	speed: 0.1922s/iter; left time: 3639.6033s
Epoch: 9 cost time: 40.52846598625183
Epoch: 9, Steps: 208 | Train Loss: 3.982 Vali Loss: 6.595 Vali Acc: 0.110 Test Loss: 6.595 Test Acc: 0.110
Validation loss decreased (-0.102799 --> -0.109985).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.7112947
	speed: 0.5514s/iter; left time: 10381.9249s
	iters: 200, epoch: 10 | loss: 2.0395982
	speed: 0.1779s/iter; left time: 3332.0053s
Epoch: 10 cost time: 38.04418206214905
Epoch: 10, Steps: 208 | Train Loss: 2.924 Vali Loss: 8.539 Vali Acc: 0.069 Test Loss: 8.539 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8342382
	speed: 0.5387s/iter; left time: 10031.0948s
	iters: 200, epoch: 11 | loss: 2.0867453
	speed: 0.1788s/iter; left time: 3311.2875s
Epoch: 11 cost time: 37.94830083847046
Epoch: 11, Steps: 208 | Train Loss: 1.883 Vali Loss: 6.561 Vali Acc: 0.116 Test Loss: 6.561 Test Acc: 0.116
Validation loss decreased (-0.109985 --> -0.115652).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7479486
	speed: 0.4930s/iter; left time: 9077.7394s
	iters: 200, epoch: 12 | loss: 1.4837078
	speed: 0.1682s/iter; left time: 3079.3593s
Epoch: 12 cost time: 35.578248500823975
Epoch: 12, Steps: 208 | Train Loss: 1.420 Vali Loss: 7.264 Vali Acc: 0.096 Test Loss: 7.264 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2658014
	speed: 0.4622s/iter; left time: 8413.9339s
	iters: 200, epoch: 13 | loss: 2.0004029
	speed: 0.1692s/iter; left time: 3063.0055s
Epoch: 13 cost time: 33.658732891082764
Epoch: 13, Steps: 208 | Train Loss: 1.127 Vali Loss: 6.528 Vali Acc: 0.129 Test Loss: 6.528 Test Acc: 0.129
Validation loss decreased (-0.115652 --> -0.128775).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9916938
	speed: 0.4998s/iter; left time: 8995.6361s
	iters: 200, epoch: 14 | loss: 1.1689922
	speed: 0.1765s/iter; left time: 3158.4057s
Epoch: 14 cost time: 36.81964325904846
Epoch: 14, Steps: 208 | Train Loss: 0.882 Vali Loss: 7.028 Vali Acc: 0.129 Test Loss: 7.028 Test Acc: 0.129
Validation loss decreased (-0.128775 --> -0.129068).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4990776
	speed: 0.6007s/iter; left time: 10685.3131s
	iters: 200, epoch: 15 | loss: 1.3786576
	speed: 0.2103s/iter; left time: 3719.4830s
Epoch: 15 cost time: 44.57496953010559
Epoch: 15, Steps: 208 | Train Loss: 0.778 Vali Loss: 7.044 Vali Acc: 0.119 Test Loss: 7.044 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4058433
	speed: 0.5623s/iter; left time: 9886.0875s
	iters: 200, epoch: 16 | loss: 0.8875740
	speed: 0.1966s/iter; left time: 3437.2277s
Epoch: 16 cost time: 42.00876808166504
Epoch: 16, Steps: 208 | Train Loss: 0.576 Vali Loss: 7.640 Vali Acc: 0.124 Test Loss: 7.640 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6463546
	speed: 0.5271s/iter; left time: 9156.5481s
	iters: 200, epoch: 17 | loss: 0.1649062
	speed: 0.1849s/iter; left time: 3194.4926s
Epoch: 17 cost time: 38.72981095314026
Epoch: 17, Steps: 208 | Train Loss: 0.519 Vali Loss: 7.998 Vali Acc: 0.129 Test Loss: 7.998 Test Acc: 0.129
Validation loss decreased (-0.129068 --> -0.129356).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5074527
	speed: 0.5246s/iter; left time: 9003.9891s
	iters: 200, epoch: 18 | loss: 0.6200894
	speed: 0.1623s/iter; left time: 2770.0609s
Epoch: 18 cost time: 35.81361269950867
Epoch: 18, Steps: 208 | Train Loss: 0.423 Vali Loss: 8.690 Vali Acc: 0.126 Test Loss: 8.690 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1119668
	speed: 0.4969s/iter; left time: 8426.5135s
	iters: 200, epoch: 19 | loss: 0.9377661
	speed: 0.1658s/iter; left time: 2794.2318s
Epoch: 19 cost time: 34.5752055644989
Epoch: 19, Steps: 208 | Train Loss: 0.395 Vali Loss: 7.931 Vali Acc: 0.133 Test Loss: 7.931 Test Acc: 0.133
Validation loss decreased (-0.129356 --> -0.132638).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2834487
	speed: 0.4890s/iter; left time: 8189.5937s
	iters: 200, epoch: 20 | loss: 0.7941609
	speed: 0.1736s/iter; left time: 2890.3312s
Epoch: 20 cost time: 35.29364728927612
Epoch: 20, Steps: 208 | Train Loss: 0.297 Vali Loss: 9.506 Vali Acc: 0.123 Test Loss: 9.506 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2442809
	speed: 0.4880s/iter; left time: 8072.4082s
	iters: 200, epoch: 21 | loss: 0.2237328
	speed: 0.1737s/iter; left time: 2855.3297s
Epoch: 21 cost time: 36.44118046760559
Epoch: 21, Steps: 208 | Train Loss: 0.284 Vali Loss: 8.327 Vali Acc: 0.129 Test Loss: 8.327 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4453739
	speed: 0.5144s/iter; left time: 8402.5099s
	iters: 200, epoch: 22 | loss: 0.1383059
	speed: 0.2007s/iter; left time: 3257.1875s
Epoch: 22 cost time: 41.601356983184814
Epoch: 22, Steps: 208 | Train Loss: 0.238 Vali Loss: 9.438 Vali Acc: 0.130 Test Loss: 9.438 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1440256
	speed: 0.5625s/iter; left time: 9069.7063s
	iters: 200, epoch: 23 | loss: 0.0630369
	speed: 0.1678s/iter; left time: 2688.9930s
Epoch: 23 cost time: 38.010478019714355
Epoch: 23, Steps: 208 | Train Loss: 0.205 Vali Loss: 11.007 Vali Acc: 0.123 Test Loss: 11.007 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4454073
	speed: 0.5385s/iter; left time: 8570.5475s
	iters: 200, epoch: 24 | loss: 0.5492437
	speed: 0.1751s/iter; left time: 2770.0374s
Epoch: 24 cost time: 37.91971254348755
Epoch: 24, Steps: 208 | Train Loss: 0.215 Vali Loss: 10.892 Vali Acc: 0.137 Test Loss: 10.892 Test Acc: 0.137
Validation loss decreased (-0.132638 --> -0.136783).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.1712719
	speed: 0.4940s/iter; left time: 7760.9226s
	iters: 200, epoch: 25 | loss: 0.1668747
	speed: 0.1723s/iter; left time: 2688.7077s
Epoch: 25 cost time: 36.356019735336304
Epoch: 25, Steps: 208 | Train Loss: 0.186 Vali Loss: 11.280 Vali Acc: 0.126 Test Loss: 11.280 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.1640821
	speed: 0.4768s/iter; left time: 7391.0656s
	iters: 200, epoch: 26 | loss: 0.3313232
	speed: 0.1679s/iter; left time: 2586.2985s
Epoch: 26 cost time: 35.57125759124756
Epoch: 26, Steps: 208 | Train Loss: 0.169 Vali Loss: 10.829 Vali Acc: 0.120 Test Loss: 10.829 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1100862
	speed: 0.4715s/iter; left time: 7210.8537s
	iters: 200, epoch: 27 | loss: 0.1384312
	speed: 0.1580s/iter; left time: 2400.7773s
Epoch: 27 cost time: 34.12341642379761
Epoch: 27, Steps: 208 | Train Loss: 0.166 Vali Loss: 11.250 Vali Acc: 0.115 Test Loss: 11.250 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1336280
	speed: 0.4543s/iter; left time: 6852.3732s
	iters: 200, epoch: 28 | loss: 0.0114756
	speed: 0.1556s/iter; left time: 2331.1767s
Epoch: 28 cost time: 32.26442527770996
Epoch: 28, Steps: 208 | Train Loss: 0.171 Vali Loss: 10.216 Vali Acc: 0.123 Test Loss: 10.216 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0557095
	speed: 0.4569s/iter; left time: 6797.3818s
	iters: 200, epoch: 29 | loss: 0.8113043
	speed: 0.1535s/iter; left time: 2267.7170s
Epoch: 29 cost time: 32.903541564941406
Epoch: 29, Steps: 208 | Train Loss: 0.176 Vali Loss: 12.810 Vali Acc: 0.126 Test Loss: 12.810 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.4155385
	speed: 0.4529s/iter; left time: 6643.8431s
	iters: 200, epoch: 30 | loss: 0.2975063
	speed: 0.1824s/iter; left time: 2657.5437s
Epoch: 30 cost time: 35.92307662963867
Epoch: 30, Steps: 208 | Train Loss: 0.147 Vali Loss: 12.377 Vali Acc: 0.118 Test Loss: 12.377 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.3626043
	speed: 0.5783s/iter; left time: 8362.7551s
	iters: 200, epoch: 31 | loss: 0.0230124
	speed: 0.1982s/iter; left time: 2846.9899s
Epoch: 31 cost time: 42.34554576873779
Epoch: 31, Steps: 208 | Train Loss: 0.163 Vali Loss: 11.462 Vali Acc: 0.126 Test Loss: 11.462 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.6130266
	speed: 0.5634s/iter; left time: 8030.3946s
	iters: 200, epoch: 32 | loss: 0.2546033
	speed: 0.2017s/iter; left time: 2854.4695s
Epoch: 32 cost time: 42.12900710105896
Epoch: 32, Steps: 208 | Train Loss: 0.151 Vali Loss: 14.234 Vali Acc: 0.123 Test Loss: 14.234 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0066216
	speed: 0.5046s/iter; left time: 7087.7761s
	iters: 200, epoch: 33 | loss: 0.6044874
	speed: 0.1960s/iter; left time: 2733.7257s
Epoch: 33 cost time: 40.57305312156677
Epoch: 33, Steps: 208 | Train Loss: 0.130 Vali Loss: 12.473 Vali Acc: 0.135 Test Loss: 12.473 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.1382278
	speed: 0.5340s/iter; left time: 7389.3824s
	iters: 200, epoch: 34 | loss: 0.0021907
	speed: 0.1725s/iter; left time: 2369.6138s
Epoch: 34 cost time: 36.059412240982056
Epoch: 34, Steps: 208 | Train Loss: 0.117 Vali Loss: 13.634 Vali Acc: 0.129 Test Loss: 13.634 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13689233522218908
model parameter : 4204135
model size : 18.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8009238
	speed: 0.1419s/iter; left time: 2936.6424s
	iters: 200, epoch: 1 | loss: 4.0384059
	speed: 0.1187s/iter; left time: 2444.6535s
Epoch: 1 cost time: 27.072540998458862
Epoch: 1, Steps: 208 | Train Loss: 4.270 Vali Loss: 3.846 Vali Acc: 0.057 Test Loss: 3.846 Test Acc: 0.057
Validation loss decreased (inf --> -0.057224).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9378483
	speed: 0.3434s/iter; left time: 7036.9851s
	iters: 200, epoch: 2 | loss: 4.6986017
	speed: 0.1378s/iter; left time: 2809.5765s
Epoch: 2 cost time: 29.153529405593872
Epoch: 2, Steps: 208 | Train Loss: 3.770 Vali Loss: 4.980 Vali Acc: 0.058 Test Loss: 4.980 Test Acc: 0.058
Validation loss decreased (-0.057224 --> -0.058107).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6352837
	speed: 0.2900s/iter; left time: 5883.6096s
	iters: 200, epoch: 3 | loss: 4.3542986
	speed: 0.1264s/iter; left time: 2551.6476s
Epoch: 3 cost time: 23.726081609725952
Epoch: 3, Steps: 208 | Train Loss: 4.071 Vali Loss: 5.399 Vali Acc: 0.088 Test Loss: 5.399 Test Acc: 0.088
Validation loss decreased (-0.058107 --> -0.087629).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7860825
	speed: 0.3526s/iter; left time: 7078.2910s
	iters: 200, epoch: 4 | loss: 4.8271255
	speed: 0.1500s/iter; left time: 2996.0900s
Epoch: 4 cost time: 31.673513650894165
Epoch: 4, Steps: 208 | Train Loss: 4.383 Vali Loss: 5.878 Vali Acc: 0.068 Test Loss: 5.878 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.2445230
	speed: 0.3100s/iter; left time: 6158.9870s
	iters: 200, epoch: 5 | loss: 4.0421119
	speed: 0.1302s/iter; left time: 2574.8953s
Epoch: 5 cost time: 26.31778073310852
Epoch: 5, Steps: 208 | Train Loss: 4.617 Vali Loss: 6.835 Vali Acc: 0.086 Test Loss: 6.835 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.4626565
	speed: 0.3139s/iter; left time: 6170.6159s
	iters: 200, epoch: 6 | loss: 4.1161056
	speed: 0.1341s/iter; left time: 2623.0801s
Epoch: 6 cost time: 27.218844652175903
Epoch: 6, Steps: 208 | Train Loss: 4.586 Vali Loss: 6.963 Vali Acc: 0.090 Test Loss: 6.963 Test Acc: 0.090
Validation loss decreased (-0.087629 --> -0.089999).  Saving model ...
	iters: 100, epoch: 7 | loss: 4.3609366
	speed: 0.3274s/iter; left time: 6368.7404s
	iters: 200, epoch: 7 | loss: 3.8017795
	speed: 0.1233s/iter; left time: 2385.3052s
Epoch: 7 cost time: 26.872764825820923
Epoch: 7, Steps: 208 | Train Loss: 4.231 Vali Loss: 5.480 Vali Acc: 0.114 Test Loss: 5.480 Test Acc: 0.114
Validation loss decreased (-0.089999 --> -0.113873).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4244909
	speed: 0.3920s/iter; left time: 7544.6504s
	iters: 200, epoch: 8 | loss: 3.4077208
	speed: 0.1771s/iter; left time: 3389.7365s
Epoch: 8 cost time: 36.921940088272095
Epoch: 8, Steps: 208 | Train Loss: 3.827 Vali Loss: 6.352 Vali Acc: 0.107 Test Loss: 6.352 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2025769
	speed: 0.3975s/iter; left time: 7567.2309s
	iters: 200, epoch: 9 | loss: 2.5246077
	speed: 0.1631s/iter; left time: 3088.3345s
Epoch: 9 cost time: 35.15657186508179
Epoch: 9, Steps: 208 | Train Loss: 3.297 Vali Loss: 6.425 Vali Acc: 0.112 Test Loss: 6.425 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.4267392
	speed: 0.4073s/iter; left time: 7669.9619s
	iters: 200, epoch: 10 | loss: 2.5257063
	speed: 0.1800s/iter; left time: 3370.6719s
Epoch: 10 cost time: 37.46435856819153
Epoch: 10, Steps: 208 | Train Loss: 2.707 Vali Loss: 7.172 Vali Acc: 0.114 Test Loss: 7.172 Test Acc: 0.114
Validation loss decreased (-0.113873 --> -0.114154).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3623738
	speed: 0.3338s/iter; left time: 6214.9098s
	iters: 200, epoch: 11 | loss: 2.2414093
	speed: 0.1503s/iter; left time: 2783.4933s
Epoch: 11 cost time: 28.63532567024231
Epoch: 11, Steps: 208 | Train Loss: 2.044 Vali Loss: 6.628 Vali Acc: 0.107 Test Loss: 6.628 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0007324
	speed: 0.3703s/iter; left time: 6819.1033s
	iters: 200, epoch: 12 | loss: 2.2674606
	speed: 0.1636s/iter; left time: 2995.1055s
Epoch: 12 cost time: 33.49070358276367
Epoch: 12, Steps: 208 | Train Loss: 1.578 Vali Loss: 6.108 Vali Acc: 0.126 Test Loss: 6.108 Test Acc: 0.126
Validation loss decreased (-0.114154 --> -0.126393).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9709663
	speed: 0.3454s/iter; left time: 6287.3653s
	iters: 200, epoch: 13 | loss: 1.8475356
	speed: 0.1527s/iter; left time: 2765.1168s
Epoch: 13 cost time: 30.75343084335327
Epoch: 13, Steps: 208 | Train Loss: 1.244 Vali Loss: 6.830 Vali Acc: 0.111 Test Loss: 6.830 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9822379
	speed: 0.3876s/iter; left time: 6975.6317s
	iters: 200, epoch: 14 | loss: 1.2770251
	speed: 0.1375s/iter; left time: 2460.0244s
Epoch: 14 cost time: 32.07898306846619
Epoch: 14, Steps: 208 | Train Loss: 1.003 Vali Loss: 5.857 Vali Acc: 0.142 Test Loss: 5.857 Test Acc: 0.142
Validation loss decreased (-0.126393 --> -0.141606).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2056918
	speed: 0.3654s/iter; left time: 6499.3433s
	iters: 200, epoch: 15 | loss: 0.8867395
	speed: 0.1672s/iter; left time: 2957.9499s
Epoch: 15 cost time: 33.879793882369995
Epoch: 15, Steps: 208 | Train Loss: 0.817 Vali Loss: 6.067 Vali Acc: 0.129 Test Loss: 6.067 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6264897
	speed: 0.3865s/iter; left time: 6795.3429s
	iters: 200, epoch: 16 | loss: 1.4978895
	speed: 0.1489s/iter; left time: 2602.8317s
Epoch: 16 cost time: 31.83673334121704
Epoch: 16, Steps: 208 | Train Loss: 0.702 Vali Loss: 7.008 Vali Acc: 0.136 Test Loss: 7.008 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2789997
	speed: 0.3695s/iter; left time: 6419.7038s
	iters: 200, epoch: 17 | loss: 1.4014771
	speed: 0.1590s/iter; left time: 2746.8353s
Epoch: 17 cost time: 32.81492757797241
Epoch: 17, Steps: 208 | Train Loss: 0.550 Vali Loss: 7.898 Vali Acc: 0.131 Test Loss: 7.898 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3501081
	speed: 0.3487s/iter; left time: 5985.4114s
	iters: 200, epoch: 18 | loss: 0.2253925
	speed: 0.1499s/iter; left time: 2557.4398s
Epoch: 18 cost time: 30.070346355438232
Epoch: 18, Steps: 208 | Train Loss: 0.499 Vali Loss: 8.763 Vali Acc: 0.137 Test Loss: 8.763 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7973494
	speed: 0.3363s/iter; left time: 5702.6398s
	iters: 200, epoch: 19 | loss: 0.8357982
	speed: 0.1265s/iter; left time: 2132.4638s
Epoch: 19 cost time: 27.773546934127808
Epoch: 19, Steps: 208 | Train Loss: 0.404 Vali Loss: 8.505 Vali Acc: 0.137 Test Loss: 8.505 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2519969
	speed: 0.3346s/iter; left time: 5603.5858s
	iters: 200, epoch: 20 | loss: 0.5232196
	speed: 0.1412s/iter; left time: 2351.2208s
Epoch: 20 cost time: 29.66847538948059
Epoch: 20, Steps: 208 | Train Loss: 0.371 Vali Loss: 7.914 Vali Acc: 0.139 Test Loss: 7.914 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.5661405
	speed: 0.3401s/iter; left time: 5624.8071s
	iters: 200, epoch: 21 | loss: 0.3881141
	speed: 0.1574s/iter; left time: 2587.4361s
Epoch: 21 cost time: 32.79252314567566
Epoch: 21, Steps: 208 | Train Loss: 0.347 Vali Loss: 8.664 Vali Acc: 0.130 Test Loss: 8.664 Test Acc: 0.130
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1358793
	speed: 0.3986s/iter; left time: 6510.6019s
	iters: 200, epoch: 22 | loss: 0.2244067
	speed: 0.1665s/iter; left time: 2702.6739s
Epoch: 22 cost time: 35.29210543632507
Epoch: 22, Steps: 208 | Train Loss: 0.294 Vali Loss: 9.567 Vali Acc: 0.125 Test Loss: 9.567 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2095317
	speed: 0.3982s/iter; left time: 6421.0225s
	iters: 200, epoch: 23 | loss: 0.2406729
	speed: 0.1708s/iter; left time: 2736.7549s
Epoch: 23 cost time: 36.04527258872986
Epoch: 23, Steps: 208 | Train Loss: 0.276 Vali Loss: 9.957 Vali Acc: 0.135 Test Loss: 9.957 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0205898
	speed: 0.3459s/iter; left time: 5506.3335s
	iters: 200, epoch: 24 | loss: 0.4995167
	speed: 0.1042s/iter; left time: 1648.0515s
Epoch: 24 cost time: 23.648573398590088
Epoch: 24, Steps: 208 | Train Loss: 0.245 Vali Loss: 9.331 Vali Acc: 0.123 Test Loss: 9.331 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1416641813301521
model parameter : 2227943
model size : 10.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.2360473
	speed: 0.1821s/iter; left time: 3768.7621s
	iters: 200, epoch: 1 | loss: 4.1529493
	speed: 0.1448s/iter; left time: 2982.9685s
Epoch: 1 cost time: 33.914937019348145
Epoch: 1, Steps: 208 | Train Loss: 4.171 Vali Loss: 3.504 Vali Acc: 0.080 Test Loss: 3.504 Test Acc: 0.080
Validation loss decreased (inf --> -0.079595).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7475977
	speed: 0.3210s/iter; left time: 6579.1351s
	iters: 200, epoch: 2 | loss: 3.7866693
	speed: 0.1308s/iter; left time: 2666.4767s
Epoch: 2 cost time: 28.671112060546875
Epoch: 2, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.539 Vali Acc: 0.098 Test Loss: 3.539 Test Acc: 0.098
Validation loss decreased (-0.079595 --> -0.098086).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9308050
	speed: 0.2741s/iter; left time: 5560.3967s
	iters: 200, epoch: 3 | loss: 3.8819058
	speed: 0.1277s/iter; left time: 2576.7997s
Epoch: 3 cost time: 25.86341094970703
Epoch: 3, Steps: 208 | Train Loss: 3.772 Vali Loss: 3.812 Vali Acc: 0.095 Test Loss: 3.812 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7715297
	speed: 0.2912s/iter; left time: 5846.9274s
	iters: 200, epoch: 4 | loss: 4.1177659
	speed: 0.1181s/iter; left time: 2358.9810s
Epoch: 4 cost time: 25.264002561569214
Epoch: 4, Steps: 208 | Train Loss: 3.968 Vali Loss: 5.151 Vali Acc: 0.079 Test Loss: 5.151 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.9055243
	speed: 0.2793s/iter; left time: 5549.9003s
	iters: 200, epoch: 5 | loss: 3.9645529
	speed: 0.1213s/iter; left time: 2397.3362s
Epoch: 5 cost time: 25.367945194244385
Epoch: 5, Steps: 208 | Train Loss: 4.016 Vali Loss: 4.990 Vali Acc: 0.116 Test Loss: 4.990 Test Acc: 0.116
Validation loss decreased (-0.098086 --> -0.115667).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1734493
	speed: 0.2866s/iter; left time: 5633.9406s
	iters: 200, epoch: 6 | loss: 4.8038878
	speed: 0.1191s/iter; left time: 2329.9230s
Epoch: 6 cost time: 24.501889944076538
Epoch: 6, Steps: 208 | Train Loss: 3.983 Vali Loss: 6.564 Vali Acc: 0.085 Test Loss: 6.564 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0983496
	speed: 0.2616s/iter; left time: 5088.5815s
	iters: 200, epoch: 7 | loss: 3.6666665
	speed: 0.1140s/iter; left time: 2206.4383s
Epoch: 7 cost time: 22.380568265914917
Epoch: 7, Steps: 208 | Train Loss: 3.829 Vali Loss: 4.747 Vali Acc: 0.116 Test Loss: 4.747 Test Acc: 0.116
Validation loss decreased (-0.115667 --> -0.115670).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9143770
	speed: 0.2846s/iter; left time: 5477.8310s
	iters: 200, epoch: 8 | loss: 4.5247970
	speed: 0.1063s/iter; left time: 2036.0618s
Epoch: 8 cost time: 23.680623054504395
Epoch: 8, Steps: 208 | Train Loss: 3.539 Vali Loss: 4.444 Vali Acc: 0.098 Test Loss: 4.444 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3067772
	speed: 0.2797s/iter; left time: 5324.3749s
	iters: 200, epoch: 9 | loss: 3.3839104
	speed: 0.1184s/iter; left time: 2241.5729s
Epoch: 9 cost time: 25.2548770904541
Epoch: 9, Steps: 208 | Train Loss: 3.171 Vali Loss: 5.032 Vali Acc: 0.097 Test Loss: 5.032 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9783990
	speed: 0.2731s/iter; left time: 5141.7168s
	iters: 200, epoch: 10 | loss: 1.9818701
	speed: 0.1206s/iter; left time: 2258.1965s
Epoch: 10 cost time: 25.022613763809204
Epoch: 10, Steps: 208 | Train Loss: 2.611 Vali Loss: 5.926 Vali Acc: 0.108 Test Loss: 5.926 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7916248
	speed: 0.3024s/iter; left time: 5631.4611s
	iters: 200, epoch: 11 | loss: 3.3130553
	speed: 0.1213s/iter; left time: 2247.3869s
Epoch: 11 cost time: 26.737613677978516
Epoch: 11, Steps: 208 | Train Loss: 2.164 Vali Loss: 5.276 Vali Acc: 0.108 Test Loss: 5.276 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 2.3202786
	speed: 0.3471s/iter; left time: 6391.5062s
	iters: 200, epoch: 12 | loss: 1.6422527
	speed: 0.1611s/iter; left time: 2949.5099s
Epoch: 12 cost time: 34.61923336982727
Epoch: 12, Steps: 208 | Train Loss: 1.631 Vali Loss: 5.336 Vali Acc: 0.127 Test Loss: 5.336 Test Acc: 0.127
Validation loss decreased (-0.115670 --> -0.127295).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5572307
	speed: 0.3554s/iter; left time: 6470.9324s
	iters: 200, epoch: 13 | loss: 0.9806603
	speed: 0.1626s/iter; left time: 2944.4068s
Epoch: 13 cost time: 34.1488242149353
Epoch: 13, Steps: 208 | Train Loss: 1.303 Vali Loss: 6.303 Vali Acc: 0.128 Test Loss: 6.303 Test Acc: 0.128
Validation loss decreased (-0.127295 --> -0.128180).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1716017
	speed: 0.3433s/iter; left time: 6179.0483s
	iters: 200, epoch: 14 | loss: 1.1318585
	speed: 0.1062s/iter; left time: 1900.2537s
Epoch: 14 cost time: 26.46099066734314
Epoch: 14, Steps: 208 | Train Loss: 1.060 Vali Loss: 6.026 Vali Acc: 0.130 Test Loss: 6.026 Test Acc: 0.130
Validation loss decreased (-0.128180 --> -0.129674).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2950641
	speed: 0.3246s/iter; left time: 5774.9024s
	iters: 200, epoch: 15 | loss: 0.8809175
	speed: 0.1447s/iter; left time: 2560.1248s
Epoch: 15 cost time: 30.931579113006592
Epoch: 15, Steps: 208 | Train Loss: 0.867 Vali Loss: 6.816 Vali Acc: 0.143 Test Loss: 6.816 Test Acc: 0.143
Validation loss decreased (-0.129674 --> -0.143385).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4677523
	speed: 0.3303s/iter; left time: 5806.3019s
	iters: 200, epoch: 16 | loss: 0.3459599
	speed: 0.1150s/iter; left time: 2011.0929s
Epoch: 16 cost time: 27.236380577087402
Epoch: 16, Steps: 208 | Train Loss: 0.706 Vali Loss: 7.084 Vali Acc: 0.142 Test Loss: 7.084 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2735794
	speed: 0.3326s/iter; left time: 5777.9538s
	iters: 200, epoch: 17 | loss: 0.8307468
	speed: 0.1501s/iter; left time: 2593.4537s
Epoch: 17 cost time: 31.424593448638916
Epoch: 17, Steps: 208 | Train Loss: 0.593 Vali Loss: 6.948 Vali Acc: 0.134 Test Loss: 6.948 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8833706
	speed: 0.3103s/iter; left time: 5327.0449s
	iters: 200, epoch: 18 | loss: 0.2473557
	speed: 0.1260s/iter; left time: 2149.7103s
Epoch: 18 cost time: 26.929985284805298
Epoch: 18, Steps: 208 | Train Loss: 0.503 Vali Loss: 7.783 Vali Acc: 0.130 Test Loss: 7.783 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1109439
	speed: 0.3277s/iter; left time: 5557.1981s
	iters: 200, epoch: 19 | loss: 0.8472154
	speed: 0.1457s/iter; left time: 2455.2476s
Epoch: 19 cost time: 30.87511110305786
Epoch: 19, Steps: 208 | Train Loss: 0.461 Vali Loss: 8.522 Vali Acc: 0.119 Test Loss: 8.522 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3394127
	speed: 0.3111s/iter; left time: 5211.2941s
	iters: 200, epoch: 20 | loss: 1.2927272
	speed: 0.1157s/iter; left time: 1926.3676s
Epoch: 20 cost time: 26.187745571136475
Epoch: 20, Steps: 208 | Train Loss: 0.415 Vali Loss: 8.103 Vali Acc: 0.133 Test Loss: 8.103 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8420304
	speed: 0.3001s/iter; left time: 4964.2531s
	iters: 200, epoch: 21 | loss: 0.5638948
	speed: 0.1255s/iter; left time: 2062.8380s
Epoch: 21 cost time: 26.82998824119568
Epoch: 21, Steps: 208 | Train Loss: 0.359 Vali Loss: 8.228 Vali Acc: 0.139 Test Loss: 8.228 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3169309
	speed: 0.2732s/iter; left time: 4462.6000s
	iters: 200, epoch: 22 | loss: 0.1623708
	speed: 0.1213s/iter; left time: 1968.6204s
Epoch: 22 cost time: 25.338524103164673
Epoch: 22, Steps: 208 | Train Loss: 0.315 Vali Loss: 8.960 Vali Acc: 0.134 Test Loss: 8.960 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3542798
	speed: 0.2771s/iter; left time: 4468.2756s
	iters: 200, epoch: 23 | loss: 0.1423451
	speed: 0.1127s/iter; left time: 1805.9005s
Epoch: 23 cost time: 24.02111005783081
Epoch: 23, Steps: 208 | Train Loss: 0.301 Vali Loss: 9.678 Vali Acc: 0.137 Test Loss: 9.678 Test Acc: 0.137
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0471615
	speed: 0.2856s/iter; left time: 4545.7017s
	iters: 200, epoch: 24 | loss: 0.0594040
	speed: 0.1257s/iter; left time: 1987.7195s
Epoch: 24 cost time: 26.548282146453857
Epoch: 24, Steps: 208 | Train Loss: 0.277 Vali Loss: 10.198 Vali Acc: 0.126 Test Loss: 10.198 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.3583069
	speed: 0.3244s/iter; left time: 5095.2519s
	iters: 200, epoch: 25 | loss: 0.1891963
	speed: 0.1666s/iter; left time: 2599.9465s
Epoch: 25 cost time: 35.287200927734375
Epoch: 25, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.000 Vali Acc: 0.122 Test Loss: 10.000 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14345362362063824
model parameter : 1569767
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2116981
	speed: 0.1659s/iter; left time: 3434.4715s
	iters: 200, epoch: 1 | loss: 3.6771929
	speed: 0.1532s/iter; left time: 3155.0438s
Epoch: 1 cost time: 33.35946464538574
Epoch: 1, Steps: 208 | Train Loss: 4.067 Vali Loss: 3.623 Vali Acc: 0.058 Test Loss: 3.623 Test Acc: 0.058
Validation loss decreased (inf --> -0.058419).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8668842
	speed: 0.3424s/iter; left time: 7016.7827s
	iters: 200, epoch: 2 | loss: 3.7700424
	speed: 0.1501s/iter; left time: 3061.5692s
Epoch: 2 cost time: 32.44363188743591
Epoch: 2, Steps: 208 | Train Loss: 3.614 Vali Loss: 3.713 Vali Acc: 0.076 Test Loss: 3.713 Test Acc: 0.076
Validation loss decreased (-0.058419 --> -0.076014).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.0243669
	speed: 0.3265s/iter; left time: 6622.7869s
	iters: 200, epoch: 3 | loss: 3.1450479
	speed: 0.1425s/iter; left time: 2875.5738s
Epoch: 3 cost time: 30.199464559555054
Epoch: 3, Steps: 208 | Train Loss: 3.678 Vali Loss: 3.677 Vali Acc: 0.094 Test Loss: 3.677 Test Acc: 0.094
Validation loss decreased (-0.076014 --> -0.094207).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3775239
	speed: 0.2615s/iter; left time: 5250.1623s
	iters: 200, epoch: 4 | loss: 3.8350308
	speed: 0.1105s/iter; left time: 2207.2745s
Epoch: 4 cost time: 21.641377687454224
Epoch: 4, Steps: 208 | Train Loss: 3.797 Vali Loss: 4.484 Vali Acc: 0.085 Test Loss: 4.484 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.8053041
	speed: 0.2946s/iter; left time: 5853.1581s
	iters: 200, epoch: 5 | loss: 5.0503740
	speed: 0.1121s/iter; left time: 2216.6752s
Epoch: 5 cost time: 24.79870581626892
Epoch: 5, Steps: 208 | Train Loss: 3.811 Vali Loss: 4.449 Vali Acc: 0.107 Test Loss: 4.449 Test Acc: 0.107
Validation loss decreased (-0.094207 --> -0.107322).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.9255047
	speed: 0.2890s/iter; left time: 5681.7473s
	iters: 200, epoch: 6 | loss: 5.8546987
	speed: 0.1215s/iter; left time: 2376.4574s
Epoch: 6 cost time: 25.525320529937744
Epoch: 6, Steps: 208 | Train Loss: 3.794 Vali Loss: 4.911 Vali Acc: 0.112 Test Loss: 4.911 Test Acc: 0.112
Validation loss decreased (-0.107322 --> -0.112388).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0729001
	speed: 0.2578s/iter; left time: 5015.6724s
	iters: 200, epoch: 7 | loss: 4.3527074
	speed: 0.1086s/iter; left time: 2101.2383s
Epoch: 7 cost time: 22.097822189331055
Epoch: 7, Steps: 208 | Train Loss: 3.622 Vali Loss: 5.070 Vali Acc: 0.108 Test Loss: 5.070 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9554679
	speed: 0.2721s/iter; left time: 5236.4370s
	iters: 200, epoch: 8 | loss: 4.0020251
	speed: 0.1030s/iter; left time: 1971.8063s
Epoch: 8 cost time: 22.75402283668518
Epoch: 8, Steps: 208 | Train Loss: 3.276 Vali Loss: 5.345 Vali Acc: 0.121 Test Loss: 5.345 Test Acc: 0.121
Validation loss decreased (-0.112388 --> -0.121032).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3997543
	speed: 0.2492s/iter; left time: 4743.7175s
	iters: 200, epoch: 9 | loss: 3.6903934
	speed: 0.0910s/iter; left time: 1723.8932s
Epoch: 9 cost time: 19.069530963897705
Epoch: 9, Steps: 208 | Train Loss: 2.935 Vali Loss: 5.066 Vali Acc: 0.127 Test Loss: 5.066 Test Acc: 0.127
Validation loss decreased (-0.121032 --> -0.126702).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4292085
	speed: 0.2740s/iter; left time: 5159.0325s
	iters: 200, epoch: 10 | loss: 2.6843412
	speed: 0.1142s/iter; left time: 2139.4777s
Epoch: 10 cost time: 23.131761074066162
Epoch: 10, Steps: 208 | Train Loss: 2.525 Vali Loss: 5.366 Vali Acc: 0.115 Test Loss: 5.366 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.8513181
	speed: 0.2826s/iter; left time: 5263.0956s
	iters: 200, epoch: 11 | loss: 3.0008559
	speed: 0.1067s/iter; left time: 1975.7464s
Epoch: 11 cost time: 23.560256004333496
Epoch: 11, Steps: 208 | Train Loss: 2.105 Vali Loss: 6.157 Vali Acc: 0.127 Test Loss: 6.157 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4740828
	speed: 0.2614s/iter; left time: 4813.5548s
	iters: 200, epoch: 12 | loss: 1.6357164
	speed: 0.0968s/iter; left time: 1771.8426s
Epoch: 12 cost time: 21.829813480377197
Epoch: 12, Steps: 208 | Train Loss: 1.686 Vali Loss: 6.154 Vali Acc: 0.116 Test Loss: 6.154 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.8001528
	speed: 0.2461s/iter; left time: 4479.3457s
	iters: 200, epoch: 13 | loss: 1.0100944
	speed: 0.0913s/iter; left time: 1653.6776s
Epoch: 13 cost time: 19.609206438064575
Epoch: 13, Steps: 208 | Train Loss: 1.399 Vali Loss: 5.664 Vali Acc: 0.140 Test Loss: 5.664 Test Acc: 0.140
Validation loss decreased (-0.126702 --> -0.139818).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5475376
	speed: 0.2615s/iter; left time: 4707.0687s
	iters: 200, epoch: 14 | loss: 0.4485104
	speed: 0.0935s/iter; left time: 1674.0230s
Epoch: 14 cost time: 20.291648387908936
Epoch: 14, Steps: 208 | Train Loss: 1.145 Vali Loss: 6.639 Vali Acc: 0.134 Test Loss: 6.639 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7326066
	speed: 0.2391s/iter; left time: 4252.6073s
	iters: 200, epoch: 15 | loss: 0.8724943
	speed: 0.0776s/iter; left time: 1372.7334s
Epoch: 15 cost time: 18.053975105285645
Epoch: 15, Steps: 208 | Train Loss: 0.905 Vali Loss: 7.201 Vali Acc: 0.135 Test Loss: 7.201 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4605516
	speed: 0.2320s/iter; left time: 4078.9149s
	iters: 200, epoch: 16 | loss: 0.8499371
	speed: 0.1074s/iter; left time: 1877.4035s
Epoch: 16 cost time: 20.008176803588867
Epoch: 16, Steps: 208 | Train Loss: 0.733 Vali Loss: 7.089 Vali Acc: 0.130 Test Loss: 7.089 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3916124
	speed: 0.3070s/iter; left time: 5333.5709s
	iters: 200, epoch: 17 | loss: 0.5165668
	speed: 0.1433s/iter; left time: 2475.9639s
Epoch: 17 cost time: 30.59774899482727
Epoch: 17, Steps: 208 | Train Loss: 0.657 Vali Loss: 7.585 Vali Acc: 0.126 Test Loss: 7.585 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7948474
	speed: 0.3237s/iter; left time: 5556.7525s
	iters: 200, epoch: 18 | loss: 0.0836406
	speed: 0.1413s/iter; left time: 2411.0604s
Epoch: 18 cost time: 29.9587299823761
Epoch: 18, Steps: 208 | Train Loss: 0.586 Vali Loss: 8.027 Vali Acc: 0.132 Test Loss: 8.027 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8144286
	speed: 0.3420s/iter; left time: 5799.8275s
	iters: 200, epoch: 19 | loss: 0.5284594
	speed: 0.1496s/iter; left time: 2521.7421s
Epoch: 19 cost time: 32.5071017742157
Epoch: 19, Steps: 208 | Train Loss: 0.489 Vali Loss: 7.993 Vali Acc: 0.132 Test Loss: 7.993 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1169813
	speed: 0.3263s/iter; left time: 5464.8276s
	iters: 200, epoch: 20 | loss: 0.5306721
	speed: 0.1052s/iter; left time: 1751.7484s
Epoch: 20 cost time: 25.45064425468445
Epoch: 20, Steps: 208 | Train Loss: 0.457 Vali Loss: 7.829 Vali Acc: 0.133 Test Loss: 7.829 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2343612
	speed: 0.2999s/iter; left time: 4961.3484s
	iters: 200, epoch: 21 | loss: 0.6623387
	speed: 0.1322s/iter; left time: 2172.9903s
Epoch: 21 cost time: 27.655129432678223
Epoch: 21, Steps: 208 | Train Loss: 0.381 Vali Loss: 8.804 Vali Acc: 0.131 Test Loss: 8.804 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2956779
	speed: 0.1908s/iter; left time: 3116.0721s
	iters: 200, epoch: 22 | loss: 0.3321236
	speed: 0.0474s/iter; left time: 768.7524s
Epoch: 22 cost time: 10.687003374099731
Epoch: 22, Steps: 208 | Train Loss: 0.381 Vali Loss: 9.318 Vali Acc: 0.125 Test Loss: 9.318 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.6055523
	speed: 0.2513s/iter; left time: 4051.4731s
	iters: 200, epoch: 23 | loss: 0.5475522
	speed: 0.1051s/iter; left time: 1684.8304s
Epoch: 23 cost time: 22.6148738861084
Epoch: 23, Steps: 208 | Train Loss: 0.333 Vali Loss: 8.922 Vali Acc: 0.120 Test Loss: 8.922 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13987473903966596
model parameter : 1295847
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8494270
	speed: 0.1347s/iter; left time: 2787.4761s
	iters: 200, epoch: 1 | loss: 3.7428565
	speed: 0.1125s/iter; left time: 2316.7423s
Epoch: 1 cost time: 25.726417541503906
Epoch: 1, Steps: 208 | Train Loss: 4.039 Vali Loss: 3.683 Vali Acc: 0.043 Test Loss: 3.683 Test Acc: 0.043
Validation loss decreased (inf --> -0.042612).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4784079
	speed: 0.2444s/iter; left time: 5009.0521s
	iters: 200, epoch: 2 | loss: 3.4537301
	speed: 0.1161s/iter; left time: 2367.7357s
Epoch: 2 cost time: 23.9251606464386
Epoch: 2, Steps: 208 | Train Loss: 3.476 Vali Loss: 3.916 Vali Acc: 0.058 Test Loss: 3.916 Test Acc: 0.058
Validation loss decreased (-0.042612 --> -0.058118).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8338449
	speed: 0.2599s/iter; left time: 5271.2279s
	iters: 200, epoch: 3 | loss: 3.8094466
	speed: 0.1136s/iter; left time: 2293.6454s
Epoch: 3 cost time: 24.04675269126892
Epoch: 3, Steps: 208 | Train Loss: 3.468 Vali Loss: 4.123 Vali Acc: 0.077 Test Loss: 4.123 Test Acc: 0.077
Validation loss decreased (-0.058118 --> -0.076607).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8265295
	speed: 0.2409s/iter; left time: 4836.8545s
	iters: 200, epoch: 4 | loss: 4.2895398
	speed: 0.0936s/iter; left time: 1869.4494s
Epoch: 4 cost time: 20.54678988456726
Epoch: 4, Steps: 208 | Train Loss: 3.499 Vali Loss: 4.135 Vali Acc: 0.088 Test Loss: 4.135 Test Acc: 0.088
Validation loss decreased (-0.076607 --> -0.087940).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.2398858
	speed: 0.2568s/iter; left time: 5103.2193s
	iters: 200, epoch: 5 | loss: 2.7938068
	speed: 0.1086s/iter; left time: 2146.2021s
Epoch: 5 cost time: 23.092525482177734
Epoch: 5, Steps: 208 | Train Loss: 3.495 Vali Loss: 4.632 Vali Acc: 0.090 Test Loss: 4.632 Test Acc: 0.090
Validation loss decreased (-0.087940 --> -0.090321).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9304240
	speed: 0.2347s/iter; left time: 4614.2381s
	iters: 200, epoch: 6 | loss: 2.4904385
	speed: 0.1039s/iter; left time: 2033.3344s
Epoch: 6 cost time: 20.970736742019653
Epoch: 6, Steps: 208 | Train Loss: 3.439 Vali Loss: 4.812 Vali Acc: 0.102 Test Loss: 4.812 Test Acc: 0.102
Validation loss decreased (-0.090321 --> -0.101652).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.6113338
	speed: 0.2745s/iter; left time: 5340.6783s
	iters: 200, epoch: 7 | loss: 2.9222240
	speed: 0.1192s/iter; left time: 2306.7322s
Epoch: 7 cost time: 25.66398811340332
Epoch: 7, Steps: 208 | Train Loss: 3.296 Vali Loss: 4.914 Vali Acc: 0.098 Test Loss: 4.914 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.8779440
	speed: 0.2844s/iter; left time: 5473.9626s
	iters: 200, epoch: 8 | loss: 3.0674620
	speed: 0.1242s/iter; left time: 2378.5265s
Epoch: 8 cost time: 26.488073348999023
Epoch: 8, Steps: 208 | Train Loss: 3.067 Vali Loss: 5.364 Vali Acc: 0.102 Test Loss: 5.364 Test Acc: 0.102
Validation loss decreased (-0.101652 --> -0.101945).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3966475
	speed: 0.2554s/iter; left time: 4861.3565s
	iters: 200, epoch: 9 | loss: 2.5537517
	speed: 0.1283s/iter; left time: 2430.4815s
Epoch: 9 cost time: 24.86668109893799
Epoch: 9, Steps: 208 | Train Loss: 2.777 Vali Loss: 5.073 Vali Acc: 0.112 Test Loss: 5.073 Test Acc: 0.112
Validation loss decreased (-0.101945 --> -0.111491).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9683337
	speed: 0.2877s/iter; left time: 5417.6521s
	iters: 200, epoch: 10 | loss: 2.6704960
	speed: 0.1218s/iter; left time: 2281.4763s
Epoch: 10 cost time: 26.380342960357666
Epoch: 10, Steps: 208 | Train Loss: 2.418 Vali Loss: 5.351 Vali Acc: 0.113 Test Loss: 5.351 Test Acc: 0.113
Validation loss decreased (-0.111491 --> -0.113278).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9263968
	speed: 0.2341s/iter; left time: 4359.0253s
	iters: 200, epoch: 11 | loss: 2.2664502
	speed: 0.0935s/iter; left time: 1732.4028s
Epoch: 11 cost time: 18.82834768295288
Epoch: 11, Steps: 208 | Train Loss: 2.145 Vali Loss: 6.082 Vali Acc: 0.118 Test Loss: 6.082 Test Acc: 0.118
Validation loss decreased (-0.113278 --> -0.117446).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8286577
	speed: 0.2479s/iter; left time: 4564.3671s
	iters: 200, epoch: 12 | loss: 2.4133396
	speed: 0.1062s/iter; left time: 1945.4235s
Epoch: 12 cost time: 20.835951328277588
Epoch: 12, Steps: 208 | Train Loss: 1.803 Vali Loss: 5.725 Vali Acc: 0.106 Test Loss: 5.725 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1951659
	speed: 0.2393s/iter; left time: 4356.7838s
	iters: 200, epoch: 13 | loss: 1.9019234
	speed: 0.0807s/iter; left time: 1460.9545s
Epoch: 13 cost time: 17.6697199344635
Epoch: 13, Steps: 208 | Train Loss: 1.498 Vali Loss: 6.616 Vali Acc: 0.119 Test Loss: 6.616 Test Acc: 0.119
Validation loss decreased (-0.117446 --> -0.119230).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6574874
	speed: 0.2461s/iter; left time: 4428.5803s
	iters: 200, epoch: 14 | loss: 0.9272481
	speed: 0.0859s/iter; left time: 1538.1852s
Epoch: 14 cost time: 18.893091678619385
Epoch: 14, Steps: 208 | Train Loss: 1.235 Vali Loss: 6.373 Vali Acc: 0.118 Test Loss: 6.373 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5758395
	speed: 0.2350s/iter; left time: 4180.2768s
	iters: 200, epoch: 15 | loss: 0.3003917
	speed: 0.0969s/iter; left time: 1714.7771s
Epoch: 15 cost time: 19.53192162513733
Epoch: 15, Steps: 208 | Train Loss: 0.983 Vali Loss: 6.873 Vali Acc: 0.126 Test Loss: 6.873 Test Acc: 0.126
Validation loss decreased (-0.119230 --> -0.125789).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0753253
	speed: 0.2484s/iter; left time: 4367.6357s
	iters: 200, epoch: 16 | loss: 0.5176154
	speed: 0.0701s/iter; left time: 1225.9754s
Epoch: 16 cost time: 17.267401695251465
Epoch: 16, Steps: 208 | Train Loss: 0.825 Vali Loss: 7.006 Vali Acc: 0.124 Test Loss: 7.006 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6387723
	speed: 0.2480s/iter; left time: 4308.7350s
	iters: 200, epoch: 17 | loss: 1.1139092
	speed: 0.0903s/iter; left time: 1560.5665s
Epoch: 17 cost time: 19.766430139541626
Epoch: 17, Steps: 208 | Train Loss: 0.733 Vali Loss: 7.500 Vali Acc: 0.123 Test Loss: 7.500 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3537363
	speed: 0.2536s/iter; left time: 4353.8940s
	iters: 200, epoch: 18 | loss: 0.7570891
	speed: 0.1127s/iter; left time: 1924.0682s
Epoch: 18 cost time: 23.4228458404541
Epoch: 18, Steps: 208 | Train Loss: 0.616 Vali Loss: 8.091 Vali Acc: 0.121 Test Loss: 8.091 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1447712
	speed: 0.2740s/iter; left time: 4645.4762s
	iters: 200, epoch: 19 | loss: 0.3253044
	speed: 0.1123s/iter; left time: 1892.9625s
Epoch: 19 cost time: 24.521090030670166
Epoch: 19, Steps: 208 | Train Loss: 0.556 Vali Loss: 8.117 Vali Acc: 0.122 Test Loss: 8.117 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1292566
	speed: 0.2693s/iter; left time: 4511.0795s
	iters: 200, epoch: 20 | loss: 1.6735444
	speed: 0.1159s/iter; left time: 1928.9741s
Epoch: 20 cost time: 24.082700967788696
Epoch: 20, Steps: 208 | Train Loss: 0.513 Vali Loss: 7.906 Vali Acc: 0.126 Test Loss: 7.906 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4150940
	speed: 0.3031s/iter; left time: 5013.8328s
	iters: 200, epoch: 21 | loss: 0.5846514
	speed: 0.1326s/iter; left time: 2180.4684s
Epoch: 21 cost time: 29.900554656982422
Epoch: 21, Steps: 208 | Train Loss: 0.432 Vali Loss: 8.033 Vali Acc: 0.114 Test Loss: 8.033 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4736889
	speed: 0.3509s/iter; left time: 5731.1978s
	iters: 200, epoch: 22 | loss: 0.9791197
	speed: 0.1423s/iter; left time: 2310.7364s
Epoch: 22 cost time: 31.946134328842163
Epoch: 22, Steps: 208 | Train Loss: 0.438 Vali Loss: 8.931 Vali Acc: 0.110 Test Loss: 8.931 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3328066
	speed: 0.3460s/iter; left time: 5579.4956s
	iters: 200, epoch: 23 | loss: 0.2639916
	speed: 0.1866s/iter; left time: 2989.7365s
Epoch: 23 cost time: 36.79881167411804
Epoch: 23, Steps: 208 | Train Loss: 0.379 Vali Loss: 9.734 Vali Acc: 0.115 Test Loss: 9.734 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1699072
	speed: 0.3284s/iter; left time: 5226.9558s
	iters: 200, epoch: 24 | loss: 0.3040380
	speed: 0.1424s/iter; left time: 2251.9671s
Epoch: 24 cost time: 30.8524751663208
Epoch: 24, Steps: 208 | Train Loss: 0.371 Vali Loss: 10.103 Vali Acc: 0.122 Test Loss: 10.103 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.2688762
	speed: 0.2923s/iter; left time: 4591.3085s
	iters: 200, epoch: 25 | loss: 0.3271564
	speed: 0.1429s/iter; left time: 2230.5795s
Epoch: 25 cost time: 29.05067801475525
Epoch: 25, Steps: 208 | Train Loss: 0.336 Vali Loss: 9.747 Vali Acc: 0.119 Test Loss: 9.747 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1258574410975246
model parameter : 912871
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4331951
	speed: 0.1502s/iter; left time: 3109.8280s
	iters: 200, epoch: 1 | loss: 4.0209699
	speed: 0.1060s/iter; left time: 2183.8374s
Epoch: 1 cost time: 26.557380199432373
Epoch: 1, Steps: 208 | Train Loss: 3.986 Vali Loss: 3.583 Vali Acc: 0.062 Test Loss: 3.583 Test Acc: 0.062
Validation loss decreased (inf --> -0.061700).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2131765
	speed: 0.2933s/iter; left time: 6009.5904s
	iters: 200, epoch: 2 | loss: 3.3498902
	speed: 0.1393s/iter; left time: 2840.5581s
Epoch: 2 cost time: 29.11032199859619
Epoch: 2, Steps: 208 | Train Loss: 3.467 Vali Loss: 3.987 Vali Acc: 0.067 Test Loss: 3.987 Test Acc: 0.067
Validation loss decreased (-0.061700 --> -0.066468).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3544519
	speed: 0.2493s/iter; left time: 5057.0758s
	iters: 200, epoch: 3 | loss: 3.0182393
	speed: 0.0888s/iter; left time: 1793.3424s
Epoch: 3 cost time: 19.08258843421936
Epoch: 3, Steps: 208 | Train Loss: 3.372 Vali Loss: 3.630 Vali Acc: 0.092 Test Loss: 3.630 Test Acc: 0.092
Validation loss decreased (-0.066468 --> -0.091822).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1609087
	speed: 0.2244s/iter; left time: 4506.1161s
	iters: 200, epoch: 4 | loss: 2.7572258
	speed: 0.0814s/iter; left time: 1625.3594s
Epoch: 4 cost time: 17.398735761642456
Epoch: 4, Steps: 208 | Train Loss: 3.416 Vali Loss: 3.626 Vali Acc: 0.095 Test Loss: 3.626 Test Acc: 0.095
Validation loss decreased (-0.091822 --> -0.095102).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.3101926
	speed: 0.2548s/iter; left time: 5062.7026s
	iters: 200, epoch: 5 | loss: 2.7540321
	speed: 0.0892s/iter; left time: 1763.2320s
Epoch: 5 cost time: 19.966614246368408
Epoch: 5, Steps: 208 | Train Loss: 3.392 Vali Loss: 3.900 Vali Acc: 0.093 Test Loss: 3.900 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6665416
	speed: 0.2218s/iter; left time: 4361.2479s
	iters: 200, epoch: 6 | loss: 2.6556146
	speed: 0.0635s/iter; left time: 1241.4736s
Epoch: 6 cost time: 14.842820644378662
Epoch: 6, Steps: 208 | Train Loss: 3.311 Vali Loss: 4.207 Vali Acc: 0.103 Test Loss: 4.207 Test Acc: 0.103
Validation loss decreased (-0.095102 --> -0.102851).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9352903
	speed: 0.2437s/iter; left time: 4740.2213s
	iters: 200, epoch: 7 | loss: 3.8175454
	speed: 0.1007s/iter; left time: 1949.5927s
Epoch: 7 cost time: 21.53563904762268
Epoch: 7, Steps: 208 | Train Loss: 3.083 Vali Loss: 4.939 Vali Acc: 0.108 Test Loss: 4.939 Test Acc: 0.108
Validation loss decreased (-0.102851 --> -0.107615).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4387038
	speed: 0.2608s/iter; left time: 5019.8002s
	iters: 200, epoch: 8 | loss: 3.3539703
	speed: 0.0937s/iter; left time: 1793.4706s
Epoch: 8 cost time: 21.194305419921875
Epoch: 8, Steps: 208 | Train Loss: 2.931 Vali Loss: 5.427 Vali Acc: 0.111 Test Loss: 5.427 Test Acc: 0.111
Validation loss decreased (-0.107615 --> -0.110891).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1488695
	speed: 0.2341s/iter; left time: 4457.2837s
	iters: 200, epoch: 9 | loss: 3.0117855
	speed: 0.0959s/iter; left time: 1815.2057s
Epoch: 9 cost time: 19.866732358932495
Epoch: 9, Steps: 208 | Train Loss: 2.633 Vali Loss: 4.480 Vali Acc: 0.109 Test Loss: 4.480 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2584205
	speed: 0.2505s/iter; left time: 4715.9288s
	iters: 200, epoch: 10 | loss: 2.5878694
	speed: 0.0751s/iter; left time: 1405.7818s
Epoch: 10 cost time: 18.147397756576538
Epoch: 10, Steps: 208 | Train Loss: 2.376 Vali Loss: 5.102 Vali Acc: 0.109 Test Loss: 5.102 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1917051
	speed: 0.2460s/iter; left time: 4580.3166s
	iters: 200, epoch: 11 | loss: 2.1935234
	speed: 0.1121s/iter; left time: 2076.7893s
Epoch: 11 cost time: 21.161590576171875
Epoch: 11, Steps: 208 | Train Loss: 2.042 Vali Loss: 5.741 Vali Acc: 0.112 Test Loss: 5.741 Test Acc: 0.112
Validation loss decreased (-0.110891 --> -0.112081).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5463715
	speed: 0.2783s/iter; left time: 5125.0485s
	iters: 200, epoch: 12 | loss: 1.2111456
	speed: 0.1185s/iter; left time: 2170.1538s
Epoch: 12 cost time: 24.15619397163391
Epoch: 12, Steps: 208 | Train Loss: 1.738 Vali Loss: 6.541 Vali Acc: 0.124 Test Loss: 6.541 Test Acc: 0.124
Validation loss decreased (-0.112081 --> -0.124003).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6667765
	speed: 0.2879s/iter; left time: 5241.9685s
	iters: 200, epoch: 13 | loss: 2.1062908
	speed: 0.1189s/iter; left time: 2152.0682s
Epoch: 13 cost time: 24.976914405822754
Epoch: 13, Steps: 208 | Train Loss: 1.457 Vali Loss: 6.497 Vali Acc: 0.119 Test Loss: 6.497 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5223104
	speed: 0.2853s/iter; left time: 5134.1990s
	iters: 200, epoch: 14 | loss: 2.3621571
	speed: 0.1198s/iter; left time: 2144.9484s
Epoch: 14 cost time: 25.518295526504517
Epoch: 14, Steps: 208 | Train Loss: 1.197 Vali Loss: 7.156 Vali Acc: 0.111 Test Loss: 7.156 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7610320
	speed: 0.3138s/iter; left time: 5581.4052s
	iters: 200, epoch: 15 | loss: 1.6615297
	speed: 0.1481s/iter; left time: 2620.0535s
Epoch: 15 cost time: 31.386987686157227
Epoch: 15, Steps: 208 | Train Loss: 1.045 Vali Loss: 6.964 Vali Acc: 0.124 Test Loss: 6.964 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.7008546
	speed: 0.3257s/iter; left time: 5725.7520s
	iters: 200, epoch: 16 | loss: 0.5885799
	speed: 0.1449s/iter; left time: 2532.2600s
Epoch: 16 cost time: 31.006853342056274
Epoch: 16, Steps: 208 | Train Loss: 0.888 Vali Loss: 7.635 Vali Acc: 0.122 Test Loss: 7.635 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6692455
	speed: 0.3070s/iter; left time: 5333.3617s
	iters: 200, epoch: 17 | loss: 0.9876660
	speed: 0.1040s/iter; left time: 1796.7670s
Epoch: 17 cost time: 25.094172954559326
Epoch: 17, Steps: 208 | Train Loss: 0.754 Vali Loss: 7.452 Vali Acc: 0.123 Test Loss: 7.452 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.7492129
	speed: 0.2917s/iter; left time: 5007.2777s
	iters: 200, epoch: 18 | loss: 0.2679878
	speed: 0.1301s/iter; left time: 2220.2394s
Epoch: 18 cost time: 26.916982412338257
Epoch: 18, Steps: 208 | Train Loss: 0.639 Vali Loss: 7.725 Vali Acc: 0.123 Test Loss: 7.725 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4496222
	speed: 0.2886s/iter; left time: 4893.4892s
	iters: 200, epoch: 19 | loss: 0.5942060
	speed: 0.1153s/iter; left time: 1943.7349s
Epoch: 19 cost time: 25.10200786590576
Epoch: 19, Steps: 208 | Train Loss: 0.609 Vali Loss: 8.152 Vali Acc: 0.112 Test Loss: 8.152 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2604069
	speed: 0.3072s/iter; left time: 5145.7201s
	iters: 200, epoch: 20 | loss: 1.2127390
	speed: 0.1451s/iter; left time: 2415.7584s
Epoch: 20 cost time: 28.689656496047974
Epoch: 20, Steps: 208 | Train Loss: 0.543 Vali Loss: 8.402 Vali Acc: 0.110 Test Loss: 8.402 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.4725079
	speed: 0.3134s/iter; left time: 5183.9813s
	iters: 200, epoch: 21 | loss: 1.3368311
	speed: 0.1451s/iter; left time: 2386.3145s
Epoch: 21 cost time: 28.410624980926514
Epoch: 21, Steps: 208 | Train Loss: 0.503 Vali Loss: 8.585 Vali Acc: 0.112 Test Loss: 8.585 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3534087
	speed: 0.3272s/iter; left time: 5343.5082s
	iters: 200, epoch: 22 | loss: 0.6347235
	speed: 0.1245s/iter; left time: 2021.0090s
Epoch: 22 cost time: 27.241870164871216
Epoch: 22, Steps: 208 | Train Loss: 0.428 Vali Loss: 9.288 Vali Acc: 0.114 Test Loss: 9.288 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12406799880703848
model parameter : 749543
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9235311
	speed: 0.1961s/iter; left time: 4060.0037s
	iters: 200, epoch: 1 | loss: 3.8116214
	speed: 0.1300s/iter; left time: 2677.4661s
Epoch: 1 cost time: 33.8152072429657
Epoch: 1, Steps: 208 | Train Loss: 3.928 Vali Loss: 3.848 Vali Acc: 0.056 Test Loss: 3.848 Test Acc: 0.056
Validation loss decreased (inf --> -0.056031).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7360477
	speed: 0.3503s/iter; left time: 7178.1583s
	iters: 200, epoch: 2 | loss: 3.9222026
	speed: 0.1708s/iter; left time: 3482.7625s
Epoch: 2 cost time: 35.11208701133728
Epoch: 2, Steps: 208 | Train Loss: 3.529 Vali Loss: 3.445 Vali Acc: 0.080 Test Loss: 3.445 Test Acc: 0.080
Validation loss decreased (-0.056031 --> -0.080192).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2793896
	speed: 0.3036s/iter; left time: 6158.8677s
	iters: 200, epoch: 3 | loss: 2.9116983
	speed: 0.1465s/iter; left time: 2957.4823s
Epoch: 3 cost time: 30.79435086250305
Epoch: 3, Steps: 208 | Train Loss: 3.372 Vali Loss: 3.811 Vali Acc: 0.083 Test Loss: 3.811 Test Acc: 0.083
Validation loss decreased (-0.080192 --> -0.083171).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5470681
	speed: 0.2634s/iter; left time: 5288.1784s
	iters: 200, epoch: 4 | loss: 3.2384028
	speed: 0.1328s/iter; left time: 2653.1141s
Epoch: 4 cost time: 23.723531246185303
Epoch: 4, Steps: 208 | Train Loss: 3.269 Vali Loss: 4.110 Vali Acc: 0.090 Test Loss: 4.110 Test Acc: 0.090
Validation loss decreased (-0.083171 --> -0.089729).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9668069
	speed: 0.2927s/iter; left time: 5816.0867s
	iters: 200, epoch: 5 | loss: 3.3266308
	speed: 0.0718s/iter; left time: 1418.8602s
Epoch: 5 cost time: 19.884758949279785
Epoch: 5, Steps: 208 | Train Loss: 3.233 Vali Loss: 3.907 Vali Acc: 0.088 Test Loss: 3.907 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.7279286
	speed: 0.2789s/iter; left time: 5484.3715s
	iters: 200, epoch: 6 | loss: 3.5298669
	speed: 0.1136s/iter; left time: 2221.4475s
Epoch: 6 cost time: 24.36012315750122
Epoch: 6, Steps: 208 | Train Loss: 3.070 Vali Loss: 4.271 Vali Acc: 0.107 Test Loss: 4.271 Test Acc: 0.107
Validation loss decreased (-0.089729 --> -0.107026).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3488483
	speed: 0.3013s/iter; left time: 5861.7589s
	iters: 200, epoch: 7 | loss: 3.3527277
	speed: 0.1579s/iter; left time: 3055.6332s
Epoch: 7 cost time: 30.85001015663147
Epoch: 7, Steps: 208 | Train Loss: 2.945 Vali Loss: 4.687 Vali Acc: 0.099 Test Loss: 4.687 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5738826
	speed: 0.3242s/iter; left time: 6239.6908s
	iters: 200, epoch: 8 | loss: 2.8275201
	speed: 0.1595s/iter; left time: 3053.8091s
Epoch: 8 cost time: 31.619579553604126
Epoch: 8, Steps: 208 | Train Loss: 2.672 Vali Loss: 4.560 Vali Acc: 0.106 Test Loss: 4.560 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9939690
	speed: 0.3512s/iter; left time: 6685.0121s
	iters: 200, epoch: 9 | loss: 2.8466232
	speed: 0.1238s/iter; left time: 2343.8818s
Epoch: 9 cost time: 30.58970856666565
Epoch: 9, Steps: 208 | Train Loss: 2.445 Vali Loss: 5.836 Vali Acc: 0.098 Test Loss: 5.836 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8328544
	speed: 0.3397s/iter; left time: 6395.4290s
	iters: 200, epoch: 10 | loss: 2.6546383
	speed: 0.1524s/iter; left time: 2854.6299s
Epoch: 10 cost time: 32.95328998565674
Epoch: 10, Steps: 208 | Train Loss: 2.165 Vali Loss: 6.110 Vali Acc: 0.098 Test Loss: 6.110 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.4339912
	speed: 0.3490s/iter; left time: 6498.6566s
	iters: 200, epoch: 11 | loss: 2.2861395
	speed: 0.1893s/iter; left time: 3506.5164s
Epoch: 11 cost time: 38.54673624038696
Epoch: 11, Steps: 208 | Train Loss: 1.888 Vali Loss: 5.749 Vali Acc: 0.098 Test Loss: 5.749 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0172309
	speed: 0.3560s/iter; left time: 6554.4419s
	iters: 200, epoch: 12 | loss: 2.0154879
	speed: 0.1761s/iter; left time: 3225.7737s
Epoch: 12 cost time: 36.47243523597717
Epoch: 12, Steps: 208 | Train Loss: 1.579 Vali Loss: 6.785 Vali Acc: 0.113 Test Loss: 6.785 Test Acc: 0.113
Validation loss decreased (-0.107026 --> -0.113263).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3180363
	speed: 0.3690s/iter; left time: 6718.5164s
	iters: 200, epoch: 13 | loss: 2.6539123
	speed: 0.1722s/iter; left time: 3117.3983s
Epoch: 13 cost time: 37.05081915855408
Epoch: 13, Steps: 208 | Train Loss: 1.382 Vali Loss: 6.546 Vali Acc: 0.109 Test Loss: 6.546 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3064142
	speed: 0.3353s/iter; left time: 6033.8131s
	iters: 200, epoch: 14 | loss: 1.2142416
	speed: 0.1653s/iter; left time: 2958.9735s
Epoch: 14 cost time: 34.031933069229126
Epoch: 14, Steps: 208 | Train Loss: 1.125 Vali Loss: 7.158 Vali Acc: 0.101 Test Loss: 7.158 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3042709
	speed: 0.3266s/iter; left time: 5810.0992s
	iters: 200, epoch: 15 | loss: 1.2130282
	speed: 0.1604s/iter; left time: 2837.0875s
Epoch: 15 cost time: 32.17607545852661
Epoch: 15, Steps: 208 | Train Loss: 0.974 Vali Loss: 7.513 Vali Acc: 0.111 Test Loss: 7.513 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8071973
	speed: 0.3272s/iter; left time: 5753.2284s
	iters: 200, epoch: 16 | loss: 0.8727929
	speed: 0.1552s/iter; left time: 2713.2466s
Epoch: 16 cost time: 31.78602385520935
Epoch: 16, Steps: 208 | Train Loss: 0.861 Vali Loss: 7.765 Vali Acc: 0.117 Test Loss: 7.765 Test Acc: 0.117
Validation loss decreased (-0.113263 --> -0.117131).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.9880916
	speed: 0.3769s/iter; left time: 6547.3692s
	iters: 200, epoch: 17 | loss: 0.8846070
	speed: 0.1604s/iter; left time: 2770.0843s
Epoch: 17 cost time: 36.71125888824463
Epoch: 17, Steps: 208 | Train Loss: 0.737 Vali Loss: 8.291 Vali Acc: 0.112 Test Loss: 8.291 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5286988
	speed: 0.3189s/iter; left time: 5474.4256s
	iters: 200, epoch: 18 | loss: 0.8692752
	speed: 0.1516s/iter; left time: 2587.6049s
Epoch: 18 cost time: 29.822884559631348
Epoch: 18, Steps: 208 | Train Loss: 0.646 Vali Loss: 8.378 Vali Acc: 0.121 Test Loss: 8.378 Test Acc: 0.121
Validation loss decreased (-0.117131 --> -0.120704).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5078021
	speed: 0.2926s/iter; left time: 4961.9347s
	iters: 200, epoch: 19 | loss: 0.7436465
	speed: 0.1393s/iter; left time: 2347.4399s
Epoch: 19 cost time: 27.134491682052612
Epoch: 19, Steps: 208 | Train Loss: 0.584 Vali Loss: 9.156 Vali Acc: 0.112 Test Loss: 9.156 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3616519
	speed: 0.3085s/iter; left time: 5167.8334s
	iters: 200, epoch: 20 | loss: 0.6086582
	speed: 0.0998s/iter; left time: 1661.1231s
Epoch: 20 cost time: 24.484097719192505
Epoch: 20, Steps: 208 | Train Loss: 0.567 Vali Loss: 8.995 Vali Acc: 0.108 Test Loss: 8.995 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.3395546
	speed: 0.3085s/iter; left time: 5103.6943s
	iters: 200, epoch: 21 | loss: 0.1653904
	speed: 0.1207s/iter; left time: 1984.9931s
Epoch: 21 cost time: 26.25105571746826
Epoch: 21, Steps: 208 | Train Loss: 0.474 Vali Loss: 8.972 Vali Acc: 0.108 Test Loss: 8.972 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.4063909
	speed: 0.3022s/iter; left time: 4935.2134s
	iters: 200, epoch: 22 | loss: 0.5121084
	speed: 0.1375s/iter; left time: 2232.7519s
Epoch: 22 cost time: 28.93513035774231
Epoch: 22, Steps: 208 | Train Loss: 0.491 Vali Loss: 9.720 Vali Acc: 0.109 Test Loss: 9.720 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.4090989
	speed: 0.2652s/iter; left time: 4277.1016s
	iters: 200, epoch: 23 | loss: 0.8868542
	speed: 0.1345s/iter; left time: 2156.0220s
Epoch: 23 cost time: 24.7194402217865
Epoch: 23, Steps: 208 | Train Loss: 0.436 Vali Loss: 9.679 Vali Acc: 0.110 Test Loss: 9.679 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.9784275
	speed: 0.2694s/iter; left time: 4287.9536s
	iters: 200, epoch: 24 | loss: 0.3479278
	speed: 0.0879s/iter; left time: 1389.6448s
Epoch: 24 cost time: 19.990398645401
Epoch: 24, Steps: 208 | Train Loss: 0.417 Vali Loss: 9.490 Vali Acc: 0.098 Test Loss: 9.490 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1861771
	speed: 0.2858s/iter; left time: 4489.3997s
	iters: 200, epoch: 25 | loss: 0.6906464
	speed: 0.1243s/iter; left time: 1939.9130s
Epoch: 25 cost time: 26.09368133544922
Epoch: 25, Steps: 208 | Train Loss: 0.411 Vali Loss: 10.229 Vali Acc: 0.102 Test Loss: 10.229 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.5518869
	speed: 0.3259s/iter; left time: 5051.0187s
	iters: 200, epoch: 26 | loss: 0.2327161
	speed: 0.1648s/iter; left time: 2537.8463s
Epoch: 26 cost time: 33.00038957595825
Epoch: 26, Steps: 208 | Train Loss: 0.377 Vali Loss: 10.758 Vali Acc: 0.107 Test Loss: 10.758 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.4800695
	speed: 0.3638s/iter; left time: 5562.8955s
	iters: 200, epoch: 27 | loss: 0.7194459
	speed: 0.1990s/iter; left time: 3024.1179s
Epoch: 27 cost time: 40.09138250350952
Epoch: 27, Steps: 208 | Train Loss: 0.373 Vali Loss: 10.665 Vali Acc: 0.111 Test Loss: 10.665 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.1740339
	speed: 0.4099s/iter; left time: 6183.2445s
	iters: 200, epoch: 28 | loss: 0.2431121
	speed: 0.1899s/iter; left time: 2844.9523s
Epoch: 28 cost time: 42.08552098274231
Epoch: 28, Steps: 208 | Train Loss: 0.377 Vali Loss: 10.708 Vali Acc: 0.106 Test Loss: 10.708 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm128_nh16_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1207873546078139
model parameter : 641127
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2518263
	speed: 0.2889s/iter; left time: 5981.2050s
	iters: 200, epoch: 1 | loss: 3.4171085
	speed: 0.2615s/iter; left time: 5387.7616s
Epoch: 1 cost time: 57.09962463378906
Epoch: 1, Steps: 208 | Train Loss: 4.500 Vali Loss: 3.715 Vali Acc: 0.068 Test Loss: 3.715 Test Acc: 0.068
Validation loss decreased (inf --> -0.067663).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9678750
	speed: 0.6482s/iter; left time: 13283.0821s
	iters: 200, epoch: 2 | loss: 4.0081964
	speed: 0.2532s/iter; left time: 5163.2439s
Epoch: 2 cost time: 52.38530707359314
Epoch: 2, Steps: 208 | Train Loss: 3.606 Vali Loss: 4.882 Vali Acc: 0.056 Test Loss: 4.882 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.5222821
	speed: 0.6325s/iter; left time: 12829.3093s
	iters: 200, epoch: 3 | loss: 4.9048195
	speed: 0.2186s/iter; left time: 4411.7781s
Epoch: 3 cost time: 46.68257546424866
Epoch: 3, Steps: 208 | Train Loss: 3.950 Vali Loss: 4.991 Vali Acc: 0.078 Test Loss: 4.991 Test Acc: 0.078
Validation loss decreased (-0.067663 --> -0.077791).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0418811
	speed: 0.6084s/iter; left time: 12215.4024s
	iters: 200, epoch: 4 | loss: 5.6481991
	speed: 0.2221s/iter; left time: 4436.2230s
Epoch: 4 cost time: 46.372544288635254
Epoch: 4, Steps: 208 | Train Loss: 4.168 Vali Loss: 5.210 Vali Acc: 0.070 Test Loss: 5.210 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 5.1558089
	speed: 0.5825s/iter; left time: 11573.7299s
	iters: 200, epoch: 5 | loss: 4.0708795
	speed: 0.2216s/iter; left time: 4381.0231s
Epoch: 5 cost time: 46.90081596374512
Epoch: 5, Steps: 208 | Train Loss: 4.110 Vali Loss: 6.199 Vali Acc: 0.083 Test Loss: 6.199 Test Acc: 0.083
Validation loss decreased (-0.077791 --> -0.083147).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3386238
	speed: 0.5865s/iter; left time: 11530.4054s
	iters: 200, epoch: 6 | loss: 3.7956595
	speed: 0.2013s/iter; left time: 3936.6811s
Epoch: 6 cost time: 46.161834478378296
Epoch: 6, Steps: 208 | Train Loss: 3.872 Vali Loss: 4.725 Vali Acc: 0.115 Test Loss: 4.725 Test Acc: 0.115
Validation loss decreased (-0.083147 --> -0.114775).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5648577
	speed: 0.6703s/iter; left time: 13038.4267s
	iters: 200, epoch: 7 | loss: 4.1014175
	speed: 0.2522s/iter; left time: 4880.8981s
Epoch: 7 cost time: 54.00844097137451
Epoch: 7, Steps: 208 | Train Loss: 3.424 Vali Loss: 6.839 Vali Acc: 0.106 Test Loss: 6.839 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.4033604
	speed: 0.5164s/iter; left time: 9938.8198s
	iters: 200, epoch: 8 | loss: 3.4053109
	speed: 0.1961s/iter; left time: 3753.7672s
Epoch: 8 cost time: 38.327495098114014
Epoch: 8, Steps: 208 | Train Loss: 2.742 Vali Loss: 7.355 Vali Acc: 0.080 Test Loss: 7.355 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3223479
	speed: 0.5185s/iter; left time: 9870.0083s
	iters: 200, epoch: 9 | loss: 2.6417701
	speed: 0.1707s/iter; left time: 3232.0252s
Epoch: 9 cost time: 36.76720976829529
Epoch: 9, Steps: 208 | Train Loss: 2.004 Vali Loss: 5.780 Vali Acc: 0.116 Test Loss: 5.780 Test Acc: 0.116
Validation loss decreased (-0.114775 --> -0.115958).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2492698
	speed: 0.5104s/iter; left time: 9610.3086s
	iters: 200, epoch: 10 | loss: 1.4307628
	speed: 0.1972s/iter; left time: 3692.7062s
Epoch: 10 cost time: 41.42422604560852
Epoch: 10, Steps: 208 | Train Loss: 1.501 Vali Loss: 7.255 Vali Acc: 0.112 Test Loss: 7.255 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4605951
	speed: 0.4980s/iter; left time: 9272.5164s
	iters: 200, epoch: 11 | loss: 1.0725365
	speed: 0.1869s/iter; left time: 3461.7322s
Epoch: 11 cost time: 37.85305309295654
Epoch: 11, Steps: 208 | Train Loss: 1.232 Vali Loss: 6.323 Vali Acc: 0.125 Test Loss: 6.323 Test Acc: 0.125
Validation loss decreased (-0.115958 --> -0.124601).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4777604
	speed: 0.5953s/iter; left time: 10960.8964s
	iters: 200, epoch: 12 | loss: 1.3251493
	speed: 0.2168s/iter; left time: 3969.8302s
Epoch: 12 cost time: 46.12161087989807
Epoch: 12, Steps: 208 | Train Loss: 0.917 Vali Loss: 7.932 Vali Acc: 0.120 Test Loss: 7.932 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1056664
	speed: 0.5709s/iter; left time: 10394.0887s
	iters: 200, epoch: 13 | loss: 0.8767328
	speed: 0.2024s/iter; left time: 3663.5964s
Epoch: 13 cost time: 43.980623960494995
Epoch: 13, Steps: 208 | Train Loss: 0.763 Vali Loss: 8.481 Vali Acc: 0.129 Test Loss: 8.481 Test Acc: 0.129
Validation loss decreased (-0.124601 --> -0.128755).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2691179
	speed: 0.5495s/iter; left time: 9888.5142s
	iters: 200, epoch: 14 | loss: 1.1502694
	speed: 0.1986s/iter; left time: 3554.9645s
Epoch: 14 cost time: 41.20860767364502
Epoch: 14, Steps: 208 | Train Loss: 0.641 Vali Loss: 7.116 Vali Acc: 0.121 Test Loss: 7.116 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3689240
	speed: 0.5177s/iter; left time: 9209.3478s
	iters: 200, epoch: 15 | loss: 0.4412072
	speed: 0.1990s/iter; left time: 3520.4360s
Epoch: 15 cost time: 42.20952081680298
Epoch: 15, Steps: 208 | Train Loss: 0.550 Vali Loss: 7.772 Vali Acc: 0.123 Test Loss: 7.772 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.2452709
	speed: 0.5240s/iter; left time: 9213.1472s
	iters: 200, epoch: 16 | loss: 0.2184802
	speed: 0.2155s/iter; left time: 3767.1409s
Epoch: 16 cost time: 43.30669951438904
Epoch: 16, Steps: 208 | Train Loss: 0.447 Vali Loss: 9.386 Vali Acc: 0.124 Test Loss: 9.386 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2555925
	speed: 0.5962s/iter; left time: 10357.1784s
	iters: 200, epoch: 17 | loss: 0.2532350
	speed: 0.2318s/iter; left time: 4004.5589s
Epoch: 17 cost time: 47.5483136177063
Epoch: 17, Steps: 208 | Train Loss: 0.388 Vali Loss: 8.129 Vali Acc: 0.129 Test Loss: 8.129 Test Acc: 0.129
Validation loss decreased (-0.128755 --> -0.128759).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1196336
	speed: 0.5436s/iter; left time: 9330.6574s
	iters: 200, epoch: 18 | loss: 0.3461734
	speed: 0.2183s/iter; left time: 3724.7300s
Epoch: 18 cost time: 46.00068640708923
Epoch: 18, Steps: 208 | Train Loss: 0.363 Vali Loss: 9.684 Vali Acc: 0.130 Test Loss: 9.684 Test Acc: 0.130
Validation loss decreased (-0.128759 --> -0.129638).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3798780
	speed: 0.5385s/iter; left time: 9131.2193s
	iters: 200, epoch: 19 | loss: 0.0493893
	speed: 0.1927s/iter; left time: 3249.0043s
Epoch: 19 cost time: 41.96678423881531
Epoch: 19, Steps: 208 | Train Loss: 0.288 Vali Loss: 10.110 Vali Acc: 0.122 Test Loss: 10.110 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.3163429
	speed: 0.5418s/iter; left time: 9074.8720s
	iters: 200, epoch: 20 | loss: 0.3278583
	speed: 0.1781s/iter; left time: 2965.0337s
Epoch: 20 cost time: 39.986289262771606
Epoch: 20, Steps: 208 | Train Loss: 0.259 Vali Loss: 9.355 Vali Acc: 0.128 Test Loss: 9.355 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2661130
	speed: 0.5156s/iter; left time: 8528.8532s
	iters: 200, epoch: 21 | loss: 0.3229102
	speed: 0.1834s/iter; left time: 3015.2463s
Epoch: 21 cost time: 38.956162214279175
Epoch: 21, Steps: 208 | Train Loss: 0.213 Vali Loss: 10.141 Vali Acc: 0.126 Test Loss: 10.141 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.5918527
	speed: 0.4958s/iter; left time: 8097.3009s
	iters: 200, epoch: 22 | loss: 0.0954042
	speed: 0.1820s/iter; left time: 2954.0550s
Epoch: 22 cost time: 38.44683527946472
Epoch: 22, Steps: 208 | Train Loss: 0.214 Vali Loss: 10.912 Vali Acc: 0.128 Test Loss: 10.912 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.4164234
	speed: 0.4687s/iter; left time: 7558.2036s
	iters: 200, epoch: 23 | loss: 0.1067502
	speed: 0.1893s/iter; left time: 3033.9971s
Epoch: 23 cost time: 39.31298756599426
Epoch: 23, Steps: 208 | Train Loss: 0.187 Vali Loss: 11.294 Vali Acc: 0.128 Test Loss: 11.294 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0055800
	speed: 0.5270s/iter; left time: 8388.0398s
	iters: 200, epoch: 24 | loss: 0.1391219
	speed: 0.1895s/iter; left time: 2996.9349s
Epoch: 24 cost time: 40.618396282196045
Epoch: 24, Steps: 208 | Train Loss: 0.167 Vali Loss: 11.784 Vali Acc: 0.122 Test Loss: 11.784 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1463595
	speed: 0.6147s/iter; left time: 9656.8146s
	iters: 200, epoch: 25 | loss: 0.2555813
	speed: 0.2679s/iter; left time: 4181.0086s
Epoch: 25 cost time: 52.94566535949707
Epoch: 25, Steps: 208 | Train Loss: 0.150 Vali Loss: 12.385 Vali Acc: 0.129 Test Loss: 12.385 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0800558
	speed: 0.6675s/iter; left time: 10347.6775s
	iters: 200, epoch: 26 | loss: 0.1788391
	speed: 0.2201s/iter; left time: 3389.8439s
Epoch: 26 cost time: 48.73231530189514
Epoch: 26, Steps: 208 | Train Loss: 0.151 Vali Loss: 12.718 Vali Acc: 0.124 Test Loss: 12.718 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.3347805
	speed: 0.5499s/iter; left time: 8409.6265s
	iters: 200, epoch: 27 | loss: 0.0861127
	speed: 0.2176s/iter; left time: 3306.7282s
Epoch: 27 cost time: 45.41571760177612
Epoch: 27, Steps: 208 | Train Loss: 0.150 Vali Loss: 13.001 Vali Acc: 0.122 Test Loss: 13.001 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0729685
	speed: 0.4981s/iter; left time: 7514.4011s
	iters: 200, epoch: 28 | loss: 0.2010059
	speed: 0.1812s/iter; left time: 2715.5685s
Epoch: 28 cost time: 37.692949056625366
Epoch: 28, Steps: 208 | Train Loss: 0.144 Vali Loss: 12.865 Vali Acc: 0.115 Test Loss: 12.865 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12973456606024455
model parameter : 2127335
model size : 9.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5210261
	speed: 0.1834s/iter; left time: 3795.9636s
	iters: 200, epoch: 1 | loss: 3.9642901
	speed: 0.1700s/iter; left time: 3502.9445s
Epoch: 1 cost time: 36.73252511024475
Epoch: 1, Steps: 208 | Train Loss: 4.122 Vali Loss: 3.487 Vali Acc: 0.064 Test Loss: 3.487 Test Acc: 0.064
Validation loss decreased (inf --> -0.064087).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9914262
	speed: 0.3908s/iter; left time: 8009.3072s
	iters: 200, epoch: 2 | loss: 3.4157455
	speed: 0.1530s/iter; left time: 3120.5223s
Epoch: 2 cost time: 33.40424394607544
Epoch: 2, Steps: 208 | Train Loss: 3.379 Vali Loss: 3.416 Vali Acc: 0.098 Test Loss: 3.416 Test Acc: 0.098
Validation loss decreased (-0.064087 --> -0.098385).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0188413
	speed: 0.3829s/iter; left time: 7767.7050s
	iters: 200, epoch: 3 | loss: 3.1272423
	speed: 0.1656s/iter; left time: 3341.9094s
Epoch: 3 cost time: 34.148584842681885
Epoch: 3, Steps: 208 | Train Loss: 3.404 Vali Loss: 4.618 Vali Acc: 0.070 Test Loss: 4.618 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5983682
	speed: 0.3708s/iter; left time: 7443.6216s
	iters: 200, epoch: 4 | loss: 3.4902713
	speed: 0.1582s/iter; left time: 3159.9962s
Epoch: 4 cost time: 33.0788094997406
Epoch: 4, Steps: 208 | Train Loss: 3.495 Vali Loss: 4.438 Vali Acc: 0.075 Test Loss: 4.438 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4729769
	speed: 0.4355s/iter; left time: 8653.7729s
	iters: 200, epoch: 5 | loss: 2.5470793
	speed: 0.1861s/iter; left time: 3678.3188s
Epoch: 5 cost time: 39.43258547782898
Epoch: 5, Steps: 208 | Train Loss: 3.504 Vali Loss: 4.763 Vali Acc: 0.097 Test Loss: 4.763 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.3358836
	speed: 0.3745s/iter; left time: 7363.5195s
	iters: 200, epoch: 6 | loss: 3.3019755
	speed: 0.1639s/iter; left time: 3205.6115s
Epoch: 6 cost time: 32.74826431274414
Epoch: 6, Steps: 208 | Train Loss: 3.314 Vali Loss: 4.315 Vali Acc: 0.123 Test Loss: 4.315 Test Acc: 0.123
Validation loss decreased (-0.098385 --> -0.122534).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0812128
	speed: 0.3794s/iter; left time: 7381.1397s
	iters: 200, epoch: 7 | loss: 4.5295157
	speed: 0.1460s/iter; left time: 2826.0412s
Epoch: 7 cost time: 32.14586424827576
Epoch: 7, Steps: 208 | Train Loss: 2.985 Vali Loss: 5.581 Vali Acc: 0.121 Test Loss: 5.581 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5533657
	speed: 0.3785s/iter; left time: 7283.5216s
	iters: 200, epoch: 8 | loss: 1.7340739
	speed: 0.1464s/iter; left time: 2801.9748s
Epoch: 8 cost time: 31.91999387741089
Epoch: 8, Steps: 208 | Train Loss: 2.641 Vali Loss: 5.606 Vali Acc: 0.109 Test Loss: 5.606 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3115005
	speed: 0.3549s/iter; left time: 6756.6864s
	iters: 200, epoch: 9 | loss: 1.8254241
	speed: 0.1546s/iter; left time: 2926.8221s
Epoch: 9 cost time: 32.76193881034851
Epoch: 9, Steps: 208 | Train Loss: 2.268 Vali Loss: 5.622 Vali Acc: 0.101 Test Loss: 5.622 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5905538
	speed: 0.3331s/iter; left time: 6271.3107s
	iters: 200, epoch: 10 | loss: 1.6485409
	speed: 0.1297s/iter; left time: 2429.0613s
Epoch: 10 cost time: 27.78124451637268
Epoch: 10, Steps: 208 | Train Loss: 1.801 Vali Loss: 5.737 Vali Acc: 0.134 Test Loss: 5.737 Test Acc: 0.134
Validation loss decreased (-0.122534 --> -0.133853).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8698293
	speed: 0.2965s/iter; left time: 5521.2553s
	iters: 200, epoch: 11 | loss: 1.6727216
	speed: 0.1102s/iter; left time: 2041.7506s
Epoch: 11 cost time: 22.529644012451172
Epoch: 11, Steps: 208 | Train Loss: 1.442 Vali Loss: 6.126 Vali Acc: 0.129 Test Loss: 6.126 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0888453
	speed: 0.3262s/iter; left time: 6006.7742s
	iters: 200, epoch: 12 | loss: 1.0290961
	speed: 0.1147s/iter; left time: 2100.3225s
Epoch: 12 cost time: 25.177645444869995
Epoch: 12, Steps: 208 | Train Loss: 1.124 Vali Loss: 6.207 Vali Acc: 0.124 Test Loss: 6.207 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8902031
	speed: 0.3144s/iter; left time: 5723.9211s
	iters: 200, epoch: 13 | loss: 1.2911152
	speed: 0.1172s/iter; left time: 2121.2245s
Epoch: 13 cost time: 25.427388429641724
Epoch: 13, Steps: 208 | Train Loss: 0.942 Vali Loss: 6.273 Vali Acc: 0.129 Test Loss: 6.273 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9756374
	speed: 0.3772s/iter; left time: 6788.7809s
	iters: 200, epoch: 14 | loss: 0.8531835
	speed: 0.1718s/iter; left time: 3075.2522s
Epoch: 14 cost time: 36.33803749084473
Epoch: 14, Steps: 208 | Train Loss: 0.757 Vali Loss: 6.910 Vali Acc: 0.135 Test Loss: 6.910 Test Acc: 0.135
Validation loss decreased (-0.133853 --> -0.134437).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6843483
	speed: 0.4112s/iter; left time: 7315.4185s
	iters: 200, epoch: 15 | loss: 0.5689740
	speed: 0.1429s/iter; left time: 2528.3980s
Epoch: 15 cost time: 33.009894132614136
Epoch: 15, Steps: 208 | Train Loss: 0.613 Vali Loss: 7.519 Vali Acc: 0.134 Test Loss: 7.519 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7314960
	speed: 0.3438s/iter; left time: 6044.1926s
	iters: 200, epoch: 16 | loss: 0.2860280
	speed: 0.1432s/iter; left time: 2503.5462s
Epoch: 16 cost time: 30.666163682937622
Epoch: 16, Steps: 208 | Train Loss: 0.515 Vali Loss: 7.996 Vali Acc: 0.137 Test Loss: 7.996 Test Acc: 0.137
Validation loss decreased (-0.134437 --> -0.136812).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0262826
	speed: 0.3511s/iter; left time: 6099.6708s
	iters: 200, epoch: 17 | loss: 0.5907117
	speed: 0.1083s/iter; left time: 1870.6246s
Epoch: 17 cost time: 25.895849466323853
Epoch: 17, Steps: 208 | Train Loss: 0.450 Vali Loss: 8.694 Vali Acc: 0.135 Test Loss: 8.694 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5130522
	speed: 0.4238s/iter; left time: 7274.0993s
	iters: 200, epoch: 18 | loss: 0.4939782
	speed: 0.1903s/iter; left time: 3246.8182s
Epoch: 18 cost time: 40.48963451385498
Epoch: 18, Steps: 208 | Train Loss: 0.414 Vali Loss: 9.236 Vali Acc: 0.126 Test Loss: 9.236 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.7667348
	speed: 0.3980s/iter; left time: 6749.0246s
	iters: 200, epoch: 19 | loss: 0.1242710
	speed: 0.1754s/iter; left time: 2955.8987s
Epoch: 19 cost time: 36.11376762390137
Epoch: 19, Steps: 208 | Train Loss: 0.337 Vali Loss: 9.222 Vali Acc: 0.130 Test Loss: 9.222 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1573355
	speed: 0.3935s/iter; left time: 6590.5989s
	iters: 200, epoch: 20 | loss: 0.2397245
	speed: 0.1747s/iter; left time: 2909.0766s
Epoch: 20 cost time: 36.16850757598877
Epoch: 20, Steps: 208 | Train Loss: 0.304 Vali Loss: 9.327 Vali Acc: 0.123 Test Loss: 9.327 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1518016
	speed: 0.3866s/iter; left time: 6395.0863s
	iters: 200, epoch: 21 | loss: 0.2590069
	speed: 0.1715s/iter; left time: 2818.9724s
Epoch: 21 cost time: 35.608901500701904
Epoch: 21, Steps: 208 | Train Loss: 0.278 Vali Loss: 10.542 Vali Acc: 0.132 Test Loss: 10.542 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3376827
	speed: 0.3743s/iter; left time: 6113.1516s
	iters: 200, epoch: 22 | loss: 0.1366823
	speed: 0.1568s/iter; left time: 2545.9747s
Epoch: 22 cost time: 32.47385787963867
Epoch: 22, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.481 Vali Acc: 0.134 Test Loss: 10.481 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0866893
	speed: 0.3823s/iter; left time: 6165.3601s
	iters: 200, epoch: 23 | loss: 0.0349531
	speed: 0.1815s/iter; left time: 2908.1695s
Epoch: 23 cost time: 35.554624795913696
Epoch: 23, Steps: 208 | Train Loss: 0.220 Vali Loss: 10.155 Vali Acc: 0.139 Test Loss: 10.155 Test Acc: 0.139
Validation loss decreased (-0.136812 --> -0.139177).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1485537
	speed: 0.4185s/iter; left time: 6661.1644s
	iters: 200, epoch: 24 | loss: 0.0037624
	speed: 0.1604s/iter; left time: 2537.4640s
Epoch: 24 cost time: 35.82226252555847
Epoch: 24, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.945 Vali Acc: 0.133 Test Loss: 10.945 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0147384
	speed: 0.4097s/iter; left time: 6435.8690s
	iters: 200, epoch: 25 | loss: 0.0118104
	speed: 0.1640s/iter; left time: 2560.0925s
Epoch: 25 cost time: 35.570109605789185
Epoch: 25, Steps: 208 | Train Loss: 0.215 Vali Loss: 10.953 Vali Acc: 0.119 Test Loss: 10.953 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0268887
	speed: 0.3801s/iter; left time: 5892.6185s
	iters: 200, epoch: 26 | loss: 0.1829454
	speed: 0.1666s/iter; left time: 2566.0018s
Epoch: 26 cost time: 33.76963829994202
Epoch: 26, Steps: 208 | Train Loss: 0.176 Vali Loss: 11.570 Vali Acc: 0.137 Test Loss: 11.570 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1964012
	speed: 0.4012s/iter; left time: 6134.8146s
	iters: 200, epoch: 27 | loss: 0.0279453
	speed: 0.1518s/iter; left time: 2307.0308s
Epoch: 27 cost time: 33.71348834037781
Epoch: 27, Steps: 208 | Train Loss: 0.179 Vali Loss: 11.074 Vali Acc: 0.129 Test Loss: 11.074 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.1983140
	speed: 0.3515s/iter; left time: 5302.7594s
	iters: 200, epoch: 28 | loss: 0.0462501
	speed: 0.1366s/iter; left time: 2047.4702s
Epoch: 28 cost time: 29.61850333213806
Epoch: 28, Steps: 208 | Train Loss: 0.157 Vali Loss: 12.012 Vali Acc: 0.140 Test Loss: 12.012 Test Acc: 0.140
Validation loss decreased (-0.139177 --> -0.139755).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0141862
	speed: 0.3561s/iter; left time: 5297.3926s
	iters: 200, epoch: 29 | loss: 0.0461319
	speed: 0.1097s/iter; left time: 1621.5973s
Epoch: 29 cost time: 26.221193313598633
Epoch: 29, Steps: 208 | Train Loss: 0.181 Vali Loss: 12.020 Vali Acc: 0.135 Test Loss: 12.020 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.1806867
	speed: 0.3043s/iter; left time: 4463.6541s
	iters: 200, epoch: 30 | loss: 0.5853977
	speed: 0.1242s/iter; left time: 1809.6023s
Epoch: 30 cost time: 25.24293303489685
Epoch: 30, Steps: 208 | Train Loss: 0.185 Vali Loss: 11.894 Vali Acc: 0.124 Test Loss: 11.894 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0979383
	speed: 0.3134s/iter; left time: 4531.8979s
	iters: 200, epoch: 31 | loss: 0.4594836
	speed: 0.1089s/iter; left time: 1564.3120s
Epoch: 31 cost time: 23.741872310638428
Epoch: 31, Steps: 208 | Train Loss: 0.184 Vali Loss: 12.759 Vali Acc: 0.124 Test Loss: 12.759 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0172557
	speed: 0.3063s/iter; left time: 4365.6638s
	iters: 200, epoch: 32 | loss: 0.9500508
	speed: 0.1461s/iter; left time: 2067.5492s
Epoch: 32 cost time: 28.19735288619995
Epoch: 32, Steps: 208 | Train Loss: 0.163 Vali Loss: 11.951 Vali Acc: 0.129 Test Loss: 11.951 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.1519553
	speed: 0.3497s/iter; left time: 4911.1468s
	iters: 200, epoch: 33 | loss: 0.1646573
	speed: 0.1186s/iter; left time: 1654.4968s
Epoch: 33 cost time: 26.6753249168396
Epoch: 33, Steps: 208 | Train Loss: 0.159 Vali Loss: 13.239 Vali Acc: 0.133 Test Loss: 13.239 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0171170
	speed: 0.3132s/iter; left time: 4333.0621s
	iters: 200, epoch: 34 | loss: 0.0189022
	speed: 0.1082s/iter; left time: 1486.1580s
Epoch: 34 cost time: 22.893806219100952
Epoch: 34, Steps: 208 | Train Loss: 0.135 Vali Loss: 13.665 Vali Acc: 0.136 Test Loss: 13.665 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0116209
	speed: 0.3481s/iter; left time: 4744.0677s
	iters: 200, epoch: 35 | loss: 0.0496212
	speed: 0.1515s/iter; left time: 2049.3154s
Epoch: 35 cost time: 31.661879539489746
Epoch: 35, Steps: 208 | Train Loss: 0.145 Vali Loss: 12.848 Vali Acc: 0.128 Test Loss: 12.848 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0173315
	speed: 0.3524s/iter; left time: 4729.1648s
	iters: 200, epoch: 36 | loss: 0.1094347
	speed: 0.1385s/iter; left time: 1845.5035s
Epoch: 36 cost time: 29.75585627555847
Epoch: 36, Steps: 208 | Train Loss: 0.124 Vali Loss: 13.293 Vali Acc: 0.134 Test Loss: 13.293 Test Acc: 0.134
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0123230
	speed: 0.3378s/iter; left time: 4463.1923s
	iters: 200, epoch: 37 | loss: 0.0131422
	speed: 0.1389s/iter; left time: 1821.0198s
Epoch: 37 cost time: 28.75350284576416
Epoch: 37, Steps: 208 | Train Loss: 0.106 Vali Loss: 13.950 Vali Acc: 0.125 Test Loss: 13.950 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0071741
	speed: 0.3435s/iter; left time: 4467.0065s
	iters: 200, epoch: 38 | loss: 0.0449060
	speed: 0.1324s/iter; left time: 1708.1706s
Epoch: 38 cost time: 29.151633262634277
Epoch: 38, Steps: 208 | Train Loss: 0.120 Vali Loss: 13.724 Vali Acc: 0.122 Test Loss: 13.724 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13987473903966596
model parameter : 1139239
model size : 5.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7850435
	speed: 0.1363s/iter; left time: 2821.4700s
	iters: 200, epoch: 1 | loss: 4.2237611
	speed: 0.1223s/iter; left time: 2520.3333s
Epoch: 1 cost time: 26.77047634124756
Epoch: 1, Steps: 208 | Train Loss: 4.066 Vali Loss: 3.735 Vali Acc: 0.060 Test Loss: 3.735 Test Acc: 0.060
Validation loss decreased (inf --> -0.059611).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1440015
	speed: 0.3119s/iter; left time: 6391.1276s
	iters: 200, epoch: 2 | loss: 3.4981422
	speed: 0.1452s/iter; left time: 2960.0614s
Epoch: 2 cost time: 29.13235068321228
Epoch: 2, Steps: 208 | Train Loss: 3.331 Vali Loss: 4.430 Vali Acc: 0.063 Test Loss: 4.430 Test Acc: 0.063
Validation loss decreased (-0.059611 --> -0.063183).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1831515
	speed: 0.3345s/iter; left time: 6785.9076s
	iters: 200, epoch: 3 | loss: 3.5170965
	speed: 0.1273s/iter; left time: 2568.8352s
Epoch: 3 cost time: 28.024365186691284
Epoch: 3, Steps: 208 | Train Loss: 3.242 Vali Loss: 3.696 Vali Acc: 0.099 Test Loss: 3.696 Test Acc: 0.099
Validation loss decreased (-0.063183 --> -0.099277).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8343554
	speed: 0.3182s/iter; left time: 6387.5614s
	iters: 200, epoch: 4 | loss: 3.6875067
	speed: 0.1351s/iter; left time: 2698.6858s
Epoch: 4 cost time: 28.561885833740234
Epoch: 4, Steps: 208 | Train Loss: 3.266 Vali Loss: 3.967 Vali Acc: 0.092 Test Loss: 3.967 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2256377
	speed: 0.2817s/iter; left time: 5596.2657s
	iters: 200, epoch: 5 | loss: 3.6054792
	speed: 0.1312s/iter; left time: 2592.9112s
Epoch: 5 cost time: 24.85921812057495
Epoch: 5, Steps: 208 | Train Loss: 3.180 Vali Loss: 4.199 Vali Acc: 0.110 Test Loss: 4.199 Test Acc: 0.110
Validation loss decreased (-0.099277 --> -0.110307).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5282547
	speed: 0.3238s/iter; left time: 6365.2691s
	iters: 200, epoch: 6 | loss: 4.9712391
	speed: 0.1004s/iter; left time: 1964.0644s
Epoch: 6 cost time: 25.37686252593994
Epoch: 6, Steps: 208 | Train Loss: 3.099 Vali Loss: 4.331 Vali Acc: 0.128 Test Loss: 4.331 Test Acc: 0.128
Validation loss decreased (-0.110307 --> -0.127604).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2849419
	speed: 0.2707s/iter; left time: 5266.5915s
	iters: 200, epoch: 7 | loss: 2.5610998
	speed: 0.1038s/iter; left time: 2009.4341s
Epoch: 7 cost time: 21.155865907669067
Epoch: 7, Steps: 208 | Train Loss: 2.879 Vali Loss: 4.430 Vali Acc: 0.128 Test Loss: 4.430 Test Acc: 0.128
Validation loss decreased (-0.127604 --> -0.127901).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7232714
	speed: 0.2659s/iter; left time: 5117.2123s
	iters: 200, epoch: 8 | loss: 3.0393987
	speed: 0.1040s/iter; left time: 1990.4023s
Epoch: 8 cost time: 21.494163990020752
Epoch: 8, Steps: 208 | Train Loss: 2.567 Vali Loss: 4.788 Vali Acc: 0.124 Test Loss: 4.788 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.0090730
	speed: 0.2572s/iter; left time: 4897.1047s
	iters: 200, epoch: 9 | loss: 1.9673364
	speed: 0.0946s/iter; left time: 1790.9702s
Epoch: 9 cost time: 19.660159587860107
Epoch: 9, Steps: 208 | Train Loss: 2.187 Vali Loss: 5.196 Vali Acc: 0.129 Test Loss: 5.196 Test Acc: 0.129
Validation loss decreased (-0.127901 --> -0.129086).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5850879
	speed: 0.2656s/iter; left time: 5000.7901s
	iters: 200, epoch: 10 | loss: 1.5291587
	speed: 0.0996s/iter; left time: 1864.6017s
Epoch: 10 cost time: 20.6886146068573
Epoch: 10, Steps: 208 | Train Loss: 1.846 Vali Loss: 6.045 Vali Acc: 0.134 Test Loss: 6.045 Test Acc: 0.134
Validation loss decreased (-0.129086 --> -0.133849).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4952786
	speed: 0.2834s/iter; left time: 5277.9666s
	iters: 200, epoch: 11 | loss: 1.3416007
	speed: 0.0895s/iter; left time: 1657.3165s
Epoch: 11 cost time: 20.941601514816284
Epoch: 11, Steps: 208 | Train Loss: 1.497 Vali Loss: 5.050 Vali Acc: 0.125 Test Loss: 5.050 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7325529
	speed: 0.2814s/iter; left time: 5181.2789s
	iters: 200, epoch: 12 | loss: 1.4121614
	speed: 0.1040s/iter; left time: 1904.7346s
Epoch: 12 cost time: 22.979191064834595
Epoch: 12, Steps: 208 | Train Loss: 1.205 Vali Loss: 5.762 Vali Acc: 0.142 Test Loss: 5.762 Test Acc: 0.142
Validation loss decreased (-0.133849 --> -0.142203).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6395226
	speed: 0.2879s/iter; left time: 5241.6158s
	iters: 200, epoch: 13 | loss: 1.1919723
	speed: 0.0890s/iter; left time: 1610.6376s
Epoch: 13 cost time: 20.466728687286377
Epoch: 13, Steps: 208 | Train Loss: 1.014 Vali Loss: 6.460 Vali Acc: 0.144 Test Loss: 6.460 Test Acc: 0.144
Validation loss decreased (-0.142203 --> -0.143986).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7499947
	speed: 0.3146s/iter; left time: 5661.3456s
	iters: 200, epoch: 14 | loss: 1.2276410
	speed: 0.1266s/iter; left time: 2266.3864s
Epoch: 14 cost time: 27.284120559692383
Epoch: 14, Steps: 208 | Train Loss: 0.843 Vali Loss: 6.550 Vali Acc: 0.145 Test Loss: 6.550 Test Acc: 0.145
Validation loss decreased (-0.143986 --> -0.144581).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6135360
	speed: 0.3028s/iter; left time: 5386.6012s
	iters: 200, epoch: 15 | loss: 0.3876558
	speed: 0.1245s/iter; left time: 2202.1883s
Epoch: 15 cost time: 26.03883957862854
Epoch: 15, Steps: 208 | Train Loss: 0.704 Vali Loss: 6.849 Vali Acc: 0.133 Test Loss: 6.849 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1222370
	speed: 0.2993s/iter; left time: 5261.7231s
	iters: 200, epoch: 16 | loss: 1.3069733
	speed: 0.1207s/iter; left time: 2109.3795s
Epoch: 16 cost time: 25.586122751235962
Epoch: 16, Steps: 208 | Train Loss: 0.558 Vali Loss: 7.164 Vali Acc: 0.131 Test Loss: 7.164 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7720004
	speed: 0.3098s/iter; left time: 5381.5869s
	iters: 200, epoch: 17 | loss: 0.3974946
	speed: 0.1222s/iter; left time: 2110.1592s
Epoch: 17 cost time: 26.762371063232422
Epoch: 17, Steps: 208 | Train Loss: 0.469 Vali Loss: 7.935 Vali Acc: 0.131 Test Loss: 7.935 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2963441
	speed: 0.3076s/iter; left time: 5279.1948s
	iters: 200, epoch: 18 | loss: 0.3327712
	speed: 0.1306s/iter; left time: 2228.8151s
Epoch: 18 cost time: 27.937953233718872
Epoch: 18, Steps: 208 | Train Loss: 0.419 Vali Loss: 8.564 Vali Acc: 0.141 Test Loss: 8.564 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3249505
	speed: 0.2933s/iter; left time: 4972.9380s
	iters: 200, epoch: 19 | loss: 0.4325985
	speed: 0.1261s/iter; left time: 2125.5685s
Epoch: 19 cost time: 26.272733688354492
Epoch: 19, Steps: 208 | Train Loss: 0.406 Vali Loss: 8.377 Vali Acc: 0.131 Test Loss: 8.377 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2460979
	speed: 0.2896s/iter; left time: 4850.3190s
	iters: 200, epoch: 20 | loss: 0.3514132
	speed: 0.1253s/iter; left time: 2086.6656s
Epoch: 20 cost time: 26.154739141464233
Epoch: 20, Steps: 208 | Train Loss: 0.347 Vali Loss: 8.699 Vali Acc: 0.141 Test Loss: 8.699 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.5058977
	speed: 0.2990s/iter; left time: 4946.2427s
	iters: 200, epoch: 21 | loss: 0.3667190
	speed: 0.1238s/iter; left time: 2035.7285s
Epoch: 21 cost time: 26.28494429588318
Epoch: 21, Steps: 208 | Train Loss: 0.292 Vali Loss: 9.707 Vali Acc: 0.129 Test Loss: 9.707 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2435100
	speed: 0.3226s/iter; left time: 5269.0318s
	iters: 200, epoch: 22 | loss: 0.4062345
	speed: 0.1146s/iter; left time: 1860.3786s
Epoch: 22 cost time: 26.615318059921265
Epoch: 22, Steps: 208 | Train Loss: 0.283 Vali Loss: 9.786 Vali Acc: 0.137 Test Loss: 9.786 Test Acc: 0.137
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1297106
	speed: 0.2912s/iter; left time: 4694.9012s
	iters: 200, epoch: 23 | loss: 0.2824750
	speed: 0.1232s/iter; left time: 1973.5538s
Epoch: 23 cost time: 25.935619592666626
Epoch: 23, Steps: 208 | Train Loss: 0.277 Vali Loss: 10.743 Vali Acc: 0.139 Test Loss: 10.743 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1309038
	speed: 0.3005s/iter; left time: 4782.9417s
	iters: 200, epoch: 24 | loss: 0.1675170
	speed: 0.0841s/iter; left time: 1330.6526s
Epoch: 24 cost time: 21.889676570892334
Epoch: 24, Steps: 208 | Train Loss: 0.246 Vali Loss: 10.666 Vali Acc: 0.136 Test Loss: 10.666 Test Acc: 0.136
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.144646585147629
model parameter : 810151
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0517864
	speed: 0.1100s/iter; left time: 2276.4677s
	iters: 200, epoch: 1 | loss: 3.5910113
	speed: 0.0846s/iter; left time: 1743.8486s
Epoch: 1 cost time: 20.234909772872925
Epoch: 1, Steps: 208 | Train Loss: 4.034 Vali Loss: 3.893 Vali Acc: 0.072 Test Loss: 3.893 Test Acc: 0.072
Validation loss decreased (inf --> -0.071539).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9649093
	speed: 0.2526s/iter; left time: 5175.5664s
	iters: 200, epoch: 2 | loss: 3.7111773
	speed: 0.1209s/iter; left time: 2464.9007s
Epoch: 2 cost time: 23.761356353759766
Epoch: 2, Steps: 208 | Train Loss: 3.364 Vali Loss: 4.025 Vali Acc: 0.057 Test Loss: 4.025 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5143619
	speed: 0.2950s/iter; left time: 5984.8567s
	iters: 200, epoch: 3 | loss: 3.9075713
	speed: 0.1213s/iter; left time: 2448.1913s
Epoch: 3 cost time: 24.46598529815674
Epoch: 3, Steps: 208 | Train Loss: 3.206 Vali Loss: 4.263 Vali Acc: 0.074 Test Loss: 4.263 Test Acc: 0.074
Validation loss decreased (-0.071539 --> -0.073623).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6738441
	speed: 0.3086s/iter; left time: 6196.6771s
	iters: 200, epoch: 4 | loss: 4.9523001
	speed: 0.1073s/iter; left time: 2144.1194s
Epoch: 4 cost time: 24.843209505081177
Epoch: 4, Steps: 208 | Train Loss: 3.146 Vali Loss: 4.173 Vali Acc: 0.096 Test Loss: 4.173 Test Acc: 0.096
Validation loss decreased (-0.073623 --> -0.095693).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2900593
	speed: 0.3055s/iter; left time: 6069.7567s
	iters: 200, epoch: 5 | loss: 3.1704562
	speed: 0.1129s/iter; left time: 2232.5749s
Epoch: 5 cost time: 25.276248455047607
Epoch: 5, Steps: 208 | Train Loss: 3.103 Vali Loss: 4.780 Vali Acc: 0.100 Test Loss: 4.780 Test Acc: 0.100
Validation loss decreased (-0.095693 --> -0.100161).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1439879
	speed: 0.2884s/iter; left time: 5670.5032s
	iters: 200, epoch: 6 | loss: 2.8516855
	speed: 0.1166s/iter; left time: 2279.9812s
Epoch: 6 cost time: 24.336166381835938
Epoch: 6, Steps: 208 | Train Loss: 2.979 Vali Loss: 4.522 Vali Acc: 0.106 Test Loss: 4.522 Test Acc: 0.106
Validation loss decreased (-0.100161 --> -0.106128).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7857618
	speed: 0.3267s/iter; left time: 6354.7250s
	iters: 200, epoch: 7 | loss: 2.5909162
	speed: 0.1341s/iter; left time: 2596.1956s
Epoch: 7 cost time: 30.018502950668335
Epoch: 7, Steps: 208 | Train Loss: 2.761 Vali Loss: 4.735 Vali Acc: 0.101 Test Loss: 4.735 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5317600
	speed: 0.3493s/iter; left time: 6722.9068s
	iters: 200, epoch: 8 | loss: 2.2791924
	speed: 0.1483s/iter; left time: 2839.3602s
Epoch: 8 cost time: 31.804043531417847
Epoch: 8, Steps: 208 | Train Loss: 2.371 Vali Loss: 4.816 Vali Acc: 0.123 Test Loss: 4.816 Test Acc: 0.123
Validation loss decreased (-0.106128 --> -0.122827).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7681339
	speed: 0.3297s/iter; left time: 6275.5902s
	iters: 200, epoch: 9 | loss: 3.2110054
	speed: 0.1493s/iter; left time: 2827.1985s
Epoch: 9 cost time: 30.559125900268555
Epoch: 9, Steps: 208 | Train Loss: 2.134 Vali Loss: 4.584 Vali Acc: 0.134 Test Loss: 4.584 Test Acc: 0.134
Validation loss decreased (-0.122827 --> -0.133566).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1769841
	speed: 0.3408s/iter; left time: 6417.4236s
	iters: 200, epoch: 10 | loss: 1.9459342
	speed: 0.1397s/iter; left time: 2616.2517s
Epoch: 10 cost time: 30.683249711990356
Epoch: 10, Steps: 208 | Train Loss: 1.760 Vali Loss: 5.236 Vali Acc: 0.137 Test Loss: 5.236 Test Acc: 0.137
Validation loss decreased (-0.133566 --> -0.136542).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1827202
	speed: 0.3349s/iter; left time: 6235.7891s
	iters: 200, epoch: 11 | loss: 2.1671112
	speed: 0.1426s/iter; left time: 2641.1567s
Epoch: 11 cost time: 30.078516483306885
Epoch: 11, Steps: 208 | Train Loss: 1.497 Vali Loss: 5.418 Vali Acc: 0.131 Test Loss: 5.418 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8490265
	speed: 0.3317s/iter; left time: 6107.8526s
	iters: 200, epoch: 12 | loss: 1.3580782
	speed: 0.1434s/iter; left time: 2626.5613s
Epoch: 12 cost time: 30.018725156784058
Epoch: 12, Steps: 208 | Train Loss: 1.276 Vali Loss: 6.701 Vali Acc: 0.130 Test Loss: 6.701 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2494987
	speed: 0.3345s/iter; left time: 6090.3287s
	iters: 200, epoch: 13 | loss: 1.2714477
	speed: 0.1228s/iter; left time: 2222.8971s
Epoch: 13 cost time: 28.695321559906006
Epoch: 13, Steps: 208 | Train Loss: 1.039 Vali Loss: 6.600 Vali Acc: 0.128 Test Loss: 6.600 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9589529
	speed: 0.3030s/iter; left time: 5452.5334s
	iters: 200, epoch: 14 | loss: 1.3942434
	speed: 0.1359s/iter; left time: 2432.1734s
Epoch: 14 cost time: 28.281898975372314
Epoch: 14, Steps: 208 | Train Loss: 0.885 Vali Loss: 6.683 Vali Acc: 0.137 Test Loss: 6.683 Test Acc: 0.137
Validation loss decreased (-0.136542 --> -0.137124).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6065069
	speed: 0.3060s/iter; left time: 5442.7855s
	iters: 200, epoch: 15 | loss: 0.4779661
	speed: 0.1385s/iter; left time: 2450.8014s
Epoch: 15 cost time: 29.13083243370056
Epoch: 15, Steps: 208 | Train Loss: 0.738 Vali Loss: 7.801 Vali Acc: 0.137 Test Loss: 7.801 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5100672
	speed: 0.3042s/iter; left time: 5347.5781s
	iters: 200, epoch: 16 | loss: 0.3800325
	speed: 0.1205s/iter; left time: 2106.5034s
Epoch: 16 cost time: 26.458149671554565
Epoch: 16, Steps: 208 | Train Loss: 0.636 Vali Loss: 7.322 Vali Acc: 0.131 Test Loss: 7.322 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1726540
	speed: 0.2877s/iter; left time: 4997.6066s
	iters: 200, epoch: 17 | loss: 0.2025014
	speed: 0.1302s/iter; left time: 2248.3082s
Epoch: 17 cost time: 26.715715408325195
Epoch: 17, Steps: 208 | Train Loss: 0.545 Vali Loss: 7.781 Vali Acc: 0.137 Test Loss: 7.781 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3686863
	speed: 0.2785s/iter; left time: 4780.8301s
	iters: 200, epoch: 18 | loss: 1.2182509
	speed: 0.1026s/iter; left time: 1751.1054s
Epoch: 18 cost time: 22.137646436691284
Epoch: 18, Steps: 208 | Train Loss: 0.468 Vali Loss: 8.568 Vali Acc: 0.132 Test Loss: 8.568 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2232076
	speed: 0.2562s/iter; left time: 4345.1151s
	iters: 200, epoch: 19 | loss: 0.7964518
	speed: 0.0990s/iter; left time: 1669.0490s
Epoch: 19 cost time: 20.421376943588257
Epoch: 19, Steps: 208 | Train Loss: 0.401 Vali Loss: 8.178 Vali Acc: 0.129 Test Loss: 8.178 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0567912
	speed: 0.2610s/iter; left time: 4371.3880s
	iters: 200, epoch: 20 | loss: 0.2805443
	speed: 0.0817s/iter; left time: 1360.7641s
Epoch: 20 cost time: 19.241228103637695
Epoch: 20, Steps: 208 | Train Loss: 0.371 Vali Loss: 9.099 Vali Acc: 0.135 Test Loss: 9.099 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.3269421
	speed: 0.2371s/iter; left time: 3921.9347s
	iters: 200, epoch: 21 | loss: 0.1615345
	speed: 0.1018s/iter; left time: 1673.2411s
Epoch: 21 cost time: 20.270132780075073
Epoch: 21, Steps: 208 | Train Loss: 0.348 Vali Loss: 9.660 Vali Acc: 0.136 Test Loss: 9.660 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3033425
	speed: 0.2531s/iter; left time: 4133.1765s
	iters: 200, epoch: 22 | loss: 0.2383460
	speed: 0.0858s/iter; left time: 1392.6707s
Epoch: 22 cost time: 19.205325603485107
Epoch: 22, Steps: 208 | Train Loss: 0.327 Vali Loss: 10.768 Vali Acc: 0.135 Test Loss: 10.768 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1355440
	speed: 0.2711s/iter; left time: 4370.7196s
	iters: 200, epoch: 23 | loss: 0.4931323
	speed: 0.0971s/iter; left time: 1556.5024s
Epoch: 23 cost time: 22.1613712310791
Epoch: 23, Steps: 208 | Train Loss: 0.331 Vali Loss: 9.744 Vali Acc: 0.125 Test Loss: 9.744 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2519517
	speed: 0.2416s/iter; left time: 3844.8172s
	iters: 200, epoch: 24 | loss: 0.8563756
	speed: 0.0934s/iter; left time: 1476.5475s
Epoch: 24 cost time: 19.438525676727295
Epoch: 24, Steps: 208 | Train Loss: 0.251 Vali Loss: 10.365 Vali Acc: 0.132 Test Loss: 10.365 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13719057560393677
model parameter : 673191
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3285992
	speed: 0.1071s/iter; left time: 2217.2943s
	iters: 200, epoch: 1 | loss: 4.2626667
	speed: 0.0943s/iter; left time: 1943.1257s
Epoch: 1 cost time: 20.98660159111023
Epoch: 1, Steps: 208 | Train Loss: 3.915 Vali Loss: 3.979 Vali Acc: 0.061 Test Loss: 3.979 Test Acc: 0.061
Validation loss decreased (inf --> -0.061099).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5752316
	speed: 0.2572s/iter; left time: 5269.8519s
	iters: 200, epoch: 2 | loss: 3.3745410
	speed: 0.1161s/iter; left time: 2368.6457s
Epoch: 2 cost time: 24.4262478351593
Epoch: 2, Steps: 208 | Train Loss: 3.508 Vali Loss: 3.656 Vali Acc: 0.077 Test Loss: 3.656 Test Acc: 0.077
Validation loss decreased (-0.061099 --> -0.077208).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2554166
	speed: 0.2596s/iter; left time: 5265.4395s
	iters: 200, epoch: 3 | loss: 3.2518072
	speed: 0.1114s/iter; left time: 2248.6689s
Epoch: 3 cost time: 23.975521087646484
Epoch: 3, Steps: 208 | Train Loss: 3.201 Vali Loss: 3.695 Vali Acc: 0.095 Test Loss: 3.695 Test Acc: 0.095
Validation loss decreased (-0.077208 --> -0.095102).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8109908
	speed: 0.2613s/iter; left time: 5246.9553s
	iters: 200, epoch: 4 | loss: 3.3581805
	speed: 0.1182s/iter; left time: 2360.8505s
Epoch: 4 cost time: 25.22615909576416
Epoch: 4, Steps: 208 | Train Loss: 3.059 Vali Loss: 3.792 Vali Acc: 0.082 Test Loss: 3.792 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.6330402
	speed: 0.2683s/iter; left time: 5330.3540s
	iters: 200, epoch: 5 | loss: 3.4138443
	speed: 0.1119s/iter; left time: 2212.5912s
Epoch: 5 cost time: 24.07489776611328
Epoch: 5, Steps: 208 | Train Loss: 2.971 Vali Loss: 4.249 Vali Acc: 0.100 Test Loss: 4.249 Test Acc: 0.100
Validation loss decreased (-0.095102 --> -0.099570).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7547760
	speed: 0.2580s/iter; left time: 5073.1886s
	iters: 200, epoch: 6 | loss: 2.8728731
	speed: 0.1061s/iter; left time: 2076.1838s
Epoch: 6 cost time: 23.225804090499878
Epoch: 6, Steps: 208 | Train Loss: 2.797 Vali Loss: 4.618 Vali Acc: 0.102 Test Loss: 4.618 Test Acc: 0.102
Validation loss decreased (-0.099570 --> -0.101654).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6697791
	speed: 0.2572s/iter; left time: 5003.8162s
	iters: 200, epoch: 7 | loss: 2.0015767
	speed: 0.1098s/iter; left time: 2124.6605s
Epoch: 7 cost time: 23.156970977783203
Epoch: 7, Steps: 208 | Train Loss: 2.568 Vali Loss: 4.404 Vali Acc: 0.116 Test Loss: 4.404 Test Acc: 0.116
Validation loss decreased (-0.101654 --> -0.115971).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2846787
	speed: 0.2636s/iter; left time: 5073.9117s
	iters: 200, epoch: 8 | loss: 1.6752102
	speed: 0.1000s/iter; left time: 1913.7870s
Epoch: 8 cost time: 22.377931833267212
Epoch: 8, Steps: 208 | Train Loss: 2.265 Vali Loss: 4.833 Vali Acc: 0.110 Test Loss: 4.833 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.4932103
	speed: 0.2577s/iter; left time: 4905.1183s
	iters: 200, epoch: 9 | loss: 1.7487664
	speed: 0.1044s/iter; left time: 1977.7419s
Epoch: 9 cost time: 22.684307098388672
Epoch: 9, Steps: 208 | Train Loss: 2.042 Vali Loss: 5.223 Vali Acc: 0.120 Test Loss: 5.223 Test Acc: 0.120
Validation loss decreased (-0.115971 --> -0.120139).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4333332
	speed: 0.2572s/iter; left time: 4842.1051s
	iters: 200, epoch: 10 | loss: 2.1480713
	speed: 0.1155s/iter; left time: 2162.4012s
Epoch: 10 cost time: 24.332382440567017
Epoch: 10, Steps: 208 | Train Loss: 1.715 Vali Loss: 5.641 Vali Acc: 0.124 Test Loss: 5.641 Test Acc: 0.124
Validation loss decreased (-0.120139 --> -0.124310).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6176783
	speed: 0.2669s/iter; left time: 4970.6345s
	iters: 200, epoch: 11 | loss: 1.1849530
	speed: 0.1240s/iter; left time: 2296.1889s
Epoch: 11 cost time: 25.433498859405518
Epoch: 11, Steps: 208 | Train Loss: 1.407 Vali Loss: 5.567 Vali Acc: 0.107 Test Loss: 5.567 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1686900
	speed: 0.2791s/iter; left time: 5138.4102s
	iters: 200, epoch: 12 | loss: 1.3745573
	speed: 0.0975s/iter; left time: 1786.0516s
Epoch: 12 cost time: 22.934407234191895
Epoch: 12, Steps: 208 | Train Loss: 1.194 Vali Loss: 6.016 Vali Acc: 0.121 Test Loss: 6.016 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5428882
	speed: 0.2350s/iter; left time: 4277.4238s
	iters: 200, epoch: 13 | loss: 1.1032032
	speed: 0.0794s/iter; left time: 1437.7056s
Epoch: 13 cost time: 17.80121898651123
Epoch: 13, Steps: 208 | Train Loss: 0.951 Vali Loss: 6.614 Vali Acc: 0.112 Test Loss: 6.614 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9854254
	speed: 0.2327s/iter; left time: 4187.2536s
	iters: 200, epoch: 14 | loss: 0.8112179
	speed: 0.0868s/iter; left time: 1553.7311s
Epoch: 14 cost time: 18.78243637084961
Epoch: 14, Steps: 208 | Train Loss: 0.836 Vali Loss: 7.286 Vali Acc: 0.122 Test Loss: 7.286 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.4489128
	speed: 0.2442s/iter; left time: 4343.8770s
	iters: 200, epoch: 15 | loss: 1.7807816
	speed: 0.0916s/iter; left time: 1619.5823s
Epoch: 15 cost time: 19.47718095779419
Epoch: 15, Steps: 208 | Train Loss: 0.695 Vali Loss: 6.992 Vali Acc: 0.124 Test Loss: 6.992 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4284626
	speed: 0.2315s/iter; left time: 4069.3158s
	iters: 200, epoch: 16 | loss: 0.7501113
	speed: 0.0743s/iter; left time: 1298.8148s
Epoch: 16 cost time: 16.793238162994385
Epoch: 16, Steps: 208 | Train Loss: 0.570 Vali Loss: 7.913 Vali Acc: 0.122 Test Loss: 7.913 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6121277
	speed: 0.2252s/iter; left time: 3912.1971s
	iters: 200, epoch: 17 | loss: 0.6811817
	speed: 0.0753s/iter; left time: 1300.5483s
Epoch: 17 cost time: 16.87789034843445
Epoch: 17, Steps: 208 | Train Loss: 0.515 Vali Loss: 8.381 Vali Acc: 0.125 Test Loss: 8.381 Test Acc: 0.125
Validation loss decreased (-0.124310 --> -0.125177).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.8676914
	speed: 0.2360s/iter; left time: 4051.7704s
	iters: 200, epoch: 18 | loss: 0.5751585
	speed: 0.0883s/iter; left time: 1507.4632s
Epoch: 18 cost time: 18.245773792266846
Epoch: 18, Steps: 208 | Train Loss: 0.454 Vali Loss: 8.515 Vali Acc: 0.120 Test Loss: 8.515 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5309810
	speed: 0.2404s/iter; left time: 4077.2001s
	iters: 200, epoch: 19 | loss: 0.6727854
	speed: 0.0837s/iter; left time: 1411.5172s
Epoch: 19 cost time: 18.51064443588257
Epoch: 19, Steps: 208 | Train Loss: 0.380 Vali Loss: 9.180 Vali Acc: 0.116 Test Loss: 9.180 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3526831
	speed: 0.2214s/iter; left time: 3708.5513s
	iters: 200, epoch: 20 | loss: 0.3646476
	speed: 0.0783s/iter; left time: 1303.9047s
Epoch: 20 cost time: 16.94418954849243
Epoch: 20, Steps: 208 | Train Loss: 0.387 Vali Loss: 8.990 Vali Acc: 0.131 Test Loss: 8.990 Test Acc: 0.131
Validation loss decreased (-0.125177 --> -0.130539).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1407453
	speed: 0.2555s/iter; left time: 4226.6329s
	iters: 200, epoch: 21 | loss: 0.2548518
	speed: 0.1073s/iter; left time: 1763.3168s
Epoch: 21 cost time: 23.02719020843506
Epoch: 21, Steps: 208 | Train Loss: 0.338 Vali Loss: 9.374 Vali Acc: 0.122 Test Loss: 9.374 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.3660052
	speed: 0.2703s/iter; left time: 4414.1136s
	iters: 200, epoch: 22 | loss: 0.5678062
	speed: 0.1126s/iter; left time: 1827.3851s
Epoch: 22 cost time: 24.178065538406372
Epoch: 22, Steps: 208 | Train Loss: 0.305 Vali Loss: 10.192 Vali Acc: 0.117 Test Loss: 10.192 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.6554651
	speed: 0.2580s/iter; left time: 4160.9773s
	iters: 200, epoch: 23 | loss: 0.4835795
	speed: 0.1088s/iter; left time: 1743.4840s
Epoch: 23 cost time: 23.75266933441162
Epoch: 23, Steps: 208 | Train Loss: 0.252 Vali Loss: 10.486 Vali Acc: 0.118 Test Loss: 10.486 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0769945
	speed: 0.2503s/iter; left time: 3983.6895s
	iters: 200, epoch: 24 | loss: 1.1274518
	speed: 0.1099s/iter; left time: 1737.9633s
Epoch: 24 cost time: 23.69497060775757
Epoch: 24, Steps: 208 | Train Loss: 0.283 Vali Loss: 10.406 Vali Acc: 0.129 Test Loss: 10.406 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0997660
	speed: 0.2639s/iter; left time: 4144.9705s
	iters: 200, epoch: 25 | loss: 0.3287756
	speed: 0.1116s/iter; left time: 1741.7848s
Epoch: 25 cost time: 24.478699207305908
Epoch: 25, Steps: 208 | Train Loss: 0.269 Vali Loss: 11.561 Vali Acc: 0.129 Test Loss: 11.561 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.2274436
	speed: 0.2678s/iter; left time: 4150.4453s
	iters: 200, epoch: 26 | loss: 0.3549147
	speed: 0.1247s/iter; left time: 1920.6683s
Epoch: 26 cost time: 26.418211460113525
Epoch: 26, Steps: 208 | Train Loss: 0.230 Vali Loss: 11.526 Vali Acc: 0.119 Test Loss: 11.526 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0031687
	speed: 0.2828s/iter; left time: 4324.2570s
	iters: 200, epoch: 27 | loss: 0.2023021
	speed: 0.1218s/iter; left time: 1849.9300s
Epoch: 27 cost time: 26.428607940673828
Epoch: 27, Steps: 208 | Train Loss: 0.247 Vali Loss: 11.928 Vali Acc: 0.122 Test Loss: 11.928 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1551462
	speed: 0.2734s/iter; left time: 4123.9023s
	iters: 200, epoch: 28 | loss: 0.0143953
	speed: 0.1196s/iter; left time: 1792.5391s
Epoch: 28 cost time: 25.787550687789917
Epoch: 28, Steps: 208 | Train Loss: 0.220 Vali Loss: 11.632 Vali Acc: 0.121 Test Loss: 11.632 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0097424
	speed: 0.2677s/iter; left time: 3982.1780s
	iters: 200, epoch: 29 | loss: 0.2826180
	speed: 0.1058s/iter; left time: 1563.3775s
Epoch: 29 cost time: 23.67203950881958
Epoch: 29, Steps: 208 | Train Loss: 0.216 Vali Loss: 13.009 Vali Acc: 0.118 Test Loss: 13.009 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000947
	speed: 0.2593s/iter; left time: 3804.1406s
	iters: 200, epoch: 30 | loss: 0.1055604
	speed: 0.1300s/iter; left time: 1893.7522s
Epoch: 30 cost time: 25.915143966674805
Epoch: 30, Steps: 208 | Train Loss: 0.204 Vali Loss: 11.776 Vali Acc: 0.120 Test Loss: 11.776 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1306292872054876
model parameter : 481703
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8870296
	speed: 0.0788s/iter; left time: 1631.6548s
	iters: 200, epoch: 1 | loss: 3.4524591
	speed: 0.0583s/iter; left time: 1201.8853s
Epoch: 1 cost time: 14.18187427520752
Epoch: 1, Steps: 208 | Train Loss: 3.865 Vali Loss: 3.833 Vali Acc: 0.054 Test Loss: 3.833 Test Acc: 0.054
Validation loss decreased (inf --> -0.054241).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1612215
	speed: 0.2016s/iter; left time: 4130.4802s
	iters: 200, epoch: 2 | loss: 3.4736233
	speed: 0.0534s/iter; left time: 1089.3172s
Epoch: 2 cost time: 11.702951908111572
Epoch: 2, Steps: 208 | Train Loss: 3.508 Vali Loss: 3.767 Vali Acc: 0.080 Test Loss: 3.767 Test Acc: 0.080
Validation loss decreased (-0.054241 --> -0.079891).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5814013
	speed: 0.1861s/iter; left time: 3776.0440s
	iters: 200, epoch: 3 | loss: 3.2255859
	speed: 0.0507s/iter; left time: 1023.3967s
Epoch: 3 cost time: 10.583873510360718
Epoch: 3, Steps: 208 | Train Loss: 3.207 Vali Loss: 3.661 Vali Acc: 0.089 Test Loss: 3.661 Test Acc: 0.089
Validation loss decreased (-0.079891 --> -0.088839).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4911194
	speed: 0.1998s/iter; left time: 4011.1950s
	iters: 200, epoch: 4 | loss: 4.1408772
	speed: 0.0549s/iter; left time: 1096.2056s
Epoch: 4 cost time: 11.820135116577148
Epoch: 4, Steps: 208 | Train Loss: 3.119 Vali Loss: 3.914 Vali Acc: 0.081 Test Loss: 3.914 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.1984971
	speed: 0.1920s/iter; left time: 3815.5335s
	iters: 200, epoch: 5 | loss: 2.8706732
	speed: 0.0544s/iter; left time: 1074.5427s
Epoch: 5 cost time: 11.617846488952637
Epoch: 5, Steps: 208 | Train Loss: 2.972 Vali Loss: 4.290 Vali Acc: 0.095 Test Loss: 4.290 Test Acc: 0.095
Validation loss decreased (-0.088839 --> -0.095096).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9571050
	speed: 0.1946s/iter; left time: 3826.0079s
	iters: 200, epoch: 6 | loss: 2.7534673
	speed: 0.0527s/iter; left time: 1030.9769s
Epoch: 6 cost time: 11.705036401748657
Epoch: 6, Steps: 208 | Train Loss: 2.788 Vali Loss: 4.347 Vali Acc: 0.101 Test Loss: 4.347 Test Acc: 0.101
Validation loss decreased (-0.095096 --> -0.100762).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0757785
	speed: 0.1759s/iter; left time: 3421.7253s
	iters: 200, epoch: 7 | loss: 1.9578360
	speed: 0.0449s/iter; left time: 868.8336s
Epoch: 7 cost time: 9.898741245269775
Epoch: 7, Steps: 208 | Train Loss: 2.572 Vali Loss: 4.620 Vali Acc: 0.105 Test Loss: 4.620 Test Acc: 0.105
Validation loss decreased (-0.100762 --> -0.105233).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5971122
	speed: 0.1879s/iter; left time: 3615.2238s
	iters: 200, epoch: 8 | loss: 3.0502856
	speed: 0.0527s/iter; left time: 1009.0104s
Epoch: 8 cost time: 10.995794773101807
Epoch: 8, Steps: 208 | Train Loss: 2.390 Vali Loss: 4.646 Vali Acc: 0.116 Test Loss: 4.646 Test Acc: 0.116
Validation loss decreased (-0.105233 --> -0.115671).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8599826
	speed: 0.1952s/iter; left time: 3715.5034s
	iters: 200, epoch: 9 | loss: 2.1214056
	speed: 0.0517s/iter; left time: 979.7776s
Epoch: 9 cost time: 11.610413312911987
Epoch: 9, Steps: 208 | Train Loss: 2.052 Vali Loss: 5.040 Vali Acc: 0.113 Test Loss: 5.040 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7472366
	speed: 0.1907s/iter; left time: 3591.4604s
	iters: 200, epoch: 10 | loss: 2.2980139
	speed: 0.0506s/iter; left time: 946.9200s
Epoch: 10 cost time: 11.433604717254639
Epoch: 10, Steps: 208 | Train Loss: 1.750 Vali Loss: 5.147 Vali Acc: 0.114 Test Loss: 5.147 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6726105
	speed: 0.1891s/iter; left time: 3520.7871s
	iters: 200, epoch: 11 | loss: 1.3000017
	speed: 0.0549s/iter; left time: 1016.6069s
Epoch: 11 cost time: 11.900681257247925
Epoch: 11, Steps: 208 | Train Loss: 1.473 Vali Loss: 5.563 Vali Acc: 0.109 Test Loss: 5.563 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.5694681
	speed: 0.1900s/iter; left time: 3497.8834s
	iters: 200, epoch: 12 | loss: 1.2492828
	speed: 0.0506s/iter; left time: 926.6446s
Epoch: 12 cost time: 11.377441883087158
Epoch: 12, Steps: 208 | Train Loss: 1.244 Vali Loss: 6.134 Vali Acc: 0.110 Test Loss: 6.134 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.0733166
	speed: 0.1974s/iter; left time: 3593.0437s
	iters: 200, epoch: 13 | loss: 0.6625410
	speed: 0.0569s/iter; left time: 1029.6972s
Epoch: 13 cost time: 12.559715986251831
Epoch: 13, Steps: 208 | Train Loss: 1.033 Vali Loss: 6.341 Vali Acc: 0.106 Test Loss: 6.341 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3557849
	speed: 0.1834s/iter; left time: 3299.9765s
	iters: 200, epoch: 14 | loss: 1.4896988
	speed: 0.0550s/iter; left time: 983.4544s
Epoch: 14 cost time: 11.54613709449768
Epoch: 14, Steps: 208 | Train Loss: 0.888 Vali Loss: 6.944 Vali Acc: 0.125 Test Loss: 6.944 Test Acc: 0.125
Validation loss decreased (-0.115671 --> -0.124595).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8358587
	speed: 0.1954s/iter; left time: 3476.6471s
	iters: 200, epoch: 15 | loss: 0.6156604
	speed: 0.0543s/iter; left time: 960.7193s
Epoch: 15 cost time: 11.738465547561646
Epoch: 15, Steps: 208 | Train Loss: 0.734 Vali Loss: 7.306 Vali Acc: 0.111 Test Loss: 7.306 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0310344
	speed: 0.1973s/iter; left time: 3467.9914s
	iters: 200, epoch: 16 | loss: 0.6278999
	speed: 0.0544s/iter; left time: 951.4491s
Epoch: 16 cost time: 11.975138425827026
Epoch: 16, Steps: 208 | Train Loss: 0.656 Vali Loss: 7.782 Vali Acc: 0.113 Test Loss: 7.782 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5153772
	speed: 0.2000s/iter; left time: 3475.4653s
	iters: 200, epoch: 17 | loss: 0.5801409
	speed: 0.0559s/iter; left time: 965.0293s
Epoch: 17 cost time: 12.371374130249023
Epoch: 17, Steps: 208 | Train Loss: 0.588 Vali Loss: 8.228 Vali Acc: 0.113 Test Loss: 8.228 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.0461407
	speed: 0.1948s/iter; left time: 3343.3497s
	iters: 200, epoch: 18 | loss: 0.8773887
	speed: 0.0565s/iter; left time: 963.3965s
Epoch: 18 cost time: 12.112736940383911
Epoch: 18, Steps: 208 | Train Loss: 0.475 Vali Loss: 8.297 Vali Acc: 0.115 Test Loss: 8.297 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0899273
	speed: 0.1957s/iter; left time: 3319.0806s
	iters: 200, epoch: 19 | loss: 0.7805558
	speed: 0.0573s/iter; left time: 965.8550s
Epoch: 19 cost time: 12.33299994468689
Epoch: 19, Steps: 208 | Train Loss: 0.451 Vali Loss: 8.462 Vali Acc: 0.116 Test Loss: 8.462 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2593320
	speed: 0.2033s/iter; left time: 3405.2829s
	iters: 200, epoch: 20 | loss: 0.5037019
	speed: 0.0562s/iter; left time: 935.8337s
Epoch: 20 cost time: 12.21916389465332
Epoch: 20, Steps: 208 | Train Loss: 0.384 Vali Loss: 9.328 Vali Acc: 0.109 Test Loss: 9.328 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.7101033
	speed: 0.1937s/iter; left time: 3203.8532s
	iters: 200, epoch: 21 | loss: 0.4727215
	speed: 0.0542s/iter; left time: 890.5467s
Epoch: 21 cost time: 11.923279285430908
Epoch: 21, Steps: 208 | Train Loss: 0.361 Vali Loss: 9.513 Vali Acc: 0.109 Test Loss: 9.513 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6528907
	speed: 0.1925s/iter; left time: 3143.6937s
	iters: 200, epoch: 22 | loss: 0.9640654
	speed: 0.0572s/iter; left time: 929.0648s
Epoch: 22 cost time: 12.323280811309814
Epoch: 22, Steps: 208 | Train Loss: 0.326 Vali Loss: 9.818 Vali Acc: 0.106 Test Loss: 9.818 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.5465189
	speed: 0.2017s/iter; left time: 3252.7507s
	iters: 200, epoch: 23 | loss: 0.9475817
	speed: 0.0593s/iter; left time: 950.8704s
Epoch: 23 cost time: 12.906879186630249
Epoch: 23, Steps: 208 | Train Loss: 0.312 Vali Loss: 10.300 Vali Acc: 0.114 Test Loss: 10.300 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.3080018
	speed: 0.1946s/iter; left time: 3097.5602s
	iters: 200, epoch: 24 | loss: 0.2321621
	speed: 0.0511s/iter; left time: 807.8681s
Epoch: 24 cost time: 11.460591077804565
Epoch: 24, Steps: 208 | Train Loss: 0.296 Vali Loss: 10.303 Vali Acc: 0.114 Test Loss: 10.303 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 400039
model size : 2.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0552330
	speed: 0.0800s/iter; left time: 1655.7819s
	iters: 200, epoch: 1 | loss: 3.9289155
	speed: 0.0655s/iter; left time: 1349.8852s
Epoch: 1 cost time: 15.153136014938354
Epoch: 1, Steps: 208 | Train Loss: 3.836 Vali Loss: 3.833 Vali Acc: 0.061 Test Loss: 3.833 Test Acc: 0.061
Validation loss decreased (inf --> -0.061101).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3245759
	speed: 0.2057s/iter; left time: 4216.3947s
	iters: 200, epoch: 2 | loss: 3.6174209
	speed: 0.0626s/iter; left time: 1276.3312s
Epoch: 2 cost time: 13.081194162368774
Epoch: 2, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.900 Vali Acc: 0.078 Test Loss: 3.900 Test Acc: 0.078
Validation loss decreased (-0.061101 --> -0.078398).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7428021
	speed: 0.2002s/iter; left time: 4061.6901s
	iters: 200, epoch: 3 | loss: 3.9268057
	speed: 0.0588s/iter; left time: 1187.5838s
Epoch: 3 cost time: 12.426162004470825
Epoch: 3, Steps: 208 | Train Loss: 3.319 Vali Loss: 3.807 Vali Acc: 0.086 Test Loss: 3.807 Test Acc: 0.086
Validation loss decreased (-0.078398 --> -0.085855).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0613091
	speed: 0.1954s/iter; left time: 3923.6722s
	iters: 200, epoch: 4 | loss: 2.8545091
	speed: 0.0582s/iter; left time: 1162.5250s
Epoch: 4 cost time: 12.544666290283203
Epoch: 4, Steps: 208 | Train Loss: 3.108 Vali Loss: 3.744 Vali Acc: 0.091 Test Loss: 3.744 Test Acc: 0.091
Validation loss decreased (-0.085855 --> -0.091224).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0828273
	speed: 0.2044s/iter; left time: 4060.9562s
	iters: 200, epoch: 5 | loss: 4.3568015
	speed: 0.0494s/iter; left time: 975.7088s
Epoch: 5 cost time: 11.50490689277649
Epoch: 5, Steps: 208 | Train Loss: 2.946 Vali Loss: 4.232 Vali Acc: 0.094 Test Loss: 4.232 Test Acc: 0.094
Validation loss decreased (-0.091224 --> -0.094202).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7378595
	speed: 0.1765s/iter; left time: 3469.4887s
	iters: 200, epoch: 6 | loss: 3.6496720
	speed: 0.0506s/iter; left time: 989.7098s
Epoch: 6 cost time: 10.9325692653656
Epoch: 6, Steps: 208 | Train Loss: 2.699 Vali Loss: 4.222 Vali Acc: 0.102 Test Loss: 4.222 Test Acc: 0.102
Validation loss decreased (-0.094202 --> -0.101658).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2909369
	speed: 0.1938s/iter; left time: 3769.8095s
	iters: 200, epoch: 7 | loss: 2.7888610
	speed: 0.0465s/iter; left time: 899.5084s
Epoch: 7 cost time: 10.595333099365234
Epoch: 7, Steps: 208 | Train Loss: 2.463 Vali Loss: 4.612 Vali Acc: 0.108 Test Loss: 4.612 Test Acc: 0.108
Validation loss decreased (-0.101658 --> -0.108215).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3371928
	speed: 0.1915s/iter; left time: 3685.2226s
	iters: 200, epoch: 8 | loss: 3.3750696
	speed: 0.0485s/iter; left time: 927.7361s
Epoch: 8 cost time: 10.721867799758911
Epoch: 8, Steps: 208 | Train Loss: 2.213 Vali Loss: 4.667 Vali Acc: 0.108 Test Loss: 4.667 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2152910
	speed: 0.1833s/iter; left time: 3488.9281s
	iters: 200, epoch: 9 | loss: 2.3071277
	speed: 0.0438s/iter; left time: 829.5306s
Epoch: 9 cost time: 9.525516986846924
Epoch: 9, Steps: 208 | Train Loss: 1.883 Vali Loss: 4.817 Vali Acc: 0.106 Test Loss: 4.817 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0269457
	speed: 0.1833s/iter; left time: 3451.1437s
	iters: 200, epoch: 10 | loss: 2.0523038
	speed: 0.0518s/iter; left time: 970.2129s
Epoch: 10 cost time: 11.260617017745972
Epoch: 10, Steps: 208 | Train Loss: 1.628 Vali Loss: 5.352 Vali Acc: 0.107 Test Loss: 5.352 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6552652
	speed: 0.1854s/iter; left time: 3452.8408s
	iters: 200, epoch: 11 | loss: 1.4830601
	speed: 0.0444s/iter; left time: 822.0751s
Epoch: 11 cost time: 10.359187126159668
Epoch: 11, Steps: 208 | Train Loss: 1.352 Vali Loss: 5.686 Vali Acc: 0.106 Test Loss: 5.686 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0859599
	speed: 0.1910s/iter; left time: 3516.7066s
	iters: 200, epoch: 12 | loss: 1.2056733
	speed: 0.0524s/iter; left time: 959.7891s
Epoch: 12 cost time: 11.218287944793701
Epoch: 12, Steps: 208 | Train Loss: 1.146 Vali Loss: 6.014 Vali Acc: 0.105 Test Loss: 6.014 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3986344
	speed: 0.1843s/iter; left time: 3355.2804s
	iters: 200, epoch: 13 | loss: 1.0771531
	speed: 0.0448s/iter; left time: 810.5335s
Epoch: 13 cost time: 9.940917491912842
Epoch: 13, Steps: 208 | Train Loss: 0.969 Vali Loss: 6.877 Vali Acc: 0.108 Test Loss: 6.877 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7212809
	speed: 0.1853s/iter; left time: 3335.2040s
	iters: 200, epoch: 14 | loss: 0.7241911
	speed: 0.0480s/iter; left time: 858.7957s
Epoch: 14 cost time: 10.80075740814209
Epoch: 14, Steps: 208 | Train Loss: 0.790 Vali Loss: 7.287 Vali Acc: 0.101 Test Loss: 7.287 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.9860297
	speed: 0.1827s/iter; left time: 3250.5123s
	iters: 200, epoch: 15 | loss: 0.5670968
	speed: 0.0402s/iter; left time: 711.7871s
Epoch: 15 cost time: 9.287768602371216
Epoch: 15, Steps: 208 | Train Loss: 0.680 Vali Loss: 7.804 Vali Acc: 0.102 Test Loss: 7.804 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1746067
	speed: 0.1812s/iter; left time: 3185.7245s
	iters: 200, epoch: 16 | loss: 0.8529839
	speed: 0.0430s/iter; left time: 752.1420s
Epoch: 16 cost time: 9.810596227645874
Epoch: 16, Steps: 208 | Train Loss: 0.590 Vali Loss: 8.016 Vali Acc: 0.112 Test Loss: 8.016 Test Acc: 0.112
Validation loss decreased (-0.108215 --> -0.112356).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2715119
	speed: 0.1864s/iter; left time: 3238.0628s
	iters: 200, epoch: 17 | loss: 0.8031055
	speed: 0.0490s/iter; left time: 846.6629s
Epoch: 17 cost time: 11.072017669677734
Epoch: 17, Steps: 208 | Train Loss: 0.509 Vali Loss: 8.824 Vali Acc: 0.113 Test Loss: 8.824 Test Acc: 0.113
Validation loss decreased (-0.112356 --> -0.112945).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6668547
	speed: 0.1861s/iter; left time: 3194.9390s
	iters: 200, epoch: 18 | loss: 0.5352132
	speed: 0.0481s/iter; left time: 821.0863s
Epoch: 18 cost time: 10.841003656387329
Epoch: 18, Steps: 208 | Train Loss: 0.446 Vali Loss: 9.116 Vali Acc: 0.112 Test Loss: 9.116 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.7598388
	speed: 0.1866s/iter; left time: 3164.8079s
	iters: 200, epoch: 19 | loss: 0.3530367
	speed: 0.0492s/iter; left time: 830.1527s
Epoch: 19 cost time: 10.854298830032349
Epoch: 19, Steps: 208 | Train Loss: 0.419 Vali Loss: 9.478 Vali Acc: 0.113 Test Loss: 9.478 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.4149504
	speed: 0.1903s/iter; left time: 3187.8220s
	iters: 200, epoch: 20 | loss: 0.2796969
	speed: 0.0495s/iter; left time: 824.8546s
Epoch: 20 cost time: 11.032944679260254
Epoch: 20, Steps: 208 | Train Loss: 0.359 Vali Loss: 9.690 Vali Acc: 0.113 Test Loss: 9.690 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.6679481
	speed: 0.1742s/iter; left time: 2880.7992s
	iters: 200, epoch: 21 | loss: 0.1022247
	speed: 0.0459s/iter; left time: 755.0135s
Epoch: 21 cost time: 10.144646406173706
Epoch: 21, Steps: 208 | Train Loss: 0.360 Vali Loss: 10.144 Vali Acc: 0.106 Test Loss: 10.144 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2008730
	speed: 0.1833s/iter; left time: 2993.5329s
	iters: 200, epoch: 22 | loss: 0.0383659
	speed: 0.0479s/iter; left time: 778.3474s
Epoch: 22 cost time: 10.477581262588501
Epoch: 22, Steps: 208 | Train Loss: 0.286 Vali Loss: 10.483 Vali Acc: 0.103 Test Loss: 10.483 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1323328
	speed: 0.1771s/iter; left time: 2856.3883s
	iters: 200, epoch: 23 | loss: 0.3335753
	speed: 0.0500s/iter; left time: 801.1114s
Epoch: 23 cost time: 10.915441989898682
Epoch: 23, Steps: 208 | Train Loss: 0.306 Vali Loss: 10.893 Vali Acc: 0.107 Test Loss: 10.893 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.7265418
	speed: 0.1800s/iter; left time: 2865.1379s
	iters: 200, epoch: 24 | loss: 0.3091326
	speed: 0.0474s/iter; left time: 749.6224s
Epoch: 24 cost time: 10.797814130783081
Epoch: 24, Steps: 208 | Train Loss: 0.312 Vali Loss: 10.921 Vali Acc: 0.113 Test Loss: 10.921 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1918944
	speed: 0.1782s/iter; left time: 2799.8884s
	iters: 200, epoch: 25 | loss: 0.1861974
	speed: 0.0479s/iter; left time: 747.5774s
Epoch: 25 cost time: 10.782088041305542
Epoch: 25, Steps: 208 | Train Loss: 0.272 Vali Loss: 10.988 Vali Acc: 0.100 Test Loss: 10.988 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0030920
	speed: 0.1789s/iter; left time: 2772.9925s
	iters: 200, epoch: 26 | loss: 0.0664226
	speed: 0.0482s/iter; left time: 742.3696s
Epoch: 26 cost time: 10.67869758605957
Epoch: 26, Steps: 208 | Train Loss: 0.242 Vali Loss: 11.628 Vali Acc: 0.109 Test Loss: 11.628 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.2761141
	speed: 0.1836s/iter; left time: 2808.0402s
	iters: 200, epoch: 27 | loss: 0.4386619
	speed: 0.0511s/iter; left time: 775.8953s
Epoch: 27 cost time: 11.225337028503418
Epoch: 27, Steps: 208 | Train Loss: 0.243 Vali Loss: 11.800 Vali Acc: 0.104 Test Loss: 11.800 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.113033104682374
model parameter : 345831
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.1087546
	speed: 0.1454s/iter; left time: 3009.9874s
	iters: 200, epoch: 1 | loss: 3.7655725
	speed: 0.1271s/iter; left time: 2619.0322s
Epoch: 1 cost time: 28.57711434364319
Epoch: 1, Steps: 208 | Train Loss: 4.453 Vali Loss: 3.466 Vali Acc: 0.071 Test Loss: 3.466 Test Acc: 0.071
Validation loss decreased (inf --> -0.071245).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8119996
	speed: 0.4228s/iter; left time: 8665.0932s
	iters: 200, epoch: 2 | loss: 3.8310544
	speed: 0.1469s/iter; left time: 2994.8716s
Epoch: 2 cost time: 31.42904496192932
Epoch: 2, Steps: 208 | Train Loss: 3.628 Vali Loss: 4.039 Vali Acc: 0.066 Test Loss: 4.039 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4462311
	speed: 0.3990s/iter; left time: 8094.3108s
	iters: 200, epoch: 3 | loss: 4.2570415
	speed: 0.1437s/iter; left time: 2900.5514s
Epoch: 3 cost time: 28.604875087738037
Epoch: 3, Steps: 208 | Train Loss: 3.996 Vali Loss: 5.982 Vali Acc: 0.057 Test Loss: 5.982 Test Acc: 0.057
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.7025988
	speed: 0.3555s/iter; left time: 7137.4885s
	iters: 200, epoch: 4 | loss: 3.8440511
	speed: 0.1183s/iter; left time: 2363.0940s
Epoch: 4 cost time: 24.85590434074402
Epoch: 4, Steps: 208 | Train Loss: 4.198 Vali Loss: 4.984 Vali Acc: 0.078 Test Loss: 4.984 Test Acc: 0.078
Validation loss decreased (-0.071245 --> -0.078089).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9288898
	speed: 0.3563s/iter; left time: 7079.1762s
	iters: 200, epoch: 5 | loss: 3.8800645
	speed: 0.1233s/iter; left time: 2437.2417s
Epoch: 5 cost time: 26.527523279190063
Epoch: 5, Steps: 208 | Train Loss: 4.125 Vali Loss: 4.888 Vali Acc: 0.096 Test Loss: 4.888 Test Acc: 0.096
Validation loss decreased (-0.078089 --> -0.095686).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6795967
	speed: 0.3490s/iter; left time: 6861.9636s
	iters: 200, epoch: 6 | loss: 2.8158214
	speed: 0.1056s/iter; left time: 2065.1940s
Epoch: 6 cost time: 23.082188367843628
Epoch: 6, Steps: 208 | Train Loss: 3.927 Vali Loss: 5.392 Vali Acc: 0.108 Test Loss: 5.392 Test Acc: 0.108
Validation loss decreased (-0.095686 --> -0.107611).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3940799
	speed: 0.3424s/iter; left time: 6661.2789s
	iters: 200, epoch: 7 | loss: 3.7909300
	speed: 0.1140s/iter; left time: 2206.0521s
Epoch: 7 cost time: 24.54842734336853
Epoch: 7, Steps: 208 | Train Loss: 3.391 Vali Loss: 5.676 Vali Acc: 0.106 Test Loss: 5.676 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4256954
	speed: 0.3552s/iter; left time: 6836.3321s
	iters: 200, epoch: 8 | loss: 2.5465348
	speed: 0.1146s/iter; left time: 2193.8614s
Epoch: 8 cost time: 24.831303596496582
Epoch: 8, Steps: 208 | Train Loss: 2.764 Vali Loss: 11.346 Vali Acc: 0.046 Test Loss: 11.346 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5943236
	speed: 0.3621s/iter; left time: 6894.0360s
	iters: 200, epoch: 9 | loss: 1.5218716
	speed: 0.1281s/iter; left time: 2426.6251s
Epoch: 9 cost time: 27.33370065689087
Epoch: 9, Steps: 208 | Train Loss: 1.903 Vali Loss: 7.179 Vali Acc: 0.089 Test Loss: 7.179 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2812817
	speed: 0.3792s/iter; left time: 7140.3785s
	iters: 200, epoch: 10 | loss: 1.9335598
	speed: 0.1265s/iter; left time: 2369.7358s
Epoch: 10 cost time: 27.358537912368774
Epoch: 10, Steps: 208 | Train Loss: 1.431 Vali Loss: 7.243 Vali Acc: 0.090 Test Loss: 7.243 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8983920
	speed: 0.4009s/iter; left time: 7465.1103s
	iters: 200, epoch: 11 | loss: 1.2151179
	speed: 0.1439s/iter; left time: 2664.2953s
Epoch: 11 cost time: 29.934230089187622
Epoch: 11, Steps: 208 | Train Loss: 1.180 Vali Loss: 6.819 Vali Acc: 0.109 Test Loss: 6.819 Test Acc: 0.109
Validation loss decreased (-0.107611 --> -0.109386).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6216256
	speed: 0.4008s/iter; left time: 7380.5767s
	iters: 200, epoch: 12 | loss: 0.9897196
	speed: 0.1328s/iter; left time: 2432.7304s
Epoch: 12 cost time: 28.363250970840454
Epoch: 12, Steps: 208 | Train Loss: 0.967 Vali Loss: 6.974 Vali Acc: 0.100 Test Loss: 6.974 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9485607
	speed: 0.3732s/iter; left time: 6793.9269s
	iters: 200, epoch: 13 | loss: 0.8220042
	speed: 0.1283s/iter; left time: 2322.0074s
Epoch: 13 cost time: 26.77500343322754
Epoch: 13, Steps: 208 | Train Loss: 0.839 Vali Loss: 7.150 Vali Acc: 0.123 Test Loss: 7.150 Test Acc: 0.123
Validation loss decreased (-0.109386 --> -0.123400).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2720990
	speed: 0.4015s/iter; left time: 7225.4136s
	iters: 200, epoch: 14 | loss: 0.7617748
	speed: 0.1389s/iter; left time: 2486.4106s
Epoch: 14 cost time: 29.160677909851074
Epoch: 14, Steps: 208 | Train Loss: 0.673 Vali Loss: 8.512 Vali Acc: 0.114 Test Loss: 8.512 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4641247
	speed: 0.3942s/iter; left time: 7013.2232s
	iters: 200, epoch: 15 | loss: 0.7515463
	speed: 0.1300s/iter; left time: 2299.6615s
Epoch: 15 cost time: 28.172423839569092
Epoch: 15, Steps: 208 | Train Loss: 0.598 Vali Loss: 8.206 Vali Acc: 0.120 Test Loss: 8.206 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3270518
	speed: 0.4174s/iter; left time: 7338.9553s
	iters: 200, epoch: 16 | loss: 0.1815647
	speed: 0.1647s/iter; left time: 2878.5147s
Epoch: 16 cost time: 34.07175660133362
Epoch: 16, Steps: 208 | Train Loss: 0.476 Vali Loss: 9.210 Vali Acc: 0.110 Test Loss: 9.210 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1627979
	speed: 0.4192s/iter; left time: 7283.4919s
	iters: 200, epoch: 17 | loss: 0.4905010
	speed: 0.1527s/iter; left time: 2637.7431s
Epoch: 17 cost time: 29.979380130767822
Epoch: 17, Steps: 208 | Train Loss: 0.388 Vali Loss: 9.076 Vali Acc: 0.123 Test Loss: 9.076 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2733469
	speed: 0.4355s/iter; left time: 7475.1576s
	iters: 200, epoch: 18 | loss: 0.0941045
	speed: 0.1541s/iter; left time: 2628.9949s
Epoch: 18 cost time: 32.882532358169556
Epoch: 18, Steps: 208 | Train Loss: 0.360 Vali Loss: 9.385 Vali Acc: 0.111 Test Loss: 9.385 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1376935
	speed: 0.4128s/iter; left time: 7000.3366s
	iters: 200, epoch: 19 | loss: 0.3451772
	speed: 0.1384s/iter; left time: 2332.9574s
Epoch: 19 cost time: 29.968836307525635
Epoch: 19, Steps: 208 | Train Loss: 0.298 Vali Loss: 10.927 Vali Acc: 0.109 Test Loss: 10.927 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1694891
	speed: 0.4271s/iter; left time: 7153.1459s
	iters: 200, epoch: 20 | loss: 0.6127409
	speed: 0.1384s/iter; left time: 2304.5336s
Epoch: 20 cost time: 30.59155774116516
Epoch: 20, Steps: 208 | Train Loss: 0.249 Vali Loss: 10.850 Vali Acc: 0.110 Test Loss: 10.850 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0446224
	speed: 0.3628s/iter; left time: 6000.3518s
	iters: 200, epoch: 21 | loss: 0.0320230
	speed: 0.1270s/iter; left time: 2087.4603s
Epoch: 21 cost time: 26.0680890083313
Epoch: 21, Steps: 208 | Train Loss: 0.202 Vali Loss: 10.962 Vali Acc: 0.114 Test Loss: 10.962 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1260843
	speed: 0.3676s/iter; left time: 6004.6103s
	iters: 200, epoch: 22 | loss: 0.3629303
	speed: 0.1292s/iter; left time: 2097.6267s
Epoch: 22 cost time: 26.81525444984436
Epoch: 22, Steps: 208 | Train Loss: 0.190 Vali Loss: 11.526 Vali Acc: 0.122 Test Loss: 11.526 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0013942
	speed: 0.3708s/iter; left time: 5978.8299s
	iters: 200, epoch: 23 | loss: 0.5206769
	speed: 0.1111s/iter; left time: 1780.4073s
Epoch: 23 cost time: 26.18704915046692
Epoch: 23, Steps: 208 | Train Loss: 0.177 Vali Loss: 12.600 Vali Acc: 0.111 Test Loss: 12.600 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1234715180435431
model parameter : 2077799
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2993021
	speed: 0.1039s/iter; left time: 2149.8446s
	iters: 200, epoch: 1 | loss: 3.7520609
	speed: 0.0961s/iter; left time: 1979.9622s
Epoch: 1 cost time: 20.93311643600464
Epoch: 1, Steps: 208 | Train Loss: 4.166 Vali Loss: 3.472 Vali Acc: 0.068 Test Loss: 3.472 Test Acc: 0.068
Validation loss decreased (inf --> -0.067666).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0496733
	speed: 0.2608s/iter; left time: 5345.2760s
	iters: 200, epoch: 2 | loss: 3.8980365
	speed: 0.1058s/iter; left time: 2158.1351s
Epoch: 2 cost time: 22.14591360092163
Epoch: 2, Steps: 208 | Train Loss: 3.520 Vali Loss: 3.830 Vali Acc: 0.072 Test Loss: 3.830 Test Acc: 0.072
Validation loss decreased (-0.067666 --> -0.071539).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2792628
	speed: 0.2541s/iter; left time: 5154.7833s
	iters: 200, epoch: 3 | loss: 3.0337446
	speed: 0.1073s/iter; left time: 2166.8046s
Epoch: 3 cost time: 20.1501784324646
Epoch: 3, Steps: 208 | Train Loss: 3.475 Vali Loss: 5.102 Vali Acc: 0.044 Test Loss: 5.102 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4867046
	speed: 0.2900s/iter; left time: 5821.8975s
	iters: 200, epoch: 4 | loss: 3.7699978
	speed: 0.1311s/iter; left time: 2619.1277s
Epoch: 4 cost time: 26.712592601776123
Epoch: 4, Steps: 208 | Train Loss: 3.552 Vali Loss: 4.355 Vali Acc: 0.098 Test Loss: 4.355 Test Acc: 0.098
Validation loss decreased (-0.071539 --> -0.097481).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1090693
	speed: 0.3104s/iter; left time: 6167.3109s
	iters: 200, epoch: 5 | loss: 4.0763927
	speed: 0.1167s/iter; left time: 2307.2220s
Epoch: 5 cost time: 26.27184772491455
Epoch: 5, Steps: 208 | Train Loss: 3.493 Vali Loss: 4.151 Vali Acc: 0.106 Test Loss: 4.151 Test Acc: 0.106
Validation loss decreased (-0.097481 --> -0.105536).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5280507
	speed: 0.3223s/iter; left time: 6335.9028s
	iters: 200, epoch: 6 | loss: 2.1018324
	speed: 0.1471s/iter; left time: 2878.1974s
Epoch: 6 cost time: 30.51907753944397
Epoch: 6, Steps: 208 | Train Loss: 3.300 Vali Loss: 3.916 Vali Acc: 0.117 Test Loss: 3.916 Test Acc: 0.117
Validation loss decreased (-0.105536 --> -0.116871).  Saving model ...
	iters: 100, epoch: 7 | loss: 4.6708708
	speed: 0.3546s/iter; left time: 6898.6058s
	iters: 200, epoch: 7 | loss: 3.0232873
	speed: 0.1523s/iter; left time: 2946.6592s
Epoch: 7 cost time: 32.88585901260376
Epoch: 7, Steps: 208 | Train Loss: 3.095 Vali Loss: 4.068 Vali Acc: 0.136 Test Loss: 4.068 Test Acc: 0.136
Validation loss decreased (-0.116871 --> -0.135957).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5915301
	speed: 0.3458s/iter; left time: 6654.1015s
	iters: 200, epoch: 8 | loss: 3.4067354
	speed: 0.1447s/iter; left time: 2770.5791s
Epoch: 8 cost time: 30.618388414382935
Epoch: 8, Steps: 208 | Train Loss: 2.704 Vali Loss: 4.751 Vali Acc: 0.134 Test Loss: 4.751 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.8148236
	speed: 0.3546s/iter; left time: 6750.8759s
	iters: 200, epoch: 9 | loss: 2.6581771
	speed: 0.1451s/iter; left time: 2747.6846s
Epoch: 9 cost time: 31.513170957565308
Epoch: 9, Steps: 208 | Train Loss: 2.182 Vali Loss: 5.434 Vali Acc: 0.117 Test Loss: 5.434 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2707438
	speed: 0.3391s/iter; left time: 6384.2206s
	iters: 200, epoch: 10 | loss: 2.2611499
	speed: 0.1301s/iter; left time: 2435.8737s
Epoch: 10 cost time: 28.99966049194336
Epoch: 10, Steps: 208 | Train Loss: 1.762 Vali Loss: 6.123 Vali Acc: 0.115 Test Loss: 6.123 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2343484
	speed: 0.3468s/iter; left time: 6456.8727s
	iters: 200, epoch: 11 | loss: 2.7710495
	speed: 0.1512s/iter; left time: 2799.4979s
Epoch: 11 cost time: 31.176337718963623
Epoch: 11, Steps: 208 | Train Loss: 1.446 Vali Loss: 5.684 Vali Acc: 0.133 Test Loss: 5.684 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2780278
	speed: 0.3292s/iter; left time: 6061.8163s
	iters: 200, epoch: 12 | loss: 1.3984500
	speed: 0.1230s/iter; left time: 2252.8713s
Epoch: 12 cost time: 26.855740070343018
Epoch: 12, Steps: 208 | Train Loss: 1.197 Vali Loss: 5.984 Vali Acc: 0.135 Test Loss: 5.984 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3760507
	speed: 0.3186s/iter; left time: 5799.5324s
	iters: 200, epoch: 13 | loss: 1.1658990
	speed: 0.1340s/iter; left time: 2426.4047s
Epoch: 13 cost time: 28.388320922851562
Epoch: 13, Steps: 208 | Train Loss: 1.017 Vali Loss: 6.039 Vali Acc: 0.142 Test Loss: 6.039 Test Acc: 0.142
Validation loss decreased (-0.135957 --> -0.141902).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5748173
	speed: 0.3127s/iter; left time: 5628.1026s
	iters: 200, epoch: 14 | loss: 0.6481476
	speed: 0.1160s/iter; left time: 2075.1579s
Epoch: 14 cost time: 25.736044883728027
Epoch: 14, Steps: 208 | Train Loss: 0.802 Vali Loss: 7.079 Vali Acc: 0.136 Test Loss: 7.079 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4014562
	speed: 0.2764s/iter; left time: 4916.8532s
	iters: 200, epoch: 15 | loss: 0.8946635
	speed: 0.0984s/iter; left time: 1740.4165s
Epoch: 15 cost time: 22.973491191864014
Epoch: 15, Steps: 208 | Train Loss: 0.659 Vali Loss: 6.813 Vali Acc: 0.141 Test Loss: 6.813 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4250516
	speed: 0.2554s/iter; left time: 4489.3718s
	iters: 200, epoch: 16 | loss: 0.8563843
	speed: 0.1190s/iter; left time: 2079.6658s
Epoch: 16 cost time: 22.91508197784424
Epoch: 16, Steps: 208 | Train Loss: 0.576 Vali Loss: 7.821 Vali Acc: 0.142 Test Loss: 7.821 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9671072
	speed: 0.2518s/iter; left time: 4375.3140s
	iters: 200, epoch: 17 | loss: 0.8067487
	speed: 0.1097s/iter; left time: 1894.9663s
Epoch: 17 cost time: 21.434263944625854
Epoch: 17, Steps: 208 | Train Loss: 0.469 Vali Loss: 8.153 Vali Acc: 0.146 Test Loss: 8.153 Test Acc: 0.146
Validation loss decreased (-0.141902 --> -0.146354).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0730611
	speed: 0.2338s/iter; left time: 4012.4344s
	iters: 200, epoch: 18 | loss: 0.6462009
	speed: 0.1121s/iter; left time: 1912.8772s
Epoch: 18 cost time: 20.573034524917603
Epoch: 18, Steps: 208 | Train Loss: 0.388 Vali Loss: 8.993 Vali Acc: 0.132 Test Loss: 8.993 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1034347
	speed: 0.3170s/iter; left time: 5375.7140s
	iters: 200, epoch: 19 | loss: 0.1642044
	speed: 0.1194s/iter; left time: 2013.3530s
Epoch: 19 cost time: 26.09140419960022
Epoch: 19, Steps: 208 | Train Loss: 0.337 Vali Loss: 8.936 Vali Acc: 0.136 Test Loss: 8.936 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.6248010
	speed: 0.3243s/iter; left time: 5431.0869s
	iters: 200, epoch: 20 | loss: 0.0245537
	speed: 0.1283s/iter; left time: 2136.2968s
Epoch: 20 cost time: 27.972618341445923
Epoch: 20, Steps: 208 | Train Loss: 0.314 Vali Loss: 9.022 Vali Acc: 0.130 Test Loss: 9.022 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.1238267
	speed: 0.3619s/iter; left time: 5986.5905s
	iters: 200, epoch: 21 | loss: 0.4286759
	speed: 0.1493s/iter; left time: 2455.1720s
Epoch: 21 cost time: 31.978124141693115
Epoch: 21, Steps: 208 | Train Loss: 0.273 Vali Loss: 9.397 Vali Acc: 0.135 Test Loss: 9.397 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0284990
	speed: 0.3579s/iter; left time: 5845.8592s
	iters: 200, epoch: 22 | loss: 0.1832501
	speed: 0.1666s/iter; left time: 2703.8724s
Epoch: 22 cost time: 33.53929162025452
Epoch: 22, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.428 Vali Acc: 0.136 Test Loss: 9.428 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3243214
	speed: 0.3573s/iter; left time: 5761.3512s
	iters: 200, epoch: 23 | loss: 0.2080142
	speed: 0.1591s/iter; left time: 2549.4625s
Epoch: 23 cost time: 32.91311955451965
Epoch: 23, Steps: 208 | Train Loss: 0.236 Vali Loss: 10.470 Vali Acc: 0.137 Test Loss: 10.470 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0022827
	speed: 0.3462s/iter; left time: 5510.8211s
	iters: 200, epoch: 24 | loss: 0.3514576
	speed: 0.1572s/iter; left time: 2486.9308s
Epoch: 24 cost time: 32.74843072891235
Epoch: 24, Steps: 208 | Train Loss: 0.204 Vali Loss: 10.349 Vali Acc: 0.135 Test Loss: 10.349 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0371290
	speed: 0.3586s/iter; left time: 5633.2081s
	iters: 200, epoch: 25 | loss: 0.5483964
	speed: 0.1577s/iter; left time: 2461.9579s
Epoch: 25 cost time: 32.51089119911194
Epoch: 25, Steps: 208 | Train Loss: 0.200 Vali Loss: 11.215 Vali Acc: 0.135 Test Loss: 11.215 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.6990246
	speed: 0.3442s/iter; left time: 5336.1004s
	iters: 200, epoch: 26 | loss: 0.0975333
	speed: 0.1540s/iter; left time: 2371.0069s
Epoch: 26 cost time: 31.40999746322632
Epoch: 26, Steps: 208 | Train Loss: 0.175 Vali Loss: 11.673 Vali Acc: 0.134 Test Loss: 11.673 Test Acc: 0.134
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0349689
	speed: 0.3608s/iter; left time: 5517.0475s
	iters: 200, epoch: 27 | loss: 0.8875444
	speed: 0.1347s/iter; left time: 2046.3877s
Epoch: 27 cost time: 30.68010973930359
Epoch: 27, Steps: 208 | Train Loss: 0.194 Vali Loss: 11.722 Vali Acc: 0.137 Test Loss: 11.722 Test Acc: 0.137
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14643602743811512
model parameter : 1089703
model size : 5.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5990522
	speed: 0.1481s/iter; left time: 3064.8405s
	iters: 200, epoch: 1 | loss: 4.0844154
	speed: 0.1435s/iter; left time: 2955.8125s
Epoch: 1 cost time: 30.318852186203003
Epoch: 1, Steps: 208 | Train Loss: 4.073 Vali Loss: 3.643 Vali Acc: 0.064 Test Loss: 3.643 Test Acc: 0.064
Validation loss decreased (inf --> -0.063489).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7062721
	speed: 0.2881s/iter; left time: 5904.2414s
	iters: 200, epoch: 2 | loss: 3.6242571
	speed: 0.1296s/iter; left time: 2643.1088s
Epoch: 2 cost time: 26.80604314804077
Epoch: 2, Steps: 208 | Train Loss: 3.402 Vali Loss: 3.474 Vali Acc: 0.086 Test Loss: 3.474 Test Acc: 0.086
Validation loss decreased (-0.063489 --> -0.086455).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0245073
	speed: 0.3139s/iter; left time: 6367.8820s
	iters: 200, epoch: 3 | loss: 4.3301859
	speed: 0.1319s/iter; left time: 2662.4294s
Epoch: 3 cost time: 29.234147787094116
Epoch: 3, Steps: 208 | Train Loss: 3.289 Vali Loss: 3.953 Vali Acc: 0.093 Test Loss: 3.953 Test Acc: 0.093
Validation loss decreased (-0.086455 --> -0.093011).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4497688
	speed: 0.3189s/iter; left time: 6402.5089s
	iters: 200, epoch: 4 | loss: 2.8968389
	speed: 0.1346s/iter; left time: 2689.4573s
Epoch: 4 cost time: 29.473522663116455
Epoch: 4, Steps: 208 | Train Loss: 3.296 Vali Loss: 3.685 Vali Acc: 0.103 Test Loss: 3.685 Test Acc: 0.103
Validation loss decreased (-0.093011 --> -0.102856).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9357519
	speed: 0.2840s/iter; left time: 5642.6553s
	iters: 200, epoch: 5 | loss: 4.0438032
	speed: 0.1322s/iter; left time: 2614.4225s
Epoch: 5 cost time: 26.818650007247925
Epoch: 5, Steps: 208 | Train Loss: 3.272 Vali Loss: 4.220 Vali Acc: 0.099 Test Loss: 4.220 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8277640
	speed: 0.2784s/iter; left time: 5472.7463s
	iters: 200, epoch: 6 | loss: 2.9269676
	speed: 0.1235s/iter; left time: 2415.9737s
Epoch: 6 cost time: 25.41066884994507
Epoch: 6, Steps: 208 | Train Loss: 3.108 Vali Loss: 4.787 Vali Acc: 0.111 Test Loss: 4.787 Test Acc: 0.111
Validation loss decreased (-0.102856 --> -0.111196).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3521252
	speed: 0.2915s/iter; left time: 5671.1845s
	iters: 200, epoch: 7 | loss: 3.3653004
	speed: 0.1219s/iter; left time: 2358.4625s
Epoch: 7 cost time: 25.664238691329956
Epoch: 7, Steps: 208 | Train Loss: 2.851 Vali Loss: 4.813 Vali Acc: 0.118 Test Loss: 4.813 Test Acc: 0.118
Validation loss decreased (-0.111196 --> -0.117757).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3026841
	speed: 0.2996s/iter; left time: 5766.4327s
	iters: 200, epoch: 8 | loss: 2.8968899
	speed: 0.1087s/iter; left time: 2080.5638s
Epoch: 8 cost time: 25.156219959259033
Epoch: 8, Steps: 208 | Train Loss: 2.502 Vali Loss: 5.116 Vali Acc: 0.119 Test Loss: 5.116 Test Acc: 0.119
Validation loss decreased (-0.117757 --> -0.118649).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4845357
	speed: 0.2968s/iter; left time: 5649.2776s
	iters: 200, epoch: 9 | loss: 3.1998858
	speed: 0.1278s/iter; left time: 2419.7741s
Epoch: 9 cost time: 28.045764923095703
Epoch: 9, Steps: 208 | Train Loss: 2.150 Vali Loss: 4.611 Vali Acc: 0.131 Test Loss: 4.611 Test Acc: 0.131
Validation loss decreased (-0.118649 --> -0.130881).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3861827
	speed: 0.2885s/iter; left time: 5432.5221s
	iters: 200, epoch: 10 | loss: 1.8738927
	speed: 0.1287s/iter; left time: 2410.0208s
Epoch: 10 cost time: 27.166869163513184
Epoch: 10, Steps: 208 | Train Loss: 1.758 Vali Loss: 5.341 Vali Acc: 0.133 Test Loss: 5.341 Test Acc: 0.133
Validation loss decreased (-0.130881 --> -0.132962).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8767412
	speed: 0.2685s/iter; left time: 4999.5427s
	iters: 200, epoch: 11 | loss: 1.0507308
	speed: 0.1253s/iter; left time: 2321.5431s
Epoch: 11 cost time: 24.70253276824951
Epoch: 11, Steps: 208 | Train Loss: 1.514 Vali Loss: 6.100 Vali Acc: 0.128 Test Loss: 6.100 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5365564
	speed: 0.2649s/iter; left time: 4878.2379s
	iters: 200, epoch: 12 | loss: 1.2478681
	speed: 0.0903s/iter; left time: 1653.0241s
Epoch: 12 cost time: 19.48404312133789
Epoch: 12, Steps: 208 | Train Loss: 1.248 Vali Loss: 6.251 Vali Acc: 0.145 Test Loss: 6.251 Test Acc: 0.145
Validation loss decreased (-0.132962 --> -0.145181).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6195493
	speed: 0.2375s/iter; left time: 4322.7823s
	iters: 200, epoch: 13 | loss: 1.1832335
	speed: 0.1117s/iter; left time: 2021.8450s
Epoch: 13 cost time: 22.9128577709198
Epoch: 13, Steps: 208 | Train Loss: 0.996 Vali Loss: 6.470 Vali Acc: 0.136 Test Loss: 6.470 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4849119
	speed: 0.2681s/iter; left time: 4824.3756s
	iters: 200, epoch: 14 | loss: 1.8801472
	speed: 0.1098s/iter; left time: 1964.4014s
Epoch: 14 cost time: 23.95580005645752
Epoch: 14, Steps: 208 | Train Loss: 0.852 Vali Loss: 6.776 Vali Acc: 0.135 Test Loss: 6.776 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.0913904
	speed: 0.2634s/iter; left time: 4685.5973s
	iters: 200, epoch: 15 | loss: 0.6392900
	speed: 0.1120s/iter; left time: 1981.7505s
Epoch: 15 cost time: 24.117952346801758
Epoch: 15, Steps: 208 | Train Loss: 0.696 Vali Loss: 7.833 Vali Acc: 0.132 Test Loss: 7.833 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2235714
	speed: 0.2693s/iter; left time: 4734.4151s
	iters: 200, epoch: 16 | loss: 0.5743613
	speed: 0.1153s/iter; left time: 2014.9442s
Epoch: 16 cost time: 24.94980478286743
Epoch: 16, Steps: 208 | Train Loss: 0.563 Vali Loss: 7.885 Vali Acc: 0.133 Test Loss: 7.885 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.8350481
	speed: 0.2663s/iter; left time: 4625.6648s
	iters: 200, epoch: 17 | loss: 0.4098383
	speed: 0.1138s/iter; left time: 1965.9050s
Epoch: 17 cost time: 24.60262703895569
Epoch: 17, Steps: 208 | Train Loss: 0.510 Vali Loss: 8.528 Vali Acc: 0.138 Test Loss: 8.528 Test Acc: 0.138
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1886578
	speed: 0.2639s/iter; left time: 4530.2097s
	iters: 200, epoch: 18 | loss: 0.6131068
	speed: 0.1134s/iter; left time: 1935.9209s
Epoch: 18 cost time: 24.045629024505615
Epoch: 18, Steps: 208 | Train Loss: 0.459 Vali Loss: 8.070 Vali Acc: 0.135 Test Loss: 8.070 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4019454
	speed: 0.2622s/iter; left time: 4445.9590s
	iters: 200, epoch: 19 | loss: 0.7723078
	speed: 0.1143s/iter; left time: 1926.1123s
Epoch: 19 cost time: 24.584216833114624
Epoch: 19, Steps: 208 | Train Loss: 0.411 Vali Loss: 8.514 Vali Acc: 0.128 Test Loss: 8.514 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1685150
	speed: 0.2592s/iter; left time: 4341.7296s
	iters: 200, epoch: 20 | loss: 0.7926168
	speed: 0.1098s/iter; left time: 1827.2972s
Epoch: 20 cost time: 23.615365505218506
Epoch: 20, Steps: 208 | Train Loss: 0.360 Vali Loss: 8.973 Vali Acc: 0.137 Test Loss: 8.973 Test Acc: 0.137
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0261950
	speed: 0.2620s/iter; left time: 4333.5750s
	iters: 200, epoch: 21 | loss: 0.0658419
	speed: 0.1082s/iter; left time: 1779.1907s
Epoch: 21 cost time: 23.29344916343689
Epoch: 21, Steps: 208 | Train Loss: 0.322 Vali Loss: 9.724 Vali Acc: 0.134 Test Loss: 9.724 Test Acc: 0.134
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2528797
	speed: 0.2665s/iter; left time: 4352.7233s
	iters: 200, epoch: 22 | loss: 0.2838542
	speed: 0.1224s/iter; left time: 1986.8519s
Epoch: 22 cost time: 25.852977991104126
Epoch: 22, Steps: 208 | Train Loss: 0.288 Vali Loss: 10.487 Vali Acc: 0.129 Test Loss: 10.487 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14524306591112437
model parameter : 760615
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0487866
	speed: 0.1040s/iter; left time: 2153.8020s
	iters: 200, epoch: 1 | loss: 4.1737533
	speed: 0.0970s/iter; left time: 1999.1776s
Epoch: 1 cost time: 20.939866304397583
Epoch: 1, Steps: 208 | Train Loss: 4.042 Vali Loss: 4.048 Vali Acc: 0.063 Test Loss: 4.048 Test Acc: 0.063
Validation loss decreased (inf --> -0.063186).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5251505
	speed: 0.2418s/iter; left time: 4955.2692s
	iters: 200, epoch: 2 | loss: 4.1920757
	speed: 0.1030s/iter; left time: 2099.9469s
Epoch: 2 cost time: 21.67660403251648
Epoch: 2, Steps: 208 | Train Loss: 3.438 Vali Loss: 3.823 Vali Acc: 0.069 Test Loss: 3.823 Test Acc: 0.069
Validation loss decreased (-0.063186 --> -0.068557).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3596003
	speed: 0.2458s/iter; left time: 4985.3084s
	iters: 200, epoch: 3 | loss: 3.5195417
	speed: 0.0998s/iter; left time: 2014.7350s
Epoch: 3 cost time: 21.710588455200195
Epoch: 3, Steps: 208 | Train Loss: 3.176 Vali Loss: 3.825 Vali Acc: 0.100 Test Loss: 3.825 Test Acc: 0.100
Validation loss decreased (-0.068557 --> -0.099574).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5606101
	speed: 0.2390s/iter; left time: 4798.9043s
	iters: 200, epoch: 4 | loss: 2.5576146
	speed: 0.0953s/iter; left time: 1904.1949s
Epoch: 4 cost time: 20.634303331375122
Epoch: 4, Steps: 208 | Train Loss: 3.194 Vali Loss: 3.449 Vali Acc: 0.117 Test Loss: 3.449 Test Acc: 0.117
Validation loss decreased (-0.099574 --> -0.116577).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4516814
	speed: 0.2270s/iter; left time: 4509.4304s
	iters: 200, epoch: 5 | loss: 4.5349269
	speed: 0.0941s/iter; left time: 1860.5506s
Epoch: 5 cost time: 19.06837248802185
Epoch: 5, Steps: 208 | Train Loss: 3.070 Vali Loss: 3.944 Vali Acc: 0.105 Test Loss: 3.944 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1202555
	speed: 0.2419s/iter; left time: 4755.3700s
	iters: 200, epoch: 6 | loss: 2.7446148
	speed: 0.1081s/iter; left time: 2115.3531s
Epoch: 6 cost time: 22.181630611419678
Epoch: 6, Steps: 208 | Train Loss: 2.984 Vali Loss: 4.270 Vali Acc: 0.129 Test Loss: 4.270 Test Acc: 0.129
Validation loss decreased (-0.116577 --> -0.128797).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1345959
	speed: 0.2317s/iter; left time: 4507.3220s
	iters: 200, epoch: 7 | loss: 2.5934503
	speed: 0.0936s/iter; left time: 1810.6650s
Epoch: 7 cost time: 19.487247228622437
Epoch: 7, Steps: 208 | Train Loss: 2.757 Vali Loss: 4.734 Vali Acc: 0.126 Test Loss: 4.734 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5806508
	speed: 0.2358s/iter; left time: 4537.6340s
	iters: 200, epoch: 8 | loss: 2.2780039
	speed: 0.1058s/iter; left time: 2025.9635s
Epoch: 8 cost time: 21.244924783706665
Epoch: 8, Steps: 208 | Train Loss: 2.450 Vali Loss: 4.900 Vali Acc: 0.131 Test Loss: 4.900 Test Acc: 0.131
Validation loss decreased (-0.128797 --> -0.130580).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.4244311
	speed: 0.2629s/iter; left time: 5004.6029s
	iters: 200, epoch: 9 | loss: 2.8251402
	speed: 0.1202s/iter; left time: 2276.2499s
Epoch: 9 cost time: 25.244551181793213
Epoch: 9, Steps: 208 | Train Loss: 2.172 Vali Loss: 5.101 Vali Acc: 0.132 Test Loss: 5.101 Test Acc: 0.132
Validation loss decreased (-0.130580 --> -0.132069).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7252839
	speed: 0.2644s/iter; left time: 4977.8837s
	iters: 200, epoch: 10 | loss: 2.8023791
	speed: 0.1243s/iter; left time: 2328.5134s
Epoch: 10 cost time: 25.479413509368896
Epoch: 10, Steps: 208 | Train Loss: 1.882 Vali Loss: 5.117 Vali Acc: 0.135 Test Loss: 5.117 Test Acc: 0.135
Validation loss decreased (-0.132069 --> -0.135350).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1346091
	speed: 0.2618s/iter; left time: 4874.1720s
	iters: 200, epoch: 11 | loss: 1.7959684
	speed: 0.1173s/iter; left time: 2173.0209s
Epoch: 11 cost time: 24.51461696624756
Epoch: 11, Steps: 208 | Train Loss: 1.571 Vali Loss: 5.507 Vali Acc: 0.137 Test Loss: 5.507 Test Acc: 0.137
Validation loss decreased (-0.135350 --> -0.137434).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5684729
	speed: 0.2670s/iter; left time: 4916.2430s
	iters: 200, epoch: 12 | loss: 1.2473727
	speed: 0.1223s/iter; left time: 2240.1167s
Epoch: 12 cost time: 25.45471429824829
Epoch: 12, Steps: 208 | Train Loss: 1.300 Vali Loss: 5.892 Vali Acc: 0.128 Test Loss: 5.892 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0367566
	speed: 0.2684s/iter; left time: 4886.2950s
	iters: 200, epoch: 13 | loss: 0.9916751
	speed: 0.1085s/iter; left time: 1964.0348s
Epoch: 13 cost time: 24.147023677825928
Epoch: 13, Steps: 208 | Train Loss: 1.071 Vali Loss: 6.259 Vali Acc: 0.137 Test Loss: 6.259 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7366250
	speed: 0.2714s/iter; left time: 4883.9370s
	iters: 200, epoch: 14 | loss: 0.9111390
	speed: 0.1253s/iter; left time: 2242.1407s
Epoch: 14 cost time: 26.8424174785614
Epoch: 14, Steps: 208 | Train Loss: 0.927 Vali Loss: 6.359 Vali Acc: 0.137 Test Loss: 6.359 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2447845
	speed: 0.2831s/iter; left time: 5036.5675s
	iters: 200, epoch: 15 | loss: 0.6236202
	speed: 0.1198s/iter; left time: 2118.9724s
Epoch: 15 cost time: 26.505056619644165
Epoch: 15, Steps: 208 | Train Loss: 0.770 Vali Loss: 6.696 Vali Acc: 0.138 Test Loss: 6.696 Test Acc: 0.138
Validation loss decreased (-0.137434 --> -0.138317).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6450248
	speed: 0.2778s/iter; left time: 4884.5137s
	iters: 200, epoch: 16 | loss: 0.6460409
	speed: 0.1273s/iter; left time: 2226.0965s
Epoch: 16 cost time: 27.053333044052124
Epoch: 16, Steps: 208 | Train Loss: 0.618 Vali Loss: 7.706 Vali Acc: 0.130 Test Loss: 7.706 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6988457
	speed: 0.2716s/iter; left time: 4717.7346s
	iters: 200, epoch: 17 | loss: 0.5091918
	speed: 0.1291s/iter; left time: 2230.5999s
Epoch: 17 cost time: 26.627047777175903
Epoch: 17, Steps: 208 | Train Loss: 0.557 Vali Loss: 7.638 Vali Acc: 0.140 Test Loss: 7.638 Test Acc: 0.140
Validation loss decreased (-0.138317 --> -0.139500).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2054711
	speed: 0.2747s/iter; left time: 4714.9618s
	iters: 200, epoch: 18 | loss: 0.5688105
	speed: 0.1152s/iter; left time: 1966.6940s
Epoch: 18 cost time: 25.32914090156555
Epoch: 18, Steps: 208 | Train Loss: 0.459 Vali Loss: 8.413 Vali Acc: 0.136 Test Loss: 8.413 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5333839
	speed: 0.2727s/iter; left time: 4623.8270s
	iters: 200, epoch: 19 | loss: 0.3752152
	speed: 0.1267s/iter; left time: 2135.8770s
Epoch: 19 cost time: 26.27769112586975
Epoch: 19, Steps: 208 | Train Loss: 0.410 Vali Loss: 8.687 Vali Acc: 0.141 Test Loss: 8.687 Test Acc: 0.141
Validation loss decreased (-0.139500 --> -0.140683).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6043105
	speed: 0.2380s/iter; left time: 3985.7296s
	iters: 200, epoch: 20 | loss: 0.4172559
	speed: 0.0996s/iter; left time: 1658.0012s
Epoch: 20 cost time: 20.270384073257446
Epoch: 20, Steps: 208 | Train Loss: 0.377 Vali Loss: 8.863 Vali Acc: 0.128 Test Loss: 8.863 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0909073
	speed: 0.2388s/iter; left time: 3950.0232s
	iters: 200, epoch: 21 | loss: 1.1237656
	speed: 0.1030s/iter; left time: 1693.0068s
Epoch: 21 cost time: 21.389655351638794
Epoch: 21, Steps: 208 | Train Loss: 0.356 Vali Loss: 8.669 Vali Acc: 0.143 Test Loss: 8.669 Test Acc: 0.143
Validation loss decreased (-0.140683 --> -0.143069).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.3061641
	speed: 0.2424s/iter; left time: 3958.5586s
	iters: 200, epoch: 22 | loss: 0.2678558
	speed: 0.1094s/iter; left time: 1776.6430s
Epoch: 22 cost time: 22.052481651306152
Epoch: 22, Steps: 208 | Train Loss: 0.338 Vali Loss: 9.582 Vali Acc: 0.131 Test Loss: 9.582 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3458964
	speed: 0.2375s/iter; left time: 3830.2794s
	iters: 200, epoch: 23 | loss: 0.4348186
	speed: 0.1070s/iter; left time: 1714.1954s
Epoch: 23 cost time: 21.439510107040405
Epoch: 23, Steps: 208 | Train Loss: 0.311 Vali Loss: 9.540 Vali Acc: 0.127 Test Loss: 9.540 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2417523
	speed: 0.2338s/iter; left time: 3721.9247s
	iters: 200, epoch: 24 | loss: 0.2291863
	speed: 0.1063s/iter; left time: 1681.1266s
Epoch: 24 cost time: 21.69593596458435
Epoch: 24, Steps: 208 | Train Loss: 0.280 Vali Loss: 9.676 Vali Acc: 0.137 Test Loss: 9.676 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.1334014
	speed: 0.2338s/iter; left time: 3673.0755s
	iters: 200, epoch: 25 | loss: 0.5196333
	speed: 0.0989s/iter; left time: 1544.0851s
Epoch: 25 cost time: 20.647486448287964
Epoch: 25, Steps: 208 | Train Loss: 0.252 Vali Loss: 10.323 Vali Acc: 0.135 Test Loss: 10.323 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.1182363
	speed: 0.2169s/iter; left time: 3361.5453s
	iters: 200, epoch: 26 | loss: 0.2487110
	speed: 0.0920s/iter; left time: 1417.5918s
Epoch: 26 cost time: 18.939706802368164
Epoch: 26, Steps: 208 | Train Loss: 0.248 Vali Loss: 10.325 Vali Acc: 0.131 Test Loss: 10.325 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1334533
	speed: 0.2366s/iter; left time: 3618.1344s
	iters: 200, epoch: 27 | loss: 0.0726011
	speed: 0.0872s/iter; left time: 1325.0497s
Epoch: 27 cost time: 19.39713478088379
Epoch: 27, Steps: 208 | Train Loss: 0.210 Vali Loss: 10.489 Vali Acc: 0.134 Test Loss: 10.489 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0903710
	speed: 0.2540s/iter; left time: 3831.4358s
	iters: 200, epoch: 28 | loss: 0.0862140
	speed: 0.1104s/iter; left time: 1653.6010s
Epoch: 28 cost time: 23.7993745803833
Epoch: 28, Steps: 208 | Train Loss: 0.220 Vali Loss: 10.758 Vali Acc: 0.131 Test Loss: 10.758 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.2454357
	speed: 0.2534s/iter; left time: 3770.0027s
	iters: 200, epoch: 29 | loss: 0.1348653
	speed: 0.1097s/iter; left time: 1621.2848s
Epoch: 29 cost time: 23.336024522781372
Epoch: 29, Steps: 208 | Train Loss: 0.191 Vali Loss: 11.149 Vali Acc: 0.128 Test Loss: 11.149 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0953791
	speed: 0.2607s/iter; left time: 3824.1120s
	iters: 200, epoch: 30 | loss: 0.0678500
	speed: 0.1119s/iter; left time: 1629.6908s
Epoch: 30 cost time: 24.07203722000122
Epoch: 30, Steps: 208 | Train Loss: 0.198 Vali Loss: 11.114 Vali Acc: 0.132 Test Loss: 11.114 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0736613
	speed: 0.2624s/iter; left time: 3794.3054s
	iters: 200, epoch: 31 | loss: 0.0051985
	speed: 0.1253s/iter; left time: 1799.5274s
Epoch: 31 cost time: 25.87104892730713
Epoch: 31, Steps: 208 | Train Loss: 0.206 Vali Loss: 11.806 Vali Acc: 0.135 Test Loss: 11.806 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14315538323889054
model parameter : 623655
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7870300
	speed: 0.1265s/iter; left time: 2617.7138s
	iters: 200, epoch: 1 | loss: 3.9564815
	speed: 0.1127s/iter; left time: 2322.7566s
Epoch: 1 cost time: 24.885745525360107
Epoch: 1, Steps: 208 | Train Loss: 3.936 Vali Loss: 4.080 Vali Acc: 0.042 Test Loss: 4.080 Test Acc: 0.042
Validation loss decreased (inf --> -0.042011).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1708264
	speed: 0.2362s/iter; left time: 4840.8037s
	iters: 200, epoch: 2 | loss: 3.4044991
	speed: 0.1052s/iter; left time: 2144.9945s
Epoch: 2 cost time: 22.677611112594604
Epoch: 2, Steps: 208 | Train Loss: 3.521 Vali Loss: 3.515 Vali Acc: 0.070 Test Loss: 3.515 Test Acc: 0.070
Validation loss decreased (-0.042011 --> -0.070051).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4411430
	speed: 0.2400s/iter; left time: 4867.8900s
	iters: 200, epoch: 3 | loss: 3.9283564
	speed: 0.1085s/iter; left time: 2189.6108s
Epoch: 3 cost time: 23.44737696647644
Epoch: 3, Steps: 208 | Train Loss: 3.187 Vali Loss: 4.075 Vali Acc: 0.074 Test Loss: 4.075 Test Acc: 0.074
Validation loss decreased (-0.070051 --> -0.074221).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2624521
	speed: 0.2408s/iter; left time: 4833.8390s
	iters: 200, epoch: 4 | loss: 2.8431003
	speed: 0.1175s/iter; left time: 2346.7815s
Epoch: 4 cost time: 24.242706537246704
Epoch: 4, Steps: 208 | Train Loss: 3.060 Vali Loss: 3.738 Vali Acc: 0.091 Test Loss: 3.738 Test Acc: 0.091
Validation loss decreased (-0.074221 --> -0.090926).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5467372
	speed: 0.2457s/iter; left time: 4882.0485s
	iters: 200, epoch: 5 | loss: 3.3018460
	speed: 0.1164s/iter; left time: 2300.3090s
Epoch: 5 cost time: 24.338136672973633
Epoch: 5, Steps: 208 | Train Loss: 2.982 Vali Loss: 4.137 Vali Acc: 0.107 Test Loss: 4.137 Test Acc: 0.107
Validation loss decreased (-0.090926 --> -0.106729).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5355914
	speed: 0.2349s/iter; left time: 4617.4081s
	iters: 200, epoch: 6 | loss: 3.6876502
	speed: 0.1074s/iter; left time: 2100.8971s
Epoch: 6 cost time: 22.321524381637573
Epoch: 6, Steps: 208 | Train Loss: 2.864 Vali Loss: 4.136 Vali Acc: 0.087 Test Loss: 4.136 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1704822
	speed: 0.2194s/iter; left time: 4267.8584s
	iters: 200, epoch: 7 | loss: 3.7262177
	speed: 0.0798s/iter; left time: 1543.8212s
Epoch: 7 cost time: 18.393601894378662
Epoch: 7, Steps: 208 | Train Loss: 2.642 Vali Loss: 4.244 Vali Acc: 0.113 Test Loss: 4.244 Test Acc: 0.113
Validation loss decreased (-0.106729 --> -0.112991).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3357561
	speed: 0.2133s/iter; left time: 4104.8146s
	iters: 200, epoch: 8 | loss: 3.0694656
	speed: 0.0886s/iter; left time: 1695.7002s
Epoch: 8 cost time: 19.20720934867859
Epoch: 8, Steps: 208 | Train Loss: 2.365 Vali Loss: 4.788 Vali Acc: 0.109 Test Loss: 4.788 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9389310
	speed: 0.2020s/iter; left time: 3845.1995s
	iters: 200, epoch: 9 | loss: 2.7073081
	speed: 0.0811s/iter; left time: 1535.9081s
Epoch: 9 cost time: 16.791626930236816
Epoch: 9, Steps: 208 | Train Loss: 2.101 Vali Loss: 5.070 Vali Acc: 0.127 Test Loss: 5.070 Test Acc: 0.127
Validation loss decreased (-0.112991 --> -0.127000).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9043868
	speed: 0.1940s/iter; left time: 3653.6363s
	iters: 200, epoch: 10 | loss: 1.9594085
	speed: 0.0688s/iter; left time: 1288.3540s
Epoch: 10 cost time: 15.307431697845459
Epoch: 10, Steps: 208 | Train Loss: 1.821 Vali Loss: 5.324 Vali Acc: 0.108 Test Loss: 5.324 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4369627
	speed: 0.2011s/iter; left time: 3744.9795s
	iters: 200, epoch: 11 | loss: 1.8097938
	speed: 0.0750s/iter; left time: 1389.9600s
Epoch: 11 cost time: 15.729317665100098
Epoch: 11, Steps: 208 | Train Loss: 1.526 Vali Loss: 5.894 Vali Acc: 0.117 Test Loss: 5.894 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1199676
	speed: 0.1965s/iter; left time: 3617.5841s
	iters: 200, epoch: 12 | loss: 1.9668921
	speed: 0.0818s/iter; left time: 1497.3722s
Epoch: 12 cost time: 16.82423710823059
Epoch: 12, Steps: 208 | Train Loss: 1.270 Vali Loss: 6.159 Vali Acc: 0.116 Test Loss: 6.159 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9225570
	speed: 0.1923s/iter; left time: 3500.1612s
	iters: 200, epoch: 13 | loss: 1.3824878
	speed: 0.0711s/iter; left time: 1286.6182s
Epoch: 13 cost time: 15.197688817977905
Epoch: 13, Steps: 208 | Train Loss: 1.042 Vali Loss: 6.374 Vali Acc: 0.118 Test Loss: 6.374 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2340456
	speed: 0.2073s/iter; left time: 3730.4073s
	iters: 200, epoch: 14 | loss: 0.3864780
	speed: 0.0746s/iter; left time: 1335.0594s
Epoch: 14 cost time: 16.766337394714355
Epoch: 14, Steps: 208 | Train Loss: 0.857 Vali Loss: 7.035 Vali Acc: 0.115 Test Loss: 7.035 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.4112327
	speed: 0.2021s/iter; left time: 3594.7141s
	iters: 200, epoch: 15 | loss: 0.6366490
	speed: 0.0781s/iter; left time: 1380.6450s
Epoch: 15 cost time: 16.567360877990723
Epoch: 15, Steps: 208 | Train Loss: 0.746 Vali Loss: 6.891 Vali Acc: 0.116 Test Loss: 6.891 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.7699843
	speed: 0.2285s/iter; left time: 4017.3596s
	iters: 200, epoch: 16 | loss: 0.5444144
	speed: 0.1034s/iter; left time: 1806.8480s
Epoch: 16 cost time: 22.05588412284851
Epoch: 16, Steps: 208 | Train Loss: 0.653 Vali Loss: 8.036 Vali Acc: 0.118 Test Loss: 8.036 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8757821
	speed: 0.2447s/iter; left time: 4250.4286s
	iters: 200, epoch: 17 | loss: 1.5894436
	speed: 0.1125s/iter; left time: 1942.5468s
Epoch: 17 cost time: 23.343665838241577
Epoch: 17, Steps: 208 | Train Loss: 0.565 Vali Loss: 7.957 Vali Acc: 0.113 Test Loss: 7.957 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5598717
	speed: 0.2311s/iter; left time: 3966.2737s
	iters: 200, epoch: 18 | loss: 1.6458414
	speed: 0.0879s/iter; left time: 1499.9187s
Epoch: 18 cost time: 19.932429313659668
Epoch: 18, Steps: 208 | Train Loss: 0.497 Vali Loss: 8.534 Vali Acc: 0.124 Test Loss: 8.534 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.3385266
	speed: 0.1350s/iter; left time: 2288.3623s
	iters: 200, epoch: 19 | loss: 0.2665017
	speed: 0.0342s/iter; left time: 577.0626s
Epoch: 19 cost time: 7.980772495269775
Epoch: 19, Steps: 208 | Train Loss: 0.426 Vali Loss: 9.299 Vali Acc: 0.110 Test Loss: 9.299 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12705040262451536
model parameter : 432167
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4817982
	speed: 0.0684s/iter; left time: 1416.5094s
	iters: 200, epoch: 1 | loss: 3.8858380
	speed: 0.0502s/iter; left time: 1034.6289s
Epoch: 1 cost time: 12.327420711517334
Epoch: 1, Steps: 208 | Train Loss: 3.862 Vali Loss: 3.896 Vali Acc: 0.058 Test Loss: 3.896 Test Acc: 0.058
Validation loss decreased (inf --> -0.057820).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6597176
	speed: 0.1729s/iter; left time: 3543.4774s
	iters: 200, epoch: 2 | loss: 3.3453472
	speed: 0.0513s/iter; left time: 1047.0693s
Epoch: 2 cost time: 10.84116244316101
Epoch: 2, Steps: 208 | Train Loss: 3.535 Vali Loss: 3.843 Vali Acc: 0.066 Test Loss: 3.843 Test Acc: 0.066
Validation loss decreased (-0.057820 --> -0.066171).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2447996
	speed: 0.1769s/iter; left time: 3588.1876s
	iters: 200, epoch: 3 | loss: 3.3838460
	speed: 0.0483s/iter; left time: 974.9792s
Epoch: 3 cost time: 10.657867670059204
Epoch: 3, Steps: 208 | Train Loss: 3.223 Vali Loss: 3.820 Vali Acc: 0.081 Test Loss: 3.820 Test Acc: 0.081
Validation loss decreased (-0.066171 --> -0.081381).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5920579
	speed: 0.1663s/iter; left time: 3338.6123s
	iters: 200, epoch: 4 | loss: 3.6764874
	speed: 0.0424s/iter; left time: 847.9437s
Epoch: 4 cost time: 9.649909257888794
Epoch: 4, Steps: 208 | Train Loss: 3.093 Vali Loss: 3.997 Vali Acc: 0.083 Test Loss: 3.997 Test Acc: 0.083
Validation loss decreased (-0.081381 --> -0.083169).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7703118
	speed: 0.1708s/iter; left time: 3392.7361s
	iters: 200, epoch: 5 | loss: 3.3620136
	speed: 0.0483s/iter; left time: 953.8897s
Epoch: 5 cost time: 10.356903314590454
Epoch: 5, Steps: 208 | Train Loss: 2.949 Vali Loss: 4.163 Vali Acc: 0.094 Test Loss: 4.163 Test Acc: 0.094
Validation loss decreased (-0.083169 --> -0.093606).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6228631
	speed: 0.1731s/iter; left time: 3404.1957s
	iters: 200, epoch: 6 | loss: 3.3389840
	speed: 0.0491s/iter; left time: 959.9979s
Epoch: 6 cost time: 10.810948848724365
Epoch: 6, Steps: 208 | Train Loss: 2.791 Vali Loss: 4.160 Vali Acc: 0.102 Test Loss: 4.160 Test Acc: 0.102
Validation loss decreased (-0.093606 --> -0.101957).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8584068
	speed: 0.1748s/iter; left time: 3399.8823s
	iters: 200, epoch: 7 | loss: 2.9385176
	speed: 0.0417s/iter; left time: 806.4111s
Epoch: 7 cost time: 10.025424003601074
Epoch: 7, Steps: 208 | Train Loss: 2.581 Vali Loss: 4.516 Vali Acc: 0.114 Test Loss: 4.516 Test Acc: 0.114
Validation loss decreased (-0.101957 --> -0.114181).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3819218
	speed: 0.1590s/iter; left time: 3059.7308s
	iters: 200, epoch: 8 | loss: 2.5617962
	speed: 0.0450s/iter; left time: 860.9160s
Epoch: 8 cost time: 9.875985622406006
Epoch: 8, Steps: 208 | Train Loss: 2.306 Vali Loss: 4.832 Vali Acc: 0.109 Test Loss: 4.832 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8707696
	speed: 0.1646s/iter; left time: 3132.6156s
	iters: 200, epoch: 9 | loss: 2.7489960
	speed: 0.0456s/iter; left time: 862.8259s
Epoch: 9 cost time: 9.939852952957153
Epoch: 9, Steps: 208 | Train Loss: 2.080 Vali Loss: 5.214 Vali Acc: 0.113 Test Loss: 5.214 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3502434
	speed: 0.1735s/iter; left time: 3266.5937s
	iters: 200, epoch: 10 | loss: 1.9484122
	speed: 0.0457s/iter; left time: 855.6462s
Epoch: 10 cost time: 10.460155725479126
Epoch: 10, Steps: 208 | Train Loss: 1.851 Vali Loss: 5.086 Vali Acc: 0.116 Test Loss: 5.086 Test Acc: 0.116
Validation loss decreased (-0.114181 --> -0.115666).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5813396
	speed: 0.1626s/iter; left time: 3028.3044s
	iters: 200, epoch: 11 | loss: 2.5055456
	speed: 0.0465s/iter; left time: 861.3859s
Epoch: 11 cost time: 10.019795656204224
Epoch: 11, Steps: 208 | Train Loss: 1.567 Vali Loss: 5.465 Vali Acc: 0.114 Test Loss: 5.465 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6852653
	speed: 0.1664s/iter; left time: 3063.5929s
	iters: 200, epoch: 12 | loss: 1.7046169
	speed: 0.0466s/iter; left time: 853.0032s
Epoch: 12 cost time: 10.211381435394287
Epoch: 12, Steps: 208 | Train Loss: 1.340 Vali Loss: 5.913 Vali Acc: 0.122 Test Loss: 5.913 Test Acc: 0.122
Validation loss decreased (-0.115666 --> -0.121623).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9282420
	speed: 0.1616s/iter; left time: 2941.4253s
	iters: 200, epoch: 13 | loss: 0.7440944
	speed: 0.0428s/iter; left time: 774.3984s
Epoch: 13 cost time: 9.001106977462769
Epoch: 13, Steps: 208 | Train Loss: 1.131 Vali Loss: 6.654 Vali Acc: 0.126 Test Loss: 6.654 Test Acc: 0.126
Validation loss decreased (-0.121623 --> -0.125493).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6303689
	speed: 0.1616s/iter; left time: 2907.6694s
	iters: 200, epoch: 14 | loss: 0.8793604
	speed: 0.0434s/iter; left time: 776.0568s
Epoch: 14 cost time: 9.58111310005188
Epoch: 14, Steps: 208 | Train Loss: 0.931 Vali Loss: 6.736 Vali Acc: 0.125 Test Loss: 6.736 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6000986
	speed: 0.1580s/iter; left time: 2810.8860s
	iters: 200, epoch: 15 | loss: 1.1985810
	speed: 0.0399s/iter; left time: 705.8226s
Epoch: 15 cost time: 8.899308681488037
Epoch: 15, Steps: 208 | Train Loss: 0.828 Vali Loss: 6.862 Vali Acc: 0.118 Test Loss: 6.862 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0900837
	speed: 0.1528s/iter; left time: 2686.9654s
	iters: 200, epoch: 16 | loss: 0.8480065
	speed: 0.0391s/iter; left time: 683.1753s
Epoch: 16 cost time: 8.617628812789917
Epoch: 16, Steps: 208 | Train Loss: 0.711 Vali Loss: 7.371 Vali Acc: 0.112 Test Loss: 7.371 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1306227
	speed: 0.1524s/iter; left time: 2647.7796s
	iters: 200, epoch: 17 | loss: 1.1744920
	speed: 0.0412s/iter; left time: 711.3056s
Epoch: 17 cost time: 9.136566162109375
Epoch: 17, Steps: 208 | Train Loss: 0.615 Vali Loss: 7.669 Vali Acc: 0.125 Test Loss: 7.669 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6451496
	speed: 0.1577s/iter; left time: 2707.7058s
	iters: 200, epoch: 18 | loss: 0.2190900
	speed: 0.0409s/iter; left time: 697.7515s
Epoch: 18 cost time: 9.062539339065552
Epoch: 18, Steps: 208 | Train Loss: 0.553 Vali Loss: 8.350 Vali Acc: 0.119 Test Loss: 8.350 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1786764
	speed: 0.1472s/iter; left time: 2495.8392s
	iters: 200, epoch: 19 | loss: 0.3223189
	speed: 0.0386s/iter; left time: 649.9195s
Epoch: 19 cost time: 8.592689752578735
Epoch: 19, Steps: 208 | Train Loss: 0.472 Vali Loss: 8.860 Vali Acc: 0.120 Test Loss: 8.860 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0837801
	speed: 0.1567s/iter; left time: 2624.9418s
	iters: 200, epoch: 20 | loss: 0.3838289
	speed: 0.0410s/iter; left time: 683.3097s
Epoch: 20 cost time: 9.14773964881897
Epoch: 20, Steps: 208 | Train Loss: 0.447 Vali Loss: 9.086 Vali Acc: 0.118 Test Loss: 9.086 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.4838628
	speed: 0.1553s/iter; left time: 2569.5424s
	iters: 200, epoch: 21 | loss: 0.0964509
	speed: 0.0464s/iter; left time: 762.2876s
Epoch: 21 cost time: 9.917521953582764
Epoch: 21, Steps: 208 | Train Loss: 0.416 Vali Loss: 9.736 Vali Acc: 0.116 Test Loss: 9.736 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.8932555
	speed: 0.1708s/iter; left time: 2789.4267s
	iters: 200, epoch: 22 | loss: 0.1956498
	speed: 0.0463s/iter; left time: 751.2446s
Epoch: 22 cost time: 10.227876424789429
Epoch: 22, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.623 Vali Acc: 0.116 Test Loss: 9.623 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4603332
	speed: 0.1683s/iter; left time: 2713.9026s
	iters: 200, epoch: 23 | loss: 0.7286922
	speed: 0.0470s/iter; left time: 753.6450s
Epoch: 23 cost time: 10.332993984222412
Epoch: 23, Steps: 208 | Train Loss: 0.346 Vali Loss: 10.200 Vali Acc: 0.118 Test Loss: 10.200 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12555920071577692
model parameter : 350503
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1025643
	speed: 0.0678s/iter; left time: 1404.4987s
	iters: 200, epoch: 1 | loss: 3.9373622
	speed: 0.0487s/iter; left time: 1003.5075s
Epoch: 1 cost time: 12.155263185501099
Epoch: 1, Steps: 208 | Train Loss: 3.828 Vali Loss: 3.888 Vali Acc: 0.055 Test Loss: 3.888 Test Acc: 0.055
Validation loss decreased (inf --> -0.054539).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8264341
	speed: 0.1722s/iter; left time: 3528.3259s
	iters: 200, epoch: 2 | loss: 3.4980640
	speed: 0.0510s/iter; left time: 1040.8562s
Epoch: 2 cost time: 11.065616130828857
Epoch: 2, Steps: 208 | Train Loss: 3.616 Vali Loss: 3.745 Vali Acc: 0.075 Test Loss: 3.745 Test Acc: 0.075
Validation loss decreased (-0.054539 --> -0.074821).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5126634
	speed: 0.1756s/iter; left time: 3561.9582s
	iters: 200, epoch: 3 | loss: 4.2224483
	speed: 0.0505s/iter; left time: 1019.4416s
Epoch: 3 cost time: 10.90689730644226
Epoch: 3, Steps: 208 | Train Loss: 3.309 Vali Loss: 4.059 Vali Acc: 0.067 Test Loss: 4.059 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2682581
	speed: 0.1730s/iter; left time: 3472.8704s
	iters: 200, epoch: 4 | loss: 3.2595048
	speed: 0.0522s/iter; left time: 1042.5980s
Epoch: 4 cost time: 11.175100564956665
Epoch: 4, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.850 Vali Acc: 0.086 Test Loss: 3.850 Test Acc: 0.086
Validation loss decreased (-0.074821 --> -0.086153).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1185968
	speed: 0.1761s/iter; left time: 3498.3602s
	iters: 200, epoch: 5 | loss: 2.8318193
	speed: 0.0535s/iter; left time: 1058.5634s
Epoch: 5 cost time: 11.52364206314087
Epoch: 5, Steps: 208 | Train Loss: 2.975 Vali Loss: 4.025 Vali Acc: 0.089 Test Loss: 4.025 Test Acc: 0.089
Validation loss decreased (-0.086153 --> -0.089134).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4955559
	speed: 0.1844s/iter; left time: 3625.8718s
	iters: 200, epoch: 6 | loss: 2.1116896
	speed: 0.0511s/iter; left time: 999.7474s
Epoch: 6 cost time: 11.460164308547974
Epoch: 6, Steps: 208 | Train Loss: 2.750 Vali Loss: 4.284 Vali Acc: 0.100 Test Loss: 4.284 Test Acc: 0.100
Validation loss decreased (-0.089134 --> -0.099868).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1202915
	speed: 0.1832s/iter; left time: 3563.5686s
	iters: 200, epoch: 7 | loss: 3.1606941
	speed: 0.0529s/iter; left time: 1023.4529s
Epoch: 7 cost time: 11.699100494384766
Epoch: 7, Steps: 208 | Train Loss: 2.567 Vali Loss: 4.599 Vali Acc: 0.102 Test Loss: 4.599 Test Acc: 0.102
Validation loss decreased (-0.099868 --> -0.101952).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1923733
	speed: 0.1768s/iter; left time: 3402.1805s
	iters: 200, epoch: 8 | loss: 2.8253036
	speed: 0.0553s/iter; left time: 1059.4973s
Epoch: 8 cost time: 12.002636909484863
Epoch: 8, Steps: 208 | Train Loss: 2.300 Vali Loss: 4.567 Vali Acc: 0.092 Test Loss: 4.567 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5747936
	speed: 0.1793s/iter; left time: 3413.5931s
	iters: 200, epoch: 9 | loss: 3.2239692
	speed: 0.0501s/iter; left time: 948.7668s
Epoch: 9 cost time: 11.28866457939148
Epoch: 9, Steps: 208 | Train Loss: 2.010 Vali Loss: 4.941 Vali Acc: 0.097 Test Loss: 4.941 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.2988126
	speed: 0.1838s/iter; left time: 3459.9750s
	iters: 200, epoch: 10 | loss: 2.7767713
	speed: 0.0443s/iter; left time: 830.2945s
Epoch: 10 cost time: 10.644229650497437
Epoch: 10, Steps: 208 | Train Loss: 1.762 Vali Loss: 5.350 Vali Acc: 0.108 Test Loss: 5.350 Test Acc: 0.108
Validation loss decreased (-0.101952 --> -0.107910).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8616735
	speed: 0.1723s/iter; left time: 3208.2654s
	iters: 200, epoch: 11 | loss: 2.0795434
	speed: 0.0462s/iter; left time: 855.0389s
Epoch: 11 cost time: 9.962270736694336
Epoch: 11, Steps: 208 | Train Loss: 1.525 Vali Loss: 5.746 Vali Acc: 0.112 Test Loss: 5.746 Test Acc: 0.112
Validation loss decreased (-0.107910 --> -0.111484).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1223079
	speed: 0.1701s/iter; left time: 3132.1688s
	iters: 200, epoch: 12 | loss: 0.6773342
	speed: 0.0471s/iter; left time: 863.1969s
Epoch: 12 cost time: 10.260528087615967
Epoch: 12, Steps: 208 | Train Loss: 1.298 Vali Loss: 5.844 Vali Acc: 0.108 Test Loss: 5.844 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1757437
	speed: 0.1747s/iter; left time: 3179.9188s
	iters: 200, epoch: 13 | loss: 1.1637269
	speed: 0.0447s/iter; left time: 808.7399s
Epoch: 13 cost time: 9.787293910980225
Epoch: 13, Steps: 208 | Train Loss: 1.073 Vali Loss: 6.282 Vali Acc: 0.113 Test Loss: 6.282 Test Acc: 0.113
Validation loss decreased (-0.111484 --> -0.113269).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7358689
	speed: 0.1726s/iter; left time: 3106.1646s
	iters: 200, epoch: 14 | loss: 1.8453007
	speed: 0.0439s/iter; left time: 786.4602s
Epoch: 14 cost time: 9.707677841186523
Epoch: 14, Steps: 208 | Train Loss: 0.893 Vali Loss: 7.114 Vali Acc: 0.111 Test Loss: 7.114 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8405480
	speed: 0.1776s/iter; left time: 3159.1026s
	iters: 200, epoch: 15 | loss: 0.6646397
	speed: 0.0446s/iter; left time: 788.9920s
Epoch: 15 cost time: 9.91943645477295
Epoch: 15, Steps: 208 | Train Loss: 0.764 Vali Loss: 7.319 Vali Acc: 0.102 Test Loss: 7.319 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7477649
	speed: 0.1667s/iter; left time: 2930.3319s
	iters: 200, epoch: 16 | loss: 0.4071098
	speed: 0.0440s/iter; left time: 769.5383s
Epoch: 16 cost time: 9.676809072494507
Epoch: 16, Steps: 208 | Train Loss: 0.661 Vali Loss: 7.700 Vali Acc: 0.119 Test Loss: 7.700 Test Acc: 0.119
Validation loss decreased (-0.113269 --> -0.118921).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4275138
	speed: 0.1698s/iter; left time: 2950.0198s
	iters: 200, epoch: 17 | loss: 0.7105307
	speed: 0.0440s/iter; left time: 760.4607s
Epoch: 17 cost time: 9.881599426269531
Epoch: 17, Steps: 208 | Train Loss: 0.566 Vali Loss: 8.178 Vali Acc: 0.112 Test Loss: 8.178 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0786593
	speed: 0.1667s/iter; left time: 2861.1361s
	iters: 200, epoch: 18 | loss: 0.5067188
	speed: 0.0454s/iter; left time: 774.2071s
Epoch: 18 cost time: 9.836897611618042
Epoch: 18, Steps: 208 | Train Loss: 0.507 Vali Loss: 8.538 Vali Acc: 0.111 Test Loss: 8.538 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.6099074
	speed: 0.1704s/iter; left time: 2889.2213s
	iters: 200, epoch: 19 | loss: 0.4562389
	speed: 0.0508s/iter; left time: 855.8299s
Epoch: 19 cost time: 10.605797052383423
Epoch: 19, Steps: 208 | Train Loss: 0.444 Vali Loss: 8.951 Vali Acc: 0.112 Test Loss: 8.951 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2358107
	speed: 0.1757s/iter; left time: 2942.7651s
	iters: 200, epoch: 20 | loss: 0.3541780
	speed: 0.0497s/iter; left time: 827.8692s
Epoch: 20 cost time: 10.980090856552124
Epoch: 20, Steps: 208 | Train Loss: 0.418 Vali Loss: 9.308 Vali Acc: 0.121 Test Loss: 9.308 Test Acc: 0.121
Validation loss decreased (-0.118921 --> -0.120993).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0711659
	speed: 0.1803s/iter; left time: 2981.6178s
	iters: 200, epoch: 21 | loss: 0.3680040
	speed: 0.0499s/iter; left time: 820.8252s
Epoch: 21 cost time: 10.975421905517578
Epoch: 21, Steps: 208 | Train Loss: 0.371 Vali Loss: 9.587 Vali Acc: 0.106 Test Loss: 9.587 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1644903
	speed: 0.1765s/iter; left time: 2882.7985s
	iters: 200, epoch: 22 | loss: 1.0280021
	speed: 0.0487s/iter; left time: 791.2888s
Epoch: 22 cost time: 10.825207233428955
Epoch: 22, Steps: 208 | Train Loss: 0.372 Vali Loss: 9.939 Vali Acc: 0.115 Test Loss: 9.939 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0855246
	speed: 0.1880s/iter; left time: 3031.9606s
	iters: 200, epoch: 23 | loss: 0.5093077
	speed: 0.0602s/iter; left time: 964.6321s
Epoch: 23 cost time: 12.692216157913208
Epoch: 23, Steps: 208 | Train Loss: 0.352 Vali Loss: 10.240 Vali Acc: 0.108 Test Loss: 10.240 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1125301
	speed: 0.1978s/iter; left time: 3147.9049s
	iters: 200, epoch: 24 | loss: 0.2592344
	speed: 0.0515s/iter; left time: 815.0886s
Epoch: 24 cost time: 11.749798774719238
Epoch: 24, Steps: 208 | Train Loss: 0.319 Vali Loss: 10.582 Vali Acc: 0.102 Test Loss: 10.582 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2268240
	speed: 0.1891s/iter; left time: 2970.1634s
	iters: 200, epoch: 25 | loss: 0.1854185
	speed: 0.0543s/iter; left time: 847.8920s
Epoch: 25 cost time: 12.141403913497925
Epoch: 25, Steps: 208 | Train Loss: 0.305 Vali Loss: 11.069 Vali Acc: 0.112 Test Loss: 11.069 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.8274791
	speed: 0.1911s/iter; left time: 2962.9089s
	iters: 200, epoch: 26 | loss: 0.4490732
	speed: 0.0617s/iter; left time: 950.4482s
Epoch: 26 cost time: 12.66691279411316
Epoch: 26, Steps: 208 | Train Loss: 0.271 Vali Loss: 11.435 Vali Acc: 0.121 Test Loss: 11.435 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6833317
	speed: 0.1901s/iter; left time: 2907.0439s
	iters: 200, epoch: 27 | loss: 0.2428061
	speed: 0.0497s/iter; left time: 754.8010s
Epoch: 27 cost time: 11.10998010635376
Epoch: 27, Steps: 208 | Train Loss: 0.271 Vali Loss: 11.522 Vali Acc: 0.109 Test Loss: 11.522 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0418439
	speed: 0.1853s/iter; left time: 2795.6708s
	iters: 200, epoch: 28 | loss: 0.9851310
	speed: 0.0548s/iter; left time: 820.4306s
Epoch: 28 cost time: 11.71974515914917
Epoch: 28, Steps: 208 | Train Loss: 0.275 Vali Loss: 11.972 Vali Acc: 0.104 Test Loss: 11.972 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.4477283
	speed: 0.1857s/iter; left time: 2762.4181s
	iters: 200, epoch: 29 | loss: 0.3276120
	speed: 0.0511s/iter; left time: 754.7638s
Epoch: 29 cost time: 11.482182502746582
Epoch: 29, Steps: 208 | Train Loss: 0.286 Vali Loss: 12.201 Vali Acc: 0.109 Test Loss: 12.201 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.4514597
	speed: 0.1807s/iter; left time: 2650.6904s
	iters: 200, epoch: 30 | loss: 0.0237693
	speed: 0.0505s/iter; left time: 736.3036s
Epoch: 30 cost time: 10.821335315704346
Epoch: 30, Steps: 208 | Train Loss: 0.241 Vali Loss: 12.351 Vali Acc: 0.107 Test Loss: 12.351 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12108559498956159
model parameter : 296295
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.4492230
	speed: 0.1731s/iter; left time: 3582.4442s
	iters: 200, epoch: 1 | loss: 4.1854134
	speed: 0.1604s/iter; left time: 3303.5283s
Epoch: 1 cost time: 34.658010959625244
Epoch: 1, Steps: 208 | Train Loss: 4.557 Vali Loss: 3.521 Vali Acc: 0.074 Test Loss: 3.521 Test Acc: 0.074
Validation loss decreased (inf --> -0.074227).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1913316
	speed: 0.3870s/iter; left time: 7930.5236s
	iters: 200, epoch: 2 | loss: 3.0986705
	speed: 0.1344s/iter; left time: 2741.6294s
Epoch: 2 cost time: 30.433109521865845
Epoch: 2, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.959 Vali Acc: 0.082 Test Loss: 3.959 Test Acc: 0.082
Validation loss decreased (-0.074227 --> -0.081678).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5078673
	speed: 0.3760s/iter; left time: 7627.0932s
	iters: 200, epoch: 3 | loss: 4.4378371
	speed: 0.1443s/iter; left time: 2913.2403s
Epoch: 3 cost time: 30.982420682907104
Epoch: 3, Steps: 208 | Train Loss: 4.041 Vali Loss: 4.250 Vali Acc: 0.089 Test Loss: 4.250 Test Acc: 0.089
Validation loss decreased (-0.081678 --> -0.088833).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8649774
	speed: 0.3685s/iter; left time: 7397.8002s
	iters: 200, epoch: 4 | loss: 3.8115613
	speed: 0.1455s/iter; left time: 2907.3654s
Epoch: 4 cost time: 31.603235721588135
Epoch: 4, Steps: 208 | Train Loss: 4.169 Vali Loss: 3.942 Vali Acc: 0.104 Test Loss: 3.942 Test Acc: 0.104
Validation loss decreased (-0.088833 --> -0.104046).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.9379478
	speed: 0.3791s/iter; left time: 7532.4988s
	iters: 200, epoch: 5 | loss: 4.7986884
	speed: 0.1850s/iter; left time: 3657.6660s
Epoch: 5 cost time: 35.9872772693634
Epoch: 5, Steps: 208 | Train Loss: 4.170 Vali Loss: 4.395 Vali Acc: 0.112 Test Loss: 4.395 Test Acc: 0.112
Validation loss decreased (-0.104046 --> -0.112094).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.4130301
	speed: 0.4262s/iter; left time: 8380.1877s
	iters: 200, epoch: 6 | loss: 5.7220902
	speed: 0.1821s/iter; left time: 3562.8613s
Epoch: 6 cost time: 38.513449907302856
Epoch: 6, Steps: 208 | Train Loss: 3.990 Vali Loss: 5.032 Vali Acc: 0.090 Test Loss: 5.032 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6247752
	speed: 0.4406s/iter; left time: 8570.0953s
	iters: 200, epoch: 7 | loss: 4.4958358
	speed: 0.1986s/iter; left time: 3844.2358s
Epoch: 7 cost time: 41.64950919151306
Epoch: 7, Steps: 208 | Train Loss: 3.558 Vali Loss: 5.030 Vali Acc: 0.115 Test Loss: 5.030 Test Acc: 0.115
Validation loss decreased (-0.112094 --> -0.114772).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.6699853
	speed: 0.4515s/iter; left time: 8688.7685s
	iters: 200, epoch: 8 | loss: 3.3928435
	speed: 0.1714s/iter; left time: 3281.9556s
Epoch: 8 cost time: 38.5850510597229
Epoch: 8, Steps: 208 | Train Loss: 2.675 Vali Loss: 7.177 Vali Acc: 0.088 Test Loss: 7.177 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3599681
	speed: 0.4188s/iter; left time: 7973.2051s
	iters: 200, epoch: 9 | loss: 2.5724061
	speed: 0.1774s/iter; left time: 3360.1654s
Epoch: 9 cost time: 37.766213178634644
Epoch: 9, Steps: 208 | Train Loss: 1.901 Vali Loss: 7.070 Vali Acc: 0.077 Test Loss: 7.070 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2710192
	speed: 0.4395s/iter; left time: 8274.7503s
	iters: 200, epoch: 10 | loss: 2.0278015
	speed: 0.1792s/iter; left time: 3356.6497s
Epoch: 10 cost time: 38.449065923690796
Epoch: 10, Steps: 208 | Train Loss: 1.497 Vali Loss: 6.654 Vali Acc: 0.114 Test Loss: 6.654 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6104736
	speed: 0.4139s/iter; left time: 7707.1066s
	iters: 200, epoch: 11 | loss: 0.8902567
	speed: 0.1503s/iter; left time: 2783.9567s
Epoch: 11 cost time: 34.70506405830383
Epoch: 11, Steps: 208 | Train Loss: 1.116 Vali Loss: 6.165 Vali Acc: 0.108 Test Loss: 6.165 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.9762905
	speed: 0.3512s/iter; left time: 6465.7939s
	iters: 200, epoch: 12 | loss: 0.9454238
	speed: 0.1411s/iter; left time: 2583.6063s
Epoch: 12 cost time: 29.905749797821045
Epoch: 12, Steps: 208 | Train Loss: 0.989 Vali Loss: 6.936 Vali Acc: 0.132 Test Loss: 6.936 Test Acc: 0.132
Validation loss decreased (-0.114772 --> -0.132051).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3303114
	speed: 0.3244s/iter; left time: 5905.1878s
	iters: 200, epoch: 13 | loss: 0.7106794
	speed: 0.1035s/iter; left time: 1874.3297s
Epoch: 13 cost time: 23.143797636032104
Epoch: 13, Steps: 208 | Train Loss: 0.777 Vali Loss: 7.588 Vali Acc: 0.128 Test Loss: 7.588 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1615086
	speed: 0.3262s/iter; left time: 5871.3192s
	iters: 200, epoch: 14 | loss: 0.8125812
	speed: 0.1151s/iter; left time: 2059.3714s
Epoch: 14 cost time: 26.008553981781006
Epoch: 14, Steps: 208 | Train Loss: 0.666 Vali Loss: 8.312 Vali Acc: 0.122 Test Loss: 8.312 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6982248
	speed: 0.3291s/iter; left time: 5853.9360s
	iters: 200, epoch: 15 | loss: 0.6268165
	speed: 0.1163s/iter; left time: 2056.4233s
Epoch: 15 cost time: 25.56687092781067
Epoch: 15, Steps: 208 | Train Loss: 0.524 Vali Loss: 8.651 Vali Acc: 0.121 Test Loss: 8.651 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9148961
	speed: 0.3722s/iter; left time: 6544.1626s
	iters: 200, epoch: 16 | loss: 0.3016982
	speed: 0.1605s/iter; left time: 2806.0485s
Epoch: 16 cost time: 34.0586621761322
Epoch: 16, Steps: 208 | Train Loss: 0.433 Vali Loss: 8.666 Vali Acc: 0.123 Test Loss: 8.666 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5384602
	speed: 0.4188s/iter; left time: 7275.3992s
	iters: 200, epoch: 17 | loss: 0.5788776
	speed: 0.1883s/iter; left time: 3252.9042s
Epoch: 17 cost time: 39.8422417640686
Epoch: 17, Steps: 208 | Train Loss: 0.382 Vali Loss: 9.100 Vali Acc: 0.109 Test Loss: 9.100 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6169654
	speed: 0.4050s/iter; left time: 6951.2786s
	iters: 200, epoch: 18 | loss: 0.6444062
	speed: 0.1713s/iter; left time: 2923.3523s
Epoch: 18 cost time: 36.23548197746277
Epoch: 18, Steps: 208 | Train Loss: 0.320 Vali Loss: 11.141 Vali Acc: 0.119 Test Loss: 11.141 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1612105
	speed: 0.3989s/iter; left time: 6764.1985s
	iters: 200, epoch: 19 | loss: 0.4202176
	speed: 0.1777s/iter; left time: 2995.5276s
Epoch: 19 cost time: 37.11160063743591
Epoch: 19, Steps: 208 | Train Loss: 0.276 Vali Loss: 9.978 Vali Acc: 0.120 Test Loss: 9.978 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.8001660
	speed: 0.3924s/iter; left time: 6572.6335s
	iters: 200, epoch: 20 | loss: 0.8857054
	speed: 0.1679s/iter; left time: 2795.5506s
Epoch: 20 cost time: 35.38668441772461
Epoch: 20, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.012 Vali Acc: 0.116 Test Loss: 11.012 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0449131
	speed: 0.3919s/iter; left time: 6482.2445s
	iters: 200, epoch: 21 | loss: 0.1307315
	speed: 0.1659s/iter; left time: 2727.3679s
Epoch: 21 cost time: 34.531012773513794
Epoch: 21, Steps: 208 | Train Loss: 0.222 Vali Loss: 11.257 Vali Acc: 0.124 Test Loss: 11.257 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0995879
	speed: 0.3454s/iter; left time: 5641.6856s
	iters: 200, epoch: 22 | loss: 0.0697682
	speed: 0.1292s/iter; left time: 2097.4748s
Epoch: 22 cost time: 28.014934301376343
Epoch: 22, Steps: 208 | Train Loss: 0.195 Vali Loss: 12.298 Vali Acc: 0.118 Test Loss: 12.298 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13212048911422605
model parameter : 2053031
model size : 9.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8874211
	speed: 0.2474s/iter; left time: 5121.7864s
	iters: 200, epoch: 1 | loss: 3.7413068
	speed: 0.2019s/iter; left time: 4160.3512s
Epoch: 1 cost time: 46.9366238117218
Epoch: 1, Steps: 208 | Train Loss: 4.289 Vali Loss: 3.586 Vali Acc: 0.046 Test Loss: 3.586 Test Acc: 0.046
Validation loss decreased (inf --> -0.045595).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7001514
	speed: 0.5499s/iter; left time: 11268.4523s
	iters: 200, epoch: 2 | loss: 3.2041562
	speed: 0.2693s/iter; left time: 5491.1178s
Epoch: 2 cost time: 55.56131911277771
Epoch: 2, Steps: 208 | Train Loss: 3.418 Vali Loss: 3.722 Vali Acc: 0.078 Test Loss: 3.722 Test Acc: 0.078
Validation loss decreased (-0.045595 --> -0.077505).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1006403
	speed: 0.5250s/iter; left time: 10648.7178s
	iters: 200, epoch: 3 | loss: 3.4765131
	speed: 0.2131s/iter; left time: 4300.9237s
Epoch: 3 cost time: 47.58283495903015
Epoch: 3, Steps: 208 | Train Loss: 3.439 Vali Loss: 3.671 Vali Acc: 0.107 Test Loss: 3.671 Test Acc: 0.107
Validation loss decreased (-0.077505 --> -0.106733).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1131010
	speed: 0.5354s/iter; left time: 10748.6022s
	iters: 200, epoch: 4 | loss: 4.1125660
	speed: 0.2644s/iter; left time: 5281.1617s
Epoch: 4 cost time: 54.52393126487732
Epoch: 4, Steps: 208 | Train Loss: 3.564 Vali Loss: 5.087 Vali Acc: 0.068 Test Loss: 5.087 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.4009886
	speed: 0.5421s/iter; left time: 10770.0205s
	iters: 200, epoch: 5 | loss: 3.6656127
	speed: 0.2720s/iter; left time: 5376.5513s
Epoch: 5 cost time: 55.778926849365234
Epoch: 5, Steps: 208 | Train Loss: 3.483 Vali Loss: 4.388 Vali Acc: 0.100 Test Loss: 4.388 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.6918800
	speed: 0.5831s/iter; left time: 11464.1554s
	iters: 200, epoch: 6 | loss: 4.7192907
	speed: 0.2635s/iter; left time: 5154.2939s
Epoch: 6 cost time: 56.184356927871704
Epoch: 6, Steps: 208 | Train Loss: 3.306 Vali Loss: 4.541 Vali Acc: 0.100 Test Loss: 4.541 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.0773091
	speed: 0.5638s/iter; left time: 10968.0034s
	iters: 200, epoch: 7 | loss: 4.5852613
	speed: 0.2595s/iter; left time: 5022.1943s
Epoch: 7 cost time: 55.433313608169556
Epoch: 7, Steps: 208 | Train Loss: 3.066 Vali Loss: 5.118 Vali Acc: 0.120 Test Loss: 5.118 Test Acc: 0.120
Validation loss decreased (-0.106733 --> -0.120140).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3950884
	speed: 0.5578s/iter; left time: 10734.2615s
	iters: 200, epoch: 8 | loss: 3.1697958
	speed: 0.2366s/iter; left time: 4529.2536s
Epoch: 8 cost time: 51.09901022911072
Epoch: 8, Steps: 208 | Train Loss: 2.711 Vali Loss: 5.172 Vali Acc: 0.131 Test Loss: 5.172 Test Acc: 0.131
Validation loss decreased (-0.120140 --> -0.130578).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8396902
	speed: 0.5130s/iter; left time: 9766.5880s
	iters: 200, epoch: 9 | loss: 2.7451468
	speed: 0.2546s/iter; left time: 4821.1169s
Epoch: 9 cost time: 52.8172402381897
Epoch: 9, Steps: 208 | Train Loss: 2.263 Vali Loss: 5.757 Vali Acc: 0.113 Test Loss: 5.757 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6142256
	speed: 0.4767s/iter; left time: 8976.3621s
	iters: 200, epoch: 10 | loss: 2.5992661
	speed: 0.2408s/iter; left time: 4509.0284s
Epoch: 10 cost time: 48.919371128082275
Epoch: 10, Steps: 208 | Train Loss: 1.858 Vali Loss: 5.305 Vali Acc: 0.122 Test Loss: 5.305 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0878818
	speed: 0.4710s/iter; left time: 8769.7181s
	iters: 200, epoch: 11 | loss: 1.7008920
	speed: 0.2279s/iter; left time: 4221.3682s
Epoch: 11 cost time: 47.83485817909241
Epoch: 11, Steps: 208 | Train Loss: 1.521 Vali Loss: 4.957 Vali Acc: 0.134 Test Loss: 4.957 Test Acc: 0.134
Validation loss decreased (-0.130578 --> -0.134159).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5289086
	speed: 0.5661s/iter; left time: 10423.3054s
	iters: 200, epoch: 12 | loss: 1.3304188
	speed: 0.2678s/iter; left time: 4904.1579s
Epoch: 12 cost time: 55.928258180618286
Epoch: 12, Steps: 208 | Train Loss: 1.268 Vali Loss: 5.303 Vali Acc: 0.143 Test Loss: 5.303 Test Acc: 0.143
Validation loss decreased (-0.134159 --> -0.142506).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8137564
	speed: 0.5125s/iter; left time: 9329.8242s
	iters: 200, epoch: 13 | loss: 1.9523219
	speed: 0.2437s/iter; left time: 4412.6326s
Epoch: 13 cost time: 49.49087977409363
Epoch: 13, Steps: 208 | Train Loss: 1.049 Vali Loss: 6.325 Vali Acc: 0.133 Test Loss: 6.325 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8749267
	speed: 0.5310s/iter; left time: 9555.8892s
	iters: 200, epoch: 14 | loss: 0.9027737
	speed: 0.2766s/iter; left time: 4950.1457s
Epoch: 14 cost time: 54.17941904067993
Epoch: 14, Steps: 208 | Train Loss: 0.838 Vali Loss: 6.446 Vali Acc: 0.151 Test Loss: 6.446 Test Acc: 0.151
Validation loss decreased (-0.142506 --> -0.150845).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5168176
	speed: 0.5621s/iter; left time: 9999.9836s
	iters: 200, epoch: 15 | loss: 1.0885855
	speed: 0.2433s/iter; left time: 4303.6773s
Epoch: 15 cost time: 52.55069065093994
Epoch: 15, Steps: 208 | Train Loss: 0.705 Vali Loss: 6.816 Vali Acc: 0.140 Test Loss: 6.816 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7100806
	speed: 0.5259s/iter; left time: 9246.5374s
	iters: 200, epoch: 16 | loss: 0.3789683
	speed: 0.2528s/iter; left time: 4418.5849s
Epoch: 16 cost time: 52.57910346984863
Epoch: 16, Steps: 208 | Train Loss: 0.588 Vali Loss: 7.524 Vali Acc: 0.140 Test Loss: 7.524 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.0063385
	speed: 0.5396s/iter; left time: 9374.8757s
	iters: 200, epoch: 17 | loss: 0.6962196
	speed: 0.2549s/iter; left time: 4402.6775s
Epoch: 17 cost time: 53.334020137786865
Epoch: 17, Steps: 208 | Train Loss: 0.493 Vali Loss: 7.620 Vali Acc: 0.140 Test Loss: 7.620 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5399644
	speed: 0.5246s/iter; left time: 9004.2857s
	iters: 200, epoch: 18 | loss: 0.4571405
	speed: 0.2485s/iter; left time: 4241.0965s
Epoch: 18 cost time: 50.62892150878906
Epoch: 18, Steps: 208 | Train Loss: 0.421 Vali Loss: 7.756 Vali Acc: 0.145 Test Loss: 7.756 Test Acc: 0.145
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2853949
	speed: 0.5048s/iter; left time: 8559.5511s
	iters: 200, epoch: 19 | loss: 0.4581589
	speed: 0.2449s/iter; left time: 4127.8700s
Epoch: 19 cost time: 51.13839912414551
Epoch: 19, Steps: 208 | Train Loss: 0.370 Vali Loss: 8.200 Vali Acc: 0.141 Test Loss: 8.200 Test Acc: 0.141
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3638621
	speed: 0.5198s/iter; left time: 8706.8973s
	iters: 200, epoch: 20 | loss: 0.1137045
	speed: 0.2585s/iter; left time: 4304.2161s
Epoch: 20 cost time: 52.8205029964447
Epoch: 20, Steps: 208 | Train Loss: 0.332 Vali Loss: 8.838 Vali Acc: 0.138 Test Loss: 8.838 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.4416617
	speed: 0.5535s/iter; left time: 9155.2295s
	iters: 200, epoch: 21 | loss: 0.2022058
	speed: 0.2584s/iter; left time: 4248.7203s
Epoch: 21 cost time: 54.492894411087036
Epoch: 21, Steps: 208 | Train Loss: 0.303 Vali Loss: 8.860 Vali Acc: 0.132 Test Loss: 8.860 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2434218
	speed: 0.5077s/iter; left time: 8292.3330s
	iters: 200, epoch: 22 | loss: 0.0664546
	speed: 0.2428s/iter; left time: 3942.1445s
Epoch: 22 cost time: 50.1035361289978
Epoch: 22, Steps: 208 | Train Loss: 0.258 Vali Loss: 9.525 Vali Acc: 0.135 Test Loss: 9.525 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2540462
	speed: 0.5045s/iter; left time: 8135.5511s
	iters: 200, epoch: 23 | loss: 0.0624858
	speed: 0.2207s/iter; left time: 3536.6603s
Epoch: 23 cost time: 46.0709547996521
Epoch: 23, Steps: 208 | Train Loss: 0.270 Vali Loss: 9.715 Vali Acc: 0.137 Test Loss: 9.715 Test Acc: 0.137
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.5797290
	speed: 0.4480s/iter; left time: 7131.4151s
	iters: 200, epoch: 24 | loss: 0.1705564
	speed: 0.2027s/iter; left time: 3205.8243s
Epoch: 24 cost time: 40.56195378303528
Epoch: 24, Steps: 208 | Train Loss: 0.217 Vali Loss: 11.013 Vali Acc: 0.136 Test Loss: 11.013 Test Acc: 0.136
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.15090963316433045
model parameter : 1064935
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2952776
	speed: 0.0912s/iter; left time: 1886.9697s
	iters: 200, epoch: 1 | loss: 3.7414427
	speed: 0.0537s/iter; left time: 1107.1535s
Epoch: 1 cost time: 15.076322555541992
Epoch: 1, Steps: 208 | Train Loss: 4.042 Vali Loss: 3.534 Vali Acc: 0.068 Test Loss: 3.534 Test Acc: 0.068
Validation loss decreased (inf --> -0.067963).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5919063
	speed: 0.1918s/iter; left time: 3931.2539s
	iters: 200, epoch: 2 | loss: 3.2468922
	speed: 0.0741s/iter; left time: 1511.0153s
Epoch: 2 cost time: 15.34223461151123
Epoch: 2, Steps: 208 | Train Loss: 3.391 Vali Loss: 3.387 Vali Acc: 0.090 Test Loss: 3.387 Test Acc: 0.090
Validation loss decreased (-0.067963 --> -0.090035).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4657159
	speed: 0.1957s/iter; left time: 3969.3305s
	iters: 200, epoch: 3 | loss: 4.4076986
	speed: 0.0770s/iter; left time: 1553.7476s
Epoch: 3 cost time: 15.406684398651123
Epoch: 3, Steps: 208 | Train Loss: 3.380 Vali Loss: 3.719 Vali Acc: 0.081 Test Loss: 3.719 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.1953297
	speed: 0.1998s/iter; left time: 4011.6184s
	iters: 200, epoch: 4 | loss: 3.7411144
	speed: 0.0792s/iter; left time: 1582.5389s
Epoch: 4 cost time: 16.329530477523804
Epoch: 4, Steps: 208 | Train Loss: 3.384 Vali Loss: 3.765 Vali Acc: 0.100 Test Loss: 3.765 Test Acc: 0.100
Validation loss decreased (-0.090035 --> -0.099873).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1270883
	speed: 0.1982s/iter; left time: 3937.1375s
	iters: 200, epoch: 5 | loss: 3.7414434
	speed: 0.0565s/iter; left time: 1117.2246s
Epoch: 5 cost time: 13.017901420593262
Epoch: 5, Steps: 208 | Train Loss: 3.228 Vali Loss: 4.046 Vali Acc: 0.097 Test Loss: 4.046 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9178927
	speed: 0.1986s/iter; left time: 3905.1185s
	iters: 200, epoch: 6 | loss: 4.1298809
	speed: 0.0742s/iter; left time: 1452.2778s
Epoch: 6 cost time: 15.181076049804688
Epoch: 6, Steps: 208 | Train Loss: 3.164 Vali Loss: 4.642 Vali Acc: 0.102 Test Loss: 4.642 Test Acc: 0.102
Validation loss decreased (-0.099873 --> -0.101654).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1412668
	speed: 0.2292s/iter; left time: 4459.3465s
	iters: 200, epoch: 7 | loss: 2.9602094
	speed: 0.0922s/iter; left time: 1784.2429s
Epoch: 7 cost time: 20.07455539703369
Epoch: 7, Steps: 208 | Train Loss: 2.914 Vali Loss: 4.391 Vali Acc: 0.121 Test Loss: 4.391 Test Acc: 0.121
Validation loss decreased (-0.101654 --> -0.121340).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7926501
	speed: 0.2386s/iter; left time: 4591.9777s
	iters: 200, epoch: 8 | loss: 3.3523772
	speed: 0.1062s/iter; left time: 2033.7805s
Epoch: 8 cost time: 22.682754516601562
Epoch: 8, Steps: 208 | Train Loss: 2.646 Vali Loss: 4.827 Vali Acc: 0.126 Test Loss: 4.827 Test Acc: 0.126
Validation loss decreased (-0.121340 --> -0.126107).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5344212
	speed: 0.2480s/iter; left time: 4720.9288s
	iters: 200, epoch: 9 | loss: 2.3319306
	speed: 0.1039s/iter; left time: 1966.9692s
Epoch: 9 cost time: 22.608131408691406
Epoch: 9, Steps: 208 | Train Loss: 2.238 Vali Loss: 4.374 Vali Acc: 0.115 Test Loss: 4.374 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2421485
	speed: 0.2490s/iter; left time: 4689.2475s
	iters: 200, epoch: 10 | loss: 3.3034940
	speed: 0.1015s/iter; left time: 1901.5343s
Epoch: 10 cost time: 22.309616565704346
Epoch: 10, Steps: 208 | Train Loss: 1.904 Vali Loss: 5.165 Vali Acc: 0.131 Test Loss: 5.165 Test Acc: 0.131
Validation loss decreased (-0.126107 --> -0.130578).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6919544
	speed: 0.2446s/iter; left time: 4554.2410s
	iters: 200, epoch: 11 | loss: 2.3595064
	speed: 0.1079s/iter; left time: 1999.3118s
Epoch: 11 cost time: 22.785168409347534
Epoch: 11, Steps: 208 | Train Loss: 1.550 Vali Loss: 5.552 Vali Acc: 0.135 Test Loss: 5.552 Test Acc: 0.135
Validation loss decreased (-0.130578 --> -0.134451).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7088140
	speed: 0.2419s/iter; left time: 4454.5439s
	iters: 200, epoch: 12 | loss: 0.7993776
	speed: 0.1015s/iter; left time: 1859.6502s
Epoch: 12 cost time: 21.9053852558136
Epoch: 12, Steps: 208 | Train Loss: 1.271 Vali Loss: 5.716 Vali Acc: 0.139 Test Loss: 5.716 Test Acc: 0.139
Validation loss decreased (-0.134451 --> -0.139221).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7642771
	speed: 0.2296s/iter; left time: 4180.3651s
	iters: 200, epoch: 13 | loss: 1.1659776
	speed: 0.1095s/iter; left time: 1983.0849s
Epoch: 13 cost time: 21.65979790687561
Epoch: 13, Steps: 208 | Train Loss: 1.103 Vali Loss: 6.091 Vali Acc: 0.140 Test Loss: 6.091 Test Acc: 0.140
Validation loss decreased (-0.139221 --> -0.139814).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0130390
	speed: 0.2366s/iter; left time: 4257.5912s
	iters: 200, epoch: 14 | loss: 1.0886415
	speed: 0.1061s/iter; left time: 1898.8602s
Epoch: 14 cost time: 21.29828715324402
Epoch: 14, Steps: 208 | Train Loss: 0.869 Vali Loss: 6.739 Vali Acc: 0.140 Test Loss: 6.739 Test Acc: 0.140
Validation loss decreased (-0.139814 --> -0.140404).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6918076
	speed: 0.2098s/iter; left time: 3731.7451s
	iters: 200, epoch: 15 | loss: 0.7950565
	speed: 0.0719s/iter; left time: 1271.2994s
Epoch: 15 cost time: 15.825436353683472
Epoch: 15, Steps: 208 | Train Loss: 0.734 Vali Loss: 6.699 Vali Acc: 0.128 Test Loss: 6.699 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5249012
	speed: 0.2107s/iter; left time: 3704.8021s
	iters: 200, epoch: 16 | loss: 0.7329651
	speed: 0.0628s/iter; left time: 1098.5860s
Epoch: 16 cost time: 15.15632700920105
Epoch: 16, Steps: 208 | Train Loss: 0.618 Vali Loss: 7.366 Vali Acc: 0.143 Test Loss: 7.366 Test Acc: 0.143
Validation loss decreased (-0.140404 --> -0.143380).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6330193
	speed: 0.2121s/iter; left time: 3685.4599s
	iters: 200, epoch: 17 | loss: 0.5195889
	speed: 0.0611s/iter; left time: 1055.4203s
Epoch: 17 cost time: 14.961663961410522
Epoch: 17, Steps: 208 | Train Loss: 0.531 Vali Loss: 7.930 Vali Acc: 0.134 Test Loss: 7.930 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1034248
	speed: 0.1905s/iter; left time: 3270.0935s
	iters: 200, epoch: 18 | loss: 0.7275704
	speed: 0.0661s/iter; left time: 1128.6174s
Epoch: 18 cost time: 14.207695245742798
Epoch: 18, Steps: 208 | Train Loss: 0.463 Vali Loss: 7.730 Vali Acc: 0.142 Test Loss: 7.730 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1348722
	speed: 0.2093s/iter; left time: 3549.8340s
	iters: 200, epoch: 19 | loss: 1.3126142
	speed: 0.0657s/iter; left time: 1107.6859s
Epoch: 19 cost time: 15.314382076263428
Epoch: 19, Steps: 208 | Train Loss: 0.426 Vali Loss: 8.112 Vali Acc: 0.141 Test Loss: 8.112 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.8656549
	speed: 0.2184s/iter; left time: 3657.7258s
	iters: 200, epoch: 20 | loss: 0.4474222
	speed: 0.0716s/iter; left time: 1192.8326s
Epoch: 20 cost time: 16.864781856536865
Epoch: 20, Steps: 208 | Train Loss: 0.427 Vali Loss: 8.824 Vali Acc: 0.134 Test Loss: 8.824 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3819660
	speed: 0.2265s/iter; left time: 3746.8433s
	iters: 200, epoch: 21 | loss: 0.1843904
	speed: 0.1179s/iter; left time: 1937.8859s
Epoch: 21 cost time: 22.432446479797363
Epoch: 21, Steps: 208 | Train Loss: 0.363 Vali Loss: 9.044 Vali Acc: 0.139 Test Loss: 9.044 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3650422
	speed: 0.2565s/iter; left time: 4189.2597s
	iters: 200, epoch: 22 | loss: 0.1405450
	speed: 0.1089s/iter; left time: 1767.3382s
Epoch: 22 cost time: 23.701834201812744
Epoch: 22, Steps: 208 | Train Loss: 0.325 Vali Loss: 9.894 Vali Acc: 0.124 Test Loss: 9.894 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.3085289
	speed: 0.2480s/iter; left time: 3999.7940s
	iters: 200, epoch: 23 | loss: 0.2841871
	speed: 0.1036s/iter; left time: 1659.4644s
Epoch: 23 cost time: 22.829249143600464
Epoch: 23, Steps: 208 | Train Loss: 0.304 Vali Loss: 9.970 Vali Acc: 0.133 Test Loss: 9.970 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2356170
	speed: 0.2286s/iter; left time: 3639.1485s
	iters: 200, epoch: 24 | loss: 0.7113354
	speed: 0.0987s/iter; left time: 1560.7645s
Epoch: 24 cost time: 20.59691286087036
Epoch: 24, Steps: 208 | Train Loss: 0.305 Vali Loss: 10.389 Vali Acc: 0.136 Test Loss: 10.389 Test Acc: 0.136
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2658747
	speed: 0.2447s/iter; left time: 3844.0035s
	iters: 200, epoch: 25 | loss: 0.1733606
	speed: 0.1007s/iter; left time: 1572.1886s
Epoch: 25 cost time: 21.82866597175598
Epoch: 25, Steps: 208 | Train Loss: 0.246 Vali Loss: 10.871 Vali Acc: 0.133 Test Loss: 10.871 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2690224
	speed: 0.2322s/iter; left time: 3599.8881s
	iters: 200, epoch: 26 | loss: 0.1689963
	speed: 0.0908s/iter; left time: 1397.8951s
Epoch: 26 cost time: 20.236883640289307
Epoch: 26, Steps: 208 | Train Loss: 0.261 Vali Loss: 10.239 Vali Acc: 0.133 Test Loss: 10.239 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14345362362063824
model parameter : 735847
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4644642
	speed: 0.1175s/iter; left time: 2432.2737s
	iters: 200, epoch: 1 | loss: 3.8846595
	speed: 0.0939s/iter; left time: 1934.9446s
Epoch: 1 cost time: 22.066962480545044
Epoch: 1, Steps: 208 | Train Loss: 4.045 Vali Loss: 4.032 Vali Acc: 0.057 Test Loss: 4.032 Test Acc: 0.057
Validation loss decreased (inf --> -0.057222).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5151100
	speed: 0.2262s/iter; left time: 4636.2424s
	iters: 200, epoch: 2 | loss: 3.7509828
	speed: 0.0630s/iter; left time: 1284.8616s
Epoch: 2 cost time: 16.303457021713257
Epoch: 2, Steps: 208 | Train Loss: 3.436 Vali Loss: 3.736 Vali Acc: 0.078 Test Loss: 3.736 Test Acc: 0.078
Validation loss decreased (-0.057222 --> -0.078400).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2003250
	speed: 0.1802s/iter; left time: 3654.5154s
	iters: 200, epoch: 3 | loss: 3.3225257
	speed: 0.0830s/iter; left time: 1674.9975s
Epoch: 3 cost time: 15.584226369857788
Epoch: 3, Steps: 208 | Train Loss: 3.228 Vali Loss: 3.715 Vali Acc: 0.090 Test Loss: 3.715 Test Acc: 0.090
Validation loss decreased (-0.078400 --> -0.089733).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1491628
	speed: 0.1903s/iter; left time: 3821.5490s
	iters: 200, epoch: 4 | loss: 3.2030745
	speed: 0.0758s/iter; left time: 1514.0539s
Epoch: 4 cost time: 14.934606075286865
Epoch: 4, Steps: 208 | Train Loss: 3.146 Vali Loss: 3.862 Vali Acc: 0.100 Test Loss: 3.862 Test Acc: 0.100
Validation loss decreased (-0.089733 --> -0.099574).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8713911
	speed: 0.2137s/iter; left time: 4246.4356s
	iters: 200, epoch: 5 | loss: 3.9758577
	speed: 0.0696s/iter; left time: 1376.6060s
Epoch: 5 cost time: 15.971364498138428
Epoch: 5, Steps: 208 | Train Loss: 3.150 Vali Loss: 3.753 Vali Acc: 0.113 Test Loss: 3.753 Test Acc: 0.113
Validation loss decreased (-0.099574 --> -0.112697).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4655764
	speed: 0.2182s/iter; left time: 4290.6098s
	iters: 200, epoch: 6 | loss: 3.8005309
	speed: 0.0723s/iter; left time: 1413.4649s
Epoch: 6 cost time: 16.834057331085205
Epoch: 6, Steps: 208 | Train Loss: 3.026 Vali Loss: 3.758 Vali Acc: 0.115 Test Loss: 3.758 Test Acc: 0.115
Validation loss decreased (-0.112697 --> -0.114785).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4975371
	speed: 0.2107s/iter; left time: 4098.6935s
	iters: 200, epoch: 7 | loss: 2.5166926
	speed: 0.0695s/iter; left time: 1345.6116s
Epoch: 7 cost time: 16.317706823349
Epoch: 7, Steps: 208 | Train Loss: 2.797 Vali Loss: 4.302 Vali Acc: 0.130 Test Loss: 4.302 Test Acc: 0.130
Validation loss decreased (-0.114785 --> -0.129692).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5493987
	speed: 0.2017s/iter; left time: 3881.8613s
	iters: 200, epoch: 8 | loss: 3.0723796
	speed: 0.0614s/iter; left time: 1176.3032s
Epoch: 8 cost time: 14.335811376571655
Epoch: 8, Steps: 208 | Train Loss: 2.470 Vali Loss: 4.425 Vali Acc: 0.131 Test Loss: 4.425 Test Acc: 0.131
Validation loss decreased (-0.129692 --> -0.130883).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2688930
	speed: 0.2368s/iter; left time: 4507.3123s
	iters: 200, epoch: 9 | loss: 2.4435556
	speed: 0.1054s/iter; left time: 1996.7066s
Epoch: 9 cost time: 22.96130132675171
Epoch: 9, Steps: 208 | Train Loss: 2.153 Vali Loss: 5.089 Vali Acc: 0.134 Test Loss: 5.089 Test Acc: 0.134
Validation loss decreased (-0.130883 --> -0.133859).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9472373
	speed: 0.2343s/iter; left time: 4411.1664s
	iters: 200, epoch: 10 | loss: 1.7325503
	speed: 0.1101s/iter; left time: 2061.6575s
Epoch: 10 cost time: 22.702163457870483
Epoch: 10, Steps: 208 | Train Loss: 1.891 Vali Loss: 5.378 Vali Acc: 0.140 Test Loss: 5.378 Test Acc: 0.140
Validation loss decreased (-0.133859 --> -0.139821).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9876803
	speed: 0.2436s/iter; left time: 4536.4353s
	iters: 200, epoch: 11 | loss: 1.6978358
	speed: 0.1023s/iter; left time: 1894.8865s
Epoch: 11 cost time: 22.674176692962646
Epoch: 11, Steps: 208 | Train Loss: 1.554 Vali Loss: 4.997 Vali Acc: 0.133 Test Loss: 4.997 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4120398
	speed: 0.2377s/iter; left time: 4376.9617s
	iters: 200, epoch: 12 | loss: 1.5654866
	speed: 0.0956s/iter; left time: 1750.8808s
Epoch: 12 cost time: 21.167165756225586
Epoch: 12, Steps: 208 | Train Loss: 1.271 Vali Loss: 5.782 Vali Acc: 0.130 Test Loss: 5.782 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9659531
	speed: 0.2392s/iter; left time: 4354.2304s
	iters: 200, epoch: 13 | loss: 0.7555946
	speed: 0.0980s/iter; left time: 1775.0749s
Epoch: 13 cost time: 21.130263090133667
Epoch: 13, Steps: 208 | Train Loss: 1.066 Vali Loss: 6.259 Vali Acc: 0.146 Test Loss: 6.259 Test Acc: 0.146
Validation loss decreased (-0.139821 --> -0.145777).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9115450
	speed: 0.2318s/iter; left time: 4170.9028s
	iters: 200, epoch: 14 | loss: 1.1360373
	speed: 0.0998s/iter; left time: 1786.6406s
Epoch: 14 cost time: 20.889187574386597
Epoch: 14, Steps: 208 | Train Loss: 0.867 Vali Loss: 6.610 Vali Acc: 0.146 Test Loss: 6.610 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5492852
	speed: 0.2418s/iter; left time: 4301.9476s
	iters: 200, epoch: 15 | loss: 0.5977941
	speed: 0.0975s/iter; left time: 1724.4202s
Epoch: 15 cost time: 21.29236388206482
Epoch: 15, Steps: 208 | Train Loss: 0.733 Vali Loss: 6.601 Vali Acc: 0.139 Test Loss: 6.601 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8275561
	speed: 0.2400s/iter; left time: 4219.2948s
	iters: 200, epoch: 16 | loss: 1.1648649
	speed: 0.0930s/iter; left time: 1625.3651s
Epoch: 16 cost time: 20.95922088623047
Epoch: 16, Steps: 208 | Train Loss: 0.615 Vali Loss: 7.742 Vali Acc: 0.127 Test Loss: 7.742 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2947313
	speed: 0.1980s/iter; left time: 3439.5753s
	iters: 200, epoch: 17 | loss: 0.5782737
	speed: 0.0680s/iter; left time: 1174.6041s
Epoch: 17 cost time: 15.030147314071655
Epoch: 17, Steps: 208 | Train Loss: 0.547 Vali Loss: 8.320 Vali Acc: 0.143 Test Loss: 8.320 Test Acc: 0.143
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4138444
	speed: 0.1894s/iter; left time: 3251.3144s
	iters: 200, epoch: 18 | loss: 0.5742242
	speed: 0.0801s/iter; left time: 1366.2720s
Epoch: 18 cost time: 15.675386905670166
Epoch: 18, Steps: 208 | Train Loss: 0.508 Vali Loss: 8.419 Vali Acc: 0.127 Test Loss: 8.419 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.0771352
	speed: 0.1835s/iter; left time: 3111.9367s
	iters: 200, epoch: 19 | loss: 0.2986130
	speed: 0.0743s/iter; left time: 1253.1658s
Epoch: 19 cost time: 14.562096118927002
Epoch: 19, Steps: 208 | Train Loss: 0.460 Vali Loss: 8.538 Vali Acc: 0.126 Test Loss: 8.538 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7074414
	speed: 0.1963s/iter; left time: 3288.0110s
	iters: 200, epoch: 20 | loss: 0.4930395
	speed: 0.0690s/iter; left time: 1147.9884s
Epoch: 20 cost time: 14.793052434921265
Epoch: 20, Steps: 208 | Train Loss: 0.385 Vali Loss: 9.293 Vali Acc: 0.142 Test Loss: 9.293 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.5217755
	speed: 0.1973s/iter; left time: 3262.7714s
	iters: 200, epoch: 21 | loss: 0.5768009
	speed: 0.0697s/iter; left time: 1146.3345s
Epoch: 21 cost time: 14.763192892074585
Epoch: 21, Steps: 208 | Train Loss: 0.354 Vali Loss: 8.812 Vali Acc: 0.135 Test Loss: 8.812 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3313702
	speed: 0.2017s/iter; left time: 3294.3516s
	iters: 200, epoch: 22 | loss: 0.2659377
	speed: 0.0820s/iter; left time: 1330.7448s
Epoch: 22 cost time: 16.251983642578125
Epoch: 22, Steps: 208 | Train Loss: 0.309 Vali Loss: 9.527 Vali Acc: 0.132 Test Loss: 9.527 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1346314
	speed: 0.2250s/iter; left time: 3627.6308s
	iters: 200, epoch: 23 | loss: 0.3787954
	speed: 0.0912s/iter; left time: 1461.4655s
Epoch: 23 cost time: 19.533363819122314
Epoch: 23, Steps: 208 | Train Loss: 0.314 Vali Loss: 9.913 Vali Acc: 0.131 Test Loss: 9.913 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14583954667461974
model parameter : 598887
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4722729
	speed: 0.1169s/iter; left time: 2419.4359s
	iters: 200, epoch: 1 | loss: 4.0710688
	speed: 0.0891s/iter; left time: 1835.5430s
Epoch: 1 cost time: 21.272907733917236
Epoch: 1, Steps: 208 | Train Loss: 3.911 Vali Loss: 4.102 Vali Acc: 0.061 Test Loss: 4.102 Test Acc: 0.061
Validation loss decreased (inf --> -0.060800).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7994137
	speed: 0.2099s/iter; left time: 4300.8274s
	iters: 200, epoch: 2 | loss: 3.3790946
	speed: 0.0948s/iter; left time: 1933.4698s
Epoch: 2 cost time: 19.986889123916626
Epoch: 2, Steps: 208 | Train Loss: 3.539 Vali Loss: 3.606 Vali Acc: 0.071 Test Loss: 3.606 Test Acc: 0.071
Validation loss decreased (-0.060800 --> -0.070647).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5146523
	speed: 0.2120s/iter; left time: 4301.3913s
	iters: 200, epoch: 3 | loss: 3.2049341
	speed: 0.0967s/iter; left time: 1952.1357s
Epoch: 3 cost time: 19.801507234573364
Epoch: 3, Steps: 208 | Train Loss: 3.207 Vali Loss: 3.858 Vali Acc: 0.086 Test Loss: 3.858 Test Acc: 0.086
Validation loss decreased (-0.070647 --> -0.086153).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.3214679
	speed: 0.2193s/iter; left time: 4403.0123s
	iters: 200, epoch: 4 | loss: 2.7657216
	speed: 0.0986s/iter; left time: 1969.9341s
Epoch: 4 cost time: 20.372714519500732
Epoch: 4, Steps: 208 | Train Loss: 3.082 Vali Loss: 4.406 Vali Acc: 0.087 Test Loss: 4.406 Test Acc: 0.087
Validation loss decreased (-0.086153 --> -0.087042).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1029625
	speed: 0.2209s/iter; left time: 4388.1281s
	iters: 200, epoch: 5 | loss: 4.0483904
	speed: 0.0890s/iter; left time: 1760.3671s
Epoch: 5 cost time: 19.28803277015686
Epoch: 5, Steps: 208 | Train Loss: 2.982 Vali Loss: 4.169 Vali Acc: 0.095 Test Loss: 4.169 Test Acc: 0.095
Validation loss decreased (-0.087042 --> -0.095395).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4079874
	speed: 0.2180s/iter; left time: 4285.2962s
	iters: 200, epoch: 6 | loss: 3.5209148
	speed: 0.0861s/iter; left time: 1683.3764s
Epoch: 6 cost time: 19.342026710510254
Epoch: 6, Steps: 208 | Train Loss: 2.850 Vali Loss: 3.994 Vali Acc: 0.113 Test Loss: 3.994 Test Acc: 0.113
Validation loss decreased (-0.095395 --> -0.112695).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1620522
	speed: 0.2085s/iter; left time: 4055.7615s
	iters: 200, epoch: 7 | loss: 2.9522827
	speed: 0.0442s/iter; left time: 854.5870s
Epoch: 7 cost time: 14.348347425460815
Epoch: 7, Steps: 208 | Train Loss: 2.674 Vali Loss: 4.133 Vali Acc: 0.118 Test Loss: 4.133 Test Acc: 0.118
Validation loss decreased (-0.112695 --> -0.117465).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5214779
	speed: 0.1674s/iter; left time: 3221.6654s
	iters: 200, epoch: 8 | loss: 2.3358948
	speed: 0.0632s/iter; left time: 1210.5531s
Epoch: 8 cost time: 12.269700527191162
Epoch: 8, Steps: 208 | Train Loss: 2.438 Vali Loss: 4.548 Vali Acc: 0.125 Test Loss: 4.548 Test Acc: 0.125
Validation loss decreased (-0.117465 --> -0.125215).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0124872
	speed: 0.1755s/iter; left time: 3340.3072s
	iters: 200, epoch: 9 | loss: 2.4681857
	speed: 0.0646s/iter; left time: 1222.7000s
Epoch: 9 cost time: 13.180559873580933
Epoch: 9, Steps: 208 | Train Loss: 2.164 Vali Loss: 4.701 Vali Acc: 0.124 Test Loss: 4.701 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6068510
	speed: 0.1602s/iter; left time: 3016.9635s
	iters: 200, epoch: 10 | loss: 1.8379958
	speed: 0.0728s/iter; left time: 1364.3365s
Epoch: 10 cost time: 13.158981800079346
Epoch: 10, Steps: 208 | Train Loss: 1.890 Vali Loss: 4.971 Vali Acc: 0.125 Test Loss: 4.971 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5124117
	speed: 0.1611s/iter; left time: 3000.4810s
	iters: 200, epoch: 11 | loss: 1.9359245
	speed: 0.0629s/iter; left time: 1164.7823s
Epoch: 11 cost time: 12.513259649276733
Epoch: 11, Steps: 208 | Train Loss: 1.615 Vali Loss: 5.522 Vali Acc: 0.129 Test Loss: 5.522 Test Acc: 0.129
Validation loss decreased (-0.125215 --> -0.129381).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8132461
	speed: 0.1772s/iter; left time: 3262.9851s
	iters: 200, epoch: 12 | loss: 1.7861571
	speed: 0.0592s/iter; left time: 1083.3754s
Epoch: 12 cost time: 12.574805736541748
Epoch: 12, Steps: 208 | Train Loss: 1.371 Vali Loss: 5.801 Vali Acc: 0.126 Test Loss: 5.801 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6593737
	speed: 0.1593s/iter; left time: 2900.5224s
	iters: 200, epoch: 13 | loss: 1.6953417
	speed: 0.0415s/iter; left time: 751.1390s
Epoch: 13 cost time: 9.185251951217651
Epoch: 13, Steps: 208 | Train Loss: 1.149 Vali Loss: 6.233 Vali Acc: 0.128 Test Loss: 6.233 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7251000
	speed: 0.2028s/iter; left time: 3649.6245s
	iters: 200, epoch: 14 | loss: 1.0376282
	speed: 0.1046s/iter; left time: 1872.8034s
Epoch: 14 cost time: 21.28375792503357
Epoch: 14, Steps: 208 | Train Loss: 0.976 Vali Loss: 6.447 Vali Acc: 0.131 Test Loss: 6.447 Test Acc: 0.131
Validation loss decreased (-0.129381 --> -0.130565).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8567044
	speed: 0.2212s/iter; left time: 3935.4439s
	iters: 200, epoch: 15 | loss: 1.7185780
	speed: 0.1008s/iter; left time: 1783.5179s
Epoch: 15 cost time: 21.833919048309326
Epoch: 15, Steps: 208 | Train Loss: 0.834 Vali Loss: 6.810 Vali Acc: 0.123 Test Loss: 6.810 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5643339
	speed: 0.2313s/iter; left time: 4067.0184s
	iters: 200, epoch: 16 | loss: 1.0136918
	speed: 0.0955s/iter; left time: 1669.5528s
Epoch: 16 cost time: 20.94382333755493
Epoch: 16, Steps: 208 | Train Loss: 0.729 Vali Loss: 7.229 Vali Acc: 0.129 Test Loss: 7.229 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4092273
	speed: 0.2252s/iter; left time: 3912.8523s
	iters: 200, epoch: 17 | loss: 0.5137276
	speed: 0.1039s/iter; left time: 1794.4034s
Epoch: 17 cost time: 22.157769441604614
Epoch: 17, Steps: 208 | Train Loss: 0.620 Vali Loss: 7.418 Vali Acc: 0.135 Test Loss: 7.418 Test Acc: 0.135
Validation loss decreased (-0.130565 --> -0.135327).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5550077
	speed: 0.2214s/iter; left time: 3800.7000s
	iters: 200, epoch: 18 | loss: 0.7148603
	speed: 0.1142s/iter; left time: 1949.0089s
Epoch: 18 cost time: 22.833552837371826
Epoch: 18, Steps: 208 | Train Loss: 0.532 Vali Loss: 8.246 Vali Acc: 0.131 Test Loss: 8.246 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5199873
	speed: 0.2462s/iter; left time: 4174.8311s
	iters: 200, epoch: 19 | loss: 0.3402382
	speed: 0.1158s/iter; left time: 1951.2283s
Epoch: 19 cost time: 24.581830501556396
Epoch: 19, Steps: 208 | Train Loss: 0.504 Vali Loss: 8.575 Vali Acc: 0.121 Test Loss: 8.575 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3475053
	speed: 0.2301s/iter; left time: 3853.1868s
	iters: 200, epoch: 20 | loss: 1.2425631
	speed: 0.1031s/iter; left time: 1716.4059s
Epoch: 20 cost time: 21.82866358757019
Epoch: 20, Steps: 208 | Train Loss: 0.470 Vali Loss: 8.920 Vali Acc: 0.127 Test Loss: 8.920 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.1062164
	speed: 0.2291s/iter; left time: 3789.4801s
	iters: 200, epoch: 21 | loss: 0.4307681
	speed: 0.1105s/iter; left time: 1817.4091s
Epoch: 21 cost time: 23.099839210510254
Epoch: 21, Steps: 208 | Train Loss: 0.402 Vali Loss: 8.779 Vali Acc: 0.123 Test Loss: 8.779 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.8524315
	speed: 0.2240s/iter; left time: 3657.9964s
	iters: 200, epoch: 22 | loss: 0.1513590
	speed: 0.0926s/iter; left time: 1502.9948s
Epoch: 22 cost time: 20.759363412857056
Epoch: 22, Steps: 208 | Train Loss: 0.364 Vali Loss: 9.208 Vali Acc: 0.115 Test Loss: 9.208 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0383950
	speed: 0.1916s/iter; left time: 3089.9448s
	iters: 200, epoch: 23 | loss: 1.0484047
	speed: 0.0803s/iter; left time: 1286.1272s
Epoch: 23 cost time: 16.68707776069641
Epoch: 23, Steps: 208 | Train Loss: 0.332 Vali Loss: 9.886 Vali Acc: 0.122 Test Loss: 9.886 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0319051
	speed: 0.1943s/iter; left time: 3092.7614s
	iters: 200, epoch: 24 | loss: 0.1876821
	speed: 0.0883s/iter; left time: 1395.9172s
Epoch: 24 cost time: 17.478501319885254
Epoch: 24, Steps: 208 | Train Loss: 0.298 Vali Loss: 9.720 Vali Acc: 0.128 Test Loss: 9.720 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1369208
	speed: 0.1965s/iter; left time: 3086.7667s
	iters: 200, epoch: 25 | loss: 0.2563705
	speed: 0.0891s/iter; left time: 1390.0234s
Epoch: 25 cost time: 18.38580894470215
Epoch: 25, Steps: 208 | Train Loss: 0.328 Vali Loss: 10.255 Vali Acc: 0.130 Test Loss: 10.255 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.4271736
	speed: 0.1995s/iter; left time: 3093.0205s
	iters: 200, epoch: 26 | loss: 0.4046400
	speed: 0.0859s/iter; left time: 1323.1146s
Epoch: 26 cost time: 18.194948434829712
Epoch: 26, Steps: 208 | Train Loss: 0.295 Vali Loss: 10.831 Vali Acc: 0.127 Test Loss: 10.831 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1728735
	speed: 0.2092s/iter; left time: 3199.2152s
	iters: 200, epoch: 27 | loss: 0.3843470
	speed: 0.0789s/iter; left time: 1198.6516s
Epoch: 27 cost time: 17.81462812423706
Epoch: 27, Steps: 208 | Train Loss: 0.267 Vali Loss: 10.944 Vali Acc: 0.118 Test Loss: 10.944 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13540113331345063
model parameter : 407399
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9377153
	speed: 0.0671s/iter; left time: 1388.5505s
	iters: 200, epoch: 1 | loss: 3.5669370
	speed: 0.0486s/iter; left time: 1002.0605s
Epoch: 1 cost time: 12.021532773971558
Epoch: 1, Steps: 208 | Train Loss: 3.862 Vali Loss: 3.903 Vali Acc: 0.057 Test Loss: 3.903 Test Acc: 0.057
Validation loss decreased (inf --> -0.056925).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6604724
	speed: 0.1665s/iter; left time: 3411.9907s
	iters: 200, epoch: 2 | loss: 3.2818546
	speed: 0.0468s/iter; left time: 954.7665s
Epoch: 2 cost time: 10.435254096984863
Epoch: 2, Steps: 208 | Train Loss: 3.565 Vali Loss: 3.620 Vali Acc: 0.082 Test Loss: 3.620 Test Acc: 0.082
Validation loss decreased (-0.056925 --> -0.082278).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9067621
	speed: 0.1610s/iter; left time: 3266.8702s
	iters: 200, epoch: 3 | loss: 3.3513188
	speed: 0.0485s/iter; left time: 979.9576s
Epoch: 3 cost time: 10.449714422225952
Epoch: 3, Steps: 208 | Train Loss: 3.248 Vali Loss: 3.597 Vali Acc: 0.088 Test Loss: 3.597 Test Acc: 0.088
Validation loss decreased (-0.082278 --> -0.088243).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6837530
	speed: 0.1656s/iter; left time: 3324.6707s
	iters: 200, epoch: 4 | loss: 3.3545628
	speed: 0.0484s/iter; left time: 967.3127s
Epoch: 4 cost time: 10.30244255065918
Epoch: 4, Steps: 208 | Train Loss: 3.085 Vali Loss: 3.654 Vali Acc: 0.092 Test Loss: 3.654 Test Acc: 0.092
Validation loss decreased (-0.088243 --> -0.092418).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6685343
	speed: 0.1651s/iter; left time: 3281.1956s
	iters: 200, epoch: 5 | loss: 3.1095831
	speed: 0.0487s/iter; left time: 963.6528s
Epoch: 5 cost time: 10.396201848983765
Epoch: 5, Steps: 208 | Train Loss: 2.944 Vali Loss: 3.824 Vali Acc: 0.080 Test Loss: 3.824 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1873798
	speed: 0.1618s/iter; left time: 3182.1253s
	iters: 200, epoch: 6 | loss: 3.0245819
	speed: 0.0480s/iter; left time: 939.0023s
Epoch: 6 cost time: 10.383711099624634
Epoch: 6, Steps: 208 | Train Loss: 2.777 Vali Loss: 3.978 Vali Acc: 0.103 Test Loss: 3.978 Test Acc: 0.103
Validation loss decreased (-0.092418 --> -0.102853).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0915108
	speed: 0.1667s/iter; left time: 3242.1676s
	iters: 200, epoch: 7 | loss: 2.7155457
	speed: 0.0480s/iter; left time: 929.5735s
Epoch: 7 cost time: 10.747030258178711
Epoch: 7, Steps: 208 | Train Loss: 2.599 Vali Loss: 4.310 Vali Acc: 0.107 Test Loss: 4.310 Test Acc: 0.107
Validation loss decreased (-0.102853 --> -0.106727).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.6133215
	speed: 0.1519s/iter; left time: 2922.8517s
	iters: 200, epoch: 8 | loss: 3.2262778
	speed: 0.0460s/iter; left time: 880.8336s
Epoch: 8 cost time: 9.89779806137085
Epoch: 8, Steps: 208 | Train Loss: 2.356 Vali Loss: 4.835 Vali Acc: 0.106 Test Loss: 4.835 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8070186
	speed: 0.1542s/iter; left time: 2934.5902s
	iters: 200, epoch: 9 | loss: 2.6178136
	speed: 0.0474s/iter; left time: 897.7277s
Epoch: 9 cost time: 10.132478952407837
Epoch: 9, Steps: 208 | Train Loss: 2.077 Vali Loss: 5.126 Vali Acc: 0.104 Test Loss: 5.126 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0652966
	speed: 0.1693s/iter; left time: 3188.4844s
	iters: 200, epoch: 10 | loss: 1.6029387
	speed: 0.0489s/iter; left time: 915.5665s
Epoch: 10 cost time: 10.582196235656738
Epoch: 10, Steps: 208 | Train Loss: 1.809 Vali Loss: 5.384 Vali Acc: 0.117 Test Loss: 5.384 Test Acc: 0.117
Validation loss decreased (-0.106727 --> -0.116856).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0680931
	speed: 0.1588s/iter; left time: 2956.3894s
	iters: 200, epoch: 11 | loss: 1.4116536
	speed: 0.0483s/iter; left time: 894.8691s
Epoch: 11 cost time: 10.5323805809021
Epoch: 11, Steps: 208 | Train Loss: 1.571 Vali Loss: 5.593 Vali Acc: 0.113 Test Loss: 5.593 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6130083
	speed: 0.1581s/iter; left time: 2911.0844s
	iters: 200, epoch: 12 | loss: 2.3749793
	speed: 0.0467s/iter; left time: 854.6353s
Epoch: 12 cost time: 10.082429647445679
Epoch: 12, Steps: 208 | Train Loss: 1.322 Vali Loss: 5.765 Vali Acc: 0.113 Test Loss: 5.765 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7162519
	speed: 0.1651s/iter; left time: 3005.6691s
	iters: 200, epoch: 13 | loss: 0.9526371
	speed: 0.0477s/iter; left time: 862.8629s
Epoch: 13 cost time: 10.343427658081055
Epoch: 13, Steps: 208 | Train Loss: 1.120 Vali Loss: 6.392 Vali Acc: 0.102 Test Loss: 6.392 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3085191
	speed: 0.1624s/iter; left time: 2923.2908s
	iters: 200, epoch: 14 | loss: 0.6707043
	speed: 0.0478s/iter; left time: 855.8767s
Epoch: 14 cost time: 10.270363569259644
Epoch: 14, Steps: 208 | Train Loss: 0.951 Vali Loss: 6.770 Vali Acc: 0.118 Test Loss: 6.770 Test Acc: 0.118
Validation loss decreased (-0.116856 --> -0.117737).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0797818
	speed: 0.1574s/iter; left time: 2800.6099s
	iters: 200, epoch: 15 | loss: 0.7550709
	speed: 0.0413s/iter; left time: 730.4095s
Epoch: 15 cost time: 9.111572980880737
Epoch: 15, Steps: 208 | Train Loss: 0.820 Vali Loss: 7.043 Vali Acc: 0.111 Test Loss: 7.043 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6507566
	speed: 0.1540s/iter; left time: 2708.0102s
	iters: 200, epoch: 16 | loss: 1.0610684
	speed: 0.0401s/iter; left time: 700.7217s
Epoch: 16 cost time: 8.726242065429688
Epoch: 16, Steps: 208 | Train Loss: 0.726 Vali Loss: 7.584 Vali Acc: 0.112 Test Loss: 7.584 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5988708
	speed: 0.1603s/iter; left time: 2784.8655s
	iters: 200, epoch: 17 | loss: 0.7662355
	speed: 0.0428s/iter; left time: 739.7632s
Epoch: 17 cost time: 9.562827825546265
Epoch: 17, Steps: 208 | Train Loss: 0.611 Vali Loss: 7.929 Vali Acc: 0.108 Test Loss: 7.929 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7086834
	speed: 0.1637s/iter; left time: 2809.5592s
	iters: 200, epoch: 18 | loss: 1.3080649
	speed: 0.0436s/iter; left time: 744.6871s
Epoch: 18 cost time: 9.569062948226929
Epoch: 18, Steps: 208 | Train Loss: 0.541 Vali Loss: 8.349 Vali Acc: 0.105 Test Loss: 8.349 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7151639
	speed: 0.1713s/iter; left time: 2905.0586s
	iters: 200, epoch: 19 | loss: 0.1634648
	speed: 0.0398s/iter; left time: 670.3911s
Epoch: 19 cost time: 9.402891874313354
Epoch: 19, Steps: 208 | Train Loss: 0.498 Vali Loss: 9.059 Vali Acc: 0.107 Test Loss: 9.059 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6017795
	speed: 0.1575s/iter; left time: 2638.4988s
	iters: 200, epoch: 20 | loss: 0.6709642
	speed: 0.0407s/iter; left time: 678.1858s
Epoch: 20 cost time: 9.266381978988647
Epoch: 20, Steps: 208 | Train Loss: 0.452 Vali Loss: 9.288 Vali Acc: 0.108 Test Loss: 9.288 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2924750
	speed: 0.1533s/iter; left time: 2535.4259s
	iters: 200, epoch: 21 | loss: 0.5499999
	speed: 0.0416s/iter; left time: 684.4186s
Epoch: 21 cost time: 9.104196071624756
Epoch: 21, Steps: 208 | Train Loss: 0.389 Vali Loss: 9.799 Vali Acc: 0.103 Test Loss: 9.799 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3333885
	speed: 0.1548s/iter; left time: 2528.3433s
	iters: 200, epoch: 22 | loss: 0.3576286
	speed: 0.0466s/iter; left time: 755.9660s
Epoch: 22 cost time: 9.792152404785156
Epoch: 22, Steps: 208 | Train Loss: 0.357 Vali Loss: 10.062 Vali Acc: 0.110 Test Loss: 10.062 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.5740516
	speed: 0.1620s/iter; left time: 2611.6272s
	iters: 200, epoch: 23 | loss: 0.4070962
	speed: 0.0425s/iter; left time: 680.7689s
Epoch: 23 cost time: 9.495612144470215
Epoch: 23, Steps: 208 | Train Loss: 0.315 Vali Loss: 10.383 Vali Acc: 0.114 Test Loss: 10.383 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0986528
	speed: 0.1649s/iter; left time: 2625.4729s
	iters: 200, epoch: 24 | loss: 0.2203447
	speed: 0.0467s/iter; left time: 738.7191s
Epoch: 24 cost time: 10.34212589263916
Epoch: 24, Steps: 208 | Train Loss: 0.325 Vali Loss: 10.596 Vali Acc: 0.111 Test Loss: 10.596 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11780495079033701
model parameter : 325735
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4504282
	speed: 0.0671s/iter; left time: 1388.8706s
	iters: 200, epoch: 1 | loss: 3.9514482
	speed: 0.0495s/iter; left time: 1019.8920s
Epoch: 1 cost time: 12.148944616317749
Epoch: 1, Steps: 208 | Train Loss: 3.827 Vali Loss: 3.875 Vali Acc: 0.055 Test Loss: 3.875 Test Acc: 0.055
Validation loss decreased (inf --> -0.054539).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7852495
	speed: 0.1674s/iter; left time: 3429.5875s
	iters: 200, epoch: 2 | loss: 3.4630406
	speed: 0.0491s/iter; left time: 1001.2226s
Epoch: 2 cost time: 10.69464111328125
Epoch: 2, Steps: 208 | Train Loss: 3.629 Vali Loss: 3.898 Vali Acc: 0.076 Test Loss: 3.898 Test Acc: 0.076
Validation loss decreased (-0.054539 --> -0.076311).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6376836
	speed: 0.1619s/iter; left time: 3283.2344s
	iters: 200, epoch: 3 | loss: 3.1096280
	speed: 0.0480s/iter; left time: 968.4530s
Epoch: 3 cost time: 10.469091653823853
Epoch: 3, Steps: 208 | Train Loss: 3.336 Vali Loss: 3.715 Vali Acc: 0.076 Test Loss: 3.715 Test Acc: 0.076
Validation loss decreased (-0.076311 --> -0.076312).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3383026
	speed: 0.1651s/iter; left time: 3313.8138s
	iters: 200, epoch: 4 | loss: 3.3317852
	speed: 0.0458s/iter; left time: 915.8292s
Epoch: 4 cost time: 10.035230875015259
Epoch: 4, Steps: 208 | Train Loss: 3.107 Vali Loss: 3.898 Vali Acc: 0.089 Test Loss: 3.898 Test Acc: 0.089
Validation loss decreased (-0.076312 --> -0.088538).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5020838
	speed: 0.1650s/iter; left time: 3278.7838s
	iters: 200, epoch: 5 | loss: 2.7498384
	speed: 0.0480s/iter; left time: 948.8806s
Epoch: 5 cost time: 10.29904317855835
Epoch: 5, Steps: 208 | Train Loss: 2.945 Vali Loss: 3.909 Vali Acc: 0.101 Test Loss: 3.909 Test Acc: 0.101
Validation loss decreased (-0.088538 --> -0.100468).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3695171
	speed: 0.1703s/iter; left time: 3347.7909s
	iters: 200, epoch: 6 | loss: 3.7100391
	speed: 0.0536s/iter; left time: 1047.9305s
Epoch: 6 cost time: 11.647457599639893
Epoch: 6, Steps: 208 | Train Loss: 2.793 Vali Loss: 4.190 Vali Acc: 0.104 Test Loss: 4.190 Test Acc: 0.104
Validation loss decreased (-0.100468 --> -0.104342).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8359149
	speed: 0.1779s/iter; left time: 3459.8315s
	iters: 200, epoch: 7 | loss: 2.1898091
	speed: 0.0514s/iter; left time: 995.6601s
Epoch: 7 cost time: 11.412995100021362
Epoch: 7, Steps: 208 | Train Loss: 2.576 Vali Loss: 4.450 Vali Acc: 0.109 Test Loss: 4.450 Test Acc: 0.109
Validation loss decreased (-0.104342 --> -0.108813).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6496196
	speed: 0.1700s/iter; left time: 3271.2914s
	iters: 200, epoch: 8 | loss: 2.2688553
	speed: 0.0519s/iter; left time: 993.3759s
Epoch: 8 cost time: 11.33660626411438
Epoch: 8, Steps: 208 | Train Loss: 2.385 Vali Loss: 4.664 Vali Acc: 0.099 Test Loss: 4.664 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5405188
	speed: 0.1567s/iter; left time: 2983.1790s
	iters: 200, epoch: 9 | loss: 2.1830618
	speed: 0.0498s/iter; left time: 942.2598s
Epoch: 9 cost time: 10.401859998703003
Epoch: 9, Steps: 208 | Train Loss: 2.109 Vali Loss: 4.965 Vali Acc: 0.102 Test Loss: 4.965 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5757490
	speed: 0.1769s/iter; left time: 3330.0847s
	iters: 200, epoch: 10 | loss: 2.3882709
	speed: 0.0466s/iter; left time: 873.3650s
Epoch: 10 cost time: 10.657819986343384
Epoch: 10, Steps: 208 | Train Loss: 1.855 Vali Loss: 5.390 Vali Acc: 0.104 Test Loss: 5.390 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5782498
	speed: 0.1693s/iter; left time: 3152.7254s
	iters: 200, epoch: 11 | loss: 2.4588528
	speed: 0.0470s/iter; left time: 870.6253s
Epoch: 11 cost time: 10.395642042160034
Epoch: 11, Steps: 208 | Train Loss: 1.627 Vali Loss: 5.597 Vali Acc: 0.108 Test Loss: 5.597 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1268858
	speed: 0.1610s/iter; left time: 2964.5073s
	iters: 200, epoch: 12 | loss: 1.2460091
	speed: 0.0459s/iter; left time: 839.7812s
Epoch: 12 cost time: 9.824975728988647
Epoch: 12, Steps: 208 | Train Loss: 1.413 Vali Loss: 5.775 Vali Acc: 0.116 Test Loss: 5.775 Test Acc: 0.116
Validation loss decreased (-0.108813 --> -0.116256).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7883958
	speed: 0.1603s/iter; left time: 2918.6878s
	iters: 200, epoch: 13 | loss: 1.3073856
	speed: 0.0440s/iter; left time: 796.4709s
Epoch: 13 cost time: 9.441036224365234
Epoch: 13, Steps: 208 | Train Loss: 1.183 Vali Loss: 6.392 Vali Acc: 0.106 Test Loss: 6.392 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8220184
	speed: 0.1607s/iter; left time: 2893.0154s
	iters: 200, epoch: 14 | loss: 1.1592125
	speed: 0.0399s/iter; left time: 713.2074s
Epoch: 14 cost time: 8.96076488494873
Epoch: 14, Steps: 208 | Train Loss: 0.990 Vali Loss: 6.711 Vali Acc: 0.105 Test Loss: 6.711 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2463672
	speed: 0.1592s/iter; left time: 2832.2722s
	iters: 200, epoch: 15 | loss: 0.9678356
	speed: 0.0440s/iter; left time: 777.6778s
Epoch: 15 cost time: 9.507530450820923
Epoch: 15, Steps: 208 | Train Loss: 0.851 Vali Loss: 7.021 Vali Acc: 0.105 Test Loss: 7.021 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3167490
	speed: 0.1518s/iter; left time: 2669.2066s
	iters: 200, epoch: 16 | loss: 0.5207019
	speed: 0.0382s/iter; left time: 668.0803s
Epoch: 16 cost time: 8.42274022102356
Epoch: 16, Steps: 208 | Train Loss: 0.746 Vali Loss: 7.662 Vali Acc: 0.102 Test Loss: 7.662 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7438872
	speed: 0.1526s/iter; left time: 2651.7865s
	iters: 200, epoch: 17 | loss: 0.4901317
	speed: 0.0435s/iter; left time: 750.8479s
Epoch: 17 cost time: 9.317200899124146
Epoch: 17, Steps: 208 | Train Loss: 0.655 Vali Loss: 8.099 Vali Acc: 0.111 Test Loss: 8.099 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4860113
	speed: 0.1503s/iter; left time: 2579.7074s
	iters: 200, epoch: 18 | loss: 0.5825766
	speed: 0.0413s/iter; left time: 705.5854s
Epoch: 18 cost time: 8.902381420135498
Epoch: 18, Steps: 208 | Train Loss: 0.578 Vali Loss: 8.394 Vali Acc: 0.108 Test Loss: 8.394 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3128503
	speed: 0.1565s/iter; left time: 2653.4757s
	iters: 200, epoch: 19 | loss: 1.2109011
	speed: 0.0407s/iter; left time: 686.3036s
Epoch: 19 cost time: 9.129502058029175
Epoch: 19, Steps: 208 | Train Loss: 0.523 Vali Loss: 8.801 Vali Acc: 0.113 Test Loss: 8.801 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.1687511
	speed: 0.1534s/iter; left time: 2568.7401s
	iters: 200, epoch: 20 | loss: 0.5828371
	speed: 0.0415s/iter; left time: 691.3700s
Epoch: 20 cost time: 9.11789345741272
Epoch: 20, Steps: 208 | Train Loss: 0.491 Vali Loss: 9.144 Vali Acc: 0.108 Test Loss: 9.144 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1288814
	speed: 0.1494s/iter; left time: 2471.7188s
	iters: 200, epoch: 21 | loss: 0.5220507
	speed: 0.0399s/iter; left time: 656.2813s
Epoch: 21 cost time: 8.928184032440186
Epoch: 21, Steps: 208 | Train Loss: 0.435 Vali Loss: 9.390 Vali Acc: 0.109 Test Loss: 9.390 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2598051
	speed: 0.1575s/iter; left time: 2572.2629s
	iters: 200, epoch: 22 | loss: 0.2905927
	speed: 0.0454s/iter; left time: 736.3004s
Epoch: 22 cost time: 9.972059488296509
Epoch: 22, Steps: 208 | Train Loss: 0.403 Vali Loss: 9.883 Vali Acc: 0.106 Test Loss: 9.883 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm64_nh16_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11631374888159857
model parameter : 271527
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9885907
	speed: 0.0814s/iter; left time: 1684.7754s
	iters: 200, epoch: 1 | loss: 4.1784945
	speed: 0.0646s/iter; left time: 1330.8409s
Epoch: 1 cost time: 15.212444067001343
Epoch: 1, Steps: 208 | Train Loss: 4.214 Vali Loss: 3.531 Vali Acc: 0.068 Test Loss: 3.531 Test Acc: 0.068
Validation loss decreased (inf --> -0.067963).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3698428
	speed: 0.2130s/iter; left time: 4365.9265s
	iters: 200, epoch: 2 | loss: 3.8420689
	speed: 0.0683s/iter; left time: 1391.9125s
Epoch: 2 cost time: 14.919374942779541
Epoch: 2, Steps: 208 | Train Loss: 3.411 Vali Loss: 4.568 Vali Acc: 0.059 Test Loss: 4.568 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4491873
	speed: 0.2162s/iter; left time: 4385.3758s
	iters: 200, epoch: 3 | loss: 2.9374108
	speed: 0.0690s/iter; left time: 1393.1389s
Epoch: 3 cost time: 14.967305660247803
Epoch: 3, Steps: 208 | Train Loss: 3.417 Vali Loss: 4.167 Vali Acc: 0.087 Test Loss: 4.167 Test Acc: 0.087
Validation loss decreased (-0.067963 --> -0.087045).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6812165
	speed: 0.2122s/iter; left time: 4260.9067s
	iters: 200, epoch: 4 | loss: 4.1829267
	speed: 0.0663s/iter; left time: 1323.9619s
Epoch: 4 cost time: 14.359811067581177
Epoch: 4, Steps: 208 | Train Loss: 3.427 Vali Loss: 4.501 Vali Acc: 0.088 Test Loss: 4.501 Test Acc: 0.088
Validation loss decreased (-0.087045 --> -0.087936).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9537396
	speed: 0.2149s/iter; left time: 4270.3553s
	iters: 200, epoch: 5 | loss: 5.0619240
	speed: 0.0663s/iter; left time: 1309.8228s
Epoch: 5 cost time: 14.525846242904663
Epoch: 5, Steps: 208 | Train Loss: 3.403 Vali Loss: 6.577 Vali Acc: 0.077 Test Loss: 6.577 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.6477876
	speed: 0.2154s/iter; left time: 4235.6442s
	iters: 200, epoch: 6 | loss: 4.7151680
	speed: 0.0689s/iter; left time: 1348.3315s
Epoch: 6 cost time: 14.968658447265625
Epoch: 6, Steps: 208 | Train Loss: 3.068 Vali Loss: 4.534 Vali Acc: 0.078 Test Loss: 4.534 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.5257335
	speed: 0.2136s/iter; left time: 4154.3637s
	iters: 200, epoch: 7 | loss: 2.7577381
	speed: 0.0673s/iter; left time: 1301.8136s
Epoch: 7 cost time: 14.668981552124023
Epoch: 7, Steps: 208 | Train Loss: 2.677 Vali Loss: 4.746 Vali Acc: 0.117 Test Loss: 4.746 Test Acc: 0.117
Validation loss decreased (-0.087936 --> -0.116565).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1235731
	speed: 0.2078s/iter; left time: 3998.4984s
	iters: 200, epoch: 8 | loss: 2.7534833
	speed: 0.0700s/iter; left time: 1340.4001s
Epoch: 8 cost time: 14.643531322479248
Epoch: 8, Steps: 208 | Train Loss: 2.070 Vali Loss: 5.048 Vali Acc: 0.089 Test Loss: 5.048 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0235894
	speed: 0.2114s/iter; left time: 4025.0176s
	iters: 200, epoch: 9 | loss: 2.5103707
	speed: 0.0701s/iter; left time: 1326.7047s
Epoch: 9 cost time: 14.937291383743286
Epoch: 9, Steps: 208 | Train Loss: 1.662 Vali Loss: 5.844 Vali Acc: 0.115 Test Loss: 5.844 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8380760
	speed: 0.2093s/iter; left time: 3940.8884s
	iters: 200, epoch: 10 | loss: 1.7251606
	speed: 0.0641s/iter; left time: 1199.8127s
Epoch: 10 cost time: 13.803375482559204
Epoch: 10, Steps: 208 | Train Loss: 1.377 Vali Loss: 5.423 Vali Acc: 0.109 Test Loss: 5.423 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.7371662
	speed: 0.2023s/iter; left time: 3767.1295s
	iters: 200, epoch: 11 | loss: 1.5359124
	speed: 0.0652s/iter; left time: 1208.4171s
Epoch: 11 cost time: 13.944161653518677
Epoch: 11, Steps: 208 | Train Loss: 1.102 Vali Loss: 6.396 Vali Acc: 0.118 Test Loss: 6.396 Test Acc: 0.118
Validation loss decreased (-0.116565 --> -0.118337).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9248605
	speed: 0.2034s/iter; left time: 3744.8058s
	iters: 200, epoch: 12 | loss: 0.6439370
	speed: 0.0617s/iter; left time: 1129.2340s
Epoch: 12 cost time: 13.87170124053955
Epoch: 12, Steps: 208 | Train Loss: 0.936 Vali Loss: 7.335 Vali Acc: 0.110 Test Loss: 7.335 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5457337
	speed: 0.1989s/iter; left time: 3621.3788s
	iters: 200, epoch: 13 | loss: 1.6100788
	speed: 0.0659s/iter; left time: 1192.9122s
Epoch: 13 cost time: 13.835509777069092
Epoch: 13, Steps: 208 | Train Loss: 0.766 Vali Loss: 7.840 Vali Acc: 0.112 Test Loss: 7.840 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.5746291
	speed: 0.2003s/iter; left time: 3604.2153s
	iters: 200, epoch: 14 | loss: 0.5724458
	speed: 0.0628s/iter; left time: 1123.2380s
Epoch: 14 cost time: 13.83025074005127
Epoch: 14, Steps: 208 | Train Loss: 0.632 Vali Loss: 8.343 Vali Acc: 0.117 Test Loss: 8.343 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2110253
	speed: 0.2004s/iter; left time: 3565.3645s
	iters: 200, epoch: 15 | loss: 0.6252834
	speed: 0.0620s/iter; left time: 1097.0029s
Epoch: 15 cost time: 13.568286657333374
Epoch: 15, Steps: 208 | Train Loss: 0.555 Vali Loss: 9.156 Vali Acc: 0.110 Test Loss: 9.156 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.2239819
	speed: 0.1999s/iter; left time: 3515.1336s
	iters: 200, epoch: 16 | loss: 0.7683411
	speed: 0.0621s/iter; left time: 1086.0027s
Epoch: 16 cost time: 13.463459014892578
Epoch: 16, Steps: 208 | Train Loss: 0.435 Vali Loss: 9.419 Vali Acc: 0.122 Test Loss: 9.419 Test Acc: 0.122
Validation loss decreased (-0.118337 --> -0.121588).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6315378
	speed: 0.2068s/iter; left time: 3592.2818s
	iters: 200, epoch: 17 | loss: 0.4450114
	speed: 0.0694s/iter; left time: 1198.8299s
Epoch: 17 cost time: 14.728886842727661
Epoch: 17, Steps: 208 | Train Loss: 0.374 Vali Loss: 9.500 Vali Acc: 0.099 Test Loss: 9.500 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2352809
	speed: 0.2308s/iter; left time: 3962.0852s
	iters: 200, epoch: 18 | loss: 0.8151442
	speed: 0.0763s/iter; left time: 1302.3547s
Epoch: 18 cost time: 16.16097855567932
Epoch: 18, Steps: 208 | Train Loss: 0.347 Vali Loss: 10.686 Vali Acc: 0.121 Test Loss: 10.686 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2513966
	speed: 0.2160s/iter; left time: 3662.3537s
	iters: 200, epoch: 19 | loss: 0.3961686
	speed: 0.0642s/iter; left time: 1083.0038s
Epoch: 19 cost time: 13.789212942123413
Epoch: 19, Steps: 208 | Train Loss: 0.284 Vali Loss: 10.990 Vali Acc: 0.110 Test Loss: 10.990 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0493477
	speed: 0.2191s/iter; left time: 3670.2978s
	iters: 200, epoch: 20 | loss: 0.2645422
	speed: 0.0695s/iter; left time: 1156.7468s
Epoch: 20 cost time: 15.101894617080688
Epoch: 20, Steps: 208 | Train Loss: 0.258 Vali Loss: 10.933 Vali Acc: 0.111 Test Loss: 10.933 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1565385
	speed: 0.2174s/iter; left time: 3595.4360s
	iters: 200, epoch: 21 | loss: 0.5403448
	speed: 0.0684s/iter; left time: 1125.1471s
Epoch: 21 cost time: 14.848397254943848
Epoch: 21, Steps: 208 | Train Loss: 0.221 Vali Loss: 12.057 Vali Acc: 0.111 Test Loss: 12.057 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0636453
	speed: 0.2227s/iter; left time: 3638.1061s
	iters: 200, epoch: 22 | loss: 0.1277623
	speed: 0.0710s/iter; left time: 1152.9627s
Epoch: 22 cost time: 15.624844789505005
Epoch: 22, Steps: 208 | Train Loss: 0.211 Vali Loss: 11.838 Vali Acc: 0.111 Test Loss: 11.838 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.4457896
	speed: 0.2227s/iter; left time: 3591.0861s
	iters: 200, epoch: 23 | loss: 0.0048374
	speed: 0.0725s/iter; left time: 1162.1007s
Epoch: 23 cost time: 15.435450315475464
Epoch: 23, Steps: 208 | Train Loss: 0.177 Vali Loss: 12.836 Vali Acc: 0.110 Test Loss: 12.836 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0438474
	speed: 0.2255s/iter; left time: 3589.2058s
	iters: 200, epoch: 24 | loss: 0.0847313
	speed: 0.0718s/iter; left time: 1135.7782s
Epoch: 24 cost time: 15.782732248306274
Epoch: 24, Steps: 208 | Train Loss: 0.194 Vali Loss: 13.053 Vali Acc: 0.108 Test Loss: 13.053 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0554143
	speed: 0.2230s/iter; left time: 3502.9205s
	iters: 200, epoch: 25 | loss: 0.0816538
	speed: 0.0739s/iter; left time: 1153.2527s
Epoch: 25 cost time: 15.78087043762207
Epoch: 25, Steps: 208 | Train Loss: 0.164 Vali Loss: 13.536 Vali Acc: 0.105 Test Loss: 13.536 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2037358
	speed: 0.2273s/iter; left time: 3523.8209s
	iters: 200, epoch: 26 | loss: 0.1748168
	speed: 0.0730s/iter; left time: 1124.0213s
Epoch: 26 cost time: 15.829911470413208
Epoch: 26, Steps: 208 | Train Loss: 0.182 Vali Loss: 14.365 Vali Acc: 0.110 Test Loss: 14.365 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12168207575305696
model parameter : 1051783
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7481329
	speed: 0.1209s/iter; left time: 2503.0402s
	iters: 200, epoch: 1 | loss: 3.1785564
	speed: 0.1030s/iter; left time: 2121.1101s
Epoch: 1 cost time: 23.25445795059204
Epoch: 1, Steps: 208 | Train Loss: 3.957 Vali Loss: 3.981 Vali Acc: 0.062 Test Loss: 3.981 Test Acc: 0.062
Validation loss decreased (inf --> -0.062292).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8930750
	speed: 0.1946s/iter; left time: 3988.8288s
	iters: 200, epoch: 2 | loss: 3.4538140
	speed: 0.0789s/iter; left time: 1608.2391s
Epoch: 2 cost time: 16.638094663619995
Epoch: 2, Steps: 208 | Train Loss: 3.447 Vali Loss: 3.667 Vali Acc: 0.078 Test Loss: 3.667 Test Acc: 0.078
Validation loss decreased (-0.062292 --> -0.078401).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5951753
	speed: 0.1914s/iter; left time: 3883.1831s
	iters: 200, epoch: 3 | loss: 3.4962714
	speed: 0.0679s/iter; left time: 1371.0318s
Epoch: 3 cost time: 14.628999710083008
Epoch: 3, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.453 Vali Acc: 0.095 Test Loss: 3.453 Test Acc: 0.095
Validation loss decreased (-0.078401 --> -0.094508).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1579342
	speed: 0.1792s/iter; left time: 3597.5162s
	iters: 200, epoch: 4 | loss: 3.5063863
	speed: 0.0730s/iter; left time: 1459.0626s
Epoch: 4 cost time: 14.648809909820557
Epoch: 4, Steps: 208 | Train Loss: 3.063 Vali Loss: 3.781 Vali Acc: 0.101 Test Loss: 3.781 Test Acc: 0.101
Validation loss decreased (-0.094508 --> -0.101364).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6648834
	speed: 0.1891s/iter; left time: 3756.3018s
	iters: 200, epoch: 5 | loss: 3.2057145
	speed: 0.0715s/iter; left time: 1413.4031s
Epoch: 5 cost time: 15.449612855911255
Epoch: 5, Steps: 208 | Train Loss: 2.976 Vali Loss: 4.151 Vali Acc: 0.098 Test Loss: 4.151 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.5764015
	speed: 0.1953s/iter; left time: 3840.5735s
	iters: 200, epoch: 6 | loss: 3.0140369
	speed: 0.0772s/iter; left time: 1510.7840s
Epoch: 6 cost time: 16.468714475631714
Epoch: 6, Steps: 208 | Train Loss: 2.755 Vali Loss: 4.182 Vali Acc: 0.107 Test Loss: 4.182 Test Acc: 0.107
Validation loss decreased (-0.101364 --> -0.107026).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7891223
	speed: 0.1896s/iter; left time: 3689.2389s
	iters: 200, epoch: 7 | loss: 3.1057289
	speed: 0.0766s/iter; left time: 1482.9024s
Epoch: 7 cost time: 15.981898784637451
Epoch: 7, Steps: 208 | Train Loss: 2.510 Vali Loss: 4.682 Vali Acc: 0.103 Test Loss: 4.682 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6894608
	speed: 0.2200s/iter; left time: 4233.8258s
	iters: 200, epoch: 8 | loss: 2.2248764
	speed: 0.1012s/iter; left time: 1936.7376s
Epoch: 8 cost time: 21.710625171661377
Epoch: 8, Steps: 208 | Train Loss: 2.212 Vali Loss: 5.166 Vali Acc: 0.102 Test Loss: 5.166 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7831208
	speed: 0.2295s/iter; left time: 4368.9925s
	iters: 200, epoch: 9 | loss: 2.2182572
	speed: 0.0987s/iter; left time: 1869.7730s
Epoch: 9 cost time: 21.33148455619812
Epoch: 9, Steps: 208 | Train Loss: 1.830 Vali Loss: 4.922 Vali Acc: 0.118 Test Loss: 4.922 Test Acc: 0.118
Validation loss decreased (-0.107026 --> -0.117756).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7185895
	speed: 0.2270s/iter; left time: 4273.4523s
	iters: 200, epoch: 10 | loss: 1.6303127
	speed: 0.0985s/iter; left time: 1845.4129s
Epoch: 10 cost time: 21.24393343925476
Epoch: 10, Steps: 208 | Train Loss: 1.575 Vali Loss: 5.628 Vali Acc: 0.109 Test Loss: 5.628 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4065876
	speed: 0.2231s/iter; left time: 4154.3219s
	iters: 200, epoch: 11 | loss: 1.3799345
	speed: 0.0956s/iter; left time: 1771.3470s
Epoch: 11 cost time: 20.681400060653687
Epoch: 11, Steps: 208 | Train Loss: 1.412 Vali Loss: 5.570 Vali Acc: 0.112 Test Loss: 5.570 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1455493
	speed: 0.2277s/iter; left time: 4193.4394s
	iters: 200, epoch: 12 | loss: 1.7929397
	speed: 0.0980s/iter; left time: 1794.6404s
Epoch: 12 cost time: 20.810721158981323
Epoch: 12, Steps: 208 | Train Loss: 1.213 Vali Loss: 5.823 Vali Acc: 0.120 Test Loss: 5.823 Test Acc: 0.120
Validation loss decreased (-0.117756 --> -0.120431).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5838830
	speed: 0.2202s/iter; left time: 4009.1615s
	iters: 200, epoch: 13 | loss: 1.5201142
	speed: 0.0952s/iter; left time: 1723.4028s
Epoch: 13 cost time: 20.45989179611206
Epoch: 13, Steps: 208 | Train Loss: 1.031 Vali Loss: 6.430 Vali Acc: 0.124 Test Loss: 6.430 Test Acc: 0.124
Validation loss decreased (-0.120431 --> -0.123705).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5122330
	speed: 0.2128s/iter; left time: 3829.3578s
	iters: 200, epoch: 14 | loss: 0.8973827
	speed: 0.0973s/iter; left time: 1741.7340s
Epoch: 14 cost time: 20.127010822296143
Epoch: 14, Steps: 208 | Train Loss: 0.880 Vali Loss: 6.598 Vali Acc: 0.116 Test Loss: 6.598 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2464365
	speed: 0.2148s/iter; left time: 3821.8422s
	iters: 200, epoch: 15 | loss: 0.7833411
	speed: 0.0976s/iter; left time: 1727.0741s
Epoch: 15 cost time: 20.334843635559082
Epoch: 15, Steps: 208 | Train Loss: 0.733 Vali Loss: 6.995 Vali Acc: 0.122 Test Loss: 6.995 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3043163
	speed: 0.1889s/iter; left time: 3320.9363s
	iters: 200, epoch: 16 | loss: 1.0275316
	speed: 0.0668s/iter; left time: 1168.2872s
Epoch: 16 cost time: 14.728837013244629
Epoch: 16, Steps: 208 | Train Loss: 0.654 Vali Loss: 7.631 Vali Acc: 0.127 Test Loss: 7.631 Test Acc: 0.127
Validation loss decreased (-0.123705 --> -0.126974).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3497884
	speed: 0.1956s/iter; left time: 3398.5858s
	iters: 200, epoch: 17 | loss: 0.9138187
	speed: 0.0700s/iter; left time: 1208.2612s
Epoch: 17 cost time: 15.666260957717896
Epoch: 17, Steps: 208 | Train Loss: 0.557 Vali Loss: 8.336 Vali Acc: 0.125 Test Loss: 8.336 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6361221
	speed: 0.1894s/iter; left time: 3250.7329s
	iters: 200, epoch: 18 | loss: 0.6868294
	speed: 0.0709s/iter; left time: 1209.9019s
Epoch: 18 cost time: 15.142750978469849
Epoch: 18, Steps: 208 | Train Loss: 0.474 Vali Loss: 8.482 Vali Acc: 0.126 Test Loss: 8.482 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4844966
	speed: 0.1735s/iter; left time: 2942.3780s
	iters: 200, epoch: 19 | loss: 1.5330582
	speed: 0.0708s/iter; left time: 1193.2110s
Epoch: 19 cost time: 14.089176177978516
Epoch: 19, Steps: 208 | Train Loss: 0.454 Vali Loss: 8.689 Vali Acc: 0.122 Test Loss: 8.689 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.5880682
	speed: 0.1911s/iter; left time: 3201.3547s
	iters: 200, epoch: 20 | loss: 0.3148369
	speed: 0.0730s/iter; left time: 1215.2317s
Epoch: 20 cost time: 15.792481899261475
Epoch: 20, Steps: 208 | Train Loss: 0.396 Vali Loss: 9.180 Vali Acc: 0.129 Test Loss: 9.180 Test Acc: 0.129
Validation loss decreased (-0.126974 --> -0.128450).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1251548
	speed: 0.1972s/iter; left time: 3261.1887s
	iters: 200, epoch: 21 | loss: 0.4072711
	speed: 0.0680s/iter; left time: 1118.8041s
Epoch: 21 cost time: 15.40036916732788
Epoch: 21, Steps: 208 | Train Loss: 0.383 Vali Loss: 9.598 Vali Acc: 0.123 Test Loss: 9.598 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0588495
	speed: 0.1889s/iter; left time: 3085.4924s
	iters: 200, epoch: 22 | loss: 0.7590895
	speed: 0.1086s/iter; left time: 1763.0508s
Epoch: 22 cost time: 19.970498085021973
Epoch: 22, Steps: 208 | Train Loss: 0.328 Vali Loss: 10.008 Vali Acc: 0.119 Test Loss: 10.008 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2148093
	speed: 0.2335s/iter; left time: 3765.1233s
	iters: 200, epoch: 23 | loss: 0.3644250
	speed: 0.1096s/iter; left time: 1756.7093s
Epoch: 23 cost time: 23.12758469581604
Epoch: 23, Steps: 208 | Train Loss: 0.317 Vali Loss: 10.281 Vali Acc: 0.123 Test Loss: 10.281 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.4028055
	speed: 0.2404s/iter; left time: 3826.4505s
	iters: 200, epoch: 24 | loss: 0.6732224
	speed: 0.0942s/iter; left time: 1490.3628s
Epoch: 24 cost time: 21.61112403869629
Epoch: 24, Steps: 208 | Train Loss: 0.290 Vali Loss: 10.583 Vali Acc: 0.121 Test Loss: 10.583 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1082716
	speed: 0.2195s/iter; left time: 3448.3498s
	iters: 200, epoch: 25 | loss: 0.2787079
	speed: 0.0970s/iter; left time: 1513.7566s
Epoch: 25 cost time: 20.947728157043457
Epoch: 25, Steps: 208 | Train Loss: 0.268 Vali Loss: 11.286 Vali Acc: 0.120 Test Loss: 11.286 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0904817
	speed: 0.2162s/iter; left time: 3352.0678s
	iters: 200, epoch: 26 | loss: 0.3867952
	speed: 0.0956s/iter; left time: 1472.0212s
Epoch: 26 cost time: 20.197922229766846
Epoch: 26, Steps: 208 | Train Loss: 0.269 Vali Loss: 11.100 Vali Acc: 0.125 Test Loss: 11.100 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.1150503
	speed: 0.2237s/iter; left time: 3420.5035s
	iters: 200, epoch: 27 | loss: 0.0617328
	speed: 0.0961s/iter; left time: 1460.3321s
Epoch: 27 cost time: 20.17798137664795
Epoch: 27, Steps: 208 | Train Loss: 0.229 Vali Loss: 11.773 Vali Acc: 0.123 Test Loss: 11.773 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.4844947
	speed: 0.2293s/iter; left time: 3459.2381s
	iters: 200, epoch: 28 | loss: 0.4368176
	speed: 0.0967s/iter; left time: 1449.6253s
Epoch: 28 cost time: 21.116611003875732
Epoch: 28, Steps: 208 | Train Loss: 0.226 Vali Loss: 11.493 Vali Acc: 0.130 Test Loss: 11.493 Test Acc: 0.130
Validation loss decreased (-0.128450 --> -0.130216).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0962174
	speed: 0.2303s/iter; left time: 3426.6667s
	iters: 200, epoch: 29 | loss: 0.3960307
	speed: 0.0980s/iter; left time: 1447.7289s
Epoch: 29 cost time: 21.209755897521973
Epoch: 29, Steps: 208 | Train Loss: 0.205 Vali Loss: 11.879 Vali Acc: 0.125 Test Loss: 11.879 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.5520697
	speed: 0.2203s/iter; left time: 3231.9430s
	iters: 200, epoch: 30 | loss: 0.1231943
	speed: 0.0873s/iter; left time: 1271.8211s
Epoch: 30 cost time: 20.029062032699585
Epoch: 30, Steps: 208 | Train Loss: 0.201 Vali Loss: 12.255 Vali Acc: 0.122 Test Loss: 12.255 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.1301944
	speed: 0.1889s/iter; left time: 2731.2230s
	iters: 200, epoch: 31 | loss: 0.0214512
	speed: 0.0815s/iter; left time: 1171.0060s
Epoch: 31 cost time: 16.39769434928894
Epoch: 31, Steps: 208 | Train Loss: 0.193 Vali Loss: 12.572 Vali Acc: 0.123 Test Loss: 12.572 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.1264923
	speed: 0.2028s/iter; left time: 2890.5127s
	iters: 200, epoch: 32 | loss: 0.1261007
	speed: 0.0841s/iter; left time: 1190.5984s
Epoch: 32 cost time: 18.19290280342102
Epoch: 32, Steps: 208 | Train Loss: 0.184 Vali Loss: 12.354 Vali Acc: 0.115 Test Loss: 12.354 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0610566
	speed: 0.1855s/iter; left time: 2605.9771s
	iters: 200, epoch: 33 | loss: 0.1072849
	speed: 0.0659s/iter; left time: 919.1919s
Epoch: 33 cost time: 14.491217613220215
Epoch: 33, Steps: 208 | Train Loss: 0.185 Vali Loss: 13.053 Vali Acc: 0.116 Test Loss: 13.053 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0262667
	speed: 0.2021s/iter; left time: 2795.8134s
	iters: 200, epoch: 34 | loss: 0.1630919
	speed: 0.0852s/iter; left time: 1169.8142s
Epoch: 34 cost time: 17.820818185806274
Epoch: 34, Steps: 208 | Train Loss: 0.164 Vali Loss: 13.364 Vali Acc: 0.112 Test Loss: 13.364 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.1692716
	speed: 0.1867s/iter; left time: 2544.0356s
	iters: 200, epoch: 35 | loss: 0.2824732
	speed: 0.0521s/iter; left time: 705.3914s
Epoch: 35 cost time: 12.343348264694214
Epoch: 35, Steps: 208 | Train Loss: 0.186 Vali Loss: 13.429 Vali Acc: 0.115 Test Loss: 13.429 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.1831109
	speed: 0.1944s/iter; left time: 2608.8381s
	iters: 200, epoch: 36 | loss: 0.0579151
	speed: 0.0699s/iter; left time: 931.5047s
Epoch: 36 cost time: 15.983858346939087
Epoch: 36, Steps: 208 | Train Loss: 0.165 Vali Loss: 13.519 Vali Acc: 0.116 Test Loss: 13.519 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0972791
	speed: 0.2258s/iter; left time: 2983.9015s
	iters: 200, epoch: 37 | loss: 0.3527872
	speed: 0.0984s/iter; left time: 1290.2903s
Epoch: 37 cost time: 21.522059202194214
Epoch: 37, Steps: 208 | Train Loss: 0.153 Vali Loss: 13.386 Vali Acc: 0.115 Test Loss: 13.386 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.5154198
	speed: 0.2226s/iter; left time: 2894.8244s
	iters: 200, epoch: 38 | loss: 0.0424688
	speed: 0.0992s/iter; left time: 1279.7117s
Epoch: 38 cost time: 21.242653608322144
Epoch: 38, Steps: 208 | Train Loss: 0.162 Vali Loss: 13.253 Vali Acc: 0.117 Test Loss: 13.253 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13033104682373994
model parameter : 557735
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2574167
	speed: 0.1124s/iter; left time: 2327.4188s
	iters: 200, epoch: 1 | loss: 3.9081390
	speed: 0.1022s/iter; left time: 2104.6726s
Epoch: 1 cost time: 22.27391791343689
Epoch: 1, Steps: 208 | Train Loss: 3.887 Vali Loss: 3.929 Vali Acc: 0.063 Test Loss: 3.929 Test Acc: 0.063
Validation loss decreased (inf --> -0.062889).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5324597
	speed: 0.2018s/iter; left time: 4134.6493s
	iters: 200, epoch: 2 | loss: 4.0210323
	speed: 0.0973s/iter; left time: 1983.5935s
Epoch: 2 cost time: 20.106500387191772
Epoch: 2, Steps: 208 | Train Loss: 3.500 Vali Loss: 3.801 Vali Acc: 0.073 Test Loss: 3.801 Test Acc: 0.073
Validation loss decreased (-0.062889 --> -0.073031).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5226998
	speed: 0.2028s/iter; left time: 4112.9168s
	iters: 200, epoch: 3 | loss: 3.8540316
	speed: 0.0981s/iter; left time: 1979.9903s
Epoch: 3 cost time: 19.98733687400818
Epoch: 3, Steps: 208 | Train Loss: 3.168 Vali Loss: 3.814 Vali Acc: 0.081 Test Loss: 3.814 Test Acc: 0.081
Validation loss decreased (-0.073031 --> -0.081083).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7205055
	speed: 0.2052s/iter; left time: 4120.2450s
	iters: 200, epoch: 4 | loss: 3.1703327
	speed: 0.0917s/iter; left time: 1832.2607s
Epoch: 4 cost time: 19.952443599700928
Epoch: 4, Steps: 208 | Train Loss: 2.964 Vali Loss: 4.355 Vali Acc: 0.076 Test Loss: 4.355 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8324068
	speed: 0.2070s/iter; left time: 4113.6816s
	iters: 200, epoch: 5 | loss: 3.9593050
	speed: 0.0972s/iter; left time: 1920.6956s
Epoch: 5 cost time: 20.34773063659668
Epoch: 5, Steps: 208 | Train Loss: 2.848 Vali Loss: 4.097 Vali Acc: 0.099 Test Loss: 4.097 Test Acc: 0.099
Validation loss decreased (-0.081083 --> -0.099273).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2827952
	speed: 0.2029s/iter; left time: 3990.1297s
	iters: 200, epoch: 6 | loss: 4.2706423
	speed: 0.0747s/iter; left time: 1461.5572s
Epoch: 6 cost time: 17.82042908668518
Epoch: 6, Steps: 208 | Train Loss: 2.638 Vali Loss: 4.498 Vali Acc: 0.109 Test Loss: 4.498 Test Acc: 0.109
Validation loss decreased (-0.099273 --> -0.109409).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6204529
	speed: 0.1820s/iter; left time: 3540.3623s
	iters: 200, epoch: 7 | loss: 3.4607229
	speed: 0.0772s/iter; left time: 1493.1188s
Epoch: 7 cost time: 16.49658203125
Epoch: 7, Steps: 208 | Train Loss: 2.463 Vali Loss: 4.278 Vali Acc: 0.106 Test Loss: 4.278 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5909429
	speed: 0.1886s/iter; left time: 3630.2408s
	iters: 200, epoch: 8 | loss: 2.6402831
	speed: 0.0744s/iter; left time: 1424.4144s
Epoch: 8 cost time: 16.451714754104614
Epoch: 8, Steps: 208 | Train Loss: 2.186 Vali Loss: 4.669 Vali Acc: 0.112 Test Loss: 4.669 Test Acc: 0.112
Validation loss decreased (-0.109409 --> -0.112092).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6590514
	speed: 0.1787s/iter; left time: 3402.5408s
	iters: 200, epoch: 9 | loss: 2.4691510
	speed: 0.0578s/iter; left time: 1094.3583s
Epoch: 9 cost time: 14.166932344436646
Epoch: 9, Steps: 208 | Train Loss: 1.960 Vali Loss: 4.618 Vali Acc: 0.106 Test Loss: 4.618 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7572718
	speed: 0.1646s/iter; left time: 3099.3720s
	iters: 200, epoch: 10 | loss: 1.6074102
	speed: 0.0681s/iter; left time: 1275.1397s
Epoch: 10 cost time: 13.996711015701294
Epoch: 10, Steps: 208 | Train Loss: 1.716 Vali Loss: 5.208 Vali Acc: 0.122 Test Loss: 5.208 Test Acc: 0.122
Validation loss decreased (-0.112092 --> -0.122226).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4461734
	speed: 0.1800s/iter; left time: 3352.1447s
	iters: 200, epoch: 11 | loss: 1.9425558
	speed: 0.0720s/iter; left time: 1332.8209s
Epoch: 11 cost time: 15.016478061676025
Epoch: 11, Steps: 208 | Train Loss: 1.525 Vali Loss: 5.302 Vali Acc: 0.129 Test Loss: 5.302 Test Acc: 0.129
Validation loss decreased (-0.122226 --> -0.129085).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2448778
	speed: 0.1702s/iter; left time: 3133.2664s
	iters: 200, epoch: 12 | loss: 1.4371740
	speed: 0.0595s/iter; left time: 1089.6916s
Epoch: 12 cost time: 13.056843519210815
Epoch: 12, Steps: 208 | Train Loss: 1.336 Vali Loss: 5.711 Vali Acc: 0.122 Test Loss: 5.711 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2908626
	speed: 0.1426s/iter; left time: 2596.7065s
	iters: 200, epoch: 13 | loss: 1.1225123
	speed: 0.0865s/iter; left time: 1566.5383s
Epoch: 13 cost time: 14.509191036224365
Epoch: 13, Steps: 208 | Train Loss: 1.137 Vali Loss: 6.089 Vali Acc: 0.126 Test Loss: 6.089 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.9619889
	speed: 0.1965s/iter; left time: 3536.7575s
	iters: 200, epoch: 14 | loss: 1.1182756
	speed: 0.0885s/iter; left time: 1583.4522s
Epoch: 14 cost time: 18.39631724357605
Epoch: 14, Steps: 208 | Train Loss: 0.994 Vali Loss: 6.420 Vali Acc: 0.120 Test Loss: 6.420 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8936297
	speed: 0.1977s/iter; left time: 3516.3030s
	iters: 200, epoch: 15 | loss: 1.0890611
	speed: 0.0639s/iter; left time: 1130.4145s
Epoch: 15 cost time: 15.931725978851318
Epoch: 15, Steps: 208 | Train Loss: 0.851 Vali Loss: 6.620 Vali Acc: 0.135 Test Loss: 6.620 Test Acc: 0.135
Validation loss decreased (-0.129085 --> -0.134440).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5438868
	speed: 0.1089s/iter; left time: 1914.4935s
	iters: 200, epoch: 16 | loss: 0.7766361
	speed: 0.0279s/iter; left time: 487.0933s
Epoch: 16 cost time: 6.373318195343018
Epoch: 16, Steps: 208 | Train Loss: 0.759 Vali Loss: 7.248 Vali Acc: 0.129 Test Loss: 7.248 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6208423
	speed: 0.1044s/iter; left time: 1813.3958s
	iters: 200, epoch: 17 | loss: 1.3755193
	speed: 0.0953s/iter; left time: 1646.9000s
Epoch: 17 cost time: 14.287476301193237
Epoch: 17, Steps: 208 | Train Loss: 0.681 Vali Loss: 7.560 Vali Acc: 0.123 Test Loss: 7.560 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.6003964
	speed: 0.2029s/iter; left time: 3483.3574s
	iters: 200, epoch: 18 | loss: 0.5183024
	speed: 0.0953s/iter; left time: 1626.2597s
Epoch: 18 cost time: 20.13990545272827
Epoch: 18, Steps: 208 | Train Loss: 0.586 Vali Loss: 8.067 Vali Acc: 0.112 Test Loss: 8.067 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4464020
	speed: 0.2110s/iter; left time: 3578.5164s
	iters: 200, epoch: 19 | loss: 0.5748180
	speed: 0.1056s/iter; left time: 1779.3137s
Epoch: 19 cost time: 21.71034073829651
Epoch: 19, Steps: 208 | Train Loss: 0.534 Vali Loss: 8.138 Vali Acc: 0.120 Test Loss: 8.138 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5763182
	speed: 0.2152s/iter; left time: 3603.7787s
	iters: 200, epoch: 20 | loss: 0.5171321
	speed: 0.1036s/iter; left time: 1725.6028s
Epoch: 20 cost time: 21.845258712768555
Epoch: 20, Steps: 208 | Train Loss: 0.466 Vali Loss: 8.560 Vali Acc: 0.116 Test Loss: 8.560 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5968618
	speed: 0.2117s/iter; left time: 3501.5579s
	iters: 200, epoch: 21 | loss: 0.8183899
	speed: 0.0945s/iter; left time: 1553.3668s
Epoch: 21 cost time: 19.788912534713745
Epoch: 21, Steps: 208 | Train Loss: 0.436 Vali Loss: 8.778 Vali Acc: 0.119 Test Loss: 8.778 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2546999
	speed: 0.2137s/iter; left time: 3490.2303s
	iters: 200, epoch: 22 | loss: 0.4916459
	speed: 0.0880s/iter; left time: 1427.7047s
Epoch: 22 cost time: 19.943817853927612
Epoch: 22, Steps: 208 | Train Loss: 0.366 Vali Loss: 9.596 Vali Acc: 0.108 Test Loss: 9.596 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3870515
	speed: 0.2018s/iter; left time: 3253.9217s
	iters: 200, epoch: 23 | loss: 0.4996356
	speed: 0.0922s/iter; left time: 1476.8515s
Epoch: 23 cost time: 19.692850351333618
Epoch: 23, Steps: 208 | Train Loss: 0.362 Vali Loss: 9.422 Vali Acc: 0.118 Test Loss: 9.422 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.5424064
	speed: 0.2039s/iter; left time: 3245.3066s
	iters: 200, epoch: 24 | loss: 0.3809813
	speed: 0.0917s/iter; left time: 1450.5240s
Epoch: 24 cost time: 19.73835062980652
Epoch: 24, Steps: 208 | Train Loss: 0.355 Vali Loss: 9.775 Vali Acc: 0.119 Test Loss: 9.775 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0534118
	speed: 0.1656s/iter; left time: 2601.7309s
	iters: 200, epoch: 25 | loss: 1.2498900
	speed: 0.0702s/iter; left time: 1095.9033s
Epoch: 25 cost time: 14.318543672561646
Epoch: 25, Steps: 208 | Train Loss: 0.342 Vali Loss: 10.238 Vali Acc: 0.112 Test Loss: 10.238 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13450641216820758
model parameter : 393191
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7563789
	speed: 0.0534s/iter; left time: 1105.8041s
	iters: 200, epoch: 1 | loss: 3.5464313
	speed: 0.0382s/iter; left time: 786.8621s
Epoch: 1 cost time: 9.542261600494385
Epoch: 1, Steps: 208 | Train Loss: 3.834 Vali Loss: 3.824 Vali Acc: 0.064 Test Loss: 3.824 Test Acc: 0.064
Validation loss decreased (inf --> -0.063487).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7188776
	speed: 0.1429s/iter; left time: 2929.4676s
	iters: 200, epoch: 2 | loss: 3.6065521
	speed: 0.0394s/iter; left time: 802.4788s
Epoch: 2 cost time: 8.727733850479126
Epoch: 2, Steps: 208 | Train Loss: 3.460 Vali Loss: 3.807 Vali Acc: 0.067 Test Loss: 3.807 Test Acc: 0.067
Validation loss decreased (-0.063487 --> -0.066470).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5112469
	speed: 0.1477s/iter; left time: 2996.5165s
	iters: 200, epoch: 3 | loss: 3.1215692
	speed: 0.0369s/iter; left time: 744.7823s
Epoch: 3 cost time: 8.315085411071777
Epoch: 3, Steps: 208 | Train Loss: 3.137 Vali Loss: 3.956 Vali Acc: 0.077 Test Loss: 3.956 Test Acc: 0.077
Validation loss decreased (-0.066470 --> -0.076906).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5346370
	speed: 0.1377s/iter; left time: 2765.4079s
	iters: 200, epoch: 4 | loss: 2.7396042
	speed: 0.0391s/iter; left time: 780.6633s
Epoch: 4 cost time: 8.403446435928345
Epoch: 4, Steps: 208 | Train Loss: 2.979 Vali Loss: 3.738 Vali Acc: 0.091 Test Loss: 3.738 Test Acc: 0.091
Validation loss decreased (-0.076906 --> -0.090628).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6438603
	speed: 0.1456s/iter; left time: 2891.9901s
	iters: 200, epoch: 5 | loss: 2.3448167
	speed: 0.0339s/iter; left time: 669.3299s
Epoch: 5 cost time: 8.128315210342407
Epoch: 5, Steps: 208 | Train Loss: 2.810 Vali Loss: 4.005 Vali Acc: 0.098 Test Loss: 4.005 Test Acc: 0.098
Validation loss decreased (-0.090628 --> -0.097783).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8998861
	speed: 0.1469s/iter; left time: 2888.1086s
	iters: 200, epoch: 6 | loss: 2.9190984
	speed: 0.0435s/iter; left time: 850.9832s
Epoch: 6 cost time: 9.583991765975952
Epoch: 6, Steps: 208 | Train Loss: 2.625 Vali Loss: 4.173 Vali Acc: 0.108 Test Loss: 4.173 Test Acc: 0.108
Validation loss decreased (-0.097783 --> -0.107623).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5737150
	speed: 0.1466s/iter; left time: 2852.2823s
	iters: 200, epoch: 7 | loss: 2.5712423
	speed: 0.0429s/iter; left time: 830.3018s
Epoch: 7 cost time: 9.476654767990112
Epoch: 7, Steps: 208 | Train Loss: 2.517 Vali Loss: 4.396 Vali Acc: 0.105 Test Loss: 4.396 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7817526
	speed: 0.1470s/iter; left time: 2828.2496s
	iters: 200, epoch: 8 | loss: 3.1060395
	speed: 0.0436s/iter; left time: 835.2030s
Epoch: 8 cost time: 9.683274269104004
Epoch: 8, Steps: 208 | Train Loss: 2.234 Vali Loss: 4.439 Vali Acc: 0.114 Test Loss: 4.439 Test Acc: 0.114
Validation loss decreased (-0.107623 --> -0.114182).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8524575
	speed: 0.1459s/iter; left time: 2777.2679s
	iters: 200, epoch: 9 | loss: 2.7724018
	speed: 0.0448s/iter; left time: 849.0572s
Epoch: 9 cost time: 9.644985675811768
Epoch: 9, Steps: 208 | Train Loss: 2.034 Vali Loss: 4.397 Vali Acc: 0.114 Test Loss: 4.397 Test Acc: 0.114
Validation loss decreased (-0.114182 --> -0.114182).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7816653
	speed: 0.1530s/iter; left time: 2880.7254s
	iters: 200, epoch: 10 | loss: 1.5617090
	speed: 0.0434s/iter; left time: 813.4436s
Epoch: 10 cost time: 9.69291615486145
Epoch: 10, Steps: 208 | Train Loss: 1.816 Vali Loss: 4.769 Vali Acc: 0.115 Test Loss: 4.769 Test Acc: 0.115
Validation loss decreased (-0.114182 --> -0.114775).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9538472
	speed: 0.1448s/iter; left time: 2696.9174s
	iters: 200, epoch: 11 | loss: 1.9039736
	speed: 0.0431s/iter; left time: 797.4463s
Epoch: 11 cost time: 9.357630252838135
Epoch: 11, Steps: 208 | Train Loss: 1.633 Vali Loss: 4.998 Vali Acc: 0.124 Test Loss: 4.998 Test Acc: 0.124
Validation loss decreased (-0.114775 --> -0.123720).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2426625
	speed: 0.1465s/iter; left time: 2697.9492s
	iters: 200, epoch: 12 | loss: 2.0963655
	speed: 0.0442s/iter; left time: 809.2694s
Epoch: 12 cost time: 9.700553178787231
Epoch: 12, Steps: 208 | Train Loss: 1.454 Vali Loss: 5.447 Vali Acc: 0.116 Test Loss: 5.447 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.8583111
	speed: 0.1478s/iter; left time: 2691.6044s
	iters: 200, epoch: 13 | loss: 1.4645994
	speed: 0.0415s/iter; left time: 752.0337s
Epoch: 13 cost time: 9.214300394058228
Epoch: 13, Steps: 208 | Train Loss: 1.256 Vali Loss: 5.650 Vali Acc: 0.116 Test Loss: 5.650 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7807355
	speed: 0.1508s/iter; left time: 2714.6724s
	iters: 200, epoch: 14 | loss: 1.4014088
	speed: 0.0417s/iter; left time: 745.8088s
Epoch: 14 cost time: 9.314848899841309
Epoch: 14, Steps: 208 | Train Loss: 1.128 Vali Loss: 6.066 Vali Acc: 0.118 Test Loss: 6.066 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4017467
	speed: 0.1516s/iter; left time: 2696.7703s
	iters: 200, epoch: 15 | loss: 1.0273921
	speed: 0.0408s/iter; left time: 721.5647s
Epoch: 15 cost time: 9.01650071144104
Epoch: 15, Steps: 208 | Train Loss: 0.955 Vali Loss: 6.283 Vali Acc: 0.117 Test Loss: 6.283 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.7315950
	speed: 0.1486s/iter; left time: 2612.5614s
	iters: 200, epoch: 16 | loss: 1.4067678
	speed: 0.0419s/iter; left time: 732.7468s
Epoch: 16 cost time: 9.208662748336792
Epoch: 16, Steps: 208 | Train Loss: 0.881 Vali Loss: 6.663 Vali Acc: 0.120 Test Loss: 6.663 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.4770944
	speed: 0.1438s/iter; left time: 2497.9413s
	iters: 200, epoch: 17 | loss: 0.9057372
	speed: 0.0371s/iter; left time: 640.9309s
Epoch: 17 cost time: 8.137537956237793
Epoch: 17, Steps: 208 | Train Loss: 0.737 Vali Loss: 7.662 Vali Acc: 0.119 Test Loss: 7.662 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8872993
	speed: 0.1479s/iter; left time: 2539.0620s
	iters: 200, epoch: 18 | loss: 0.6309230
	speed: 0.0367s/iter; left time: 626.3293s
Epoch: 18 cost time: 8.407260179519653
Epoch: 18, Steps: 208 | Train Loss: 0.665 Vali Loss: 7.721 Vali Acc: 0.114 Test Loss: 7.721 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6272018
	speed: 0.1403s/iter; left time: 2378.7001s
	iters: 200, epoch: 19 | loss: 0.5740606
	speed: 0.0372s/iter; left time: 627.5515s
Epoch: 19 cost time: 8.167323350906372
Epoch: 19, Steps: 208 | Train Loss: 0.597 Vali Loss: 7.881 Vali Acc: 0.119 Test Loss: 7.881 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.8773001
	speed: 0.1384s/iter; left time: 2318.3650s
	iters: 200, epoch: 20 | loss: 1.2633069
	speed: 0.0359s/iter; left time: 598.4936s
Epoch: 20 cost time: 8.164813041687012
Epoch: 20, Steps: 208 | Train Loss: 0.528 Vali Loss: 8.116 Vali Acc: 0.123 Test Loss: 8.116 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.6307742
	speed: 0.1365s/iter; left time: 2257.2657s
	iters: 200, epoch: 21 | loss: 0.8486024
	speed: 0.0372s/iter; left time: 611.2606s
Epoch: 21 cost time: 8.335454940795898
Epoch: 21, Steps: 208 | Train Loss: 0.488 Vali Loss: 8.629 Vali Acc: 0.113 Test Loss: 8.629 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12376975842529078
model parameter : 324711
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6697652
	speed: 0.0560s/iter; left time: 1158.5354s
	iters: 200, epoch: 1 | loss: 3.7563875
	speed: 0.0376s/iter; left time: 774.0901s
Epoch: 1 cost time: 9.73465633392334
Epoch: 1, Steps: 208 | Train Loss: 3.794 Vali Loss: 3.795 Vali Acc: 0.062 Test Loss: 3.795 Test Acc: 0.062
Validation loss decreased (inf --> -0.061698).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3050442
	speed: 0.1464s/iter; left time: 3000.2282s
	iters: 200, epoch: 2 | loss: 3.2709875
	speed: 0.0404s/iter; left time: 824.6214s
Epoch: 2 cost time: 8.713561058044434
Epoch: 2, Steps: 208 | Train Loss: 3.525 Vali Loss: 3.720 Vali Acc: 0.078 Test Loss: 3.720 Test Acc: 0.078
Validation loss decreased (-0.061698 --> -0.078400).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7251315
	speed: 0.1387s/iter; left time: 2813.7511s
	iters: 200, epoch: 3 | loss: 3.7250733
	speed: 0.0411s/iter; left time: 829.4512s
Epoch: 3 cost time: 8.900106191635132
Epoch: 3, Steps: 208 | Train Loss: 3.217 Vali Loss: 3.831 Vali Acc: 0.087 Test Loss: 3.831 Test Acc: 0.087
Validation loss decreased (-0.078400 --> -0.086750).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5565097
	speed: 0.1429s/iter; left time: 2868.4020s
	iters: 200, epoch: 4 | loss: 3.9250193
	speed: 0.0421s/iter; left time: 840.4681s
Epoch: 4 cost time: 9.056823253631592
Epoch: 4, Steps: 208 | Train Loss: 3.036 Vali Loss: 4.129 Vali Acc: 0.084 Test Loss: 4.129 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8138423
	speed: 0.1443s/iter; left time: 2867.5990s
	iters: 200, epoch: 5 | loss: 2.8314152
	speed: 0.0414s/iter; left time: 817.5639s
Epoch: 5 cost time: 9.045057535171509
Epoch: 5, Steps: 208 | Train Loss: 2.840 Vali Loss: 4.207 Vali Acc: 0.094 Test Loss: 4.207 Test Acc: 0.094
Validation loss decreased (-0.086750 --> -0.094202).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6568878
	speed: 0.1429s/iter; left time: 2810.0005s
	iters: 200, epoch: 6 | loss: 3.9926188
	speed: 0.0407s/iter; left time: 795.3681s
Epoch: 6 cost time: 8.878787755966187
Epoch: 6, Steps: 208 | Train Loss: 2.707 Vali Loss: 4.097 Vali Acc: 0.104 Test Loss: 4.097 Test Acc: 0.104
Validation loss decreased (-0.094202 --> -0.104045).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6938212
	speed: 0.1369s/iter; left time: 2662.4648s
	iters: 200, epoch: 7 | loss: 3.6046462
	speed: 0.0409s/iter; left time: 791.7881s
Epoch: 7 cost time: 8.851794004440308
Epoch: 7, Steps: 208 | Train Loss: 2.547 Vali Loss: 4.225 Vali Acc: 0.098 Test Loss: 4.225 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.2192521
	speed: 0.1402s/iter; left time: 2698.6677s
	iters: 200, epoch: 8 | loss: 2.9963768
	speed: 0.0420s/iter; left time: 804.0786s
Epoch: 8 cost time: 9.089894771575928
Epoch: 8, Steps: 208 | Train Loss: 2.374 Vali Loss: 4.360 Vali Acc: 0.097 Test Loss: 4.360 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7613550
	speed: 0.1454s/iter; left time: 2768.6071s
	iters: 200, epoch: 9 | loss: 2.7413137
	speed: 0.0418s/iter; left time: 791.1835s
Epoch: 9 cost time: 9.252192735671997
Epoch: 9, Steps: 208 | Train Loss: 2.143 Vali Loss: 4.376 Vali Acc: 0.110 Test Loss: 4.376 Test Acc: 0.110
Validation loss decreased (-0.104045 --> -0.109709).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2492847
	speed: 0.1454s/iter; left time: 2737.7587s
	iters: 200, epoch: 10 | loss: 2.1059091
	speed: 0.0402s/iter; left time: 752.9536s
Epoch: 10 cost time: 8.908799171447754
Epoch: 10, Steps: 208 | Train Loss: 1.986 Vali Loss: 4.551 Vali Acc: 0.099 Test Loss: 4.551 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6992716
	speed: 0.1431s/iter; left time: 2664.0617s
	iters: 200, epoch: 11 | loss: 1.4006628
	speed: 0.0412s/iter; left time: 762.5721s
Epoch: 11 cost time: 8.868001937866211
Epoch: 11, Steps: 208 | Train Loss: 1.815 Vali Loss: 4.831 Vali Acc: 0.105 Test Loss: 4.831 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7360902
	speed: 0.1475s/iter; left time: 2715.8779s
	iters: 200, epoch: 12 | loss: 1.8219124
	speed: 0.0408s/iter; left time: 747.9622s
Epoch: 12 cost time: 8.842716932296753
Epoch: 12, Steps: 208 | Train Loss: 1.637 Vali Loss: 5.154 Vali Acc: 0.110 Test Loss: 5.154 Test Acc: 0.110
Validation loss decreased (-0.109709 --> -0.109999).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6182725
	speed: 0.1498s/iter; left time: 2727.8431s
	iters: 200, epoch: 13 | loss: 2.0799067
	speed: 0.0388s/iter; left time: 703.2950s
Epoch: 13 cost time: 8.816473960876465
Epoch: 13, Steps: 208 | Train Loss: 1.437 Vali Loss: 5.397 Vali Acc: 0.121 Test Loss: 5.397 Test Acc: 0.121
Validation loss decreased (-0.109999 --> -0.121330).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3652788
	speed: 0.1420s/iter; left time: 2555.3013s
	iters: 200, epoch: 14 | loss: 1.1707476
	speed: 0.0358s/iter; left time: 640.9531s
Epoch: 14 cost time: 7.827908754348755
Epoch: 14, Steps: 208 | Train Loss: 1.283 Vali Loss: 5.453 Vali Acc: 0.110 Test Loss: 5.453 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8105217
	speed: 0.1381s/iter; left time: 2456.8698s
	iters: 200, epoch: 15 | loss: 1.5659925
	speed: 0.0355s/iter; left time: 627.4459s
Epoch: 15 cost time: 7.659877061843872
Epoch: 15, Steps: 208 | Train Loss: 1.146 Vali Loss: 5.910 Vali Acc: 0.118 Test Loss: 5.910 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.8937689
	speed: 0.1436s/iter; left time: 2523.8666s
	iters: 200, epoch: 16 | loss: 1.7152050
	speed: 0.0349s/iter; left time: 609.7671s
Epoch: 16 cost time: 7.7925732135772705
Epoch: 16, Steps: 208 | Train Loss: 1.035 Vali Loss: 6.261 Vali Acc: 0.119 Test Loss: 6.261 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8406839
	speed: 0.1392s/iter; left time: 2418.6573s
	iters: 200, epoch: 17 | loss: 1.7787956
	speed: 0.0354s/iter; left time: 611.6377s
Epoch: 17 cost time: 7.731242895126343
Epoch: 17, Steps: 208 | Train Loss: 0.954 Vali Loss: 6.569 Vali Acc: 0.116 Test Loss: 6.569 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7111445
	speed: 0.1325s/iter; left time: 2274.0629s
	iters: 200, epoch: 18 | loss: 0.5754641
	speed: 0.0350s/iter; left time: 596.6442s
Epoch: 18 cost time: 7.672348260879517
Epoch: 18, Steps: 208 | Train Loss: 0.780 Vali Loss: 7.002 Vali Acc: 0.112 Test Loss: 7.002 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7946088
	speed: 0.1400s/iter; left time: 2374.1413s
	iters: 200, epoch: 19 | loss: 0.7122771
	speed: 0.0377s/iter; left time: 635.5541s
Epoch: 19 cost time: 8.140977144241333
Epoch: 19, Steps: 208 | Train Loss: 0.741 Vali Loss: 7.468 Vali Acc: 0.109 Test Loss: 7.468 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6387497
	speed: 0.1404s/iter; left time: 2350.8507s
	iters: 200, epoch: 20 | loss: 0.1595567
	speed: 0.0368s/iter; left time: 611.8752s
Epoch: 20 cost time: 8.595306634902954
Epoch: 20, Steps: 208 | Train Loss: 0.666 Vali Loss: 7.322 Vali Acc: 0.118 Test Loss: 7.322 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.3145689
	speed: 0.1537s/iter; left time: 2543.1095s
	iters: 200, epoch: 21 | loss: 0.3477752
	speed: 0.0431s/iter; left time: 708.6105s
Epoch: 21 cost time: 9.577797174453735
Epoch: 21, Steps: 208 | Train Loss: 0.599 Vali Loss: 7.704 Vali Acc: 0.115 Test Loss: 7.704 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3122317
	speed: 0.1470s/iter; left time: 2400.9724s
	iters: 200, epoch: 22 | loss: 0.3747889
	speed: 0.0457s/iter; left time: 741.2525s
Epoch: 22 cost time: 9.566264152526855
Epoch: 22, Steps: 208 | Train Loss: 0.549 Vali Loss: 8.280 Vali Acc: 0.112 Test Loss: 8.280 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3504096
	speed: 0.1582s/iter; left time: 2551.4216s
	iters: 200, epoch: 23 | loss: 0.4625465
	speed: 0.0445s/iter; left time: 712.3685s
Epoch: 23 cost time: 10.08283257484436
Epoch: 23, Steps: 208 | Train Loss: 0.502 Vali Loss: 8.652 Vali Acc: 0.107 Test Loss: 8.652 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12138383537130927
model parameter : 228967
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7869084
	speed: 0.0613s/iter; left time: 1268.5951s
	iters: 200, epoch: 1 | loss: 3.7740092
	speed: 0.0464s/iter; left time: 954.9026s
Epoch: 1 cost time: 11.230310201644897
Epoch: 1, Steps: 208 | Train Loss: 3.772 Vali Loss: 3.756 Vali Acc: 0.056 Test Loss: 3.756 Test Acc: 0.056
Validation loss decreased (inf --> -0.056032).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4202116
	speed: 0.1570s/iter; left time: 3217.0248s
	iters: 200, epoch: 2 | loss: 3.9458218
	speed: 0.0451s/iter; left time: 920.3316s
Epoch: 2 cost time: 9.98123836517334
Epoch: 2, Steps: 208 | Train Loss: 3.498 Vali Loss: 3.713 Vali Acc: 0.079 Test Loss: 3.713 Test Acc: 0.079
Validation loss decreased (-0.056032 --> -0.079295).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3329265
	speed: 0.1537s/iter; left time: 3117.3628s
	iters: 200, epoch: 3 | loss: 3.1639750
	speed: 0.0462s/iter; left time: 933.2810s
Epoch: 3 cost time: 9.83835768699646
Epoch: 3, Steps: 208 | Train Loss: 3.232 Vali Loss: 3.797 Vali Acc: 0.083 Test Loss: 3.797 Test Acc: 0.083
Validation loss decreased (-0.079295 --> -0.082575).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6060309
	speed: 0.1525s/iter; left time: 3062.5071s
	iters: 200, epoch: 4 | loss: 3.3933113
	speed: 0.0399s/iter; left time: 796.8158s
Epoch: 4 cost time: 8.945251703262329
Epoch: 4, Steps: 208 | Train Loss: 3.092 Vali Loss: 3.871 Vali Acc: 0.087 Test Loss: 3.871 Test Acc: 0.087
Validation loss decreased (-0.082575 --> -0.087047).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0791206
	speed: 0.1449s/iter; left time: 2878.3199s
	iters: 200, epoch: 5 | loss: 3.3188548
	speed: 0.0419s/iter; left time: 828.4717s
Epoch: 5 cost time: 9.295863151550293
Epoch: 5, Steps: 208 | Train Loss: 2.948 Vali Loss: 3.990 Vali Acc: 0.093 Test Loss: 3.990 Test Acc: 0.093
Validation loss decreased (-0.087047 --> -0.093011).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2592819
	speed: 0.1436s/iter; left time: 2822.4455s
	iters: 200, epoch: 6 | loss: 3.2913706
	speed: 0.0436s/iter; left time: 852.0714s
Epoch: 6 cost time: 9.30729079246521
Epoch: 6, Steps: 208 | Train Loss: 2.794 Vali Loss: 4.073 Vali Acc: 0.098 Test Loss: 4.073 Test Acc: 0.098
Validation loss decreased (-0.093011 --> -0.097782).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6386249
	speed: 0.1478s/iter; left time: 2874.3719s
	iters: 200, epoch: 7 | loss: 2.4929905
	speed: 0.0413s/iter; left time: 799.4531s
Epoch: 7 cost time: 9.141510248184204
Epoch: 7, Steps: 208 | Train Loss: 2.619 Vali Loss: 4.122 Vali Acc: 0.102 Test Loss: 4.122 Test Acc: 0.102
Validation loss decreased (-0.097782 --> -0.102255).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9449546
	speed: 0.1467s/iter; left time: 2823.9768s
	iters: 200, epoch: 8 | loss: 2.7376435
	speed: 0.0362s/iter; left time: 693.2865s
Epoch: 8 cost time: 8.663747787475586
Epoch: 8, Steps: 208 | Train Loss: 2.485 Vali Loss: 4.155 Vali Acc: 0.099 Test Loss: 4.155 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2831130
	speed: 0.1447s/iter; left time: 2755.3037s
	iters: 200, epoch: 9 | loss: 2.8912656
	speed: 0.0371s/iter; left time: 702.3373s
Epoch: 9 cost time: 8.102415084838867
Epoch: 9, Steps: 208 | Train Loss: 2.291 Vali Loss: 4.417 Vali Acc: 0.109 Test Loss: 4.417 Test Acc: 0.109
Validation loss decreased (-0.102255 --> -0.109112).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7395974
	speed: 0.1397s/iter; left time: 2631.1628s
	iters: 200, epoch: 10 | loss: 1.8749268
	speed: 0.0349s/iter; left time: 653.3690s
Epoch: 10 cost time: 7.97768235206604
Epoch: 10, Steps: 208 | Train Loss: 2.110 Vali Loss: 4.406 Vali Acc: 0.110 Test Loss: 4.406 Test Acc: 0.110
Validation loss decreased (-0.109112 --> -0.109708).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4771445
	speed: 0.1499s/iter; left time: 2790.7007s
	iters: 200, epoch: 11 | loss: 2.1957312
	speed: 0.0348s/iter; left time: 644.1642s
Epoch: 11 cost time: 8.11482572555542
Epoch: 11, Steps: 208 | Train Loss: 1.927 Vali Loss: 4.649 Vali Acc: 0.106 Test Loss: 4.649 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2606091
	speed: 0.1336s/iter; left time: 2460.6130s
	iters: 200, epoch: 12 | loss: 1.6103539
	speed: 0.0374s/iter; left time: 684.9261s
Epoch: 12 cost time: 8.301110744476318
Epoch: 12, Steps: 208 | Train Loss: 1.760 Vali Loss: 4.628 Vali Acc: 0.110 Test Loss: 4.628 Test Acc: 0.110
Validation loss decreased (-0.109708 --> -0.110303).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7272537
	speed: 0.1466s/iter; left time: 2668.0967s
	iters: 200, epoch: 13 | loss: 1.4265678
	speed: 0.0364s/iter; left time: 659.4864s
Epoch: 13 cost time: 8.152366876602173
Epoch: 13, Steps: 208 | Train Loss: 1.542 Vali Loss: 5.084 Vali Acc: 0.118 Test Loss: 5.084 Test Acc: 0.118
Validation loss decreased (-0.110303 --> -0.118351).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6191686
	speed: 0.1484s/iter; left time: 2670.6801s
	iters: 200, epoch: 14 | loss: 1.7450247
	speed: 0.0380s/iter; left time: 679.4538s
Epoch: 14 cost time: 8.411775827407837
Epoch: 14, Steps: 208 | Train Loss: 1.433 Vali Loss: 5.311 Vali Acc: 0.120 Test Loss: 5.311 Test Acc: 0.120
Validation loss decreased (-0.118351 --> -0.119541).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3861878
	speed: 0.1503s/iter; left time: 2673.7070s
	iters: 200, epoch: 15 | loss: 1.3710454
	speed: 0.0368s/iter; left time: 650.6358s
Epoch: 15 cost time: 8.203428506851196
Epoch: 15, Steps: 208 | Train Loss: 1.268 Vali Loss: 5.638 Vali Acc: 0.113 Test Loss: 5.638 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.9681030
	speed: 0.1563s/iter; left time: 2747.9096s
	iters: 200, epoch: 16 | loss: 0.8228824
	speed: 0.0416s/iter; left time: 726.8441s
Epoch: 16 cost time: 9.374180793762207
Epoch: 16, Steps: 208 | Train Loss: 1.144 Vali Loss: 5.948 Vali Acc: 0.105 Test Loss: 5.948 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5769649
	speed: 0.1481s/iter; left time: 2572.1296s
	iters: 200, epoch: 17 | loss: 1.4159558
	speed: 0.0438s/iter; left time: 756.1921s
Epoch: 17 cost time: 9.503477334976196
Epoch: 17, Steps: 208 | Train Loss: 1.043 Vali Loss: 6.222 Vali Acc: 0.107 Test Loss: 6.222 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.1296816
	speed: 0.1461s/iter; left time: 2507.9563s
	iters: 200, epoch: 18 | loss: 2.1796043
	speed: 0.0430s/iter; left time: 733.8716s
Epoch: 18 cost time: 9.436434030532837
Epoch: 18, Steps: 208 | Train Loss: 0.901 Vali Loss: 6.587 Vali Acc: 0.111 Test Loss: 6.587 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5518326
	speed: 0.1487s/iter; left time: 2522.2174s
	iters: 200, epoch: 19 | loss: 0.8822811
	speed: 0.0439s/iter; left time: 740.3384s
Epoch: 19 cost time: 9.619115114212036
Epoch: 19, Steps: 208 | Train Loss: 0.823 Vali Loss: 6.908 Vali Acc: 0.114 Test Loss: 6.908 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5833068
	speed: 0.1504s/iter; left time: 2519.0172s
	iters: 200, epoch: 20 | loss: 0.8512429
	speed: 0.0433s/iter; left time: 720.4585s
Epoch: 20 cost time: 9.513928413391113
Epoch: 20, Steps: 208 | Train Loss: 0.757 Vali Loss: 7.328 Vali Acc: 0.109 Test Loss: 7.328 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.0474728
	speed: 0.1487s/iter; left time: 2459.0333s
	iters: 200, epoch: 21 | loss: 1.2168505
	speed: 0.0423s/iter; left time: 695.1692s
Epoch: 21 cost time: 9.433260917663574
Epoch: 21, Steps: 208 | Train Loss: 0.667 Vali Loss: 7.608 Vali Acc: 0.110 Test Loss: 7.608 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.4662438
	speed: 0.1519s/iter; left time: 2480.4943s
	iters: 200, epoch: 22 | loss: 0.3994310
	speed: 0.0447s/iter; left time: 725.1704s
Epoch: 22 cost time: 9.674780130386353
Epoch: 22, Steps: 208 | Train Loss: 0.601 Vali Loss: 7.983 Vali Acc: 0.110 Test Loss: 7.983 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.7526398
	speed: 0.1576s/iter; left time: 2541.8946s
	iters: 200, epoch: 23 | loss: 0.9486889
	speed: 0.0405s/iter; left time: 648.4650s
Epoch: 23 cost time: 9.455114364624023
Epoch: 23, Steps: 208 | Train Loss: 0.548 Vali Loss: 8.440 Vali Acc: 0.111 Test Loss: 8.440 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2175373
	speed: 0.1508s/iter; left time: 2401.0692s
	iters: 200, epoch: 24 | loss: 0.7609255
	speed: 0.0424s/iter; left time: 671.1218s
Epoch: 24 cost time: 9.382702350616455
Epoch: 24, Steps: 208 | Train Loss: 0.549 Vali Loss: 8.632 Vali Acc: 0.112 Test Loss: 8.632 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11959439308082315
model parameter : 188135
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7859683
	speed: 0.0598s/iter; left time: 1238.1317s
	iters: 200, epoch: 1 | loss: 3.7147408
	speed: 0.0409s/iter; left time: 841.7248s
Epoch: 1 cost time: 10.468015193939209
Epoch: 1, Steps: 208 | Train Loss: 3.765 Vali Loss: 3.727 Vali Acc: 0.060 Test Loss: 3.727 Test Acc: 0.060
Validation loss decreased (inf --> -0.060207).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6266346
	speed: 0.1359s/iter; left time: 2784.1785s
	iters: 200, epoch: 2 | loss: 3.2384562
	speed: 0.0337s/iter; left time: 688.1962s
Epoch: 2 cost time: 7.711065053939819
Epoch: 2, Steps: 208 | Train Loss: 3.562 Vali Loss: 3.704 Vali Acc: 0.065 Test Loss: 3.704 Test Acc: 0.065
Validation loss decreased (-0.060207 --> -0.064681).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3907743
	speed: 0.1400s/iter; left time: 2839.1976s
	iters: 200, epoch: 3 | loss: 2.9029417
	speed: 0.0370s/iter; left time: 747.2224s
Epoch: 3 cost time: 8.134636640548706
Epoch: 3, Steps: 208 | Train Loss: 3.349 Vali Loss: 3.764 Vali Acc: 0.073 Test Loss: 3.764 Test Acc: 0.073
Validation loss decreased (-0.064681 --> -0.072733).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2054234
	speed: 0.1410s/iter; left time: 2831.7263s
	iters: 200, epoch: 4 | loss: 3.2807281
	speed: 0.0348s/iter; left time: 694.7005s
Epoch: 4 cost time: 7.923833847045898
Epoch: 4, Steps: 208 | Train Loss: 3.167 Vali Loss: 3.775 Vali Acc: 0.084 Test Loss: 3.775 Test Acc: 0.084
Validation loss decreased (-0.072733 --> -0.084364).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0632849
	speed: 0.1372s/iter; left time: 2726.0124s
	iters: 200, epoch: 5 | loss: 2.7679441
	speed: 0.0343s/iter; left time: 678.6926s
Epoch: 5 cost time: 7.396888017654419
Epoch: 5, Steps: 208 | Train Loss: 2.996 Vali Loss: 3.839 Vali Acc: 0.084 Test Loss: 3.839 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4824097
	speed: 0.1440s/iter; left time: 2830.5857s
	iters: 200, epoch: 6 | loss: 3.0306981
	speed: 0.0343s/iter; left time: 670.1291s
Epoch: 6 cost time: 7.92228627204895
Epoch: 6, Steps: 208 | Train Loss: 2.812 Vali Loss: 3.906 Vali Acc: 0.101 Test Loss: 3.906 Test Acc: 0.101
Validation loss decreased (-0.084364 --> -0.101064).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5489137
	speed: 0.1348s/iter; left time: 2621.6605s
	iters: 200, epoch: 7 | loss: 3.2154927
	speed: 0.0329s/iter; left time: 636.1325s
Epoch: 7 cost time: 7.4212915897369385
Epoch: 7, Steps: 208 | Train Loss: 2.675 Vali Loss: 3.994 Vali Acc: 0.089 Test Loss: 3.994 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9831042
	speed: 0.1368s/iter; left time: 2633.1365s
	iters: 200, epoch: 8 | loss: 2.6573329
	speed: 0.0358s/iter; left time: 684.9271s
Epoch: 8 cost time: 7.794703960418701
Epoch: 8, Steps: 208 | Train Loss: 2.524 Vali Loss: 4.092 Vali Acc: 0.101 Test Loss: 4.092 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5807676
	speed: 0.1485s/iter; left time: 2827.4861s
	iters: 200, epoch: 9 | loss: 2.1135168
	speed: 0.0393s/iter; left time: 743.4509s
Epoch: 9 cost time: 8.993593692779541
Epoch: 9, Steps: 208 | Train Loss: 2.357 Vali Loss: 4.180 Vali Acc: 0.102 Test Loss: 4.180 Test Acc: 0.102
Validation loss decreased (-0.101064 --> -0.101658).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0642076
	speed: 0.1452s/iter; left time: 2733.3476s
	iters: 200, epoch: 10 | loss: 2.2396498
	speed: 0.0402s/iter; left time: 753.8363s
Epoch: 10 cost time: 9.035581588745117
Epoch: 10, Steps: 208 | Train Loss: 2.199 Vali Loss: 4.230 Vali Acc: 0.108 Test Loss: 4.230 Test Acc: 0.108
Validation loss decreased (-0.101658 --> -0.107622).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8562393
	speed: 0.1485s/iter; left time: 2764.9575s
	iters: 200, epoch: 11 | loss: 1.3056729
	speed: 0.0411s/iter; left time: 761.3292s
Epoch: 11 cost time: 8.981589794158936
Epoch: 11, Steps: 208 | Train Loss: 2.025 Vali Loss: 4.544 Vali Acc: 0.106 Test Loss: 4.544 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9847379
	speed: 0.1486s/iter; left time: 2736.1238s
	iters: 200, epoch: 12 | loss: 1.6702948
	speed: 0.0416s/iter; left time: 761.3749s
Epoch: 12 cost time: 9.258730173110962
Epoch: 12, Steps: 208 | Train Loss: 1.834 Vali Loss: 4.749 Vali Acc: 0.103 Test Loss: 4.749 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.2532942
	speed: 0.1506s/iter; left time: 2742.3433s
	iters: 200, epoch: 13 | loss: 1.2069780
	speed: 0.0419s/iter; left time: 758.4736s
Epoch: 13 cost time: 9.16578483581543
Epoch: 13, Steps: 208 | Train Loss: 1.677 Vali Loss: 5.008 Vali Acc: 0.106 Test Loss: 5.008 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1816658
	speed: 0.1483s/iter; left time: 2668.9754s
	iters: 200, epoch: 14 | loss: 1.7375160
	speed: 0.0385s/iter; left time: 688.7242s
Epoch: 14 cost time: 8.476579427719116
Epoch: 14, Steps: 208 | Train Loss: 1.481 Vali Loss: 5.295 Vali Acc: 0.103 Test Loss: 5.295 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5041769
	speed: 0.1419s/iter; left time: 2523.5650s
	iters: 200, epoch: 15 | loss: 1.3041832
	speed: 0.0415s/iter; left time: 733.2993s
Epoch: 15 cost time: 9.16242265701294
Epoch: 15, Steps: 208 | Train Loss: 1.325 Vali Loss: 5.592 Vali Acc: 0.103 Test Loss: 5.592 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0313245
	speed: 0.1464s/iter; left time: 2573.0881s
	iters: 200, epoch: 16 | loss: 1.2545936
	speed: 0.0421s/iter; left time: 735.2122s
Epoch: 16 cost time: 9.346571445465088
Epoch: 16, Steps: 208 | Train Loss: 1.209 Vali Loss: 5.838 Vali Acc: 0.104 Test Loss: 5.838 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.9355316
	speed: 0.1480s/iter; left time: 2571.0694s
	iters: 200, epoch: 17 | loss: 1.1111882
	speed: 0.0410s/iter; left time: 707.7160s
Epoch: 17 cost time: 9.153492212295532
Epoch: 17, Steps: 208 | Train Loss: 1.102 Vali Loss: 6.237 Vali Acc: 0.101 Test Loss: 6.237 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3998150
	speed: 0.1436s/iter; left time: 2465.0277s
	iters: 200, epoch: 18 | loss: 1.4645671
	speed: 0.0402s/iter; left time: 685.2291s
Epoch: 18 cost time: 8.95145583152771
Epoch: 18, Steps: 208 | Train Loss: 0.971 Vali Loss: 6.676 Vali Acc: 0.110 Test Loss: 6.676 Test Acc: 0.110
Validation loss decreased (-0.107622 --> -0.110282).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3774016
	speed: 0.1463s/iter; left time: 2480.6381s
	iters: 200, epoch: 19 | loss: 1.0453389
	speed: 0.0418s/iter; left time: 704.3147s
Epoch: 19 cost time: 9.139256000518799
Epoch: 19, Steps: 208 | Train Loss: 0.834 Vali Loss: 7.090 Vali Acc: 0.102 Test Loss: 7.090 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4181664
	speed: 0.1428s/iter; left time: 2391.5994s
	iters: 200, epoch: 20 | loss: 0.8070439
	speed: 0.0356s/iter; left time: 593.5217s
Epoch: 20 cost time: 7.7111732959747314
Epoch: 20, Steps: 208 | Train Loss: 0.799 Vali Loss: 7.428 Vali Acc: 0.103 Test Loss: 7.428 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.5431609
	speed: 0.1487s/iter; left time: 2460.3403s
	iters: 200, epoch: 21 | loss: 0.9704108
	speed: 0.0345s/iter; left time: 567.2931s
Epoch: 21 cost time: 7.9910314083099365
Epoch: 21, Steps: 208 | Train Loss: 0.732 Vali Loss: 7.768 Vali Acc: 0.107 Test Loss: 7.768 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.9670628
	speed: 0.1407s/iter; left time: 2297.3656s
	iters: 200, epoch: 22 | loss: 1.0554951
	speed: 0.0327s/iter; left time: 530.0554s
Epoch: 22 cost time: 7.412480115890503
Epoch: 22, Steps: 208 | Train Loss: 0.633 Vali Loss: 8.159 Vali Acc: 0.102 Test Loss: 8.159 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.0517905
	speed: 0.1360s/iter; left time: 2193.3633s
	iters: 200, epoch: 23 | loss: 0.7506053
	speed: 0.0340s/iter; left time: 544.3376s
Epoch: 23 cost time: 7.5094640254974365
Epoch: 23, Steps: 208 | Train Loss: 0.580 Vali Loss: 8.433 Vali Acc: 0.101 Test Loss: 8.433 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.5834460
	speed: 0.1399s/iter; left time: 2227.0533s
	iters: 200, epoch: 24 | loss: 0.4653723
	speed: 0.0342s/iter; left time: 541.4913s
Epoch: 24 cost time: 7.6643736362457275
Epoch: 24, Steps: 208 | Train Loss: 0.550 Vali Loss: 8.674 Vali Acc: 0.103 Test Loss: 8.674 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.3172261
	speed: 0.1416s/iter; left time: 2224.5045s
	iters: 200, epoch: 25 | loss: 0.3784095
	speed: 0.0339s/iter; left time: 528.5603s
Epoch: 25 cost time: 7.7268335819244385
Epoch: 25, Steps: 208 | Train Loss: 0.490 Vali Loss: 9.089 Vali Acc: 0.103 Test Loss: 9.089 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1374857
	speed: 0.1395s/iter; left time: 2162.6206s
	iters: 200, epoch: 26 | loss: 0.4666379
	speed: 0.0351s/iter; left time: 540.7017s
Epoch: 26 cost time: 7.85888934135437
Epoch: 26, Steps: 208 | Train Loss: 0.471 Vali Loss: 9.288 Vali Acc: 0.096 Test Loss: 9.288 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.2222697
	speed: 0.1315s/iter; left time: 2010.4885s
	iters: 200, epoch: 27 | loss: 1.1052958
	speed: 0.0421s/iter; left time: 639.8033s
Epoch: 27 cost time: 8.140157699584961
Epoch: 27, Steps: 208 | Train Loss: 0.468 Vali Loss: 9.681 Vali Acc: 0.099 Test Loss: 9.681 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.3349579
	speed: 0.1470s/iter; left time: 2216.8918s
	iters: 200, epoch: 28 | loss: 0.4897376
	speed: 0.0422s/iter; left time: 632.8577s
Epoch: 28 cost time: 9.29312539100647
Epoch: 28, Steps: 208 | Train Loss: 0.395 Vali Loss: 10.184 Vali Acc: 0.099 Test Loss: 10.184 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1103489412466448
model parameter : 161031
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1277571
	speed: 0.0737s/iter; left time: 1524.6519s
	iters: 200, epoch: 1 | loss: 3.7041450
	speed: 0.0561s/iter; left time: 1155.6635s
Epoch: 1 cost time: 13.570303440093994
Epoch: 1, Steps: 208 | Train Loss: 4.248 Vali Loss: 3.965 Vali Acc: 0.036 Test Loss: 3.965 Test Acc: 0.036
Validation loss decreased (inf --> -0.035749).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0702391
	speed: 0.2015s/iter; left time: 4129.2669s
	iters: 200, epoch: 2 | loss: 4.0060391
	speed: 0.0604s/iter; left time: 1232.4831s
Epoch: 2 cost time: 13.066870212554932
Epoch: 2, Steps: 208 | Train Loss: 3.369 Vali Loss: 3.555 Vali Acc: 0.078 Test Loss: 3.555 Test Acc: 0.078
Validation loss decreased (-0.035749 --> -0.078402).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6830688
	speed: 0.2014s/iter; left time: 4084.5049s
	iters: 200, epoch: 3 | loss: 3.6507430
	speed: 0.0628s/iter; left time: 1266.6958s
Epoch: 3 cost time: 13.21864628791809
Epoch: 3, Steps: 208 | Train Loss: 3.419 Vali Loss: 4.190 Vali Acc: 0.063 Test Loss: 4.190 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.4147112
	speed: 0.2027s/iter; left time: 4069.1873s
	iters: 200, epoch: 4 | loss: 3.4325187
	speed: 0.0570s/iter; left time: 1139.5361s
Epoch: 4 cost time: 12.697663307189941
Epoch: 4, Steps: 208 | Train Loss: 3.431 Vali Loss: 4.450 Vali Acc: 0.085 Test Loss: 4.450 Test Acc: 0.085
Validation loss decreased (-0.078402 --> -0.085252).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4108579
	speed: 0.1905s/iter; left time: 3785.6676s
	iters: 200, epoch: 5 | loss: 3.0476909
	speed: 0.0604s/iter; left time: 1193.3660s
Epoch: 5 cost time: 12.485066175460815
Epoch: 5, Steps: 208 | Train Loss: 3.300 Vali Loss: 5.358 Vali Acc: 0.101 Test Loss: 5.358 Test Acc: 0.101
Validation loss decreased (-0.085252 --> -0.101050).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1400394
	speed: 0.1936s/iter; left time: 3806.3585s
	iters: 200, epoch: 6 | loss: 3.3937070
	speed: 0.0577s/iter; left time: 1128.4617s
Epoch: 6 cost time: 12.503730773925781
Epoch: 6, Steps: 208 | Train Loss: 3.008 Vali Loss: 4.300 Vali Acc: 0.113 Test Loss: 4.300 Test Acc: 0.113
Validation loss decreased (-0.101050 --> -0.112990).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.8459280
	speed: 0.1927s/iter; left time: 3749.2036s
	iters: 200, epoch: 7 | loss: 2.9074590
	speed: 0.0583s/iter; left time: 1127.3213s
Epoch: 7 cost time: 12.588380813598633
Epoch: 7, Steps: 208 | Train Loss: 2.548 Vali Loss: 6.062 Vali Acc: 0.100 Test Loss: 6.062 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8267255
	speed: 0.1927s/iter; left time: 3709.1663s
	iters: 200, epoch: 8 | loss: 2.0531027
	speed: 0.0555s/iter; left time: 1061.8630s
Epoch: 8 cost time: 12.044348001480103
Epoch: 8, Steps: 208 | Train Loss: 1.971 Vali Loss: 5.366 Vali Acc: 0.090 Test Loss: 5.366 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.1579669
	speed: 0.1720s/iter; left time: 3273.6898s
	iters: 200, epoch: 9 | loss: 2.2078128
	speed: 0.0504s/iter; left time: 955.3311s
Epoch: 9 cost time: 10.831782102584839
Epoch: 9, Steps: 208 | Train Loss: 1.615 Vali Loss: 5.910 Vali Acc: 0.115 Test Loss: 5.910 Test Acc: 0.115
Validation loss decreased (-0.112990 --> -0.114465).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2581611
	speed: 0.1742s/iter; left time: 3279.2060s
	iters: 200, epoch: 10 | loss: 1.8414159
	speed: 0.0477s/iter; left time: 893.7079s
Epoch: 10 cost time: 10.439829349517822
Epoch: 10, Steps: 208 | Train Loss: 1.333 Vali Loss: 6.517 Vali Acc: 0.105 Test Loss: 6.517 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0461602
	speed: 0.1743s/iter; left time: 3244.9858s
	iters: 200, epoch: 11 | loss: 1.4370595
	speed: 0.0496s/iter; left time: 919.3672s
Epoch: 11 cost time: 10.708844423294067
Epoch: 11, Steps: 208 | Train Loss: 1.134 Vali Loss: 6.240 Vali Acc: 0.116 Test Loss: 6.240 Test Acc: 0.116
Validation loss decreased (-0.114465 --> -0.115655).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5866361
	speed: 0.1746s/iter; left time: 3215.5908s
	iters: 200, epoch: 12 | loss: 0.8297334
	speed: 0.0489s/iter; left time: 895.7575s
Epoch: 12 cost time: 10.582679271697998
Epoch: 12, Steps: 208 | Train Loss: 0.939 Vali Loss: 7.314 Vali Acc: 0.109 Test Loss: 7.314 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9933718
	speed: 0.1735s/iter; left time: 3157.8608s
	iters: 200, epoch: 13 | loss: 1.4210702
	speed: 0.0495s/iter; left time: 895.5669s
Epoch: 13 cost time: 10.52401351928711
Epoch: 13, Steps: 208 | Train Loss: 0.798 Vali Loss: 8.179 Vali Acc: 0.112 Test Loss: 8.179 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6570957
	speed: 0.1830s/iter; left time: 3293.3388s
	iters: 200, epoch: 14 | loss: 1.7854058
	speed: 0.0492s/iter; left time: 879.9658s
Epoch: 14 cost time: 10.756183624267578
Epoch: 14, Steps: 208 | Train Loss: 0.643 Vali Loss: 8.615 Vali Acc: 0.117 Test Loss: 8.615 Test Acc: 0.117
Validation loss decreased (-0.115655 --> -0.116526).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7839501
	speed: 0.1869s/iter; left time: 3324.5534s
	iters: 200, epoch: 15 | loss: 0.7386424
	speed: 0.0598s/iter; left time: 1057.1652s
Epoch: 15 cost time: 12.735809803009033
Epoch: 15, Steps: 208 | Train Loss: 0.542 Vali Loss: 8.900 Vali Acc: 0.123 Test Loss: 8.900 Test Acc: 0.123
Validation loss decreased (-0.116526 --> -0.122488).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3015875
	speed: 0.1985s/iter; left time: 3490.6045s
	iters: 200, epoch: 16 | loss: 0.6243279
	speed: 0.0585s/iter; left time: 1022.4987s
Epoch: 16 cost time: 12.8535737991333
Epoch: 16, Steps: 208 | Train Loss: 0.464 Vali Loss: 8.643 Vali Acc: 0.120 Test Loss: 8.643 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0558636
	speed: 0.1946s/iter; left time: 3381.0327s
	iters: 200, epoch: 17 | loss: 0.6254890
	speed: 0.0601s/iter; left time: 1038.3679s
Epoch: 17 cost time: 12.874141693115234
Epoch: 17, Steps: 208 | Train Loss: 0.415 Vali Loss: 9.785 Vali Acc: 0.113 Test Loss: 9.785 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5153028
	speed: 0.1909s/iter; left time: 3276.6307s
	iters: 200, epoch: 18 | loss: 1.1685930
	speed: 0.0577s/iter; left time: 984.4575s
Epoch: 18 cost time: 12.496386528015137
Epoch: 18, Steps: 208 | Train Loss: 0.327 Vali Loss: 10.173 Vali Acc: 0.114 Test Loss: 10.173 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1984164
	speed: 0.1939s/iter; left time: 3288.1311s
	iters: 200, epoch: 19 | loss: 0.5808412
	speed: 0.0612s/iter; left time: 1032.2506s
Epoch: 19 cost time: 12.844247579574585
Epoch: 19, Steps: 208 | Train Loss: 0.311 Vali Loss: 10.747 Vali Acc: 0.119 Test Loss: 10.747 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1437785
	speed: 0.1925s/iter; left time: 3223.6720s
	iters: 200, epoch: 20 | loss: 1.5852997
	speed: 0.0564s/iter; left time: 938.2449s
Epoch: 20 cost time: 12.18555498123169
Epoch: 20, Steps: 208 | Train Loss: 0.257 Vali Loss: 11.306 Vali Acc: 0.109 Test Loss: 11.306 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2316301
	speed: 0.1953s/iter; left time: 3231.1388s
	iters: 200, epoch: 21 | loss: 0.2397629
	speed: 0.0571s/iter; left time: 939.1565s
Epoch: 21 cost time: 12.435227155685425
Epoch: 21, Steps: 208 | Train Loss: 0.204 Vali Loss: 11.577 Vali Acc: 0.117 Test Loss: 11.577 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0814959
	speed: 0.1958s/iter; left time: 3197.8382s
	iters: 200, epoch: 22 | loss: 0.2296809
	speed: 0.0556s/iter; left time: 901.7900s
Epoch: 22 cost time: 12.083913326263428
Epoch: 22, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.499 Vali Acc: 0.111 Test Loss: 11.499 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.2756640
	speed: 0.1949s/iter; left time: 3142.5078s
	iters: 200, epoch: 23 | loss: 0.5782459
	speed: 0.0557s/iter; left time: 892.5320s
Epoch: 23 cost time: 12.136555910110474
Epoch: 23, Steps: 208 | Train Loss: 0.206 Vali Loss: 12.762 Vali Acc: 0.120 Test Loss: 12.762 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1186499
	speed: 0.1986s/iter; left time: 3160.5991s
	iters: 200, epoch: 24 | loss: 0.0524073
	speed: 0.0567s/iter; left time: 896.2818s
Epoch: 24 cost time: 12.41590929031372
Epoch: 24, Steps: 208 | Train Loss: 0.175 Vali Loss: 13.296 Vali Acc: 0.113 Test Loss: 13.296 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0444938
	speed: 0.1794s/iter; left time: 2817.5279s
	iters: 200, epoch: 25 | loss: 0.1100344
	speed: 0.0490s/iter; left time: 765.3715s
Epoch: 25 cost time: 10.919883966445923
Epoch: 25, Steps: 208 | Train Loss: 0.195 Vali Loss: 12.659 Vali Acc: 0.112 Test Loss: 12.659 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12257679689830003
model parameter : 1026823
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9985924
	speed: 0.0807s/iter; left time: 1670.8361s
	iters: 200, epoch: 1 | loss: 4.1221590
	speed: 0.0497s/iter; left time: 1023.9301s
Epoch: 1 cost time: 13.65412187576294
Epoch: 1, Steps: 208 | Train Loss: 4.013 Vali Loss: 4.016 Vali Acc: 0.056 Test Loss: 4.016 Test Acc: 0.056
Validation loss decreased (inf --> -0.055731).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2464437
	speed: 0.1618s/iter; left time: 3316.7642s
	iters: 200, epoch: 2 | loss: 2.9939620
	speed: 0.0664s/iter; left time: 1354.3847s
Epoch: 2 cost time: 13.286330938339233
Epoch: 2, Steps: 208 | Train Loss: 3.459 Vali Loss: 3.795 Vali Acc: 0.067 Test Loss: 3.795 Test Acc: 0.067
Validation loss decreased (-0.055731 --> -0.066768).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2835910
	speed: 0.1573s/iter; left time: 3190.9326s
	iters: 200, epoch: 3 | loss: 3.6427443
	speed: 0.0591s/iter; left time: 1193.2833s
Epoch: 3 cost time: 12.352956295013428
Epoch: 3, Steps: 208 | Train Loss: 3.153 Vali Loss: 3.854 Vali Acc: 0.089 Test Loss: 3.854 Test Acc: 0.089
Validation loss decreased (-0.066768 --> -0.089135).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0593266
	speed: 0.1624s/iter; left time: 3260.4588s
	iters: 200, epoch: 4 | loss: 2.4879243
	speed: 0.0868s/iter; left time: 1733.2783s
Epoch: 4 cost time: 15.466827630996704
Epoch: 4, Steps: 208 | Train Loss: 3.056 Vali Loss: 3.963 Vali Acc: 0.092 Test Loss: 3.963 Test Acc: 0.092
Validation loss decreased (-0.089135 --> -0.092415).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2794397
	speed: 0.1954s/iter; left time: 3882.3321s
	iters: 200, epoch: 5 | loss: 3.6629169
	speed: 0.0876s/iter; left time: 1731.3084s
Epoch: 5 cost time: 18.415886402130127
Epoch: 5, Steps: 208 | Train Loss: 2.934 Vali Loss: 4.485 Vali Acc: 0.106 Test Loss: 4.485 Test Acc: 0.106
Validation loss decreased (-0.092415 --> -0.106129).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4781413
	speed: 0.2014s/iter; left time: 3960.2881s
	iters: 200, epoch: 6 | loss: 3.9112470
	speed: 0.0886s/iter; left time: 1732.5676s
Epoch: 6 cost time: 18.608264446258545
Epoch: 6, Steps: 208 | Train Loss: 2.762 Vali Loss: 3.991 Vali Acc: 0.093 Test Loss: 3.991 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.4405477
	speed: 0.2021s/iter; left time: 3931.5075s
	iters: 200, epoch: 7 | loss: 3.3994391
	speed: 0.0873s/iter; left time: 1688.9037s
Epoch: 7 cost time: 18.576513290405273
Epoch: 7, Steps: 208 | Train Loss: 2.493 Vali Loss: 4.817 Vali Acc: 0.120 Test Loss: 4.817 Test Acc: 0.120
Validation loss decreased (-0.106129 --> -0.119844).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4796829
	speed: 0.1963s/iter; left time: 3778.2871s
	iters: 200, epoch: 8 | loss: 2.5559583
	speed: 0.0913s/iter; left time: 1747.9278s
Epoch: 8 cost time: 18.823519706726074
Epoch: 8, Steps: 208 | Train Loss: 2.159 Vali Loss: 4.922 Vali Acc: 0.115 Test Loss: 4.922 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8837807
	speed: 0.1950s/iter; left time: 3711.6179s
	iters: 200, epoch: 9 | loss: 2.3790178
	speed: 0.0863s/iter; left time: 1633.8229s
Epoch: 9 cost time: 17.897273778915405
Epoch: 9, Steps: 208 | Train Loss: 1.853 Vali Loss: 5.299 Vali Acc: 0.120 Test Loss: 5.299 Test Acc: 0.120
Validation loss decreased (-0.119844 --> -0.120138).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2298294
	speed: 0.1955s/iter; left time: 3681.1177s
	iters: 200, epoch: 10 | loss: 1.3311970
	speed: 0.0863s/iter; left time: 1615.4004s
Epoch: 10 cost time: 18.274157762527466
Epoch: 10, Steps: 208 | Train Loss: 1.576 Vali Loss: 5.466 Vali Acc: 0.120 Test Loss: 5.466 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1075494
	speed: 0.1915s/iter; left time: 3566.3366s
	iters: 200, epoch: 11 | loss: 2.2653279
	speed: 0.0708s/iter; left time: 1310.3756s
Epoch: 11 cost time: 15.959558248519897
Epoch: 11, Steps: 208 | Train Loss: 1.365 Vali Loss: 5.747 Vali Acc: 0.119 Test Loss: 5.747 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7107428
	speed: 0.1718s/iter; left time: 3163.5790s
	iters: 200, epoch: 12 | loss: 1.1020598
	speed: 0.0583s/iter; left time: 1067.5788s
Epoch: 12 cost time: 12.85680079460144
Epoch: 12, Steps: 208 | Train Loss: 1.141 Vali Loss: 6.441 Vali Acc: 0.131 Test Loss: 6.441 Test Acc: 0.131
Validation loss decreased (-0.120138 --> -0.130863).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1162081
	speed: 0.1730s/iter; left time: 3148.8760s
	iters: 200, epoch: 13 | loss: 0.4587576
	speed: 0.0579s/iter; left time: 1048.7164s
Epoch: 13 cost time: 12.778711795806885
Epoch: 13, Steps: 208 | Train Loss: 1.000 Vali Loss: 6.706 Vali Acc: 0.123 Test Loss: 6.706 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4044585
	speed: 0.1566s/iter; left time: 2817.8762s
	iters: 200, epoch: 14 | loss: 1.9903402
	speed: 0.0595s/iter; left time: 1065.6048s
Epoch: 14 cost time: 11.470387935638428
Epoch: 14, Steps: 208 | Train Loss: 0.878 Vali Loss: 6.550 Vali Acc: 0.128 Test Loss: 6.550 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5669523
	speed: 0.1591s/iter; left time: 2829.7974s
	iters: 200, epoch: 15 | loss: 0.3383889
	speed: 0.0613s/iter; left time: 1084.4544s
Epoch: 15 cost time: 12.616262912750244
Epoch: 15, Steps: 208 | Train Loss: 0.740 Vali Loss: 7.310 Vali Acc: 0.120 Test Loss: 7.310 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8186616
	speed: 0.1644s/iter; left time: 2890.9331s
	iters: 200, epoch: 16 | loss: 0.6881459
	speed: 0.0618s/iter; left time: 1079.8393s
Epoch: 16 cost time: 13.36148977279663
Epoch: 16, Steps: 208 | Train Loss: 0.664 Vali Loss: 7.959 Vali Acc: 0.128 Test Loss: 7.959 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5157032
	speed: 0.1976s/iter; left time: 3432.3987s
	iters: 200, epoch: 17 | loss: 0.7440595
	speed: 0.0921s/iter; left time: 1590.4219s
Epoch: 17 cost time: 19.934524059295654
Epoch: 17, Steps: 208 | Train Loss: 0.574 Vali Loss: 8.435 Vali Acc: 0.125 Test Loss: 8.435 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1858175
	speed: 0.2032s/iter; left time: 3488.2421s
	iters: 200, epoch: 18 | loss: 0.7879386
	speed: 0.0884s/iter; left time: 1508.4468s
Epoch: 18 cost time: 19.199476718902588
Epoch: 18, Steps: 208 | Train Loss: 0.528 Vali Loss: 9.061 Vali Acc: 0.119 Test Loss: 9.061 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6916425
	speed: 0.2004s/iter; left time: 3397.8541s
	iters: 200, epoch: 19 | loss: 0.7787743
	speed: 0.0932s/iter; left time: 1571.7854s
Epoch: 19 cost time: 18.978017568588257
Epoch: 19, Steps: 208 | Train Loss: 0.436 Vali Loss: 9.481 Vali Acc: 0.129 Test Loss: 9.481 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.3209887
	speed: 0.2064s/iter; left time: 3456.5083s
	iters: 200, epoch: 20 | loss: 0.7905353
	speed: 0.0947s/iter; left time: 1576.9920s
Epoch: 20 cost time: 19.509178400039673
Epoch: 20, Steps: 208 | Train Loss: 0.434 Vali Loss: 9.242 Vali Acc: 0.124 Test Loss: 9.242 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.6298262
	speed: 0.2082s/iter; left time: 3443.4594s
	iters: 200, epoch: 21 | loss: 0.2715753
	speed: 0.0913s/iter; left time: 1501.7222s
Epoch: 21 cost time: 19.607189416885376
Epoch: 21, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.533 Vali Acc: 0.119 Test Loss: 9.533 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5234934
	speed: 0.2056s/iter; left time: 3358.4723s
	iters: 200, epoch: 22 | loss: 0.7648984
	speed: 0.0804s/iter; left time: 1305.2073s
Epoch: 22 cost time: 18.21146249771118
Epoch: 22, Steps: 208 | Train Loss: 0.364 Vali Loss: 10.677 Vali Acc: 0.121 Test Loss: 10.677 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1309275275872353
model parameter : 532775
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5144613
	speed: 0.1094s/iter; left time: 2265.1745s
	iters: 200, epoch: 1 | loss: 4.0671310
	speed: 0.0516s/iter; left time: 1062.3026s
Epoch: 1 cost time: 16.575173139572144
Epoch: 1, Steps: 208 | Train Loss: 3.891 Vali Loss: 3.975 Vali Acc: 0.057 Test Loss: 3.975 Test Acc: 0.057
Validation loss decreased (inf --> -0.056924).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4072163
	speed: 0.1712s/iter; left time: 3509.2546s
	iters: 200, epoch: 2 | loss: 4.1070623
	speed: 0.0440s/iter; left time: 897.5557s
Epoch: 2 cost time: 11.511504173278809
Epoch: 2, Steps: 208 | Train Loss: 3.489 Vali Loss: 3.768 Vali Acc: 0.078 Test Loss: 3.768 Test Acc: 0.078
Validation loss decreased (-0.056924 --> -0.077505).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4980490
	speed: 0.1602s/iter; left time: 3249.6420s
	iters: 200, epoch: 3 | loss: 3.2401035
	speed: 0.0576s/iter; left time: 1163.1220s
Epoch: 3 cost time: 12.479572534561157
Epoch: 3, Steps: 208 | Train Loss: 3.194 Vali Loss: 3.980 Vali Acc: 0.088 Test Loss: 3.980 Test Acc: 0.088
Validation loss decreased (-0.077505 --> -0.088239).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2507467
	speed: 0.1677s/iter; left time: 3367.4814s
	iters: 200, epoch: 4 | loss: 4.3578401
	speed: 0.0471s/iter; left time: 941.0332s
Epoch: 4 cost time: 11.078250885009766
Epoch: 4, Steps: 208 | Train Loss: 2.992 Vali Loss: 4.505 Vali Acc: 0.081 Test Loss: 4.505 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2114224
	speed: 0.1674s/iter; left time: 3326.7830s
	iters: 200, epoch: 5 | loss: 2.2417283
	speed: 0.0525s/iter; left time: 1037.1764s
Epoch: 5 cost time: 11.908854722976685
Epoch: 5, Steps: 208 | Train Loss: 2.878 Vali Loss: 4.340 Vali Acc: 0.098 Test Loss: 4.340 Test Acc: 0.098
Validation loss decreased (-0.088239 --> -0.097779).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3291798
	speed: 0.1725s/iter; left time: 3391.5479s
	iters: 200, epoch: 6 | loss: 3.3435423
	speed: 0.0491s/iter; left time: 960.7241s
Epoch: 6 cost time: 12.462640762329102
Epoch: 6, Steps: 208 | Train Loss: 2.711 Vali Loss: 4.091 Vali Acc: 0.113 Test Loss: 4.091 Test Acc: 0.113
Validation loss decreased (-0.097779 --> -0.112992).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4805243
	speed: 0.1844s/iter; left time: 3587.5260s
	iters: 200, epoch: 7 | loss: 3.2928610
	speed: 0.0875s/iter; left time: 1693.7652s
Epoch: 7 cost time: 17.143009424209595
Epoch: 7, Steps: 208 | Train Loss: 2.528 Vali Loss: 4.260 Vali Acc: 0.112 Test Loss: 4.260 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6023390
	speed: 0.2077s/iter; left time: 3996.4854s
	iters: 200, epoch: 8 | loss: 1.9308120
	speed: 0.0867s/iter; left time: 1659.5284s
Epoch: 8 cost time: 18.9164936542511
Epoch: 8, Steps: 208 | Train Loss: 2.275 Vali Loss: 4.589 Vali Acc: 0.118 Test Loss: 4.589 Test Acc: 0.118
Validation loss decreased (-0.112992 --> -0.118356).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8073347
	speed: 0.1917s/iter; left time: 3650.1652s
	iters: 200, epoch: 9 | loss: 2.6470973
	speed: 0.0949s/iter; left time: 1796.8828s
Epoch: 9 cost time: 19.53266453742981
Epoch: 9, Steps: 208 | Train Loss: 2.031 Vali Loss: 4.930 Vali Acc: 0.108 Test Loss: 4.930 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8483778
	speed: 0.2058s/iter; left time: 3875.1897s
	iters: 200, epoch: 10 | loss: 2.5106523
	speed: 0.0906s/iter; left time: 1697.6850s
Epoch: 10 cost time: 19.66649556159973
Epoch: 10, Steps: 208 | Train Loss: 1.830 Vali Loss: 4.709 Vali Acc: 0.119 Test Loss: 4.709 Test Acc: 0.119
Validation loss decreased (-0.118356 --> -0.118653).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2123296
	speed: 0.2038s/iter; left time: 3795.7519s
	iters: 200, epoch: 11 | loss: 1.7974824
	speed: 0.0814s/iter; left time: 1507.5024s
Epoch: 11 cost time: 18.54441547393799
Epoch: 11, Steps: 208 | Train Loss: 1.605 Vali Loss: 5.294 Vali Acc: 0.120 Test Loss: 5.294 Test Acc: 0.120
Validation loss decreased (-0.118653 --> -0.119840).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7036041
	speed: 0.1884s/iter; left time: 3468.6986s
	iters: 200, epoch: 12 | loss: 2.3261678
	speed: 0.0890s/iter; left time: 1630.2094s
Epoch: 12 cost time: 18.23127055168152
Epoch: 12, Steps: 208 | Train Loss: 1.447 Vali Loss: 5.264 Vali Acc: 0.125 Test Loss: 5.264 Test Acc: 0.125
Validation loss decreased (-0.119840 --> -0.124910).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4861470
	speed: 0.1914s/iter; left time: 3484.8780s
	iters: 200, epoch: 13 | loss: 0.8898164
	speed: 0.0894s/iter; left time: 1618.9724s
Epoch: 13 cost time: 18.08667826652527
Epoch: 13, Steps: 208 | Train Loss: 1.220 Vali Loss: 5.734 Vali Acc: 0.120 Test Loss: 5.734 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2057565
	speed: 0.1948s/iter; left time: 3505.1591s
	iters: 200, epoch: 14 | loss: 0.7381307
	speed: 0.0556s/iter; left time: 995.1225s
Epoch: 14 cost time: 14.93986439704895
Epoch: 14, Steps: 208 | Train Loss: 1.070 Vali Loss: 6.141 Vali Acc: 0.130 Test Loss: 6.141 Test Acc: 0.130
Validation loss decreased (-0.124910 --> -0.129971).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6694579
	speed: 0.1647s/iter; left time: 2929.6467s
	iters: 200, epoch: 15 | loss: 1.4051486
	speed: 0.0471s/iter; left time: 832.8960s
Epoch: 15 cost time: 11.259730815887451
Epoch: 15, Steps: 208 | Train Loss: 0.974 Vali Loss: 5.933 Vali Acc: 0.123 Test Loss: 5.933 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5608159
	speed: 0.1570s/iter; left time: 2759.4333s
	iters: 200, epoch: 16 | loss: 0.7596679
	speed: 0.0612s/iter; left time: 1069.0200s
Epoch: 16 cost time: 12.57877516746521
Epoch: 16, Steps: 208 | Train Loss: 0.860 Vali Loss: 6.549 Vali Acc: 0.127 Test Loss: 6.549 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2903670
	speed: 0.1568s/iter; left time: 2724.3307s
	iters: 200, epoch: 17 | loss: 0.8886850
	speed: 0.0495s/iter; left time: 855.5286s
Epoch: 17 cost time: 11.33661675453186
Epoch: 17, Steps: 208 | Train Loss: 0.743 Vali Loss: 7.176 Vali Acc: 0.129 Test Loss: 7.176 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5935112
	speed: 0.1555s/iter; left time: 2669.1554s
	iters: 200, epoch: 18 | loss: 1.1745125
	speed: 0.0512s/iter; left time: 874.2982s
Epoch: 18 cost time: 11.477119207382202
Epoch: 18, Steps: 208 | Train Loss: 0.672 Vali Loss: 7.413 Vali Acc: 0.132 Test Loss: 7.413 Test Acc: 0.132
Validation loss decreased (-0.129971 --> -0.131450).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.8812959
	speed: 0.1583s/iter; left time: 2683.5262s
	iters: 200, epoch: 19 | loss: 0.3324012
	speed: 0.0496s/iter; left time: 836.5162s
Epoch: 19 cost time: 11.526225805282593
Epoch: 19, Steps: 208 | Train Loss: 0.607 Vali Loss: 7.542 Vali Acc: 0.124 Test Loss: 7.542 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7832946
	speed: 0.1873s/iter; left time: 3136.3977s
	iters: 200, epoch: 20 | loss: 0.4748968
	speed: 0.0794s/iter; left time: 1321.5704s
Epoch: 20 cost time: 18.094897508621216
Epoch: 20, Steps: 208 | Train Loss: 0.521 Vali Loss: 8.527 Vali Acc: 0.129 Test Loss: 8.527 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.4312386
	speed: 0.1886s/iter; left time: 3119.0656s
	iters: 200, epoch: 21 | loss: 1.1148497
	speed: 0.0846s/iter; left time: 1391.6592s
Epoch: 21 cost time: 18.0396568775177
Epoch: 21, Steps: 208 | Train Loss: 0.470 Vali Loss: 8.549 Vali Acc: 0.126 Test Loss: 8.549 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1757325
	speed: 0.1831s/iter; left time: 2991.1070s
	iters: 200, epoch: 22 | loss: 0.3307841
	speed: 0.0892s/iter; left time: 1448.4634s
Epoch: 22 cost time: 17.980332136154175
Epoch: 22, Steps: 208 | Train Loss: 0.435 Vali Loss: 8.677 Vali Acc: 0.116 Test Loss: 8.677 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.3327723
	speed: 0.1880s/iter; left time: 3031.9268s
	iters: 200, epoch: 23 | loss: 0.5871087
	speed: 0.0906s/iter; left time: 1451.1040s
Epoch: 23 cost time: 18.49620032310486
Epoch: 23, Steps: 208 | Train Loss: 0.400 Vali Loss: 9.200 Vali Acc: 0.126 Test Loss: 9.200 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.6631626
	speed: 0.1941s/iter; left time: 3089.2871s
	iters: 200, epoch: 24 | loss: 0.4258434
	speed: 0.0907s/iter; left time: 1433.9093s
Epoch: 24 cost time: 18.98861312866211
Epoch: 24, Steps: 208 | Train Loss: 0.401 Vali Loss: 9.837 Vali Acc: 0.117 Test Loss: 9.837 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1403546
	speed: 0.1934s/iter; left time: 3038.0993s
	iters: 200, epoch: 25 | loss: 0.5264269
	speed: 0.0866s/iter; left time: 1352.0176s
Epoch: 25 cost time: 18.849120140075684
Epoch: 25, Steps: 208 | Train Loss: 0.369 Vali Loss: 9.726 Vali Acc: 0.126 Test Loss: 9.726 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.4708950
	speed: 0.1932s/iter; left time: 2994.0848s
	iters: 200, epoch: 26 | loss: 0.2653358
	speed: 0.0831s/iter; left time: 1279.9316s
Epoch: 26 cost time: 18.12005853652954
Epoch: 26, Steps: 208 | Train Loss: 0.336 Vali Loss: 10.470 Vali Acc: 0.122 Test Loss: 10.470 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.2213859
	speed: 0.1868s/iter; left time: 2856.3113s
	iters: 200, epoch: 27 | loss: 0.4285756
	speed: 0.0435s/iter; left time: 661.1470s
Epoch: 27 cost time: 13.453996181488037
Epoch: 27, Steps: 208 | Train Loss: 0.303 Vali Loss: 10.528 Vali Acc: 0.128 Test Loss: 10.528 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0395339
	speed: 0.1361s/iter; left time: 2053.4438s
	iters: 200, epoch: 28 | loss: 0.1767497
	speed: 0.0499s/iter; left time: 747.8427s
Epoch: 28 cost time: 9.582434892654419
Epoch: 28, Steps: 208 | Train Loss: 0.326 Vali Loss: 10.948 Vali Acc: 0.115 Test Loss: 10.948 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1315240083507307
model parameter : 368231
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5880942
	speed: 0.0496s/iter; left time: 1027.4954s
	iters: 200, epoch: 1 | loss: 4.0982566
	speed: 0.0352s/iter; left time: 724.2423s
Epoch: 1 cost time: 8.887100458145142
Epoch: 1, Steps: 208 | Train Loss: 3.851 Vali Loss: 3.790 Vali Acc: 0.069 Test Loss: 3.790 Test Acc: 0.069
Validation loss decreased (inf --> -0.069452).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6649547
	speed: 0.1565s/iter; left time: 3208.0234s
	iters: 200, epoch: 2 | loss: 3.5411587
	speed: 0.0337s/iter; left time: 686.6328s
Epoch: 2 cost time: 8.218503713607788
Epoch: 2, Steps: 208 | Train Loss: 3.554 Vali Loss: 3.729 Vali Acc: 0.087 Test Loss: 3.729 Test Acc: 0.087
Validation loss decreased (-0.069452 --> -0.087049).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1140416
	speed: 0.1516s/iter; left time: 3074.7550s
	iters: 200, epoch: 3 | loss: 3.4581990
	speed: 0.0424s/iter; left time: 855.5203s
Epoch: 3 cost time: 8.885088443756104
Epoch: 3, Steps: 208 | Train Loss: 3.179 Vali Loss: 4.089 Vali Acc: 0.082 Test Loss: 4.089 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6598427
	speed: 0.1531s/iter; left time: 3073.3506s
	iters: 200, epoch: 4 | loss: 3.3439493
	speed: 0.0425s/iter; left time: 849.1365s
Epoch: 4 cost time: 9.205427408218384
Epoch: 4, Steps: 208 | Train Loss: 3.018 Vali Loss: 4.101 Vali Acc: 0.096 Test Loss: 4.101 Test Acc: 0.096
Validation loss decreased (-0.087049 --> -0.096291).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5878534
	speed: 0.1523s/iter; left time: 3026.5551s
	iters: 200, epoch: 5 | loss: 2.7082498
	speed: 0.0436s/iter; left time: 862.7152s
Epoch: 5 cost time: 9.742066621780396
Epoch: 5, Steps: 208 | Train Loss: 2.825 Vali Loss: 4.241 Vali Acc: 0.103 Test Loss: 4.241 Test Acc: 0.103
Validation loss decreased (-0.096291 --> -0.102552).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8905199
	speed: 0.1680s/iter; left time: 3302.1490s
	iters: 200, epoch: 6 | loss: 2.5326018
	speed: 0.0511s/iter; left time: 998.7781s
Epoch: 6 cost time: 11.216278553009033
Epoch: 6, Steps: 208 | Train Loss: 2.690 Vali Loss: 4.207 Vali Acc: 0.106 Test Loss: 4.207 Test Acc: 0.106
Validation loss decreased (-0.102552 --> -0.105833).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0244763
	speed: 0.1671s/iter; left time: 3250.9142s
	iters: 200, epoch: 7 | loss: 2.4261770
	speed: 0.0513s/iter; left time: 993.4039s
Epoch: 7 cost time: 11.248263120651245
Epoch: 7, Steps: 208 | Train Loss: 2.524 Vali Loss: 4.585 Vali Acc: 0.108 Test Loss: 4.585 Test Acc: 0.108
Validation loss decreased (-0.105833 --> -0.107619).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4473295
	speed: 0.1614s/iter; left time: 3106.2863s
	iters: 200, epoch: 8 | loss: 2.1071293
	speed: 0.0474s/iter; left time: 907.7230s
Epoch: 8 cost time: 10.265469789505005
Epoch: 8, Steps: 208 | Train Loss: 2.328 Vali Loss: 4.488 Vali Acc: 0.119 Test Loss: 4.488 Test Acc: 0.119
Validation loss decreased (-0.107619 --> -0.118953).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9253047
	speed: 0.1649s/iter; left time: 3138.5973s
	iters: 200, epoch: 9 | loss: 2.7769990
	speed: 0.0460s/iter; left time: 870.4392s
Epoch: 9 cost time: 10.418975353240967
Epoch: 9, Steps: 208 | Train Loss: 2.124 Vali Loss: 4.341 Vali Acc: 0.115 Test Loss: 4.341 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6220227
	speed: 0.1633s/iter; left time: 3074.0836s
	iters: 200, epoch: 10 | loss: 2.1253107
	speed: 0.0507s/iter; left time: 948.8196s
Epoch: 10 cost time: 10.97973346710205
Epoch: 10, Steps: 208 | Train Loss: 1.904 Vali Loss: 4.679 Vali Acc: 0.119 Test Loss: 4.679 Test Acc: 0.119
Validation loss decreased (-0.118953 --> -0.119249).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9934431
	speed: 0.1633s/iter; left time: 3040.5660s
	iters: 200, epoch: 11 | loss: 1.6693659
	speed: 0.0510s/iter; left time: 944.9651s
Epoch: 11 cost time: 10.682146787643433
Epoch: 11, Steps: 208 | Train Loss: 1.756 Vali Loss: 5.016 Vali Acc: 0.124 Test Loss: 5.016 Test Acc: 0.124
Validation loss decreased (-0.119249 --> -0.124018).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6669633
	speed: 0.1691s/iter; left time: 3113.9567s
	iters: 200, epoch: 12 | loss: 1.8630414
	speed: 0.0438s/iter; left time: 802.3340s
Epoch: 12 cost time: 10.18165898323059
Epoch: 12, Steps: 208 | Train Loss: 1.571 Vali Loss: 5.093 Vali Acc: 0.119 Test Loss: 5.093 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3917193
	speed: 0.1599s/iter; left time: 2911.1920s
	iters: 200, epoch: 13 | loss: 1.2070453
	speed: 0.0488s/iter; left time: 884.0421s
Epoch: 13 cost time: 10.698471546173096
Epoch: 13, Steps: 208 | Train Loss: 1.388 Vali Loss: 5.211 Vali Acc: 0.125 Test Loss: 5.211 Test Acc: 0.125
Validation loss decreased (-0.124018 --> -0.125209).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2100949
	speed: 0.1659s/iter; left time: 2986.1516s
	iters: 200, epoch: 14 | loss: 1.5652088
	speed: 0.0482s/iter; left time: 862.8641s
Epoch: 14 cost time: 10.782833814620972
Epoch: 14, Steps: 208 | Train Loss: 1.227 Vali Loss: 5.532 Vali Acc: 0.129 Test Loss: 5.532 Test Acc: 0.129
Validation loss decreased (-0.125209 --> -0.128486).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0210929
	speed: 0.1608s/iter; left time: 2859.8146s
	iters: 200, epoch: 15 | loss: 0.5986515
	speed: 0.0461s/iter; left time: 815.7892s
Epoch: 15 cost time: 9.800470352172852
Epoch: 15, Steps: 208 | Train Loss: 1.075 Vali Loss: 5.649 Vali Acc: 0.130 Test Loss: 5.649 Test Acc: 0.130
Validation loss decreased (-0.128486 --> -0.129976).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7871901
	speed: 0.1675s/iter; left time: 2945.0202s
	iters: 200, epoch: 16 | loss: 0.9156384
	speed: 0.0447s/iter; left time: 781.6358s
Epoch: 16 cost time: 10.157130002975464
Epoch: 16, Steps: 208 | Train Loss: 0.957 Vali Loss: 6.327 Vali Acc: 0.127 Test Loss: 6.327 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6704562
	speed: 0.1525s/iter; left time: 2648.6011s
	iters: 200, epoch: 17 | loss: 0.8432476
	speed: 0.0424s/iter; left time: 733.2166s
Epoch: 17 cost time: 9.398277997970581
Epoch: 17, Steps: 208 | Train Loss: 0.867 Vali Loss: 6.445 Vali Acc: 0.121 Test Loss: 6.445 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8322778
	speed: 0.1399s/iter; left time: 2402.2013s
	iters: 200, epoch: 18 | loss: 0.8318244
	speed: 0.0425s/iter; left time: 725.1225s
Epoch: 18 cost time: 8.721094369888306
Epoch: 18, Steps: 208 | Train Loss: 0.795 Vali Loss: 6.939 Vali Acc: 0.121 Test Loss: 6.939 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6222180
	speed: 0.1434s/iter; left time: 2431.5488s
	iters: 200, epoch: 19 | loss: 0.6211076
	speed: 0.0360s/iter; left time: 606.7270s
Epoch: 19 cost time: 8.15591835975647
Epoch: 19, Steps: 208 | Train Loss: 0.712 Vali Loss: 7.182 Vali Acc: 0.120 Test Loss: 7.182 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6839378
	speed: 0.1492s/iter; left time: 2498.7225s
	iters: 200, epoch: 20 | loss: 0.7097932
	speed: 0.0427s/iter; left time: 710.3150s
Epoch: 20 cost time: 9.365044116973877
Epoch: 20, Steps: 208 | Train Loss: 0.638 Vali Loss: 7.413 Vali Acc: 0.127 Test Loss: 7.413 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4501364
	speed: 0.1507s/iter; left time: 2493.4718s
	iters: 200, epoch: 21 | loss: 0.4173011
	speed: 0.0416s/iter; left time: 684.1093s
Epoch: 21 cost time: 9.220110654830933
Epoch: 21, Steps: 208 | Train Loss: 0.571 Vali Loss: 7.971 Vali Acc: 0.124 Test Loss: 7.971 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.6197752
	speed: 0.1403s/iter; left time: 2291.5296s
	iters: 200, epoch: 22 | loss: 0.5087714
	speed: 0.0362s/iter; left time: 588.2141s
Epoch: 22 cost time: 7.910391569137573
Epoch: 22, Steps: 208 | Train Loss: 0.543 Vali Loss: 7.944 Vali Acc: 0.132 Test Loss: 7.944 Test Acc: 0.132
Validation loss decreased (-0.129976 --> -0.131743).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.3202053
	speed: 0.1517s/iter; left time: 2446.6016s
	iters: 200, epoch: 23 | loss: 2.0019600
	speed: 0.0403s/iter; left time: 645.7829s
Epoch: 23 cost time: 9.000774621963501
Epoch: 23, Steps: 208 | Train Loss: 0.480 Vali Loss: 8.466 Vali Acc: 0.132 Test Loss: 8.466 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1450464
	speed: 0.1493s/iter; left time: 2375.7164s
	iters: 200, epoch: 24 | loss: 0.4033749
	speed: 0.0455s/iter; left time: 720.3630s
Epoch: 24 cost time: 9.513499975204468
Epoch: 24, Steps: 208 | Train Loss: 0.482 Vali Loss: 9.200 Vali Acc: 0.126 Test Loss: 9.200 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2291524
	speed: 0.1574s/iter; left time: 2472.2304s
	iters: 200, epoch: 25 | loss: 1.4505042
	speed: 0.0513s/iter; left time: 800.1308s
Epoch: 25 cost time: 10.839295148849487
Epoch: 25, Steps: 208 | Train Loss: 0.421 Vali Loss: 9.084 Vali Acc: 0.127 Test Loss: 9.084 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.2467485
	speed: 0.1638s/iter; left time: 2538.7187s
	iters: 200, epoch: 26 | loss: 0.8956092
	speed: 0.0419s/iter; left time: 644.8353s
Epoch: 26 cost time: 9.88340973854065
Epoch: 26, Steps: 208 | Train Loss: 0.387 Vali Loss: 9.549 Vali Acc: 0.121 Test Loss: 9.549 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.0117774
	speed: 0.1587s/iter; left time: 2426.7226s
	iters: 200, epoch: 27 | loss: 0.2933196
	speed: 0.0489s/iter; left time: 742.3669s
Epoch: 27 cost time: 10.594332218170166
Epoch: 27, Steps: 208 | Train Loss: 0.358 Vali Loss: 9.573 Vali Acc: 0.122 Test Loss: 9.573 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1180706
	speed: 0.1599s/iter; left time: 2411.5558s
	iters: 200, epoch: 28 | loss: 0.5557286
	speed: 0.0509s/iter; left time: 763.2582s
Epoch: 28 cost time: 10.701619625091553
Epoch: 28, Steps: 208 | Train Loss: 0.364 Vali Loss: 9.920 Vali Acc: 0.125 Test Loss: 9.920 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.2051468
	speed: 0.1579s/iter; left time: 2349.4453s
	iters: 200, epoch: 29 | loss: 0.3229243
	speed: 0.0446s/iter; left time: 659.4258s
Epoch: 29 cost time: 10.086096286773682
Epoch: 29, Steps: 208 | Train Loss: 0.355 Vali Loss: 9.966 Vali Acc: 0.118 Test Loss: 9.966 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.1205990
	speed: 0.1576s/iter; left time: 2311.3606s
	iters: 200, epoch: 30 | loss: 0.2561346
	speed: 0.0498s/iter; left time: 726.0542s
Epoch: 30 cost time: 10.714107990264893
Epoch: 30, Steps: 208 | Train Loss: 0.311 Vali Loss: 10.270 Vali Acc: 0.122 Test Loss: 10.270 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.9086720
	speed: 0.1554s/iter; left time: 2247.6269s
	iters: 200, epoch: 31 | loss: 0.0833118
	speed: 0.0473s/iter; left time: 679.5281s
Epoch: 31 cost time: 10.278466939926147
Epoch: 31, Steps: 208 | Train Loss: 0.307 Vali Loss: 10.706 Vali Acc: 0.126 Test Loss: 10.706 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.3118534
	speed: 0.1562s/iter; left time: 2226.5242s
	iters: 200, epoch: 32 | loss: 0.6850065
	speed: 0.0421s/iter; left time: 596.4708s
Epoch: 32 cost time: 9.290849208831787
Epoch: 32, Steps: 208 | Train Loss: 0.306 Vali Loss: 10.835 Vali Acc: 0.124 Test Loss: 10.835 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1318222487324784
model parameter : 299751
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5366364
	speed: 0.0661s/iter; left time: 1369.1268s
	iters: 200, epoch: 1 | loss: 4.1024923
	speed: 0.0482s/iter; left time: 991.9941s
Epoch: 1 cost time: 11.868920803070068
Epoch: 1, Steps: 208 | Train Loss: 3.798 Vali Loss: 3.767 Vali Acc: 0.053 Test Loss: 3.767 Test Acc: 0.053
Validation loss decreased (inf --> -0.053049).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6308827
	speed: 0.1609s/iter; left time: 3296.4397s
	iters: 200, epoch: 2 | loss: 3.7168245
	speed: 0.0439s/iter; left time: 894.7911s
Epoch: 2 cost time: 9.440900087356567
Epoch: 2, Steps: 208 | Train Loss: 3.505 Vali Loss: 3.833 Vali Acc: 0.071 Test Loss: 3.833 Test Acc: 0.071
Validation loss decreased (-0.053049 --> -0.070645).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4686880
	speed: 0.1635s/iter; left time: 3317.3015s
	iters: 200, epoch: 3 | loss: 3.3061185
	speed: 0.0426s/iter; left time: 859.3098s
Epoch: 3 cost time: 9.836950063705444
Epoch: 3, Steps: 208 | Train Loss: 3.245 Vali Loss: 4.069 Vali Acc: 0.072 Test Loss: 4.069 Test Acc: 0.072
Validation loss decreased (-0.070645 --> -0.071537).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3775539
	speed: 0.1486s/iter; left time: 2982.7282s
	iters: 200, epoch: 4 | loss: 2.4374692
	speed: 0.0436s/iter; left time: 871.5441s
Epoch: 4 cost time: 9.198305368423462
Epoch: 4, Steps: 208 | Train Loss: 3.027 Vali Loss: 4.074 Vali Acc: 0.087 Test Loss: 4.074 Test Acc: 0.087
Validation loss decreased (-0.071537 --> -0.087045).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8466053
	speed: 0.1542s/iter; left time: 3064.3975s
	iters: 200, epoch: 5 | loss: 3.1037900
	speed: 0.0421s/iter; left time: 831.6025s
Epoch: 5 cost time: 9.129871129989624
Epoch: 5, Steps: 208 | Train Loss: 2.851 Vali Loss: 4.232 Vali Acc: 0.089 Test Loss: 4.232 Test Acc: 0.089
Validation loss decreased (-0.087045 --> -0.089430).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1536338
	speed: 0.1413s/iter; left time: 2777.5928s
	iters: 200, epoch: 6 | loss: 3.3693855
	speed: 0.0369s/iter; left time: 722.7573s
Epoch: 6 cost time: 7.936796188354492
Epoch: 6, Steps: 208 | Train Loss: 2.709 Vali Loss: 4.171 Vali Acc: 0.099 Test Loss: 4.171 Test Acc: 0.099
Validation loss decreased (-0.089430 --> -0.098974).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4576418
	speed: 0.1489s/iter; left time: 2897.0709s
	iters: 200, epoch: 7 | loss: 3.2312176
	speed: 0.0396s/iter; left time: 765.6122s
Epoch: 7 cost time: 8.99911093711853
Epoch: 7, Steps: 208 | Train Loss: 2.565 Vali Loss: 4.271 Vali Acc: 0.106 Test Loss: 4.271 Test Acc: 0.106
Validation loss decreased (-0.098974 --> -0.106131).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6050136
	speed: 0.1488s/iter; left time: 2862.8350s
	iters: 200, epoch: 8 | loss: 2.7127178
	speed: 0.0449s/iter; left time: 859.9329s
Epoch: 8 cost time: 9.906980037689209
Epoch: 8, Steps: 208 | Train Loss: 2.367 Vali Loss: 4.226 Vali Acc: 0.110 Test Loss: 4.226 Test Acc: 0.110
Validation loss decreased (-0.106131 --> -0.109710).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9480568
	speed: 0.1506s/iter; left time: 2867.5002s
	iters: 200, epoch: 9 | loss: 2.0712185
	speed: 0.0432s/iter; left time: 818.7570s
Epoch: 9 cost time: 9.1372230052948
Epoch: 9, Steps: 208 | Train Loss: 2.190 Vali Loss: 4.537 Vali Acc: 0.113 Test Loss: 4.537 Test Acc: 0.113
Validation loss decreased (-0.109710 --> -0.113286).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1813021
	speed: 0.1560s/iter; left time: 2936.7205s
	iters: 200, epoch: 10 | loss: 1.9852710
	speed: 0.0367s/iter; left time: 686.9596s
Epoch: 10 cost time: 8.656894207000732
Epoch: 10, Steps: 208 | Train Loss: 2.047 Vali Loss: 4.543 Vali Acc: 0.115 Test Loss: 4.543 Test Acc: 0.115
Validation loss decreased (-0.113286 --> -0.115075).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0741460
	speed: 0.1524s/iter; left time: 2838.5565s
	iters: 200, epoch: 11 | loss: 2.1211274
	speed: 0.0440s/iter; left time: 814.9915s
Epoch: 11 cost time: 9.689231872558594
Epoch: 11, Steps: 208 | Train Loss: 1.894 Vali Loss: 4.800 Vali Acc: 0.118 Test Loss: 4.800 Test Acc: 0.118
Validation loss decreased (-0.115075 --> -0.117459).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2925342
	speed: 0.1622s/iter; left time: 2987.2998s
	iters: 200, epoch: 12 | loss: 1.8562264
	speed: 0.0503s/iter; left time: 921.6619s
Epoch: 12 cost time: 10.81202507019043
Epoch: 12, Steps: 208 | Train Loss: 1.703 Vali Loss: 4.944 Vali Acc: 0.118 Test Loss: 4.944 Test Acc: 0.118
Validation loss decreased (-0.117459 --> -0.118352).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2169471
	speed: 0.1608s/iter; left time: 2927.5639s
	iters: 200, epoch: 13 | loss: 2.1519961
	speed: 0.0413s/iter; left time: 747.0764s
Epoch: 13 cost time: 9.394377946853638
Epoch: 13, Steps: 208 | Train Loss: 1.570 Vali Loss: 5.188 Vali Acc: 0.118 Test Loss: 5.188 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8932643
	speed: 0.1632s/iter; left time: 2937.9283s
	iters: 200, epoch: 14 | loss: 1.6843760
	speed: 0.0496s/iter; left time: 887.8669s
Epoch: 14 cost time: 10.865374326705933
Epoch: 14, Steps: 208 | Train Loss: 1.387 Vali Loss: 5.578 Vali Acc: 0.115 Test Loss: 5.578 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4696492
	speed: 0.1605s/iter; left time: 2854.8051s
	iters: 200, epoch: 15 | loss: 1.8762549
	speed: 0.0499s/iter; left time: 882.0667s
Epoch: 15 cost time: 10.587558507919312
Epoch: 15, Steps: 208 | Train Loss: 1.260 Vali Loss: 5.675 Vali Acc: 0.121 Test Loss: 5.675 Test Acc: 0.121
Validation loss decreased (-0.118352 --> -0.121029).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3392421
	speed: 0.1623s/iter; left time: 2853.6013s
	iters: 200, epoch: 16 | loss: 1.2982363
	speed: 0.0425s/iter; left time: 743.2835s
Epoch: 16 cost time: 9.365633964538574
Epoch: 16, Steps: 208 | Train Loss: 1.138 Vali Loss: 5.987 Vali Acc: 0.119 Test Loss: 5.987 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8373597
	speed: 0.1458s/iter; left time: 2533.8400s
	iters: 200, epoch: 17 | loss: 1.4388933
	speed: 0.0403s/iter; left time: 695.5409s
Epoch: 17 cost time: 8.574166774749756
Epoch: 17, Steps: 208 | Train Loss: 1.009 Vali Loss: 6.338 Vali Acc: 0.119 Test Loss: 6.338 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5649390
	speed: 0.1411s/iter; left time: 2421.1761s
	iters: 200, epoch: 18 | loss: 1.8823136
	speed: 0.0368s/iter; left time: 628.7881s
Epoch: 18 cost time: 8.1367347240448
Epoch: 18, Steps: 208 | Train Loss: 0.935 Vali Loss: 6.734 Vali Acc: 0.116 Test Loss: 6.734 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.5428194
	speed: 0.1445s/iter; left time: 2450.1066s
	iters: 200, epoch: 19 | loss: 0.9280661
	speed: 0.0382s/iter; left time: 643.1187s
Epoch: 19 cost time: 8.604620933532715
Epoch: 19, Steps: 208 | Train Loss: 0.848 Vali Loss: 6.964 Vali Acc: 0.123 Test Loss: 6.964 Test Acc: 0.123
Validation loss decreased (-0.121029 --> -0.123402).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5976086
	speed: 0.1448s/iter; left time: 2424.4629s
	iters: 200, epoch: 20 | loss: 1.0071610
	speed: 0.0410s/iter; left time: 682.5546s
Epoch: 20 cost time: 8.91919755935669
Epoch: 20, Steps: 208 | Train Loss: 0.765 Vali Loss: 7.199 Vali Acc: 0.107 Test Loss: 7.199 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8607376
	speed: 0.1478s/iter; left time: 2444.2209s
	iters: 200, epoch: 21 | loss: 0.6115465
	speed: 0.0392s/iter; left time: 644.7453s
Epoch: 21 cost time: 8.826677799224854
Epoch: 21, Steps: 208 | Train Loss: 0.682 Vali Loss: 7.647 Vali Acc: 0.118 Test Loss: 7.647 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2552128
	speed: 0.1438s/iter; left time: 2348.9201s
	iters: 200, epoch: 22 | loss: 1.2204702
	speed: 0.0365s/iter; left time: 592.9389s
Epoch: 22 cost time: 8.258919954299927
Epoch: 22, Steps: 208 | Train Loss: 0.636 Vali Loss: 7.919 Vali Acc: 0.119 Test Loss: 7.919 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.6610039
	speed: 0.1310s/iter; left time: 2111.8498s
	iters: 200, epoch: 23 | loss: 0.4174296
	speed: 0.0351s/iter; left time: 562.0322s
Epoch: 23 cost time: 7.82618260383606
Epoch: 23, Steps: 208 | Train Loss: 0.585 Vali Loss: 8.364 Vali Acc: 0.112 Test Loss: 8.364 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.5985929
	speed: 0.1412s/iter; left time: 2247.9142s
	iters: 200, epoch: 24 | loss: 0.6474577
	speed: 0.0355s/iter; left time: 562.0485s
Epoch: 24 cost time: 7.846632242202759
Epoch: 24, Steps: 208 | Train Loss: 0.549 Vali Loss: 8.664 Vali Acc: 0.118 Test Loss: 8.664 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0411531
	speed: 0.1447s/iter; left time: 2272.9008s
	iters: 200, epoch: 25 | loss: 0.5475355
	speed: 0.0360s/iter; left time: 561.3969s
Epoch: 25 cost time: 7.9102137088775635
Epoch: 25, Steps: 208 | Train Loss: 0.517 Vali Loss: 8.880 Vali Acc: 0.112 Test Loss: 8.880 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.7058563
	speed: 0.1378s/iter; left time: 2136.6192s
	iters: 200, epoch: 26 | loss: 0.4644620
	speed: 0.0350s/iter; left time: 539.6928s
Epoch: 26 cost time: 7.802868843078613
Epoch: 26, Steps: 208 | Train Loss: 0.515 Vali Loss: 9.289 Vali Acc: 0.118 Test Loss: 9.289 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.2274273
	speed: 0.1396s/iter; left time: 2135.4081s
	iters: 200, epoch: 27 | loss: 0.3753720
	speed: 0.0359s/iter; left time: 545.4121s
Epoch: 27 cost time: 7.714559316635132
Epoch: 27, Steps: 208 | Train Loss: 0.464 Vali Loss: 9.367 Vali Acc: 0.120 Test Loss: 9.367 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2036485
	speed: 0.1351s/iter; left time: 2038.0878s
	iters: 200, epoch: 28 | loss: 0.2315517
	speed: 0.0343s/iter; left time: 513.7028s
Epoch: 28 cost time: 7.555474758148193
Epoch: 28, Steps: 208 | Train Loss: 0.415 Vali Loss: 9.781 Vali Acc: 0.109 Test Loss: 9.781 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.2364859
	speed: 0.1362s/iter; left time: 2026.8197s
	iters: 200, epoch: 29 | loss: 0.1708259
	speed: 0.0337s/iter; left time: 497.8060s
Epoch: 29 cost time: 7.780932188034058
Epoch: 29, Steps: 208 | Train Loss: 0.382 Vali Loss: 10.090 Vali Acc: 0.117 Test Loss: 10.090 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1234715180435431
model parameter : 204007
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4902501
	speed: 0.0574s/iter; left time: 1188.0100s
	iters: 200, epoch: 1 | loss: 3.6655657
	speed: 0.0400s/iter; left time: 823.8352s
Epoch: 1 cost time: 10.123096942901611
Epoch: 1, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.763 Vali Acc: 0.050 Test Loss: 3.763 Test Acc: 0.050
Validation loss decreased (inf --> -0.050365).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8227687
	speed: 0.1427s/iter; left time: 2925.3113s
	iters: 200, epoch: 2 | loss: 3.2033882
	speed: 0.0396s/iter; left time: 807.3822s
Epoch: 2 cost time: 8.709483861923218
Epoch: 2, Steps: 208 | Train Loss: 3.547 Vali Loss: 3.723 Vali Acc: 0.071 Test Loss: 3.723 Test Acc: 0.071
Validation loss decreased (-0.050365 --> -0.070944).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2340465
	speed: 0.1426s/iter; left time: 2893.4745s
	iters: 200, epoch: 3 | loss: 3.4367492
	speed: 0.0400s/iter; left time: 806.3965s
Epoch: 3 cost time: 8.774038553237915
Epoch: 3, Steps: 208 | Train Loss: 3.266 Vali Loss: 3.760 Vali Acc: 0.070 Test Loss: 3.760 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3609581
	speed: 0.1381s/iter; left time: 2771.9947s
	iters: 200, epoch: 4 | loss: 3.2767985
	speed: 0.0379s/iter; left time: 757.3669s
Epoch: 4 cost time: 8.44995927810669
Epoch: 4, Steps: 208 | Train Loss: 3.087 Vali Loss: 3.775 Vali Acc: 0.081 Test Loss: 3.775 Test Acc: 0.081
Validation loss decreased (-0.070944 --> -0.081382).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0285614
	speed: 0.1421s/iter; left time: 2822.4368s
	iters: 200, epoch: 5 | loss: 3.7709248
	speed: 0.0390s/iter; left time: 770.8614s
Epoch: 5 cost time: 8.58695912361145
Epoch: 5, Steps: 208 | Train Loss: 2.927 Vali Loss: 4.006 Vali Acc: 0.099 Test Loss: 4.006 Test Acc: 0.099
Validation loss decreased (-0.081382 --> -0.099274).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7732928
	speed: 0.1416s/iter; left time: 2784.7501s
	iters: 200, epoch: 6 | loss: 2.5559397
	speed: 0.0395s/iter; left time: 772.0515s
Epoch: 6 cost time: 8.587453365325928
Epoch: 6, Steps: 208 | Train Loss: 2.784 Vali Loss: 3.982 Vali Acc: 0.095 Test Loss: 3.982 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4813087
	speed: 0.1472s/iter; left time: 2862.9500s
	iters: 200, epoch: 7 | loss: 2.6801209
	speed: 0.0382s/iter; left time: 738.7060s
Epoch: 7 cost time: 8.35584306716919
Epoch: 7, Steps: 208 | Train Loss: 2.653 Vali Loss: 4.021 Vali Acc: 0.089 Test Loss: 4.021 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.9426379
	speed: 0.1405s/iter; left time: 2703.3759s
	iters: 200, epoch: 8 | loss: 3.2825682
	speed: 0.0381s/iter; left time: 729.2101s
Epoch: 8 cost time: 8.289148330688477
Epoch: 8, Steps: 208 | Train Loss: 2.517 Vali Loss: 4.185 Vali Acc: 0.096 Test Loss: 4.185 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3306608
	speed: 0.1448s/iter; left time: 2756.3310s
	iters: 200, epoch: 9 | loss: 2.9834788
	speed: 0.0395s/iter; left time: 748.9100s
Epoch: 9 cost time: 8.466763019561768
Epoch: 9, Steps: 208 | Train Loss: 2.366 Vali Loss: 4.211 Vali Acc: 0.106 Test Loss: 4.211 Test Acc: 0.106
Validation loss decreased (-0.099274 --> -0.106430).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0176082
	speed: 0.1416s/iter; left time: 2665.6820s
	iters: 200, epoch: 10 | loss: 2.3537529
	speed: 0.0340s/iter; left time: 637.1551s
Epoch: 10 cost time: 7.556505918502808
Epoch: 10, Steps: 208 | Train Loss: 2.209 Vali Loss: 4.443 Vali Acc: 0.093 Test Loss: 4.443 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1920359
	speed: 0.1378s/iter; left time: 2566.8630s
	iters: 200, epoch: 11 | loss: 2.5873265
	speed: 0.0302s/iter; left time: 559.7985s
Epoch: 11 cost time: 6.85567307472229
Epoch: 11, Steps: 208 | Train Loss: 2.079 Vali Loss: 4.468 Vali Acc: 0.101 Test Loss: 4.468 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8768803
	speed: 0.1288s/iter; left time: 2371.3969s
	iters: 200, epoch: 12 | loss: 2.0542147
	speed: 0.0337s/iter; left time: 617.1376s
Epoch: 12 cost time: 7.3393402099609375
Epoch: 12, Steps: 208 | Train Loss: 1.913 Vali Loss: 4.726 Vali Acc: 0.102 Test Loss: 4.726 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3090750
	speed: 0.1278s/iter; left time: 2326.7471s
	iters: 200, epoch: 13 | loss: 1.8428150
	speed: 0.0303s/iter; left time: 549.2033s
Epoch: 13 cost time: 7.23362398147583
Epoch: 13, Steps: 208 | Train Loss: 1.745 Vali Loss: 4.757 Vali Acc: 0.104 Test Loss: 4.757 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3054818
	speed: 0.1346s/iter; left time: 2422.2765s
	iters: 200, epoch: 14 | loss: 1.9401999
	speed: 0.0358s/iter; left time: 639.8700s
Epoch: 14 cost time: 7.858562707901001
Epoch: 14, Steps: 208 | Train Loss: 1.616 Vali Loss: 4.978 Vali Acc: 0.105 Test Loss: 4.978 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4126709
	speed: 0.1387s/iter; left time: 2467.0510s
	iters: 200, epoch: 15 | loss: 1.8941675
	speed: 0.0337s/iter; left time: 596.1534s
Epoch: 15 cost time: 7.501904010772705
Epoch: 15, Steps: 208 | Train Loss: 1.488 Vali Loss: 5.284 Vali Acc: 0.110 Test Loss: 5.284 Test Acc: 0.110
Validation loss decreased (-0.106430 --> -0.109700).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6059883
	speed: 0.1297s/iter; left time: 2279.6417s
	iters: 200, epoch: 16 | loss: 1.2131060
	speed: 0.0333s/iter; left time: 582.8085s
Epoch: 16 cost time: 7.35860013961792
Epoch: 16, Steps: 208 | Train Loss: 1.345 Vali Loss: 5.600 Vali Acc: 0.110 Test Loss: 5.600 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1779829
	speed: 0.1389s/iter; left time: 2412.9084s
	iters: 200, epoch: 17 | loss: 0.9406478
	speed: 0.0385s/iter; left time: 664.3343s
Epoch: 17 cost time: 8.42528486251831
Epoch: 17, Steps: 208 | Train Loss: 1.226 Vali Loss: 5.931 Vali Acc: 0.109 Test Loss: 5.931 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.1223209
	speed: 0.1378s/iter; left time: 2365.5849s
	iters: 200, epoch: 18 | loss: 1.5748461
	speed: 0.0391s/iter; left time: 667.6582s
Epoch: 18 cost time: 8.555720806121826
Epoch: 18, Steps: 208 | Train Loss: 1.116 Vali Loss: 6.307 Vali Acc: 0.112 Test Loss: 6.307 Test Acc: 0.112
Validation loss decreased (-0.109700 --> -0.111479).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.8050586
	speed: 0.1464s/iter; left time: 2482.0084s
	iters: 200, epoch: 19 | loss: 1.2076969
	speed: 0.0377s/iter; left time: 635.8141s
Epoch: 19 cost time: 8.375616788864136
Epoch: 19, Steps: 208 | Train Loss: 1.036 Vali Loss: 6.535 Vali Acc: 0.109 Test Loss: 6.535 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7728621
	speed: 0.1409s/iter; left time: 2360.0992s
	iters: 200, epoch: 20 | loss: 0.8653690
	speed: 0.0388s/iter; left time: 645.8669s
Epoch: 20 cost time: 8.590426206588745
Epoch: 20, Steps: 208 | Train Loss: 0.945 Vali Loss: 6.732 Vali Acc: 0.106 Test Loss: 6.732 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.7974662
	speed: 0.1421s/iter; left time: 2350.9016s
	iters: 200, epoch: 21 | loss: 1.2222164
	speed: 0.0400s/iter; left time: 658.1808s
Epoch: 21 cost time: 8.665371417999268
Epoch: 21, Steps: 208 | Train Loss: 0.841 Vali Loss: 7.036 Vali Acc: 0.106 Test Loss: 7.036 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.3442624
	speed: 0.1399s/iter; left time: 2284.5174s
	iters: 200, epoch: 22 | loss: 0.9836487
	speed: 0.0388s/iter; left time: 630.0054s
Epoch: 22 cost time: 8.587523937225342
Epoch: 22, Steps: 208 | Train Loss: 0.808 Vali Loss: 7.227 Vali Acc: 0.115 Test Loss: 7.227 Test Acc: 0.115
Validation loss decreased (-0.111479 --> -0.114452).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.3883603
	speed: 0.1365s/iter; left time: 2201.2282s
	iters: 200, epoch: 23 | loss: 0.8216295
	speed: 0.0390s/iter; left time: 624.8668s
Epoch: 23 cost time: 8.608384370803833
Epoch: 23, Steps: 208 | Train Loss: 0.713 Vali Loss: 7.721 Vali Acc: 0.106 Test Loss: 7.721 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.3123426
	speed: 0.1356s/iter; left time: 2158.4908s
	iters: 200, epoch: 24 | loss: 0.3953768
	speed: 0.0380s/iter; left time: 601.1127s
Epoch: 24 cost time: 8.27047348022461
Epoch: 24, Steps: 208 | Train Loss: 0.681 Vali Loss: 8.011 Vali Acc: 0.098 Test Loss: 8.011 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.8623245
	speed: 0.1348s/iter; left time: 2117.3344s
	iters: 200, epoch: 25 | loss: 0.5110332
	speed: 0.0383s/iter; left time: 597.8143s
Epoch: 25 cost time: 8.26181936264038
Epoch: 25, Steps: 208 | Train Loss: 0.592 Vali Loss: 8.328 Vali Acc: 0.110 Test Loss: 8.328 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.0926338
	speed: 0.1513s/iter; left time: 2345.9538s
	iters: 200, epoch: 26 | loss: 0.6680107
	speed: 0.0385s/iter; left time: 593.4785s
Epoch: 26 cost time: 8.58769702911377
Epoch: 26, Steps: 208 | Train Loss: 0.574 Vali Loss: 8.717 Vali Acc: 0.107 Test Loss: 8.717 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.4026295
	speed: 0.1452s/iter; left time: 2220.4997s
	iters: 200, epoch: 27 | loss: 0.7900496
	speed: 0.0384s/iter; left time: 583.7377s
Epoch: 27 cost time: 8.548853158950806
Epoch: 27, Steps: 208 | Train Loss: 0.549 Vali Loss: 8.829 Vali Acc: 0.102 Test Loss: 8.829 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.2948498
	speed: 0.1392s/iter; left time: 2100.4859s
	iters: 200, epoch: 28 | loss: 1.1205921
	speed: 0.0337s/iter; left time: 504.4871s
Epoch: 28 cost time: 7.642948150634766
Epoch: 28, Steps: 208 | Train Loss: 0.506 Vali Loss: 9.264 Vali Acc: 0.100 Test Loss: 9.264 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.4035946
	speed: 0.1413s/iter; left time: 2102.4607s
	iters: 200, epoch: 29 | loss: 0.8598074
	speed: 0.0329s/iter; left time: 486.1125s
Epoch: 29 cost time: 7.5517897605896
Epoch: 29, Steps: 208 | Train Loss: 0.495 Vali Loss: 9.437 Vali Acc: 0.106 Test Loss: 9.437 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.5633910
	speed: 0.1375s/iter; left time: 2017.0632s
	iters: 200, epoch: 30 | loss: 1.1212655
	speed: 0.0332s/iter; left time: 483.4938s
Epoch: 30 cost time: 7.590692043304443
Epoch: 30, Steps: 208 | Train Loss: 0.432 Vali Loss: 9.739 Vali Acc: 0.101 Test Loss: 9.739 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.1494773
	speed: 0.1398s/iter; left time: 2021.5735s
	iters: 200, epoch: 31 | loss: 1.0156500
	speed: 0.0337s/iter; left time: 484.0505s
Epoch: 31 cost time: 7.392810583114624
Epoch: 31, Steps: 208 | Train Loss: 0.450 Vali Loss: 9.920 Vali Acc: 0.106 Test Loss: 9.920 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0358346
	speed: 0.1386s/iter; left time: 1975.8355s
	iters: 200, epoch: 32 | loss: 0.8083735
	speed: 0.0355s/iter; left time: 502.6340s
Epoch: 32 cost time: 7.736770391464233
Epoch: 32, Steps: 208 | Train Loss: 0.416 Vali Loss: 10.119 Vali Acc: 0.106 Test Loss: 10.119 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11452430659111244
model parameter : 163175
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7115464
	speed: 0.0522s/iter; left time: 1079.9730s
	iters: 200, epoch: 1 | loss: 3.8968618
	speed: 0.0358s/iter; left time: 737.6246s
Epoch: 1 cost time: 9.060241937637329
Epoch: 1, Steps: 208 | Train Loss: 3.768 Vali Loss: 3.709 Vali Acc: 0.061 Test Loss: 3.709 Test Acc: 0.061
Validation loss decreased (inf --> -0.061400).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3157480
	speed: 0.1303s/iter; left time: 2669.4875s
	iters: 200, epoch: 2 | loss: 3.9566140
	speed: 0.0383s/iter; left time: 781.4258s
Epoch: 2 cost time: 8.350724697113037
Epoch: 2, Steps: 208 | Train Loss: 3.573 Vali Loss: 3.737 Vali Acc: 0.067 Test Loss: 3.737 Test Acc: 0.067
Validation loss decreased (-0.061400 --> -0.066768).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1752555
	speed: 0.1422s/iter; left time: 2883.8293s
	iters: 200, epoch: 3 | loss: 3.3552835
	speed: 0.0382s/iter; left time: 770.9648s
Epoch: 3 cost time: 8.48238754272461
Epoch: 3, Steps: 208 | Train Loss: 3.337 Vali Loss: 3.768 Vali Acc: 0.077 Test Loss: 3.768 Test Acc: 0.077
Validation loss decreased (-0.066768 --> -0.076908).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9035325
	speed: 0.1435s/iter; left time: 2880.5111s
	iters: 200, epoch: 4 | loss: 3.3680344
	speed: 0.0399s/iter; left time: 797.9531s
Epoch: 4 cost time: 8.927960634231567
Epoch: 4, Steps: 208 | Train Loss: 3.140 Vali Loss: 3.884 Vali Acc: 0.078 Test Loss: 3.884 Test Acc: 0.078
Validation loss decreased (-0.076908 --> -0.078398).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8694403
	speed: 0.1478s/iter; left time: 2937.1618s
	iters: 200, epoch: 5 | loss: 3.6360908
	speed: 0.0392s/iter; left time: 774.2368s
Epoch: 5 cost time: 8.826416254043579
Epoch: 5, Steps: 208 | Train Loss: 3.034 Vali Loss: 3.956 Vali Acc: 0.083 Test Loss: 3.956 Test Acc: 0.083
Validation loss decreased (-0.078398 --> -0.083170).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9515638
	speed: 0.1420s/iter; left time: 2791.8340s
	iters: 200, epoch: 6 | loss: 3.0542800
	speed: 0.0391s/iter; left time: 764.0787s
Epoch: 6 cost time: 8.600003242492676
Epoch: 6, Steps: 208 | Train Loss: 2.875 Vali Loss: 3.843 Vali Acc: 0.095 Test Loss: 3.843 Test Acc: 0.095
Validation loss decreased (-0.083170 --> -0.094802).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2248850
	speed: 0.1361s/iter; left time: 2648.3682s
	iters: 200, epoch: 7 | loss: 3.5366952
	speed: 0.0412s/iter; left time: 796.9806s
Epoch: 7 cost time: 8.911112785339355
Epoch: 7, Steps: 208 | Train Loss: 2.699 Vali Loss: 4.078 Vali Acc: 0.101 Test Loss: 4.078 Test Acc: 0.101
Validation loss decreased (-0.094802 --> -0.101063).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0217981
	speed: 0.1369s/iter; left time: 2635.2888s
	iters: 200, epoch: 8 | loss: 2.9259098
	speed: 0.0387s/iter; left time: 740.5957s
Epoch: 8 cost time: 8.630852699279785
Epoch: 8, Steps: 208 | Train Loss: 2.585 Vali Loss: 3.968 Vali Acc: 0.105 Test Loss: 3.968 Test Acc: 0.105
Validation loss decreased (-0.101063 --> -0.104643).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6371448
	speed: 0.1368s/iter; left time: 2603.4341s
	iters: 200, epoch: 9 | loss: 2.4262486
	speed: 0.0370s/iter; left time: 700.2030s
Epoch: 9 cost time: 8.475863933563232
Epoch: 9, Steps: 208 | Train Loss: 2.425 Vali Loss: 4.238 Vali Acc: 0.107 Test Loss: 4.238 Test Acc: 0.107
Validation loss decreased (-0.104643 --> -0.107324).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7599285
	speed: 0.1409s/iter; left time: 2652.4249s
	iters: 200, epoch: 10 | loss: 2.1464715
	speed: 0.0392s/iter; left time: 733.4110s
Epoch: 10 cost time: 8.551050186157227
Epoch: 10, Steps: 208 | Train Loss: 2.289 Vali Loss: 4.278 Vali Acc: 0.116 Test Loss: 4.278 Test Acc: 0.116
Validation loss decreased (-0.107324 --> -0.115674).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5953550
	speed: 0.1376s/iter; left time: 2562.6620s
	iters: 200, epoch: 11 | loss: 3.2775919
	speed: 0.0383s/iter; left time: 709.5255s
Epoch: 11 cost time: 8.595311164855957
Epoch: 11, Steps: 208 | Train Loss: 2.137 Vali Loss: 4.313 Vali Acc: 0.113 Test Loss: 4.313 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9009188
	speed: 0.1406s/iter; left time: 2588.7791s
	iters: 200, epoch: 12 | loss: 1.9369732
	speed: 0.0367s/iter; left time: 672.9073s
Epoch: 12 cost time: 8.308254957199097
Epoch: 12, Steps: 208 | Train Loss: 1.970 Vali Loss: 4.624 Vali Acc: 0.107 Test Loss: 4.624 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.2649238
	speed: 0.1271s/iter; left time: 2314.2698s
	iters: 200, epoch: 13 | loss: 1.8801351
	speed: 0.0318s/iter; left time: 576.2929s
Epoch: 13 cost time: 7.20023250579834
Epoch: 13, Steps: 208 | Train Loss: 1.827 Vali Loss: 4.813 Vali Acc: 0.112 Test Loss: 4.813 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6241553
	speed: 0.1334s/iter; left time: 2400.6280s
	iters: 200, epoch: 14 | loss: 2.3258228
	speed: 0.0329s/iter; left time: 588.5148s
Epoch: 14 cost time: 7.371246814727783
Epoch: 14, Steps: 208 | Train Loss: 1.664 Vali Loss: 5.039 Vali Acc: 0.114 Test Loss: 5.039 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4757971
	speed: 0.1314s/iter; left time: 2337.3906s
	iters: 200, epoch: 15 | loss: 1.2686913
	speed: 0.0326s/iter; left time: 576.4147s
Epoch: 15 cost time: 7.540278911590576
Epoch: 15, Steps: 208 | Train Loss: 1.532 Vali Loss: 5.217 Vali Acc: 0.117 Test Loss: 5.217 Test Acc: 0.117
Validation loss decreased (-0.115674 --> -0.117156).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5356830
	speed: 0.1244s/iter; left time: 2186.2835s
	iters: 200, epoch: 16 | loss: 1.8198127
	speed: 0.0324s/iter; left time: 565.9253s
Epoch: 16 cost time: 6.970853090286255
Epoch: 16, Steps: 208 | Train Loss: 1.393 Vali Loss: 5.608 Vali Acc: 0.112 Test Loss: 5.608 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.6250032
	speed: 0.1215s/iter; left time: 2110.6977s
	iters: 200, epoch: 17 | loss: 1.6525658
	speed: 0.0296s/iter; left time: 510.5567s
Epoch: 17 cost time: 6.740677118301392
Epoch: 17, Steps: 208 | Train Loss: 1.266 Vali Loss: 5.750 Vali Acc: 0.114 Test Loss: 5.750 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5878046
	speed: 0.1291s/iter; left time: 2216.4344s
	iters: 200, epoch: 18 | loss: 1.4715796
	speed: 0.0387s/iter; left time: 660.8987s
Epoch: 18 cost time: 8.183972597122192
Epoch: 18, Steps: 208 | Train Loss: 1.142 Vali Loss: 6.084 Vali Acc: 0.113 Test Loss: 6.084 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6374460
	speed: 0.1321s/iter; left time: 2239.9897s
	iters: 200, epoch: 19 | loss: 1.2207944
	speed: 0.0347s/iter; left time: 584.6677s
Epoch: 19 cost time: 7.5922629833221436
Epoch: 19, Steps: 208 | Train Loss: 1.045 Vali Loss: 6.466 Vali Acc: 0.117 Test Loss: 6.466 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9571984
	speed: 0.1258s/iter; left time: 2107.5236s
	iters: 200, epoch: 20 | loss: 1.2668219
	speed: 0.0346s/iter; left time: 576.3850s
Epoch: 20 cost time: 7.669784069061279
Epoch: 20, Steps: 208 | Train Loss: 0.928 Vali Loss: 6.885 Vali Acc: 0.118 Test Loss: 6.885 Test Acc: 0.118
Validation loss decreased (-0.117156 --> -0.117438).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4288943
	speed: 0.1365s/iter; left time: 2257.2660s
	iters: 200, epoch: 21 | loss: 1.0390868
	speed: 0.0368s/iter; left time: 605.1369s
Epoch: 21 cost time: 8.367001056671143
Epoch: 21, Steps: 208 | Train Loss: 0.870 Vali Loss: 6.953 Vali Acc: 0.117 Test Loss: 6.953 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5993126
	speed: 0.1402s/iter; left time: 2290.5750s
	iters: 200, epoch: 22 | loss: 0.8806310
	speed: 0.0381s/iter; left time: 618.4389s
Epoch: 22 cost time: 8.477315187454224
Epoch: 22, Steps: 208 | Train Loss: 0.814 Vali Loss: 7.225 Vali Acc: 0.120 Test Loss: 7.225 Test Acc: 0.120
Validation loss decreased (-0.117438 --> -0.120417).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.4690881
	speed: 0.1029s/iter; left time: 1659.6792s
	iters: 200, epoch: 23 | loss: 0.3712048
	speed: 0.0224s/iter; left time: 359.6614s
Epoch: 23 cost time: 4.908393621444702
Epoch: 23, Steps: 208 | Train Loss: 0.731 Vali Loss: 7.555 Vali Acc: 0.118 Test Loss: 7.555 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.6463838
	speed: 0.0912s/iter; left time: 1451.0102s
	iters: 200, epoch: 24 | loss: 1.0943696
	speed: 0.0217s/iter; left time: 342.8350s
Epoch: 24 cost time: 5.208836793899536
Epoch: 24, Steps: 208 | Train Loss: 0.667 Vali Loss: 7.886 Vali Acc: 0.117 Test Loss: 7.886 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.5579990
	speed: 0.1193s/iter; left time: 1874.3854s
	iters: 200, epoch: 25 | loss: 0.4457163
	speed: 0.0392s/iter; left time: 611.1574s
Epoch: 25 cost time: 8.497841835021973
Epoch: 25, Steps: 208 | Train Loss: 0.639 Vali Loss: 8.201 Vali Acc: 0.118 Test Loss: 8.201 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.7701670
	speed: 0.1363s/iter; left time: 2112.4362s
	iters: 200, epoch: 26 | loss: 1.1897342
	speed: 0.0402s/iter; left time: 619.1233s
Epoch: 26 cost time: 8.803174018859863
Epoch: 26, Steps: 208 | Train Loss: 0.598 Vali Loss: 8.501 Vali Acc: 0.109 Test Loss: 8.501 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.4853925
	speed: 0.1376s/iter; left time: 2104.0891s
	iters: 200, epoch: 27 | loss: 1.5549837
	speed: 0.0403s/iter; left time: 612.2551s
Epoch: 27 cost time: 8.908538818359375
Epoch: 27, Steps: 208 | Train Loss: 0.557 Vali Loss: 8.656 Vali Acc: 0.114 Test Loss: 8.656 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.4250548
	speed: 0.1358s/iter; left time: 2048.6526s
	iters: 200, epoch: 28 | loss: 0.3533037
	speed: 0.0400s/iter; left time: 599.8770s
Epoch: 28 cost time: 8.7541184425354
Epoch: 28, Steps: 208 | Train Loss: 0.510 Vali Loss: 9.074 Vali Acc: 0.117 Test Loss: 9.074 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.5289419
	speed: 0.1329s/iter; left time: 1976.8339s
	iters: 200, epoch: 29 | loss: 0.4768694
	speed: 0.0392s/iter; left time: 578.7731s
Epoch: 29 cost time: 8.27329134941101
Epoch: 29, Steps: 208 | Train Loss: 0.495 Vali Loss: 9.415 Vali Acc: 0.105 Test Loss: 9.415 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.1951219
	speed: 0.1408s/iter; left time: 2065.5364s
	iters: 200, epoch: 30 | loss: 0.3429051
	speed: 0.0373s/iter; left time: 543.5845s
Epoch: 30 cost time: 8.360223293304443
Epoch: 30, Steps: 208 | Train Loss: 0.463 Vali Loss: 9.522 Vali Acc: 0.114 Test Loss: 9.522 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.2932155
	speed: 0.1423s/iter; left time: 2058.3228s
	iters: 200, epoch: 31 | loss: 1.1325320
	speed: 0.0376s/iter; left time: 540.5161s
Epoch: 31 cost time: 8.510902404785156
Epoch: 31, Steps: 208 | Train Loss: 0.448 Vali Loss: 9.840 Vali Acc: 0.121 Test Loss: 9.840 Test Acc: 0.121
Validation loss decreased (-0.120417 --> -0.121285).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.3808229
	speed: 0.1401s/iter; left time: 1997.5121s
	iters: 200, epoch: 32 | loss: 1.1616051
	speed: 0.0385s/iter; left time: 545.3490s
Epoch: 32 cost time: 8.464539527893066
Epoch: 32, Steps: 208 | Train Loss: 0.437 Vali Loss: 9.855 Vali Acc: 0.107 Test Loss: 9.855 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.3485820
	speed: 0.1368s/iter; left time: 1921.9877s
	iters: 200, epoch: 33 | loss: 0.1339279
	speed: 0.0390s/iter; left time: 543.8421s
Epoch: 33 cost time: 8.393717050552368
Epoch: 33, Steps: 208 | Train Loss: 0.418 Vali Loss: 10.124 Vali Acc: 0.115 Test Loss: 10.124 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.5419428
	speed: 0.1344s/iter; left time: 1860.2271s
	iters: 200, epoch: 34 | loss: 0.1113546
	speed: 0.0383s/iter; left time: 525.9757s
Epoch: 34 cost time: 8.190059661865234
Epoch: 34, Steps: 208 | Train Loss: 0.395 Vali Loss: 10.592 Vali Acc: 0.109 Test Loss: 10.592 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.4314561
	speed: 0.1252s/iter; left time: 1706.3806s
	iters: 200, epoch: 35 | loss: 0.1511595
	speed: 0.0276s/iter; left time: 372.8909s
Epoch: 35 cost time: 6.32456636428833
Epoch: 35, Steps: 208 | Train Loss: 0.393 Vali Loss: 10.802 Vali Acc: 0.104 Test Loss: 10.802 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.6892837
	speed: 0.1314s/iter; left time: 1762.9356s
	iters: 200, epoch: 36 | loss: 0.3553073
	speed: 0.0274s/iter; left time: 364.8166s
Epoch: 36 cost time: 6.572065591812134
Epoch: 36, Steps: 208 | Train Loss: 0.362 Vali Loss: 10.932 Vali Acc: 0.111 Test Loss: 10.932 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.4330245
	speed: 0.1228s/iter; left time: 1622.2138s
	iters: 200, epoch: 37 | loss: 0.4790920
	speed: 0.0303s/iter; left time: 397.2523s
Epoch: 37 cost time: 6.616718053817749
Epoch: 37, Steps: 208 | Train Loss: 0.364 Vali Loss: 11.080 Vali Acc: 0.104 Test Loss: 11.080 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0673944
	speed: 0.1321s/iter; left time: 1717.3398s
	iters: 200, epoch: 38 | loss: 0.2978469
	speed: 0.0331s/iter; left time: 426.8688s
Epoch: 38 cost time: 7.291469573974609
Epoch: 38, Steps: 208 | Train Loss: 0.376 Vali Loss: 11.365 Vali Acc: 0.105 Test Loss: 11.365 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.2257251
	speed: 0.1258s/iter; left time: 1610.3448s
	iters: 200, epoch: 39 | loss: 0.6226699
	speed: 0.0296s/iter; left time: 376.3039s
Epoch: 39 cost time: 6.85430121421814
Epoch: 39, Steps: 208 | Train Loss: 0.349 Vali Loss: 11.633 Vali Acc: 0.112 Test Loss: 11.633 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.1362918
	speed: 0.1247s/iter; left time: 1569.3927s
	iters: 200, epoch: 40 | loss: 0.6677041
	speed: 0.0395s/iter; left time: 493.8498s
Epoch: 40 cost time: 8.358647584915161
Epoch: 40, Steps: 208 | Train Loss: 0.319 Vali Loss: 11.772 Vali Acc: 0.105 Test Loss: 11.772 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0395392
	speed: 0.1364s/iter; left time: 1688.1674s
	iters: 200, epoch: 41 | loss: 0.2491914
	speed: 0.0375s/iter; left time: 460.3255s
Epoch: 41 cost time: 8.230817079544067
Epoch: 41, Steps: 208 | Train Loss: 0.334 Vali Loss: 12.032 Vali Acc: 0.100 Test Loss: 12.032 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12138383537130927
model parameter : 136071
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1879659
	speed: 0.1143s/iter; left time: 2367.0505s
	iters: 200, epoch: 1 | loss: 4.5034089
	speed: 0.0935s/iter; left time: 1926.8856s
Epoch: 1 cost time: 21.636298418045044
Epoch: 1, Steps: 208 | Train Loss: 4.466 Vali Loss: 4.362 Vali Acc: 0.055 Test Loss: 4.362 Test Acc: 0.055
Validation loss decreased (inf --> -0.055131).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2549348
	speed: 0.2258s/iter; left time: 4626.6314s
	iters: 200, epoch: 2 | loss: 3.9542503
	speed: 0.1009s/iter; left time: 2057.3509s
Epoch: 2 cost time: 20.251319646835327
Epoch: 2, Steps: 208 | Train Loss: 3.467 Vali Loss: 3.526 Vali Acc: 0.096 Test Loss: 3.526 Test Acc: 0.096
Validation loss decreased (-0.055131 --> -0.095700).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8042645
	speed: 0.2319s/iter; left time: 4704.6190s
	iters: 200, epoch: 3 | loss: 3.1070929
	speed: 0.0990s/iter; left time: 1998.1115s
Epoch: 3 cost time: 20.709775924682617
Epoch: 3, Steps: 208 | Train Loss: 3.398 Vali Loss: 4.028 Vali Acc: 0.081 Test Loss: 4.028 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6255188
	speed: 0.2077s/iter; left time: 4169.5723s
	iters: 200, epoch: 4 | loss: 4.0523915
	speed: 0.0949s/iter; left time: 1895.2726s
Epoch: 4 cost time: 18.7110378742218
Epoch: 4, Steps: 208 | Train Loss: 3.489 Vali Loss: 4.745 Vali Acc: 0.066 Test Loss: 4.745 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.1590862
	speed: 0.1857s/iter; left time: 3689.0515s
	iters: 200, epoch: 5 | loss: 3.7739241
	speed: 0.0673s/iter; left time: 1331.3226s
Epoch: 5 cost time: 13.725010633468628
Epoch: 5, Steps: 208 | Train Loss: 3.315 Vali Loss: 4.240 Vali Acc: 0.090 Test Loss: 4.240 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.6806991
	speed: 0.1801s/iter; left time: 3539.9813s
	iters: 200, epoch: 6 | loss: 3.1377234
	speed: 0.0576s/iter; left time: 1126.7546s
Epoch: 6 cost time: 12.625913143157959
Epoch: 6, Steps: 208 | Train Loss: 3.082 Vali Loss: 4.357 Vali Acc: 0.112 Test Loss: 4.357 Test Acc: 0.112
Validation loss decreased (-0.095700 --> -0.111498).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4956112
	speed: 0.1718s/iter; left time: 3342.2383s
	iters: 200, epoch: 7 | loss: 3.4584715
	speed: 0.0476s/iter; left time: 920.5015s
Epoch: 7 cost time: 11.267282724380493
Epoch: 7, Steps: 208 | Train Loss: 2.692 Vali Loss: 6.497 Vali Acc: 0.066 Test Loss: 6.497 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8508656
	speed: 0.1748s/iter; left time: 3364.5039s
	iters: 200, epoch: 8 | loss: 1.7882164
	speed: 0.0463s/iter; left time: 887.1712s
Epoch: 8 cost time: 10.960350513458252
Epoch: 8, Steps: 208 | Train Loss: 2.134 Vali Loss: 5.234 Vali Acc: 0.115 Test Loss: 5.234 Test Acc: 0.115
Validation loss decreased (-0.111498 --> -0.114472).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3205832
	speed: 0.2024s/iter; left time: 3852.6865s
	iters: 200, epoch: 9 | loss: 1.4732709
	speed: 0.0958s/iter; left time: 1813.5385s
Epoch: 9 cost time: 18.962068557739258
Epoch: 9, Steps: 208 | Train Loss: 1.708 Vali Loss: 4.894 Vali Acc: 0.104 Test Loss: 4.894 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4375403
	speed: 0.2291s/iter; left time: 4313.1673s
	iters: 200, epoch: 10 | loss: 1.4433751
	speed: 0.0914s/iter; left time: 1712.6812s
Epoch: 10 cost time: 19.809598445892334
Epoch: 10, Steps: 208 | Train Loss: 1.506 Vali Loss: 5.393 Vali Acc: 0.120 Test Loss: 5.393 Test Acc: 0.120
Validation loss decreased (-0.114472 --> -0.119540).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5097809
	speed: 0.2328s/iter; left time: 4335.2226s
	iters: 200, epoch: 11 | loss: 2.0035233
	speed: 0.0945s/iter; left time: 1749.6365s
Epoch: 11 cost time: 20.57800817489624
Epoch: 11, Steps: 208 | Train Loss: 1.331 Vali Loss: 6.120 Vali Acc: 0.115 Test Loss: 6.120 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5549988
	speed: 0.2363s/iter; left time: 4351.8525s
	iters: 200, epoch: 12 | loss: 1.4321845
	speed: 0.1053s/iter; left time: 1928.2878s
Epoch: 12 cost time: 21.896903038024902
Epoch: 12, Steps: 208 | Train Loss: 1.138 Vali Loss: 6.184 Vali Acc: 0.118 Test Loss: 6.184 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7370980
	speed: 0.2404s/iter; left time: 4376.5717s
	iters: 200, epoch: 13 | loss: 1.3475294
	speed: 0.0992s/iter; left time: 1796.6171s
Epoch: 13 cost time: 21.465553283691406
Epoch: 13, Steps: 208 | Train Loss: 0.961 Vali Loss: 6.729 Vali Acc: 0.122 Test Loss: 6.729 Test Acc: 0.122
Validation loss decreased (-0.119540 --> -0.121913).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9742647
	speed: 0.2354s/iter; left time: 4237.1486s
	iters: 200, epoch: 14 | loss: 0.6417750
	speed: 0.1015s/iter; left time: 1815.7535s
Epoch: 14 cost time: 21.00155234336853
Epoch: 14, Steps: 208 | Train Loss: 0.814 Vali Loss: 7.270 Vali Acc: 0.114 Test Loss: 7.270 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5742172
	speed: 0.1980s/iter; left time: 3521.8909s
	iters: 200, epoch: 15 | loss: 0.5729420
	speed: 0.0668s/iter; left time: 1182.4369s
Epoch: 15 cost time: 14.366146326065063
Epoch: 15, Steps: 208 | Train Loss: 0.670 Vali Loss: 7.721 Vali Acc: 0.112 Test Loss: 7.721 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8262063
	speed: 0.1797s/iter; left time: 3158.8575s
	iters: 200, epoch: 16 | loss: 0.5762200
	speed: 0.0564s/iter; left time: 986.2422s
Epoch: 16 cost time: 12.614135026931763
Epoch: 16, Steps: 208 | Train Loss: 0.555 Vali Loss: 8.362 Vali Acc: 0.116 Test Loss: 8.362 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2637505
	speed: 0.1586s/iter; left time: 2755.2174s
	iters: 200, epoch: 17 | loss: 0.5245118
	speed: 0.0460s/iter; left time: 794.0566s
Epoch: 17 cost time: 9.825783967971802
Epoch: 17, Steps: 208 | Train Loss: 0.485 Vali Loss: 8.734 Vali Acc: 0.112 Test Loss: 8.734 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4357570
	speed: 0.1739s/iter; left time: 2985.3879s
	iters: 200, epoch: 18 | loss: 0.2578375
	speed: 0.0523s/iter; left time: 891.7966s
Epoch: 18 cost time: 11.371275186538696
Epoch: 18, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.234 Vali Acc: 0.118 Test Loss: 9.234 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.5899382
	speed: 0.1751s/iter; left time: 2969.1499s
	iters: 200, epoch: 19 | loss: 0.4994634
	speed: 0.0934s/iter; left time: 1573.6817s
Epoch: 19 cost time: 16.10309648513794
Epoch: 19, Steps: 208 | Train Loss: 0.404 Vali Loss: 9.967 Vali Acc: 0.118 Test Loss: 9.967 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0435166
	speed: 0.2225s/iter; left time: 3726.6073s
	iters: 200, epoch: 20 | loss: 0.2039418
	speed: 0.0944s/iter; left time: 1572.1361s
Epoch: 20 cost time: 19.994126558303833
Epoch: 20, Steps: 208 | Train Loss: 0.289 Vali Loss: 10.545 Vali Acc: 0.113 Test Loss: 10.545 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.3788387
	speed: 0.2209s/iter; left time: 3654.6257s
	iters: 200, epoch: 21 | loss: 0.8099607
	speed: 0.0824s/iter; left time: 1354.1185s
Epoch: 21 cost time: 18.502352714538574
Epoch: 21, Steps: 208 | Train Loss: 0.250 Vali Loss: 10.737 Vali Acc: 0.111 Test Loss: 10.737 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2531594
	speed: 0.2230s/iter; left time: 3642.0432s
	iters: 200, epoch: 22 | loss: 0.2955805
	speed: 0.0964s/iter; left time: 1564.0598s
Epoch: 22 cost time: 20.08337140083313
Epoch: 22, Steps: 208 | Train Loss: 0.239 Vali Loss: 11.474 Vali Acc: 0.119 Test Loss: 11.474 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1057976
	speed: 0.2261s/iter; left time: 3646.2149s
	iters: 200, epoch: 23 | loss: 0.0503289
	speed: 0.0977s/iter; left time: 1565.4820s
Epoch: 23 cost time: 20.358214378356934
Epoch: 23, Steps: 208 | Train Loss: 0.237 Vali Loss: 11.785 Vali Acc: 0.111 Test Loss: 11.785 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12198031613480466
model parameter : 1014343
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3641515
	speed: 0.1015s/iter; left time: 2101.5904s
	iters: 200, epoch: 1 | loss: 3.6719170
	speed: 0.0374s/iter; left time: 770.3543s
Epoch: 1 cost time: 14.320281505584717
Epoch: 1, Steps: 208 | Train Loss: 4.031 Vali Loss: 4.034 Vali Acc: 0.056 Test Loss: 4.034 Test Acc: 0.056
Validation loss decreased (inf --> -0.056029).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8507109
	speed: 0.1502s/iter; left time: 3077.0652s
	iters: 200, epoch: 2 | loss: 3.2096775
	speed: 0.0504s/iter; left time: 1028.7563s
Epoch: 2 cost time: 11.155703783035278
Epoch: 2, Steps: 208 | Train Loss: 3.523 Vali Loss: 3.535 Vali Acc: 0.075 Test Loss: 3.535 Test Acc: 0.075
Validation loss decreased (-0.056029 --> -0.075121).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1071777
	speed: 0.1463s/iter; left time: 2967.8894s
	iters: 200, epoch: 3 | loss: 3.2724926
	speed: 0.0378s/iter; left time: 763.6025s
Epoch: 3 cost time: 9.592088222503662
Epoch: 3, Steps: 208 | Train Loss: 3.229 Vali Loss: 3.738 Vali Acc: 0.084 Test Loss: 3.738 Test Acc: 0.084
Validation loss decreased (-0.075121 --> -0.083768).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9877477
	speed: 0.1489s/iter; left time: 2990.2332s
	iters: 200, epoch: 4 | loss: 3.5011718
	speed: 0.0390s/iter; left time: 778.1807s
Epoch: 4 cost time: 10.045865058898926
Epoch: 4, Steps: 208 | Train Loss: 3.155 Vali Loss: 3.760 Vali Acc: 0.100 Test Loss: 3.760 Test Acc: 0.100
Validation loss decreased (-0.083768 --> -0.099575).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2281353
	speed: 0.1442s/iter; left time: 2864.9946s
	iters: 200, epoch: 5 | loss: 3.2438655
	speed: 0.0399s/iter; left time: 788.2707s
Epoch: 5 cost time: 9.864131927490234
Epoch: 5, Steps: 208 | Train Loss: 2.980 Vali Loss: 4.311 Vali Acc: 0.095 Test Loss: 4.311 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6020234
	speed: 0.1797s/iter; left time: 3533.0311s
	iters: 200, epoch: 6 | loss: 2.8105721
	speed: 0.0743s/iter; left time: 1453.1789s
Epoch: 6 cost time: 16.48813486099243
Epoch: 6, Steps: 208 | Train Loss: 2.847 Vali Loss: 4.477 Vali Acc: 0.102 Test Loss: 4.477 Test Acc: 0.102
Validation loss decreased (-0.099575 --> -0.101953).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1836290
	speed: 0.1815s/iter; left time: 3531.4741s
	iters: 200, epoch: 7 | loss: 3.0050359
	speed: 0.0786s/iter; left time: 1521.2951s
Epoch: 7 cost time: 16.701873064041138
Epoch: 7, Steps: 208 | Train Loss: 2.505 Vali Loss: 4.930 Vali Acc: 0.102 Test Loss: 4.930 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0795357
	speed: 0.1788s/iter; left time: 3440.7797s
	iters: 200, epoch: 8 | loss: 1.7990301
	speed: 0.0798s/iter; left time: 1527.3818s
Epoch: 8 cost time: 16.588325262069702
Epoch: 8, Steps: 208 | Train Loss: 2.213 Vali Loss: 4.484 Vali Acc: 0.116 Test Loss: 4.484 Test Acc: 0.116
Validation loss decreased (-0.101953 --> -0.115971).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5131459
	speed: 0.1850s/iter; left time: 3522.2634s
	iters: 200, epoch: 9 | loss: 2.4560471
	speed: 0.0797s/iter; left time: 1508.4823s
Epoch: 9 cost time: 17.080196619033813
Epoch: 9, Steps: 208 | Train Loss: 1.936 Vali Loss: 4.724 Vali Acc: 0.118 Test Loss: 4.724 Test Acc: 0.118
Validation loss decreased (-0.115971 --> -0.117459).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0814655
	speed: 0.1841s/iter; left time: 3465.7933s
	iters: 200, epoch: 10 | loss: 2.2262762
	speed: 0.0780s/iter; left time: 1461.0689s
Epoch: 10 cost time: 16.97708511352539
Epoch: 10, Steps: 208 | Train Loss: 1.704 Vali Loss: 4.793 Vali Acc: 0.118 Test Loss: 4.793 Test Acc: 0.118
Validation loss decreased (-0.117459 --> -0.118055).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5004653
	speed: 0.1815s/iter; left time: 3379.3730s
	iters: 200, epoch: 11 | loss: 1.3843073
	speed: 0.0762s/iter; left time: 1410.4622s
Epoch: 11 cost time: 16.76781678199768
Epoch: 11, Steps: 208 | Train Loss: 1.543 Vali Loss: 5.188 Vali Acc: 0.127 Test Loss: 5.188 Test Acc: 0.127
Validation loss decreased (-0.118055 --> -0.126700).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0056752
	speed: 0.1403s/iter; left time: 2583.5423s
	iters: 200, epoch: 12 | loss: 1.1425576
	speed: 0.0424s/iter; left time: 776.0593s
Epoch: 12 cost time: 9.773831605911255
Epoch: 12, Steps: 208 | Train Loss: 1.345 Vali Loss: 5.552 Vali Acc: 0.131 Test Loss: 5.552 Test Acc: 0.131
Validation loss decreased (-0.126700 --> -0.130574).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2617593
	speed: 0.1400s/iter; left time: 2548.3229s
	iters: 200, epoch: 13 | loss: 0.6482124
	speed: 0.0355s/iter; left time: 641.9573s
Epoch: 13 cost time: 9.012254238128662
Epoch: 13, Steps: 208 | Train Loss: 1.148 Vali Loss: 5.941 Vali Acc: 0.129 Test Loss: 5.941 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9898160
	speed: 0.1330s/iter; left time: 2393.2408s
	iters: 200, epoch: 14 | loss: 1.3170785
	speed: 0.0341s/iter; left time: 610.2706s
Epoch: 14 cost time: 8.509281873703003
Epoch: 14, Steps: 208 | Train Loss: 1.007 Vali Loss: 6.555 Vali Acc: 0.120 Test Loss: 6.555 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.0017663
	speed: 0.1300s/iter; left time: 2312.5684s
	iters: 200, epoch: 15 | loss: 2.6591892
	speed: 0.0367s/iter; left time: 648.8189s
Epoch: 15 cost time: 8.401517629623413
Epoch: 15, Steps: 208 | Train Loss: 0.862 Vali Loss: 7.190 Vali Acc: 0.123 Test Loss: 7.190 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1694580
	speed: 0.1441s/iter; left time: 2534.0685s
	iters: 200, epoch: 16 | loss: 1.2214091
	speed: 0.0355s/iter; left time: 620.5915s
Epoch: 16 cost time: 9.30093765258789
Epoch: 16, Steps: 208 | Train Loss: 0.758 Vali Loss: 7.213 Vali Acc: 0.129 Test Loss: 7.213 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3939215
	speed: 0.1703s/iter; left time: 2959.1952s
	iters: 200, epoch: 17 | loss: 0.4059728
	speed: 0.0753s/iter; left time: 1301.0988s
Epoch: 17 cost time: 16.834064722061157
Epoch: 17, Steps: 208 | Train Loss: 0.700 Vali Loss: 7.795 Vali Acc: 0.131 Test Loss: 7.795 Test Acc: 0.131
Validation loss decreased (-0.130574 --> -0.130850).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.7351269
	speed: 0.1752s/iter; left time: 3006.8702s
	iters: 200, epoch: 18 | loss: 1.5462538
	speed: 0.0770s/iter; left time: 1314.5989s
Epoch: 18 cost time: 16.732765197753906
Epoch: 18, Steps: 208 | Train Loss: 0.608 Vali Loss: 8.406 Vali Acc: 0.123 Test Loss: 8.406 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6629223
	speed: 0.1772s/iter; left time: 3004.5842s
	iters: 200, epoch: 19 | loss: 0.2638554
	speed: 0.0853s/iter; left time: 1437.8057s
Epoch: 19 cost time: 17.589909315109253
Epoch: 19, Steps: 208 | Train Loss: 0.536 Vali Loss: 8.005 Vali Acc: 0.131 Test Loss: 8.005 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.6086549
	speed: 0.1731s/iter; left time: 2899.4027s
	iters: 200, epoch: 20 | loss: 0.2704382
	speed: 0.0747s/iter; left time: 1243.7042s
Epoch: 20 cost time: 16.195823669433594
Epoch: 20, Steps: 208 | Train Loss: 0.496 Vali Loss: 8.624 Vali Acc: 0.118 Test Loss: 8.624 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4808512
	speed: 0.1791s/iter; left time: 2962.0141s
	iters: 200, epoch: 21 | loss: 0.7237383
	speed: 0.0811s/iter; left time: 1333.5144s
Epoch: 21 cost time: 17.552640676498413
Epoch: 21, Steps: 208 | Train Loss: 0.430 Vali Loss: 9.208 Vali Acc: 0.127 Test Loss: 9.208 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.0492396
	speed: 0.1766s/iter; left time: 2883.9267s
	iters: 200, epoch: 22 | loss: 0.4561540
	speed: 0.0774s/iter; left time: 1256.9120s
Epoch: 22 cost time: 16.613035440444946
Epoch: 22, Steps: 208 | Train Loss: 0.434 Vali Loss: 9.530 Vali Acc: 0.126 Test Loss: 9.530 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3032902
	speed: 0.1751s/iter; left time: 2822.8989s
	iters: 200, epoch: 23 | loss: 1.1412591
	speed: 0.0482s/iter; left time: 772.8714s
Epoch: 23 cost time: 12.906774997711182
Epoch: 23, Steps: 208 | Train Loss: 0.373 Vali Loss: 9.853 Vali Acc: 0.115 Test Loss: 9.853 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.1277250
	speed: 0.1292s/iter; left time: 2056.2305s
	iters: 200, epoch: 24 | loss: 0.3547070
	speed: 0.0432s/iter; left time: 682.9942s
Epoch: 24 cost time: 8.53033709526062
Epoch: 24, Steps: 208 | Train Loss: 0.357 Vali Loss: 10.127 Vali Acc: 0.121 Test Loss: 10.127 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.4971300
	speed: 0.1286s/iter; left time: 2020.5206s
	iters: 200, epoch: 25 | loss: 0.3839744
	speed: 0.0348s/iter; left time: 543.8558s
Epoch: 25 cost time: 7.825260162353516
Epoch: 25, Steps: 208 | Train Loss: 0.358 Vali Loss: 10.881 Vali Acc: 0.114 Test Loss: 10.881 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.5201181
	speed: 0.1222s/iter; left time: 1894.8204s
	iters: 200, epoch: 26 | loss: 0.2544566
	speed: 0.0377s/iter; left time: 580.4570s
Epoch: 26 cost time: 8.184356212615967
Epoch: 26, Steps: 208 | Train Loss: 0.317 Vali Loss: 10.871 Vali Acc: 0.120 Test Loss: 10.871 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0243847
	speed: 0.1412s/iter; left time: 2158.9462s
	iters: 200, epoch: 27 | loss: 0.1221517
	speed: 0.0352s/iter; left time: 534.6671s
Epoch: 27 cost time: 8.766666412353516
Epoch: 27, Steps: 208 | Train Loss: 0.300 Vali Loss: 10.659 Vali Acc: 0.127 Test Loss: 10.659 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1309275275872353
model parameter : 520295
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4081206
	speed: 0.0934s/iter; left time: 1932.5177s
	iters: 200, epoch: 1 | loss: 4.6520247
	speed: 0.0763s/iter; left time: 1572.4834s
Epoch: 1 cost time: 17.666240453720093
Epoch: 1, Steps: 208 | Train Loss: 3.905 Vali Loss: 4.065 Vali Acc: 0.060 Test Loss: 4.065 Test Acc: 0.060
Validation loss decreased (inf --> -0.060204).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3751192
	speed: 0.1736s/iter; left time: 3557.1299s
	iters: 200, epoch: 2 | loss: 3.3755867
	speed: 0.0781s/iter; left time: 1592.3339s
Epoch: 2 cost time: 16.109029293060303
Epoch: 2, Steps: 208 | Train Loss: 3.515 Vali Loss: 3.782 Vali Acc: 0.059 Test Loss: 3.782 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.1777813
	speed: 0.1762s/iter; left time: 3575.1290s
	iters: 200, epoch: 3 | loss: 3.3154547
	speed: 0.0890s/iter; left time: 1796.6209s
Epoch: 3 cost time: 18.054384469985962
Epoch: 3, Steps: 208 | Train Loss: 3.188 Vali Loss: 3.711 Vali Acc: 0.080 Test Loss: 3.711 Test Acc: 0.080
Validation loss decreased (-0.060204 --> -0.079593).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2550297
	speed: 0.1792s/iter; left time: 3598.3975s
	iters: 200, epoch: 4 | loss: 3.0784550
	speed: 0.0823s/iter; left time: 1644.4688s
Epoch: 4 cost time: 17.127101182937622
Epoch: 4, Steps: 208 | Train Loss: 3.018 Vali Loss: 3.740 Vali Acc: 0.109 Test Loss: 3.740 Test Acc: 0.109
Validation loss decreased (-0.079593 --> -0.108522).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0956974
	speed: 0.2188s/iter; left time: 4348.0650s
	iters: 200, epoch: 5 | loss: 2.9563255
	speed: 0.0937s/iter; left time: 1852.9853s
Epoch: 5 cost time: 21.03885579109192
Epoch: 5, Steps: 208 | Train Loss: 2.866 Vali Loss: 4.071 Vali Acc: 0.103 Test Loss: 4.071 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.2931790
	speed: 0.2126s/iter; left time: 4179.2458s
	iters: 200, epoch: 6 | loss: 3.7245479
	speed: 0.1023s/iter; left time: 2000.7064s
Epoch: 6 cost time: 21.478461980819702
Epoch: 6, Steps: 208 | Train Loss: 2.694 Vali Loss: 4.110 Vali Acc: 0.104 Test Loss: 4.110 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.1786265
	speed: 0.1630s/iter; left time: 3171.5800s
	iters: 200, epoch: 7 | loss: 2.6801596
	speed: 0.0546s/iter; left time: 1057.6066s
Epoch: 7 cost time: 11.612715721130371
Epoch: 7, Steps: 208 | Train Loss: 2.517 Vali Loss: 4.253 Vali Acc: 0.109 Test Loss: 4.253 Test Acc: 0.109
Validation loss decreased (-0.108522 --> -0.108815).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3508174
	speed: 0.1711s/iter; left time: 3292.9614s
	iters: 200, epoch: 8 | loss: 2.4215231
	speed: 0.0683s/iter; left time: 1306.8889s
Epoch: 8 cost time: 13.987342596054077
Epoch: 8, Steps: 208 | Train Loss: 2.299 Vali Loss: 4.487 Vali Acc: 0.102 Test Loss: 4.487 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3559368
	speed: 0.1603s/iter; left time: 3050.8422s
	iters: 200, epoch: 9 | loss: 1.8046949
	speed: 0.0420s/iter; left time: 795.3311s
Epoch: 9 cost time: 10.272648334503174
Epoch: 9, Steps: 208 | Train Loss: 2.076 Vali Loss: 4.899 Vali Acc: 0.114 Test Loss: 4.899 Test Acc: 0.114
Validation loss decreased (-0.108815 --> -0.113879).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5862192
	speed: 0.1555s/iter; left time: 2927.1871s
	iters: 200, epoch: 10 | loss: 2.5561047
	speed: 0.0536s/iter; left time: 1003.7114s
Epoch: 10 cost time: 11.776232957839966
Epoch: 10, Steps: 208 | Train Loss: 1.875 Vali Loss: 4.823 Vali Acc: 0.113 Test Loss: 4.823 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2618819
	speed: 0.1747s/iter; left time: 3252.5312s
	iters: 200, epoch: 11 | loss: 1.7178969
	speed: 0.0398s/iter; left time: 737.7420s
Epoch: 11 cost time: 11.18856143951416
Epoch: 11, Steps: 208 | Train Loss: 1.673 Vali Loss: 5.111 Vali Acc: 0.117 Test Loss: 5.111 Test Acc: 0.117
Validation loss decreased (-0.113879 --> -0.117157).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1507244
	speed: 0.1721s/iter; left time: 3168.0074s
	iters: 200, epoch: 12 | loss: 1.3673190
	speed: 0.0802s/iter; left time: 1468.3616s
Epoch: 12 cost time: 15.733989953994751
Epoch: 12, Steps: 208 | Train Loss: 1.455 Vali Loss: 5.348 Vali Acc: 0.120 Test Loss: 5.348 Test Acc: 0.120
Validation loss decreased (-0.117157 --> -0.120137).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8304026
	speed: 0.2024s/iter; left time: 3684.5356s
	iters: 200, epoch: 13 | loss: 1.6717690
	speed: 0.0868s/iter; left time: 1572.3375s
Epoch: 13 cost time: 19.132036447525024
Epoch: 13, Steps: 208 | Train Loss: 1.299 Vali Loss: 5.857 Vali Acc: 0.116 Test Loss: 5.857 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2078714
	speed: 0.2048s/iter; left time: 3686.1954s
	iters: 200, epoch: 14 | loss: 1.1594187
	speed: 0.0915s/iter; left time: 1637.0423s
Epoch: 14 cost time: 19.41956329345703
Epoch: 14, Steps: 208 | Train Loss: 1.175 Vali Loss: 6.259 Vali Acc: 0.115 Test Loss: 6.259 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7914995
	speed: 0.1963s/iter; left time: 3491.1482s
	iters: 200, epoch: 15 | loss: 1.0425923
	speed: 0.1027s/iter; left time: 1816.3301s
Epoch: 15 cost time: 20.237852334976196
Epoch: 15, Steps: 208 | Train Loss: 1.065 Vali Loss: 6.590 Vali Acc: 0.115 Test Loss: 6.590 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9482112
	speed: 0.1995s/iter; left time: 3507.7510s
	iters: 200, epoch: 16 | loss: 0.8852830
	speed: 0.1036s/iter; left time: 1811.8405s
Epoch: 16 cost time: 20.836731910705566
Epoch: 16, Steps: 208 | Train Loss: 0.904 Vali Loss: 6.806 Vali Acc: 0.120 Test Loss: 6.806 Test Acc: 0.120
Validation loss decreased (-0.120137 --> -0.120421).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1599724
	speed: 0.2146s/iter; left time: 3727.8120s
	iters: 200, epoch: 17 | loss: 1.2758878
	speed: 0.1082s/iter; left time: 1868.4716s
Epoch: 17 cost time: 22.471444845199585
Epoch: 17, Steps: 208 | Train Loss: 0.790 Vali Loss: 7.333 Vali Acc: 0.116 Test Loss: 7.333 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3719271
	speed: 0.2186s/iter; left time: 3752.5742s
	iters: 200, epoch: 18 | loss: 0.9125305
	speed: 0.1043s/iter; left time: 1780.1821s
Epoch: 18 cost time: 22.41903567314148
Epoch: 18, Steps: 208 | Train Loss: 0.711 Vali Loss: 7.766 Vali Acc: 0.118 Test Loss: 7.766 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4143638
	speed: 0.1885s/iter; left time: 3196.8965s
	iters: 200, epoch: 19 | loss: 0.5874094
	speed: 0.0584s/iter; left time: 984.4924s
Epoch: 19 cost time: 14.298343658447266
Epoch: 19, Steps: 208 | Train Loss: 0.659 Vali Loss: 8.010 Vali Acc: 0.107 Test Loss: 8.010 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.5938589
	speed: 0.1782s/iter; left time: 2985.1394s
	iters: 200, epoch: 20 | loss: 0.2217031
	speed: 0.0536s/iter; left time: 892.2447s
Epoch: 20 cost time: 13.068652153015137
Epoch: 20, Steps: 208 | Train Loss: 0.552 Vali Loss: 8.021 Vali Acc: 0.118 Test Loss: 8.021 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.5432612
	speed: 0.1622s/iter; left time: 2683.7412s
	iters: 200, epoch: 21 | loss: 0.3365760
	speed: 0.0537s/iter; left time: 882.9415s
Epoch: 21 cost time: 12.01878046989441
Epoch: 21, Steps: 208 | Train Loss: 0.544 Vali Loss: 8.560 Vali Acc: 0.113 Test Loss: 8.560 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3112991
	speed: 0.1735s/iter; left time: 2834.0724s
	iters: 200, epoch: 22 | loss: 0.7680871
	speed: 0.0415s/iter; left time: 673.6981s
Epoch: 22 cost time: 11.889998435974121
Epoch: 22, Steps: 208 | Train Loss: 0.527 Vali Loss: 8.930 Vali Acc: 0.114 Test Loss: 8.930 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2016130
	speed: 0.1564s/iter; left time: 2521.6919s
	iters: 200, epoch: 23 | loss: 0.2462966
	speed: 0.0574s/iter; left time: 919.0948s
Epoch: 23 cost time: 11.604246139526367
Epoch: 23, Steps: 208 | Train Loss: 0.474 Vali Loss: 9.116 Vali Acc: 0.113 Test Loss: 9.116 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.4262383
	speed: 0.2065s/iter; left time: 3286.0861s
	iters: 200, epoch: 24 | loss: 0.4417479
	speed: 0.0919s/iter; left time: 1452.8517s
Epoch: 24 cost time: 20.431883335113525
Epoch: 24, Steps: 208 | Train Loss: 0.431 Vali Loss: 9.693 Vali Acc: 0.116 Test Loss: 9.693 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0916488
	speed: 0.2175s/iter; left time: 3417.4463s
	iters: 200, epoch: 25 | loss: 0.2098457
	speed: 0.0871s/iter; left time: 1360.2157s
Epoch: 25 cost time: 20.080581426620483
Epoch: 25, Steps: 208 | Train Loss: 0.424 Vali Loss: 9.666 Vali Acc: 0.122 Test Loss: 9.666 Test Acc: 0.122
Validation loss decreased (-0.120421 --> -0.121585).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.6773357
	speed: 0.2008s/iter; left time: 3112.8576s
	iters: 200, epoch: 26 | loss: 0.2630048
	speed: 0.0907s/iter; left time: 1397.3923s
Epoch: 26 cost time: 19.785988330841064
Epoch: 26, Steps: 208 | Train Loss: 0.378 Vali Loss: 10.383 Vali Acc: 0.119 Test Loss: 10.383 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.2105260
	speed: 0.2053s/iter; left time: 3140.3517s
	iters: 200, epoch: 27 | loss: 0.3981592
	speed: 0.1013s/iter; left time: 1539.5247s
Epoch: 27 cost time: 20.63187313079834
Epoch: 27, Steps: 208 | Train Loss: 0.321 Vali Loss: 10.695 Vali Acc: 0.112 Test Loss: 10.695 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.4718841
	speed: 0.1984s/iter; left time: 2992.1870s
	iters: 200, epoch: 28 | loss: 0.1273928
	speed: 0.1041s/iter; left time: 1559.3070s
Epoch: 28 cost time: 20.367082595825195
Epoch: 28, Steps: 208 | Train Loss: 0.340 Vali Loss: 10.555 Vali Acc: 0.109 Test Loss: 10.555 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.3518612
	speed: 0.1958s/iter; left time: 2913.3758s
	iters: 200, epoch: 29 | loss: 0.6246400
	speed: 0.0738s/iter; left time: 1089.9513s
Epoch: 29 cost time: 16.818739891052246
Epoch: 29, Steps: 208 | Train Loss: 0.333 Vali Loss: 11.225 Vali Acc: 0.119 Test Loss: 11.225 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.5777613
	speed: 0.1877s/iter; left time: 2753.0284s
	iters: 200, epoch: 30 | loss: 0.8860126
	speed: 0.0609s/iter; left time: 887.1810s
Epoch: 30 cost time: 15.539604187011719
Epoch: 30, Steps: 208 | Train Loss: 0.316 Vali Loss: 11.842 Vali Acc: 0.111 Test Loss: 11.842 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.4302295
	speed: 0.1388s/iter; left time: 2007.0254s
	iters: 200, epoch: 31 | loss: 0.3340961
	speed: 0.0548s/iter; left time: 787.0793s
Epoch: 31 cost time: 10.56935715675354
Epoch: 31, Steps: 208 | Train Loss: 0.304 Vali Loss: 11.602 Vali Acc: 0.120 Test Loss: 11.602 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.4483450
	speed: 0.1504s/iter; left time: 2144.1798s
	iters: 200, epoch: 32 | loss: 0.2091586
	speed: 0.0418s/iter; left time: 590.9784s
Epoch: 32 cost time: 10.66781234741211
Epoch: 32, Steps: 208 | Train Loss: 0.263 Vali Loss: 11.683 Vali Acc: 0.121 Test Loss: 11.683 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.1107717
	speed: 0.1510s/iter; left time: 2120.2853s
	iters: 200, epoch: 33 | loss: 0.1098172
	speed: 0.0536s/iter; left time: 747.8283s
Epoch: 33 cost time: 12.068754434585571
Epoch: 33, Steps: 208 | Train Loss: 0.275 Vali Loss: 12.271 Vali Acc: 0.116 Test Loss: 12.271 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0731789
	speed: 0.1431s/iter; left time: 1980.3777s
	iters: 200, epoch: 34 | loss: 0.2889664
	speed: 0.0570s/iter; left time: 783.1297s
Epoch: 34 cost time: 11.477015018463135
Epoch: 34, Steps: 208 | Train Loss: 0.267 Vali Loss: 12.294 Vali Acc: 0.118 Test Loss: 12.294 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.3529413
	speed: 0.1730s/iter; left time: 2357.1401s
	iters: 200, epoch: 35 | loss: 0.3885217
	speed: 0.0810s/iter; left time: 1095.8488s
Epoch: 35 cost time: 17.219197273254395
Epoch: 35, Steps: 208 | Train Loss: 0.270 Vali Loss: 12.281 Vali Acc: 0.123 Test Loss: 12.281 Test Acc: 0.123
Validation loss decreased (-0.121585 --> -0.123050).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.3531732
	speed: 0.1866s/iter; left time: 2504.6608s
	iters: 200, epoch: 36 | loss: 0.2733105
	speed: 0.0777s/iter; left time: 1034.6352s
Epoch: 36 cost time: 17.082433223724365
Epoch: 36, Steps: 208 | Train Loss: 0.222 Vali Loss: 12.508 Vali Acc: 0.124 Test Loss: 12.508 Test Acc: 0.124
Validation loss decreased (-0.123050 --> -0.124241).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0190628
	speed: 0.1846s/iter; left time: 2438.5066s
	iters: 200, epoch: 37 | loss: 0.2849199
	speed: 0.0816s/iter; left time: 1070.3921s
Epoch: 37 cost time: 17.2955060005188
Epoch: 37, Steps: 208 | Train Loss: 0.240 Vali Loss: 13.094 Vali Acc: 0.121 Test Loss: 13.094 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.4376340
	speed: 0.1789s/iter; left time: 2327.1161s
	iters: 200, epoch: 38 | loss: 0.0392304
	speed: 0.0824s/iter; left time: 1063.5449s
Epoch: 38 cost time: 17.065791606903076
Epoch: 38, Steps: 208 | Train Loss: 0.240 Vali Loss: 13.178 Vali Acc: 0.117 Test Loss: 13.178 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.5374558
	speed: 0.1770s/iter; left time: 2264.5364s
	iters: 200, epoch: 39 | loss: 0.4370882
	speed: 0.0740s/iter; left time: 939.3478s
Epoch: 39 cost time: 15.68643856048584
Epoch: 39, Steps: 208 | Train Loss: 0.208 Vali Loss: 13.505 Vali Acc: 0.130 Test Loss: 13.505 Test Acc: 0.130
Validation loss decreased (-0.124241 --> -0.129600).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.1882528
	speed: 0.1847s/iter; left time: 2325.2557s
	iters: 200, epoch: 40 | loss: 0.2340747
	speed: 0.0819s/iter; left time: 1022.3881s
Epoch: 40 cost time: 17.57275629043579
Epoch: 40, Steps: 208 | Train Loss: 0.211 Vali Loss: 13.941 Vali Acc: 0.116 Test Loss: 13.941 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.3473886
	speed: 0.1793s/iter; left time: 2220.0595s
	iters: 200, epoch: 41 | loss: 0.0647801
	speed: 0.0491s/iter; left time: 603.5047s
Epoch: 41 cost time: 14.115168571472168
Epoch: 41, Steps: 208 | Train Loss: 0.220 Vali Loss: 14.267 Vali Acc: 0.125 Test Loss: 14.267 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.0257893
	speed: 0.1423s/iter; left time: 1732.7908s
	iters: 200, epoch: 42 | loss: 0.2619279
	speed: 0.0510s/iter; left time: 615.8289s
Epoch: 42 cost time: 10.813384771347046
Epoch: 42, Steps: 208 | Train Loss: 0.215 Vali Loss: 14.373 Vali Acc: 0.118 Test Loss: 14.373 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.0136163
	speed: 0.1513s/iter; left time: 1809.9814s
	iters: 200, epoch: 43 | loss: 0.3823327
	speed: 0.0455s/iter; left time: 540.1065s
Epoch: 43 cost time: 10.263184547424316
Epoch: 43, Steps: 208 | Train Loss: 0.189 Vali Loss: 14.000 Vali Acc: 0.123 Test Loss: 14.000 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.2304986
	speed: 0.1513s/iter; left time: 1778.3004s
	iters: 200, epoch: 44 | loss: 0.2185724
	speed: 0.0446s/iter; left time: 520.2974s
Epoch: 44 cost time: 10.511877298355103
Epoch: 44, Steps: 208 | Train Loss: 0.205 Vali Loss: 14.762 Vali Acc: 0.119 Test Loss: 14.762 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.2436168
	speed: 0.1322s/iter; left time: 1526.9156s
	iters: 200, epoch: 45 | loss: 0.5346807
	speed: 0.0473s/iter; left time: 541.2616s
Epoch: 45 cost time: 9.28829026222229
Epoch: 45, Steps: 208 | Train Loss: 0.164 Vali Loss: 14.658 Vali Acc: 0.130 Test Loss: 14.658 Test Acc: 0.130
Validation loss decreased (-0.129600 --> -0.130184).  Saving model ...
	iters: 100, epoch: 46 | loss: 0.0343758
	speed: 0.1783s/iter; left time: 2022.3032s
	iters: 200, epoch: 46 | loss: 0.0219696
	speed: 0.0801s/iter; left time: 900.2000s
Epoch: 46 cost time: 17.315157890319824
Epoch: 46, Steps: 208 | Train Loss: 0.197 Vali Loss: 15.147 Vali Acc: 0.117 Test Loss: 15.147 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 0.0572130
	speed: 0.1830s/iter; left time: 2037.0315s
	iters: 200, epoch: 47 | loss: 0.1121179
	speed: 0.0802s/iter; left time: 884.9066s
Epoch: 47 cost time: 17.53369379043579
Epoch: 47, Steps: 208 | Train Loss: 0.209 Vali Loss: 14.961 Vali Acc: 0.115 Test Loss: 14.961 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 48 | loss: 0.0552774
	speed: 0.1749s/iter; left time: 1910.3864s
	iters: 200, epoch: 48 | loss: 0.2728062
	speed: 0.0793s/iter; left time: 858.0218s
Epoch: 48 cost time: 16.97771692276001
Epoch: 48, Steps: 208 | Train Loss: 0.202 Vali Loss: 15.260 Vali Acc: 0.123 Test Loss: 15.260 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 49 | loss: 0.6866844
	speed: 0.1834s/iter; left time: 1965.1993s
	iters: 200, epoch: 49 | loss: 0.5774978
	speed: 0.0863s/iter; left time: 916.5250s
Epoch: 49 cost time: 18.191402435302734
Epoch: 49, Steps: 208 | Train Loss: 0.219 Vali Loss: 15.383 Vali Acc: 0.119 Test Loss: 15.383 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 50 | loss: 0.0185466
	speed: 0.1924s/iter; left time: 2021.6599s
	iters: 200, epoch: 50 | loss: 0.1460443
	speed: 0.0840s/iter; left time: 874.0383s
Epoch: 50 cost time: 18.184247732162476
Epoch: 50, Steps: 208 | Train Loss: 0.172 Vali Loss: 16.122 Vali Acc: 0.124 Test Loss: 16.122 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 51 | loss: 0.0721307
	speed: 0.1787s/iter; left time: 1841.0364s
	iters: 200, epoch: 51 | loss: 0.6239827
	speed: 0.0817s/iter; left time: 833.3555s
Epoch: 51 cost time: 17.241581439971924
Epoch: 51, Steps: 208 | Train Loss: 0.172 Vali Loss: 16.126 Vali Acc: 0.119 Test Loss: 16.126 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 52 | loss: 0.0556333
	speed: 0.1807s/iter; left time: 1823.7455s
	iters: 200, epoch: 52 | loss: 0.0840245
	speed: 0.0383s/iter; left time: 383.1522s
Epoch: 52 cost time: 12.260020017623901
Epoch: 52, Steps: 208 | Train Loss: 0.150 Vali Loss: 16.139 Vali Acc: 0.123 Test Loss: 16.139 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 53 | loss: 0.4673979
	speed: 0.1575s/iter; left time: 1556.5093s
	iters: 200, epoch: 53 | loss: 0.2308356
	speed: 0.0464s/iter; left time: 453.8028s
Epoch: 53 cost time: 10.675797462463379
Epoch: 53, Steps: 208 | Train Loss: 0.153 Vali Loss: 15.907 Vali Acc: 0.132 Test Loss: 15.907 Test Acc: 0.132
Validation loss decreased (-0.130184 --> -0.131663).  Saving model ...
	iters: 100, epoch: 54 | loss: 0.3200004
	speed: 0.1526s/iter; left time: 1476.3366s
	iters: 200, epoch: 54 | loss: 0.5507417
	speed: 0.0579s/iter; left time: 554.7488s
Epoch: 54 cost time: 11.427038669586182
Epoch: 54, Steps: 208 | Train Loss: 0.182 Vali Loss: 16.249 Vali Acc: 0.122 Test Loss: 16.249 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 55 | loss: 0.1377591
	speed: 0.1416s/iter; left time: 1340.3668s
	iters: 200, epoch: 55 | loss: 0.2221218
	speed: 0.0419s/iter; left time: 392.1647s
Epoch: 55 cost time: 9.282837390899658
Epoch: 55, Steps: 208 | Train Loss: 0.149 Vali Loss: 16.595 Vali Acc: 0.125 Test Loss: 16.595 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 56 | loss: 0.9448351
	speed: 0.1534s/iter; left time: 1420.8694s
	iters: 200, epoch: 56 | loss: 0.4191103
	speed: 0.0410s/iter; left time: 375.7483s
Epoch: 56 cost time: 9.896052122116089
Epoch: 56, Steps: 208 | Train Loss: 0.152 Vali Loss: 16.705 Vali Acc: 0.119 Test Loss: 16.705 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 57 | loss: 0.1208786
	speed: 0.1823s/iter; left time: 1650.1542s
	iters: 200, epoch: 57 | loss: 0.0359643
	speed: 0.0866s/iter; left time: 775.7600s
Epoch: 57 cost time: 18.549307346343994
Epoch: 57, Steps: 208 | Train Loss: 0.168 Vali Loss: 16.856 Vali Acc: 0.123 Test Loss: 16.856 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 58 | loss: 0.0519492
	speed: 0.1829s/iter; left time: 1617.5976s
	iters: 200, epoch: 58 | loss: 1.0795345
	speed: 0.0880s/iter; left time: 769.2521s
Epoch: 58 cost time: 18.08987522125244
Epoch: 58, Steps: 208 | Train Loss: 0.183 Vali Loss: 16.794 Vali Acc: 0.120 Test Loss: 16.794 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 59 | loss: 0.0105495
	speed: 0.1872s/iter; left time: 1616.7666s
	iters: 200, epoch: 59 | loss: 0.0242708
	speed: 0.0851s/iter; left time: 726.7572s
Epoch: 59 cost time: 18.190267324447632
Epoch: 59, Steps: 208 | Train Loss: 0.163 Vali Loss: 16.361 Vali Acc: 0.117 Test Loss: 16.361 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 60 | loss: 0.0800105
	speed: 0.1862s/iter; left time: 1569.6340s
	iters: 200, epoch: 60 | loss: 0.0402879
	speed: 0.0796s/iter; left time: 663.1979s
Epoch: 60 cost time: 17.214147329330444
Epoch: 60, Steps: 208 | Train Loss: 0.162 Vali Loss: 16.930 Vali Acc: 0.116 Test Loss: 16.930 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 61 | loss: 0.0795344
	speed: 0.1794s/iter; left time: 1474.6806s
	iters: 200, epoch: 61 | loss: 0.0017251
	speed: 0.0829s/iter; left time: 673.5363s
Epoch: 61 cost time: 17.511091470718384
Epoch: 61, Steps: 208 | Train Loss: 0.148 Vali Loss: 17.482 Vali Acc: 0.121 Test Loss: 17.482 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 62 | loss: 0.0020940
	speed: 0.1856s/iter; left time: 1487.3190s
	iters: 200, epoch: 62 | loss: 0.0012612
	speed: 0.0797s/iter; left time: 630.5535s
Epoch: 62 cost time: 17.210836172103882
Epoch: 62, Steps: 208 | Train Loss: 0.143 Vali Loss: 17.342 Vali Acc: 0.117 Test Loss: 17.342 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 63 | loss: 0.3499500
	speed: 0.1801s/iter; left time: 1405.4862s
	iters: 200, epoch: 63 | loss: 0.6901411
	speed: 0.0457s/iter; left time: 351.9189s
Epoch: 63 cost time: 13.439892053604126
Epoch: 63, Steps: 208 | Train Loss: 0.170 Vali Loss: 17.409 Vali Acc: 0.112 Test Loss: 17.409 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1318222487324784
model parameter : 355751
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9864109
	speed: 0.0464s/iter; left time: 959.8268s
	iters: 200, epoch: 1 | loss: 4.1302686
	speed: 0.0292s/iter; left time: 601.4163s
Epoch: 1 cost time: 7.854520082473755
Epoch: 1, Steps: 208 | Train Loss: 3.875 Vali Loss: 3.978 Vali Acc: 0.060 Test Loss: 3.978 Test Acc: 0.060
Validation loss decreased (inf --> -0.060205).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4829772
	speed: 0.1102s/iter; left time: 2257.7873s
	iters: 200, epoch: 2 | loss: 3.7159448
	speed: 0.0300s/iter; left time: 611.1556s
Epoch: 2 cost time: 6.5298073291778564
Epoch: 2, Steps: 208 | Train Loss: 3.545 Vali Loss: 4.068 Vali Acc: 0.068 Test Loss: 4.068 Test Acc: 0.068
Validation loss decreased (-0.060205 --> -0.067958).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0322196
	speed: 0.1250s/iter; left time: 2536.3521s
	iters: 200, epoch: 3 | loss: 3.3297179
	speed: 0.0289s/iter; left time: 583.0475s
Epoch: 3 cost time: 6.880395412445068
Epoch: 3, Steps: 208 | Train Loss: 3.254 Vali Loss: 4.160 Vali Acc: 0.080 Test Loss: 4.160 Test Acc: 0.080
Validation loss decreased (-0.067958 --> -0.079589).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0889416
	speed: 0.1179s/iter; left time: 2367.2208s
	iters: 200, epoch: 4 | loss: 3.6271133
	speed: 0.0299s/iter; left time: 596.6854s
Epoch: 4 cost time: 6.5940423011779785
Epoch: 4, Steps: 208 | Train Loss: 2.998 Vali Loss: 4.301 Vali Acc: 0.085 Test Loss: 4.301 Test Acc: 0.085
Validation loss decreased (-0.079589 --> -0.084657).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6930892
	speed: 0.1337s/iter; left time: 2657.3958s
	iters: 200, epoch: 5 | loss: 3.3311014
	speed: 0.0383s/iter; left time: 757.3835s
Epoch: 5 cost time: 8.62813138961792
Epoch: 5, Steps: 208 | Train Loss: 2.870 Vali Loss: 4.382 Vali Acc: 0.086 Test Loss: 4.382 Test Acc: 0.086
Validation loss decreased (-0.084657 --> -0.086148).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5851169
	speed: 0.1334s/iter; left time: 2623.5034s
	iters: 200, epoch: 6 | loss: 3.0748096
	speed: 0.0408s/iter; left time: 797.5668s
Epoch: 6 cost time: 8.756742238998413
Epoch: 6, Steps: 208 | Train Loss: 2.720 Vali Loss: 4.398 Vali Acc: 0.102 Test Loss: 4.398 Test Acc: 0.102
Validation loss decreased (-0.086148 --> -0.101656).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4244804
	speed: 0.1327s/iter; left time: 2581.5822s
	iters: 200, epoch: 7 | loss: 3.7802131
	speed: 0.0385s/iter; left time: 745.7658s
Epoch: 7 cost time: 8.669241666793823
Epoch: 7, Steps: 208 | Train Loss: 2.529 Vali Loss: 4.398 Vali Acc: 0.108 Test Loss: 4.398 Test Acc: 0.108
Validation loss decreased (-0.101656 --> -0.107621).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5671077
	speed: 0.1283s/iter; left time: 2468.2819s
	iters: 200, epoch: 8 | loss: 2.6845653
	speed: 0.0375s/iter; left time: 717.9480s
Epoch: 8 cost time: 8.239624738693237
Epoch: 8, Steps: 208 | Train Loss: 2.347 Vali Loss: 4.543 Vali Acc: 0.109 Test Loss: 4.543 Test Acc: 0.109
Validation loss decreased (-0.107621 --> -0.108812).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3424287
	speed: 0.1298s/iter; left time: 2471.3339s
	iters: 200, epoch: 9 | loss: 3.1222062
	speed: 0.0399s/iter; left time: 756.3365s
Epoch: 9 cost time: 8.759662389755249
Epoch: 9, Steps: 208 | Train Loss: 2.168 Vali Loss: 4.574 Vali Acc: 0.124 Test Loss: 4.574 Test Acc: 0.124
Validation loss decreased (-0.108812 --> -0.124022).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3040140
	speed: 0.1340s/iter; left time: 2523.4525s
	iters: 200, epoch: 10 | loss: 2.2351768
	speed: 0.0410s/iter; left time: 768.6849s
Epoch: 10 cost time: 8.949734210968018
Epoch: 10, Steps: 208 | Train Loss: 1.953 Vali Loss: 4.682 Vali Acc: 0.110 Test Loss: 4.682 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2527437
	speed: 0.1333s/iter; left time: 2481.7951s
	iters: 200, epoch: 11 | loss: 1.4507462
	speed: 0.0416s/iter; left time: 770.6677s
Epoch: 11 cost time: 8.985544443130493
Epoch: 11, Steps: 208 | Train Loss: 1.770 Vali Loss: 4.905 Vali Acc: 0.122 Test Loss: 4.905 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1131667
	speed: 0.1349s/iter; left time: 2483.7549s
	iters: 200, epoch: 12 | loss: 1.3424054
	speed: 0.0425s/iter; left time: 778.2624s
Epoch: 12 cost time: 9.289553880691528
Epoch: 12, Steps: 208 | Train Loss: 1.578 Vali Loss: 5.070 Vali Acc: 0.110 Test Loss: 5.070 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5857451
	speed: 0.1346s/iter; left time: 2449.6424s
	iters: 200, epoch: 13 | loss: 1.4510150
	speed: 0.0414s/iter; left time: 750.0350s
Epoch: 13 cost time: 9.195642232894897
Epoch: 13, Steps: 208 | Train Loss: 1.411 Vali Loss: 5.489 Vali Acc: 0.120 Test Loss: 5.489 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.5223429
	speed: 0.1362s/iter; left time: 2450.8925s
	iters: 200, epoch: 14 | loss: 1.3808882
	speed: 0.0421s/iter; left time: 752.8283s
Epoch: 14 cost time: 9.173838138580322
Epoch: 14, Steps: 208 | Train Loss: 1.266 Vali Loss: 5.559 Vali Acc: 0.120 Test Loss: 5.559 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8091669
	speed: 0.1393s/iter; left time: 2478.1294s
	iters: 200, epoch: 15 | loss: 1.0423895
	speed: 0.0413s/iter; left time: 731.2134s
Epoch: 15 cost time: 8.888155221939087
Epoch: 15, Steps: 208 | Train Loss: 1.127 Vali Loss: 6.137 Vali Acc: 0.117 Test Loss: 6.137 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.4890542
	speed: 0.1256s/iter; left time: 2208.4777s
	iters: 200, epoch: 16 | loss: 1.6741618
	speed: 0.0311s/iter; left time: 543.7417s
Epoch: 16 cost time: 7.042970418930054
Epoch: 16, Steps: 208 | Train Loss: 1.021 Vali Loss: 6.485 Vali Acc: 0.123 Test Loss: 6.485 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.0025270
	speed: 0.1304s/iter; left time: 2266.1980s
	iters: 200, epoch: 17 | loss: 1.3243736
	speed: 0.0317s/iter; left time: 547.2577s
Epoch: 17 cost time: 7.146146535873413
Epoch: 17, Steps: 208 | Train Loss: 0.892 Vali Loss: 6.512 Vali Acc: 0.118 Test Loss: 6.512 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5873554
	speed: 0.1253s/iter; left time: 2151.3130s
	iters: 200, epoch: 18 | loss: 0.5295173
	speed: 0.0309s/iter; left time: 526.6676s
Epoch: 18 cost time: 6.806942701339722
Epoch: 18, Steps: 208 | Train Loss: 0.834 Vali Loss: 6.883 Vali Acc: 0.128 Test Loss: 6.883 Test Acc: 0.128
Validation loss decreased (-0.124022 --> -0.128175).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.7410614
	speed: 0.1235s/iter; left time: 2093.7864s
	iters: 200, epoch: 19 | loss: 0.4672563
	speed: 0.0313s/iter; left time: 528.4100s
Epoch: 19 cost time: 6.909456729888916
Epoch: 19, Steps: 208 | Train Loss: 0.750 Vali Loss: 7.440 Vali Acc: 0.126 Test Loss: 7.440 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.9481057
	speed: 0.1227s/iter; left time: 2055.2603s
	iters: 200, epoch: 20 | loss: 0.4682573
	speed: 0.0297s/iter; left time: 493.6733s
Epoch: 20 cost time: 6.940264463424683
Epoch: 20, Steps: 208 | Train Loss: 0.678 Vali Loss: 7.457 Vali Acc: 0.120 Test Loss: 7.457 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.3217064
	speed: 0.1234s/iter; left time: 2040.5951s
	iters: 200, epoch: 21 | loss: 0.3383113
	speed: 0.0318s/iter; left time: 523.2969s
Epoch: 21 cost time: 7.039816856384277
Epoch: 21, Steps: 208 | Train Loss: 0.603 Vali Loss: 7.781 Vali Acc: 0.118 Test Loss: 7.781 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.6468321
	speed: 0.1316s/iter; left time: 2148.9506s
	iters: 200, epoch: 22 | loss: 0.5081874
	speed: 0.0418s/iter; left time: 678.4722s
Epoch: 22 cost time: 9.069006443023682
Epoch: 22, Steps: 208 | Train Loss: 0.547 Vali Loss: 8.448 Vali Acc: 0.123 Test Loss: 8.448 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1886644
	speed: 0.1342s/iter; left time: 2163.5442s
	iters: 200, epoch: 23 | loss: 0.5823774
	speed: 0.0410s/iter; left time: 657.4145s
Epoch: 23 cost time: 8.957839012145996
Epoch: 23, Steps: 208 | Train Loss: 0.509 Vali Loss: 8.490 Vali Acc: 0.122 Test Loss: 8.490 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.4856618
	speed: 0.1366s/iter; left time: 2174.4939s
	iters: 200, epoch: 24 | loss: 0.8098094
	speed: 0.0409s/iter; left time: 646.7233s
Epoch: 24 cost time: 9.091444730758667
Epoch: 24, Steps: 208 | Train Loss: 0.520 Vali Loss: 8.760 Vali Acc: 0.118 Test Loss: 8.760 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.5077525
	speed: 0.1332s/iter; left time: 2093.1322s
	iters: 200, epoch: 25 | loss: 0.6431123
	speed: 0.0379s/iter; left time: 591.4207s
Epoch: 25 cost time: 8.34942889213562
Epoch: 25, Steps: 208 | Train Loss: 0.461 Vali Loss: 9.031 Vali Acc: 0.111 Test Loss: 9.031 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.4173379
	speed: 0.1254s/iter; left time: 1944.3092s
	iters: 200, epoch: 26 | loss: 0.3362825
	speed: 0.0394s/iter; left time: 606.4169s
Epoch: 26 cost time: 8.559755325317383
Epoch: 26, Steps: 208 | Train Loss: 0.443 Vali Loss: 8.953 Vali Acc: 0.121 Test Loss: 8.953 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.5268686
	speed: 0.1219s/iter; left time: 1863.4803s
	iters: 200, epoch: 27 | loss: 0.4819278
	speed: 0.0373s/iter; left time: 567.1075s
Epoch: 27 cost time: 7.98815131187439
Epoch: 27, Steps: 208 | Train Loss: 0.406 Vali Loss: 9.588 Vali Acc: 0.116 Test Loss: 9.588 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.5929084
	speed: 0.1308s/iter; left time: 1973.0779s
	iters: 200, epoch: 28 | loss: 0.1331947
	speed: 0.0393s/iter; left time: 589.4788s
Epoch: 28 cost time: 8.77204179763794
Epoch: 28, Steps: 208 | Train Loss: 0.398 Vali Loss: 10.060 Vali Acc: 0.118 Test Loss: 10.060 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1282433641515061
model parameter : 287271
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0448771
	speed: 0.0553s/iter; left time: 1145.3007s
	iters: 200, epoch: 1 | loss: 3.7074499
	speed: 0.0375s/iter; left time: 771.5714s
Epoch: 1 cost time: 9.632676839828491
Epoch: 1, Steps: 208 | Train Loss: 3.792 Vali Loss: 3.800 Vali Acc: 0.061 Test Loss: 3.800 Test Acc: 0.061
Validation loss decreased (inf --> -0.060803).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8900955
	speed: 0.1278s/iter; left time: 2619.0303s
	iters: 200, epoch: 2 | loss: 3.6019607
	speed: 0.0376s/iter; left time: 766.7426s
Epoch: 2 cost time: 8.214789390563965
Epoch: 2, Steps: 208 | Train Loss: 3.529 Vali Loss: 3.801 Vali Acc: 0.074 Test Loss: 3.801 Test Acc: 0.074
Validation loss decreased (-0.060803 --> -0.073627).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3749392
	speed: 0.1145s/iter; left time: 2322.8291s
	iters: 200, epoch: 3 | loss: 3.1273322
	speed: 0.0292s/iter; left time: 590.3785s
Epoch: 3 cost time: 6.161395788192749
Epoch: 3, Steps: 208 | Train Loss: 3.225 Vali Loss: 4.034 Vali Acc: 0.074 Test Loss: 4.034 Test Acc: 0.074
Validation loss decreased (-0.073627 --> -0.074222).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0103076
	speed: 0.1233s/iter; left time: 2475.5252s
	iters: 200, epoch: 4 | loss: 3.3719611
	speed: 0.0281s/iter; left time: 561.8818s
Epoch: 4 cost time: 6.366075754165649
Epoch: 4, Steps: 208 | Train Loss: 3.014 Vali Loss: 3.972 Vali Acc: 0.088 Test Loss: 3.972 Test Acc: 0.088
Validation loss decreased (-0.074222 --> -0.087643).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4751556
	speed: 0.1205s/iter; left time: 2395.1550s
	iters: 200, epoch: 5 | loss: 3.1175332
	speed: 0.0283s/iter; left time: 558.5796s
Epoch: 5 cost time: 6.393785715103149
Epoch: 5, Steps: 208 | Train Loss: 2.849 Vali Loss: 4.201 Vali Acc: 0.085 Test Loss: 4.201 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.5326471
	speed: 0.1113s/iter; left time: 2189.0895s
	iters: 200, epoch: 6 | loss: 2.6296260
	speed: 0.0269s/iter; left time: 526.7958s
Epoch: 6 cost time: 6.250468969345093
Epoch: 6, Steps: 208 | Train Loss: 2.709 Vali Loss: 4.044 Vali Acc: 0.103 Test Loss: 4.044 Test Acc: 0.103
Validation loss decreased (-0.087643 --> -0.103151).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0853260
	speed: 0.1170s/iter; left time: 2275.5250s
	iters: 200, epoch: 7 | loss: 3.1172702
	speed: 0.0287s/iter; left time: 555.6194s
Epoch: 7 cost time: 6.312335968017578
Epoch: 7, Steps: 208 | Train Loss: 2.577 Vali Loss: 4.223 Vali Acc: 0.105 Test Loss: 4.223 Test Acc: 0.105
Validation loss decreased (-0.103151 --> -0.104938).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3398848
	speed: 0.1164s/iter; left time: 2240.6638s
	iters: 200, epoch: 8 | loss: 3.4081581
	speed: 0.0277s/iter; left time: 530.9210s
Epoch: 8 cost time: 6.157231330871582
Epoch: 8, Steps: 208 | Train Loss: 2.422 Vali Loss: 4.310 Vali Acc: 0.109 Test Loss: 4.310 Test Acc: 0.109
Validation loss decreased (-0.104938 --> -0.109411).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2722452
	speed: 0.1137s/iter; left time: 2165.2086s
	iters: 200, epoch: 9 | loss: 2.0596831
	speed: 0.0349s/iter; left time: 660.4796s
Epoch: 9 cost time: 7.63680100440979
Epoch: 9, Steps: 208 | Train Loss: 2.266 Vali Loss: 4.383 Vali Acc: 0.116 Test Loss: 4.383 Test Acc: 0.116
Validation loss decreased (-0.109411 --> -0.115673).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7314496
	speed: 0.1283s/iter; left time: 2416.1415s
	iters: 200, epoch: 10 | loss: 2.3427932
	speed: 0.0373s/iter; left time: 698.8457s
Epoch: 10 cost time: 8.239650249481201
Epoch: 10, Steps: 208 | Train Loss: 2.095 Vali Loss: 4.541 Vali Acc: 0.117 Test Loss: 4.541 Test Acc: 0.117
Validation loss decreased (-0.115673 --> -0.116567).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6363169
	speed: 0.1314s/iter; left time: 2447.4314s
	iters: 200, epoch: 11 | loss: 2.7329087
	speed: 0.0359s/iter; left time: 665.4650s
Epoch: 11 cost time: 8.112251996994019
Epoch: 11, Steps: 208 | Train Loss: 1.915 Vali Loss: 4.665 Vali Acc: 0.112 Test Loss: 4.665 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7614595
	speed: 0.1300s/iter; left time: 2394.5167s
	iters: 200, epoch: 12 | loss: 2.1349878
	speed: 0.0365s/iter; left time: 668.9919s
Epoch: 12 cost time: 8.061471223831177
Epoch: 12, Steps: 208 | Train Loss: 1.797 Vali Loss: 4.808 Vali Acc: 0.120 Test Loss: 4.808 Test Acc: 0.120
Validation loss decreased (-0.116567 --> -0.120441).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7701733
	speed: 0.1327s/iter; left time: 2415.0103s
	iters: 200, epoch: 13 | loss: 1.2803504
	speed: 0.0368s/iter; left time: 665.7238s
Epoch: 13 cost time: 8.01435899734497
Epoch: 13, Steps: 208 | Train Loss: 1.648 Vali Loss: 4.959 Vali Acc: 0.118 Test Loss: 4.959 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9374471
	speed: 0.1325s/iter; left time: 2384.4869s
	iters: 200, epoch: 14 | loss: 2.2444775
	speed: 0.0373s/iter; left time: 668.2332s
Epoch: 14 cost time: 8.300497770309448
Epoch: 14, Steps: 208 | Train Loss: 1.528 Vali Loss: 5.380 Vali Acc: 0.115 Test Loss: 5.380 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1155694
	speed: 0.1310s/iter; left time: 2329.5890s
	iters: 200, epoch: 15 | loss: 1.5461245
	speed: 0.0368s/iter; left time: 650.2847s
Epoch: 15 cost time: 8.204384803771973
Epoch: 15, Steps: 208 | Train Loss: 1.362 Vali Loss: 5.705 Vali Acc: 0.119 Test Loss: 5.705 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.7470520
	speed: 0.1228s/iter; left time: 2158.7421s
	iters: 200, epoch: 16 | loss: 1.7453314
	speed: 0.0379s/iter; left time: 662.0403s
Epoch: 16 cost time: 8.121375799179077
Epoch: 16, Steps: 208 | Train Loss: 1.267 Vali Loss: 5.695 Vali Acc: 0.117 Test Loss: 5.695 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7373499
	speed: 0.1238s/iter; left time: 2151.3072s
	iters: 200, epoch: 17 | loss: 1.3959644
	speed: 0.0384s/iter; left time: 664.0060s
Epoch: 17 cost time: 8.358367204666138
Epoch: 17, Steps: 208 | Train Loss: 1.151 Vali Loss: 6.063 Vali Acc: 0.114 Test Loss: 6.063 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.6558409
	speed: 0.1280s/iter; left time: 2197.6080s
	iters: 200, epoch: 18 | loss: 1.1118960
	speed: 0.0378s/iter; left time: 645.0259s
Epoch: 18 cost time: 8.447454929351807
Epoch: 18, Steps: 208 | Train Loss: 1.073 Vali Loss: 6.269 Vali Acc: 0.116 Test Loss: 6.269 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3729838
	speed: 0.1155s/iter; left time: 1958.5500s
	iters: 200, epoch: 19 | loss: 0.6472247
	speed: 0.0285s/iter; left time: 480.8035s
Epoch: 19 cost time: 6.447327136993408
Epoch: 19, Steps: 208 | Train Loss: 0.971 Vali Loss: 6.632 Vali Acc: 0.110 Test Loss: 6.632 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.1879704
	speed: 0.1171s/iter; left time: 1961.6272s
	iters: 200, epoch: 20 | loss: 0.7769237
	speed: 0.0299s/iter; left time: 497.7082s
Epoch: 20 cost time: 6.608049154281616
Epoch: 20, Steps: 208 | Train Loss: 0.890 Vali Loss: 6.974 Vali Acc: 0.111 Test Loss: 6.974 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.6890964
	speed: 0.1143s/iter; left time: 1890.5822s
	iters: 200, epoch: 21 | loss: 0.9397946
	speed: 0.0288s/iter; left time: 473.2297s
Epoch: 21 cost time: 6.267289876937866
Epoch: 21, Steps: 208 | Train Loss: 0.793 Vali Loss: 7.091 Vali Acc: 0.114 Test Loss: 7.091 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.7614190
	speed: 0.1198s/iter; left time: 1956.1290s
	iters: 200, epoch: 22 | loss: 0.9655848
	speed: 0.0282s/iter; left time: 457.0675s
Epoch: 22 cost time: 6.465953588485718
Epoch: 22, Steps: 208 | Train Loss: 0.758 Vali Loss: 7.734 Vali Acc: 0.112 Test Loss: 7.734 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12048911422606622
model parameter : 191527
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6986957
	speed: 0.0423s/iter; left time: 875.6576s
	iters: 200, epoch: 1 | loss: 3.9789593
	speed: 0.0346s/iter; left time: 712.4861s
Epoch: 1 cost time: 8.035217523574829
Epoch: 1, Steps: 208 | Train Loss: 3.799 Vali Loss: 3.739 Vali Acc: 0.054 Test Loss: 3.739 Test Acc: 0.054
Validation loss decreased (inf --> -0.054242).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6145656
	speed: 0.1224s/iter; left time: 2508.6738s
	iters: 200, epoch: 2 | loss: 3.3903112
	speed: 0.0370s/iter; left time: 753.9401s
Epoch: 2 cost time: 8.22374677658081
Epoch: 2, Steps: 208 | Train Loss: 3.536 Vali Loss: 3.748 Vali Acc: 0.066 Test Loss: 3.748 Test Acc: 0.066
Validation loss decreased (-0.054242 --> -0.065874).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3245833
	speed: 0.1301s/iter; left time: 2639.1614s
	iters: 200, epoch: 3 | loss: 3.5428345
	speed: 0.0382s/iter; left time: 771.4176s
Epoch: 3 cost time: 8.339175701141357
Epoch: 3, Steps: 208 | Train Loss: 3.274 Vali Loss: 3.772 Vali Acc: 0.082 Test Loss: 3.772 Test Acc: 0.082
Validation loss decreased (-0.065874 --> -0.081680).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9698386
	speed: 0.1322s/iter; left time: 2654.9290s
	iters: 200, epoch: 4 | loss: 3.5867205
	speed: 0.0379s/iter; left time: 756.1430s
Epoch: 4 cost time: 8.205593824386597
Epoch: 4, Steps: 208 | Train Loss: 3.097 Vali Loss: 3.914 Vali Acc: 0.076 Test Loss: 3.914 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.5227425
	speed: 0.1269s/iter; left time: 2520.5372s
	iters: 200, epoch: 5 | loss: 3.1241524
	speed: 0.0380s/iter; left time: 751.3642s
Epoch: 5 cost time: 8.288292169570923
Epoch: 5, Steps: 208 | Train Loss: 2.938 Vali Loss: 3.933 Vali Acc: 0.090 Test Loss: 3.933 Test Acc: 0.090
Validation loss decreased (-0.081680 --> -0.090029).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3089964
	speed: 0.1280s/iter; left time: 2517.4386s
	iters: 200, epoch: 6 | loss: 3.2134614
	speed: 0.0370s/iter; left time: 723.4179s
Epoch: 6 cost time: 8.251590490341187
Epoch: 6, Steps: 208 | Train Loss: 2.793 Vali Loss: 4.051 Vali Acc: 0.095 Test Loss: 4.051 Test Acc: 0.095
Validation loss decreased (-0.090029 --> -0.094800).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6879725
	speed: 0.1273s/iter; left time: 2476.9413s
	iters: 200, epoch: 7 | loss: 2.6194575
	speed: 0.0373s/iter; left time: 721.7754s
Epoch: 7 cost time: 8.24817681312561
Epoch: 7, Steps: 208 | Train Loss: 2.677 Vali Loss: 4.012 Vali Acc: 0.101 Test Loss: 4.012 Test Acc: 0.101
Validation loss decreased (-0.094800 --> -0.101362).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0701625
	speed: 0.1298s/iter; left time: 2498.3703s
	iters: 200, epoch: 8 | loss: 2.3696346
	speed: 0.0375s/iter; left time: 717.6456s
Epoch: 8 cost time: 8.241257667541504
Epoch: 8, Steps: 208 | Train Loss: 2.513 Vali Loss: 4.171 Vali Acc: 0.102 Test Loss: 4.171 Test Acc: 0.102
Validation loss decreased (-0.101362 --> -0.101956).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6793652
	speed: 0.1295s/iter; left time: 2465.2026s
	iters: 200, epoch: 9 | loss: 2.1937807
	speed: 0.0378s/iter; left time: 714.9875s
Epoch: 9 cost time: 8.19051218032837
Epoch: 9, Steps: 208 | Train Loss: 2.408 Vali Loss: 4.289 Vali Acc: 0.105 Test Loss: 4.289 Test Acc: 0.105
Validation loss decreased (-0.101956 --> -0.104938).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5300999
	speed: 0.1253s/iter; left time: 2360.1065s
	iters: 200, epoch: 10 | loss: 2.8015792
	speed: 0.0375s/iter; left time: 701.5011s
Epoch: 10 cost time: 8.06594705581665
Epoch: 10, Steps: 208 | Train Loss: 2.270 Vali Loss: 4.358 Vali Acc: 0.102 Test Loss: 4.358 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2075560
	speed: 0.1300s/iter; left time: 2420.3148s
	iters: 200, epoch: 11 | loss: 2.6827009
	speed: 0.0391s/iter; left time: 723.7749s
Epoch: 11 cost time: 8.377826690673828
Epoch: 11, Steps: 208 | Train Loss: 2.120 Vali Loss: 4.483 Vali Acc: 0.112 Test Loss: 4.483 Test Acc: 0.112
Validation loss decreased (-0.104938 --> -0.111497).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4199005
	speed: 0.1097s/iter; left time: 2019.8331s
	iters: 200, epoch: 12 | loss: 2.7681830
	speed: 0.0278s/iter; left time: 508.7898s
Epoch: 12 cost time: 6.139700412750244
Epoch: 12, Steps: 208 | Train Loss: 1.970 Vali Loss: 4.740 Vali Acc: 0.103 Test Loss: 4.740 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5226921
	speed: 0.1140s/iter; left time: 2074.6092s
	iters: 200, epoch: 13 | loss: 2.5857489
	speed: 0.0292s/iter; left time: 528.9151s
Epoch: 13 cost time: 6.2756266593933105
Epoch: 13, Steps: 208 | Train Loss: 1.878 Vali Loss: 4.765 Vali Acc: 0.118 Test Loss: 4.765 Test Acc: 0.118
Validation loss decreased (-0.111497 --> -0.118056).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8879175
	speed: 0.1153s/iter; left time: 2074.9645s
	iters: 200, epoch: 14 | loss: 2.0283086
	speed: 0.0293s/iter; left time: 525.0745s
Epoch: 14 cost time: 6.544465780258179
Epoch: 14, Steps: 208 | Train Loss: 1.735 Vali Loss: 4.940 Vali Acc: 0.101 Test Loss: 4.940 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6634965
	speed: 0.1166s/iter; left time: 2074.1290s
	iters: 200, epoch: 15 | loss: 1.7781003
	speed: 0.0279s/iter; left time: 493.0159s
Epoch: 15 cost time: 6.238670349121094
Epoch: 15, Steps: 208 | Train Loss: 1.577 Vali Loss: 5.109 Vali Acc: 0.103 Test Loss: 5.109 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3770559
	speed: 0.1134s/iter; left time: 1993.2036s
	iters: 200, epoch: 16 | loss: 1.7228519
	speed: 0.0282s/iter; left time: 493.0915s
Epoch: 16 cost time: 6.292962312698364
Epoch: 16, Steps: 208 | Train Loss: 1.486 Vali Loss: 5.345 Vali Acc: 0.115 Test Loss: 5.345 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6397827
	speed: 0.1119s/iter; left time: 1943.6822s
	iters: 200, epoch: 17 | loss: 1.3766215
	speed: 0.0302s/iter; left time: 521.6165s
Epoch: 17 cost time: 6.607846260070801
Epoch: 17, Steps: 208 | Train Loss: 1.380 Vali Loss: 5.642 Vali Acc: 0.109 Test Loss: 5.642 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.2670162
	speed: 0.1315s/iter; left time: 2256.5713s
	iters: 200, epoch: 18 | loss: 2.0525074
	speed: 0.0378s/iter; left time: 644.5897s
Epoch: 18 cost time: 8.553100824356079
Epoch: 18, Steps: 208 | Train Loss: 1.277 Vali Loss: 5.825 Vali Acc: 0.111 Test Loss: 5.825 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.5969217
	speed: 0.1300s/iter; left time: 2204.5151s
	iters: 200, epoch: 19 | loss: 1.2136987
	speed: 0.0371s/iter; left time: 626.1118s
Epoch: 19 cost time: 8.312190294265747
Epoch: 19, Steps: 208 | Train Loss: 1.184 Vali Loss: 6.115 Vali Acc: 0.112 Test Loss: 6.115 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.0794355
	speed: 0.1283s/iter; left time: 2149.6666s
	iters: 200, epoch: 20 | loss: 1.1877844
	speed: 0.0396s/iter; left time: 659.2611s
Epoch: 20 cost time: 8.388201475143433
Epoch: 20, Steps: 208 | Train Loss: 1.104 Vali Loss: 6.440 Vali Acc: 0.111 Test Loss: 6.440 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8183818
	speed: 0.1280s/iter; left time: 2117.9837s
	iters: 200, epoch: 21 | loss: 0.7600852
	speed: 0.0355s/iter; left time: 583.6112s
Epoch: 21 cost time: 7.8558642864227295
Epoch: 21, Steps: 208 | Train Loss: 1.002 Vali Loss: 6.635 Vali Acc: 0.111 Test Loss: 6.635 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.9510716
	speed: 0.1262s/iter; left time: 2061.3025s
	iters: 200, epoch: 22 | loss: 0.5793875
	speed: 0.0365s/iter; left time: 592.2939s
Epoch: 22 cost time: 7.966745138168335
Epoch: 22, Steps: 208 | Train Loss: 0.932 Vali Loss: 6.994 Vali Acc: 0.107 Test Loss: 6.994 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.1607490
	speed: 0.1334s/iter; left time: 2151.5648s
	iters: 200, epoch: 23 | loss: 0.9369576
	speed: 0.0369s/iter; left time: 591.9572s
Epoch: 23 cost time: 8.108911275863647
Epoch: 23, Steps: 208 | Train Loss: 0.893 Vali Loss: 7.179 Vali Acc: 0.114 Test Loss: 7.179 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1181031911720847
model parameter : 150695
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9056246
	speed: 0.0483s/iter; left time: 999.2839s
	iters: 200, epoch: 1 | loss: 3.5103929
	speed: 0.0329s/iter; left time: 677.6118s
Epoch: 1 cost time: 8.46604323387146
Epoch: 1, Steps: 208 | Train Loss: 3.787 Vali Loss: 3.727 Vali Acc: 0.054 Test Loss: 3.727 Test Acc: 0.054
Validation loss decreased (inf --> -0.053646).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7201095
	speed: 0.1313s/iter; left time: 2690.0363s
	iters: 200, epoch: 2 | loss: 3.5765061
	speed: 0.0375s/iter; left time: 764.9159s
Epoch: 2 cost time: 8.30263638496399
Epoch: 2, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.823 Vali Acc: 0.058 Test Loss: 3.823 Test Acc: 0.058
Validation loss decreased (-0.053646 --> -0.058119).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4632766
	speed: 0.1239s/iter; left time: 2513.6687s
	iters: 200, epoch: 3 | loss: 3.0938973
	speed: 0.0305s/iter; left time: 616.2601s
Epoch: 3 cost time: 6.857504606246948
Epoch: 3, Steps: 208 | Train Loss: 3.363 Vali Loss: 3.779 Vali Acc: 0.074 Test Loss: 3.779 Test Acc: 0.074
Validation loss decreased (-0.058119 --> -0.073926).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0846355
	speed: 0.1142s/iter; left time: 2291.9696s
	iters: 200, epoch: 4 | loss: 2.9691176
	speed: 0.0296s/iter; left time: 591.1960s
Epoch: 4 cost time: 6.381171464920044
Epoch: 4, Steps: 208 | Train Loss: 3.173 Vali Loss: 3.849 Vali Acc: 0.072 Test Loss: 3.849 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.5232201
	speed: 0.1185s/iter; left time: 2354.0399s
	iters: 200, epoch: 5 | loss: 3.9151785
	speed: 0.0275s/iter; left time: 544.2427s
Epoch: 5 cost time: 6.422435998916626
Epoch: 5, Steps: 208 | Train Loss: 3.027 Vali Loss: 3.863 Vali Acc: 0.078 Test Loss: 3.863 Test Acc: 0.078
Validation loss decreased (-0.073926 --> -0.078399).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7155199
	speed: 0.1225s/iter; left time: 2408.4231s
	iters: 200, epoch: 6 | loss: 3.0885119
	speed: 0.0283s/iter; left time: 553.9720s
Epoch: 6 cost time: 6.570593357086182
Epoch: 6, Steps: 208 | Train Loss: 2.896 Vali Loss: 3.975 Vali Acc: 0.084 Test Loss: 3.975 Test Acc: 0.084
Validation loss decreased (-0.078399 --> -0.084362).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2466631
	speed: 0.1197s/iter; left time: 2328.6317s
	iters: 200, epoch: 7 | loss: 2.5559120
	speed: 0.0292s/iter; left time: 565.6806s
Epoch: 7 cost time: 6.60352087020874
Epoch: 7, Steps: 208 | Train Loss: 2.761 Vali Loss: 3.957 Vali Acc: 0.099 Test Loss: 3.957 Test Acc: 0.099
Validation loss decreased (-0.084362 --> -0.098976).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9957590
	speed: 0.1185s/iter; left time: 2280.3971s
	iters: 200, epoch: 8 | loss: 3.4277251
	speed: 0.0357s/iter; left time: 682.7556s
Epoch: 8 cost time: 6.9444966316223145
Epoch: 8, Steps: 208 | Train Loss: 2.620 Vali Loss: 4.015 Vali Acc: 0.099 Test Loss: 4.015 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.0958755
	speed: 0.1308s/iter; left time: 2489.7957s
	iters: 200, epoch: 9 | loss: 2.2613540
	speed: 0.0386s/iter; left time: 731.6620s
Epoch: 9 cost time: 8.30712080001831
Epoch: 9, Steps: 208 | Train Loss: 2.463 Vali Loss: 4.111 Vali Acc: 0.095 Test Loss: 4.111 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6530693
	speed: 0.1344s/iter; left time: 2530.6542s
	iters: 200, epoch: 10 | loss: 2.7975748
	speed: 0.0368s/iter; left time: 688.8947s
Epoch: 10 cost time: 8.2548508644104
Epoch: 10, Steps: 208 | Train Loss: 2.363 Vali Loss: 4.304 Vali Acc: 0.094 Test Loss: 4.304 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.9923403
	speed: 0.1327s/iter; left time: 2470.8605s
	iters: 200, epoch: 11 | loss: 3.0160489
	speed: 0.0366s/iter; left time: 678.7475s
Epoch: 11 cost time: 8.193185567855835
Epoch: 11, Steps: 208 | Train Loss: 2.216 Vali Loss: 4.425 Vali Acc: 0.097 Test Loss: 4.425 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 2.0217295
	speed: 0.1348s/iter; left time: 2481.8286s
	iters: 200, epoch: 12 | loss: 2.6437898
	speed: 0.0400s/iter; left time: 733.1265s
Epoch: 12 cost time: 8.751896142959595
Epoch: 12, Steps: 208 | Train Loss: 2.057 Vali Loss: 4.635 Vali Acc: 0.100 Test Loss: 4.635 Test Acc: 0.100
Validation loss decreased (-0.098976 --> -0.100162).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5776758
	speed: 0.1384s/iter; left time: 2519.4195s
	iters: 200, epoch: 13 | loss: 1.7950139
	speed: 0.0374s/iter; left time: 676.3727s
Epoch: 13 cost time: 8.46087098121643
Epoch: 13, Steps: 208 | Train Loss: 1.954 Vali Loss: 4.714 Vali Acc: 0.115 Test Loss: 4.714 Test Acc: 0.115
Validation loss decreased (-0.100162 --> -0.115372).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0111115
	speed: 0.1332s/iter; left time: 2397.9804s
	iters: 200, epoch: 14 | loss: 2.0281131
	speed: 0.0393s/iter; left time: 702.5637s
Epoch: 14 cost time: 8.356836318969727
Epoch: 14, Steps: 208 | Train Loss: 1.810 Vali Loss: 4.788 Vali Acc: 0.107 Test Loss: 4.788 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7235970
	speed: 0.1314s/iter; left time: 2337.4002s
	iters: 200, epoch: 15 | loss: 1.2087463
	speed: 0.0368s/iter; left time: 650.3529s
Epoch: 15 cost time: 8.159916162490845
Epoch: 15, Steps: 208 | Train Loss: 1.668 Vali Loss: 5.093 Vali Acc: 0.108 Test Loss: 5.093 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.8902955
	speed: 0.1283s/iter; left time: 2256.2076s
	iters: 200, epoch: 16 | loss: 2.0001404
	speed: 0.0380s/iter; left time: 664.0573s
Epoch: 16 cost time: 8.308706760406494
Epoch: 16, Steps: 208 | Train Loss: 1.587 Vali Loss: 5.181 Vali Acc: 0.109 Test Loss: 5.181 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9009272
	speed: 0.1270s/iter; left time: 2205.6158s
	iters: 200, epoch: 17 | loss: 2.2662172
	speed: 0.0394s/iter; left time: 680.2683s
Epoch: 17 cost time: 8.408263206481934
Epoch: 17, Steps: 208 | Train Loss: 1.458 Vali Loss: 5.462 Vali Acc: 0.110 Test Loss: 5.462 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5080797
	speed: 0.1231s/iter; left time: 2112.4314s
	iters: 200, epoch: 18 | loss: 1.4046096
	speed: 0.0277s/iter; left time: 472.2935s
Epoch: 18 cost time: 6.32835054397583
Epoch: 18, Steps: 208 | Train Loss: 1.342 Vali Loss: 5.681 Vali Acc: 0.110 Test Loss: 5.681 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.6855631
	speed: 0.1156s/iter; left time: 1960.7207s
	iters: 200, epoch: 19 | loss: 1.4287316
	speed: 0.0277s/iter; left time: 466.3910s
Epoch: 19 cost time: 6.243640422821045
Epoch: 19, Steps: 208 | Train Loss: 1.228 Vali Loss: 6.075 Vali Acc: 0.110 Test Loss: 6.075 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.0786253
	speed: 0.1216s/iter; left time: 2036.1495s
	iters: 200, epoch: 20 | loss: 1.3854153
	speed: 0.0271s/iter; left time: 450.7692s
Epoch: 20 cost time: 6.261547088623047
Epoch: 20, Steps: 208 | Train Loss: 1.165 Vali Loss: 6.311 Vali Acc: 0.106 Test Loss: 6.311 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.9517160
	speed: 0.1247s/iter; left time: 2062.8306s
	iters: 200, epoch: 21 | loss: 1.0808461
	speed: 0.0283s/iter; left time: 465.6338s
Epoch: 21 cost time: 6.623168468475342
Epoch: 21, Steps: 208 | Train Loss: 1.091 Vali Loss: 6.558 Vali Acc: 0.106 Test Loss: 6.558 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.8740796
	speed: 0.1206s/iter; left time: 1969.3505s
	iters: 200, epoch: 22 | loss: 1.1433024
	speed: 0.0267s/iter; left time: 433.6310s
Epoch: 22 cost time: 6.021835565567017
Epoch: 22, Steps: 208 | Train Loss: 1.021 Vali Loss: 6.729 Vali Acc: 0.106 Test Loss: 6.729 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.8140012
	speed: 0.1207s/iter; left time: 1946.6033s
	iters: 200, epoch: 23 | loss: 1.0256457
	speed: 0.0296s/iter; left time: 474.6426s
Epoch: 23 cost time: 6.465206861495972
Epoch: 23, Steps: 208 | Train Loss: 0.931 Vali Loss: 6.931 Vali Acc: 0.101 Test Loss: 6.931 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm32_nh4_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1154190277363555
model parameter : 123591
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5615268
	speed: 0.0726s/iter; left time: 1503.1656s
	iters: 200, epoch: 1 | loss: 3.4772241
	speed: 0.0566s/iter; left time: 1165.4547s
Epoch: 1 cost time: 13.415909767150879
Epoch: 1, Steps: 208 | Train Loss: 3.944 Vali Loss: 3.867 Vali Acc: 0.065 Test Loss: 3.867 Test Acc: 0.065
Validation loss decreased (inf --> -0.064679).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5841761
	speed: 0.1637s/iter; left time: 3353.7697s
	iters: 200, epoch: 2 | loss: 3.4633951
	speed: 0.0591s/iter; left time: 1204.3630s
Epoch: 2 cost time: 12.107330799102783
Epoch: 2, Steps: 208 | Train Loss: 3.443 Vali Loss: 3.572 Vali Acc: 0.078 Test Loss: 3.572 Test Acc: 0.078
Validation loss decreased (-0.064679 --> -0.077507).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1884851
	speed: 0.1660s/iter; left time: 3368.0088s
	iters: 200, epoch: 3 | loss: 3.1799760
	speed: 0.0550s/iter; left time: 1110.9902s
Epoch: 3 cost time: 11.929446935653687
Epoch: 3, Steps: 208 | Train Loss: 3.104 Vali Loss: 3.705 Vali Acc: 0.095 Test Loss: 3.705 Test Acc: 0.095
Validation loss decreased (-0.077507 --> -0.094505).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7256405
	speed: 0.1719s/iter; left time: 3450.8770s
	iters: 200, epoch: 4 | loss: 2.6438804
	speed: 0.0546s/iter; left time: 1091.6694s
Epoch: 4 cost time: 12.241039514541626
Epoch: 4, Steps: 208 | Train Loss: 2.899 Vali Loss: 4.259 Vali Acc: 0.096 Test Loss: 4.259 Test Acc: 0.096
Validation loss decreased (-0.094505 --> -0.096289).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2260206
	speed: 0.1710s/iter; left time: 3397.2274s
	iters: 200, epoch: 5 | loss: 3.3774512
	speed: 0.0576s/iter; left time: 1138.7741s
Epoch: 5 cost time: 12.369550704956055
Epoch: 5, Steps: 208 | Train Loss: 2.722 Vali Loss: 4.338 Vali Acc: 0.098 Test Loss: 4.338 Test Acc: 0.098
Validation loss decreased (-0.096289 --> -0.097481).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2458341
	speed: 0.1711s/iter; left time: 3364.8175s
	iters: 200, epoch: 6 | loss: 2.9425826
	speed: 0.0559s/iter; left time: 1094.3960s
Epoch: 6 cost time: 12.344239950180054
Epoch: 6, Steps: 208 | Train Loss: 2.376 Vali Loss: 4.891 Vali Acc: 0.084 Test Loss: 4.891 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7044599
	speed: 0.1672s/iter; left time: 3251.6472s
	iters: 200, epoch: 7 | loss: 2.4664145
	speed: 0.0573s/iter; left time: 1108.9475s
Epoch: 7 cost time: 12.264065504074097
Epoch: 7, Steps: 208 | Train Loss: 2.096 Vali Loss: 4.910 Vali Acc: 0.100 Test Loss: 4.910 Test Acc: 0.100
Validation loss decreased (-0.097481 --> -0.100160).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1574744
	speed: 0.1680s/iter; left time: 3233.7826s
	iters: 200, epoch: 8 | loss: 2.4157910
	speed: 0.0595s/iter; left time: 1138.2690s
Epoch: 8 cost time: 12.4923734664917
Epoch: 8, Steps: 208 | Train Loss: 1.783 Vali Loss: 5.121 Vali Acc: 0.098 Test Loss: 5.121 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8926220
	speed: 0.1482s/iter; left time: 2820.7663s
	iters: 200, epoch: 9 | loss: 2.3379700
	speed: 0.0369s/iter; left time: 698.0529s
Epoch: 9 cost time: 8.431946277618408
Epoch: 9, Steps: 208 | Train Loss: 1.481 Vali Loss: 5.587 Vali Acc: 0.105 Test Loss: 5.587 Test Acc: 0.105
Validation loss decreased (-0.100160 --> -0.104925).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5481954
	speed: 0.1411s/iter; left time: 2657.2517s
	iters: 200, epoch: 10 | loss: 1.5535148
	speed: 0.0450s/iter; left time: 843.6388s
Epoch: 10 cost time: 9.421501159667969
Epoch: 10, Steps: 208 | Train Loss: 1.240 Vali Loss: 6.179 Vali Acc: 0.098 Test Loss: 6.179 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1155611
	speed: 0.1497s/iter; left time: 2787.9832s
	iters: 200, epoch: 11 | loss: 1.7695305
	speed: 0.0367s/iter; left time: 680.4188s
Epoch: 11 cost time: 8.636713027954102
Epoch: 11, Steps: 208 | Train Loss: 1.063 Vali Loss: 6.669 Vali Acc: 0.103 Test Loss: 6.669 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.5723137
	speed: 0.1467s/iter; left time: 2700.6958s
	iters: 200, epoch: 12 | loss: 0.9458669
	speed: 0.0449s/iter; left time: 822.4953s
Epoch: 12 cost time: 9.759933471679688
Epoch: 12, Steps: 208 | Train Loss: 0.938 Vali Loss: 7.564 Vali Acc: 0.106 Test Loss: 7.564 Test Acc: 0.106
Validation loss decreased (-0.104925 --> -0.106098).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7984941
	speed: 0.1404s/iter; left time: 2556.8029s
	iters: 200, epoch: 13 | loss: 1.2000166
	speed: 0.0417s/iter; left time: 755.8556s
Epoch: 13 cost time: 8.941678285598755
Epoch: 13, Steps: 208 | Train Loss: 0.802 Vali Loss: 8.140 Vali Acc: 0.100 Test Loss: 8.140 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4490080
	speed: 0.1440s/iter; left time: 2592.1381s
	iters: 200, epoch: 14 | loss: 0.5110253
	speed: 0.0520s/iter; left time: 930.3497s
Epoch: 14 cost time: 10.463945627212524
Epoch: 14, Steps: 208 | Train Loss: 0.679 Vali Loss: 8.392 Vali Acc: 0.107 Test Loss: 8.392 Test Acc: 0.107
Validation loss decreased (-0.106098 --> -0.106984).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5645707
	speed: 0.1654s/iter; left time: 2942.8606s
	iters: 200, epoch: 15 | loss: 0.6073448
	speed: 0.0554s/iter; left time: 980.1716s
Epoch: 15 cost time: 12.170246839523315
Epoch: 15, Steps: 208 | Train Loss: 0.596 Vali Loss: 9.061 Vali Acc: 0.104 Test Loss: 9.061 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1964264
	speed: 0.1689s/iter; left time: 2968.6765s
	iters: 200, epoch: 16 | loss: 0.5598385
	speed: 0.0557s/iter; left time: 974.3235s
Epoch: 16 cost time: 12.042147874832153
Epoch: 16, Steps: 208 | Train Loss: 0.516 Vali Loss: 9.703 Vali Acc: 0.102 Test Loss: 9.703 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4040670
	speed: 0.1737s/iter; left time: 3017.5570s
	iters: 200, epoch: 17 | loss: 0.4942190
	speed: 0.0588s/iter; left time: 1015.7505s
Epoch: 17 cost time: 12.75826382637024
Epoch: 17, Steps: 208 | Train Loss: 0.474 Vali Loss: 10.398 Vali Acc: 0.106 Test Loss: 10.398 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0792980
	speed: 0.1805s/iter; left time: 3097.7680s
	iters: 200, epoch: 18 | loss: 0.4744595
	speed: 0.0611s/iter; left time: 1043.0874s
Epoch: 18 cost time: 13.291746377944946
Epoch: 18, Steps: 208 | Train Loss: 0.446 Vali Loss: 10.896 Vali Acc: 0.097 Test Loss: 10.896 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2393280
	speed: 0.1773s/iter; left time: 3005.6909s
	iters: 200, epoch: 19 | loss: 1.4822596
	speed: 0.0623s/iter; left time: 1049.7781s
Epoch: 19 cost time: 13.266130924224854
Epoch: 19, Steps: 208 | Train Loss: 0.394 Vali Loss: 10.348 Vali Acc: 0.110 Test Loss: 10.348 Test Acc: 0.110
Validation loss decreased (-0.106984 --> -0.109649).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4096875
	speed: 0.1801s/iter; left time: 3015.9719s
	iters: 200, epoch: 20 | loss: 0.0915604
	speed: 0.0637s/iter; left time: 1061.1871s
Epoch: 20 cost time: 13.481686115264893
Epoch: 20, Steps: 208 | Train Loss: 0.339 Vali Loss: 11.641 Vali Acc: 0.105 Test Loss: 11.641 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0947072
	speed: 0.1824s/iter; left time: 3017.1815s
	iters: 200, epoch: 21 | loss: 0.5014051
	speed: 0.0624s/iter; left time: 1026.6193s
Epoch: 21 cost time: 13.53963828086853
Epoch: 21, Steps: 208 | Train Loss: 0.338 Vali Loss: 12.107 Vali Acc: 0.101 Test Loss: 12.107 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2691975
	speed: 0.1830s/iter; left time: 2989.4711s
	iters: 200, epoch: 22 | loss: 0.2443905
	speed: 0.0640s/iter; left time: 1038.1839s
Epoch: 22 cost time: 13.51148247718811
Epoch: 22, Steps: 208 | Train Loss: 0.279 Vali Loss: 11.828 Vali Acc: 0.102 Test Loss: 11.828 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1428003
	speed: 0.1828s/iter; left time: 2947.0110s
	iters: 200, epoch: 23 | loss: 0.1553436
	speed: 0.0631s/iter; left time: 1010.5327s
Epoch: 23 cost time: 13.56535029411316
Epoch: 23, Steps: 208 | Train Loss: 0.280 Vali Loss: 12.357 Vali Acc: 0.095 Test Loss: 12.357 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0379672
	speed: 0.1571s/iter; left time: 2500.5180s
	iters: 200, epoch: 24 | loss: 0.2325021
	speed: 0.0498s/iter; left time: 787.0655s
Epoch: 24 cost time: 10.718125820159912
Epoch: 24, Steps: 208 | Train Loss: 0.265 Vali Loss: 12.780 Vali Acc: 0.106 Test Loss: 12.780 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0814789
	speed: 0.1486s/iter; left time: 2334.8876s
	iters: 200, epoch: 25 | loss: 0.7451695
	speed: 0.0464s/iter; left time: 723.8420s
Epoch: 25 cost time: 9.935574293136597
Epoch: 25, Steps: 208 | Train Loss: 0.222 Vali Loss: 13.739 Vali Acc: 0.103 Test Loss: 13.739 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.4795795
	speed: 0.1451s/iter; left time: 2248.8289s
	iters: 200, epoch: 26 | loss: 0.3285235
	speed: 0.0437s/iter; left time: 672.2997s
Epoch: 26 cost time: 9.309669017791748
Epoch: 26, Steps: 208 | Train Loss: 0.293 Vali Loss: 13.138 Vali Acc: 0.102 Test Loss: 13.138 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0061775
	speed: 0.1523s/iter; left time: 2329.1250s
	iters: 200, epoch: 27 | loss: 0.2759431
	speed: 0.0435s/iter; left time: 661.2289s
Epoch: 27 cost time: 9.785613298416138
Epoch: 27, Steps: 208 | Train Loss: 0.219 Vali Loss: 14.185 Vali Acc: 0.100 Test Loss: 14.185 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0849406
	speed: 0.1358s/iter; left time: 2048.0202s
	iters: 200, epoch: 28 | loss: 0.0878562
	speed: 0.0422s/iter; left time: 632.9561s
Epoch: 28 cost time: 8.939655542373657
Epoch: 28, Steps: 208 | Train Loss: 0.212 Vali Loss: 14.519 Vali Acc: 0.101 Test Loss: 14.519 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.1461771
	speed: 0.1543s/iter; left time: 2295.5768s
	iters: 200, epoch: 29 | loss: 0.0973444
	speed: 0.0483s/iter; left time: 713.7885s
Epoch: 29 cost time: 10.377744197845459
Epoch: 29, Steps: 208 | Train Loss: 0.203 Vali Loss: 14.060 Vali Acc: 0.098 Test Loss: 14.060 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10975246048314942
model parameter : 523223
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7482591
	speed: 0.0559s/iter; left time: 1157.8395s
	iters: 200, epoch: 1 | loss: 3.3176808
	speed: 0.0369s/iter; left time: 759.9961s
Epoch: 1 cost time: 9.63192105293274
Epoch: 1, Steps: 208 | Train Loss: 3.829 Vali Loss: 3.746 Vali Acc: 0.060 Test Loss: 3.746 Test Acc: 0.060
Validation loss decreased (inf --> -0.059909).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5905919
	speed: 0.1393s/iter; left time: 2855.4092s
	iters: 200, epoch: 2 | loss: 3.8691967
	speed: 0.0423s/iter; left time: 863.3508s
Epoch: 2 cost time: 9.276211261749268
Epoch: 2, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.630 Vali Acc: 0.077 Test Loss: 3.630 Test Acc: 0.077
Validation loss decreased (-0.059909 --> -0.077208).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9362285
	speed: 0.1364s/iter; left time: 2766.3033s
	iters: 200, epoch: 3 | loss: 3.5025487
	speed: 0.0436s/iter; left time: 880.2345s
Epoch: 3 cost time: 9.392461061477661
Epoch: 3, Steps: 208 | Train Loss: 3.174 Vali Loss: 3.888 Vali Acc: 0.068 Test Loss: 3.888 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6467929
	speed: 0.1334s/iter; left time: 2677.5976s
	iters: 200, epoch: 4 | loss: 3.7754076
	speed: 0.0423s/iter; left time: 845.9861s
Epoch: 4 cost time: 9.122365474700928
Epoch: 4, Steps: 208 | Train Loss: 3.000 Vali Loss: 4.099 Vali Acc: 0.089 Test Loss: 4.099 Test Acc: 0.089
Validation loss decreased (-0.077208 --> -0.089133).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9763620
	speed: 0.1345s/iter; left time: 2672.4508s
	iters: 200, epoch: 5 | loss: 2.8956652
	speed: 0.0413s/iter; left time: 816.4825s
Epoch: 5 cost time: 9.141168594360352
Epoch: 5, Steps: 208 | Train Loss: 2.774 Vali Loss: 3.991 Vali Acc: 0.104 Test Loss: 3.991 Test Acc: 0.104
Validation loss decreased (-0.089133 --> -0.104046).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3717587
	speed: 0.1394s/iter; left time: 2739.8305s
	iters: 200, epoch: 6 | loss: 3.0559669
	speed: 0.0427s/iter; left time: 836.1641s
Epoch: 6 cost time: 9.357591390609741
Epoch: 6, Steps: 208 | Train Loss: 2.640 Vali Loss: 3.842 Vali Acc: 0.107 Test Loss: 3.842 Test Acc: 0.107
Validation loss decreased (-0.104046 --> -0.107328).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0530405
	speed: 0.1357s/iter; left time: 2640.4554s
	iters: 200, epoch: 7 | loss: 2.6765800
	speed: 0.0425s/iter; left time: 822.6883s
Epoch: 7 cost time: 9.336315631866455
Epoch: 7, Steps: 208 | Train Loss: 2.417 Vali Loss: 4.007 Vali Acc: 0.105 Test Loss: 4.007 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9427179
	speed: 0.1307s/iter; left time: 2515.3804s
	iters: 200, epoch: 8 | loss: 2.1703119
	speed: 0.0393s/iter; left time: 752.8181s
Epoch: 8 cost time: 8.569978475570679
Epoch: 8, Steps: 208 | Train Loss: 2.248 Vali Loss: 4.239 Vali Acc: 0.103 Test Loss: 4.239 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.1734886
	speed: 0.1347s/iter; left time: 2563.7807s
	iters: 200, epoch: 9 | loss: 2.9946444
	speed: 0.0402s/iter; left time: 760.6779s
Epoch: 9 cost time: 8.904829263687134
Epoch: 9, Steps: 208 | Train Loss: 2.061 Vali Loss: 4.465 Vali Acc: 0.107 Test Loss: 4.465 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9702715
	speed: 0.1232s/iter; left time: 2319.9911s
	iters: 200, epoch: 10 | loss: 2.6353414
	speed: 0.0320s/iter; left time: 599.7341s
Epoch: 10 cost time: 7.224086761474609
Epoch: 10, Steps: 208 | Train Loss: 1.895 Vali Loss: 4.902 Vali Acc: 0.112 Test Loss: 4.902 Test Acc: 0.112
Validation loss decreased (-0.107328 --> -0.112388).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6968248
	speed: 0.1252s/iter; left time: 2332.0646s
	iters: 200, epoch: 11 | loss: 2.1691959
	speed: 0.0337s/iter; left time: 624.9205s
Epoch: 11 cost time: 7.382626056671143
Epoch: 11, Steps: 208 | Train Loss: 1.730 Vali Loss: 4.983 Vali Acc: 0.117 Test Loss: 4.983 Test Acc: 0.117
Validation loss decreased (-0.112388 --> -0.116860).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2160487
	speed: 0.1296s/iter; left time: 2386.6550s
	iters: 200, epoch: 12 | loss: 2.3699756
	speed: 0.0281s/iter; left time: 513.7114s
Epoch: 12 cost time: 7.023868083953857
Epoch: 12, Steps: 208 | Train Loss: 1.594 Vali Loss: 5.076 Vali Acc: 0.112 Test Loss: 5.076 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2957119
	speed: 0.1231s/iter; left time: 2240.2858s
	iters: 200, epoch: 13 | loss: 1.9888980
	speed: 0.0317s/iter; left time: 574.2082s
Epoch: 13 cost time: 7.000537395477295
Epoch: 13, Steps: 208 | Train Loss: 1.470 Vali Loss: 5.318 Vali Acc: 0.104 Test Loss: 5.318 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3995707
	speed: 0.1175s/iter; left time: 2115.1350s
	iters: 200, epoch: 14 | loss: 1.7270378
	speed: 0.0306s/iter; left time: 547.2599s
Epoch: 14 cost time: 6.751984119415283
Epoch: 14, Steps: 208 | Train Loss: 1.355 Vali Loss: 5.779 Vali Acc: 0.112 Test Loss: 5.779 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7623069
	speed: 0.1225s/iter; left time: 2178.4276s
	iters: 200, epoch: 15 | loss: 1.5187538
	speed: 0.0341s/iter; left time: 603.1005s
Epoch: 15 cost time: 7.482601165771484
Epoch: 15, Steps: 208 | Train Loss: 1.206 Vali Loss: 5.929 Vali Acc: 0.111 Test Loss: 5.929 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.7151083
	speed: 0.1347s/iter; left time: 2368.7322s
	iters: 200, epoch: 16 | loss: 1.0847479
	speed: 0.0413s/iter; left time: 722.0799s
Epoch: 16 cost time: 8.870968580245972
Epoch: 16, Steps: 208 | Train Loss: 1.127 Vali Loss: 6.064 Vali Acc: 0.110 Test Loss: 6.064 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5942515
	speed: 0.1436s/iter; left time: 2494.2202s
	iters: 200, epoch: 17 | loss: 1.8336401
	speed: 0.0419s/iter; left time: 724.2942s
Epoch: 17 cost time: 9.07141375541687
Epoch: 17, Steps: 208 | Train Loss: 1.014 Vali Loss: 6.433 Vali Acc: 0.115 Test Loss: 6.433 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.5199932
	speed: 0.1419s/iter; left time: 2436.4723s
	iters: 200, epoch: 18 | loss: 1.1511602
	speed: 0.0385s/iter; left time: 657.3918s
Epoch: 18 cost time: 8.740633249282837
Epoch: 18, Steps: 208 | Train Loss: 0.932 Vali Loss: 6.945 Vali Acc: 0.115 Test Loss: 6.945 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1881993
	speed: 0.1329s/iter; left time: 2254.0892s
	iters: 200, epoch: 19 | loss: 1.3234286
	speed: 0.0397s/iter; left time: 668.8190s
Epoch: 19 cost time: 8.780252933502197
Epoch: 19, Steps: 208 | Train Loss: 0.859 Vali Loss: 7.141 Vali Acc: 0.117 Test Loss: 7.141 Test Acc: 0.117
Validation loss decreased (-0.116860 --> -0.117137).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6954376
	speed: 0.1391s/iter; left time: 2330.0386s
	iters: 200, epoch: 20 | loss: 1.1098804
	speed: 0.0395s/iter; left time: 658.2347s
Epoch: 20 cost time: 8.731062173843384
Epoch: 20, Steps: 208 | Train Loss: 0.808 Vali Loss: 7.678 Vali Acc: 0.114 Test Loss: 7.678 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.6354227
	speed: 0.1371s/iter; left time: 2267.9311s
	iters: 200, epoch: 21 | loss: 1.3200275
	speed: 0.0413s/iter; left time: 679.2559s
Epoch: 21 cost time: 9.15929365158081
Epoch: 21, Steps: 208 | Train Loss: 0.752 Vali Loss: 7.908 Vali Acc: 0.101 Test Loss: 7.908 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4807373
	speed: 0.1411s/iter; left time: 2304.7971s
	iters: 200, epoch: 22 | loss: 1.0855763
	speed: 0.0419s/iter; left time: 680.4971s
Epoch: 22 cost time: 9.210136651992798
Epoch: 22, Steps: 208 | Train Loss: 0.716 Vali Loss: 8.048 Vali Acc: 0.104 Test Loss: 8.048 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.5679895
	speed: 0.1362s/iter; left time: 2196.7995s
	iters: 200, epoch: 23 | loss: 0.8775909
	speed: 0.0430s/iter; left time: 688.3660s
Epoch: 23 cost time: 9.139849424362183
Epoch: 23, Steps: 208 | Train Loss: 0.637 Vali Loss: 8.133 Vali Acc: 0.115 Test Loss: 8.133 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.5690584
	speed: 0.1344s/iter; left time: 2138.6809s
	iters: 200, epoch: 24 | loss: 0.8244367
	speed: 0.0399s/iter; left time: 631.8796s
Epoch: 24 cost time: 8.87209677696228
Epoch: 24, Steps: 208 | Train Loss: 0.623 Vali Loss: 8.902 Vali Acc: 0.106 Test Loss: 8.902 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.3479078
	speed: 0.1374s/iter; left time: 2157.8539s
	iters: 200, epoch: 25 | loss: 0.6249369
	speed: 0.0401s/iter; left time: 626.1097s
Epoch: 25 cost time: 9.0278959274292
Epoch: 25, Steps: 208 | Train Loss: 0.562 Vali Loss: 8.869 Vali Acc: 0.116 Test Loss: 8.869 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.1928885
	speed: 0.1227s/iter; left time: 1901.4629s
	iters: 200, epoch: 26 | loss: 0.6885738
	speed: 0.0355s/iter; left time: 546.5840s
Epoch: 26 cost time: 7.526232957839966
Epoch: 26, Steps: 208 | Train Loss: 0.559 Vali Loss: 9.263 Vali Acc: 0.111 Test Loss: 9.263 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.4757442
	speed: 0.1280s/iter; left time: 1956.8333s
	iters: 200, epoch: 27 | loss: 0.3740057
	speed: 0.0351s/iter; left time: 533.7380s
Epoch: 27 cost time: 7.724763870239258
Epoch: 27, Steps: 208 | Train Loss: 0.499 Vali Loss: 9.157 Vali Acc: 0.113 Test Loss: 9.157 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2237665
	speed: 0.1248s/iter; left time: 1882.5559s
	iters: 200, epoch: 28 | loss: 0.3806606
	speed: 0.0314s/iter; left time: 469.8600s
Epoch: 28 cost time: 6.998124599456787
Epoch: 28, Steps: 208 | Train Loss: 0.472 Vali Loss: 9.782 Vali Acc: 0.112 Test Loss: 9.782 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.3291801
	speed: 0.1207s/iter; left time: 1796.2808s
	iters: 200, epoch: 29 | loss: 0.7788001
	speed: 0.0325s/iter; left time: 479.7581s
Epoch: 29 cost time: 7.018171787261963
Epoch: 29, Steps: 208 | Train Loss: 0.468 Vali Loss: 9.941 Vali Acc: 0.110 Test Loss: 9.941 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11720847002684164
model parameter : 276199
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0145602
	speed: 0.0562s/iter; left time: 1163.1776s
	iters: 200, epoch: 1 | loss: 3.8043845
	speed: 0.0363s/iter; left time: 748.7649s
Epoch: 1 cost time: 9.68764042854309
Epoch: 1, Steps: 208 | Train Loss: 3.813 Vali Loss: 3.703 Vali Acc: 0.058 Test Loss: 3.703 Test Acc: 0.058
Validation loss decreased (inf --> -0.057523).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1095600
	speed: 0.1347s/iter; left time: 2759.6683s
	iters: 200, epoch: 2 | loss: 3.9810870
	speed: 0.0381s/iter; left time: 777.1437s
Epoch: 2 cost time: 8.46568489074707
Epoch: 2, Steps: 208 | Train Loss: 3.451 Vali Loss: 3.763 Vali Acc: 0.073 Test Loss: 3.763 Test Acc: 0.073
Validation loss decreased (-0.057523 --> -0.073031).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4993651
	speed: 0.1329s/iter; left time: 2694.9000s
	iters: 200, epoch: 3 | loss: 3.5129013
	speed: 0.0396s/iter; left time: 798.5715s
Epoch: 3 cost time: 8.486126184463501
Epoch: 3, Steps: 208 | Train Loss: 3.168 Vali Loss: 3.758 Vali Acc: 0.085 Test Loss: 3.758 Test Acc: 0.085
Validation loss decreased (-0.073031 --> -0.085259).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8680613
	speed: 0.1372s/iter; left time: 2754.2740s
	iters: 200, epoch: 4 | loss: 3.3035135
	speed: 0.0390s/iter; left time: 778.2635s
Epoch: 4 cost time: 8.579946041107178
Epoch: 4, Steps: 208 | Train Loss: 2.984 Vali Loss: 3.805 Vali Acc: 0.082 Test Loss: 3.805 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.5588365
	speed: 0.1315s/iter; left time: 2613.7583s
	iters: 200, epoch: 5 | loss: 2.8939347
	speed: 0.0366s/iter; left time: 724.1231s
Epoch: 5 cost time: 8.095004320144653
Epoch: 5, Steps: 208 | Train Loss: 2.814 Vali Loss: 3.887 Vali Acc: 0.094 Test Loss: 3.887 Test Acc: 0.094
Validation loss decreased (-0.085259 --> -0.093907).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7725070
	speed: 0.1273s/iter; left time: 2502.7373s
	iters: 200, epoch: 6 | loss: 2.6629717
	speed: 0.0375s/iter; left time: 733.3211s
Epoch: 6 cost time: 8.120179891586304
Epoch: 6, Steps: 208 | Train Loss: 2.675 Vali Loss: 4.022 Vali Acc: 0.098 Test Loss: 4.022 Test Acc: 0.098
Validation loss decreased (-0.093907 --> -0.098081).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4560122
	speed: 0.1278s/iter; left time: 2485.2979s
	iters: 200, epoch: 7 | loss: 3.6313894
	speed: 0.0370s/iter; left time: 715.3686s
Epoch: 7 cost time: 8.056288719177246
Epoch: 7, Steps: 208 | Train Loss: 2.500 Vali Loss: 4.246 Vali Acc: 0.096 Test Loss: 4.246 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8159173
	speed: 0.1311s/iter; left time: 2523.7024s
	iters: 200, epoch: 8 | loss: 3.1369827
	speed: 0.0390s/iter; left time: 747.3404s
Epoch: 8 cost time: 8.454670429229736
Epoch: 8, Steps: 208 | Train Loss: 2.360 Vali Loss: 4.154 Vali Acc: 0.109 Test Loss: 4.154 Test Acc: 0.109
Validation loss decreased (-0.098081 --> -0.109114).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7595891
	speed: 0.1323s/iter; left time: 2518.2780s
	iters: 200, epoch: 9 | loss: 2.8276060
	speed: 0.0387s/iter; left time: 732.8410s
Epoch: 9 cost time: 8.508287191390991
Epoch: 9, Steps: 208 | Train Loss: 2.193 Vali Loss: 4.403 Vali Acc: 0.107 Test Loss: 4.403 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2729297
	speed: 0.1282s/iter; left time: 2413.3797s
	iters: 200, epoch: 10 | loss: 2.2803085
	speed: 0.0404s/iter; left time: 756.4023s
Epoch: 10 cost time: 8.734466552734375
Epoch: 10, Steps: 208 | Train Loss: 2.060 Vali Loss: 4.680 Vali Acc: 0.102 Test Loss: 4.680 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.2438092
	speed: 0.1132s/iter; left time: 2108.4881s
	iters: 200, epoch: 11 | loss: 2.4777033
	speed: 0.0297s/iter; left time: 550.3034s
Epoch: 11 cost time: 6.612308740615845
Epoch: 11, Steps: 208 | Train Loss: 1.932 Vali Loss: 4.552 Vali Acc: 0.106 Test Loss: 4.552 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4498578
	speed: 0.1128s/iter; left time: 2077.1677s
	iters: 200, epoch: 12 | loss: 1.8251929
	speed: 0.0293s/iter; left time: 536.8882s
Epoch: 12 cost time: 6.6879050731658936
Epoch: 12, Steps: 208 | Train Loss: 1.795 Vali Loss: 5.099 Vali Acc: 0.102 Test Loss: 5.099 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6935909
	speed: 0.1210s/iter; left time: 2203.6483s
	iters: 200, epoch: 13 | loss: 1.8846896
	speed: 0.0303s/iter; left time: 549.0785s
Epoch: 13 cost time: 6.829690456390381
Epoch: 13, Steps: 208 | Train Loss: 1.694 Vali Loss: 5.052 Vali Acc: 0.106 Test Loss: 5.052 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.6583418
	speed: 0.1194s/iter; left time: 2149.5666s
	iters: 200, epoch: 14 | loss: 1.7027690
	speed: 0.0306s/iter; left time: 547.0747s
Epoch: 14 cost time: 6.8646790981292725
Epoch: 14, Steps: 208 | Train Loss: 1.564 Vali Loss: 5.257 Vali Acc: 0.106 Test Loss: 5.257 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.6281095
	speed: 0.1260s/iter; left time: 2242.1940s
	iters: 200, epoch: 15 | loss: 1.2600459
	speed: 0.0295s/iter; left time: 522.6500s
Epoch: 15 cost time: 6.732174634933472
Epoch: 15, Steps: 208 | Train Loss: 1.480 Vali Loss: 5.519 Vali Acc: 0.100 Test Loss: 5.519 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.2117774
	speed: 0.1134s/iter; left time: 1993.3451s
	iters: 200, epoch: 16 | loss: 2.0141468
	speed: 0.0262s/iter; left time: 458.2373s
Epoch: 16 cost time: 6.053323030471802
Epoch: 16, Steps: 208 | Train Loss: 1.378 Vali Loss: 5.675 Vali Acc: 0.109 Test Loss: 5.675 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.3425703
	speed: 0.1197s/iter; left time: 2079.9034s
	iters: 200, epoch: 17 | loss: 1.6467292
	speed: 0.0344s/iter; left time: 593.7060s
Epoch: 17 cost time: 7.7451348304748535
Epoch: 17, Steps: 208 | Train Loss: 1.310 Vali Loss: 5.990 Vali Acc: 0.107 Test Loss: 5.990 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.3980167
	speed: 0.1250s/iter; left time: 2145.4646s
	iters: 200, epoch: 18 | loss: 1.5305581
	speed: 0.0357s/iter; left time: 609.6297s
Epoch: 18 cost time: 7.856236219406128
Epoch: 18, Steps: 208 | Train Loss: 1.200 Vali Loss: 6.204 Vali Acc: 0.103 Test Loss: 6.204 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10915597971965404
model parameter : 193927
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4360600
	speed: 0.0532s/iter; left time: 1100.5129s
	iters: 200, epoch: 1 | loss: 3.4387963
	speed: 0.0351s/iter; left time: 723.4763s
Epoch: 1 cost time: 9.177128076553345
Epoch: 1, Steps: 208 | Train Loss: 3.765 Vali Loss: 3.712 Vali Acc: 0.058 Test Loss: 3.712 Test Acc: 0.058
Validation loss decreased (inf --> -0.057822).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3083904
	speed: 0.1199s/iter; left time: 2457.8488s
	iters: 200, epoch: 2 | loss: 3.2287674
	speed: 0.0349s/iter; left time: 711.5059s
Epoch: 2 cost time: 7.613062620162964
Epoch: 2, Steps: 208 | Train Loss: 3.483 Vali Loss: 3.630 Vali Acc: 0.078 Test Loss: 3.630 Test Acc: 0.078
Validation loss decreased (-0.057822 --> -0.077506).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4947917
	speed: 0.1192s/iter; left time: 2418.7074s
	iters: 200, epoch: 3 | loss: 2.9557271
	speed: 0.0344s/iter; left time: 694.8550s
Epoch: 3 cost time: 7.269510746002197
Epoch: 3, Steps: 208 | Train Loss: 3.246 Vali Loss: 3.624 Vali Acc: 0.081 Test Loss: 3.624 Test Acc: 0.081
Validation loss decreased (-0.077506 --> -0.080787).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2635949
	speed: 0.1165s/iter; left time: 2339.4209s
	iters: 200, epoch: 4 | loss: 3.2452078
	speed: 0.0329s/iter; left time: 657.6574s
Epoch: 4 cost time: 7.156440734863281
Epoch: 4, Steps: 208 | Train Loss: 3.087 Vali Loss: 3.788 Vali Acc: 0.085 Test Loss: 3.788 Test Acc: 0.085
Validation loss decreased (-0.080787 --> -0.084961).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4383938
	speed: 0.1206s/iter; left time: 2395.6104s
	iters: 200, epoch: 5 | loss: 3.4429529
	speed: 0.0338s/iter; left time: 668.8501s
Epoch: 5 cost time: 7.108199119567871
Epoch: 5, Steps: 208 | Train Loss: 2.955 Vali Loss: 3.878 Vali Acc: 0.079 Test Loss: 3.878 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4109223
	speed: 0.1231s/iter; left time: 2419.2864s
	iters: 200, epoch: 6 | loss: 3.1497409
	speed: 0.0332s/iter; left time: 649.0549s
Epoch: 6 cost time: 7.420252799987793
Epoch: 6, Steps: 208 | Train Loss: 2.785 Vali Loss: 3.930 Vali Acc: 0.092 Test Loss: 3.930 Test Acc: 0.092
Validation loss decreased (-0.084961 --> -0.091819).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3060007
	speed: 0.1287s/iter; left time: 2503.4660s
	iters: 200, epoch: 7 | loss: 2.9638762
	speed: 0.0356s/iter; left time: 688.1111s
Epoch: 7 cost time: 7.961994409561157
Epoch: 7, Steps: 208 | Train Loss: 2.649 Vali Loss: 3.788 Vali Acc: 0.105 Test Loss: 3.788 Test Acc: 0.105
Validation loss decreased (-0.091819 --> -0.104644).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9752209
	speed: 0.1262s/iter; left time: 2428.5344s
	iters: 200, epoch: 8 | loss: 2.6395378
	speed: 0.0354s/iter; left time: 677.9826s
Epoch: 8 cost time: 7.765615463256836
Epoch: 8, Steps: 208 | Train Loss: 2.539 Vali Loss: 4.000 Vali Acc: 0.098 Test Loss: 4.000 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6610411
	speed: 0.1261s/iter; left time: 2399.8454s
	iters: 200, epoch: 9 | loss: 1.9015437
	speed: 0.0358s/iter; left time: 678.0029s
Epoch: 9 cost time: 7.866606950759888
Epoch: 9, Steps: 208 | Train Loss: 2.402 Vali Loss: 3.975 Vali Acc: 0.106 Test Loss: 3.975 Test Acc: 0.106
Validation loss decreased (-0.104644 --> -0.105836).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0783131
	speed: 0.1287s/iter; left time: 2422.7765s
	iters: 200, epoch: 10 | loss: 2.3254035
	speed: 0.0363s/iter; left time: 680.2619s
Epoch: 10 cost time: 7.87297248840332
Epoch: 10, Steps: 208 | Train Loss: 2.292 Vali Loss: 3.961 Vali Acc: 0.115 Test Loss: 3.961 Test Acc: 0.115
Validation loss decreased (-0.105836 --> -0.115379).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1109109
	speed: 0.1125s/iter; left time: 2094.4768s
	iters: 200, epoch: 11 | loss: 2.2327414
	speed: 0.0292s/iter; left time: 541.6052s
Epoch: 11 cost time: 6.589047908782959
Epoch: 11, Steps: 208 | Train Loss: 2.145 Vali Loss: 4.157 Vali Acc: 0.114 Test Loss: 4.157 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7796756
	speed: 0.1169s/iter; left time: 2151.6732s
	iters: 200, epoch: 12 | loss: 2.4159961
	speed: 0.0294s/iter; left time: 539.2866s
Epoch: 12 cost time: 6.539546012878418
Epoch: 12, Steps: 208 | Train Loss: 2.036 Vali Loss: 4.251 Vali Acc: 0.115 Test Loss: 4.251 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.7473557
	speed: 0.1078s/iter; left time: 1963.2056s
	iters: 200, epoch: 13 | loss: 2.6470635
	speed: 0.0296s/iter; left time: 535.3534s
Epoch: 13 cost time: 6.323852062225342
Epoch: 13, Steps: 208 | Train Loss: 1.934 Vali Loss: 4.316 Vali Acc: 0.115 Test Loss: 4.316 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.3348441
	speed: 0.1178s/iter; left time: 2120.2489s
	iters: 200, epoch: 14 | loss: 1.8659699
	speed: 0.0307s/iter; left time: 549.3940s
Epoch: 14 cost time: 6.6525774002075195
Epoch: 14, Steps: 208 | Train Loss: 1.830 Vali Loss: 4.453 Vali Acc: 0.120 Test Loss: 4.453 Test Acc: 0.120
Validation loss decreased (-0.115379 --> -0.120146).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4292102
	speed: 0.1196s/iter; left time: 2126.9388s
	iters: 200, epoch: 15 | loss: 2.0583873
	speed: 0.0276s/iter; left time: 487.9640s
Epoch: 15 cost time: 6.522733926773071
Epoch: 15, Steps: 208 | Train Loss: 1.761 Vali Loss: 4.510 Vali Acc: 0.120 Test Loss: 4.510 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3613605
	speed: 0.1304s/iter; left time: 2293.3958s
	iters: 200, epoch: 16 | loss: 1.7235570
	speed: 0.0361s/iter; left time: 631.8324s
Epoch: 16 cost time: 8.07735013961792
Epoch: 16, Steps: 208 | Train Loss: 1.660 Vali Loss: 4.964 Vali Acc: 0.113 Test Loss: 4.964 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1586802
	speed: 0.1269s/iter; left time: 2204.9750s
	iters: 200, epoch: 17 | loss: 1.6377536
	speed: 0.0365s/iter; left time: 630.9886s
Epoch: 17 cost time: 8.084269285202026
Epoch: 17, Steps: 208 | Train Loss: 1.593 Vali Loss: 4.938 Vali Acc: 0.112 Test Loss: 4.938 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.4892657
	speed: 0.1293s/iter; left time: 2218.8945s
	iters: 200, epoch: 18 | loss: 2.1389158
	speed: 0.0362s/iter; left time: 618.4638s
Epoch: 18 cost time: 7.896434545516968
Epoch: 18, Steps: 208 | Train Loss: 1.486 Vali Loss: 5.276 Vali Acc: 0.119 Test Loss: 5.276 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.1723498
	speed: 0.1262s/iter; left time: 2140.1122s
	iters: 200, epoch: 19 | loss: 2.2023482
	speed: 0.0370s/iter; left time: 623.7962s
Epoch: 19 cost time: 7.982899188995361
Epoch: 19, Steps: 208 | Train Loss: 1.423 Vali Loss: 5.397 Vali Acc: 0.112 Test Loss: 5.397 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.7192278
	speed: 0.1241s/iter; left time: 2079.2047s
	iters: 200, epoch: 20 | loss: 1.4627445
	speed: 0.0335s/iter; left time: 558.5079s
Epoch: 20 cost time: 7.553921461105347
Epoch: 20, Steps: 208 | Train Loss: 1.388 Vali Loss: 5.371 Vali Acc: 0.118 Test Loss: 5.371 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.1293975
	speed: 0.1224s/iter; left time: 2024.4365s
	iters: 200, epoch: 21 | loss: 1.1056246
	speed: 0.0370s/iter; left time: 608.9843s
Epoch: 21 cost time: 7.902032852172852
Epoch: 21, Steps: 208 | Train Loss: 1.300 Vali Loss: 5.568 Vali Acc: 0.117 Test Loss: 5.568 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.4660597
	speed: 0.1214s/iter; left time: 1983.6207s
	iters: 200, epoch: 22 | loss: 0.9526992
	speed: 0.0350s/iter; left time: 568.8645s
Epoch: 22 cost time: 7.896917819976807
Epoch: 22, Steps: 208 | Train Loss: 1.240 Vali Loss: 5.910 Vali Acc: 0.112 Test Loss: 5.910 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.9350761
	speed: 0.1256s/iter; left time: 2025.0586s
	iters: 200, epoch: 23 | loss: 1.6028843
	speed: 0.0339s/iter; left time: 543.4986s
Epoch: 23 cost time: 7.455925464630127
Epoch: 23, Steps: 208 | Train Loss: 1.174 Vali Loss: 5.987 Vali Acc: 0.118 Test Loss: 5.987 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.2056537
	speed: 0.1226s/iter; left time: 1952.0971s
	iters: 200, epoch: 24 | loss: 1.2143272
	speed: 0.0370s/iter; left time: 585.6619s
Epoch: 24 cost time: 7.951528310775757
Epoch: 24, Steps: 208 | Train Loss: 1.126 Vali Loss: 6.072 Vali Acc: 0.122 Test Loss: 6.072 Test Acc: 0.122
Validation loss decreased (-0.120146 --> -0.121920).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.3595083
	speed: 0.1292s/iter; left time: 2029.9834s
	iters: 200, epoch: 25 | loss: 1.1182441
	speed: 0.0360s/iter; left time: 561.5616s
Epoch: 25 cost time: 7.9040915966033936
Epoch: 25, Steps: 208 | Train Loss: 1.047 Vali Loss: 6.216 Vali Acc: 0.123 Test Loss: 6.216 Test Acc: 0.123
Validation loss decreased (-0.121920 --> -0.123409).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0787836
	speed: 0.1121s/iter; left time: 1738.2932s
	iters: 200, epoch: 26 | loss: 0.5093884
	speed: 0.0281s/iter; left time: 433.4620s
Epoch: 26 cost time: 6.271089792251587
Epoch: 26, Steps: 208 | Train Loss: 1.007 Vali Loss: 6.765 Vali Acc: 0.110 Test Loss: 6.765 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.1112139
	speed: 0.1213s/iter; left time: 1855.5816s
	iters: 200, epoch: 27 | loss: 1.7269425
	speed: 0.0294s/iter; left time: 446.6836s
Epoch: 27 cost time: 6.493586301803589
Epoch: 27, Steps: 208 | Train Loss: 0.997 Vali Loss: 6.852 Vali Acc: 0.108 Test Loss: 6.852 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.6045763
	speed: 0.1134s/iter; left time: 1710.2774s
	iters: 200, epoch: 28 | loss: 1.6395900
	speed: 0.0284s/iter; left time: 424.8540s
Epoch: 28 cost time: 6.342408895492554
Epoch: 28, Steps: 208 | Train Loss: 0.945 Vali Loss: 7.063 Vali Acc: 0.115 Test Loss: 7.063 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.3147024
	speed: 0.1154s/iter; left time: 1716.0914s
	iters: 200, epoch: 29 | loss: 0.9644057
	speed: 0.0276s/iter; left time: 408.2653s
Epoch: 29 cost time: 6.3700361251831055
Epoch: 29, Steps: 208 | Train Loss: 0.888 Vali Loss: 7.199 Vali Acc: 0.121 Test Loss: 7.199 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.4597212
	speed: 0.1200s/iter; left time: 1759.6657s
	iters: 200, epoch: 30 | loss: 1.4137752
	speed: 0.0297s/iter; left time: 432.9882s
Epoch: 30 cost time: 6.603494167327881
Epoch: 30, Steps: 208 | Train Loss: 0.857 Vali Loss: 7.469 Vali Acc: 0.108 Test Loss: 7.469 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.5142064
	speed: 0.1242s/iter; left time: 1795.7023s
	iters: 200, epoch: 31 | loss: 1.3882207
	speed: 0.0358s/iter; left time: 513.9398s
Epoch: 31 cost time: 7.946027040481567
Epoch: 31, Steps: 208 | Train Loss: 0.841 Vali Loss: 7.790 Vali Acc: 0.115 Test Loss: 7.790 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.7194920
	speed: 0.1185s/iter; left time: 1689.1287s
	iters: 200, epoch: 32 | loss: 0.7087620
	speed: 0.0382s/iter; left time: 540.6228s
Epoch: 32 cost time: 7.824915170669556
Epoch: 32, Steps: 208 | Train Loss: 0.813 Vali Loss: 7.845 Vali Acc: 0.109 Test Loss: 7.845 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.4586571
	speed: 0.1285s/iter; left time: 1804.1800s
	iters: 200, epoch: 33 | loss: 0.9905989
	speed: 0.0364s/iter; left time: 507.4565s
Epoch: 33 cost time: 8.186257362365723
Epoch: 33, Steps: 208 | Train Loss: 0.757 Vali Loss: 7.884 Vali Acc: 0.112 Test Loss: 7.884 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.8026530
	speed: 0.1201s/iter; left time: 1661.9166s
	iters: 200, epoch: 34 | loss: 1.0856886
	speed: 0.0364s/iter; left time: 499.4900s
Epoch: 34 cost time: 8.027963638305664
Epoch: 34, Steps: 208 | Train Loss: 0.731 Vali Loss: 8.279 Vali Acc: 0.115 Test Loss: 8.279 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.6112951
	speed: 0.1270s/iter; left time: 1730.3264s
	iters: 200, epoch: 35 | loss: 1.0759749
	speed: 0.0374s/iter; left time: 505.8364s
Epoch: 35 cost time: 8.147822380065918
Epoch: 35, Steps: 208 | Train Loss: 0.699 Vali Loss: 8.753 Vali Acc: 0.102 Test Loss: 8.753 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1234715180435431
model parameter : 159687
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4708056
	speed: 0.0539s/iter; left time: 1115.3647s
	iters: 200, epoch: 1 | loss: 3.7832348
	speed: 0.0361s/iter; left time: 743.0652s
Epoch: 1 cost time: 9.390222311019897
Epoch: 1, Steps: 208 | Train Loss: 3.766 Vali Loss: 3.704 Vali Acc: 0.049 Test Loss: 3.704 Test Acc: 0.049
Validation loss decreased (inf --> -0.049173).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2953634
	speed: 0.1189s/iter; left time: 2436.5463s
	iters: 200, epoch: 2 | loss: 3.2761838
	speed: 0.0355s/iter; left time: 723.5973s
Epoch: 2 cost time: 7.761866331100464
Epoch: 2, Steps: 208 | Train Loss: 3.561 Vali Loss: 3.631 Vali Acc: 0.073 Test Loss: 3.631 Test Acc: 0.073
Validation loss decreased (-0.049173 --> -0.073331).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9451396
	speed: 0.1217s/iter; left time: 2467.6749s
	iters: 200, epoch: 3 | loss: 3.1814454
	speed: 0.0362s/iter; left time: 729.9732s
Epoch: 3 cost time: 7.878455638885498
Epoch: 3, Steps: 208 | Train Loss: 3.284 Vali Loss: 3.563 Vali Acc: 0.078 Test Loss: 3.563 Test Acc: 0.078
Validation loss decreased (-0.073331 --> -0.078103).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7636633
	speed: 0.1294s/iter; left time: 2598.6118s
	iters: 200, epoch: 4 | loss: 3.1070054
	speed: 0.0344s/iter; left time: 686.3375s
Epoch: 4 cost time: 7.826772689819336
Epoch: 4, Steps: 208 | Train Loss: 3.110 Vali Loss: 3.622 Vali Acc: 0.087 Test Loss: 3.622 Test Acc: 0.087
Validation loss decreased (-0.078103 --> -0.087348).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9078879
	speed: 0.1160s/iter; left time: 2305.3833s
	iters: 200, epoch: 5 | loss: 3.2563143
	speed: 0.0281s/iter; left time: 556.2139s
Epoch: 5 cost time: 6.433777093887329
Epoch: 5, Steps: 208 | Train Loss: 2.982 Vali Loss: 3.758 Vali Acc: 0.085 Test Loss: 3.758 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9212942
	speed: 0.1090s/iter; left time: 2142.5079s
	iters: 200, epoch: 6 | loss: 2.3380322
	speed: 0.0279s/iter; left time: 546.0140s
Epoch: 6 cost time: 6.178933143615723
Epoch: 6, Steps: 208 | Train Loss: 2.878 Vali Loss: 3.754 Vali Acc: 0.103 Test Loss: 3.754 Test Acc: 0.103
Validation loss decreased (-0.087348 --> -0.102855).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3232503
	speed: 0.1178s/iter; left time: 2291.3504s
	iters: 200, epoch: 7 | loss: 2.7441139
	speed: 0.0264s/iter; left time: 510.0432s
Epoch: 7 cost time: 5.993052244186401
Epoch: 7, Steps: 208 | Train Loss: 2.781 Vali Loss: 3.747 Vali Acc: 0.104 Test Loss: 3.747 Test Acc: 0.104
Validation loss decreased (-0.102855 --> -0.104048).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2745609
	speed: 0.1115s/iter; left time: 2145.0392s
	iters: 200, epoch: 8 | loss: 3.1321714
	speed: 0.0274s/iter; left time: 523.9737s
Epoch: 8 cost time: 6.103039264678955
Epoch: 8, Steps: 208 | Train Loss: 2.669 Vali Loss: 3.803 Vali Acc: 0.107 Test Loss: 3.803 Test Acc: 0.107
Validation loss decreased (-0.104048 --> -0.107329).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5151534
	speed: 0.1131s/iter; left time: 2152.1929s
	iters: 200, epoch: 9 | loss: 3.3518128
	speed: 0.0357s/iter; left time: 675.8269s
Epoch: 9 cost time: 7.09834623336792
Epoch: 9, Steps: 208 | Train Loss: 2.594 Vali Loss: 3.806 Vali Acc: 0.103 Test Loss: 3.806 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2999079
	speed: 0.1173s/iter; left time: 2208.5901s
	iters: 200, epoch: 10 | loss: 2.6623561
	speed: 0.0324s/iter; left time: 607.0769s
Epoch: 10 cost time: 7.3383777141571045
Epoch: 10, Steps: 208 | Train Loss: 2.490 Vali Loss: 3.797 Vali Acc: 0.108 Test Loss: 3.797 Test Acc: 0.108
Validation loss decreased (-0.107329 --> -0.107627).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.9561050
	speed: 0.1166s/iter; left time: 2170.4619s
	iters: 200, epoch: 11 | loss: 2.5728958
	speed: 0.0332s/iter; left time: 615.2555s
Epoch: 11 cost time: 7.2047741413116455
Epoch: 11, Steps: 208 | Train Loss: 2.395 Vali Loss: 3.848 Vali Acc: 0.112 Test Loss: 3.848 Test Acc: 0.112
Validation loss decreased (-0.107627 --> -0.112100).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3139665
	speed: 0.1247s/iter; left time: 2296.5553s
	iters: 200, epoch: 12 | loss: 2.4054079
	speed: 0.0316s/iter; left time: 578.1700s
Epoch: 12 cost time: 7.186973810195923
Epoch: 12, Steps: 208 | Train Loss: 2.294 Vali Loss: 3.914 Vali Acc: 0.116 Test Loss: 3.914 Test Acc: 0.116
Validation loss decreased (-0.112100 --> -0.116275).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2082584
	speed: 0.1242s/iter; left time: 2260.4395s
	iters: 200, epoch: 13 | loss: 2.6326542
	speed: 0.0334s/iter; left time: 604.4803s
Epoch: 13 cost time: 7.55016827583313
Epoch: 13, Steps: 208 | Train Loss: 2.223 Vali Loss: 4.083 Vali Acc: 0.118 Test Loss: 4.083 Test Acc: 0.118
Validation loss decreased (-0.116275 --> -0.117466).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0811977
	speed: 0.1246s/iter; left time: 2242.0757s
	iters: 200, epoch: 14 | loss: 2.3565626
	speed: 0.0342s/iter; left time: 611.3808s
Epoch: 14 cost time: 7.538784503936768
Epoch: 14, Steps: 208 | Train Loss: 2.120 Vali Loss: 4.149 Vali Acc: 0.113 Test Loss: 4.149 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0784662
	speed: 0.1227s/iter; left time: 2182.7891s
	iters: 200, epoch: 15 | loss: 2.1279984
	speed: 0.0351s/iter; left time: 620.8990s
Epoch: 15 cost time: 7.650448322296143
Epoch: 15, Steps: 208 | Train Loss: 2.052 Vali Loss: 4.328 Vali Acc: 0.115 Test Loss: 4.328 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.9116111
	speed: 0.1242s/iter; left time: 2184.1513s
	iters: 200, epoch: 16 | loss: 2.0653858
	speed: 0.0338s/iter; left time: 591.1862s
Epoch: 16 cost time: 7.709173679351807
Epoch: 16, Steps: 208 | Train Loss: 1.985 Vali Loss: 4.381 Vali Acc: 0.120 Test Loss: 4.381 Test Acc: 0.120
Validation loss decreased (-0.117466 --> -0.119551).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.0313523
	speed: 0.1172s/iter; left time: 2035.3552s
	iters: 200, epoch: 17 | loss: 1.9579203
	speed: 0.0331s/iter; left time: 571.9982s
Epoch: 17 cost time: 7.368349313735962
Epoch: 17, Steps: 208 | Train Loss: 1.903 Vali Loss: 4.453 Vali Acc: 0.121 Test Loss: 4.453 Test Acc: 0.121
Validation loss decreased (-0.119551 --> -0.121041).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.0710452
	speed: 0.1230s/iter; left time: 2111.6087s
	iters: 200, epoch: 18 | loss: 2.0323188
	speed: 0.0347s/iter; left time: 591.6751s
Epoch: 18 cost time: 7.626913547515869
Epoch: 18, Steps: 208 | Train Loss: 1.817 Vali Loss: 4.601 Vali Acc: 0.119 Test Loss: 4.601 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.7838730
	speed: 0.1086s/iter; left time: 1841.4021s
	iters: 200, epoch: 19 | loss: 1.6411490
	speed: 0.0262s/iter; left time: 442.4902s
Epoch: 19 cost time: 6.043423652648926
Epoch: 19, Steps: 208 | Train Loss: 1.762 Vali Loss: 4.730 Vali Acc: 0.115 Test Loss: 4.730 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.7328045
	speed: 0.1154s/iter; left time: 1933.1522s
	iters: 200, epoch: 20 | loss: 2.1236768
	speed: 0.0274s/iter; left time: 456.3962s
Epoch: 20 cost time: 6.1402506828308105
Epoch: 20, Steps: 208 | Train Loss: 1.691 Vali Loss: 4.867 Vali Acc: 0.117 Test Loss: 4.867 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.2513967
	speed: 0.1136s/iter; left time: 1878.2486s
	iters: 200, epoch: 21 | loss: 2.3582675
	speed: 0.0245s/iter; left time: 402.1543s
Epoch: 21 cost time: 5.5563812255859375
Epoch: 21, Steps: 208 | Train Loss: 1.617 Vali Loss: 4.957 Vali Acc: 0.121 Test Loss: 4.957 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.6672113
	speed: 0.1139s/iter; left time: 1860.8373s
	iters: 200, epoch: 22 | loss: 2.1182830
	speed: 0.0302s/iter; left time: 490.1547s
Epoch: 22 cost time: 6.617786407470703
Epoch: 22, Steps: 208 | Train Loss: 1.572 Vali Loss: 5.081 Vali Acc: 0.113 Test Loss: 5.081 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.3060802
	speed: 0.1253s/iter; left time: 2019.8498s
	iters: 200, epoch: 23 | loss: 2.0030353
	speed: 0.0330s/iter; left time: 529.5835s
Epoch: 23 cost time: 7.216392517089844
Epoch: 23, Steps: 208 | Train Loss: 1.520 Vali Loss: 5.311 Vali Acc: 0.119 Test Loss: 5.311 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.7338039
	speed: 0.1259s/iter; left time: 2003.7955s
	iters: 200, epoch: 24 | loss: 1.5760452
	speed: 0.0362s/iter; left time: 572.0039s
Epoch: 24 cost time: 7.972005844116211
Epoch: 24, Steps: 208 | Train Loss: 1.456 Vali Loss: 5.307 Vali Acc: 0.109 Test Loss: 5.307 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.9427732
	speed: 0.1241s/iter; left time: 1949.5127s
	iters: 200, epoch: 25 | loss: 1.9701941
	speed: 0.0355s/iter; left time: 554.5750s
Epoch: 25 cost time: 7.989997863769531
Epoch: 25, Steps: 208 | Train Loss: 1.400 Vali Loss: 5.535 Vali Acc: 0.115 Test Loss: 5.535 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.2765663
	speed: 0.1227s/iter; left time: 1901.7416s
	iters: 200, epoch: 26 | loss: 2.2154489
	speed: 0.0359s/iter; left time: 553.5922s
Epoch: 26 cost time: 7.935871362686157
Epoch: 26, Steps: 208 | Train Loss: 1.367 Vali Loss: 5.707 Vali Acc: 0.109 Test Loss: 5.707 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.5522836
	speed: 0.1192s/iter; left time: 1823.2878s
	iters: 200, epoch: 27 | loss: 1.4933771
	speed: 0.0356s/iter; left time: 541.5712s
Epoch: 27 cost time: 7.659722328186035
Epoch: 27, Steps: 208 | Train Loss: 1.315 Vali Loss: 5.729 Vali Acc: 0.112 Test Loss: 5.729 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12108559498956159
model parameter : 111815
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5449586
	speed: 0.0526s/iter; left time: 1089.6731s
	iters: 200, epoch: 1 | loss: 3.4851475
	speed: 0.0353s/iter; left time: 728.1527s
Epoch: 1 cost time: 9.1144859790802
Epoch: 1, Steps: 208 | Train Loss: 3.751 Vali Loss: 3.679 Vali Acc: 0.054 Test Loss: 3.679 Test Acc: 0.054
Validation loss decreased (inf --> -0.053945).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5572791
	speed: 0.1257s/iter; left time: 2574.9535s
	iters: 200, epoch: 2 | loss: 3.1119497
	speed: 0.0350s/iter; left time: 713.1843s
Epoch: 2 cost time: 7.530274152755737
Epoch: 2, Steps: 208 | Train Loss: 3.555 Vali Loss: 3.634 Vali Acc: 0.069 Test Loss: 3.634 Test Acc: 0.069
Validation loss decreased (-0.053945 --> -0.068857).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2018900
	speed: 0.1254s/iter; left time: 2544.6094s
	iters: 200, epoch: 3 | loss: 3.2336326
	speed: 0.0352s/iter; left time: 709.7382s
Epoch: 3 cost time: 7.596301555633545
Epoch: 3, Steps: 208 | Train Loss: 3.349 Vali Loss: 3.546 Vali Acc: 0.084 Test Loss: 3.546 Test Acc: 0.084
Validation loss decreased (-0.068857 --> -0.084068).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4482558
	speed: 0.1308s/iter; left time: 2626.3736s
	iters: 200, epoch: 4 | loss: 2.7100837
	speed: 0.0352s/iter; left time: 704.1170s
Epoch: 4 cost time: 7.750363826751709
Epoch: 4, Steps: 208 | Train Loss: 3.175 Vali Loss: 3.583 Vali Acc: 0.085 Test Loss: 3.583 Test Acc: 0.085
Validation loss decreased (-0.084068 --> -0.084963).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8732285
	speed: 0.1263s/iter; left time: 2509.0244s
	iters: 200, epoch: 5 | loss: 3.0525537
	speed: 0.0263s/iter; left time: 519.4496s
Epoch: 5 cost time: 6.781376361846924
Epoch: 5, Steps: 208 | Train Loss: 3.059 Vali Loss: 3.585 Vali Acc: 0.090 Test Loss: 3.585 Test Acc: 0.090
Validation loss decreased (-0.084963 --> -0.089735).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0102825
	speed: 0.1179s/iter; left time: 2317.0536s
	iters: 200, epoch: 6 | loss: 3.0957446
	speed: 0.0273s/iter; left time: 534.0217s
Epoch: 6 cost time: 6.135870456695557
Epoch: 6, Steps: 208 | Train Loss: 2.956 Vali Loss: 3.617 Vali Acc: 0.094 Test Loss: 3.617 Test Acc: 0.094
Validation loss decreased (-0.089735 --> -0.093910).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9686251
	speed: 0.1121s/iter; left time: 2181.0249s
	iters: 200, epoch: 7 | loss: 3.2563562
	speed: 0.0260s/iter; left time: 502.3037s
Epoch: 7 cost time: 5.898341417312622
Epoch: 7, Steps: 208 | Train Loss: 2.858 Vali Loss: 3.641 Vali Acc: 0.095 Test Loss: 3.641 Test Acc: 0.095
Validation loss decreased (-0.093910 --> -0.095401).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9493182
	speed: 0.1073s/iter; left time: 2065.0301s
	iters: 200, epoch: 8 | loss: 2.9140522
	speed: 0.0278s/iter; left time: 532.2651s
Epoch: 8 cost time: 6.2311155796051025
Epoch: 8, Steps: 208 | Train Loss: 2.780 Vali Loss: 3.731 Vali Acc: 0.096 Test Loss: 3.731 Test Acc: 0.096
Validation loss decreased (-0.095401 --> -0.095996).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2360339
	speed: 0.1110s/iter; left time: 2112.8477s
	iters: 200, epoch: 9 | loss: 2.8347938
	speed: 0.0309s/iter; left time: 585.9730s
Epoch: 9 cost time: 6.476569414138794
Epoch: 9, Steps: 208 | Train Loss: 2.701 Vali Loss: 3.731 Vali Acc: 0.100 Test Loss: 3.731 Test Acc: 0.100
Validation loss decreased (-0.095996 --> -0.100171).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9372549
	speed: 0.1118s/iter; left time: 2105.9757s
	iters: 200, epoch: 10 | loss: 2.9329598
	speed: 0.0311s/iter; left time: 583.3892s
Epoch: 10 cost time: 7.065272331237793
Epoch: 10, Steps: 208 | Train Loss: 2.601 Vali Loss: 3.778 Vali Acc: 0.098 Test Loss: 3.778 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.4252577
	speed: 0.1131s/iter; left time: 2106.3377s
	iters: 200, epoch: 11 | loss: 2.6542387
	speed: 0.0332s/iter; left time: 615.2195s
Epoch: 11 cost time: 7.131632566452026
Epoch: 11, Steps: 208 | Train Loss: 2.526 Vali Loss: 3.814 Vali Acc: 0.096 Test Loss: 3.814 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.7701135
	speed: 0.1200s/iter; left time: 2209.4211s
	iters: 200, epoch: 12 | loss: 2.6508505
	speed: 0.0348s/iter; left time: 637.1082s
Epoch: 12 cost time: 7.523193359375
Epoch: 12, Steps: 208 | Train Loss: 2.450 Vali Loss: 3.956 Vali Acc: 0.098 Test Loss: 3.956 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5572767
	speed: 0.1195s/iter; left time: 2175.3632s
	iters: 200, epoch: 13 | loss: 2.3140068
	speed: 0.0322s/iter; left time: 582.3245s
Epoch: 13 cost time: 7.256327152252197
Epoch: 13, Steps: 208 | Train Loss: 2.383 Vali Loss: 3.969 Vali Acc: 0.101 Test Loss: 3.969 Test Acc: 0.101
Validation loss decreased (-0.100171 --> -0.100467).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.9878247
	speed: 0.1171s/iter; left time: 2107.0470s
	iters: 200, epoch: 14 | loss: 2.6360810
	speed: 0.0359s/iter; left time: 642.6032s
Epoch: 14 cost time: 7.51960015296936
Epoch: 14, Steps: 208 | Train Loss: 2.320 Vali Loss: 4.016 Vali Acc: 0.106 Test Loss: 4.016 Test Acc: 0.106
Validation loss decreased (-0.100467 --> -0.105537).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.3855879
	speed: 0.1290s/iter; left time: 2295.0888s
	iters: 200, epoch: 15 | loss: 2.7046690
	speed: 0.0329s/iter; left time: 582.6044s
Epoch: 15 cost time: 7.60705304145813
Epoch: 15, Steps: 208 | Train Loss: 2.234 Vali Loss: 4.089 Vali Acc: 0.108 Test Loss: 4.089 Test Acc: 0.108
Validation loss decreased (-0.105537 --> -0.108220).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.8360586
	speed: 0.1181s/iter; left time: 2075.5976s
	iters: 200, epoch: 16 | loss: 2.1798000
	speed: 0.0332s/iter; left time: 580.9945s
Epoch: 16 cost time: 7.232417106628418
Epoch: 16, Steps: 208 | Train Loss: 2.129 Vali Loss: 4.194 Vali Acc: 0.102 Test Loss: 4.194 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.3100452
	speed: 0.1241s/iter; left time: 2156.2229s
	iters: 200, epoch: 17 | loss: 1.9492850
	speed: 0.0356s/iter; left time: 615.3664s
Epoch: 17 cost time: 7.716425895690918
Epoch: 17, Steps: 208 | Train Loss: 2.086 Vali Loss: 4.296 Vali Acc: 0.107 Test Loss: 4.296 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.2110851
	speed: 0.1194s/iter; left time: 2050.1290s
	iters: 200, epoch: 18 | loss: 2.4113162
	speed: 0.0332s/iter; left time: 566.8733s
Epoch: 18 cost time: 7.495802402496338
Epoch: 18, Steps: 208 | Train Loss: 2.024 Vali Loss: 4.413 Vali Acc: 0.114 Test Loss: 4.413 Test Acc: 0.114
Validation loss decreased (-0.108220 --> -0.113585).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5817515
	speed: 0.1184s/iter; left time: 2008.2447s
	iters: 200, epoch: 19 | loss: 2.6881092
	speed: 0.0366s/iter; left time: 616.3909s
Epoch: 19 cost time: 7.688586473464966
Epoch: 19, Steps: 208 | Train Loss: 1.979 Vali Loss: 4.509 Vali Acc: 0.115 Test Loss: 4.509 Test Acc: 0.115
Validation loss decreased (-0.113585 --> -0.114777).  Saving model ...
	iters: 100, epoch: 20 | loss: 2.1303887
	speed: 0.1123s/iter; left time: 1881.4921s
	iters: 200, epoch: 20 | loss: 1.9770048
	speed: 0.0265s/iter; left time: 441.9793s
Epoch: 20 cost time: 6.031601190567017
Epoch: 20, Steps: 208 | Train Loss: 1.918 Vali Loss: 4.634 Vali Acc: 0.109 Test Loss: 4.634 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.7309881
	speed: 0.1169s/iter; left time: 1933.3894s
	iters: 200, epoch: 21 | loss: 2.2014039
	speed: 0.0275s/iter; left time: 452.6482s
Epoch: 21 cost time: 6.130922317504883
Epoch: 21, Steps: 208 | Train Loss: 1.859 Vali Loss: 4.614 Vali Acc: 0.104 Test Loss: 4.614 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 2.3045008
	speed: 0.1112s/iter; left time: 1816.3364s
	iters: 200, epoch: 22 | loss: 2.2570028
	speed: 0.0269s/iter; left time: 437.0863s
Epoch: 22 cost time: 5.931864976882935
Epoch: 22, Steps: 208 | Train Loss: 1.770 Vali Loss: 4.841 Vali Acc: 0.101 Test Loss: 4.841 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.0947111
	speed: 0.1161s/iter; left time: 1871.5471s
	iters: 200, epoch: 23 | loss: 1.6087450
	speed: 0.0260s/iter; left time: 417.2480s
Epoch: 23 cost time: 5.932932376861572
Epoch: 23, Steps: 208 | Train Loss: 1.714 Vali Loss: 5.005 Vali Acc: 0.109 Test Loss: 5.005 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.8173789
	speed: 0.1162s/iter; left time: 1849.0039s
	iters: 200, epoch: 24 | loss: 1.2463470
	speed: 0.0293s/iter; left time: 463.7808s
Epoch: 24 cost time: 6.3796563148498535
Epoch: 24, Steps: 208 | Train Loss: 1.687 Vali Loss: 5.036 Vali Acc: 0.107 Test Loss: 5.036 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.7093420
	speed: 0.1179s/iter; left time: 1852.2066s
	iters: 200, epoch: 25 | loss: 1.6484172
	speed: 0.0313s/iter; left time: 488.7867s
Epoch: 25 cost time: 6.8319408893585205
Epoch: 25, Steps: 208 | Train Loss: 1.627 Vali Loss: 5.295 Vali Acc: 0.096 Test Loss: 5.295 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.2704403
	speed: 0.1272s/iter; left time: 1972.0026s
	iters: 200, epoch: 26 | loss: 1.4742247
	speed: 0.0328s/iter; left time: 504.5609s
Epoch: 26 cost time: 7.640753746032715
Epoch: 26, Steps: 208 | Train Loss: 1.570 Vali Loss: 5.350 Vali Acc: 0.107 Test Loss: 5.350 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.3808466
	speed: 0.1228s/iter; left time: 1877.2900s
	iters: 200, epoch: 27 | loss: 1.4618323
	speed: 0.0343s/iter; left time: 521.3103s
Epoch: 27 cost time: 7.532643556594849
Epoch: 27, Steps: 208 | Train Loss: 1.497 Vali Loss: 5.557 Vali Acc: 0.100 Test Loss: 5.557 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.3052771
	speed: 0.1276s/iter; left time: 1925.1627s
	iters: 200, epoch: 28 | loss: 1.5768427
	speed: 0.0358s/iter; left time: 536.4024s
Epoch: 28 cost time: 7.864067077636719
Epoch: 28, Steps: 208 | Train Loss: 1.474 Vali Loss: 5.681 Vali Acc: 0.105 Test Loss: 5.681 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.6754847
	speed: 0.1166s/iter; left time: 1735.2491s
	iters: 200, epoch: 29 | loss: 2.3800600
	speed: 0.0349s/iter; left time: 516.2571s
Epoch: 29 cost time: 7.58637547492981
Epoch: 29, Steps: 208 | Train Loss: 1.426 Vali Loss: 5.727 Vali Acc: 0.100 Test Loss: 5.727 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11482254697286012
model parameter : 91399
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0006123
	speed: 0.0490s/iter; left time: 1015.3220s
	iters: 200, epoch: 1 | loss: 3.8182261
	speed: 0.0342s/iter; left time: 704.9709s
Epoch: 1 cost time: 8.677736520767212
Epoch: 1, Steps: 208 | Train Loss: 3.780 Vali Loss: 3.665 Vali Acc: 0.057 Test Loss: 3.665 Test Acc: 0.057
Validation loss decreased (inf --> -0.056927).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7207093
	speed: 0.1264s/iter; left time: 2590.4619s
	iters: 200, epoch: 2 | loss: 3.8408415
	speed: 0.0354s/iter; left time: 721.6571s
Epoch: 2 cost time: 7.773749351501465
Epoch: 2, Steps: 208 | Train Loss: 3.607 Vali Loss: 3.655 Vali Acc: 0.063 Test Loss: 3.655 Test Acc: 0.063
Validation loss decreased (-0.056927 --> -0.062594).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6903086
	speed: 0.1243s/iter; left time: 2520.9447s
	iters: 200, epoch: 3 | loss: 3.1701956
	speed: 0.0331s/iter; left time: 667.3154s
Epoch: 3 cost time: 7.454500436782837
Epoch: 3, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.579 Vali Acc: 0.068 Test Loss: 3.579 Test Acc: 0.068
Validation loss decreased (-0.062594 --> -0.068261).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5667658
	speed: 0.1227s/iter; left time: 2463.9528s
	iters: 200, epoch: 4 | loss: 2.7212837
	speed: 0.0288s/iter; left time: 575.3114s
Epoch: 4 cost time: 6.945566892623901
Epoch: 4, Steps: 208 | Train Loss: 3.275 Vali Loss: 3.629 Vali Acc: 0.072 Test Loss: 3.629 Test Acc: 0.072
Validation loss decreased (-0.068261 --> -0.071840).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0576580
	speed: 0.1139s/iter; left time: 2262.3656s
	iters: 200, epoch: 5 | loss: 2.6562994
	speed: 0.0263s/iter; left time: 520.1287s
Epoch: 5 cost time: 6.021951913833618
Epoch: 5, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.578 Vali Acc: 0.082 Test Loss: 3.578 Test Acc: 0.082
Validation loss decreased (-0.071840 --> -0.081980).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9295731
	speed: 0.1178s/iter; left time: 2315.1084s
	iters: 200, epoch: 6 | loss: 3.1959138
	speed: 0.0280s/iter; left time: 547.0170s
Epoch: 6 cost time: 6.248783111572266
Epoch: 6, Steps: 208 | Train Loss: 3.067 Vali Loss: 3.643 Vali Acc: 0.082 Test Loss: 3.643 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.9727566
	speed: 0.1126s/iter; left time: 2190.6629s
	iters: 200, epoch: 7 | loss: 3.1690998
	speed: 0.0269s/iter; left time: 520.1951s
Epoch: 7 cost time: 6.1802895069122314
Epoch: 7, Steps: 208 | Train Loss: 2.956 Vali Loss: 3.572 Vali Acc: 0.092 Test Loss: 3.572 Test Acc: 0.092
Validation loss decreased (-0.081980 --> -0.091524).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2675655
	speed: 0.1111s/iter; left time: 2137.7995s
	iters: 200, epoch: 8 | loss: 3.0911186
	speed: 0.0282s/iter; left time: 538.9583s
Epoch: 8 cost time: 6.1952574253082275
Epoch: 8, Steps: 208 | Train Loss: 2.873 Vali Loss: 3.547 Vali Acc: 0.101 Test Loss: 3.547 Test Acc: 0.101
Validation loss decreased (-0.091524 --> -0.100770).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4710298
	speed: 0.1208s/iter; left time: 2299.9147s
	iters: 200, epoch: 9 | loss: 2.8660564
	speed: 0.0355s/iter; left time: 672.8342s
Epoch: 9 cost time: 7.877294301986694
Epoch: 9, Steps: 208 | Train Loss: 2.776 Vali Loss: 3.618 Vali Acc: 0.097 Test Loss: 3.618 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.2131321
	speed: 0.1190s/iter; left time: 2239.9357s
	iters: 200, epoch: 10 | loss: 2.8131120
	speed: 0.0335s/iter; left time: 626.8501s
Epoch: 10 cost time: 7.333984136581421
Epoch: 10, Steps: 208 | Train Loss: 2.721 Vali Loss: 3.615 Vali Acc: 0.105 Test Loss: 3.615 Test Acc: 0.105
Validation loss decreased (-0.100770 --> -0.104944).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.0899646
	speed: 0.1263s/iter; left time: 2351.3048s
	iters: 200, epoch: 11 | loss: 2.7589254
	speed: 0.0359s/iter; left time: 664.3617s
Epoch: 11 cost time: 7.78588604927063
Epoch: 11, Steps: 208 | Train Loss: 2.614 Vali Loss: 3.676 Vali Acc: 0.104 Test Loss: 3.676 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.4325273
	speed: 0.1237s/iter; left time: 2276.9456s
	iters: 200, epoch: 12 | loss: 2.2659841
	speed: 0.0326s/iter; left time: 597.8957s
Epoch: 12 cost time: 7.278812408447266
Epoch: 12, Steps: 208 | Train Loss: 2.553 Vali Loss: 3.780 Vali Acc: 0.101 Test Loss: 3.780 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.1125288
	speed: 0.1241s/iter; left time: 2258.4052s
	iters: 200, epoch: 13 | loss: 3.0355093
	speed: 0.0371s/iter; left time: 670.8371s
Epoch: 13 cost time: 7.6879799365997314
Epoch: 13, Steps: 208 | Train Loss: 2.500 Vali Loss: 3.756 Vali Acc: 0.105 Test Loss: 3.756 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.1116030
	speed: 0.1294s/iter; left time: 2328.8963s
	iters: 200, epoch: 14 | loss: 2.8438361
	speed: 0.0318s/iter; left time: 569.4428s
Epoch: 14 cost time: 7.342340469360352
Epoch: 14, Steps: 208 | Train Loss: 2.406 Vali Loss: 3.858 Vali Acc: 0.109 Test Loss: 3.858 Test Acc: 0.109
Validation loss decreased (-0.104944 --> -0.109117).  Saving model ...
	iters: 100, epoch: 15 | loss: 3.0911779
	speed: 0.1183s/iter; left time: 2105.3105s
	iters: 200, epoch: 15 | loss: 3.1760004
	speed: 0.0306s/iter; left time: 541.4457s
Epoch: 15 cost time: 6.806791543960571
Epoch: 15, Steps: 208 | Train Loss: 2.335 Vali Loss: 3.941 Vali Acc: 0.108 Test Loss: 3.941 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8810823
	speed: 0.1257s/iter; left time: 2209.5785s
	iters: 200, epoch: 16 | loss: 2.0594652
	speed: 0.0328s/iter; left time: 572.9267s
Epoch: 16 cost time: 7.319591283798218
Epoch: 16, Steps: 208 | Train Loss: 2.270 Vali Loss: 4.109 Vali Acc: 0.108 Test Loss: 4.109 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.8204484
	speed: 0.1237s/iter; left time: 2149.2741s
	iters: 200, epoch: 17 | loss: 1.9794775
	speed: 0.0328s/iter; left time: 567.1678s
Epoch: 17 cost time: 7.379845380783081
Epoch: 17, Steps: 208 | Train Loss: 2.225 Vali Loss: 4.126 Vali Acc: 0.104 Test Loss: 4.126 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.1955860
	speed: 0.1202s/iter; left time: 2062.8141s
	iters: 200, epoch: 18 | loss: 1.9283853
	speed: 0.0304s/iter; left time: 518.0029s
Epoch: 18 cost time: 6.885467052459717
Epoch: 18, Steps: 208 | Train Loss: 2.148 Vali Loss: 4.197 Vali Acc: 0.110 Test Loss: 4.197 Test Acc: 0.110
Validation loss decreased (-0.109117 --> -0.110009).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3897661
	speed: 0.1125s/iter; left time: 1907.9550s
	iters: 200, epoch: 19 | loss: 2.1175339
	speed: 0.0253s/iter; left time: 425.9129s
Epoch: 19 cost time: 5.815611839294434
Epoch: 19, Steps: 208 | Train Loss: 2.112 Vali Loss: 4.347 Vali Acc: 0.106 Test Loss: 4.347 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.8986071
	speed: 0.1105s/iter; left time: 1850.1534s
	iters: 200, epoch: 20 | loss: 2.0686028
	speed: 0.0273s/iter; left time: 453.9253s
Epoch: 20 cost time: 6.189755201339722
Epoch: 20, Steps: 208 | Train Loss: 2.026 Vali Loss: 4.547 Vali Acc: 0.103 Test Loss: 4.547 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.3669815
	speed: 0.1134s/iter; left time: 1875.0368s
	iters: 200, epoch: 21 | loss: 2.4490502
	speed: 0.0266s/iter; left time: 437.5439s
Epoch: 21 cost time: 6.145810842514038
Epoch: 21, Steps: 208 | Train Loss: 2.002 Vali Loss: 4.493 Vali Acc: 0.108 Test Loss: 4.493 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.6394943
	speed: 0.1100s/iter; left time: 1796.6867s
	iters: 200, epoch: 22 | loss: 1.7802061
	speed: 0.0260s/iter; left time: 422.1882s
Epoch: 22 cost time: 5.938698768615723
Epoch: 22, Steps: 208 | Train Loss: 1.939 Vali Loss: 4.579 Vali Acc: 0.099 Test Loss: 4.579 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.9577904
	speed: 0.1183s/iter; left time: 1906.8427s
	iters: 200, epoch: 23 | loss: 2.1510825
	speed: 0.0343s/iter; left time: 550.0970s
Epoch: 23 cost time: 7.444906234741211
Epoch: 23, Steps: 208 | Train Loss: 1.863 Vali Loss: 4.636 Vali Acc: 0.106 Test Loss: 4.636 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.0095479
	speed: 0.1209s/iter; left time: 1924.0770s
	iters: 200, epoch: 24 | loss: 1.9082452
	speed: 0.0318s/iter; left time: 502.5821s
Epoch: 24 cost time: 7.210941553115845
Epoch: 24, Steps: 208 | Train Loss: 1.852 Vali Loss: 4.785 Vali Acc: 0.105 Test Loss: 4.785 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.3226161
	speed: 0.1171s/iter; left time: 1839.2016s
	iters: 200, epoch: 25 | loss: 1.9166652
	speed: 0.0348s/iter; left time: 543.3664s
Epoch: 25 cost time: 7.332157373428345
Epoch: 25, Steps: 208 | Train Loss: 1.788 Vali Loss: 4.944 Vali Acc: 0.104 Test Loss: 4.944 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.4456691
	speed: 0.1194s/iter; left time: 1850.1029s
	iters: 200, epoch: 26 | loss: 2.1731665
	speed: 0.0309s/iter; left time: 475.5661s
Epoch: 26 cost time: 7.154721975326538
Epoch: 26, Steps: 208 | Train Loss: 1.729 Vali Loss: 5.008 Vali Acc: 0.103 Test Loss: 5.008 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.6369399
	speed: 0.1171s/iter; left time: 1790.3386s
	iters: 200, epoch: 27 | loss: 1.5433928
	speed: 0.0295s/iter; left time: 448.3447s
Epoch: 27 cost time: 6.512403964996338
Epoch: 27, Steps: 208 | Train Loss: 1.657 Vali Loss: 5.123 Vali Acc: 0.110 Test Loss: 5.123 Test Acc: 0.110
Validation loss decreased (-0.110009 --> -0.110298).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.4902949
	speed: 0.1224s/iter; left time: 1846.7004s
	iters: 200, epoch: 28 | loss: 1.6704384
	speed: 0.0364s/iter; left time: 545.7944s
Epoch: 28 cost time: 7.792188882827759
Epoch: 28, Steps: 208 | Train Loss: 1.649 Vali Loss: 5.266 Vali Acc: 0.110 Test Loss: 5.266 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 2.3303981
	speed: 0.1280s/iter; left time: 1903.5780s
	iters: 200, epoch: 29 | loss: 1.5389299
	speed: 0.0334s/iter; left time: 493.9398s
Epoch: 29 cost time: 7.546900987625122
Epoch: 29, Steps: 208 | Train Loss: 1.552 Vali Loss: 5.410 Vali Acc: 0.108 Test Loss: 5.410 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 2.0853372
	speed: 0.1175s/iter; left time: 1723.7538s
	iters: 200, epoch: 30 | loss: 1.6239902
	speed: 0.0359s/iter; left time: 523.2599s
Epoch: 30 cost time: 7.490909576416016
Epoch: 30, Steps: 208 | Train Loss: 1.557 Vali Loss: 5.582 Vali Acc: 0.106 Test Loss: 5.582 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.7383060
	speed: 0.1226s/iter; left time: 1773.3422s
	iters: 200, epoch: 31 | loss: 1.6367563
	speed: 0.0295s/iter; left time: 423.4740s
Epoch: 31 cost time: 6.916034698486328
Epoch: 31, Steps: 208 | Train Loss: 1.500 Vali Loss: 5.636 Vali Acc: 0.107 Test Loss: 5.636 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 1.5374873
	speed: 0.1234s/iter; left time: 1759.2367s
	iters: 200, epoch: 32 | loss: 1.6720283
	speed: 0.0320s/iter; left time: 452.8893s
Epoch: 32 cost time: 7.387169361114502
Epoch: 32, Steps: 208 | Train Loss: 1.497 Vali Loss: 5.598 Vali Acc: 0.110 Test Loss: 5.598 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 1.5849385
	speed: 0.1130s/iter; left time: 1587.4547s
	iters: 200, epoch: 33 | loss: 1.3565812
	speed: 0.0272s/iter; left time: 379.4132s
Epoch: 33 cost time: 6.150629997253418
Epoch: 33, Steps: 208 | Train Loss: 1.429 Vali Loss: 5.810 Vali Acc: 0.106 Test Loss: 5.810 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 1.6810305
	speed: 0.1173s/iter; left time: 1623.2791s
	iters: 200, epoch: 34 | loss: 0.8486726
	speed: 0.0267s/iter; left time: 366.4258s
Epoch: 34 cost time: 6.109760522842407
Epoch: 34, Steps: 208 | Train Loss: 1.392 Vali Loss: 5.956 Vali Acc: 0.109 Test Loss: 5.956 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 1.0914938
	speed: 0.1138s/iter; left time: 1550.9737s
	iters: 200, epoch: 35 | loss: 2.2582569
	speed: 0.0269s/iter; left time: 363.9673s
Epoch: 35 cost time: 6.1347527503967285
Epoch: 35, Steps: 208 | Train Loss: 1.357 Vali Loss: 6.109 Vali Acc: 0.108 Test Loss: 6.109 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 1.7010002
	speed: 0.1147s/iter; left time: 1538.7646s
	iters: 200, epoch: 36 | loss: 1.2034596
	speed: 0.0260s/iter; left time: 345.8954s
Epoch: 36 cost time: 6.026188850402832
Epoch: 36, Steps: 208 | Train Loss: 1.308 Vali Loss: 6.493 Vali Acc: 0.102 Test Loss: 6.493 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 1.3301765
	speed: 0.1166s/iter; left time: 1540.4017s
	iters: 200, epoch: 37 | loss: 1.1062595
	speed: 0.0320s/iter; left time: 419.6888s
Epoch: 37 cost time: 7.302886247634888
Epoch: 37, Steps: 208 | Train Loss: 1.299 Vali Loss: 6.375 Vali Acc: 0.104 Test Loss: 6.375 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1103489412466448
model parameter : 77847
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9918001
	speed: 0.0610s/iter; left time: 1262.1238s
	iters: 200, epoch: 1 | loss: 3.8028617
	speed: 0.0440s/iter; left time: 906.0865s
Epoch: 1 cost time: 10.942999362945557
Epoch: 1, Steps: 208 | Train Loss: 3.962 Vali Loss: 4.082 Vali Acc: 0.068 Test Loss: 4.082 Test Acc: 0.068
Validation loss decreased (inf --> -0.068256).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9034872
	speed: 0.1471s/iter; left time: 3013.5944s
	iters: 200, epoch: 2 | loss: 3.7588944
	speed: 0.0490s/iter; left time: 1000.1348s
Epoch: 2 cost time: 10.232539415359497
Epoch: 2, Steps: 208 | Train Loss: 3.573 Vali Loss: 3.861 Vali Acc: 0.074 Test Loss: 3.861 Test Acc: 0.074
Validation loss decreased (-0.068256 --> -0.074223).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0857358
	speed: 0.1448s/iter; left time: 2937.3583s
	iters: 200, epoch: 3 | loss: 3.4119372
	speed: 0.0455s/iter; left time: 917.5983s
Epoch: 3 cost time: 9.769990921020508
Epoch: 3, Steps: 208 | Train Loss: 3.172 Vali Loss: 4.219 Vali Acc: 0.076 Test Loss: 4.219 Test Acc: 0.076
Validation loss decreased (-0.074223 --> -0.076307).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0362725
	speed: 0.1487s/iter; left time: 2986.1360s
	iters: 200, epoch: 4 | loss: 3.2081790
	speed: 0.0467s/iter; left time: 932.7357s
Epoch: 4 cost time: 10.252841472625732
Epoch: 4, Steps: 208 | Train Loss: 2.923 Vali Loss: 4.233 Vali Acc: 0.084 Test Loss: 4.233 Test Acc: 0.084
Validation loss decreased (-0.076307 --> -0.084061).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1223650
	speed: 0.1473s/iter; left time: 2926.3424s
	iters: 200, epoch: 5 | loss: 3.3693540
	speed: 0.0469s/iter; left time: 927.2375s
Epoch: 5 cost time: 10.226919174194336
Epoch: 5, Steps: 208 | Train Loss: 2.766 Vali Loss: 4.230 Vali Acc: 0.106 Test Loss: 4.230 Test Acc: 0.106
Validation loss decreased (-0.084061 --> -0.105833).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2410676
	speed: 0.1477s/iter; left time: 2903.6066s
	iters: 200, epoch: 6 | loss: 3.1755772
	speed: 0.0437s/iter; left time: 854.7886s
Epoch: 6 cost time: 9.775686264038086
Epoch: 6, Steps: 208 | Train Loss: 2.489 Vali Loss: 4.643 Vali Acc: 0.101 Test Loss: 4.643 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6044520
	speed: 0.1387s/iter; left time: 2698.9598s
	iters: 200, epoch: 7 | loss: 2.7322457
	speed: 0.0442s/iter; left time: 855.5386s
Epoch: 7 cost time: 9.64441990852356
Epoch: 7, Steps: 208 | Train Loss: 2.145 Vali Loss: 5.864 Vali Acc: 0.065 Test Loss: 5.864 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5780030
	speed: 0.1449s/iter; left time: 2788.8093s
	iters: 200, epoch: 8 | loss: 2.3945787
	speed: 0.0480s/iter; left time: 918.0942s
Epoch: 8 cost time: 9.909317255020142
Epoch: 8, Steps: 208 | Train Loss: 1.871 Vali Loss: 5.289 Vali Acc: 0.099 Test Loss: 5.289 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3925959
	speed: 0.1339s/iter; left time: 2549.5265s
	iters: 200, epoch: 9 | loss: 2.3207693
	speed: 0.0337s/iter; left time: 639.0804s
Epoch: 9 cost time: 7.702608346939087
Epoch: 9, Steps: 208 | Train Loss: 1.594 Vali Loss: 5.339 Vali Acc: 0.109 Test Loss: 5.339 Test Acc: 0.109
Validation loss decreased (-0.105833 --> -0.108506).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2068541
	speed: 0.1339s/iter; left time: 2520.2691s
	iters: 200, epoch: 10 | loss: 1.3408391
	speed: 0.0363s/iter; left time: 679.2094s
Epoch: 10 cost time: 8.07482647895813
Epoch: 10, Steps: 208 | Train Loss: 1.331 Vali Loss: 6.282 Vali Acc: 0.109 Test Loss: 6.282 Test Acc: 0.109
Validation loss decreased (-0.108506 --> -0.109093).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9876432
	speed: 0.1324s/iter; left time: 2465.0739s
	iters: 200, epoch: 11 | loss: 2.3670559
	speed: 0.0364s/iter; left time: 674.8150s
Epoch: 11 cost time: 8.120556354522705
Epoch: 11, Steps: 208 | Train Loss: 1.110 Vali Loss: 6.665 Vali Acc: 0.105 Test Loss: 6.665 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0600694
	speed: 0.1349s/iter; left time: 2483.1868s
	iters: 200, epoch: 12 | loss: 1.4907262
	speed: 0.0400s/iter; left time: 732.5841s
Epoch: 12 cost time: 8.35858154296875
Epoch: 12, Steps: 208 | Train Loss: 0.944 Vali Loss: 6.687 Vali Acc: 0.113 Test Loss: 6.687 Test Acc: 0.113
Validation loss decreased (-0.109093 --> -0.113264).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0313758
	speed: 0.1339s/iter; left time: 2437.4467s
	iters: 200, epoch: 13 | loss: 1.1147338
	speed: 0.0458s/iter; left time: 828.6309s
Epoch: 13 cost time: 9.144487380981445
Epoch: 13, Steps: 208 | Train Loss: 0.810 Vali Loss: 7.316 Vali Acc: 0.100 Test Loss: 7.316 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0820298
	speed: 0.1475s/iter; left time: 2655.0261s
	iters: 200, epoch: 14 | loss: 0.9787744
	speed: 0.0479s/iter; left time: 858.0400s
Epoch: 14 cost time: 10.05996298789978
Epoch: 14, Steps: 208 | Train Loss: 0.700 Vali Loss: 8.260 Vali Acc: 0.101 Test Loss: 8.260 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8591580
	speed: 0.1459s/iter; left time: 2594.6604s
	iters: 200, epoch: 15 | loss: 0.4884680
	speed: 0.0442s/iter; left time: 781.8816s
Epoch: 15 cost time: 9.60434103012085
Epoch: 15, Steps: 208 | Train Loss: 0.581 Vali Loss: 8.968 Vali Acc: 0.104 Test Loss: 8.968 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6148938
	speed: 0.1463s/iter; left time: 2572.5335s
	iters: 200, epoch: 16 | loss: 0.9178341
	speed: 0.0423s/iter; left time: 739.6459s
Epoch: 16 cost time: 9.29056692123413
Epoch: 16, Steps: 208 | Train Loss: 0.529 Vali Loss: 8.899 Vali Acc: 0.102 Test Loss: 8.899 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5852695
	speed: 0.1484s/iter; left time: 2578.9792s
	iters: 200, epoch: 17 | loss: 0.8454537
	speed: 0.0436s/iter; left time: 753.0087s
Epoch: 17 cost time: 9.604913711547852
Epoch: 17, Steps: 208 | Train Loss: 0.489 Vali Loss: 10.077 Vali Acc: 0.106 Test Loss: 10.077 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.7861316
	speed: 0.1476s/iter; left time: 2534.2733s
	iters: 200, epoch: 18 | loss: 0.3710766
	speed: 0.0463s/iter; left time: 789.6278s
Epoch: 18 cost time: 9.962596654891968
Epoch: 18, Steps: 208 | Train Loss: 0.427 Vali Loss: 10.132 Vali Acc: 0.108 Test Loss: 10.132 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4675983
	speed: 0.1409s/iter; left time: 2388.5931s
	iters: 200, epoch: 19 | loss: 0.4984927
	speed: 0.0387s/iter; left time: 652.6494s
Epoch: 19 cost time: 8.563084602355957
Epoch: 19, Steps: 208 | Train Loss: 0.394 Vali Loss: 10.353 Vali Acc: 0.103 Test Loss: 10.353 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2370975
	speed: 0.1464s/iter; left time: 2452.0237s
	iters: 200, epoch: 20 | loss: 0.7448996
	speed: 0.0471s/iter; left time: 783.5759s
Epoch: 20 cost time: 10.33634328842163
Epoch: 20, Steps: 208 | Train Loss: 0.363 Vali Loss: 11.127 Vali Acc: 0.109 Test Loss: 11.127 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.5678275
	speed: 0.1467s/iter; left time: 2426.5648s
	iters: 200, epoch: 21 | loss: 0.1132961
	speed: 0.0477s/iter; left time: 784.1734s
Epoch: 21 cost time: 10.32676887512207
Epoch: 21, Steps: 208 | Train Loss: 0.333 Vali Loss: 11.805 Vali Acc: 0.111 Test Loss: 11.805 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2128463
	speed: 0.1447s/iter; left time: 2363.5496s
	iters: 200, epoch: 22 | loss: 0.3423209
	speed: 0.0486s/iter; left time: 788.6154s
Epoch: 22 cost time: 10.110776901245117
Epoch: 22, Steps: 208 | Train Loss: 0.319 Vali Loss: 11.408 Vali Acc: 0.095 Test Loss: 11.408 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11333134506412168
model parameter : 510551
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1390724
	speed: 0.0438s/iter; left time: 907.4968s
	iters: 200, epoch: 1 | loss: 3.7034266
	speed: 0.0282s/iter; left time: 580.1341s
Epoch: 1 cost time: 7.514983654022217
Epoch: 1, Steps: 208 | Train Loss: 3.887 Vali Loss: 3.907 Vali Acc: 0.065 Test Loss: 3.907 Test Acc: 0.065
Validation loss decreased (inf --> -0.064977).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8841691
	speed: 0.1128s/iter; left time: 2310.7276s
	iters: 200, epoch: 2 | loss: 3.3760858
	speed: 0.0272s/iter; left time: 555.0846s
Epoch: 2 cost time: 6.4762208461761475
Epoch: 2, Steps: 208 | Train Loss: 3.556 Vali Loss: 3.631 Vali Acc: 0.082 Test Loss: 3.631 Test Acc: 0.082
Validation loss decreased (-0.064977 --> -0.081682).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7003253
	speed: 0.1108s/iter; left time: 2247.1440s
	iters: 200, epoch: 3 | loss: 3.2192612
	speed: 0.0310s/iter; left time: 625.8933s
Epoch: 3 cost time: 6.862383604049683
Epoch: 3, Steps: 208 | Train Loss: 3.173 Vali Loss: 3.649 Vali Acc: 0.095 Test Loss: 3.649 Test Acc: 0.095
Validation loss decreased (-0.081682 --> -0.094506).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7882128
	speed: 0.1190s/iter; left time: 2388.2345s
	iters: 200, epoch: 4 | loss: 3.1764686
	speed: 0.0318s/iter; left time: 636.0313s
Epoch: 4 cost time: 6.966076374053955
Epoch: 4, Steps: 208 | Train Loss: 2.973 Vali Loss: 3.875 Vali Acc: 0.103 Test Loss: 3.875 Test Acc: 0.103
Validation loss decreased (-0.094506 --> -0.102556).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4940515
	speed: 0.1218s/iter; left time: 2419.8459s
	iters: 200, epoch: 5 | loss: 3.7552276
	speed: 0.0389s/iter; left time: 769.4777s
Epoch: 5 cost time: 8.260873317718506
Epoch: 5, Steps: 208 | Train Loss: 2.793 Vali Loss: 3.902 Vali Acc: 0.125 Test Loss: 3.902 Test Acc: 0.125
Validation loss decreased (-0.102556 --> -0.124924).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4267201
	speed: 0.1271s/iter; left time: 2498.0223s
	iters: 200, epoch: 6 | loss: 2.8723717
	speed: 0.0354s/iter; left time: 691.6341s
Epoch: 6 cost time: 7.820241928100586
Epoch: 6, Steps: 208 | Train Loss: 2.603 Vali Loss: 4.155 Vali Acc: 0.107 Test Loss: 4.155 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0245547
	speed: 0.1288s/iter; left time: 2504.6349s
	iters: 200, epoch: 7 | loss: 1.8222811
	speed: 0.0367s/iter; left time: 710.3698s
Epoch: 7 cost time: 8.121832847595215
Epoch: 7, Steps: 208 | Train Loss: 2.401 Vali Loss: 4.355 Vali Acc: 0.104 Test Loss: 4.355 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0588942
	speed: 0.1303s/iter; left time: 2507.9077s
	iters: 200, epoch: 8 | loss: 3.0302770
	speed: 0.0383s/iter; left time: 732.8157s
Epoch: 8 cost time: 8.162919521331787
Epoch: 8, Steps: 208 | Train Loss: 2.275 Vali Loss: 4.148 Vali Acc: 0.107 Test Loss: 4.148 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.1834381
	speed: 0.1340s/iter; left time: 2551.3072s
	iters: 200, epoch: 9 | loss: 2.4078920
	speed: 0.0370s/iter; left time: 700.8384s
Epoch: 9 cost time: 8.121571063995361
Epoch: 9, Steps: 208 | Train Loss: 2.076 Vali Loss: 4.366 Vali Acc: 0.114 Test Loss: 4.366 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.3908541
	speed: 0.1281s/iter; left time: 2412.1025s
	iters: 200, epoch: 10 | loss: 2.4458995
	speed: 0.0373s/iter; left time: 697.9405s
Epoch: 10 cost time: 7.993759632110596
Epoch: 10, Steps: 208 | Train Loss: 1.891 Vali Loss: 4.518 Vali Acc: 0.120 Test Loss: 4.518 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.8411027
	speed: 0.1251s/iter; left time: 2330.0184s
	iters: 200, epoch: 11 | loss: 2.3423808
	speed: 0.0361s/iter; left time: 668.0624s
Epoch: 11 cost time: 7.947680473327637
Epoch: 11, Steps: 208 | Train Loss: 1.768 Vali Loss: 4.789 Vali Acc: 0.112 Test Loss: 4.789 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.2194564
	speed: 0.1279s/iter; left time: 2355.1778s
	iters: 200, epoch: 12 | loss: 2.0956488
	speed: 0.0363s/iter; left time: 665.0784s
Epoch: 12 cost time: 8.069170713424683
Epoch: 12, Steps: 208 | Train Loss: 1.622 Vali Loss: 4.909 Vali Acc: 0.116 Test Loss: 4.909 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.2708423
	speed: 0.1276s/iter; left time: 2322.4001s
	iters: 200, epoch: 13 | loss: 1.2154611
	speed: 0.0376s/iter; left time: 680.8930s
Epoch: 13 cost time: 8.255522727966309
Epoch: 13, Steps: 208 | Train Loss: 1.463 Vali Loss: 5.164 Vali Acc: 0.122 Test Loss: 5.164 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0688226
	speed: 0.1259s/iter; left time: 2265.1034s
	iters: 200, epoch: 14 | loss: 1.4567223
	speed: 0.0365s/iter; left time: 653.1975s
Epoch: 14 cost time: 8.102589845657349
Epoch: 14, Steps: 208 | Train Loss: 1.359 Vali Loss: 5.610 Vali Acc: 0.115 Test Loss: 5.610 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.7564108
	speed: 0.1108s/iter; left time: 1971.0563s
	iters: 200, epoch: 15 | loss: 1.5263743
	speed: 0.0287s/iter; left time: 507.9137s
Epoch: 15 cost time: 6.398395538330078
Epoch: 15, Steps: 208 | Train Loss: 1.201 Vali Loss: 6.003 Vali Acc: 0.110 Test Loss: 6.003 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12496271995228155
model parameter : 263527
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8469706
	speed: 0.0484s/iter; left time: 1002.2205s
	iters: 200, epoch: 1 | loss: 3.9637170
	speed: 0.0270s/iter; left time: 556.3076s
Epoch: 1 cost time: 7.862445831298828
Epoch: 1, Steps: 208 | Train Loss: 3.792 Vali Loss: 3.751 Vali Acc: 0.057 Test Loss: 3.751 Test Acc: 0.057
Validation loss decreased (inf --> -0.056926).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9439654
	speed: 0.1090s/iter; left time: 2234.5966s
	iters: 200, epoch: 2 | loss: 3.5813677
	speed: 0.0280s/iter; left time: 570.4667s
Epoch: 2 cost time: 6.162545919418335
Epoch: 2, Steps: 208 | Train Loss: 3.477 Vali Loss: 3.666 Vali Acc: 0.077 Test Loss: 3.666 Test Acc: 0.077
Validation loss decreased (-0.056926 --> -0.076611).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4433665
	speed: 0.1176s/iter; left time: 2384.7981s
	iters: 200, epoch: 3 | loss: 3.2478766
	speed: 0.0374s/iter; left time: 755.7797s
Epoch: 3 cost time: 7.259167671203613
Epoch: 3, Steps: 208 | Train Loss: 3.181 Vali Loss: 3.759 Vali Acc: 0.088 Test Loss: 3.759 Test Acc: 0.088
Validation loss decreased (-0.076611 --> -0.088242).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1003599
	speed: 0.1252s/iter; left time: 2512.7150s
	iters: 200, epoch: 4 | loss: 3.1395152
	speed: 0.0359s/iter; left time: 717.2378s
Epoch: 4 cost time: 7.980384349822998
Epoch: 4, Steps: 208 | Train Loss: 3.003 Vali Loss: 3.926 Vali Acc: 0.087 Test Loss: 3.926 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.9560246
	speed: 0.1216s/iter; left time: 2416.7796s
	iters: 200, epoch: 5 | loss: 2.6138339
	speed: 0.0390s/iter; left time: 770.8480s
Epoch: 5 cost time: 8.142200946807861
Epoch: 5, Steps: 208 | Train Loss: 2.832 Vali Loss: 3.992 Vali Acc: 0.095 Test Loss: 3.992 Test Acc: 0.095
Validation loss decreased (-0.088242 --> -0.095397).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5120437
	speed: 0.1244s/iter; left time: 2446.0152s
	iters: 200, epoch: 6 | loss: 3.4041276
	speed: 0.0373s/iter; left time: 729.2456s
Epoch: 6 cost time: 8.177332162857056
Epoch: 6, Steps: 208 | Train Loss: 2.663 Vali Loss: 3.951 Vali Acc: 0.101 Test Loss: 3.951 Test Acc: 0.101
Validation loss decreased (-0.095397 --> -0.100766).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9944849
	speed: 0.1234s/iter; left time: 2399.6993s
	iters: 200, epoch: 7 | loss: 2.3533080
	speed: 0.0390s/iter; left time: 754.2251s
Epoch: 7 cost time: 8.294113159179688
Epoch: 7, Steps: 208 | Train Loss: 2.542 Vali Loss: 3.988 Vali Acc: 0.116 Test Loss: 3.988 Test Acc: 0.116
Validation loss decreased (-0.100766 --> -0.115677).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1881945
	speed: 0.1261s/iter; left time: 2425.9476s
	iters: 200, epoch: 8 | loss: 2.3749177
	speed: 0.0339s/iter; left time: 648.8839s
Epoch: 8 cost time: 7.739844083786011
Epoch: 8, Steps: 208 | Train Loss: 2.371 Vali Loss: 4.108 Vali Acc: 0.103 Test Loss: 4.108 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.0346639
	speed: 0.1193s/iter; left time: 2271.1311s
	iters: 200, epoch: 9 | loss: 2.8698068
	speed: 0.0362s/iter; left time: 686.1377s
Epoch: 9 cost time: 7.911660432815552
Epoch: 9, Steps: 208 | Train Loss: 2.248 Vali Loss: 4.078 Vali Acc: 0.112 Test Loss: 4.078 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.3406503
	speed: 0.1209s/iter; left time: 2275.6296s
	iters: 200, epoch: 10 | loss: 2.4526842
	speed: 0.0371s/iter; left time: 694.0262s
Epoch: 10 cost time: 7.9530627727508545
Epoch: 10, Steps: 208 | Train Loss: 2.107 Vali Loss: 4.283 Vali Acc: 0.108 Test Loss: 4.283 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.9700754
	speed: 0.1231s/iter; left time: 2292.0451s
	iters: 200, epoch: 11 | loss: 2.3772936
	speed: 0.0327s/iter; left time: 604.9126s
Epoch: 11 cost time: 7.355812311172485
Epoch: 11, Steps: 208 | Train Loss: 1.957 Vali Loss: 4.362 Vali Acc: 0.118 Test Loss: 4.362 Test Acc: 0.118
Validation loss decreased (-0.115677 --> -0.117463).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0549073
	speed: 0.1222s/iter; left time: 2250.6046s
	iters: 200, epoch: 12 | loss: 2.3826089
	speed: 0.0378s/iter; left time: 691.7326s
Epoch: 12 cost time: 7.879784822463989
Epoch: 12, Steps: 208 | Train Loss: 1.844 Vali Loss: 4.529 Vali Acc: 0.115 Test Loss: 4.529 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.9716578
	speed: 0.1218s/iter; left time: 2217.0551s
	iters: 200, epoch: 13 | loss: 1.8708072
	speed: 0.0349s/iter; left time: 632.1434s
Epoch: 13 cost time: 7.686349630355835
Epoch: 13, Steps: 208 | Train Loss: 1.728 Vali Loss: 4.804 Vali Acc: 0.117 Test Loss: 4.804 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2323046
	speed: 0.1160s/iter; left time: 2088.1282s
	iters: 200, epoch: 14 | loss: 2.0260801
	speed: 0.0289s/iter; left time: 517.6658s
Epoch: 14 cost time: 6.328021287918091
Epoch: 14, Steps: 208 | Train Loss: 1.658 Vali Loss: 4.947 Vali Acc: 0.115 Test Loss: 4.947 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.3010141
	speed: 0.1152s/iter; left time: 2049.9823s
	iters: 200, epoch: 15 | loss: 1.9646288
	speed: 0.0276s/iter; left time: 488.4753s
Epoch: 15 cost time: 6.193326234817505
Epoch: 15, Steps: 208 | Train Loss: 1.552 Vali Loss: 5.234 Vali Acc: 0.117 Test Loss: 5.234 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2522944
	speed: 0.1115s/iter; left time: 1959.5539s
	iters: 200, epoch: 16 | loss: 1.3970004
	speed: 0.0261s/iter; left time: 456.5214s
Epoch: 16 cost time: 5.757482051849365
Epoch: 16, Steps: 208 | Train Loss: 1.469 Vali Loss: 5.253 Vali Acc: 0.117 Test Loss: 5.253 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9894615
	speed: 0.1102s/iter; left time: 1914.0357s
	iters: 200, epoch: 17 | loss: 1.7477984
	speed: 0.0288s/iter; left time: 497.8838s
Epoch: 17 cost time: 6.3211283683776855
Epoch: 17, Steps: 208 | Train Loss: 1.351 Vali Loss: 5.269 Vali Acc: 0.118 Test Loss: 5.269 Test Acc: 0.118
Validation loss decreased (-0.117463 --> -0.118349).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3430647
	speed: 0.1123s/iter; left time: 1926.8643s
	iters: 200, epoch: 18 | loss: 1.3306295
	speed: 0.0333s/iter; left time: 568.7304s
Epoch: 18 cost time: 6.893131256103516
Epoch: 18, Steps: 208 | Train Loss: 1.304 Vali Loss: 5.623 Vali Acc: 0.124 Test Loss: 5.623 Test Acc: 0.124
Validation loss decreased (-0.118349 --> -0.124310).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3476319
	speed: 0.1231s/iter; left time: 2087.2181s
	iters: 200, epoch: 19 | loss: 1.0689855
	speed: 0.0347s/iter; left time: 584.7429s
Epoch: 19 cost time: 7.793776273727417
Epoch: 19, Steps: 208 | Train Loss: 1.237 Vali Loss: 5.828 Vali Acc: 0.116 Test Loss: 5.828 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5409594
	speed: 0.1192s/iter; left time: 1996.0443s
	iters: 200, epoch: 20 | loss: 1.1984787
	speed: 0.0375s/iter; left time: 625.0583s
Epoch: 20 cost time: 7.772257089614868
Epoch: 20, Steps: 208 | Train Loss: 1.182 Vali Loss: 6.232 Vali Acc: 0.122 Test Loss: 6.232 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0952424
	speed: 0.1225s/iter; left time: 2026.4412s
	iters: 200, epoch: 21 | loss: 0.8697684
	speed: 0.0319s/iter; left time: 523.9398s
Epoch: 21 cost time: 7.4266791343688965
Epoch: 21, Steps: 208 | Train Loss: 1.105 Vali Loss: 6.049 Vali Acc: 0.116 Test Loss: 6.049 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.7983673
	speed: 0.1225s/iter; left time: 2000.0103s
	iters: 200, epoch: 22 | loss: 1.4741541
	speed: 0.0367s/iter; left time: 596.4388s
Epoch: 22 cost time: 7.857736110687256
Epoch: 22, Steps: 208 | Train Loss: 1.063 Vali Loss: 6.750 Vali Acc: 0.116 Test Loss: 6.750 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.6506772
	speed: 0.1248s/iter; left time: 2013.0716s
	iters: 200, epoch: 23 | loss: 0.8955355
	speed: 0.0368s/iter; left time: 589.9495s
Epoch: 23 cost time: 8.098269939422607
Epoch: 23, Steps: 208 | Train Loss: 0.963 Vali Loss: 6.676 Vali Acc: 0.118 Test Loss: 6.676 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.2412063
	speed: 0.1212s/iter; left time: 1929.5650s
	iters: 200, epoch: 24 | loss: 1.9557554
	speed: 0.0346s/iter; left time: 547.4495s
Epoch: 24 cost time: 7.577149391174316
Epoch: 24, Steps: 208 | Train Loss: 0.950 Vali Loss: 6.886 Vali Acc: 0.118 Test Loss: 6.886 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.8786330
	speed: 0.1205s/iter; left time: 1892.1676s
	iters: 200, epoch: 25 | loss: 0.8130651
	speed: 0.0367s/iter; left time: 573.3294s
Epoch: 25 cost time: 7.726525068283081
Epoch: 25, Steps: 208 | Train Loss: 0.933 Vali Loss: 7.128 Vali Acc: 0.116 Test Loss: 7.128 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.4942522
	speed: 0.1241s/iter; left time: 1923.3490s
	iters: 200, epoch: 26 | loss: 0.9193193
	speed: 0.0357s/iter; left time: 549.2284s
Epoch: 26 cost time: 7.938132047653198
Epoch: 26, Steps: 208 | Train Loss: 0.887 Vali Loss: 7.471 Vali Acc: 0.118 Test Loss: 7.471 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.3467719
	speed: 0.1254s/iter; left time: 1917.6985s
	iters: 200, epoch: 27 | loss: 1.1332568
	speed: 0.0369s/iter; left time: 560.4510s
Epoch: 27 cost time: 7.929694652557373
Epoch: 27, Steps: 208 | Train Loss: 0.800 Vali Loss: 7.629 Vali Acc: 0.120 Test Loss: 7.629 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.1266198
	speed: 0.1264s/iter; left time: 1907.3096s
	iters: 200, epoch: 28 | loss: 1.0211306
	speed: 0.0367s/iter; left time: 549.7857s
Epoch: 28 cost time: 8.230452060699463
Epoch: 28, Steps: 208 | Train Loss: 0.783 Vali Loss: 7.817 Vali Acc: 0.117 Test Loss: 7.817 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12436623918878616
model parameter : 181255
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8886590
	speed: 0.0445s/iter; left time: 922.0844s
	iters: 200, epoch: 1 | loss: 3.4043338
	speed: 0.0278s/iter; left time: 571.6971s
Epoch: 1 cost time: 7.490671634674072
Epoch: 1, Steps: 208 | Train Loss: 3.790 Vali Loss: 3.738 Vali Acc: 0.056 Test Loss: 3.738 Test Acc: 0.056
Validation loss decreased (inf --> -0.056330).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5925150
	speed: 0.1130s/iter; left time: 2315.4667s
	iters: 200, epoch: 2 | loss: 3.9646335
	speed: 0.0268s/iter; left time: 547.0413s
Epoch: 2 cost time: 6.1324052810668945
Epoch: 2, Steps: 208 | Train Loss: 3.525 Vali Loss: 3.711 Vali Acc: 0.074 Test Loss: 3.711 Test Acc: 0.074
Validation loss decreased (-0.056330 --> -0.073927).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7703650
	speed: 0.1115s/iter; left time: 2262.7199s
	iters: 200, epoch: 3 | loss: 3.3666375
	speed: 0.0267s/iter; left time: 538.8725s
Epoch: 3 cost time: 6.114086627960205
Epoch: 3, Steps: 208 | Train Loss: 3.304 Vali Loss: 3.842 Vali Acc: 0.068 Test Loss: 3.842 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.9770286
	speed: 0.1239s/iter; left time: 2487.2604s
	iters: 200, epoch: 4 | loss: 3.5519295
	speed: 0.0360s/iter; left time: 719.6585s
Epoch: 4 cost time: 7.784832000732422
Epoch: 4, Steps: 208 | Train Loss: 3.138 Vali Loss: 3.808 Vali Acc: 0.081 Test Loss: 3.808 Test Acc: 0.081
Validation loss decreased (-0.073927 --> -0.081382).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3406215
	speed: 0.1287s/iter; left time: 2558.0652s
	iters: 200, epoch: 5 | loss: 2.9128304
	speed: 0.0349s/iter; left time: 690.3387s
Epoch: 5 cost time: 7.812196731567383
Epoch: 5, Steps: 208 | Train Loss: 2.957 Vali Loss: 3.811 Vali Acc: 0.098 Test Loss: 3.811 Test Acc: 0.098
Validation loss decreased (-0.081382 --> -0.098381).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2237206
	speed: 0.1238s/iter; left time: 2434.5384s
	iters: 200, epoch: 6 | loss: 2.6957612
	speed: 0.0344s/iter; left time: 672.0207s
Epoch: 6 cost time: 7.5362913608551025
Epoch: 6, Steps: 208 | Train Loss: 2.797 Vali Loss: 3.841 Vali Acc: 0.091 Test Loss: 3.841 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4212122
	speed: 0.1229s/iter; left time: 2391.6944s
	iters: 200, epoch: 7 | loss: 3.2937360
	speed: 0.0345s/iter; left time: 667.7933s
Epoch: 7 cost time: 7.475656986236572
Epoch: 7, Steps: 208 | Train Loss: 2.640 Vali Loss: 3.921 Vali Acc: 0.099 Test Loss: 3.921 Test Acc: 0.099
Validation loss decreased (-0.098381 --> -0.098977).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3687475
	speed: 0.1231s/iter; left time: 2369.6851s
	iters: 200, epoch: 8 | loss: 2.3494792
	speed: 0.0329s/iter; left time: 630.4876s
Epoch: 8 cost time: 7.516367673873901
Epoch: 8, Steps: 208 | Train Loss: 2.474 Vali Loss: 4.027 Vali Acc: 0.112 Test Loss: 4.027 Test Acc: 0.112
Validation loss decreased (-0.098977 --> -0.111800).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5331035
	speed: 0.1152s/iter; left time: 2193.6252s
	iters: 200, epoch: 9 | loss: 2.3411164
	speed: 0.0314s/iter; left time: 594.0302s
Epoch: 9 cost time: 6.966197967529297
Epoch: 9, Steps: 208 | Train Loss: 2.382 Vali Loss: 4.017 Vali Acc: 0.113 Test Loss: 4.017 Test Acc: 0.113
Validation loss decreased (-0.111800 --> -0.112695).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.0182586
	speed: 0.1227s/iter; left time: 2310.5476s
	iters: 200, epoch: 10 | loss: 2.6328678
	speed: 0.0368s/iter; left time: 688.6108s
Epoch: 10 cost time: 7.799595355987549
Epoch: 10, Steps: 208 | Train Loss: 2.246 Vali Loss: 4.214 Vali Acc: 0.109 Test Loss: 4.214 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3573267
	speed: 0.1205s/iter; left time: 2243.6156s
	iters: 200, epoch: 11 | loss: 2.3846257
	speed: 0.0346s/iter; left time: 640.1705s
Epoch: 11 cost time: 7.639117956161499
Epoch: 11, Steps: 208 | Train Loss: 2.152 Vali Loss: 4.300 Vali Acc: 0.109 Test Loss: 4.300 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7853916
	speed: 0.1169s/iter; left time: 2151.7853s
	iters: 200, epoch: 12 | loss: 2.2722178
	speed: 0.0346s/iter; left time: 634.3676s
Epoch: 12 cost time: 7.461397409439087
Epoch: 12, Steps: 208 | Train Loss: 2.048 Vali Loss: 4.474 Vali Acc: 0.120 Test Loss: 4.474 Test Acc: 0.120
Validation loss decreased (-0.112695 --> -0.120146).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6742606
	speed: 0.1214s/iter; left time: 2210.6560s
	iters: 200, epoch: 13 | loss: 2.1810842
	speed: 0.0302s/iter; left time: 547.0440s
Epoch: 13 cost time: 7.068949937820435
Epoch: 13, Steps: 208 | Train Loss: 1.945 Vali Loss: 4.516 Vali Acc: 0.113 Test Loss: 4.516 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2496562
	speed: 0.1084s/iter; left time: 1950.8884s
	iters: 200, epoch: 14 | loss: 2.3599637
	speed: 0.0272s/iter; left time: 487.6871s
Epoch: 14 cost time: 6.102474689483643
Epoch: 14, Steps: 208 | Train Loss: 1.884 Vali Loss: 4.588 Vali Acc: 0.122 Test Loss: 4.588 Test Acc: 0.122
Validation loss decreased (-0.120146 --> -0.121636).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.0845344
	speed: 0.1137s/iter; left time: 2022.6766s
	iters: 200, epoch: 15 | loss: 1.3194041
	speed: 0.0278s/iter; left time: 491.7203s
Epoch: 15 cost time: 6.293288230895996
Epoch: 15, Steps: 208 | Train Loss: 1.776 Vali Loss: 4.796 Vali Acc: 0.113 Test Loss: 4.796 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.1740019
	speed: 0.1113s/iter; left time: 1956.9456s
	iters: 200, epoch: 16 | loss: 1.6287293
	speed: 0.0271s/iter; left time: 473.9317s
Epoch: 16 cost time: 6.086050748825073
Epoch: 16, Steps: 208 | Train Loss: 1.655 Vali Loss: 4.879 Vali Acc: 0.109 Test Loss: 4.879 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1261578
	speed: 0.1126s/iter; left time: 1955.7764s
	iters: 200, epoch: 17 | loss: 2.1044037
	speed: 0.0282s/iter; left time: 487.0735s
Epoch: 17 cost time: 6.255084753036499
Epoch: 17, Steps: 208 | Train Loss: 1.601 Vali Loss: 5.139 Vali Acc: 0.116 Test Loss: 5.139 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.6971653
	speed: 0.1125s/iter; left time: 1930.3267s
	iters: 200, epoch: 18 | loss: 1.2430670
	speed: 0.0336s/iter; left time: 572.6549s
Epoch: 18 cost time: 7.3535239696502686
Epoch: 18, Steps: 208 | Train Loss: 1.525 Vali Loss: 5.335 Vali Acc: 0.112 Test Loss: 5.335 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.3551028
	speed: 0.1180s/iter; left time: 2001.4837s
	iters: 200, epoch: 19 | loss: 0.8845424
	speed: 0.0352s/iter; left time: 592.6807s
Epoch: 19 cost time: 7.524850845336914
Epoch: 19, Steps: 208 | Train Loss: 1.415 Vali Loss: 5.480 Vali Acc: 0.117 Test Loss: 5.480 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.4648559
	speed: 0.1181s/iter; left time: 1978.4902s
	iters: 200, epoch: 20 | loss: 1.6598325
	speed: 0.0337s/iter; left time: 560.8823s
Epoch: 20 cost time: 7.532588720321655
Epoch: 20, Steps: 208 | Train Loss: 1.382 Vali Loss: 5.744 Vali Acc: 0.113 Test Loss: 5.744 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.5215350
	speed: 0.1198s/iter; left time: 1981.0790s
	iters: 200, epoch: 21 | loss: 1.3210546
	speed: 0.0364s/iter; left time: 597.8712s
Epoch: 21 cost time: 7.816150665283203
Epoch: 21, Steps: 208 | Train Loss: 1.326 Vali Loss: 5.647 Vali Acc: 0.107 Test Loss: 5.647 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.4511813
	speed: 0.1200s/iter; left time: 1960.7517s
	iters: 200, epoch: 22 | loss: 1.3526525
	speed: 0.0337s/iter; left time: 546.6339s
Epoch: 22 cost time: 7.523050546646118
Epoch: 22, Steps: 208 | Train Loss: 1.271 Vali Loss: 5.929 Vali Acc: 0.107 Test Loss: 5.929 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 2.0683000
	speed: 0.1190s/iter; left time: 1918.1796s
	iters: 200, epoch: 23 | loss: 1.6993279
	speed: 0.0331s/iter; left time: 530.0078s
Epoch: 23 cost time: 7.166428804397583
Epoch: 23, Steps: 208 | Train Loss: 1.213 Vali Loss: 6.218 Vali Acc: 0.110 Test Loss: 6.218 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.5337971
	speed: 0.1240s/iter; left time: 1974.3032s
	iters: 200, epoch: 24 | loss: 0.8813466
	speed: 0.0315s/iter; left time: 498.8640s
Epoch: 24 cost time: 7.240541458129883
Epoch: 24, Steps: 208 | Train Loss: 1.154 Vali Loss: 6.354 Vali Acc: 0.111 Test Loss: 6.354 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12168207575305696
model parameter : 147015
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7039392
	speed: 0.0503s/iter; left time: 1042.0164s
	iters: 200, epoch: 1 | loss: 3.6693130
	speed: 0.0307s/iter; left time: 633.2010s
Epoch: 1 cost time: 8.414944410324097
Epoch: 1, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.714 Vali Acc: 0.053 Test Loss: 3.714 Test Acc: 0.053
Validation loss decreased (inf --> -0.053050).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2717693
	speed: 0.1213s/iter; left time: 2485.5422s
	iters: 200, epoch: 2 | loss: 3.6723969
	speed: 0.0248s/iter; left time: 505.4388s
Epoch: 2 cost time: 6.297449827194214
Epoch: 2, Steps: 208 | Train Loss: 3.558 Vali Loss: 3.661 Vali Acc: 0.070 Test Loss: 3.661 Test Acc: 0.070
Validation loss decreased (-0.053050 --> -0.069752).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8198493
	speed: 0.1152s/iter; left time: 2335.9779s
	iters: 200, epoch: 3 | loss: 2.9058614
	speed: 0.0264s/iter; left time: 532.9089s
Epoch: 3 cost time: 6.010543584823608
Epoch: 3, Steps: 208 | Train Loss: 3.325 Vali Loss: 3.761 Vali Acc: 0.072 Test Loss: 3.761 Test Acc: 0.072
Validation loss decreased (-0.069752 --> -0.072435).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3254919
	speed: 0.1165s/iter; left time: 2339.1532s
	iters: 200, epoch: 4 | loss: 3.5838709
	speed: 0.0239s/iter; left time: 477.8231s
Epoch: 4 cost time: 5.785497426986694
Epoch: 4, Steps: 208 | Train Loss: 3.158 Vali Loss: 3.655 Vali Acc: 0.091 Test Loss: 3.655 Test Acc: 0.091
Validation loss decreased (-0.072435 --> -0.090927).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9720607
	speed: 0.1086s/iter; left time: 2157.4862s
	iters: 200, epoch: 5 | loss: 2.9312322
	speed: 0.0273s/iter; left time: 539.8657s
Epoch: 5 cost time: 6.021641254425049
Epoch: 5, Steps: 208 | Train Loss: 3.038 Vali Loss: 3.672 Vali Acc: 0.097 Test Loss: 3.672 Test Acc: 0.097
Validation loss decreased (-0.090927 --> -0.097190).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4821591
	speed: 0.1077s/iter; left time: 2117.7999s
	iters: 200, epoch: 6 | loss: 3.6001174
	speed: 0.0270s/iter; left time: 529.0693s
Epoch: 6 cost time: 5.956193923950195
Epoch: 6, Steps: 208 | Train Loss: 2.885 Vali Loss: 3.662 Vali Acc: 0.097 Test Loss: 3.662 Test Acc: 0.097
Validation loss decreased (-0.097190 --> -0.097190).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2939677
	speed: 0.1178s/iter; left time: 2290.6624s
	iters: 200, epoch: 7 | loss: 3.3432651
	speed: 0.0335s/iter; left time: 648.7212s
Epoch: 7 cost time: 7.491284370422363
Epoch: 7, Steps: 208 | Train Loss: 2.782 Vali Loss: 3.714 Vali Acc: 0.101 Test Loss: 3.714 Test Acc: 0.101
Validation loss decreased (-0.097190 --> -0.100768).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0378940
	speed: 0.1189s/iter; left time: 2288.7403s
	iters: 200, epoch: 8 | loss: 3.1516879
	speed: 0.0319s/iter; left time: 611.6643s
Epoch: 8 cost time: 7.2264404296875
Epoch: 8, Steps: 208 | Train Loss: 2.689 Vali Loss: 3.865 Vali Acc: 0.100 Test Loss: 3.865 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.7906899
	speed: 0.1196s/iter; left time: 2276.4824s
	iters: 200, epoch: 9 | loss: 2.5668201
	speed: 0.0320s/iter; left time: 606.7646s
Epoch: 9 cost time: 6.927066802978516
Epoch: 9, Steps: 208 | Train Loss: 2.572 Vali Loss: 3.880 Vali Acc: 0.110 Test Loss: 3.880 Test Acc: 0.110
Validation loss decreased (-0.100768 --> -0.110310).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1004078
	speed: 0.1193s/iter; left time: 2246.9749s
	iters: 200, epoch: 10 | loss: 3.0488911
	speed: 0.0325s/iter; left time: 609.0291s
Epoch: 10 cost time: 7.225400447845459
Epoch: 10, Steps: 208 | Train Loss: 2.478 Vali Loss: 3.988 Vali Acc: 0.113 Test Loss: 3.988 Test Acc: 0.113
Validation loss decreased (-0.110310 --> -0.112993).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.0089767
	speed: 0.1174s/iter; left time: 2186.1428s
	iters: 200, epoch: 11 | loss: 3.0770855
	speed: 0.0303s/iter; left time: 562.0412s
Epoch: 11 cost time: 6.945647954940796
Epoch: 11, Steps: 208 | Train Loss: 2.394 Vali Loss: 3.986 Vali Acc: 0.117 Test Loss: 3.986 Test Acc: 0.117
Validation loss decreased (-0.112993 --> -0.117169).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0649128
	speed: 0.1178s/iter; left time: 2169.5648s
	iters: 200, epoch: 12 | loss: 2.1739571
	speed: 0.0329s/iter; left time: 603.3142s
Epoch: 12 cost time: 7.222897291183472
Epoch: 12, Steps: 208 | Train Loss: 2.303 Vali Loss: 3.976 Vali Acc: 0.118 Test Loss: 3.976 Test Acc: 0.118
Validation loss decreased (-0.117169 --> -0.118362).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.9946990
	speed: 0.1179s/iter; left time: 2147.1819s
	iters: 200, epoch: 13 | loss: 2.6305196
	speed: 0.0297s/iter; left time: 537.8975s
Epoch: 13 cost time: 6.631437540054321
Epoch: 13, Steps: 208 | Train Loss: 2.243 Vali Loss: 4.114 Vali Acc: 0.115 Test Loss: 4.114 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.3555367
	speed: 0.1307s/iter; left time: 2352.0758s
	iters: 200, epoch: 14 | loss: 2.1874835
	speed: 0.0449s/iter; left time: 802.8194s
Epoch: 14 cost time: 9.368576049804688
Epoch: 14, Steps: 208 | Train Loss: 2.176 Vali Loss: 4.155 Vali Acc: 0.113 Test Loss: 4.155 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.2669904
	speed: 0.1357s/iter; left time: 2413.7743s
	iters: 200, epoch: 15 | loss: 1.7595222
	speed: 0.0444s/iter; left time: 785.5946s
Epoch: 15 cost time: 9.225252151489258
Epoch: 15, Steps: 208 | Train Loss: 2.073 Vali Loss: 4.324 Vali Acc: 0.107 Test Loss: 4.324 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.6885569
	speed: 0.1362s/iter; left time: 2394.1839s
	iters: 200, epoch: 16 | loss: 2.6212323
	speed: 0.0273s/iter; left time: 476.3705s
Epoch: 16 cost time: 7.266881704330444
Epoch: 16, Steps: 208 | Train Loss: 2.010 Vali Loss: 4.328 Vali Acc: 0.120 Test Loss: 4.328 Test Acc: 0.120
Validation loss decreased (-0.118362 --> -0.119551).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.3902411
	speed: 0.1309s/iter; left time: 2273.2861s
	iters: 200, epoch: 17 | loss: 2.6154666
	speed: 0.0323s/iter; left time: 557.1627s
Epoch: 17 cost time: 7.595237970352173
Epoch: 17, Steps: 208 | Train Loss: 1.938 Vali Loss: 4.420 Vali Acc: 0.119 Test Loss: 4.420 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.0477962
	speed: 0.1255s/iter; left time: 2154.0401s
	iters: 200, epoch: 18 | loss: 1.8996806
	speed: 0.0364s/iter; left time: 621.9277s
Epoch: 18 cost time: 7.7898454666137695
Epoch: 18, Steps: 208 | Train Loss: 1.863 Vali Loss: 4.620 Vali Acc: 0.112 Test Loss: 4.620 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.3683360
	speed: 0.1288s/iter; left time: 2184.1187s
	iters: 200, epoch: 19 | loss: 1.9723618
	speed: 0.0322s/iter; left time: 542.4083s
Epoch: 19 cost time: 7.408044099807739
Epoch: 19, Steps: 208 | Train Loss: 1.809 Vali Loss: 4.643 Vali Acc: 0.119 Test Loss: 4.643 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.6402757
	speed: 0.1259s/iter; left time: 2108.1437s
	iters: 200, epoch: 20 | loss: 1.8512548
	speed: 0.0312s/iter; left time: 520.1635s
Epoch: 20 cost time: 6.710315942764282
Epoch: 20, Steps: 208 | Train Loss: 1.765 Vali Loss: 4.730 Vali Acc: 0.121 Test Loss: 4.730 Test Acc: 0.121
Validation loss decreased (-0.119551 --> -0.121337).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.8722761
	speed: 0.1274s/iter; left time: 2107.1485s
	iters: 200, epoch: 21 | loss: 0.9854920
	speed: 0.0355s/iter; left time: 583.6305s
Epoch: 21 cost time: 7.3861987590789795
Epoch: 21, Steps: 208 | Train Loss: 1.699 Vali Loss: 4.904 Vali Acc: 0.119 Test Loss: 4.904 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.6324254
	speed: 0.1426s/iter; left time: 2328.3850s
	iters: 200, epoch: 22 | loss: 2.1815512
	speed: 0.0390s/iter; left time: 632.3971s
Epoch: 22 cost time: 8.873708248138428
Epoch: 22, Steps: 208 | Train Loss: 1.644 Vali Loss: 5.079 Vali Acc: 0.118 Test Loss: 5.079 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.3671345
	speed: 0.1352s/iter; left time: 2179.5705s
	iters: 200, epoch: 23 | loss: 1.9068127
	speed: 0.0429s/iter; left time: 687.9878s
Epoch: 23 cost time: 9.218187808990479
Epoch: 23, Steps: 208 | Train Loss: 1.591 Vali Loss: 5.175 Vali Acc: 0.116 Test Loss: 5.175 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.5482986
	speed: 0.1368s/iter; left time: 2177.6042s
	iters: 200, epoch: 24 | loss: 1.2356491
	speed: 0.0401s/iter; left time: 634.0501s
Epoch: 24 cost time: 8.659327030181885
Epoch: 24, Steps: 208 | Train Loss: 1.539 Vali Loss: 5.283 Vali Acc: 0.116 Test Loss: 5.283 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.3909581
	speed: 0.1321s/iter; left time: 2075.3971s
	iters: 200, epoch: 25 | loss: 1.4584379
	speed: 0.0355s/iter; left time: 553.9876s
Epoch: 25 cost time: 7.629207611083984
Epoch: 25, Steps: 208 | Train Loss: 1.530 Vali Loss: 5.409 Vali Acc: 0.120 Test Loss: 5.409 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.3316265
	speed: 0.1457s/iter; left time: 2258.2603s
	iters: 200, epoch: 26 | loss: 2.2085714
	speed: 0.0403s/iter; left time: 621.3724s
Epoch: 26 cost time: 9.231284379959106
Epoch: 26, Steps: 208 | Train Loss: 1.451 Vali Loss: 5.621 Vali Acc: 0.119 Test Loss: 5.621 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.7943704
	speed: 0.1343s/iter; left time: 2054.5524s
	iters: 200, epoch: 27 | loss: 1.2464494
	speed: 0.0414s/iter; left time: 628.8652s
Epoch: 27 cost time: 9.02537226676941
Epoch: 27, Steps: 208 | Train Loss: 1.393 Vali Loss: 5.656 Vali Acc: 0.122 Test Loss: 5.656 Test Acc: 0.122
Validation loss decreased (-0.121337 --> -0.121626).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.8422399
	speed: 0.1329s/iter; left time: 2004.8839s
	iters: 200, epoch: 28 | loss: 1.2230963
	speed: 0.0450s/iter; left time: 674.2150s
Epoch: 28 cost time: 9.150821685791016
Epoch: 28, Steps: 208 | Train Loss: 1.347 Vali Loss: 5.818 Vali Acc: 0.115 Test Loss: 5.818 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.9509202
	speed: 0.1334s/iter; left time: 1983.8621s
	iters: 200, epoch: 29 | loss: 1.4191397
	speed: 0.0353s/iter; left time: 521.5720s
Epoch: 29 cost time: 8.01131296157837
Epoch: 29, Steps: 208 | Train Loss: 1.310 Vali Loss: 6.021 Vali Acc: 0.118 Test Loss: 6.021 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.6361732
	speed: 0.1379s/iter; left time: 2022.5950s
	iters: 200, epoch: 30 | loss: 1.4248695
	speed: 0.0433s/iter; left time: 630.2340s
Epoch: 30 cost time: 9.238915205001831
Epoch: 30, Steps: 208 | Train Loss: 1.289 Vali Loss: 6.103 Vali Acc: 0.120 Test Loss: 6.103 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.0359755
	speed: 0.1404s/iter; left time: 2030.3508s
	iters: 200, epoch: 31 | loss: 1.0917747
	speed: 0.0418s/iter; left time: 599.7820s
Epoch: 31 cost time: 9.30687952041626
Epoch: 31, Steps: 208 | Train Loss: 1.247 Vali Loss: 6.141 Vali Acc: 0.118 Test Loss: 6.141 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.6183804
	speed: 0.1220s/iter; left time: 1738.5535s
	iters: 200, epoch: 32 | loss: 1.6261334
	speed: 0.0354s/iter; left time: 501.5163s
Epoch: 32 cost time: 7.317561149597168
Epoch: 32, Steps: 208 | Train Loss: 1.219 Vali Loss: 6.379 Vali Acc: 0.115 Test Loss: 6.379 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 1.7856872
	speed: 0.1192s/iter; left time: 1674.2845s
	iters: 200, epoch: 33 | loss: 1.2268763
	speed: 0.0305s/iter; left time: 424.9317s
Epoch: 33 cost time: 6.432340860366821
Epoch: 33, Steps: 208 | Train Loss: 1.157 Vali Loss: 6.544 Vali Acc: 0.118 Test Loss: 6.544 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 1.3360095
	speed: 0.1235s/iter; left time: 1709.2508s
	iters: 200, epoch: 34 | loss: 1.1003809
	speed: 0.0282s/iter; left time: 387.2698s
Epoch: 34 cost time: 6.728349685668945
Epoch: 34, Steps: 208 | Train Loss: 1.147 Vali Loss: 6.693 Vali Acc: 0.110 Test Loss: 6.693 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 1.4294748
	speed: 0.1268s/iter; left time: 1727.7508s
	iters: 200, epoch: 35 | loss: 1.3227596
	speed: 0.0341s/iter; left time: 460.8180s
Epoch: 35 cost time: 7.327070474624634
Epoch: 35, Steps: 208 | Train Loss: 1.101 Vali Loss: 6.717 Vali Acc: 0.116 Test Loss: 6.717 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 1.0191665
	speed: 0.1256s/iter; left time: 1686.2723s
	iters: 200, epoch: 36 | loss: 0.7786418
	speed: 0.0370s/iter; left time: 493.4350s
Epoch: 36 cost time: 7.841661691665649
Epoch: 36, Steps: 208 | Train Loss: 1.080 Vali Loss: 7.030 Vali Acc: 0.114 Test Loss: 7.030 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.9117870
	speed: 0.1342s/iter; left time: 1773.0893s
	iters: 200, epoch: 37 | loss: 0.7408773
	speed: 0.0431s/iter; left time: 564.8235s
Epoch: 37 cost time: 8.920393466949463
Epoch: 37, Steps: 208 | Train Loss: 1.054 Vali Loss: 7.111 Vali Acc: 0.119 Test Loss: 7.111 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12168207575305696
model parameter : 99143
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5172734
	speed: 0.0593s/iter; left time: 1227.0609s
	iters: 200, epoch: 1 | loss: 3.8327422
	speed: 0.0395s/iter; left time: 813.8362s
Epoch: 1 cost time: 10.259440183639526
Epoch: 1, Steps: 208 | Train Loss: 3.780 Vali Loss: 3.678 Vali Acc: 0.053 Test Loss: 3.678 Test Acc: 0.053
Validation loss decreased (inf --> -0.053348).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3925791
	speed: 0.1374s/iter; left time: 2815.1773s
	iters: 200, epoch: 2 | loss: 3.5775497
	speed: 0.0409s/iter; left time: 834.3779s
Epoch: 2 cost time: 9.016010522842407
Epoch: 2, Steps: 208 | Train Loss: 3.588 Vali Loss: 3.682 Vali Acc: 0.068 Test Loss: 3.682 Test Acc: 0.068
Validation loss decreased (-0.053348 --> -0.068260).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5036249
	speed: 0.1361s/iter; left time: 2760.1475s
	iters: 200, epoch: 3 | loss: 3.1269503
	speed: 0.0412s/iter; left time: 832.0111s
Epoch: 3 cost time: 8.830633163452148
Epoch: 3, Steps: 208 | Train Loss: 3.387 Vali Loss: 3.570 Vali Acc: 0.078 Test Loss: 3.570 Test Acc: 0.078
Validation loss decreased (-0.068260 --> -0.077507).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3407826
	speed: 0.1305s/iter; left time: 2620.7654s
	iters: 200, epoch: 4 | loss: 2.9833860
	speed: 0.0322s/iter; left time: 643.6545s
Epoch: 4 cost time: 7.405004501342773
Epoch: 4, Steps: 208 | Train Loss: 3.215 Vali Loss: 3.524 Vali Acc: 0.086 Test Loss: 3.524 Test Acc: 0.086
Validation loss decreased (-0.077507 --> -0.085560).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2154830
	speed: 0.1198s/iter; left time: 2380.2798s
	iters: 200, epoch: 5 | loss: 3.1926568
	speed: 0.0308s/iter; left time: 607.9600s
Epoch: 5 cost time: 6.7706825733184814
Epoch: 5, Steps: 208 | Train Loss: 3.085 Vali Loss: 3.631 Vali Acc: 0.077 Test Loss: 3.631 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3140042
	speed: 0.1281s/iter; left time: 2519.0757s
	iters: 200, epoch: 6 | loss: 2.5211849
	speed: 0.0316s/iter; left time: 617.7605s
Epoch: 6 cost time: 7.426720142364502
Epoch: 6, Steps: 208 | Train Loss: 2.968 Vali Loss: 3.606 Vali Acc: 0.090 Test Loss: 3.606 Test Acc: 0.090
Validation loss decreased (-0.085560 --> -0.090331).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8247545
	speed: 0.1261s/iter; left time: 2452.7977s
	iters: 200, epoch: 7 | loss: 3.0795164
	speed: 0.0349s/iter; left time: 675.5417s
Epoch: 7 cost time: 7.775472640991211
Epoch: 7, Steps: 208 | Train Loss: 2.885 Vali Loss: 3.661 Vali Acc: 0.089 Test Loss: 3.661 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5345259
	speed: 0.1193s/iter; left time: 2296.7309s
	iters: 200, epoch: 8 | loss: 3.2404101
	speed: 0.0276s/iter; left time: 528.4712s
Epoch: 8 cost time: 6.099456787109375
Epoch: 8, Steps: 208 | Train Loss: 2.793 Vali Loss: 3.701 Vali Acc: 0.108 Test Loss: 3.701 Test Acc: 0.108
Validation loss decreased (-0.090331 --> -0.107628).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6443675
	speed: 0.1226s/iter; left time: 2334.2510s
	iters: 200, epoch: 9 | loss: 2.5635738
	speed: 0.0308s/iter; left time: 583.8269s
Epoch: 9 cost time: 6.869807481765747
Epoch: 9, Steps: 208 | Train Loss: 2.726 Vali Loss: 3.739 Vali Acc: 0.096 Test Loss: 3.739 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.8407359
	speed: 0.1162s/iter; left time: 2187.9375s
	iters: 200, epoch: 10 | loss: 3.5772655
	speed: 0.0283s/iter; left time: 529.7416s
Epoch: 10 cost time: 6.353204011917114
Epoch: 10, Steps: 208 | Train Loss: 2.632 Vali Loss: 3.761 Vali Acc: 0.100 Test Loss: 3.761 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.4718471
	speed: 0.1120s/iter; left time: 2086.1825s
	iters: 200, epoch: 11 | loss: 2.6980448
	speed: 0.0283s/iter; left time: 523.2427s
Epoch: 11 cost time: 6.218767881393433
Epoch: 11, Steps: 208 | Train Loss: 2.553 Vali Loss: 3.787 Vali Acc: 0.106 Test Loss: 3.787 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.6606345
	speed: 0.1158s/iter; left time: 2131.3571s
	iters: 200, epoch: 12 | loss: 2.9185388
	speed: 0.0267s/iter; left time: 488.9941s
Epoch: 12 cost time: 6.196016311645508
Epoch: 12, Steps: 208 | Train Loss: 2.483 Vali Loss: 3.844 Vali Acc: 0.093 Test Loss: 3.844 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.4016888
	speed: 0.1232s/iter; left time: 2242.4375s
	iters: 200, epoch: 13 | loss: 2.3998196
	speed: 0.0380s/iter; left time: 688.6897s
Epoch: 13 cost time: 8.30929183959961
Epoch: 13, Steps: 208 | Train Loss: 2.416 Vali Loss: 3.899 Vali Acc: 0.108 Test Loss: 3.899 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.8463577
	speed: 0.1288s/iter; left time: 2318.3874s
	iters: 200, epoch: 14 | loss: 2.0931964
	speed: 0.0380s/iter; left time: 679.9675s
Epoch: 14 cost time: 8.235675573348999
Epoch: 14, Steps: 208 | Train Loss: 2.332 Vali Loss: 4.008 Vali Acc: 0.106 Test Loss: 4.008 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 2.7634375
	speed: 0.1233s/iter; left time: 2193.4550s
	iters: 200, epoch: 15 | loss: 2.7323272
	speed: 0.0367s/iter; left time: 649.6245s
Epoch: 15 cost time: 7.695579767227173
Epoch: 15, Steps: 208 | Train Loss: 2.291 Vali Loss: 3.969 Vali Acc: 0.109 Test Loss: 3.969 Test Acc: 0.109
Validation loss decreased (-0.107628 --> -0.109116).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.1632519
	speed: 0.1247s/iter; left time: 2191.8032s
	iters: 200, epoch: 16 | loss: 2.0659962
	speed: 0.0344s/iter; left time: 600.8321s
Epoch: 16 cost time: 7.6084816455841064
Epoch: 16, Steps: 208 | Train Loss: 2.196 Vali Loss: 4.131 Vali Acc: 0.105 Test Loss: 4.131 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.7798452
	speed: 0.1264s/iter; left time: 2196.0336s
	iters: 200, epoch: 17 | loss: 2.6018872
	speed: 0.0371s/iter; left time: 641.5452s
Epoch: 17 cost time: 8.103728771209717
Epoch: 17, Steps: 208 | Train Loss: 2.148 Vali Loss: 4.204 Vali Acc: 0.103 Test Loss: 4.204 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.0536401
	speed: 0.1286s/iter; left time: 2207.0370s
	iters: 200, epoch: 18 | loss: 1.9838105
	speed: 0.0383s/iter; left time: 653.9879s
Epoch: 18 cost time: 8.25743579864502
Epoch: 18, Steps: 208 | Train Loss: 2.079 Vali Loss: 4.264 Vali Acc: 0.103 Test Loss: 4.264 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.0875268
	speed: 0.1287s/iter; left time: 2183.1868s
	iters: 200, epoch: 19 | loss: 2.1439266
	speed: 0.0374s/iter; left time: 630.2566s
Epoch: 19 cost time: 8.143702983856201
Epoch: 19, Steps: 208 | Train Loss: 2.025 Vali Loss: 4.440 Vali Acc: 0.100 Test Loss: 4.440 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 2.4754884
	speed: 0.1218s/iter; left time: 2039.9566s
	iters: 200, epoch: 20 | loss: 1.8648049
	speed: 0.0368s/iter; left time: 613.3752s
Epoch: 20 cost time: 7.685510158538818
Epoch: 20, Steps: 208 | Train Loss: 1.955 Vali Loss: 4.461 Vali Acc: 0.112 Test Loss: 4.461 Test Acc: 0.112
Validation loss decreased (-0.109116 --> -0.111497).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.9440179
	speed: 0.1257s/iter; left time: 2079.7643s
	iters: 200, epoch: 21 | loss: 1.9364774
	speed: 0.0367s/iter; left time: 603.5853s
Epoch: 21 cost time: 8.108725547790527
Epoch: 21, Steps: 208 | Train Loss: 1.922 Vali Loss: 4.688 Vali Acc: 0.100 Test Loss: 4.688 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.9697521
	speed: 0.1298s/iter; left time: 2120.3280s
	iters: 200, epoch: 22 | loss: 2.3294649
	speed: 0.0393s/iter; left time: 638.4309s
Epoch: 22 cost time: 8.497685194015503
Epoch: 22, Steps: 208 | Train Loss: 1.862 Vali Loss: 4.676 Vali Acc: 0.108 Test Loss: 4.676 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.7930858
	speed: 0.1269s/iter; left time: 2045.9294s
	iters: 200, epoch: 23 | loss: 2.0650649
	speed: 0.0308s/iter; left time: 493.2778s
Epoch: 23 cost time: 7.105438709259033
Epoch: 23, Steps: 208 | Train Loss: 1.821 Vali Loss: 4.749 Vali Acc: 0.098 Test Loss: 4.749 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.6870724
	speed: 0.1228s/iter; left time: 1955.2712s
	iters: 200, epoch: 24 | loss: 2.1582894
	speed: 0.0289s/iter; left time: 456.8693s
Epoch: 24 cost time: 6.54341983795166
Epoch: 24, Steps: 208 | Train Loss: 1.782 Vali Loss: 4.920 Vali Acc: 0.103 Test Loss: 4.920 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.8857481
	speed: 0.1230s/iter; left time: 1932.6310s
	iters: 200, epoch: 25 | loss: 2.2871873
	speed: 0.0284s/iter; left time: 443.3818s
Epoch: 25 cost time: 6.33189845085144
Epoch: 25, Steps: 208 | Train Loss: 1.699 Vali Loss: 5.105 Vali Acc: 0.094 Test Loss: 5.105 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.9126250
	speed: 0.1164s/iter; left time: 1804.8754s
	iters: 200, epoch: 26 | loss: 1.6086850
	speed: 0.0272s/iter; left time: 418.6229s
Epoch: 26 cost time: 6.205087184906006
Epoch: 26, Steps: 208 | Train Loss: 1.673 Vali Loss: 5.086 Vali Acc: 0.099 Test Loss: 5.086 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.0704645
	speed: 0.1227s/iter; left time: 1875.8235s
	iters: 200, epoch: 27 | loss: 1.3848995
	speed: 0.0259s/iter; left time: 393.1571s
Epoch: 27 cost time: 6.238110542297363
Epoch: 27, Steps: 208 | Train Loss: 1.642 Vali Loss: 5.289 Vali Acc: 0.103 Test Loss: 5.289 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.7003134
	speed: 0.1264s/iter; left time: 1906.0623s
	iters: 200, epoch: 28 | loss: 1.6557418
	speed: 0.0373s/iter; left time: 558.6779s
Epoch: 28 cost time: 8.172266244888306
Epoch: 28, Steps: 208 | Train Loss: 1.597 Vali Loss: 5.226 Vali Acc: 0.099 Test Loss: 5.226 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.2580686
	speed: 0.1338s/iter; left time: 1990.5693s
	iters: 200, epoch: 29 | loss: 1.5910163
	speed: 0.0362s/iter; left time: 535.0514s
Epoch: 29 cost time: 8.102627515792847
Epoch: 29, Steps: 208 | Train Loss: 1.558 Vali Loss: 5.433 Vali Acc: 0.104 Test Loss: 5.433 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 1.3359843
	speed: 0.1279s/iter; left time: 1875.5414s
	iters: 200, epoch: 30 | loss: 2.2408402
	speed: 0.0360s/iter; left time: 524.5142s
Epoch: 30 cost time: 7.8492302894592285
Epoch: 30, Steps: 208 | Train Loss: 1.514 Vali Loss: 5.437 Vali Acc: 0.104 Test Loss: 5.437 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11154190277363556
model parameter : 78727
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8874536
	speed: 0.0532s/iter; left time: 1101.7417s
	iters: 200, epoch: 1 | loss: 3.6628306
	speed: 0.0340s/iter; left time: 699.5886s
Epoch: 1 cost time: 9.020012617111206
Epoch: 1, Steps: 208 | Train Loss: 3.781 Vali Loss: 3.664 Vali Acc: 0.053 Test Loss: 3.664 Test Acc: 0.053
Validation loss decreased (inf --> -0.052752).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5833547
	speed: 0.1247s/iter; left time: 2555.2298s
	iters: 200, epoch: 2 | loss: 3.9474247
	speed: 0.0375s/iter; left time: 765.7256s
Epoch: 2 cost time: 8.0777108669281
Epoch: 2, Steps: 208 | Train Loss: 3.607 Vali Loss: 3.680 Vali Acc: 0.064 Test Loss: 3.680 Test Acc: 0.064
Validation loss decreased (-0.052752 --> -0.063787).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8765011
	speed: 0.1289s/iter; left time: 2614.0919s
	iters: 200, epoch: 3 | loss: 2.9627709
	speed: 0.0384s/iter; left time: 775.5469s
Epoch: 3 cost time: 8.34224271774292
Epoch: 3, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.612 Vali Acc: 0.069 Test Loss: 3.612 Test Acc: 0.069
Validation loss decreased (-0.063787 --> -0.068559).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2947037
	speed: 0.1276s/iter; left time: 2561.9235s
	iters: 200, epoch: 4 | loss: 3.7891536
	speed: 0.0360s/iter; left time: 719.2511s
Epoch: 4 cost time: 7.740919589996338
Epoch: 4, Steps: 208 | Train Loss: 3.333 Vali Loss: 3.565 Vali Acc: 0.077 Test Loss: 3.565 Test Acc: 0.077
Validation loss decreased (-0.068559 --> -0.076910).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3303938
	speed: 0.1178s/iter; left time: 2339.8627s
	iters: 200, epoch: 5 | loss: 3.1663342
	speed: 0.0353s/iter; left time: 698.0787s
Epoch: 5 cost time: 7.385919094085693
Epoch: 5, Steps: 208 | Train Loss: 3.175 Vali Loss: 3.561 Vali Acc: 0.091 Test Loss: 3.561 Test Acc: 0.091
Validation loss decreased (-0.076910 --> -0.090629).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7257781
	speed: 0.1304s/iter; left time: 2563.6430s
	iters: 200, epoch: 6 | loss: 3.3318636
	speed: 0.0336s/iter; left time: 657.1173s
Epoch: 6 cost time: 7.854021310806274
Epoch: 6, Steps: 208 | Train Loss: 3.074 Vali Loss: 3.549 Vali Acc: 0.086 Test Loss: 3.549 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0474296
	speed: 0.1174s/iter; left time: 2284.5167s
	iters: 200, epoch: 7 | loss: 3.5573831
	speed: 0.0299s/iter; left time: 577.7347s
Epoch: 7 cost time: 6.483078241348267
Epoch: 7, Steps: 208 | Train Loss: 2.984 Vali Loss: 3.600 Vali Acc: 0.089 Test Loss: 3.600 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.7185450
	speed: 0.1164s/iter; left time: 2241.0765s
	iters: 200, epoch: 8 | loss: 3.5444615
	speed: 0.0243s/iter; left time: 465.4239s
Epoch: 8 cost time: 5.655325651168823
Epoch: 8, Steps: 208 | Train Loss: 2.904 Vali Loss: 3.591 Vali Acc: 0.093 Test Loss: 3.591 Test Acc: 0.093
Validation loss decreased (-0.090629 --> -0.093313).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3843696
	speed: 0.1110s/iter; left time: 2112.8046s
	iters: 200, epoch: 9 | loss: 2.8005986
	speed: 0.0279s/iter; left time: 528.8918s
Epoch: 9 cost time: 6.174663066864014
Epoch: 9, Steps: 208 | Train Loss: 2.791 Vali Loss: 3.662 Vali Acc: 0.101 Test Loss: 3.662 Test Acc: 0.101
Validation loss decreased (-0.093313 --> -0.100769).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.3131027
	speed: 0.1145s/iter; left time: 2155.3382s
	iters: 200, epoch: 10 | loss: 2.5476968
	speed: 0.0293s/iter; left time: 548.1395s
Epoch: 10 cost time: 6.351275682449341
Epoch: 10, Steps: 208 | Train Loss: 2.752 Vali Loss: 3.599 Vali Acc: 0.103 Test Loss: 3.599 Test Acc: 0.103
Validation loss decreased (-0.100769 --> -0.102857).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.9597569
	speed: 0.1135s/iter; left time: 2112.7023s
	iters: 200, epoch: 11 | loss: 3.1172168
	speed: 0.0294s/iter; left time: 544.9585s
Epoch: 11 cost time: 6.450127840042114
Epoch: 11, Steps: 208 | Train Loss: 2.666 Vali Loss: 3.717 Vali Acc: 0.098 Test Loss: 3.717 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3903439
	speed: 0.1289s/iter; left time: 2373.8063s
	iters: 200, epoch: 12 | loss: 2.4946551
	speed: 0.0346s/iter; left time: 632.8696s
Epoch: 12 cost time: 7.991078615188599
Epoch: 12, Steps: 208 | Train Loss: 2.591 Vali Loss: 3.732 Vali Acc: 0.103 Test Loss: 3.732 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.8227688
	speed: 0.1289s/iter; left time: 2347.1309s
	iters: 200, epoch: 13 | loss: 2.6627665
	speed: 0.0357s/iter; left time: 647.2449s
Epoch: 13 cost time: 7.858014345169067
Epoch: 13, Steps: 208 | Train Loss: 2.515 Vali Loss: 3.796 Vali Acc: 0.108 Test Loss: 3.796 Test Acc: 0.108
Validation loss decreased (-0.102857 --> -0.107925).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.4406629
	speed: 0.1240s/iter; left time: 2231.0464s
	iters: 200, epoch: 14 | loss: 2.2800653
	speed: 0.0357s/iter; left time: 638.7692s
Epoch: 14 cost time: 7.863397121429443
Epoch: 14, Steps: 208 | Train Loss: 2.470 Vali Loss: 3.864 Vali Acc: 0.102 Test Loss: 3.864 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3832395
	speed: 0.1221s/iter; left time: 2172.3192s
	iters: 200, epoch: 15 | loss: 2.4971201
	speed: 0.0345s/iter; left time: 610.3665s
Epoch: 15 cost time: 7.424068212509155
Epoch: 15, Steps: 208 | Train Loss: 2.410 Vali Loss: 3.905 Vali Acc: 0.104 Test Loss: 3.905 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.0999069
	speed: 0.1251s/iter; left time: 2198.7474s
	iters: 200, epoch: 16 | loss: 2.0717125
	speed: 0.0335s/iter; left time: 584.9335s
Epoch: 16 cost time: 7.374105215072632
Epoch: 16, Steps: 208 | Train Loss: 2.350 Vali Loss: 3.953 Vali Acc: 0.101 Test Loss: 3.953 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.1603715
	speed: 0.1239s/iter; left time: 2151.8397s
	iters: 200, epoch: 17 | loss: 2.0204349
	speed: 0.0329s/iter; left time: 568.2421s
Epoch: 17 cost time: 7.589714050292969
Epoch: 17, Steps: 208 | Train Loss: 2.306 Vali Loss: 4.031 Vali Acc: 0.114 Test Loss: 4.031 Test Acc: 0.114
Validation loss decreased (-0.107925 --> -0.113888).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.4386106
	speed: 0.1268s/iter; left time: 2176.6969s
	iters: 200, epoch: 18 | loss: 2.5462921
	speed: 0.0355s/iter; left time: 605.2721s
Epoch: 18 cost time: 7.771006345748901
Epoch: 18, Steps: 208 | Train Loss: 2.238 Vali Loss: 4.129 Vali Acc: 0.102 Test Loss: 4.129 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.9491643
	speed: 0.1295s/iter; left time: 2195.9068s
	iters: 200, epoch: 19 | loss: 2.0374577
	speed: 0.0347s/iter; left time: 584.1206s
Epoch: 19 cost time: 7.8206400871276855
Epoch: 19, Steps: 208 | Train Loss: 2.188 Vali Loss: 4.177 Vali Acc: 0.105 Test Loss: 4.177 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.9194694
	speed: 0.1244s/iter; left time: 2083.0803s
	iters: 200, epoch: 20 | loss: 1.9507951
	speed: 0.0330s/iter; left time: 548.7493s
Epoch: 20 cost time: 7.233499526977539
Epoch: 20, Steps: 208 | Train Loss: 2.169 Vali Loss: 4.217 Vali Acc: 0.107 Test Loss: 4.217 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.6064116
	speed: 0.1245s/iter; left time: 2058.9163s
	iters: 200, epoch: 21 | loss: 2.3326902
	speed: 0.0274s/iter; left time: 449.9788s
Epoch: 21 cost time: 6.517373323440552
Epoch: 21, Steps: 208 | Train Loss: 2.094 Vali Loss: 4.345 Vali Acc: 0.105 Test Loss: 4.345 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.8646486
	speed: 0.1196s/iter; left time: 1953.3629s
	iters: 200, epoch: 22 | loss: 2.1699269
	speed: 0.0276s/iter; left time: 448.3555s
Epoch: 22 cost time: 6.415106296539307
Epoch: 22, Steps: 208 | Train Loss: 2.064 Vali Loss: 4.377 Vali Acc: 0.109 Test Loss: 4.377 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 2.4159424
	speed: 0.1252s/iter; left time: 2019.4722s
	iters: 200, epoch: 23 | loss: 2.0391653
	speed: 0.0270s/iter; left time: 432.5949s
Epoch: 23 cost time: 6.581413984298706
Epoch: 23, Steps: 208 | Train Loss: 2.002 Vali Loss: 4.410 Vali Acc: 0.104 Test Loss: 4.410 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.6743944
	speed: 0.1211s/iter; left time: 1927.9160s
	iters: 200, epoch: 24 | loss: 1.6739501
	speed: 0.0299s/iter; left time: 473.2473s
Epoch: 24 cost time: 6.6887266635894775
Epoch: 24, Steps: 208 | Train Loss: 1.973 Vali Loss: 4.533 Vali Acc: 0.114 Test Loss: 4.533 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.7158364
	speed: 0.1248s/iter; left time: 1959.7365s
	iters: 200, epoch: 25 | loss: 2.0115578
	speed: 0.0269s/iter; left time: 420.5580s
Epoch: 25 cost time: 6.507726669311523
Epoch: 25, Steps: 208 | Train Loss: 1.916 Vali Loss: 4.629 Vali Acc: 0.104 Test Loss: 4.629 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.4502350
	speed: 0.1608s/iter; left time: 2493.2925s
	iters: 200, epoch: 26 | loss: 1.8834751
	speed: 0.0419s/iter; left time: 645.1193s
Epoch: 26 cost time: 10.289735078811646
Epoch: 26, Steps: 208 | Train Loss: 1.876 Vali Loss: 4.674 Vali Acc: 0.106 Test Loss: 4.674 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 2.0279427
	speed: 0.1699s/iter; left time: 2598.2891s
	iters: 200, epoch: 27 | loss: 1.9353526
	speed: 0.0516s/iter; left time: 783.2738s
Epoch: 27 cost time: 11.059695959091187
Epoch: 27, Steps: 208 | Train Loss: 1.844 Vali Loss: 4.793 Vali Acc: 0.100 Test Loss: 4.793 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11392782582761705
model parameter : 65175
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9837596
	speed: 0.1402s/iter; left time: 2903.0783s
	iters: 200, epoch: 1 | loss: 4.2608271
	speed: 0.1087s/iter; left time: 2239.2385s
Epoch: 1 cost time: 26.12755274772644
Epoch: 1, Steps: 208 | Train Loss: 4.009 Vali Loss: 4.187 Vali Acc: 0.063 Test Loss: 4.187 Test Acc: 0.063
Validation loss decreased (inf --> -0.062887).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9612107
	speed: 0.2782s/iter; left time: 5700.6971s
	iters: 200, epoch: 2 | loss: 3.5385530
	speed: 0.1093s/iter; left time: 2229.3774s
Epoch: 2 cost time: 25.649730443954468
Epoch: 2, Steps: 208 | Train Loss: 3.545 Vali Loss: 3.859 Vali Acc: 0.078 Test Loss: 3.859 Test Acc: 0.078
Validation loss decreased (-0.062887 --> -0.078100).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5499785
	speed: 0.2739s/iter; left time: 5555.9492s
	iters: 200, epoch: 3 | loss: 3.2706571
	speed: 0.1364s/iter; left time: 2753.3821s
Epoch: 3 cost time: 28.475550413131714
Epoch: 3, Steps: 208 | Train Loss: 3.135 Vali Loss: 3.934 Vali Acc: 0.080 Test Loss: 3.934 Test Acc: 0.080
Validation loss decreased (-0.078100 --> -0.080187).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5161903
	speed: 0.2169s/iter; left time: 4355.6043s
	iters: 200, epoch: 4 | loss: 3.4820509
	speed: 0.0861s/iter; left time: 1720.5015s
Epoch: 4 cost time: 17.778204441070557
Epoch: 4, Steps: 208 | Train Loss: 2.931 Vali Loss: 4.531 Vali Acc: 0.088 Test Loss: 4.531 Test Acc: 0.088
Validation loss decreased (-0.080187 --> -0.088234).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2527246
	speed: 0.2122s/iter; left time: 4217.0608s
	iters: 200, epoch: 5 | loss: 2.5462482
	speed: 0.0988s/iter; left time: 1953.7857s
Epoch: 5 cost time: 20.77281427383423
Epoch: 5, Steps: 208 | Train Loss: 2.698 Vali Loss: 4.806 Vali Acc: 0.096 Test Loss: 4.806 Test Acc: 0.096
Validation loss decreased (-0.088234 --> -0.095687).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1253071
	speed: 0.2906s/iter; left time: 5713.8370s
	iters: 200, epoch: 6 | loss: 3.0169196
	speed: 0.1250s/iter; left time: 2444.1765s
Epoch: 6 cost time: 26.85470700263977
Epoch: 6, Steps: 208 | Train Loss: 2.417 Vali Loss: 4.859 Vali Acc: 0.100 Test Loss: 4.859 Test Acc: 0.100
Validation loss decreased (-0.095687 --> -0.100160).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.5612733
	speed: 0.3039s/iter; left time: 5910.9427s
	iters: 200, epoch: 7 | loss: 3.4444802
	speed: 0.1237s/iter; left time: 2394.2210s
Epoch: 7 cost time: 26.590571403503418
Epoch: 7, Steps: 208 | Train Loss: 2.164 Vali Loss: 5.202 Vali Acc: 0.093 Test Loss: 5.202 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7168918
	speed: 0.2514s/iter; left time: 4838.3699s
	iters: 200, epoch: 8 | loss: 1.9607913
	speed: 0.1042s/iter; left time: 1994.2067s
Epoch: 8 cost time: 22.507442712783813
Epoch: 8, Steps: 208 | Train Loss: 1.871 Vali Loss: 5.298 Vali Acc: 0.099 Test Loss: 5.298 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9252840
	speed: 0.2683s/iter; left time: 5108.3964s
	iters: 200, epoch: 9 | loss: 1.8812517
	speed: 0.1123s/iter; left time: 2125.9260s
Epoch: 9 cost time: 23.468613624572754
Epoch: 9, Steps: 208 | Train Loss: 1.609 Vali Loss: 5.530 Vali Acc: 0.106 Test Loss: 5.530 Test Acc: 0.106
Validation loss decreased (-0.100160 --> -0.106118).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0236429
	speed: 0.2541s/iter; left time: 4784.2220s
	iters: 200, epoch: 10 | loss: 2.6249053
	speed: 0.0922s/iter; left time: 1726.0566s
Epoch: 10 cost time: 21.63075041770935
Epoch: 10, Steps: 208 | Train Loss: 1.374 Vali Loss: 6.032 Vali Acc: 0.101 Test Loss: 6.032 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4961467
	speed: 0.3003s/iter; left time: 5592.2459s
	iters: 200, epoch: 11 | loss: 2.0556421
	speed: 0.1217s/iter; left time: 2253.8263s
Epoch: 11 cost time: 27.835758924484253
Epoch: 11, Steps: 208 | Train Loss: 1.210 Vali Loss: 6.507 Vali Acc: 0.107 Test Loss: 6.507 Test Acc: 0.107
Validation loss decreased (-0.106118 --> -0.106705).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0326542
	speed: 0.2774s/iter; left time: 5108.1901s
	iters: 200, epoch: 12 | loss: 1.3524355
	speed: 0.0888s/iter; left time: 1626.5391s
Epoch: 12 cost time: 21.62666893005371
Epoch: 12, Steps: 208 | Train Loss: 1.004 Vali Loss: 7.000 Vali Acc: 0.113 Test Loss: 7.000 Test Acc: 0.113
Validation loss decreased (-0.106705 --> -0.112963).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7271562
	speed: 0.2192s/iter; left time: 3990.6450s
	iters: 200, epoch: 13 | loss: 1.2063059
	speed: 0.0912s/iter; left time: 1651.0481s
Epoch: 13 cost time: 19.51240563392639
Epoch: 13, Steps: 208 | Train Loss: 0.902 Vali Loss: 7.603 Vali Acc: 0.100 Test Loss: 7.603 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4148645
	speed: 0.2888s/iter; left time: 5198.0556s
	iters: 200, epoch: 14 | loss: 0.7275701
	speed: 0.1216s/iter; left time: 2175.6283s
Epoch: 14 cost time: 26.605027437210083
Epoch: 14, Steps: 208 | Train Loss: 0.782 Vali Loss: 8.393 Vali Acc: 0.106 Test Loss: 8.393 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6977877
	speed: 0.2690s/iter; left time: 4785.2122s
	iters: 200, epoch: 15 | loss: 0.9132801
	speed: 0.1039s/iter; left time: 1838.1346s
Epoch: 15 cost time: 23.13816785812378
Epoch: 15, Steps: 208 | Train Loss: 0.670 Vali Loss: 8.352 Vali Acc: 0.104 Test Loss: 8.352 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2177104
	speed: 0.2721s/iter; left time: 4784.6178s
	iters: 200, epoch: 16 | loss: 0.3026817
	speed: 0.0886s/iter; left time: 1548.3463s
Epoch: 16 cost time: 21.790306329727173
Epoch: 16, Steps: 208 | Train Loss: 0.618 Vali Loss: 9.019 Vali Acc: 0.103 Test Loss: 9.019 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2751011
	speed: 0.2184s/iter; left time: 3794.2105s
	iters: 200, epoch: 17 | loss: 0.4978781
	speed: 0.0611s/iter; left time: 1055.2892s
Epoch: 17 cost time: 15.660879135131836
Epoch: 17, Steps: 208 | Train Loss: 0.503 Vali Loss: 10.161 Vali Acc: 0.107 Test Loss: 10.161 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1074577
	speed: 0.1565s/iter; left time: 2686.8897s
	iters: 200, epoch: 18 | loss: 1.0577489
	speed: 0.0422s/iter; left time: 720.2892s
Epoch: 18 cost time: 9.662290334701538
Epoch: 18, Steps: 208 | Train Loss: 0.456 Vali Loss: 10.486 Vali Acc: 0.111 Test Loss: 10.486 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2699058
	speed: 0.1673s/iter; left time: 2837.6622s
	iters: 200, epoch: 19 | loss: 0.8345565
	speed: 0.0741s/iter; left time: 1248.2782s
Epoch: 19 cost time: 13.926846742630005
Epoch: 19, Steps: 208 | Train Loss: 0.446 Vali Loss: 10.485 Vali Acc: 0.107 Test Loss: 10.485 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1689098
	speed: 0.2118s/iter; left time: 3546.7102s
	iters: 200, epoch: 20 | loss: 0.3447019
	speed: 0.0782s/iter; left time: 1301.9534s
Epoch: 20 cost time: 15.626393556594849
Epoch: 20, Steps: 208 | Train Loss: 0.426 Vali Loss: 10.816 Vali Acc: 0.109 Test Loss: 10.816 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1171188
	speed: 0.2347s/iter; left time: 3882.2768s
	iters: 200, epoch: 21 | loss: 0.3025462
	speed: 0.1111s/iter; left time: 1826.0218s
Epoch: 21 cost time: 21.81824541091919
Epoch: 21, Steps: 208 | Train Loss: 0.378 Vali Loss: 11.044 Vali Acc: 0.103 Test Loss: 11.044 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.1342577
	speed: 0.2587s/iter; left time: 4225.7538s
	iters: 200, epoch: 22 | loss: 0.5663432
	speed: 0.0954s/iter; left time: 1548.0157s
Epoch: 22 cost time: 21.576771020889282
Epoch: 22, Steps: 208 | Train Loss: 0.302 Vali Loss: 11.616 Vali Acc: 0.104 Test Loss: 11.616 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.113033104682374
model parameter : 504215
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5635133
	speed: 0.0664s/iter; left time: 1374.3761s
	iters: 200, epoch: 1 | loss: 4.2967753
	speed: 0.0499s/iter; left time: 1027.9032s
Epoch: 1 cost time: 12.050881385803223
Epoch: 1, Steps: 208 | Train Loss: 3.856 Vali Loss: 3.919 Vali Acc: 0.058 Test Loss: 3.919 Test Acc: 0.058
Validation loss decreased (inf --> -0.057819).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0651855
	speed: 0.1629s/iter; left time: 3339.2999s
	iters: 200, epoch: 2 | loss: 3.4235582
	speed: 0.0539s/iter; left time: 1099.5220s
Epoch: 2 cost time: 10.889140367507935
Epoch: 2, Steps: 208 | Train Loss: 3.552 Vali Loss: 3.912 Vali Acc: 0.063 Test Loss: 3.912 Test Acc: 0.063
Validation loss decreased (-0.057819 --> -0.063188).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6548674
	speed: 0.1586s/iter; left time: 3216.2430s
	iters: 200, epoch: 3 | loss: 3.3585222
	speed: 0.0410s/iter; left time: 826.6970s
Epoch: 3 cost time: 9.372694969177246
Epoch: 3, Steps: 208 | Train Loss: 3.222 Vali Loss: 3.870 Vali Acc: 0.093 Test Loss: 3.870 Test Acc: 0.093
Validation loss decreased (-0.063188 --> -0.093311).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8468986
	speed: 0.1553s/iter; left time: 3117.9512s
	iters: 200, epoch: 4 | loss: 3.3225398
	speed: 0.0429s/iter; left time: 856.8379s
Epoch: 4 cost time: 9.401832342147827
Epoch: 4, Steps: 208 | Train Loss: 2.950 Vali Loss: 4.218 Vali Acc: 0.091 Test Loss: 4.218 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2254612
	speed: 0.1670s/iter; left time: 3317.8631s
	iters: 200, epoch: 5 | loss: 3.4303436
	speed: 0.0456s/iter; left time: 901.2302s
Epoch: 5 cost time: 10.31712794303894
Epoch: 5, Steps: 208 | Train Loss: 2.736 Vali Loss: 4.054 Vali Acc: 0.102 Test Loss: 4.054 Test Acc: 0.102
Validation loss decreased (-0.093311 --> -0.101659).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7335057
	speed: 0.1685s/iter; left time: 3312.1396s
	iters: 200, epoch: 6 | loss: 2.7573321
	speed: 0.0350s/iter; left time: 684.6508s
Epoch: 6 cost time: 8.639622688293457
Epoch: 6, Steps: 208 | Train Loss: 2.565 Vali Loss: 4.363 Vali Acc: 0.105 Test Loss: 4.363 Test Acc: 0.105
Validation loss decreased (-0.101659 --> -0.104937).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3298552
	speed: 0.1466s/iter; left time: 2850.8916s
	iters: 200, epoch: 7 | loss: 3.1356575
	speed: 0.0372s/iter; left time: 718.9835s
Epoch: 7 cost time: 7.9970948696136475
Epoch: 7, Steps: 208 | Train Loss: 2.419 Vali Loss: 4.205 Vali Acc: 0.102 Test Loss: 4.205 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4968030
	speed: 0.1489s/iter; left time: 2864.8568s
	iters: 200, epoch: 8 | loss: 2.4994512
	speed: 0.0306s/iter; left time: 586.7066s
Epoch: 8 cost time: 7.020442008972168
Epoch: 8, Steps: 208 | Train Loss: 2.217 Vali Loss: 4.684 Vali Acc: 0.104 Test Loss: 4.684 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9593314
	speed: 0.1403s/iter; left time: 2671.8250s
	iters: 200, epoch: 9 | loss: 2.2618594
	speed: 0.0338s/iter; left time: 639.7208s
Epoch: 9 cost time: 7.64544677734375
Epoch: 9, Steps: 208 | Train Loss: 2.068 Vali Loss: 4.767 Vali Acc: 0.106 Test Loss: 4.767 Test Acc: 0.106
Validation loss decreased (-0.104937 --> -0.106126).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2854664
	speed: 0.1506s/iter; left time: 2835.0736s
	iters: 200, epoch: 10 | loss: 1.2272959
	speed: 0.0405s/iter; left time: 759.0861s
Epoch: 10 cost time: 8.90182614326477
Epoch: 10, Steps: 208 | Train Loss: 1.895 Vali Loss: 4.821 Vali Acc: 0.111 Test Loss: 4.821 Test Acc: 0.111
Validation loss decreased (-0.106126 --> -0.110897).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8939646
	speed: 0.1855s/iter; left time: 3453.5768s
	iters: 200, epoch: 11 | loss: 1.9045408
	speed: 0.0458s/iter; left time: 847.8938s
Epoch: 11 cost time: 10.522907018661499
Epoch: 11, Steps: 208 | Train Loss: 1.740 Vali Loss: 5.325 Vali Acc: 0.103 Test Loss: 5.325 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7172006
	speed: 0.1710s/iter; left time: 3149.1679s
	iters: 200, epoch: 12 | loss: 2.2268248
	speed: 0.0440s/iter; left time: 805.0330s
Epoch: 12 cost time: 9.656330347061157
Epoch: 12, Steps: 208 | Train Loss: 1.617 Vali Loss: 5.156 Vali Acc: 0.106 Test Loss: 5.156 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4460461
	speed: 0.1598s/iter; left time: 2908.5781s
	iters: 200, epoch: 13 | loss: 1.9199771
	speed: 0.0422s/iter; left time: 764.2107s
Epoch: 13 cost time: 9.141927003860474
Epoch: 13, Steps: 208 | Train Loss: 1.504 Vali Loss: 5.215 Vali Acc: 0.115 Test Loss: 5.215 Test Acc: 0.115
Validation loss decreased (-0.110897 --> -0.114770).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9486127
	speed: 0.1529s/iter; left time: 2752.3224s
	iters: 200, epoch: 14 | loss: 1.5325937
	speed: 0.0401s/iter; left time: 717.4678s
Epoch: 14 cost time: 8.763790130615234
Epoch: 14, Steps: 208 | Train Loss: 1.375 Vali Loss: 5.505 Vali Acc: 0.118 Test Loss: 5.505 Test Acc: 0.118
Validation loss decreased (-0.114770 --> -0.118048).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9452904
	speed: 0.1863s/iter; left time: 3314.7445s
	iters: 200, epoch: 15 | loss: 1.7945381
	speed: 0.0570s/iter; left time: 1007.6539s
Epoch: 15 cost time: 12.167237043380737
Epoch: 15, Steps: 208 | Train Loss: 1.287 Vali Loss: 6.078 Vali Acc: 0.109 Test Loss: 6.078 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2417266
	speed: 0.2069s/iter; left time: 3637.7433s
	iters: 200, epoch: 16 | loss: 2.0934148
	speed: 0.0601s/iter; left time: 1049.9789s
Epoch: 16 cost time: 13.629924535751343
Epoch: 16, Steps: 208 | Train Loss: 1.172 Vali Loss: 6.617 Vali Acc: 0.118 Test Loss: 6.617 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8607217
	speed: 0.1934s/iter; left time: 3360.5653s
	iters: 200, epoch: 17 | loss: 1.3441948
	speed: 0.0549s/iter; left time: 947.6499s
Epoch: 17 cost time: 12.181928634643555
Epoch: 17, Steps: 208 | Train Loss: 1.094 Vali Loss: 6.744 Vali Acc: 0.112 Test Loss: 6.744 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4701857
	speed: 0.1921s/iter; left time: 3297.3442s
	iters: 200, epoch: 18 | loss: 1.2437785
	speed: 0.0634s/iter; left time: 1082.6016s
Epoch: 18 cost time: 13.052018880844116
Epoch: 18, Steps: 208 | Train Loss: 1.010 Vali Loss: 6.938 Vali Acc: 0.109 Test Loss: 6.938 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.8288570
	speed: 0.1986s/iter; left time: 3367.6741s
	iters: 200, epoch: 19 | loss: 0.7210876
	speed: 0.0478s/iter; left time: 806.3943s
Epoch: 19 cost time: 11.68098258972168
Epoch: 19, Steps: 208 | Train Loss: 0.947 Vali Loss: 7.094 Vali Acc: 0.108 Test Loss: 7.094 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.0780398
	speed: 0.1893s/iter; left time: 3170.0987s
	iters: 200, epoch: 20 | loss: 0.7778857
	speed: 0.0619s/iter; left time: 1030.7653s
Epoch: 20 cost time: 12.506811618804932
Epoch: 20, Steps: 208 | Train Loss: 0.876 Vali Loss: 7.425 Vali Acc: 0.116 Test Loss: 7.425 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9418362
	speed: 0.1906s/iter; left time: 3153.4006s
	iters: 200, epoch: 21 | loss: 1.2499154
	speed: 0.0578s/iter; left time: 949.7452s
Epoch: 21 cost time: 12.964754581451416
Epoch: 21, Steps: 208 | Train Loss: 0.828 Vali Loss: 7.598 Vali Acc: 0.110 Test Loss: 7.598 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.7461443
	speed: 0.1764s/iter; left time: 2881.5482s
	iters: 200, epoch: 22 | loss: 1.1842653
	speed: 0.0412s/iter; left time: 668.1055s
Epoch: 22 cost time: 9.848018407821655
Epoch: 22, Steps: 208 | Train Loss: 0.807 Vali Loss: 7.811 Vali Acc: 0.113 Test Loss: 7.811 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.7674482
	speed: 0.1709s/iter; left time: 2756.1218s
	iters: 200, epoch: 23 | loss: 0.7771007
	speed: 0.0319s/iter; left time: 510.9694s
Epoch: 23 cost time: 7.906776428222656
Epoch: 23, Steps: 208 | Train Loss: 0.705 Vali Loss: 8.348 Vali Acc: 0.121 Test Loss: 8.348 Test Acc: 0.121
Validation loss decreased (-0.118048 --> -0.120704).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.2164900
	speed: 0.1332s/iter; left time: 2119.6399s
	iters: 200, epoch: 24 | loss: 1.2078822
	speed: 0.0303s/iter; left time: 478.6605s
Epoch: 24 cost time: 6.917612075805664
Epoch: 24, Steps: 208 | Train Loss: 0.687 Vali Loss: 8.757 Vali Acc: 0.112 Test Loss: 8.757 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4792760
	speed: 0.1485s/iter; left time: 2332.1621s
	iters: 200, epoch: 25 | loss: 1.0710882
	speed: 0.0386s/iter; left time: 602.0068s
Epoch: 25 cost time: 9.356656074523926
Epoch: 25, Steps: 208 | Train Loss: 0.661 Vali Loss: 8.721 Vali Acc: 0.114 Test Loss: 8.721 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.6051287
	speed: 0.1710s/iter; left time: 2650.7218s
	iters: 200, epoch: 26 | loss: 0.8567371
	speed: 0.0395s/iter; left time: 608.8511s
Epoch: 26 cost time: 9.740471839904785
Epoch: 26, Steps: 208 | Train Loss: 0.602 Vali Loss: 9.160 Vali Acc: 0.108 Test Loss: 9.160 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.2813701
	speed: 0.1811s/iter; left time: 2769.0205s
	iters: 200, epoch: 27 | loss: 0.8921586
	speed: 0.0550s/iter; left time: 835.9620s
Epoch: 27 cost time: 11.166785955429077
Epoch: 27, Steps: 208 | Train Loss: 0.581 Vali Loss: 9.284 Vali Acc: 0.118 Test Loss: 9.284 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.3633066
	speed: 0.1901s/iter; left time: 2867.1484s
	iters: 200, epoch: 28 | loss: 1.0550622
	speed: 0.0510s/iter; left time: 764.5368s
Epoch: 28 cost time: 11.752264499664307
Epoch: 28, Steps: 208 | Train Loss: 0.547 Vali Loss: 9.639 Vali Acc: 0.111 Test Loss: 9.639 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.2547176
	speed: 0.1805s/iter; left time: 2684.6466s
	iters: 200, epoch: 29 | loss: 0.9929423
	speed: 0.0538s/iter; left time: 794.9869s
Epoch: 29 cost time: 10.938334703445435
Epoch: 29, Steps: 208 | Train Loss: 0.544 Vali Loss: 9.794 Vali Acc: 0.108 Test Loss: 9.794 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.5071154
	speed: 0.1872s/iter; left time: 2746.6110s
	iters: 200, epoch: 30 | loss: 0.4111001
	speed: 0.0467s/iter; left time: 680.5741s
Epoch: 30 cost time: 11.661036491394043
Epoch: 30, Steps: 208 | Train Loss: 0.509 Vali Loss: 9.879 Vali Acc: 0.104 Test Loss: 9.879 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.3389924
	speed: 0.1805s/iter; left time: 2610.3821s
	iters: 200, epoch: 31 | loss: 0.9823741
	speed: 0.0550s/iter; left time: 789.9396s
Epoch: 31 cost time: 11.79611611366272
Epoch: 31, Steps: 208 | Train Loss: 0.513 Vali Loss: 10.655 Vali Acc: 0.111 Test Loss: 10.655 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.5248538
	speed: 0.1814s/iter; left time: 2585.7930s
	iters: 200, epoch: 32 | loss: 0.3199570
	speed: 0.0576s/iter; left time: 815.0253s
Epoch: 32 cost time: 11.979212045669556
Epoch: 32, Steps: 208 | Train Loss: 0.477 Vali Loss: 10.482 Vali Acc: 0.112 Test Loss: 10.482 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.4954479
	speed: 0.1922s/iter; left time: 2699.5317s
	iters: 200, epoch: 33 | loss: 0.2765644
	speed: 0.0589s/iter; left time: 821.9832s
Epoch: 33 cost time: 12.64744257926941
Epoch: 33, Steps: 208 | Train Loss: 0.438 Vali Loss: 10.985 Vali Acc: 0.107 Test Loss: 10.985 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1207873546078139
model parameter : 257191
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7195940
	speed: 0.0707s/iter; left time: 1463.1614s
	iters: 200, epoch: 1 | loss: 3.5341296
	speed: 0.0529s/iter; left time: 1089.7659s
Epoch: 1 cost time: 12.921937704086304
Epoch: 1, Steps: 208 | Train Loss: 3.825 Vali Loss: 3.767 Vali Acc: 0.066 Test Loss: 3.767 Test Acc: 0.066
Validation loss decreased (inf --> -0.065575).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6021500
	speed: 0.1666s/iter; left time: 3413.9563s
	iters: 200, epoch: 2 | loss: 3.6978290
	speed: 0.0532s/iter; left time: 1083.9132s
Epoch: 2 cost time: 10.81003713607788
Epoch: 2, Steps: 208 | Train Loss: 3.520 Vali Loss: 3.680 Vali Acc: 0.072 Test Loss: 3.680 Test Acc: 0.072
Validation loss decreased (-0.065575 --> -0.071541).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3975360
	speed: 0.1689s/iter; left time: 3426.3991s
	iters: 200, epoch: 3 | loss: 3.8144429
	speed: 0.0499s/iter; left time: 1006.8658s
Epoch: 3 cost time: 10.73896050453186
Epoch: 3, Steps: 208 | Train Loss: 3.206 Vali Loss: 3.778 Vali Acc: 0.087 Test Loss: 3.778 Test Acc: 0.087
Validation loss decreased (-0.071541 --> -0.087048).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8459599
	speed: 0.1595s/iter; left time: 3201.3763s
	iters: 200, epoch: 4 | loss: 4.0358438
	speed: 0.0316s/iter; left time: 630.6990s
Epoch: 4 cost time: 7.5130369663238525
Epoch: 4, Steps: 208 | Train Loss: 2.995 Vali Loss: 3.826 Vali Acc: 0.092 Test Loss: 3.826 Test Acc: 0.092
Validation loss decreased (-0.087048 --> -0.091522).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5796366
	speed: 0.1509s/iter; left time: 2998.9869s
	iters: 200, epoch: 5 | loss: 2.7478607
	speed: 0.0335s/iter; left time: 661.3139s
Epoch: 5 cost time: 7.5697596073150635
Epoch: 5, Steps: 208 | Train Loss: 2.847 Vali Loss: 3.986 Vali Acc: 0.091 Test Loss: 3.986 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.6537313
	speed: 0.1449s/iter; left time: 2849.1087s
	iters: 200, epoch: 6 | loss: 3.0502949
	speed: 0.0329s/iter; left time: 644.3373s
Epoch: 6 cost time: 7.29008150100708
Epoch: 6, Steps: 208 | Train Loss: 2.701 Vali Loss: 4.073 Vali Acc: 0.094 Test Loss: 4.073 Test Acc: 0.094
Validation loss decreased (-0.091522 --> -0.093607).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0291095
	speed: 0.1682s/iter; left time: 3271.9182s
	iters: 200, epoch: 7 | loss: 3.0513210
	speed: 0.0385s/iter; left time: 744.7308s
Epoch: 7 cost time: 8.91598916053772
Epoch: 7, Steps: 208 | Train Loss: 2.561 Vali Loss: 4.114 Vali Acc: 0.092 Test Loss: 4.114 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7321508
	speed: 0.1668s/iter; left time: 3210.4342s
	iters: 200, epoch: 8 | loss: 2.7184713
	speed: 0.0502s/iter; left time: 960.4479s
Epoch: 8 cost time: 10.460932970046997
Epoch: 8, Steps: 208 | Train Loss: 2.405 Vali Loss: 4.237 Vali Acc: 0.097 Test Loss: 4.237 Test Acc: 0.097
Validation loss decreased (-0.093607 --> -0.096588).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5074152
	speed: 0.1790s/iter; left time: 3406.7827s
	iters: 200, epoch: 9 | loss: 2.2089760
	speed: 0.0447s/iter; left time: 847.3263s
Epoch: 9 cost time: 10.509521245956421
Epoch: 9, Steps: 208 | Train Loss: 2.295 Vali Loss: 4.229 Vali Acc: 0.101 Test Loss: 4.229 Test Acc: 0.101
Validation loss decreased (-0.096588 --> -0.100763).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5383425
	speed: 0.1532s/iter; left time: 2884.6647s
	iters: 200, epoch: 10 | loss: 2.4963310
	speed: 0.0365s/iter; left time: 683.1944s
Epoch: 10 cost time: 8.25729751586914
Epoch: 10, Steps: 208 | Train Loss: 2.144 Vali Loss: 4.290 Vali Acc: 0.101 Test Loss: 4.290 Test Acc: 0.101
Validation loss decreased (-0.100763 --> -0.101359).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7246739
	speed: 0.1371s/iter; left time: 2552.6501s
	iters: 200, epoch: 11 | loss: 2.5839865
	speed: 0.0339s/iter; left time: 627.2975s
Epoch: 11 cost time: 7.655412912368774
Epoch: 11, Steps: 208 | Train Loss: 2.031 Vali Loss: 4.409 Vali Acc: 0.100 Test Loss: 4.409 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3688846
	speed: 0.1523s/iter; left time: 2804.0380s
	iters: 200, epoch: 12 | loss: 1.5456276
	speed: 0.0435s/iter; left time: 795.8742s
Epoch: 12 cost time: 9.684690952301025
Epoch: 12, Steps: 208 | Train Loss: 1.911 Vali Loss: 4.697 Vali Acc: 0.097 Test Loss: 4.697 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.9086198
	speed: 0.1630s/iter; left time: 2967.8170s
	iters: 200, epoch: 13 | loss: 2.1964729
	speed: 0.0476s/iter; left time: 861.4117s
Epoch: 13 cost time: 10.247708559036255
Epoch: 13, Steps: 208 | Train Loss: 1.820 Vali Loss: 4.837 Vali Acc: 0.101 Test Loss: 4.837 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4514712
	speed: 0.1625s/iter; left time: 2924.7213s
	iters: 200, epoch: 14 | loss: 1.4979923
	speed: 0.0429s/iter; left time: 768.2402s
Epoch: 14 cost time: 9.788964986801147
Epoch: 14, Steps: 208 | Train Loss: 1.713 Vali Loss: 4.833 Vali Acc: 0.103 Test Loss: 4.833 Test Acc: 0.103
Validation loss decreased (-0.101359 --> -0.102546).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.1786888
	speed: 0.1660s/iter; left time: 2953.0579s
	iters: 200, epoch: 15 | loss: 2.3407075
	speed: 0.0502s/iter; left time: 887.9472s
Epoch: 15 cost time: 10.46019172668457
Epoch: 15, Steps: 208 | Train Loss: 1.617 Vali Loss: 4.913 Vali Acc: 0.105 Test Loss: 4.913 Test Acc: 0.105
Validation loss decreased (-0.102546 --> -0.104633).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3184166
	speed: 0.1520s/iter; left time: 2672.9228s
	iters: 200, epoch: 16 | loss: 1.2481416
	speed: 0.0360s/iter; left time: 630.0553s
Epoch: 16 cost time: 8.0265474319458
Epoch: 16, Steps: 208 | Train Loss: 1.530 Vali Loss: 5.344 Vali Acc: 0.106 Test Loss: 5.344 Test Acc: 0.106
Validation loss decreased (-0.104633 --> -0.106120).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0957289
	speed: 0.1435s/iter; left time: 2493.3228s
	iters: 200, epoch: 17 | loss: 2.1736116
	speed: 0.0391s/iter; left time: 674.5611s
Epoch: 17 cost time: 8.507495164871216
Epoch: 17, Steps: 208 | Train Loss: 1.477 Vali Loss: 5.428 Vali Acc: 0.111 Test Loss: 5.428 Test Acc: 0.111
Validation loss decreased (-0.106120 --> -0.111189).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5817903
	speed: 0.1605s/iter; left time: 2754.2381s
	iters: 200, epoch: 18 | loss: 1.6515665
	speed: 0.0377s/iter; left time: 642.9593s
Epoch: 18 cost time: 8.219465017318726
Epoch: 18, Steps: 208 | Train Loss: 1.360 Vali Loss: 5.675 Vali Acc: 0.102 Test Loss: 5.675 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.5122519
	speed: 0.1513s/iter; left time: 2565.9365s
	iters: 200, epoch: 19 | loss: 1.7449317
	speed: 0.0342s/iter; left time: 577.2528s
Epoch: 19 cost time: 7.894993543624878
Epoch: 19, Steps: 208 | Train Loss: 1.293 Vali Loss: 5.745 Vali Acc: 0.112 Test Loss: 5.745 Test Acc: 0.112
Validation loss decreased (-0.111189 --> -0.111484).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1301427
	speed: 0.1482s/iter; left time: 2481.4552s
	iters: 200, epoch: 20 | loss: 1.1686833
	speed: 0.0378s/iter; left time: 628.9336s
Epoch: 20 cost time: 7.808653354644775
Epoch: 20, Steps: 208 | Train Loss: 1.228 Vali Loss: 6.114 Vali Acc: 0.106 Test Loss: 6.114 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8623788
	speed: 0.1377s/iter; left time: 2277.7024s
	iters: 200, epoch: 21 | loss: 1.1089886
	speed: 0.0363s/iter; left time: 596.0778s
Epoch: 21 cost time: 7.864532470703125
Epoch: 21, Steps: 208 | Train Loss: 1.177 Vali Loss: 6.218 Vali Acc: 0.110 Test Loss: 6.218 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.7986255
	speed: 0.1469s/iter; left time: 2399.3722s
	iters: 200, epoch: 22 | loss: 0.8370932
	speed: 0.0377s/iter; left time: 611.6369s
Epoch: 22 cost time: 8.215476989746094
Epoch: 22, Steps: 208 | Train Loss: 1.099 Vali Loss: 6.625 Vali Acc: 0.105 Test Loss: 6.625 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.8061225
	speed: 0.1544s/iter; left time: 2489.7435s
	iters: 200, epoch: 23 | loss: 1.2683809
	speed: 0.0394s/iter; left time: 630.8678s
Epoch: 23 cost time: 8.893928289413452
Epoch: 23, Steps: 208 | Train Loss: 1.089 Vali Loss: 6.958 Vali Acc: 0.105 Test Loss: 6.958 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.2026037
	speed: 0.1408s/iter; left time: 2240.9569s
	iters: 200, epoch: 24 | loss: 1.3386871
	speed: 0.0363s/iter; left time: 574.6295s
Epoch: 24 cost time: 8.285820007324219
Epoch: 24, Steps: 208 | Train Loss: 1.019 Vali Loss: 6.958 Vali Acc: 0.104 Test Loss: 6.958 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.8288740
	speed: 0.1653s/iter; left time: 2596.4786s
	iters: 200, epoch: 25 | loss: 0.6005049
	speed: 0.0458s/iter; left time: 714.1636s
Epoch: 25 cost time: 9.83531403541565
Epoch: 25, Steps: 208 | Train Loss: 0.964 Vali Loss: 7.391 Vali Acc: 0.108 Test Loss: 7.391 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.8682950
	speed: 0.1637s/iter; left time: 2536.9168s
	iters: 200, epoch: 26 | loss: 1.0510926
	speed: 0.0398s/iter; left time: 613.3651s
Epoch: 26 cost time: 9.15456223487854
Epoch: 26, Steps: 208 | Train Loss: 0.940 Vali Loss: 7.475 Vali Acc: 0.100 Test Loss: 7.475 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.5546569
	speed: 0.1713s/iter; left time: 2619.5243s
	iters: 200, epoch: 27 | loss: 1.0815439
	speed: 0.0394s/iter; left time: 599.3444s
Epoch: 27 cost time: 9.490784406661987
Epoch: 27, Steps: 208 | Train Loss: 0.878 Vali Loss: 7.570 Vali Acc: 0.106 Test Loss: 7.570 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.2757186
	speed: 0.1578s/iter; left time: 2380.7133s
	iters: 200, epoch: 28 | loss: 0.6345224
	speed: 0.0393s/iter; left time: 588.1959s
Epoch: 28 cost time: 9.052472114562988
Epoch: 28, Steps: 208 | Train Loss: 0.852 Vali Loss: 7.784 Vali Acc: 0.105 Test Loss: 7.784 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.6998881
	speed: 0.1874s/iter; left time: 2788.1508s
	iters: 200, epoch: 29 | loss: 0.7585669
	speed: 0.0610s/iter; left time: 902.0153s
Epoch: 29 cost time: 12.033432006835938
Epoch: 29, Steps: 208 | Train Loss: 0.806 Vali Loss: 7.922 Vali Acc: 0.112 Test Loss: 7.922 Test Acc: 0.112
Validation loss decreased (-0.111484 --> -0.112357).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.2394450
	speed: 0.1938s/iter; left time: 2842.5840s
	iters: 200, epoch: 30 | loss: 1.0206486
	speed: 0.0617s/iter; left time: 899.6046s
Epoch: 30 cost time: 13.164570569992065
Epoch: 30, Steps: 208 | Train Loss: 0.798 Vali Loss: 8.236 Vali Acc: 0.109 Test Loss: 8.236 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.6292063
	speed: 0.1844s/iter; left time: 2666.9354s
	iters: 200, epoch: 31 | loss: 0.9462616
	speed: 0.0502s/iter; left time: 721.2471s
Epoch: 31 cost time: 10.855558395385742
Epoch: 31, Steps: 208 | Train Loss: 0.738 Vali Loss: 8.374 Vali Acc: 0.106 Test Loss: 8.374 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.7636515
	speed: 0.1923s/iter; left time: 2740.8244s
	iters: 200, epoch: 32 | loss: 0.6098532
	speed: 0.0653s/iter; left time: 924.7480s
Epoch: 32 cost time: 13.645759582519531
Epoch: 32, Steps: 208 | Train Loss: 0.741 Vali Loss: 8.902 Vali Acc: 0.105 Test Loss: 8.902 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.5331676
	speed: 0.1969s/iter; left time: 2765.1139s
	iters: 200, epoch: 33 | loss: 0.7978650
	speed: 0.0454s/iter; left time: 632.6896s
Epoch: 33 cost time: 11.547582387924194
Epoch: 33, Steps: 208 | Train Loss: 0.701 Vali Loss: 9.230 Vali Acc: 0.105 Test Loss: 9.230 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.4216593
	speed: 0.1853s/iter; left time: 2564.6605s
	iters: 200, epoch: 34 | loss: 1.4698687
	speed: 0.0574s/iter; left time: 788.2000s
Epoch: 34 cost time: 12.130188941955566
Epoch: 34, Steps: 208 | Train Loss: 0.687 Vali Loss: 9.342 Vali Acc: 0.103 Test Loss: 9.342 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 1.7353038
	speed: 0.1791s/iter; left time: 2440.4256s
	iters: 200, epoch: 35 | loss: 0.5328178
	speed: 0.0457s/iter; left time: 617.8437s
Epoch: 35 cost time: 10.58338475227356
Epoch: 35, Steps: 208 | Train Loss: 0.663 Vali Loss: 9.323 Vali Acc: 0.106 Test Loss: 9.323 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.2539361
	speed: 0.1774s/iter; left time: 2380.8976s
	iters: 200, epoch: 36 | loss: 0.6131982
	speed: 0.0592s/iter; left time: 789.0106s
Epoch: 36 cost time: 12.328928470611572
Epoch: 36, Steps: 208 | Train Loss: 0.633 Vali Loss: 9.456 Vali Acc: 0.111 Test Loss: 9.456 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.4144346
	speed: 0.1914s/iter; left time: 2529.3935s
	iters: 200, epoch: 37 | loss: 0.7903709
	speed: 0.0484s/iter; left time: 634.1320s
Epoch: 37 cost time: 10.699157238006592
Epoch: 37, Steps: 208 | Train Loss: 0.652 Vali Loss: 9.542 Vali Acc: 0.114 Test Loss: 9.542 Test Acc: 0.114
Validation loss decreased (-0.112357 --> -0.113534).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.9056695
	speed: 0.1716s/iter; left time: 2231.6458s
	iters: 200, epoch: 38 | loss: 0.8279664
	speed: 0.0336s/iter; left time: 434.1976s
Epoch: 38 cost time: 7.687766790390015
Epoch: 38, Steps: 208 | Train Loss: 0.594 Vali Loss: 9.852 Vali Acc: 0.103 Test Loss: 9.852 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.3314601
	speed: 0.1547s/iter; left time: 1979.7984s
	iters: 200, epoch: 39 | loss: 0.6588964
	speed: 0.0575s/iter; left time: 730.6085s
Epoch: 39 cost time: 11.079440832138062
Epoch: 39, Steps: 208 | Train Loss: 0.563 Vali Loss: 10.030 Vali Acc: 0.108 Test Loss: 10.030 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.4610994
	speed: 0.1923s/iter; left time: 2420.7314s
	iters: 200, epoch: 40 | loss: 1.1345721
	speed: 0.0541s/iter; left time: 675.4642s
Epoch: 40 cost time: 12.45418667793274
Epoch: 40, Steps: 208 | Train Loss: 0.565 Vali Loss: 10.212 Vali Acc: 0.107 Test Loss: 10.212 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.4035979
	speed: 0.1889s/iter; left time: 2338.3113s
	iters: 200, epoch: 41 | loss: 0.6472763
	speed: 0.0562s/iter; left time: 690.5924s
Epoch: 41 cost time: 11.287741422653198
Epoch: 41, Steps: 208 | Train Loss: 0.567 Vali Loss: 10.301 Vali Acc: 0.101 Test Loss: 10.301 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.5429558
	speed: 0.1994s/iter; left time: 2427.1227s
	iters: 200, epoch: 42 | loss: 0.9185171
	speed: 0.0578s/iter; left time: 697.6106s
Epoch: 42 cost time: 12.495262622833252
Epoch: 42, Steps: 208 | Train Loss: 0.529 Vali Loss: 10.671 Vali Acc: 0.103 Test Loss: 10.671 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 0.7951621
	speed: 0.1966s/iter; left time: 2352.2098s
	iters: 200, epoch: 43 | loss: 0.6037320
	speed: 0.0542s/iter; left time: 643.3943s
Epoch: 43 cost time: 12.804834604263306
Epoch: 43, Steps: 208 | Train Loss: 0.497 Vali Loss: 10.884 Vali Acc: 0.103 Test Loss: 10.884 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 0.0913410
	speed: 0.1939s/iter; left time: 2279.3116s
	iters: 200, epoch: 44 | loss: 0.9047647
	speed: 0.0609s/iter; left time: 709.3999s
Epoch: 44 cost time: 12.601370811462402
Epoch: 44, Steps: 208 | Train Loss: 0.504 Vali Loss: 10.929 Vali Acc: 0.099 Test Loss: 10.929 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 45 | loss: 0.0700846
	speed: 0.1765s/iter; left time: 2037.9595s
	iters: 200, epoch: 45 | loss: 1.1783164
	speed: 0.0362s/iter; left time: 414.8552s
Epoch: 45 cost time: 8.2108154296875
Epoch: 45, Steps: 208 | Train Loss: 0.504 Vali Loss: 11.143 Vali Acc: 0.107 Test Loss: 11.143 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 46 | loss: 1.3506573
	speed: 0.1669s/iter; left time: 1893.0008s
	iters: 200, epoch: 46 | loss: 0.4073475
	speed: 0.0533s/iter; left time: 599.4146s
Epoch: 46 cost time: 10.951018810272217
Epoch: 46, Steps: 208 | Train Loss: 0.488 Vali Loss: 10.912 Vali Acc: 0.100 Test Loss: 10.912 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 47 | loss: 0.1631878
	speed: 0.1930s/iter; left time: 2149.1012s
	iters: 200, epoch: 47 | loss: 0.1187600
	speed: 0.0531s/iter; left time: 586.2626s
Epoch: 47 cost time: 11.84015941619873
Epoch: 47, Steps: 208 | Train Loss: 0.469 Vali Loss: 11.492 Vali Acc: 0.103 Test Loss: 11.492 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11362958544586937
model parameter : 174919
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8783648
	speed: 0.0694s/iter; left time: 1437.0069s
	iters: 200, epoch: 1 | loss: 3.7219038
	speed: 0.0447s/iter; left time: 921.5443s
Epoch: 1 cost time: 11.79088020324707
Epoch: 1, Steps: 208 | Train Loss: 3.779 Vali Loss: 3.768 Vali Acc: 0.045 Test Loss: 3.768 Test Acc: 0.045
Validation loss decreased (inf --> -0.045295).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2512765
	speed: 0.1475s/iter; left time: 3023.1717s
	iters: 200, epoch: 2 | loss: 3.3932278
	speed: 0.0318s/iter; left time: 648.2159s
Epoch: 2 cost time: 7.561983108520508
Epoch: 2, Steps: 208 | Train Loss: 3.528 Vali Loss: 3.757 Vali Acc: 0.066 Test Loss: 3.757 Test Acc: 0.066
Validation loss decreased (-0.045295 --> -0.066172).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1704309
	speed: 0.1558s/iter; left time: 3160.2533s
	iters: 200, epoch: 3 | loss: 2.9128003
	speed: 0.0463s/iter; left time: 933.7224s
Epoch: 3 cost time: 9.576331853866577
Epoch: 3, Steps: 208 | Train Loss: 3.301 Vali Loss: 3.700 Vali Acc: 0.076 Test Loss: 3.700 Test Acc: 0.076
Validation loss decreased (-0.066172 --> -0.076014).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9199154
	speed: 0.1691s/iter; left time: 3394.4220s
	iters: 200, epoch: 4 | loss: 2.7563906
	speed: 0.0457s/iter; left time: 912.0102s
Epoch: 4 cost time: 10.111985921859741
Epoch: 4, Steps: 208 | Train Loss: 3.092 Vali Loss: 3.807 Vali Acc: 0.089 Test Loss: 3.807 Test Acc: 0.089
Validation loss decreased (-0.076014 --> -0.089434).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2590492
	speed: 0.1644s/iter; left time: 3266.5687s
	iters: 200, epoch: 5 | loss: 3.2149446
	speed: 0.0440s/iter; left time: 869.3457s
Epoch: 5 cost time: 9.111905813217163
Epoch: 5, Steps: 208 | Train Loss: 2.962 Vali Loss: 3.825 Vali Acc: 0.085 Test Loss: 3.825 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1069238
	speed: 0.1774s/iter; left time: 3487.2700s
	iters: 200, epoch: 6 | loss: 2.9130802
	speed: 0.0455s/iter; left time: 890.8170s
Epoch: 6 cost time: 10.288861989974976
Epoch: 6, Steps: 208 | Train Loss: 2.836 Vali Loss: 3.779 Vali Acc: 0.094 Test Loss: 3.779 Test Acc: 0.094
Validation loss decreased (-0.089434 --> -0.094206).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8905585
	speed: 0.1686s/iter; left time: 3280.2070s
	iters: 200, epoch: 7 | loss: 3.1133142
	speed: 0.0479s/iter; left time: 926.9618s
Epoch: 7 cost time: 9.95469617843628
Epoch: 7, Steps: 208 | Train Loss: 2.713 Vali Loss: 3.917 Vali Acc: 0.101 Test Loss: 3.917 Test Acc: 0.101
Validation loss decreased (-0.094206 --> -0.100766).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1010985
	speed: 0.1587s/iter; left time: 3053.3111s
	iters: 200, epoch: 8 | loss: 2.4440095
	speed: 0.0390s/iter; left time: 747.3158s
Epoch: 8 cost time: 8.802568197250366
Epoch: 8, Steps: 208 | Train Loss: 2.569 Vali Loss: 4.031 Vali Acc: 0.100 Test Loss: 4.031 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0404029
	speed: 0.1689s/iter; left time: 3215.8303s
	iters: 200, epoch: 9 | loss: 2.6950371
	speed: 0.0508s/iter; left time: 962.2924s
Epoch: 9 cost time: 11.495212316513062
Epoch: 9, Steps: 208 | Train Loss: 2.443 Vali Loss: 4.009 Vali Acc: 0.104 Test Loss: 4.009 Test Acc: 0.104
Validation loss decreased (-0.100766 --> -0.103748).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3486497
	speed: 0.1795s/iter; left time: 3379.2104s
	iters: 200, epoch: 10 | loss: 2.1726778
	speed: 0.0504s/iter; left time: 944.6625s
Epoch: 10 cost time: 11.035117864608765
Epoch: 10, Steps: 208 | Train Loss: 2.334 Vali Loss: 4.069 Vali Acc: 0.114 Test Loss: 4.069 Test Acc: 0.114
Validation loss decreased (-0.103748 --> -0.114185).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.0368848
	speed: 0.1845s/iter; left time: 3435.0590s
	iters: 200, epoch: 11 | loss: 3.0345743
	speed: 0.0505s/iter; left time: 936.2294s
Epoch: 11 cost time: 11.114837169647217
Epoch: 11, Steps: 208 | Train Loss: 2.217 Vali Loss: 4.251 Vali Acc: 0.112 Test Loss: 4.251 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9353164
	speed: 0.1737s/iter; left time: 3197.5239s
	iters: 200, epoch: 12 | loss: 2.4739621
	speed: 0.0402s/iter; left time: 736.6373s
Epoch: 12 cost time: 9.043834447860718
Epoch: 12, Steps: 208 | Train Loss: 2.102 Vali Loss: 4.263 Vali Acc: 0.108 Test Loss: 4.263 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7071984
	speed: 0.1483s/iter; left time: 2699.6541s
	iters: 200, epoch: 13 | loss: 1.3883028
	speed: 0.0391s/iter; left time: 708.7936s
Epoch: 13 cost time: 8.374340057373047
Epoch: 13, Steps: 208 | Train Loss: 2.019 Vali Loss: 4.328 Vali Acc: 0.112 Test Loss: 4.328 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3571547
	speed: 0.1755s/iter; left time: 3158.7285s
	iters: 200, epoch: 14 | loss: 1.9653271
	speed: 0.0408s/iter; left time: 730.3050s
Epoch: 14 cost time: 9.705865383148193
Epoch: 14, Steps: 208 | Train Loss: 1.941 Vali Loss: 4.526 Vali Acc: 0.110 Test Loss: 4.526 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.0070000
	speed: 0.1655s/iter; left time: 2943.5777s
	iters: 200, epoch: 15 | loss: 2.2475171
	speed: 0.0442s/iter; left time: 782.6223s
Epoch: 15 cost time: 9.704419612884521
Epoch: 15, Steps: 208 | Train Loss: 1.830 Vali Loss: 4.646 Vali Acc: 0.116 Test Loss: 4.646 Test Acc: 0.116
Validation loss decreased (-0.114185 --> -0.115969).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2645714
	speed: 0.1642s/iter; left time: 2886.0567s
	iters: 200, epoch: 16 | loss: 1.4016376
	speed: 0.0394s/iter; left time: 688.5741s
Epoch: 16 cost time: 8.920732498168945
Epoch: 16, Steps: 208 | Train Loss: 1.751 Vali Loss: 4.809 Vali Acc: 0.117 Test Loss: 4.809 Test Acc: 0.117
Validation loss decreased (-0.115969 --> -0.116564).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0582609
	speed: 0.1465s/iter; left time: 2544.7293s
	iters: 200, epoch: 17 | loss: 2.1583014
	speed: 0.0322s/iter; left time: 556.8505s
Epoch: 17 cost time: 7.13202428817749
Epoch: 17, Steps: 208 | Train Loss: 1.687 Vali Loss: 4.878 Vali Acc: 0.116 Test Loss: 4.878 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0855037
	speed: 0.1329s/iter; left time: 2281.1446s
	iters: 200, epoch: 18 | loss: 1.9202056
	speed: 0.0380s/iter; left time: 648.8950s
Epoch: 18 cost time: 7.603374481201172
Epoch: 18, Steps: 208 | Train Loss: 1.620 Vali Loss: 5.171 Vali Acc: 0.108 Test Loss: 5.171 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.0184283
	speed: 0.1496s/iter; left time: 2536.0087s
	iters: 200, epoch: 19 | loss: 1.5613872
	speed: 0.0360s/iter; left time: 607.5502s
Epoch: 19 cost time: 8.145127296447754
Epoch: 19, Steps: 208 | Train Loss: 1.558 Vali Loss: 5.253 Vali Acc: 0.109 Test Loss: 5.253 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.3886881
	speed: 0.1538s/iter; left time: 2575.7898s
	iters: 200, epoch: 20 | loss: 1.7721523
	speed: 0.0367s/iter; left time: 610.5751s
Epoch: 20 cost time: 8.24892282485962
Epoch: 20, Steps: 208 | Train Loss: 1.479 Vali Loss: 5.482 Vali Acc: 0.110 Test Loss: 5.482 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 2.3583524
	speed: 0.1691s/iter; left time: 2797.2659s
	iters: 200, epoch: 21 | loss: 1.6149879
	speed: 0.0425s/iter; left time: 698.7930s
Epoch: 21 cost time: 9.853960275650024
Epoch: 21, Steps: 208 | Train Loss: 1.432 Vali Loss: 5.433 Vali Acc: 0.119 Test Loss: 5.433 Test Acc: 0.119
Validation loss decreased (-0.116564 --> -0.119242).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0784199
	speed: 0.1751s/iter; left time: 2860.3728s
	iters: 200, epoch: 22 | loss: 2.5550106
	speed: 0.0476s/iter; left time: 772.3671s
Epoch: 22 cost time: 10.437605381011963
Epoch: 22, Steps: 208 | Train Loss: 1.369 Vali Loss: 5.640 Vali Acc: 0.114 Test Loss: 5.640 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.9046854
	speed: 0.1641s/iter; left time: 2645.8736s
	iters: 200, epoch: 23 | loss: 1.5296785
	speed: 0.0395s/iter; left time: 632.6003s
Epoch: 23 cost time: 8.74997615814209
Epoch: 23, Steps: 208 | Train Loss: 1.347 Vali Loss: 5.875 Vali Acc: 0.118 Test Loss: 5.875 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.4452841
	speed: 0.1852s/iter; left time: 2948.3851s
	iters: 200, epoch: 24 | loss: 1.9655402
	speed: 0.0590s/iter; left time: 933.0530s
Epoch: 24 cost time: 12.72865343093872
Epoch: 24, Steps: 208 | Train Loss: 1.289 Vali Loss: 6.040 Vali Acc: 0.116 Test Loss: 6.040 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.8388744
	speed: 0.2002s/iter; left time: 3144.7112s
	iters: 200, epoch: 25 | loss: 1.5714507
	speed: 0.0598s/iter; left time: 933.7847s
Epoch: 25 cost time: 13.247798204421997
Epoch: 25, Steps: 208 | Train Loss: 1.206 Vali Loss: 6.114 Vali Acc: 0.116 Test Loss: 6.114 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 2.2379081
	speed: 0.1897s/iter; left time: 2940.7470s
	iters: 200, epoch: 26 | loss: 0.7902800
	speed: 0.0527s/iter; left time: 812.2109s
Epoch: 26 cost time: 11.602988719940186
Epoch: 26, Steps: 208 | Train Loss: 1.179 Vali Loss: 6.372 Vali Acc: 0.115 Test Loss: 6.372 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.6447468
	speed: 0.1749s/iter; left time: 2675.1082s
	iters: 200, epoch: 27 | loss: 1.6844287
	speed: 0.0594s/iter; left time: 902.3616s
Epoch: 27 cost time: 12.396925926208496
Epoch: 27, Steps: 208 | Train Loss: 1.143 Vali Loss: 6.607 Vali Acc: 0.117 Test Loss: 6.607 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.9717875
	speed: 0.1824s/iter; left time: 2752.0284s
	iters: 200, epoch: 28 | loss: 0.9561235
	speed: 0.0486s/iter; left time: 728.2823s
Epoch: 28 cost time: 11.364282369613647
Epoch: 28, Steps: 208 | Train Loss: 1.112 Vali Loss: 6.722 Vali Acc: 0.121 Test Loss: 6.722 Test Acc: 0.121
Validation loss decreased (-0.119242 --> -0.121317).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.9023129
	speed: 0.1895s/iter; left time: 2818.7796s
	iters: 200, epoch: 29 | loss: 0.6078691
	speed: 0.0575s/iter; left time: 849.8982s
Epoch: 29 cost time: 12.340228080749512
Epoch: 29, Steps: 208 | Train Loss: 1.049 Vali Loss: 6.956 Vali Acc: 0.123 Test Loss: 6.956 Test Acc: 0.123
Validation loss decreased (-0.121317 --> -0.122805).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.9699544
	speed: 0.1914s/iter; left time: 2807.5648s
	iters: 200, epoch: 30 | loss: 0.8151281
	speed: 0.0510s/iter; left time: 742.9216s
Epoch: 30 cost time: 11.920933961868286
Epoch: 30, Steps: 208 | Train Loss: 1.052 Vali Loss: 7.207 Vali Acc: 0.116 Test Loss: 7.207 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.1920063
	speed: 0.1917s/iter; left time: 2772.1614s
	iters: 200, epoch: 31 | loss: 0.8698304
	speed: 0.0592s/iter; left time: 849.8292s
Epoch: 31 cost time: 12.871319770812988
Epoch: 31, Steps: 208 | Train Loss: 0.967 Vali Loss: 7.126 Vali Acc: 0.115 Test Loss: 7.126 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.5985319
	speed: 0.1672s/iter; left time: 2383.1261s
	iters: 200, epoch: 32 | loss: 1.0601434
	speed: 0.0508s/iter; left time: 718.3593s
Epoch: 32 cost time: 10.224863767623901
Epoch: 32, Steps: 208 | Train Loss: 0.965 Vali Loss: 7.346 Vali Acc: 0.120 Test Loss: 7.346 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.9054170
	speed: 0.1842s/iter; left time: 2587.1806s
	iters: 200, epoch: 33 | loss: 1.1400744
	speed: 0.0392s/iter; left time: 547.1383s
Epoch: 33 cost time: 9.748895406723022
Epoch: 33, Steps: 208 | Train Loss: 0.917 Vali Loss: 7.605 Vali Acc: 0.115 Test Loss: 7.605 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.7139175
	speed: 0.1793s/iter; left time: 2480.3989s
	iters: 200, epoch: 34 | loss: 0.8217869
	speed: 0.0489s/iter; left time: 671.5372s
Epoch: 34 cost time: 10.60872769355774
Epoch: 34, Steps: 208 | Train Loss: 0.938 Vali Loss: 7.771 Vali Acc: 0.118 Test Loss: 7.771 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.5719409
	speed: 0.1458s/iter; left time: 1987.0809s
	iters: 200, epoch: 35 | loss: 0.7286038
	speed: 0.0315s/iter; left time: 426.2569s
Epoch: 35 cost time: 6.957276105880737
Epoch: 35, Steps: 208 | Train Loss: 0.898 Vali Loss: 7.847 Vali Acc: 0.117 Test Loss: 7.847 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.8339779
	speed: 0.1678s/iter; left time: 2251.4212s
	iters: 200, epoch: 36 | loss: 1.1637323
	speed: 0.0377s/iter; left time: 502.1668s
Epoch: 36 cost time: 10.004335641860962
Epoch: 36, Steps: 208 | Train Loss: 0.854 Vali Loss: 7.924 Vali Acc: 0.113 Test Loss: 7.924 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 1.0815077
	speed: 0.1773s/iter; left time: 2342.8374s
	iters: 200, epoch: 37 | loss: 0.2687694
	speed: 0.0497s/iter; left time: 651.8233s
Epoch: 37 cost time: 10.84635329246521
Epoch: 37, Steps: 208 | Train Loss: 0.841 Vali Loss: 8.134 Vali Acc: 0.123 Test Loss: 8.134 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.1867371
	speed: 0.1793s/iter; left time: 2332.3301s
	iters: 200, epoch: 38 | loss: 0.9670005
	speed: 0.0565s/iter; left time: 728.5124s
Epoch: 38 cost time: 11.60625958442688
Epoch: 38, Steps: 208 | Train Loss: 0.809 Vali Loss: 8.214 Vali Acc: 0.107 Test Loss: 8.214 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.5592694
	speed: 0.1814s/iter; left time: 2320.7554s
	iters: 200, epoch: 39 | loss: 0.8140492
	speed: 0.0465s/iter; left time: 590.2782s
Epoch: 39 cost time: 10.918261051177979
Epoch: 39, Steps: 208 | Train Loss: 0.811 Vali Loss: 8.501 Vali Acc: 0.108 Test Loss: 8.501 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12287503728004771
model parameter : 140679
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7668018
	speed: 0.0551s/iter; left time: 1140.3762s
	iters: 200, epoch: 1 | loss: 3.8541429
	speed: 0.0349s/iter; left time: 718.4127s
Epoch: 1 cost time: 9.336232900619507
Epoch: 1, Steps: 208 | Train Loss: 3.785 Vali Loss: 3.717 Vali Acc: 0.054 Test Loss: 3.717 Test Acc: 0.054
Validation loss decreased (inf --> -0.053944).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1939037
	speed: 0.1419s/iter; left time: 2907.6131s
	iters: 200, epoch: 2 | loss: 3.5409970
	speed: 0.0466s/iter; left time: 949.3061s
Epoch: 2 cost time: 9.320155382156372
Epoch: 2, Steps: 208 | Train Loss: 3.571 Vali Loss: 3.703 Vali Acc: 0.065 Test Loss: 3.703 Test Acc: 0.065
Validation loss decreased (-0.053944 --> -0.065278).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5633957
	speed: 0.1644s/iter; left time: 3334.4696s
	iters: 200, epoch: 3 | loss: 2.7481725
	speed: 0.0507s/iter; left time: 1022.8025s
Epoch: 3 cost time: 10.213746309280396
Epoch: 3, Steps: 208 | Train Loss: 3.329 Vali Loss: 3.693 Vali Acc: 0.072 Test Loss: 3.693 Test Acc: 0.072
Validation loss decreased (-0.065278 --> -0.071839).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5560851
	speed: 0.1778s/iter; left time: 3570.5780s
	iters: 200, epoch: 4 | loss: 2.8309355
	speed: 0.0446s/iter; left time: 890.3926s
Epoch: 4 cost time: 10.330257177352905
Epoch: 4, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.650 Vali Acc: 0.088 Test Loss: 3.650 Test Acc: 0.088
Validation loss decreased (-0.071839 --> -0.087646).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6168149
	speed: 0.1647s/iter; left time: 3271.9051s
	iters: 200, epoch: 5 | loss: 3.3665171
	speed: 0.0468s/iter; left time: 924.3001s
Epoch: 5 cost time: 9.843053340911865
Epoch: 5, Steps: 208 | Train Loss: 2.990 Vali Loss: 3.754 Vali Acc: 0.088 Test Loss: 3.754 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.7188065
	speed: 0.1592s/iter; left time: 3130.8523s
	iters: 200, epoch: 6 | loss: 2.6922238
	speed: 0.0368s/iter; left time: 720.0064s
Epoch: 6 cost time: 8.668940782546997
Epoch: 6, Steps: 208 | Train Loss: 2.880 Vali Loss: 3.666 Vali Acc: 0.103 Test Loss: 3.666 Test Acc: 0.103
Validation loss decreased (-0.087646 --> -0.103155).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0258362
	speed: 0.1361s/iter; left time: 2647.5903s
	iters: 200, epoch: 7 | loss: 3.4092550
	speed: 0.0297s/iter; left time: 574.6431s
Epoch: 7 cost time: 6.8205859661102295
Epoch: 7, Steps: 208 | Train Loss: 2.760 Vali Loss: 3.769 Vali Acc: 0.103 Test Loss: 3.769 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3799469
	speed: 0.1589s/iter; left time: 3058.8361s
	iters: 200, epoch: 8 | loss: 2.8200436
	speed: 0.0358s/iter; left time: 684.9360s
Epoch: 8 cost time: 8.067167520523071
Epoch: 8, Steps: 208 | Train Loss: 2.681 Vali Loss: 3.720 Vali Acc: 0.104 Test Loss: 3.720 Test Acc: 0.104
Validation loss decreased (-0.103155 --> -0.104347).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7856574
	speed: 0.1506s/iter; left time: 2867.8093s
	iters: 200, epoch: 9 | loss: 3.7597923
	speed: 0.0398s/iter; left time: 754.4488s
Epoch: 9 cost time: 8.662031412124634
Epoch: 9, Steps: 208 | Train Loss: 2.613 Vali Loss: 3.814 Vali Acc: 0.103 Test Loss: 3.814 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3951340
	speed: 0.1619s/iter; left time: 3047.8488s
	iters: 200, epoch: 10 | loss: 2.1209993
	speed: 0.0404s/iter; left time: 756.3429s
Epoch: 10 cost time: 9.398550748825073
Epoch: 10, Steps: 208 | Train Loss: 2.526 Vali Loss: 3.836 Vali Acc: 0.109 Test Loss: 3.836 Test Acc: 0.109
Validation loss decreased (-0.104347 --> -0.108819).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4932852
	speed: 0.1460s/iter; left time: 2718.6108s
	iters: 200, epoch: 11 | loss: 2.8985646
	speed: 0.0353s/iter; left time: 653.5325s
Epoch: 11 cost time: 7.555148124694824
Epoch: 11, Steps: 208 | Train Loss: 2.451 Vali Loss: 3.881 Vali Acc: 0.115 Test Loss: 3.881 Test Acc: 0.115
Validation loss decreased (-0.108819 --> -0.114485).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.9733248
	speed: 0.1675s/iter; left time: 3083.2614s
	iters: 200, epoch: 12 | loss: 2.6411076
	speed: 0.0409s/iter; left time: 748.9077s
Epoch: 12 cost time: 9.746503591537476
Epoch: 12, Steps: 208 | Train Loss: 2.361 Vali Loss: 4.001 Vali Acc: 0.112 Test Loss: 4.001 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7907933
	speed: 0.1630s/iter; left time: 2967.0543s
	iters: 200, epoch: 13 | loss: 2.5190475
	speed: 0.0369s/iter; left time: 667.3758s
Epoch: 13 cost time: 8.670559167861938
Epoch: 13, Steps: 208 | Train Loss: 2.281 Vali Loss: 3.957 Vali Acc: 0.110 Test Loss: 3.957 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 3.0114307
	speed: 0.1409s/iter; left time: 2535.5315s
	iters: 200, epoch: 14 | loss: 2.5852110
	speed: 0.0305s/iter; left time: 546.1598s
Epoch: 14 cost time: 6.932748079299927
Epoch: 14, Steps: 208 | Train Loss: 2.242 Vali Loss: 4.070 Vali Acc: 0.114 Test Loss: 4.070 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7285928
	speed: 0.1579s/iter; left time: 2808.8633s
	iters: 200, epoch: 15 | loss: 2.0815148
	speed: 0.0448s/iter; left time: 792.1642s
Epoch: 15 cost time: 9.853834629058838
Epoch: 15, Steps: 208 | Train Loss: 2.159 Vali Loss: 4.224 Vali Acc: 0.101 Test Loss: 4.224 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.1667941
	speed: 0.1607s/iter; left time: 2826.0252s
	iters: 200, epoch: 16 | loss: 2.1489332
	speed: 0.0447s/iter; left time: 781.5286s
Epoch: 16 cost time: 9.362777948379517
Epoch: 16, Steps: 208 | Train Loss: 2.118 Vali Loss: 4.304 Vali Acc: 0.114 Test Loss: 4.304 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 2.1203728
	speed: 0.1516s/iter; left time: 2634.5444s
	iters: 200, epoch: 17 | loss: 1.7928722
	speed: 0.0428s/iter; left time: 739.8242s
Epoch: 17 cost time: 9.164212226867676
Epoch: 17, Steps: 208 | Train Loss: 2.036 Vali Loss: 4.346 Vali Acc: 0.109 Test Loss: 4.346 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.4391524
	speed: 0.1626s/iter; left time: 2791.0351s
	iters: 200, epoch: 18 | loss: 1.8775221
	speed: 0.0392s/iter; left time: 668.9269s
Epoch: 18 cost time: 8.98928713798523
Epoch: 18, Steps: 208 | Train Loss: 1.987 Vali Loss: 4.362 Vali Acc: 0.113 Test Loss: 4.362 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.9936008
	speed: 0.1461s/iter; left time: 2476.6474s
	iters: 200, epoch: 19 | loss: 2.0561583
	speed: 0.0377s/iter; left time: 634.8403s
Epoch: 19 cost time: 8.114356279373169
Epoch: 19, Steps: 208 | Train Loss: 1.943 Vali Loss: 4.507 Vali Acc: 0.110 Test Loss: 4.507 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 2.1128774
	speed: 0.1577s/iter; left time: 2641.8097s
	iters: 200, epoch: 20 | loss: 2.2169564
	speed: 0.0443s/iter; left time: 737.5683s
Epoch: 20 cost time: 9.882420539855957
Epoch: 20, Steps: 208 | Train Loss: 1.885 Vali Loss: 4.583 Vali Acc: 0.115 Test Loss: 4.583 Test Acc: 0.115
Validation loss decreased (-0.114485 --> -0.115075).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4920290
	speed: 0.1428s/iter; left time: 2362.0530s
	iters: 200, epoch: 21 | loss: 2.4477654
	speed: 0.0375s/iter; left time: 617.0939s
Epoch: 21 cost time: 7.767275094985962
Epoch: 21, Steps: 208 | Train Loss: 1.825 Vali Loss: 4.689 Vali Acc: 0.109 Test Loss: 4.689 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.8817040
	speed: 0.1399s/iter; left time: 2285.4795s
	iters: 200, epoch: 22 | loss: 2.0076976
	speed: 0.0347s/iter; left time: 562.9760s
Epoch: 22 cost time: 7.559292316436768
Epoch: 22, Steps: 208 | Train Loss: 1.782 Vali Loss: 4.814 Vali Acc: 0.115 Test Loss: 4.814 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 2.4108391
	speed: 0.1415s/iter; left time: 2281.0546s
	iters: 200, epoch: 23 | loss: 2.0168447
	speed: 0.0333s/iter; left time: 533.3534s
Epoch: 23 cost time: 7.541620492935181
Epoch: 23, Steps: 208 | Train Loss: 1.733 Vali Loss: 4.929 Vali Acc: 0.110 Test Loss: 4.929 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.6688002
	speed: 0.1431s/iter; left time: 2278.1830s
	iters: 200, epoch: 24 | loss: 1.6179639
	speed: 0.0338s/iter; left time: 534.0236s
Epoch: 24 cost time: 7.6697986125946045
Epoch: 24, Steps: 208 | Train Loss: 1.677 Vali Loss: 4.978 Vali Acc: 0.115 Test Loss: 4.978 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.1520212
	speed: 0.1411s/iter; left time: 2215.7595s
	iters: 200, epoch: 25 | loss: 2.1426671
	speed: 0.0358s/iter; left time: 558.9312s
Epoch: 25 cost time: 7.765047073364258
Epoch: 25, Steps: 208 | Train Loss: 1.661 Vali Loss: 5.026 Vali Acc: 0.117 Test Loss: 5.026 Test Acc: 0.117
Validation loss decreased (-0.115075 --> -0.116562).  Saving model ...
	iters: 100, epoch: 26 | loss: 2.3994865
	speed: 0.1585s/iter; left time: 2457.3797s
	iters: 200, epoch: 26 | loss: 1.4191151
	speed: 0.0430s/iter; left time: 662.9310s
Epoch: 26 cost time: 9.158827781677246
Epoch: 26, Steps: 208 | Train Loss: 1.619 Vali Loss: 5.126 Vali Acc: 0.120 Test Loss: 5.126 Test Acc: 0.120
Validation loss decreased (-0.116562 --> -0.119543).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.2806665
	speed: 0.1534s/iter; left time: 2345.6908s
	iters: 200, epoch: 27 | loss: 1.4597182
	speed: 0.0420s/iter; left time: 637.9000s
Epoch: 27 cost time: 8.837154626846313
Epoch: 27, Steps: 208 | Train Loss: 1.597 Vali Loss: 5.247 Vali Acc: 0.115 Test Loss: 5.247 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.5233178
	speed: 0.1472s/iter; left time: 2220.0088s
	iters: 200, epoch: 28 | loss: 1.9593420
	speed: 0.0368s/iter; left time: 550.8475s
Epoch: 28 cost time: 8.157986402511597
Epoch: 28, Steps: 208 | Train Loss: 1.535 Vali Loss: 5.446 Vali Acc: 0.118 Test Loss: 5.446 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.2925472
	speed: 0.1571s/iter; left time: 2337.6469s
	iters: 200, epoch: 29 | loss: 1.9139768
	speed: 0.0395s/iter; left time: 583.4659s
Epoch: 29 cost time: 8.697318077087402
Epoch: 29, Steps: 208 | Train Loss: 1.504 Vali Loss: 5.603 Vali Acc: 0.119 Test Loss: 5.603 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.3144530
	speed: 0.1595s/iter; left time: 2340.1807s
	iters: 200, epoch: 30 | loss: 0.9487665
	speed: 0.0403s/iter; left time: 586.9613s
Epoch: 30 cost time: 9.040150880813599
Epoch: 30, Steps: 208 | Train Loss: 1.474 Vali Loss: 5.638 Vali Acc: 0.119 Test Loss: 5.638 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.6205564
	speed: 0.1571s/iter; left time: 2271.2577s
	iters: 200, epoch: 31 | loss: 0.9052324
	speed: 0.0361s/iter; left time: 519.0731s
Epoch: 31 cost time: 8.084171533584595
Epoch: 31, Steps: 208 | Train Loss: 1.443 Vali Loss: 5.849 Vali Acc: 0.111 Test Loss: 5.849 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 1.7654542
	speed: 0.1396s/iter; left time: 1989.6115s
	iters: 200, epoch: 32 | loss: 1.2278475
	speed: 0.0378s/iter; left time: 534.3466s
Epoch: 32 cost time: 8.160877466201782
Epoch: 32, Steps: 208 | Train Loss: 1.408 Vali Loss: 5.787 Vali Acc: 0.112 Test Loss: 5.787 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 1.1247032
	speed: 0.1795s/iter; left time: 2521.1818s
	iters: 200, epoch: 33 | loss: 1.6714510
	speed: 0.0588s/iter; left time: 819.4416s
Epoch: 33 cost time: 11.950007915496826
Epoch: 33, Steps: 208 | Train Loss: 1.407 Vali Loss: 5.941 Vali Acc: 0.110 Test Loss: 5.941 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 1.6541346
	speed: 0.1748s/iter; left time: 2418.4619s
	iters: 200, epoch: 34 | loss: 2.1680660
	speed: 0.0469s/iter; left time: 644.4859s
Epoch: 34 cost time: 10.5677969455719
Epoch: 34, Steps: 208 | Train Loss: 1.359 Vali Loss: 6.049 Vali Acc: 0.107 Test Loss: 6.049 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 1.2833459
	speed: 0.1796s/iter; left time: 2448.1684s
	iters: 200, epoch: 35 | loss: 1.3072214
	speed: 0.0604s/iter; left time: 816.5991s
Epoch: 35 cost time: 12.543028116226196
Epoch: 35, Steps: 208 | Train Loss: 1.297 Vali Loss: 6.102 Vali Acc: 0.107 Test Loss: 6.102 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.8903465
	speed: 0.1699s/iter; left time: 2280.7759s
	iters: 200, epoch: 36 | loss: 1.2625667
	speed: 0.0480s/iter; left time: 638.8082s
Epoch: 36 cost time: 9.756841897964478
Epoch: 36, Steps: 208 | Train Loss: 1.304 Vali Loss: 6.203 Vali Acc: 0.114 Test Loss: 6.203 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11959439308082315
model parameter : 92807
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9011209
	speed: 0.0550s/iter; left time: 1138.6870s
	iters: 200, epoch: 1 | loss: 3.8369749
	speed: 0.0526s/iter; left time: 1083.1281s
Epoch: 1 cost time: 11.258723735809326
Epoch: 1, Steps: 208 | Train Loss: 3.770 Vali Loss: 3.673 Vali Acc: 0.048 Test Loss: 3.673 Test Acc: 0.048
Validation loss decreased (inf --> -0.048278).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9143314
	speed: 0.1709s/iter; left time: 3501.9175s
	iters: 200, epoch: 2 | loss: 3.8211174
	speed: 0.0385s/iter; left time: 784.1895s
Epoch: 2 cost time: 9.573379755020142
Epoch: 2, Steps: 208 | Train Loss: 3.610 Vali Loss: 3.697 Vali Acc: 0.058 Test Loss: 3.697 Test Acc: 0.058
Validation loss decreased (-0.048278 --> -0.058120).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2250636
	speed: 0.1543s/iter; left time: 3130.2968s
	iters: 200, epoch: 3 | loss: 3.5837035
	speed: 0.0294s/iter; left time: 592.7936s
Epoch: 3 cost time: 7.206646680831909
Epoch: 3, Steps: 208 | Train Loss: 3.438 Vali Loss: 3.632 Vali Acc: 0.072 Test Loss: 3.632 Test Acc: 0.072
Validation loss decreased (-0.058120 --> -0.072138).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4423225
	speed: 0.1301s/iter; left time: 2612.2146s
	iters: 200, epoch: 4 | loss: 3.7351851
	speed: 0.0326s/iter; left time: 650.4158s
Epoch: 4 cost time: 7.174301862716675
Epoch: 4, Steps: 208 | Train Loss: 3.257 Vali Loss: 3.589 Vali Acc: 0.084 Test Loss: 3.589 Test Acc: 0.084
Validation loss decreased (-0.072138 --> -0.084366).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2914469
	speed: 0.1640s/iter; left time: 3258.4624s
	iters: 200, epoch: 5 | loss: 2.8936136
	speed: 0.0484s/iter; left time: 956.7987s
Epoch: 5 cost time: 10.837968111038208
Epoch: 5, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.664 Vali Acc: 0.075 Test Loss: 3.664 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.5740688
	speed: 0.1677s/iter; left time: 3298.0536s
	iters: 200, epoch: 6 | loss: 3.4804392
	speed: 0.0466s/iter; left time: 911.9455s
Epoch: 6 cost time: 10.57260513305664
Epoch: 6, Steps: 208 | Train Loss: 3.026 Vali Loss: 3.571 Vali Acc: 0.089 Test Loss: 3.571 Test Acc: 0.089
Validation loss decreased (-0.084366 --> -0.088840).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2676778
	speed: 0.1726s/iter; left time: 3357.7444s
	iters: 200, epoch: 7 | loss: 3.3963337
	speed: 0.0442s/iter; left time: 854.6166s
Epoch: 7 cost time: 10.648894309997559
Epoch: 7, Steps: 208 | Train Loss: 2.933 Vali Loss: 3.663 Vali Acc: 0.084 Test Loss: 3.663 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1864901
	speed: 0.1699s/iter; left time: 3269.6124s
	iters: 200, epoch: 8 | loss: 2.8464956
	speed: 0.0474s/iter; left time: 907.6442s
Epoch: 8 cost time: 10.499833106994629
Epoch: 8, Steps: 208 | Train Loss: 2.845 Vali Loss: 3.697 Vali Acc: 0.093 Test Loss: 3.697 Test Acc: 0.093
Validation loss decreased (-0.088840 --> -0.092716).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8602591
	speed: 0.1726s/iter; left time: 3286.7169s
	iters: 200, epoch: 9 | loss: 3.5498817
	speed: 0.0498s/iter; left time: 942.5679s
Epoch: 9 cost time: 10.59848141670227
Epoch: 9, Steps: 208 | Train Loss: 2.796 Vali Loss: 3.700 Vali Acc: 0.096 Test Loss: 3.700 Test Acc: 0.096
Validation loss decreased (-0.092716 --> -0.095996).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5522056
	speed: 0.1669s/iter; left time: 3142.8023s
	iters: 200, epoch: 10 | loss: 3.2257957
	speed: 0.0501s/iter; left time: 938.3476s
Epoch: 10 cost time: 10.25200605392456
Epoch: 10, Steps: 208 | Train Loss: 2.680 Vali Loss: 3.721 Vali Acc: 0.091 Test Loss: 3.721 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.6905768
	speed: 0.1659s/iter; left time: 3089.5656s
	iters: 200, epoch: 11 | loss: 2.8543780
	speed: 0.0485s/iter; left time: 898.9096s
Epoch: 11 cost time: 9.912542581558228
Epoch: 11, Steps: 208 | Train Loss: 2.621 Vali Loss: 3.713 Vali Acc: 0.097 Test Loss: 3.713 Test Acc: 0.097
Validation loss decreased (-0.095996 --> -0.096891).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5015807
	speed: 0.1409s/iter; left time: 2594.8819s
	iters: 200, epoch: 12 | loss: 2.4978540
	speed: 0.0315s/iter; left time: 576.7193s
Epoch: 12 cost time: 7.140669345855713
Epoch: 12, Steps: 208 | Train Loss: 2.536 Vali Loss: 3.793 Vali Acc: 0.096 Test Loss: 3.793 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.4467194
	speed: 0.1437s/iter; left time: 2616.7467s
	iters: 200, epoch: 13 | loss: 3.4106321
	speed: 0.0361s/iter; left time: 652.7498s
Epoch: 13 cost time: 7.7378034591674805
Epoch: 13, Steps: 208 | Train Loss: 2.489 Vali Loss: 3.863 Vali Acc: 0.093 Test Loss: 3.863 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.1522093
	speed: 0.1549s/iter; left time: 2787.0056s
	iters: 200, epoch: 14 | loss: 2.0508652
	speed: 0.0309s/iter; left time: 553.8116s
Epoch: 14 cost time: 8.076631546020508
Epoch: 14, Steps: 208 | Train Loss: 2.402 Vali Loss: 4.018 Vali Acc: 0.094 Test Loss: 4.018 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.2074478
	speed: 0.1535s/iter; left time: 2730.7406s
	iters: 200, epoch: 15 | loss: 3.1135848
	speed: 0.0395s/iter; left time: 698.4635s
Epoch: 15 cost time: 8.363811016082764
Epoch: 15, Steps: 208 | Train Loss: 2.356 Vali Loss: 3.985 Vali Acc: 0.102 Test Loss: 3.985 Test Acc: 0.102
Validation loss decreased (-0.096891 --> -0.101660).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.3240025
	speed: 0.1547s/iter; left time: 2719.1829s
	iters: 200, epoch: 16 | loss: 2.8340712
	speed: 0.0315s/iter; left time: 551.1398s
Epoch: 16 cost time: 7.682043790817261
Epoch: 16, Steps: 208 | Train Loss: 2.281 Vali Loss: 4.019 Vali Acc: 0.101 Test Loss: 4.019 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.3230891
	speed: 0.1293s/iter; left time: 2246.0115s
	iters: 200, epoch: 17 | loss: 1.4928780
	speed: 0.0287s/iter; left time: 495.4251s
Epoch: 17 cost time: 6.416145324707031
Epoch: 17, Steps: 208 | Train Loss: 2.251 Vali Loss: 4.085 Vali Acc: 0.098 Test Loss: 4.085 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.8978733
	speed: 0.1462s/iter; left time: 2508.7989s
	iters: 200, epoch: 18 | loss: 1.9794915
	speed: 0.0436s/iter; left time: 744.1355s
Epoch: 18 cost time: 9.249653577804565
Epoch: 18, Steps: 208 | Train Loss: 2.188 Vali Loss: 4.166 Vali Acc: 0.102 Test Loss: 4.166 Test Acc: 0.102
Validation loss decreased (-0.101660 --> -0.102255).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.2032814
	speed: 0.1669s/iter; left time: 2830.8999s
	iters: 200, epoch: 19 | loss: 2.3092792
	speed: 0.0432s/iter; left time: 727.8060s
Epoch: 19 cost time: 9.848700046539307
Epoch: 19, Steps: 208 | Train Loss: 2.145 Vali Loss: 4.234 Vali Acc: 0.107 Test Loss: 4.234 Test Acc: 0.107
Validation loss decreased (-0.102255 --> -0.107324).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4667243
	speed: 0.1614s/iter; left time: 2702.4571s
	iters: 200, epoch: 20 | loss: 2.0912144
	speed: 0.0444s/iter; left time: 738.4320s
Epoch: 20 cost time: 9.622101545333862
Epoch: 20, Steps: 208 | Train Loss: 2.079 Vali Loss: 4.307 Vali Acc: 0.096 Test Loss: 4.307 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.9043677
	speed: 0.1643s/iter; left time: 2717.6427s
	iters: 200, epoch: 21 | loss: 2.3459496
	speed: 0.0445s/iter; left time: 731.5109s
Epoch: 21 cost time: 9.745759725570679
Epoch: 21, Steps: 208 | Train Loss: 2.030 Vali Loss: 4.370 Vali Acc: 0.103 Test Loss: 4.370 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4390762
	speed: 0.1482s/iter; left time: 2420.5147s
	iters: 200, epoch: 22 | loss: 2.2781227
	speed: 0.0337s/iter; left time: 546.4147s
Epoch: 22 cost time: 7.546094179153442
Epoch: 22, Steps: 208 | Train Loss: 1.989 Vali Loss: 4.524 Vali Acc: 0.103 Test Loss: 4.524 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 2.0449407
	speed: 0.1456s/iter; left time: 2348.3675s
	iters: 200, epoch: 23 | loss: 1.5890102
	speed: 0.0391s/iter; left time: 626.0003s
Epoch: 23 cost time: 8.225091457366943
Epoch: 23, Steps: 208 | Train Loss: 1.929 Vali Loss: 4.556 Vali Acc: 0.099 Test Loss: 4.556 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.2859246
	speed: 0.1562s/iter; left time: 2486.8919s
	iters: 200, epoch: 24 | loss: 2.5294213
	speed: 0.0409s/iter; left time: 647.0680s
Epoch: 24 cost time: 8.930904626846313
Epoch: 24, Steps: 208 | Train Loss: 1.886 Vali Loss: 4.698 Vali Acc: 0.101 Test Loss: 4.698 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 2.4769559
	speed: 0.1593s/iter; left time: 2502.4099s
	iters: 200, epoch: 25 | loss: 2.1977267
	speed: 0.0414s/iter; left time: 646.1025s
Epoch: 25 cost time: 9.477854013442993
Epoch: 25, Steps: 208 | Train Loss: 1.828 Vali Loss: 4.726 Vali Acc: 0.101 Test Loss: 4.726 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 2.4006164
	speed: 0.1598s/iter; left time: 2476.9835s
	iters: 200, epoch: 26 | loss: 2.0581801
	speed: 0.0432s/iter; left time: 664.9975s
Epoch: 26 cost time: 9.496966123580933
Epoch: 26, Steps: 208 | Train Loss: 1.809 Vali Loss: 4.800 Vali Acc: 0.099 Test Loss: 4.800 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.2933322
	speed: 0.1325s/iter; left time: 2026.3785s
	iters: 200, epoch: 27 | loss: 1.3499143
	speed: 0.0293s/iter; left time: 445.7662s
Epoch: 27 cost time: 6.501508474349976
Epoch: 27, Steps: 208 | Train Loss: 1.755 Vali Loss: 4.951 Vali Acc: 0.101 Test Loss: 4.951 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.9027544
	speed: 0.1309s/iter; left time: 1974.1584s
	iters: 200, epoch: 28 | loss: 1.1617965
	speed: 0.0326s/iter; left time: 488.0292s
Epoch: 28 cost time: 7.034184455871582
Epoch: 28, Steps: 208 | Train Loss: 1.702 Vali Loss: 5.075 Vali Acc: 0.099 Test Loss: 5.075 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.8398803
	speed: 0.1383s/iter; left time: 2057.8858s
	iters: 200, epoch: 29 | loss: 1.8296593
	speed: 0.0304s/iter; left time: 448.7754s
Epoch: 29 cost time: 6.805173873901367
Epoch: 29, Steps: 208 | Train Loss: 1.658 Vali Loss: 5.104 Vali Acc: 0.100 Test Loss: 5.104 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10736653742916791
model parameter : 72391
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6824489
	speed: 0.0505s/iter; left time: 1044.6516s
	iters: 200, epoch: 1 | loss: 3.6268659
	speed: 0.0306s/iter; left time: 630.1749s
Epoch: 1 cost time: 8.465291261672974
Epoch: 1, Steps: 208 | Train Loss: 3.789 Vali Loss: 3.679 Vali Acc: 0.052 Test Loss: 3.679 Test Acc: 0.052
Validation loss decreased (inf --> -0.051559).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5596588
	speed: 0.1531s/iter; left time: 3136.5173s
	iters: 200, epoch: 2 | loss: 3.4057922
	speed: 0.0386s/iter; left time: 787.0923s
Epoch: 2 cost time: 8.629496097564697
Epoch: 2, Steps: 208 | Train Loss: 3.612 Vali Loss: 3.721 Vali Acc: 0.057 Test Loss: 3.721 Test Acc: 0.057
Validation loss decreased (-0.051559 --> -0.057225).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5052855
	speed: 0.1506s/iter; left time: 3053.9610s
	iters: 200, epoch: 3 | loss: 3.4205453
	speed: 0.0333s/iter; left time: 671.3894s
Epoch: 3 cost time: 7.609661102294922
Epoch: 3, Steps: 208 | Train Loss: 3.513 Vali Loss: 3.667 Vali Acc: 0.064 Test Loss: 3.667 Test Acc: 0.064
Validation loss decreased (-0.057225 --> -0.063787).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2296703
	speed: 0.1440s/iter; left time: 2891.0527s
	iters: 200, epoch: 4 | loss: 3.2988622
	speed: 0.0360s/iter; left time: 719.0708s
Epoch: 4 cost time: 8.054565906524658
Epoch: 4, Steps: 208 | Train Loss: 3.323 Vali Loss: 3.612 Vali Acc: 0.080 Test Loss: 3.612 Test Acc: 0.080
Validation loss decreased (-0.063787 --> -0.080191).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2848423
	speed: 0.1531s/iter; left time: 3041.9243s
	iters: 200, epoch: 5 | loss: 3.7089574
	speed: 0.0379s/iter; left time: 748.8698s
Epoch: 5 cost time: 8.227025985717773
Epoch: 5, Steps: 208 | Train Loss: 3.226 Vali Loss: 3.571 Vali Acc: 0.083 Test Loss: 3.571 Test Acc: 0.083
Validation loss decreased (-0.080191 --> -0.082577).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2788749
	speed: 0.1523s/iter; left time: 2994.1108s
	iters: 200, epoch: 6 | loss: 3.1300731
	speed: 0.0355s/iter; left time: 694.9910s
Epoch: 6 cost time: 8.034368753433228
Epoch: 6, Steps: 208 | Train Loss: 3.118 Vali Loss: 3.614 Vali Acc: 0.081 Test Loss: 3.614 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7261634
	speed: 0.1458s/iter; left time: 2836.7631s
	iters: 200, epoch: 7 | loss: 3.3386235
	speed: 0.0424s/iter; left time: 820.1888s
Epoch: 7 cost time: 8.798089981079102
Epoch: 7, Steps: 208 | Train Loss: 3.012 Vali Loss: 3.602 Vali Acc: 0.086 Test Loss: 3.602 Test Acc: 0.086
Validation loss decreased (-0.082577 --> -0.086454).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4673221
	speed: 0.1428s/iter; left time: 2747.3834s
	iters: 200, epoch: 8 | loss: 2.8270383
	speed: 0.0334s/iter; left time: 639.3611s
Epoch: 8 cost time: 7.563599586486816
Epoch: 8, Steps: 208 | Train Loss: 2.945 Vali Loss: 3.636 Vali Acc: 0.091 Test Loss: 3.636 Test Acc: 0.091
Validation loss decreased (-0.086454 --> -0.090927).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9867184
	speed: 0.1555s/iter; left time: 2959.6490s
	iters: 200, epoch: 9 | loss: 3.3119431
	speed: 0.0539s/iter; left time: 1020.8842s
Epoch: 9 cost time: 11.855339527130127
Epoch: 9, Steps: 208 | Train Loss: 2.863 Vali Loss: 3.679 Vali Acc: 0.092 Test Loss: 3.679 Test Acc: 0.092
Validation loss decreased (-0.090927 --> -0.091821).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9374802
	speed: 0.1768s/iter; left time: 3329.5001s
	iters: 200, epoch: 10 | loss: 3.3801360
	speed: 0.0544s/iter; left time: 1018.4803s
Epoch: 10 cost time: 11.293413877487183
Epoch: 10, Steps: 208 | Train Loss: 2.789 Vali Loss: 3.761 Vali Acc: 0.086 Test Loss: 3.761 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.9532652
	speed: 0.1600s/iter; left time: 2979.3175s
	iters: 200, epoch: 11 | loss: 3.1091244
	speed: 0.0378s/iter; left time: 699.2934s
Epoch: 11 cost time: 8.717018842697144
Epoch: 11, Steps: 208 | Train Loss: 2.711 Vali Loss: 3.728 Vali Acc: 0.097 Test Loss: 3.728 Test Acc: 0.097
Validation loss decreased (-0.091821 --> -0.097189).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5413957
	speed: 0.1711s/iter; left time: 3150.9750s
	iters: 200, epoch: 12 | loss: 2.4022865
	speed: 0.0417s/iter; left time: 763.0311s
Epoch: 12 cost time: 10.148298025131226
Epoch: 12, Steps: 208 | Train Loss: 2.639 Vali Loss: 3.824 Vali Acc: 0.096 Test Loss: 3.824 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.8253288
	speed: 0.1614s/iter; left time: 2938.4690s
	iters: 200, epoch: 13 | loss: 3.3485653
	speed: 0.0505s/iter; left time: 915.0493s
Epoch: 13 cost time: 9.54938006401062
Epoch: 13, Steps: 208 | Train Loss: 2.578 Vali Loss: 3.826 Vali Acc: 0.099 Test Loss: 3.826 Test Acc: 0.099
Validation loss decreased (-0.097189 --> -0.098679).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1912851
	speed: 0.1678s/iter; left time: 3020.4293s
	iters: 200, epoch: 14 | loss: 2.8300276
	speed: 0.0353s/iter; left time: 632.3334s
Epoch: 14 cost time: 8.89162302017212
Epoch: 14, Steps: 208 | Train Loss: 2.516 Vali Loss: 3.906 Vali Acc: 0.098 Test Loss: 3.906 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.5389779
	speed: 0.1773s/iter; left time: 3153.4657s
	iters: 200, epoch: 15 | loss: 3.1144145
	speed: 0.0398s/iter; left time: 703.8098s
Epoch: 15 cost time: 9.90055799484253
Epoch: 15, Steps: 208 | Train Loss: 2.457 Vali Loss: 3.956 Vali Acc: 0.104 Test Loss: 3.956 Test Acc: 0.104
Validation loss decreased (-0.098679 --> -0.104046).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.2789741
	speed: 0.1496s/iter; left time: 2629.6795s
	iters: 200, epoch: 16 | loss: 1.8631009
	speed: 0.0347s/iter; left time: 606.9843s
Epoch: 16 cost time: 7.863590240478516
Epoch: 16, Steps: 208 | Train Loss: 2.405 Vali Loss: 4.032 Vali Acc: 0.101 Test Loss: 4.032 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.2473929
	speed: 0.1479s/iter; left time: 2569.9994s
	iters: 200, epoch: 17 | loss: 2.4807489
	speed: 0.0438s/iter; left time: 756.4375s
Epoch: 17 cost time: 9.103312492370605
Epoch: 17, Steps: 208 | Train Loss: 2.372 Vali Loss: 4.105 Vali Acc: 0.093 Test Loss: 4.105 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.0539746
	speed: 0.1557s/iter; left time: 2672.9864s
	iters: 200, epoch: 18 | loss: 1.9894892
	speed: 0.0452s/iter; left time: 770.8029s
Epoch: 18 cost time: 9.180159330368042
Epoch: 18, Steps: 208 | Train Loss: 2.306 Vali Loss: 4.116 Vali Acc: 0.097 Test Loss: 4.116 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.2910409
	speed: 0.1552s/iter; left time: 2631.0576s
	iters: 200, epoch: 19 | loss: 2.6369379
	speed: 0.0456s/iter; left time: 768.1696s
Epoch: 19 cost time: 9.806501626968384
Epoch: 19, Steps: 208 | Train Loss: 2.256 Vali Loss: 4.255 Vali Acc: 0.100 Test Loss: 4.255 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 2.5536547
	speed: 0.1580s/iter; left time: 2646.9253s
	iters: 200, epoch: 20 | loss: 2.0371618
	speed: 0.0455s/iter; left time: 757.5260s
Epoch: 20 cost time: 9.691989183425903
Epoch: 20, Steps: 208 | Train Loss: 2.221 Vali Loss: 4.261 Vali Acc: 0.102 Test Loss: 4.261 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 2.2772965
	speed: 0.1648s/iter; left time: 2725.5082s
	iters: 200, epoch: 21 | loss: 1.7330786
	speed: 0.0426s/iter; left time: 701.1470s
Epoch: 21 cost time: 9.634669780731201
Epoch: 21, Steps: 208 | Train Loss: 2.171 Vali Loss: 4.305 Vali Acc: 0.103 Test Loss: 4.305 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 2.7181201
	speed: 0.1572s/iter; left time: 2567.5952s
	iters: 200, epoch: 22 | loss: 1.8204465
	speed: 0.0381s/iter; left time: 618.8474s
Epoch: 22 cost time: 8.968000173568726
Epoch: 22, Steps: 208 | Train Loss: 2.134 Vali Loss: 4.458 Vali Acc: 0.100 Test Loss: 4.458 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.9371486
	speed: 0.1604s/iter; left time: 2586.9390s
	iters: 200, epoch: 23 | loss: 1.9721105
	speed: 0.0420s/iter; left time: 672.7972s
Epoch: 23 cost time: 8.91192102432251
Epoch: 23, Steps: 208 | Train Loss: 2.092 Vali Loss: 4.461 Vali Acc: 0.102 Test Loss: 4.461 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.7935301
	speed: 0.1594s/iter; left time: 2536.8403s
	iters: 200, epoch: 24 | loss: 2.6931229
	speed: 0.0452s/iter; left time: 715.6254s
Epoch: 24 cost time: 9.494837045669556
Epoch: 24, Steps: 208 | Train Loss: 2.041 Vali Loss: 4.569 Vali Acc: 0.106 Test Loss: 4.569 Test Acc: 0.106
Validation loss decreased (-0.104046 --> -0.105531).  Saving model ...
	iters: 100, epoch: 25 | loss: 2.5265939
	speed: 0.1630s/iter; left time: 2560.8081s
	iters: 200, epoch: 25 | loss: 2.1755013
	speed: 0.0416s/iter; left time: 649.6821s
Epoch: 25 cost time: 9.58073616027832
Epoch: 25, Steps: 208 | Train Loss: 2.003 Vali Loss: 4.646 Vali Acc: 0.101 Test Loss: 4.646 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.9268305
	speed: 0.1411s/iter; left time: 2186.8842s
	iters: 200, epoch: 26 | loss: 2.0514851
	speed: 0.0271s/iter; left time: 416.6737s
Epoch: 26 cost time: 6.098329544067383
Epoch: 26, Steps: 208 | Train Loss: 1.967 Vali Loss: 4.732 Vali Acc: 0.105 Test Loss: 4.732 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.4359025
	speed: 0.1297s/iter; left time: 1983.9235s
	iters: 200, epoch: 27 | loss: 2.4330401
	speed: 0.0270s/iter; left time: 410.6361s
Epoch: 27 cost time: 6.4698498249053955
Epoch: 27, Steps: 208 | Train Loss: 1.925 Vali Loss: 4.906 Vali Acc: 0.099 Test Loss: 4.906 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 2.2298450
	speed: 0.1316s/iter; left time: 1985.9154s
	iters: 200, epoch: 28 | loss: 1.7242284
	speed: 0.0347s/iter; left time: 519.4040s
Epoch: 28 cost time: 7.2274534702301025
Epoch: 28, Steps: 208 | Train Loss: 1.890 Vali Loss: 4.869 Vali Acc: 0.100 Test Loss: 4.869 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.8877838
	speed: 0.1381s/iter; left time: 2055.2456s
	iters: 200, epoch: 29 | loss: 1.4277914
	speed: 0.0315s/iter; left time: 465.1510s
Epoch: 29 cost time: 7.076560735702515
Epoch: 29, Steps: 208 | Train Loss: 1.841 Vali Loss: 5.026 Vali Acc: 0.097 Test Loss: 5.026 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 2.0032105
	speed: 0.1364s/iter; left time: 2001.0766s
	iters: 200, epoch: 30 | loss: 2.0298393
	speed: 0.0327s/iter; left time: 476.2166s
Epoch: 30 cost time: 7.247641324996948
Epoch: 30, Steps: 208 | Train Loss: 1.827 Vali Loss: 5.075 Vali Acc: 0.101 Test Loss: 5.075 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 2.0722094
	speed: 0.1536s/iter; left time: 2221.3075s
	iters: 200, epoch: 31 | loss: 2.6868474
	speed: 0.0408s/iter; left time: 586.4177s
Epoch: 31 cost time: 9.354539155960083
Epoch: 31, Steps: 208 | Train Loss: 1.815 Vali Loss: 5.135 Vali Acc: 0.098 Test Loss: 5.135 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 2.0463338
	speed: 0.1528s/iter; left time: 2177.8811s
	iters: 200, epoch: 32 | loss: 2.5034516
	speed: 0.0434s/iter; left time: 613.5741s
Epoch: 32 cost time: 9.491112232208252
Epoch: 32, Steps: 208 | Train Loss: 1.737 Vali Loss: 5.216 Vali Acc: 0.097 Test Loss: 5.216 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.2375145
	speed: 0.1420s/iter; left time: 1994.6017s
	iters: 200, epoch: 33 | loss: 2.3700631
	speed: 0.0338s/iter; left time: 471.5319s
Epoch: 33 cost time: 7.7379913330078125
Epoch: 33, Steps: 208 | Train Loss: 1.734 Vali Loss: 5.361 Vali Acc: 0.096 Test Loss: 5.361 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.2936447
	speed: 0.1363s/iter; left time: 1886.6045s
	iters: 200, epoch: 34 | loss: 2.1341746
	speed: 0.0415s/iter; left time: 570.6899s
Epoch: 34 cost time: 8.232097387313843
Epoch: 34, Steps: 208 | Train Loss: 1.715 Vali Loss: 5.369 Vali Acc: 0.099 Test Loss: 5.369 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el3_dm16_nh4_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10557709513868178
model parameter : 58839
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 7.2299061
	speed: 0.1352s/iter; left time: 2797.8459s
	iters: 200, epoch: 1 | loss: 4.1506319
	speed: 0.1195s/iter; left time: 2462.3227s
Epoch: 1 cost time: 26.514363527297974
Epoch: 1, Steps: 208 | Train Loss: 4.977 Vali Loss: 3.951 Vali Acc: 0.047 Test Loss: 3.951 Test Acc: 0.047
Validation loss decreased (inf --> -0.046784).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1657457
	speed: 0.3054s/iter; left time: 6259.5002s
	iters: 200, epoch: 2 | loss: 4.5914869
	speed: 0.0931s/iter; left time: 1899.4295s
Epoch: 2 cost time: 20.207000494003296
Epoch: 2, Steps: 208 | Train Loss: 4.228 Vali Loss: 3.590 Vali Acc: 0.086 Test Loss: 3.590 Test Acc: 0.086
Validation loss decreased (-0.046784 --> -0.085559).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5542755
	speed: 0.3109s/iter; left time: 6306.0625s
	iters: 200, epoch: 3 | loss: 6.2722144
	speed: 0.1057s/iter; left time: 2133.4666s
Epoch: 3 cost time: 22.783692598342896
Epoch: 3, Steps: 208 | Train Loss: 5.004 Vali Loss: 5.682 Vali Acc: 0.068 Test Loss: 5.682 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.6488624
	speed: 0.2726s/iter; left time: 5473.3675s
	iters: 200, epoch: 4 | loss: 4.6732488
	speed: 0.0755s/iter; left time: 1507.5720s
Epoch: 4 cost time: 17.296895027160645
Epoch: 4, Steps: 208 | Train Loss: 5.685 Vali Loss: 5.716 Vali Acc: 0.072 Test Loss: 5.716 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 7.5742750
	speed: 0.2504s/iter; left time: 4975.6964s
	iters: 200, epoch: 5 | loss: 5.0319414
	speed: 0.0881s/iter; left time: 1741.5951s
Epoch: 5 cost time: 19.68209934234619
Epoch: 5, Steps: 208 | Train Loss: 5.974 Vali Loss: 6.072 Vali Acc: 0.097 Test Loss: 6.072 Test Acc: 0.097
Validation loss decreased (-0.085559 --> -0.097166).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.8456273
	speed: 0.2700s/iter; left time: 5309.2914s
	iters: 200, epoch: 6 | loss: 4.9626555
	speed: 0.0897s/iter; left time: 1755.3136s
Epoch: 6 cost time: 19.866928815841675
Epoch: 6, Steps: 208 | Train Loss: 5.912 Vali Loss: 5.741 Vali Acc: 0.124 Test Loss: 5.741 Test Acc: 0.124
Validation loss decreased (-0.097166 --> -0.124309).  Saving model ...
	iters: 100, epoch: 7 | loss: 6.1291995
	speed: 0.2757s/iter; left time: 5363.3449s
	iters: 200, epoch: 7 | loss: 5.2500763
	speed: 0.1003s/iter; left time: 1940.4169s
Epoch: 7 cost time: 21.243456840515137
Epoch: 7, Steps: 208 | Train Loss: 5.437 Vali Loss: 7.173 Vali Acc: 0.113 Test Loss: 7.173 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.6850569
	speed: 0.3036s/iter; left time: 5842.9116s
	iters: 200, epoch: 8 | loss: 3.9459429
	speed: 0.1043s/iter; left time: 1997.6581s
Epoch: 8 cost time: 22.392005681991577
Epoch: 8, Steps: 208 | Train Loss: 4.835 Vali Loss: 7.430 Vali Acc: 0.111 Test Loss: 7.430 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 5.4218082
	speed: 0.3077s/iter; left time: 5856.7714s
	iters: 200, epoch: 9 | loss: 4.3302360
	speed: 0.1017s/iter; left time: 1925.7362s
Epoch: 9 cost time: 22.374814987182617
Epoch: 9, Steps: 208 | Train Loss: 4.075 Vali Loss: 7.558 Vali Acc: 0.085 Test Loss: 7.558 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.0624018
	speed: 0.3291s/iter; left time: 6197.3817s
	iters: 200, epoch: 10 | loss: 3.1189175
	speed: 0.1344s/iter; left time: 2516.5916s
Epoch: 10 cost time: 29.21820068359375
Epoch: 10, Steps: 208 | Train Loss: 2.979 Vali Loss: 13.962 Vali Acc: 0.048 Test Loss: 13.962 Test Acc: 0.048
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.3576410
	speed: 0.3673s/iter; left time: 6839.6719s
	iters: 200, epoch: 11 | loss: 1.9065288
	speed: 0.1281s/iter; left time: 2371.6326s
Epoch: 11 cost time: 27.363041877746582
Epoch: 11, Steps: 208 | Train Loss: 1.922 Vali Loss: 7.851 Vali Acc: 0.093 Test Loss: 7.851 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0353863
	speed: 0.3588s/iter; left time: 6606.8746s
	iters: 200, epoch: 12 | loss: 1.9959401
	speed: 0.1309s/iter; left time: 2397.5359s
Epoch: 12 cost time: 27.683621644973755
Epoch: 12, Steps: 208 | Train Loss: 1.483 Vali Loss: 6.482 Vali Acc: 0.113 Test Loss: 6.482 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1548071
	speed: 0.3215s/iter; left time: 5852.5200s
	iters: 200, epoch: 13 | loss: 0.7332485
	speed: 0.0937s/iter; left time: 1697.1940s
Epoch: 13 cost time: 20.682130575180054
Epoch: 13, Steps: 208 | Train Loss: 1.210 Vali Loss: 6.265 Vali Acc: 0.124 Test Loss: 6.265 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.8611355
	speed: 0.2822s/iter; left time: 5077.9706s
	iters: 200, epoch: 14 | loss: 1.4751761
	speed: 0.1133s/iter; left time: 2027.0689s
Epoch: 14 cost time: 22.511703729629517
Epoch: 14, Steps: 208 | Train Loss: 1.029 Vali Loss: 6.222 Vali Acc: 0.114 Test Loss: 6.222 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.5916510
	speed: 0.2957s/iter; left time: 5259.6772s
	iters: 200, epoch: 15 | loss: 1.5056002
	speed: 0.1091s/iter; left time: 1929.4209s
Epoch: 15 cost time: 23.523605823516846
Epoch: 15, Steps: 208 | Train Loss: 0.840 Vali Loss: 6.777 Vali Acc: 0.144 Test Loss: 6.777 Test Acc: 0.144
Validation loss decreased (-0.124309 --> -0.143684).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6050887
	speed: 0.2996s/iter; left time: 5266.7375s
	iters: 200, epoch: 16 | loss: 0.8811461
	speed: 0.1114s/iter; left time: 1946.9892s
Epoch: 16 cost time: 22.72585940361023
Epoch: 16, Steps: 208 | Train Loss: 0.748 Vali Loss: 7.543 Vali Acc: 0.142 Test Loss: 7.543 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.5768238
	speed: 0.3195s/iter; left time: 5550.2881s
	iters: 200, epoch: 17 | loss: 0.3652191
	speed: 0.0991s/iter; left time: 1711.7212s
Epoch: 17 cost time: 21.217195510864258
Epoch: 17, Steps: 208 | Train Loss: 0.592 Vali Loss: 8.611 Vali Acc: 0.120 Test Loss: 8.611 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7894916
	speed: 0.3217s/iter; left time: 5521.5485s
	iters: 200, epoch: 18 | loss: 0.3937830
	speed: 0.1185s/iter; left time: 2022.7117s
Epoch: 18 cost time: 25.27987051010132
Epoch: 18, Steps: 208 | Train Loss: 0.473 Vali Loss: 8.764 Vali Acc: 0.129 Test Loss: 8.764 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3193627
	speed: 0.3078s/iter; left time: 5219.5385s
	iters: 200, epoch: 19 | loss: 0.5489867
	speed: 0.0928s/iter; left time: 1564.2541s
Epoch: 19 cost time: 20.49033808708191
Epoch: 19, Steps: 208 | Train Loss: 0.372 Vali Loss: 8.590 Vali Acc: 0.127 Test Loss: 8.590 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9059428
	speed: 0.3188s/iter; left time: 5340.1580s
	iters: 200, epoch: 20 | loss: 1.0569865
	speed: 0.1196s/iter; left time: 1990.5224s
Epoch: 20 cost time: 25.004554271697998
Epoch: 20, Steps: 208 | Train Loss: 0.383 Vali Loss: 9.401 Vali Acc: 0.137 Test Loss: 9.401 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0401731
	speed: 0.3179s/iter; left time: 5259.1600s
	iters: 200, epoch: 21 | loss: 0.7021433
	speed: 0.1001s/iter; left time: 1645.0435s
Epoch: 21 cost time: 22.01190686225891
Epoch: 21, Steps: 208 | Train Loss: 0.307 Vali Loss: 9.232 Vali Acc: 0.123 Test Loss: 9.232 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1200262
	speed: 0.3007s/iter; left time: 4912.0653s
	iters: 200, epoch: 22 | loss: 0.4067646
	speed: 0.1096s/iter; left time: 1779.6335s
Epoch: 22 cost time: 23.461035013198853
Epoch: 22, Steps: 208 | Train Loss: 0.299 Vali Loss: 9.998 Vali Acc: 0.128 Test Loss: 9.998 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.1543019
	speed: 0.2783s/iter; left time: 4488.2441s
	iters: 200, epoch: 23 | loss: 0.3675130
	speed: 0.0843s/iter; left time: 1351.2935s
Epoch: 23 cost time: 18.60082697868347
Epoch: 23, Steps: 208 | Train Loss: 0.232 Vali Loss: 10.863 Vali Acc: 0.126 Test Loss: 10.863 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1492464
	speed: 0.2468s/iter; left time: 3928.3016s
	iters: 200, epoch: 24 | loss: 0.2733773
	speed: 0.0920s/iter; left time: 1454.5832s
Epoch: 24 cost time: 19.64107871055603
Epoch: 24, Steps: 208 | Train Loss: 0.207 Vali Loss: 10.866 Vali Acc: 0.128 Test Loss: 10.866 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.4444141
	speed: 0.2719s/iter; left time: 4271.0100s
	iters: 200, epoch: 25 | loss: 0.2527562
	speed: 0.0940s/iter; left time: 1467.9087s
Epoch: 25 cost time: 20.464287519454956
Epoch: 25, Steps: 208 | Train Loss: 0.214 Vali Loss: 10.916 Vali Acc: 0.125 Test Loss: 10.916 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14375186400238593
model parameter : 4219687
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0408521
	speed: 0.0616s/iter; left time: 1274.1933s
	iters: 200, epoch: 1 | loss: 3.8001387
	speed: 0.0297s/iter; left time: 612.3101s
Epoch: 1 cost time: 9.475109577178955
Epoch: 1, Steps: 208 | Train Loss: 4.430 Vali Loss: 3.354 Vali Acc: 0.088 Test Loss: 3.354 Test Acc: 0.088
Validation loss decreased (inf --> -0.088246).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8691008
	speed: 0.1291s/iter; left time: 2645.3100s
	iters: 200, epoch: 2 | loss: 4.2599673
	speed: 0.0343s/iter; left time: 699.4554s
Epoch: 2 cost time: 7.653120994567871
Epoch: 2, Steps: 208 | Train Loss: 3.641 Vali Loss: 3.795 Vali Acc: 0.079 Test Loss: 3.795 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8570495
	speed: 0.1254s/iter; left time: 2543.1094s
	iters: 200, epoch: 3 | loss: 4.7301831
	speed: 0.0431s/iter; left time: 869.5144s
Epoch: 3 cost time: 8.888266324996948
Epoch: 3, Steps: 208 | Train Loss: 4.020 Vali Loss: 5.615 Vali Acc: 0.055 Test Loss: 5.615 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.7693710
	speed: 0.2386s/iter; left time: 4790.1796s
	iters: 200, epoch: 4 | loss: 4.6120672
	speed: 0.0796s/iter; left time: 1589.1825s
Epoch: 4 cost time: 17.080867290496826
Epoch: 4, Steps: 208 | Train Loss: 4.397 Vali Loss: 4.904 Vali Acc: 0.098 Test Loss: 4.904 Test Acc: 0.098
Validation loss decreased (-0.088246 --> -0.098072).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4129889
	speed: 0.2503s/iter; left time: 4973.0208s
	iters: 200, epoch: 5 | loss: 5.0378475
	speed: 0.1026s/iter; left time: 2029.0341s
Epoch: 5 cost time: 21.162368774414062
Epoch: 5, Steps: 208 | Train Loss: 4.483 Vali Loss: 4.518 Vali Acc: 0.122 Test Loss: 4.518 Test Acc: 0.122
Validation loss decreased (-0.098072 --> -0.121637).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.8509612
	speed: 0.2821s/iter; left time: 5546.9870s
	iters: 200, epoch: 6 | loss: 5.6992207
	speed: 0.0981s/iter; left time: 1919.0556s
Epoch: 6 cost time: 20.091967582702637
Epoch: 6, Steps: 208 | Train Loss: 4.627 Vali Loss: 4.909 Vali Acc: 0.118 Test Loss: 4.909 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.4403458
	speed: 0.2829s/iter; left time: 5503.1166s
	iters: 200, epoch: 7 | loss: 4.5461946
	speed: 0.0976s/iter; left time: 1888.7452s
Epoch: 7 cost time: 20.231284618377686
Epoch: 7, Steps: 208 | Train Loss: 4.307 Vali Loss: 7.328 Vali Acc: 0.066 Test Loss: 7.328 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 4.6499085
	speed: 0.2769s/iter; left time: 5328.6565s
	iters: 200, epoch: 8 | loss: 3.8577909
	speed: 0.0914s/iter; left time: 1750.2526s
Epoch: 8 cost time: 19.47464680671692
Epoch: 8, Steps: 208 | Train Loss: 3.951 Vali Loss: 6.372 Vali Acc: 0.119 Test Loss: 6.372 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 5.8699965
	speed: 0.2344s/iter; left time: 4462.8760s
	iters: 200, epoch: 9 | loss: 2.5156379
	speed: 0.0877s/iter; left time: 1660.5063s
Epoch: 9 cost time: 18.289310932159424
Epoch: 9, Steps: 208 | Train Loss: 3.500 Vali Loss: 5.732 Vali Acc: 0.125 Test Loss: 5.732 Test Acc: 0.125
Validation loss decreased (-0.121637 --> -0.125204).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9481847
	speed: 0.2675s/iter; left time: 5037.3401s
	iters: 200, epoch: 10 | loss: 2.2860045
	speed: 0.0968s/iter; left time: 1812.6328s
Epoch: 10 cost time: 19.733736753463745
Epoch: 10, Steps: 208 | Train Loss: 2.841 Vali Loss: 5.797 Vali Acc: 0.115 Test Loss: 5.797 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.9376531
	speed: 0.2511s/iter; left time: 4676.4231s
	iters: 200, epoch: 11 | loss: 1.7957766
	speed: 0.0767s/iter; left time: 1420.9255s
Epoch: 11 cost time: 16.339509963989258
Epoch: 11, Steps: 208 | Train Loss: 2.141 Vali Loss: 6.644 Vali Acc: 0.125 Test Loss: 6.644 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5775619
	speed: 0.2493s/iter; left time: 4591.1939s
	iters: 200, epoch: 12 | loss: 1.8381662
	speed: 0.0879s/iter; left time: 1610.5619s
Epoch: 12 cost time: 18.293994903564453
Epoch: 12, Steps: 208 | Train Loss: 1.641 Vali Loss: 6.077 Vali Acc: 0.131 Test Loss: 6.077 Test Acc: 0.131
Validation loss decreased (-0.125204 --> -0.131165).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2526321
	speed: 0.2497s/iter; left time: 4545.6606s
	iters: 200, epoch: 13 | loss: 1.8739022
	speed: 0.0750s/iter; left time: 1357.8732s
Epoch: 13 cost time: 16.470267057418823
Epoch: 13, Steps: 208 | Train Loss: 1.351 Vali Loss: 5.700 Vali Acc: 0.132 Test Loss: 5.700 Test Acc: 0.132
Validation loss decreased (-0.131165 --> -0.131467).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7464056
	speed: 0.2288s/iter; left time: 4117.5607s
	iters: 200, epoch: 14 | loss: 1.3959670
	speed: 0.0798s/iter; left time: 1428.9435s
Epoch: 14 cost time: 16.623507499694824
Epoch: 14, Steps: 208 | Train Loss: 1.137 Vali Loss: 6.393 Vali Acc: 0.133 Test Loss: 6.393 Test Acc: 0.133
Validation loss decreased (-0.131467 --> -0.132951).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5715426
	speed: 0.2519s/iter; left time: 4481.6717s
	iters: 200, epoch: 15 | loss: 0.6565675
	speed: 0.0782s/iter; left time: 1383.0560s
Epoch: 15 cost time: 17.598986387252808
Epoch: 15, Steps: 208 | Train Loss: 0.922 Vali Loss: 6.545 Vali Acc: 0.139 Test Loss: 6.545 Test Acc: 0.139
Validation loss decreased (-0.132951 --> -0.138915).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7977991
	speed: 0.2493s/iter; left time: 4382.2548s
	iters: 200, epoch: 16 | loss: 1.4288265
	speed: 0.0731s/iter; left time: 1277.7874s
Epoch: 16 cost time: 16.463011026382446
Epoch: 16, Steps: 208 | Train Loss: 0.742 Vali Loss: 7.495 Vali Acc: 0.139 Test Loss: 7.495 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7048259
	speed: 0.2252s/iter; left time: 3911.7948s
	iters: 200, epoch: 17 | loss: 0.9595704
	speed: 0.0783s/iter; left time: 1353.0276s
Epoch: 17 cost time: 16.311213970184326
Epoch: 17, Steps: 208 | Train Loss: 0.618 Vali Loss: 7.158 Vali Acc: 0.133 Test Loss: 7.158 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.6202270
	speed: 0.2413s/iter; left time: 4141.9510s
	iters: 200, epoch: 18 | loss: 0.6001997
	speed: 0.0778s/iter; left time: 1327.2697s
Epoch: 18 cost time: 16.670681953430176
Epoch: 18, Steps: 208 | Train Loss: 0.548 Vali Loss: 7.854 Vali Acc: 0.148 Test Loss: 7.854 Test Acc: 0.148
Validation loss decreased (-0.138915 --> -0.148147).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6969852
	speed: 0.2317s/iter; left time: 3929.3684s
	iters: 200, epoch: 19 | loss: 0.4384703
	speed: 0.0710s/iter; left time: 1196.5626s
Epoch: 19 cost time: 15.188151597976685
Epoch: 19, Steps: 208 | Train Loss: 0.435 Vali Loss: 8.503 Vali Acc: 0.136 Test Loss: 8.503 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.5186444
	speed: 0.2334s/iter; left time: 3909.0952s
	iters: 200, epoch: 20 | loss: 0.7161551
	speed: 0.0793s/iter; left time: 1319.6362s
Epoch: 20 cost time: 16.953551530838013
Epoch: 20, Steps: 208 | Train Loss: 0.361 Vali Loss: 8.926 Vali Acc: 0.141 Test Loss: 8.926 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2953022
	speed: 0.2344s/iter; left time: 3876.5652s
	iters: 200, epoch: 21 | loss: 0.1895560
	speed: 0.0737s/iter; left time: 1211.0783s
Epoch: 21 cost time: 15.987467050552368
Epoch: 21, Steps: 208 | Train Loss: 0.344 Vali Loss: 7.973 Vali Acc: 0.126 Test Loss: 7.973 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0694395
	speed: 0.2239s/iter; left time: 3657.2881s
	iters: 200, epoch: 22 | loss: 0.4148584
	speed: 0.0767s/iter; left time: 1244.5066s
Epoch: 22 cost time: 16.396999835968018
Epoch: 22, Steps: 208 | Train Loss: 0.288 Vali Loss: 9.715 Vali Acc: 0.129 Test Loss: 9.715 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0808867
	speed: 0.2327s/iter; left time: 3752.8475s
	iters: 200, epoch: 23 | loss: 0.4221717
	speed: 0.0764s/iter; left time: 1223.8978s
Epoch: 23 cost time: 16.221989393234253
Epoch: 23, Steps: 208 | Train Loss: 0.280 Vali Loss: 9.564 Vali Acc: 0.136 Test Loss: 9.564 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0525098
	speed: 0.2257s/iter; left time: 3591.6758s
	iters: 200, epoch: 24 | loss: 0.0802701
	speed: 0.0831s/iter; left time: 1314.2187s
Epoch: 24 cost time: 17.020516872406006
Epoch: 24, Steps: 208 | Train Loss: 0.294 Vali Loss: 9.132 Vali Acc: 0.125 Test Loss: 9.132 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.3910817
	speed: 0.2711s/iter; left time: 4258.4378s
	iters: 200, epoch: 25 | loss: 0.4371487
	speed: 0.0872s/iter; left time: 1361.0896s
Epoch: 25 cost time: 18.972119331359863
Epoch: 25, Steps: 208 | Train Loss: 0.258 Vali Loss: 10.157 Vali Acc: 0.132 Test Loss: 10.157 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.2467985
	speed: 0.2654s/iter; left time: 4114.1903s
	iters: 200, epoch: 26 | loss: 0.4306100
	speed: 0.0794s/iter; left time: 1223.0082s
Epoch: 26 cost time: 17.42653226852417
Epoch: 26, Steps: 208 | Train Loss: 0.238 Vali Loss: 10.510 Vali Acc: 0.126 Test Loss: 10.510 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1411794
	speed: 0.2536s/iter; left time: 3877.6368s
	iters: 200, epoch: 27 | loss: 0.2159528
	speed: 0.0629s/iter; left time: 955.2114s
Epoch: 27 cost time: 14.78851866722107
Epoch: 27, Steps: 208 | Train Loss: 0.230 Vali Loss: 11.272 Vali Acc: 0.139 Test Loss: 11.272 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0005748
	speed: 0.2192s/iter; left time: 3306.3781s
	iters: 200, epoch: 28 | loss: 0.2242157
	speed: 0.0780s/iter; left time: 1168.7759s
Epoch: 28 cost time: 16.347295999526978
Epoch: 28, Steps: 208 | Train Loss: 0.205 Vali Loss: 12.514 Vali Acc: 0.122 Test Loss: 12.514 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14822546972860126
model parameter : 2243495
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8127608
	speed: 0.0860s/iter; left time: 1781.0508s
	iters: 200, epoch: 1 | loss: 3.5588183
	speed: 0.0635s/iter; left time: 1307.2048s
Epoch: 1 cost time: 15.59446668624878
Epoch: 1, Steps: 208 | Train Loss: 4.223 Vali Loss: 3.645 Vali Acc: 0.060 Test Loss: 3.645 Test Acc: 0.060
Validation loss decreased (inf --> -0.060208).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9039700
	speed: 0.2122s/iter; left time: 4347.7364s
	iters: 200, epoch: 2 | loss: 3.2355494
	speed: 0.0689s/iter; left time: 1404.2279s
Epoch: 2 cost time: 14.457717418670654
Epoch: 2, Steps: 208 | Train Loss: 3.503 Vali Loss: 3.768 Vali Acc: 0.088 Test Loss: 3.768 Test Acc: 0.088
Validation loss decreased (-0.060208 --> -0.087943).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3799288
	speed: 0.2125s/iter; left time: 4310.1260s
	iters: 200, epoch: 3 | loss: 4.1398430
	speed: 0.0683s/iter; left time: 1378.4143s
Epoch: 3 cost time: 14.755805969238281
Epoch: 3, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.824 Vali Acc: 0.089 Test Loss: 3.824 Test Acc: 0.089
Validation loss decreased (-0.087943 --> -0.089136).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2397134
	speed: 0.2140s/iter; left time: 4296.3884s
	iters: 200, epoch: 4 | loss: 4.9009490
	speed: 0.0660s/iter; left time: 1317.6085s
Epoch: 4 cost time: 14.365232944488525
Epoch: 4, Steps: 208 | Train Loss: 3.940 Vali Loss: 3.928 Vali Acc: 0.101 Test Loss: 3.928 Test Acc: 0.101
Validation loss decreased (-0.089136 --> -0.101362).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5736852
	speed: 0.2168s/iter; left time: 4306.9134s
	iters: 200, epoch: 5 | loss: 5.0286713
	speed: 0.0646s/iter; left time: 1278.0442s
Epoch: 5 cost time: 14.791731119155884
Epoch: 5, Steps: 208 | Train Loss: 3.953 Vali Loss: 4.951 Vali Acc: 0.111 Test Loss: 4.951 Test Acc: 0.111
Validation loss decreased (-0.101362 --> -0.110896).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.9768486
	speed: 0.2121s/iter; left time: 4169.5744s
	iters: 200, epoch: 6 | loss: 2.3227296
	speed: 0.0624s/iter; left time: 1220.6690s
Epoch: 6 cost time: 14.08611536026001
Epoch: 6, Steps: 208 | Train Loss: 3.882 Vali Loss: 4.694 Vali Acc: 0.121 Test Loss: 4.694 Test Acc: 0.121
Validation loss decreased (-0.110896 --> -0.120740).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4614315
	speed: 0.1967s/iter; left time: 3826.3797s
	iters: 200, epoch: 7 | loss: 3.8240283
	speed: 0.0662s/iter; left time: 1281.5331s
Epoch: 7 cost time: 14.14993953704834
Epoch: 7, Steps: 208 | Train Loss: 3.824 Vali Loss: 5.235 Vali Acc: 0.118 Test Loss: 5.235 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.6801274
	speed: 0.2064s/iter; left time: 3972.5146s
	iters: 200, epoch: 8 | loss: 4.2778506
	speed: 0.0661s/iter; left time: 1265.4085s
Epoch: 8 cost time: 14.181434392929077
Epoch: 8, Steps: 208 | Train Loss: 3.454 Vali Loss: 5.400 Vali Acc: 0.133 Test Loss: 5.400 Test Acc: 0.133
Validation loss decreased (-0.120740 --> -0.133259).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6368513
	speed: 0.2025s/iter; left time: 3855.3350s
	iters: 200, epoch: 9 | loss: 2.4010317
	speed: 0.0659s/iter; left time: 1248.8201s
Epoch: 9 cost time: 14.597225427627563
Epoch: 9, Steps: 208 | Train Loss: 3.062 Vali Loss: 5.800 Vali Acc: 0.127 Test Loss: 5.800 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.1066172
	speed: 0.2014s/iter; left time: 3792.6901s
	iters: 200, epoch: 10 | loss: 3.8430033
	speed: 0.0709s/iter; left time: 1327.9678s
Epoch: 10 cost time: 14.919859170913696
Epoch: 10, Steps: 208 | Train Loss: 2.649 Vali Loss: 5.399 Vali Acc: 0.112 Test Loss: 5.399 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.0763483
	speed: 0.1999s/iter; left time: 3722.5165s
	iters: 200, epoch: 11 | loss: 3.1433959
	speed: 0.0735s/iter; left time: 1361.3935s
Epoch: 11 cost time: 14.741938352584839
Epoch: 11, Steps: 208 | Train Loss: 2.211 Vali Loss: 5.618 Vali Acc: 0.118 Test Loss: 5.618 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2791502
	speed: 0.2323s/iter; left time: 4277.8419s
	iters: 200, epoch: 12 | loss: 2.0895257
	speed: 0.0716s/iter; left time: 1311.6372s
Epoch: 12 cost time: 15.794004917144775
Epoch: 12, Steps: 208 | Train Loss: 1.646 Vali Loss: 5.952 Vali Acc: 0.121 Test Loss: 5.952 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.4120468
	speed: 0.2335s/iter; left time: 4251.3809s
	iters: 200, epoch: 13 | loss: 1.5315696
	speed: 0.0792s/iter; left time: 1433.6840s
Epoch: 13 cost time: 16.94894289970398
Epoch: 13, Steps: 208 | Train Loss: 1.338 Vali Loss: 6.999 Vali Acc: 0.121 Test Loss: 6.999 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.2215972
	speed: 0.2115s/iter; left time: 3806.6806s
	iters: 200, epoch: 14 | loss: 0.8954500
	speed: 0.0737s/iter; left time: 1319.2335s
Epoch: 14 cost time: 15.109599828720093
Epoch: 14, Steps: 208 | Train Loss: 1.088 Vali Loss: 6.808 Vali Acc: 0.137 Test Loss: 6.808 Test Acc: 0.137
Validation loss decreased (-0.133259 --> -0.136824).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2115686
	speed: 0.2178s/iter; left time: 3874.5425s
	iters: 200, epoch: 15 | loss: 1.2348409
	speed: 0.0765s/iter; left time: 1352.7579s
Epoch: 15 cost time: 15.92831563949585
Epoch: 15, Steps: 208 | Train Loss: 0.851 Vali Loss: 6.663 Vali Acc: 0.127 Test Loss: 6.663 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3983679
	speed: 0.2125s/iter; left time: 3735.8470s
	iters: 200, epoch: 16 | loss: 0.9319892
	speed: 0.0693s/iter; left time: 1212.0507s
Epoch: 16 cost time: 14.661972045898438
Epoch: 16, Steps: 208 | Train Loss: 0.690 Vali Loss: 7.677 Vali Acc: 0.130 Test Loss: 7.677 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5158151
	speed: 0.2101s/iter; left time: 3650.7235s
	iters: 200, epoch: 17 | loss: 0.7007824
	speed: 0.0713s/iter; left time: 1232.0499s
Epoch: 17 cost time: 14.654793739318848
Epoch: 17, Steps: 208 | Train Loss: 0.614 Vali Loss: 6.952 Vali Acc: 0.125 Test Loss: 6.952 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5512235
	speed: 0.2146s/iter; left time: 3682.9412s
	iters: 200, epoch: 18 | loss: 0.3860090
	speed: 0.0777s/iter; left time: 1325.7936s
Epoch: 18 cost time: 15.619194030761719
Epoch: 18, Steps: 208 | Train Loss: 0.484 Vali Loss: 8.401 Vali Acc: 0.131 Test Loss: 8.401 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0725332
	speed: 0.2170s/iter; left time: 3680.1067s
	iters: 200, epoch: 19 | loss: 0.5852913
	speed: 0.0700s/iter; left time: 1179.2792s
Epoch: 19 cost time: 14.819602727890015
Epoch: 19, Steps: 208 | Train Loss: 0.464 Vali Loss: 8.680 Vali Acc: 0.130 Test Loss: 8.680 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3501544
	speed: 0.2065s/iter; left time: 3457.9281s
	iters: 200, epoch: 20 | loss: 0.1192672
	speed: 0.0667s/iter; left time: 1110.3042s
Epoch: 20 cost time: 14.344837427139282
Epoch: 20, Steps: 208 | Train Loss: 0.405 Vali Loss: 8.705 Vali Acc: 0.128 Test Loss: 8.705 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2918212
	speed: 0.2201s/iter; left time: 3640.4060s
	iters: 200, epoch: 21 | loss: 0.8485507
	speed: 0.0730s/iter; left time: 1199.9036s
Epoch: 21 cost time: 15.781946182250977
Epoch: 21, Steps: 208 | Train Loss: 0.322 Vali Loss: 9.157 Vali Acc: 0.134 Test Loss: 9.157 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6124397
	speed: 0.2135s/iter; left time: 3486.8568s
	iters: 200, epoch: 22 | loss: 0.2700768
	speed: 0.0675s/iter; left time: 1095.3156s
Epoch: 22 cost time: 15.056626558303833
Epoch: 22, Steps: 208 | Train Loss: 0.308 Vali Loss: 9.488 Vali Acc: 0.124 Test Loss: 9.488 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0547244
	speed: 0.2052s/iter; left time: 3308.0807s
	iters: 200, epoch: 23 | loss: 0.4769340
	speed: 0.0611s/iter; left time: 979.5668s
Epoch: 23 cost time: 13.585171937942505
Epoch: 23, Steps: 208 | Train Loss: 0.292 Vali Loss: 9.403 Vali Acc: 0.127 Test Loss: 9.403 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0675252
	speed: 0.2268s/iter; left time: 3609.4379s
	iters: 200, epoch: 24 | loss: 0.1828418
	speed: 0.0711s/iter; left time: 1124.7981s
Epoch: 24 cost time: 15.313716411590576
Epoch: 24, Steps: 208 | Train Loss: 0.296 Vali Loss: 9.612 Vali Acc: 0.125 Test Loss: 9.612 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13689233522218908
model parameter : 1585319
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5172992
	speed: 0.0883s/iter; left time: 1826.9277s
	iters: 200, epoch: 1 | loss: 3.6619577
	speed: 0.0616s/iter; left time: 1269.6489s
Epoch: 1 cost time: 15.543471336364746
Epoch: 1, Steps: 208 | Train Loss: 4.225 Vali Loss: 3.545 Vali Acc: 0.056 Test Loss: 3.545 Test Acc: 0.056
Validation loss decreased (inf --> -0.055736).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4444995
	speed: 0.2251s/iter; left time: 4611.9591s
	iters: 200, epoch: 2 | loss: 3.5441480
	speed: 0.0819s/iter; left time: 1669.6578s
Epoch: 2 cost time: 17.311522006988525
Epoch: 2, Steps: 208 | Train Loss: 3.476 Vali Loss: 3.828 Vali Acc: 0.077 Test Loss: 3.828 Test Acc: 0.077
Validation loss decreased (-0.055736 --> -0.076908).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4776654
	speed: 0.2577s/iter; left time: 5227.7927s
	iters: 200, epoch: 3 | loss: 3.6037860
	speed: 0.0865s/iter; left time: 1747.0039s
Epoch: 3 cost time: 18.526628017425537
Epoch: 3, Steps: 208 | Train Loss: 3.536 Vali Loss: 3.710 Vali Acc: 0.103 Test Loss: 3.710 Test Acc: 0.103
Validation loss decreased (-0.076908 --> -0.103154).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7550201
	speed: 0.2547s/iter; left time: 5113.0683s
	iters: 200, epoch: 4 | loss: 3.8216448
	speed: 0.0873s/iter; left time: 1744.8610s
Epoch: 4 cost time: 18.237075567245483
Epoch: 4, Steps: 208 | Train Loss: 3.650 Vali Loss: 3.977 Vali Acc: 0.107 Test Loss: 3.977 Test Acc: 0.107
Validation loss decreased (-0.103154 --> -0.107327).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.1567101
	speed: 0.2529s/iter; left time: 5025.2976s
	iters: 200, epoch: 5 | loss: 2.9066925
	speed: 0.0865s/iter; left time: 1709.4810s
Epoch: 5 cost time: 18.503317832946777
Epoch: 5, Steps: 208 | Train Loss: 3.774 Vali Loss: 4.157 Vali Acc: 0.122 Test Loss: 4.157 Test Acc: 0.122
Validation loss decreased (-0.107327 --> -0.121939).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3803852
	speed: 0.2631s/iter; left time: 5172.0215s
	iters: 200, epoch: 6 | loss: 3.9159806
	speed: 0.1031s/iter; left time: 2016.7594s
Epoch: 6 cost time: 21.668712854385376
Epoch: 6, Steps: 208 | Train Loss: 3.745 Vali Loss: 5.017 Vali Acc: 0.099 Test Loss: 5.017 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.7722790
	speed: 0.2782s/iter; left time: 5411.2602s
	iters: 200, epoch: 7 | loss: 3.1682203
	speed: 0.1006s/iter; left time: 1947.0735s
Epoch: 7 cost time: 21.583051681518555
Epoch: 7, Steps: 208 | Train Loss: 3.604 Vali Loss: 4.362 Vali Acc: 0.121 Test Loss: 4.362 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.4946234
	speed: 0.2529s/iter; left time: 4866.1807s
	iters: 200, epoch: 8 | loss: 3.3462873
	speed: 0.0742s/iter; left time: 1420.1020s
Epoch: 8 cost time: 16.482133626937866
Epoch: 8, Steps: 208 | Train Loss: 3.318 Vali Loss: 5.127 Vali Acc: 0.125 Test Loss: 5.127 Test Acc: 0.125
Validation loss decreased (-0.121939 --> -0.124911).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8472445
	speed: 0.2350s/iter; left time: 4473.4418s
	iters: 200, epoch: 9 | loss: 2.5047910
	speed: 0.0853s/iter; left time: 1615.6457s
Epoch: 9 cost time: 18.40732979774475
Epoch: 9, Steps: 208 | Train Loss: 2.905 Vali Loss: 5.311 Vali Acc: 0.116 Test Loss: 5.311 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4716802
	speed: 0.2422s/iter; left time: 4560.1708s
	iters: 200, epoch: 10 | loss: 1.7395331
	speed: 0.0817s/iter; left time: 1530.9959s
Epoch: 10 cost time: 17.90801239013672
Epoch: 10, Steps: 208 | Train Loss: 2.606 Vali Loss: 4.891 Vali Acc: 0.115 Test Loss: 4.891 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.5700748
	speed: 0.2319s/iter; left time: 4318.5796s
	iters: 200, epoch: 11 | loss: 2.0715098
	speed: 0.0764s/iter; left time: 1415.5578s
Epoch: 11 cost time: 16.308099508285522
Epoch: 11, Steps: 208 | Train Loss: 2.147 Vali Loss: 6.097 Vali Acc: 0.120 Test Loss: 6.097 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.8165637
	speed: 0.2012s/iter; left time: 3704.1673s
	iters: 200, epoch: 12 | loss: 2.0118732
	speed: 0.0674s/iter; left time: 1234.4622s
Epoch: 12 cost time: 14.295535326004028
Epoch: 12, Steps: 208 | Train Loss: 1.679 Vali Loss: 6.021 Vali Acc: 0.125 Test Loss: 6.021 Test Acc: 0.125
Validation loss decreased (-0.124911 --> -0.125201).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5528309
	speed: 0.2301s/iter; left time: 4188.9567s
	iters: 200, epoch: 13 | loss: 1.6590273
	speed: 0.0732s/iter; left time: 1325.6563s
Epoch: 13 cost time: 16.27151584625244
Epoch: 13, Steps: 208 | Train Loss: 1.393 Vali Loss: 6.997 Vali Acc: 0.126 Test Loss: 6.997 Test Acc: 0.126
Validation loss decreased (-0.125201 --> -0.126086).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4085723
	speed: 0.2118s/iter; left time: 3812.3767s
	iters: 200, epoch: 14 | loss: 1.1490401
	speed: 0.0682s/iter; left time: 1220.7225s
Epoch: 14 cost time: 14.460160493850708
Epoch: 14, Steps: 208 | Train Loss: 1.150 Vali Loss: 6.937 Vali Acc: 0.125 Test Loss: 6.937 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0776304
	speed: 0.2195s/iter; left time: 3905.5029s
	iters: 200, epoch: 15 | loss: 1.7157409
	speed: 0.0681s/iter; left time: 1204.3495s
Epoch: 15 cost time: 14.323132276535034
Epoch: 15, Steps: 208 | Train Loss: 0.903 Vali Loss: 5.926 Vali Acc: 0.131 Test Loss: 5.926 Test Acc: 0.131
Validation loss decreased (-0.126086 --> -0.131167).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1299837
	speed: 0.1816s/iter; left time: 3193.4224s
	iters: 200, epoch: 16 | loss: 1.1718591
	speed: 0.0552s/iter; left time: 965.1929s
Epoch: 16 cost time: 11.638426303863525
Epoch: 16, Steps: 208 | Train Loss: 0.741 Vali Loss: 7.290 Vali Acc: 0.122 Test Loss: 7.290 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4904113
	speed: 0.2024s/iter; left time: 3516.8149s
	iters: 200, epoch: 17 | loss: 0.3260138
	speed: 0.0705s/iter; left time: 1216.9804s
Epoch: 17 cost time: 14.619816541671753
Epoch: 17, Steps: 208 | Train Loss: 0.618 Vali Loss: 7.351 Vali Acc: 0.123 Test Loss: 7.351 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2827018
	speed: 0.2302s/iter; left time: 3950.5723s
	iters: 200, epoch: 18 | loss: 0.5641754
	speed: 0.0763s/iter; left time: 1301.2665s
Epoch: 18 cost time: 16.94768977165222
Epoch: 18, Steps: 208 | Train Loss: 0.510 Vali Loss: 7.917 Vali Acc: 0.133 Test Loss: 7.917 Test Acc: 0.133
Validation loss decreased (-0.131167 --> -0.133234).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.2668004
	speed: 0.2573s/iter; left time: 4362.9667s
	iters: 200, epoch: 19 | loss: 0.5676376
	speed: 0.0727s/iter; left time: 1225.0278s
Epoch: 19 cost time: 17.232441663742065
Epoch: 19, Steps: 208 | Train Loss: 0.452 Vali Loss: 8.669 Vali Acc: 0.136 Test Loss: 8.669 Test Acc: 0.136
Validation loss decreased (-0.133234 --> -0.135613).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1944261
	speed: 0.2163s/iter; left time: 3623.5237s
	iters: 200, epoch: 20 | loss: 0.8098175
	speed: 0.0671s/iter; left time: 1117.8911s
Epoch: 20 cost time: 14.604801654815674
Epoch: 20, Steps: 208 | Train Loss: 0.417 Vali Loss: 8.270 Vali Acc: 0.130 Test Loss: 8.270 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0327058
	speed: 0.2112s/iter; left time: 3493.9885s
	iters: 200, epoch: 21 | loss: 0.2791120
	speed: 0.0611s/iter; left time: 1005.2118s
Epoch: 21 cost time: 13.491668939590454
Epoch: 21, Steps: 208 | Train Loss: 0.359 Vali Loss: 9.185 Vali Acc: 0.130 Test Loss: 9.185 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4839219
	speed: 0.2161s/iter; left time: 3529.0237s
	iters: 200, epoch: 22 | loss: 1.0271589
	speed: 0.0718s/iter; left time: 1166.1626s
Epoch: 22 cost time: 14.541533470153809
Epoch: 22, Steps: 208 | Train Loss: 0.332 Vali Loss: 8.931 Vali Acc: 0.121 Test Loss: 8.931 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1071482
	speed: 0.1963s/iter; left time: 3166.1086s
	iters: 200, epoch: 23 | loss: 0.4958982
	speed: 0.0554s/iter; left time: 888.2233s
Epoch: 23 cost time: 11.602478265762329
Epoch: 23, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.527 Vali Acc: 0.128 Test Loss: 9.527 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.7573570
	speed: 0.2089s/iter; left time: 3325.6547s
	iters: 200, epoch: 24 | loss: 0.4588208
	speed: 0.0652s/iter; left time: 1031.7019s
Epoch: 24 cost time: 13.81155276298523
Epoch: 24, Steps: 208 | Train Loss: 0.299 Vali Loss: 9.522 Vali Acc: 0.135 Test Loss: 9.522 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1078277
	speed: 0.2119s/iter; left time: 3328.3061s
	iters: 200, epoch: 25 | loss: 0.2105993
	speed: 0.0619s/iter; left time: 966.9711s
Epoch: 25 cost time: 13.70845890045166
Epoch: 25, Steps: 208 | Train Loss: 0.289 Vali Loss: 9.381 Vali Acc: 0.134 Test Loss: 9.381 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.4601246
	speed: 0.2081s/iter; left time: 3225.2102s
	iters: 200, epoch: 26 | loss: 0.5165176
	speed: 0.0651s/iter; left time: 1001.9004s
Epoch: 26 cost time: 13.590025901794434
Epoch: 26, Steps: 208 | Train Loss: 0.268 Vali Loss: 9.985 Vali Acc: 0.120 Test Loss: 9.985 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1199824
	speed: 0.2340s/iter; left time: 3578.1551s
	iters: 200, epoch: 27 | loss: 0.0930336
	speed: 0.0588s/iter; left time: 892.8096s
Epoch: 27 cost time: 14.229747295379639
Epoch: 27, Steps: 208 | Train Loss: 0.257 Vali Loss: 10.529 Vali Acc: 0.125 Test Loss: 10.529 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0809265
	speed: 0.2293s/iter; left time: 3458.6026s
	iters: 200, epoch: 28 | loss: 0.3162125
	speed: 0.0656s/iter; left time: 982.8498s
Epoch: 28 cost time: 15.220725536346436
Epoch: 28, Steps: 208 | Train Loss: 0.268 Vali Loss: 10.863 Vali Acc: 0.133 Test Loss: 10.863 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.3651470
	speed: 0.2091s/iter; left time: 3110.0946s
	iters: 200, epoch: 29 | loss: 0.6110457
	speed: 0.0613s/iter; left time: 905.2002s
Epoch: 29 cost time: 12.817926168441772
Epoch: 29, Steps: 208 | Train Loss: 0.257 Vali Loss: 10.030 Vali Acc: 0.119 Test Loss: 10.030 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13569937369519833
model parameter : 1311399
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4883528
	speed: 0.0729s/iter; left time: 1508.1260s
	iters: 200, epoch: 1 | loss: 3.9418292
	speed: 0.0618s/iter; left time: 1272.5473s
Epoch: 1 cost time: 14.224531412124634
Epoch: 1, Steps: 208 | Train Loss: 4.093 Vali Loss: 3.832 Vali Acc: 0.055 Test Loss: 3.832 Test Acc: 0.055
Validation loss decreased (inf --> -0.055136).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1529703
	speed: 0.2589s/iter; left time: 5306.5799s
	iters: 200, epoch: 2 | loss: 3.5702679
	speed: 0.1003s/iter; left time: 2045.8938s
Epoch: 2 cost time: 20.923776149749756
Epoch: 2, Steps: 208 | Train Loss: 3.447 Vali Loss: 3.550 Vali Acc: 0.075 Test Loss: 3.550 Test Acc: 0.075
Validation loss decreased (-0.055136 --> -0.075419).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2549949
	speed: 0.2407s/iter; left time: 4881.6980s
	iters: 200, epoch: 3 | loss: 3.7680418
	speed: 0.0769s/iter; left time: 1552.8251s
Epoch: 3 cost time: 16.78276562690735
Epoch: 3, Steps: 208 | Train Loss: 3.394 Vali Loss: 3.676 Vali Acc: 0.095 Test Loss: 3.676 Test Acc: 0.095
Validation loss decreased (-0.075419 --> -0.095400).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.4479485
	speed: 0.2364s/iter; left time: 4746.3431s
	iters: 200, epoch: 4 | loss: 4.1091237
	speed: 0.0843s/iter; left time: 1684.5913s
Epoch: 4 cost time: 18.064443588256836
Epoch: 4, Steps: 208 | Train Loss: 3.377 Vali Loss: 3.821 Vali Acc: 0.099 Test Loss: 3.821 Test Acc: 0.099
Validation loss decreased (-0.095400 --> -0.098679).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5698228
	speed: 0.2324s/iter; left time: 4616.9562s
	iters: 200, epoch: 5 | loss: 3.5734026
	speed: 0.0804s/iter; left time: 1590.2567s
Epoch: 5 cost time: 17.31905436515808
Epoch: 5, Steps: 208 | Train Loss: 3.381 Vali Loss: 3.995 Vali Acc: 0.112 Test Loss: 3.995 Test Acc: 0.112
Validation loss decreased (-0.098679 --> -0.111800).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0767031
	speed: 0.1869s/iter; left time: 3675.3454s
	iters: 200, epoch: 6 | loss: 3.3976331
	speed: 0.0605s/iter; left time: 1183.2044s
Epoch: 6 cost time: 13.53476333618164
Epoch: 6, Steps: 208 | Train Loss: 3.282 Vali Loss: 4.443 Vali Acc: 0.103 Test Loss: 4.443 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.7206864
	speed: 0.1950s/iter; left time: 3792.9308s
	iters: 200, epoch: 7 | loss: 3.8499012
	speed: 0.0777s/iter; left time: 1502.9188s
Epoch: 7 cost time: 15.883273839950562
Epoch: 7, Steps: 208 | Train Loss: 3.073 Vali Loss: 4.565 Vali Acc: 0.111 Test Loss: 4.565 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7113628
	speed: 0.2053s/iter; left time: 3950.3162s
	iters: 200, epoch: 8 | loss: 3.2419879
	speed: 0.0724s/iter; left time: 1386.3062s
Epoch: 8 cost time: 15.260737180709839
Epoch: 8, Steps: 208 | Train Loss: 2.826 Vali Loss: 4.906 Vali Acc: 0.121 Test Loss: 4.906 Test Acc: 0.121
Validation loss decreased (-0.111800 --> -0.121037).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1969337
	speed: 0.2087s/iter; left time: 3973.9489s
	iters: 200, epoch: 9 | loss: 4.4375124
	speed: 0.0677s/iter; left time: 1281.9491s
Epoch: 9 cost time: 14.917701482772827
Epoch: 9, Steps: 208 | Train Loss: 2.572 Vali Loss: 5.463 Vali Acc: 0.115 Test Loss: 5.463 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7232070
	speed: 0.2007s/iter; left time: 3778.0769s
	iters: 200, epoch: 10 | loss: 3.4082043
	speed: 0.0580s/iter; left time: 1086.8980s
Epoch: 10 cost time: 13.315576553344727
Epoch: 10, Steps: 208 | Train Loss: 2.179 Vali Loss: 6.188 Vali Acc: 0.116 Test Loss: 6.188 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8874718
	speed: 0.1952s/iter; left time: 3635.6268s
	iters: 200, epoch: 11 | loss: 2.5482657
	speed: 0.0693s/iter; left time: 1283.7423s
Epoch: 11 cost time: 14.494751930236816
Epoch: 11, Steps: 208 | Train Loss: 1.888 Vali Loss: 6.609 Vali Acc: 0.122 Test Loss: 6.609 Test Acc: 0.122
Validation loss decreased (-0.121037 --> -0.121914).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0272870
	speed: 0.2046s/iter; left time: 3767.0541s
	iters: 200, epoch: 12 | loss: 1.0627928
	speed: 0.0641s/iter; left time: 1173.9871s
Epoch: 12 cost time: 13.890493392944336
Epoch: 12, Steps: 208 | Train Loss: 1.551 Vali Loss: 6.982 Vali Acc: 0.121 Test Loss: 6.982 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6456757
	speed: 0.2108s/iter; left time: 3837.1731s
	iters: 200, epoch: 13 | loss: 1.4317642
	speed: 0.0712s/iter; left time: 1289.9562s
Epoch: 13 cost time: 14.73861026763916
Epoch: 13, Steps: 208 | Train Loss: 1.318 Vali Loss: 7.502 Vali Acc: 0.121 Test Loss: 7.502 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4862046
	speed: 0.2026s/iter; left time: 3646.1589s
	iters: 200, epoch: 14 | loss: 1.3557342
	speed: 0.0572s/iter; left time: 1023.5859s
Epoch: 14 cost time: 12.835644483566284
Epoch: 14, Steps: 208 | Train Loss: 1.109 Vali Loss: 7.157 Vali Acc: 0.109 Test Loss: 7.157 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5053430
	speed: 0.1822s/iter; left time: 3240.7593s
	iters: 200, epoch: 15 | loss: 1.3973141
	speed: 0.0642s/iter; left time: 1135.6574s
Epoch: 15 cost time: 13.349205017089844
Epoch: 15, Steps: 208 | Train Loss: 0.913 Vali Loss: 7.032 Vali Acc: 0.117 Test Loss: 7.032 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1690442
	speed: 0.2113s/iter; left time: 3715.0081s
	iters: 200, epoch: 16 | loss: 1.5035031
	speed: 0.0734s/iter; left time: 1283.4038s
Epoch: 16 cost time: 16.282395124435425
Epoch: 16, Steps: 208 | Train Loss: 0.812 Vali Loss: 8.008 Vali Acc: 0.111 Test Loss: 8.008 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.4673294
	speed: 0.2139s/iter; left time: 3715.2449s
	iters: 200, epoch: 17 | loss: 0.2563953
	speed: 0.0792s/iter; left time: 1368.8143s
Epoch: 17 cost time: 16.115434169769287
Epoch: 17, Steps: 208 | Train Loss: 0.684 Vali Loss: 8.517 Vali Acc: 0.121 Test Loss: 8.517 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9630101
	speed: 0.2403s/iter; left time: 4125.5267s
	iters: 200, epoch: 18 | loss: 0.7165339
	speed: 0.0800s/iter; left time: 1365.6460s
Epoch: 18 cost time: 17.87906575202942
Epoch: 18, Steps: 208 | Train Loss: 0.573 Vali Loss: 8.771 Vali Acc: 0.122 Test Loss: 8.771 Test Acc: 0.122
Validation loss decreased (-0.121914 --> -0.122191).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.8296835
	speed: 0.2149s/iter; left time: 3644.6250s
	iters: 200, epoch: 19 | loss: 1.2738601
	speed: 0.0694s/iter; left time: 1169.1733s
Epoch: 19 cost time: 14.625092029571533
Epoch: 19, Steps: 208 | Train Loss: 0.531 Vali Loss: 9.044 Vali Acc: 0.120 Test Loss: 9.044 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8568937
	speed: 0.2101s/iter; left time: 3519.5781s
	iters: 200, epoch: 20 | loss: 0.5334823
	speed: 0.0670s/iter; left time: 1114.7931s
Epoch: 20 cost time: 14.484949111938477
Epoch: 20, Steps: 208 | Train Loss: 0.489 Vali Loss: 9.085 Vali Acc: 0.124 Test Loss: 9.085 Test Acc: 0.124
Validation loss decreased (-0.122191 --> -0.123679).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3245600
	speed: 0.2012s/iter; left time: 3328.4237s
	iters: 200, epoch: 21 | loss: 0.5976939
	speed: 0.0685s/iter; left time: 1126.5156s
Epoch: 21 cost time: 14.666562557220459
Epoch: 21, Steps: 208 | Train Loss: 0.434 Vali Loss: 8.661 Vali Acc: 0.116 Test Loss: 8.661 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.4288652
	speed: 0.2016s/iter; left time: 3293.4423s
	iters: 200, epoch: 22 | loss: 0.3033162
	speed: 0.0672s/iter; left time: 1091.2725s
Epoch: 22 cost time: 14.375997543334961
Epoch: 22, Steps: 208 | Train Loss: 0.418 Vali Loss: 9.788 Vali Acc: 0.114 Test Loss: 9.788 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5306967
	speed: 0.2060s/iter; left time: 3322.1881s
	iters: 200, epoch: 23 | loss: 0.3856381
	speed: 0.0616s/iter; left time: 986.9517s
Epoch: 23 cost time: 13.639591932296753
Epoch: 23, Steps: 208 | Train Loss: 0.411 Vali Loss: 10.255 Vali Acc: 0.122 Test Loss: 10.255 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.2005650
	speed: 0.1888s/iter; left time: 3004.3479s
	iters: 200, epoch: 24 | loss: 0.7859166
	speed: 0.0677s/iter; left time: 1071.0839s
Epoch: 24 cost time: 14.122191190719604
Epoch: 24, Steps: 208 | Train Loss: 0.363 Vali Loss: 9.568 Vali Acc: 0.110 Test Loss: 9.568 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0333034
	speed: 0.2021s/iter; left time: 3174.0592s
	iters: 200, epoch: 25 | loss: 0.2816840
	speed: 0.0603s/iter; left time: 940.6376s
Epoch: 25 cost time: 13.458547353744507
Epoch: 25, Steps: 208 | Train Loss: 0.313 Vali Loss: 10.561 Vali Acc: 0.119 Test Loss: 10.561 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0683287
	speed: 0.1853s/iter; left time: 2872.1297s
	iters: 200, epoch: 26 | loss: 0.2185392
	speed: 0.0606s/iter; left time: 933.5534s
Epoch: 26 cost time: 12.935183763504028
Epoch: 26, Steps: 208 | Train Loss: 0.312 Vali Loss: 10.194 Vali Acc: 0.104 Test Loss: 10.194 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1777502
	speed: 0.1851s/iter; left time: 2830.3340s
	iters: 200, epoch: 27 | loss: 0.7463360
	speed: 0.0603s/iter; left time: 916.7282s
Epoch: 27 cost time: 13.458849906921387
Epoch: 27, Steps: 208 | Train Loss: 0.296 Vali Loss: 10.565 Vali Acc: 0.125 Test Loss: 10.565 Test Acc: 0.125
Validation loss decreased (-0.123679 --> -0.124559).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0629821
	speed: 0.2143s/iter; left time: 3232.5418s
	iters: 200, epoch: 28 | loss: 0.0127933
	speed: 0.0704s/iter; left time: 1055.6244s
Epoch: 28 cost time: 15.366328716278076
Epoch: 28, Steps: 208 | Train Loss: 0.282 Vali Loss: 10.667 Vali Acc: 0.114 Test Loss: 10.667 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0602102
	speed: 0.2094s/iter; left time: 3114.9703s
	iters: 200, epoch: 29 | loss: 1.1544783
	speed: 0.0686s/iter; left time: 1013.7253s
Epoch: 29 cost time: 14.73208999633789
Epoch: 29, Steps: 208 | Train Loss: 0.281 Vali Loss: 10.707 Vali Acc: 0.102 Test Loss: 10.707 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0909209
	speed: 0.2019s/iter; left time: 2961.0398s
	iters: 200, epoch: 30 | loss: 0.2393839
	speed: 0.0588s/iter; left time: 857.2048s
Epoch: 30 cost time: 13.042107105255127
Epoch: 30, Steps: 208 | Train Loss: 0.254 Vali Loss: 10.990 Vali Acc: 0.115 Test Loss: 10.990 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0146350
	speed: 0.1851s/iter; left time: 2677.0538s
	iters: 200, epoch: 31 | loss: 0.4421993
	speed: 0.0540s/iter; left time: 776.1324s
Epoch: 31 cost time: 12.057507038116455
Epoch: 31, Steps: 208 | Train Loss: 0.249 Vali Loss: 11.828 Vali Acc: 0.115 Test Loss: 11.828 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.3937362
	speed: 0.1939s/iter; left time: 2763.7284s
	iters: 200, epoch: 32 | loss: 0.3044393
	speed: 0.0632s/iter; left time: 894.1878s
Epoch: 32 cost time: 13.00383710861206
Epoch: 32, Steps: 208 | Train Loss: 0.243 Vali Loss: 11.281 Vali Acc: 0.122 Test Loss: 11.281 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.2142248
	speed: 0.2044s/iter; left time: 2871.3181s
	iters: 200, epoch: 33 | loss: 0.1998169
	speed: 0.0517s/iter; left time: 720.9358s
Epoch: 33 cost time: 12.084156036376953
Epoch: 33, Steps: 208 | Train Loss: 0.288 Vali Loss: 11.924 Vali Acc: 0.120 Test Loss: 11.924 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0298883
	speed: 0.1958s/iter; left time: 2708.6235s
	iters: 200, epoch: 34 | loss: 0.0954107
	speed: 0.0549s/iter; left time: 754.3528s
Epoch: 34 cost time: 11.981003284454346
Epoch: 34, Steps: 208 | Train Loss: 0.239 Vali Loss: 11.248 Vali Acc: 0.122 Test Loss: 11.248 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.1973108
	speed: 0.2229s/iter; left time: 3037.4403s
	iters: 200, epoch: 35 | loss: 0.1081311
	speed: 0.0690s/iter; left time: 933.5397s
Epoch: 35 cost time: 15.71017837524414
Epoch: 35, Steps: 208 | Train Loss: 0.233 Vali Loss: 11.333 Vali Acc: 0.124 Test Loss: 11.333 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0394275
	speed: 0.2120s/iter; left time: 2844.8427s
	iters: 200, epoch: 36 | loss: 0.5405241
	speed: 0.0733s/iter; left time: 975.9358s
Epoch: 36 cost time: 14.22536849975586
Epoch: 36, Steps: 208 | Train Loss: 0.235 Vali Loss: 11.672 Vali Acc: 0.111 Test Loss: 11.672 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.5315326
	speed: 0.1785s/iter; left time: 2358.6567s
	iters: 200, epoch: 37 | loss: 0.0743433
	speed: 0.0488s/iter; left time: 639.4241s
Epoch: 37 cost time: 10.829251766204834
Epoch: 37, Steps: 208 | Train Loss: 0.244 Vali Loss: 11.984 Vali Acc: 0.117 Test Loss: 11.984 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 928423
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1821175
	speed: 0.0887s/iter; left time: 1835.5875s
	iters: 200, epoch: 1 | loss: 4.0674887
	speed: 0.0559s/iter; left time: 1152.0759s
Epoch: 1 cost time: 15.049011945724487
Epoch: 1, Steps: 208 | Train Loss: 4.059 Vali Loss: 3.866 Vali Acc: 0.055 Test Loss: 3.866 Test Acc: 0.055
Validation loss decreased (inf --> -0.055136).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4552526
	speed: 0.1883s/iter; left time: 3859.4096s
	iters: 200, epoch: 2 | loss: 3.5988545
	speed: 0.0743s/iter; left time: 1514.3404s
Epoch: 2 cost time: 14.700927019119263
Epoch: 2, Steps: 208 | Train Loss: 3.432 Vali Loss: 3.627 Vali Acc: 0.076 Test Loss: 3.627 Test Acc: 0.076
Validation loss decreased (-0.055136 --> -0.075717).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1842551
	speed: 0.2197s/iter; left time: 4457.4058s
	iters: 200, epoch: 3 | loss: 3.6385992
	speed: 0.0614s/iter; left time: 1238.6390s
Epoch: 3 cost time: 14.693125009536743
Epoch: 3, Steps: 208 | Train Loss: 3.325 Vali Loss: 3.661 Vali Acc: 0.092 Test Loss: 3.661 Test Acc: 0.092
Validation loss decreased (-0.075717 --> -0.091523).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3648467
	speed: 0.1783s/iter; left time: 3580.1212s
	iters: 200, epoch: 4 | loss: 3.8682287
	speed: 0.0711s/iter; left time: 1421.0732s
Epoch: 4 cost time: 13.156255722045898
Epoch: 4, Steps: 208 | Train Loss: 3.328 Vali Loss: 3.768 Vali Acc: 0.086 Test Loss: 3.768 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2157862
	speed: 0.1828s/iter; left time: 3632.6730s
	iters: 200, epoch: 5 | loss: 2.8289473
	speed: 0.0557s/iter; left time: 1101.5455s
Epoch: 5 cost time: 11.615543127059937
Epoch: 5, Steps: 208 | Train Loss: 3.279 Vali Loss: 4.333 Vali Acc: 0.072 Test Loss: 4.333 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.6754394
	speed: 0.1816s/iter; left time: 3569.6254s
	iters: 200, epoch: 6 | loss: 3.9007251
	speed: 0.0528s/iter; left time: 1032.2265s
Epoch: 6 cost time: 11.407455682754517
Epoch: 6, Steps: 208 | Train Loss: 3.275 Vali Loss: 4.184 Vali Acc: 0.096 Test Loss: 4.184 Test Acc: 0.096
Validation loss decreased (-0.091523 --> -0.095992).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6044340
	speed: 0.1735s/iter; left time: 3374.2402s
	iters: 200, epoch: 7 | loss: 3.3371675
	speed: 0.0634s/iter; left time: 1226.1312s
Epoch: 7 cost time: 11.364927053451538
Epoch: 7, Steps: 208 | Train Loss: 3.086 Vali Loss: 4.782 Vali Acc: 0.084 Test Loss: 4.782 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3627419
	speed: 0.1970s/iter; left time: 3791.0311s
	iters: 200, epoch: 8 | loss: 2.6954453
	speed: 0.0569s/iter; left time: 1089.8532s
Epoch: 8 cost time: 12.289111614227295
Epoch: 8, Steps: 208 | Train Loss: 2.846 Vali Loss: 6.041 Vali Acc: 0.112 Test Loss: 6.041 Test Acc: 0.112
Validation loss decreased (-0.095992 --> -0.112078).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7193782
	speed: 0.1918s/iter; left time: 3650.9880s
	iters: 200, epoch: 9 | loss: 2.1648107
	speed: 0.0537s/iter; left time: 1015.9717s
Epoch: 9 cost time: 11.647639036178589
Epoch: 9, Steps: 208 | Train Loss: 2.643 Vali Loss: 5.176 Vali Acc: 0.115 Test Loss: 5.176 Test Acc: 0.115
Validation loss decreased (-0.112078 --> -0.114771).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2402043
	speed: 0.1864s/iter; left time: 3510.4430s
	iters: 200, epoch: 10 | loss: 2.4976559
	speed: 0.0596s/iter; left time: 1117.1370s
Epoch: 10 cost time: 12.709850072860718
Epoch: 10, Steps: 208 | Train Loss: 2.283 Vali Loss: 5.994 Vali Acc: 0.113 Test Loss: 5.994 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7915159
	speed: 0.1911s/iter; left time: 3558.0171s
	iters: 200, epoch: 11 | loss: 2.4857776
	speed: 0.0557s/iter; left time: 1032.2783s
Epoch: 11 cost time: 12.145375967025757
Epoch: 11, Steps: 208 | Train Loss: 2.004 Vali Loss: 5.847 Vali Acc: 0.101 Test Loss: 5.847 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8171992
	speed: 0.1950s/iter; left time: 3590.3579s
	iters: 200, epoch: 12 | loss: 2.0682123
	speed: 0.0622s/iter; left time: 1138.8311s
Epoch: 12 cost time: 13.566241025924683
Epoch: 12, Steps: 208 | Train Loss: 1.722 Vali Loss: 6.111 Vali Acc: 0.111 Test Loss: 6.111 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.3718607
	speed: 0.1957s/iter; left time: 3562.8282s
	iters: 200, epoch: 13 | loss: 1.7806023
	speed: 0.0594s/iter; left time: 1074.7038s
Epoch: 13 cost time: 12.667784690856934
Epoch: 13, Steps: 208 | Train Loss: 1.453 Vali Loss: 6.182 Vali Acc: 0.116 Test Loss: 6.182 Test Acc: 0.116
Validation loss decreased (-0.114771 --> -0.116252).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0546572
	speed: 0.1811s/iter; left time: 3259.3401s
	iters: 200, epoch: 14 | loss: 1.0820521
	speed: 0.0584s/iter; left time: 1046.0652s
Epoch: 14 cost time: 12.375187635421753
Epoch: 14, Steps: 208 | Train Loss: 1.198 Vali Loss: 6.692 Vali Acc: 0.111 Test Loss: 6.692 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7398955
	speed: 0.2044s/iter; left time: 3635.7513s
	iters: 200, epoch: 15 | loss: 0.6883599
	speed: 0.0694s/iter; left time: 1227.8926s
Epoch: 15 cost time: 14.558191537857056
Epoch: 15, Steps: 208 | Train Loss: 1.001 Vali Loss: 7.001 Vali Acc: 0.109 Test Loss: 7.001 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5179921
	speed: 0.2061s/iter; left time: 3622.8540s
	iters: 200, epoch: 16 | loss: 0.6726965
	speed: 0.0638s/iter; left time: 1114.8621s
Epoch: 16 cost time: 14.052885055541992
Epoch: 16, Steps: 208 | Train Loss: 0.879 Vali Loss: 7.388 Vali Acc: 0.101 Test Loss: 7.388 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8295841
	speed: 0.1851s/iter; left time: 3215.2925s
	iters: 200, epoch: 17 | loss: 1.1005857
	speed: 0.0549s/iter; left time: 948.2879s
Epoch: 17 cost time: 11.963435649871826
Epoch: 17, Steps: 208 | Train Loss: 0.710 Vali Loss: 8.021 Vali Acc: 0.107 Test Loss: 8.021 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7199091
	speed: 0.1996s/iter; left time: 3426.2982s
	iters: 200, epoch: 18 | loss: 0.6215698
	speed: 0.0576s/iter; left time: 982.7966s
Epoch: 18 cost time: 13.00123119354248
Epoch: 18, Steps: 208 | Train Loss: 0.656 Vali Loss: 7.692 Vali Acc: 0.113 Test Loss: 7.692 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1154051
	speed: 0.1900s/iter; left time: 3221.6737s
	iters: 200, epoch: 19 | loss: 0.7048516
	speed: 0.0660s/iter; left time: 1113.1197s
Epoch: 19 cost time: 13.761149883270264
Epoch: 19, Steps: 208 | Train Loss: 0.549 Vali Loss: 8.315 Vali Acc: 0.118 Test Loss: 8.315 Test Acc: 0.118
Validation loss decreased (-0.116252 --> -0.117722).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4654743
	speed: 0.2031s/iter; left time: 3401.0632s
	iters: 200, epoch: 20 | loss: 0.6899088
	speed: 0.0641s/iter; left time: 1067.3992s
Epoch: 20 cost time: 14.029233932495117
Epoch: 20, Steps: 208 | Train Loss: 0.501 Vali Loss: 8.911 Vali Acc: 0.112 Test Loss: 8.911 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8201297
	speed: 0.1984s/iter; left time: 3281.6322s
	iters: 200, epoch: 21 | loss: 0.9426168
	speed: 0.0620s/iter; left time: 1019.6146s
Epoch: 21 cost time: 13.270655155181885
Epoch: 21, Steps: 208 | Train Loss: 0.482 Vali Loss: 9.139 Vali Acc: 0.117 Test Loss: 9.139 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.6432247
	speed: 0.1952s/iter; left time: 3188.2567s
	iters: 200, epoch: 22 | loss: 1.1241391
	speed: 0.0596s/iter; left time: 968.0417s
Epoch: 22 cost time: 12.641493320465088
Epoch: 22, Steps: 208 | Train Loss: 0.423 Vali Loss: 9.894 Vali Acc: 0.112 Test Loss: 9.894 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.6855578
	speed: 0.1853s/iter; left time: 2987.8547s
	iters: 200, epoch: 23 | loss: 0.7317638
	speed: 0.0601s/iter; left time: 963.8452s
Epoch: 23 cost time: 12.778429508209229
Epoch: 23, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.482 Vali Acc: 0.105 Test Loss: 9.482 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1299421
	speed: 0.2213s/iter; left time: 3522.4214s
	iters: 200, epoch: 24 | loss: 0.6647216
	speed: 0.0802s/iter; left time: 1267.7570s
Epoch: 24 cost time: 17.42582130432129
Epoch: 24, Steps: 208 | Train Loss: 0.363 Vali Loss: 9.566 Vali Acc: 0.115 Test Loss: 9.566 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1922454
	speed: 0.2502s/iter; left time: 3930.0076s
	iters: 200, epoch: 25 | loss: 0.0880677
	speed: 0.0984s/iter; left time: 1535.5722s
Epoch: 25 cost time: 20.3205885887146
Epoch: 25, Steps: 208 | Train Loss: 0.386 Vali Loss: 10.642 Vali Acc: 0.113 Test Loss: 10.642 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2714518
	speed: 0.2474s/iter; left time: 3834.7752s
	iters: 200, epoch: 26 | loss: 0.4797548
	speed: 0.0887s/iter; left time: 1366.3204s
Epoch: 26 cost time: 18.958685874938965
Epoch: 26, Steps: 208 | Train Loss: 0.335 Vali Loss: 10.573 Vali Acc: 0.109 Test Loss: 10.573 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.4387059
	speed: 0.2516s/iter; left time: 3847.8455s
	iters: 200, epoch: 27 | loss: 0.2433080
	speed: 0.0902s/iter; left time: 1370.5242s
Epoch: 27 cost time: 19.055973291397095
Epoch: 27, Steps: 208 | Train Loss: 0.310 Vali Loss: 10.121 Vali Acc: 0.118 Test Loss: 10.121 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0998212
	speed: 0.2373s/iter; left time: 3579.1027s
	iters: 200, epoch: 28 | loss: 0.1664854
	speed: 0.0809s/iter; left time: 1211.9882s
Epoch: 28 cost time: 17.059494972229004
Epoch: 28, Steps: 208 | Train Loss: 0.298 Vali Loss: 11.346 Vali Acc: 0.111 Test Loss: 11.346 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.1839136
	speed: 0.2270s/iter; left time: 3377.1350s
	iters: 200, epoch: 29 | loss: 0.7168192
	speed: 0.0852s/iter; left time: 1259.2236s
Epoch: 29 cost time: 17.676690816879272
Epoch: 29, Steps: 208 | Train Loss: 0.314 Vali Loss: 11.050 Vali Acc: 0.110 Test Loss: 11.050 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11780495079033701
model parameter : 765095
model size : 5.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9530873
	speed: 0.1036s/iter; left time: 2144.2639s
	iters: 200, epoch: 1 | loss: 3.7482572
	speed: 0.0699s/iter; left time: 1440.2786s
Epoch: 1 cost time: 17.76887583732605
Epoch: 1, Steps: 208 | Train Loss: 3.984 Vali Loss: 4.336 Vali Acc: 0.056 Test Loss: 4.336 Test Acc: 0.056
Validation loss decreased (inf --> -0.055728).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0315294
	speed: 0.1918s/iter; left time: 3930.4422s
	iters: 200, epoch: 2 | loss: 3.2153664
	speed: 0.0571s/iter; left time: 1164.6463s
Epoch: 2 cost time: 12.626592874526978
Epoch: 2, Steps: 208 | Train Loss: 3.605 Vali Loss: 3.835 Vali Acc: 0.073 Test Loss: 3.835 Test Acc: 0.073
Validation loss decreased (-0.055728 --> -0.073031).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2211246
	speed: 0.2253s/iter; left time: 4571.0864s
	iters: 200, epoch: 3 | loss: 3.6268573
	speed: 0.0757s/iter; left time: 1527.7430s
Epoch: 3 cost time: 16.136210203170776
Epoch: 3, Steps: 208 | Train Loss: 3.275 Vali Loss: 3.717 Vali Acc: 0.076 Test Loss: 3.717 Test Acc: 0.076
Validation loss decreased (-0.073031 --> -0.076312).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5276415
	speed: 0.2142s/iter; left time: 4301.3519s
	iters: 200, epoch: 4 | loss: 3.3615401
	speed: 0.0732s/iter; left time: 1462.0449s
Epoch: 4 cost time: 15.295738935470581
Epoch: 4, Steps: 208 | Train Loss: 3.223 Vali Loss: 3.672 Vali Acc: 0.097 Test Loss: 3.672 Test Acc: 0.097
Validation loss decreased (-0.076312 --> -0.096891).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1461685
	speed: 0.2142s/iter; left time: 4256.4189s
	iters: 200, epoch: 5 | loss: 3.3201234
	speed: 0.0622s/iter; left time: 1230.5401s
Epoch: 5 cost time: 14.193840742111206
Epoch: 5, Steps: 208 | Train Loss: 3.184 Vali Loss: 4.241 Vali Acc: 0.096 Test Loss: 4.241 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.2920463
	speed: 0.2330s/iter; left time: 4581.7418s
	iters: 200, epoch: 6 | loss: 4.1362462
	speed: 0.0749s/iter; left time: 1465.0803s
Epoch: 6 cost time: 16.27321457862854
Epoch: 6, Steps: 208 | Train Loss: 2.999 Vali Loss: 4.335 Vali Acc: 0.094 Test Loss: 4.335 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.7431827
	speed: 0.2263s/iter; left time: 4402.5105s
	iters: 200, epoch: 7 | loss: 3.0134766
	speed: 0.0631s/iter; left time: 1222.1072s
Epoch: 7 cost time: 14.958226203918457
Epoch: 7, Steps: 208 | Train Loss: 2.897 Vali Loss: 4.436 Vali Acc: 0.094 Test Loss: 4.436 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.0090566
	speed: 0.2391s/iter; left time: 4601.0515s
	iters: 200, epoch: 8 | loss: 1.6946852
	speed: 0.0940s/iter; left time: 1798.7682s
Epoch: 8 cost time: 19.37419605255127
Epoch: 8, Steps: 208 | Train Loss: 2.658 Vali Loss: 5.430 Vali Acc: 0.106 Test Loss: 5.430 Test Acc: 0.106
Validation loss decreased (-0.096891 --> -0.106119).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2762351
	speed: 0.2330s/iter; left time: 4436.3688s
	iters: 200, epoch: 9 | loss: 2.8643627
	speed: 0.0695s/iter; left time: 1316.4219s
Epoch: 9 cost time: 15.238163948059082
Epoch: 9, Steps: 208 | Train Loss: 2.401 Vali Loss: 5.268 Vali Acc: 0.112 Test Loss: 5.268 Test Acc: 0.112
Validation loss decreased (-0.106119 --> -0.112384).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0876212
	speed: 0.2250s/iter; left time: 4236.1382s
	iters: 200, epoch: 10 | loss: 3.1998749
	speed: 0.0664s/iter; left time: 1243.7036s
Epoch: 10 cost time: 14.449204683303833
Epoch: 10, Steps: 208 | Train Loss: 2.121 Vali Loss: 5.418 Vali Acc: 0.111 Test Loss: 5.418 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2576020
	speed: 0.2201s/iter; left time: 4098.5230s
	iters: 200, epoch: 11 | loss: 2.3836899
	speed: 0.0910s/iter; left time: 1685.1634s
Epoch: 11 cost time: 18.203018188476562
Epoch: 11, Steps: 208 | Train Loss: 1.790 Vali Loss: 5.929 Vali Acc: 0.108 Test Loss: 5.929 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3359754
	speed: 0.2482s/iter; left time: 4569.8314s
	iters: 200, epoch: 12 | loss: 1.4102627
	speed: 0.0648s/iter; left time: 1187.1443s
Epoch: 12 cost time: 15.42671513557434
Epoch: 12, Steps: 208 | Train Loss: 1.578 Vali Loss: 6.232 Vali Acc: 0.108 Test Loss: 6.232 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.7829558
	speed: 0.2348s/iter; left time: 4275.0353s
	iters: 200, epoch: 13 | loss: 1.1941936
	speed: 0.0805s/iter; left time: 1458.1068s
Epoch: 13 cost time: 17.223471879959106
Epoch: 13, Steps: 208 | Train Loss: 1.305 Vali Loss: 6.974 Vali Acc: 0.112 Test Loss: 6.974 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3284123
	speed: 0.2117s/iter; left time: 3809.4478s
	iters: 200, epoch: 14 | loss: 1.7046233
	speed: 0.0568s/iter; left time: 1016.3711s
Epoch: 14 cost time: 12.578104972839355
Epoch: 14, Steps: 208 | Train Loss: 1.114 Vali Loss: 8.068 Vali Acc: 0.105 Test Loss: 8.068 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8294738
	speed: 0.2074s/iter; left time: 3688.8152s
	iters: 200, epoch: 15 | loss: 1.6407241
	speed: 0.0833s/iter; left time: 1473.9242s
Epoch: 15 cost time: 16.82374143600464
Epoch: 15, Steps: 208 | Train Loss: 0.955 Vali Loss: 7.770 Vali Acc: 0.108 Test Loss: 7.770 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.1829669
	speed: 0.2303s/iter; left time: 4049.7580s
	iters: 200, epoch: 16 | loss: 1.1488907
	speed: 0.0940s/iter; left time: 1642.8582s
Epoch: 16 cost time: 18.439058303833008
Epoch: 16, Steps: 208 | Train Loss: 0.826 Vali Loss: 8.211 Vali Acc: 0.113 Test Loss: 8.211 Test Acc: 0.113
Validation loss decreased (-0.112384 --> -0.112951).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6004833
	speed: 0.2438s/iter; left time: 4234.6782s
	iters: 200, epoch: 17 | loss: 1.6373335
	speed: 0.0758s/iter; left time: 1309.3055s
Epoch: 17 cost time: 17.4441237449646
Epoch: 17, Steps: 208 | Train Loss: 0.697 Vali Loss: 8.562 Vali Acc: 0.112 Test Loss: 8.562 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0786544
	speed: 0.2137s/iter; left time: 3668.3371s
	iters: 200, epoch: 18 | loss: 0.3036330
	speed: 0.0917s/iter; left time: 1565.6934s
Epoch: 18 cost time: 18.737306594848633
Epoch: 18, Steps: 208 | Train Loss: 0.629 Vali Loss: 8.805 Vali Acc: 0.115 Test Loss: 8.805 Test Acc: 0.115
Validation loss decreased (-0.112951 --> -0.115331).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.2618093
	speed: 0.2251s/iter; left time: 3817.0228s
	iters: 200, epoch: 19 | loss: 0.4407150
	speed: 0.0599s/iter; left time: 1009.6981s
Epoch: 19 cost time: 14.488621950149536
Epoch: 19, Steps: 208 | Train Loss: 0.550 Vali Loss: 9.082 Vali Acc: 0.101 Test Loss: 9.082 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1944730
	speed: 0.2472s/iter; left time: 4139.5954s
	iters: 200, epoch: 20 | loss: 0.8195837
	speed: 0.0870s/iter; left time: 1448.9649s
Epoch: 20 cost time: 19.333226442337036
Epoch: 20, Steps: 208 | Train Loss: 0.541 Vali Loss: 9.036 Vali Acc: 0.106 Test Loss: 9.036 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2312331
	speed: 0.2501s/iter; left time: 4137.6121s
	iters: 200, epoch: 21 | loss: 0.3986510
	speed: 0.0791s/iter; left time: 1301.2898s
Epoch: 21 cost time: 17.674713373184204
Epoch: 21, Steps: 208 | Train Loss: 0.504 Vali Loss: 9.345 Vali Acc: 0.094 Test Loss: 9.345 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8497338
	speed: 0.2556s/iter; left time: 4175.4484s
	iters: 200, epoch: 22 | loss: 0.4130374
	speed: 0.0882s/iter; left time: 1431.8098s
Epoch: 22 cost time: 19.53022265434265
Epoch: 22, Steps: 208 | Train Loss: 0.405 Vali Loss: 9.866 Vali Acc: 0.107 Test Loss: 9.866 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1380383
	speed: 0.2251s/iter; left time: 3630.4328s
	iters: 200, epoch: 23 | loss: 0.1679455
	speed: 0.0900s/iter; left time: 1442.5411s
Epoch: 23 cost time: 17.517371654510498
Epoch: 23, Steps: 208 | Train Loss: 0.422 Vali Loss: 10.347 Vali Acc: 0.113 Test Loss: 10.347 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1152040
	speed: 0.2543s/iter; left time: 4048.1863s
	iters: 200, epoch: 24 | loss: 0.2575424
	speed: 0.0902s/iter; left time: 1427.1326s
Epoch: 24 cost time: 19.042983055114746
Epoch: 24, Steps: 208 | Train Loss: 0.385 Vali Loss: 10.349 Vali Acc: 0.112 Test Loss: 10.349 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1633730
	speed: 0.2402s/iter; left time: 3772.7676s
	iters: 200, epoch: 25 | loss: 0.5200624
	speed: 0.0815s/iter; left time: 1271.3701s
Epoch: 25 cost time: 18.251368761062622
Epoch: 25, Steps: 208 | Train Loss: 0.370 Vali Loss: 10.076 Vali Acc: 0.110 Test Loss: 10.076 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.1154634
	speed: 0.2605s/iter; left time: 4037.8107s
	iters: 200, epoch: 26 | loss: 0.4649108
	speed: 0.0969s/iter; left time: 1492.4765s
Epoch: 26 cost time: 22.03362464904785
Epoch: 26, Steps: 208 | Train Loss: 0.320 Vali Loss: 11.375 Vali Acc: 0.103 Test Loss: 11.375 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1820226
	speed: 0.2843s/iter; left time: 4347.6358s
	iters: 200, epoch: 27 | loss: 0.1819951
	speed: 0.1050s/iter; left time: 1595.7334s
Epoch: 27 cost time: 22.555803775787354
Epoch: 27, Steps: 208 | Train Loss: 0.359 Vali Loss: 10.794 Vali Acc: 0.110 Test Loss: 10.794 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.6866122
	speed: 0.2720s/iter; left time: 4102.5210s
	iters: 200, epoch: 28 | loss: 0.2119153
	speed: 0.1051s/iter; left time: 1574.3166s
Epoch: 28 cost time: 21.705708265304565
Epoch: 28, Steps: 208 | Train Loss: 0.332 Vali Loss: 11.440 Vali Acc: 0.108 Test Loss: 11.440 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1154190277363555
model parameter : 656679
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 7.3786469
	speed: 0.2244s/iter; left time: 4645.1565s
	iters: 200, epoch: 1 | loss: 4.2362709
	speed: 0.1834s/iter; left time: 3778.3344s
Epoch: 1 cost time: 42.31225848197937
Epoch: 1, Steps: 208 | Train Loss: 5.085 Vali Loss: 3.805 Vali Acc: 0.059 Test Loss: 3.805 Test Acc: 0.059
Validation loss decreased (inf --> -0.059312).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2255201
	speed: 0.5336s/iter; left time: 10935.0145s
	iters: 200, epoch: 2 | loss: 4.6903939
	speed: 0.1920s/iter; left time: 3914.5213s
Epoch: 2 cost time: 40.6480712890625
Epoch: 2, Steps: 208 | Train Loss: 4.210 Vali Loss: 3.954 Vali Acc: 0.075 Test Loss: 3.954 Test Acc: 0.075
Validation loss decreased (-0.059312 --> -0.075415).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.9545727
	speed: 0.4743s/iter; left time: 9621.7306s
	iters: 200, epoch: 3 | loss: 6.0009117
	speed: 0.1788s/iter; left time: 3608.2275s
Epoch: 3 cost time: 38.99810743331909
Epoch: 3, Steps: 208 | Train Loss: 5.014 Vali Loss: 4.475 Vali Acc: 0.092 Test Loss: 4.475 Test Acc: 0.092
Validation loss decreased (-0.075415 --> -0.091515).  Saving model ...
	iters: 100, epoch: 4 | loss: 6.2424927
	speed: 0.5105s/iter; left time: 10249.6929s
	iters: 200, epoch: 4 | loss: 7.7292137
	speed: 0.1819s/iter; left time: 3634.0896s
Epoch: 4 cost time: 37.29742646217346
Epoch: 4, Steps: 208 | Train Loss: 5.792 Vali Loss: 5.478 Vali Acc: 0.091 Test Loss: 5.478 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 6.6522622
	speed: 0.4448s/iter; left time: 8837.6947s
	iters: 200, epoch: 5 | loss: 5.5753870
	speed: 0.1792s/iter; left time: 3543.4432s
Epoch: 5 cost time: 34.395936489105225
Epoch: 5, Steps: 208 | Train Loss: 5.990 Vali Loss: 5.708 Vali Acc: 0.101 Test Loss: 5.708 Test Acc: 0.101
Validation loss decreased (-0.091515 --> -0.100450).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.7042856
	speed: 0.5073s/iter; left time: 9974.6616s
	iters: 200, epoch: 6 | loss: 5.9437790
	speed: 0.1731s/iter; left time: 3386.8875s
Epoch: 6 cost time: 35.60400128364563
Epoch: 6, Steps: 208 | Train Loss: 5.898 Vali Loss: 5.656 Vali Acc: 0.129 Test Loss: 5.656 Test Acc: 0.129
Validation loss decreased (-0.100450 --> -0.129082).  Saving model ...
	iters: 100, epoch: 7 | loss: 6.3326216
	speed: 0.4740s/iter; left time: 9221.2347s
	iters: 200, epoch: 7 | loss: 6.9019556
	speed: 0.1646s/iter; left time: 3184.7752s
Epoch: 7 cost time: 34.83672761917114
Epoch: 7, Steps: 208 | Train Loss: 5.548 Vali Loss: 7.402 Vali Acc: 0.077 Test Loss: 7.402 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 6.6964574
	speed: 0.5162s/iter; left time: 9935.2083s
	iters: 200, epoch: 8 | loss: 1.2262763
	speed: 0.1529s/iter; left time: 2927.1187s
Epoch: 8 cost time: 35.563162326812744
Epoch: 8, Steps: 208 | Train Loss: 4.893 Vali Loss: 7.971 Vali Acc: 0.109 Test Loss: 7.971 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.9073191
	speed: 0.4801s/iter; left time: 9139.3212s
	iters: 200, epoch: 9 | loss: 1.8496236
	speed: 0.1497s/iter; left time: 2834.9500s
Epoch: 9 cost time: 32.465094566345215
Epoch: 9, Steps: 208 | Train Loss: 3.886 Vali Loss: 9.509 Vali Acc: 0.096 Test Loss: 9.509 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9424213
	speed: 0.4702s/iter; left time: 8854.3161s
	iters: 200, epoch: 10 | loss: 2.7360651
	speed: 0.1594s/iter; left time: 2986.3126s
Epoch: 10 cost time: 34.92125678062439
Epoch: 10, Steps: 208 | Train Loss: 2.839 Vali Loss: 7.385 Vali Acc: 0.096 Test Loss: 7.385 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.7581613
	speed: 0.3723s/iter; left time: 6933.3100s
	iters: 200, epoch: 11 | loss: 1.7571921
	speed: 0.1387s/iter; left time: 2568.3452s
Epoch: 11 cost time: 25.29158067703247
Epoch: 11, Steps: 208 | Train Loss: 1.836 Vali Loss: 6.890 Vali Acc: 0.119 Test Loss: 6.890 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5252129
	speed: 0.4167s/iter; left time: 7671.9564s
	iters: 200, epoch: 12 | loss: 2.2225523
	speed: 0.1356s/iter; left time: 2482.4937s
Epoch: 12 cost time: 28.825901985168457
Epoch: 12, Steps: 208 | Train Loss: 1.373 Vali Loss: 7.183 Vali Acc: 0.091 Test Loss: 7.183 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.7397720
	speed: 0.3762s/iter; left time: 6849.1721s
	iters: 200, epoch: 13 | loss: 1.5217816
	speed: 0.1398s/iter; left time: 2531.6953s
Epoch: 13 cost time: 28.142939805984497
Epoch: 13, Steps: 208 | Train Loss: 1.147 Vali Loss: 6.821 Vali Acc: 0.104 Test Loss: 6.821 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.7060332
	speed: 0.4044s/iter; left time: 7278.5422s
	iters: 200, epoch: 14 | loss: 0.9862947
	speed: 0.1343s/iter; left time: 2403.8398s
Epoch: 14 cost time: 28.85412621498108
Epoch: 14, Steps: 208 | Train Loss: 0.999 Vali Loss: 7.207 Vali Acc: 0.125 Test Loss: 7.207 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0777066
	speed: 0.3980s/iter; left time: 7079.5148s
	iters: 200, epoch: 15 | loss: 0.6808156
	speed: 0.1356s/iter; left time: 2399.3515s
Epoch: 15 cost time: 28.114713668823242
Epoch: 15, Steps: 208 | Train Loss: 0.794 Vali Loss: 6.564 Vali Acc: 0.139 Test Loss: 6.564 Test Acc: 0.139
Validation loss decreased (-0.129082 --> -0.138914).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4627306
	speed: 0.3955s/iter; left time: 6954.0565s
	iters: 200, epoch: 16 | loss: 0.5191406
	speed: 0.1737s/iter; left time: 3037.1388s
Epoch: 16 cost time: 32.24299621582031
Epoch: 16, Steps: 208 | Train Loss: 0.705 Vali Loss: 6.813 Vali Acc: 0.134 Test Loss: 6.813 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4701903
	speed: 0.4895s/iter; left time: 8503.7588s
	iters: 200, epoch: 17 | loss: 0.4812807
	speed: 0.1768s/iter; left time: 3053.6283s
Epoch: 17 cost time: 35.24419689178467
Epoch: 17, Steps: 208 | Train Loss: 0.554 Vali Loss: 8.297 Vali Acc: 0.140 Test Loss: 8.297 Test Acc: 0.140
Validation loss decreased (-0.138914 --> -0.139792).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2593688
	speed: 0.4780s/iter; left time: 8204.9546s
	iters: 200, epoch: 18 | loss: 0.3072653
	speed: 0.1521s/iter; left time: 2595.9556s
Epoch: 18 cost time: 32.79783010482788
Epoch: 18, Steps: 208 | Train Loss: 0.462 Vali Loss: 8.734 Vali Acc: 0.135 Test Loss: 8.734 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2388770
	speed: 0.4497s/iter; left time: 7626.0979s
	iters: 200, epoch: 19 | loss: 0.5247703
	speed: 0.1580s/iter; left time: 2663.0614s
Epoch: 19 cost time: 31.478861331939697
Epoch: 19, Steps: 208 | Train Loss: 0.345 Vali Loss: 9.724 Vali Acc: 0.125 Test Loss: 9.724 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1456347
	speed: 0.4287s/iter; left time: 7179.7494s
	iters: 200, epoch: 20 | loss: 0.6412161
	speed: 0.1126s/iter; left time: 1873.9248s
Epoch: 20 cost time: 24.95276689529419
Epoch: 20, Steps: 208 | Train Loss: 0.329 Vali Loss: 10.064 Vali Acc: 0.123 Test Loss: 10.064 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.3522036
	speed: 0.4453s/iter; left time: 7365.1529s
	iters: 200, epoch: 21 | loss: 0.3039089
	speed: 0.1582s/iter; left time: 2601.6078s
Epoch: 21 cost time: 32.690327882766724
Epoch: 21, Steps: 208 | Train Loss: 0.265 Vali Loss: 10.639 Vali Acc: 0.128 Test Loss: 10.639 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.3436484
	speed: 0.4515s/iter; left time: 7374.8188s
	iters: 200, epoch: 22 | loss: 0.4320688
	speed: 0.1541s/iter; left time: 2501.7729s
Epoch: 22 cost time: 32.496594190597534
Epoch: 22, Steps: 208 | Train Loss: 0.254 Vali Loss: 10.094 Vali Acc: 0.127 Test Loss: 10.094 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.4778737
	speed: 0.3883s/iter; left time: 6260.9584s
	iters: 200, epoch: 23 | loss: 0.2281889
	speed: 0.1358s/iter; left time: 2176.7083s
Epoch: 23 cost time: 29.44160294532776
Epoch: 23, Steps: 208 | Train Loss: 0.216 Vali Loss: 11.000 Vali Acc: 0.125 Test Loss: 11.000 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.2776745
	speed: 0.4278s/iter; left time: 6809.4536s
	iters: 200, epoch: 24 | loss: 0.1766154
	speed: 0.1357s/iter; left time: 2146.8767s
Epoch: 24 cost time: 29.519715547561646
Epoch: 24, Steps: 208 | Train Loss: 0.217 Vali Loss: 10.690 Vali Acc: 0.122 Test Loss: 10.690 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.4534257
	speed: 0.3842s/iter; left time: 6036.0183s
	iters: 200, epoch: 25 | loss: 0.1684766
	speed: 0.1492s/iter; left time: 2328.9719s
Epoch: 25 cost time: 28.383960962295532
Epoch: 25, Steps: 208 | Train Loss: 0.182 Vali Loss: 10.107 Vali Acc: 0.131 Test Loss: 10.107 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2716333
	speed: 0.4274s/iter; left time: 6624.9519s
	iters: 200, epoch: 26 | loss: 0.0017947
	speed: 0.1216s/iter; left time: 1873.1489s
Epoch: 26 cost time: 27.335442066192627
Epoch: 26, Steps: 208 | Train Loss: 0.176 Vali Loss: 11.378 Vali Acc: 0.124 Test Loss: 11.378 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0922045
	speed: 0.4463s/iter; left time: 6825.9881s
	iters: 200, epoch: 27 | loss: 0.3492846
	speed: 0.1525s/iter; left time: 2316.6844s
Epoch: 27 cost time: 32.3681366443634
Epoch: 27, Steps: 208 | Train Loss: 0.182 Vali Loss: 11.502 Vali Acc: 0.121 Test Loss: 11.502 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13987473903966596
model parameter : 4153895
model size : 18.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5614982
	speed: 0.1211s/iter; left time: 2507.5377s
	iters: 200, epoch: 1 | loss: 3.2847099
	speed: 0.1093s/iter; left time: 2250.9941s
Epoch: 1 cost time: 24.00939178466797
Epoch: 1, Steps: 208 | Train Loss: 4.436 Vali Loss: 3.498 Vali Acc: 0.061 Test Loss: 3.498 Test Acc: 0.061
Validation loss decreased (inf --> -0.061104).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6079712
	speed: 0.2894s/iter; left time: 5931.0577s
	iters: 200, epoch: 2 | loss: 4.2331462
	speed: 0.1134s/iter; left time: 2312.6701s
Epoch: 2 cost time: 23.87847137451172
Epoch: 2, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.828 Vali Acc: 0.073 Test Loss: 3.828 Test Acc: 0.073
Validation loss decreased (-0.061104 --> -0.072732).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.6357999
	speed: 0.2827s/iter; left time: 5735.5205s
	iters: 200, epoch: 3 | loss: 4.5365701
	speed: 0.1073s/iter; left time: 2166.7771s
Epoch: 3 cost time: 22.30207324028015
Epoch: 3, Steps: 208 | Train Loss: 4.133 Vali Loss: 4.238 Vali Acc: 0.076 Test Loss: 4.238 Test Acc: 0.076
Validation loss decreased (-0.072732 --> -0.076009).  Saving model ...
	iters: 100, epoch: 4 | loss: 6.0419116
	speed: 0.2876s/iter; left time: 5773.6488s
	iters: 200, epoch: 4 | loss: 5.4626727
	speed: 0.1004s/iter; left time: 2006.5659s
Epoch: 4 cost time: 22.37980365753174
Epoch: 4, Steps: 208 | Train Loss: 4.452 Vali Loss: 3.834 Vali Acc: 0.118 Test Loss: 3.834 Test Acc: 0.118
Validation loss decreased (-0.076009 --> -0.117468).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.5544686
	speed: 0.2758s/iter; left time: 5479.2121s
	iters: 200, epoch: 5 | loss: 4.8266726
	speed: 0.0959s/iter; left time: 1895.9994s
Epoch: 5 cost time: 20.610548496246338
Epoch: 5, Steps: 208 | Train Loss: 4.521 Vali Loss: 4.438 Vali Acc: 0.114 Test Loss: 4.438 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 5.1746230
	speed: 0.2827s/iter; left time: 5558.3188s
	iters: 200, epoch: 6 | loss: 4.8695974
	speed: 0.1110s/iter; left time: 2171.7174s
Epoch: 6 cost time: 23.612550735473633
Epoch: 6, Steps: 208 | Train Loss: 4.456 Vali Loss: 4.515 Vali Acc: 0.113 Test Loss: 4.515 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.7424235
	speed: 0.2800s/iter; left time: 5447.1181s
	iters: 200, epoch: 7 | loss: 5.7780704
	speed: 0.0990s/iter; left time: 1916.7348s
Epoch: 7 cost time: 21.232810974121094
Epoch: 7, Steps: 208 | Train Loss: 4.282 Vali Loss: 6.124 Vali Acc: 0.104 Test Loss: 6.124 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 5.2867799
	speed: 0.2802s/iter; left time: 5392.0705s
	iters: 200, epoch: 8 | loss: 4.0805426
	speed: 0.1049s/iter; left time: 2008.0058s
Epoch: 8 cost time: 22.17055606842041
Epoch: 8, Steps: 208 | Train Loss: 3.772 Vali Loss: 5.262 Vali Acc: 0.120 Test Loss: 5.262 Test Acc: 0.120
Validation loss decreased (-0.117468 --> -0.120138).  Saving model ...
	iters: 100, epoch: 9 | loss: 4.3010368
	speed: 0.2854s/iter; left time: 5433.2028s
	iters: 200, epoch: 9 | loss: 3.2168813
	speed: 0.1150s/iter; left time: 2178.1301s
Epoch: 9 cost time: 24.48857569694519
Epoch: 9, Steps: 208 | Train Loss: 3.253 Vali Loss: 5.534 Vali Acc: 0.125 Test Loss: 5.534 Test Acc: 0.125
Validation loss decreased (-0.120138 --> -0.124609).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.8939145
	speed: 0.3036s/iter; left time: 5717.2558s
	iters: 200, epoch: 10 | loss: 3.5444021
	speed: 0.0977s/iter; left time: 1830.0394s
Epoch: 10 cost time: 22.403947830200195
Epoch: 10, Steps: 208 | Train Loss: 2.695 Vali Loss: 6.316 Vali Acc: 0.108 Test Loss: 6.316 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1208363
	speed: 0.3002s/iter; left time: 5590.3018s
	iters: 200, epoch: 11 | loss: 3.2339423
	speed: 0.1319s/iter; left time: 2442.9561s
Epoch: 11 cost time: 27.678083658218384
Epoch: 11, Steps: 208 | Train Loss: 1.997 Vali Loss: 6.369 Vali Acc: 0.120 Test Loss: 6.369 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4498034
	speed: 0.3450s/iter; left time: 6352.7723s
	iters: 200, epoch: 12 | loss: 2.5571706
	speed: 0.1181s/iter; left time: 2163.4968s
Epoch: 12 cost time: 26.832935094833374
Epoch: 12, Steps: 208 | Train Loss: 1.522 Vali Loss: 6.493 Vali Acc: 0.112 Test Loss: 6.493 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.8456349
	speed: 0.3484s/iter; left time: 6342.1954s
	iters: 200, epoch: 13 | loss: 1.8149614
	speed: 0.1305s/iter; left time: 2362.0170s
Epoch: 13 cost time: 28.63755965232849
Epoch: 13, Steps: 208 | Train Loss: 1.191 Vali Loss: 6.549 Vali Acc: 0.143 Test Loss: 6.549 Test Acc: 0.143
Validation loss decreased (-0.124609 --> -0.142493).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.9797299
	speed: 0.3394s/iter; left time: 6108.0960s
	iters: 200, epoch: 14 | loss: 0.8766146
	speed: 0.1328s/iter; left time: 2377.0050s
Epoch: 14 cost time: 28.553438186645508
Epoch: 14, Steps: 208 | Train Loss: 0.977 Vali Loss: 6.837 Vali Acc: 0.139 Test Loss: 6.837 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7908247
	speed: 0.3375s/iter; left time: 6003.1080s
	iters: 200, epoch: 15 | loss: 0.7743565
	speed: 0.1333s/iter; left time: 2357.0711s
Epoch: 15 cost time: 28.45263409614563
Epoch: 15, Steps: 208 | Train Loss: 0.814 Vali Loss: 6.946 Vali Acc: 0.136 Test Loss: 6.946 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6687037
	speed: 0.3827s/iter; left time: 6727.6660s
	iters: 200, epoch: 16 | loss: 0.7237051
	speed: 0.1643s/iter; left time: 2872.3089s
Epoch: 16 cost time: 34.50694441795349
Epoch: 16, Steps: 208 | Train Loss: 0.665 Vali Loss: 7.896 Vali Acc: 0.148 Test Loss: 7.896 Test Acc: 0.148
Validation loss decreased (-0.142493 --> -0.147848).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0639864
	speed: 0.3692s/iter; left time: 6414.6857s
	iters: 200, epoch: 17 | loss: 0.9211794
	speed: 0.1460s/iter; left time: 2521.1006s
Epoch: 17 cost time: 30.278801202774048
Epoch: 17, Steps: 208 | Train Loss: 0.566 Vali Loss: 7.930 Vali Acc: 0.137 Test Loss: 7.930 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3719844
	speed: 0.3332s/iter; left time: 5719.4650s
	iters: 200, epoch: 18 | loss: 0.4221387
	speed: 0.1235s/iter; left time: 2108.3445s
Epoch: 18 cost time: 26.470484018325806
Epoch: 18, Steps: 208 | Train Loss: 0.464 Vali Loss: 8.299 Vali Acc: 0.139 Test Loss: 8.299 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0934824
	speed: 0.3419s/iter; left time: 5796.9540s
	iters: 200, epoch: 19 | loss: 0.8874459
	speed: 0.1197s/iter; left time: 2017.8005s
Epoch: 19 cost time: 26.18152117729187
Epoch: 19, Steps: 208 | Train Loss: 0.382 Vali Loss: 8.554 Vali Acc: 0.141 Test Loss: 8.554 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2279016
	speed: 0.2774s/iter; left time: 4646.0958s
	iters: 200, epoch: 20 | loss: 0.9919686
	speed: 0.0894s/iter; left time: 1488.8272s
Epoch: 20 cost time: 19.4218852519989
Epoch: 20, Steps: 208 | Train Loss: 0.330 Vali Loss: 9.449 Vali Acc: 0.125 Test Loss: 9.449 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1198654
	speed: 0.3007s/iter; left time: 4973.4143s
	iters: 200, epoch: 21 | loss: 0.7749211
	speed: 0.1162s/iter; left time: 1910.8913s
Epoch: 21 cost time: 25.10396146774292
Epoch: 21, Steps: 208 | Train Loss: 0.274 Vali Loss: 9.922 Vali Acc: 0.127 Test Loss: 9.922 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0983596
	speed: 0.2986s/iter; left time: 4876.3529s
	iters: 200, epoch: 22 | loss: 0.4414913
	speed: 0.1154s/iter; left time: 1873.7150s
Epoch: 22 cost time: 24.06855607032776
Epoch: 22, Steps: 208 | Train Loss: 0.317 Vali Loss: 9.113 Vali Acc: 0.136 Test Loss: 9.113 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.1003832
	speed: 0.2978s/iter; left time: 4802.0542s
	iters: 200, epoch: 23 | loss: 0.5628251
	speed: 0.1110s/iter; left time: 1778.2478s
Epoch: 23 cost time: 23.76790761947632
Epoch: 23, Steps: 208 | Train Loss: 0.267 Vali Loss: 9.921 Vali Acc: 0.134 Test Loss: 9.921 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2204022
	speed: 0.2968s/iter; left time: 4723.9447s
	iters: 200, epoch: 24 | loss: 0.4343971
	speed: 0.1115s/iter; left time: 1762.8260s
Epoch: 24 cost time: 23.445589065551758
Epoch: 24, Steps: 208 | Train Loss: 0.247 Vali Loss: 10.619 Vali Acc: 0.132 Test Loss: 10.619 Test Acc: 0.132
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0327632
	speed: 0.2619s/iter; left time: 4113.7635s
	iters: 200, epoch: 25 | loss: 0.6030832
	speed: 0.0763s/iter; left time: 1191.1953s
Epoch: 25 cost time: 17.32681655883789
Epoch: 25, Steps: 208 | Train Loss: 0.223 Vali Loss: 10.086 Vali Acc: 0.140 Test Loss: 10.086 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.5054886
	speed: 0.2900s/iter; left time: 4495.6871s
	iters: 200, epoch: 26 | loss: 0.6432660
	speed: 0.1074s/iter; left time: 1653.7178s
Epoch: 26 cost time: 23.071216344833374
Epoch: 26, Steps: 208 | Train Loss: 0.200 Vali Loss: 10.601 Vali Acc: 0.129 Test Loss: 10.601 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14792722934685357
model parameter : 2177703
model size : 10.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6257753
	speed: 0.1240s/iter; left time: 2565.9878s
	iters: 200, epoch: 1 | loss: 4.0310111
	speed: 0.1004s/iter; left time: 2067.8668s
Epoch: 1 cost time: 23.439950227737427
Epoch: 1, Steps: 208 | Train Loss: 4.304 Vali Loss: 3.552 Vali Acc: 0.063 Test Loss: 3.552 Test Acc: 0.063
Validation loss decreased (inf --> -0.062595).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1533732
	speed: 0.2770s/iter; left time: 5677.0278s
	iters: 200, epoch: 2 | loss: 4.0872159
	speed: 0.0943s/iter; left time: 1922.0804s
Epoch: 2 cost time: 20.329861164093018
Epoch: 2, Steps: 208 | Train Loss: 3.529 Vali Loss: 3.683 Vali Acc: 0.095 Test Loss: 3.683 Test Acc: 0.095
Validation loss decreased (-0.062595 --> -0.095102).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.0199571
	speed: 0.2748s/iter; left time: 5574.2382s
	iters: 200, epoch: 3 | loss: 3.5421925
	speed: 0.0912s/iter; left time: 1839.9223s
Epoch: 3 cost time: 20.783881902694702
Epoch: 3, Steps: 208 | Train Loss: 3.711 Vali Loss: 4.489 Vali Acc: 0.081 Test Loss: 4.489 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.8466859
	speed: 0.2487s/iter; left time: 4992.7782s
	iters: 200, epoch: 4 | loss: 4.4205880
	speed: 0.0940s/iter; left time: 1878.1747s
Epoch: 4 cost time: 18.472872495651245
Epoch: 4, Steps: 208 | Train Loss: 3.971 Vali Loss: 4.113 Vali Acc: 0.103 Test Loss: 4.113 Test Acc: 0.103
Validation loss decreased (-0.095102 --> -0.102852).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9401748
	speed: 0.2341s/iter; left time: 4651.6488s
	iters: 200, epoch: 5 | loss: 4.9427009
	speed: 0.0706s/iter; left time: 1395.0598s
Epoch: 5 cost time: 14.663216590881348
Epoch: 5, Steps: 208 | Train Loss: 4.047 Vali Loss: 5.560 Vali Acc: 0.079 Test Loss: 5.560 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.7402856
	speed: 0.2545s/iter; left time: 5003.1992s
	iters: 200, epoch: 6 | loss: 4.4862213
	speed: 0.0825s/iter; left time: 1613.5152s
Epoch: 6 cost time: 18.584093809127808
Epoch: 6, Steps: 208 | Train Loss: 4.008 Vali Loss: 6.086 Vali Acc: 0.095 Test Loss: 6.086 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 5.6292720
	speed: 0.2649s/iter; left time: 5152.3586s
	iters: 200, epoch: 7 | loss: 3.6600797
	speed: 0.0880s/iter; left time: 1702.7011s
Epoch: 7 cost time: 19.858057260513306
Epoch: 7, Steps: 208 | Train Loss: 3.809 Vali Loss: 4.889 Vali Acc: 0.112 Test Loss: 4.889 Test Acc: 0.112
Validation loss decreased (-0.102852 --> -0.112089).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9552581
	speed: 0.2821s/iter; left time: 5429.4625s
	iters: 200, epoch: 8 | loss: 5.0302329
	speed: 0.0951s/iter; left time: 1820.6785s
Epoch: 8 cost time: 21.192304849624634
Epoch: 8, Steps: 208 | Train Loss: 3.538 Vali Loss: 5.272 Vali Acc: 0.142 Test Loss: 5.272 Test Acc: 0.142
Validation loss decreased (-0.112089 --> -0.141611).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8777556
	speed: 0.2332s/iter; left time: 4439.2028s
	iters: 200, epoch: 9 | loss: 3.3760109
	speed: 0.0845s/iter; left time: 1600.7348s
Epoch: 9 cost time: 17.91878843307495
Epoch: 9, Steps: 208 | Train Loss: 3.107 Vali Loss: 5.259 Vali Acc: 0.114 Test Loss: 5.259 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7790747
	speed: 0.2637s/iter; left time: 4965.5256s
	iters: 200, epoch: 10 | loss: 4.0626459
	speed: 0.1005s/iter; left time: 1882.4214s
Epoch: 10 cost time: 21.664533615112305
Epoch: 10, Steps: 208 | Train Loss: 2.655 Vali Loss: 5.411 Vali Acc: 0.117 Test Loss: 5.411 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8495888
	speed: 0.2774s/iter; left time: 5166.2168s
	iters: 200, epoch: 11 | loss: 1.8177257
	speed: 0.1044s/iter; left time: 1934.1465s
Epoch: 11 cost time: 22.692351818084717
Epoch: 11, Steps: 208 | Train Loss: 2.137 Vali Loss: 6.804 Vali Acc: 0.122 Test Loss: 6.804 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.1672518
	speed: 0.2643s/iter; left time: 4866.0144s
	iters: 200, epoch: 12 | loss: 2.1235671
	speed: 0.0889s/iter; left time: 1627.2324s
Epoch: 12 cost time: 19.300049304962158
Epoch: 12, Steps: 208 | Train Loss: 1.732 Vali Loss: 6.523 Vali Acc: 0.129 Test Loss: 6.523 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6770290
	speed: 0.2731s/iter; left time: 4971.2956s
	iters: 200, epoch: 13 | loss: 1.7826352
	speed: 0.0982s/iter; left time: 1777.1181s
Epoch: 13 cost time: 21.048120737075806
Epoch: 13, Steps: 208 | Train Loss: 1.351 Vali Loss: 6.259 Vali Acc: 0.121 Test Loss: 6.259 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.8338560
	speed: 0.2355s/iter; left time: 4238.9525s
	iters: 200, epoch: 14 | loss: 1.3135107
	speed: 0.0869s/iter; left time: 1554.9505s
Epoch: 14 cost time: 17.943389177322388
Epoch: 14, Steps: 208 | Train Loss: 1.079 Vali Loss: 6.592 Vali Acc: 0.134 Test Loss: 6.592 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6957486
	speed: 0.2583s/iter; left time: 4594.1775s
	iters: 200, epoch: 15 | loss: 0.5542849
	speed: 0.0927s/iter; left time: 1640.4578s
Epoch: 15 cost time: 19.940332889556885
Epoch: 15, Steps: 208 | Train Loss: 0.880 Vali Loss: 6.502 Vali Acc: 0.128 Test Loss: 6.502 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1836268
	speed: 0.2469s/iter; left time: 4340.6213s
	iters: 200, epoch: 16 | loss: 1.5279863
	speed: 0.0798s/iter; left time: 1394.2998s
Epoch: 16 cost time: 17.5367910861969
Epoch: 16, Steps: 208 | Train Loss: 0.722 Vali Loss: 6.738 Vali Acc: 0.129 Test Loss: 6.738 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.5853650
	speed: 0.2722s/iter; left time: 4729.5007s
	iters: 200, epoch: 17 | loss: 0.2588651
	speed: 0.1183s/iter; left time: 2042.5514s
Epoch: 17 cost time: 24.89696717262268
Epoch: 17, Steps: 208 | Train Loss: 0.580 Vali Loss: 7.474 Vali Acc: 0.129 Test Loss: 7.474 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.3906586
	speed: 0.2970s/iter; left time: 5097.2618s
	iters: 200, epoch: 18 | loss: 0.2027616
	speed: 0.1120s/iter; left time: 1911.5750s
Epoch: 18 cost time: 23.344318151474
Epoch: 18, Steps: 208 | Train Loss: 0.519 Vali Loss: 7.875 Vali Acc: 0.121 Test Loss: 7.875 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1416641813301521
model parameter : 1519527
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1543355
	speed: 0.1310s/iter; left time: 2711.6043s
	iters: 200, epoch: 1 | loss: 3.9233177
	speed: 0.1205s/iter; left time: 2482.8241s
Epoch: 1 cost time: 26.01969838142395
Epoch: 1, Steps: 208 | Train Loss: 4.275 Vali Loss: 3.628 Vali Acc: 0.053 Test Loss: 3.628 Test Acc: 0.053
Validation loss decreased (inf --> -0.053349).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2561688
	speed: 0.2941s/iter; left time: 6027.0265s
	iters: 200, epoch: 2 | loss: 4.6917596
	speed: 0.0811s/iter; left time: 1653.5052s
Epoch: 2 cost time: 20.317073345184326
Epoch: 2, Steps: 208 | Train Loss: 3.579 Vali Loss: 3.743 Vali Acc: 0.081 Test Loss: 3.743 Test Acc: 0.081
Validation loss decreased (-0.053349 --> -0.081084).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4789078
	speed: 0.2663s/iter; left time: 5402.1387s
	iters: 200, epoch: 3 | loss: 4.1000571
	speed: 0.1168s/iter; left time: 2357.5654s
Epoch: 3 cost time: 25.282829999923706
Epoch: 3, Steps: 208 | Train Loss: 3.589 Vali Loss: 3.702 Vali Acc: 0.103 Test Loss: 3.702 Test Acc: 0.103
Validation loss decreased (-0.081084 --> -0.102558).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8118136
	speed: 0.2781s/iter; left time: 5583.6160s
	iters: 200, epoch: 4 | loss: 4.1682291
	speed: 0.1076s/iter; left time: 2150.0223s
Epoch: 4 cost time: 21.98581552505493
Epoch: 4, Steps: 208 | Train Loss: 3.779 Vali Loss: 3.933 Vali Acc: 0.111 Test Loss: 3.933 Test Acc: 0.111
Validation loss decreased (-0.102558 --> -0.110906).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9563153
	speed: 0.2843s/iter; left time: 5648.9755s
	iters: 200, epoch: 5 | loss: 3.8115072
	speed: 0.0868s/iter; left time: 1715.6812s
Epoch: 5 cost time: 20.82473397254944
Epoch: 5, Steps: 208 | Train Loss: 3.774 Vali Loss: 3.985 Vali Acc: 0.115 Test Loss: 3.985 Test Acc: 0.115
Validation loss decreased (-0.110906 --> -0.114783).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6016207
	speed: 0.2611s/iter; left time: 5132.9663s
	iters: 200, epoch: 6 | loss: 2.8015921
	speed: 0.1040s/iter; left time: 2033.6223s
Epoch: 6 cost time: 22.712881803512573
Epoch: 6, Steps: 208 | Train Loss: 3.673 Vali Loss: 4.279 Vali Acc: 0.117 Test Loss: 4.279 Test Acc: 0.117
Validation loss decreased (-0.114783 --> -0.116867).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9331071
	speed: 0.2682s/iter; left time: 5217.6811s
	iters: 200, epoch: 7 | loss: 3.2835829
	speed: 0.1074s/iter; left time: 2078.4856s
Epoch: 7 cost time: 21.701564073562622
Epoch: 7, Steps: 208 | Train Loss: 3.604 Vali Loss: 4.590 Vali Acc: 0.129 Test Loss: 4.590 Test Acc: 0.129
Validation loss decreased (-0.116867 --> -0.129390).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1897044
	speed: 0.2984s/iter; left time: 5742.2992s
	iters: 200, epoch: 8 | loss: 2.9246087
	speed: 0.1048s/iter; left time: 2006.3793s
Epoch: 8 cost time: 22.553123235702515
Epoch: 8, Steps: 208 | Train Loss: 3.272 Vali Loss: 5.179 Vali Acc: 0.121 Test Loss: 5.179 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8604894
	speed: 0.2626s/iter; left time: 4998.6361s
	iters: 200, epoch: 9 | loss: 3.6254137
	speed: 0.1065s/iter; left time: 2016.8324s
Epoch: 9 cost time: 21.834619522094727
Epoch: 9, Steps: 208 | Train Loss: 2.926 Vali Loss: 4.960 Vali Acc: 0.121 Test Loss: 4.960 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8223119
	speed: 0.2643s/iter; left time: 4976.5705s
	iters: 200, epoch: 10 | loss: 2.9979911
	speed: 0.1024s/iter; left time: 1918.6510s
Epoch: 10 cost time: 21.613616466522217
Epoch: 10, Steps: 208 | Train Loss: 2.479 Vali Loss: 5.244 Vali Acc: 0.122 Test Loss: 5.244 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.6795754
	speed: 0.2539s/iter; left time: 4726.9939s
	iters: 200, epoch: 11 | loss: 2.1280146
	speed: 0.0817s/iter; left time: 1512.6468s
Epoch: 11 cost time: 17.31850242614746
Epoch: 11, Steps: 208 | Train Loss: 2.074 Vali Loss: 5.551 Vali Acc: 0.129 Test Loss: 5.551 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3540337
	speed: 0.2503s/iter; left time: 4608.3473s
	iters: 200, epoch: 12 | loss: 2.0818641
	speed: 0.0759s/iter; left time: 1389.7982s
Epoch: 12 cost time: 17.766332387924194
Epoch: 12, Steps: 208 | Train Loss: 1.712 Vali Loss: 6.081 Vali Acc: 0.123 Test Loss: 6.081 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1020043
	speed: 0.2616s/iter; left time: 4761.8366s
	iters: 200, epoch: 13 | loss: 1.4253545
	speed: 0.0947s/iter; left time: 1714.2094s
Epoch: 13 cost time: 21.02667999267578
Epoch: 13, Steps: 208 | Train Loss: 1.363 Vali Loss: 6.110 Vali Acc: 0.138 Test Loss: 6.110 Test Acc: 0.138
Validation loss decreased (-0.129390 --> -0.138024).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0950323
	speed: 0.2471s/iter; left time: 4446.2421s
	iters: 200, epoch: 14 | loss: 1.4153731
	speed: 0.0714s/iter; left time: 1277.9721s
Epoch: 14 cost time: 15.939621448516846
Epoch: 14, Steps: 208 | Train Loss: 1.091 Vali Loss: 6.612 Vali Acc: 0.133 Test Loss: 6.612 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3045149
	speed: 0.2526s/iter; left time: 4492.9220s
	iters: 200, epoch: 15 | loss: 1.0705723
	speed: 0.0888s/iter; left time: 1571.4328s
Epoch: 15 cost time: 19.256234169006348
Epoch: 15, Steps: 208 | Train Loss: 0.908 Vali Loss: 6.797 Vali Acc: 0.108 Test Loss: 6.797 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7482427
	speed: 0.2351s/iter; left time: 4133.5155s
	iters: 200, epoch: 16 | loss: 0.4539267
	speed: 0.0815s/iter; left time: 1424.2848s
Epoch: 16 cost time: 17.218472957611084
Epoch: 16, Steps: 208 | Train Loss: 0.728 Vali Loss: 7.097 Vali Acc: 0.138 Test Loss: 7.097 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2941952
	speed: 0.2233s/iter; left time: 3879.0125s
	iters: 200, epoch: 17 | loss: 0.6239743
	speed: 0.0785s/iter; left time: 1356.4374s
Epoch: 17 cost time: 16.412850379943848
Epoch: 17, Steps: 208 | Train Loss: 0.616 Vali Loss: 7.458 Vali Acc: 0.124 Test Loss: 7.458 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4686661
	speed: 0.2484s/iter; left time: 4263.9052s
	iters: 200, epoch: 18 | loss: 0.8326213
	speed: 0.0885s/iter; left time: 1510.7304s
Epoch: 18 cost time: 18.19199514389038
Epoch: 18, Steps: 208 | Train Loss: 0.499 Vali Loss: 7.875 Vali Acc: 0.128 Test Loss: 7.875 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4696893
	speed: 0.2460s/iter; left time: 4170.9871s
	iters: 200, epoch: 19 | loss: 0.3664804
	speed: 0.0841s/iter; left time: 1417.8581s
Epoch: 19 cost time: 17.7235586643219
Epoch: 19, Steps: 208 | Train Loss: 0.444 Vali Loss: 8.203 Vali Acc: 0.132 Test Loss: 8.203 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2466936
	speed: 0.2388s/iter; left time: 3999.3978s
	iters: 200, epoch: 20 | loss: 0.4527340
	speed: 0.0713s/iter; left time: 1187.3422s
Epoch: 20 cost time: 15.568502426147461
Epoch: 20, Steps: 208 | Train Loss: 0.397 Vali Loss: 9.203 Vali Acc: 0.129 Test Loss: 9.203 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2147594
	speed: 0.2795s/iter; left time: 4623.7031s
	iters: 200, epoch: 21 | loss: 0.3795477
	speed: 0.1110s/iter; left time: 1825.3073s
Epoch: 21 cost time: 23.55717658996582
Epoch: 21, Steps: 208 | Train Loss: 0.368 Vali Loss: 8.824 Vali Acc: 0.132 Test Loss: 8.824 Test Acc: 0.132
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4015844
	speed: 0.3087s/iter; left time: 5042.7259s
	iters: 200, epoch: 22 | loss: 0.7847723
	speed: 0.0978s/iter; left time: 1587.4045s
Epoch: 22 cost time: 21.891754388809204
Epoch: 22, Steps: 208 | Train Loss: 0.322 Vali Loss: 9.184 Vali Acc: 0.136 Test Loss: 9.184 Test Acc: 0.136
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1112916
	speed: 0.3001s/iter; left time: 4839.2572s
	iters: 200, epoch: 23 | loss: 0.1563314
	speed: 0.1098s/iter; left time: 1759.0745s
Epoch: 23 cost time: 23.045315265655518
Epoch: 23, Steps: 208 | Train Loss: 0.335 Vali Loss: 8.842 Vali Acc: 0.132 Test Loss: 8.842 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13808529674917983
model parameter : 1245607
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0897985
	speed: 0.0900s/iter; left time: 1862.3344s
	iters: 200, epoch: 1 | loss: 3.6445112
	speed: 0.0659s/iter; left time: 1357.0365s
Epoch: 1 cost time: 16.213274478912354
Epoch: 1, Steps: 208 | Train Loss: 4.149 Vali Loss: 3.656 Vali Acc: 0.055 Test Loss: 3.656 Test Acc: 0.055
Validation loss decreased (inf --> -0.055436).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4034209
	speed: 0.2350s/iter; left time: 4815.8798s
	iters: 200, epoch: 2 | loss: 3.2843523
	speed: 0.0815s/iter; left time: 1661.4859s
Epoch: 2 cost time: 18.118082284927368
Epoch: 2, Steps: 208 | Train Loss: 3.482 Vali Loss: 3.648 Vali Acc: 0.081 Test Loss: 3.648 Test Acc: 0.081
Validation loss decreased (-0.055436 --> -0.080787).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2392759
	speed: 0.2223s/iter; left time: 4509.7387s
	iters: 200, epoch: 3 | loss: 3.7895632
	speed: 0.0921s/iter; left time: 1858.5528s
Epoch: 3 cost time: 18.71852993965149
Epoch: 3, Steps: 208 | Train Loss: 3.391 Vali Loss: 3.622 Vali Acc: 0.093 Test Loss: 3.622 Test Acc: 0.093
Validation loss decreased (-0.080787 --> -0.093313).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4725351
	speed: 0.2259s/iter; left time: 4534.7867s
	iters: 200, epoch: 4 | loss: 4.6524353
	speed: 0.0770s/iter; left time: 1538.6296s
Epoch: 4 cost time: 16.23850917816162
Epoch: 4, Steps: 208 | Train Loss: 3.457 Vali Loss: 3.725 Vali Acc: 0.107 Test Loss: 3.725 Test Acc: 0.107
Validation loss decreased (-0.093313 --> -0.107329).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6103427
	speed: 0.2270s/iter; left time: 4510.3423s
	iters: 200, epoch: 5 | loss: 3.8355160
	speed: 0.0783s/iter; left time: 1548.5268s
Epoch: 5 cost time: 15.985136985778809
Epoch: 5, Steps: 208 | Train Loss: 3.460 Vali Loss: 4.192 Vali Acc: 0.101 Test Loss: 4.192 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.6256461
	speed: 0.2375s/iter; left time: 4668.8815s
	iters: 200, epoch: 6 | loss: 3.0206180
	speed: 0.0838s/iter; left time: 1638.4896s
Epoch: 6 cost time: 17.68286633491516
Epoch: 6, Steps: 208 | Train Loss: 3.439 Vali Loss: 4.430 Vali Acc: 0.108 Test Loss: 4.430 Test Acc: 0.108
Validation loss decreased (-0.107329 --> -0.107620).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0928004
	speed: 0.2177s/iter; left time: 4234.3938s
	iters: 200, epoch: 7 | loss: 3.1018436
	speed: 0.0744s/iter; left time: 1440.5691s
Epoch: 7 cost time: 15.823407649993896
Epoch: 7, Steps: 208 | Train Loss: 3.229 Vali Loss: 4.675 Vali Acc: 0.107 Test Loss: 4.675 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.6254032
	speed: 0.2545s/iter; left time: 4897.6266s
	iters: 200, epoch: 8 | loss: 3.0502758
	speed: 0.0922s/iter; left time: 1765.7847s
Epoch: 8 cost time: 20.381591796875
Epoch: 8, Steps: 208 | Train Loss: 2.944 Vali Loss: 5.219 Vali Acc: 0.104 Test Loss: 5.219 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.6422739
	speed: 0.2421s/iter; left time: 4609.6463s
	iters: 200, epoch: 9 | loss: 3.8560433
	speed: 0.0819s/iter; left time: 1550.8958s
Epoch: 9 cost time: 18.337238073349
Epoch: 9, Steps: 208 | Train Loss: 2.766 Vali Loss: 4.790 Vali Acc: 0.106 Test Loss: 4.790 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.4048088
	speed: 0.2354s/iter; left time: 4432.2460s
	iters: 200, epoch: 10 | loss: 2.6431117
	speed: 0.0849s/iter; left time: 1590.7531s
Epoch: 10 cost time: 18.381144285202026
Epoch: 10, Steps: 208 | Train Loss: 2.415 Vali Loss: 5.176 Vali Acc: 0.109 Test Loss: 5.176 Test Acc: 0.109
Validation loss decreased (-0.107620 --> -0.108806).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6576618
	speed: 0.2262s/iter; left time: 4212.2666s
	iters: 200, epoch: 11 | loss: 3.8087103
	speed: 0.0722s/iter; left time: 1337.2115s
Epoch: 11 cost time: 15.714559078216553
Epoch: 11, Steps: 208 | Train Loss: 2.071 Vali Loss: 6.559 Vali Acc: 0.114 Test Loss: 6.559 Test Acc: 0.114
Validation loss decreased (-0.108806 --> -0.113862).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4401425
	speed: 0.2287s/iter; left time: 4211.8047s
	iters: 200, epoch: 12 | loss: 2.3117735
	speed: 0.0794s/iter; left time: 1453.4704s
Epoch: 12 cost time: 16.614048719406128
Epoch: 12, Steps: 208 | Train Loss: 1.772 Vali Loss: 6.099 Vali Acc: 0.121 Test Loss: 6.099 Test Acc: 0.121
Validation loss decreased (-0.113862 --> -0.121025).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2285973
	speed: 0.2537s/iter; left time: 4619.5023s
	iters: 200, epoch: 13 | loss: 1.2842764
	speed: 0.0842s/iter; left time: 1523.9423s
Epoch: 13 cost time: 18.30019235610962
Epoch: 13, Steps: 208 | Train Loss: 1.440 Vali Loss: 6.114 Vali Acc: 0.123 Test Loss: 6.114 Test Acc: 0.123
Validation loss decreased (-0.121025 --> -0.122516).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8674304
	speed: 0.2608s/iter; left time: 4694.1853s
	iters: 200, epoch: 14 | loss: 0.8710893
	speed: 0.0790s/iter; left time: 1414.6369s
Epoch: 14 cost time: 17.68619704246521
Epoch: 14, Steps: 208 | Train Loss: 1.194 Vali Loss: 6.827 Vali Acc: 0.120 Test Loss: 6.827 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6704062
	speed: 0.2281s/iter; left time: 4058.2901s
	iters: 200, epoch: 15 | loss: 0.8815039
	speed: 0.0695s/iter; left time: 1228.5703s
Epoch: 15 cost time: 14.973044395446777
Epoch: 15, Steps: 208 | Train Loss: 0.996 Vali Loss: 7.527 Vali Acc: 0.120 Test Loss: 7.527 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0100430
	speed: 0.2495s/iter; left time: 4385.8757s
	iters: 200, epoch: 16 | loss: 1.6228448
	speed: 0.0839s/iter; left time: 1467.4547s
Epoch: 16 cost time: 17.9275963306427
Epoch: 16, Steps: 208 | Train Loss: 0.852 Vali Loss: 7.180 Vali Acc: 0.114 Test Loss: 7.180 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7785355
	speed: 0.2542s/iter; left time: 4416.2990s
	iters: 200, epoch: 17 | loss: 0.9380702
	speed: 0.0824s/iter; left time: 1422.6965s
Epoch: 17 cost time: 17.761911392211914
Epoch: 17, Steps: 208 | Train Loss: 0.706 Vali Loss: 7.579 Vali Acc: 0.120 Test Loss: 7.579 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.3802297
	speed: 0.2400s/iter; left time: 4119.7292s
	iters: 200, epoch: 18 | loss: 0.4655683
	speed: 0.0725s/iter; left time: 1236.7483s
Epoch: 18 cost time: 16.02033495903015
Epoch: 18, Steps: 208 | Train Loss: 0.651 Vali Loss: 7.852 Vali Acc: 0.114 Test Loss: 7.852 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3336764
	speed: 0.2347s/iter; left time: 3979.8673s
	iters: 200, epoch: 19 | loss: 0.5992969
	speed: 0.0790s/iter; left time: 1331.5886s
Epoch: 19 cost time: 17.027528047561646
Epoch: 19, Steps: 208 | Train Loss: 0.542 Vali Loss: 8.280 Vali Acc: 0.119 Test Loss: 8.280 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.5109698
	speed: 0.2458s/iter; left time: 4117.2833s
	iters: 200, epoch: 20 | loss: 0.7025747
	speed: 0.0814s/iter; left time: 1355.7782s
Epoch: 20 cost time: 17.007721662521362
Epoch: 20, Steps: 208 | Train Loss: 0.489 Vali Loss: 8.804 Vali Acc: 0.119 Test Loss: 8.804 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2114992
	speed: 0.2457s/iter; left time: 4063.4481s
	iters: 200, epoch: 21 | loss: 0.3554603
	speed: 0.0810s/iter; left time: 1331.9721s
Epoch: 21 cost time: 16.860915422439575
Epoch: 21, Steps: 208 | Train Loss: 0.446 Vali Loss: 8.665 Vali Acc: 0.117 Test Loss: 8.665 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3695425
	speed: 0.2419s/iter; left time: 3951.0396s
	iters: 200, epoch: 22 | loss: 0.4857107
	speed: 0.0711s/iter; left time: 1154.3111s
Epoch: 22 cost time: 15.290368795394897
Epoch: 22, Steps: 208 | Train Loss: 0.429 Vali Loss: 9.242 Vali Acc: 0.105 Test Loss: 9.242 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.8091747
	speed: 0.2246s/iter; left time: 3622.1659s
	iters: 200, epoch: 23 | loss: 0.4777137
	speed: 0.0724s/iter; left time: 1159.8349s
Epoch: 23 cost time: 15.614261150360107
Epoch: 23, Steps: 208 | Train Loss: 0.384 Vali Loss: 9.405 Vali Acc: 0.122 Test Loss: 9.405 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12257679689830003
model parameter : 862631
model size : 5.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0374260
	speed: 0.0912s/iter; left time: 1888.5764s
	iters: 200, epoch: 1 | loss: 4.2492161
	speed: 0.0578s/iter; left time: 1191.4067s
Epoch: 1 cost time: 15.542100667953491
Epoch: 1, Steps: 208 | Train Loss: 4.054 Vali Loss: 4.103 Vali Acc: 0.059 Test Loss: 4.103 Test Acc: 0.059
Validation loss decreased (inf --> -0.059309).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9900072
	speed: 0.2357s/iter; left time: 4830.1280s
	iters: 200, epoch: 2 | loss: 3.4035466
	speed: 0.0558s/iter; left time: 1138.0988s
Epoch: 2 cost time: 12.720446109771729
Epoch: 2, Steps: 208 | Train Loss: 3.523 Vali Loss: 3.599 Vali Acc: 0.075 Test Loss: 3.599 Test Acc: 0.075
Validation loss decreased (-0.059309 --> -0.074524).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1297226
	speed: 0.2207s/iter; left time: 4476.5488s
	iters: 200, epoch: 3 | loss: 3.6800442
	speed: 0.0550s/iter; left time: 1109.2870s
Epoch: 3 cost time: 11.938467741012573
Epoch: 3, Steps: 208 | Train Loss: 3.311 Vali Loss: 3.723 Vali Acc: 0.089 Test Loss: 3.723 Test Acc: 0.089
Validation loss decreased (-0.074524 --> -0.088838).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7175775
	speed: 0.2327s/iter; left time: 4671.2968s
	iters: 200, epoch: 4 | loss: 3.0834515
	speed: 0.0531s/iter; left time: 1061.4582s
Epoch: 4 cost time: 12.255553245544434
Epoch: 4, Steps: 208 | Train Loss: 3.310 Vali Loss: 4.071 Vali Acc: 0.073 Test Loss: 4.071 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.0494838
	speed: 0.2327s/iter; left time: 4624.4709s
	iters: 200, epoch: 5 | loss: 4.2353764
	speed: 0.0592s/iter; left time: 1171.2761s
Epoch: 5 cost time: 12.664372682571411
Epoch: 5, Steps: 208 | Train Loss: 3.254 Vali Loss: 3.808 Vali Acc: 0.101 Test Loss: 3.808 Test Acc: 0.101
Validation loss decreased (-0.088838 --> -0.100767).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7639463
	speed: 0.2509s/iter; left time: 4933.3564s
	iters: 200, epoch: 6 | loss: 3.4088929
	speed: 0.0581s/iter; left time: 1136.5109s
Epoch: 6 cost time: 12.698546171188354
Epoch: 6, Steps: 208 | Train Loss: 3.216 Vali Loss: 4.411 Vali Acc: 0.098 Test Loss: 4.411 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7414439
	speed: 0.2646s/iter; left time: 5147.9500s
	iters: 200, epoch: 7 | loss: 2.9674418
	speed: 0.0723s/iter; left time: 1399.2799s
Epoch: 7 cost time: 15.2156240940094
Epoch: 7, Steps: 208 | Train Loss: 3.042 Vali Loss: 4.532 Vali Acc: 0.101 Test Loss: 4.532 Test Acc: 0.101
Validation loss decreased (-0.100767 --> -0.101058).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5651641
	speed: 0.2754s/iter; left time: 5299.3930s
	iters: 200, epoch: 8 | loss: 3.5455961
	speed: 0.0694s/iter; left time: 1327.9006s
Epoch: 8 cost time: 14.616660118103027
Epoch: 8, Steps: 208 | Train Loss: 2.825 Vali Loss: 4.604 Vali Acc: 0.106 Test Loss: 4.604 Test Acc: 0.106
Validation loss decreased (-0.101058 --> -0.106426).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8007910
	speed: 0.2735s/iter; left time: 5206.6852s
	iters: 200, epoch: 9 | loss: 1.9684894
	speed: 0.0676s/iter; left time: 1280.5946s
Epoch: 9 cost time: 15.070098638534546
Epoch: 9, Steps: 208 | Train Loss: 2.554 Vali Loss: 6.354 Vali Acc: 0.114 Test Loss: 6.354 Test Acc: 0.114
Validation loss decreased (-0.106426 --> -0.113566).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9833210
	speed: 0.2770s/iter; left time: 5215.1914s
	iters: 200, epoch: 10 | loss: 2.8129997
	speed: 0.0590s/iter; left time: 1104.7343s
Epoch: 10 cost time: 13.777624607086182
Epoch: 10, Steps: 208 | Train Loss: 2.368 Vali Loss: 5.580 Vali Acc: 0.100 Test Loss: 5.580 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.6358733
	speed: 0.2523s/iter; left time: 4697.3329s
	iters: 200, epoch: 11 | loss: 1.3321850
	speed: 0.0530s/iter; left time: 981.5719s
Epoch: 11 cost time: 12.463568687438965
Epoch: 11, Steps: 208 | Train Loss: 2.088 Vali Loss: 5.892 Vali Acc: 0.112 Test Loss: 5.892 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.1927333
	speed: 0.2472s/iter; left time: 4551.1241s
	iters: 200, epoch: 12 | loss: 1.9462826
	speed: 0.0503s/iter; left time: 921.9205s
Epoch: 12 cost time: 11.946654558181763
Epoch: 12, Steps: 208 | Train Loss: 1.736 Vali Loss: 6.199 Vali Acc: 0.107 Test Loss: 6.199 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9233370
	speed: 0.2393s/iter; left time: 4356.6572s
	iters: 200, epoch: 13 | loss: 1.4365600
	speed: 0.0634s/iter; left time: 1147.9951s
Epoch: 13 cost time: 15.007577657699585
Epoch: 13, Steps: 208 | Train Loss: 1.467 Vali Loss: 6.278 Vali Acc: 0.119 Test Loss: 6.278 Test Acc: 0.119
Validation loss decreased (-0.113566 --> -0.119233).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8138577
	speed: 0.2772s/iter; left time: 4988.5355s
	iters: 200, epoch: 14 | loss: 1.0019323
	speed: 0.0765s/iter; left time: 1368.4964s
Epoch: 14 cost time: 16.889342784881592
Epoch: 14, Steps: 208 | Train Loss: 1.192 Vali Loss: 7.090 Vali Acc: 0.112 Test Loss: 7.090 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1249399
	speed: 0.2793s/iter; left time: 4968.6909s
	iters: 200, epoch: 15 | loss: 1.8458343
	speed: 0.0756s/iter; left time: 1338.0971s
Epoch: 15 cost time: 16.734206438064575
Epoch: 15, Steps: 208 | Train Loss: 1.059 Vali Loss: 7.129 Vali Acc: 0.112 Test Loss: 7.129 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4970055
	speed: 0.2836s/iter; left time: 4985.8251s
	iters: 200, epoch: 16 | loss: 1.2966286
	speed: 0.0785s/iter; left time: 1372.6587s
Epoch: 16 cost time: 16.868316173553467
Epoch: 16, Steps: 208 | Train Loss: 0.892 Vali Loss: 7.232 Vali Acc: 0.117 Test Loss: 7.232 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9231789
	speed: 0.2959s/iter; left time: 5141.5141s
	iters: 200, epoch: 17 | loss: 0.9099379
	speed: 0.0756s/iter; left time: 1306.5041s
Epoch: 17 cost time: 16.39470410346985
Epoch: 17, Steps: 208 | Train Loss: 0.736 Vali Loss: 7.755 Vali Acc: 0.111 Test Loss: 7.755 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3591058
	speed: 0.2733s/iter; left time: 4691.3704s
	iters: 200, epoch: 18 | loss: 1.0100554
	speed: 0.0677s/iter; left time: 1155.4944s
Epoch: 18 cost time: 14.796404600143433
Epoch: 18, Steps: 208 | Train Loss: 0.635 Vali Loss: 8.308 Vali Acc: 0.112 Test Loss: 8.308 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4540277
	speed: 0.2676s/iter; left time: 4537.4629s
	iters: 200, epoch: 19 | loss: 0.1844363
	speed: 0.0685s/iter; left time: 1155.5287s
Epoch: 19 cost time: 15.301682949066162
Epoch: 19, Steps: 208 | Train Loss: 0.602 Vali Loss: 8.412 Vali Acc: 0.118 Test Loss: 8.412 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3314927
	speed: 0.2639s/iter; left time: 4419.6226s
	iters: 200, epoch: 20 | loss: 0.9876823
	speed: 0.0662s/iter; left time: 1101.8704s
Epoch: 20 cost time: 15.108094692230225
Epoch: 20, Steps: 208 | Train Loss: 0.516 Vali Loss: 8.997 Vali Acc: 0.103 Test Loss: 8.997 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.3155364
	speed: 0.2798s/iter; left time: 4628.0662s
	iters: 200, epoch: 21 | loss: 0.5193029
	speed: 0.0702s/iter; left time: 1153.6367s
Epoch: 21 cost time: 15.554412841796875
Epoch: 21, Steps: 208 | Train Loss: 0.474 Vali Loss: 8.985 Vali Acc: 0.117 Test Loss: 8.985 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2475899
	speed: 0.2730s/iter; left time: 4459.6319s
	iters: 200, epoch: 22 | loss: 0.2276024
	speed: 0.0768s/iter; left time: 1247.3757s
Epoch: 22 cost time: 16.46108603477478
Epoch: 22, Steps: 208 | Train Loss: 0.424 Vali Loss: 9.829 Vali Acc: 0.111 Test Loss: 9.829 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1929332
	speed: 0.3229s/iter; left time: 5206.5539s
	iters: 200, epoch: 23 | loss: 0.3812298
	speed: 0.0924s/iter; left time: 1480.6404s
Epoch: 23 cost time: 21.11690330505371
Epoch: 23, Steps: 208 | Train Loss: 0.380 Vali Loss: 9.769 Vali Acc: 0.111 Test Loss: 9.769 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11929615269907545
model parameter : 699303
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3256063
	speed: 0.1161s/iter; left time: 2403.8057s
	iters: 200, epoch: 1 | loss: 3.9471314
	speed: 0.0912s/iter; left time: 1878.9360s
Epoch: 1 cost time: 21.581974267959595
Epoch: 1, Steps: 208 | Train Loss: 3.989 Vali Loss: 4.235 Vali Acc: 0.049 Test Loss: 4.235 Test Acc: 0.049
Validation loss decreased (inf --> -0.049167).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4229426
	speed: 0.2833s/iter; left time: 5806.3452s
	iters: 200, epoch: 2 | loss: 4.1174598
	speed: 0.0744s/iter; left time: 1517.9482s
Epoch: 2 cost time: 16.451883792877197
Epoch: 2, Steps: 208 | Train Loss: 3.616 Vali Loss: 3.670 Vali Acc: 0.068 Test Loss: 3.670 Test Acc: 0.068
Validation loss decreased (-0.049167 --> -0.067664).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7215040
	speed: 0.2950s/iter; left time: 5984.9235s
	iters: 200, epoch: 3 | loss: 3.7266405
	speed: 0.0716s/iter; left time: 1445.9844s
Epoch: 3 cost time: 17.768505811691284
Epoch: 3, Steps: 208 | Train Loss: 3.353 Vali Loss: 3.572 Vali Acc: 0.086 Test Loss: 3.572 Test Acc: 0.086
Validation loss decreased (-0.067664 --> -0.086156).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6304326
	speed: 0.2944s/iter; left time: 5910.4671s
	iters: 200, epoch: 4 | loss: 2.6530287
	speed: 0.0890s/iter; left time: 1777.3686s
Epoch: 4 cost time: 19.60889220237732
Epoch: 4, Steps: 208 | Train Loss: 3.293 Vali Loss: 3.781 Vali Acc: 0.091 Test Loss: 3.781 Test Acc: 0.091
Validation loss decreased (-0.086156 --> -0.091224).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3835051
	speed: 0.2700s/iter; left time: 5364.2439s
	iters: 200, epoch: 5 | loss: 2.4558372
	speed: 0.0828s/iter; left time: 1637.2940s
Epoch: 5 cost time: 17.4000403881073
Epoch: 5, Steps: 208 | Train Loss: 3.145 Vali Loss: 3.788 Vali Acc: 0.107 Test Loss: 3.788 Test Acc: 0.107
Validation loss decreased (-0.091224 --> -0.106732).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1714175
	speed: 0.3017s/iter; left time: 5930.9878s
	iters: 200, epoch: 6 | loss: 3.6117768
	speed: 0.0850s/iter; left time: 1662.6406s
Epoch: 6 cost time: 17.30782198905945
Epoch: 6, Steps: 208 | Train Loss: 3.042 Vali Loss: 4.504 Vali Acc: 0.103 Test Loss: 4.504 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5668240
	speed: 0.2926s/iter; left time: 5692.6531s
	iters: 200, epoch: 7 | loss: 3.3075831
	speed: 0.0804s/iter; left time: 1555.7165s
Epoch: 7 cost time: 15.78516936302185
Epoch: 7, Steps: 208 | Train Loss: 2.892 Vali Loss: 4.492 Vali Acc: 0.101 Test Loss: 4.492 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.1467924
	speed: 0.2693s/iter; left time: 5183.5521s
	iters: 200, epoch: 8 | loss: 2.0680270
	speed: 0.0554s/iter; left time: 1060.8022s
Epoch: 8 cost time: 12.49237608909607
Epoch: 8, Steps: 208 | Train Loss: 2.671 Vali Loss: 4.762 Vali Acc: 0.100 Test Loss: 4.762 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.7463853
	speed: 0.2659s/iter; left time: 5062.8113s
	iters: 200, epoch: 9 | loss: 2.3343906
	speed: 0.0571s/iter; left time: 1080.6543s
Epoch: 9 cost time: 14.883652925491333
Epoch: 9, Steps: 208 | Train Loss: 2.429 Vali Loss: 5.642 Vali Acc: 0.098 Test Loss: 5.642 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.7762604
	speed: 0.2572s/iter; left time: 4842.9264s
	iters: 200, epoch: 10 | loss: 2.2242639
	speed: 0.0726s/iter; left time: 1360.6077s
Epoch: 10 cost time: 16.2674241065979
Epoch: 10, Steps: 208 | Train Loss: 2.127 Vali Loss: 6.286 Vali Acc: 0.108 Test Loss: 6.286 Test Acc: 0.108
Validation loss decreased (-0.106732 --> -0.107602).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4199648
	speed: 0.2756s/iter; left time: 5131.1065s
	iters: 200, epoch: 11 | loss: 3.1730266
	speed: 0.0758s/iter; left time: 1403.9164s
Epoch: 11 cost time: 16.430114269256592
Epoch: 11, Steps: 208 | Train Loss: 1.909 Vali Loss: 6.676 Vali Acc: 0.111 Test Loss: 6.676 Test Acc: 0.111
Validation loss decreased (-0.107602 --> -0.111177).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2166909
	speed: 0.2759s/iter; left time: 5079.8023s
	iters: 200, epoch: 12 | loss: 1.7681170
	speed: 0.0778s/iter; left time: 1424.7551s
Epoch: 12 cost time: 16.61234140396118
Epoch: 12, Steps: 208 | Train Loss: 1.627 Vali Loss: 6.124 Vali Acc: 0.114 Test Loss: 6.124 Test Acc: 0.114
Validation loss decreased (-0.111177 --> -0.113867).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4846790
	speed: 0.2825s/iter; left time: 5143.1073s
	iters: 200, epoch: 13 | loss: 1.6032953
	speed: 0.0787s/iter; left time: 1424.5140s
Epoch: 13 cost time: 15.817736387252808
Epoch: 13, Steps: 208 | Train Loss: 1.421 Vali Loss: 7.020 Vali Acc: 0.107 Test Loss: 7.020 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8299019
	speed: 0.2761s/iter; left time: 4968.2223s
	iters: 200, epoch: 14 | loss: 0.7240487
	speed: 0.0644s/iter; left time: 1153.2748s
Epoch: 14 cost time: 13.915351629257202
Epoch: 14, Steps: 208 | Train Loss: 1.197 Vali Loss: 6.948 Vali Acc: 0.111 Test Loss: 6.948 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7690470
	speed: 0.2637s/iter; left time: 4691.4249s
	iters: 200, epoch: 15 | loss: 1.1421356
	speed: 0.0541s/iter; left time: 956.8632s
Epoch: 15 cost time: 12.389020681381226
Epoch: 15, Steps: 208 | Train Loss: 1.023 Vali Loss: 7.361 Vali Acc: 0.109 Test Loss: 7.361 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4389790
	speed: 0.2912s/iter; left time: 5119.6545s
	iters: 200, epoch: 16 | loss: 0.7911521
	speed: 0.0534s/iter; left time: 934.2741s
Epoch: 16 cost time: 14.22392749786377
Epoch: 16, Steps: 208 | Train Loss: 0.868 Vali Loss: 7.473 Vali Acc: 0.107 Test Loss: 7.473 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3566839
	speed: 0.2811s/iter; left time: 4882.7300s
	iters: 200, epoch: 17 | loss: 0.5350153
	speed: 0.0866s/iter; left time: 1495.9076s
Epoch: 17 cost time: 17.497363328933716
Epoch: 17, Steps: 208 | Train Loss: 0.782 Vali Loss: 8.419 Vali Acc: 0.118 Test Loss: 8.419 Test Acc: 0.118
Validation loss decreased (-0.113867 --> -0.117721).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4620946
	speed: 0.2932s/iter; left time: 5033.6317s
	iters: 200, epoch: 18 | loss: 1.5016003
	speed: 0.0984s/iter; left time: 1679.3659s
Epoch: 18 cost time: 20.04823088645935
Epoch: 18, Steps: 208 | Train Loss: 0.704 Vali Loss: 8.506 Vali Acc: 0.114 Test Loss: 8.506 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2556861
	speed: 0.3281s/iter; left time: 5562.9923s
	iters: 200, epoch: 19 | loss: 0.7510488
	speed: 0.1066s/iter; left time: 1797.6758s
Epoch: 19 cost time: 23.136754751205444
Epoch: 19, Steps: 208 | Train Loss: 0.640 Vali Loss: 9.111 Vali Acc: 0.108 Test Loss: 9.111 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2657151
	speed: 0.3112s/iter; left time: 5212.7605s
	iters: 200, epoch: 20 | loss: 0.9876129
	speed: 0.1132s/iter; left time: 1885.2246s
Epoch: 20 cost time: 22.0954167842865
Epoch: 20, Steps: 208 | Train Loss: 0.557 Vali Loss: 9.290 Vali Acc: 0.119 Test Loss: 9.290 Test Acc: 0.119
Validation loss decreased (-0.117721 --> -0.118607).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3220804
	speed: 0.3483s/iter; left time: 5761.8884s
	iters: 200, epoch: 21 | loss: 0.5357371
	speed: 0.0853s/iter; left time: 1402.0530s
Epoch: 21 cost time: 20.611095666885376
Epoch: 21, Steps: 208 | Train Loss: 0.504 Vali Loss: 9.580 Vali Acc: 0.111 Test Loss: 9.580 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.9866585
	speed: 0.3252s/iter; left time: 5311.1005s
	iters: 200, epoch: 22 | loss: 0.7144744
	speed: 0.0862s/iter; left time: 1399.7434s
Epoch: 22 cost time: 19.709163665771484
Epoch: 22, Steps: 208 | Train Loss: 0.488 Vali Loss: 9.808 Vali Acc: 0.115 Test Loss: 9.808 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5008458
	speed: 0.2940s/iter; left time: 4740.0006s
	iters: 200, epoch: 23 | loss: 0.4511314
	speed: 0.0939s/iter; left time: 1505.3207s
Epoch: 23 cost time: 20.37653398513794
Epoch: 23, Steps: 208 | Train Loss: 0.453 Vali Loss: 10.153 Vali Acc: 0.104 Test Loss: 10.153 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.6596017
	speed: 0.3242s/iter; left time: 5160.2382s
	iters: 200, epoch: 24 | loss: 0.6498503
	speed: 0.1008s/iter; left time: 1595.1185s
Epoch: 24 cost time: 22.749932050704956
Epoch: 24, Steps: 208 | Train Loss: 0.426 Vali Loss: 10.216 Vali Acc: 0.115 Test Loss: 10.216 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1670613
	speed: 0.3234s/iter; left time: 5080.0697s
	iters: 200, epoch: 25 | loss: 0.4536332
	speed: 0.0997s/iter; left time: 1556.3397s
Epoch: 25 cost time: 20.909791707992554
Epoch: 25, Steps: 208 | Train Loss: 0.395 Vali Loss: 10.639 Vali Acc: 0.106 Test Loss: 10.639 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.6668930
	speed: 0.3216s/iter; left time: 4985.6182s
	iters: 200, epoch: 26 | loss: 0.3742675
	speed: 0.0846s/iter; left time: 1303.3481s
Epoch: 26 cost time: 20.134673595428467
Epoch: 26, Steps: 208 | Train Loss: 0.400 Vali Loss: 10.409 Vali Acc: 0.113 Test Loss: 10.409 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.4046794
	speed: 0.2999s/iter; left time: 4585.8214s
	iters: 200, epoch: 27 | loss: 0.4468095
	speed: 0.0861s/iter; left time: 1308.6805s
Epoch: 27 cost time: 19.26343607902527
Epoch: 27, Steps: 208 | Train Loss: 0.358 Vali Loss: 10.877 Vali Acc: 0.114 Test Loss: 10.877 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.4865930
	speed: 0.3076s/iter; left time: 4639.6679s
	iters: 200, epoch: 28 | loss: 0.2010681
	speed: 0.0974s/iter; left time: 1459.2914s
Epoch: 28 cost time: 20.81097722053528
Epoch: 28, Steps: 208 | Train Loss: 0.366 Vali Loss: 10.423 Vali Acc: 0.115 Test Loss: 10.423 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0906031
	speed: 0.3244s/iter; left time: 4825.6447s
	iters: 200, epoch: 29 | loss: 0.8810510
	speed: 0.0969s/iter; left time: 1431.9502s
Epoch: 29 cost time: 20.542680501937866
Epoch: 29, Steps: 208 | Train Loss: 0.337 Vali Loss: 11.201 Vali Acc: 0.113 Test Loss: 11.201 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1531863
	speed: 0.3124s/iter; left time: 4582.7427s
	iters: 200, epoch: 30 | loss: 0.2391792
	speed: 0.0903s/iter; left time: 1315.9463s
Epoch: 30 cost time: 19.024797201156616
Epoch: 30, Steps: 208 | Train Loss: 0.362 Vali Loss: 11.825 Vali Acc: 0.109 Test Loss: 11.825 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11869967193558008
model parameter : 590887
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7305527
	speed: 0.1498s/iter; left time: 3100.3561s
	iters: 200, epoch: 1 | loss: 3.9507124
	speed: 0.1258s/iter; left time: 2591.9223s
Epoch: 1 cost time: 28.640289783477783
Epoch: 1, Steps: 208 | Train Loss: 4.938 Vali Loss: 4.187 Vali Acc: 0.057 Test Loss: 4.187 Test Acc: 0.057
Validation loss decreased (inf --> -0.057220).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5841970
	speed: 0.4270s/iter; left time: 8750.9327s
	iters: 200, epoch: 2 | loss: 5.4375157
	speed: 0.1060s/iter; left time: 2162.3936s
Epoch: 2 cost time: 23.102661848068237
Epoch: 2, Steps: 208 | Train Loss: 4.317 Vali Loss: 3.772 Vali Acc: 0.085 Test Loss: 3.772 Test Acc: 0.085
Validation loss decreased (-0.057220 --> -0.084961).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.7504678
	speed: 0.3971s/iter; left time: 8055.8439s
	iters: 200, epoch: 3 | loss: 6.7453189
	speed: 0.0952s/iter; left time: 1921.3576s
Epoch: 3 cost time: 22.91681933403015
Epoch: 3, Steps: 208 | Train Loss: 5.083 Vali Loss: 5.142 Vali Acc: 0.077 Test Loss: 5.142 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.5574546
	speed: 0.3840s/iter; left time: 7709.5582s
	iters: 200, epoch: 4 | loss: 6.1230087
	speed: 0.1002s/iter; left time: 2001.0370s
Epoch: 4 cost time: 22.76941227912903
Epoch: 4, Steps: 208 | Train Loss: 5.800 Vali Loss: 5.433 Vali Acc: 0.101 Test Loss: 5.433 Test Acc: 0.101
Validation loss decreased (-0.084961 --> -0.100453).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.1807303
	speed: 0.3628s/iter; left time: 7209.0314s
	iters: 200, epoch: 5 | loss: 7.9123125
	speed: 0.0957s/iter; left time: 1892.1598s
Epoch: 5 cost time: 21.77426791191101
Epoch: 5, Steps: 208 | Train Loss: 5.979 Vali Loss: 6.332 Vali Acc: 0.071 Test Loss: 6.332 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 6.6666827
	speed: 0.3583s/iter; left time: 7045.3995s
	iters: 200, epoch: 6 | loss: 5.0441022
	speed: 0.1016s/iter; left time: 1987.4506s
Epoch: 6 cost time: 22.202444076538086
Epoch: 6, Steps: 208 | Train Loss: 6.100 Vali Loss: 5.973 Vali Acc: 0.096 Test Loss: 5.973 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 6.2358799
	speed: 0.3855s/iter; left time: 7499.2896s
	iters: 200, epoch: 7 | loss: 5.4465523
	speed: 0.0966s/iter; left time: 1870.4315s
Epoch: 7 cost time: 22.034422874450684
Epoch: 7, Steps: 208 | Train Loss: 5.413 Vali Loss: 6.071 Vali Acc: 0.118 Test Loss: 6.071 Test Acc: 0.118
Validation loss decreased (-0.100453 --> -0.117446).  Saving model ...
	iters: 100, epoch: 8 | loss: 6.0178990
	speed: 0.3753s/iter; left time: 7222.0722s
	iters: 200, epoch: 8 | loss: 3.4260585
	speed: 0.0953s/iter; left time: 1825.4369s
Epoch: 8 cost time: 21.10101628303528
Epoch: 8, Steps: 208 | Train Loss: 4.827 Vali Loss: 7.075 Vali Acc: 0.118 Test Loss: 7.075 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 4.6832433
	speed: 0.3827s/iter; left time: 7286.2307s
	iters: 200, epoch: 9 | loss: 3.8641708
	speed: 0.0941s/iter; left time: 1782.1386s
Epoch: 9 cost time: 20.310624599456787
Epoch: 9, Steps: 208 | Train Loss: 3.927 Vali Loss: 7.159 Vali Acc: 0.108 Test Loss: 7.159 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.8750143
	speed: 0.3622s/iter; left time: 6819.3622s
	iters: 200, epoch: 10 | loss: 3.5635495
	speed: 0.0958s/iter; left time: 1794.9371s
Epoch: 10 cost time: 19.87462544441223
Epoch: 10, Steps: 208 | Train Loss: 2.731 Vali Loss: 8.880 Vali Acc: 0.095 Test Loss: 8.880 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6418148
	speed: 0.3714s/iter; left time: 6915.3212s
	iters: 200, epoch: 11 | loss: 2.4109957
	speed: 0.0953s/iter; left time: 1764.6391s
Epoch: 11 cost time: 20.125725269317627
Epoch: 11, Steps: 208 | Train Loss: 1.784 Vali Loss: 6.481 Vali Acc: 0.110 Test Loss: 6.481 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5485287
	speed: 0.3822s/iter; left time: 7036.6100s
	iters: 200, epoch: 12 | loss: 1.5789711
	speed: 0.0931s/iter; left time: 1704.4085s
Epoch: 12 cost time: 20.06985878944397
Epoch: 12, Steps: 208 | Train Loss: 1.302 Vali Loss: 7.388 Vali Acc: 0.109 Test Loss: 7.388 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3211632
	speed: 0.3794s/iter; left time: 6907.2913s
	iters: 200, epoch: 13 | loss: 1.1155341
	speed: 0.0986s/iter; left time: 1785.0298s
Epoch: 13 cost time: 20.898621797561646
Epoch: 13, Steps: 208 | Train Loss: 1.038 Vali Loss: 7.410 Vali Acc: 0.112 Test Loss: 7.410 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.4713163
	speed: 0.3669s/iter; left time: 6603.0557s
	iters: 200, epoch: 14 | loss: 0.3054906
	speed: 0.0883s/iter; left time: 1581.0025s
Epoch: 14 cost time: 18.959903240203857
Epoch: 14, Steps: 208 | Train Loss: 0.844 Vali Loss: 7.265 Vali Acc: 0.103 Test Loss: 7.265 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.3017475
	speed: 0.4031s/iter; left time: 7170.4571s
	iters: 200, epoch: 15 | loss: 0.8364245
	speed: 0.1020s/iter; left time: 1804.4265s
Epoch: 15 cost time: 22.263813257217407
Epoch: 15, Steps: 208 | Train Loss: 0.660 Vali Loss: 7.934 Vali Acc: 0.121 Test Loss: 7.934 Test Acc: 0.121
Validation loss decreased (-0.117446 --> -0.121006).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5982331
	speed: 0.4121s/iter; left time: 7245.2209s
	iters: 200, epoch: 16 | loss: 1.4906262
	speed: 0.1101s/iter; left time: 1925.3415s
Epoch: 16 cost time: 23.952797651290894
Epoch: 16, Steps: 208 | Train Loss: 0.585 Vali Loss: 8.127 Vali Acc: 0.109 Test Loss: 8.127 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1161498
	speed: 0.4418s/iter; left time: 7674.6313s
	iters: 200, epoch: 17 | loss: 0.2696660
	speed: 0.1131s/iter; left time: 1954.0164s
Epoch: 17 cost time: 24.727264404296875
Epoch: 17, Steps: 208 | Train Loss: 0.450 Vali Loss: 8.708 Vali Acc: 0.118 Test Loss: 8.708 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4944863
	speed: 0.4477s/iter; left time: 7684.5350s
	iters: 200, epoch: 18 | loss: 0.1429384
	speed: 0.1130s/iter; left time: 1928.6431s
Epoch: 18 cost time: 25.048685312271118
Epoch: 18, Steps: 208 | Train Loss: 0.361 Vali Loss: 9.513 Vali Acc: 0.124 Test Loss: 9.513 Test Acc: 0.124
Validation loss decreased (-0.121006 --> -0.124271).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1041166
	speed: 0.4247s/iter; left time: 7200.8973s
	iters: 200, epoch: 19 | loss: 0.8477502
	speed: 0.0977s/iter; left time: 1647.1474s
Epoch: 19 cost time: 21.75503706932068
Epoch: 19, Steps: 208 | Train Loss: 0.340 Vali Loss: 8.724 Vali Acc: 0.116 Test Loss: 8.724 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.2948335
	speed: 0.4179s/iter; left time: 6998.8557s
	iters: 200, epoch: 20 | loss: 0.1422604
	speed: 0.0952s/iter; left time: 1584.8342s
Epoch: 20 cost time: 22.06499218940735
Epoch: 20, Steps: 208 | Train Loss: 0.256 Vali Loss: 10.591 Vali Acc: 0.113 Test Loss: 10.591 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1521672
	speed: 0.4155s/iter; left time: 6872.0401s
	iters: 200, epoch: 21 | loss: 0.5248382
	speed: 0.1014s/iter; left time: 1666.8226s
Epoch: 21 cost time: 22.963334321975708
Epoch: 21, Steps: 208 | Train Loss: 0.244 Vali Loss: 10.146 Vali Acc: 0.136 Test Loss: 10.146 Test Acc: 0.136
Validation loss decreased (-0.124271 --> -0.135598).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0395982
	speed: 0.4274s/iter; left time: 6980.5842s
	iters: 200, epoch: 22 | loss: 0.1149440
	speed: 0.1142s/iter; left time: 1853.1003s
Epoch: 22 cost time: 24.840770721435547
Epoch: 22, Steps: 208 | Train Loss: 0.232 Vali Loss: 10.625 Vali Acc: 0.117 Test Loss: 10.625 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2596915
	speed: 0.4331s/iter; left time: 6983.2652s
	iters: 200, epoch: 23 | loss: 0.5232278
	speed: 0.1190s/iter; left time: 1907.6940s
Epoch: 23 cost time: 25.79000759124756
Epoch: 23, Steps: 208 | Train Loss: 0.203 Vali Loss: 10.847 Vali Acc: 0.127 Test Loss: 10.847 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0516594
	speed: 0.4239s/iter; left time: 6747.6566s
	iters: 200, epoch: 24 | loss: 0.2903813
	speed: 0.1106s/iter; left time: 1749.7983s
Epoch: 24 cost time: 24.27114963531494
Epoch: 24, Steps: 208 | Train Loss: 0.180 Vali Loss: 11.814 Vali Acc: 0.115 Test Loss: 11.814 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0563370
	speed: 0.4274s/iter; left time: 6713.9976s
	iters: 200, epoch: 25 | loss: 0.0494355
	speed: 0.1100s/iter; left time: 1716.4286s
Epoch: 25 cost time: 24.11512303352356
Epoch: 25, Steps: 208 | Train Loss: 0.180 Vali Loss: 12.090 Vali Acc: 0.123 Test Loss: 12.090 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.2149484
	speed: 0.4573s/iter; left time: 7087.9407s
	iters: 200, epoch: 26 | loss: 0.0654862
	speed: 0.1224s/iter; left time: 1885.8141s
Epoch: 26 cost time: 26.468857526779175
Epoch: 26, Steps: 208 | Train Loss: 0.161 Vali Loss: 11.667 Vali Acc: 0.111 Test Loss: 11.667 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0653129
	speed: 0.4321s/iter; left time: 6608.7111s
	iters: 200, epoch: 27 | loss: 0.2852284
	speed: 0.1065s/iter; left time: 1617.4599s
Epoch: 27 cost time: 23.766879320144653
Epoch: 27, Steps: 208 | Train Loss: 0.174 Vali Loss: 12.636 Vali Acc: 0.114 Test Loss: 12.636 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0567200
	speed: 0.4068s/iter; left time: 6136.0086s
	iters: 200, epoch: 28 | loss: 0.4078992
	speed: 0.0938s/iter; left time: 1406.0538s
Epoch: 28 cost time: 21.358957767486572
Epoch: 28, Steps: 208 | Train Loss: 0.133 Vali Loss: 11.918 Vali Acc: 0.109 Test Loss: 11.918 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0747892
	speed: 0.3938s/iter; left time: 5858.6319s
	iters: 200, epoch: 29 | loss: 0.1311624
	speed: 0.0930s/iter; left time: 1373.9815s
Epoch: 29 cost time: 20.167606353759766
Epoch: 29, Steps: 208 | Train Loss: 0.142 Vali Loss: 13.052 Vali Acc: 0.113 Test Loss: 13.052 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0216094
	speed: 0.3867s/iter; left time: 5673.0717s
	iters: 200, epoch: 30 | loss: 0.0139721
	speed: 0.1019s/iter; left time: 1483.8789s
Epoch: 30 cost time: 22.17894697189331
Epoch: 30, Steps: 208 | Train Loss: 0.125 Vali Loss: 12.198 Vali Acc: 0.116 Test Loss: 12.198 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0075783
	speed: 0.3872s/iter; left time: 5599.3781s
	iters: 200, epoch: 31 | loss: 0.0165662
	speed: 0.1014s/iter; left time: 1455.7923s
Epoch: 31 cost time: 21.64476728439331
Epoch: 31, Steps: 208 | Train Loss: 0.132 Vali Loss: 13.435 Vali Acc: 0.112 Test Loss: 13.435 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13569937369519833
model parameter : 4120999
model size : 18.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.0792336
	speed: 0.0963s/iter; left time: 1993.5000s
	iters: 200, epoch: 1 | loss: 3.8659575
	speed: 0.0496s/iter; left time: 1021.1706s
Epoch: 1 cost time: 15.272051095962524
Epoch: 1, Steps: 208 | Train Loss: 4.434 Vali Loss: 3.895 Vali Acc: 0.047 Test Loss: 3.895 Test Acc: 0.047
Validation loss decreased (inf --> -0.046487).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1045804
	speed: 0.2713s/iter; left time: 5559.3002s
	iters: 200, epoch: 2 | loss: 4.2361064
	speed: 0.0641s/iter; left time: 1307.0566s
Epoch: 2 cost time: 14.493091344833374
Epoch: 2, Steps: 208 | Train Loss: 3.751 Vali Loss: 3.897 Vali Acc: 0.074 Test Loss: 3.897 Test Acc: 0.074
Validation loss decreased (-0.046487 --> -0.074223).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2725835
	speed: 0.2868s/iter; left time: 5817.3862s
	iters: 200, epoch: 3 | loss: 4.2449236
	speed: 0.0688s/iter; left time: 1389.3138s
Epoch: 3 cost time: 14.985608339309692
Epoch: 3, Steps: 208 | Train Loss: 4.156 Vali Loss: 3.948 Vali Acc: 0.106 Test Loss: 3.948 Test Acc: 0.106
Validation loss decreased (-0.074223 --> -0.105836).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.5875463
	speed: 0.3059s/iter; left time: 6140.6013s
	iters: 200, epoch: 4 | loss: 3.7804430
	speed: 0.0804s/iter; left time: 1605.6985s
Epoch: 4 cost time: 17.26714825630188
Epoch: 4, Steps: 208 | Train Loss: 4.458 Vali Loss: 4.387 Vali Acc: 0.102 Test Loss: 4.387 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.1570272
	speed: 0.3164s/iter; left time: 6286.6453s
	iters: 200, epoch: 5 | loss: 3.6639755
	speed: 0.0840s/iter; left time: 1661.1079s
Epoch: 5 cost time: 17.98011803627014
Epoch: 5, Steps: 208 | Train Loss: 4.628 Vali Loss: 5.498 Vali Acc: 0.071 Test Loss: 5.498 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 5.1800504
	speed: 0.3262s/iter; left time: 6413.4356s
	iters: 200, epoch: 6 | loss: 4.7020187
	speed: 0.0867s/iter; left time: 1695.7524s
Epoch: 6 cost time: 18.634448289871216
Epoch: 6, Steps: 208 | Train Loss: 4.590 Vali Loss: 5.132 Vali Acc: 0.112 Test Loss: 5.132 Test Acc: 0.112
Validation loss decreased (-0.105836 --> -0.112087).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4601033
	speed: 0.3128s/iter; left time: 6085.8661s
	iters: 200, epoch: 7 | loss: 5.0341063
	speed: 0.0845s/iter; left time: 1634.4337s
Epoch: 7 cost time: 18.37428116798401
Epoch: 7, Steps: 208 | Train Loss: 4.285 Vali Loss: 6.494 Vali Acc: 0.121 Test Loss: 6.494 Test Acc: 0.121
Validation loss decreased (-0.112087 --> -0.120722).  Saving model ...
	iters: 100, epoch: 8 | loss: 4.1608281
	speed: 0.3205s/iter; left time: 6167.1173s
	iters: 200, epoch: 8 | loss: 3.0661664
	speed: 0.0840s/iter; left time: 1607.3825s
Epoch: 8 cost time: 18.115444660186768
Epoch: 8, Steps: 208 | Train Loss: 3.866 Vali Loss: 5.471 Vali Acc: 0.115 Test Loss: 5.471 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 4.5463271
	speed: 0.3272s/iter; left time: 6228.3458s
	iters: 200, epoch: 9 | loss: 4.3145976
	speed: 0.0829s/iter; left time: 1569.7490s
Epoch: 9 cost time: 18.07660961151123
Epoch: 9, Steps: 208 | Train Loss: 3.314 Vali Loss: 5.724 Vali Acc: 0.133 Test Loss: 5.724 Test Acc: 0.133
Validation loss decreased (-0.120722 --> -0.132660).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2067714
	speed: 0.3274s/iter; left time: 6163.8228s
	iters: 200, epoch: 10 | loss: 2.6156693
	speed: 0.0849s/iter; left time: 1590.7688s
Epoch: 10 cost time: 18.424030780792236
Epoch: 10, Steps: 208 | Train Loss: 2.594 Vali Loss: 6.580 Vali Acc: 0.100 Test Loss: 6.580 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4269301
	speed: 0.3212s/iter; left time: 5980.8045s
	iters: 200, epoch: 11 | loss: 1.6762052
	speed: 0.0787s/iter; left time: 1457.3589s
Epoch: 11 cost time: 17.442116737365723
Epoch: 11, Steps: 208 | Train Loss: 1.986 Vali Loss: 6.317 Vali Acc: 0.112 Test Loss: 6.317 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8467491
	speed: 0.3184s/iter; left time: 5863.0841s
	iters: 200, epoch: 12 | loss: 2.0906904
	speed: 0.0822s/iter; left time: 1506.0020s
Epoch: 12 cost time: 18.025165557861328
Epoch: 12, Steps: 208 | Train Loss: 1.497 Vali Loss: 6.590 Vali Acc: 0.121 Test Loss: 6.590 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5492667
	speed: 0.3520s/iter; left time: 6407.9748s
	iters: 200, epoch: 13 | loss: 2.0075281
	speed: 0.0833s/iter; left time: 1507.7091s
Epoch: 13 cost time: 19.351269006729126
Epoch: 13, Steps: 208 | Train Loss: 1.212 Vali Loss: 6.542 Vali Acc: 0.126 Test Loss: 6.542 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8009157
	speed: 0.3236s/iter; left time: 5824.2702s
	iters: 200, epoch: 14 | loss: 1.4401102
	speed: 0.0818s/iter; left time: 1463.2272s
Epoch: 14 cost time: 17.85748553276062
Epoch: 14, Steps: 208 | Train Loss: 0.990 Vali Loss: 6.985 Vali Acc: 0.137 Test Loss: 6.985 Test Acc: 0.137
Validation loss decreased (-0.132660 --> -0.137121).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7381645
	speed: 0.3186s/iter; left time: 5666.9067s
	iters: 200, epoch: 15 | loss: 0.8349391
	speed: 0.0801s/iter; left time: 1416.0186s
Epoch: 15 cost time: 17.84696125984192
Epoch: 15, Steps: 208 | Train Loss: 0.785 Vali Loss: 7.019 Vali Acc: 0.134 Test Loss: 7.019 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.9667343
	speed: 0.3277s/iter; left time: 5760.7367s
	iters: 200, epoch: 16 | loss: 0.5351956
	speed: 0.0782s/iter; left time: 1366.7159s
Epoch: 16 cost time: 17.473384380340576
Epoch: 16, Steps: 208 | Train Loss: 0.657 Vali Loss: 7.234 Vali Acc: 0.131 Test Loss: 7.234 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5177023
	speed: 0.3133s/iter; left time: 5442.9597s
	iters: 200, epoch: 17 | loss: 0.6996320
	speed: 0.0650s/iter; left time: 1122.0204s
Epoch: 17 cost time: 16.045376777648926
Epoch: 17, Steps: 208 | Train Loss: 0.539 Vali Loss: 7.677 Vali Acc: 0.138 Test Loss: 7.677 Test Acc: 0.138
Validation loss decreased (-0.137121 --> -0.138009).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4793229
	speed: 0.2920s/iter; left time: 5011.9900s
	iters: 200, epoch: 18 | loss: 0.1375795
	speed: 0.0604s/iter; left time: 1029.8909s
Epoch: 18 cost time: 14.056769609451294
Epoch: 18, Steps: 208 | Train Loss: 0.453 Vali Loss: 8.366 Vali Acc: 0.136 Test Loss: 8.366 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1268238
	speed: 0.2845s/iter; left time: 4824.9634s
	iters: 200, epoch: 19 | loss: 0.4444017
	speed: 0.0601s/iter; left time: 1013.8304s
Epoch: 19 cost time: 14.15838098526001
Epoch: 19, Steps: 208 | Train Loss: 0.387 Vali Loss: 8.662 Vali Acc: 0.134 Test Loss: 8.662 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.4031551
	speed: 0.2927s/iter; left time: 4901.9719s
	iters: 200, epoch: 20 | loss: 0.2039597
	speed: 0.0663s/iter; left time: 1104.0577s
Epoch: 20 cost time: 14.72561001777649
Epoch: 20, Steps: 208 | Train Loss: 0.340 Vali Loss: 8.883 Vali Acc: 0.129 Test Loss: 8.883 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4752550
	speed: 0.3195s/iter; left time: 5285.6168s
	iters: 200, epoch: 21 | loss: 0.1462476
	speed: 0.0662s/iter; left time: 1087.6202s
Epoch: 21 cost time: 15.479242086410522
Epoch: 21, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.728 Vali Acc: 0.135 Test Loss: 8.728 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.7029589
	speed: 0.3026s/iter; left time: 4941.9159s
	iters: 200, epoch: 22 | loss: 0.0983843
	speed: 0.0678s/iter; left time: 1100.7855s
Epoch: 22 cost time: 15.322919845581055
Epoch: 22, Steps: 208 | Train Loss: 0.279 Vali Loss: 9.457 Vali Acc: 0.125 Test Loss: 9.457 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1999435
	speed: 0.3123s/iter; left time: 5035.9051s
	iters: 200, epoch: 23 | loss: 0.3343977
	speed: 0.0904s/iter; left time: 1448.7308s
Epoch: 23 cost time: 18.276952505111694
Epoch: 23, Steps: 208 | Train Loss: 0.258 Vali Loss: 9.668 Vali Acc: 0.142 Test Loss: 9.668 Test Acc: 0.142
Validation loss decreased (-0.138009 --> -0.142164).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1108057
	speed: 0.3222s/iter; left time: 5128.3962s
	iters: 200, epoch: 24 | loss: 0.1314978
	speed: 0.0875s/iter; left time: 1384.5215s
Epoch: 24 cost time: 18.16282820701599
Epoch: 24, Steps: 208 | Train Loss: 0.249 Vali Loss: 10.016 Vali Acc: 0.141 Test Loss: 10.016 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.3223251
	speed: 0.3122s/iter; left time: 4904.4338s
	iters: 200, epoch: 25 | loss: 0.3559305
	speed: 0.0838s/iter; left time: 1308.5920s
Epoch: 25 cost time: 18.093594074249268
Epoch: 25, Steps: 208 | Train Loss: 0.255 Vali Loss: 10.514 Vali Acc: 0.134 Test Loss: 10.514 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.2627652
	speed: 0.3161s/iter; left time: 4899.4914s
	iters: 200, epoch: 26 | loss: 0.4252890
	speed: 0.0711s/iter; left time: 1095.2187s
Epoch: 26 cost time: 17.070441246032715
Epoch: 26, Steps: 208 | Train Loss: 0.190 Vali Loss: 11.257 Vali Acc: 0.140 Test Loss: 11.257 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0958769
	speed: 0.2932s/iter; left time: 4483.2018s
	iters: 200, epoch: 27 | loss: 0.0290694
	speed: 0.0694s/iter; left time: 1054.0638s
Epoch: 27 cost time: 15.821194887161255
Epoch: 27, Steps: 208 | Train Loss: 0.185 Vali Loss: 10.538 Vali Acc: 0.137 Test Loss: 10.538 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.2083686
	speed: 0.3098s/iter; left time: 4673.0835s
	iters: 200, epoch: 28 | loss: 0.2916498
	speed: 0.0647s/iter; left time: 969.4528s
Epoch: 28 cost time: 15.3287672996521
Epoch: 28, Steps: 208 | Train Loss: 0.197 Vali Loss: 10.555 Vali Acc: 0.124 Test Loss: 10.555 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.3070155
	speed: 0.3202s/iter; left time: 4764.2885s
	iters: 200, epoch: 29 | loss: 0.1047732
	speed: 0.0604s/iter; left time: 893.1473s
Epoch: 29 cost time: 15.70715880393982
Epoch: 29, Steps: 208 | Train Loss: 0.190 Vali Loss: 11.629 Vali Acc: 0.133 Test Loss: 11.629 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.3179094
	speed: 0.3762s/iter; left time: 5518.8321s
	iters: 200, epoch: 30 | loss: 0.3861468
	speed: 0.0899s/iter; left time: 1309.9042s
Epoch: 30 cost time: 20.464957237243652
Epoch: 30, Steps: 208 | Train Loss: 0.191 Vali Loss: 11.089 Vali Acc: 0.136 Test Loss: 11.089 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0611502
	speed: 0.3446s/iter; left time: 4982.6797s
	iters: 200, epoch: 31 | loss: 0.0358638
	speed: 0.0915s/iter; left time: 1314.4197s
Epoch: 31 cost time: 19.604045867919922
Epoch: 31, Steps: 208 | Train Loss: 0.190 Vali Loss: 11.088 Vali Acc: 0.122 Test Loss: 11.088 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.4465721
	speed: 0.3314s/iter; left time: 4723.8832s
	iters: 200, epoch: 32 | loss: 0.2036745
	speed: 0.0809s/iter; left time: 1145.3559s
Epoch: 32 cost time: 18.557598114013672
Epoch: 32, Steps: 208 | Train Loss: 0.169 Vali Loss: 11.915 Vali Acc: 0.131 Test Loss: 11.915 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.1235327
	speed: 0.3217s/iter; left time: 4518.1826s
	iters: 200, epoch: 33 | loss: 0.4215988
	speed: 0.0780s/iter; left time: 1087.1415s
Epoch: 33 cost time: 17.96598744392395
Epoch: 33, Steps: 208 | Train Loss: 0.164 Vali Loss: 12.534 Vali Acc: 0.130 Test Loss: 12.534 Test Acc: 0.130
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1422606620936475
model parameter : 2144807
model size : 10.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8297577
	speed: 0.1143s/iter; left time: 2365.1491s
	iters: 200, epoch: 1 | loss: 3.8923540
	speed: 0.0844s/iter; left time: 1739.4588s
Epoch: 1 cost time: 20.875190496444702
Epoch: 1, Steps: 208 | Train Loss: 4.301 Vali Loss: 3.899 Vali Acc: 0.027 Test Loss: 3.899 Test Acc: 0.027
Validation loss decreased (inf --> -0.026803).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2477252
	speed: 0.3064s/iter; left time: 6279.0841s
	iters: 200, epoch: 2 | loss: 3.6314387
	speed: 0.0822s/iter; left time: 1677.1186s
Epoch: 2 cost time: 17.64795470237732
Epoch: 2, Steps: 208 | Train Loss: 3.596 Vali Loss: 3.620 Vali Acc: 0.093 Test Loss: 3.620 Test Acc: 0.093
Validation loss decreased (-0.026803 --> -0.093313).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5016336
	speed: 0.3094s/iter; left time: 6276.3561s
	iters: 200, epoch: 3 | loss: 3.6679327
	speed: 0.0831s/iter; left time: 1676.5938s
Epoch: 3 cost time: 17.878509998321533
Epoch: 3, Steps: 208 | Train Loss: 3.862 Vali Loss: 3.666 Vali Acc: 0.118 Test Loss: 3.666 Test Acc: 0.118
Validation loss decreased (-0.093313 --> -0.118365).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5037186
	speed: 0.3028s/iter; left time: 6078.5349s
	iters: 200, epoch: 4 | loss: 4.0231090
	speed: 0.0694s/iter; left time: 1386.0335s
Epoch: 4 cost time: 15.742281675338745
Epoch: 4, Steps: 208 | Train Loss: 3.992 Vali Loss: 4.975 Vali Acc: 0.110 Test Loss: 4.975 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.4873714
	speed: 0.2821s/iter; left time: 5604.1542s
	iters: 200, epoch: 5 | loss: 4.1482754
	speed: 0.0791s/iter; left time: 1562.7842s
Epoch: 5 cost time: 17.28575086593628
Epoch: 5, Steps: 208 | Train Loss: 4.094 Vali Loss: 4.161 Vali Acc: 0.106 Test Loss: 4.161 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.7700901
	speed: 0.2998s/iter; left time: 5894.0003s
	iters: 200, epoch: 6 | loss: 3.3632038
	speed: 0.0847s/iter; left time: 1657.7775s
Epoch: 6 cost time: 18.40586757659912
Epoch: 6, Steps: 208 | Train Loss: 3.952 Vali Loss: 4.378 Vali Acc: 0.112 Test Loss: 4.378 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 4.8066344
	speed: 0.3044s/iter; left time: 5922.0247s
	iters: 200, epoch: 7 | loss: 4.8870530
	speed: 0.0756s/iter; left time: 1462.3365s
Epoch: 7 cost time: 16.819939374923706
Epoch: 7, Steps: 208 | Train Loss: 3.772 Vali Loss: 4.704 Vali Acc: 0.122 Test Loss: 4.704 Test Acc: 0.122
Validation loss decreased (-0.118365 --> -0.121933).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7735724
	speed: 0.2714s/iter; left time: 5222.4856s
	iters: 200, epoch: 8 | loss: 3.6768122
	speed: 0.0664s/iter; left time: 1270.8762s
Epoch: 8 cost time: 13.492716312408447
Epoch: 8, Steps: 208 | Train Loss: 3.458 Vali Loss: 5.730 Vali Acc: 0.123 Test Loss: 5.730 Test Acc: 0.123
Validation loss decreased (-0.121933 --> -0.123116).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4598091
	speed: 0.2647s/iter; left time: 5039.5711s
	iters: 200, epoch: 9 | loss: 4.9520774
	speed: 0.0565s/iter; left time: 1069.7225s
Epoch: 9 cost time: 13.325570106506348
Epoch: 9, Steps: 208 | Train Loss: 3.093 Vali Loss: 5.858 Vali Acc: 0.123 Test Loss: 5.858 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.6476774
	speed: 0.2497s/iter; left time: 4700.7151s
	iters: 200, epoch: 10 | loss: 1.6782141
	speed: 0.0625s/iter; left time: 1171.4679s
Epoch: 10 cost time: 13.26981496810913
Epoch: 10, Steps: 208 | Train Loss: 2.538 Vali Loss: 5.679 Vali Acc: 0.109 Test Loss: 5.679 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4003800
	speed: 0.2722s/iter; left time: 5068.3614s
	iters: 200, epoch: 11 | loss: 2.0615439
	speed: 0.0558s/iter; left time: 1032.7234s
Epoch: 11 cost time: 12.931084632873535
Epoch: 11, Steps: 208 | Train Loss: 2.024 Vali Loss: 6.251 Vali Acc: 0.115 Test Loss: 6.251 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4789295
	speed: 0.2769s/iter; left time: 5098.3423s
	iters: 200, epoch: 12 | loss: 2.0186102
	speed: 0.0560s/iter; left time: 1025.1138s
Epoch: 12 cost time: 13.172202825546265
Epoch: 12, Steps: 208 | Train Loss: 1.588 Vali Loss: 5.807 Vali Acc: 0.118 Test Loss: 5.807 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0824281
	speed: 0.2765s/iter; left time: 5033.6424s
	iters: 200, epoch: 13 | loss: 2.4027431
	speed: 0.0628s/iter; left time: 1137.7656s
Epoch: 13 cost time: 13.92171859741211
Epoch: 13, Steps: 208 | Train Loss: 1.346 Vali Loss: 5.960 Vali Acc: 0.136 Test Loss: 5.960 Test Acc: 0.136
Validation loss decreased (-0.123116 --> -0.135640).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1932415
	speed: 0.2682s/iter; left time: 4827.6562s
	iters: 200, epoch: 14 | loss: 0.4518474
	speed: 0.0467s/iter; left time: 835.5438s
Epoch: 14 cost time: 11.887807846069336
Epoch: 14, Steps: 208 | Train Loss: 1.046 Vali Loss: 6.453 Vali Acc: 0.134 Test Loss: 6.453 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5173204
	speed: 0.2536s/iter; left time: 4512.0310s
	iters: 200, epoch: 15 | loss: 0.4611843
	speed: 0.0516s/iter; left time: 912.4628s
Epoch: 15 cost time: 12.01491928100586
Epoch: 15, Steps: 208 | Train Loss: 0.852 Vali Loss: 6.678 Vali Acc: 0.123 Test Loss: 6.678 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1771723
	speed: 0.2659s/iter; left time: 4674.3183s
	iters: 200, epoch: 16 | loss: 0.6854648
	speed: 0.0524s/iter; left time: 916.4339s
Epoch: 16 cost time: 12.296568632125854
Epoch: 16, Steps: 208 | Train Loss: 0.690 Vali Loss: 7.448 Vali Acc: 0.129 Test Loss: 7.448 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9340678
	speed: 0.2853s/iter; left time: 4956.3771s
	iters: 200, epoch: 17 | loss: 0.2802983
	speed: 0.0597s/iter; left time: 1031.7094s
Epoch: 17 cost time: 14.043477773666382
Epoch: 17, Steps: 208 | Train Loss: 0.585 Vali Loss: 7.268 Vali Acc: 0.124 Test Loss: 7.268 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2536435
	speed: 0.2666s/iter; left time: 4576.6445s
	iters: 200, epoch: 18 | loss: 0.4218339
	speed: 0.0632s/iter; left time: 1078.4939s
Epoch: 18 cost time: 13.267674684524536
Epoch: 18, Steps: 208 | Train Loss: 0.517 Vali Loss: 7.764 Vali Acc: 0.129 Test Loss: 7.764 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7197377
	speed: 0.2566s/iter; left time: 4351.9796s
	iters: 200, epoch: 19 | loss: 0.9734491
	speed: 0.0573s/iter; left time: 966.2933s
Epoch: 19 cost time: 12.818049192428589
Epoch: 19, Steps: 208 | Train Loss: 0.423 Vali Loss: 7.985 Vali Acc: 0.133 Test Loss: 7.985 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8618867
	speed: 0.2545s/iter; left time: 4263.1346s
	iters: 200, epoch: 20 | loss: 0.4987827
	speed: 0.0591s/iter; left time: 984.2098s
Epoch: 20 cost time: 13.057342290878296
Epoch: 20, Steps: 208 | Train Loss: 0.352 Vali Loss: 8.501 Vali Acc: 0.129 Test Loss: 8.501 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0411553
	speed: 0.2925s/iter; left time: 4838.0360s
	iters: 200, epoch: 21 | loss: 0.2009042
	speed: 0.0675s/iter; left time: 1110.2203s
Epoch: 21 cost time: 15.41543436050415
Epoch: 21, Steps: 208 | Train Loss: 0.327 Vali Loss: 9.134 Vali Acc: 0.131 Test Loss: 9.134 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4152435
	speed: 0.2811s/iter; left time: 4591.0892s
	iters: 200, epoch: 22 | loss: 0.3322593
	speed: 0.0734s/iter; left time: 1191.4129s
Epoch: 22 cost time: 16.106132984161377
Epoch: 22, Steps: 208 | Train Loss: 0.328 Vali Loss: 9.575 Vali Acc: 0.134 Test Loss: 9.575 Test Acc: 0.134
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3471613
	speed: 0.2875s/iter; left time: 4635.6582s
	iters: 200, epoch: 23 | loss: 0.0233984
	speed: 0.0763s/iter; left time: 1223.0514s
Epoch: 23 cost time: 16.908005475997925
Epoch: 23, Steps: 208 | Train Loss: 0.310 Vali Loss: 9.049 Vali Acc: 0.137 Test Loss: 9.049 Test Acc: 0.137
Validation loss decreased (-0.135640 --> -0.136802).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.3092864
	speed: 0.2930s/iter; left time: 4664.2099s
	iters: 200, epoch: 24 | loss: 0.0198433
	speed: 0.0748s/iter; left time: 1182.8296s
Epoch: 24 cost time: 16.16500449180603
Epoch: 24, Steps: 208 | Train Loss: 0.259 Vali Loss: 9.189 Vali Acc: 0.129 Test Loss: 9.189 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1956461
	speed: 0.2860s/iter; left time: 4492.5798s
	iters: 200, epoch: 25 | loss: 0.1430323
	speed: 0.0717s/iter; left time: 1119.8757s
Epoch: 25 cost time: 15.677705764770508
Epoch: 25, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.786 Vali Acc: 0.119 Test Loss: 9.786 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0590300
	speed: 0.2881s/iter; left time: 4466.1097s
	iters: 200, epoch: 26 | loss: 0.2016295
	speed: 0.0754s/iter; left time: 1161.3129s
Epoch: 26 cost time: 16.67174983024597
Epoch: 26, Steps: 208 | Train Loss: 0.261 Vali Loss: 9.305 Vali Acc: 0.121 Test Loss: 9.305 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.2385014
	speed: 0.2782s/iter; left time: 4254.6605s
	iters: 200, epoch: 27 | loss: 0.2711111
	speed: 0.0775s/iter; left time: 1177.0121s
Epoch: 27 cost time: 16.689584493637085
Epoch: 27, Steps: 208 | Train Loss: 0.229 Vali Loss: 9.219 Vali Acc: 0.124 Test Loss: 9.219 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.3060955
	speed: 0.2991s/iter; left time: 4512.4726s
	iters: 200, epoch: 28 | loss: 0.1365644
	speed: 0.0739s/iter; left time: 1106.6797s
Epoch: 28 cost time: 16.79092788696289
Epoch: 28, Steps: 208 | Train Loss: 0.228 Vali Loss: 10.334 Vali Acc: 0.120 Test Loss: 10.334 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0436194
	speed: 0.2991s/iter; left time: 4450.3834s
	iters: 200, epoch: 29 | loss: 0.2674881
	speed: 0.0770s/iter; left time: 1137.3745s
Epoch: 29 cost time: 16.240759134292603
Epoch: 29, Steps: 208 | Train Loss: 0.230 Vali Loss: 11.038 Vali Acc: 0.122 Test Loss: 11.038 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0107152
	speed: 0.3169s/iter; left time: 4648.4861s
	iters: 200, epoch: 30 | loss: 0.1219587
	speed: 0.0851s/iter; left time: 1240.3320s
Epoch: 30 cost time: 18.350295305252075
Epoch: 30, Steps: 208 | Train Loss: 0.189 Vali Loss: 10.773 Vali Acc: 0.129 Test Loss: 10.773 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0317826
	speed: 0.3150s/iter; left time: 4555.8794s
	iters: 200, epoch: 31 | loss: 0.0113902
	speed: 0.0893s/iter; left time: 1282.8773s
Epoch: 31 cost time: 18.799766540527344
Epoch: 31, Steps: 208 | Train Loss: 0.222 Vali Loss: 11.418 Vali Acc: 0.125 Test Loss: 11.418 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.1316194
	speed: 0.3155s/iter; left time: 4496.6760s
	iters: 200, epoch: 32 | loss: 0.3545988
	speed: 0.0845s/iter; left time: 1196.3040s
Epoch: 32 cost time: 18.28179931640625
Epoch: 32, Steps: 208 | Train Loss: 0.209 Vali Loss: 10.205 Vali Acc: 0.122 Test Loss: 10.205 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0793121
	speed: 0.2980s/iter; left time: 4185.4869s
	iters: 200, epoch: 33 | loss: 0.2881056
	speed: 0.0739s/iter; left time: 1030.9380s
Epoch: 33 cost time: 15.64711856842041
Epoch: 33, Steps: 208 | Train Loss: 0.225 Vali Loss: 11.244 Vali Acc: 0.124 Test Loss: 11.244 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13689233522218908
model parameter : 1486631
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7920613
	speed: 0.0944s/iter; left time: 1954.3483s
	iters: 200, epoch: 1 | loss: 3.8299584
	speed: 0.0630s/iter; left time: 1298.7057s
Epoch: 1 cost time: 16.51401925086975
Epoch: 1, Steps: 208 | Train Loss: 4.235 Vali Loss: 3.766 Vali Acc: 0.048 Test Loss: 3.766 Test Acc: 0.048
Validation loss decreased (inf --> -0.047979).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1346397
	speed: 0.2761s/iter; left time: 5657.3529s
	iters: 200, epoch: 2 | loss: 4.3073711
	speed: 0.0562s/iter; left time: 1146.3954s
Epoch: 2 cost time: 12.867808818817139
Epoch: 2, Steps: 208 | Train Loss: 3.555 Vali Loss: 3.710 Vali Acc: 0.086 Test Loss: 3.710 Test Acc: 0.086
Validation loss decreased (-0.047979 --> -0.086154).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1927264
	speed: 0.2788s/iter; left time: 5656.2317s
	iters: 200, epoch: 3 | loss: 3.8527620
	speed: 0.0599s/iter; left time: 1208.5611s
Epoch: 3 cost time: 14.173911809921265
Epoch: 3, Steps: 208 | Train Loss: 3.606 Vali Loss: 3.956 Vali Acc: 0.096 Test Loss: 3.956 Test Acc: 0.096
Validation loss decreased (-0.086154 --> -0.095696).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1488647
	speed: 0.2698s/iter; left time: 5417.7144s
	iters: 200, epoch: 4 | loss: 4.0527635
	speed: 0.0661s/iter; left time: 1319.7989s
Epoch: 4 cost time: 14.26240587234497
Epoch: 4, Steps: 208 | Train Loss: 3.797 Vali Loss: 3.844 Vali Acc: 0.104 Test Loss: 3.844 Test Acc: 0.104
Validation loss decreased (-0.095696 --> -0.104346).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6338363
	speed: 0.2662s/iter; left time: 5288.8940s
	iters: 200, epoch: 5 | loss: 4.2985096
	speed: 0.0579s/iter; left time: 1144.8285s
Epoch: 5 cost time: 13.240029335021973
Epoch: 5, Steps: 208 | Train Loss: 3.879 Vali Loss: 4.365 Vali Acc: 0.109 Test Loss: 4.365 Test Acc: 0.109
Validation loss decreased (-0.104346 --> -0.109112).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.2554016
	speed: 0.2518s/iter; left time: 4950.0890s
	iters: 200, epoch: 6 | loss: 3.7073455
	speed: 0.0657s/iter; left time: 1285.3208s
Epoch: 6 cost time: 13.970663785934448
Epoch: 6, Steps: 208 | Train Loss: 3.721 Vali Loss: 4.670 Vali Acc: 0.086 Test Loss: 4.670 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.9234076
	speed: 0.2555s/iter; left time: 4971.1443s
	iters: 200, epoch: 7 | loss: 4.6595087
	speed: 0.0633s/iter; left time: 1224.8005s
Epoch: 7 cost time: 13.315523624420166
Epoch: 7, Steps: 208 | Train Loss: 3.607 Vali Loss: 4.701 Vali Acc: 0.117 Test Loss: 4.701 Test Acc: 0.117
Validation loss decreased (-0.109112 --> -0.116863).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8327031
	speed: 0.2737s/iter; left time: 5266.5629s
	iters: 200, epoch: 8 | loss: 3.5665164
	speed: 0.0588s/iter; left time: 1126.3076s
Epoch: 8 cost time: 13.12067699432373
Epoch: 8, Steps: 208 | Train Loss: 3.334 Vali Loss: 5.378 Vali Acc: 0.123 Test Loss: 5.378 Test Acc: 0.123
Validation loss decreased (-0.116863 --> -0.123120).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1634703
	speed: 0.2809s/iter; left time: 5347.5039s
	iters: 200, epoch: 9 | loss: 2.7127829
	speed: 0.0566s/iter; left time: 1071.9520s
Epoch: 9 cost time: 13.764398574829102
Epoch: 9, Steps: 208 | Train Loss: 2.923 Vali Loss: 6.072 Vali Acc: 0.110 Test Loss: 6.072 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.6542382
	speed: 0.2815s/iter; left time: 5300.7099s
	iters: 200, epoch: 10 | loss: 2.5863235
	speed: 0.0616s/iter; left time: 1152.8845s
Epoch: 10 cost time: 14.287013053894043
Epoch: 10, Steps: 208 | Train Loss: 2.444 Vali Loss: 5.662 Vali Acc: 0.116 Test Loss: 5.662 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.0301487
	speed: 0.2683s/iter; left time: 4995.2148s
	iters: 200, epoch: 11 | loss: 2.9514916
	speed: 0.0557s/iter; left time: 1031.1965s
Epoch: 11 cost time: 13.244028568267822
Epoch: 11, Steps: 208 | Train Loss: 2.076 Vali Loss: 6.059 Vali Acc: 0.127 Test Loss: 6.059 Test Acc: 0.127
Validation loss decreased (-0.123120 --> -0.126990).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8201456
	speed: 0.2735s/iter; left time: 5035.7531s
	iters: 200, epoch: 12 | loss: 1.7263135
	speed: 0.0624s/iter; left time: 1142.4719s
Epoch: 12 cost time: 13.579474210739136
Epoch: 12, Steps: 208 | Train Loss: 1.656 Vali Loss: 6.330 Vali Acc: 0.120 Test Loss: 6.330 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8025701
	speed: 0.2966s/iter; left time: 5400.2925s
	iters: 200, epoch: 13 | loss: 1.1092508
	speed: 0.0718s/iter; left time: 1299.2929s
Epoch: 13 cost time: 16.244273900985718
Epoch: 13, Steps: 208 | Train Loss: 1.402 Vali Loss: 5.972 Vali Acc: 0.127 Test Loss: 5.972 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1427263
	speed: 0.3187s/iter; left time: 5735.4380s
	iters: 200, epoch: 14 | loss: 1.7713269
	speed: 0.0724s/iter; left time: 1295.7854s
Epoch: 14 cost time: 16.416884660720825
Epoch: 14, Steps: 208 | Train Loss: 1.121 Vali Loss: 5.948 Vali Acc: 0.127 Test Loss: 5.948 Test Acc: 0.127
Validation loss decreased (-0.126990 --> -0.126991).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5612902
	speed: 0.3034s/iter; left time: 5396.7151s
	iters: 200, epoch: 15 | loss: 1.0311654
	speed: 0.0682s/iter; left time: 1205.9018s
Epoch: 15 cost time: 15.969618797302246
Epoch: 15, Steps: 208 | Train Loss: 0.849 Vali Loss: 6.628 Vali Acc: 0.128 Test Loss: 6.628 Test Acc: 0.128
Validation loss decreased (-0.126991 --> -0.128177).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0862232
	speed: 0.3205s/iter; left time: 5634.5274s
	iters: 200, epoch: 16 | loss: 0.9291677
	speed: 0.0752s/iter; left time: 1313.7516s
Epoch: 16 cost time: 16.644177675247192
Epoch: 16, Steps: 208 | Train Loss: 0.723 Vali Loss: 7.162 Vali Acc: 0.129 Test Loss: 7.162 Test Acc: 0.129
Validation loss decreased (-0.128177 --> -0.129066).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6174473
	speed: 0.3241s/iter; left time: 5631.1113s
	iters: 200, epoch: 17 | loss: 1.8254250
	speed: 0.0759s/iter; left time: 1310.6589s
Epoch: 17 cost time: 16.56505799293518
Epoch: 17, Steps: 208 | Train Loss: 0.637 Vali Loss: 7.557 Vali Acc: 0.128 Test Loss: 7.557 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.7474667
	speed: 0.3326s/iter; left time: 5708.7984s
	iters: 200, epoch: 18 | loss: 0.5516847
	speed: 0.0746s/iter; left time: 1272.3787s
Epoch: 18 cost time: 16.754773378372192
Epoch: 18, Steps: 208 | Train Loss: 0.488 Vali Loss: 8.250 Vali Acc: 0.126 Test Loss: 8.250 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1523978
	speed: 0.3151s/iter; left time: 5342.5791s
	iters: 200, epoch: 19 | loss: 0.8139572
	speed: 0.0671s/iter; left time: 1130.3500s
Epoch: 19 cost time: 15.87386178970337
Epoch: 19, Steps: 208 | Train Loss: 0.455 Vali Loss: 8.690 Vali Acc: 0.132 Test Loss: 8.690 Test Acc: 0.132
Validation loss decreased (-0.129066 --> -0.131735).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3327037
	speed: 0.3295s/iter; left time: 5518.0295s
	iters: 200, epoch: 20 | loss: 0.5552999
	speed: 0.0798s/iter; left time: 1328.0542s
Epoch: 20 cost time: 17.68769121170044
Epoch: 20, Steps: 208 | Train Loss: 0.412 Vali Loss: 8.338 Vali Acc: 0.133 Test Loss: 8.338 Test Acc: 0.133
Validation loss decreased (-0.131735 --> -0.133230).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3535917
	speed: 0.3246s/iter; left time: 5368.7814s
	iters: 200, epoch: 21 | loss: 0.2578041
	speed: 0.0737s/iter; left time: 1212.0709s
Epoch: 21 cost time: 16.879220485687256
Epoch: 21, Steps: 208 | Train Loss: 0.336 Vali Loss: 8.907 Vali Acc: 0.131 Test Loss: 8.907 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.3835107
	speed: 0.2794s/iter; left time: 4563.0719s
	iters: 200, epoch: 22 | loss: 0.2940591
	speed: 0.0715s/iter; left time: 1160.9876s
Epoch: 22 cost time: 15.521816968917847
Epoch: 22, Steps: 208 | Train Loss: 0.330 Vali Loss: 9.009 Vali Acc: 0.134 Test Loss: 9.009 Test Acc: 0.134
Validation loss decreased (-0.133230 --> -0.133522).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.2737623
	speed: 0.2932s/iter; left time: 4727.6600s
	iters: 200, epoch: 23 | loss: 1.0679588
	speed: 0.0672s/iter; left time: 1077.0674s
Epoch: 23 cost time: 15.562300443649292
Epoch: 23, Steps: 208 | Train Loss: 0.303 Vali Loss: 9.494 Vali Acc: 0.132 Test Loss: 9.494 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1255798
	speed: 0.3006s/iter; left time: 4784.3686s
	iters: 200, epoch: 24 | loss: 0.5750949
	speed: 0.0649s/iter; left time: 1027.3038s
Epoch: 24 cost time: 15.49871563911438
Epoch: 24, Steps: 208 | Train Loss: 0.281 Vali Loss: 9.461 Vali Acc: 0.122 Test Loss: 9.461 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.5336643
	speed: 0.3006s/iter; left time: 4722.7433s
	iters: 200, epoch: 25 | loss: 0.6152205
	speed: 0.0553s/iter; left time: 862.5667s
Epoch: 25 cost time: 14.414295196533203
Epoch: 25, Steps: 208 | Train Loss: 0.287 Vali Loss: 9.995 Vali Acc: 0.133 Test Loss: 9.995 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0944742
	speed: 0.3005s/iter; left time: 4658.0925s
	iters: 200, epoch: 26 | loss: 0.1837545
	speed: 0.0592s/iter; left time: 911.3878s
Epoch: 26 cost time: 13.603181600570679
Epoch: 26, Steps: 208 | Train Loss: 0.297 Vali Loss: 10.629 Vali Acc: 0.129 Test Loss: 10.629 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.2020919
	speed: 0.3149s/iter; left time: 4815.0539s
	iters: 200, epoch: 27 | loss: 0.5204993
	speed: 0.0628s/iter; left time: 954.5503s
Epoch: 27 cost time: 14.111987829208374
Epoch: 27, Steps: 208 | Train Loss: 0.296 Vali Loss: 10.463 Vali Acc: 0.128 Test Loss: 10.463 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.2721152
	speed: 0.2995s/iter; left time: 4517.3122s
	iters: 200, epoch: 28 | loss: 1.0819944
	speed: 0.0615s/iter; left time: 922.0441s
Epoch: 28 cost time: 14.557251691818237
Epoch: 28, Steps: 208 | Train Loss: 0.247 Vali Loss: 10.481 Vali Acc: 0.125 Test Loss: 10.481 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.2764353
	speed: 0.2938s/iter; left time: 4370.1450s
	iters: 200, epoch: 29 | loss: 1.0700257
	speed: 0.0557s/iter; left time: 823.5437s
Epoch: 29 cost time: 13.93233847618103
Epoch: 29, Steps: 208 | Train Loss: 0.239 Vali Loss: 10.712 Vali Acc: 0.135 Test Loss: 10.712 Test Acc: 0.135
Validation loss decreased (-0.133522 --> -0.135294).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0518323
	speed: 0.2931s/iter; left time: 4299.7325s
	iters: 200, epoch: 30 | loss: 0.0114311
	speed: 0.0609s/iter; left time: 887.9555s
Epoch: 30 cost time: 13.38496732711792
Epoch: 30, Steps: 208 | Train Loss: 0.242 Vali Loss: 11.069 Vali Acc: 0.128 Test Loss: 11.069 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0073884
	speed: 0.2957s/iter; left time: 4276.6287s
	iters: 200, epoch: 31 | loss: 0.1560444
	speed: 0.0569s/iter; left time: 817.8524s
Epoch: 31 cost time: 12.98763656616211
Epoch: 31, Steps: 208 | Train Loss: 0.226 Vali Loss: 10.572 Vali Acc: 0.129 Test Loss: 10.572 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0080796
	speed: 0.2863s/iter; left time: 4080.9325s
	iters: 200, epoch: 32 | loss: 0.4701240
	speed: 0.0563s/iter; left time: 796.2110s
Epoch: 32 cost time: 13.006129503250122
Epoch: 32, Steps: 208 | Train Loss: 0.215 Vali Loss: 10.350 Vali Acc: 0.126 Test Loss: 10.350 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.1340088
	speed: 0.2804s/iter; left time: 3938.5553s
	iters: 200, epoch: 33 | loss: 0.0060773
	speed: 0.0599s/iter; left time: 835.7996s
Epoch: 33 cost time: 13.890867710113525
Epoch: 33, Steps: 208 | Train Loss: 0.196 Vali Loss: 11.240 Vali Acc: 0.119 Test Loss: 11.240 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.2705760
	speed: 0.2947s/iter; left time: 4077.5120s
	iters: 200, epoch: 34 | loss: 0.5001373
	speed: 0.0597s/iter; left time: 820.6234s
Epoch: 34 cost time: 14.346956253051758
Epoch: 34, Steps: 208 | Train Loss: 0.212 Vali Loss: 11.668 Vali Acc: 0.116 Test Loss: 11.668 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.1746105
	speed: 0.3073s/iter; left time: 4188.0005s
	iters: 200, epoch: 35 | loss: 0.2745367
	speed: 0.0689s/iter; left time: 932.1598s
Epoch: 35 cost time: 16.02938985824585
Epoch: 35, Steps: 208 | Train Loss: 0.216 Vali Loss: 11.864 Vali Acc: 0.121 Test Loss: 11.864 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.4774014
	speed: 0.3144s/iter; left time: 4219.7029s
	iters: 200, epoch: 36 | loss: 0.0988277
	speed: 0.0696s/iter; left time: 927.0780s
Epoch: 36 cost time: 15.405045747756958
Epoch: 36, Steps: 208 | Train Loss: 0.188 Vali Loss: 11.445 Vali Acc: 0.115 Test Loss: 11.445 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.2190025
	speed: 0.3241s/iter; left time: 4282.9529s
	iters: 200, epoch: 37 | loss: 0.3477193
	speed: 0.0787s/iter; left time: 1031.5376s
Epoch: 37 cost time: 17.756187677383423
Epoch: 37, Steps: 208 | Train Loss: 0.229 Vali Loss: 12.425 Vali Acc: 0.124 Test Loss: 12.425 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0146207
	speed: 0.3227s/iter; left time: 4197.1803s
	iters: 200, epoch: 38 | loss: 0.3745424
	speed: 0.0713s/iter; left time: 920.0033s
Epoch: 38 cost time: 16.385743618011475
Epoch: 38, Steps: 208 | Train Loss: 0.206 Vali Loss: 12.269 Vali Acc: 0.117 Test Loss: 12.269 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0351792
	speed: 0.3245s/iter; left time: 4152.1432s
	iters: 200, epoch: 39 | loss: 0.1904219
	speed: 0.0723s/iter; left time: 918.4179s
Epoch: 39 cost time: 16.80806612968445
Epoch: 39, Steps: 208 | Train Loss: 0.209 Vali Loss: 12.298 Vali Acc: 0.118 Test Loss: 12.298 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13540113331345063
model parameter : 1212711
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6070037
	speed: 0.0825s/iter; left time: 1706.8991s
	iters: 200, epoch: 1 | loss: 4.1611185
	speed: 0.0379s/iter; left time: 781.5697s
Epoch: 1 cost time: 12.475064516067505
Epoch: 1, Steps: 208 | Train Loss: 4.123 Vali Loss: 3.659 Vali Acc: 0.057 Test Loss: 3.659 Test Acc: 0.057
Validation loss decreased (inf --> -0.056629).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8210018
	speed: 0.2189s/iter; left time: 4486.1943s
	iters: 200, epoch: 2 | loss: 3.0858357
	speed: 0.0325s/iter; left time: 661.9018s
Epoch: 2 cost time: 7.935154676437378
Epoch: 2, Steps: 208 | Train Loss: 3.535 Vali Loss: 3.518 Vali Acc: 0.091 Test Loss: 3.518 Test Acc: 0.091
Validation loss decreased (-0.056629 --> -0.090630).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8167448
	speed: 0.2411s/iter; left time: 4891.3451s
	iters: 200, epoch: 3 | loss: 3.5772254
	speed: 0.0376s/iter; left time: 758.3083s
Epoch: 3 cost time: 9.557716846466064
Epoch: 3, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.512 Vali Acc: 0.089 Test Loss: 3.512 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.1487174
	speed: 0.2416s/iter; left time: 4850.1458s
	iters: 200, epoch: 4 | loss: 2.7984400
	speed: 0.0363s/iter; left time: 725.0214s
Epoch: 4 cost time: 9.359273195266724
Epoch: 4, Steps: 208 | Train Loss: 3.502 Vali Loss: 4.186 Vali Acc: 0.094 Test Loss: 4.186 Test Acc: 0.094
Validation loss decreased (-0.090630 --> -0.093606).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2814922
	speed: 0.2467s/iter; left time: 4902.5556s
	iters: 200, epoch: 5 | loss: 3.3998239
	speed: 0.0637s/iter; left time: 1259.4638s
Epoch: 5 cost time: 14.818358182907104
Epoch: 5, Steps: 208 | Train Loss: 3.529 Vali Loss: 4.173 Vali Acc: 0.094 Test Loss: 4.173 Test Acc: 0.094
Validation loss decreased (-0.093606 --> -0.094202).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9896898
	speed: 0.2857s/iter; left time: 5617.2538s
	iters: 200, epoch: 6 | loss: 3.3755009
	speed: 0.0596s/iter; left time: 1166.4036s
Epoch: 6 cost time: 13.616362571716309
Epoch: 6, Steps: 208 | Train Loss: 3.478 Vali Loss: 4.121 Vali Acc: 0.112 Test Loss: 4.121 Test Acc: 0.112
Validation loss decreased (-0.094202 --> -0.112395).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.5815356
	speed: 0.2866s/iter; left time: 5575.2519s
	iters: 200, epoch: 7 | loss: 4.5152249
	speed: 0.0719s/iter; left time: 1392.4452s
Epoch: 7 cost time: 15.301699161529541
Epoch: 7, Steps: 208 | Train Loss: 3.309 Vali Loss: 4.920 Vali Acc: 0.100 Test Loss: 4.920 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7304337
	speed: 0.2783s/iter; left time: 5356.1006s
	iters: 200, epoch: 8 | loss: 4.1824489
	speed: 0.0648s/iter; left time: 1240.8382s
Epoch: 8 cost time: 14.259503364562988
Epoch: 8, Steps: 208 | Train Loss: 3.065 Vali Loss: 4.471 Vali Acc: 0.112 Test Loss: 4.471 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.4426396
	speed: 0.2772s/iter; left time: 5277.7179s
	iters: 200, epoch: 9 | loss: 4.5904994
	speed: 0.0624s/iter; left time: 1181.2267s
Epoch: 9 cost time: 14.27879524230957
Epoch: 9, Steps: 208 | Train Loss: 2.791 Vali Loss: 5.104 Vali Acc: 0.097 Test Loss: 5.104 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.1685603
	speed: 0.2896s/iter; left time: 5452.5241s
	iters: 200, epoch: 10 | loss: 2.7373199
	speed: 0.0722s/iter; left time: 1351.8858s
Epoch: 10 cost time: 15.55220341682434
Epoch: 10, Steps: 208 | Train Loss: 2.496 Vali Loss: 5.384 Vali Acc: 0.122 Test Loss: 5.384 Test Acc: 0.122
Validation loss decreased (-0.112395 --> -0.121926).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5869315
	speed: 0.2960s/iter; left time: 5512.3931s
	iters: 200, epoch: 11 | loss: 1.8978146
	speed: 0.0701s/iter; left time: 1298.1085s
Epoch: 11 cost time: 15.180308818817139
Epoch: 11, Steps: 208 | Train Loss: 2.242 Vali Loss: 5.565 Vali Acc: 0.107 Test Loss: 5.565 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.6135960
	speed: 0.3019s/iter; left time: 5559.4241s
	iters: 200, epoch: 12 | loss: 1.3614379
	speed: 0.0703s/iter; left time: 1286.9277s
Epoch: 12 cost time: 15.489214181900024
Epoch: 12, Steps: 208 | Train Loss: 1.890 Vali Loss: 5.781 Vali Acc: 0.103 Test Loss: 5.781 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5605410
	speed: 0.2790s/iter; left time: 5079.3818s
	iters: 200, epoch: 13 | loss: 2.8660700
	speed: 0.0507s/iter; left time: 917.2982s
Epoch: 13 cost time: 12.079537630081177
Epoch: 13, Steps: 208 | Train Loss: 1.629 Vali Loss: 5.898 Vali Acc: 0.120 Test Loss: 5.898 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6686304
	speed: 0.2642s/iter; left time: 4755.0051s
	iters: 200, epoch: 14 | loss: 1.3115299
	speed: 0.0441s/iter; left time: 789.6593s
Epoch: 14 cost time: 10.218940258026123
Epoch: 14, Steps: 208 | Train Loss: 1.400 Vali Loss: 6.039 Vali Acc: 0.124 Test Loss: 6.039 Test Acc: 0.124
Validation loss decreased (-0.121926 --> -0.124008).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7229309
	speed: 0.2607s/iter; left time: 4638.4679s
	iters: 200, epoch: 15 | loss: 1.0652812
	speed: 0.0495s/iter; left time: 874.8323s
Epoch: 15 cost time: 11.544653415679932
Epoch: 15, Steps: 208 | Train Loss: 1.148 Vali Loss: 6.711 Vali Acc: 0.119 Test Loss: 6.711 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0004678
	speed: 0.2701s/iter; left time: 4748.3434s
	iters: 200, epoch: 16 | loss: 1.5192322
	speed: 0.0471s/iter; left time: 823.1357s
Epoch: 16 cost time: 11.218226432800293
Epoch: 16, Steps: 208 | Train Loss: 0.976 Vali Loss: 6.814 Vali Acc: 0.118 Test Loss: 6.814 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7057650
	speed: 0.2642s/iter; left time: 4590.6476s
	iters: 200, epoch: 17 | loss: 1.3998625
	speed: 0.0474s/iter; left time: 819.5865s
Epoch: 17 cost time: 11.466068506240845
Epoch: 17, Steps: 208 | Train Loss: 0.854 Vali Loss: 7.229 Vali Acc: 0.127 Test Loss: 7.229 Test Acc: 0.127
Validation loss decreased (-0.124008 --> -0.126978).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.9686387
	speed: 0.2778s/iter; left time: 4768.3614s
	iters: 200, epoch: 18 | loss: 1.1797745
	speed: 0.0505s/iter; left time: 861.7805s
Epoch: 18 cost time: 11.410317182540894
Epoch: 18, Steps: 208 | Train Loss: 0.681 Vali Loss: 7.591 Vali Acc: 0.123 Test Loss: 7.591 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6177192
	speed: 0.2655s/iter; left time: 4501.2661s
	iters: 200, epoch: 19 | loss: 0.8784968
	speed: 0.0444s/iter; left time: 748.7983s
Epoch: 19 cost time: 10.591357707977295
Epoch: 19, Steps: 208 | Train Loss: 0.642 Vali Loss: 7.961 Vali Acc: 0.127 Test Loss: 7.961 Test Acc: 0.127
Validation loss decreased (-0.126978 --> -0.127269).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4174082
	speed: 0.2330s/iter; left time: 3902.3232s
	iters: 200, epoch: 20 | loss: 1.4315228
	speed: 0.0614s/iter; left time: 1021.5311s
Epoch: 20 cost time: 11.815778732299805
Epoch: 20, Steps: 208 | Train Loss: 0.513 Vali Loss: 8.274 Vali Acc: 0.126 Test Loss: 8.274 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8957870
	speed: 0.2625s/iter; left time: 4342.6087s
	iters: 200, epoch: 21 | loss: 0.4004020
	speed: 0.0674s/iter; left time: 1107.3451s
Epoch: 21 cost time: 14.197477340698242
Epoch: 21, Steps: 208 | Train Loss: 0.470 Vali Loss: 8.370 Vali Acc: 0.129 Test Loss: 8.370 Test Acc: 0.129
Validation loss decreased (-0.127269 --> -0.128458).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2601244
	speed: 0.2743s/iter; left time: 4480.1167s
	iters: 200, epoch: 22 | loss: 0.3064854
	speed: 0.0581s/iter; left time: 943.7427s
Epoch: 22 cost time: 13.430994272232056
Epoch: 22, Steps: 208 | Train Loss: 0.467 Vali Loss: 8.898 Vali Acc: 0.124 Test Loss: 8.898 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1844183
	speed: 0.2634s/iter; left time: 4247.3191s
	iters: 200, epoch: 23 | loss: 0.0932730
	speed: 0.0620s/iter; left time: 993.5920s
Epoch: 23 cost time: 13.860439777374268
Epoch: 23, Steps: 208 | Train Loss: 0.396 Vali Loss: 8.996 Vali Acc: 0.118 Test Loss: 8.996 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2934518
	speed: 0.2728s/iter; left time: 4341.9992s
	iters: 200, epoch: 24 | loss: 0.8854528
	speed: 0.0631s/iter; left time: 997.9550s
Epoch: 24 cost time: 14.284065961837769
Epoch: 24, Steps: 208 | Train Loss: 0.354 Vali Loss: 9.589 Vali Acc: 0.117 Test Loss: 9.589 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.1189315
	speed: 0.2920s/iter; left time: 4586.8673s
	iters: 200, epoch: 25 | loss: 0.3710525
	speed: 0.0645s/iter; left time: 1006.0096s
Epoch: 25 cost time: 14.847463607788086
Epoch: 25, Steps: 208 | Train Loss: 0.369 Vali Loss: 10.254 Vali Acc: 0.115 Test Loss: 10.254 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.6744752
	speed: 0.2914s/iter; left time: 4516.7898s
	iters: 200, epoch: 26 | loss: 0.1679171
	speed: 0.0610s/iter; left time: 939.0415s
Epoch: 26 cost time: 14.247379302978516
Epoch: 26, Steps: 208 | Train Loss: 0.333 Vali Loss: 9.842 Vali Acc: 0.122 Test Loss: 9.842 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2649565
	speed: 0.2899s/iter; left time: 4432.9837s
	iters: 200, epoch: 27 | loss: 1.0956411
	speed: 0.0683s/iter; left time: 1037.4863s
Epoch: 27 cost time: 15.02816653251648
Epoch: 27, Steps: 208 | Train Loss: 0.320 Vali Loss: 10.182 Vali Acc: 0.116 Test Loss: 10.182 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0847505
	speed: 0.2847s/iter; left time: 4294.9433s
	iters: 200, epoch: 28 | loss: 0.2598570
	speed: 0.0504s/iter; left time: 755.7607s
Epoch: 28 cost time: 11.778396844863892
Epoch: 28, Steps: 208 | Train Loss: 0.303 Vali Loss: 10.229 Vali Acc: 0.119 Test Loss: 10.229 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0944133
	speed: 0.2564s/iter; left time: 3814.9250s
	iters: 200, epoch: 29 | loss: 0.0118099
	speed: 0.0471s/iter; left time: 696.5853s
Epoch: 29 cost time: 10.956597805023193
Epoch: 29, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.311 Vali Acc: 0.116 Test Loss: 10.311 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.1163213
	speed: 0.2699s/iter; left time: 3958.8153s
	iters: 200, epoch: 30 | loss: 1.5086546
	speed: 0.0512s/iter; left time: 745.2843s
Epoch: 30 cost time: 12.528655052185059
Epoch: 30, Steps: 208 | Train Loss: 0.304 Vali Loss: 10.498 Vali Acc: 0.122 Test Loss: 10.498 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.4487960
	speed: 0.2676s/iter; left time: 3869.8481s
	iters: 200, epoch: 31 | loss: 0.0571779
	speed: 0.0532s/iter; left time: 763.5501s
Epoch: 31 cost time: 11.210925817489624
Epoch: 31, Steps: 208 | Train Loss: 0.348 Vali Loss: 11.386 Vali Acc: 0.112 Test Loss: 11.386 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1285416045332538
model parameter : 829735
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7869887
	speed: 0.0918s/iter; left time: 1901.1277s
	iters: 200, epoch: 1 | loss: 4.0405707
	speed: 0.0531s/iter; left time: 1092.8901s
Epoch: 1 cost time: 15.150609016418457
Epoch: 1, Steps: 208 | Train Loss: 4.053 Vali Loss: 4.046 Vali Acc: 0.065 Test Loss: 4.046 Test Acc: 0.065
Validation loss decreased (inf --> -0.064678).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8063028
	speed: 0.2663s/iter; left time: 5456.9602s
	iters: 200, epoch: 2 | loss: 3.2847838
	speed: 0.0464s/iter; left time: 945.9489s
Epoch: 2 cost time: 10.659295558929443
Epoch: 2, Steps: 208 | Train Loss: 3.551 Vali Loss: 3.620 Vali Acc: 0.082 Test Loss: 3.620 Test Acc: 0.082
Validation loss decreased (-0.064678 --> -0.082278).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8101249
	speed: 0.2812s/iter; left time: 5704.4447s
	iters: 200, epoch: 3 | loss: 2.9762082
	speed: 0.0657s/iter; left time: 1325.6209s
Epoch: 3 cost time: 14.194350242614746
Epoch: 3, Steps: 208 | Train Loss: 3.386 Vali Loss: 3.628 Vali Acc: 0.087 Test Loss: 3.628 Test Acc: 0.087
Validation loss decreased (-0.082278 --> -0.087050).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7723033
	speed: 0.2878s/iter; left time: 5778.7391s
	iters: 200, epoch: 4 | loss: 3.3889408
	speed: 0.0600s/iter; left time: 1199.5229s
Epoch: 4 cost time: 14.199729204177856
Epoch: 4, Steps: 208 | Train Loss: 3.322 Vali Loss: 4.124 Vali Acc: 0.073 Test Loss: 4.124 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2442684
	speed: 0.2797s/iter; left time: 5557.2029s
	iters: 200, epoch: 5 | loss: 3.5279107
	speed: 0.0606s/iter; left time: 1197.7065s
Epoch: 5 cost time: 14.319874286651611
Epoch: 5, Steps: 208 | Train Loss: 3.330 Vali Loss: 3.706 Vali Acc: 0.093 Test Loss: 3.706 Test Acc: 0.093
Validation loss decreased (-0.087050 --> -0.093312).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6403048
	speed: 0.2678s/iter; left time: 5265.2486s
	iters: 200, epoch: 6 | loss: 2.9479594
	speed: 0.0647s/iter; left time: 1264.7634s
Epoch: 6 cost time: 14.396052837371826
Epoch: 6, Steps: 208 | Train Loss: 3.210 Vali Loss: 4.618 Vali Acc: 0.099 Test Loss: 4.618 Test Acc: 0.099
Validation loss decreased (-0.093312 --> -0.098671).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8653865
	speed: 0.2787s/iter; left time: 5421.7198s
	iters: 200, epoch: 7 | loss: 3.2450414
	speed: 0.0663s/iter; left time: 1282.1922s
Epoch: 7 cost time: 14.457204818725586
Epoch: 7, Steps: 208 | Train Loss: 3.108 Vali Loss: 4.135 Vali Acc: 0.097 Test Loss: 4.135 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.1828566
	speed: 0.2771s/iter; left time: 5332.4740s
	iters: 200, epoch: 8 | loss: 3.3516901
	speed: 0.0653s/iter; left time: 1249.8857s
Epoch: 8 cost time: 14.231191873550415
Epoch: 8, Steps: 208 | Train Loss: 2.927 Vali Loss: 5.020 Vali Acc: 0.111 Test Loss: 5.020 Test Acc: 0.111
Validation loss decreased (-0.098671 --> -0.110597).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4424522
	speed: 0.2792s/iter; left time: 5315.2408s
	iters: 200, epoch: 9 | loss: 3.9138949
	speed: 0.0635s/iter; left time: 1202.4616s
Epoch: 9 cost time: 14.354891777038574
Epoch: 9, Steps: 208 | Train Loss: 2.643 Vali Loss: 5.249 Vali Acc: 0.113 Test Loss: 5.249 Test Acc: 0.113
Validation loss decreased (-0.110597 --> -0.112981).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3293557
	speed: 0.2714s/iter; left time: 5109.8151s
	iters: 200, epoch: 10 | loss: 3.4867859
	speed: 0.0499s/iter; left time: 933.8903s
Epoch: 10 cost time: 11.162055015563965
Epoch: 10, Steps: 208 | Train Loss: 2.390 Vali Loss: 5.519 Vali Acc: 0.110 Test Loss: 5.519 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8378707
	speed: 0.2769s/iter; left time: 5156.5292s
	iters: 200, epoch: 11 | loss: 2.6965125
	speed: 0.0455s/iter; left time: 842.7907s
Epoch: 11 cost time: 10.853214263916016
Epoch: 11, Steps: 208 | Train Loss: 2.058 Vali Loss: 5.549 Vali Acc: 0.110 Test Loss: 5.549 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1604615
	speed: 0.2839s/iter; left time: 5227.6450s
	iters: 200, epoch: 12 | loss: 2.1337647
	speed: 0.0496s/iter; left time: 907.7530s
Epoch: 12 cost time: 11.945937156677246
Epoch: 12, Steps: 208 | Train Loss: 1.793 Vali Loss: 5.648 Vali Acc: 0.103 Test Loss: 5.648 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4274340
	speed: 0.2710s/iter; left time: 4933.2944s
	iters: 200, epoch: 13 | loss: 0.9373452
	speed: 0.0525s/iter; left time: 951.3799s
Epoch: 13 cost time: 12.726187705993652
Epoch: 13, Steps: 208 | Train Loss: 1.581 Vali Loss: 6.629 Vali Acc: 0.111 Test Loss: 6.629 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2701786
	speed: 0.2796s/iter; left time: 5032.5810s
	iters: 200, epoch: 14 | loss: 1.4593658
	speed: 0.0582s/iter; left time: 1042.3885s
Epoch: 14 cost time: 13.612453937530518
Epoch: 14, Steps: 208 | Train Loss: 1.327 Vali Loss: 6.146 Vali Acc: 0.108 Test Loss: 6.146 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3801466
	speed: 0.2837s/iter; left time: 5046.2964s
	iters: 200, epoch: 15 | loss: 1.0920755
	speed: 0.0630s/iter; left time: 1113.6491s
Epoch: 15 cost time: 13.573395013809204
Epoch: 15, Steps: 208 | Train Loss: 1.093 Vali Loss: 7.029 Vali Acc: 0.108 Test Loss: 7.029 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.8142555
	speed: 0.2579s/iter; left time: 4534.7948s
	iters: 200, epoch: 16 | loss: 0.8752186
	speed: 0.0631s/iter; left time: 1102.9119s
Epoch: 16 cost time: 13.013591289520264
Epoch: 16, Steps: 208 | Train Loss: 0.952 Vali Loss: 6.868 Vali Acc: 0.120 Test Loss: 6.868 Test Acc: 0.120
Validation loss decreased (-0.112981 --> -0.119526).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6730847
	speed: 0.2818s/iter; left time: 4896.0459s
	iters: 200, epoch: 17 | loss: 0.6382133
	speed: 0.0488s/iter; left time: 842.3863s
Epoch: 17 cost time: 11.266041278839111
Epoch: 17, Steps: 208 | Train Loss: 0.847 Vali Loss: 7.548 Vali Acc: 0.110 Test Loss: 7.548 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6940811
	speed: 0.2858s/iter; left time: 4906.2399s
	iters: 200, epoch: 18 | loss: 0.6987656
	speed: 0.0684s/iter; left time: 1167.9799s
Epoch: 18 cost time: 14.779358386993408
Epoch: 18, Steps: 208 | Train Loss: 0.701 Vali Loss: 8.028 Vali Acc: 0.106 Test Loss: 8.028 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5262874
	speed: 0.3467s/iter; left time: 5878.2093s
	iters: 200, epoch: 19 | loss: 0.6407639
	speed: 0.1062s/iter; left time: 1790.7364s
Epoch: 19 cost time: 21.91487693786621
Epoch: 19, Steps: 208 | Train Loss: 0.629 Vali Loss: 8.536 Vali Acc: 0.111 Test Loss: 8.536 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.2166818
	speed: 0.4065s/iter; left time: 6808.4997s
	iters: 200, epoch: 20 | loss: 0.8320104
	speed: 0.1174s/iter; left time: 1953.9622s
Epoch: 20 cost time: 26.172470331192017
Epoch: 20, Steps: 208 | Train Loss: 0.543 Vali Loss: 8.416 Vali Acc: 0.109 Test Loss: 8.416 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.4549453
	speed: 0.3943s/iter; left time: 6521.4128s
	iters: 200, epoch: 21 | loss: 0.6659218
	speed: 0.0887s/iter; left time: 1458.8525s
Epoch: 21 cost time: 21.801955699920654
Epoch: 21, Steps: 208 | Train Loss: 0.494 Vali Loss: 8.823 Vali Acc: 0.111 Test Loss: 8.823 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.5420724
	speed: 0.3571s/iter; left time: 5832.0839s
	iters: 200, epoch: 22 | loss: 0.6714491
	speed: 0.1094s/iter; left time: 1776.5935s
Epoch: 22 cost time: 20.838578462600708
Epoch: 22, Steps: 208 | Train Loss: 0.454 Vali Loss: 9.123 Vali Acc: 0.108 Test Loss: 9.123 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.5079721
	speed: 0.3675s/iter; left time: 5925.2267s
	iters: 200, epoch: 23 | loss: 0.7449859
	speed: 0.0958s/iter; left time: 1534.4971s
Epoch: 23 cost time: 21.934391736984253
Epoch: 23, Steps: 208 | Train Loss: 0.444 Vali Loss: 9.466 Vali Acc: 0.119 Test Loss: 9.466 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.4937032
	speed: 0.3797s/iter; left time: 6043.2463s
	iters: 200, epoch: 24 | loss: 0.5614536
	speed: 0.0911s/iter; left time: 1440.1556s
Epoch: 24 cost time: 20.953927040100098
Epoch: 24, Steps: 208 | Train Loss: 0.400 Vali Loss: 9.940 Vali Acc: 0.105 Test Loss: 9.940 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0983734
	speed: 0.3632s/iter; left time: 5705.8309s
	iters: 200, epoch: 25 | loss: 0.4269564
	speed: 0.1092s/iter; left time: 1705.2332s
Epoch: 25 cost time: 24.30449080467224
Epoch: 25, Steps: 208 | Train Loss: 0.366 Vali Loss: 10.362 Vali Acc: 0.118 Test Loss: 10.362 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.3145799
	speed: 0.3449s/iter; left time: 5345.8451s
	iters: 200, epoch: 26 | loss: 0.5544496
	speed: 0.1076s/iter; left time: 1657.4170s
Epoch: 26 cost time: 21.110223293304443
Epoch: 26, Steps: 208 | Train Loss: 0.350 Vali Loss: 10.225 Vali Acc: 0.112 Test Loss: 10.225 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11959439308082315
model parameter : 666407
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9512355
	speed: 0.1014s/iter; left time: 2099.4291s
	iters: 200, epoch: 1 | loss: 4.3574429
	speed: 0.0494s/iter; left time: 1018.2296s
Epoch: 1 cost time: 15.543817043304443
Epoch: 1, Steps: 208 | Train Loss: 3.989 Vali Loss: 3.960 Vali Acc: 0.048 Test Loss: 3.960 Test Acc: 0.048
Validation loss decreased (inf --> -0.048275).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0798302
	speed: 0.2599s/iter; left time: 5325.4036s
	iters: 200, epoch: 2 | loss: 3.6720278
	speed: 0.0451s/iter; left time: 920.5049s
Epoch: 2 cost time: 11.036985874176025
Epoch: 2, Steps: 208 | Train Loss: 3.587 Vali Loss: 3.619 Vali Acc: 0.069 Test Loss: 3.619 Test Acc: 0.069
Validation loss decreased (-0.048275 --> -0.069454).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7828584
	speed: 0.2402s/iter; left time: 4872.0555s
	iters: 200, epoch: 3 | loss: 3.0070930
	speed: 0.0468s/iter; left time: 945.1658s
Epoch: 3 cost time: 10.810638904571533
Epoch: 3, Steps: 208 | Train Loss: 3.347 Vali Loss: 3.609 Vali Acc: 0.087 Test Loss: 3.609 Test Acc: 0.087
Validation loss decreased (-0.069454 --> -0.086752).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9083111
	speed: 0.2449s/iter; left time: 4917.2842s
	iters: 200, epoch: 4 | loss: 3.2039540
	speed: 0.0484s/iter; left time: 966.5728s
Epoch: 4 cost time: 11.347040891647339
Epoch: 4, Steps: 208 | Train Loss: 3.328 Vali Loss: 3.840 Vali Acc: 0.093 Test Loss: 3.840 Test Acc: 0.093
Validation loss decreased (-0.086752 --> -0.093311).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5407670
	speed: 0.2542s/iter; left time: 5051.1894s
	iters: 200, epoch: 5 | loss: 3.9765062
	speed: 0.0492s/iter; left time: 972.4667s
Epoch: 5 cost time: 11.196973323822021
Epoch: 5, Steps: 208 | Train Loss: 3.127 Vali Loss: 4.072 Vali Acc: 0.093 Test Loss: 4.072 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6353781
	speed: 0.2442s/iter; left time: 4801.1779s
	iters: 200, epoch: 6 | loss: 3.6457322
	speed: 0.0441s/iter; left time: 862.7218s
Epoch: 6 cost time: 9.934623718261719
Epoch: 6, Steps: 208 | Train Loss: 3.064 Vali Loss: 3.971 Vali Acc: 0.101 Test Loss: 3.971 Test Acc: 0.101
Validation loss decreased (-0.093311 --> -0.101064).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0884533
	speed: 0.2403s/iter; left time: 4675.0929s
	iters: 200, epoch: 7 | loss: 2.1837187
	speed: 0.0412s/iter; left time: 797.4648s
Epoch: 7 cost time: 10.21947693824768
Epoch: 7, Steps: 208 | Train Loss: 2.922 Vali Loss: 4.908 Vali Acc: 0.100 Test Loss: 4.908 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1644900
	speed: 0.2577s/iter; left time: 4960.0951s
	iters: 200, epoch: 8 | loss: 3.1322045
	speed: 0.0681s/iter; left time: 1303.0507s
Epoch: 8 cost time: 13.664433479309082
Epoch: 8, Steps: 208 | Train Loss: 2.751 Vali Loss: 4.660 Vali Acc: 0.096 Test Loss: 4.660 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5220957
	speed: 0.3085s/iter; left time: 5872.6135s
	iters: 200, epoch: 9 | loss: 4.1063352
	speed: 0.0831s/iter; left time: 1573.7020s
Epoch: 9 cost time: 18.661869287490845
Epoch: 9, Steps: 208 | Train Loss: 2.467 Vali Loss: 5.073 Vali Acc: 0.099 Test Loss: 5.073 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.2022450
	speed: 0.2925s/iter; left time: 5507.5667s
	iters: 200, epoch: 10 | loss: 2.7980087
	speed: 0.0753s/iter; left time: 1410.1616s
Epoch: 10 cost time: 16.50204825401306
Epoch: 10, Steps: 208 | Train Loss: 2.200 Vali Loss: 5.745 Vali Acc: 0.111 Test Loss: 5.745 Test Acc: 0.111
Validation loss decreased (-0.101064 --> -0.111186).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0860004
	speed: 0.3021s/iter; left time: 5624.4737s
	iters: 200, epoch: 11 | loss: 2.2376561
	speed: 0.0664s/iter; left time: 1230.2023s
Epoch: 11 cost time: 15.844443798065186
Epoch: 11, Steps: 208 | Train Loss: 2.001 Vali Loss: 6.107 Vali Acc: 0.109 Test Loss: 6.107 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2060997
	speed: 0.3087s/iter; left time: 5683.9821s
	iters: 200, epoch: 12 | loss: 1.7624092
	speed: 0.0811s/iter; left time: 1484.7547s
Epoch: 12 cost time: 17.521964073181152
Epoch: 12, Steps: 208 | Train Loss: 1.738 Vali Loss: 6.686 Vali Acc: 0.097 Test Loss: 6.686 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5498074
	speed: 0.3040s/iter; left time: 5534.9472s
	iters: 200, epoch: 13 | loss: 1.6176291
	speed: 0.0708s/iter; left time: 1280.9597s
Epoch: 13 cost time: 15.868645429611206
Epoch: 13, Steps: 208 | Train Loss: 1.545 Vali Loss: 6.618 Vali Acc: 0.110 Test Loss: 6.618 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.7172692
	speed: 0.2963s/iter; left time: 5332.4816s
	iters: 200, epoch: 14 | loss: 0.7598935
	speed: 0.0699s/iter; left time: 1250.3075s
Epoch: 14 cost time: 15.517263412475586
Epoch: 14, Steps: 208 | Train Loss: 1.314 Vali Loss: 7.069 Vali Acc: 0.115 Test Loss: 7.069 Test Acc: 0.115
Validation loss decreased (-0.111186 --> -0.115050).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0521119
	speed: 0.2850s/iter; left time: 5069.0096s
	iters: 200, epoch: 15 | loss: 0.7200505
	speed: 0.0580s/iter; left time: 1025.4786s
Epoch: 15 cost time: 13.116238594055176
Epoch: 15, Steps: 208 | Train Loss: 1.128 Vali Loss: 6.832 Vali Acc: 0.107 Test Loss: 6.832 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0082490
	speed: 0.2748s/iter; left time: 4831.3054s
	iters: 200, epoch: 16 | loss: 1.0711232
	speed: 0.0639s/iter; left time: 1117.3267s
Epoch: 16 cost time: 14.619614124298096
Epoch: 16, Steps: 208 | Train Loss: 0.985 Vali Loss: 7.026 Vali Acc: 0.116 Test Loss: 7.026 Test Acc: 0.116
Validation loss decreased (-0.115050 --> -0.115945).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6783166
	speed: 0.2628s/iter; left time: 4565.4163s
	iters: 200, epoch: 17 | loss: 1.3933997
	speed: 0.0593s/iter; left time: 1024.9110s
Epoch: 17 cost time: 12.799030780792236
Epoch: 17, Steps: 208 | Train Loss: 0.821 Vali Loss: 7.691 Vali Acc: 0.106 Test Loss: 7.691 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2381636
	speed: 0.2609s/iter; left time: 4477.9601s
	iters: 200, epoch: 18 | loss: 1.2851374
	speed: 0.0599s/iter; left time: 1021.7924s
Epoch: 18 cost time: 12.744723796844482
Epoch: 18, Steps: 208 | Train Loss: 0.735 Vali Loss: 8.290 Vali Acc: 0.106 Test Loss: 8.290 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4810999
	speed: 0.2888s/iter; left time: 4897.7334s
	iters: 200, epoch: 19 | loss: 0.7037777
	speed: 0.0489s/iter; left time: 825.1134s
Epoch: 19 cost time: 11.52016806602478
Epoch: 19, Steps: 208 | Train Loss: 0.670 Vali Loss: 8.597 Vali Acc: 0.106 Test Loss: 8.597 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3217550
	speed: 0.2774s/iter; left time: 4646.1660s
	iters: 200, epoch: 20 | loss: 0.7684841
	speed: 0.0496s/iter; left time: 825.5198s
Epoch: 20 cost time: 12.197916984558105
Epoch: 20, Steps: 208 | Train Loss: 0.583 Vali Loss: 8.589 Vali Acc: 0.099 Test Loss: 8.589 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2471011
	speed: 0.2689s/iter; left time: 4447.4105s
	iters: 200, epoch: 21 | loss: 0.4889855
	speed: 0.0552s/iter; left time: 908.2671s
Epoch: 21 cost time: 12.348720788955688
Epoch: 21, Steps: 208 | Train Loss: 0.557 Vali Loss: 9.088 Vali Acc: 0.113 Test Loss: 9.088 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3767850
	speed: 0.2446s/iter; left time: 3995.0237s
	iters: 200, epoch: 22 | loss: 0.4541788
	speed: 0.0471s/iter; left time: 764.4135s
Epoch: 22 cost time: 10.942278861999512
Epoch: 22, Steps: 208 | Train Loss: 0.516 Vali Loss: 9.854 Vali Acc: 0.104 Test Loss: 9.854 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2707388
	speed: 0.2713s/iter; left time: 4374.8319s
	iters: 200, epoch: 23 | loss: 0.2670968
	speed: 0.0497s/iter; left time: 796.3897s
Epoch: 23 cost time: 12.302692174911499
Epoch: 23, Steps: 208 | Train Loss: 0.509 Vali Loss: 9.455 Vali Acc: 0.109 Test Loss: 9.455 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.5068799
	speed: 0.2843s/iter; left time: 4525.1369s
	iters: 200, epoch: 24 | loss: 0.4197174
	speed: 0.0499s/iter; left time: 789.8903s
Epoch: 24 cost time: 11.556618213653564
Epoch: 24, Steps: 208 | Train Loss: 0.415 Vali Loss: 9.937 Vali Acc: 0.101 Test Loss: 9.937 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.4394809
	speed: 0.2815s/iter; left time: 4421.5028s
	iters: 200, epoch: 25 | loss: 0.5011995
	speed: 0.0527s/iter; left time: 822.1574s
Epoch: 25 cost time: 12.591270446777344
Epoch: 25, Steps: 208 | Train Loss: 0.418 Vali Loss: 10.051 Vali Acc: 0.108 Test Loss: 10.051 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1704709
	speed: 0.3025s/iter; left time: 4688.6414s
	iters: 200, epoch: 26 | loss: 0.7025678
	speed: 0.0715s/iter; left time: 1100.5679s
Epoch: 26 cost time: 16.497387409210205
Epoch: 26, Steps: 208 | Train Loss: 0.412 Vali Loss: 10.564 Vali Acc: 0.108 Test Loss: 10.564 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm128_nh16_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11601550849985089
model parameter : 557991
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3967633
	speed: 0.1514s/iter; left time: 3133.7944s
	iters: 200, epoch: 1 | loss: 4.1883063
	speed: 0.1141s/iter; left time: 2350.9704s
Epoch: 1 cost time: 27.602696895599365
Epoch: 1, Steps: 208 | Train Loss: 4.712 Vali Loss: 3.815 Vali Acc: 0.044 Test Loss: 3.815 Test Acc: 0.044
Validation loss decreased (inf --> -0.043505).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3764772
	speed: 0.4093s/iter; left time: 8387.3986s
	iters: 200, epoch: 2 | loss: 4.3353844
	speed: 0.1191s/iter; left time: 2429.0106s
Epoch: 2 cost time: 24.901931047439575
Epoch: 2, Steps: 208 | Train Loss: 3.621 Vali Loss: 4.759 Vali Acc: 0.057 Test Loss: 4.759 Test Acc: 0.057
Validation loss decreased (-0.043505 --> -0.057215).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4717054
	speed: 0.4018s/iter; left time: 8151.0054s
	iters: 200, epoch: 3 | loss: 3.6433091
	speed: 0.1164s/iter; left time: 2350.2943s
Epoch: 3 cost time: 24.682585954666138
Epoch: 3, Steps: 208 | Train Loss: 3.889 Vali Loss: 4.194 Vali Acc: 0.095 Test Loss: 4.194 Test Acc: 0.095
Validation loss decreased (-0.057215 --> -0.094500).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6159053
	speed: 0.4145s/iter; left time: 8322.0391s
	iters: 200, epoch: 4 | loss: 3.6821079
	speed: 0.1062s/iter; left time: 2121.7359s
Epoch: 4 cost time: 23.4103901386261
Epoch: 4, Steps: 208 | Train Loss: 4.142 Vali Loss: 4.792 Vali Acc: 0.106 Test Loss: 4.792 Test Acc: 0.106
Validation loss decreased (-0.094500 --> -0.106424).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6984894
	speed: 0.3900s/iter; left time: 7749.3243s
	iters: 200, epoch: 5 | loss: 4.2661915
	speed: 0.1039s/iter; left time: 2053.3998s
Epoch: 5 cost time: 22.64306402206421
Epoch: 5, Steps: 208 | Train Loss: 4.070 Vali Loss: 5.214 Vali Acc: 0.107 Test Loss: 5.214 Test Acc: 0.107
Validation loss decreased (-0.106424 --> -0.107016).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.0585127
	speed: 0.4079s/iter; left time: 8019.8920s
	iters: 200, epoch: 6 | loss: 3.6195385
	speed: 0.0967s/iter; left time: 1892.4334s
Epoch: 6 cost time: 22.518187046051025
Epoch: 6, Steps: 208 | Train Loss: 3.920 Vali Loss: 5.262 Vali Acc: 0.110 Test Loss: 5.262 Test Acc: 0.110
Validation loss decreased (-0.107016 --> -0.110296).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8088312
	speed: 0.3305s/iter; left time: 6428.4125s
	iters: 200, epoch: 7 | loss: 2.5861909
	speed: 0.0698s/iter; left time: 1350.7838s
Epoch: 7 cost time: 16.35148549079895
Epoch: 7, Steps: 208 | Train Loss: 3.378 Vali Loss: 5.784 Vali Acc: 0.117 Test Loss: 5.784 Test Acc: 0.117
Validation loss decreased (-0.110296 --> -0.116852).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9164990
	speed: 0.3608s/iter; left time: 6942.7183s
	iters: 200, epoch: 8 | loss: 3.8194942
	speed: 0.0816s/iter; left time: 1561.6005s
Epoch: 8 cost time: 17.791470527648926
Epoch: 8, Steps: 208 | Train Loss: 2.712 Vali Loss: 6.214 Vali Acc: 0.109 Test Loss: 6.214 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5235827
	speed: 0.3587s/iter; left time: 6828.3171s
	iters: 200, epoch: 9 | loss: 2.8988676
	speed: 0.0746s/iter; left time: 1411.7820s
Epoch: 9 cost time: 17.19447088241577
Epoch: 9, Steps: 208 | Train Loss: 1.931 Vali Loss: 6.754 Vali Acc: 0.092 Test Loss: 6.754 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2687542
	speed: 0.3256s/iter; left time: 6131.5878s
	iters: 200, epoch: 10 | loss: 1.2042711
	speed: 0.0705s/iter; left time: 1320.4419s
Epoch: 10 cost time: 16.654022932052612
Epoch: 10, Steps: 208 | Train Loss: 1.468 Vali Loss: 6.946 Vali Acc: 0.115 Test Loss: 6.946 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1704487
	speed: 0.3304s/iter; left time: 6151.8369s
	iters: 200, epoch: 11 | loss: 1.3316731
	speed: 0.0790s/iter; left time: 1462.9449s
Epoch: 11 cost time: 17.62791657447815
Epoch: 11, Steps: 208 | Train Loss: 1.144 Vali Loss: 6.644 Vali Acc: 0.111 Test Loss: 6.644 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1778729
	speed: 0.3485s/iter; left time: 6417.4134s
	iters: 200, epoch: 12 | loss: 1.3230903
	speed: 0.0764s/iter; left time: 1399.4632s
Epoch: 12 cost time: 17.160386323928833
Epoch: 12, Steps: 208 | Train Loss: 0.950 Vali Loss: 7.878 Vali Acc: 0.122 Test Loss: 7.878 Test Acc: 0.122
Validation loss decreased (-0.116852 --> -0.121603).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8288956
	speed: 0.3524s/iter; left time: 6414.9698s
	iters: 200, epoch: 13 | loss: 0.6995344
	speed: 0.1195s/iter; left time: 2163.7080s
Epoch: 13 cost time: 22.76715064048767
Epoch: 13, Steps: 208 | Train Loss: 0.772 Vali Loss: 8.232 Vali Acc: 0.125 Test Loss: 8.232 Test Acc: 0.125
Validation loss decreased (-0.121603 --> -0.124582).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5900295
	speed: 0.4305s/iter; left time: 7747.0148s
	iters: 200, epoch: 14 | loss: 0.9215573
	speed: 0.1238s/iter; left time: 2214.8278s
Epoch: 14 cost time: 25.284676790237427
Epoch: 14, Steps: 208 | Train Loss: 0.667 Vali Loss: 8.374 Vali Acc: 0.118 Test Loss: 8.374 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1115362
	speed: 0.4130s/iter; left time: 7347.2158s
	iters: 200, epoch: 15 | loss: 0.3766628
	speed: 0.1076s/iter; left time: 1903.0279s
Epoch: 15 cost time: 22.786720275878906
Epoch: 15, Steps: 208 | Train Loss: 0.588 Vali Loss: 9.125 Vali Acc: 0.120 Test Loss: 9.125 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5156347
	speed: 0.4045s/iter; left time: 7111.2110s
	iters: 200, epoch: 16 | loss: 0.4278524
	speed: 0.1150s/iter; left time: 2010.3998s
Epoch: 16 cost time: 23.74001383781433
Epoch: 16, Steps: 208 | Train Loss: 0.483 Vali Loss: 10.189 Vali Acc: 0.119 Test Loss: 10.189 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4376224
	speed: 0.3916s/iter; left time: 6803.3151s
	iters: 200, epoch: 17 | loss: 0.4309486
	speed: 0.1136s/iter; left time: 1962.6991s
Epoch: 17 cost time: 23.286839246749878
Epoch: 17, Steps: 208 | Train Loss: 0.392 Vali Loss: 9.633 Vali Acc: 0.122 Test Loss: 9.633 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2227141
	speed: 0.4032s/iter; left time: 6921.3803s
	iters: 200, epoch: 18 | loss: 0.2489166
	speed: 0.1094s/iter; left time: 1866.1400s
Epoch: 18 cost time: 23.681360483169556
Epoch: 18, Steps: 208 | Train Loss: 0.319 Vali Loss: 10.854 Vali Acc: 0.126 Test Loss: 10.854 Test Acc: 0.126
Validation loss decreased (-0.124582 --> -0.126345).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.2018138
	speed: 0.3834s/iter; left time: 6500.9683s
	iters: 200, epoch: 19 | loss: 0.0602040
	speed: 0.0989s/iter; left time: 1666.6113s
Epoch: 19 cost time: 21.495867490768433
Epoch: 19, Steps: 208 | Train Loss: 0.276 Vali Loss: 10.698 Vali Acc: 0.120 Test Loss: 10.698 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0402849
	speed: 0.4166s/iter; left time: 6976.9262s
	iters: 200, epoch: 20 | loss: 0.8344198
	speed: 0.1247s/iter; left time: 2076.3943s
Epoch: 20 cost time: 26.655132293701172
Epoch: 20, Steps: 208 | Train Loss: 0.227 Vali Loss: 11.482 Vali Acc: 0.117 Test Loss: 11.482 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1719212
	speed: 0.4186s/iter; left time: 6924.6996s
	iters: 200, epoch: 21 | loss: 0.0107624
	speed: 0.0902s/iter; left time: 1483.1869s
Epoch: 21 cost time: 21.81668186187744
Epoch: 21, Steps: 208 | Train Loss: 0.211 Vali Loss: 11.160 Vali Acc: 0.129 Test Loss: 11.160 Test Acc: 0.129
Validation loss decreased (-0.126345 --> -0.128728).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.3354671
	speed: 0.4001s/iter; left time: 6535.0797s
	iters: 200, epoch: 22 | loss: 0.2099003
	speed: 0.1059s/iter; left time: 1719.0132s
Epoch: 22 cost time: 23.345202922821045
Epoch: 22, Steps: 208 | Train Loss: 0.238 Vali Loss: 10.796 Vali Acc: 0.123 Test Loss: 10.796 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4970193
	speed: 0.3991s/iter; left time: 6435.3631s
	iters: 200, epoch: 23 | loss: 0.0419872
	speed: 0.1047s/iter; left time: 1678.1368s
Epoch: 23 cost time: 21.816397428512573
Epoch: 23, Steps: 208 | Train Loss: 0.206 Vali Loss: 13.023 Vali Acc: 0.116 Test Loss: 13.023 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1540034
	speed: 0.3528s/iter; left time: 5615.4861s
	iters: 200, epoch: 24 | loss: 0.4853823
	speed: 0.0839s/iter; left time: 1327.6948s
Epoch: 24 cost time: 19.088459491729736
Epoch: 24, Steps: 208 | Train Loss: 0.178 Vali Loss: 11.937 Vali Acc: 0.116 Test Loss: 11.937 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0978150
	speed: 0.3409s/iter; left time: 5354.5603s
	iters: 200, epoch: 25 | loss: 0.4936637
	speed: 0.1002s/iter; left time: 1564.3350s
Epoch: 25 cost time: 20.105393171310425
Epoch: 25, Steps: 208 | Train Loss: 0.140 Vali Loss: 12.947 Vali Acc: 0.126 Test Loss: 12.947 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.9050308
	speed: 0.3897s/iter; left time: 6040.2703s
	iters: 200, epoch: 26 | loss: 0.3212099
	speed: 0.0969s/iter; left time: 1492.1351s
Epoch: 26 cost time: 21.355811834335327
Epoch: 26, Steps: 208 | Train Loss: 0.157 Vali Loss: 13.243 Vali Acc: 0.122 Test Loss: 13.243 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0366270
	speed: 0.3756s/iter; left time: 5744.6231s
	iters: 200, epoch: 27 | loss: 0.5095505
	speed: 0.0847s/iter; left time: 1286.9652s
Epoch: 27 cost time: 19.92820119857788
Epoch: 27, Steps: 208 | Train Loss: 0.132 Vali Loss: 12.809 Vali Acc: 0.120 Test Loss: 12.809 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0437060
	speed: 0.4105s/iter; left time: 6191.9667s
	iters: 200, epoch: 28 | loss: 0.3620640
	speed: 0.1063s/iter; left time: 1593.1892s
Epoch: 28 cost time: 24.073712825775146
Epoch: 28, Steps: 208 | Train Loss: 0.130 Vali Loss: 14.107 Vali Acc: 0.119 Test Loss: 14.107 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1451417
	speed: 0.3897s/iter; left time: 5797.3610s
	iters: 200, epoch: 29 | loss: 0.4787686
	speed: 0.1037s/iter; left time: 1531.7292s
Epoch: 29 cost time: 22.23891544342041
Epoch: 29, Steps: 208 | Train Loss: 0.143 Vali Loss: 13.294 Vali Acc: 0.119 Test Loss: 13.294 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.2345216
	speed: 0.4090s/iter; left time: 6000.2684s
	iters: 200, epoch: 30 | loss: 0.0762758
	speed: 0.1336s/iter; left time: 1946.8896s
Epoch: 30 cost time: 27.303942680358887
Epoch: 30, Steps: 208 | Train Loss: 0.144 Vali Loss: 14.001 Vali Acc: 0.118 Test Loss: 14.001 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0020028
	speed: 0.4601s/iter; left time: 6654.0876s
	iters: 200, epoch: 31 | loss: 0.0709120
	speed: 0.1174s/iter; left time: 1685.4924s
Epoch: 31 cost time: 26.732511520385742
Epoch: 31, Steps: 208 | Train Loss: 0.121 Vali Loss: 14.581 Vali Acc: 0.123 Test Loss: 14.581 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1288398449150015
model parameter : 2077351
model size : 9.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.4785590
	speed: 0.1090s/iter; left time: 2255.7357s
	iters: 200, epoch: 1 | loss: 3.9871919
	speed: 0.0790s/iter; left time: 1626.9750s
Epoch: 1 cost time: 19.606709480285645
Epoch: 1, Steps: 208 | Train Loss: 4.301 Vali Loss: 3.803 Vali Acc: 0.066 Test Loss: 3.803 Test Acc: 0.066
Validation loss decreased (inf --> -0.065575).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1790273
	speed: 0.3070s/iter; left time: 6290.7451s
	iters: 200, epoch: 2 | loss: 3.2023506
	speed: 0.0723s/iter; left time: 1473.7323s
Epoch: 2 cost time: 15.98672604560852
Epoch: 2, Steps: 208 | Train Loss: 3.372 Vali Loss: 3.586 Vali Acc: 0.091 Test Loss: 3.586 Test Acc: 0.091
Validation loss decreased (-0.065575 --> -0.090629).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0034707
	speed: 0.2878s/iter; left time: 5837.0383s
	iters: 200, epoch: 3 | loss: 3.3789983
	speed: 0.0657s/iter; left time: 1326.5615s
Epoch: 3 cost time: 14.282755136489868
Epoch: 3, Steps: 208 | Train Loss: 3.364 Vali Loss: 3.700 Vali Acc: 0.091 Test Loss: 3.700 Test Acc: 0.091
Validation loss decreased (-0.090629 --> -0.090926).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8451991
	speed: 0.3013s/iter; left time: 6049.2345s
	iters: 200, epoch: 4 | loss: 3.8083842
	speed: 0.0532s/iter; left time: 1063.0356s
Epoch: 4 cost time: 12.72419810295105
Epoch: 4, Steps: 208 | Train Loss: 3.440 Vali Loss: 4.639 Vali Acc: 0.078 Test Loss: 4.639 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2251153
	speed: 0.2855s/iter; left time: 5672.6250s
	iters: 200, epoch: 5 | loss: 3.3530824
	speed: 0.0605s/iter; left time: 1196.3317s
Epoch: 5 cost time: 14.656140565872192
Epoch: 5, Steps: 208 | Train Loss: 3.453 Vali Loss: 5.196 Vali Acc: 0.091 Test Loss: 5.196 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.8485579
	speed: 0.2805s/iter; left time: 5515.1350s
	iters: 200, epoch: 6 | loss: 3.2724459
	speed: 0.0654s/iter; left time: 1280.0750s
Epoch: 6 cost time: 14.235008716583252
Epoch: 6, Steps: 208 | Train Loss: 3.309 Vali Loss: 4.751 Vali Acc: 0.112 Test Loss: 4.751 Test Acc: 0.112
Validation loss decreased (-0.090926 --> -0.111793).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4850757
	speed: 0.2665s/iter; left time: 5185.1710s
	iters: 200, epoch: 7 | loss: 3.6621053
	speed: 0.0605s/iter; left time: 1171.5173s
Epoch: 7 cost time: 13.207519292831421
Epoch: 7, Steps: 208 | Train Loss: 3.070 Vali Loss: 4.488 Vali Acc: 0.117 Test Loss: 4.488 Test Acc: 0.117
Validation loss decreased (-0.111793 --> -0.116567).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5577140
	speed: 0.2552s/iter; left time: 4912.1095s
	iters: 200, epoch: 8 | loss: 3.6283562
	speed: 0.0561s/iter; left time: 1073.9169s
Epoch: 8 cost time: 12.550074815750122
Epoch: 8, Steps: 208 | Train Loss: 2.686 Vali Loss: 4.668 Vali Acc: 0.119 Test Loss: 4.668 Test Acc: 0.119
Validation loss decreased (-0.116567 --> -0.119249).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0820336
	speed: 0.2770s/iter; left time: 5274.1818s
	iters: 200, epoch: 9 | loss: 2.3171511
	speed: 0.0576s/iter; left time: 1091.0840s
Epoch: 9 cost time: 12.661815166473389
Epoch: 9, Steps: 208 | Train Loss: 2.149 Vali Loss: 5.296 Vali Acc: 0.129 Test Loss: 5.296 Test Acc: 0.129
Validation loss decreased (-0.119249 --> -0.129085).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1188865
	speed: 0.2877s/iter; left time: 5416.5928s
	iters: 200, epoch: 10 | loss: 2.1443076
	speed: 0.0685s/iter; left time: 1282.9590s
Epoch: 10 cost time: 13.9248788356781
Epoch: 10, Steps: 208 | Train Loss: 1.718 Vali Loss: 5.943 Vali Acc: 0.107 Test Loss: 5.943 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8829101
	speed: 0.2981s/iter; left time: 5550.7068s
	iters: 200, epoch: 11 | loss: 2.1771770
	speed: 0.0869s/iter; left time: 1608.7035s
Epoch: 11 cost time: 18.312715530395508
Epoch: 11, Steps: 208 | Train Loss: 1.447 Vali Loss: 5.869 Vali Acc: 0.123 Test Loss: 5.869 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0340196
	speed: 0.3072s/iter; left time: 5656.7887s
	iters: 200, epoch: 12 | loss: 2.1039476
	speed: 0.0801s/iter; left time: 1466.1577s
Epoch: 12 cost time: 16.74234104156494
Epoch: 12, Steps: 208 | Train Loss: 1.166 Vali Loss: 6.864 Vali Acc: 0.123 Test Loss: 6.864 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1491617
	speed: 0.3198s/iter; left time: 5821.5435s
	iters: 200, epoch: 13 | loss: 0.8336978
	speed: 0.0728s/iter; left time: 1317.9983s
Epoch: 13 cost time: 16.599754333496094
Epoch: 13, Steps: 208 | Train Loss: 0.955 Vali Loss: 6.768 Vali Acc: 0.134 Test Loss: 6.768 Test Acc: 0.134
Validation loss decreased (-0.129085 --> -0.133544).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5148918
	speed: 0.2720s/iter; left time: 4895.7419s
	iters: 200, epoch: 14 | loss: 1.0110635
	speed: 0.0718s/iter; left time: 1285.8199s
Epoch: 14 cost time: 14.909294605255127
Epoch: 14, Steps: 208 | Train Loss: 0.812 Vali Loss: 7.179 Vali Acc: 0.141 Test Loss: 7.179 Test Acc: 0.141
Validation loss decreased (-0.133544 --> -0.141294).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7643991
	speed: 0.2799s/iter; left time: 4979.4521s
	iters: 200, epoch: 15 | loss: 0.7572044
	speed: 0.0671s/iter; left time: 1186.9674s
Epoch: 15 cost time: 15.375783205032349
Epoch: 15, Steps: 208 | Train Loss: 0.692 Vali Loss: 7.435 Vali Acc: 0.138 Test Loss: 7.435 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3856940
	speed: 0.2769s/iter; left time: 4869.0053s
	iters: 200, epoch: 16 | loss: 0.5376331
	speed: 0.0750s/iter; left time: 1311.1899s
Epoch: 16 cost time: 16.417151927947998
Epoch: 16, Steps: 208 | Train Loss: 0.584 Vali Loss: 7.671 Vali Acc: 0.138 Test Loss: 7.671 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4771808
	speed: 0.2991s/iter; left time: 5196.5278s
	iters: 200, epoch: 17 | loss: 0.4522942
	speed: 0.0780s/iter; left time: 1347.3332s
Epoch: 17 cost time: 16.864163398742676
Epoch: 17, Steps: 208 | Train Loss: 0.468 Vali Loss: 8.773 Vali Acc: 0.139 Test Loss: 8.773 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3522817
	speed: 0.3084s/iter; left time: 5294.3428s
	iters: 200, epoch: 18 | loss: 0.2042205
	speed: 0.0728s/iter; left time: 1242.2302s
Epoch: 18 cost time: 16.375486373901367
Epoch: 18, Steps: 208 | Train Loss: 0.427 Vali Loss: 9.250 Vali Acc: 0.135 Test Loss: 9.250 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1507602
	speed: 0.2944s/iter; left time: 4991.7617s
	iters: 200, epoch: 19 | loss: 0.4042361
	speed: 0.0496s/iter; left time: 836.2125s
Epoch: 19 cost time: 11.773544549942017
Epoch: 19, Steps: 208 | Train Loss: 0.351 Vali Loss: 9.456 Vali Acc: 0.132 Test Loss: 9.456 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1094435
	speed: 0.2681s/iter; left time: 4490.4494s
	iters: 200, epoch: 20 | loss: 0.4336848
	speed: 0.0527s/iter; left time: 878.1019s
Epoch: 20 cost time: 11.949970960617065
Epoch: 20, Steps: 208 | Train Loss: 0.310 Vali Loss: 9.897 Vali Acc: 0.136 Test Loss: 9.897 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0462460
	speed: 0.2635s/iter; left time: 4359.2928s
	iters: 200, epoch: 21 | loss: 0.0569712
	speed: 0.0535s/iter; left time: 878.8529s
Epoch: 21 cost time: 12.097338438034058
Epoch: 21, Steps: 208 | Train Loss: 0.313 Vali Loss: 9.682 Vali Acc: 0.131 Test Loss: 9.682 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1653192
	speed: 0.2760s/iter; left time: 4508.6690s
	iters: 200, epoch: 22 | loss: 0.7470294
	speed: 0.0528s/iter; left time: 857.6658s
Epoch: 22 cost time: 12.257965087890625
Epoch: 22, Steps: 208 | Train Loss: 0.253 Vali Loss: 10.966 Vali Acc: 0.131 Test Loss: 10.966 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.4155669
	speed: 0.2725s/iter; left time: 4393.6003s
	iters: 200, epoch: 23 | loss: 0.2731780
	speed: 0.0548s/iter; left time: 878.2864s
Epoch: 23 cost time: 12.201887845993042
Epoch: 23, Steps: 208 | Train Loss: 0.231 Vali Loss: 10.723 Vali Acc: 0.127 Test Loss: 10.723 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2390143
	speed: 0.2453s/iter; left time: 3903.8788s
	iters: 200, epoch: 24 | loss: 0.1741836
	speed: 0.0496s/iter; left time: 784.8452s
Epoch: 24 cost time: 11.417689561843872
Epoch: 24, Steps: 208 | Train Loss: 0.221 Vali Loss: 10.587 Vali Acc: 0.132 Test Loss: 10.587 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1413659409484044
model parameter : 1089255
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4990158
	speed: 0.1148s/iter; left time: 2376.5954s
	iters: 200, epoch: 1 | loss: 4.1312075
	speed: 0.0751s/iter; left time: 1546.2717s
Epoch: 1 cost time: 19.82710337638855
Epoch: 1, Steps: 208 | Train Loss: 4.147 Vali Loss: 4.049 Vali Acc: 0.066 Test Loss: 4.049 Test Acc: 0.066
Validation loss decreased (inf --> -0.065871).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1388106
	speed: 0.3487s/iter; left time: 7145.4957s
	iters: 200, epoch: 2 | loss: 3.9146514
	speed: 0.0769s/iter; left time: 1567.7736s
Epoch: 2 cost time: 18.146462440490723
Epoch: 2, Steps: 208 | Train Loss: 3.401 Vali Loss: 3.803 Vali Acc: 0.075 Test Loss: 3.803 Test Acc: 0.075
Validation loss decreased (-0.065871 --> -0.074820).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4609692
	speed: 0.3346s/iter; left time: 6787.9020s
	iters: 200, epoch: 3 | loss: 3.9922862
	speed: 0.0845s/iter; left time: 1705.3564s
Epoch: 3 cost time: 18.55867028236389
Epoch: 3, Steps: 208 | Train Loss: 3.285 Vali Loss: 4.022 Vali Acc: 0.095 Test Loss: 4.022 Test Acc: 0.095
Validation loss decreased (-0.074820 --> -0.095098).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9471982
	speed: 0.3036s/iter; left time: 6094.5444s
	iters: 200, epoch: 4 | loss: 4.0988359
	speed: 0.0695s/iter; left time: 1388.2349s
Epoch: 4 cost time: 15.487591981887817
Epoch: 4, Steps: 208 | Train Loss: 3.274 Vali Loss: 3.966 Vali Acc: 0.106 Test Loss: 3.966 Test Acc: 0.106
Validation loss decreased (-0.095098 --> -0.106432).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6914394
	speed: 0.2925s/iter; left time: 5812.0318s
	iters: 200, epoch: 5 | loss: 3.2277942
	speed: 0.0651s/iter; left time: 1287.7354s
Epoch: 5 cost time: 14.912765502929688
Epoch: 5, Steps: 208 | Train Loss: 3.257 Vali Loss: 4.119 Vali Acc: 0.101 Test Loss: 4.119 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6659248
	speed: 0.3005s/iter; left time: 5907.4944s
	iters: 200, epoch: 6 | loss: 4.0051289
	speed: 0.0684s/iter; left time: 1337.6562s
Epoch: 6 cost time: 15.67949891090393
Epoch: 6, Steps: 208 | Train Loss: 3.081 Vali Loss: 4.050 Vali Acc: 0.113 Test Loss: 4.050 Test Acc: 0.113
Validation loss decreased (-0.106432 --> -0.113291).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7646289
	speed: 0.3232s/iter; left time: 6287.2159s
	iters: 200, epoch: 7 | loss: 2.5697958
	speed: 0.0722s/iter; left time: 1398.2199s
Epoch: 7 cost time: 17.069319486618042
Epoch: 7, Steps: 208 | Train Loss: 2.891 Vali Loss: 4.621 Vali Acc: 0.115 Test Loss: 4.621 Test Acc: 0.115
Validation loss decreased (-0.113291 --> -0.114776).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4514050
	speed: 0.3234s/iter; left time: 6224.2274s
	iters: 200, epoch: 8 | loss: 2.6090486
	speed: 0.0753s/iter; left time: 1442.1130s
Epoch: 8 cost time: 16.65367102622986
Epoch: 8, Steps: 208 | Train Loss: 2.565 Vali Loss: 4.809 Vali Acc: 0.122 Test Loss: 4.809 Test Acc: 0.122
Validation loss decreased (-0.114776 --> -0.121634).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5632524
	speed: 0.2920s/iter; left time: 5558.0590s
	iters: 200, epoch: 9 | loss: 2.8833489
	speed: 0.0483s/iter; left time: 914.5248s
Epoch: 9 cost time: 12.221503496170044
Epoch: 9, Steps: 208 | Train Loss: 2.237 Vali Loss: 5.184 Vali Acc: 0.115 Test Loss: 5.184 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0134110
	speed: 0.2975s/iter; left time: 5602.4058s
	iters: 200, epoch: 10 | loss: 1.3262464
	speed: 0.0598s/iter; left time: 1119.7066s
Epoch: 10 cost time: 14.366182565689087
Epoch: 10, Steps: 208 | Train Loss: 1.911 Vali Loss: 5.249 Vali Acc: 0.116 Test Loss: 5.249 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.0188701
	speed: 0.3071s/iter; left time: 5717.6478s
	iters: 200, epoch: 11 | loss: 0.7529349
	speed: 0.0601s/iter; left time: 1113.1013s
Epoch: 11 cost time: 13.704219579696655
Epoch: 11, Steps: 208 | Train Loss: 1.566 Vali Loss: 5.461 Vali Acc: 0.129 Test Loss: 5.461 Test Acc: 0.129
Validation loss decreased (-0.121634 --> -0.128785).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4212896
	speed: 0.2994s/iter; left time: 5513.4761s
	iters: 200, epoch: 12 | loss: 1.8661702
	speed: 0.0591s/iter; left time: 1081.4980s
Epoch: 12 cost time: 13.074593305587769
Epoch: 12, Steps: 208 | Train Loss: 1.306 Vali Loss: 5.943 Vali Acc: 0.126 Test Loss: 5.943 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0168440
	speed: 0.2930s/iter; left time: 5333.6740s
	iters: 200, epoch: 13 | loss: 2.1461065
	speed: 0.0511s/iter; left time: 925.7170s
Epoch: 13 cost time: 12.769247770309448
Epoch: 13, Steps: 208 | Train Loss: 1.051 Vali Loss: 6.189 Vali Acc: 0.132 Test Loss: 6.189 Test Acc: 0.132
Validation loss decreased (-0.128785 --> -0.132357).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9065974
	speed: 0.2849s/iter; left time: 5127.3273s
	iters: 200, epoch: 14 | loss: 0.7097243
	speed: 0.0481s/iter; left time: 860.0836s
Epoch: 14 cost time: 10.996644735336304
Epoch: 14, Steps: 208 | Train Loss: 0.906 Vali Loss: 6.329 Vali Acc: 0.143 Test Loss: 6.329 Test Acc: 0.143
Validation loss decreased (-0.132357 --> -0.142496).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.9215624
	speed: 0.2758s/iter; left time: 4906.4114s
	iters: 200, epoch: 15 | loss: 0.4994794
	speed: 0.0492s/iter; left time: 870.0194s
Epoch: 15 cost time: 11.828672647476196
Epoch: 15, Steps: 208 | Train Loss: 0.734 Vali Loss: 6.711 Vali Acc: 0.136 Test Loss: 6.711 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6185677
	speed: 0.2825s/iter; left time: 4966.2827s
	iters: 200, epoch: 16 | loss: 0.9298829
	speed: 0.0664s/iter; left time: 1160.0056s
Epoch: 16 cost time: 13.51121473312378
Epoch: 16, Steps: 208 | Train Loss: 0.601 Vali Loss: 7.408 Vali Acc: 0.135 Test Loss: 7.408 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6717045
	speed: 0.3062s/iter; left time: 5319.7274s
	iters: 200, epoch: 17 | loss: 0.7442175
	speed: 0.0700s/iter; left time: 1209.7874s
Epoch: 17 cost time: 15.986613273620605
Epoch: 17, Steps: 208 | Train Loss: 0.533 Vali Loss: 8.118 Vali Acc: 0.139 Test Loss: 8.118 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4576773
	speed: 0.3257s/iter; left time: 5590.9727s
	iters: 200, epoch: 18 | loss: 0.4959486
	speed: 0.0795s/iter; left time: 1356.6985s
Epoch: 18 cost time: 17.535497426986694
Epoch: 18, Steps: 208 | Train Loss: 0.430 Vali Loss: 8.208 Vali Acc: 0.142 Test Loss: 8.208 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3760653
	speed: 0.3232s/iter; left time: 5481.3080s
	iters: 200, epoch: 19 | loss: 0.5121186
	speed: 0.0743s/iter; left time: 1252.0941s
Epoch: 19 cost time: 16.874558925628662
Epoch: 19, Steps: 208 | Train Loss: 0.434 Vali Loss: 9.228 Vali Acc: 0.133 Test Loss: 9.228 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3447641
	speed: 0.3405s/iter; left time: 5703.8051s
	iters: 200, epoch: 20 | loss: 0.3862796
	speed: 0.0754s/iter; left time: 1255.4733s
Epoch: 20 cost time: 16.97063159942627
Epoch: 20, Steps: 208 | Train Loss: 0.377 Vali Loss: 8.960 Vali Acc: 0.142 Test Loss: 8.960 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0170578
	speed: 0.3243s/iter; left time: 5364.3268s
	iters: 200, epoch: 21 | loss: 0.1877535
	speed: 0.0781s/iter; left time: 1284.0397s
Epoch: 21 cost time: 16.912015199661255
Epoch: 21, Steps: 208 | Train Loss: 0.337 Vali Loss: 8.948 Vali Acc: 0.134 Test Loss: 8.948 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.4668622
	speed: 0.3224s/iter; left time: 5265.3931s
	iters: 200, epoch: 22 | loss: 0.8201767
	speed: 0.0721s/iter; left time: 1170.6291s
Epoch: 22 cost time: 16.323580980300903
Epoch: 22, Steps: 208 | Train Loss: 0.316 Vali Loss: 9.465 Vali Acc: 0.147 Test Loss: 9.465 Test Acc: 0.147
Validation loss decreased (-0.142496 --> -0.146938).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.3608244
	speed: 0.3174s/iter; left time: 5118.8234s
	iters: 200, epoch: 23 | loss: 0.2203533
	speed: 0.0546s/iter; left time: 874.3079s
Epoch: 23 cost time: 14.335253953933716
Epoch: 23, Steps: 208 | Train Loss: 0.246 Vali Loss: 10.158 Vali Acc: 0.135 Test Loss: 10.158 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.2912903
	speed: 0.2954s/iter; left time: 4701.4607s
	iters: 200, epoch: 24 | loss: 0.3324349
	speed: 0.0590s/iter; left time: 933.6797s
Epoch: 24 cost time: 13.916448593139648
Epoch: 24, Steps: 208 | Train Loss: 0.252 Vali Loss: 10.647 Vali Acc: 0.140 Test Loss: 10.647 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.4823608
	speed: 0.3055s/iter; left time: 4798.7276s
	iters: 200, epoch: 25 | loss: 0.5973147
	speed: 0.0551s/iter; left time: 859.5100s
Epoch: 25 cost time: 13.155638933181763
Epoch: 25, Steps: 208 | Train Loss: 0.238 Vali Loss: 10.922 Vali Acc: 0.140 Test Loss: 10.922 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.4861059
	speed: 0.3004s/iter; left time: 4656.7936s
	iters: 200, epoch: 26 | loss: 0.5411845
	speed: 0.0538s/iter; left time: 827.9241s
Epoch: 26 cost time: 12.74134373664856
Epoch: 26, Steps: 208 | Train Loss: 0.242 Vali Loss: 11.042 Vali Acc: 0.116 Test Loss: 11.042 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0312255
	speed: 0.2805s/iter; left time: 4290.0379s
	iters: 200, epoch: 27 | loss: 0.9262474
	speed: 0.0453s/iter; left time: 688.3536s
Epoch: 27 cost time: 11.434408187866211
Epoch: 27, Steps: 208 | Train Loss: 0.221 Vali Loss: 11.353 Vali Acc: 0.140 Test Loss: 11.353 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0237731
	speed: 0.2814s/iter; left time: 4245.2537s
	iters: 200, epoch: 28 | loss: 0.5028087
	speed: 0.0549s/iter; left time: 822.9810s
Epoch: 28 cost time: 12.12563705444336
Epoch: 28, Steps: 208 | Train Loss: 0.182 Vali Loss: 11.815 Vali Acc: 0.129 Test Loss: 11.815 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0348159
	speed: 0.2872s/iter; left time: 4272.8560s
	iters: 200, epoch: 29 | loss: 0.0733190
	speed: 0.0554s/iter; left time: 818.2678s
Epoch: 29 cost time: 12.53414535522461
Epoch: 29, Steps: 208 | Train Loss: 0.203 Vali Loss: 11.896 Vali Acc: 0.129 Test Loss: 11.896 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.1060821
	speed: 0.3073s/iter; left time: 4507.8191s
	iters: 200, epoch: 30 | loss: 0.1568661
	speed: 0.0576s/iter; left time: 838.5412s
Epoch: 30 cost time: 13.819111347198486
Epoch: 30, Steps: 208 | Train Loss: 0.190 Vali Loss: 11.510 Vali Acc: 0.125 Test Loss: 11.510 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.2074857
	speed: 0.3286s/iter; left time: 4751.3759s
	iters: 200, epoch: 31 | loss: 0.3157015
	speed: 0.0756s/iter; left time: 1085.8000s
Epoch: 31 cost time: 16.97765278816223
Epoch: 31, Steps: 208 | Train Loss: 0.182 Vali Loss: 12.741 Vali Acc: 0.134 Test Loss: 12.741 Test Acc: 0.134
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0885520
	speed: 0.3447s/iter; left time: 4912.9018s
	iters: 200, epoch: 32 | loss: 0.0212506
	speed: 0.0697s/iter; left time: 986.3056s
Epoch: 32 cost time: 15.817362070083618
Epoch: 32, Steps: 208 | Train Loss: 0.167 Vali Loss: 12.549 Vali Acc: 0.126 Test Loss: 12.549 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14703250820161048
model parameter : 760167
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7512603
	speed: 0.1117s/iter; left time: 2313.0990s
	iters: 200, epoch: 1 | loss: 4.3494120
	speed: 0.0734s/iter; left time: 1512.9811s
Epoch: 1 cost time: 19.36858868598938
Epoch: 1, Steps: 208 | Train Loss: 4.065 Vali Loss: 4.301 Vali Acc: 0.054 Test Loss: 4.301 Test Acc: 0.054
Validation loss decreased (inf --> -0.053640).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2047515
	speed: 0.3411s/iter; left time: 6990.7057s
	iters: 200, epoch: 2 | loss: 3.0059390
	speed: 0.0683s/iter; left time: 1393.2749s
Epoch: 2 cost time: 15.111693143844604
Epoch: 2, Steps: 208 | Train Loss: 3.517 Vali Loss: 3.618 Vali Acc: 0.088 Test Loss: 3.618 Test Acc: 0.088
Validation loss decreased (-0.053640 --> -0.087945).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4946482
	speed: 0.2951s/iter; left time: 5986.4130s
	iters: 200, epoch: 3 | loss: 3.2778213
	speed: 0.0490s/iter; left time: 988.2416s
Epoch: 3 cost time: 11.738679647445679
Epoch: 3, Steps: 208 | Train Loss: 3.180 Vali Loss: 4.106 Vali Acc: 0.074 Test Loss: 4.106 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6851885
	speed: 0.2813s/iter; left time: 5647.3656s
	iters: 200, epoch: 4 | loss: 4.0539727
	speed: 0.0472s/iter; left time: 942.0414s
Epoch: 4 cost time: 11.226745843887329
Epoch: 4, Steps: 208 | Train Loss: 3.105 Vali Loss: 4.011 Vali Acc: 0.081 Test Loss: 4.011 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3768148
	speed: 0.2843s/iter; left time: 5649.6453s
	iters: 200, epoch: 5 | loss: 2.9950428
	speed: 0.0494s/iter; left time: 977.2291s
Epoch: 5 cost time: 11.354902744293213
Epoch: 5, Steps: 208 | Train Loss: 3.067 Vali Loss: 4.896 Vali Acc: 0.092 Test Loss: 4.896 Test Acc: 0.092
Validation loss decreased (-0.087945 --> -0.092107).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9884112
	speed: 0.2760s/iter; left time: 5426.1326s
	iters: 200, epoch: 6 | loss: 3.3399608
	speed: 0.0447s/iter; left time: 874.0477s
Epoch: 6 cost time: 10.016420602798462
Epoch: 6, Steps: 208 | Train Loss: 2.937 Vali Loss: 4.415 Vali Acc: 0.101 Test Loss: 4.415 Test Acc: 0.101
Validation loss decreased (-0.092107 --> -0.101358).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1707010
	speed: 0.2825s/iter; left time: 5495.9723s
	iters: 200, epoch: 7 | loss: 2.6451726
	speed: 0.0680s/iter; left time: 1316.0855s
Epoch: 7 cost time: 14.916207075119019
Epoch: 7, Steps: 208 | Train Loss: 2.709 Vali Loss: 4.446 Vali Acc: 0.127 Test Loss: 4.446 Test Acc: 0.127
Validation loss decreased (-0.101358 --> -0.127304).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.9148989
	speed: 0.3136s/iter; left time: 6035.0255s
	iters: 200, epoch: 8 | loss: 2.4146147
	speed: 0.0678s/iter; left time: 1298.9476s
Epoch: 8 cost time: 14.927074670791626
Epoch: 8, Steps: 208 | Train Loss: 2.499 Vali Loss: 4.719 Vali Acc: 0.130 Test Loss: 4.719 Test Acc: 0.130
Validation loss decreased (-0.127304 --> -0.129986).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0807393
	speed: 0.2964s/iter; left time: 5642.6871s
	iters: 200, epoch: 9 | loss: 2.5955594
	speed: 0.0664s/iter; left time: 1257.5050s
Epoch: 9 cost time: 13.566166877746582
Epoch: 9, Steps: 208 | Train Loss: 2.193 Vali Loss: 4.759 Vali Acc: 0.127 Test Loss: 4.759 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5954562
	speed: 0.2937s/iter; left time: 5530.3953s
	iters: 200, epoch: 10 | loss: 2.1925061
	speed: 0.0729s/iter; left time: 1366.1643s
Epoch: 10 cost time: 13.786182880401611
Epoch: 10, Steps: 208 | Train Loss: 1.899 Vali Loss: 5.276 Vali Acc: 0.132 Test Loss: 5.276 Test Acc: 0.132
Validation loss decreased (-0.129986 --> -0.132366).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0613239
	speed: 0.3473s/iter; left time: 6466.2394s
	iters: 200, epoch: 11 | loss: 1.5256985
	speed: 0.0745s/iter; left time: 1379.6931s
Epoch: 11 cost time: 16.725894689559937
Epoch: 11, Steps: 208 | Train Loss: 1.522 Vali Loss: 5.581 Vali Acc: 0.122 Test Loss: 5.581 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7321036
	speed: 0.3188s/iter; left time: 5870.5975s
	iters: 200, epoch: 12 | loss: 1.9799163
	speed: 0.0669s/iter; left time: 1225.8673s
Epoch: 12 cost time: 15.799492597579956
Epoch: 12, Steps: 208 | Train Loss: 1.265 Vali Loss: 5.640 Vali Acc: 0.130 Test Loss: 5.640 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0667317
	speed: 0.3508s/iter; left time: 6386.2438s
	iters: 200, epoch: 13 | loss: 1.7106169
	speed: 0.0713s/iter; left time: 1290.7589s
Epoch: 13 cost time: 17.28139853477478
Epoch: 13, Steps: 208 | Train Loss: 1.042 Vali Loss: 5.900 Vali Acc: 0.133 Test Loss: 5.900 Test Acc: 0.133
Validation loss decreased (-0.132366 --> -0.132658).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0119224
	speed: 0.3609s/iter; left time: 6495.8289s
	iters: 200, epoch: 14 | loss: 0.9677848
	speed: 0.0910s/iter; left time: 1628.0663s
Epoch: 14 cost time: 20.638429880142212
Epoch: 14, Steps: 208 | Train Loss: 0.851 Vali Loss: 6.583 Vali Acc: 0.130 Test Loss: 6.583 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5504327
	speed: 0.4050s/iter; left time: 7205.2157s
	iters: 200, epoch: 15 | loss: 0.4730877
	speed: 0.1135s/iter; left time: 2007.1961s
Epoch: 15 cost time: 24.177467346191406
Epoch: 15, Steps: 208 | Train Loss: 0.715 Vali Loss: 7.110 Vali Acc: 0.130 Test Loss: 7.110 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9815361
	speed: 0.4240s/iter; left time: 7453.8230s
	iters: 200, epoch: 16 | loss: 0.8437004
	speed: 0.1068s/iter; left time: 1867.3004s
Epoch: 16 cost time: 24.482799291610718
Epoch: 16, Steps: 208 | Train Loss: 0.593 Vali Loss: 7.592 Vali Acc: 0.132 Test Loss: 7.592 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2092299
	speed: 0.3818s/iter; left time: 6633.2282s
	iters: 200, epoch: 17 | loss: 0.7364410
	speed: 0.1050s/iter; left time: 1813.3936s
Epoch: 17 cost time: 22.313762426376343
Epoch: 17, Steps: 208 | Train Loss: 0.543 Vali Loss: 7.806 Vali Acc: 0.132 Test Loss: 7.806 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3913131
	speed: 0.3492s/iter; left time: 5993.3896s
	iters: 200, epoch: 18 | loss: 0.6336327
	speed: 0.0889s/iter; left time: 1516.6868s
Epoch: 18 cost time: 19.45810604095459
Epoch: 18, Steps: 208 | Train Loss: 0.448 Vali Loss: 8.200 Vali Acc: 0.138 Test Loss: 8.200 Test Acc: 0.138
Validation loss decreased (-0.132658 --> -0.138003).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1479629
	speed: 0.3255s/iter; left time: 5519.5709s
	iters: 200, epoch: 19 | loss: 0.6531773
	speed: 0.0956s/iter; left time: 1611.4729s
Epoch: 19 cost time: 18.590916872024536
Epoch: 19, Steps: 208 | Train Loss: 0.397 Vali Loss: 8.433 Vali Acc: 0.143 Test Loss: 8.433 Test Acc: 0.143
Validation loss decreased (-0.138003 --> -0.142475).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2291529
	speed: 0.2932s/iter; left time: 4911.1471s
	iters: 200, epoch: 20 | loss: 0.7193478
	speed: 0.0692s/iter; left time: 1151.5296s
Epoch: 20 cost time: 14.286387205123901
Epoch: 20, Steps: 208 | Train Loss: 0.368 Vali Loss: 8.871 Vali Acc: 0.124 Test Loss: 8.871 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2885085
	speed: 0.2749s/iter; left time: 4546.5767s
	iters: 200, epoch: 21 | loss: 0.4851862
	speed: 0.0492s/iter; left time: 809.2530s
Epoch: 21 cost time: 11.007463216781616
Epoch: 21, Steps: 208 | Train Loss: 0.326 Vali Loss: 9.105 Vali Acc: 0.138 Test Loss: 9.105 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.3394243
	speed: 0.2687s/iter; left time: 4387.9399s
	iters: 200, epoch: 22 | loss: 0.1208618
	speed: 0.0439s/iter; left time: 711.8695s
Epoch: 22 cost time: 10.018277883529663
Epoch: 22, Steps: 208 | Train Loss: 0.323 Vali Loss: 9.183 Vali Acc: 0.143 Test Loss: 9.183 Test Acc: 0.143
Validation loss decreased (-0.142475 --> -0.143064).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1892408
	speed: 0.2642s/iter; left time: 4260.7478s
	iters: 200, epoch: 23 | loss: 0.5438780
	speed: 0.0425s/iter; left time: 681.2538s
Epoch: 23 cost time: 9.937751770019531
Epoch: 23, Steps: 208 | Train Loss: 0.260 Vali Loss: 10.528 Vali Acc: 0.127 Test Loss: 10.528 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1029844
	speed: 0.2948s/iter; left time: 4691.9638s
	iters: 200, epoch: 24 | loss: 0.4799473
	speed: 0.0550s/iter; left time: 870.5708s
Epoch: 24 cost time: 12.97688341140747
Epoch: 24, Steps: 208 | Train Loss: 0.276 Vali Loss: 10.548 Vali Acc: 0.135 Test Loss: 10.548 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0235571
	speed: 0.3137s/iter; left time: 4928.4562s
	iters: 200, epoch: 25 | loss: 0.1260858
	speed: 0.0574s/iter; left time: 896.3415s
Epoch: 25 cost time: 14.222877740859985
Epoch: 25, Steps: 208 | Train Loss: 0.257 Vali Loss: 10.833 Vali Acc: 0.133 Test Loss: 10.833 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.3928501
	speed: 0.3227s/iter; left time: 5001.8404s
	iters: 200, epoch: 26 | loss: 0.7124107
	speed: 0.0834s/iter; left time: 1284.9017s
Epoch: 26 cost time: 17.71903347969055
Epoch: 26, Steps: 208 | Train Loss: 0.233 Vali Loss: 10.962 Vali Acc: 0.128 Test Loss: 10.962 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0526096
	speed: 0.3485s/iter; left time: 5329.1533s
	iters: 200, epoch: 27 | loss: 0.2456973
	speed: 0.0773s/iter; left time: 1175.0166s
Epoch: 27 cost time: 17.3703191280365
Epoch: 27, Steps: 208 | Train Loss: 0.198 Vali Loss: 11.502 Vali Acc: 0.130 Test Loss: 11.502 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.4224026
	speed: 0.3150s/iter; left time: 4751.3947s
	iters: 200, epoch: 28 | loss: 0.4229310
	speed: 0.0780s/iter; left time: 1169.2651s
Epoch: 28 cost time: 17.537675380706787
Epoch: 28, Steps: 208 | Train Loss: 0.214 Vali Loss: 11.524 Vali Acc: 0.137 Test Loss: 11.524 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.1096186
	speed: 0.3074s/iter; left time: 4572.5332s
	iters: 200, epoch: 29 | loss: 0.3855996
	speed: 0.0765s/iter; left time: 1130.2191s
Epoch: 29 cost time: 16.653841257095337
Epoch: 29, Steps: 208 | Train Loss: 0.207 Vali Loss: 11.993 Vali Acc: 0.124 Test Loss: 11.993 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.1238320
	speed: 0.3285s/iter; left time: 4818.5702s
	iters: 200, epoch: 30 | loss: 0.4458558
	speed: 0.0792s/iter; left time: 1153.8539s
Epoch: 30 cost time: 16.76020121574402
Epoch: 30, Steps: 208 | Train Loss: 0.183 Vali Loss: 12.020 Vali Acc: 0.125 Test Loss: 12.020 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.3266537
	speed: 0.3383s/iter; left time: 4892.1926s
	iters: 200, epoch: 31 | loss: 0.0752311
	speed: 0.0805s/iter; left time: 1155.6082s
Epoch: 31 cost time: 17.099066495895386
Epoch: 31, Steps: 208 | Train Loss: 0.170 Vali Loss: 12.721 Vali Acc: 0.129 Test Loss: 12.721 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.1512202
	speed: 0.3393s/iter; left time: 4836.6394s
	iters: 200, epoch: 32 | loss: 0.3832487
	speed: 0.0730s/iter; left time: 1033.5733s
Epoch: 32 cost time: 16.742522716522217
Epoch: 32, Steps: 208 | Train Loss: 0.203 Vali Loss: 12.270 Vali Acc: 0.127 Test Loss: 12.270 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14315538323889054
model parameter : 623207
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6262531
	speed: 0.0881s/iter; left time: 1823.8219s
	iters: 200, epoch: 1 | loss: 4.0249319
	speed: 0.0547s/iter; left time: 1126.5992s
Epoch: 1 cost time: 14.743147611618042
Epoch: 1, Steps: 208 | Train Loss: 3.933 Vali Loss: 4.011 Vali Acc: 0.058 Test Loss: 4.011 Test Acc: 0.058
Validation loss decreased (inf --> -0.057520).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0075636
	speed: 0.2581s/iter; left time: 5288.7193s
	iters: 200, epoch: 2 | loss: 3.4309170
	speed: 0.0475s/iter; left time: 968.6331s
Epoch: 2 cost time: 10.905522346496582
Epoch: 2, Steps: 208 | Train Loss: 3.585 Vali Loss: 3.695 Vali Acc: 0.081 Test Loss: 3.695 Test Acc: 0.081
Validation loss decreased (-0.057520 --> -0.080786).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7263632
	speed: 0.2982s/iter; left time: 6048.2442s
	iters: 200, epoch: 3 | loss: 2.8454616
	speed: 0.0517s/iter; left time: 1043.9690s
Epoch: 3 cost time: 11.907640933990479
Epoch: 3, Steps: 208 | Train Loss: 3.192 Vali Loss: 3.922 Vali Acc: 0.091 Test Loss: 3.922 Test Acc: 0.091
Validation loss decreased (-0.080786 --> -0.091222).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7404366
	speed: 0.2753s/iter; left time: 5526.9735s
	iters: 200, epoch: 4 | loss: 2.9868069
	speed: 0.0529s/iter; left time: 1057.3350s
Epoch: 4 cost time: 11.3142569065094
Epoch: 4, Steps: 208 | Train Loss: 3.066 Vali Loss: 3.889 Vali Acc: 0.105 Test Loss: 3.889 Test Acc: 0.105
Validation loss decreased (-0.091222 --> -0.105240).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2240174
	speed: 0.2835s/iter; left time: 5632.0757s
	iters: 200, epoch: 5 | loss: 3.3138256
	speed: 0.0528s/iter; left time: 1044.1088s
Epoch: 5 cost time: 11.682546615600586
Epoch: 5, Steps: 208 | Train Loss: 2.950 Vali Loss: 4.475 Vali Acc: 0.089 Test Loss: 4.475 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.5484159
	speed: 0.2868s/iter; left time: 5638.0502s
	iters: 200, epoch: 6 | loss: 3.6360300
	speed: 0.0450s/iter; left time: 880.6683s
Epoch: 6 cost time: 11.394901037216187
Epoch: 6, Steps: 208 | Train Loss: 2.816 Vali Loss: 4.468 Vali Acc: 0.095 Test Loss: 4.468 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.3397460
	speed: 0.3006s/iter; left time: 5848.3242s
	iters: 200, epoch: 7 | loss: 2.6838009
	speed: 0.0507s/iter; left time: 981.2316s
Epoch: 7 cost time: 11.296292543411255
Epoch: 7, Steps: 208 | Train Loss: 2.599 Vali Loss: 4.477 Vali Acc: 0.106 Test Loss: 4.477 Test Acc: 0.106
Validation loss decreased (-0.105240 --> -0.106129).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1829557
	speed: 0.3135s/iter; left time: 6033.3498s
	iters: 200, epoch: 8 | loss: 3.0006621
	speed: 0.0748s/iter; left time: 1431.3950s
Epoch: 8 cost time: 15.880090236663818
Epoch: 8, Steps: 208 | Train Loss: 2.397 Vali Loss: 4.692 Vali Acc: 0.112 Test Loss: 4.692 Test Acc: 0.112
Validation loss decreased (-0.106129 --> -0.111793).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9138132
	speed: 0.2940s/iter; left time: 5596.4803s
	iters: 200, epoch: 9 | loss: 1.3624712
	speed: 0.0643s/iter; left time: 1217.7095s
Epoch: 9 cost time: 14.363970518112183
Epoch: 9, Steps: 208 | Train Loss: 2.063 Vali Loss: 5.309 Vali Acc: 0.117 Test Loss: 5.309 Test Acc: 0.117
Validation loss decreased (-0.111793 --> -0.116559).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5975044
	speed: 0.3350s/iter; left time: 6306.8517s
	iters: 200, epoch: 10 | loss: 2.4615927
	speed: 0.0663s/iter; left time: 1241.0320s
Epoch: 10 cost time: 15.93742036819458
Epoch: 10, Steps: 208 | Train Loss: 1.871 Vali Loss: 5.915 Vali Acc: 0.110 Test Loss: 5.915 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4137205
	speed: 0.3424s/iter; left time: 6376.3405s
	iters: 200, epoch: 11 | loss: 1.0997779
	speed: 0.0710s/iter; left time: 1314.1950s
Epoch: 11 cost time: 16.50749635696411
Epoch: 11, Steps: 208 | Train Loss: 1.558 Vali Loss: 5.462 Vali Acc: 0.123 Test Loss: 5.462 Test Acc: 0.123
Validation loss decreased (-0.116559 --> -0.122820).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9352277
	speed: 0.3414s/iter; left time: 6285.3242s
	iters: 200, epoch: 12 | loss: 1.4732027
	speed: 0.0724s/iter; left time: 1326.1123s
Epoch: 12 cost time: 16.6488356590271
Epoch: 12, Steps: 208 | Train Loss: 1.325 Vali Loss: 6.109 Vali Acc: 0.121 Test Loss: 6.109 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9257566
	speed: 0.3109s/iter; left time: 5659.0621s
	iters: 200, epoch: 13 | loss: 1.6542257
	speed: 0.0757s/iter; left time: 1370.8429s
Epoch: 13 cost time: 16.72251009941101
Epoch: 13, Steps: 208 | Train Loss: 1.112 Vali Loss: 6.320 Vali Acc: 0.120 Test Loss: 6.320 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5603982
	speed: 0.3275s/iter; left time: 5894.0422s
	iters: 200, epoch: 14 | loss: 0.6060658
	speed: 0.0734s/iter; left time: 1313.9003s
Epoch: 14 cost time: 16.493128299713135
Epoch: 14, Steps: 208 | Train Loss: 0.909 Vali Loss: 6.523 Vali Acc: 0.132 Test Loss: 6.523 Test Acc: 0.132
Validation loss decreased (-0.122820 --> -0.131757).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2737612
	speed: 0.3215s/iter; left time: 5719.2243s
	iters: 200, epoch: 15 | loss: 1.0695897
	speed: 0.0570s/iter; left time: 1007.9125s
Epoch: 15 cost time: 13.470352411270142
Epoch: 15, Steps: 208 | Train Loss: 0.786 Vali Loss: 7.124 Vali Acc: 0.118 Test Loss: 7.124 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0498265
	speed: 0.3051s/iter; left time: 5364.0813s
	iters: 200, epoch: 16 | loss: 0.5706525
	speed: 0.0534s/iter; left time: 933.2092s
Epoch: 16 cost time: 12.843255281448364
Epoch: 16, Steps: 208 | Train Loss: 0.672 Vali Loss: 7.601 Vali Acc: 0.115 Test Loss: 7.601 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3607970
	speed: 0.3143s/iter; left time: 5459.5625s
	iters: 200, epoch: 17 | loss: 0.6713378
	speed: 0.0520s/iter; left time: 898.6477s
Epoch: 17 cost time: 12.252230405807495
Epoch: 17, Steps: 208 | Train Loss: 0.556 Vali Loss: 7.943 Vali Acc: 0.118 Test Loss: 7.943 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4913420
	speed: 0.2847s/iter; left time: 4886.8482s
	iters: 200, epoch: 18 | loss: 0.9705837
	speed: 0.0553s/iter; left time: 944.3790s
Epoch: 18 cost time: 12.62384581565857
Epoch: 18, Steps: 208 | Train Loss: 0.534 Vali Loss: 8.487 Vali Acc: 0.114 Test Loss: 8.487 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.0165795
	speed: 0.2988s/iter; left time: 5067.4375s
	iters: 200, epoch: 19 | loss: 0.6384499
	speed: 0.0524s/iter; left time: 883.8468s
Epoch: 19 cost time: 12.069331884384155
Epoch: 19, Steps: 208 | Train Loss: 0.484 Vali Loss: 8.478 Vali Acc: 0.121 Test Loss: 8.478 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.0970384
	speed: 0.2727s/iter; left time: 4566.6497s
	iters: 200, epoch: 20 | loss: 0.5381711
	speed: 0.0544s/iter; left time: 906.1256s
Epoch: 20 cost time: 12.266876697540283
Epoch: 20, Steps: 208 | Train Loss: 0.412 Vali Loss: 8.727 Vali Acc: 0.117 Test Loss: 8.727 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0764299
	speed: 0.3060s/iter; left time: 5061.7340s
	iters: 200, epoch: 21 | loss: 1.0953488
	speed: 0.0494s/iter; left time: 812.2041s
Epoch: 21 cost time: 11.92442512512207
Epoch: 21, Steps: 208 | Train Loss: 0.363 Vali Loss: 9.742 Vali Acc: 0.118 Test Loss: 9.742 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.5554337
	speed: 0.2920s/iter; left time: 4768.5523s
	iters: 200, epoch: 22 | loss: 0.3895362
	speed: 0.0678s/iter; left time: 1099.8184s
Epoch: 22 cost time: 13.887418508529663
Epoch: 22, Steps: 208 | Train Loss: 0.331 Vali Loss: 9.548 Vali Acc: 0.115 Test Loss: 9.548 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.0855310
	speed: 0.3288s/iter; left time: 5302.1923s
	iters: 200, epoch: 23 | loss: 0.3032107
	speed: 0.0790s/iter; left time: 1266.2640s
Epoch: 23 cost time: 16.885601043701172
Epoch: 23, Steps: 208 | Train Loss: 0.336 Vali Loss: 10.034 Vali Acc: 0.116 Test Loss: 10.034 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.6072911
	speed: 0.2970s/iter; left time: 4727.4687s
	iters: 200, epoch: 24 | loss: 0.1166347
	speed: 0.0712s/iter; left time: 1126.2266s
Epoch: 24 cost time: 15.146664142608643
Epoch: 24, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.187 Vali Acc: 0.121 Test Loss: 10.187 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1318222487324784
model parameter : 431719
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8921914
	speed: 0.0905s/iter; left time: 1873.7495s
	iters: 200, epoch: 1 | loss: 3.7921321
	speed: 0.0545s/iter; left time: 1122.5288s
Epoch: 1 cost time: 15.165795087814331
Epoch: 1, Steps: 208 | Train Loss: 3.891 Vali Loss: 4.054 Vali Acc: 0.062 Test Loss: 4.054 Test Acc: 0.062
Validation loss decreased (inf --> -0.061695).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8350832
	speed: 0.2922s/iter; left time: 5987.8261s
	iters: 200, epoch: 2 | loss: 3.8402064
	speed: 0.0513s/iter; left time: 1045.3052s
Epoch: 2 cost time: 11.606329917907715
Epoch: 2, Steps: 208 | Train Loss: 3.606 Vali Loss: 3.727 Vali Acc: 0.066 Test Loss: 3.727 Test Acc: 0.066
Validation loss decreased (-0.061695 --> -0.065874).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0096130
	speed: 0.2764s/iter; left time: 5607.1275s
	iters: 200, epoch: 3 | loss: 3.6741874
	speed: 0.0485s/iter; left time: 978.9732s
Epoch: 3 cost time: 10.681991815567017
Epoch: 3, Steps: 208 | Train Loss: 3.257 Vali Loss: 3.972 Vali Acc: 0.075 Test Loss: 3.972 Test Acc: 0.075
Validation loss decreased (-0.065874 --> -0.074520).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3459797
	speed: 0.2766s/iter; left time: 5553.1808s
	iters: 200, epoch: 4 | loss: 3.6718214
	speed: 0.0460s/iter; left time: 919.1913s
Epoch: 4 cost time: 10.086079120635986
Epoch: 4, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.965 Vali Acc: 0.096 Test Loss: 3.965 Test Acc: 0.096
Validation loss decreased (-0.074520 --> -0.095696).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2545395
	speed: 0.2808s/iter; left time: 5579.8049s
	iters: 200, epoch: 5 | loss: 3.1467071
	speed: 0.0411s/iter; left time: 811.5962s
Epoch: 5 cost time: 9.557549476623535
Epoch: 5, Steps: 208 | Train Loss: 2.955 Vali Loss: 3.994 Vali Acc: 0.108 Test Loss: 3.994 Test Acc: 0.108
Validation loss decreased (-0.095696 --> -0.107923).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0233898
	speed: 0.2834s/iter; left time: 5572.2293s
	iters: 200, epoch: 6 | loss: 2.5810523
	speed: 0.0431s/iter; left time: 843.8431s
Epoch: 6 cost time: 11.051771879196167
Epoch: 6, Steps: 208 | Train Loss: 2.740 Vali Loss: 4.401 Vali Acc: 0.106 Test Loss: 4.401 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.8014882
	speed: 0.2889s/iter; left time: 5619.2769s
	iters: 200, epoch: 7 | loss: 3.3368821
	speed: 0.0405s/iter; left time: 783.2968s
Epoch: 7 cost time: 10.654932260513306
Epoch: 7, Steps: 208 | Train Loss: 2.612 Vali Loss: 4.721 Vali Acc: 0.123 Test Loss: 4.721 Test Acc: 0.123
Validation loss decreased (-0.107923 --> -0.122828).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0596831
	speed: 0.2909s/iter; left time: 5597.6297s
	iters: 200, epoch: 8 | loss: 2.4955800
	speed: 0.0452s/iter; left time: 866.1799s
Epoch: 8 cost time: 10.819624662399292
Epoch: 8, Steps: 208 | Train Loss: 2.385 Vali Loss: 4.537 Vali Acc: 0.101 Test Loss: 4.537 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8963110
	speed: 0.2942s/iter; left time: 5600.6847s
	iters: 200, epoch: 9 | loss: 3.0177259
	speed: 0.0443s/iter; left time: 837.9658s
Epoch: 9 cost time: 10.89596176147461
Epoch: 9, Steps: 208 | Train Loss: 2.092 Vali Loss: 4.998 Vali Acc: 0.110 Test Loss: 4.998 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4067018
	speed: 0.2816s/iter; left time: 5301.7622s
	iters: 200, epoch: 10 | loss: 1.5999141
	speed: 0.0428s/iter; left time: 800.7709s
Epoch: 10 cost time: 9.929574012756348
Epoch: 10, Steps: 208 | Train Loss: 1.844 Vali Loss: 5.138 Vali Acc: 0.118 Test Loss: 5.138 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.0963550
	speed: 0.2772s/iter; left time: 5162.3229s
	iters: 200, epoch: 11 | loss: 2.6312110
	speed: 0.0362s/iter; left time: 670.6217s
Epoch: 11 cost time: 9.148858070373535
Epoch: 11, Steps: 208 | Train Loss: 1.616 Vali Loss: 5.489 Vali Acc: 0.123 Test Loss: 5.489 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2665472
	speed: 0.2947s/iter; left time: 5427.1073s
	iters: 200, epoch: 12 | loss: 1.4138266
	speed: 0.0564s/iter; left time: 1032.4211s
Epoch: 12 cost time: 12.34872555732727
Epoch: 12, Steps: 208 | Train Loss: 1.352 Vali Loss: 5.872 Vali Acc: 0.113 Test Loss: 5.872 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.8947828
	speed: 0.2805s/iter; left time: 5106.9504s
	iters: 200, epoch: 13 | loss: 0.8102106
	speed: 0.0498s/iter; left time: 902.0753s
Epoch: 13 cost time: 11.910960912704468
Epoch: 13, Steps: 208 | Train Loss: 1.162 Vali Loss: 6.195 Vali Acc: 0.128 Test Loss: 6.195 Test Acc: 0.128
Validation loss decreased (-0.122828 --> -0.127883).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8740555
	speed: 0.2877s/iter; left time: 5176.9222s
	iters: 200, epoch: 14 | loss: 1.4682457
	speed: 0.0433s/iter; left time: 774.2099s
Epoch: 14 cost time: 11.387941598892212
Epoch: 14, Steps: 208 | Train Loss: 0.986 Vali Loss: 6.520 Vali Acc: 0.119 Test Loss: 6.520 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5423605
	speed: 0.2884s/iter; left time: 5130.1756s
	iters: 200, epoch: 15 | loss: 0.9082823
	speed: 0.0389s/iter; left time: 688.7946s
Epoch: 15 cost time: 10.237303256988525
Epoch: 15, Steps: 208 | Train Loss: 0.847 Vali Loss: 7.230 Vali Acc: 0.118 Test Loss: 7.230 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2303673
	speed: 0.3186s/iter; left time: 5600.7957s
	iters: 200, epoch: 16 | loss: 0.8662159
	speed: 0.0565s/iter; left time: 988.2176s
Epoch: 16 cost time: 13.175487518310547
Epoch: 16, Steps: 208 | Train Loss: 0.721 Vali Loss: 7.576 Vali Acc: 0.122 Test Loss: 7.576 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7271316
	speed: 0.3024s/iter; left time: 5254.4341s
	iters: 200, epoch: 17 | loss: 1.0047041
	speed: 0.0505s/iter; left time: 871.7573s
Epoch: 17 cost time: 11.777698278427124
Epoch: 17, Steps: 208 | Train Loss: 0.645 Vali Loss: 7.903 Vali Acc: 0.123 Test Loss: 7.903 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.9228233
	speed: 0.3065s/iter; left time: 5261.3421s
	iters: 200, epoch: 18 | loss: 0.2923015
	speed: 0.0491s/iter; left time: 837.8143s
Epoch: 18 cost time: 11.773755550384521
Epoch: 18, Steps: 208 | Train Loss: 0.577 Vali Loss: 8.087 Vali Acc: 0.110 Test Loss: 8.087 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4588394
	speed: 0.2747s/iter; left time: 4657.5906s
	iters: 200, epoch: 19 | loss: 0.5790338
	speed: 0.0427s/iter; left time: 719.3461s
Epoch: 19 cost time: 10.330938339233398
Epoch: 19, Steps: 208 | Train Loss: 0.492 Vali Loss: 8.241 Vali Acc: 0.118 Test Loss: 8.241 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6381927
	speed: 0.2768s/iter; left time: 4635.8727s
	iters: 200, epoch: 20 | loss: 0.2801651
	speed: 0.0431s/iter; left time: 716.8054s
Epoch: 20 cost time: 10.661990642547607
Epoch: 20, Steps: 208 | Train Loss: 0.444 Vali Loss: 9.024 Vali Acc: 0.128 Test Loss: 9.024 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1894657
	speed: 0.2523s/iter; left time: 4173.3072s
	iters: 200, epoch: 21 | loss: 0.4996993
	speed: 0.0407s/iter; left time: 668.5524s
Epoch: 21 cost time: 10.120790719985962
Epoch: 21, Steps: 208 | Train Loss: 0.410 Vali Loss: 9.485 Vali Acc: 0.122 Test Loss: 9.485 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2744855
	speed: 0.2718s/iter; left time: 4438.7076s
	iters: 200, epoch: 22 | loss: 0.4078170
	speed: 0.0409s/iter; left time: 663.9703s
Epoch: 22 cost time: 10.29500937461853
Epoch: 22, Steps: 208 | Train Loss: 0.374 Vali Loss: 9.509 Vali Acc: 0.116 Test Loss: 9.509 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1128186
	speed: 0.2637s/iter; left time: 4252.7695s
	iters: 200, epoch: 23 | loss: 0.3727188
	speed: 0.0417s/iter; left time: 668.6228s
Epoch: 23 cost time: 9.889931917190552
Epoch: 23, Steps: 208 | Train Loss: 0.355 Vali Loss: 10.021 Vali Acc: 0.119 Test Loss: 10.021 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12794512376975842
model parameter : 350055
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5420995
	speed: 0.0767s/iter; left time: 1588.3486s
	iters: 200, epoch: 1 | loss: 3.8850267
	speed: 0.0477s/iter; left time: 982.7781s
Epoch: 1 cost time: 12.938219547271729
Epoch: 1, Steps: 208 | Train Loss: 3.833 Vali Loss: 3.896 Vali Acc: 0.051 Test Loss: 3.896 Test Acc: 0.051
Validation loss decreased (inf --> -0.051258).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0055177
	speed: 0.2961s/iter; left time: 6067.7659s
	iters: 200, epoch: 2 | loss: 3.6019084
	speed: 0.0509s/iter; left time: 1038.9412s
Epoch: 2 cost time: 12.359075546264648
Epoch: 2, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.832 Vali Acc: 0.075 Test Loss: 3.832 Test Acc: 0.075
Validation loss decreased (-0.051258 --> -0.075118).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6533196
	speed: 0.2910s/iter; left time: 5901.9485s
	iters: 200, epoch: 3 | loss: 3.1846414
	speed: 0.0457s/iter; left time: 923.1900s
Epoch: 3 cost time: 10.319786071777344
Epoch: 3, Steps: 208 | Train Loss: 3.305 Vali Loss: 3.946 Vali Acc: 0.071 Test Loss: 3.946 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5347052
	speed: 0.2988s/iter; left time: 5999.0497s
	iters: 200, epoch: 4 | loss: 2.9973049
	speed: 0.0447s/iter; left time: 893.6622s
Epoch: 4 cost time: 10.896533250808716
Epoch: 4, Steps: 208 | Train Loss: 3.113 Vali Loss: 3.893 Vali Acc: 0.083 Test Loss: 3.893 Test Acc: 0.083
Validation loss decreased (-0.075118 --> -0.082574).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6908734
	speed: 0.2731s/iter; left time: 5425.6847s
	iters: 200, epoch: 5 | loss: 2.4583709
	speed: 0.0509s/iter; left time: 1006.1793s
Epoch: 5 cost time: 11.569698572158813
Epoch: 5, Steps: 208 | Train Loss: 2.970 Vali Loss: 4.079 Vali Acc: 0.093 Test Loss: 4.079 Test Acc: 0.093
Validation loss decreased (-0.082574 --> -0.092712).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2130177
	speed: 0.2840s/iter; left time: 5584.3391s
	iters: 200, epoch: 6 | loss: 2.8893611
	speed: 0.0437s/iter; left time: 854.2714s
Epoch: 6 cost time: 10.4139883518219
Epoch: 6, Steps: 208 | Train Loss: 2.779 Vali Loss: 4.169 Vali Acc: 0.102 Test Loss: 4.169 Test Acc: 0.102
Validation loss decreased (-0.092712 --> -0.102255).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2265916
	speed: 0.2914s/iter; left time: 5668.0070s
	iters: 200, epoch: 7 | loss: 2.7277815
	speed: 0.0455s/iter; left time: 880.2784s
Epoch: 7 cost time: 10.774740219116211
Epoch: 7, Steps: 208 | Train Loss: 2.595 Vali Loss: 4.452 Vali Acc: 0.101 Test Loss: 4.452 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8772480
	speed: 0.2654s/iter; left time: 5108.3927s
	iters: 200, epoch: 8 | loss: 2.5187004
	speed: 0.0529s/iter; left time: 1012.6852s
Epoch: 8 cost time: 11.09136176109314
Epoch: 8, Steps: 208 | Train Loss: 2.319 Vali Loss: 4.705 Vali Acc: 0.115 Test Loss: 4.705 Test Acc: 0.115
Validation loss decreased (-0.102255 --> -0.114776).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9624329
	speed: 0.2655s/iter; left time: 5054.8443s
	iters: 200, epoch: 9 | loss: 2.7971509
	speed: 0.0419s/iter; left time: 792.8188s
Epoch: 9 cost time: 9.756203413009644
Epoch: 9, Steps: 208 | Train Loss: 2.068 Vali Loss: 4.825 Vali Acc: 0.114 Test Loss: 4.825 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9532632
	speed: 0.2604s/iter; left time: 4903.4671s
	iters: 200, epoch: 10 | loss: 1.5908539
	speed: 0.0411s/iter; left time: 769.4574s
Epoch: 10 cost time: 9.016436576843262
Epoch: 10, Steps: 208 | Train Loss: 1.807 Vali Loss: 5.605 Vali Acc: 0.111 Test Loss: 5.605 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1904244
	speed: 0.2679s/iter; left time: 4989.4463s
	iters: 200, epoch: 11 | loss: 1.8821087
	speed: 0.0391s/iter; left time: 724.8197s
Epoch: 11 cost time: 9.46593165397644
Epoch: 11, Steps: 208 | Train Loss: 1.609 Vali Loss: 5.488 Vali Acc: 0.113 Test Loss: 5.488 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2316252
	speed: 0.2803s/iter; left time: 5160.2573s
	iters: 200, epoch: 12 | loss: 1.8348691
	speed: 0.0470s/iter; left time: 861.2953s
Epoch: 12 cost time: 11.265648365020752
Epoch: 12, Steps: 208 | Train Loss: 1.361 Vali Loss: 5.822 Vali Acc: 0.125 Test Loss: 5.822 Test Acc: 0.125
Validation loss decreased (-0.114776 --> -0.124606).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9625908
	speed: 0.2929s/iter; left time: 5332.0611s
	iters: 200, epoch: 13 | loss: 0.9327264
	speed: 0.0446s/iter; left time: 807.1132s
Epoch: 13 cost time: 10.365174293518066
Epoch: 13, Steps: 208 | Train Loss: 1.129 Vali Loss: 6.135 Vali Acc: 0.108 Test Loss: 6.135 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7294962
	speed: 0.2865s/iter; left time: 5155.6034s
	iters: 200, epoch: 14 | loss: 0.6708694
	speed: 0.0464s/iter; left time: 830.7364s
Epoch: 14 cost time: 12.007852792739868
Epoch: 14, Steps: 208 | Train Loss: 0.980 Vali Loss: 6.870 Vali Acc: 0.111 Test Loss: 6.870 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5871792
	speed: 0.3102s/iter; left time: 5518.9137s
	iters: 200, epoch: 15 | loss: 0.7554600
	speed: 0.0441s/iter; left time: 779.3507s
Epoch: 15 cost time: 11.542061805725098
Epoch: 15, Steps: 208 | Train Loss: 0.818 Vali Loss: 7.071 Vali Acc: 0.119 Test Loss: 7.071 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5488521
	speed: 0.2844s/iter; left time: 5000.8370s
	iters: 200, epoch: 16 | loss: 0.7958287
	speed: 0.0422s/iter; left time: 736.8347s
Epoch: 16 cost time: 10.177214860916138
Epoch: 16, Steps: 208 | Train Loss: 0.710 Vali Loss: 7.415 Vali Acc: 0.118 Test Loss: 7.415 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4654490
	speed: 0.2704s/iter; left time: 4698.4924s
	iters: 200, epoch: 17 | loss: 0.7725543
	speed: 0.0318s/iter; left time: 550.0076s
Epoch: 17 cost time: 8.588927507400513
Epoch: 17, Steps: 208 | Train Loss: 0.612 Vali Loss: 7.862 Vali Acc: 0.112 Test Loss: 7.862 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1595660
	speed: 0.2585s/iter; left time: 4437.8809s
	iters: 200, epoch: 18 | loss: 0.3698697
	speed: 0.0504s/iter; left time: 860.7637s
Epoch: 18 cost time: 11.02160096168518
Epoch: 18, Steps: 208 | Train Loss: 0.583 Vali Loss: 8.353 Vali Acc: 0.112 Test Loss: 8.353 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1300006
	speed: 0.2844s/iter; left time: 4822.4421s
	iters: 200, epoch: 19 | loss: 0.5084420
	speed: 0.0420s/iter; left time: 707.6231s
Epoch: 19 cost time: 10.146223545074463
Epoch: 19, Steps: 208 | Train Loss: 0.472 Vali Loss: 8.371 Vali Acc: 0.111 Test Loss: 8.371 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0915880
	speed: 0.2655s/iter; left time: 4447.0403s
	iters: 200, epoch: 20 | loss: 0.2901602
	speed: 0.0422s/iter; left time: 702.3938s
Epoch: 20 cost time: 9.914439916610718
Epoch: 20, Steps: 208 | Train Loss: 0.412 Vali Loss: 9.385 Vali Acc: 0.112 Test Loss: 9.385 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2731637
	speed: 0.2418s/iter; left time: 3999.7656s
	iters: 200, epoch: 21 | loss: 0.2336590
	speed: 0.0437s/iter; left time: 718.7537s
Epoch: 21 cost time: 9.74132490158081
Epoch: 21, Steps: 208 | Train Loss: 0.392 Vali Loss: 9.583 Vali Acc: 0.113 Test Loss: 9.583 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3967685
	speed: 0.2612s/iter; left time: 4265.5508s
	iters: 200, epoch: 22 | loss: 0.0682886
	speed: 0.0363s/iter; left time: 589.3303s
Epoch: 22 cost time: 9.367159843444824
Epoch: 22, Steps: 208 | Train Loss: 0.347 Vali Loss: 9.810 Vali Acc: 0.114 Test Loss: 9.810 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 295847
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.5132265
	speed: 0.1442s/iter; left time: 2985.7864s
	iters: 200, epoch: 1 | loss: 3.7961864
	speed: 0.1045s/iter; left time: 2152.2435s
Epoch: 1 cost time: 25.8110408782959
Epoch: 1, Steps: 208 | Train Loss: 4.683 Vali Loss: 3.709 Vali Acc: 0.066 Test Loss: 3.709 Test Acc: 0.066
Validation loss decreased (inf --> -0.065874).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2815163
	speed: 0.4248s/iter; left time: 8704.6374s
	iters: 200, epoch: 2 | loss: 4.3561883
	speed: 0.1030s/iter; left time: 2100.6029s
Epoch: 2 cost time: 22.652334213256836
Epoch: 2, Steps: 208 | Train Loss: 3.658 Vali Loss: 4.247 Vali Acc: 0.054 Test Loss: 4.247 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2915795
	speed: 0.3964s/iter; left time: 8041.1657s
	iters: 200, epoch: 3 | loss: 4.1498561
	speed: 0.0819s/iter; left time: 1652.8884s
Epoch: 3 cost time: 18.100297451019287
Epoch: 3, Steps: 208 | Train Loss: 4.002 Vali Loss: 4.272 Vali Acc: 0.088 Test Loss: 4.272 Test Acc: 0.088
Validation loss decreased (-0.065874 --> -0.087640).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8822584
	speed: 0.3692s/iter; left time: 7413.0803s
	iters: 200, epoch: 4 | loss: 3.9755723
	speed: 0.0865s/iter; left time: 1727.9886s
Epoch: 4 cost time: 18.3959481716156
Epoch: 4, Steps: 208 | Train Loss: 4.211 Vali Loss: 4.385 Vali Acc: 0.091 Test Loss: 4.385 Test Acc: 0.091
Validation loss decreased (-0.087640 --> -0.091218).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.7012472
	speed: 0.3822s/iter; left time: 7593.3781s
	iters: 200, epoch: 5 | loss: 3.3393509
	speed: 0.0816s/iter; left time: 1613.9232s
Epoch: 5 cost time: 17.888019323349
Epoch: 5, Steps: 208 | Train Loss: 4.226 Vali Loss: 4.469 Vali Acc: 0.105 Test Loss: 4.469 Test Acc: 0.105
Validation loss decreased (-0.091218 --> -0.104638).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.9678071
	speed: 0.3308s/iter; left time: 6503.0668s
	iters: 200, epoch: 6 | loss: 2.9443724
	speed: 0.0604s/iter; left time: 1181.1129s
Epoch: 6 cost time: 14.358736753463745
Epoch: 6, Steps: 208 | Train Loss: 3.855 Vali Loss: 4.725 Vali Acc: 0.123 Test Loss: 4.725 Test Acc: 0.123
Validation loss decreased (-0.104638 --> -0.123126).  Saving model ...
	iters: 100, epoch: 7 | loss: 4.7196641
	speed: 0.3587s/iter; left time: 6978.2801s
	iters: 200, epoch: 7 | loss: 5.0473332
	speed: 0.0706s/iter; left time: 1365.4734s
Epoch: 7 cost time: 16.485695600509644
Epoch: 7, Steps: 208 | Train Loss: 3.499 Vali Loss: 5.674 Vali Acc: 0.110 Test Loss: 5.674 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4890683
	speed: 0.3539s/iter; left time: 6810.3165s
	iters: 200, epoch: 8 | loss: 2.3919077
	speed: 0.0660s/iter; left time: 1262.7700s
Epoch: 8 cost time: 14.927240371704102
Epoch: 8, Steps: 208 | Train Loss: 2.699 Vali Loss: 6.209 Vali Acc: 0.105 Test Loss: 6.209 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.7052808
	speed: 0.3186s/iter; left time: 6065.9103s
	iters: 200, epoch: 9 | loss: 1.9744651
	speed: 0.0588s/iter; left time: 1112.6010s
Epoch: 9 cost time: 13.190967321395874
Epoch: 9, Steps: 208 | Train Loss: 2.020 Vali Loss: 7.052 Vali Acc: 0.082 Test Loss: 7.052 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.3555157
	speed: 0.2833s/iter; left time: 5334.3443s
	iters: 200, epoch: 10 | loss: 2.4496188
	speed: 0.0552s/iter; left time: 1034.3891s
Epoch: 10 cost time: 12.474501609802246
Epoch: 10, Steps: 208 | Train Loss: 1.479 Vali Loss: 5.872 Vali Acc: 0.125 Test Loss: 5.872 Test Acc: 0.125
Validation loss decreased (-0.123126 --> -0.125202).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7880175
	speed: 0.2925s/iter; left time: 5447.0284s
	iters: 200, epoch: 11 | loss: 1.4431081
	speed: 0.0584s/iter; left time: 1080.9229s
Epoch: 11 cost time: 12.934011459350586
Epoch: 11, Steps: 208 | Train Loss: 1.163 Vali Loss: 6.670 Vali Acc: 0.112 Test Loss: 6.670 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6839210
	speed: 0.3259s/iter; left time: 6001.4549s
	iters: 200, epoch: 12 | loss: 0.9063624
	speed: 0.0771s/iter; left time: 1412.2783s
Epoch: 12 cost time: 16.671329736709595
Epoch: 12, Steps: 208 | Train Loss: 0.984 Vali Loss: 6.742 Vali Acc: 0.109 Test Loss: 6.742 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5678922
	speed: 0.3925s/iter; left time: 7144.6475s
	iters: 200, epoch: 13 | loss: 1.8798730
	speed: 0.0890s/iter; left time: 1612.1805s
Epoch: 13 cost time: 19.10531210899353
Epoch: 13, Steps: 208 | Train Loss: 0.876 Vali Loss: 7.007 Vali Acc: 0.112 Test Loss: 7.007 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.6955884
	speed: 0.3841s/iter; left time: 6912.0019s
	iters: 200, epoch: 14 | loss: 1.0191031
	speed: 0.0899s/iter; left time: 1608.9271s
Epoch: 14 cost time: 19.11015248298645
Epoch: 14, Steps: 208 | Train Loss: 0.693 Vali Loss: 8.180 Vali Acc: 0.123 Test Loss: 8.180 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.6216430
	speed: 0.3919s/iter; left time: 6971.9252s
	iters: 200, epoch: 15 | loss: 1.0599444
	speed: 0.0842s/iter; left time: 1489.6119s
Epoch: 15 cost time: 18.4348304271698
Epoch: 15, Steps: 208 | Train Loss: 0.574 Vali Loss: 7.778 Vali Acc: 0.128 Test Loss: 7.778 Test Acc: 0.128
Validation loss decreased (-0.125202 --> -0.127569).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4539352
	speed: 0.3882s/iter; left time: 6824.2595s
	iters: 200, epoch: 16 | loss: 0.2295011
	speed: 0.0813s/iter; left time: 1420.4296s
Epoch: 16 cost time: 18.14474081993103
Epoch: 16, Steps: 208 | Train Loss: 0.456 Vali Loss: 8.446 Vali Acc: 0.127 Test Loss: 8.446 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1777783
	speed: 0.3395s/iter; left time: 5897.3746s
	iters: 200, epoch: 17 | loss: 0.5936646
	speed: 0.0638s/iter; left time: 1102.5781s
Epoch: 17 cost time: 14.061826944351196
Epoch: 17, Steps: 208 | Train Loss: 0.371 Vali Loss: 8.927 Vali Acc: 0.125 Test Loss: 8.927 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5530794
	speed: 0.3189s/iter; left time: 5473.8199s
	iters: 200, epoch: 18 | loss: 0.3267230
	speed: 0.0549s/iter; left time: 936.4938s
Epoch: 18 cost time: 13.018836736679077
Epoch: 18, Steps: 208 | Train Loss: 0.289 Vali Loss: 9.516 Vali Acc: 0.135 Test Loss: 9.516 Test Acc: 0.135
Validation loss decreased (-0.127569 --> -0.135306).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1222432
	speed: 0.3108s/iter; left time: 5270.2614s
	iters: 200, epoch: 19 | loss: 0.3107588
	speed: 0.0632s/iter; left time: 1065.0565s
Epoch: 19 cost time: 14.018667221069336
Epoch: 19, Steps: 208 | Train Loss: 0.304 Vali Loss: 10.198 Vali Acc: 0.126 Test Loss: 10.198 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.3044184
	speed: 0.3180s/iter; left time: 5326.5130s
	iters: 200, epoch: 20 | loss: 0.1658974
	speed: 0.0623s/iter; left time: 1037.2338s
Epoch: 20 cost time: 13.75846791267395
Epoch: 20, Steps: 208 | Train Loss: 0.270 Vali Loss: 10.279 Vali Acc: 0.124 Test Loss: 10.279 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.7901258
	speed: 0.3160s/iter; left time: 5227.1548s
	iters: 200, epoch: 21 | loss: 0.2759185
	speed: 0.0639s/iter; left time: 1049.8353s
Epoch: 21 cost time: 13.929469347000122
Epoch: 21, Steps: 208 | Train Loss: 0.246 Vali Loss: 11.169 Vali Acc: 0.120 Test Loss: 11.169 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0983154
	speed: 0.2920s/iter; left time: 4769.1903s
	iters: 200, epoch: 22 | loss: 0.3899398
	speed: 0.0578s/iter; left time: 938.4688s
Epoch: 22 cost time: 13.394025087356567
Epoch: 22, Steps: 208 | Train Loss: 0.203 Vali Loss: 11.911 Vali Acc: 0.122 Test Loss: 11.911 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0688168
	speed: 0.3487s/iter; left time: 5623.3961s
	iters: 200, epoch: 23 | loss: 0.0315249
	speed: 0.0857s/iter; left time: 1373.2517s
Epoch: 23 cost time: 18.572194576263428
Epoch: 23, Steps: 208 | Train Loss: 0.168 Vali Loss: 12.070 Vali Acc: 0.118 Test Loss: 12.070 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0021539
	speed: 0.3877s/iter; left time: 6170.8108s
	iters: 200, epoch: 24 | loss: 0.1809027
	speed: 0.0865s/iter; left time: 1368.7041s
Epoch: 24 cost time: 19.428649187088013
Epoch: 24, Steps: 208 | Train Loss: 0.176 Vali Loss: 12.278 Vali Acc: 0.134 Test Loss: 12.278 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0646058
	speed: 0.3847s/iter; left time: 6042.6975s
	iters: 200, epoch: 25 | loss: 0.3056956
	speed: 0.0859s/iter; left time: 1340.3283s
Epoch: 25 cost time: 18.818964958190918
Epoch: 25, Steps: 208 | Train Loss: 0.150 Vali Loss: 12.128 Vali Acc: 0.130 Test Loss: 12.128 Test Acc: 0.130
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.3870628
	speed: 0.3779s/iter; left time: 5857.9382s
	iters: 200, epoch: 26 | loss: 0.2175544
	speed: 0.0814s/iter; left time: 1254.4017s
Epoch: 26 cost time: 18.33237624168396
Epoch: 26, Steps: 208 | Train Loss: 0.150 Vali Loss: 12.209 Vali Acc: 0.128 Test Loss: 12.209 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.2867933
	speed: 0.3736s/iter; left time: 5712.8790s
	iters: 200, epoch: 27 | loss: 0.0049709
	speed: 0.0822s/iter; left time: 1248.2036s
Epoch: 27 cost time: 18.34175395965576
Epoch: 27, Steps: 208 | Train Loss: 0.124 Vali Loss: 13.006 Vali Acc: 0.131 Test Loss: 13.006 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.3111676
	speed: 0.3331s/iter; left time: 5025.0865s
	iters: 200, epoch: 28 | loss: 0.1519580
	speed: 0.0583s/iter; left time: 873.9101s
Epoch: 28 cost time: 13.851130962371826
Epoch: 28, Steps: 208 | Train Loss: 0.142 Vali Loss: 13.264 Vali Acc: 0.133 Test Loss: 13.264 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13540113331345063
model parameter : 2044327
model size : 9.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2655320
	speed: 0.0908s/iter; left time: 1879.6492s
	iters: 200, epoch: 1 | loss: 3.8094833
	speed: 0.0474s/iter; left time: 975.6528s
Epoch: 1 cost time: 14.56162166595459
Epoch: 1, Steps: 208 | Train Loss: 4.337 Vali Loss: 3.714 Vali Acc: 0.067 Test Loss: 3.714 Test Acc: 0.067
Validation loss decreased (inf --> -0.067365).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0729349
	speed: 0.3275s/iter; left time: 6711.8572s
	iters: 200, epoch: 2 | loss: 3.0580707
	speed: 0.0756s/iter; left time: 1541.5736s
Epoch: 2 cost time: 16.639007091522217
Epoch: 2, Steps: 208 | Train Loss: 3.418 Vali Loss: 3.737 Vali Acc: 0.085 Test Loss: 3.737 Test Acc: 0.085
Validation loss decreased (-0.067365 --> -0.085259).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3432794
	speed: 0.3658s/iter; left time: 7420.7545s
	iters: 200, epoch: 3 | loss: 4.1394048
	speed: 0.0681s/iter; left time: 1375.0392s
Epoch: 3 cost time: 17.927757263183594
Epoch: 3, Steps: 208 | Train Loss: 3.421 Vali Loss: 3.767 Vali Acc: 0.082 Test Loss: 3.767 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3294642
	speed: 0.3556s/iter; left time: 7139.8167s
	iters: 200, epoch: 4 | loss: 3.4948902
	speed: 0.0772s/iter; left time: 1543.1346s
Epoch: 4 cost time: 18.086246728897095
Epoch: 4, Steps: 208 | Train Loss: 3.506 Vali Loss: 4.106 Vali Acc: 0.093 Test Loss: 4.106 Test Acc: 0.093
Validation loss decreased (-0.085259 --> -0.092712).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7122252
	speed: 0.3189s/iter; left time: 6336.8155s
	iters: 200, epoch: 5 | loss: 4.2997923
	speed: 0.0798s/iter; left time: 1576.7815s
Epoch: 5 cost time: 17.109917163848877
Epoch: 5, Steps: 208 | Train Loss: 3.418 Vali Loss: 4.057 Vali Acc: 0.118 Test Loss: 4.057 Test Acc: 0.118
Validation loss decreased (-0.092712 --> -0.118063).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8515840
	speed: 0.3125s/iter; left time: 6144.1044s
	iters: 200, epoch: 6 | loss: 3.3929214
	speed: 0.0716s/iter; left time: 1401.1391s
Epoch: 6 cost time: 15.358715772628784
Epoch: 6, Steps: 208 | Train Loss: 3.288 Vali Loss: 4.694 Vali Acc: 0.125 Test Loss: 4.694 Test Acc: 0.125
Validation loss decreased (-0.118063 --> -0.124618).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.8412502
	speed: 0.2931s/iter; left time: 5701.5504s
	iters: 200, epoch: 7 | loss: 3.3480775
	speed: 0.0483s/iter; left time: 934.8163s
Epoch: 7 cost time: 10.63031554222107
Epoch: 7, Steps: 208 | Train Loss: 3.039 Vali Loss: 4.350 Vali Acc: 0.132 Test Loss: 4.350 Test Acc: 0.132
Validation loss decreased (-0.124618 --> -0.132077).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6594923
	speed: 0.2660s/iter; left time: 5119.7864s
	iters: 200, epoch: 8 | loss: 2.9619246
	speed: 0.0465s/iter; left time: 890.8154s
Epoch: 8 cost time: 10.456649541854858
Epoch: 8, Steps: 208 | Train Loss: 2.737 Vali Loss: 5.126 Vali Acc: 0.111 Test Loss: 5.126 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2469985
	speed: 0.2936s/iter; left time: 5589.1079s
	iters: 200, epoch: 9 | loss: 2.4067779
	speed: 0.0519s/iter; left time: 981.9987s
Epoch: 9 cost time: 13.72741413116455
Epoch: 9, Steps: 208 | Train Loss: 2.189 Vali Loss: 4.950 Vali Acc: 0.110 Test Loss: 4.950 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.4076991
	speed: 0.3148s/iter; left time: 5926.9876s
	iters: 200, epoch: 10 | loss: 1.8104184
	speed: 0.0618s/iter; left time: 1157.9637s
Epoch: 10 cost time: 14.454144954681396
Epoch: 10, Steps: 208 | Train Loss: 1.775 Vali Loss: 5.490 Vali Acc: 0.117 Test Loss: 5.490 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7119125
	speed: 0.2692s/iter; left time: 5013.6044s
	iters: 200, epoch: 11 | loss: 1.1953208
	speed: 0.0534s/iter; left time: 989.1079s
Epoch: 11 cost time: 12.238551139831543
Epoch: 11, Steps: 208 | Train Loss: 1.482 Vali Loss: 5.431 Vali Acc: 0.140 Test Loss: 5.431 Test Acc: 0.140
Validation loss decreased (-0.132077 --> -0.140417).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6706419
	speed: 0.2954s/iter; left time: 5438.4942s
	iters: 200, epoch: 12 | loss: 1.5621823
	speed: 0.0481s/iter; left time: 881.1626s
Epoch: 12 cost time: 10.589292526245117
Epoch: 12, Steps: 208 | Train Loss: 1.224 Vali Loss: 6.377 Vali Acc: 0.124 Test Loss: 6.377 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4039987
	speed: 0.2613s/iter; left time: 4757.5800s
	iters: 200, epoch: 13 | loss: 1.0109271
	speed: 0.0509s/iter; left time: 921.3721s
Epoch: 13 cost time: 11.21183156967163
Epoch: 13, Steps: 208 | Train Loss: 1.035 Vali Loss: 6.612 Vali Acc: 0.139 Test Loss: 6.612 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3910466
	speed: 0.3005s/iter; left time: 5407.7308s
	iters: 200, epoch: 14 | loss: 1.1752548
	speed: 0.0700s/iter; left time: 1251.9007s
Epoch: 14 cost time: 16.43000888824463
Epoch: 14, Steps: 208 | Train Loss: 0.847 Vali Loss: 7.004 Vali Acc: 0.132 Test Loss: 7.004 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7385763
	speed: 0.3176s/iter; left time: 5649.3774s
	iters: 200, epoch: 15 | loss: 0.6459227
	speed: 0.0781s/iter; left time: 1380.8370s
Epoch: 15 cost time: 17.91898465156555
Epoch: 15, Steps: 208 | Train Loss: 0.716 Vali Loss: 7.064 Vali Acc: 0.145 Test Loss: 7.064 Test Acc: 0.145
Validation loss decreased (-0.140417 --> -0.144874).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5359980
	speed: 0.3400s/iter; left time: 5976.9769s
	iters: 200, epoch: 16 | loss: 0.3421184
	speed: 0.0851s/iter; left time: 1487.6201s
Epoch: 16 cost time: 19.388200759887695
Epoch: 16, Steps: 208 | Train Loss: 0.607 Vali Loss: 7.404 Vali Acc: 0.138 Test Loss: 7.404 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.5967396
	speed: 0.3349s/iter; left time: 5818.1038s
	iters: 200, epoch: 17 | loss: 0.5904903
	speed: 0.0877s/iter; left time: 1514.9814s
Epoch: 17 cost time: 18.644476890563965
Epoch: 17, Steps: 208 | Train Loss: 0.501 Vali Loss: 8.270 Vali Acc: 0.134 Test Loss: 8.270 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7867373
	speed: 0.3273s/iter; left time: 5617.5894s
	iters: 200, epoch: 18 | loss: 0.5270719
	speed: 0.0703s/iter; left time: 1200.3060s
Epoch: 18 cost time: 16.377211809158325
Epoch: 18, Steps: 208 | Train Loss: 0.456 Vali Loss: 9.428 Vali Acc: 0.138 Test Loss: 9.428 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2306441
	speed: 0.3143s/iter; left time: 5330.3710s
	iters: 200, epoch: 19 | loss: 0.4637279
	speed: 0.0655s/iter; left time: 1104.5148s
Epoch: 19 cost time: 14.42386531829834
Epoch: 19, Steps: 208 | Train Loss: 0.400 Vali Loss: 9.510 Vali Acc: 0.140 Test Loss: 9.510 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4283812
	speed: 0.2739s/iter; left time: 4588.0237s
	iters: 200, epoch: 20 | loss: 0.5234420
	speed: 0.0524s/iter; left time: 872.4658s
Epoch: 20 cost time: 12.018327951431274
Epoch: 20, Steps: 208 | Train Loss: 0.319 Vali Loss: 9.703 Vali Acc: 0.135 Test Loss: 9.703 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3896532
	speed: 0.2920s/iter; left time: 4830.3764s
	iters: 200, epoch: 21 | loss: 0.2150600
	speed: 0.0614s/iter; left time: 1009.4918s
Epoch: 21 cost time: 13.458940029144287
Epoch: 21, Steps: 208 | Train Loss: 0.281 Vali Loss: 9.997 Vali Acc: 0.141 Test Loss: 9.997 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0161718
	speed: 0.3348s/iter; left time: 5468.2904s
	iters: 200, epoch: 22 | loss: 0.0682609
	speed: 0.0588s/iter; left time: 954.9606s
Epoch: 22 cost time: 15.85897445678711
Epoch: 22, Steps: 208 | Train Loss: 0.254 Vali Loss: 10.589 Vali Acc: 0.129 Test Loss: 10.589 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.4578629
	speed: 0.3081s/iter; left time: 4968.0923s
	iters: 200, epoch: 23 | loss: 0.5401781
	speed: 0.0689s/iter; left time: 1104.5652s
Epoch: 23 cost time: 15.57974910736084
Epoch: 23, Steps: 208 | Train Loss: 0.287 Vali Loss: 10.459 Vali Acc: 0.137 Test Loss: 10.459 Test Acc: 0.137
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1259943
	speed: 0.2815s/iter; left time: 4480.7589s
	iters: 200, epoch: 24 | loss: 0.0439574
	speed: 0.0659s/iter; left time: 1041.6273s
Epoch: 24 cost time: 12.89757227897644
Epoch: 24, Steps: 208 | Train Loss: 0.231 Vali Loss: 11.314 Vali Acc: 0.142 Test Loss: 11.314 Test Acc: 0.142
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0318578
	speed: 0.2754s/iter; left time: 4325.7983s
	iters: 200, epoch: 25 | loss: 0.4021823
	speed: 0.0481s/iter; left time: 751.0244s
Epoch: 25 cost time: 11.173969268798828
Epoch: 25, Steps: 208 | Train Loss: 0.216 Vali Loss: 10.805 Vali Acc: 0.138 Test Loss: 10.805 Test Acc: 0.138
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14494482552937668
model parameter : 1056231
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4817243
	speed: 0.1214s/iter; left time: 2512.6075s
	iters: 200, epoch: 1 | loss: 3.4373267
	speed: 0.0622s/iter; left time: 1282.2858s
Epoch: 1 cost time: 19.13444685935974
Epoch: 1, Steps: 208 | Train Loss: 4.163 Vali Loss: 3.968 Vali Acc: 0.067 Test Loss: 3.968 Test Acc: 0.067
Validation loss decreased (inf --> -0.067064).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7379763
	speed: 0.3305s/iter; left time: 6772.1367s
	iters: 200, epoch: 2 | loss: 3.3510096
	speed: 0.0623s/iter; left time: 1269.7208s
Epoch: 2 cost time: 14.63399863243103
Epoch: 2, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.525 Vali Acc: 0.084 Test Loss: 3.525 Test Acc: 0.084
Validation loss decreased (-0.067064 --> -0.083472).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7285314
	speed: 0.3167s/iter; left time: 6424.9384s
	iters: 200, epoch: 3 | loss: 3.0293143
	speed: 0.0616s/iter; left time: 1243.4131s
Epoch: 3 cost time: 14.855389595031738
Epoch: 3, Steps: 208 | Train Loss: 3.240 Vali Loss: 3.680 Vali Acc: 0.102 Test Loss: 3.680 Test Acc: 0.102
Validation loss decreased (-0.083472 --> -0.102260).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9115500
	speed: 0.3101s/iter; left time: 6225.7998s
	iters: 200, epoch: 4 | loss: 2.9301920
	speed: 0.0579s/iter; left time: 1157.4467s
Epoch: 4 cost time: 13.83293867111206
Epoch: 4, Steps: 208 | Train Loss: 3.295 Vali Loss: 3.955 Vali Acc: 0.103 Test Loss: 3.955 Test Acc: 0.103
Validation loss decreased (-0.102260 --> -0.102853).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6264372
	speed: 0.2952s/iter; left time: 5865.2267s
	iters: 200, epoch: 5 | loss: 3.1141233
	speed: 0.0473s/iter; left time: 935.0932s
Epoch: 5 cost time: 12.113472700119019
Epoch: 5, Steps: 208 | Train Loss: 3.224 Vali Loss: 3.833 Vali Acc: 0.104 Test Loss: 3.833 Test Acc: 0.104
Validation loss decreased (-0.102853 --> -0.103749).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1305580
	speed: 0.2877s/iter; left time: 5655.5303s
	iters: 200, epoch: 6 | loss: 4.2077765
	speed: 0.0538s/iter; left time: 1052.7252s
Epoch: 6 cost time: 12.095000505447388
Epoch: 6, Steps: 208 | Train Loss: 3.181 Vali Loss: 4.218 Vali Acc: 0.103 Test Loss: 4.218 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3147631
	speed: 0.2945s/iter; left time: 5728.1988s
	iters: 200, epoch: 7 | loss: 2.9440920
	speed: 0.0515s/iter; left time: 997.0477s
Epoch: 7 cost time: 13.103951215744019
Epoch: 7, Steps: 208 | Train Loss: 2.882 Vali Loss: 4.777 Vali Acc: 0.112 Test Loss: 4.777 Test Acc: 0.112
Validation loss decreased (-0.103749 --> -0.112389).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4572463
	speed: 0.2922s/iter; left time: 5624.2321s
	iters: 200, epoch: 8 | loss: 2.4745226
	speed: 0.0522s/iter; left time: 999.9368s
Epoch: 8 cost time: 12.256266355514526
Epoch: 8, Steps: 208 | Train Loss: 2.711 Vali Loss: 4.837 Vali Acc: 0.112 Test Loss: 4.837 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.7111485
	speed: 0.3006s/iter; left time: 5721.5749s
	iters: 200, epoch: 9 | loss: 2.4191711
	speed: 0.0507s/iter; left time: 960.4966s
Epoch: 9 cost time: 11.81610631942749
Epoch: 9, Steps: 208 | Train Loss: 2.278 Vali Loss: 5.617 Vali Acc: 0.130 Test Loss: 5.617 Test Acc: 0.130
Validation loss decreased (-0.112389 --> -0.130275).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9789205
	speed: 0.3053s/iter; left time: 5748.2792s
	iters: 200, epoch: 10 | loss: 1.1832087
	speed: 0.0632s/iter; left time: 1182.8171s
Epoch: 10 cost time: 13.94913935661316
Epoch: 10, Steps: 208 | Train Loss: 1.915 Vali Loss: 5.801 Vali Acc: 0.117 Test Loss: 5.801 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1967571
	speed: 0.3238s/iter; left time: 6029.8568s
	iters: 200, epoch: 11 | loss: 1.9066341
	speed: 0.0650s/iter; left time: 1203.1083s
Epoch: 11 cost time: 14.482829093933105
Epoch: 11, Steps: 208 | Train Loss: 1.624 Vali Loss: 5.277 Vali Acc: 0.125 Test Loss: 5.277 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2288973
	speed: 0.3336s/iter; left time: 6142.5331s
	iters: 200, epoch: 12 | loss: 1.7946866
	speed: 0.0900s/iter; left time: 1647.4990s
Epoch: 12 cost time: 18.2365939617157
Epoch: 12, Steps: 208 | Train Loss: 1.374 Vali Loss: 6.539 Vali Acc: 0.120 Test Loss: 6.539 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4012150
	speed: 0.3437s/iter; left time: 6257.1222s
	iters: 200, epoch: 13 | loss: 1.1586828
	speed: 0.0757s/iter; left time: 1370.8207s
Epoch: 13 cost time: 16.892693519592285
Epoch: 13, Steps: 208 | Train Loss: 1.147 Vali Loss: 5.922 Vali Acc: 0.136 Test Loss: 5.922 Test Acc: 0.136
Validation loss decreased (-0.130275 --> -0.135938).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0172902
	speed: 0.3621s/iter; left time: 6516.3971s
	iters: 200, epoch: 14 | loss: 0.9544291
	speed: 0.0862s/iter; left time: 1543.3409s
Epoch: 14 cost time: 17.16699194908142
Epoch: 14, Steps: 208 | Train Loss: 0.956 Vali Loss: 6.508 Vali Acc: 0.129 Test Loss: 6.508 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6138945
	speed: 0.3438s/iter; left time: 6115.3744s
	iters: 200, epoch: 15 | loss: 1.0897049
	speed: 0.0639s/iter; left time: 1131.1048s
Epoch: 15 cost time: 14.180664777755737
Epoch: 15, Steps: 208 | Train Loss: 0.808 Vali Loss: 6.786 Vali Acc: 0.131 Test Loss: 6.786 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5770791
	speed: 0.2866s/iter; left time: 5039.5440s
	iters: 200, epoch: 16 | loss: 0.9834678
	speed: 0.0497s/iter; left time: 868.8205s
Epoch: 16 cost time: 11.044201612472534
Epoch: 16, Steps: 208 | Train Loss: 0.654 Vali Loss: 7.284 Vali Acc: 0.123 Test Loss: 7.284 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1598327
	speed: 0.3119s/iter; left time: 5419.3651s
	iters: 200, epoch: 17 | loss: 0.7243829
	speed: 0.0553s/iter; left time: 956.0348s
Epoch: 17 cost time: 12.489501237869263
Epoch: 17, Steps: 208 | Train Loss: 0.563 Vali Loss: 7.760 Vali Acc: 0.127 Test Loss: 7.760 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4904194
	speed: 0.2955s/iter; left time: 5072.9700s
	iters: 200, epoch: 18 | loss: 0.8347741
	speed: 0.0515s/iter; left time: 878.2456s
Epoch: 18 cost time: 12.434704303741455
Epoch: 18, Steps: 208 | Train Loss: 0.487 Vali Loss: 8.370 Vali Acc: 0.126 Test Loss: 8.370 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4453662
	speed: 0.3104s/iter; left time: 5264.2139s
	iters: 200, epoch: 19 | loss: 0.7538461
	speed: 0.0556s/iter; left time: 936.9553s
Epoch: 19 cost time: 12.479948043823242
Epoch: 19, Steps: 208 | Train Loss: 0.426 Vali Loss: 8.774 Vali Acc: 0.131 Test Loss: 8.774 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.9182518
	speed: 0.3120s/iter; left time: 5225.7201s
	iters: 200, epoch: 20 | loss: 0.1913680
	speed: 0.0511s/iter; left time: 850.6899s
Epoch: 20 cost time: 12.274788856506348
Epoch: 20, Steps: 208 | Train Loss: 0.383 Vali Loss: 8.978 Vali Acc: 0.126 Test Loss: 8.978 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.5120295
	speed: 0.3607s/iter; left time: 5965.7993s
	iters: 200, epoch: 21 | loss: 0.4826093
	speed: 0.0714s/iter; left time: 1174.4221s
Epoch: 21 cost time: 16.248979330062866
Epoch: 21, Steps: 208 | Train Loss: 0.339 Vali Loss: 9.169 Vali Acc: 0.134 Test Loss: 9.169 Test Acc: 0.134
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3689191
	speed: 0.3547s/iter; left time: 5793.1848s
	iters: 200, epoch: 22 | loss: 0.0867191
	speed: 0.0757s/iter; left time: 1228.6347s
Epoch: 22 cost time: 16.74602961540222
Epoch: 22, Steps: 208 | Train Loss: 0.312 Vali Loss: 9.867 Vali Acc: 0.134 Test Loss: 9.867 Test Acc: 0.134
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0427998
	speed: 0.3394s/iter; left time: 5473.0952s
	iters: 200, epoch: 23 | loss: 0.3635454
	speed: 0.0671s/iter; left time: 1075.2877s
Epoch: 23 cost time: 15.539575338363647
Epoch: 23, Steps: 208 | Train Loss: 0.272 Vali Loss: 9.919 Vali Acc: 0.129 Test Loss: 9.919 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13599761407694602
model parameter : 727143
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9021635
	speed: 0.1028s/iter; left time: 2128.9023s
	iters: 200, epoch: 1 | loss: 4.2422080
	speed: 0.0591s/iter; left time: 1217.6277s
Epoch: 1 cost time: 16.785863399505615
Epoch: 1, Steps: 208 | Train Loss: 4.069 Vali Loss: 4.455 Vali Acc: 0.064 Test Loss: 4.455 Test Acc: 0.064
Validation loss decreased (inf --> -0.063779).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0055733
	speed: 0.2943s/iter; left time: 6031.6105s
	iters: 200, epoch: 2 | loss: 3.7024269
	speed: 0.0543s/iter; left time: 1108.0544s
Epoch: 2 cost time: 12.3311288356781
Epoch: 2, Steps: 208 | Train Loss: 3.560 Vali Loss: 3.636 Vali Acc: 0.080 Test Loss: 3.636 Test Acc: 0.080
Validation loss decreased (-0.063779 --> -0.079594).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3664303
	speed: 0.3038s/iter; left time: 6161.8375s
	iters: 200, epoch: 3 | loss: 3.7646382
	speed: 0.0590s/iter; left time: 1191.2230s
Epoch: 3 cost time: 13.250542402267456
Epoch: 3, Steps: 208 | Train Loss: 3.190 Vali Loss: 4.275 Vali Acc: 0.085 Test Loss: 4.275 Test Acc: 0.085
Validation loss decreased (-0.079594 --> -0.085254).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0437303
	speed: 0.2710s/iter; left time: 5441.6587s
	iters: 200, epoch: 4 | loss: 4.2869334
	speed: 0.0427s/iter; left time: 853.7212s
Epoch: 4 cost time: 10.320091247558594
Epoch: 4, Steps: 208 | Train Loss: 3.176 Vali Loss: 4.145 Vali Acc: 0.092 Test Loss: 4.145 Test Acc: 0.092
Validation loss decreased (-0.085254 --> -0.091518).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0606270
	speed: 0.2873s/iter; left time: 5708.9680s
	iters: 200, epoch: 5 | loss: 3.6448164
	speed: 0.0484s/iter; left time: 957.5625s
Epoch: 5 cost time: 10.942726612091064
Epoch: 5, Steps: 208 | Train Loss: 3.070 Vali Loss: 4.001 Vali Acc: 0.110 Test Loss: 4.001 Test Acc: 0.110
Validation loss decreased (-0.091518 --> -0.110309).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5219505
	speed: 0.2820s/iter; left time: 5544.4517s
	iters: 200, epoch: 6 | loss: 2.9021015
	speed: 0.0493s/iter; left time: 965.1713s
Epoch: 6 cost time: 12.527910470962524
Epoch: 6, Steps: 208 | Train Loss: 2.989 Vali Loss: 4.535 Vali Acc: 0.114 Test Loss: 4.535 Test Acc: 0.114
Validation loss decreased (-0.110309 --> -0.113584).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3185179
	speed: 0.2815s/iter; left time: 5476.3823s
	iters: 200, epoch: 7 | loss: 3.0694938
	speed: 0.0533s/iter; left time: 1031.3415s
Epoch: 7 cost time: 11.92978549003601
Epoch: 7, Steps: 208 | Train Loss: 2.823 Vali Loss: 4.467 Vali Acc: 0.128 Test Loss: 4.467 Test Acc: 0.128
Validation loss decreased (-0.113584 --> -0.128199).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1668391
	speed: 0.3300s/iter; left time: 6351.1895s
	iters: 200, epoch: 8 | loss: 2.2214530
	speed: 0.0769s/iter; left time: 1472.0980s
Epoch: 8 cost time: 17.300649166107178
Epoch: 8, Steps: 208 | Train Loss: 2.594 Vali Loss: 4.910 Vali Acc: 0.119 Test Loss: 4.910 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5848725
	speed: 0.3171s/iter; left time: 6036.1324s
	iters: 200, epoch: 9 | loss: 2.2462542
	speed: 0.0832s/iter; left time: 1576.0447s
Epoch: 9 cost time: 18.197193384170532
Epoch: 9, Steps: 208 | Train Loss: 2.251 Vali Loss: 4.909 Vali Acc: 0.127 Test Loss: 4.909 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1953007
	speed: 0.3101s/iter; left time: 5839.0884s
	iters: 200, epoch: 10 | loss: 2.8713217
	speed: 0.0830s/iter; left time: 1554.3476s
Epoch: 10 cost time: 18.441900491714478
Epoch: 10, Steps: 208 | Train Loss: 1.930 Vali Loss: 5.001 Vali Acc: 0.126 Test Loss: 5.001 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.9907672
	speed: 0.2924s/iter; left time: 5445.6218s
	iters: 200, epoch: 11 | loss: 1.8258973
	speed: 0.0764s/iter; left time: 1414.2249s
Epoch: 11 cost time: 16.870666027069092
Epoch: 11, Steps: 208 | Train Loss: 1.614 Vali Loss: 5.343 Vali Acc: 0.120 Test Loss: 5.343 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4905516
	speed: 0.2885s/iter; left time: 5312.5291s
	iters: 200, epoch: 12 | loss: 1.2703322
	speed: 0.0641s/iter; left time: 1173.0159s
Epoch: 12 cost time: 14.492392301559448
Epoch: 12, Steps: 208 | Train Loss: 1.352 Vali Loss: 5.506 Vali Acc: 0.128 Test Loss: 5.506 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5735525
	speed: 0.3177s/iter; left time: 5783.6528s
	iters: 200, epoch: 13 | loss: 1.3236630
	speed: 0.0475s/iter; left time: 859.4316s
Epoch: 13 cost time: 12.494032382965088
Epoch: 13, Steps: 208 | Train Loss: 1.147 Vali Loss: 6.027 Vali Acc: 0.135 Test Loss: 6.027 Test Acc: 0.135
Validation loss decreased (-0.128199 --> -0.134446).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0947744
	speed: 0.2615s/iter; left time: 4706.3385s
	iters: 200, epoch: 14 | loss: 1.4855863
	speed: 0.0471s/iter; left time: 843.1860s
Epoch: 14 cost time: 10.659074306488037
Epoch: 14, Steps: 208 | Train Loss: 0.964 Vali Loss: 6.346 Vali Acc: 0.130 Test Loss: 6.346 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8253857
	speed: 0.2854s/iter; left time: 5077.6895s
	iters: 200, epoch: 15 | loss: 0.8895716
	speed: 0.0468s/iter; left time: 828.3706s
Epoch: 15 cost time: 12.326512575149536
Epoch: 15, Steps: 208 | Train Loss: 0.790 Vali Loss: 6.521 Vali Acc: 0.135 Test Loss: 6.521 Test Acc: 0.135
Validation loss decreased (-0.134446 --> -0.135038).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4947694
	speed: 0.2799s/iter; left time: 4920.4499s
	iters: 200, epoch: 16 | loss: 1.3773333
	speed: 0.0549s/iter; left time: 959.2956s
Epoch: 16 cost time: 13.08043646812439
Epoch: 16, Steps: 208 | Train Loss: 0.675 Vali Loss: 7.232 Vali Acc: 0.137 Test Loss: 7.232 Test Acc: 0.137
Validation loss decreased (-0.135038 --> -0.136522).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1673452
	speed: 0.2657s/iter; left time: 4615.6407s
	iters: 200, epoch: 17 | loss: 1.1222850
	speed: 0.0509s/iter; left time: 878.3818s
Epoch: 17 cost time: 11.836473226547241
Epoch: 17, Steps: 208 | Train Loss: 0.593 Vali Loss: 7.648 Vali Acc: 0.134 Test Loss: 7.648 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.7016803
	speed: 0.2741s/iter; left time: 4704.8175s
	iters: 200, epoch: 18 | loss: 1.5620153
	speed: 0.0478s/iter; left time: 816.3138s
Epoch: 18 cost time: 11.108715772628784
Epoch: 18, Steps: 208 | Train Loss: 0.544 Vali Loss: 7.845 Vali Acc: 0.127 Test Loss: 7.845 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1839336
	speed: 0.2601s/iter; left time: 4410.7907s
	iters: 200, epoch: 19 | loss: 0.7040069
	speed: 0.0425s/iter; left time: 716.2023s
Epoch: 19 cost time: 10.264541387557983
Epoch: 19, Steps: 208 | Train Loss: 0.469 Vali Loss: 8.068 Vali Acc: 0.133 Test Loss: 8.068 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.4497754
	speed: 0.2949s/iter; left time: 4938.8607s
	iters: 200, epoch: 20 | loss: 0.7246911
	speed: 0.0621s/iter; left time: 1034.1096s
Epoch: 20 cost time: 15.151262521743774
Epoch: 20, Steps: 208 | Train Loss: 0.423 Vali Loss: 8.454 Vali Acc: 0.135 Test Loss: 8.454 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3720127
	speed: 0.3466s/iter; left time: 5732.4218s
	iters: 200, epoch: 21 | loss: 0.5429279
	speed: 0.0590s/iter; left time: 969.6883s
Epoch: 21 cost time: 16.22669816017151
Epoch: 21, Steps: 208 | Train Loss: 0.336 Vali Loss: 9.120 Vali Acc: 0.128 Test Loss: 9.120 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6346304
	speed: 0.3191s/iter; left time: 5212.1666s
	iters: 200, epoch: 22 | loss: 0.7961435
	speed: 0.0795s/iter; left time: 1291.1159s
Epoch: 22 cost time: 17.91835594177246
Epoch: 22, Steps: 208 | Train Loss: 0.318 Vali Loss: 9.274 Vali Acc: 0.124 Test Loss: 9.274 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.4077389
	speed: 0.2883s/iter; left time: 4648.6870s
	iters: 200, epoch: 23 | loss: 0.2829927
	speed: 0.0607s/iter; left time: 973.1987s
Epoch: 23 cost time: 13.43243145942688
Epoch: 23, Steps: 208 | Train Loss: 0.325 Vali Loss: 9.600 Vali Acc: 0.126 Test Loss: 9.600 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1092311
	speed: 0.2816s/iter; left time: 4482.3729s
	iters: 200, epoch: 24 | loss: 0.3178524
	speed: 0.0612s/iter; left time: 967.3949s
Epoch: 24 cost time: 12.821984767913818
Epoch: 24, Steps: 208 | Train Loss: 0.278 Vali Loss: 9.777 Vali Acc: 0.120 Test Loss: 9.777 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.4628797
	speed: 0.2741s/iter; left time: 4305.4322s
	iters: 200, epoch: 25 | loss: 0.0628166
	speed: 0.0471s/iter; left time: 735.3565s
Epoch: 25 cost time: 11.77686882019043
Epoch: 25, Steps: 208 | Train Loss: 0.292 Vali Loss: 10.385 Vali Acc: 0.127 Test Loss: 10.385 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0495496
	speed: 0.2652s/iter; left time: 4110.8265s
	iters: 200, epoch: 26 | loss: 0.1234592
	speed: 0.0447s/iter; left time: 689.1154s
Epoch: 26 cost time: 11.511267185211182
Epoch: 26, Steps: 208 | Train Loss: 0.252 Vali Loss: 10.936 Vali Acc: 0.132 Test Loss: 10.936 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13659409484044138
model parameter : 590183
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6824334
	speed: 0.1229s/iter; left time: 2543.6417s
	iters: 200, epoch: 1 | loss: 4.0380526
	speed: 0.0557s/iter; left time: 1146.7120s
Epoch: 1 cost time: 18.340142488479614
Epoch: 1, Steps: 208 | Train Loss: 3.933 Vali Loss: 4.079 Vali Acc: 0.059 Test Loss: 4.079 Test Acc: 0.059
Validation loss decreased (inf --> -0.059309).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4088976
	speed: 0.3073s/iter; left time: 6297.1494s
	iters: 200, epoch: 2 | loss: 3.2713215
	speed: 0.0720s/iter; left time: 1469.0202s
Epoch: 2 cost time: 14.904646873474121
Epoch: 2, Steps: 208 | Train Loss: 3.617 Vali Loss: 3.608 Vali Acc: 0.085 Test Loss: 3.608 Test Acc: 0.085
Validation loss decreased (-0.059309 --> -0.084664).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2704968
	speed: 0.3040s/iter; left time: 6166.7693s
	iters: 200, epoch: 3 | loss: 3.2732656
	speed: 0.0729s/iter; left time: 1472.2386s
Epoch: 3 cost time: 15.365358114242554
Epoch: 3, Steps: 208 | Train Loss: 3.179 Vali Loss: 3.729 Vali Acc: 0.090 Test Loss: 3.729 Test Acc: 0.090
Validation loss decreased (-0.084664 --> -0.090031).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7561054
	speed: 0.3338s/iter; left time: 6700.8749s
	iters: 200, epoch: 4 | loss: 3.3399723
	speed: 0.1057s/iter; left time: 2112.4160s
Epoch: 4 cost time: 20.667808055877686
Epoch: 4, Steps: 208 | Train Loss: 3.059 Vali Loss: 4.348 Vali Acc: 0.078 Test Loss: 4.348 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4155965
	speed: 0.3176s/iter; left time: 6309.5689s
	iters: 200, epoch: 5 | loss: 2.9087157
	speed: 0.0868s/iter; left time: 1715.5786s
Epoch: 5 cost time: 17.613337755203247
Epoch: 5, Steps: 208 | Train Loss: 2.975 Vali Loss: 3.972 Vali Acc: 0.095 Test Loss: 3.972 Test Acc: 0.095
Validation loss decreased (-0.090031 --> -0.095099).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4427660
	speed: 0.3447s/iter; left time: 6776.5091s
	iters: 200, epoch: 6 | loss: 3.4470825
	speed: 0.0709s/iter; left time: 1386.0132s
Epoch: 6 cost time: 16.995463132858276
Epoch: 6, Steps: 208 | Train Loss: 2.846 Vali Loss: 4.108 Vali Acc: 0.108 Test Loss: 4.108 Test Acc: 0.108
Validation loss decreased (-0.095099 --> -0.108220).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6895490
	speed: 0.3572s/iter; left time: 6948.7918s
	iters: 200, epoch: 7 | loss: 3.6388876
	speed: 0.0778s/iter; left time: 1505.0481s
Epoch: 7 cost time: 18.26732850074768
Epoch: 7, Steps: 208 | Train Loss: 2.639 Vali Loss: 4.570 Vali Acc: 0.109 Test Loss: 4.570 Test Acc: 0.109
Validation loss decreased (-0.108220 --> -0.108812).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2561743
	speed: 0.3353s/iter; left time: 6453.3056s
	iters: 200, epoch: 8 | loss: 2.7158699
	speed: 0.0771s/iter; left time: 1476.1109s
Epoch: 8 cost time: 17.26773166656494
Epoch: 8, Steps: 208 | Train Loss: 2.449 Vali Loss: 4.708 Vali Acc: 0.111 Test Loss: 4.708 Test Acc: 0.111
Validation loss decreased (-0.108812 --> -0.111197).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5463524
	speed: 0.3387s/iter; left time: 6447.6234s
	iters: 200, epoch: 9 | loss: 2.7764657
	speed: 0.0729s/iter; left time: 1380.3676s
Epoch: 9 cost time: 17.246274709701538
Epoch: 9, Steps: 208 | Train Loss: 2.171 Vali Loss: 5.124 Vali Acc: 0.122 Test Loss: 5.124 Test Acc: 0.122
Validation loss decreased (-0.111197 --> -0.121929).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8198154
	speed: 0.3405s/iter; left time: 6410.8415s
	iters: 200, epoch: 10 | loss: 2.5132205
	speed: 0.0522s/iter; left time: 978.2084s
Epoch: 10 cost time: 12.144651651382446
Epoch: 10, Steps: 208 | Train Loss: 1.927 Vali Loss: 4.916 Vali Acc: 0.116 Test Loss: 4.916 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3599142
	speed: 0.2675s/iter; left time: 4981.6160s
	iters: 200, epoch: 11 | loss: 1.7795871
	speed: 0.0382s/iter; left time: 707.1572s
Epoch: 11 cost time: 9.578202247619629
Epoch: 11, Steps: 208 | Train Loss: 1.665 Vali Loss: 5.386 Vali Acc: 0.112 Test Loss: 5.386 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1806743
	speed: 0.2808s/iter; left time: 5170.0163s
	iters: 200, epoch: 12 | loss: 2.0271983
	speed: 0.0555s/iter; left time: 1016.5802s
Epoch: 12 cost time: 12.722721576690674
Epoch: 12, Steps: 208 | Train Loss: 1.422 Vali Loss: 5.404 Vali Acc: 0.126 Test Loss: 5.404 Test Acc: 0.126
Validation loss decreased (-0.121929 --> -0.126102).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0131871
	speed: 0.2690s/iter; left time: 4897.5688s
	iters: 200, epoch: 13 | loss: 1.6818062
	speed: 0.0595s/iter; left time: 1077.0377s
Epoch: 13 cost time: 12.249772548675537
Epoch: 13, Steps: 208 | Train Loss: 1.201 Vali Loss: 6.043 Vali Acc: 0.121 Test Loss: 6.043 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9116505
	speed: 0.2855s/iter; left time: 5138.8893s
	iters: 200, epoch: 14 | loss: 1.0174874
	speed: 0.0533s/iter; left time: 953.1707s
Epoch: 14 cost time: 11.712008237838745
Epoch: 14, Steps: 208 | Train Loss: 1.045 Vali Loss: 6.146 Vali Acc: 0.114 Test Loss: 6.146 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6306986
	speed: 0.2876s/iter; left time: 5115.5772s
	iters: 200, epoch: 15 | loss: 1.3704013
	speed: 0.0548s/iter; left time: 969.0344s
Epoch: 15 cost time: 11.506098508834839
Epoch: 15, Steps: 208 | Train Loss: 0.906 Vali Loss: 6.806 Vali Acc: 0.126 Test Loss: 6.806 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6195085
	speed: 0.2758s/iter; left time: 4848.1478s
	iters: 200, epoch: 16 | loss: 0.7200246
	speed: 0.0506s/iter; left time: 884.2092s
Epoch: 16 cost time: 10.949499368667603
Epoch: 16, Steps: 208 | Train Loss: 0.768 Vali Loss: 7.050 Vali Acc: 0.122 Test Loss: 7.050 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3254635
	speed: 0.3058s/iter; left time: 5312.4824s
	iters: 200, epoch: 17 | loss: 0.7165412
	speed: 0.0706s/iter; left time: 1219.2391s
Epoch: 17 cost time: 15.52378535270691
Epoch: 17, Steps: 208 | Train Loss: 0.635 Vali Loss: 7.203 Vali Acc: 0.118 Test Loss: 7.203 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2571895
	speed: 0.3123s/iter; left time: 5360.8732s
	iters: 200, epoch: 18 | loss: 0.9823736
	speed: 0.0613s/iter; left time: 1045.3118s
Epoch: 18 cost time: 15.036142349243164
Epoch: 18, Steps: 208 | Train Loss: 0.567 Vali Loss: 7.973 Vali Acc: 0.125 Test Loss: 7.973 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.0234332
	speed: 0.3223s/iter; left time: 5465.0522s
	iters: 200, epoch: 19 | loss: 0.7141512
	speed: 0.0603s/iter; left time: 1016.3310s
Epoch: 19 cost time: 15.521015882492065
Epoch: 19, Steps: 208 | Train Loss: 0.530 Vali Loss: 8.431 Vali Acc: 0.119 Test Loss: 8.431 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.4653506
	speed: 0.3335s/iter; left time: 5585.7811s
	iters: 200, epoch: 20 | loss: 0.6317068
	speed: 0.0777s/iter; left time: 1294.0338s
Epoch: 20 cost time: 18.17934012413025
Epoch: 20, Steps: 208 | Train Loss: 0.483 Vali Loss: 8.226 Vali Acc: 0.119 Test Loss: 8.226 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0639995
	speed: 0.3415s/iter; left time: 5648.4677s
	iters: 200, epoch: 21 | loss: 0.2711169
	speed: 0.0738s/iter; left time: 1213.2137s
Epoch: 21 cost time: 17.225385665893555
Epoch: 21, Steps: 208 | Train Loss: 0.421 Vali Loss: 8.987 Vali Acc: 0.112 Test Loss: 8.987 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.1818184
	speed: 0.3478s/iter; left time: 5680.1289s
	iters: 200, epoch: 22 | loss: 0.5273853
	speed: 0.0518s/iter; left time: 841.3931s
Epoch: 22 cost time: 14.194708585739136
Epoch: 22, Steps: 208 | Train Loss: 0.409 Vali Loss: 9.111 Vali Acc: 0.117 Test Loss: 9.111 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12615568147927228
model parameter : 398695
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3024845
	speed: 0.0864s/iter; left time: 1789.4628s
	iters: 200, epoch: 1 | loss: 4.0746989
	speed: 0.0475s/iter; left time: 978.6550s
Epoch: 1 cost time: 13.814122200012207
Epoch: 1, Steps: 208 | Train Loss: 3.867 Vali Loss: 3.934 Vali Acc: 0.057 Test Loss: 3.934 Test Acc: 0.057
Validation loss decreased (inf --> -0.057223).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2322178
	speed: 0.2466s/iter; left time: 5054.1127s
	iters: 200, epoch: 2 | loss: 3.3735275
	speed: 0.0446s/iter; left time: 908.9488s
Epoch: 2 cost time: 9.627391576766968
Epoch: 2, Steps: 208 | Train Loss: 3.585 Vali Loss: 3.853 Vali Acc: 0.068 Test Loss: 3.853 Test Acc: 0.068
Validation loss decreased (-0.057223 --> -0.067662).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3294556
	speed: 0.2468s/iter; left time: 5006.6311s
	iters: 200, epoch: 3 | loss: 3.4374013
	speed: 0.0406s/iter; left time: 819.0090s
Epoch: 3 cost time: 9.23244047164917
Epoch: 3, Steps: 208 | Train Loss: 3.237 Vali Loss: 3.742 Vali Acc: 0.083 Test Loss: 3.742 Test Acc: 0.083
Validation loss decreased (-0.067662 --> -0.082575).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4141006
	speed: 0.2640s/iter; left time: 5300.0872s
	iters: 200, epoch: 4 | loss: 2.8597243
	speed: 0.0441s/iter; left time: 881.0677s
Epoch: 4 cost time: 10.450489044189453
Epoch: 4, Steps: 208 | Train Loss: 3.082 Vali Loss: 3.826 Vali Acc: 0.083 Test Loss: 3.826 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.0916095
	speed: 0.2545s/iter; left time: 5056.5868s
	iters: 200, epoch: 5 | loss: 3.7606456
	speed: 0.0381s/iter; left time: 754.1799s
Epoch: 5 cost time: 9.334215879440308
Epoch: 5, Steps: 208 | Train Loss: 2.891 Vali Loss: 4.250 Vali Acc: 0.095 Test Loss: 4.250 Test Acc: 0.095
Validation loss decreased (-0.082575 --> -0.094500).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2356026
	speed: 0.2461s/iter; left time: 4839.1551s
	iters: 200, epoch: 6 | loss: 2.8660085
	speed: 0.0415s/iter; left time: 812.1031s
Epoch: 6 cost time: 9.938442468643188
Epoch: 6, Steps: 208 | Train Loss: 2.778 Vali Loss: 4.656 Vali Acc: 0.091 Test Loss: 4.656 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7242410
	speed: 0.2466s/iter; left time: 4797.2230s
	iters: 200, epoch: 7 | loss: 3.1089950
	speed: 0.0370s/iter; left time: 716.8383s
Epoch: 7 cost time: 9.019550800323486
Epoch: 7, Steps: 208 | Train Loss: 2.672 Vali Loss: 4.585 Vali Acc: 0.102 Test Loss: 4.585 Test Acc: 0.102
Validation loss decreased (-0.094500 --> -0.101952).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1883180
	speed: 0.2624s/iter; left time: 5049.4426s
	iters: 200, epoch: 8 | loss: 3.2257664
	speed: 0.0427s/iter; left time: 817.6084s
Epoch: 8 cost time: 9.777477502822876
Epoch: 8, Steps: 208 | Train Loss: 2.428 Vali Loss: 4.664 Vali Acc: 0.098 Test Loss: 4.664 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0971916
	speed: 0.2908s/iter; left time: 5535.0472s
	iters: 200, epoch: 9 | loss: 2.3367727
	speed: 0.0451s/iter; left time: 854.7970s
Epoch: 9 cost time: 10.926010131835938
Epoch: 9, Steps: 208 | Train Loss: 2.209 Vali Loss: 4.961 Vali Acc: 0.100 Test Loss: 4.961 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9160489
	speed: 0.2687s/iter; left time: 5059.7805s
	iters: 200, epoch: 10 | loss: 2.0501206
	speed: 0.0500s/iter; left time: 936.6447s
Epoch: 10 cost time: 11.15083384513855
Epoch: 10, Steps: 208 | Train Loss: 1.963 Vali Loss: 5.016 Vali Acc: 0.116 Test Loss: 5.016 Test Acc: 0.116
Validation loss decreased (-0.101952 --> -0.116264).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4456120
	speed: 0.2858s/iter; left time: 5322.4479s
	iters: 200, epoch: 11 | loss: 1.4602612
	speed: 0.0483s/iter; left time: 894.2208s
Epoch: 11 cost time: 11.130051374435425
Epoch: 11, Steps: 208 | Train Loss: 1.710 Vali Loss: 5.371 Vali Acc: 0.108 Test Loss: 5.371 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9987426
	speed: 0.2506s/iter; left time: 4613.9166s
	iters: 200, epoch: 12 | loss: 1.8920184
	speed: 0.0383s/iter; left time: 701.4024s
Epoch: 12 cost time: 9.235831022262573
Epoch: 12, Steps: 208 | Train Loss: 1.549 Vali Loss: 5.908 Vali Acc: 0.105 Test Loss: 5.908 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2750633
	speed: 0.2630s/iter; left time: 4788.6951s
	iters: 200, epoch: 13 | loss: 1.7785673
	speed: 0.0411s/iter; left time: 744.7820s
Epoch: 13 cost time: 10.107903003692627
Epoch: 13, Steps: 208 | Train Loss: 1.298 Vali Loss: 5.910 Vali Acc: 0.120 Test Loss: 5.910 Test Acc: 0.120
Validation loss decreased (-0.116264 --> -0.119535).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7705887
	speed: 0.2366s/iter; left time: 4258.7301s
	iters: 200, epoch: 14 | loss: 1.0458226
	speed: 0.0332s/iter; left time: 593.6466s
Epoch: 14 cost time: 8.251572608947754
Epoch: 14, Steps: 208 | Train Loss: 1.145 Vali Loss: 6.429 Vali Acc: 0.124 Test Loss: 6.429 Test Acc: 0.124
Validation loss decreased (-0.119535 --> -0.123705).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3487189
	speed: 0.2341s/iter; left time: 4164.5042s
	iters: 200, epoch: 15 | loss: 1.6628790
	speed: 0.0350s/iter; left time: 618.8666s
Epoch: 15 cost time: 8.199259519577026
Epoch: 15, Steps: 208 | Train Loss: 0.986 Vali Loss: 6.680 Vali Acc: 0.123 Test Loss: 6.680 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6982535
	speed: 0.2346s/iter; left time: 4124.4053s
	iters: 200, epoch: 16 | loss: 1.4187140
	speed: 0.0421s/iter; left time: 735.7373s
Epoch: 16 cost time: 9.86323094367981
Epoch: 16, Steps: 208 | Train Loss: 0.842 Vali Loss: 6.928 Vali Acc: 0.113 Test Loss: 6.928 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6420311
	speed: 0.2488s/iter; left time: 4322.5846s
	iters: 200, epoch: 17 | loss: 0.4353717
	speed: 0.0387s/iter; left time: 668.4255s
Epoch: 17 cost time: 8.629554033279419
Epoch: 17, Steps: 208 | Train Loss: 0.725 Vali Loss: 7.435 Vali Acc: 0.117 Test Loss: 7.435 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6144406
	speed: 0.2493s/iter; left time: 4279.9871s
	iters: 200, epoch: 18 | loss: 0.7860123
	speed: 0.0404s/iter; left time: 690.0315s
Epoch: 18 cost time: 9.372611999511719
Epoch: 18, Steps: 208 | Train Loss: 0.659 Vali Loss: 8.143 Vali Acc: 0.114 Test Loss: 8.143 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3092695
	speed: 0.2613s/iter; left time: 4430.3456s
	iters: 200, epoch: 19 | loss: 0.5769265
	speed: 0.0426s/iter; left time: 717.8091s
Epoch: 19 cost time: 9.909551858901978
Epoch: 19, Steps: 208 | Train Loss: 0.566 Vali Loss: 8.236 Vali Acc: 0.118 Test Loss: 8.236 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.7710820
	speed: 0.2691s/iter; left time: 4506.9901s
	iters: 200, epoch: 20 | loss: 0.3275488
	speed: 0.0372s/iter; left time: 619.0114s
Epoch: 20 cost time: 9.18085789680481
Epoch: 20, Steps: 208 | Train Loss: 0.516 Vali Loss: 8.673 Vali Acc: 0.118 Test Loss: 8.673 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1933948
	speed: 0.2789s/iter; left time: 4613.9612s
	iters: 200, epoch: 21 | loss: 0.6169080
	speed: 0.0501s/iter; left time: 823.8103s
Epoch: 21 cost time: 11.369846105575562
Epoch: 21, Steps: 208 | Train Loss: 0.470 Vali Loss: 8.932 Vali Acc: 0.108 Test Loss: 8.932 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3553547
	speed: 0.2448s/iter; left time: 3998.0226s
	iters: 200, epoch: 22 | loss: 0.1093557
	speed: 0.0400s/iter; left time: 649.7541s
Epoch: 22 cost time: 9.0878164768219
Epoch: 22, Steps: 208 | Train Loss: 0.417 Vali Loss: 9.144 Vali Acc: 0.114 Test Loss: 9.144 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0660303
	speed: 0.2637s/iter; left time: 4251.9368s
	iters: 200, epoch: 23 | loss: 0.7992048
	speed: 0.0423s/iter; left time: 678.3431s
Epoch: 23 cost time: 10.239060640335083
Epoch: 23, Steps: 208 | Train Loss: 0.387 Vali Loss: 9.784 Vali Acc: 0.113 Test Loss: 9.784 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.5545573
	speed: 0.2676s/iter; left time: 4258.8058s
	iters: 200, epoch: 24 | loss: 1.2127836
	speed: 0.0459s/iter; left time: 725.6981s
Epoch: 24 cost time: 10.555397510528564
Epoch: 24, Steps: 208 | Train Loss: 0.371 Vali Loss: 9.891 Vali Acc: 0.113 Test Loss: 9.891 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12376975842529078
model parameter : 317031
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5057626
	speed: 0.0956s/iter; left time: 1979.4075s
	iters: 200, epoch: 1 | loss: 4.4230638
	speed: 0.0408s/iter; left time: 840.2160s
Epoch: 1 cost time: 14.101243495941162
Epoch: 1, Steps: 208 | Train Loss: 3.825 Vali Loss: 3.855 Vali Acc: 0.055 Test Loss: 3.855 Test Acc: 0.055
Validation loss decreased (inf --> -0.055136).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7841127
	speed: 0.2614s/iter; left time: 5357.7677s
	iters: 200, epoch: 2 | loss: 3.5362060
	speed: 0.0351s/iter; left time: 716.0012s
Epoch: 2 cost time: 8.829735040664673
Epoch: 2, Steps: 208 | Train Loss: 3.620 Vali Loss: 3.825 Vali Acc: 0.067 Test Loss: 3.825 Test Acc: 0.067
Validation loss decreased (-0.055136 --> -0.067364).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7841268
	speed: 0.2695s/iter; left time: 5466.0038s
	iters: 200, epoch: 3 | loss: 4.2739291
	speed: 0.0475s/iter; left time: 957.9114s
Epoch: 3 cost time: 10.29985761642456
Epoch: 3, Steps: 208 | Train Loss: 3.346 Vali Loss: 3.900 Vali Acc: 0.083 Test Loss: 3.900 Test Acc: 0.083
Validation loss decreased (-0.067364 --> -0.082872).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7295165
	speed: 0.2608s/iter; left time: 5236.8487s
	iters: 200, epoch: 4 | loss: 3.5000603
	speed: 0.0452s/iter; left time: 903.7015s
Epoch: 4 cost time: 10.323797941207886
Epoch: 4, Steps: 208 | Train Loss: 3.133 Vali Loss: 4.026 Vali Acc: 0.090 Test Loss: 4.026 Test Acc: 0.090
Validation loss decreased (-0.082872 --> -0.089730).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2136695
	speed: 0.2504s/iter; left time: 4976.1731s
	iters: 200, epoch: 5 | loss: 3.8287022
	speed: 0.0413s/iter; left time: 816.9352s
Epoch: 5 cost time: 10.059452533721924
Epoch: 5, Steps: 208 | Train Loss: 2.980 Vali Loss: 4.145 Vali Acc: 0.092 Test Loss: 4.145 Test Acc: 0.092
Validation loss decreased (-0.089730 --> -0.091817).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5431941
	speed: 0.2896s/iter; left time: 5693.9667s
	iters: 200, epoch: 6 | loss: 3.3734696
	speed: 0.0479s/iter; left time: 936.9902s
Epoch: 6 cost time: 10.975874185562134
Epoch: 6, Steps: 208 | Train Loss: 2.760 Vali Loss: 4.480 Vali Acc: 0.096 Test Loss: 4.480 Test Acc: 0.096
Validation loss decreased (-0.091817 --> -0.095690).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5544448
	speed: 0.2826s/iter; left time: 5496.5939s
	iters: 200, epoch: 7 | loss: 2.7101336
	speed: 0.0499s/iter; left time: 966.3049s
Epoch: 7 cost time: 10.970568656921387
Epoch: 7, Steps: 208 | Train Loss: 2.574 Vali Loss: 4.541 Vali Acc: 0.106 Test Loss: 4.541 Test Acc: 0.106
Validation loss decreased (-0.095690 --> -0.106128).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3308611
	speed: 0.3046s/iter; left time: 5861.1349s
	iters: 200, epoch: 8 | loss: 2.9568145
	speed: 0.0419s/iter; left time: 802.6556s
Epoch: 8 cost time: 10.183468103408813
Epoch: 8, Steps: 208 | Train Loss: 2.375 Vali Loss: 4.705 Vali Acc: 0.102 Test Loss: 4.705 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6312623
	speed: 0.2948s/iter; left time: 5611.2628s
	iters: 200, epoch: 9 | loss: 2.2581375
	speed: 0.0531s/iter; left time: 1004.8540s
Epoch: 9 cost time: 11.875386953353882
Epoch: 9, Steps: 208 | Train Loss: 2.105 Vali Loss: 4.772 Vali Acc: 0.106 Test Loss: 4.772 Test Acc: 0.106
Validation loss decreased (-0.106128 --> -0.106424).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5765862
	speed: 0.3056s/iter; left time: 5754.9172s
	iters: 200, epoch: 10 | loss: 1.6174775
	speed: 0.0499s/iter; left time: 934.0230s
Epoch: 10 cost time: 11.81181001663208
Epoch: 10, Steps: 208 | Train Loss: 1.880 Vali Loss: 5.154 Vali Acc: 0.109 Test Loss: 5.154 Test Acc: 0.109
Validation loss decreased (-0.106424 --> -0.108806).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3860714
	speed: 0.2978s/iter; left time: 5545.6938s
	iters: 200, epoch: 11 | loss: 2.2695875
	speed: 0.0568s/iter; left time: 1051.9812s
Epoch: 11 cost time: 12.23026990890503
Epoch: 11, Steps: 208 | Train Loss: 1.672 Vali Loss: 5.384 Vali Acc: 0.114 Test Loss: 5.384 Test Acc: 0.114
Validation loss decreased (-0.108806 --> -0.114172).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9262832
	speed: 0.2967s/iter; left time: 5463.4658s
	iters: 200, epoch: 12 | loss: 2.3459356
	speed: 0.0454s/iter; left time: 831.3700s
Epoch: 12 cost time: 10.31889820098877
Epoch: 12, Steps: 208 | Train Loss: 1.410 Vali Loss: 5.505 Vali Acc: 0.101 Test Loss: 5.505 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.9542867
	speed: 0.3074s/iter; left time: 5596.2669s
	iters: 200, epoch: 13 | loss: 1.8205677
	speed: 0.0430s/iter; left time: 779.1880s
Epoch: 13 cost time: 10.915278196334839
Epoch: 13, Steps: 208 | Train Loss: 1.224 Vali Loss: 6.289 Vali Acc: 0.108 Test Loss: 6.289 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6328869
	speed: 0.3148s/iter; left time: 5665.2906s
	iters: 200, epoch: 14 | loss: 1.1642631
	speed: 0.0446s/iter; left time: 798.6050s
Epoch: 14 cost time: 10.938475370407104
Epoch: 14, Steps: 208 | Train Loss: 1.085 Vali Loss: 6.704 Vali Acc: 0.113 Test Loss: 6.704 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5728885
	speed: 0.3178s/iter; left time: 5654.1297s
	iters: 200, epoch: 15 | loss: 0.6855884
	speed: 0.0448s/iter; left time: 792.0995s
Epoch: 15 cost time: 11.658437728881836
Epoch: 15, Steps: 208 | Train Loss: 0.877 Vali Loss: 7.063 Vali Acc: 0.108 Test Loss: 7.063 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5626775
	speed: 0.3061s/iter; left time: 5380.7249s
	iters: 200, epoch: 16 | loss: 0.3584751
	speed: 0.0521s/iter; left time: 911.4205s
Epoch: 16 cost time: 12.152165412902832
Epoch: 16, Steps: 208 | Train Loss: 0.757 Vali Loss: 7.498 Vali Acc: 0.110 Test Loss: 7.498 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.7604998
	speed: 0.3219s/iter; left time: 5592.6999s
	iters: 200, epoch: 17 | loss: 0.4812539
	speed: 0.0508s/iter; left time: 877.2971s
Epoch: 17 cost time: 11.920881986618042
Epoch: 17, Steps: 208 | Train Loss: 0.702 Vali Loss: 7.843 Vali Acc: 0.103 Test Loss: 7.843 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3259170
	speed: 0.3109s/iter; left time: 5336.5109s
	iters: 200, epoch: 18 | loss: 0.1752392
	speed: 0.0434s/iter; left time: 740.7591s
Epoch: 18 cost time: 10.267603874206543
Epoch: 18, Steps: 208 | Train Loss: 0.624 Vali Loss: 8.351 Vali Acc: 0.112 Test Loss: 8.351 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6744910
	speed: 0.3148s/iter; left time: 5337.5353s
	iters: 200, epoch: 19 | loss: 0.3597170
	speed: 0.0631s/iter; left time: 1063.6067s
Epoch: 19 cost time: 13.55828070640564
Epoch: 19, Steps: 208 | Train Loss: 0.551 Vali Loss: 8.731 Vali Acc: 0.103 Test Loss: 8.731 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.6372277
	speed: 0.3383s/iter; left time: 5667.0230s
	iters: 200, epoch: 20 | loss: 0.5939733
	speed: 0.0491s/iter; left time: 816.7909s
Epoch: 20 cost time: 12.030710220336914
Epoch: 20, Steps: 208 | Train Loss: 0.501 Vali Loss: 8.726 Vali Acc: 0.104 Test Loss: 8.726 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.2149916
	speed: 0.3479s/iter; left time: 5754.1285s
	iters: 200, epoch: 21 | loss: 0.3496511
	speed: 0.0627s/iter; left time: 1031.4750s
Epoch: 21 cost time: 14.066190481185913
Epoch: 21, Steps: 208 | Train Loss: 0.451 Vali Loss: 9.399 Vali Acc: 0.103 Test Loss: 9.399 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11422606620936475
model parameter : 262823
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9768310
	speed: 0.1710s/iter; left time: 3540.2146s
	iters: 200, epoch: 1 | loss: 3.5561497
	speed: 0.1405s/iter; left time: 2893.9057s
Epoch: 1 cost time: 32.50052523612976
Epoch: 1, Steps: 208 | Train Loss: 4.807 Vali Loss: 3.797 Vali Acc: 0.039 Test Loss: 3.797 Test Acc: 0.039
Validation loss decreased (inf --> -0.039032).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9290934
	speed: 0.4927s/iter; left time: 10096.8652s
	iters: 200, epoch: 2 | loss: 4.1013136
	speed: 0.1152s/iter; left time: 2349.4738s
Epoch: 2 cost time: 23.535757780075073
Epoch: 2, Steps: 208 | Train Loss: 3.669 Vali Loss: 3.569 Vali Acc: 0.080 Test Loss: 3.569 Test Acc: 0.080
Validation loss decreased (-0.039032 --> -0.079594).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7198825
	speed: 0.4689s/iter; left time: 9510.7184s
	iters: 200, epoch: 3 | loss: 4.2443113
	speed: 0.1207s/iter; left time: 2436.3222s
Epoch: 3 cost time: 23.98050594329834
Epoch: 3, Steps: 208 | Train Loss: 4.059 Vali Loss: 4.103 Vali Acc: 0.097 Test Loss: 4.103 Test Acc: 0.097
Validation loss decreased (-0.079594 --> -0.097185).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8926148
	speed: 0.4186s/iter; left time: 8404.3463s
	iters: 200, epoch: 4 | loss: 5.2509260
	speed: 0.1342s/iter; left time: 2681.7785s
Epoch: 4 cost time: 26.22804355621338
Epoch: 4, Steps: 208 | Train Loss: 4.215 Vali Loss: 4.270 Vali Acc: 0.086 Test Loss: 4.270 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.4906673
	speed: 0.4223s/iter; left time: 8389.7783s
	iters: 200, epoch: 5 | loss: 4.7653818
	speed: 0.1168s/iter; left time: 2308.2006s
Epoch: 5 cost time: 23.51171326637268
Epoch: 5, Steps: 208 | Train Loss: 4.198 Vali Loss: 4.471 Vali Acc: 0.108 Test Loss: 4.471 Test Acc: 0.108
Validation loss decreased (-0.097185 --> -0.107620).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.1846356
	speed: 0.4125s/iter; left time: 8109.9906s
	iters: 200, epoch: 6 | loss: 4.1293421
	speed: 0.1072s/iter; left time: 2097.6083s
Epoch: 6 cost time: 21.880770206451416
Epoch: 6, Steps: 208 | Train Loss: 3.833 Vali Loss: 4.613 Vali Acc: 0.120 Test Loss: 4.613 Test Acc: 0.120
Validation loss decreased (-0.107620 --> -0.119847).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4104624
	speed: 0.4226s/iter; left time: 8220.7087s
	iters: 200, epoch: 7 | loss: 3.3079038
	speed: 0.1008s/iter; left time: 1950.7230s
Epoch: 7 cost time: 20.421874523162842
Epoch: 7, Steps: 208 | Train Loss: 3.474 Vali Loss: 5.137 Vali Acc: 0.104 Test Loss: 5.137 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9987116
	speed: 0.4078s/iter; left time: 7847.8541s
	iters: 200, epoch: 8 | loss: 2.8311126
	speed: 0.1333s/iter; left time: 2552.1622s
Epoch: 8 cost time: 27.827008724212646
Epoch: 8, Steps: 208 | Train Loss: 2.830 Vali Loss: 7.646 Vali Acc: 0.050 Test Loss: 7.646 Test Acc: 0.050
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3372636
	speed: 0.4625s/iter; left time: 8805.1454s
	iters: 200, epoch: 9 | loss: 2.3464906
	speed: 0.1153s/iter; left time: 2183.8788s
Epoch: 9 cost time: 24.35816240310669
Epoch: 9, Steps: 208 | Train Loss: 1.889 Vali Loss: 6.316 Vali Acc: 0.089 Test Loss: 6.316 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.9107909
	speed: 0.4772s/iter; left time: 8985.7632s
	iters: 200, epoch: 10 | loss: 1.8782606
	speed: 0.1303s/iter; left time: 2441.1120s
Epoch: 10 cost time: 26.56095790863037
Epoch: 10, Steps: 208 | Train Loss: 1.525 Vali Loss: 7.125 Vali Acc: 0.097 Test Loss: 7.125 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7196574
	speed: 0.4975s/iter; left time: 9264.3533s
	iters: 200, epoch: 11 | loss: 1.5606139
	speed: 0.1325s/iter; left time: 2453.1960s
Epoch: 11 cost time: 26.842835903167725
Epoch: 11, Steps: 208 | Train Loss: 1.330 Vali Loss: 6.369 Vali Acc: 0.121 Test Loss: 6.369 Test Acc: 0.121
Validation loss decreased (-0.119847 --> -0.121022).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2134393
	speed: 0.4866s/iter; left time: 8960.0377s
	iters: 200, epoch: 12 | loss: 1.2264515
	speed: 0.1278s/iter; left time: 2341.1358s
Epoch: 12 cost time: 27.114691734313965
Epoch: 12, Steps: 208 | Train Loss: 1.065 Vali Loss: 7.602 Vali Acc: 0.111 Test Loss: 7.602 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1368188
	speed: 0.4556s/iter; left time: 8293.7828s
	iters: 200, epoch: 13 | loss: 0.7054394
	speed: 0.0837s/iter; left time: 1515.0706s
Epoch: 13 cost time: 19.814961194992065
Epoch: 13, Steps: 208 | Train Loss: 0.922 Vali Loss: 6.759 Vali Acc: 0.120 Test Loss: 6.759 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.4431241
	speed: 0.3851s/iter; left time: 6931.1663s
	iters: 200, epoch: 14 | loss: 1.3320608
	speed: 0.0944s/iter; left time: 1689.0787s
Epoch: 14 cost time: 19.39332413673401
Epoch: 14, Steps: 208 | Train Loss: 0.782 Vali Loss: 6.755 Vali Acc: 0.135 Test Loss: 6.755 Test Acc: 0.135
Validation loss decreased (-0.121022 --> -0.135035).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5360879
	speed: 0.3978s/iter; left time: 7077.0294s
	iters: 200, epoch: 15 | loss: 0.7144715
	speed: 0.0816s/iter; left time: 1443.0309s
Epoch: 15 cost time: 18.80111789703369
Epoch: 15, Steps: 208 | Train Loss: 0.631 Vali Loss: 9.664 Vali Acc: 0.130 Test Loss: 9.664 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1195129
	speed: 0.4129s/iter; left time: 7258.9286s
	iters: 200, epoch: 16 | loss: 0.5967081
	speed: 0.0808s/iter; left time: 1411.9334s
Epoch: 16 cost time: 20.14416265487671
Epoch: 16, Steps: 208 | Train Loss: 0.575 Vali Loss: 8.487 Vali Acc: 0.122 Test Loss: 8.487 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2980438
	speed: 0.3711s/iter; left time: 6446.9937s
	iters: 200, epoch: 17 | loss: 0.4381658
	speed: 0.0848s/iter; left time: 1465.2337s
Epoch: 17 cost time: 19.97785210609436
Epoch: 17, Steps: 208 | Train Loss: 0.444 Vali Loss: 8.660 Vali Acc: 0.125 Test Loss: 8.660 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2594136
	speed: 0.4422s/iter; left time: 7590.4623s
	iters: 200, epoch: 18 | loss: 0.5075921
	speed: 0.0865s/iter; left time: 1475.4399s
Epoch: 18 cost time: 21.616923809051514
Epoch: 18, Steps: 208 | Train Loss: 0.376 Vali Loss: 9.175 Vali Acc: 0.125 Test Loss: 9.175 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0971527
	speed: 0.4335s/iter; left time: 7350.1431s
	iters: 200, epoch: 19 | loss: 0.1251367
	speed: 0.1199s/iter; left time: 2021.7105s
Epoch: 19 cost time: 26.57948112487793
Epoch: 19, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.992 Vali Acc: 0.128 Test Loss: 8.992 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1330784
	speed: 0.4525s/iter; left time: 7578.6689s
	iters: 200, epoch: 20 | loss: 1.0111704
	speed: 0.1217s/iter; left time: 2025.4235s
Epoch: 20 cost time: 26.435315132141113
Epoch: 20, Steps: 208 | Train Loss: 0.280 Vali Loss: 10.876 Vali Acc: 0.131 Test Loss: 10.876 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1913677
	speed: 0.4560s/iter; left time: 7542.1299s
	iters: 200, epoch: 21 | loss: 0.2665361
	speed: 0.1547s/iter; left time: 2543.5012s
Epoch: 21 cost time: 30.819868803024292
Epoch: 21, Steps: 208 | Train Loss: 0.266 Vali Loss: 10.981 Vali Acc: 0.124 Test Loss: 10.981 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0326658
	speed: 0.4870s/iter; left time: 7953.4269s
	iters: 200, epoch: 22 | loss: 0.1385321
	speed: 0.1451s/iter; left time: 2354.8174s
Epoch: 22 cost time: 30.30045795440674
Epoch: 22, Steps: 208 | Train Loss: 0.229 Vali Loss: 11.599 Vali Acc: 0.129 Test Loss: 11.599 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3769754
	speed: 0.5146s/iter; left time: 8298.0030s
	iters: 200, epoch: 23 | loss: 0.1936755
	speed: 0.1566s/iter; left time: 2510.1655s
Epoch: 23 cost time: 31.596123933792114
Epoch: 23, Steps: 208 | Train Loss: 0.207 Vali Loss: 11.809 Vali Acc: 0.132 Test Loss: 11.809 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0290365
	speed: 0.4094s/iter; left time: 6516.3233s
	iters: 200, epoch: 24 | loss: 0.0204146
	speed: 0.1151s/iter; left time: 1820.6727s
Epoch: 24 cost time: 21.56480860710144
Epoch: 24, Steps: 208 | Train Loss: 0.169 Vali Loss: 12.159 Vali Acc: 0.126 Test Loss: 12.159 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13510289293170294
model parameter : 2027815
model size : 8.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.1381960
	speed: 0.1266s/iter; left time: 2619.8210s
	iters: 200, epoch: 1 | loss: 4.0328708
	speed: 0.0811s/iter; left time: 1670.7846s
Epoch: 1 cost time: 21.58315873146057
Epoch: 1, Steps: 208 | Train Loss: 4.396 Vali Loss: 3.981 Vali Acc: 0.055 Test Loss: 3.981 Test Acc: 0.055
Validation loss decreased (inf --> -0.054538).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8249593
	speed: 0.3771s/iter; left time: 7728.7517s
	iters: 200, epoch: 2 | loss: 3.2808251
	speed: 0.0761s/iter; left time: 1552.0796s
Epoch: 2 cost time: 17.160767316818237
Epoch: 2, Steps: 208 | Train Loss: 3.447 Vali Loss: 3.867 Vali Acc: 0.083 Test Loss: 3.867 Test Acc: 0.083
Validation loss decreased (-0.054538 --> -0.083170).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0281601
	speed: 0.3813s/iter; left time: 7735.5714s
	iters: 200, epoch: 3 | loss: 4.3974352
	speed: 0.0715s/iter; left time: 1443.0150s
Epoch: 3 cost time: 15.698140144348145
Epoch: 3, Steps: 208 | Train Loss: 3.458 Vali Loss: 4.357 Vali Acc: 0.067 Test Loss: 4.357 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.7606292
	speed: 0.3548s/iter; left time: 7122.4396s
	iters: 200, epoch: 4 | loss: 3.4986672
	speed: 0.0786s/iter; left time: 1569.9665s
Epoch: 4 cost time: 15.656386137008667
Epoch: 4, Steps: 208 | Train Loss: 3.495 Vali Loss: 3.885 Vali Acc: 0.097 Test Loss: 3.885 Test Acc: 0.097
Validation loss decreased (-0.083170 --> -0.096889).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.1472526
	speed: 0.3938s/iter; left time: 7823.9265s
	iters: 200, epoch: 5 | loss: 3.5433028
	speed: 0.0980s/iter; left time: 1936.5342s
Epoch: 5 cost time: 21.967515468597412
Epoch: 5, Steps: 208 | Train Loss: 3.526 Vali Loss: 4.220 Vali Acc: 0.112 Test Loss: 4.220 Test Acc: 0.112
Validation loss decreased (-0.096889 --> -0.112394).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4177375
	speed: 0.4541s/iter; left time: 8927.4069s
	iters: 200, epoch: 6 | loss: 3.1025803
	speed: 0.1093s/iter; left time: 2137.5657s
Epoch: 6 cost time: 25.375163555145264
Epoch: 6, Steps: 208 | Train Loss: 3.323 Vali Loss: 4.617 Vali Acc: 0.112 Test Loss: 4.617 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.1574831
	speed: 0.4135s/iter; left time: 8043.5198s
	iters: 200, epoch: 7 | loss: 2.4777720
	speed: 0.1102s/iter; left time: 2133.0889s
Epoch: 7 cost time: 23.836021184921265
Epoch: 7, Steps: 208 | Train Loss: 3.064 Vali Loss: 4.225 Vali Acc: 0.130 Test Loss: 4.225 Test Acc: 0.130
Validation loss decreased (-0.112394 --> -0.129991).  Saving model ...
	iters: 100, epoch: 8 | loss: 4.3592386
	speed: 0.4374s/iter; left time: 8417.6170s
	iters: 200, epoch: 8 | loss: 3.0421572
	speed: 0.1082s/iter; left time: 2070.7306s
Epoch: 8 cost time: 24.605024814605713
Epoch: 8, Steps: 208 | Train Loss: 2.728 Vali Loss: 4.442 Vali Acc: 0.111 Test Loss: 4.442 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7448688
	speed: 0.4277s/iter; left time: 8141.3807s
	iters: 200, epoch: 9 | loss: 2.3190775
	speed: 0.1050s/iter; left time: 1988.8099s
Epoch: 9 cost time: 23.49096179008484
Epoch: 9, Steps: 208 | Train Loss: 2.201 Vali Loss: 5.292 Vali Acc: 0.117 Test Loss: 5.292 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0672154
	speed: 0.3797s/iter; left time: 7150.1481s
	iters: 200, epoch: 10 | loss: 2.1427331
	speed: 0.0893s/iter; left time: 1671.6020s
Epoch: 10 cost time: 17.560513973236084
Epoch: 10, Steps: 208 | Train Loss: 1.862 Vali Loss: 5.303 Vali Acc: 0.118 Test Loss: 5.303 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7920086
	speed: 0.3917s/iter; left time: 7294.2929s
	iters: 200, epoch: 11 | loss: 1.9092950
	speed: 0.0833s/iter; left time: 1543.5364s
Epoch: 11 cost time: 18.14334011077881
Epoch: 11, Steps: 208 | Train Loss: 1.532 Vali Loss: 5.565 Vali Acc: 0.123 Test Loss: 5.565 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2164767
	speed: 0.3703s/iter; left time: 6818.6392s
	iters: 200, epoch: 12 | loss: 1.5822157
	speed: 0.0634s/iter; left time: 1160.6326s
Epoch: 12 cost time: 15.789873361587524
Epoch: 12, Steps: 208 | Train Loss: 1.273 Vali Loss: 6.138 Vali Acc: 0.132 Test Loss: 6.138 Test Acc: 0.132
Validation loss decreased (-0.129991 --> -0.132059).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8671149
	speed: 0.4062s/iter; left time: 7394.5067s
	iters: 200, epoch: 13 | loss: 1.8997768
	speed: 0.0639s/iter; left time: 1156.1686s
Epoch: 13 cost time: 15.97713041305542
Epoch: 13, Steps: 208 | Train Loss: 1.046 Vali Loss: 6.193 Vali Acc: 0.129 Test Loss: 6.193 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4080358
	speed: 0.4061s/iter; left time: 7309.4664s
	iters: 200, epoch: 14 | loss: 0.9225224
	speed: 0.0765s/iter; left time: 1368.2614s
Epoch: 14 cost time: 18.07597017288208
Epoch: 14, Steps: 208 | Train Loss: 0.864 Vali Loss: 7.006 Vali Acc: 0.121 Test Loss: 7.006 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7481789
	speed: 0.4056s/iter; left time: 7214.8269s
	iters: 200, epoch: 15 | loss: 0.9171296
	speed: 0.0752s/iter; left time: 1330.5012s
Epoch: 15 cost time: 18.12759804725647
Epoch: 15, Steps: 208 | Train Loss: 0.729 Vali Loss: 7.304 Vali Acc: 0.139 Test Loss: 7.304 Test Acc: 0.139
Validation loss decreased (-0.132059 --> -0.138907).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4178974
	speed: 0.4223s/iter; left time: 7424.0068s
	iters: 200, epoch: 16 | loss: 0.6116691
	speed: 0.0906s/iter; left time: 1584.3837s
Epoch: 16 cost time: 22.911988019943237
Epoch: 16, Steps: 208 | Train Loss: 0.611 Vali Loss: 7.433 Vali Acc: 0.136 Test Loss: 7.433 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8713566
	speed: 0.3880s/iter; left time: 6740.6257s
	iters: 200, epoch: 17 | loss: 0.6988084
	speed: 0.1116s/iter; left time: 1927.4660s
Epoch: 17 cost time: 24.138439655303955
Epoch: 17, Steps: 208 | Train Loss: 0.541 Vali Loss: 8.007 Vali Acc: 0.134 Test Loss: 8.007 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7218240
	speed: 0.4257s/iter; left time: 7307.4355s
	iters: 200, epoch: 18 | loss: 0.4582335
	speed: 0.1181s/iter; left time: 2014.7455s
Epoch: 18 cost time: 25.05183482170105
Epoch: 18, Steps: 208 | Train Loss: 0.449 Vali Loss: 8.030 Vali Acc: 0.135 Test Loss: 8.030 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4383228
	speed: 0.4024s/iter; left time: 6823.7142s
	iters: 200, epoch: 19 | loss: 0.5679575
	speed: 0.0932s/iter; left time: 1570.8448s
Epoch: 19 cost time: 20.468043088912964
Epoch: 19, Steps: 208 | Train Loss: 0.405 Vali Loss: 8.787 Vali Acc: 0.134 Test Loss: 8.787 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4785260
	speed: 0.4258s/iter; left time: 7131.0838s
	iters: 200, epoch: 20 | loss: 0.2214683
	speed: 0.1205s/iter; left time: 2005.4919s
Epoch: 20 cost time: 24.228725910186768
Epoch: 20, Steps: 208 | Train Loss: 0.339 Vali Loss: 9.163 Vali Acc: 0.138 Test Loss: 9.163 Test Acc: 0.138
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4048864
	speed: 0.4034s/iter; left time: 6672.9243s
	iters: 200, epoch: 21 | loss: 0.0585610
	speed: 0.0594s/iter; left time: 975.9056s
Epoch: 21 cost time: 15.432817697525024
Epoch: 21, Steps: 208 | Train Loss: 0.321 Vali Loss: 9.522 Vali Acc: 0.142 Test Loss: 9.522 Test Acc: 0.142
Validation loss decreased (-0.138907 --> -0.141867).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2377523
	speed: 0.3350s/iter; left time: 5471.9476s
	iters: 200, epoch: 22 | loss: 0.1930015
	speed: 0.0625s/iter; left time: 1014.5841s
Epoch: 22 cost time: 14.951658248901367
Epoch: 22, Steps: 208 | Train Loss: 0.286 Vali Loss: 10.038 Vali Acc: 0.132 Test Loss: 10.038 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3277070
	speed: 0.3645s/iter; left time: 5878.0927s
	iters: 200, epoch: 23 | loss: 0.3125773
	speed: 0.0714s/iter; left time: 1144.4874s
Epoch: 23 cost time: 15.98605728149414
Epoch: 23, Steps: 208 | Train Loss: 0.266 Vali Loss: 10.422 Vali Acc: 0.132 Test Loss: 10.422 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0883326
	speed: 0.3477s/iter; left time: 5534.0395s
	iters: 200, epoch: 24 | loss: 0.3232420
	speed: 0.0642s/iter; left time: 1015.7856s
Epoch: 24 cost time: 14.244068384170532
Epoch: 24, Steps: 208 | Train Loss: 0.235 Vali Loss: 11.166 Vali Acc: 0.135 Test Loss: 11.166 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.4313353
	speed: 0.3433s/iter; left time: 5393.4348s
	iters: 200, epoch: 25 | loss: 0.1702608
	speed: 0.0628s/iter; left time: 979.6736s
Epoch: 25 cost time: 14.498825788497925
Epoch: 25, Steps: 208 | Train Loss: 0.273 Vali Loss: 10.519 Vali Acc: 0.130 Test Loss: 10.519 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.2918602
	speed: 0.3047s/iter; left time: 4723.5678s
	iters: 200, epoch: 26 | loss: 0.0092944
	speed: 0.0642s/iter; left time: 989.0687s
Epoch: 26 cost time: 14.467374563217163
Epoch: 26, Steps: 208 | Train Loss: 0.224 Vali Loss: 11.320 Vali Acc: 0.128 Test Loss: 11.320 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2072842
	speed: 0.3363s/iter; left time: 5143.0806s
	iters: 200, epoch: 27 | loss: 0.0472596
	speed: 0.0683s/iter; left time: 1036.9319s
Epoch: 27 cost time: 15.114014625549316
Epoch: 27, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.822 Vali Acc: 0.131 Test Loss: 11.822 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0063963
	speed: 0.4230s/iter; left time: 6381.6245s
	iters: 200, epoch: 28 | loss: 0.4566469
	speed: 0.0940s/iter; left time: 1408.2690s
Epoch: 28 cost time: 20.939955234527588
Epoch: 28, Steps: 208 | Train Loss: 0.186 Vali Loss: 11.564 Vali Acc: 0.135 Test Loss: 11.564 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1279611
	speed: 0.4280s/iter; left time: 6368.0646s
	iters: 200, epoch: 29 | loss: 0.4119237
	speed: 0.0800s/iter; left time: 1182.0447s
Epoch: 29 cost time: 19.60088038444519
Epoch: 29, Steps: 208 | Train Loss: 0.172 Vali Loss: 11.773 Vali Acc: 0.131 Test Loss: 11.773 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.1370187
	speed: 0.3992s/iter; left time: 5855.3768s
	iters: 200, epoch: 30 | loss: 0.5013770
	speed: 0.0961s/iter; left time: 1400.3375s
Epoch: 30 cost time: 21.33375906944275
Epoch: 30, Steps: 208 | Train Loss: 0.172 Vali Loss: 11.728 Vali Acc: 0.131 Test Loss: 11.728 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0035667
	speed: 0.4391s/iter; left time: 6349.8155s
	iters: 200, epoch: 31 | loss: 0.4624605
	speed: 0.0852s/iter; left time: 1223.4083s
Epoch: 31 cost time: 21.4232337474823
Epoch: 31, Steps: 208 | Train Loss: 0.177 Vali Loss: 12.189 Vali Acc: 0.127 Test Loss: 12.189 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1419624217118998
model parameter : 1039719
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8155141
	speed: 0.1121s/iter; left time: 2321.5163s
	iters: 200, epoch: 1 | loss: 3.6682549
	speed: 0.0540s/iter; left time: 1112.5676s
Epoch: 1 cost time: 17.418514251708984
Epoch: 1, Steps: 208 | Train Loss: 4.114 Vali Loss: 3.959 Vali Acc: 0.075 Test Loss: 3.959 Test Acc: 0.075
Validation loss decreased (inf --> -0.074521).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4082623
	speed: 0.3258s/iter; left time: 6677.2683s
	iters: 200, epoch: 2 | loss: 3.3867221
	speed: 0.0745s/iter; left time: 1518.7016s
Epoch: 2 cost time: 16.428383350372314
Epoch: 2, Steps: 208 | Train Loss: 3.443 Vali Loss: 3.463 Vali Acc: 0.092 Test Loss: 3.463 Test Acc: 0.092
Validation loss decreased (-0.074521 --> -0.092420).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2344487
	speed: 0.3142s/iter; left time: 6374.0471s
	iters: 200, epoch: 3 | loss: 3.7016375
	speed: 0.0884s/iter; left time: 1784.6928s
Epoch: 3 cost time: 17.51118278503418
Epoch: 3, Steps: 208 | Train Loss: 3.293 Vali Loss: 3.599 Vali Acc: 0.106 Test Loss: 3.599 Test Acc: 0.106
Validation loss decreased (-0.092420 --> -0.105541).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1248322
	speed: 0.3590s/iter; left time: 7206.7959s
	iters: 200, epoch: 4 | loss: 2.8906217
	speed: 0.0621s/iter; left time: 1240.5523s
Epoch: 4 cost time: 14.770665168762207
Epoch: 4, Steps: 208 | Train Loss: 3.327 Vali Loss: 4.055 Vali Acc: 0.107 Test Loss: 4.055 Test Acc: 0.107
Validation loss decreased (-0.105541 --> -0.106730).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5878904
	speed: 0.3819s/iter; left time: 7587.6403s
	iters: 200, epoch: 5 | loss: 3.7377696
	speed: 0.0811s/iter; left time: 1603.9592s
Epoch: 5 cost time: 19.701475143432617
Epoch: 5, Steps: 208 | Train Loss: 3.275 Vali Loss: 4.309 Vali Acc: 0.100 Test Loss: 4.309 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.6470137
	speed: 0.3930s/iter; left time: 7727.7222s
	iters: 200, epoch: 6 | loss: 3.2614205
	speed: 0.0887s/iter; left time: 1735.0634s
Epoch: 6 cost time: 18.794825077056885
Epoch: 6, Steps: 208 | Train Loss: 3.130 Vali Loss: 4.172 Vali Acc: 0.118 Test Loss: 4.172 Test Acc: 0.118
Validation loss decreased (-0.106730 --> -0.117763).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.8580782
	speed: 0.3125s/iter; left time: 6079.0533s
	iters: 200, epoch: 7 | loss: 2.5311978
	speed: 0.0434s/iter; left time: 838.9547s
Epoch: 7 cost time: 10.291125297546387
Epoch: 7, Steps: 208 | Train Loss: 2.925 Vali Loss: 4.925 Vali Acc: 0.109 Test Loss: 4.925 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7597961
	speed: 0.3476s/iter; left time: 6688.7079s
	iters: 200, epoch: 8 | loss: 4.6366630
	speed: 0.1019s/iter; left time: 1951.5204s
Epoch: 8 cost time: 21.54989528656006
Epoch: 8, Steps: 208 | Train Loss: 2.633 Vali Loss: 4.595 Vali Acc: 0.112 Test Loss: 4.595 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.1741533
	speed: 0.4444s/iter; left time: 8460.1484s
	iters: 200, epoch: 9 | loss: 2.8124652
	speed: 0.1124s/iter; left time: 2128.3009s
Epoch: 9 cost time: 25.439594268798828
Epoch: 9, Steps: 208 | Train Loss: 2.288 Vali Loss: 5.284 Vali Acc: 0.123 Test Loss: 5.284 Test Acc: 0.123
Validation loss decreased (-0.117763 --> -0.123419).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6131043
	speed: 0.3736s/iter; left time: 7034.4617s
	iters: 200, epoch: 10 | loss: 1.7342999
	speed: 0.0564s/iter; left time: 1055.8576s
Epoch: 10 cost time: 15.450365781784058
Epoch: 10, Steps: 208 | Train Loss: 1.937 Vali Loss: 4.928 Vali Acc: 0.127 Test Loss: 4.928 Test Acc: 0.127
Validation loss decreased (-0.123419 --> -0.126703).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4216189
	speed: 0.2867s/iter; left time: 5338.1038s
	iters: 200, epoch: 11 | loss: 2.7198372
	speed: 0.0663s/iter; left time: 1228.7649s
Epoch: 11 cost time: 14.222318649291992
Epoch: 11, Steps: 208 | Train Loss: 1.675 Vali Loss: 5.454 Vali Acc: 0.139 Test Loss: 5.454 Test Acc: 0.139
Validation loss decreased (-0.126703 --> -0.138627).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1494170
	speed: 0.3144s/iter; left time: 5789.1955s
	iters: 200, epoch: 12 | loss: 1.9363284
	speed: 0.0620s/iter; left time: 1135.7712s
Epoch: 12 cost time: 15.18748688697815
Epoch: 12, Steps: 208 | Train Loss: 1.416 Vali Loss: 5.831 Vali Acc: 0.129 Test Loss: 5.831 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2001758
	speed: 0.3380s/iter; left time: 6152.7388s
	iters: 200, epoch: 13 | loss: 1.2067285
	speed: 0.0545s/iter; left time: 986.2982s
Epoch: 13 cost time: 13.970046043395996
Epoch: 13, Steps: 208 | Train Loss: 1.175 Vali Loss: 5.776 Vali Acc: 0.126 Test Loss: 5.776 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0716875
	speed: 0.3145s/iter; left time: 5659.3269s
	iters: 200, epoch: 14 | loss: 1.2179947
	speed: 0.0500s/iter; left time: 895.3796s
Epoch: 14 cost time: 12.377169370651245
Epoch: 14, Steps: 208 | Train Loss: 0.990 Vali Loss: 6.311 Vali Acc: 0.142 Test Loss: 6.311 Test Acc: 0.142
Validation loss decreased (-0.138627 --> -0.142198).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0321773
	speed: 0.3102s/iter; left time: 5518.1126s
	iters: 200, epoch: 15 | loss: 1.1292664
	speed: 0.0593s/iter; left time: 1049.2952s
Epoch: 15 cost time: 13.21999454498291
Epoch: 15, Steps: 208 | Train Loss: 0.814 Vali Loss: 6.830 Vali Acc: 0.138 Test Loss: 6.830 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2765312
	speed: 0.3153s/iter; left time: 5543.0878s
	iters: 200, epoch: 16 | loss: 0.3382147
	speed: 0.0619s/iter; left time: 1082.8627s
Epoch: 16 cost time: 14.822724103927612
Epoch: 16, Steps: 208 | Train Loss: 0.697 Vali Loss: 6.718 Vali Acc: 0.140 Test Loss: 6.718 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3506292
	speed: 0.3192s/iter; left time: 5545.0721s
	iters: 200, epoch: 17 | loss: 0.2492608
	speed: 0.0536s/iter; left time: 925.7030s
Epoch: 17 cost time: 13.482426166534424
Epoch: 17, Steps: 208 | Train Loss: 0.587 Vali Loss: 7.635 Vali Acc: 0.132 Test Loss: 7.635 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6435898
	speed: 0.2930s/iter; left time: 5030.0514s
	iters: 200, epoch: 18 | loss: 0.1867258
	speed: 0.0579s/iter; left time: 987.2422s
Epoch: 18 cost time: 13.592836141586304
Epoch: 18, Steps: 208 | Train Loss: 0.537 Vali Loss: 7.810 Vali Acc: 0.139 Test Loss: 7.810 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3597196
	speed: 0.3338s/iter; left time: 5659.4913s
	iters: 200, epoch: 19 | loss: 0.7739668
	speed: 0.0537s/iter; left time: 905.9831s
Epoch: 19 cost time: 13.036808967590332
Epoch: 19, Steps: 208 | Train Loss: 0.462 Vali Loss: 8.494 Vali Acc: 0.136 Test Loss: 8.494 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.0771549
	speed: 0.3408s/iter; left time: 5708.5869s
	iters: 200, epoch: 20 | loss: 0.5228952
	speed: 0.0746s/iter; left time: 1242.6540s
Epoch: 20 cost time: 16.06122398376465
Epoch: 20, Steps: 208 | Train Loss: 0.433 Vali Loss: 8.808 Vali Acc: 0.133 Test Loss: 8.808 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.3499767
	speed: 0.3893s/iter; left time: 6439.4241s
	iters: 200, epoch: 21 | loss: 0.6927363
	speed: 0.1008s/iter; left time: 1656.4593s
Epoch: 21 cost time: 21.150619745254517
Epoch: 21, Steps: 208 | Train Loss: 0.392 Vali Loss: 9.337 Vali Acc: 0.144 Test Loss: 9.337 Test Acc: 0.144
Validation loss decreased (-0.142198 --> -0.143658).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.4220901
	speed: 0.4029s/iter; left time: 6580.6454s
	iters: 200, epoch: 22 | loss: 0.4048822
	speed: 0.1148s/iter; left time: 1863.9484s
Epoch: 22 cost time: 23.640016078948975
Epoch: 22, Steps: 208 | Train Loss: 0.352 Vali Loss: 8.801 Vali Acc: 0.141 Test Loss: 8.801 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4245004
	speed: 0.4465s/iter; left time: 7199.5806s
	iters: 200, epoch: 23 | loss: 0.4961807
	speed: 0.1295s/iter; left time: 2074.7919s
Epoch: 23 cost time: 26.712401151657104
Epoch: 23, Steps: 208 | Train Loss: 0.317 Vali Loss: 9.673 Vali Acc: 0.142 Test Loss: 9.673 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1191157
	speed: 0.4681s/iter; left time: 7451.3388s
	iters: 200, epoch: 24 | loss: 0.6315513
	speed: 0.1235s/iter; left time: 1953.1353s
Epoch: 24 cost time: 26.68057942390442
Epoch: 24, Steps: 208 | Train Loss: 0.318 Vali Loss: 9.738 Vali Acc: 0.145 Test Loss: 9.738 Test Acc: 0.145
Validation loss decreased (-0.143658 --> -0.145146).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.4182637
	speed: 0.4343s/iter; left time: 6822.0548s
	iters: 200, epoch: 25 | loss: 0.3350487
	speed: 0.1255s/iter; left time: 1958.5098s
Epoch: 25 cost time: 25.347400188446045
Epoch: 25, Steps: 208 | Train Loss: 0.290 Vali Loss: 9.943 Vali Acc: 0.139 Test Loss: 9.943 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0364404
	speed: 0.3909s/iter; left time: 6058.9608s
	iters: 200, epoch: 26 | loss: 0.2466016
	speed: 0.0560s/iter; left time: 862.5121s
Epoch: 26 cost time: 16.722692012786865
Epoch: 26, Steps: 208 | Train Loss: 0.237 Vali Loss: 10.854 Vali Acc: 0.140 Test Loss: 10.854 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3364534
	speed: 0.3029s/iter; left time: 4632.0856s
	iters: 200, epoch: 27 | loss: 0.0907981
	speed: 0.0436s/iter; left time: 661.9749s
Epoch: 27 cost time: 10.492061138153076
Epoch: 27, Steps: 208 | Train Loss: 0.264 Vali Loss: 10.749 Vali Acc: 0.128 Test Loss: 10.749 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0240309
	speed: 0.3212s/iter; left time: 4845.2038s
	iters: 200, epoch: 28 | loss: 0.1830572
	speed: 0.0589s/iter; left time: 882.7734s
Epoch: 28 cost time: 13.98098874092102
Epoch: 28, Steps: 208 | Train Loss: 0.245 Vali Loss: 11.276 Vali Acc: 0.140 Test Loss: 11.276 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.1862656
	speed: 0.3378s/iter; left time: 5024.7252s
	iters: 200, epoch: 29 | loss: 0.4606214
	speed: 0.0755s/iter; left time: 1115.2786s
Epoch: 29 cost time: 16.72320818901062
Epoch: 29, Steps: 208 | Train Loss: 0.198 Vali Loss: 11.563 Vali Acc: 0.134 Test Loss: 11.563 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.4526435
	speed: 0.3493s/iter; left time: 5124.0903s
	iters: 200, epoch: 30 | loss: 0.0851448
	speed: 0.0644s/iter; left time: 938.2029s
Epoch: 30 cost time: 15.041430234909058
Epoch: 30, Steps: 208 | Train Loss: 0.228 Vali Loss: 11.823 Vali Acc: 0.133 Test Loss: 11.823 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.4899809
	speed: 0.3282s/iter; left time: 4746.3421s
	iters: 200, epoch: 31 | loss: 0.1967204
	speed: 0.0711s/iter; left time: 1021.2932s
Epoch: 31 cost time: 14.984904527664185
Epoch: 31, Steps: 208 | Train Loss: 0.212 Vali Loss: 12.090 Vali Acc: 0.136 Test Loss: 12.090 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.5073575
	speed: 0.3578s/iter; left time: 5100.1322s
	iters: 200, epoch: 32 | loss: 0.4194795
	speed: 0.0660s/iter; left time: 933.4190s
Epoch: 32 cost time: 15.829477310180664
Epoch: 32, Steps: 208 | Train Loss: 0.201 Vali Loss: 12.526 Vali Acc: 0.130 Test Loss: 12.526 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0345638
	speed: 0.3854s/iter; left time: 5413.0667s
	iters: 200, epoch: 33 | loss: 0.1433395
	speed: 0.0922s/iter; left time: 1285.0736s
Epoch: 33 cost time: 19.53752827644348
Epoch: 33, Steps: 208 | Train Loss: 0.220 Vali Loss: 12.132 Vali Acc: 0.140 Test Loss: 12.132 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0055477
	speed: 0.4444s/iter; left time: 6149.5762s
	iters: 200, epoch: 34 | loss: 0.0732826
	speed: 0.1318s/iter; left time: 1810.0516s
Epoch: 34 cost time: 26.421809673309326
Epoch: 34, Steps: 208 | Train Loss: 0.187 Vali Loss: 12.565 Vali Acc: 0.142 Test Loss: 12.565 Test Acc: 0.142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14524306591112437
model parameter : 710631
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8121150
	speed: 0.1805s/iter; left time: 3735.8490s
	iters: 200, epoch: 1 | loss: 4.6541510
	speed: 0.1405s/iter; left time: 2895.3366s
Epoch: 1 cost time: 33.73040747642517
Epoch: 1, Steps: 208 | Train Loss: 4.083 Vali Loss: 4.376 Vali Acc: 0.060 Test Loss: 4.376 Test Acc: 0.060
Validation loss decreased (inf --> -0.059604).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0783029
	speed: 0.3823s/iter; left time: 7834.3632s
	iters: 200, epoch: 2 | loss: 2.9032528
	speed: 0.0853s/iter; left time: 1739.0916s
Epoch: 2 cost time: 17.65471625328064
Epoch: 2, Steps: 208 | Train Loss: 3.616 Vali Loss: 3.634 Vali Acc: 0.080 Test Loss: 3.634 Test Acc: 0.080
Validation loss decreased (-0.059604 --> -0.079594).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3632207
	speed: 0.3807s/iter; left time: 7722.9939s
	iters: 200, epoch: 3 | loss: 4.0259528
	speed: 0.0691s/iter; left time: 1393.9045s
Epoch: 3 cost time: 16.113451957702637
Epoch: 3, Steps: 208 | Train Loss: 3.201 Vali Loss: 3.664 Vali Acc: 0.105 Test Loss: 3.664 Test Acc: 0.105
Validation loss decreased (-0.079594 --> -0.104944).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9997616
	speed: 0.3710s/iter; left time: 7449.2533s
	iters: 200, epoch: 4 | loss: 3.6316149
	speed: 0.0691s/iter; left time: 1379.4757s
Epoch: 4 cost time: 15.46399712562561
Epoch: 4, Steps: 208 | Train Loss: 3.165 Vali Loss: 4.366 Vali Acc: 0.092 Test Loss: 4.366 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.7401595
	speed: 0.3387s/iter; left time: 6729.6520s
	iters: 200, epoch: 5 | loss: 3.9180818
	speed: 0.0772s/iter; left time: 1525.9793s
Epoch: 5 cost time: 16.82287859916687
Epoch: 5, Steps: 208 | Train Loss: 3.075 Vali Loss: 4.209 Vali Acc: 0.108 Test Loss: 4.209 Test Acc: 0.108
Validation loss decreased (-0.104944 --> -0.108219).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9778910
	speed: 0.4018s/iter; left time: 7898.9347s
	iters: 200, epoch: 6 | loss: 3.9409008
	speed: 0.0790s/iter; left time: 1545.9246s
Epoch: 6 cost time: 20.897257328033447
Epoch: 6, Steps: 208 | Train Loss: 2.989 Vali Loss: 4.112 Vali Acc: 0.113 Test Loss: 4.112 Test Acc: 0.113
Validation loss decreased (-0.108219 --> -0.112694).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3755147
	speed: 0.3952s/iter; left time: 7688.4441s
	iters: 200, epoch: 7 | loss: 2.7590425
	speed: 0.0834s/iter; left time: 1613.9553s
Epoch: 7 cost time: 19.212867259979248
Epoch: 7, Steps: 208 | Train Loss: 2.810 Vali Loss: 4.321 Vali Acc: 0.125 Test Loss: 4.321 Test Acc: 0.125
Validation loss decreased (-0.112694 --> -0.124920).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5525658
	speed: 0.3488s/iter; left time: 6712.9341s
	iters: 200, epoch: 8 | loss: 2.5635941
	speed: 0.0687s/iter; left time: 1314.4927s
Epoch: 8 cost time: 15.313345670700073
Epoch: 8, Steps: 208 | Train Loss: 2.535 Vali Loss: 4.775 Vali Acc: 0.133 Test Loss: 4.775 Test Acc: 0.133
Validation loss decreased (-0.124920 --> -0.132669).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.4547696
	speed: 0.3460s/iter; left time: 6587.6402s
	iters: 200, epoch: 9 | loss: 2.5609901
	speed: 0.0708s/iter; left time: 1340.4890s
Epoch: 9 cost time: 15.58272647857666
Epoch: 9, Steps: 208 | Train Loss: 2.244 Vali Loss: 4.784 Vali Acc: 0.121 Test Loss: 4.784 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2300348
	speed: 0.3920s/iter; left time: 7381.2032s
	iters: 200, epoch: 10 | loss: 2.5307641
	speed: 0.0747s/iter; left time: 1398.7583s
Epoch: 10 cost time: 19.55574131011963
Epoch: 10, Steps: 208 | Train Loss: 1.975 Vali Loss: 5.167 Vali Acc: 0.119 Test Loss: 5.167 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4823627
	speed: 0.3635s/iter; left time: 6768.7985s
	iters: 200, epoch: 11 | loss: 1.5178549
	speed: 0.1084s/iter; left time: 2006.7900s
Epoch: 11 cost time: 21.54848861694336
Epoch: 11, Steps: 208 | Train Loss: 1.640 Vali Loss: 5.254 Vali Acc: 0.130 Test Loss: 5.254 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.6377940
	speed: 0.3994s/iter; left time: 7354.8358s
	iters: 200, epoch: 12 | loss: 2.0264449
	speed: 0.0987s/iter; left time: 1807.6427s
Epoch: 12 cost time: 22.341091871261597
Epoch: 12, Steps: 208 | Train Loss: 1.408 Vali Loss: 5.760 Vali Acc: 0.126 Test Loss: 5.760 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0835158
	speed: 0.4035s/iter; left time: 7346.1332s
	iters: 200, epoch: 13 | loss: 1.2843156
	speed: 0.1133s/iter; left time: 2050.8679s
Epoch: 13 cost time: 24.834473371505737
Epoch: 13, Steps: 208 | Train Loss: 1.201 Vali Loss: 6.259 Vali Acc: 0.129 Test Loss: 6.259 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.2578223
	speed: 0.4223s/iter; left time: 7599.3537s
	iters: 200, epoch: 14 | loss: 1.3806357
	speed: 0.0970s/iter; left time: 1736.3546s
Epoch: 14 cost time: 21.605648517608643
Epoch: 14, Steps: 208 | Train Loss: 1.025 Vali Loss: 6.018 Vali Acc: 0.135 Test Loss: 6.018 Test Acc: 0.135
Validation loss decreased (-0.132669 --> -0.134446).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0519423
	speed: 0.4105s/iter; left time: 7303.1237s
	iters: 200, epoch: 15 | loss: 0.5184951
	speed: 0.0889s/iter; left time: 1572.7899s
Epoch: 15 cost time: 21.144286155700684
Epoch: 15, Steps: 208 | Train Loss: 0.864 Vali Loss: 6.795 Vali Acc: 0.141 Test Loss: 6.795 Test Acc: 0.141
Validation loss decreased (-0.134446 --> -0.141000).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5461512
	speed: 0.3560s/iter; left time: 6258.8209s
	iters: 200, epoch: 16 | loss: 0.8553734
	speed: 0.0676s/iter; left time: 1181.6916s
Epoch: 16 cost time: 15.262478590011597
Epoch: 16, Steps: 208 | Train Loss: 0.725 Vali Loss: 7.558 Vali Acc: 0.136 Test Loss: 7.558 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6198555
	speed: 0.3202s/iter; left time: 5562.7728s
	iters: 200, epoch: 17 | loss: 0.7359152
	speed: 0.0604s/iter; left time: 1043.0627s
Epoch: 17 cost time: 14.17024564743042
Epoch: 17, Steps: 208 | Train Loss: 0.602 Vali Loss: 7.717 Vali Acc: 0.130 Test Loss: 7.717 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.0936693
	speed: 0.3765s/iter; left time: 6461.9969s
	iters: 200, epoch: 18 | loss: 0.6710546
	speed: 0.0742s/iter; left time: 1266.6086s
Epoch: 18 cost time: 17.381497859954834
Epoch: 18, Steps: 208 | Train Loss: 0.535 Vali Loss: 8.062 Vali Acc: 0.133 Test Loss: 8.062 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3310236
	speed: 0.3749s/iter; left time: 6356.6366s
	iters: 200, epoch: 19 | loss: 0.3320752
	speed: 0.0801s/iter; left time: 1350.2580s
Epoch: 19 cost time: 18.755940675735474
Epoch: 19, Steps: 208 | Train Loss: 0.480 Vali Loss: 8.318 Vali Acc: 0.130 Test Loss: 8.318 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3127581
	speed: 0.3631s/iter; left time: 6081.7532s
	iters: 200, epoch: 20 | loss: 0.9873108
	speed: 0.0730s/iter; left time: 1215.5455s
Epoch: 20 cost time: 17.297680139541626
Epoch: 20, Steps: 208 | Train Loss: 0.403 Vali Loss: 8.490 Vali Acc: 0.130 Test Loss: 8.490 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3447872
	speed: 0.3464s/iter; left time: 5729.1257s
	iters: 200, epoch: 21 | loss: 0.1919653
	speed: 0.0681s/iter; left time: 1120.0313s
Epoch: 21 cost time: 15.028157711029053
Epoch: 21, Steps: 208 | Train Loss: 0.372 Vali Loss: 8.816 Vali Acc: 0.131 Test Loss: 8.816 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2069167
	speed: 0.3831s/iter; left time: 6256.5743s
	iters: 200, epoch: 22 | loss: 0.2331708
	speed: 0.0744s/iter; left time: 1207.6835s
Epoch: 22 cost time: 18.981853008270264
Epoch: 22, Steps: 208 | Train Loss: 0.381 Vali Loss: 9.525 Vali Acc: 0.124 Test Loss: 9.525 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.5759186
	speed: 0.3673s/iter; left time: 5922.8357s
	iters: 200, epoch: 23 | loss: 0.0321551
	speed: 0.0701s/iter; left time: 1123.7363s
Epoch: 23 cost time: 17.612416982650757
Epoch: 23, Steps: 208 | Train Loss: 0.319 Vali Loss: 10.001 Vali Acc: 0.133 Test Loss: 10.001 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.3053035
	speed: 0.4306s/iter; left time: 6853.8202s
	iters: 200, epoch: 24 | loss: 0.1359421
	speed: 0.1300s/iter; left time: 2056.6659s
Epoch: 24 cost time: 28.48867154121399
Epoch: 24, Steps: 208 | Train Loss: 0.293 Vali Loss: 10.743 Vali Acc: 0.127 Test Loss: 10.743 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.2109920
	speed: 0.4091s/iter; left time: 6426.1826s
	iters: 200, epoch: 25 | loss: 0.5073747
	speed: 0.1185s/iter; left time: 1850.2969s
Epoch: 25 cost time: 27.346120595932007
Epoch: 25, Steps: 208 | Train Loss: 0.277 Vali Loss: 10.245 Vali Acc: 0.129 Test Loss: 10.245 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1410677005666567
model parameter : 573671
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9644411
	speed: 0.1111s/iter; left time: 2300.7759s
	iters: 200, epoch: 1 | loss: 4.1003923
	speed: 0.0767s/iter; left time: 1579.1417s
Epoch: 1 cost time: 19.42180609703064
Epoch: 1, Steps: 208 | Train Loss: 3.910 Vali Loss: 4.134 Vali Acc: 0.056 Test Loss: 4.134 Test Acc: 0.056
Validation loss decreased (inf --> -0.056028).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4289851
	speed: 0.2955s/iter; left time: 6056.6257s
	iters: 200, epoch: 2 | loss: 3.0231605
	speed: 0.0528s/iter; left time: 1076.5002s
Epoch: 2 cost time: 12.150722742080688
Epoch: 2, Steps: 208 | Train Loss: 3.662 Vali Loss: 3.764 Vali Acc: 0.079 Test Loss: 3.764 Test Acc: 0.079
Validation loss decreased (-0.056028 --> -0.078996).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5836327
	speed: 0.3094s/iter; left time: 6276.4414s
	iters: 200, epoch: 3 | loss: 3.7177460
	speed: 0.0755s/iter; left time: 1523.9232s
Epoch: 3 cost time: 15.336659669876099
Epoch: 3, Steps: 208 | Train Loss: 3.242 Vali Loss: 3.904 Vali Acc: 0.079 Test Loss: 3.904 Test Acc: 0.079
Validation loss decreased (-0.078996 --> -0.079293).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0698404
	speed: 0.3671s/iter; left time: 7371.1513s
	iters: 200, epoch: 4 | loss: 3.8509324
	speed: 0.0729s/iter; left time: 1456.6505s
Epoch: 4 cost time: 18.167375802993774
Epoch: 4, Steps: 208 | Train Loss: 3.071 Vali Loss: 3.847 Vali Acc: 0.093 Test Loss: 3.847 Test Acc: 0.093
Validation loss decreased (-0.079293 --> -0.093013).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9775181
	speed: 0.3480s/iter; left time: 6913.9908s
	iters: 200, epoch: 5 | loss: 2.5905659
	speed: 0.0754s/iter; left time: 1490.9944s
Epoch: 5 cost time: 15.72367787361145
Epoch: 5, Steps: 208 | Train Loss: 2.973 Vali Loss: 4.190 Vali Acc: 0.087 Test Loss: 4.190 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.7318709
	speed: 0.3975s/iter; left time: 7816.0780s
	iters: 200, epoch: 6 | loss: 3.7149622
	speed: 0.0722s/iter; left time: 1411.8689s
Epoch: 6 cost time: 17.559569597244263
Epoch: 6, Steps: 208 | Train Loss: 2.900 Vali Loss: 4.018 Vali Acc: 0.103 Test Loss: 4.018 Test Acc: 0.103
Validation loss decreased (-0.093013 --> -0.102555).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0926633
	speed: 0.4083s/iter; left time: 7943.4915s
	iters: 200, epoch: 7 | loss: 2.6792777
	speed: 0.1060s/iter; left time: 2052.0728s
Epoch: 7 cost time: 23.131660223007202
Epoch: 7, Steps: 208 | Train Loss: 2.679 Vali Loss: 4.100 Vali Acc: 0.115 Test Loss: 4.100 Test Acc: 0.115
Validation loss decreased (-0.102555 --> -0.114483).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2644856
	speed: 0.3797s/iter; left time: 7306.7330s
	iters: 200, epoch: 8 | loss: 2.6840150
	speed: 0.0991s/iter; left time: 1897.0580s
Epoch: 8 cost time: 20.476431369781494
Epoch: 8, Steps: 208 | Train Loss: 2.518 Vali Loss: 4.798 Vali Acc: 0.114 Test Loss: 4.798 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.0849338
	speed: 0.4088s/iter; left time: 7782.8171s
	iters: 200, epoch: 9 | loss: 2.8627462
	speed: 0.1042s/iter; left time: 1973.7912s
Epoch: 9 cost time: 22.983408451080322
Epoch: 9, Steps: 208 | Train Loss: 2.284 Vali Loss: 4.879 Vali Acc: 0.121 Test Loss: 4.879 Test Acc: 0.121
Validation loss decreased (-0.114483 --> -0.121335).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1873765
	speed: 0.4306s/iter; left time: 8107.1634s
	iters: 200, epoch: 10 | loss: 1.3286809
	speed: 0.1239s/iter; left time: 2320.0372s
Epoch: 10 cost time: 26.14433789253235
Epoch: 10, Steps: 208 | Train Loss: 2.036 Vali Loss: 5.118 Vali Acc: 0.118 Test Loss: 5.118 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9673147
	speed: 0.4107s/iter; left time: 7647.7590s
	iters: 200, epoch: 11 | loss: 2.9036646
	speed: 0.1016s/iter; left time: 1882.0972s
Epoch: 11 cost time: 23.36575150489807
Epoch: 11, Steps: 208 | Train Loss: 1.802 Vali Loss: 5.129 Vali Acc: 0.118 Test Loss: 5.129 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.1959043
	speed: 0.4235s/iter; left time: 7797.2807s
	iters: 200, epoch: 12 | loss: 1.1315734
	speed: 0.0962s/iter; left time: 1761.2171s
Epoch: 12 cost time: 24.45940351486206
Epoch: 12, Steps: 208 | Train Loss: 1.551 Vali Loss: 5.511 Vali Acc: 0.119 Test Loss: 5.511 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3852595
	speed: 0.3696s/iter; left time: 6729.3212s
	iters: 200, epoch: 13 | loss: 1.3561530
	speed: 0.0826s/iter; left time: 1496.0715s
Epoch: 13 cost time: 18.440213918685913
Epoch: 13, Steps: 208 | Train Loss: 1.312 Vali Loss: 5.824 Vali Acc: 0.127 Test Loss: 5.824 Test Acc: 0.127
Validation loss decreased (-0.121335 --> -0.127290).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9846891
	speed: 0.4075s/iter; left time: 7334.1558s
	iters: 200, epoch: 14 | loss: 1.1444175
	speed: 0.0802s/iter; left time: 1435.0550s
Epoch: 14 cost time: 20.481218338012695
Epoch: 14, Steps: 208 | Train Loss: 1.140 Vali Loss: 6.107 Vali Acc: 0.121 Test Loss: 6.107 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1739711
	speed: 0.4146s/iter; left time: 7375.0819s
	iters: 200, epoch: 15 | loss: 0.8666897
	speed: 0.1225s/iter; left time: 2167.1345s
Epoch: 15 cost time: 24.834529399871826
Epoch: 15, Steps: 208 | Train Loss: 0.994 Vali Loss: 6.552 Vali Acc: 0.122 Test Loss: 6.552 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0115142
	speed: 0.3997s/iter; left time: 7026.2627s
	iters: 200, epoch: 16 | loss: 1.1229815
	speed: 0.0661s/iter; left time: 1156.0421s
Epoch: 16 cost time: 16.77962899208069
Epoch: 16, Steps: 208 | Train Loss: 0.832 Vali Loss: 6.896 Vali Acc: 0.126 Test Loss: 6.896 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4776647
	speed: 0.3514s/iter; left time: 6105.1774s
	iters: 200, epoch: 17 | loss: 0.5830396
	speed: 0.0691s/iter; left time: 1194.4258s
Epoch: 17 cost time: 15.72164535522461
Epoch: 17, Steps: 208 | Train Loss: 0.728 Vali Loss: 7.225 Vali Acc: 0.117 Test Loss: 7.225 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.0478914
	speed: 0.3587s/iter; left time: 6156.9756s
	iters: 200, epoch: 18 | loss: 0.6106857
	speed: 0.0964s/iter; left time: 1644.8634s
Epoch: 18 cost time: 20.32692551612854
Epoch: 18, Steps: 208 | Train Loss: 0.641 Vali Loss: 7.304 Vali Acc: 0.123 Test Loss: 7.304 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8065339
	speed: 0.3971s/iter; left time: 6734.1909s
	iters: 200, epoch: 19 | loss: 0.3945754
	speed: 0.1236s/iter; left time: 2084.2124s
Epoch: 19 cost time: 25.948066234588623
Epoch: 19, Steps: 208 | Train Loss: 0.555 Vali Loss: 8.077 Vali Acc: 0.126 Test Loss: 8.077 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7447371
	speed: 0.3713s/iter; left time: 6218.2794s
	iters: 200, epoch: 20 | loss: 0.2500067
	speed: 0.0889s/iter; left time: 1479.4176s
Epoch: 20 cost time: 19.080984830856323
Epoch: 20, Steps: 208 | Train Loss: 0.496 Vali Loss: 8.166 Vali Acc: 0.113 Test Loss: 8.166 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6778911
	speed: 0.3987s/iter; left time: 6594.5956s
	iters: 200, epoch: 21 | loss: 0.8264748
	speed: 0.1228s/iter; left time: 2018.8535s
Epoch: 21 cost time: 25.749858856201172
Epoch: 21, Steps: 208 | Train Loss: 0.457 Vali Loss: 8.741 Vali Acc: 0.128 Test Loss: 8.741 Test Acc: 0.128
Validation loss decreased (-0.127290 --> -0.128156).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0636233
	speed: 0.4398s/iter; left time: 7183.7837s
	iters: 200, epoch: 22 | loss: 0.8080179
	speed: 0.1237s/iter; left time: 2007.2111s
Epoch: 22 cost time: 27.33159112930298
Epoch: 22, Steps: 208 | Train Loss: 0.391 Vali Loss: 9.173 Vali Acc: 0.119 Test Loss: 9.173 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.6428126
	speed: 0.4013s/iter; left time: 6470.5535s
	iters: 200, epoch: 23 | loss: 0.6473855
	speed: 0.1034s/iter; left time: 1657.7061s
Epoch: 23 cost time: 21.999624729156494
Epoch: 23, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.832 Vali Acc: 0.124 Test Loss: 9.832 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.3402903
	speed: 0.4200s/iter; left time: 6685.7164s
	iters: 200, epoch: 24 | loss: 0.4576277
	speed: 0.1054s/iter; left time: 1666.4021s
Epoch: 24 cost time: 24.78289771080017
Epoch: 24, Steps: 208 | Train Loss: 0.354 Vali Loss: 9.697 Vali Acc: 0.124 Test Loss: 9.697 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.2472846
	speed: 0.4170s/iter; left time: 6550.4610s
	iters: 200, epoch: 25 | loss: 0.4007364
	speed: 0.1134s/iter; left time: 1769.9964s
Epoch: 25 cost time: 23.22964358329773
Epoch: 25, Steps: 208 | Train Loss: 0.324 Vali Loss: 9.708 Vali Acc: 0.122 Test Loss: 9.708 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.3119809
	speed: 0.3841s/iter; left time: 5954.2284s
	iters: 200, epoch: 26 | loss: 0.0180759
	speed: 0.1156s/iter; left time: 1780.5685s
Epoch: 26 cost time: 21.431126594543457
Epoch: 26, Steps: 208 | Train Loss: 0.310 Vali Loss: 10.385 Vali Acc: 0.119 Test Loss: 10.385 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.5464804
	speed: 0.3402s/iter; left time: 5202.4151s
	iters: 200, epoch: 27 | loss: 0.5206903
	speed: 0.0743s/iter; left time: 1128.7560s
Epoch: 27 cost time: 16.643646240234375
Epoch: 27, Steps: 208 | Train Loss: 0.312 Vali Loss: 10.515 Vali Acc: 0.126 Test Loss: 10.515 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.3506477
	speed: 0.3133s/iter; left time: 4726.4457s
	iters: 200, epoch: 28 | loss: 0.1983535
	speed: 0.0628s/iter; left time: 941.7382s
Epoch: 28 cost time: 14.043679237365723
Epoch: 28, Steps: 208 | Train Loss: 0.269 Vali Loss: 10.760 Vali Acc: 0.127 Test Loss: 10.760 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.3189997
	speed: 0.3560s/iter; left time: 5296.9050s
	iters: 200, epoch: 29 | loss: 0.5899094
	speed: 0.0681s/iter; left time: 1006.2998s
Epoch: 29 cost time: 16.294912576675415
Epoch: 29, Steps: 208 | Train Loss: 0.288 Vali Loss: 11.322 Vali Acc: 0.120 Test Loss: 11.322 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.2524524
	speed: 0.3515s/iter; left time: 5155.8491s
	iters: 200, epoch: 30 | loss: 0.0654432
	speed: 0.0841s/iter; left time: 1225.0424s
Epoch: 30 cost time: 18.078189611434937
Epoch: 30, Steps: 208 | Train Loss: 0.298 Vali Loss: 11.190 Vali Acc: 0.117 Test Loss: 11.190 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.3929592
	speed: 0.3960s/iter; left time: 5726.4092s
	iters: 200, epoch: 31 | loss: 0.2956663
	speed: 0.1135s/iter; left time: 1630.6561s
Epoch: 31 cost time: 24.248081922531128
Epoch: 31, Steps: 208 | Train Loss: 0.240 Vali Loss: 11.507 Vali Acc: 0.120 Test Loss: 11.507 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1282433641515061
model parameter : 382183
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9859693
	speed: 0.0973s/iter; left time: 2013.6467s
	iters: 200, epoch: 1 | loss: 3.7820892
	speed: 0.0581s/iter; left time: 1196.5530s
Epoch: 1 cost time: 16.276707649230957
Epoch: 1, Steps: 208 | Train Loss: 3.869 Vali Loss: 3.989 Vali Acc: 0.055 Test Loss: 3.989 Test Acc: 0.055
Validation loss decreased (inf --> -0.055433).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1413047
	speed: 0.3797s/iter; left time: 7782.0450s
	iters: 200, epoch: 2 | loss: 4.3358164
	speed: 0.0486s/iter; left time: 990.8319s
Epoch: 2 cost time: 13.186500787734985
Epoch: 2, Steps: 208 | Train Loss: 3.633 Vali Loss: 3.926 Vali Acc: 0.081 Test Loss: 3.926 Test Acc: 0.081
Validation loss decreased (-0.055433 --> -0.081380).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9633985
	speed: 0.3726s/iter; left time: 7557.7276s
	iters: 200, epoch: 3 | loss: 3.2254696
	speed: 0.0722s/iter; left time: 1458.1440s
Epoch: 3 cost time: 15.533084154129028
Epoch: 3, Steps: 208 | Train Loss: 3.311 Vali Loss: 3.907 Vali Acc: 0.083 Test Loss: 3.907 Test Acc: 0.083
Validation loss decreased (-0.081380 --> -0.083170).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1878173
	speed: 0.3947s/iter; left time: 7924.1265s
	iters: 200, epoch: 4 | loss: 4.0370817
	speed: 0.0638s/iter; left time: 1274.5622s
Epoch: 4 cost time: 14.699949502944946
Epoch: 4, Steps: 208 | Train Loss: 3.102 Vali Loss: 4.012 Vali Acc: 0.082 Test Loss: 4.012 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5419221
	speed: 0.3747s/iter; left time: 7444.9522s
	iters: 200, epoch: 5 | loss: 3.5371118
	speed: 0.0691s/iter; left time: 1365.4144s
Epoch: 5 cost time: 14.865188360214233
Epoch: 5, Steps: 208 | Train Loss: 2.942 Vali Loss: 4.147 Vali Acc: 0.090 Test Loss: 4.147 Test Acc: 0.090
Validation loss decreased (-0.083170 --> -0.090325).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1109090
	speed: 0.3728s/iter; left time: 7329.4214s
	iters: 200, epoch: 6 | loss: 2.8141198
	speed: 0.0693s/iter; left time: 1355.4069s
Epoch: 6 cost time: 15.183008193969727
Epoch: 6, Steps: 208 | Train Loss: 2.810 Vali Loss: 4.151 Vali Acc: 0.099 Test Loss: 4.151 Test Acc: 0.099
Validation loss decreased (-0.090325 --> -0.098974).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0550039
	speed: 0.3661s/iter; left time: 7121.0350s
	iters: 200, epoch: 7 | loss: 2.8784232
	speed: 0.0509s/iter; left time: 985.6503s
Epoch: 7 cost time: 13.505090236663818
Epoch: 7, Steps: 208 | Train Loss: 2.649 Vali Loss: 4.522 Vali Acc: 0.111 Test Loss: 4.522 Test Acc: 0.111
Validation loss decreased (-0.098974 --> -0.110602).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6925752
	speed: 0.3377s/iter; left time: 6499.0343s
	iters: 200, epoch: 8 | loss: 2.2903693
	speed: 0.0438s/iter; left time: 838.6349s
Epoch: 8 cost time: 11.58527946472168
Epoch: 8, Steps: 208 | Train Loss: 2.473 Vali Loss: 4.574 Vali Acc: 0.109 Test Loss: 4.574 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4120562
	speed: 0.3522s/iter; left time: 6705.0412s
	iters: 200, epoch: 9 | loss: 2.4428444
	speed: 0.0582s/iter; left time: 1102.1483s
Epoch: 9 cost time: 13.656619787216187
Epoch: 9, Steps: 208 | Train Loss: 2.204 Vali Loss: 4.769 Vali Acc: 0.110 Test Loss: 4.769 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.2874470
	speed: 0.3575s/iter; left time: 6730.5086s
	iters: 200, epoch: 10 | loss: 2.3481579
	speed: 0.0624s/iter; left time: 1167.9481s
Epoch: 10 cost time: 13.559036254882812
Epoch: 10, Steps: 208 | Train Loss: 1.964 Vali Loss: 4.866 Vali Acc: 0.108 Test Loss: 4.866 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.1852286
	speed: 0.3794s/iter; left time: 7064.8489s
	iters: 200, epoch: 11 | loss: 2.7984827
	speed: 0.0642s/iter; left time: 1188.4394s
Epoch: 11 cost time: 15.089577674865723
Epoch: 11, Steps: 208 | Train Loss: 1.777 Vali Loss: 5.072 Vali Acc: 0.113 Test Loss: 5.072 Test Acc: 0.113
Validation loss decreased (-0.110602 --> -0.112684).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9239578
	speed: 0.3891s/iter; left time: 7165.3680s
	iters: 200, epoch: 12 | loss: 1.8883207
	speed: 0.0639s/iter; left time: 1170.4683s
Epoch: 12 cost time: 17.0218665599823
Epoch: 12, Steps: 208 | Train Loss: 1.580 Vali Loss: 5.511 Vali Acc: 0.125 Test Loss: 5.511 Test Acc: 0.125
Validation loss decreased (-0.112684 --> -0.124908).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0680475
	speed: 0.3735s/iter; left time: 6798.9848s
	iters: 200, epoch: 13 | loss: 1.0932736
	speed: 0.0857s/iter; left time: 1550.7710s
Epoch: 13 cost time: 18.24044418334961
Epoch: 13, Steps: 208 | Train Loss: 1.374 Vali Loss: 5.877 Vali Acc: 0.117 Test Loss: 5.877 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2097487
	speed: 0.4142s/iter; left time: 7453.9109s
	iters: 200, epoch: 14 | loss: 1.4722145
	speed: 0.0743s/iter; left time: 1329.4305s
Epoch: 14 cost time: 16.11609411239624
Epoch: 14, Steps: 208 | Train Loss: 1.191 Vali Loss: 6.042 Vali Acc: 0.127 Test Loss: 6.042 Test Acc: 0.127
Validation loss decreased (-0.124908 --> -0.126692).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8359982
	speed: 0.3630s/iter; left time: 6457.0215s
	iters: 200, epoch: 15 | loss: 0.9812406
	speed: 0.0587s/iter; left time: 1038.7033s
Epoch: 15 cost time: 13.36397409439087
Epoch: 15, Steps: 208 | Train Loss: 1.008 Vali Loss: 6.440 Vali Acc: 0.117 Test Loss: 6.440 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5325469
	speed: 0.3910s/iter; left time: 6874.3608s
	iters: 200, epoch: 16 | loss: 0.8417089
	speed: 0.0662s/iter; left time: 1158.0793s
Epoch: 16 cost time: 15.59784984588623
Epoch: 16, Steps: 208 | Train Loss: 0.890 Vali Loss: 6.932 Vali Acc: 0.117 Test Loss: 6.932 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5018748
	speed: 0.3822s/iter; left time: 6639.2681s
	iters: 200, epoch: 17 | loss: 0.9074072
	speed: 0.0599s/iter; left time: 1034.2988s
Epoch: 17 cost time: 13.848884344100952
Epoch: 17, Steps: 208 | Train Loss: 0.774 Vali Loss: 7.273 Vali Acc: 0.117 Test Loss: 7.273 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7713199
	speed: 0.3724s/iter; left time: 6392.4271s
	iters: 200, epoch: 18 | loss: 0.8382578
	speed: 0.0701s/iter; left time: 1196.6948s
Epoch: 18 cost time: 15.160184621810913
Epoch: 18, Steps: 208 | Train Loss: 0.677 Vali Loss: 7.506 Vali Acc: 0.121 Test Loss: 7.506 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1124338
	speed: 0.3677s/iter; left time: 6234.4899s
	iters: 200, epoch: 19 | loss: 1.6397188
	speed: 0.0686s/iter; left time: 1155.7720s
Epoch: 19 cost time: 15.701230764389038
Epoch: 19, Steps: 208 | Train Loss: 0.615 Vali Loss: 7.940 Vali Acc: 0.118 Test Loss: 7.940 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5604668
	speed: 0.3702s/iter; left time: 6201.1131s
	iters: 200, epoch: 20 | loss: 0.8900700
	speed: 0.0611s/iter; left time: 1017.8039s
Epoch: 20 cost time: 13.393675088882446
Epoch: 20, Steps: 208 | Train Loss: 0.556 Vali Loss: 8.259 Vali Acc: 0.119 Test Loss: 8.259 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.7019270
	speed: 0.3517s/iter; left time: 5816.8625s
	iters: 200, epoch: 21 | loss: 0.6066068
	speed: 0.0514s/iter; left time: 844.6414s
Epoch: 21 cost time: 12.304288387298584
Epoch: 21, Steps: 208 | Train Loss: 0.512 Vali Loss: 8.635 Vali Acc: 0.118 Test Loss: 8.635 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2535519
	speed: 0.3487s/iter; left time: 5694.6963s
	iters: 200, epoch: 22 | loss: 0.5494342
	speed: 0.0510s/iter; left time: 827.4394s
Epoch: 22 cost time: 12.663640022277832
Epoch: 22, Steps: 208 | Train Loss: 0.450 Vali Loss: 8.967 Vali Acc: 0.118 Test Loss: 8.967 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1488062
	speed: 0.3512s/iter; left time: 5663.2420s
	iters: 200, epoch: 23 | loss: 0.2565072
	speed: 0.0645s/iter; left time: 1033.5213s
Epoch: 23 cost time: 13.979051351547241
Epoch: 23, Steps: 208 | Train Loss: 0.476 Vali Loss: 9.560 Vali Acc: 0.113 Test Loss: 9.560 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.6173831
	speed: 0.3790s/iter; left time: 6033.1409s
	iters: 200, epoch: 24 | loss: 0.2320515
	speed: 0.0732s/iter; left time: 1157.9289s
Epoch: 24 cost time: 16.117785692214966
Epoch: 24, Steps: 208 | Train Loss: 0.394 Vali Loss: 9.444 Vali Acc: 0.116 Test Loss: 9.444 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12675216224276767
model parameter : 300519
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8261046
	speed: 0.1010s/iter; left time: 2091.5382s
	iters: 200, epoch: 1 | loss: 4.2625818
	speed: 0.0550s/iter; left time: 1133.5491s
Epoch: 1 cost time: 16.52630066871643
Epoch: 1, Steps: 208 | Train Loss: 3.857 Vali Loss: 3.842 Vali Acc: 0.061 Test Loss: 3.842 Test Acc: 0.061
Validation loss decreased (inf --> -0.061399).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2383451
	speed: 0.3676s/iter; left time: 7532.3361s
	iters: 200, epoch: 2 | loss: 4.1696615
	speed: 0.0695s/iter; left time: 1416.8713s
Epoch: 2 cost time: 15.14461636543274
Epoch: 2, Steps: 208 | Train Loss: 3.629 Vali Loss: 3.919 Vali Acc: 0.079 Test Loss: 3.919 Test Acc: 0.079
Validation loss decreased (-0.061399 --> -0.078696).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5965123
	speed: 0.3649s/iter; left time: 7401.9837s
	iters: 200, epoch: 3 | loss: 3.9832811
	speed: 0.0615s/iter; left time: 1240.4244s
Epoch: 3 cost time: 14.197712898254395
Epoch: 3, Steps: 208 | Train Loss: 3.371 Vali Loss: 3.913 Vali Acc: 0.077 Test Loss: 3.913 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2725973
	speed: 0.3546s/iter; left time: 7119.1664s
	iters: 200, epoch: 4 | loss: 3.4308033
	speed: 0.0709s/iter; left time: 1416.3687s
Epoch: 4 cost time: 15.600990295410156
Epoch: 4, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.975 Vali Acc: 0.091 Test Loss: 3.975 Test Acc: 0.091
Validation loss decreased (-0.078696 --> -0.091222).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4356961
	speed: 0.3510s/iter; left time: 6973.9799s
	iters: 200, epoch: 5 | loss: 3.8814018
	speed: 0.0521s/iter; left time: 1030.8229s
Epoch: 5 cost time: 12.4432053565979
Epoch: 5, Steps: 208 | Train Loss: 2.961 Vali Loss: 4.215 Vali Acc: 0.095 Test Loss: 4.215 Test Acc: 0.095
Validation loss decreased (-0.091222 --> -0.095097).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1149461
	speed: 0.3506s/iter; left time: 6893.3673s
	iters: 200, epoch: 6 | loss: 2.9441912
	speed: 0.0705s/iter; left time: 1378.5375s
Epoch: 6 cost time: 14.806602478027344
Epoch: 6, Steps: 208 | Train Loss: 2.826 Vali Loss: 4.248 Vali Acc: 0.098 Test Loss: 4.248 Test Acc: 0.098
Validation loss decreased (-0.095097 --> -0.098079).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4999027
	speed: 0.3592s/iter; left time: 6987.0365s
	iters: 200, epoch: 7 | loss: 2.7280779
	speed: 0.0646s/iter; left time: 1251.0057s
Epoch: 7 cost time: 15.108019828796387
Epoch: 7, Steps: 208 | Train Loss: 2.590 Vali Loss: 4.519 Vali Acc: 0.106 Test Loss: 4.519 Test Acc: 0.106
Validation loss decreased (-0.098079 --> -0.106427).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6990242
	speed: 0.3380s/iter; left time: 6504.3145s
	iters: 200, epoch: 8 | loss: 3.0416143
	speed: 0.0647s/iter; left time: 1239.2816s
Epoch: 8 cost time: 12.952751636505127
Epoch: 8, Steps: 208 | Train Loss: 2.395 Vali Loss: 4.680 Vali Acc: 0.103 Test Loss: 4.680 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3834434
	speed: 0.3579s/iter; left time: 6813.9866s
	iters: 200, epoch: 9 | loss: 2.0062325
	speed: 0.0525s/iter; left time: 994.6713s
Epoch: 9 cost time: 13.251983165740967
Epoch: 9, Steps: 208 | Train Loss: 2.168 Vali Loss: 4.776 Vali Acc: 0.103 Test Loss: 4.776 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7192262
	speed: 0.3279s/iter; left time: 6174.6962s
	iters: 200, epoch: 10 | loss: 2.5150094
	speed: 0.0511s/iter; left time: 956.7703s
Epoch: 10 cost time: 12.00121021270752
Epoch: 10, Steps: 208 | Train Loss: 1.933 Vali Loss: 5.171 Vali Acc: 0.109 Test Loss: 5.171 Test Acc: 0.109
Validation loss decreased (-0.106427 --> -0.108508).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0599606
	speed: 0.3555s/iter; left time: 6619.7828s
	iters: 200, epoch: 11 | loss: 2.0249026
	speed: 0.0551s/iter; left time: 1020.0107s
Epoch: 11 cost time: 12.606930017471313
Epoch: 11, Steps: 208 | Train Loss: 1.735 Vali Loss: 5.351 Vali Acc: 0.099 Test Loss: 5.351 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5117868
	speed: 0.3841s/iter; left time: 7071.6967s
	iters: 200, epoch: 12 | loss: 1.7489762
	speed: 0.0710s/iter; left time: 1299.6427s
Epoch: 12 cost time: 17.002321481704712
Epoch: 12, Steps: 208 | Train Loss: 1.505 Vali Loss: 5.625 Vali Acc: 0.117 Test Loss: 5.625 Test Acc: 0.117
Validation loss decreased (-0.108508 --> -0.116556).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5325589
	speed: 0.3916s/iter; left time: 7128.9139s
	iters: 200, epoch: 13 | loss: 2.3027959
	speed: 0.0768s/iter; left time: 1390.7317s
Epoch: 13 cost time: 16.538756132125854
Epoch: 13, Steps: 208 | Train Loss: 1.317 Vali Loss: 6.045 Vali Acc: 0.106 Test Loss: 6.045 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5229437
	speed: 0.3773s/iter; left time: 6789.7185s
	iters: 200, epoch: 14 | loss: 1.3628078
	speed: 0.0675s/iter; left time: 1207.9161s
Epoch: 14 cost time: 15.020583152770996
Epoch: 14, Steps: 208 | Train Loss: 1.170 Vali Loss: 6.282 Vali Acc: 0.112 Test Loss: 6.282 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.6644232
	speed: 0.3541s/iter; left time: 6299.3486s
	iters: 200, epoch: 15 | loss: 0.7256439
	speed: 0.0546s/iter; left time: 965.5334s
Epoch: 15 cost time: 13.1044602394104
Epoch: 15, Steps: 208 | Train Loss: 1.002 Vali Loss: 6.800 Vali Acc: 0.109 Test Loss: 6.800 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6582586
	speed: 0.3463s/iter; left time: 6088.9454s
	iters: 200, epoch: 16 | loss: 1.3915448
	speed: 0.0678s/iter; left time: 1184.4618s
Epoch: 16 cost time: 14.482006788253784
Epoch: 16, Steps: 208 | Train Loss: 0.896 Vali Loss: 7.110 Vali Acc: 0.106 Test Loss: 7.110 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7110461
	speed: 0.3544s/iter; left time: 6157.6748s
	iters: 200, epoch: 17 | loss: 1.6249701
	speed: 0.0540s/iter; left time: 933.3093s
Epoch: 17 cost time: 12.784088134765625
Epoch: 17, Steps: 208 | Train Loss: 0.781 Vali Loss: 7.637 Vali Acc: 0.112 Test Loss: 7.637 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.7515635
	speed: 0.3446s/iter; left time: 5915.5205s
	iters: 200, epoch: 18 | loss: 0.8191440
	speed: 0.0581s/iter; left time: 991.4636s
Epoch: 18 cost time: 13.58840274810791
Epoch: 18, Steps: 208 | Train Loss: 0.659 Vali Loss: 7.956 Vali Acc: 0.112 Test Loss: 7.956 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4290296
	speed: 0.3487s/iter; left time: 5912.7860s
	iters: 200, epoch: 19 | loss: 0.4129544
	speed: 0.0543s/iter; left time: 915.0848s
Epoch: 19 cost time: 13.399858713150024
Epoch: 19, Steps: 208 | Train Loss: 0.619 Vali Loss: 8.197 Vali Acc: 0.105 Test Loss: 8.197 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.1345428
	speed: 0.3676s/iter; left time: 6156.9788s
	iters: 200, epoch: 20 | loss: 0.8777719
	speed: 0.0597s/iter; left time: 993.2106s
Epoch: 20 cost time: 13.818045616149902
Epoch: 20, Steps: 208 | Train Loss: 0.565 Vali Loss: 8.543 Vali Acc: 0.106 Test Loss: 8.543 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.6415558
	speed: 0.3355s/iter; left time: 5549.9865s
	iters: 200, epoch: 21 | loss: 0.3780408
	speed: 0.0577s/iter; left time: 948.4349s
Epoch: 21 cost time: 12.928422927856445
Epoch: 21, Steps: 208 | Train Loss: 0.522 Vali Loss: 9.027 Vali Acc: 0.114 Test Loss: 9.027 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.4000192
	speed: 0.3512s/iter; left time: 5735.9594s
	iters: 200, epoch: 22 | loss: 1.0267609
	speed: 0.0538s/iter; left time: 873.2332s
Epoch: 22 cost time: 13.086454629898071
Epoch: 22, Steps: 208 | Train Loss: 0.466 Vali Loss: 9.302 Vali Acc: 0.107 Test Loss: 9.302 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm64_nh16_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11661198926334626
model parameter : 246311
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8777142
	speed: 0.1368s/iter; left time: 2832.6552s
	iters: 200, epoch: 1 | loss: 4.5603008
	speed: 0.0801s/iter; left time: 1649.5811s
Epoch: 1 cost time: 22.614048957824707
Epoch: 1, Steps: 208 | Train Loss: 4.382 Vali Loss: 4.004 Vali Acc: 0.068 Test Loss: 4.004 Test Acc: 0.068
Validation loss decreased (inf --> -0.067661).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6875062
	speed: 0.4233s/iter; left time: 8675.4950s
	iters: 200, epoch: 2 | loss: 3.4333682
	speed: 0.1087s/iter; left time: 2216.8891s
Epoch: 2 cost time: 24.270121335983276
Epoch: 2, Steps: 208 | Train Loss: 3.468 Vali Loss: 3.567 Vali Acc: 0.079 Test Loss: 3.567 Test Acc: 0.079
Validation loss decreased (-0.067661 --> -0.078998).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7192202
	speed: 0.4357s/iter; left time: 8837.6826s
	iters: 200, epoch: 3 | loss: 3.4909961
	speed: 0.1067s/iter; left time: 2153.1340s
Epoch: 3 cost time: 22.32050061225891
Epoch: 3, Steps: 208 | Train Loss: 3.373 Vali Loss: 3.736 Vali Acc: 0.085 Test Loss: 3.736 Test Acc: 0.085
Validation loss decreased (-0.078998 --> -0.084961).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7699564
	speed: 0.4024s/iter; left time: 8078.1328s
	iters: 200, epoch: 4 | loss: 3.6338387
	speed: 0.0789s/iter; left time: 1576.3464s
Epoch: 4 cost time: 17.523385286331177
Epoch: 4, Steps: 208 | Train Loss: 3.394 Vali Loss: 4.044 Vali Acc: 0.092 Test Loss: 4.044 Test Acc: 0.092
Validation loss decreased (-0.084961 --> -0.092116).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.5086765
	speed: 0.4104s/iter; left time: 8153.6463s
	iters: 200, epoch: 5 | loss: 4.2960629
	speed: 0.0672s/iter; left time: 1327.9831s
Epoch: 5 cost time: 16.453951597213745
Epoch: 5, Steps: 208 | Train Loss: 3.313 Vali Loss: 3.863 Vali Acc: 0.098 Test Loss: 3.863 Test Acc: 0.098
Validation loss decreased (-0.092116 --> -0.098381).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0825524
	speed: 0.3650s/iter; left time: 7175.5856s
	iters: 200, epoch: 6 | loss: 3.3296120
	speed: 0.0761s/iter; left time: 1489.1407s
Epoch: 6 cost time: 17.682487964630127
Epoch: 6, Steps: 208 | Train Loss: 3.036 Vali Loss: 5.021 Vali Acc: 0.092 Test Loss: 5.021 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.2467437
	speed: 0.3693s/iter; left time: 7183.9070s
	iters: 200, epoch: 7 | loss: 2.6290820
	speed: 0.0599s/iter; left time: 1158.4310s
Epoch: 7 cost time: 15.965710878372192
Epoch: 7, Steps: 208 | Train Loss: 2.640 Vali Loss: 6.068 Vali Acc: 0.089 Test Loss: 6.068 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8031340
	speed: 0.3975s/iter; left time: 7649.5899s
	iters: 200, epoch: 8 | loss: 2.1567454
	speed: 0.0840s/iter; left time: 1608.2031s
Epoch: 8 cost time: 19.580927848815918
Epoch: 8, Steps: 208 | Train Loss: 2.048 Vali Loss: 5.664 Vali Acc: 0.091 Test Loss: 5.664 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.9088639
	speed: 0.3872s/iter; left time: 7371.6185s
	iters: 200, epoch: 9 | loss: 1.8764366
	speed: 0.0834s/iter; left time: 1578.8141s
Epoch: 9 cost time: 19.342350959777832
Epoch: 9, Steps: 208 | Train Loss: 1.700 Vali Loss: 5.698 Vali Acc: 0.105 Test Loss: 5.698 Test Acc: 0.105
Validation loss decreased (-0.098381 --> -0.104924).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4614563
	speed: 0.3398s/iter; left time: 6398.8116s
	iters: 200, epoch: 10 | loss: 1.7716525
	speed: 0.0683s/iter; left time: 1278.6899s
Epoch: 10 cost time: 14.536547422409058
Epoch: 10, Steps: 208 | Train Loss: 1.453 Vali Loss: 5.760 Vali Acc: 0.106 Test Loss: 5.760 Test Acc: 0.106
Validation loss decreased (-0.104924 --> -0.105519).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5504532
	speed: 0.3344s/iter; left time: 6226.3084s
	iters: 200, epoch: 11 | loss: 1.6823058
	speed: 0.0541s/iter; left time: 1002.0581s
Epoch: 11 cost time: 13.090411901473999
Epoch: 11, Steps: 208 | Train Loss: 1.246 Vali Loss: 6.843 Vali Acc: 0.096 Test Loss: 6.843 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0746882
	speed: 0.3375s/iter; left time: 6215.0501s
	iters: 200, epoch: 12 | loss: 1.2484514
	speed: 0.0610s/iter; left time: 1117.2665s
Epoch: 12 cost time: 13.991480588912964
Epoch: 12, Steps: 208 | Train Loss: 1.079 Vali Loss: 7.212 Vali Acc: 0.120 Test Loss: 7.212 Test Acc: 0.120
Validation loss decreased (-0.105519 --> -0.120417).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6813908
	speed: 0.3412s/iter; left time: 6210.8000s
	iters: 200, epoch: 13 | loss: 0.7375641
	speed: 0.0818s/iter; left time: 1480.5403s
Epoch: 13 cost time: 16.7489173412323
Epoch: 13, Steps: 208 | Train Loss: 0.887 Vali Loss: 7.332 Vali Acc: 0.119 Test Loss: 7.332 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0381596
	speed: 0.3960s/iter; left time: 7126.9348s
	iters: 200, epoch: 14 | loss: 1.2318485
	speed: 0.0888s/iter; left time: 1589.2166s
Epoch: 14 cost time: 19.809296369552612
Epoch: 14, Steps: 208 | Train Loss: 0.735 Vali Loss: 7.469 Vali Acc: 0.102 Test Loss: 7.469 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9791989
	speed: 0.4082s/iter; left time: 7261.6951s
	iters: 200, epoch: 15 | loss: 1.5182514
	speed: 0.0896s/iter; left time: 1584.5087s
Epoch: 15 cost time: 20.477187395095825
Epoch: 15, Steps: 208 | Train Loss: 0.619 Vali Loss: 8.933 Vali Acc: 0.116 Test Loss: 8.933 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4521571
	speed: 0.3784s/iter; left time: 6652.3340s
	iters: 200, epoch: 16 | loss: 0.3432911
	speed: 0.0792s/iter; left time: 1384.0048s
Epoch: 16 cost time: 16.743154525756836
Epoch: 16, Steps: 208 | Train Loss: 0.507 Vali Loss: 8.943 Vali Acc: 0.111 Test Loss: 8.943 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0962665
	speed: 0.3947s/iter; left time: 6857.3314s
	iters: 200, epoch: 17 | loss: 0.2006762
	speed: 0.0742s/iter; left time: 1281.8331s
Epoch: 17 cost time: 16.874147415161133
Epoch: 17, Steps: 208 | Train Loss: 0.425 Vali Loss: 8.942 Vali Acc: 0.106 Test Loss: 8.942 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1523733
	speed: 0.3884s/iter; left time: 6666.1240s
	iters: 200, epoch: 18 | loss: 0.3911732
	speed: 0.0718s/iter; left time: 1225.8347s
Epoch: 18 cost time: 17.020363092422485
Epoch: 18, Steps: 208 | Train Loss: 0.367 Vali Loss: 10.783 Vali Acc: 0.103 Test Loss: 10.783 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1642507
	speed: 0.3814s/iter; left time: 6467.5412s
	iters: 200, epoch: 19 | loss: 0.0233273
	speed: 0.0636s/iter; left time: 1072.9397s
Epoch: 19 cost time: 15.068615436553955
Epoch: 19, Steps: 208 | Train Loss: 0.313 Vali Loss: 10.537 Vali Acc: 0.109 Test Loss: 10.537 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2337438
	speed: 0.3624s/iter; left time: 6069.8650s
	iters: 200, epoch: 20 | loss: 0.2666496
	speed: 0.0742s/iter; left time: 1235.9413s
Epoch: 20 cost time: 17.2225501537323
Epoch: 20, Steps: 208 | Train Loss: 0.305 Vali Loss: 11.258 Vali Acc: 0.111 Test Loss: 11.258 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2982008
	speed: 0.3536s/iter; left time: 5848.2401s
	iters: 200, epoch: 21 | loss: 0.0522820
	speed: 0.0735s/iter; left time: 1208.9877s
Epoch: 21 cost time: 16.564786434173584
Epoch: 21, Steps: 208 | Train Loss: 0.261 Vali Loss: 11.830 Vali Acc: 0.112 Test Loss: 11.830 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.4554573
	speed: 0.3291s/iter; left time: 5375.3599s
	iters: 200, epoch: 22 | loss: 0.1074408
	speed: 0.0640s/iter; left time: 1038.3157s
Epoch: 22 cost time: 14.119546890258789
Epoch: 22, Steps: 208 | Train Loss: 0.228 Vali Loss: 12.172 Vali Acc: 0.113 Test Loss: 12.172 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12048911422606622
model parameter : 1030759
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5015345
	speed: 0.1027s/iter; left time: 2125.3120s
	iters: 200, epoch: 1 | loss: 4.2053137
	speed: 0.0581s/iter; left time: 1197.8347s
Epoch: 1 cost time: 17.036301851272583
Epoch: 1, Steps: 208 | Train Loss: 4.023 Vali Loss: 4.008 Vali Acc: 0.058 Test Loss: 4.008 Test Acc: 0.058
Validation loss decreased (inf --> -0.057819).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2512369
	speed: 0.3284s/iter; left time: 6729.0363s
	iters: 200, epoch: 2 | loss: 3.6956673
	speed: 0.0559s/iter; left time: 1140.5544s
Epoch: 2 cost time: 12.915143966674805
Epoch: 2, Steps: 208 | Train Loss: 3.597 Vali Loss: 3.592 Vali Acc: 0.086 Test Loss: 3.592 Test Acc: 0.086
Validation loss decreased (-0.057819 --> -0.086156).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5547040
	speed: 0.3846s/iter; left time: 7800.6656s
	iters: 200, epoch: 3 | loss: 3.8332803
	speed: 0.0964s/iter; left time: 1945.2260s
Epoch: 3 cost time: 21.59331965446472
Epoch: 3, Steps: 208 | Train Loss: 3.201 Vali Loss: 3.769 Vali Acc: 0.089 Test Loss: 3.769 Test Acc: 0.089
Validation loss decreased (-0.086156 --> -0.088540).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4267905
	speed: 0.3966s/iter; left time: 7963.5294s
	iters: 200, epoch: 4 | loss: 3.5977917
	speed: 0.1073s/iter; left time: 2144.1980s
Epoch: 4 cost time: 24.090553283691406
Epoch: 4, Steps: 208 | Train Loss: 3.041 Vali Loss: 4.279 Vali Acc: 0.089 Test Loss: 4.279 Test Acc: 0.089
Validation loss decreased (-0.088540 --> -0.089131).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7982225
	speed: 0.3481s/iter; left time: 6916.5327s
	iters: 200, epoch: 5 | loss: 3.4759886
	speed: 0.0624s/iter; left time: 1233.9522s
Epoch: 5 cost time: 14.806143283843994
Epoch: 5, Steps: 208 | Train Loss: 2.920 Vali Loss: 4.750 Vali Acc: 0.093 Test Loss: 4.750 Test Acc: 0.093
Validation loss decreased (-0.089131 --> -0.093004).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1940377
	speed: 0.3204s/iter; left time: 6299.7179s
	iters: 200, epoch: 6 | loss: 1.8735325
	speed: 0.0874s/iter; left time: 1710.3706s
Epoch: 6 cost time: 17.562610387802124
Epoch: 6, Steps: 208 | Train Loss: 2.691 Vali Loss: 4.424 Vali Acc: 0.115 Test Loss: 4.424 Test Acc: 0.115
Validation loss decreased (-0.093004 --> -0.114778).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7381957
	speed: 0.3381s/iter; left time: 6576.3982s
	iters: 200, epoch: 7 | loss: 2.5989246
	speed: 0.0812s/iter; left time: 1570.9525s
Epoch: 7 cost time: 17.389711380004883
Epoch: 7, Steps: 208 | Train Loss: 2.473 Vali Loss: 4.915 Vali Acc: 0.118 Test Loss: 4.915 Test Acc: 0.118
Validation loss decreased (-0.114778 --> -0.118352).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9900273
	speed: 0.3305s/iter; left time: 6360.9787s
	iters: 200, epoch: 8 | loss: 3.6121469
	speed: 0.0630s/iter; left time: 1205.6769s
Epoch: 8 cost time: 13.710536241531372
Epoch: 8, Steps: 208 | Train Loss: 2.181 Vali Loss: 5.046 Vali Acc: 0.109 Test Loss: 5.046 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9504430
	speed: 0.3190s/iter; left time: 6072.6986s
	iters: 200, epoch: 9 | loss: 2.1601496
	speed: 0.0659s/iter; left time: 1247.9926s
Epoch: 9 cost time: 14.68156099319458
Epoch: 9, Steps: 208 | Train Loss: 1.883 Vali Loss: 5.271 Vali Acc: 0.111 Test Loss: 5.271 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4439839
	speed: 0.3458s/iter; left time: 6510.7060s
	iters: 200, epoch: 10 | loss: 1.4025549
	speed: 0.0663s/iter; left time: 1242.4448s
Epoch: 10 cost time: 16.46250057220459
Epoch: 10, Steps: 208 | Train Loss: 1.665 Vali Loss: 5.175 Vali Acc: 0.112 Test Loss: 5.175 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.0539851
	speed: 0.3423s/iter; left time: 6374.3459s
	iters: 200, epoch: 11 | loss: 1.6749740
	speed: 0.0711s/iter; left time: 1317.6909s
Epoch: 11 cost time: 16.09763479232788
Epoch: 11, Steps: 208 | Train Loss: 1.367 Vali Loss: 5.753 Vali Acc: 0.118 Test Loss: 5.753 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2192980
	speed: 0.3398s/iter; left time: 6256.2862s
	iters: 200, epoch: 12 | loss: 1.9471140
	speed: 0.0577s/iter; left time: 1056.9723s
Epoch: 12 cost time: 13.514320850372314
Epoch: 12, Steps: 208 | Train Loss: 1.192 Vali Loss: 6.046 Vali Acc: 0.117 Test Loss: 6.046 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.7213162
	speed: 0.3130s/iter; left time: 5697.9767s
	iters: 200, epoch: 13 | loss: 1.2571574
	speed: 0.0540s/iter; left time: 977.9041s
Epoch: 13 cost time: 12.464078903198242
Epoch: 13, Steps: 208 | Train Loss: 1.004 Vali Loss: 6.847 Vali Acc: 0.115 Test Loss: 6.847 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.6846324
	speed: 0.3166s/iter; left time: 5698.1891s
	iters: 200, epoch: 14 | loss: 0.8511966
	speed: 0.0530s/iter; left time: 948.2740s
Epoch: 14 cost time: 12.154266357421875
Epoch: 14, Steps: 208 | Train Loss: 0.873 Vali Loss: 6.822 Vali Acc: 0.111 Test Loss: 6.822 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.8514452
	speed: 0.3636s/iter; left time: 6467.4944s
	iters: 200, epoch: 15 | loss: 1.0668833
	speed: 0.0799s/iter; left time: 1413.3474s
Epoch: 15 cost time: 19.269441843032837
Epoch: 15, Steps: 208 | Train Loss: 0.739 Vali Loss: 7.729 Vali Acc: 0.117 Test Loss: 7.729 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.5328952
	speed: 0.3781s/iter; left time: 6647.8419s
	iters: 200, epoch: 16 | loss: 1.1574380
	speed: 0.0998s/iter; left time: 1745.0783s
Epoch: 16 cost time: 22.122052907943726
Epoch: 16, Steps: 208 | Train Loss: 0.694 Vali Loss: 8.042 Vali Acc: 0.112 Test Loss: 8.042 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.7740483
	speed: 0.3819s/iter; left time: 6634.3582s
	iters: 200, epoch: 17 | loss: 0.8643230
	speed: 0.0888s/iter; left time: 1534.3143s
Epoch: 17 cost time: 21.999425411224365
Epoch: 17, Steps: 208 | Train Loss: 0.552 Vali Loss: 8.454 Vali Acc: 0.122 Test Loss: 8.454 Test Acc: 0.122
Validation loss decreased (-0.118352 --> -0.121896).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1671895
	speed: 0.3878s/iter; left time: 6656.6325s
	iters: 200, epoch: 18 | loss: 0.3773254
	speed: 0.0884s/iter; left time: 1507.8056s
Epoch: 18 cost time: 20.602677583694458
Epoch: 18, Steps: 208 | Train Loss: 0.483 Vali Loss: 9.204 Vali Acc: 0.118 Test Loss: 9.204 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1640074
	speed: 0.3778s/iter; left time: 6407.0789s
	iters: 200, epoch: 19 | loss: 0.4978907
	speed: 0.1021s/iter; left time: 1720.4243s
Epoch: 19 cost time: 22.540519952774048
Epoch: 19, Steps: 208 | Train Loss: 0.479 Vali Loss: 9.290 Vali Acc: 0.114 Test Loss: 9.290 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.7792056
	speed: 0.3417s/iter; left time: 5723.6774s
	iters: 200, epoch: 20 | loss: 0.5881143
	speed: 0.0657s/iter; left time: 1093.6171s
Epoch: 20 cost time: 14.497369050979614
Epoch: 20, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.881 Vali Acc: 0.114 Test Loss: 9.881 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4897876
	speed: 0.3375s/iter; left time: 5581.8530s
	iters: 200, epoch: 21 | loss: 1.1584945
	speed: 0.0896s/iter; left time: 1472.6587s
Epoch: 21 cost time: 18.45166778564453
Epoch: 21, Steps: 208 | Train Loss: 0.350 Vali Loss: 10.372 Vali Acc: 0.108 Test Loss: 10.372 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.4574273
	speed: 0.3363s/iter; left time: 5493.4814s
	iters: 200, epoch: 22 | loss: 1.1080437
	speed: 0.0849s/iter; left time: 1377.7822s
Epoch: 22 cost time: 17.070581674575806
Epoch: 22, Steps: 208 | Train Loss: 0.347 Vali Loss: 10.398 Vali Acc: 0.114 Test Loss: 10.398 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1708909
	speed: 0.3110s/iter; left time: 5015.1789s
	iters: 200, epoch: 23 | loss: 0.2938348
	speed: 0.0554s/iter; left time: 888.5271s
Epoch: 23 cost time: 13.14132285118103
Epoch: 23, Steps: 208 | Train Loss: 0.339 Vali Loss: 10.703 Vali Acc: 0.114 Test Loss: 10.703 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.2643890
	speed: 0.3536s/iter; left time: 5628.6333s
	iters: 200, epoch: 24 | loss: 0.1197443
	speed: 0.0641s/iter; left time: 1013.2115s
Epoch: 24 cost time: 14.523551225662231
Epoch: 24, Steps: 208 | Train Loss: 0.294 Vali Loss: 11.015 Vali Acc: 0.112 Test Loss: 11.015 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.2672743
	speed: 0.3601s/iter; left time: 5656.6137s
	iters: 200, epoch: 25 | loss: 0.1489724
	speed: 0.0623s/iter; left time: 971.7959s
Epoch: 25 cost time: 15.65125560760498
Epoch: 25, Steps: 208 | Train Loss: 0.258 Vali Loss: 11.550 Vali Acc: 0.116 Test Loss: 11.550 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0584584
	speed: 0.3583s/iter; left time: 5553.3750s
	iters: 200, epoch: 26 | loss: 0.3006034
	speed: 0.0606s/iter; left time: 933.8733s
Epoch: 26 cost time: 15.763021230697632
Epoch: 26, Steps: 208 | Train Loss: 0.262 Vali Loss: 11.530 Vali Acc: 0.118 Test Loss: 11.530 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1359249
	speed: 0.3697s/iter; left time: 5653.9266s
	iters: 200, epoch: 27 | loss: 0.2545324
	speed: 0.1145s/iter; left time: 1739.8243s
Epoch: 27 cost time: 24.12693452835083
Epoch: 27, Steps: 208 | Train Loss: 0.252 Vali Loss: 11.758 Vali Acc: 0.114 Test Loss: 11.758 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12198031613480466
model parameter : 536711
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1516271
	speed: 0.1367s/iter; left time: 2828.9169s
	iters: 200, epoch: 1 | loss: 4.2070994
	speed: 0.0851s/iter; left time: 1752.6406s
Epoch: 1 cost time: 23.0095796585083
Epoch: 1, Steps: 208 | Train Loss: 3.917 Vali Loss: 3.979 Vali Acc: 0.061 Test Loss: 3.979 Test Acc: 0.061
Validation loss decreased (inf --> -0.060503).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6941957
	speed: 0.4191s/iter; left time: 8588.5778s
	iters: 200, epoch: 2 | loss: 3.9175572
	speed: 0.0876s/iter; left time: 1787.1173s
Epoch: 2 cost time: 20.265216588974
Epoch: 2, Steps: 208 | Train Loss: 3.567 Vali Loss: 3.837 Vali Acc: 0.081 Test Loss: 3.837 Test Acc: 0.081
Validation loss decreased (-0.060503 --> -0.081083).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2916474
	speed: 0.3470s/iter; left time: 7039.5929s
	iters: 200, epoch: 3 | loss: 3.2937398
	speed: 0.0574s/iter; left time: 1158.1122s
Epoch: 3 cost time: 13.922749280929565
Epoch: 3, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.894 Vali Acc: 0.078 Test Loss: 3.894 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6977592
	speed: 0.3761s/iter; left time: 7550.8290s
	iters: 200, epoch: 4 | loss: 3.5465269
	speed: 0.0580s/iter; left time: 1158.1934s
Epoch: 4 cost time: 13.909823179244995
Epoch: 4, Steps: 208 | Train Loss: 2.988 Vali Loss: 3.964 Vali Acc: 0.100 Test Loss: 3.964 Test Acc: 0.100
Validation loss decreased (-0.081083 --> -0.099871).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7903190
	speed: 0.3465s/iter; left time: 6884.5714s
	iters: 200, epoch: 5 | loss: 3.1278503
	speed: 0.0674s/iter; left time: 1333.3856s
Epoch: 5 cost time: 14.871429920196533
Epoch: 5, Steps: 208 | Train Loss: 2.843 Vali Loss: 3.980 Vali Acc: 0.104 Test Loss: 3.980 Test Acc: 0.104
Validation loss decreased (-0.099871 --> -0.103748).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4192045
	speed: 0.3197s/iter; left time: 6284.8408s
	iters: 200, epoch: 6 | loss: 4.0352216
	speed: 0.0621s/iter; left time: 1214.9936s
Epoch: 6 cost time: 13.667376041412354
Epoch: 6, Steps: 208 | Train Loss: 2.667 Vali Loss: 4.100 Vali Acc: 0.101 Test Loss: 4.100 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.2687831
	speed: 0.3307s/iter; left time: 6432.1429s
	iters: 200, epoch: 7 | loss: 3.2707682
	speed: 0.0566s/iter; left time: 1095.2170s
Epoch: 7 cost time: 12.807504415512085
Epoch: 7, Steps: 208 | Train Loss: 2.469 Vali Loss: 4.480 Vali Acc: 0.106 Test Loss: 4.480 Test Acc: 0.106
Validation loss decreased (-0.103748 --> -0.106427).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1977463
	speed: 0.3094s/iter; left time: 5955.1305s
	iters: 200, epoch: 8 | loss: 1.9256071
	speed: 0.0569s/iter; left time: 1088.6127s
Epoch: 8 cost time: 12.800504684448242
Epoch: 8, Steps: 208 | Train Loss: 2.238 Vali Loss: 4.667 Vali Acc: 0.105 Test Loss: 4.667 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0532677
	speed: 0.3487s/iter; left time: 6637.4024s
	iters: 200, epoch: 9 | loss: 1.9531171
	speed: 0.0673s/iter; left time: 1274.4444s
Epoch: 9 cost time: 16.07973599433899
Epoch: 9, Steps: 208 | Train Loss: 1.984 Vali Loss: 5.084 Vali Acc: 0.112 Test Loss: 5.084 Test Acc: 0.112
Validation loss decreased (-0.106427 --> -0.111491).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5675424
	speed: 0.3877s/iter; left time: 7300.5405s
	iters: 200, epoch: 10 | loss: 2.5691640
	speed: 0.1102s/iter; left time: 2064.2984s
Epoch: 10 cost time: 22.81158137321472
Epoch: 10, Steps: 208 | Train Loss: 1.796 Vali Loss: 5.078 Vali Acc: 0.113 Test Loss: 5.078 Test Acc: 0.113
Validation loss decreased (-0.111491 --> -0.113281).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1729339
	speed: 0.3922s/iter; left time: 7304.0508s
	iters: 200, epoch: 11 | loss: 1.8548396
	speed: 0.0620s/iter; left time: 1147.5433s
Epoch: 11 cost time: 16.95522165298462
Epoch: 11, Steps: 208 | Train Loss: 1.558 Vali Loss: 5.402 Vali Acc: 0.110 Test Loss: 5.402 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5252122
	speed: 0.3861s/iter; left time: 7109.0474s
	iters: 200, epoch: 12 | loss: 1.0871332
	speed: 0.0763s/iter; left time: 1397.8452s
Epoch: 12 cost time: 17.53162384033203
Epoch: 12, Steps: 208 | Train Loss: 1.380 Vali Loss: 5.473 Vali Acc: 0.109 Test Loss: 5.473 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2067915
	speed: 0.3838s/iter; left time: 6986.3187s
	iters: 200, epoch: 13 | loss: 1.0348037
	speed: 0.0791s/iter; left time: 1431.7132s
Epoch: 13 cost time: 19.45528483390808
Epoch: 13, Steps: 208 | Train Loss: 1.207 Vali Loss: 5.932 Vali Acc: 0.119 Test Loss: 5.932 Test Acc: 0.119
Validation loss decreased (-0.113281 --> -0.118939).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1959050
	speed: 0.3722s/iter; left time: 6698.3225s
	iters: 200, epoch: 14 | loss: 1.1110981
	speed: 0.0746s/iter; left time: 1335.5741s
Epoch: 14 cost time: 16.1540424823761
Epoch: 14, Steps: 208 | Train Loss: 1.078 Vali Loss: 6.458 Vali Acc: 0.113 Test Loss: 6.458 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7829202
	speed: 0.3391s/iter; left time: 6032.8730s
	iters: 200, epoch: 15 | loss: 0.8905578
	speed: 0.0793s/iter; left time: 1402.8779s
Epoch: 15 cost time: 16.824459552764893
Epoch: 15, Steps: 208 | Train Loss: 0.917 Vali Loss: 6.875 Vali Acc: 0.117 Test Loss: 6.875 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0544769
	speed: 0.3272s/iter; left time: 5752.5813s
	iters: 200, epoch: 16 | loss: 0.8646649
	speed: 0.0734s/iter; left time: 1282.4444s
Epoch: 16 cost time: 15.01074481010437
Epoch: 16, Steps: 208 | Train Loss: 0.840 Vali Loss: 7.089 Vali Acc: 0.098 Test Loss: 7.089 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7566352
	speed: 0.3443s/iter; left time: 5981.7569s
	iters: 200, epoch: 17 | loss: 0.6886659
	speed: 0.0505s/iter; left time: 872.8475s
Epoch: 17 cost time: 12.84199595451355
Epoch: 17, Steps: 208 | Train Loss: 0.742 Vali Loss: 7.535 Vali Acc: 0.120 Test Loss: 7.535 Test Acc: 0.120
Validation loss decreased (-0.118939 --> -0.120414).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1999681
	speed: 0.3360s/iter; left time: 5767.3784s
	iters: 200, epoch: 18 | loss: 0.4893902
	speed: 0.0595s/iter; left time: 1015.8526s
Epoch: 18 cost time: 13.805639266967773
Epoch: 18, Steps: 208 | Train Loss: 0.649 Vali Loss: 7.835 Vali Acc: 0.118 Test Loss: 7.835 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4888219
	speed: 0.3251s/iter; left time: 5513.2489s
	iters: 200, epoch: 19 | loss: 0.8853578
	speed: 0.0605s/iter; left time: 1019.8730s
Epoch: 19 cost time: 13.279126405715942
Epoch: 19, Steps: 208 | Train Loss: 0.593 Vali Loss: 8.316 Vali Acc: 0.120 Test Loss: 8.316 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.7155231
	speed: 0.3642s/iter; left time: 6099.4212s
	iters: 200, epoch: 20 | loss: 1.6099268
	speed: 0.0849s/iter; left time: 1413.1157s
Epoch: 20 cost time: 18.968159198760986
Epoch: 20, Steps: 208 | Train Loss: 0.526 Vali Loss: 8.790 Vali Acc: 0.120 Test Loss: 8.790 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.3471567
	speed: 0.4153s/iter; left time: 6869.9232s
	iters: 200, epoch: 21 | loss: 1.1733794
	speed: 0.0941s/iter; left time: 1547.7510s
Epoch: 21 cost time: 22.318317890167236
Epoch: 21, Steps: 208 | Train Loss: 0.509 Vali Loss: 9.168 Vali Acc: 0.116 Test Loss: 9.168 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.6108530
	speed: 0.4048s/iter; left time: 6611.2691s
	iters: 200, epoch: 22 | loss: 0.3172316
	speed: 0.0947s/iter; left time: 1538.0551s
Epoch: 22 cost time: 21.797648668289185
Epoch: 22, Steps: 208 | Train Loss: 0.428 Vali Loss: 9.655 Vali Acc: 0.118 Test Loss: 9.655 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3898838
	speed: 0.4262s/iter; left time: 6873.2579s
	iters: 200, epoch: 23 | loss: 0.3809684
	speed: 0.0871s/iter; left time: 1396.2108s
Epoch: 23 cost time: 22.180705070495605
Epoch: 23, Steps: 208 | Train Loss: 0.414 Vali Loss: 9.643 Vali Acc: 0.113 Test Loss: 9.643 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.1887112
	speed: 0.4301s/iter; left time: 6845.2620s
	iters: 200, epoch: 24 | loss: 0.5949172
	speed: 0.0885s/iter; left time: 1400.0642s
Epoch: 24 cost time: 21.75632405281067
Epoch: 24, Steps: 208 | Train Loss: 0.404 Vali Loss: 9.792 Vali Acc: 0.107 Test Loss: 9.792 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.4422564
	speed: 0.3814s/iter; left time: 5991.0409s
	iters: 200, epoch: 25 | loss: 0.1027314
	speed: 0.0667s/iter; left time: 1041.3242s
Epoch: 25 cost time: 17.24400544166565
Epoch: 25, Steps: 208 | Train Loss: 0.366 Vali Loss: 10.357 Vali Acc: 0.115 Test Loss: 10.357 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2816375
	speed: 0.3812s/iter; left time: 5909.1134s
	iters: 200, epoch: 26 | loss: 0.0598717
	speed: 0.0726s/iter; left time: 1118.3970s
Epoch: 26 cost time: 18.954248189926147
Epoch: 26, Steps: 208 | Train Loss: 0.332 Vali Loss: 10.677 Vali Acc: 0.112 Test Loss: 10.677 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.3004422
	speed: 0.3377s/iter; left time: 5163.9680s
	iters: 200, epoch: 27 | loss: 0.7042225
	speed: 0.0615s/iter; left time: 934.3203s
Epoch: 27 cost time: 14.884727716445923
Epoch: 27, Steps: 208 | Train Loss: 0.313 Vali Loss: 10.403 Vali Acc: 0.121 Test Loss: 10.403 Test Acc: 0.121
Validation loss decreased (-0.120414 --> -0.121280).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.5999174
	speed: 0.3606s/iter; left time: 5439.5605s
	iters: 200, epoch: 28 | loss: 0.7301273
	speed: 0.0657s/iter; left time: 984.2025s
Epoch: 28 cost time: 16.939626693725586
Epoch: 28, Steps: 208 | Train Loss: 0.298 Vali Loss: 10.968 Vali Acc: 0.118 Test Loss: 10.968 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.1165484
	speed: 0.3911s/iter; left time: 5819.0037s
	iters: 200, epoch: 29 | loss: 0.3415668
	speed: 0.0757s/iter; left time: 1118.1485s
Epoch: 29 cost time: 16.79311752319336
Epoch: 29, Steps: 208 | Train Loss: 0.297 Vali Loss: 11.184 Vali Acc: 0.115 Test Loss: 11.184 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.9286696
	speed: 0.3752s/iter; left time: 5504.3009s
	iters: 200, epoch: 30 | loss: 0.2237405
	speed: 0.0655s/iter; left time: 954.3875s
Epoch: 30 cost time: 15.303203344345093
Epoch: 30, Steps: 208 | Train Loss: 0.263 Vali Loss: 11.554 Vali Acc: 0.123 Test Loss: 11.554 Test Acc: 0.123
Validation loss decreased (-0.121280 --> -0.122461).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.3562144
	speed: 0.3857s/iter; left time: 5577.2649s
	iters: 200, epoch: 31 | loss: 0.0703395
	speed: 0.1235s/iter; left time: 1774.1059s
Epoch: 31 cost time: 25.35759210586548
Epoch: 31, Steps: 208 | Train Loss: 0.270 Vali Loss: 11.631 Vali Acc: 0.115 Test Loss: 11.631 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.1417545
	speed: 0.4060s/iter; left time: 5786.9351s
	iters: 200, epoch: 32 | loss: 0.1802557
	speed: 0.0730s/iter; left time: 1033.7284s
Epoch: 32 cost time: 18.417500019073486
Epoch: 32, Steps: 208 | Train Loss: 0.271 Vali Loss: 12.367 Vali Acc: 0.120 Test Loss: 12.367 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0284950
	speed: 0.3238s/iter; left time: 4547.9277s
	iters: 200, epoch: 33 | loss: 0.1888529
	speed: 0.0425s/iter; left time: 593.2368s
Epoch: 33 cost time: 10.762643814086914
Epoch: 33, Steps: 208 | Train Loss: 0.241 Vali Loss: 13.039 Vali Acc: 0.112 Test Loss: 13.039 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0626393
	speed: 0.2935s/iter; left time: 4061.3796s
	iters: 200, epoch: 34 | loss: 0.4807594
	speed: 0.0662s/iter; left time: 909.4464s
Epoch: 34 cost time: 14.210609436035156
Epoch: 34, Steps: 208 | Train Loss: 0.237 Vali Loss: 12.998 Vali Acc: 0.117 Test Loss: 12.998 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0158941
	speed: 0.3316s/iter; left time: 4519.7773s
	iters: 200, epoch: 35 | loss: 0.1197208
	speed: 0.0533s/iter; left time: 720.8702s
Epoch: 35 cost time: 13.71157193183899
Epoch: 35, Steps: 208 | Train Loss: 0.214 Vali Loss: 12.826 Vali Acc: 0.120 Test Loss: 12.826 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0796336
	speed: 0.3380s/iter; left time: 4535.7356s
	iters: 200, epoch: 36 | loss: 0.0986158
	speed: 0.0586s/iter; left time: 780.3730s
Epoch: 36 cost time: 13.891822338104248
Epoch: 36, Steps: 208 | Train Loss: 0.238 Vali Loss: 13.047 Vali Acc: 0.119 Test Loss: 13.047 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.1420797
	speed: 0.3761s/iter; left time: 4969.2400s
	iters: 200, epoch: 37 | loss: 0.0497366
	speed: 0.0851s/iter; left time: 1115.2868s
Epoch: 37 cost time: 18.73996591567993
Epoch: 37, Steps: 208 | Train Loss: 0.236 Vali Loss: 13.285 Vali Acc: 0.115 Test Loss: 13.285 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.1549011
	speed: 0.3747s/iter; left time: 4873.0738s
	iters: 200, epoch: 38 | loss: 0.2169686
	speed: 0.0721s/iter; left time: 930.3496s
Epoch: 38 cost time: 16.470924854278564
Epoch: 38, Steps: 208 | Train Loss: 0.198 Vali Loss: 13.316 Vali Acc: 0.114 Test Loss: 13.316 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0130945
	speed: 0.3941s/iter; left time: 5042.9992s
	iters: 200, epoch: 39 | loss: 0.3541700
	speed: 0.0797s/iter; left time: 1011.5780s
Epoch: 39 cost time: 19.742438554763794
Epoch: 39, Steps: 208 | Train Loss: 0.195 Vali Loss: 13.730 Vali Acc: 0.110 Test Loss: 13.730 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0353180
	speed: 0.3521s/iter; left time: 4432.3617s
	iters: 200, epoch: 40 | loss: 0.3060143
	speed: 0.0825s/iter; left time: 1029.7433s
Epoch: 40 cost time: 17.814971685409546
Epoch: 40, Steps: 208 | Train Loss: 0.205 Vali Loss: 14.163 Vali Acc: 0.107 Test Loss: 14.163 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12257679689830003
model parameter : 372167
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0733767
	speed: 0.1147s/iter; left time: 2373.6394s
	iters: 200, epoch: 1 | loss: 3.8745313
	speed: 0.0576s/iter; left time: 1186.7092s
Epoch: 1 cost time: 18.035855531692505
Epoch: 1, Steps: 208 | Train Loss: 3.858 Vali Loss: 3.931 Vali Acc: 0.052 Test Loss: 3.931 Test Acc: 0.052
Validation loss decreased (inf --> -0.052153).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3105612
	speed: 0.3796s/iter; left time: 7778.8351s
	iters: 200, epoch: 2 | loss: 3.6682825
	speed: 0.0550s/iter; left time: 1121.9799s
Epoch: 2 cost time: 13.42644190788269
Epoch: 2, Steps: 208 | Train Loss: 3.514 Vali Loss: 3.744 Vali Acc: 0.083 Test Loss: 3.744 Test Acc: 0.083
Validation loss decreased (-0.052153 --> -0.083172).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1264508
	speed: 0.3577s/iter; left time: 7256.1703s
	iters: 200, epoch: 3 | loss: 3.7110090
	speed: 0.0604s/iter; left time: 1219.3883s
Epoch: 3 cost time: 14.304211616516113
Epoch: 3, Steps: 208 | Train Loss: 3.239 Vali Loss: 4.033 Vali Acc: 0.077 Test Loss: 4.033 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2154758
	speed: 0.3793s/iter; left time: 7614.7916s
	iters: 200, epoch: 4 | loss: 3.5770695
	speed: 0.0647s/iter; left time: 1293.3939s
Epoch: 4 cost time: 14.338908195495605
Epoch: 4, Steps: 208 | Train Loss: 3.022 Vali Loss: 4.356 Vali Acc: 0.078 Test Loss: 4.356 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.9001181
	speed: 0.3803s/iter; left time: 7557.1548s
	iters: 200, epoch: 5 | loss: 3.3206987
	speed: 0.0476s/iter; left time: 941.8563s
Epoch: 5 cost time: 12.963907480239868
Epoch: 5, Steps: 208 | Train Loss: 2.848 Vali Loss: 4.186 Vali Acc: 0.108 Test Loss: 4.186 Test Acc: 0.108
Validation loss decreased (-0.083172 --> -0.108219).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0060775
	speed: 0.3591s/iter; left time: 7059.7482s
	iters: 200, epoch: 6 | loss: 3.1891384
	speed: 0.0646s/iter; left time: 1263.3496s
Epoch: 6 cost time: 15.187894582748413
Epoch: 6, Steps: 208 | Train Loss: 2.718 Vali Loss: 4.106 Vali Acc: 0.111 Test Loss: 4.106 Test Acc: 0.111
Validation loss decreased (-0.108219 --> -0.110606).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1476669
	speed: 0.3917s/iter; left time: 7619.0874s
	iters: 200, epoch: 7 | loss: 2.2851419
	speed: 0.0784s/iter; left time: 1517.0952s
Epoch: 7 cost time: 16.480854511260986
Epoch: 7, Steps: 208 | Train Loss: 2.494 Vali Loss: 4.543 Vali Acc: 0.120 Test Loss: 4.543 Test Acc: 0.120
Validation loss decreased (-0.110606 --> -0.120145).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6286223
	speed: 0.3838s/iter; left time: 7386.9507s
	iters: 200, epoch: 8 | loss: 1.8775430
	speed: 0.0590s/iter; left time: 1130.2064s
Epoch: 8 cost time: 14.437539339065552
Epoch: 8, Steps: 208 | Train Loss: 2.302 Vali Loss: 4.496 Vali Acc: 0.116 Test Loss: 4.496 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.6903732
	speed: 0.3731s/iter; left time: 7101.7714s
	iters: 200, epoch: 9 | loss: 1.3090020
	speed: 0.0598s/iter; left time: 1132.5359s
Epoch: 9 cost time: 14.17700481414795
Epoch: 9, Steps: 208 | Train Loss: 2.098 Vali Loss: 4.687 Vali Acc: 0.114 Test Loss: 4.687 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.7781065
	speed: 0.3532s/iter; left time: 6649.8538s
	iters: 200, epoch: 10 | loss: 2.5621114
	speed: 0.0575s/iter; left time: 1077.4887s
Epoch: 10 cost time: 13.420490026473999
Epoch: 10, Steps: 208 | Train Loss: 1.880 Vali Loss: 4.607 Vali Acc: 0.118 Test Loss: 4.607 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7609203
	speed: 0.3601s/iter; left time: 6705.7911s
	iters: 200, epoch: 11 | loss: 1.7032881
	speed: 0.0505s/iter; left time: 936.1205s
Epoch: 11 cost time: 12.401238918304443
Epoch: 11, Steps: 208 | Train Loss: 1.685 Vali Loss: 5.157 Vali Acc: 0.118 Test Loss: 5.157 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1651698
	speed: 0.3167s/iter; left time: 5830.9044s
	iters: 200, epoch: 12 | loss: 0.9794167
	speed: 0.0614s/iter; left time: 1125.1301s
Epoch: 12 cost time: 14.038187265396118
Epoch: 12, Steps: 208 | Train Loss: 1.516 Vali Loss: 5.289 Vali Acc: 0.117 Test Loss: 5.289 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.8405255
	speed: 0.3235s/iter; left time: 5889.2448s
	iters: 200, epoch: 13 | loss: 2.3675070
	speed: 0.0621s/iter; left time: 1124.8295s
Epoch: 13 cost time: 13.542376279830933
Epoch: 13, Steps: 208 | Train Loss: 1.376 Vali Loss: 5.403 Vali Acc: 0.121 Test Loss: 5.403 Test Acc: 0.121
Validation loss decreased (-0.120145 --> -0.121032).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3417071
	speed: 0.3464s/iter; left time: 6234.3104s
	iters: 200, epoch: 14 | loss: 0.9939609
	speed: 0.0644s/iter; left time: 1151.9938s
Epoch: 14 cost time: 14.217161417007446
Epoch: 14, Steps: 208 | Train Loss: 1.218 Vali Loss: 5.748 Vali Acc: 0.123 Test Loss: 5.748 Test Acc: 0.123
Validation loss decreased (-0.121032 --> -0.123116).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5347632
	speed: 0.3595s/iter; left time: 6395.3053s
	iters: 200, epoch: 15 | loss: 0.7733237
	speed: 0.0537s/iter; left time: 950.0035s
Epoch: 15 cost time: 12.992591142654419
Epoch: 15, Steps: 208 | Train Loss: 1.059 Vali Loss: 6.025 Vali Acc: 0.127 Test Loss: 6.025 Test Acc: 0.127
Validation loss decreased (-0.123116 --> -0.127288).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7073059
	speed: 0.3356s/iter; left time: 5899.7926s
	iters: 200, epoch: 16 | loss: 1.6214159
	speed: 0.0648s/iter; left time: 1132.3173s
Epoch: 16 cost time: 14.219550848007202
Epoch: 16, Steps: 208 | Train Loss: 0.941 Vali Loss: 6.532 Vali Acc: 0.113 Test Loss: 6.532 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7110976
	speed: 0.3751s/iter; left time: 6516.5228s
	iters: 200, epoch: 17 | loss: 0.8361211
	speed: 0.0629s/iter; left time: 1085.8373s
Epoch: 17 cost time: 14.465242862701416
Epoch: 17, Steps: 208 | Train Loss: 0.843 Vali Loss: 6.917 Vali Acc: 0.120 Test Loss: 6.917 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7070193
	speed: 0.3668s/iter; left time: 6296.6959s
	iters: 200, epoch: 18 | loss: 1.0552157
	speed: 0.0701s/iter; left time: 1196.7511s
Epoch: 18 cost time: 15.228285074234009
Epoch: 18, Steps: 208 | Train Loss: 0.732 Vali Loss: 7.173 Vali Acc: 0.126 Test Loss: 7.173 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.5345481
	speed: 0.3325s/iter; left time: 5638.2986s
	iters: 200, epoch: 19 | loss: 0.7550111
	speed: 0.0635s/iter; left time: 1069.7338s
Epoch: 19 cost time: 13.821478128433228
Epoch: 19, Steps: 208 | Train Loss: 0.691 Vali Loss: 7.607 Vali Acc: 0.121 Test Loss: 7.607 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4629710
	speed: 0.3676s/iter; left time: 6156.1219s
	iters: 200, epoch: 20 | loss: 1.2858094
	speed: 0.0541s/iter; left time: 901.0948s
Epoch: 20 cost time: 12.7479887008667
Epoch: 20, Steps: 208 | Train Loss: 0.603 Vali Loss: 8.052 Vali Acc: 0.123 Test Loss: 8.052 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.6195055
	speed: 0.3269s/iter; left time: 5407.8951s
	iters: 200, epoch: 21 | loss: 0.8260832
	speed: 0.0587s/iter; left time: 964.8993s
Epoch: 21 cost time: 13.924322128295898
Epoch: 21, Steps: 208 | Train Loss: 0.558 Vali Loss: 8.369 Vali Acc: 0.126 Test Loss: 8.369 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3533217
	speed: 0.3496s/iter; left time: 5709.8383s
	iters: 200, epoch: 22 | loss: 0.3688220
	speed: 0.0493s/iter; left time: 800.9419s
Epoch: 22 cost time: 12.282294034957886
Epoch: 22, Steps: 208 | Train Loss: 0.505 Vali Loss: 8.509 Vali Acc: 0.130 Test Loss: 8.509 Test Acc: 0.130
Validation loss decreased (-0.127288 --> -0.129649).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1775858
	speed: 0.3413s/iter; left time: 5502.7987s
	iters: 200, epoch: 23 | loss: 0.5078334
	speed: 0.0550s/iter; left time: 880.8660s
Epoch: 23 cost time: 12.447584629058838
Epoch: 23, Steps: 208 | Train Loss: 0.490 Vali Loss: 8.763 Vali Acc: 0.123 Test Loss: 8.763 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1787066
	speed: 0.3240s/iter; left time: 5157.6533s
	iters: 200, epoch: 24 | loss: 0.3933414
	speed: 0.0594s/iter; left time: 939.2061s
Epoch: 24 cost time: 13.690001487731934
Epoch: 24, Steps: 208 | Train Loss: 0.431 Vali Loss: 9.329 Vali Acc: 0.128 Test Loss: 9.329 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.4638416
	speed: 0.3615s/iter; left time: 5679.3417s
	iters: 200, epoch: 25 | loss: 0.4420794
	speed: 0.0614s/iter; left time: 958.5495s
Epoch: 25 cost time: 14.046393156051636
Epoch: 25, Steps: 208 | Train Loss: 0.410 Vali Loss: 9.629 Vali Acc: 0.125 Test Loss: 9.629 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.6079849
	speed: 0.3662s/iter; left time: 5676.1784s
	iters: 200, epoch: 26 | loss: 0.8695022
	speed: 0.0539s/iter; left time: 829.4172s
Epoch: 26 cost time: 13.548889875411987
Epoch: 26, Steps: 208 | Train Loss: 0.368 Vali Loss: 9.588 Vali Acc: 0.120 Test Loss: 9.588 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.2538702
	speed: 0.3269s/iter; left time: 4998.7887s
	iters: 200, epoch: 27 | loss: 0.2662904
	speed: 0.0494s/iter; left time: 751.0328s
Epoch: 27 cost time: 11.936818838119507
Epoch: 27, Steps: 208 | Train Loss: 0.343 Vali Loss: 10.419 Vali Acc: 0.118 Test Loss: 10.419 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.5065205
	speed: 0.3470s/iter; left time: 5235.0894s
	iters: 200, epoch: 28 | loss: 0.3862172
	speed: 0.0592s/iter; left time: 887.3929s
Epoch: 28 cost time: 14.004243850708008
Epoch: 28, Steps: 208 | Train Loss: 0.312 Vali Loss: 10.535 Vali Acc: 0.115 Test Loss: 10.535 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.2620156
	speed: 0.3426s/iter; left time: 5097.4682s
	iters: 200, epoch: 29 | loss: 0.2736188
	speed: 0.0548s/iter; left time: 809.2725s
Epoch: 29 cost time: 12.18244981765747
Epoch: 29, Steps: 208 | Train Loss: 0.306 Vali Loss: 10.843 Vali Acc: 0.113 Test Loss: 10.843 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.5649873
	speed: 0.3409s/iter; left time: 4999.9844s
	iters: 200, epoch: 30 | loss: 0.2448027
	speed: 0.0551s/iter; left time: 802.5308s
Epoch: 30 cost time: 12.915119647979736
Epoch: 30, Steps: 208 | Train Loss: 0.287 Vali Loss: 11.155 Vali Acc: 0.113 Test Loss: 11.155 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.6831195
	speed: 0.3503s/iter; left time: 5065.4279s
	iters: 200, epoch: 31 | loss: 0.4767139
	speed: 0.0554s/iter; left time: 795.8562s
Epoch: 31 cost time: 13.144140005111694
Epoch: 31, Steps: 208 | Train Loss: 0.278 Vali Loss: 10.967 Vali Acc: 0.112 Test Loss: 10.967 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.2510045
	speed: 0.3510s/iter; left time: 5002.3546s
	iters: 200, epoch: 32 | loss: 0.0614931
	speed: 0.0514s/iter; left time: 727.1617s
Epoch: 32 cost time: 13.066076040267944
Epoch: 32, Steps: 208 | Train Loss: 0.278 Vali Loss: 11.698 Vali Acc: 0.133 Test Loss: 11.698 Test Acc: 0.133
Validation loss decreased (-0.129649 --> -0.132600).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.1794367
	speed: 0.3168s/iter; left time: 4449.4726s
	iters: 200, epoch: 33 | loss: 0.9590389
	speed: 0.0538s/iter; left time: 750.1944s
Epoch: 33 cost time: 12.374703168869019
Epoch: 33, Steps: 208 | Train Loss: 0.267 Vali Loss: 11.803 Vali Acc: 0.123 Test Loss: 11.803 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.4136965
	speed: 0.3215s/iter; left time: 4448.0175s
	iters: 200, epoch: 34 | loss: 1.1577380
	speed: 0.0581s/iter; left time: 797.7166s
Epoch: 34 cost time: 13.089157819747925
Epoch: 34, Steps: 208 | Train Loss: 0.260 Vali Loss: 12.085 Vali Acc: 0.119 Test Loss: 12.085 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.4236527
	speed: 0.3164s/iter; left time: 4312.5257s
	iters: 200, epoch: 35 | loss: 0.2734689
	speed: 0.0606s/iter; left time: 819.3644s
Epoch: 35 cost time: 13.382838726043701
Epoch: 35, Steps: 208 | Train Loss: 0.236 Vali Loss: 12.196 Vali Acc: 0.118 Test Loss: 12.196 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0112426
	speed: 0.3607s/iter; left time: 4841.0667s
	iters: 200, epoch: 36 | loss: 0.0588474
	speed: 0.0634s/iter; left time: 843.8998s
Epoch: 36 cost time: 14.974086046218872
Epoch: 36, Steps: 208 | Train Loss: 0.263 Vali Loss: 12.340 Vali Acc: 0.123 Test Loss: 12.340 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.1041718
	speed: 0.3892s/iter; left time: 5143.0052s
	iters: 200, epoch: 37 | loss: 0.8362223
	speed: 0.0752s/iter; left time: 985.6862s
Epoch: 37 cost time: 16.985897064208984
Epoch: 37, Steps: 208 | Train Loss: 0.215 Vali Loss: 12.535 Vali Acc: 0.121 Test Loss: 12.535 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.2180499
	speed: 0.3684s/iter; left time: 4790.8688s
	iters: 200, epoch: 38 | loss: 0.5270920
	speed: 0.0510s/iter; left time: 657.9880s
Epoch: 38 cost time: 13.56434178352356
Epoch: 38, Steps: 208 | Train Loss: 0.227 Vali Loss: 12.896 Vali Acc: 0.115 Test Loss: 12.896 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0589709
	speed: 0.3376s/iter; left time: 4320.2938s
	iters: 200, epoch: 39 | loss: 0.0643725
	speed: 0.0565s/iter; left time: 717.4807s
Epoch: 39 cost time: 13.000832557678223
Epoch: 39, Steps: 208 | Train Loss: 0.197 Vali Loss: 12.642 Vali Acc: 0.117 Test Loss: 12.642 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0057511
	speed: 0.3427s/iter; left time: 4313.6594s
	iters: 200, epoch: 40 | loss: 0.0466667
	speed: 0.0534s/iter; left time: 666.6740s
Epoch: 40 cost time: 13.188218593597412
Epoch: 40, Steps: 208 | Train Loss: 0.191 Vali Loss: 13.189 Vali Acc: 0.122 Test Loss: 13.189 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.1403131
	speed: 0.3364s/iter; left time: 4165.2601s
	iters: 200, epoch: 41 | loss: 0.4955652
	speed: 0.0549s/iter; left time: 673.8751s
Epoch: 41 cost time: 12.749282598495483
Epoch: 41, Steps: 208 | Train Loss: 0.196 Vali Loss: 13.390 Vali Acc: 0.119 Test Loss: 13.390 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.4392692
	speed: 0.3450s/iter; left time: 4199.1377s
	iters: 200, epoch: 42 | loss: 0.5823686
	speed: 0.0621s/iter; left time: 749.9161s
Epoch: 42 cost time: 14.145615100860596
Epoch: 42, Steps: 208 | Train Loss: 0.203 Vali Loss: 14.006 Vali Acc: 0.116 Test Loss: 14.006 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13271696987772144
model parameter : 303687
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5634239
	speed: 0.0999s/iter; left time: 2068.6031s
	iters: 200, epoch: 1 | loss: 3.4267976
	speed: 0.0624s/iter; left time: 1285.2300s
Epoch: 1 cost time: 17.05994153022766
Epoch: 1, Steps: 208 | Train Loss: 3.814 Vali Loss: 3.839 Vali Acc: 0.054 Test Loss: 3.839 Test Acc: 0.054
Validation loss decreased (inf --> -0.054241).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4723358
	speed: 0.3413s/iter; left time: 6995.0238s
	iters: 200, epoch: 2 | loss: 3.8322029
	speed: 0.0587s/iter; left time: 1197.0139s
Epoch: 2 cost time: 13.675211906433105
Epoch: 2, Steps: 208 | Train Loss: 3.535 Vali Loss: 3.779 Vali Acc: 0.075 Test Loss: 3.779 Test Acc: 0.075
Validation loss decreased (-0.054241 --> -0.075119).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9997623
	speed: 0.3874s/iter; left time: 7858.1394s
	iters: 200, epoch: 3 | loss: 3.2596412
	speed: 0.0652s/iter; left time: 1315.1627s
Epoch: 3 cost time: 14.329464197158813
Epoch: 3, Steps: 208 | Train Loss: 3.189 Vali Loss: 3.854 Vali Acc: 0.081 Test Loss: 3.854 Test Acc: 0.081
Validation loss decreased (-0.075119 --> -0.081381).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4746621
	speed: 0.4013s/iter; left time: 8057.8866s
	iters: 200, epoch: 4 | loss: 3.3265395
	speed: 0.0740s/iter; left time: 1479.1781s
Epoch: 4 cost time: 16.695505142211914
Epoch: 4, Steps: 208 | Train Loss: 3.037 Vali Loss: 4.049 Vali Acc: 0.100 Test Loss: 4.049 Test Acc: 0.100
Validation loss decreased (-0.081381 --> -0.099572).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6197641
	speed: 0.3930s/iter; left time: 7808.8594s
	iters: 200, epoch: 5 | loss: 2.8015103
	speed: 0.0697s/iter; left time: 1377.1577s
Epoch: 5 cost time: 16.65477991104126
Epoch: 5, Steps: 208 | Train Loss: 2.838 Vali Loss: 4.080 Vali Acc: 0.098 Test Loss: 4.080 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4976423
	speed: 0.3465s/iter; left time: 6812.3437s
	iters: 200, epoch: 6 | loss: 3.0420620
	speed: 0.0676s/iter; left time: 1321.6239s
Epoch: 6 cost time: 14.846897602081299
Epoch: 6, Steps: 208 | Train Loss: 2.725 Vali Loss: 4.106 Vali Acc: 0.105 Test Loss: 4.106 Test Acc: 0.105
Validation loss decreased (-0.099572 --> -0.105238).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1871810
	speed: 0.3426s/iter; left time: 6664.0059s
	iters: 200, epoch: 7 | loss: 2.7553089
	speed: 0.0537s/iter; left time: 1040.1207s
Epoch: 7 cost time: 12.59904670715332
Epoch: 7, Steps: 208 | Train Loss: 2.569 Vali Loss: 4.352 Vali Acc: 0.099 Test Loss: 4.352 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3733978
	speed: 0.3591s/iter; left time: 6911.6304s
	iters: 200, epoch: 8 | loss: 2.5333223
	speed: 0.0510s/iter; left time: 977.1376s
Epoch: 8 cost time: 12.72036099433899
Epoch: 8, Steps: 208 | Train Loss: 2.400 Vali Loss: 4.317 Vali Acc: 0.102 Test Loss: 4.317 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4734929
	speed: 0.3706s/iter; left time: 7055.8155s
	iters: 200, epoch: 9 | loss: 3.3768477
	speed: 0.0667s/iter; left time: 1263.2293s
Epoch: 9 cost time: 15.815932273864746
Epoch: 9, Steps: 208 | Train Loss: 2.260 Vali Loss: 4.482 Vali Acc: 0.100 Test Loss: 4.482 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.0280452
	speed: 0.3474s/iter; left time: 6541.1778s
	iters: 200, epoch: 10 | loss: 1.9044753
	speed: 0.0617s/iter; left time: 1155.1072s
Epoch: 10 cost time: 13.247409582138062
Epoch: 10, Steps: 208 | Train Loss: 2.100 Vali Loss: 4.676 Vali Acc: 0.111 Test Loss: 4.676 Test Acc: 0.111
Validation loss decreased (-0.105238 --> -0.110899).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6582894
	speed: 0.3412s/iter; left time: 6352.6164s
	iters: 200, epoch: 11 | loss: 2.1487408
	speed: 0.0615s/iter; left time: 1139.5140s
Epoch: 11 cost time: 14.549399614334106
Epoch: 11, Steps: 208 | Train Loss: 1.867 Vali Loss: 4.642 Vali Acc: 0.113 Test Loss: 4.642 Test Acc: 0.113
Validation loss decreased (-0.110899 --> -0.112987).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8506706
	speed: 0.3809s/iter; left time: 7013.4427s
	iters: 200, epoch: 12 | loss: 2.2702222
	speed: 0.0674s/iter; left time: 1234.2744s
Epoch: 12 cost time: 15.841206550598145
Epoch: 12, Steps: 208 | Train Loss: 1.755 Vali Loss: 5.160 Vali Acc: 0.112 Test Loss: 5.160 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5315150
	speed: 0.3742s/iter; left time: 6811.7294s
	iters: 200, epoch: 13 | loss: 1.1474179
	speed: 0.0571s/iter; left time: 1033.8593s
Epoch: 13 cost time: 13.99722409248352
Epoch: 13, Steps: 208 | Train Loss: 1.575 Vali Loss: 5.157 Vali Acc: 0.104 Test Loss: 5.157 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1256254
	speed: 0.3824s/iter; left time: 6882.1592s
	iters: 200, epoch: 14 | loss: 1.3295974
	speed: 0.0742s/iter; left time: 1328.3843s
Epoch: 14 cost time: 16.8707172870636
Epoch: 14, Steps: 208 | Train Loss: 1.435 Vali Loss: 5.647 Vali Acc: 0.114 Test Loss: 5.647 Test Acc: 0.114
Validation loss decreased (-0.112987 --> -0.113871).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7467890
	speed: 0.3787s/iter; left time: 6735.9753s
	iters: 200, epoch: 15 | loss: 1.2594662
	speed: 0.0645s/iter; left time: 1141.0012s
Epoch: 15 cost time: 15.456636905670166
Epoch: 15, Steps: 208 | Train Loss: 1.308 Vali Loss: 5.700 Vali Acc: 0.115 Test Loss: 5.700 Test Acc: 0.115
Validation loss decreased (-0.113871 --> -0.115064).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9311349
	speed: 0.3987s/iter; left time: 7009.2575s
	iters: 200, epoch: 16 | loss: 1.1151407
	speed: 0.0669s/iter; left time: 1169.3633s
Epoch: 16 cost time: 16.011657238006592
Epoch: 16, Steps: 208 | Train Loss: 1.163 Vali Loss: 6.035 Vali Acc: 0.115 Test Loss: 6.035 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3693972
	speed: 0.3476s/iter; left time: 6038.8230s
	iters: 200, epoch: 17 | loss: 1.1934259
	speed: 0.0582s/iter; left time: 1005.0487s
Epoch: 17 cost time: 12.664308786392212
Epoch: 17, Steps: 208 | Train Loss: 1.034 Vali Loss: 6.462 Vali Acc: 0.116 Test Loss: 6.462 Test Acc: 0.116
Validation loss decreased (-0.115064 --> -0.115653).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4475648
	speed: 0.3710s/iter; left time: 6368.0126s
	iters: 200, epoch: 18 | loss: 1.5019603
	speed: 0.0562s/iter; left time: 958.7355s
Epoch: 18 cost time: 13.99882698059082
Epoch: 18, Steps: 208 | Train Loss: 0.958 Vali Loss: 6.626 Vali Acc: 0.108 Test Loss: 6.626 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8424643
	speed: 0.3540s/iter; left time: 6003.5544s
	iters: 200, epoch: 19 | loss: 1.0415455
	speed: 0.0591s/iter; left time: 996.1371s
Epoch: 19 cost time: 14.360551118850708
Epoch: 19, Steps: 208 | Train Loss: 0.855 Vali Loss: 7.016 Vali Acc: 0.111 Test Loss: 7.016 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2617150
	speed: 0.3533s/iter; left time: 5917.3356s
	iters: 200, epoch: 20 | loss: 0.7431417
	speed: 0.0566s/iter; left time: 942.2080s
Epoch: 20 cost time: 14.011569023132324
Epoch: 20, Steps: 208 | Train Loss: 0.804 Vali Loss: 7.226 Vali Acc: 0.107 Test Loss: 7.226 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.8131946
	speed: 0.3390s/iter; left time: 5607.5836s
	iters: 200, epoch: 21 | loss: 0.4055592
	speed: 0.0576s/iter; left time: 946.6825s
Epoch: 21 cost time: 12.736857891082764
Epoch: 21, Steps: 208 | Train Loss: 0.709 Vali Loss: 7.713 Vali Acc: 0.109 Test Loss: 7.713 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.6202155
	speed: 0.3245s/iter; left time: 5300.1745s
	iters: 200, epoch: 22 | loss: 0.5231465
	speed: 0.0641s/iter; left time: 1040.1243s
Epoch: 22 cost time: 14.049836874008179
Epoch: 22, Steps: 208 | Train Loss: 0.644 Vali Loss: 7.921 Vali Acc: 0.107 Test Loss: 7.921 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.9273705
	speed: 0.3313s/iter; left time: 5342.2481s
	iters: 200, epoch: 23 | loss: 0.4501564
	speed: 0.0542s/iter; left time: 868.1097s
Epoch: 23 cost time: 13.026484966278076
Epoch: 23, Steps: 208 | Train Loss: 0.592 Vali Loss: 8.155 Vali Acc: 0.118 Test Loss: 8.155 Test Acc: 0.118
Validation loss decreased (-0.115653 --> -0.117723).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.1479137
	speed: 0.3119s/iter; left time: 4965.1729s
	iters: 200, epoch: 24 | loss: 0.9223944
	speed: 0.0598s/iter; left time: 945.1798s
Epoch: 24 cost time: 12.917013168334961
Epoch: 24, Steps: 208 | Train Loss: 0.554 Vali Loss: 8.846 Vali Acc: 0.113 Test Loss: 8.846 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4707485
	speed: 0.3415s/iter; left time: 5364.0202s
	iters: 200, epoch: 25 | loss: 0.6475086
	speed: 0.0595s/iter; left time: 929.3301s
Epoch: 25 cost time: 12.413316011428833
Epoch: 25, Steps: 208 | Train Loss: 0.508 Vali Loss: 8.737 Vali Acc: 0.102 Test Loss: 8.737 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.7014233
	speed: 0.3355s/iter; left time: 5201.2747s
	iters: 200, epoch: 26 | loss: 0.8663970
	speed: 0.0594s/iter; left time: 914.4937s
Epoch: 26 cost time: 13.141117811203003
Epoch: 26, Steps: 208 | Train Loss: 0.495 Vali Loss: 8.843 Vali Acc: 0.110 Test Loss: 8.843 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1867028
	speed: 0.3451s/iter; left time: 5277.1924s
	iters: 200, epoch: 27 | loss: 0.3147491
	speed: 0.0612s/iter; left time: 929.6145s
Epoch: 27 cost time: 14.713855743408203
Epoch: 27, Steps: 208 | Train Loss: 0.457 Vali Loss: 9.353 Vali Acc: 0.109 Test Loss: 9.353 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.4365243
	speed: 0.3180s/iter; left time: 4796.9665s
	iters: 200, epoch: 28 | loss: 0.8835137
	speed: 0.0495s/iter; left time: 741.9747s
Epoch: 28 cost time: 12.064754486083984
Epoch: 28, Steps: 208 | Train Loss: 0.431 Vali Loss: 9.539 Vali Acc: 0.109 Test Loss: 9.539 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0813705
	speed: 0.2998s/iter; left time: 4460.0355s
	iters: 200, epoch: 29 | loss: 0.8241436
	speed: 0.0465s/iter; left time: 686.5996s
Epoch: 29 cost time: 11.20327639579773
Epoch: 29, Steps: 208 | Train Loss: 0.427 Vali Loss: 10.028 Vali Acc: 0.110 Test Loss: 10.028 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1742849
	speed: 0.3101s/iter; left time: 4548.5422s
	iters: 200, epoch: 30 | loss: 0.9486105
	speed: 0.0535s/iter; left time: 778.7733s
Epoch: 30 cost time: 11.964109420776367
Epoch: 30, Steps: 208 | Train Loss: 0.344 Vali Loss: 9.937 Vali Acc: 0.112 Test Loss: 9.937 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.4502076
	speed: 0.3205s/iter; left time: 4635.0109s
	iters: 200, epoch: 31 | loss: 0.6619437
	speed: 0.0496s/iter; left time: 711.5991s
Epoch: 31 cost time: 12.12598967552185
Epoch: 31, Steps: 208 | Train Loss: 0.358 Vali Loss: 10.244 Vali Acc: 0.115 Test Loss: 10.244 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.5571936
	speed: 0.3288s/iter; left time: 4686.1593s
	iters: 200, epoch: 32 | loss: 0.2709582
	speed: 0.0557s/iter; left time: 787.7206s
Epoch: 32 cost time: 13.036019802093506
Epoch: 32, Steps: 208 | Train Loss: 0.350 Vali Loss: 10.744 Vali Acc: 0.108 Test Loss: 10.744 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.3245774
	speed: 0.3282s/iter; left time: 4609.3678s
	iters: 200, epoch: 33 | loss: 0.2926261
	speed: 0.0560s/iter; left time: 780.3145s
Epoch: 33 cost time: 12.627213478088379
Epoch: 33, Steps: 208 | Train Loss: 0.322 Vali Loss: 11.349 Vali Acc: 0.110 Test Loss: 11.349 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11780495079033701
model parameter : 207943
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5352993
	speed: 0.0946s/iter; left time: 1958.3205s
	iters: 200, epoch: 1 | loss: 3.9318123
	speed: 0.0587s/iter; left time: 1209.9895s
Epoch: 1 cost time: 15.859608173370361
Epoch: 1, Steps: 208 | Train Loss: 3.783 Vali Loss: 3.744 Vali Acc: 0.051 Test Loss: 3.744 Test Acc: 0.051
Validation loss decreased (inf --> -0.050962).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9885228
	speed: 0.3397s/iter; left time: 6960.5371s
	iters: 200, epoch: 2 | loss: 3.7473412
	speed: 0.0574s/iter; left time: 1169.5861s
Epoch: 2 cost time: 13.235600709915161
Epoch: 2, Steps: 208 | Train Loss: 3.545 Vali Loss: 3.721 Vali Acc: 0.071 Test Loss: 3.721 Test Acc: 0.071
Validation loss decreased (-0.050962 --> -0.070944).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3721218
	speed: 0.3343s/iter; left time: 6781.5197s
	iters: 200, epoch: 3 | loss: 3.5615718
	speed: 0.0609s/iter; left time: 1228.3566s
Epoch: 3 cost time: 13.355847835540771
Epoch: 3, Steps: 208 | Train Loss: 3.283 Vali Loss: 3.787 Vali Acc: 0.078 Test Loss: 3.787 Test Acc: 0.078
Validation loss decreased (-0.070944 --> -0.077803).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0852928
	speed: 0.3344s/iter; left time: 6714.5672s
	iters: 200, epoch: 4 | loss: 3.7237918
	speed: 0.0544s/iter; left time: 1086.7772s
Epoch: 4 cost time: 11.671617031097412
Epoch: 4, Steps: 208 | Train Loss: 3.087 Vali Loss: 3.935 Vali Acc: 0.081 Test Loss: 3.935 Test Acc: 0.081
Validation loss decreased (-0.077803 --> -0.080486).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6312919
	speed: 0.3455s/iter; left time: 6864.5723s
	iters: 200, epoch: 5 | loss: 3.3751023
	speed: 0.0510s/iter; left time: 1008.4312s
Epoch: 5 cost time: 12.605227708816528
Epoch: 5, Steps: 208 | Train Loss: 2.958 Vali Loss: 3.940 Vali Acc: 0.091 Test Loss: 3.940 Test Acc: 0.091
Validation loss decreased (-0.080486 --> -0.090626).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6259184
	speed: 0.3120s/iter; left time: 6135.1262s
	iters: 200, epoch: 6 | loss: 3.5778601
	speed: 0.0557s/iter; left time: 1089.7727s
Epoch: 6 cost time: 12.139448404312134
Epoch: 6, Steps: 208 | Train Loss: 2.805 Vali Loss: 4.006 Vali Acc: 0.089 Test Loss: 4.006 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7162242
	speed: 0.3236s/iter; left time: 6295.4390s
	iters: 200, epoch: 7 | loss: 2.4371500
	speed: 0.0604s/iter; left time: 1169.8466s
Epoch: 7 cost time: 12.959789991378784
Epoch: 7, Steps: 208 | Train Loss: 2.671 Vali Loss: 4.037 Vali Acc: 0.101 Test Loss: 4.037 Test Acc: 0.101
Validation loss decreased (-0.090626 --> -0.101063).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0360162
	speed: 0.3177s/iter; left time: 6113.4932s
	iters: 200, epoch: 8 | loss: 2.5512540
	speed: 0.0552s/iter; left time: 1055.9963s
Epoch: 8 cost time: 11.977002382278442
Epoch: 8, Steps: 208 | Train Loss: 2.551 Vali Loss: 4.143 Vali Acc: 0.101 Test Loss: 4.143 Test Acc: 0.101
Validation loss decreased (-0.101063 --> -0.101360).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0499158
	speed: 0.3182s/iter; left time: 6056.7896s
	iters: 200, epoch: 9 | loss: 2.8230610
	speed: 0.0460s/iter; left time: 870.4943s
Epoch: 9 cost time: 11.484006881713867
Epoch: 9, Steps: 208 | Train Loss: 2.390 Vali Loss: 4.183 Vali Acc: 0.102 Test Loss: 4.183 Test Acc: 0.102
Validation loss decreased (-0.101360 --> -0.101658).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9559045
	speed: 0.3383s/iter; left time: 6370.1709s
	iters: 200, epoch: 10 | loss: 2.3173432
	speed: 0.0530s/iter; left time: 991.7111s
Epoch: 10 cost time: 13.183849573135376
Epoch: 10, Steps: 208 | Train Loss: 2.222 Vali Loss: 4.346 Vali Acc: 0.110 Test Loss: 4.346 Test Acc: 0.110
Validation loss decreased (-0.101658 --> -0.110305).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6468294
	speed: 0.3304s/iter; left time: 6151.8493s
	iters: 200, epoch: 11 | loss: 3.3348315
	speed: 0.0575s/iter; left time: 1064.9764s
Epoch: 11 cost time: 12.869728803634644
Epoch: 11, Steps: 208 | Train Loss: 2.074 Vali Loss: 4.462 Vali Acc: 0.101 Test Loss: 4.462 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6255162
	speed: 0.3392s/iter; left time: 6245.2689s
	iters: 200, epoch: 12 | loss: 2.5285304
	speed: 0.0605s/iter; left time: 1108.7992s
Epoch: 12 cost time: 13.029610872268677
Epoch: 12, Steps: 208 | Train Loss: 1.930 Vali Loss: 4.780 Vali Acc: 0.103 Test Loss: 4.780 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.1787376
	speed: 0.3279s/iter; left time: 5969.0661s
	iters: 200, epoch: 13 | loss: 2.5931027
	speed: 0.0529s/iter; left time: 957.6750s
Epoch: 13 cost time: 12.684982538223267
Epoch: 13, Steps: 208 | Train Loss: 1.754 Vali Loss: 4.891 Vali Acc: 0.106 Test Loss: 4.891 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.9855100
	speed: 0.3226s/iter; left time: 5805.8807s
	iters: 200, epoch: 14 | loss: 2.2077203
	speed: 0.0463s/iter; left time: 827.7537s
Epoch: 14 cost time: 11.552324056625366
Epoch: 14, Steps: 208 | Train Loss: 1.633 Vali Loss: 5.066 Vali Acc: 0.104 Test Loss: 5.066 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.0542781
	speed: 0.3231s/iter; left time: 5747.5211s
	iters: 200, epoch: 15 | loss: 1.0791301
	speed: 0.0491s/iter; left time: 868.7887s
Epoch: 15 cost time: 11.546808242797852
Epoch: 15, Steps: 208 | Train Loss: 1.462 Vali Loss: 5.359 Vali Acc: 0.105 Test Loss: 5.359 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3767241
	speed: 0.3064s/iter; left time: 5386.1725s
	iters: 200, epoch: 16 | loss: 1.6664755
	speed: 0.0547s/iter; left time: 955.5129s
Epoch: 16 cost time: 13.066036939620972
Epoch: 16, Steps: 208 | Train Loss: 1.293 Vali Loss: 5.789 Vali Acc: 0.106 Test Loss: 5.789 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.1808081
	speed: 0.2941s/iter; left time: 5108.9280s
	iters: 200, epoch: 17 | loss: 1.7510244
	speed: 0.0535s/iter; left time: 924.2691s
Epoch: 17 cost time: 12.422236442565918
Epoch: 17, Steps: 208 | Train Loss: 1.196 Vali Loss: 5.813 Vali Acc: 0.108 Test Loss: 5.813 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.0406333
	speed: 0.3054s/iter; left time: 5242.0841s
	iters: 200, epoch: 18 | loss: 0.6084331
	speed: 0.0521s/iter; left time: 888.9611s
Epoch: 18 cost time: 12.092201232910156
Epoch: 18, Steps: 208 | Train Loss: 1.073 Vali Loss: 6.183 Vali Acc: 0.106 Test Loss: 6.183 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.2862854
	speed: 0.3101s/iter; left time: 5258.1431s
	iters: 200, epoch: 19 | loss: 1.4126580
	speed: 0.0517s/iter; left time: 871.8445s
Epoch: 19 cost time: 12.53867769241333
Epoch: 19, Steps: 208 | Train Loss: 0.987 Vali Loss: 6.414 Vali Acc: 0.116 Test Loss: 6.414 Test Acc: 0.116
Validation loss decreased (-0.110305 --> -0.116250).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.8475009
	speed: 0.2886s/iter; left time: 4833.6229s
	iters: 200, epoch: 20 | loss: 0.7806321
	speed: 0.0449s/iter; left time: 746.8349s
Epoch: 20 cost time: 10.579570531845093
Epoch: 20, Steps: 208 | Train Loss: 0.912 Vali Loss: 6.991 Vali Acc: 0.108 Test Loss: 6.991 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.9046550
	speed: 0.2840s/iter; left time: 4697.4663s
	iters: 200, epoch: 21 | loss: 0.8289809
	speed: 0.0510s/iter; left time: 838.5310s
Epoch: 21 cost time: 11.00040864944458
Epoch: 21, Steps: 208 | Train Loss: 0.825 Vali Loss: 7.148 Vali Acc: 0.106 Test Loss: 7.148 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.8810145
	speed: 0.3351s/iter; left time: 5473.9503s
	iters: 200, epoch: 22 | loss: 0.6623503
	speed: 0.0653s/iter; left time: 1059.6951s
Epoch: 22 cost time: 14.621503353118896
Epoch: 22, Steps: 208 | Train Loss: 0.719 Vali Loss: 7.437 Vali Acc: 0.113 Test Loss: 7.437 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.4175504
	speed: 0.3455s/iter; left time: 5570.4263s
	iters: 200, epoch: 23 | loss: 0.3194120
	speed: 0.0604s/iter; left time: 968.2088s
Epoch: 23 cost time: 12.956367492675781
Epoch: 23, Steps: 208 | Train Loss: 0.713 Vali Loss: 7.759 Vali Acc: 0.113 Test Loss: 7.759 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4428627
	speed: 0.3568s/iter; left time: 5679.9034s
	iters: 200, epoch: 24 | loss: 1.3706625
	speed: 0.0578s/iter; left time: 914.5856s
Epoch: 24 cost time: 13.55271863937378
Epoch: 24, Steps: 208 | Train Loss: 0.613 Vali Loss: 8.086 Vali Acc: 0.113 Test Loss: 8.086 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.4981381
	speed: 0.3342s/iter; left time: 5249.7984s
	iters: 200, epoch: 25 | loss: 0.3764328
	speed: 0.0577s/iter; left time: 901.2081s
Epoch: 25 cost time: 13.680248022079468
Epoch: 25, Steps: 208 | Train Loss: 0.589 Vali Loss: 8.525 Vali Acc: 0.111 Test Loss: 8.525 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.7986591
	speed: 0.3356s/iter; left time: 5202.7002s
	iters: 200, epoch: 26 | loss: 0.7866992
	speed: 0.0420s/iter; left time: 646.4240s
Epoch: 26 cost time: 10.771774053573608
Epoch: 26, Steps: 208 | Train Loss: 0.540 Vali Loss: 8.776 Vali Acc: 0.108 Test Loss: 8.776 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.8898916
	speed: 0.3345s/iter; left time: 5115.8054s
	iters: 200, epoch: 27 | loss: 0.3367647
	speed: 0.0562s/iter; left time: 853.8254s
Epoch: 27 cost time: 12.854966878890991
Epoch: 27, Steps: 208 | Train Loss: 0.523 Vali Loss: 9.098 Vali Acc: 0.114 Test Loss: 9.098 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.4590111
	speed: 0.3083s/iter; left time: 4650.5642s
	iters: 200, epoch: 28 | loss: 0.7938657
	speed: 0.0526s/iter; left time: 788.5059s
Epoch: 28 cost time: 12.862279415130615
Epoch: 28, Steps: 208 | Train Loss: 0.462 Vali Loss: 9.375 Vali Acc: 0.107 Test Loss: 9.375 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.1092954
	speed: 0.3055s/iter; left time: 4545.0278s
	iters: 200, epoch: 29 | loss: 0.6791741
	speed: 0.0451s/iter; left time: 666.5536s
Epoch: 29 cost time: 11.54192042350769
Epoch: 29, Steps: 208 | Train Loss: 0.457 Vali Loss: 9.539 Vali Acc: 0.108 Test Loss: 9.539 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11631374888159857
model parameter : 167111
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6110358
	speed: 0.0826s/iter; left time: 1710.1013s
	iters: 200, epoch: 1 | loss: 3.7364836
	speed: 0.0579s/iter; left time: 1193.0704s
Epoch: 1 cost time: 14.541662454605103
Epoch: 1, Steps: 208 | Train Loss: 3.772 Vali Loss: 3.768 Vali Acc: 0.051 Test Loss: 3.768 Test Acc: 0.051
Validation loss decreased (inf --> -0.051260).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7030654
	speed: 0.3525s/iter; left time: 7223.5635s
	iters: 200, epoch: 2 | loss: 3.3371069
	speed: 0.0528s/iter; left time: 1077.3200s
Epoch: 2 cost time: 13.258989334106445
Epoch: 2, Steps: 208 | Train Loss: 3.591 Vali Loss: 3.750 Vali Acc: 0.061 Test Loss: 3.750 Test Acc: 0.061
Validation loss decreased (-0.051260 --> -0.060505).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3470011
	speed: 0.3230s/iter; left time: 6552.4378s
	iters: 200, epoch: 3 | loss: 3.0827804
	speed: 0.0557s/iter; left time: 1124.6129s
Epoch: 3 cost time: 12.126126527786255
Epoch: 3, Steps: 208 | Train Loss: 3.348 Vali Loss: 3.782 Vali Acc: 0.073 Test Loss: 3.782 Test Acc: 0.073
Validation loss decreased (-0.060505 --> -0.073031).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9436278
	speed: 0.3087s/iter; left time: 6198.2502s
	iters: 200, epoch: 4 | loss: 3.6775782
	speed: 0.0518s/iter; left time: 1035.2785s
Epoch: 4 cost time: 11.538490056991577
Epoch: 4, Steps: 208 | Train Loss: 3.160 Vali Loss: 3.759 Vali Acc: 0.080 Test Loss: 3.759 Test Acc: 0.080
Validation loss decreased (-0.073031 --> -0.079891).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3309743
	speed: 0.3255s/iter; left time: 6467.2419s
	iters: 200, epoch: 5 | loss: 2.9791088
	speed: 0.0484s/iter; left time: 957.2284s
Epoch: 5 cost time: 11.848299503326416
Epoch: 5, Steps: 208 | Train Loss: 2.995 Vali Loss: 3.928 Vali Acc: 0.088 Test Loss: 3.928 Test Acc: 0.088
Validation loss decreased (-0.079891 --> -0.087643).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1733773
	speed: 0.3190s/iter; left time: 6271.4145s
	iters: 200, epoch: 6 | loss: 3.1198812
	speed: 0.0510s/iter; left time: 998.2722s
Epoch: 6 cost time: 12.279721736907959
Epoch: 6, Steps: 208 | Train Loss: 2.869 Vali Loss: 3.933 Vali Acc: 0.088 Test Loss: 3.933 Test Acc: 0.088
Validation loss decreased (-0.087643 --> -0.087942).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4719338
	speed: 0.3133s/iter; left time: 6095.1009s
	iters: 200, epoch: 7 | loss: 2.8531895
	speed: 0.0512s/iter; left time: 990.2398s
Epoch: 7 cost time: 12.037341833114624
Epoch: 7, Steps: 208 | Train Loss: 2.748 Vali Loss: 3.972 Vali Acc: 0.093 Test Loss: 3.972 Test Acc: 0.093
Validation loss decreased (-0.087942 --> -0.093310).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3517964
	speed: 0.3062s/iter; left time: 5893.4489s
	iters: 200, epoch: 8 | loss: 3.3159983
	speed: 0.0473s/iter; left time: 905.8589s
Epoch: 8 cost time: 10.975723505020142
Epoch: 8, Steps: 208 | Train Loss: 2.590 Vali Loss: 4.063 Vali Acc: 0.096 Test Loss: 4.063 Test Acc: 0.096
Validation loss decreased (-0.093310 --> -0.095993).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2620201
	speed: 0.3059s/iter; left time: 5823.5962s
	iters: 200, epoch: 9 | loss: 2.3843615
	speed: 0.0543s/iter; left time: 1028.5470s
Epoch: 9 cost time: 12.092764377593994
Epoch: 9, Steps: 208 | Train Loss: 2.452 Vali Loss: 4.187 Vali Acc: 0.097 Test Loss: 4.187 Test Acc: 0.097
Validation loss decreased (-0.095993 --> -0.097184).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9170220
	speed: 0.3386s/iter; left time: 6376.3816s
	iters: 200, epoch: 10 | loss: 2.5975039
	speed: 0.0479s/iter; left time: 896.2481s
Epoch: 10 cost time: 11.255799531936646
Epoch: 10, Steps: 208 | Train Loss: 2.278 Vali Loss: 4.337 Vali Acc: 0.098 Test Loss: 4.337 Test Acc: 0.098
Validation loss decreased (-0.097184 --> -0.098376).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4444702
	speed: 0.3081s/iter; left time: 5737.5136s
	iters: 200, epoch: 11 | loss: 2.3240294
	speed: 0.0588s/iter; left time: 1089.1993s
Epoch: 11 cost time: 13.266156196594238
Epoch: 11, Steps: 208 | Train Loss: 2.125 Vali Loss: 4.537 Vali Acc: 0.098 Test Loss: 4.537 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9688299
	speed: 0.3133s/iter; left time: 5768.0104s
	iters: 200, epoch: 12 | loss: 2.1649675
	speed: 0.0517s/iter; left time: 946.0801s
Epoch: 12 cost time: 11.94334888458252
Epoch: 12, Steps: 208 | Train Loss: 1.983 Vali Loss: 4.629 Vali Acc: 0.101 Test Loss: 4.629 Test Acc: 0.101
Validation loss decreased (-0.098376 --> -0.100759).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4307835
	speed: 0.3386s/iter; left time: 6163.4348s
	iters: 200, epoch: 13 | loss: 2.7801216
	speed: 0.0533s/iter; left time: 964.6046s
Epoch: 13 cost time: 12.786288261413574
Epoch: 13, Steps: 208 | Train Loss: 1.803 Vali Loss: 4.856 Vali Acc: 0.101 Test Loss: 4.856 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9023356
	speed: 0.3491s/iter; left time: 6283.4324s
	iters: 200, epoch: 14 | loss: 1.9655074
	speed: 0.0526s/iter; left time: 941.2594s
Epoch: 14 cost time: 12.87267255783081
Epoch: 14, Steps: 208 | Train Loss: 1.627 Vali Loss: 5.123 Vali Acc: 0.098 Test Loss: 5.123 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.0572124
	speed: 0.3243s/iter; left time: 5769.1285s
	iters: 200, epoch: 15 | loss: 1.7647877
	speed: 0.0569s/iter; left time: 1007.0836s
Epoch: 15 cost time: 12.799573183059692
Epoch: 15, Steps: 208 | Train Loss: 1.509 Vali Loss: 5.478 Vali Acc: 0.102 Test Loss: 5.478 Test Acc: 0.102
Validation loss decreased (-0.100759 --> -0.102242).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1768157
	speed: 0.3407s/iter; left time: 5989.6265s
	iters: 200, epoch: 16 | loss: 1.5520134
	speed: 0.0547s/iter; left time: 956.7401s
Epoch: 16 cost time: 12.428783416748047
Epoch: 16, Steps: 208 | Train Loss: 1.348 Vali Loss: 5.702 Vali Acc: 0.104 Test Loss: 5.702 Test Acc: 0.104
Validation loss decreased (-0.102242 --> -0.103731).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8907442
	speed: 0.3357s/iter; left time: 5832.9092s
	iters: 200, epoch: 17 | loss: 2.0419006
	speed: 0.0522s/iter; left time: 901.3695s
Epoch: 17 cost time: 12.92335057258606
Epoch: 17, Steps: 208 | Train Loss: 1.233 Vali Loss: 6.085 Vali Acc: 0.104 Test Loss: 6.085 Test Acc: 0.104
Validation loss decreased (-0.103731 --> -0.104025).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2120807
	speed: 0.3054s/iter; left time: 5242.8045s
	iters: 200, epoch: 18 | loss: 2.5550201
	speed: 0.0417s/iter; left time: 711.8469s
Epoch: 18 cost time: 10.467544794082642
Epoch: 18, Steps: 208 | Train Loss: 1.121 Vali Loss: 6.371 Vali Acc: 0.105 Test Loss: 6.371 Test Acc: 0.105
Validation loss decreased (-0.104025 --> -0.105215).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0460594
	speed: 0.3253s/iter; left time: 5516.5015s
	iters: 200, epoch: 19 | loss: 1.2296858
	speed: 0.0513s/iter; left time: 864.6061s
Epoch: 19 cost time: 11.374457120895386
Epoch: 19, Steps: 208 | Train Loss: 0.999 Vali Loss: 6.783 Vali Acc: 0.104 Test Loss: 6.783 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.9359885
	speed: 0.3218s/iter; left time: 5390.4558s
	iters: 200, epoch: 20 | loss: 0.7390640
	speed: 0.0605s/iter; left time: 1006.7741s
Epoch: 20 cost time: 13.728123903274536
Epoch: 20, Steps: 208 | Train Loss: 0.928 Vali Loss: 7.154 Vali Acc: 0.099 Test Loss: 7.154 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0470742
	speed: 0.3235s/iter; left time: 5351.1147s
	iters: 200, epoch: 21 | loss: 0.5407283
	speed: 0.0458s/iter; left time: 753.4589s
Epoch: 21 cost time: 11.44756293296814
Epoch: 21, Steps: 208 | Train Loss: 0.840 Vali Loss: 7.310 Vali Acc: 0.101 Test Loss: 7.310 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.4966727
	speed: 0.3408s/iter; left time: 5565.8987s
	iters: 200, epoch: 22 | loss: 0.7029548
	speed: 0.0507s/iter; left time: 822.5376s
Epoch: 22 cost time: 11.99790072441101
Epoch: 22, Steps: 208 | Train Loss: 0.790 Vali Loss: 7.581 Vali Acc: 0.105 Test Loss: 7.581 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.6296401
	speed: 0.3217s/iter; left time: 5186.7988s
	iters: 200, epoch: 23 | loss: 1.7265117
	speed: 0.0554s/iter; left time: 887.6652s
Epoch: 23 cost time: 13.042807340621948
Epoch: 23, Steps: 208 | Train Loss: 0.733 Vali Loss: 7.880 Vali Acc: 0.100 Test Loss: 7.880 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.6203023
	speed: 0.3632s/iter; left time: 5781.4557s
	iters: 200, epoch: 24 | loss: 1.2553401
	speed: 0.0609s/iter; left time: 962.8377s
Epoch: 24 cost time: 13.984548568725586
Epoch: 24, Steps: 208 | Train Loss: 0.655 Vali Loss: 8.278 Vali Acc: 0.103 Test Loss: 8.278 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.7234893
	speed: 0.3456s/iter; left time: 5429.4177s
	iters: 200, epoch: 25 | loss: 1.4593959
	speed: 0.0632s/iter; left time: 986.8708s
Epoch: 25 cost time: 14.388843297958374
Epoch: 25, Steps: 208 | Train Loss: 0.597 Vali Loss: 8.700 Vali Acc: 0.096 Test Loss: 8.700 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.3160450
	speed: 0.3378s/iter; left time: 5236.5953s
	iters: 200, epoch: 26 | loss: 0.9326172
	speed: 0.0578s/iter; left time: 890.4673s
Epoch: 26 cost time: 13.653997659683228
Epoch: 26, Steps: 208 | Train Loss: 0.565 Vali Loss: 8.872 Vali Acc: 0.098 Test Loss: 8.872 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.1562858
	speed: 0.3228s/iter; left time: 4936.9445s
	iters: 200, epoch: 27 | loss: 0.5306360
	speed: 0.0441s/iter; left time: 670.0034s
Epoch: 27 cost time: 10.709687948226929
Epoch: 27, Steps: 208 | Train Loss: 0.546 Vali Loss: 9.052 Vali Acc: 0.105 Test Loss: 9.052 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.3457952
	speed: 0.3348s/iter; left time: 5051.2119s
	iters: 200, epoch: 28 | loss: 0.4875333
	speed: 0.0474s/iter; left time: 709.6385s
Epoch: 28 cost time: 11.413369178771973
Epoch: 28, Steps: 208 | Train Loss: 0.513 Vali Loss: 9.429 Vali Acc: 0.104 Test Loss: 9.429 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10527885475693409
model parameter : 140007
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6249437
	speed: 0.1086s/iter; left time: 2248.1726s
	iters: 200, epoch: 1 | loss: 5.3209486
	speed: 0.0562s/iter; left time: 1157.9761s
Epoch: 1 cost time: 16.945956230163574
Epoch: 1, Steps: 208 | Train Loss: 4.372 Vali Loss: 4.425 Vali Acc: 0.053 Test Loss: 4.425 Test Acc: 0.053
Validation loss decreased (inf --> -0.053341).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5378566
	speed: 0.3025s/iter; left time: 6200.1496s
	iters: 200, epoch: 2 | loss: 3.1830149
	speed: 0.0605s/iter; left time: 1234.0839s
Epoch: 2 cost time: 14.323940515518188
Epoch: 2, Steps: 208 | Train Loss: 3.554 Vali Loss: 3.814 Vali Acc: 0.086 Test Loss: 3.814 Test Acc: 0.086
Validation loss decreased (-0.053341 --> -0.085557).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.7747712
	speed: 0.2984s/iter; left time: 6053.9713s
	iters: 200, epoch: 3 | loss: 3.6559401
	speed: 0.0514s/iter; left time: 1038.2646s
Epoch: 3 cost time: 12.132161855697632
Epoch: 3, Steps: 208 | Train Loss: 3.353 Vali Loss: 3.677 Vali Acc: 0.089 Test Loss: 3.677 Test Acc: 0.089
Validation loss decreased (-0.085557 --> -0.089435).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1264877
	speed: 0.2890s/iter; left time: 5802.0797s
	iters: 200, epoch: 4 | loss: 3.8846245
	speed: 0.0442s/iter; left time: 882.8421s
Epoch: 4 cost time: 10.275891065597534
Epoch: 4, Steps: 208 | Train Loss: 3.426 Vali Loss: 4.318 Vali Acc: 0.086 Test Loss: 4.318 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.7589025
	speed: 0.3379s/iter; left time: 6714.4047s
	iters: 200, epoch: 5 | loss: 4.6049414
	speed: 0.0670s/iter; left time: 1325.4322s
Epoch: 5 cost time: 16.228212594985962
Epoch: 5, Steps: 208 | Train Loss: 3.313 Vali Loss: 4.590 Vali Acc: 0.088 Test Loss: 4.590 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.6030681
	speed: 0.3193s/iter; left time: 6278.3893s
	iters: 200, epoch: 6 | loss: 3.7614045
	speed: 0.0648s/iter; left time: 1267.9001s
Epoch: 6 cost time: 13.390198945999146
Epoch: 6, Steps: 208 | Train Loss: 3.059 Vali Loss: 4.542 Vali Acc: 0.092 Test Loss: 4.542 Test Acc: 0.092
Validation loss decreased (-0.089435 --> -0.092111).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6386175
	speed: 0.3216s/iter; left time: 6256.6872s
	iters: 200, epoch: 7 | loss: 1.8384936
	speed: 0.0676s/iter; left time: 1307.4715s
Epoch: 7 cost time: 15.26772427558899
Epoch: 7, Steps: 208 | Train Loss: 2.610 Vali Loss: 5.061 Vali Acc: 0.082 Test Loss: 5.061 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0526884
	speed: 0.3540s/iter; left time: 6813.0128s
	iters: 200, epoch: 8 | loss: 1.9609303
	speed: 0.0683s/iter; left time: 1308.4951s
Epoch: 8 cost time: 15.237585544586182
Epoch: 8, Steps: 208 | Train Loss: 2.039 Vali Loss: 5.007 Vali Acc: 0.108 Test Loss: 5.007 Test Acc: 0.108
Validation loss decreased (-0.092111 --> -0.107615).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6006978
	speed: 0.3292s/iter; left time: 6266.8623s
	iters: 200, epoch: 9 | loss: 1.9184716
	speed: 0.0589s/iter; left time: 1114.5087s
Epoch: 9 cost time: 14.037498950958252
Epoch: 9, Steps: 208 | Train Loss: 1.719 Vali Loss: 6.285 Vali Acc: 0.076 Test Loss: 6.285 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2026105
	speed: 0.3232s/iter; left time: 6085.2873s
	iters: 200, epoch: 10 | loss: 1.1528022
	speed: 0.0636s/iter; left time: 1191.9042s
Epoch: 10 cost time: 14.454162836074829
Epoch: 10, Steps: 208 | Train Loss: 1.473 Vali Loss: 5.557 Vali Acc: 0.115 Test Loss: 5.557 Test Acc: 0.115
Validation loss decreased (-0.107615 --> -0.114767).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0808945
	speed: 0.2942s/iter; left time: 5477.7806s
	iters: 200, epoch: 11 | loss: 1.8511248
	speed: 0.0527s/iter; left time: 976.7517s
Epoch: 11 cost time: 11.63571047782898
Epoch: 11, Steps: 208 | Train Loss: 1.285 Vali Loss: 6.406 Vali Acc: 0.113 Test Loss: 6.406 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0358994
	speed: 0.3054s/iter; left time: 5623.4855s
	iters: 200, epoch: 12 | loss: 0.8718296
	speed: 0.0500s/iter; left time: 914.8391s
Epoch: 12 cost time: 11.73306155204773
Epoch: 12, Steps: 208 | Train Loss: 1.127 Vali Loss: 6.727 Vali Acc: 0.118 Test Loss: 6.727 Test Acc: 0.118
Validation loss decreased (-0.114767 --> -0.118036).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3317462
	speed: 0.2907s/iter; left time: 5292.3971s
	iters: 200, epoch: 13 | loss: 1.0726631
	speed: 0.0566s/iter; left time: 1024.5767s
Epoch: 13 cost time: 13.01077127456665
Epoch: 13, Steps: 208 | Train Loss: 0.963 Vali Loss: 7.330 Vali Acc: 0.110 Test Loss: 7.330 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7904615
	speed: 0.3136s/iter; left time: 5643.0295s
	iters: 200, epoch: 14 | loss: 1.2601670
	speed: 0.0564s/iter; left time: 1008.5256s
Epoch: 14 cost time: 12.803212642669678
Epoch: 14, Steps: 208 | Train Loss: 0.835 Vali Loss: 7.858 Vali Acc: 0.115 Test Loss: 7.858 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5313580
	speed: 0.2782s/iter; left time: 4948.0490s
	iters: 200, epoch: 15 | loss: 0.6742532
	speed: 0.0516s/iter; left time: 912.2182s
Epoch: 15 cost time: 11.882806062698364
Epoch: 15, Steps: 208 | Train Loss: 0.708 Vali Loss: 8.013 Vali Acc: 0.106 Test Loss: 8.013 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3619980
	speed: 0.3179s/iter; left time: 5588.7165s
	iters: 200, epoch: 16 | loss: 0.7411040
	speed: 0.0739s/iter; left time: 1291.3197s
Epoch: 16 cost time: 15.642230987548828
Epoch: 16, Steps: 208 | Train Loss: 0.583 Vali Loss: 9.153 Vali Acc: 0.121 Test Loss: 9.153 Test Acc: 0.121
Validation loss decreased (-0.118036 --> -0.120696).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1605223
	speed: 0.3580s/iter; left time: 6218.7133s
	iters: 200, epoch: 17 | loss: 0.2282274
	speed: 0.0723s/iter; left time: 1248.1539s
Epoch: 17 cost time: 16.306150436401367
Epoch: 17, Steps: 208 | Train Loss: 0.521 Vali Loss: 8.918 Vali Acc: 0.120 Test Loss: 8.918 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3495069
	speed: 0.3256s/iter; left time: 5588.3771s
	iters: 200, epoch: 18 | loss: 0.0943064
	speed: 0.0578s/iter; left time: 985.8742s
Epoch: 18 cost time: 12.774202823638916
Epoch: 18, Steps: 208 | Train Loss: 0.396 Vali Loss: 9.268 Vali Acc: 0.120 Test Loss: 9.268 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3141788
	speed: 0.3340s/iter; left time: 5663.6381s
	iters: 200, epoch: 19 | loss: 1.1228514
	speed: 0.0637s/iter; left time: 1073.9471s
Epoch: 19 cost time: 14.873984813690186
Epoch: 19, Steps: 208 | Train Loss: 0.390 Vali Loss: 10.260 Vali Acc: 0.119 Test Loss: 10.260 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3176461
	speed: 0.3408s/iter; left time: 5708.8364s
	iters: 200, epoch: 20 | loss: 0.2022001
	speed: 0.0623s/iter; left time: 1037.0463s
Epoch: 20 cost time: 14.085405349731445
Epoch: 20, Steps: 208 | Train Loss: 0.369 Vali Loss: 10.747 Vali Acc: 0.117 Test Loss: 10.747 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1778393
	speed: 0.3543s/iter; left time: 5859.8387s
	iters: 200, epoch: 21 | loss: 0.6879917
	speed: 0.0589s/iter; left time: 967.6070s
Epoch: 21 cost time: 14.924753904342651
Epoch: 21, Steps: 208 | Train Loss: 0.289 Vali Loss: 10.674 Vali Acc: 0.119 Test Loss: 10.674 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2698559
	speed: 0.2975s/iter; left time: 4858.4898s
	iters: 200, epoch: 22 | loss: 0.1711961
	speed: 0.0590s/iter; left time: 957.8457s
Epoch: 22 cost time: 13.45610785484314
Epoch: 22, Steps: 208 | Train Loss: 0.238 Vali Loss: 11.504 Vali Acc: 0.109 Test Loss: 11.504 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.4055319
	speed: 0.2945s/iter; left time: 4748.5325s
	iters: 200, epoch: 23 | loss: 0.3450745
	speed: 0.0521s/iter; left time: 835.5474s
Epoch: 23 cost time: 12.390382289886475
Epoch: 23, Steps: 208 | Train Loss: 0.280 Vali Loss: 11.194 Vali Acc: 0.115 Test Loss: 11.194 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0793377
	speed: 0.2840s/iter; left time: 4520.8730s
	iters: 200, epoch: 24 | loss: 0.0381964
	speed: 0.0476s/iter; left time: 753.0757s
Epoch: 24 cost time: 11.828743696212769
Epoch: 24, Steps: 208 | Train Loss: 0.212 Vali Loss: 12.049 Vali Acc: 0.116 Test Loss: 12.049 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2423341
	speed: 0.3112s/iter; left time: 4888.9110s
	iters: 200, epoch: 25 | loss: 0.0989760
	speed: 0.0534s/iter; left time: 833.9605s
Epoch: 25 cost time: 12.259068012237549
Epoch: 25, Steps: 208 | Train Loss: 0.164 Vali Loss: 12.720 Vali Acc: 0.113 Test Loss: 12.720 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1137935
	speed: 0.3119s/iter; left time: 4834.6088s
	iters: 200, epoch: 26 | loss: 0.0784860
	speed: 0.0604s/iter; left time: 929.8022s
Epoch: 26 cost time: 12.499451398849487
Epoch: 26, Steps: 208 | Train Loss: 0.176 Vali Loss: 12.955 Vali Acc: 0.111 Test Loss: 12.955 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1207873546078139
model parameter : 1014119
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4460826
	speed: 0.1363s/iter; left time: 2821.0351s
	iters: 200, epoch: 1 | loss: 4.1144724
	speed: 0.0831s/iter; left time: 1712.0326s
Epoch: 1 cost time: 22.875304460525513
Epoch: 1, Steps: 208 | Train Loss: 4.054 Vali Loss: 4.070 Vali Acc: 0.054 Test Loss: 4.070 Test Acc: 0.054
Validation loss decreased (inf --> -0.053941).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4245033
	speed: 0.3697s/iter; left time: 7575.7935s
	iters: 200, epoch: 2 | loss: 3.2781124
	speed: 0.0744s/iter; left time: 1517.4099s
Epoch: 2 cost time: 17.044702768325806
Epoch: 2, Steps: 208 | Train Loss: 3.640 Vali Loss: 3.653 Vali Acc: 0.079 Test Loss: 3.653 Test Acc: 0.079
Validation loss decreased (-0.053941 --> -0.078997).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3187840
	speed: 0.3672s/iter; left time: 7448.2610s
	iters: 200, epoch: 3 | loss: 4.0920062
	speed: 0.0922s/iter; left time: 1861.6380s
Epoch: 3 cost time: 20.147905111312866
Epoch: 3, Steps: 208 | Train Loss: 3.238 Vali Loss: 4.027 Vali Acc: 0.083 Test Loss: 4.027 Test Acc: 0.083
Validation loss decreased (-0.078997 --> -0.083169).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3315063
	speed: 0.4026s/iter; left time: 8083.6574s
	iters: 200, epoch: 4 | loss: 3.1996901
	speed: 0.0949s/iter; left time: 1896.6276s
Epoch: 4 cost time: 22.575135231018066
Epoch: 4, Steps: 208 | Train Loss: 3.114 Vali Loss: 3.880 Vali Acc: 0.089 Test Loss: 3.880 Test Acc: 0.089
Validation loss decreased (-0.083169 --> -0.088539).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1143911
	speed: 0.3509s/iter; left time: 6972.8280s
	iters: 200, epoch: 5 | loss: 3.4309869
	speed: 0.0543s/iter; left time: 1073.2163s
Epoch: 5 cost time: 13.876360654830933
Epoch: 5, Steps: 208 | Train Loss: 3.018 Vali Loss: 4.693 Vali Acc: 0.067 Test Loss: 4.693 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9982817
	speed: 0.3231s/iter; left time: 6352.5902s
	iters: 200, epoch: 6 | loss: 2.4848325
	speed: 0.0587s/iter; left time: 1147.9648s
Epoch: 6 cost time: 14.088270664215088
Epoch: 6, Steps: 208 | Train Loss: 2.806 Vali Loss: 4.367 Vali Acc: 0.109 Test Loss: 4.367 Test Acc: 0.109
Validation loss decreased (-0.088539 --> -0.108516).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5884490
	speed: 0.3027s/iter; left time: 5889.0448s
	iters: 200, epoch: 7 | loss: 3.7413187
	speed: 0.0518s/iter; left time: 1001.9784s
Epoch: 7 cost time: 12.711989164352417
Epoch: 7, Steps: 208 | Train Loss: 2.568 Vali Loss: 4.457 Vali Acc: 0.102 Test Loss: 4.457 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1964716
	speed: 0.3144s/iter; left time: 6050.9191s
	iters: 200, epoch: 8 | loss: 2.7929561
	speed: 0.0469s/iter; left time: 898.4335s
Epoch: 8 cost time: 11.451769590377808
Epoch: 8, Steps: 208 | Train Loss: 2.229 Vali Loss: 4.990 Vali Acc: 0.103 Test Loss: 4.990 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9375280
	speed: 0.3282s/iter; left time: 6247.1029s
	iters: 200, epoch: 9 | loss: 2.4616041
	speed: 0.0514s/iter; left time: 973.5452s
Epoch: 9 cost time: 12.442674398422241
Epoch: 9, Steps: 208 | Train Loss: 1.930 Vali Loss: 4.783 Vali Acc: 0.122 Test Loss: 4.783 Test Acc: 0.122
Validation loss decreased (-0.108516 --> -0.121634).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8916202
	speed: 0.2885s/iter; left time: 5432.4762s
	iters: 200, epoch: 10 | loss: 2.1653390
	speed: 0.0481s/iter; left time: 901.1087s
Epoch: 10 cost time: 11.336856126785278
Epoch: 10, Steps: 208 | Train Loss: 1.724 Vali Loss: 5.144 Vali Acc: 0.108 Test Loss: 5.144 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1369843
	speed: 0.3146s/iter; left time: 5859.0382s
	iters: 200, epoch: 11 | loss: 2.0479422
	speed: 0.0589s/iter; left time: 1090.0569s
Epoch: 11 cost time: 14.015806674957275
Epoch: 11, Steps: 208 | Train Loss: 1.518 Vali Loss: 4.987 Vali Acc: 0.123 Test Loss: 4.987 Test Acc: 0.123
Validation loss decreased (-0.121634 --> -0.123422).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9688165
	speed: 0.3572s/iter; left time: 6576.4266s
	iters: 200, epoch: 12 | loss: 1.4624912
	speed: 0.0808s/iter; left time: 1479.5091s
Epoch: 12 cost time: 18.754067420959473
Epoch: 12, Steps: 208 | Train Loss: 1.311 Vali Loss: 5.718 Vali Acc: 0.122 Test Loss: 5.718 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3673126
	speed: 0.3391s/iter; left time: 6172.6619s
	iters: 200, epoch: 13 | loss: 1.5584390
	speed: 0.0962s/iter; left time: 1742.2147s
Epoch: 13 cost time: 19.12386155128479
Epoch: 13, Steps: 208 | Train Loss: 1.116 Vali Loss: 6.163 Vali Acc: 0.125 Test Loss: 6.163 Test Acc: 0.125
Validation loss decreased (-0.123422 --> -0.125199).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9858105
	speed: 0.3562s/iter; left time: 6410.4063s
	iters: 200, epoch: 14 | loss: 0.5446566
	speed: 0.0982s/iter; left time: 1756.7386s
Epoch: 14 cost time: 19.78105139732361
Epoch: 14, Steps: 208 | Train Loss: 0.967 Vali Loss: 6.759 Vali Acc: 0.127 Test Loss: 6.759 Test Acc: 0.127
Validation loss decreased (-0.125199 --> -0.126685).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0804245
	speed: 0.3447s/iter; left time: 6132.6417s
	iters: 200, epoch: 15 | loss: 0.7634038
	speed: 0.0654s/iter; left time: 1157.2936s
Epoch: 15 cost time: 14.889159917831421
Epoch: 15, Steps: 208 | Train Loss: 0.858 Vali Loss: 7.578 Vali Acc: 0.125 Test Loss: 7.578 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4062385
	speed: 0.3349s/iter; left time: 5887.0715s
	iters: 200, epoch: 16 | loss: 1.3458661
	speed: 0.0617s/iter; left time: 1079.3294s
Epoch: 16 cost time: 13.900750637054443
Epoch: 16, Steps: 208 | Train Loss: 0.754 Vali Loss: 7.924 Vali Acc: 0.127 Test Loss: 7.924 Test Acc: 0.127
Validation loss decreased (-0.126685 --> -0.126971).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4953614
	speed: 0.3548s/iter; left time: 6163.7987s
	iters: 200, epoch: 17 | loss: 0.5649850
	speed: 0.0660s/iter; left time: 1139.2548s
Epoch: 17 cost time: 15.310202360153198
Epoch: 17, Steps: 208 | Train Loss: 0.694 Vali Loss: 7.977 Vali Acc: 0.126 Test Loss: 7.977 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6427101
	speed: 0.3393s/iter; left time: 5824.0833s
	iters: 200, epoch: 18 | loss: 1.1485891
	speed: 0.0560s/iter; left time: 955.9443s
Epoch: 18 cost time: 13.81380295753479
Epoch: 18, Steps: 208 | Train Loss: 0.564 Vali Loss: 8.614 Vali Acc: 0.120 Test Loss: 8.614 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3011991
	speed: 0.3299s/iter; left time: 5594.8307s
	iters: 200, epoch: 19 | loss: 0.5748657
	speed: 0.0508s/iter; left time: 856.2468s
Epoch: 19 cost time: 12.259060621261597
Epoch: 19, Steps: 208 | Train Loss: 0.503 Vali Loss: 8.604 Vali Acc: 0.117 Test Loss: 8.604 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2407570
	speed: 0.3636s/iter; left time: 6090.3101s
	iters: 200, epoch: 20 | loss: 0.0820520
	speed: 0.0750s/iter; left time: 1249.0137s
Epoch: 20 cost time: 18.06609058380127
Epoch: 20, Steps: 208 | Train Loss: 0.493 Vali Loss: 8.873 Vali Acc: 0.119 Test Loss: 8.873 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2824352
	speed: 0.3740s/iter; left time: 6187.0402s
	iters: 200, epoch: 21 | loss: 0.5127837
	speed: 0.0681s/iter; left time: 1118.9629s
Epoch: 21 cost time: 16.118982076644897
Epoch: 21, Steps: 208 | Train Loss: 0.434 Vali Loss: 9.416 Vali Acc: 0.119 Test Loss: 9.416 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.5315291
	speed: 0.3761s/iter; left time: 6143.5495s
	iters: 200, epoch: 22 | loss: 0.4062203
	speed: 0.0705s/iter; left time: 1144.7562s
Epoch: 22 cost time: 17.44839572906494
Epoch: 22, Steps: 208 | Train Loss: 0.400 Vali Loss: 9.742 Vali Acc: 0.122 Test Loss: 9.742 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.1780887
	speed: 0.3748s/iter; left time: 6043.0832s
	iters: 200, epoch: 23 | loss: 0.5778973
	speed: 0.0618s/iter; left time: 991.0025s
Epoch: 23 cost time: 16.25293779373169
Epoch: 23, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.933 Vali Acc: 0.117 Test Loss: 9.933 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1519098
	speed: 0.3603s/iter; left time: 5734.9785s
	iters: 200, epoch: 24 | loss: 0.6180460
	speed: 0.0548s/iter; left time: 867.2965s
Epoch: 24 cost time: 14.666624546051025
Epoch: 24, Steps: 208 | Train Loss: 0.340 Vali Loss: 10.498 Vali Acc: 0.120 Test Loss: 10.498 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.3573224
	speed: 0.3433s/iter; left time: 5393.0625s
	iters: 200, epoch: 25 | loss: 0.1266418
	speed: 0.0570s/iter; left time: 889.6011s
Epoch: 25 cost time: 15.024391651153564
Epoch: 25, Steps: 208 | Train Loss: 0.335 Vali Loss: 10.943 Vali Acc: 0.123 Test Loss: 10.943 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2331984
	speed: 0.3595s/iter; left time: 5572.1096s
	iters: 200, epoch: 26 | loss: 0.2951435
	speed: 0.0561s/iter; left time: 864.1661s
Epoch: 26 cost time: 13.811477661132812
Epoch: 26, Steps: 208 | Train Loss: 0.296 Vali Loss: 11.875 Vali Acc: 0.111 Test Loss: 11.875 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12705040262451536
model parameter : 520071
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0811949
	speed: 0.1503s/iter; left time: 3111.4578s
	iters: 200, epoch: 1 | loss: 3.7206309
	speed: 0.0675s/iter; left time: 1391.5424s
Epoch: 1 cost time: 22.674250602722168
Epoch: 1, Steps: 208 | Train Loss: 3.933 Vali Loss: 4.042 Vali Acc: 0.061 Test Loss: 4.042 Test Acc: 0.061
Validation loss decreased (inf --> -0.060502).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2489905
	speed: 0.3763s/iter; left time: 7711.9441s
	iters: 200, epoch: 2 | loss: 4.5071273
	speed: 0.0710s/iter; left time: 1448.4197s
Epoch: 2 cost time: 17.567033767700195
Epoch: 2, Steps: 208 | Train Loss: 3.556 Vali Loss: 3.782 Vali Acc: 0.077 Test Loss: 3.782 Test Acc: 0.077
Validation loss decreased (-0.060502 --> -0.076908).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1957827
	speed: 0.3952s/iter; left time: 8017.1867s
	iters: 200, epoch: 3 | loss: 2.4994419
	speed: 0.0756s/iter; left time: 1525.0946s
Epoch: 3 cost time: 17.635371923446655
Epoch: 3, Steps: 208 | Train Loss: 3.209 Vali Loss: 3.940 Vali Acc: 0.085 Test Loss: 3.940 Test Acc: 0.085
Validation loss decreased (-0.076908 --> -0.085257).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1244841
	speed: 0.3736s/iter; left time: 7500.7158s
	iters: 200, epoch: 4 | loss: 4.2013774
	speed: 0.0623s/iter; left time: 1243.9473s
Epoch: 4 cost time: 15.056901693344116
Epoch: 4, Steps: 208 | Train Loss: 2.982 Vali Loss: 3.808 Vali Acc: 0.107 Test Loss: 3.808 Test Acc: 0.107
Validation loss decreased (-0.085257 --> -0.107328).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8048935
	speed: 0.3325s/iter; left time: 6606.1693s
	iters: 200, epoch: 5 | loss: 3.6456172
	speed: 0.0601s/iter; left time: 1187.7113s
Epoch: 5 cost time: 14.32051157951355
Epoch: 5, Steps: 208 | Train Loss: 2.817 Vali Loss: 4.175 Vali Acc: 0.103 Test Loss: 4.175 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1962042
	speed: 0.3099s/iter; left time: 6092.6196s
	iters: 200, epoch: 6 | loss: 2.8848662
	speed: 0.0486s/iter; left time: 951.0816s
Epoch: 6 cost time: 11.669165134429932
Epoch: 6, Steps: 208 | Train Loss: 2.730 Vali Loss: 4.241 Vali Acc: 0.106 Test Loss: 4.241 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0431597
	speed: 0.3007s/iter; left time: 5849.6162s
	iters: 200, epoch: 7 | loss: 2.7958474
	speed: 0.0440s/iter; left time: 852.1942s
Epoch: 7 cost time: 11.083323240280151
Epoch: 7, Steps: 208 | Train Loss: 2.517 Vali Loss: 4.632 Vali Acc: 0.101 Test Loss: 4.632 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.6078069
	speed: 0.3063s/iter; left time: 5895.2451s
	iters: 200, epoch: 8 | loss: 3.3052454
	speed: 0.0563s/iter; left time: 1078.0135s
Epoch: 8 cost time: 12.685388565063477
Epoch: 8, Steps: 208 | Train Loss: 2.308 Vali Loss: 4.493 Vali Acc: 0.115 Test Loss: 4.493 Test Acc: 0.115
Validation loss decreased (-0.107328 --> -0.114479).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2465451
	speed: 0.3296s/iter; left time: 6273.7754s
	iters: 200, epoch: 9 | loss: 2.2798738
	speed: 0.0551s/iter; left time: 1044.3166s
Epoch: 9 cost time: 12.50020956993103
Epoch: 9, Steps: 208 | Train Loss: 2.123 Vali Loss: 4.917 Vali Acc: 0.107 Test Loss: 4.917 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9954089
	speed: 0.3448s/iter; left time: 6492.7693s
	iters: 200, epoch: 10 | loss: 2.1221602
	speed: 0.0719s/iter; left time: 1345.6831s
Epoch: 10 cost time: 16.092557907104492
Epoch: 10, Steps: 208 | Train Loss: 1.892 Vali Loss: 4.653 Vali Acc: 0.116 Test Loss: 4.653 Test Acc: 0.116
Validation loss decreased (-0.114479 --> -0.116267).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7501380
	speed: 0.3350s/iter; left time: 6237.7887s
	iters: 200, epoch: 11 | loss: 2.2464910
	speed: 0.0615s/iter; left time: 1138.4400s
Epoch: 11 cost time: 14.580697774887085
Epoch: 11, Steps: 208 | Train Loss: 1.699 Vali Loss: 5.179 Vali Acc: 0.110 Test Loss: 5.179 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8947750
	speed: 0.3500s/iter; left time: 6444.5957s
	iters: 200, epoch: 12 | loss: 1.8281013
	speed: 0.0728s/iter; left time: 1333.8672s
Epoch: 12 cost time: 16.707022666931152
Epoch: 12, Steps: 208 | Train Loss: 1.537 Vali Loss: 5.410 Vali Acc: 0.111 Test Loss: 5.410 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5246140
	speed: 0.3533s/iter; left time: 6431.5258s
	iters: 200, epoch: 13 | loss: 2.6941755
	speed: 0.0768s/iter; left time: 1389.9734s
Epoch: 13 cost time: 17.743602991104126
Epoch: 13, Steps: 208 | Train Loss: 1.385 Vali Loss: 5.535 Vali Acc: 0.118 Test Loss: 5.535 Test Acc: 0.118
Validation loss decreased (-0.116267 --> -0.118346).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2148832
	speed: 0.3555s/iter; left time: 6398.0614s
	iters: 200, epoch: 14 | loss: 1.3406572
	speed: 0.0669s/iter; left time: 1197.0247s
Epoch: 14 cost time: 16.713744401931763
Epoch: 14, Steps: 208 | Train Loss: 1.214 Vali Loss: 5.882 Vali Acc: 0.112 Test Loss: 5.882 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2209713
	speed: 0.3596s/iter; left time: 6397.6615s
	iters: 200, epoch: 15 | loss: 1.5008595
	speed: 0.0484s/iter; left time: 856.0446s
Epoch: 15 cost time: 13.3544282913208
Epoch: 15, Steps: 208 | Train Loss: 1.086 Vali Loss: 6.304 Vali Acc: 0.109 Test Loss: 6.304 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7680144
	speed: 0.3334s/iter; left time: 5861.5520s
	iters: 200, epoch: 16 | loss: 1.8529856
	speed: 0.0502s/iter; left time: 876.9901s
Epoch: 16 cost time: 12.454892873764038
Epoch: 16, Steps: 208 | Train Loss: 0.958 Vali Loss: 6.396 Vali Acc: 0.115 Test Loss: 6.396 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4081797
	speed: 0.3290s/iter; left time: 5714.8597s
	iters: 200, epoch: 17 | loss: 1.5625381
	speed: 0.0581s/iter; left time: 1003.1405s
Epoch: 17 cost time: 14.246472120285034
Epoch: 17, Steps: 208 | Train Loss: 0.865 Vali Loss: 6.706 Vali Acc: 0.113 Test Loss: 6.706 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3337404
	speed: 0.3500s/iter; left time: 6007.4073s
	iters: 200, epoch: 18 | loss: 1.4311906
	speed: 0.0500s/iter; left time: 853.7136s
Epoch: 18 cost time: 14.698169469833374
Epoch: 18, Steps: 208 | Train Loss: 0.770 Vali Loss: 7.138 Vali Acc: 0.115 Test Loss: 7.138 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4497370
	speed: 0.3384s/iter; left time: 5738.8430s
	iters: 200, epoch: 19 | loss: 0.7948706
	speed: 0.0595s/iter; left time: 1002.7402s
Epoch: 19 cost time: 15.795031309127808
Epoch: 19, Steps: 208 | Train Loss: 0.696 Vali Loss: 7.490 Vali Acc: 0.118 Test Loss: 7.490 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7483523
	speed: 0.3734s/iter; left time: 6254.5378s
	iters: 200, epoch: 20 | loss: 0.7245225
	speed: 0.0749s/iter; left time: 1246.8707s
Epoch: 20 cost time: 18.85159182548523
Epoch: 20, Steps: 208 | Train Loss: 0.632 Vali Loss: 7.946 Vali Acc: 0.118 Test Loss: 7.946 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2570339
	speed: 0.3568s/iter; left time: 5901.1316s
	iters: 200, epoch: 21 | loss: 0.3341018
	speed: 0.0768s/iter; left time: 1263.3206s
Epoch: 21 cost time: 18.427863597869873
Epoch: 21, Steps: 208 | Train Loss: 0.588 Vali Loss: 8.182 Vali Acc: 0.111 Test Loss: 8.182 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.5619683
	speed: 0.3772s/iter; left time: 6160.8512s
	iters: 200, epoch: 22 | loss: 0.9372344
	speed: 0.0736s/iter; left time: 1195.1143s
Epoch: 22 cost time: 17.97018527984619
Epoch: 22, Steps: 208 | Train Loss: 0.525 Vali Loss: 8.523 Vali Acc: 0.117 Test Loss: 8.523 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.5118788
	speed: 0.3718s/iter; left time: 5995.5607s
	iters: 200, epoch: 23 | loss: 0.4319819
	speed: 0.0722s/iter; left time: 1157.6295s
Epoch: 23 cost time: 18.202006816864014
Epoch: 23, Steps: 208 | Train Loss: 0.497 Vali Loss: 9.331 Vali Acc: 0.111 Test Loss: 9.331 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11840143155383238
model parameter : 355527
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7265348
	speed: 0.0769s/iter; left time: 1592.4686s
	iters: 200, epoch: 1 | loss: 3.9134085
	speed: 0.0458s/iter; left time: 943.9190s
Epoch: 1 cost time: 12.725778579711914
Epoch: 1, Steps: 208 | Train Loss: 3.863 Vali Loss: 3.965 Vali Acc: 0.055 Test Loss: 3.965 Test Acc: 0.055
Validation loss decreased (inf --> -0.055433).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5207028
	speed: 0.2562s/iter; left time: 5249.9624s
	iters: 200, epoch: 2 | loss: 3.2784822
	speed: 0.0445s/iter; left time: 906.9259s
Epoch: 2 cost time: 10.37066912651062
Epoch: 2, Steps: 208 | Train Loss: 3.572 Vali Loss: 3.831 Vali Acc: 0.081 Test Loss: 3.831 Test Acc: 0.081
Validation loss decreased (-0.055433 --> -0.080785).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3219507
	speed: 0.2473s/iter; left time: 5017.3544s
	iters: 200, epoch: 3 | loss: 3.4196868
	speed: 0.0398s/iter; left time: 802.8088s
Epoch: 3 cost time: 9.543880939483643
Epoch: 3, Steps: 208 | Train Loss: 3.227 Vali Loss: 4.120 Vali Acc: 0.085 Test Loss: 4.120 Test Acc: 0.085
Validation loss decreased (-0.080785 --> -0.084957).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2517307
	speed: 0.2438s/iter; left time: 4895.0380s
	iters: 200, epoch: 4 | loss: 2.9471045
	speed: 0.0415s/iter; left time: 828.0825s
Epoch: 4 cost time: 9.907918930053711
Epoch: 4, Steps: 208 | Train Loss: 3.024 Vali Loss: 4.121 Vali Acc: 0.097 Test Loss: 4.121 Test Acc: 0.097
Validation loss decreased (-0.084957 --> -0.096887).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7355576
	speed: 0.2541s/iter; left time: 5048.1649s
	iters: 200, epoch: 5 | loss: 2.9633195
	speed: 0.0417s/iter; left time: 823.8653s
Epoch: 5 cost time: 9.844044923782349
Epoch: 5, Steps: 208 | Train Loss: 2.841 Vali Loss: 4.346 Vali Acc: 0.104 Test Loss: 4.346 Test Acc: 0.104
Validation loss decreased (-0.096887 --> -0.103744).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8688750
	speed: 0.2765s/iter; left time: 5435.4278s
	iters: 200, epoch: 6 | loss: 3.3190682
	speed: 0.0440s/iter; left time: 861.5980s
Epoch: 6 cost time: 10.80893874168396
Epoch: 6, Steps: 208 | Train Loss: 2.703 Vali Loss: 4.318 Vali Acc: 0.103 Test Loss: 4.318 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0383720
	speed: 0.3037s/iter; left time: 5907.6594s
	iters: 200, epoch: 7 | loss: 2.7780130
	speed: 0.0600s/iter; left time: 1162.0549s
Epoch: 7 cost time: 13.419886827468872
Epoch: 7, Steps: 208 | Train Loss: 2.525 Vali Loss: 4.435 Vali Acc: 0.105 Test Loss: 4.435 Test Acc: 0.105
Validation loss decreased (-0.103744 --> -0.105234).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5318527
	speed: 0.3017s/iter; left time: 5806.2238s
	iters: 200, epoch: 8 | loss: 2.4781022
	speed: 0.0516s/iter; left time: 988.6966s
Epoch: 8 cost time: 11.054861307144165
Epoch: 8, Steps: 208 | Train Loss: 2.369 Vali Loss: 4.374 Vali Acc: 0.108 Test Loss: 4.374 Test Acc: 0.108
Validation loss decreased (-0.105234 --> -0.108218).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8619896
	speed: 0.2792s/iter; left time: 5314.5782s
	iters: 200, epoch: 9 | loss: 2.2549107
	speed: 0.0516s/iter; left time: 977.0486s
Epoch: 9 cost time: 10.890516519546509
Epoch: 9, Steps: 208 | Train Loss: 2.164 Vali Loss: 4.488 Vali Acc: 0.110 Test Loss: 4.488 Test Acc: 0.110
Validation loss decreased (-0.108218 --> -0.109708).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0364280
	speed: 0.2724s/iter; left time: 5129.2987s
	iters: 200, epoch: 10 | loss: 2.7174585
	speed: 0.0467s/iter; left time: 874.1479s
Epoch: 10 cost time: 10.42819094657898
Epoch: 10, Steps: 208 | Train Loss: 1.982 Vali Loss: 4.615 Vali Acc: 0.125 Test Loss: 4.615 Test Acc: 0.125
Validation loss decreased (-0.109708 --> -0.125215).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4853495
	speed: 0.2874s/iter; left time: 5351.3539s
	iters: 200, epoch: 11 | loss: 2.6191082
	speed: 0.0499s/iter; left time: 923.7784s
Epoch: 11 cost time: 11.448891639709473
Epoch: 11, Steps: 208 | Train Loss: 1.807 Vali Loss: 4.773 Vali Acc: 0.115 Test Loss: 4.773 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8656865
	speed: 0.2670s/iter; left time: 4915.4128s
	iters: 200, epoch: 12 | loss: 1.6795861
	speed: 0.0375s/iter; left time: 686.0584s
Epoch: 12 cost time: 9.034369945526123
Epoch: 12, Steps: 208 | Train Loss: 1.644 Vali Loss: 4.950 Vali Acc: 0.109 Test Loss: 4.950 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.8616880
	speed: 0.2330s/iter; left time: 4242.1874s
	iters: 200, epoch: 13 | loss: 1.4840406
	speed: 0.0404s/iter; left time: 732.1700s
Epoch: 13 cost time: 9.044685125350952
Epoch: 13, Steps: 208 | Train Loss: 1.469 Vali Loss: 5.287 Vali Acc: 0.120 Test Loss: 5.287 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6191378
	speed: 0.2292s/iter; left time: 4124.7564s
	iters: 200, epoch: 14 | loss: 1.6031531
	speed: 0.0407s/iter; left time: 729.2102s
Epoch: 14 cost time: 9.12189769744873
Epoch: 14, Steps: 208 | Train Loss: 1.335 Vali Loss: 5.501 Vali Acc: 0.125 Test Loss: 5.501 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3890333
	speed: 0.2412s/iter; left time: 4290.4719s
	iters: 200, epoch: 15 | loss: 1.0687959
	speed: 0.0431s/iter; left time: 761.8735s
Epoch: 15 cost time: 10.082226037979126
Epoch: 15, Steps: 208 | Train Loss: 1.170 Vali Loss: 5.721 Vali Acc: 0.116 Test Loss: 5.721 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.6589242
	speed: 0.2498s/iter; left time: 4391.8257s
	iters: 200, epoch: 16 | loss: 1.7100755
	speed: 0.0403s/iter; left time: 704.1831s
Epoch: 16 cost time: 9.682069301605225
Epoch: 16, Steps: 208 | Train Loss: 1.076 Vali Loss: 5.985 Vali Acc: 0.113 Test Loss: 5.985 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.7781748
	speed: 0.2394s/iter; left time: 4158.8808s
	iters: 200, epoch: 17 | loss: 1.2219797
	speed: 0.0411s/iter; left time: 710.6100s
Epoch: 17 cost time: 9.5725998878479
Epoch: 17, Steps: 208 | Train Loss: 0.963 Vali Loss: 6.377 Vali Acc: 0.123 Test Loss: 6.377 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.4264142
	speed: 0.2266s/iter; left time: 3888.8548s
	iters: 200, epoch: 18 | loss: 1.4324859
	speed: 0.0394s/iter; left time: 671.9454s
Epoch: 18 cost time: 9.128473997116089
Epoch: 18, Steps: 208 | Train Loss: 0.878 Vali Loss: 6.692 Vali Acc: 0.118 Test Loss: 6.692 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.6771882
	speed: 0.2635s/iter; left time: 4467.7177s
	iters: 200, epoch: 19 | loss: 0.9662080
	speed: 0.0432s/iter; left time: 728.9412s
Epoch: 19 cost time: 10.264766931533813
Epoch: 19, Steps: 208 | Train Loss: 0.766 Vali Loss: 7.163 Vali Acc: 0.125 Test Loss: 7.163 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.3959942
	speed: 0.2695s/iter; left time: 4513.0775s
	iters: 200, epoch: 20 | loss: 0.4949189
	speed: 0.0440s/iter; left time: 732.6724s
Epoch: 20 cost time: 10.71896767616272
Epoch: 20, Steps: 208 | Train Loss: 0.685 Vali Loss: 7.482 Vali Acc: 0.120 Test Loss: 7.482 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12526096033402923
model parameter : 287047
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7141194
	speed: 0.0727s/iter; left time: 1505.2368s
	iters: 200, epoch: 1 | loss: 3.8480968
	speed: 0.0450s/iter; left time: 927.3628s
Epoch: 1 cost time: 12.200702905654907
Epoch: 1, Steps: 208 | Train Loss: 3.810 Vali Loss: 3.828 Vali Acc: 0.054 Test Loss: 3.828 Test Acc: 0.054
Validation loss decreased (inf --> -0.053645).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3606286
	speed: 0.2588s/iter; left time: 5302.6383s
	iters: 200, epoch: 2 | loss: 3.5665681
	speed: 0.0436s/iter; left time: 888.3301s
Epoch: 2 cost time: 10.434196710586548
Epoch: 2, Steps: 208 | Train Loss: 3.580 Vali Loss: 3.774 Vali Acc: 0.071 Test Loss: 3.774 Test Acc: 0.071
Validation loss decreased (-0.053645 --> -0.070943).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1311779
	speed: 0.2436s/iter; left time: 4942.2721s
	iters: 200, epoch: 3 | loss: 3.2348342
	speed: 0.0431s/iter; left time: 870.0682s
Epoch: 3 cost time: 9.604358196258545
Epoch: 3, Steps: 208 | Train Loss: 3.284 Vali Loss: 3.809 Vali Acc: 0.080 Test Loss: 3.809 Test Acc: 0.080
Validation loss decreased (-0.070943 --> -0.079592).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3765793
	speed: 0.2306s/iter; left time: 4629.5057s
	iters: 200, epoch: 4 | loss: 3.7157722
	speed: 0.0383s/iter; left time: 765.0764s
Epoch: 4 cost time: 8.936219453811646
Epoch: 4, Steps: 208 | Train Loss: 3.068 Vali Loss: 3.908 Vali Acc: 0.088 Test Loss: 3.908 Test Acc: 0.088
Validation loss decreased (-0.079592 --> -0.087644).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6883621
	speed: 0.2423s/iter; left time: 4813.4083s
	iters: 200, epoch: 5 | loss: 3.0986304
	speed: 0.0406s/iter; left time: 802.9236s
Epoch: 5 cost time: 9.027760028839111
Epoch: 5, Steps: 208 | Train Loss: 2.906 Vali Loss: 4.047 Vali Acc: 0.093 Test Loss: 4.047 Test Acc: 0.093
Validation loss decreased (-0.087644 --> -0.093309).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0963881
	speed: 0.2405s/iter; left time: 4728.6199s
	iters: 200, epoch: 6 | loss: 2.3845778
	speed: 0.0471s/iter; left time: 920.7092s
Epoch: 6 cost time: 10.019710063934326
Epoch: 6, Steps: 208 | Train Loss: 2.755 Vali Loss: 4.141 Vali Acc: 0.090 Test Loss: 4.141 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.9048610
	speed: 0.2562s/iter; left time: 4984.1426s
	iters: 200, epoch: 7 | loss: 3.2311382
	speed: 0.0381s/iter; left time: 737.7199s
Epoch: 7 cost time: 9.624569416046143
Epoch: 7, Steps: 208 | Train Loss: 2.609 Vali Loss: 4.257 Vali Acc: 0.104 Test Loss: 4.257 Test Acc: 0.104
Validation loss decreased (-0.093309 --> -0.103745).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2049370
	speed: 0.2523s/iter; left time: 4855.6296s
	iters: 200, epoch: 8 | loss: 3.2411454
	speed: 0.0449s/iter; left time: 858.7260s
Epoch: 8 cost time: 10.355220317840576
Epoch: 8, Steps: 208 | Train Loss: 2.459 Vali Loss: 4.310 Vali Acc: 0.110 Test Loss: 4.310 Test Acc: 0.110
Validation loss decreased (-0.103745 --> -0.110008).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3265204
	speed: 0.2491s/iter; left time: 4741.9788s
	iters: 200, epoch: 9 | loss: 2.0051286
	speed: 0.0409s/iter; left time: 775.3583s
Epoch: 9 cost time: 9.150697946548462
Epoch: 9, Steps: 208 | Train Loss: 2.325 Vali Loss: 4.328 Vali Acc: 0.112 Test Loss: 4.328 Test Acc: 0.112
Validation loss decreased (-0.110008 --> -0.112393).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8563513
	speed: 0.2487s/iter; left time: 4682.0432s
	iters: 200, epoch: 10 | loss: 2.4097977
	speed: 0.0412s/iter; left time: 772.2952s
Epoch: 10 cost time: 9.75241231918335
Epoch: 10, Steps: 208 | Train Loss: 2.202 Vali Loss: 4.431 Vali Acc: 0.103 Test Loss: 4.431 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9123631
	speed: 0.2642s/iter; left time: 4920.0981s
	iters: 200, epoch: 11 | loss: 2.4097846
	speed: 0.0497s/iter; left time: 921.2152s
Epoch: 11 cost time: 10.936557531356812
Epoch: 11, Steps: 208 | Train Loss: 2.018 Vali Loss: 4.679 Vali Acc: 0.100 Test Loss: 4.679 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3827519
	speed: 0.2709s/iter; left time: 4987.5814s
	iters: 200, epoch: 12 | loss: 1.5511436
	speed: 0.0455s/iter; left time: 834.1540s
Epoch: 12 cost time: 10.1233651638031
Epoch: 12, Steps: 208 | Train Loss: 1.871 Vali Loss: 4.711 Vali Acc: 0.111 Test Loss: 4.711 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.9329228
	speed: 0.2504s/iter; left time: 4558.1506s
	iters: 200, epoch: 13 | loss: 2.2138388
	speed: 0.0433s/iter; left time: 783.3309s
Epoch: 13 cost time: 9.844653606414795
Epoch: 13, Steps: 208 | Train Loss: 1.740 Vali Loss: 5.048 Vali Acc: 0.107 Test Loss: 5.048 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.9569151
	speed: 0.2421s/iter; left time: 4356.4653s
	iters: 200, epoch: 14 | loss: 2.3194578
	speed: 0.0400s/iter; left time: 715.2936s
Epoch: 14 cost time: 9.16943621635437
Epoch: 14, Steps: 208 | Train Loss: 1.614 Vali Loss: 5.211 Vali Acc: 0.111 Test Loss: 5.211 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.9543149
	speed: 0.2665s/iter; left time: 4741.1693s
	iters: 200, epoch: 15 | loss: 1.4753598
	speed: 0.0466s/iter; left time: 823.6019s
Epoch: 15 cost time: 10.579632043838501
Epoch: 15, Steps: 208 | Train Loss: 1.480 Vali Loss: 5.434 Vali Acc: 0.105 Test Loss: 5.434 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.4621167
	speed: 0.2312s/iter; left time: 4064.9934s
	iters: 200, epoch: 16 | loss: 1.7644830
	speed: 0.0405s/iter; left time: 707.1352s
Epoch: 16 cost time: 8.7108633518219
Epoch: 16, Steps: 208 | Train Loss: 1.351 Vali Loss: 5.674 Vali Acc: 0.109 Test Loss: 5.674 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.5759770
	speed: 0.2314s/iter; left time: 4020.5840s
	iters: 200, epoch: 17 | loss: 1.8689311
	speed: 0.0364s/iter; left time: 628.4728s
Epoch: 17 cost time: 8.3384690284729
Epoch: 17, Steps: 208 | Train Loss: 1.215 Vali Loss: 5.879 Vali Acc: 0.108 Test Loss: 5.879 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.4857789
	speed: 0.2402s/iter; left time: 4123.6267s
	iters: 200, epoch: 18 | loss: 1.3275093
	speed: 0.0370s/iter; left time: 631.3706s
Epoch: 18 cost time: 8.892420053482056
Epoch: 18, Steps: 208 | Train Loss: 1.121 Vali Loss: 6.176 Vali Acc: 0.109 Test Loss: 6.176 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.6102111
	speed: 0.2237s/iter; left time: 3793.3614s
	iters: 200, epoch: 19 | loss: 1.1295245
	speed: 0.0403s/iter; left time: 679.9296s
Epoch: 19 cost time: 9.027050256729126
Epoch: 19, Steps: 208 | Train Loss: 1.029 Vali Loss: 6.533 Vali Acc: 0.108 Test Loss: 6.533 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11243662391887861
model parameter : 191303
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7125974
	speed: 0.0707s/iter; left time: 1463.7796s
	iters: 200, epoch: 1 | loss: 4.1013093
	speed: 0.0341s/iter; left time: 701.8990s
Epoch: 1 cost time: 10.783563375473022
Epoch: 1, Steps: 208 | Train Loss: 3.785 Vali Loss: 3.737 Vali Acc: 0.057 Test Loss: 3.737 Test Acc: 0.057
Validation loss decreased (inf --> -0.057225).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6547053
	speed: 0.2409s/iter; left time: 4937.7679s
	iters: 200, epoch: 2 | loss: 3.0909111
	speed: 0.0375s/iter; left time: 764.2581s
Epoch: 2 cost time: 8.999496936798096
Epoch: 2, Steps: 208 | Train Loss: 3.567 Vali Loss: 3.785 Vali Acc: 0.072 Test Loss: 3.785 Test Acc: 0.072
Validation loss decreased (-0.057225 --> -0.072136).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5758588
	speed: 0.2405s/iter; left time: 4879.2505s
	iters: 200, epoch: 3 | loss: 3.4951205
	speed: 0.0431s/iter; left time: 870.8202s
Epoch: 3 cost time: 10.486677169799805
Epoch: 3, Steps: 208 | Train Loss: 3.296 Vali Loss: 3.859 Vali Acc: 0.078 Test Loss: 3.859 Test Acc: 0.078
Validation loss decreased (-0.072136 --> -0.078399).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4142461
	speed: 0.2630s/iter; left time: 5279.8038s
	iters: 200, epoch: 4 | loss: 2.9960673
	speed: 0.0478s/iter; left time: 954.7076s
Epoch: 4 cost time: 11.117838144302368
Epoch: 4, Steps: 208 | Train Loss: 3.129 Vali Loss: 3.961 Vali Acc: 0.089 Test Loss: 3.961 Test Acc: 0.089
Validation loss decreased (-0.078399 --> -0.088538).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2936413
	speed: 0.2320s/iter; left time: 4610.3995s
	iters: 200, epoch: 5 | loss: 3.4415574
	speed: 0.0401s/iter; left time: 793.4033s
Epoch: 5 cost time: 9.071578025817871
Epoch: 5, Steps: 208 | Train Loss: 2.964 Vali Loss: 4.096 Vali Acc: 0.090 Test Loss: 4.096 Test Acc: 0.090
Validation loss decreased (-0.088538 --> -0.090028).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0969305
	speed: 0.2350s/iter; left time: 4620.1274s
	iters: 200, epoch: 6 | loss: 2.5999963
	speed: 0.0392s/iter; left time: 767.2352s
Epoch: 6 cost time: 9.016284942626953
Epoch: 6, Steps: 208 | Train Loss: 2.855 Vali Loss: 4.012 Vali Acc: 0.095 Test Loss: 4.012 Test Acc: 0.095
Validation loss decreased (-0.090028 --> -0.094502).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8799481
	speed: 0.2282s/iter; left time: 4439.8198s
	iters: 200, epoch: 7 | loss: 3.0760469
	speed: 0.0407s/iter; left time: 788.1995s
Epoch: 7 cost time: 9.166643857955933
Epoch: 7, Steps: 208 | Train Loss: 2.722 Vali Loss: 4.058 Vali Acc: 0.106 Test Loss: 4.058 Test Acc: 0.106
Validation loss decreased (-0.094502 --> -0.106133).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0020292
	speed: 0.2462s/iter; left time: 4737.3869s
	iters: 200, epoch: 8 | loss: 3.0696664
	speed: 0.0399s/iter; left time: 764.8421s
Epoch: 8 cost time: 9.301957607269287
Epoch: 8, Steps: 208 | Train Loss: 2.599 Vali Loss: 4.102 Vali Acc: 0.107 Test Loss: 4.102 Test Acc: 0.107
Validation loss decreased (-0.106133 --> -0.107326).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7174757
	speed: 0.2408s/iter; left time: 4583.2979s
	iters: 200, epoch: 9 | loss: 2.8056703
	speed: 0.0432s/iter; left time: 818.1964s
Epoch: 9 cost time: 8.821346759796143
Epoch: 9, Steps: 208 | Train Loss: 2.422 Vali Loss: 4.249 Vali Acc: 0.098 Test Loss: 4.249 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0235844
	speed: 0.2532s/iter; left time: 4767.0165s
	iters: 200, epoch: 10 | loss: 2.0676408
	speed: 0.0457s/iter; left time: 855.2190s
Epoch: 10 cost time: 10.434342622756958
Epoch: 10, Steps: 208 | Train Loss: 2.328 Vali Loss: 4.362 Vali Acc: 0.110 Test Loss: 4.362 Test Acc: 0.110
Validation loss decreased (-0.107326 --> -0.109709).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.9668262
	speed: 0.2492s/iter; left time: 4639.4682s
	iters: 200, epoch: 11 | loss: 2.1000566
	speed: 0.0402s/iter; left time: 744.6564s
Epoch: 11 cost time: 9.607010841369629
Epoch: 11, Steps: 208 | Train Loss: 2.168 Vali Loss: 4.462 Vali Acc: 0.112 Test Loss: 4.462 Test Acc: 0.112
Validation loss decreased (-0.109709 --> -0.111497).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9724333
	speed: 0.2291s/iter; left time: 4217.6076s
	iters: 200, epoch: 12 | loss: 1.7707273
	speed: 0.0351s/iter; left time: 642.8500s
Epoch: 12 cost time: 8.527344703674316
Epoch: 12, Steps: 208 | Train Loss: 2.008 Vali Loss: 4.536 Vali Acc: 0.110 Test Loss: 4.536 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5440251
	speed: 0.2423s/iter; left time: 4410.2543s
	iters: 200, epoch: 13 | loss: 1.8116893
	speed: 0.0386s/iter; left time: 698.8931s
Epoch: 13 cost time: 8.74267864227295
Epoch: 13, Steps: 208 | Train Loss: 1.907 Vali Loss: 4.611 Vali Acc: 0.115 Test Loss: 4.611 Test Acc: 0.115
Validation loss decreased (-0.111497 --> -0.114776).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8017256
	speed: 0.2483s/iter; left time: 4467.8488s
	iters: 200, epoch: 14 | loss: 2.2435813
	speed: 0.0372s/iter; left time: 665.6197s
Epoch: 14 cost time: 9.829744577407837
Epoch: 14, Steps: 208 | Train Loss: 1.758 Vali Loss: 4.781 Vali Acc: 0.112 Test Loss: 4.781 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6757165
	speed: 0.2306s/iter; left time: 4102.2622s
	iters: 200, epoch: 15 | loss: 2.0240386
	speed: 0.0353s/iter; left time: 623.7694s
Epoch: 15 cost time: 8.352347373962402
Epoch: 15, Steps: 208 | Train Loss: 1.642 Vali Loss: 4.981 Vali Acc: 0.102 Test Loss: 4.981 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.6945523
	speed: 0.2227s/iter; left time: 3915.7419s
	iters: 200, epoch: 16 | loss: 1.6071979
	speed: 0.0362s/iter; left time: 632.9175s
Epoch: 16 cost time: 9.31630825996399
Epoch: 16, Steps: 208 | Train Loss: 1.518 Vali Loss: 5.294 Vali Acc: 0.112 Test Loss: 5.294 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8649137
	speed: 0.2302s/iter; left time: 3999.1344s
	iters: 200, epoch: 17 | loss: 1.3141445
	speed: 0.0389s/iter; left time: 672.6335s
Epoch: 17 cost time: 9.067217588424683
Epoch: 17, Steps: 208 | Train Loss: 1.367 Vali Loss: 5.575 Vali Acc: 0.103 Test Loss: 5.575 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.0159464
	speed: 0.2319s/iter; left time: 3980.7339s
	iters: 200, epoch: 18 | loss: 1.1591294
	speed: 0.0397s/iter; left time: 677.3399s
Epoch: 18 cost time: 9.030853033065796
Epoch: 18, Steps: 208 | Train Loss: 1.248 Vali Loss: 5.848 Vali Acc: 0.107 Test Loss: 5.848 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7508787
	speed: 0.2531s/iter; left time: 4291.6660s
	iters: 200, epoch: 19 | loss: 1.2072122
	speed: 0.0443s/iter; left time: 747.0710s
Epoch: 19 cost time: 10.056589603424072
Epoch: 19, Steps: 208 | Train Loss: 1.174 Vali Loss: 6.022 Vali Acc: 0.111 Test Loss: 6.022 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.2987156
	speed: 0.2640s/iter; left time: 4421.8783s
	iters: 200, epoch: 20 | loss: 1.3169682
	speed: 0.0414s/iter; left time: 688.9892s
Epoch: 20 cost time: 9.47759485244751
Epoch: 20, Steps: 208 | Train Loss: 1.090 Vali Loss: 6.331 Vali Acc: 0.108 Test Loss: 6.331 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.0181997
	speed: 0.2530s/iter; left time: 4184.6592s
	iters: 200, epoch: 21 | loss: 1.0499601
	speed: 0.0445s/iter; left time: 732.3001s
Epoch: 21 cost time: 10.02517056465149
Epoch: 21, Steps: 208 | Train Loss: 1.001 Vali Loss: 6.585 Vali Acc: 0.110 Test Loss: 6.585 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.8665090
	speed: 0.2499s/iter; left time: 4081.5683s
	iters: 200, epoch: 22 | loss: 1.4655902
	speed: 0.0485s/iter; left time: 788.1103s
Epoch: 22 cost time: 10.256637334823608
Epoch: 22, Steps: 208 | Train Loss: 0.919 Vali Loss: 6.923 Vali Acc: 0.113 Test Loss: 6.923 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.8550224
	speed: 0.2558s/iter; left time: 4124.4541s
	iters: 200, epoch: 23 | loss: 0.9964647
	speed: 0.0458s/iter; left time: 734.3914s
Epoch: 23 cost time: 10.14570426940918
Epoch: 23, Steps: 208 | Train Loss: 0.856 Vali Loss: 7.174 Vali Acc: 0.104 Test Loss: 7.174 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11482254697286012
model parameter : 150471
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7994537
	speed: 0.0950s/iter; left time: 1966.2640s
	iters: 200, epoch: 1 | loss: 3.7906461
	speed: 0.0493s/iter; left time: 1015.7844s
Epoch: 1 cost time: 14.97215223312378
Epoch: 1, Steps: 208 | Train Loss: 3.778 Vali Loss: 3.718 Vali Acc: 0.062 Test Loss: 3.718 Test Acc: 0.062
Validation loss decreased (inf --> -0.061699).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5354965
	speed: 0.3107s/iter; left time: 6367.5234s
	iters: 200, epoch: 2 | loss: 3.5597365
	speed: 0.0497s/iter; left time: 1012.7313s
Epoch: 2 cost time: 11.33762264251709
Epoch: 2, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.742 Vali Acc: 0.065 Test Loss: 3.742 Test Acc: 0.065
Validation loss decreased (-0.061699 --> -0.064979).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1980836
	speed: 0.3050s/iter; left time: 6187.0508s
	iters: 200, epoch: 3 | loss: 3.1805520
	speed: 0.0535s/iter; left time: 1079.9673s
Epoch: 3 cost time: 12.615819215774536
Epoch: 3, Steps: 208 | Train Loss: 3.360 Vali Loss: 3.754 Vali Acc: 0.073 Test Loss: 3.754 Test Acc: 0.073
Validation loss decreased (-0.064979 --> -0.073330).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0037625
	speed: 0.2870s/iter; left time: 5762.0663s
	iters: 200, epoch: 4 | loss: 3.4780293
	speed: 0.0452s/iter; left time: 902.2221s
Epoch: 4 cost time: 10.434446334838867
Epoch: 4, Steps: 208 | Train Loss: 3.173 Vali Loss: 3.856 Vali Acc: 0.075 Test Loss: 3.856 Test Acc: 0.075
Validation loss decreased (-0.073330 --> -0.074522).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0336702
	speed: 0.3046s/iter; left time: 6052.0735s
	iters: 200, epoch: 5 | loss: 2.4522102
	speed: 0.0463s/iter; left time: 915.2712s
Epoch: 5 cost time: 10.416126489639282
Epoch: 5, Steps: 208 | Train Loss: 3.018 Vali Loss: 3.905 Vali Acc: 0.086 Test Loss: 3.905 Test Acc: 0.086
Validation loss decreased (-0.074522 --> -0.085556).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8174732
	speed: 0.3013s/iter; left time: 5924.4054s
	iters: 200, epoch: 6 | loss: 3.3600700
	speed: 0.0501s/iter; left time: 979.6108s
Epoch: 6 cost time: 10.995999813079834
Epoch: 6, Steps: 208 | Train Loss: 2.877 Vali Loss: 3.869 Vali Acc: 0.098 Test Loss: 3.869 Test Acc: 0.098
Validation loss decreased (-0.085556 --> -0.097486).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3010170
	speed: 0.2889s/iter; left time: 5620.3080s
	iters: 200, epoch: 7 | loss: 3.3200378
	speed: 0.0499s/iter; left time: 964.9442s
Epoch: 7 cost time: 11.197086572647095
Epoch: 7, Steps: 208 | Train Loss: 2.754 Vali Loss: 4.000 Vali Acc: 0.091 Test Loss: 4.000 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3736277
	speed: 0.2770s/iter; left time: 5330.6370s
	iters: 200, epoch: 8 | loss: 2.9006174
	speed: 0.0493s/iter; left time: 943.8454s
Epoch: 8 cost time: 10.903137922286987
Epoch: 8, Steps: 208 | Train Loss: 2.643 Vali Loss: 3.988 Vali Acc: 0.099 Test Loss: 3.988 Test Acc: 0.099
Validation loss decreased (-0.097486 --> -0.098976).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7666847
	speed: 0.2776s/iter; left time: 5283.7682s
	iters: 200, epoch: 9 | loss: 2.7711651
	speed: 0.0422s/iter; left time: 799.4225s
Epoch: 9 cost time: 9.53389286994934
Epoch: 9, Steps: 208 | Train Loss: 2.492 Vali Loss: 4.099 Vali Acc: 0.102 Test Loss: 4.099 Test Acc: 0.102
Validation loss decreased (-0.098976 --> -0.101957).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3946781
	speed: 0.3006s/iter; left time: 5659.0738s
	iters: 200, epoch: 10 | loss: 2.9161782
	speed: 0.0499s/iter; left time: 934.0066s
Epoch: 10 cost time: 11.473720073699951
Epoch: 10, Steps: 208 | Train Loss: 2.376 Vali Loss: 4.225 Vali Acc: 0.103 Test Loss: 4.225 Test Acc: 0.103
Validation loss decreased (-0.101957 --> -0.102851).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1218538
	speed: 0.3109s/iter; left time: 5789.8253s
	iters: 200, epoch: 11 | loss: 2.7853067
	speed: 0.0479s/iter; left time: 887.9187s
Epoch: 11 cost time: 11.007154941558838
Epoch: 11, Steps: 208 | Train Loss: 2.252 Vali Loss: 4.274 Vali Acc: 0.098 Test Loss: 4.274 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5747802
	speed: 0.3167s/iter; left time: 5830.9235s
	iters: 200, epoch: 12 | loss: 2.2198946
	speed: 0.0475s/iter; left time: 869.1998s
Epoch: 12 cost time: 11.881112813949585
Epoch: 12, Steps: 208 | Train Loss: 2.078 Vali Loss: 4.475 Vali Acc: 0.104 Test Loss: 4.475 Test Acc: 0.104
Validation loss decreased (-0.102851 --> -0.104339).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.1602988
	speed: 0.2903s/iter; left time: 5284.3654s
	iters: 200, epoch: 13 | loss: 2.4293499
	speed: 0.0432s/iter; left time: 782.9353s
Epoch: 13 cost time: 10.169220209121704
Epoch: 13, Steps: 208 | Train Loss: 1.987 Vali Loss: 4.613 Vali Acc: 0.107 Test Loss: 4.613 Test Acc: 0.107
Validation loss decreased (-0.104339 --> -0.106724).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7448388
	speed: 0.3048s/iter; left time: 5484.7305s
	iters: 200, epoch: 14 | loss: 1.8538090
	speed: 0.0376s/iter; left time: 672.1111s
Epoch: 14 cost time: 9.74709677696228
Epoch: 14, Steps: 208 | Train Loss: 1.849 Vali Loss: 4.755 Vali Acc: 0.107 Test Loss: 4.755 Test Acc: 0.107
Validation loss decreased (-0.106724 --> -0.107021).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3464605
	speed: 0.2838s/iter; left time: 5049.3109s
	iters: 200, epoch: 15 | loss: 1.7001044
	speed: 0.0500s/iter; left time: 884.7151s
Epoch: 15 cost time: 12.061120510101318
Epoch: 15, Steps: 208 | Train Loss: 1.738 Vali Loss: 4.931 Vali Acc: 0.107 Test Loss: 4.931 Test Acc: 0.107
Validation loss decreased (-0.107021 --> -0.107317).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.1253614
	speed: 0.2977s/iter; left time: 5233.9049s
	iters: 200, epoch: 16 | loss: 1.6176291
	speed: 0.0484s/iter; left time: 845.9454s
Epoch: 16 cost time: 11.347949504852295
Epoch: 16, Steps: 208 | Train Loss: 1.594 Vali Loss: 5.046 Vali Acc: 0.109 Test Loss: 5.046 Test Acc: 0.109
Validation loss decreased (-0.107317 --> -0.108807).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7886712
	speed: 0.3010s/iter; left time: 5229.9867s
	iters: 200, epoch: 17 | loss: 2.4617722
	speed: 0.0546s/iter; left time: 942.4266s
Epoch: 17 cost time: 12.5282461643219
Epoch: 17, Steps: 208 | Train Loss: 1.487 Vali Loss: 5.454 Vali Acc: 0.104 Test Loss: 5.454 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.9485706
	speed: 0.2917s/iter; left time: 5007.8634s
	iters: 200, epoch: 18 | loss: 1.3260487
	speed: 0.0526s/iter; left time: 898.0856s
Epoch: 18 cost time: 11.66275405883789
Epoch: 18, Steps: 208 | Train Loss: 1.388 Vali Loss: 5.549 Vali Acc: 0.100 Test Loss: 5.549 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.0683306
	speed: 0.2970s/iter; left time: 5035.9122s
	iters: 200, epoch: 19 | loss: 1.4540699
	speed: 0.0499s/iter; left time: 841.1237s
Epoch: 19 cost time: 11.85286569595337
Epoch: 19, Steps: 208 | Train Loss: 1.250 Vali Loss: 5.848 Vali Acc: 0.116 Test Loss: 5.848 Test Acc: 0.116
Validation loss decreased (-0.108807 --> -0.115957).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.9906732
	speed: 0.2861s/iter; left time: 4791.9466s
	iters: 200, epoch: 20 | loss: 1.4878732
	speed: 0.0430s/iter; left time: 716.1259s
Epoch: 20 cost time: 9.954390287399292
Epoch: 20, Steps: 208 | Train Loss: 1.184 Vali Loss: 6.010 Vali Acc: 0.111 Test Loss: 6.010 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.3531247
	speed: 0.2440s/iter; left time: 4035.9051s
	iters: 200, epoch: 21 | loss: 1.3059812
	speed: 0.0467s/iter; left time: 767.3179s
Epoch: 21 cost time: 10.272550344467163
Epoch: 21, Steps: 208 | Train Loss: 1.137 Vali Loss: 6.283 Vali Acc: 0.105 Test Loss: 6.283 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.7076619
	speed: 0.2550s/iter; left time: 4164.2408s
	iters: 200, epoch: 22 | loss: 1.0362352
	speed: 0.0392s/iter; left time: 635.6103s
Epoch: 22 cost time: 9.062644243240356
Epoch: 22, Steps: 208 | Train Loss: 1.013 Vali Loss: 6.662 Vali Acc: 0.107 Test Loss: 6.662 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.4826216
	speed: 0.2593s/iter; left time: 4181.9029s
	iters: 200, epoch: 23 | loss: 2.0011041
	speed: 0.0508s/iter; left time: 814.7133s
Epoch: 23 cost time: 11.815407991409302
Epoch: 23, Steps: 208 | Train Loss: 0.967 Vali Loss: 6.893 Vali Acc: 0.104 Test Loss: 6.893 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.7637820
	speed: 0.2680s/iter; left time: 4265.4914s
	iters: 200, epoch: 24 | loss: 1.0588526
	speed: 0.0404s/iter; left time: 639.5419s
Epoch: 24 cost time: 9.8655424118042
Epoch: 24, Steps: 208 | Train Loss: 0.881 Vali Loss: 7.220 Vali Acc: 0.108 Test Loss: 7.220 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.4760812
	speed: 0.2900s/iter; left time: 4555.8912s
	iters: 200, epoch: 25 | loss: 0.9886494
	speed: 0.0469s/iter; left time: 731.8568s
Epoch: 25 cost time: 11.365968704223633
Epoch: 25, Steps: 208 | Train Loss: 0.851 Vali Loss: 7.416 Vali Acc: 0.112 Test Loss: 7.416 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.7274742
	speed: 0.2695s/iter; left time: 4176.9371s
	iters: 200, epoch: 26 | loss: 0.5947668
	speed: 0.0501s/iter; left time: 771.0550s
Epoch: 26 cost time: 10.545135736465454
Epoch: 26, Steps: 208 | Train Loss: 0.767 Vali Loss: 7.615 Vali Acc: 0.108 Test Loss: 7.615 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.7129386
	speed: 0.3086s/iter; left time: 4719.3208s
	iters: 200, epoch: 27 | loss: 0.2105516
	speed: 0.0498s/iter; left time: 756.6674s
Epoch: 27 cost time: 11.404430627822876
Epoch: 27, Steps: 208 | Train Loss: 0.766 Vali Loss: 7.890 Vali Acc: 0.109 Test Loss: 7.890 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.7704430
	speed: 0.2949s/iter; left time: 4448.2026s
	iters: 200, epoch: 28 | loss: 0.7112108
	speed: 0.0508s/iter; left time: 761.7455s
Epoch: 28 cost time: 11.83432936668396
Epoch: 28, Steps: 208 | Train Loss: 0.720 Vali Loss: 8.079 Vali Acc: 0.112 Test Loss: 8.079 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.3255412
	speed: 0.2856s/iter; left time: 4249.1225s
	iters: 200, epoch: 29 | loss: 0.8763404
	speed: 0.0479s/iter; left time: 707.4088s
Epoch: 29 cost time: 11.033306121826172
Epoch: 29, Steps: 208 | Train Loss: 0.673 Vali Loss: 8.463 Vali Acc: 0.108 Test Loss: 8.463 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11601550849985089
model parameter : 123367
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8413944
	speed: 0.0911s/iter; left time: 1885.6951s
	iters: 200, epoch: 1 | loss: 5.0925770
	speed: 0.0550s/iter; left time: 1133.9388s
Epoch: 1 cost time: 15.23697566986084
Epoch: 1, Steps: 208 | Train Loss: 4.602 Vali Loss: 5.260 Vali Acc: 0.067 Test Loss: 5.260 Test Acc: 0.067
Validation loss decreased (inf --> -0.066753).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7403467
	speed: 0.2724s/iter; left time: 5581.4739s
	iters: 200, epoch: 2 | loss: 3.7914991
	speed: 0.0449s/iter; left time: 916.1771s
Epoch: 2 cost time: 10.968427896499634
Epoch: 2, Steps: 208 | Train Loss: 3.831 Vali Loss: 3.526 Vali Acc: 0.085 Test Loss: 3.526 Test Acc: 0.085
Validation loss decreased (-0.066753 --> -0.084665).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1820593
	speed: 0.2789s/iter; left time: 5657.7642s
	iters: 200, epoch: 3 | loss: 4.0597949
	speed: 0.0523s/iter; left time: 1056.6001s
Epoch: 3 cost time: 12.461997270584106
Epoch: 3, Steps: 208 | Train Loss: 3.392 Vali Loss: 3.966 Vali Acc: 0.093 Test Loss: 3.966 Test Acc: 0.093
Validation loss decreased (-0.084665 --> -0.093011).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0061054
	speed: 0.2876s/iter; left time: 5774.9157s
	iters: 200, epoch: 4 | loss: 3.6740448
	speed: 0.0518s/iter; left time: 1035.1488s
Epoch: 4 cost time: 12.070641994476318
Epoch: 4, Steps: 208 | Train Loss: 3.380 Vali Loss: 4.486 Vali Acc: 0.087 Test Loss: 4.486 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2324376
	speed: 0.3149s/iter; left time: 6256.9437s
	iters: 200, epoch: 5 | loss: 3.6245553
	speed: 0.0768s/iter; left time: 1518.6455s
Epoch: 5 cost time: 17.26050043106079
Epoch: 5, Steps: 208 | Train Loss: 3.304 Vali Loss: 4.183 Vali Acc: 0.106 Test Loss: 4.183 Test Acc: 0.106
Validation loss decreased (-0.093011 --> -0.105535).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4177814
	speed: 0.3554s/iter; left time: 6987.4611s
	iters: 200, epoch: 6 | loss: 3.2149658
	speed: 0.1015s/iter; left time: 1985.2778s
Epoch: 6 cost time: 21.15326237678528
Epoch: 6, Steps: 208 | Train Loss: 3.120 Vali Loss: 4.376 Vali Acc: 0.099 Test Loss: 4.376 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4009869
	speed: 0.3479s/iter; left time: 6768.6629s
	iters: 200, epoch: 7 | loss: 2.6059875
	speed: 0.0885s/iter; left time: 1712.0085s
Epoch: 7 cost time: 19.957851886749268
Epoch: 7, Steps: 208 | Train Loss: 2.558 Vali Loss: 5.523 Vali Acc: 0.092 Test Loss: 5.523 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7732229
	speed: 0.3058s/iter; left time: 5884.4069s
	iters: 200, epoch: 8 | loss: 2.4159043
	speed: 0.0715s/iter; left time: 1369.0957s
Epoch: 8 cost time: 15.306702136993408
Epoch: 8, Steps: 208 | Train Loss: 2.021 Vali Loss: 6.010 Vali Acc: 0.076 Test Loss: 6.010 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4022681
	speed: 0.3288s/iter; left time: 6258.8663s
	iters: 200, epoch: 9 | loss: 1.6664206
	speed: 0.0532s/iter; left time: 1008.0408s
Epoch: 9 cost time: 11.903493642807007
Epoch: 9, Steps: 208 | Train Loss: 1.666 Vali Loss: 6.718 Vali Acc: 0.084 Test Loss: 6.718 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.1212239
	speed: 0.3177s/iter; left time: 5981.7213s
	iters: 200, epoch: 10 | loss: 2.0365043
	speed: 0.0534s/iter; left time: 1000.8556s
Epoch: 10 cost time: 11.872116565704346
Epoch: 10, Steps: 208 | Train Loss: 1.483 Vali Loss: 5.575 Vali Acc: 0.117 Test Loss: 5.575 Test Acc: 0.117
Validation loss decreased (-0.105535 --> -0.117153).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9335881
	speed: 0.3305s/iter; left time: 6154.3631s
	iters: 200, epoch: 11 | loss: 1.8911475
	speed: 0.0687s/iter; left time: 1273.0257s
Epoch: 11 cost time: 13.946504592895508
Epoch: 11, Steps: 208 | Train Loss: 1.325 Vali Loss: 5.947 Vali Acc: 0.110 Test Loss: 5.947 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7639015
	speed: 0.3170s/iter; left time: 5837.4927s
	iters: 200, epoch: 12 | loss: 1.2742677
	speed: 0.0580s/iter; left time: 1063.0669s
Epoch: 12 cost time: 13.442595720291138
Epoch: 12, Steps: 208 | Train Loss: 1.162 Vali Loss: 6.819 Vali Acc: 0.114 Test Loss: 6.819 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2361149
	speed: 0.2971s/iter; left time: 5408.1172s
	iters: 200, epoch: 13 | loss: 1.4790986
	speed: 0.0462s/iter; left time: 835.9260s
Epoch: 13 cost time: 11.195669174194336
Epoch: 13, Steps: 208 | Train Loss: 1.010 Vali Loss: 7.061 Vali Acc: 0.117 Test Loss: 7.061 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8369750
	speed: 0.2822s/iter; left time: 5078.5304s
	iters: 200, epoch: 14 | loss: 1.2477103
	speed: 0.0591s/iter; left time: 1056.9875s
Epoch: 14 cost time: 11.85708475112915
Epoch: 14, Steps: 208 | Train Loss: 0.966 Vali Loss: 7.134 Vali Acc: 0.121 Test Loss: 7.134 Test Acc: 0.121
Validation loss decreased (-0.117153 --> -0.121312).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6434633
	speed: 0.3063s/iter; left time: 5449.0305s
	iters: 200, epoch: 15 | loss: 1.2358028
	speed: 0.0525s/iter; left time: 929.5500s
Epoch: 15 cost time: 12.720219373703003
Epoch: 15, Steps: 208 | Train Loss: 0.784 Vali Loss: 8.108 Vali Acc: 0.120 Test Loss: 8.108 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7862381
	speed: 0.3312s/iter; left time: 5822.7405s
	iters: 200, epoch: 16 | loss: 1.4802969
	speed: 0.0566s/iter; left time: 989.8069s
Epoch: 16 cost time: 14.293533563613892
Epoch: 16, Steps: 208 | Train Loss: 0.708 Vali Loss: 8.421 Vali Acc: 0.120 Test Loss: 8.421 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7524906
	speed: 0.3258s/iter; left time: 5660.7273s
	iters: 200, epoch: 17 | loss: 0.8319685
	speed: 0.0670s/iter; left time: 1158.1501s
Epoch: 17 cost time: 15.894303798675537
Epoch: 17, Steps: 208 | Train Loss: 0.568 Vali Loss: 8.496 Vali Acc: 0.117 Test Loss: 8.496 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3343812
	speed: 0.3066s/iter; left time: 5263.0166s
	iters: 200, epoch: 18 | loss: 0.2703829
	speed: 0.0658s/iter; left time: 1122.6242s
Epoch: 18 cost time: 14.658990859985352
Epoch: 18, Steps: 208 | Train Loss: 0.505 Vali Loss: 9.314 Vali Acc: 0.120 Test Loss: 9.314 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1484023
	speed: 0.2838s/iter; left time: 4812.0089s
	iters: 200, epoch: 19 | loss: 0.4374982
	speed: 0.0508s/iter; left time: 855.7214s
Epoch: 19 cost time: 12.233487129211426
Epoch: 19, Steps: 208 | Train Loss: 0.424 Vali Loss: 9.960 Vali Acc: 0.110 Test Loss: 9.960 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2931075
	speed: 0.3060s/iter; left time: 5124.6733s
	iters: 200, epoch: 20 | loss: 0.4404722
	speed: 0.0444s/iter; left time: 738.7206s
Epoch: 20 cost time: 10.735236644744873
Epoch: 20, Steps: 208 | Train Loss: 0.332 Vali Loss: 10.625 Vali Acc: 0.124 Test Loss: 10.625 Test Acc: 0.124
Validation loss decreased (-0.121312 --> -0.123664).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1926749
	speed: 0.2758s/iter; left time: 4561.6720s
	iters: 200, epoch: 21 | loss: 0.4557246
	speed: 0.0436s/iter; left time: 717.2473s
Epoch: 21 cost time: 11.250706195831299
Epoch: 21, Steps: 208 | Train Loss: 0.294 Vali Loss: 11.064 Vali Acc: 0.115 Test Loss: 11.064 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2163250
	speed: 0.2921s/iter; left time: 4771.1785s
	iters: 200, epoch: 22 | loss: 0.3801745
	speed: 0.0487s/iter; left time: 790.7444s
Epoch: 22 cost time: 12.154848575592041
Epoch: 22, Steps: 208 | Train Loss: 0.318 Vali Loss: 11.241 Vali Acc: 0.116 Test Loss: 11.241 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0943827
	speed: 0.2864s/iter; left time: 4617.8128s
	iters: 200, epoch: 23 | loss: 0.4137102
	speed: 0.0429s/iter; left time: 687.9087s
Epoch: 23 cost time: 11.352014780044556
Epoch: 23, Steps: 208 | Train Loss: 0.269 Vali Loss: 11.798 Vali Acc: 0.113 Test Loss: 11.798 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1445414
	speed: 0.2848s/iter; left time: 4533.2883s
	iters: 200, epoch: 24 | loss: 0.3955447
	speed: 0.0682s/iter; left time: 1079.0795s
Epoch: 24 cost time: 14.892069101333618
Epoch: 24, Steps: 208 | Train Loss: 0.209 Vali Loss: 12.415 Vali Acc: 0.113 Test Loss: 12.415 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2468332
	speed: 0.3194s/iter; left time: 5016.8962s
	iters: 200, epoch: 25 | loss: 0.1855452
	speed: 0.0737s/iter; left time: 1151.0830s
Epoch: 25 cost time: 15.405393600463867
Epoch: 25, Steps: 208 | Train Loss: 0.201 Vali Loss: 12.705 Vali Acc: 0.120 Test Loss: 12.705 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0086892
	speed: 0.3340s/iter; left time: 5177.1172s
	iters: 200, epoch: 26 | loss: 0.1190939
	speed: 0.0585s/iter; left time: 901.2237s
Epoch: 26 cost time: 14.058425664901733
Epoch: 26, Steps: 208 | Train Loss: 0.164 Vali Loss: 12.871 Vali Acc: 0.112 Test Loss: 12.871 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0217001
	speed: 0.3127s/iter; left time: 4781.3736s
	iters: 200, epoch: 27 | loss: 0.1290906
	speed: 0.0625s/iter; left time: 950.2850s
Epoch: 27 cost time: 14.338568449020386
Epoch: 27, Steps: 208 | Train Loss: 0.159 Vali Loss: 13.591 Vali Acc: 0.112 Test Loss: 13.591 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0020810
	speed: 0.3116s/iter; left time: 4700.1921s
	iters: 200, epoch: 28 | loss: 0.5684819
	speed: 0.0439s/iter; left time: 658.0300s
Epoch: 28 cost time: 11.336132764816284
Epoch: 28, Steps: 208 | Train Loss: 0.180 Vali Loss: 13.179 Vali Acc: 0.109 Test Loss: 13.179 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.2502215
	speed: 0.2747s/iter; left time: 4086.1627s
	iters: 200, epoch: 29 | loss: 0.0131109
	speed: 0.0489s/iter; left time: 722.9769s
Epoch: 29 cost time: 11.234193801879883
Epoch: 29, Steps: 208 | Train Loss: 0.175 Vali Loss: 14.015 Vali Acc: 0.112 Test Loss: 14.015 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1760127
	speed: 0.2958s/iter; left time: 4338.8498s
	iters: 200, epoch: 30 | loss: 0.4419912
	speed: 0.0448s/iter; left time: 652.1810s
Epoch: 30 cost time: 11.410645723342896
Epoch: 30, Steps: 208 | Train Loss: 0.156 Vali Loss: 14.201 Vali Acc: 0.115 Test Loss: 14.201 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12376975842529078
model parameter : 1005799
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2126217
	speed: 0.1082s/iter; left time: 2240.3036s
	iters: 200, epoch: 1 | loss: 3.7697315
	speed: 0.0796s/iter; left time: 1639.6100s
Epoch: 1 cost time: 19.657744884490967
Epoch: 1, Steps: 208 | Train Loss: 4.070 Vali Loss: 4.231 Vali Acc: 0.065 Test Loss: 4.231 Test Acc: 0.065
Validation loss decreased (inf --> -0.064676).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1624856
	speed: 0.2701s/iter; left time: 5535.5141s
	iters: 200, epoch: 2 | loss: 3.3499939
	speed: 0.0521s/iter; left time: 1062.9891s
Epoch: 2 cost time: 11.874393701553345
Epoch: 2, Steps: 208 | Train Loss: 3.689 Vali Loss: 4.066 Vali Acc: 0.061 Test Loss: 4.066 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6121311
	speed: 0.2738s/iter; left time: 5554.8586s
	iters: 200, epoch: 3 | loss: 2.9184523
	speed: 0.0526s/iter; left time: 1061.9877s
Epoch: 3 cost time: 11.370927572250366
Epoch: 3, Steps: 208 | Train Loss: 3.258 Vali Loss: 3.742 Vali Acc: 0.100 Test Loss: 3.742 Test Acc: 0.100
Validation loss decreased (-0.064676 --> -0.099575).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5585985
	speed: 0.2617s/iter; left time: 5254.4822s
	iters: 200, epoch: 4 | loss: 2.6572752
	speed: 0.0521s/iter; left time: 1040.3787s
Epoch: 4 cost time: 11.318889379501343
Epoch: 4, Steps: 208 | Train Loss: 3.091 Vali Loss: 4.361 Vali Acc: 0.081 Test Loss: 4.361 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.1430256
	speed: 0.2817s/iter; left time: 5596.8268s
	iters: 200, epoch: 5 | loss: 3.3831279
	speed: 0.0448s/iter; left time: 885.7751s
Epoch: 5 cost time: 12.221683025360107
Epoch: 5, Steps: 208 | Train Loss: 3.000 Vali Loss: 3.862 Vali Acc: 0.110 Test Loss: 3.862 Test Acc: 0.110
Validation loss decreased (-0.099575 --> -0.110012).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9981999
	speed: 0.2274s/iter; left time: 4469.9528s
	iters: 200, epoch: 6 | loss: 2.7027934
	speed: 0.0439s/iter; left time: 858.9986s
Epoch: 6 cost time: 9.762594223022461
Epoch: 6, Steps: 208 | Train Loss: 2.785 Vali Loss: 4.134 Vali Acc: 0.102 Test Loss: 4.134 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7564304
	speed: 0.2403s/iter; left time: 4674.2661s
	iters: 200, epoch: 7 | loss: 3.3577194
	speed: 0.0542s/iter; left time: 1048.0284s
Epoch: 7 cost time: 11.611224889755249
Epoch: 7, Steps: 208 | Train Loss: 2.594 Vali Loss: 4.381 Vali Acc: 0.109 Test Loss: 4.381 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.2669587
	speed: 0.2473s/iter; left time: 4759.3069s
	iters: 200, epoch: 8 | loss: 2.4581041
	speed: 0.0457s/iter; left time: 875.7978s
Epoch: 8 cost time: 10.283562898635864
Epoch: 8, Steps: 208 | Train Loss: 2.289 Vali Loss: 4.621 Vali Acc: 0.109 Test Loss: 4.621 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.9867294
	speed: 0.2336s/iter; left time: 4447.2514s
	iters: 200, epoch: 9 | loss: 1.4079185
	speed: 0.0393s/iter; left time: 744.9968s
Epoch: 9 cost time: 9.215712070465088
Epoch: 9, Steps: 208 | Train Loss: 1.993 Vali Loss: 5.634 Vali Acc: 0.089 Test Loss: 5.634 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.7780714
	speed: 0.2617s/iter; left time: 4927.8948s
	iters: 200, epoch: 10 | loss: 2.7337728
	speed: 0.0419s/iter; left time: 784.9139s
Epoch: 10 cost time: 10.374620914459229
Epoch: 10, Steps: 208 | Train Loss: 1.726 Vali Loss: 5.139 Vali Acc: 0.118 Test Loss: 5.139 Test Acc: 0.118
Validation loss decreased (-0.110012 --> -0.117455).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6202145
	speed: 0.2624s/iter; left time: 4886.3892s
	iters: 200, epoch: 11 | loss: 2.0393891
	speed: 0.0429s/iter; left time: 793.9225s
Epoch: 11 cost time: 10.236847162246704
Epoch: 11, Steps: 208 | Train Loss: 1.498 Vali Loss: 5.129 Vali Acc: 0.123 Test Loss: 5.129 Test Acc: 0.123
Validation loss decreased (-0.117455 --> -0.123122).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5872384
	speed: 0.2631s/iter; left time: 4845.1252s
	iters: 200, epoch: 12 | loss: 1.3824515
	speed: 0.0566s/iter; left time: 1035.6964s
Epoch: 12 cost time: 11.429460048675537
Epoch: 12, Steps: 208 | Train Loss: 1.377 Vali Loss: 5.621 Vali Acc: 0.123 Test Loss: 5.621 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1805776
	speed: 0.2893s/iter; left time: 5267.4689s
	iters: 200, epoch: 13 | loss: 1.2595693
	speed: 0.0608s/iter; left time: 1100.1844s
Epoch: 13 cost time: 13.584573984146118
Epoch: 13, Steps: 208 | Train Loss: 1.148 Vali Loss: 6.068 Vali Acc: 0.127 Test Loss: 6.068 Test Acc: 0.127
Validation loss decreased (-0.123122 --> -0.126990).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3632646
	speed: 0.2812s/iter; left time: 5061.2791s
	iters: 200, epoch: 14 | loss: 1.4686878
	speed: 0.0507s/iter; left time: 907.4465s
Epoch: 14 cost time: 11.540676832199097
Epoch: 14, Steps: 208 | Train Loss: 1.025 Vali Loss: 6.356 Vali Acc: 0.122 Test Loss: 6.356 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5445366
	speed: 0.2867s/iter; left time: 5100.2240s
	iters: 200, epoch: 15 | loss: 1.1393595
	speed: 0.0483s/iter; left time: 853.9418s
Epoch: 15 cost time: 12.345829725265503
Epoch: 15, Steps: 208 | Train Loss: 0.894 Vali Loss: 6.912 Vali Acc: 0.124 Test Loss: 6.912 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3939093
	speed: 0.2469s/iter; left time: 4340.8076s
	iters: 200, epoch: 16 | loss: 0.9142872
	speed: 0.0628s/iter; left time: 1098.0892s
Epoch: 16 cost time: 13.34291958808899
Epoch: 16, Steps: 208 | Train Loss: 0.787 Vali Loss: 7.253 Vali Acc: 0.120 Test Loss: 7.253 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7860640
	speed: 0.2484s/iter; left time: 4315.4178s
	iters: 200, epoch: 17 | loss: 0.5216309
	speed: 0.0482s/iter; left time: 832.1361s
Epoch: 17 cost time: 10.209298849105835
Epoch: 17, Steps: 208 | Train Loss: 0.691 Vali Loss: 7.324 Vali Acc: 0.120 Test Loss: 7.324 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6140064
	speed: 0.2463s/iter; left time: 4227.0116s
	iters: 200, epoch: 18 | loss: 0.8844166
	speed: 0.0450s/iter; left time: 767.4785s
Epoch: 18 cost time: 10.274544954299927
Epoch: 18, Steps: 208 | Train Loss: 0.596 Vali Loss: 8.220 Vali Acc: 0.111 Test Loss: 8.220 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.1099386
	speed: 0.2599s/iter; left time: 4407.2019s
	iters: 200, epoch: 19 | loss: 0.9792603
	speed: 0.0435s/iter; left time: 734.0702s
Epoch: 19 cost time: 10.201341152191162
Epoch: 19, Steps: 208 | Train Loss: 0.559 Vali Loss: 8.659 Vali Acc: 0.109 Test Loss: 8.659 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3521882
	speed: 0.2662s/iter; left time: 4458.6270s
	iters: 200, epoch: 20 | loss: 0.7165403
	speed: 0.0438s/iter; left time: 729.8658s
Epoch: 20 cost time: 10.858090877532959
Epoch: 20, Steps: 208 | Train Loss: 0.505 Vali Loss: 9.017 Vali Acc: 0.118 Test Loss: 9.017 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.3882173
	speed: 0.2397s/iter; left time: 3964.1208s
	iters: 200, epoch: 21 | loss: 0.5399369
	speed: 0.0509s/iter; left time: 836.9814s
Epoch: 21 cost time: 10.723786354064941
Epoch: 21, Steps: 208 | Train Loss: 0.441 Vali Loss: 9.382 Vali Acc: 0.116 Test Loss: 9.382 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3266914
	speed: 0.2593s/iter; left time: 4235.9156s
	iters: 200, epoch: 22 | loss: 0.3801356
	speed: 0.0437s/iter; left time: 709.2445s
Epoch: 22 cost time: 10.08012080192566
Epoch: 22, Steps: 208 | Train Loss: 0.414 Vali Loss: 9.820 Vali Acc: 0.123 Test Loss: 9.820 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3366504
	speed: 0.2813s/iter; left time: 4536.4770s
	iters: 200, epoch: 23 | loss: 0.1854217
	speed: 0.0471s/iter; left time: 754.3548s
Epoch: 23 cost time: 11.710479497909546
Epoch: 23, Steps: 208 | Train Loss: 0.400 Vali Loss: 9.891 Vali Acc: 0.118 Test Loss: 9.891 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12705040262451536
model parameter : 511751
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9358010
	speed: 0.0970s/iter; left time: 2007.1451s
	iters: 200, epoch: 1 | loss: 4.4271345
	speed: 0.0512s/iter; left time: 1055.1751s
Epoch: 1 cost time: 15.44724988937378
Epoch: 1, Steps: 208 | Train Loss: 3.936 Vali Loss: 4.024 Vali Acc: 0.050 Test Loss: 4.024 Test Acc: 0.050
Validation loss decreased (inf --> -0.050362).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1781073
	speed: 0.2578s/iter; left time: 5283.9894s
	iters: 200, epoch: 2 | loss: 3.3033793
	speed: 0.0454s/iter; left time: 926.5541s
Epoch: 2 cost time: 10.683656215667725
Epoch: 2, Steps: 208 | Train Loss: 3.608 Vali Loss: 3.946 Vali Acc: 0.074 Test Loss: 3.946 Test Acc: 0.074
Validation loss decreased (-0.050362 --> -0.073924).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8855233
	speed: 0.2646s/iter; left time: 5367.1758s
	iters: 200, epoch: 3 | loss: 3.3292100
	speed: 0.0457s/iter; left time: 922.2437s
Epoch: 3 cost time: 10.089828968048096
Epoch: 3, Steps: 208 | Train Loss: 3.249 Vali Loss: 3.931 Vali Acc: 0.076 Test Loss: 3.931 Test Acc: 0.076
Validation loss decreased (-0.073924 --> -0.075714).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3032734
	speed: 0.2746s/iter; left time: 5513.6707s
	iters: 200, epoch: 4 | loss: 2.7054682
	speed: 0.0459s/iter; left time: 916.3881s
Epoch: 4 cost time: 10.679698467254639
Epoch: 4, Steps: 208 | Train Loss: 3.025 Vali Loss: 4.362 Vali Acc: 0.084 Test Loss: 4.362 Test Acc: 0.084
Validation loss decreased (-0.075714 --> -0.083762).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4813061
	speed: 0.2728s/iter; left time: 5420.1804s
	iters: 200, epoch: 5 | loss: 3.4580653
	speed: 0.0434s/iter; left time: 857.3204s
Epoch: 5 cost time: 10.288845777511597
Epoch: 5, Steps: 208 | Train Loss: 2.948 Vali Loss: 4.346 Vali Acc: 0.089 Test Loss: 4.346 Test Acc: 0.089
Validation loss decreased (-0.083762 --> -0.089130).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5281684
	speed: 0.2798s/iter; left time: 5500.1911s
	iters: 200, epoch: 6 | loss: 3.7040339
	speed: 0.0411s/iter; left time: 804.7003s
Epoch: 6 cost time: 10.226733684539795
Epoch: 6, Steps: 208 | Train Loss: 2.778 Vali Loss: 4.140 Vali Acc: 0.101 Test Loss: 4.140 Test Acc: 0.101
Validation loss decreased (-0.089130 --> -0.101062).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7871847
	speed: 0.2736s/iter; left time: 5322.6556s
	iters: 200, epoch: 7 | loss: 2.3584449
	speed: 0.0415s/iter; left time: 803.3936s
Epoch: 7 cost time: 9.841455698013306
Epoch: 7, Steps: 208 | Train Loss: 2.605 Vali Loss: 4.416 Vali Acc: 0.107 Test Loss: 4.416 Test Acc: 0.107
Validation loss decreased (-0.101062 --> -0.107322).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6541684
	speed: 0.2625s/iter; left time: 5052.0305s
	iters: 200, epoch: 8 | loss: 2.5008631
	speed: 0.0448s/iter; left time: 857.1992s
Epoch: 8 cost time: 10.463061809539795
Epoch: 8, Steps: 208 | Train Loss: 2.385 Vali Loss: 4.601 Vali Acc: 0.096 Test Loss: 4.601 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0345321
	speed: 0.2500s/iter; left time: 4759.9881s
	iters: 200, epoch: 9 | loss: 2.0831833
	speed: 0.0422s/iter; left time: 799.2701s
Epoch: 9 cost time: 10.26392412185669
Epoch: 9, Steps: 208 | Train Loss: 2.175 Vali Loss: 4.569 Vali Acc: 0.103 Test Loss: 4.569 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.2290933
	speed: 0.2494s/iter; left time: 4696.8117s
	iters: 200, epoch: 10 | loss: 1.7624664
	speed: 0.0494s/iter; left time: 925.9080s
Epoch: 10 cost time: 10.856704711914062
Epoch: 10, Steps: 208 | Train Loss: 1.971 Vali Loss: 4.855 Vali Acc: 0.109 Test Loss: 4.855 Test Acc: 0.109
Validation loss decreased (-0.107322 --> -0.109107).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8962685
	speed: 0.3007s/iter; left time: 5598.7907s
	iters: 200, epoch: 11 | loss: 1.8855537
	speed: 0.0699s/iter; left time: 1294.6500s
Epoch: 11 cost time: 16.5766384601593
Epoch: 11, Steps: 208 | Train Loss: 1.763 Vali Loss: 5.156 Vali Acc: 0.103 Test Loss: 5.156 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0003901
	speed: 0.2981s/iter; left time: 5488.8137s
	iters: 200, epoch: 12 | loss: 1.5028313
	speed: 0.0450s/iter; left time: 824.8648s
Epoch: 12 cost time: 11.374216556549072
Epoch: 12, Steps: 208 | Train Loss: 1.571 Vali Loss: 5.104 Vali Acc: 0.115 Test Loss: 5.104 Test Acc: 0.115
Validation loss decreased (-0.109107 --> -0.115070).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1137730
	speed: 0.2996s/iter; left time: 5453.6802s
	iters: 200, epoch: 13 | loss: 1.9704276
	speed: 0.0480s/iter; left time: 868.2777s
Epoch: 13 cost time: 11.481681108474731
Epoch: 13, Steps: 208 | Train Loss: 1.419 Vali Loss: 5.448 Vali Acc: 0.111 Test Loss: 5.448 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3970109
	speed: 0.3041s/iter; left time: 5472.4822s
	iters: 200, epoch: 14 | loss: 1.7564124
	speed: 0.0550s/iter; left time: 983.8626s
Epoch: 14 cost time: 13.249004364013672
Epoch: 14, Steps: 208 | Train Loss: 1.243 Vali Loss: 5.610 Vali Acc: 0.115 Test Loss: 5.610 Test Acc: 0.115
Validation loss decreased (-0.115070 --> -0.115363).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8141779
	speed: 0.3075s/iter; left time: 5470.9179s
	iters: 200, epoch: 15 | loss: 0.9417070
	speed: 0.0440s/iter; left time: 778.3684s
Epoch: 15 cost time: 11.078389167785645
Epoch: 15, Steps: 208 | Train Loss: 1.147 Vali Loss: 6.332 Vali Acc: 0.115 Test Loss: 6.332 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5106407
	speed: 0.3184s/iter; left time: 5598.4000s
	iters: 200, epoch: 16 | loss: 0.9966538
	speed: 0.0512s/iter; left time: 894.4777s
Epoch: 16 cost time: 12.359310626983643
Epoch: 16, Steps: 208 | Train Loss: 0.986 Vali Loss: 6.328 Vali Acc: 0.115 Test Loss: 6.328 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7956491
	speed: 0.3043s/iter; left time: 5286.8305s
	iters: 200, epoch: 17 | loss: 0.8922321
	speed: 0.0553s/iter; left time: 955.3011s
Epoch: 17 cost time: 12.461081504821777
Epoch: 17, Steps: 208 | Train Loss: 0.873 Vali Loss: 6.731 Vali Acc: 0.108 Test Loss: 6.731 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.9194239
	speed: 0.3137s/iter; left time: 5385.4233s
	iters: 200, epoch: 18 | loss: 1.5826861
	speed: 0.0563s/iter; left time: 961.5033s
Epoch: 18 cost time: 13.824116945266724
Epoch: 18, Steps: 208 | Train Loss: 0.805 Vali Loss: 7.526 Vali Acc: 0.113 Test Loss: 7.526 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.5547366
	speed: 0.3129s/iter; left time: 5305.6845s
	iters: 200, epoch: 19 | loss: 0.8283241
	speed: 0.0595s/iter; left time: 1002.2516s
Epoch: 19 cost time: 14.60146164894104
Epoch: 19, Steps: 208 | Train Loss: 0.723 Vali Loss: 7.650 Vali Acc: 0.117 Test Loss: 7.650 Test Acc: 0.117
Validation loss decreased (-0.115363 --> -0.116834).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.8415175
	speed: 0.3211s/iter; left time: 5377.9277s
	iters: 200, epoch: 20 | loss: 1.0756203
	speed: 0.0636s/iter; left time: 1058.5934s
Epoch: 20 cost time: 14.028820276260376
Epoch: 20, Steps: 208 | Train Loss: 0.643 Vali Loss: 8.012 Vali Acc: 0.114 Test Loss: 8.012 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4661493
	speed: 0.3137s/iter; left time: 5189.4700s
	iters: 200, epoch: 21 | loss: 1.0677198
	speed: 0.0711s/iter; left time: 1168.5304s
Epoch: 21 cost time: 15.800662517547607
Epoch: 21, Steps: 208 | Train Loss: 0.587 Vali Loss: 8.212 Vali Acc: 0.110 Test Loss: 8.212 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.7499157
	speed: 0.2883s/iter; left time: 4709.1133s
	iters: 200, epoch: 22 | loss: 0.5419940
	speed: 0.0470s/iter; left time: 762.7950s
Epoch: 22 cost time: 10.542835235595703
Epoch: 22, Steps: 208 | Train Loss: 0.555 Vali Loss: 8.751 Vali Acc: 0.106 Test Loss: 8.751 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.4876325
	speed: 0.2929s/iter; left time: 4723.1052s
	iters: 200, epoch: 23 | loss: 0.7154742
	speed: 0.0411s/iter; left time: 659.4183s
Epoch: 23 cost time: 10.416706085205078
Epoch: 23, Steps: 208 | Train Loss: 0.481 Vali Loss: 9.335 Vali Acc: 0.109 Test Loss: 9.335 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.3577620
	speed: 0.2752s/iter; left time: 4380.7410s
	iters: 200, epoch: 24 | loss: 0.9400982
	speed: 0.0487s/iter; left time: 770.7501s
Epoch: 24 cost time: 12.07874584197998
Epoch: 24, Steps: 208 | Train Loss: 0.473 Vali Loss: 9.416 Vali Acc: 0.106 Test Loss: 9.416 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.5265916
	speed: 0.2864s/iter; left time: 4499.0987s
	iters: 200, epoch: 25 | loss: 1.3794186
	speed: 0.0473s/iter; left time: 738.9303s
Epoch: 25 cost time: 11.307957172393799
Epoch: 25, Steps: 208 | Train Loss: 0.431 Vali Loss: 9.918 Vali Acc: 0.114 Test Loss: 9.918 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.2272676
	speed: 0.2887s/iter; left time: 4474.7000s
	iters: 200, epoch: 26 | loss: 0.3107603
	speed: 0.0589s/iter; left time: 906.7503s
Epoch: 26 cost time: 13.090522289276123
Epoch: 26, Steps: 208 | Train Loss: 0.416 Vali Loss: 10.098 Vali Acc: 0.115 Test Loss: 10.098 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.2341398
	speed: 0.3020s/iter; left time: 4618.0154s
	iters: 200, epoch: 27 | loss: 0.2203287
	speed: 0.0621s/iter; left time: 944.1685s
Epoch: 27 cost time: 14.042358875274658
Epoch: 27, Steps: 208 | Train Loss: 0.408 Vali Loss: 10.342 Vali Acc: 0.112 Test Loss: 10.342 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2650092
	speed: 0.3092s/iter; left time: 4664.0886s
	iters: 200, epoch: 28 | loss: 0.4303035
	speed: 0.0605s/iter; left time: 906.4677s
Epoch: 28 cost time: 13.277205228805542
Epoch: 28, Steps: 208 | Train Loss: 0.376 Vali Loss: 10.617 Vali Acc: 0.120 Test Loss: 10.617 Test Acc: 0.120
Validation loss decreased (-0.116834 --> -0.120085).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.3589724
	speed: 0.3021s/iter; left time: 4494.9150s
	iters: 200, epoch: 29 | loss: 0.2512669
	speed: 0.0510s/iter; left time: 753.0229s
Epoch: 29 cost time: 12.474006652832031
Epoch: 29, Steps: 208 | Train Loss: 0.379 Vali Loss: 10.726 Vali Acc: 0.115 Test Loss: 10.726 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.1837764
	speed: 0.2871s/iter; left time: 4210.8521s
	iters: 200, epoch: 30 | loss: 0.4958854
	speed: 0.0604s/iter; left time: 880.4656s
Epoch: 30 cost time: 12.60822868347168
Epoch: 30, Steps: 208 | Train Loss: 0.337 Vali Loss: 11.042 Vali Acc: 0.117 Test Loss: 11.042 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0591981
	speed: 0.2978s/iter; left time: 4306.9870s
	iters: 200, epoch: 31 | loss: 0.1258955
	speed: 0.0539s/iter; left time: 774.4084s
Epoch: 31 cost time: 12.885592937469482
Epoch: 31, Steps: 208 | Train Loss: 0.346 Vali Loss: 11.166 Vali Acc: 0.113 Test Loss: 11.166 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0078235
	speed: 0.2909s/iter; left time: 4146.2293s
	iters: 200, epoch: 32 | loss: 0.1418423
	speed: 0.0498s/iter; left time: 705.0615s
Epoch: 32 cost time: 11.53081727027893
Epoch: 32, Steps: 208 | Train Loss: 0.296 Vali Loss: 11.697 Vali Acc: 0.112 Test Loss: 11.697 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.4003632
	speed: 0.2705s/iter; left time: 3799.3561s
	iters: 200, epoch: 33 | loss: 0.6338993
	speed: 0.0385s/iter; left time: 536.6788s
Epoch: 33 cost time: 9.511829614639282
Epoch: 33, Steps: 208 | Train Loss: 0.323 Vali Loss: 11.749 Vali Acc: 0.115 Test Loss: 11.749 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.4432422
	speed: 0.2733s/iter; left time: 3781.1721s
	iters: 200, epoch: 34 | loss: 0.3213265
	speed: 0.0406s/iter; left time: 557.6297s
Epoch: 34 cost time: 9.962778806686401
Epoch: 34, Steps: 208 | Train Loss: 0.301 Vali Loss: 11.928 Vali Acc: 0.116 Test Loss: 11.928 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.2597234
	speed: 0.2608s/iter; left time: 3553.8320s
	iters: 200, epoch: 35 | loss: 0.4234809
	speed: 0.0549s/iter; left time: 742.9781s
Epoch: 35 cost time: 12.179404735565186
Epoch: 35, Steps: 208 | Train Loss: 0.282 Vali Loss: 12.782 Vali Acc: 0.123 Test Loss: 12.782 Test Acc: 0.123
Validation loss decreased (-0.120085 --> -0.122747).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.1623447
	speed: 0.2985s/iter; left time: 4006.5764s
	iters: 200, epoch: 36 | loss: 0.6707228
	speed: 0.0601s/iter; left time: 800.9925s
Epoch: 36 cost time: 13.524236679077148
Epoch: 36, Steps: 208 | Train Loss: 0.287 Vali Loss: 12.486 Vali Acc: 0.118 Test Loss: 12.486 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.3427494
	speed: 0.3017s/iter; left time: 3986.1794s
	iters: 200, epoch: 37 | loss: 0.7296668
	speed: 0.0604s/iter; left time: 792.1377s
Epoch: 37 cost time: 14.212374925613403
Epoch: 37, Steps: 208 | Train Loss: 0.251 Vali Loss: 12.633 Vali Acc: 0.113 Test Loss: 12.633 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.1981248
	speed: 0.2803s/iter; left time: 3645.3985s
	iters: 200, epoch: 38 | loss: 0.1423845
	speed: 0.0483s/iter; left time: 623.7214s
Epoch: 38 cost time: 11.890766382217407
Epoch: 38, Steps: 208 | Train Loss: 0.245 Vali Loss: 13.035 Vali Acc: 0.114 Test Loss: 13.035 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.2311329
	speed: 0.2986s/iter; left time: 3821.4517s
	iters: 200, epoch: 39 | loss: 0.3420788
	speed: 0.0544s/iter; left time: 690.9634s
Epoch: 39 cost time: 12.987953424453735
Epoch: 39, Steps: 208 | Train Loss: 0.233 Vali Loss: 13.130 Vali Acc: 0.112 Test Loss: 13.130 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.3953591
	speed: 0.2906s/iter; left time: 3658.2846s
	iters: 200, epoch: 40 | loss: 0.2871739
	speed: 0.0456s/iter; left time: 569.2519s
Epoch: 40 cost time: 10.590615510940552
Epoch: 40, Steps: 208 | Train Loss: 0.229 Vali Loss: 13.286 Vali Acc: 0.110 Test Loss: 13.286 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.3027461
	speed: 0.2665s/iter; left time: 3299.6007s
	iters: 200, epoch: 41 | loss: 0.6185745
	speed: 0.0471s/iter; left time: 578.7008s
Epoch: 41 cost time: 11.354028701782227
Epoch: 41, Steps: 208 | Train Loss: 0.220 Vali Loss: 13.808 Vali Acc: 0.120 Test Loss: 13.808 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0390680
	speed: 0.2606s/iter; left time: 3171.8653s
	iters: 200, epoch: 42 | loss: 0.7708302
	speed: 0.0508s/iter; left time: 613.8958s
Epoch: 42 cost time: 11.218784809112549
Epoch: 42, Steps: 208 | Train Loss: 0.223 Vali Loss: 14.216 Vali Acc: 0.113 Test Loss: 14.216 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.5180345
	speed: 0.2753s/iter; left time: 3293.4931s
	iters: 200, epoch: 43 | loss: 0.4408010
	speed: 0.0526s/iter; left time: 624.0455s
Epoch: 43 cost time: 11.06433892250061
Epoch: 43, Steps: 208 | Train Loss: 0.224 Vali Loss: 14.000 Vali Acc: 0.108 Test Loss: 14.000 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.3590841
	speed: 0.2534s/iter; left time: 2978.9100s
	iters: 200, epoch: 44 | loss: 0.0423508
	speed: 0.0503s/iter; left time: 585.8319s
Epoch: 44 cost time: 10.876728534698486
Epoch: 44, Steps: 208 | Train Loss: 0.206 Vali Loss: 14.113 Vali Acc: 0.109 Test Loss: 14.113 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.1774546
	speed: 0.3161s/iter; left time: 3650.2776s
	iters: 200, epoch: 45 | loss: 0.0923209
	speed: 0.0583s/iter; left time: 667.8131s
Epoch: 45 cost time: 13.822287797927856
Epoch: 45, Steps: 208 | Train Loss: 0.206 Vali Loss: 13.950 Vali Acc: 0.105 Test Loss: 13.950 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12287503728004771
model parameter : 347207
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8023961
	speed: 0.0874s/iter; left time: 1809.6798s
	iters: 200, epoch: 1 | loss: 4.1542339
	speed: 0.0467s/iter; left time: 961.8295s
Epoch: 1 cost time: 13.863338232040405
Epoch: 1, Steps: 208 | Train Loss: 3.883 Vali Loss: 3.986 Vali Acc: 0.060 Test Loss: 3.986 Test Acc: 0.060
Validation loss decreased (inf --> -0.059608).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0244498
	speed: 0.2929s/iter; left time: 6002.6514s
	iters: 200, epoch: 2 | loss: 3.2714727
	speed: 0.0436s/iter; left time: 888.5977s
Epoch: 2 cost time: 10.754148006439209
Epoch: 2, Steps: 208 | Train Loss: 3.654 Vali Loss: 3.849 Vali Acc: 0.074 Test Loss: 3.849 Test Acc: 0.074
Validation loss decreased (-0.059608 --> -0.074223).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9072182
	speed: 0.2923s/iter; left time: 5928.3143s
	iters: 200, epoch: 3 | loss: 3.2747061
	speed: 0.0414s/iter; left time: 836.2103s
Epoch: 3 cost time: 10.368361234664917
Epoch: 3, Steps: 208 | Train Loss: 3.255 Vali Loss: 3.782 Vali Acc: 0.092 Test Loss: 3.782 Test Acc: 0.092
Validation loss decreased (-0.074223 --> -0.091820).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2826746
	speed: 0.2778s/iter; left time: 5577.5163s
	iters: 200, epoch: 4 | loss: 2.8578601
	speed: 0.0414s/iter; left time: 826.9723s
Epoch: 4 cost time: 10.116437673568726
Epoch: 4, Steps: 208 | Train Loss: 3.036 Vali Loss: 4.061 Vali Acc: 0.095 Test Loss: 4.061 Test Acc: 0.095
Validation loss decreased (-0.091820 --> -0.094800).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9682271
	speed: 0.2624s/iter; left time: 5212.8730s
	iters: 200, epoch: 5 | loss: 3.1964366
	speed: 0.0426s/iter; left time: 841.9092s
Epoch: 5 cost time: 9.833075523376465
Epoch: 5, Steps: 208 | Train Loss: 2.924 Vali Loss: 4.102 Vali Acc: 0.101 Test Loss: 4.102 Test Acc: 0.101
Validation loss decreased (-0.094800 --> -0.100466).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6604929
	speed: 0.2917s/iter; left time: 5735.4268s
	iters: 200, epoch: 6 | loss: 3.4308975
	speed: 0.0463s/iter; left time: 905.0401s
Epoch: 6 cost time: 10.912441968917847
Epoch: 6, Steps: 208 | Train Loss: 2.741 Vali Loss: 4.327 Vali Acc: 0.101 Test Loss: 4.327 Test Acc: 0.101
Validation loss decreased (-0.100466 --> -0.101358).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9034374
	speed: 0.3021s/iter; left time: 5876.0638s
	iters: 200, epoch: 7 | loss: 2.4189839
	speed: 0.0617s/iter; left time: 1193.7228s
Epoch: 7 cost time: 12.402278423309326
Epoch: 7, Steps: 208 | Train Loss: 2.624 Vali Loss: 4.495 Vali Acc: 0.118 Test Loss: 4.495 Test Acc: 0.118
Validation loss decreased (-0.101358 --> -0.118356).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2867396
	speed: 0.3323s/iter; left time: 6395.8512s
	iters: 200, epoch: 8 | loss: 2.7394760
	speed: 0.0430s/iter; left time: 823.0102s
Epoch: 8 cost time: 11.406765460968018
Epoch: 8, Steps: 208 | Train Loss: 2.406 Vali Loss: 4.399 Vali Acc: 0.115 Test Loss: 4.399 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1801896
	speed: 0.3120s/iter; left time: 5938.6822s
	iters: 200, epoch: 9 | loss: 1.8727856
	speed: 0.0526s/iter; left time: 996.2016s
Epoch: 9 cost time: 11.795795440673828
Epoch: 9, Steps: 208 | Train Loss: 2.257 Vali Loss: 4.400 Vali Acc: 0.101 Test Loss: 4.400 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.4728675
	speed: 0.3170s/iter; left time: 5968.6637s
	iters: 200, epoch: 10 | loss: 1.6545894
	speed: 0.0390s/iter; left time: 730.7102s
Epoch: 10 cost time: 10.327105522155762
Epoch: 10, Steps: 208 | Train Loss: 2.096 Vali Loss: 4.600 Vali Acc: 0.117 Test Loss: 4.600 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.2837496
	speed: 0.2818s/iter; left time: 5247.0825s
	iters: 200, epoch: 11 | loss: 1.8794748
	speed: 0.0346s/iter; left time: 640.8134s
Epoch: 11 cost time: 8.913973569869995
Epoch: 11, Steps: 208 | Train Loss: 1.908 Vali Loss: 4.629 Vali Acc: 0.112 Test Loss: 4.629 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2771313
	speed: 0.3051s/iter; left time: 5618.4000s
	iters: 200, epoch: 12 | loss: 1.9880044
	speed: 0.0440s/iter; left time: 806.2967s
Epoch: 12 cost time: 10.222927331924438
Epoch: 12, Steps: 208 | Train Loss: 1.762 Vali Loss: 4.797 Vali Acc: 0.115 Test Loss: 4.797 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.7035167
	speed: 0.3085s/iter; left time: 5615.5208s
	iters: 200, epoch: 13 | loss: 1.5112611
	speed: 0.0513s/iter; left time: 928.7504s
Epoch: 13 cost time: 12.133214235305786
Epoch: 13, Steps: 208 | Train Loss: 1.591 Vali Loss: 5.019 Vali Acc: 0.128 Test Loss: 5.019 Test Acc: 0.128
Validation loss decreased (-0.118356 --> -0.127597).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6338524
	speed: 0.2830s/iter; left time: 5092.8936s
	iters: 200, epoch: 14 | loss: 0.9310621
	speed: 0.0505s/iter; left time: 903.5246s
Epoch: 14 cost time: 11.194939374923706
Epoch: 14, Steps: 208 | Train Loss: 1.471 Vali Loss: 5.131 Vali Acc: 0.127 Test Loss: 5.131 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1224487
	speed: 0.3087s/iter; left time: 5491.7634s
	iters: 200, epoch: 15 | loss: 1.6375893
	speed: 0.0502s/iter; left time: 887.4936s
Epoch: 15 cost time: 10.461294889450073
Epoch: 15, Steps: 208 | Train Loss: 1.302 Vali Loss: 5.507 Vali Acc: 0.122 Test Loss: 5.507 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.7622921
	speed: 0.2982s/iter; left time: 5242.9003s
	iters: 200, epoch: 16 | loss: 1.4124373
	speed: 0.0461s/iter; left time: 806.2031s
Epoch: 16 cost time: 10.523580551147461
Epoch: 16, Steps: 208 | Train Loss: 1.202 Vali Loss: 5.892 Vali Acc: 0.123 Test Loss: 5.892 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9117811
	speed: 0.2881s/iter; left time: 5005.6943s
	iters: 200, epoch: 17 | loss: 1.6042231
	speed: 0.0471s/iter; left time: 813.4674s
Epoch: 17 cost time: 11.103134155273438
Epoch: 17, Steps: 208 | Train Loss: 1.084 Vali Loss: 6.296 Vali Acc: 0.127 Test Loss: 6.296 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5443808
	speed: 0.3108s/iter; left time: 5335.3101s
	iters: 200, epoch: 18 | loss: 1.7765131
	speed: 0.0535s/iter; left time: 913.2712s
Epoch: 18 cost time: 11.750736951828003
Epoch: 18, Steps: 208 | Train Loss: 0.982 Vali Loss: 6.592 Vali Acc: 0.118 Test Loss: 6.592 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3244482
	speed: 0.2965s/iter; left time: 5027.1619s
	iters: 200, epoch: 19 | loss: 1.3457916
	speed: 0.0379s/iter; left time: 639.2482s
Epoch: 19 cost time: 9.64223599433899
Epoch: 19, Steps: 208 | Train Loss: 0.905 Vali Loss: 6.912 Vali Acc: 0.122 Test Loss: 6.912 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8603184
	speed: 0.2893s/iter; left time: 4844.8816s
	iters: 200, epoch: 20 | loss: 1.1799759
	speed: 0.0496s/iter; left time: 826.4342s
Epoch: 20 cost time: 11.450902223587036
Epoch: 20, Steps: 208 | Train Loss: 0.788 Vali Loss: 7.168 Vali Acc: 0.124 Test Loss: 7.168 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.3490951
	speed: 0.3031s/iter; left time: 5014.1998s
	iters: 200, epoch: 21 | loss: 1.1190450
	speed: 0.0469s/iter; left time: 770.6386s
Epoch: 21 cost time: 12.05742859840393
Epoch: 21, Steps: 208 | Train Loss: 0.714 Vali Loss: 7.339 Vali Acc: 0.107 Test Loss: 7.339 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6848972
	speed: 0.2811s/iter; left time: 4591.0435s
	iters: 200, epoch: 22 | loss: 1.5281615
	speed: 0.0559s/iter; left time: 906.7280s
Epoch: 22 cost time: 12.229168176651001
Epoch: 22, Steps: 208 | Train Loss: 0.701 Vali Loss: 7.756 Vali Acc: 0.122 Test Loss: 7.756 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3099550
	speed: 0.2993s/iter; left time: 4826.2448s
	iters: 200, epoch: 23 | loss: 0.9287370
	speed: 0.0457s/iter; left time: 732.5287s
Epoch: 23 cost time: 10.497539758682251
Epoch: 23, Steps: 208 | Train Loss: 0.628 Vali Loss: 8.143 Vali Acc: 0.125 Test Loss: 8.143 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12764688338801072
model parameter : 278727
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1709476
	speed: 0.0727s/iter; left time: 1505.5089s
	iters: 200, epoch: 1 | loss: 3.7259743
	speed: 0.0481s/iter; left time: 990.1702s
Epoch: 1 cost time: 12.590174198150635
Epoch: 1, Steps: 208 | Train Loss: 3.802 Vali Loss: 3.859 Vali Acc: 0.054 Test Loss: 3.859 Test Acc: 0.054
Validation loss decreased (inf --> -0.053645).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5468199
	speed: 0.2420s/iter; left time: 4960.0369s
	iters: 200, epoch: 2 | loss: 3.6025674
	speed: 0.0364s/iter; left time: 743.1883s
Epoch: 2 cost time: 8.292870044708252
Epoch: 2, Steps: 208 | Train Loss: 3.588 Vali Loss: 3.859 Vali Acc: 0.059 Test Loss: 3.859 Test Acc: 0.059
Validation loss decreased (-0.053645 --> -0.058715).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2296381
	speed: 0.2563s/iter; left time: 5198.8888s
	iters: 200, epoch: 3 | loss: 3.7415154
	speed: 0.0451s/iter; left time: 909.9670s
Epoch: 3 cost time: 10.001674890518188
Epoch: 3, Steps: 208 | Train Loss: 3.280 Vali Loss: 3.936 Vali Acc: 0.074 Test Loss: 3.936 Test Acc: 0.074
Validation loss decreased (-0.058715 --> -0.074222).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0590429
	speed: 0.2726s/iter; left time: 5473.5273s
	iters: 200, epoch: 4 | loss: 3.4732289
	speed: 0.0407s/iter; left time: 813.5664s
Epoch: 4 cost time: 10.660117626190186
Epoch: 4, Steps: 208 | Train Loss: 3.079 Vali Loss: 4.053 Vali Acc: 0.084 Test Loss: 4.053 Test Acc: 0.084
Validation loss decreased (-0.074222 --> -0.084063).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2702980
	speed: 0.2706s/iter; left time: 5377.2404s
	iters: 200, epoch: 5 | loss: 3.4535408
	speed: 0.0441s/iter; left time: 872.4069s
Epoch: 5 cost time: 10.36877965927124
Epoch: 5, Steps: 208 | Train Loss: 2.934 Vali Loss: 4.071 Vali Acc: 0.090 Test Loss: 4.071 Test Acc: 0.090
Validation loss decreased (-0.084063 --> -0.090028).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5166936
	speed: 0.2645s/iter; left time: 5199.5482s
	iters: 200, epoch: 6 | loss: 3.3162026
	speed: 0.0443s/iter; left time: 866.3898s
Epoch: 6 cost time: 10.27596926689148
Epoch: 6, Steps: 208 | Train Loss: 2.791 Vali Loss: 4.111 Vali Acc: 0.101 Test Loss: 4.111 Test Acc: 0.101
Validation loss decreased (-0.090028 --> -0.101361).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9788711
	speed: 0.2460s/iter; left time: 4785.6882s
	iters: 200, epoch: 7 | loss: 3.7220545
	speed: 0.0375s/iter; left time: 724.8879s
Epoch: 7 cost time: 9.214168548583984
Epoch: 7, Steps: 208 | Train Loss: 2.658 Vali Loss: 4.272 Vali Acc: 0.102 Test Loss: 4.272 Test Acc: 0.102
Validation loss decreased (-0.101361 --> -0.101657).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4581130
	speed: 0.2670s/iter; left time: 5138.8808s
	iters: 200, epoch: 8 | loss: 3.6157894
	speed: 0.0444s/iter; left time: 849.3750s
Epoch: 8 cost time: 10.025834083557129
Epoch: 8, Steps: 208 | Train Loss: 2.466 Vali Loss: 4.362 Vali Acc: 0.095 Test Loss: 4.362 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1230311
	speed: 0.2596s/iter; left time: 4942.2862s
	iters: 200, epoch: 9 | loss: 3.2610557
	speed: 0.0384s/iter; left time: 727.0750s
Epoch: 9 cost time: 9.144996643066406
Epoch: 9, Steps: 208 | Train Loss: 2.329 Vali Loss: 4.443 Vali Acc: 0.107 Test Loss: 4.443 Test Acc: 0.107
Validation loss decreased (-0.101657 --> -0.106726).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4115911
	speed: 0.2617s/iter; left time: 4927.2948s
	iters: 200, epoch: 10 | loss: 3.2342627
	speed: 0.0416s/iter; left time: 779.9458s
Epoch: 10 cost time: 9.88715386390686
Epoch: 10, Steps: 208 | Train Loss: 2.187 Vali Loss: 4.547 Vali Acc: 0.109 Test Loss: 4.547 Test Acc: 0.109
Validation loss decreased (-0.106726 --> -0.109409).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.9600260
	speed: 0.2551s/iter; left time: 4750.3543s
	iters: 200, epoch: 11 | loss: 2.8369772
	speed: 0.0482s/iter; left time: 892.2784s
Epoch: 11 cost time: 10.553616285324097
Epoch: 11, Steps: 208 | Train Loss: 2.049 Vali Loss: 4.595 Vali Acc: 0.110 Test Loss: 4.595 Test Acc: 0.110
Validation loss decreased (-0.109409 --> -0.110303).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.7845132
	speed: 0.2628s/iter; left time: 4838.3131s
	iters: 200, epoch: 12 | loss: 2.2904828
	speed: 0.0376s/iter; left time: 688.1207s
Epoch: 12 cost time: 9.47970700263977
Epoch: 12, Steps: 208 | Train Loss: 1.913 Vali Loss: 4.761 Vali Acc: 0.115 Test Loss: 4.761 Test Acc: 0.115
Validation loss decreased (-0.110303 --> -0.114477).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0743911
	speed: 0.2689s/iter; left time: 4894.9097s
	iters: 200, epoch: 13 | loss: 1.8197514
	speed: 0.0397s/iter; left time: 718.5051s
Epoch: 13 cost time: 10.496540546417236
Epoch: 13, Steps: 208 | Train Loss: 1.790 Vali Loss: 4.934 Vali Acc: 0.117 Test Loss: 4.934 Test Acc: 0.117
Validation loss decreased (-0.114477 --> -0.117159).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0326552
	speed: 0.2636s/iter; left time: 4743.3600s
	iters: 200, epoch: 14 | loss: 2.2398336
	speed: 0.0463s/iter; left time: 828.2453s
Epoch: 14 cost time: 10.477669715881348
Epoch: 14, Steps: 208 | Train Loss: 1.676 Vali Loss: 5.117 Vali Acc: 0.114 Test Loss: 5.117 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4626031
	speed: 0.2580s/iter; left time: 4588.9458s
	iters: 200, epoch: 15 | loss: 1.7008975
	speed: 0.0435s/iter; left time: 768.8448s
Epoch: 15 cost time: 10.100469589233398
Epoch: 15, Steps: 208 | Train Loss: 1.560 Vali Loss: 5.248 Vali Acc: 0.115 Test Loss: 5.248 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0095110
	speed: 0.2679s/iter; left time: 4710.4057s
	iters: 200, epoch: 16 | loss: 1.7025300
	speed: 0.0445s/iter; left time: 778.1221s
Epoch: 16 cost time: 10.641867637634277
Epoch: 16, Steps: 208 | Train Loss: 1.432 Vali Loss: 5.646 Vali Acc: 0.106 Test Loss: 5.646 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7774633
	speed: 0.2749s/iter; left time: 4775.8220s
	iters: 200, epoch: 17 | loss: 1.8426723
	speed: 0.0436s/iter; left time: 753.0020s
Epoch: 17 cost time: 10.65259313583374
Epoch: 17, Steps: 208 | Train Loss: 1.357 Vali Loss: 5.777 Vali Acc: 0.117 Test Loss: 5.777 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.1659676
	speed: 0.2766s/iter; left time: 4747.7789s
	iters: 200, epoch: 18 | loss: 1.4553978
	speed: 0.0447s/iter; left time: 762.6906s
Epoch: 18 cost time: 11.048483848571777
Epoch: 18, Steps: 208 | Train Loss: 1.238 Vali Loss: 6.094 Vali Acc: 0.116 Test Loss: 6.094 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8361439
	speed: 0.2719s/iter; left time: 4610.7737s
	iters: 200, epoch: 19 | loss: 1.3150034
	speed: 0.0431s/iter; left time: 726.9894s
Epoch: 19 cost time: 10.26696491241455
Epoch: 19, Steps: 208 | Train Loss: 1.159 Vali Loss: 6.389 Vali Acc: 0.114 Test Loss: 6.389 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.3510617
	speed: 0.2563s/iter; left time: 4293.5589s
	iters: 200, epoch: 20 | loss: 0.9980624
	speed: 0.0434s/iter; left time: 721.9570s
Epoch: 20 cost time: 9.600287914276123
Epoch: 20, Steps: 208 | Train Loss: 1.112 Vali Loss: 6.523 Vali Acc: 0.113 Test Loss: 6.523 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.4999455
	speed: 0.2536s/iter; left time: 4194.7399s
	iters: 200, epoch: 21 | loss: 0.9000473
	speed: 0.0423s/iter; left time: 694.9773s
Epoch: 21 cost time: 10.14594292640686
Epoch: 21, Steps: 208 | Train Loss: 0.985 Vali Loss: 6.721 Vali Acc: 0.111 Test Loss: 6.721 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.0851173
	speed: 0.2540s/iter; left time: 4149.0792s
	iters: 200, epoch: 22 | loss: 1.3476394
	speed: 0.0434s/iter; left time: 704.5104s
Epoch: 22 cost time: 10.073541402816772
Epoch: 22, Steps: 208 | Train Loss: 0.938 Vali Loss: 7.064 Vali Acc: 0.107 Test Loss: 7.064 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4833565
	speed: 0.2441s/iter; left time: 3936.6421s
	iters: 200, epoch: 23 | loss: 1.0777696
	speed: 0.0479s/iter; left time: 767.8146s
Epoch: 23 cost time: 10.232327222824097
Epoch: 23, Steps: 208 | Train Loss: 0.899 Vali Loss: 7.284 Vali Acc: 0.110 Test Loss: 7.284 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11720847002684164
model parameter : 182983
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9399452
	speed: 0.0759s/iter; left time: 1570.9795s
	iters: 200, epoch: 1 | loss: 3.6279337
	speed: 0.0450s/iter; left time: 927.3206s
Epoch: 1 cost time: 12.517881870269775
Epoch: 1, Steps: 208 | Train Loss: 3.796 Vali Loss: 3.727 Vali Acc: 0.060 Test Loss: 3.727 Test Acc: 0.060
Validation loss decreased (inf --> -0.059611).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5371218
	speed: 0.2739s/iter; left time: 5612.0513s
	iters: 200, epoch: 2 | loss: 2.9265344
	speed: 0.0444s/iter; left time: 904.4515s
Epoch: 2 cost time: 10.971179246902466
Epoch: 2, Steps: 208 | Train Loss: 3.574 Vali Loss: 3.778 Vali Acc: 0.069 Test Loss: 3.778 Test Acc: 0.069
Validation loss decreased (-0.059611 --> -0.069154).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4770975
	speed: 0.2563s/iter; left time: 5199.8639s
	iters: 200, epoch: 3 | loss: 3.1374807
	speed: 0.0388s/iter; left time: 782.6302s
Epoch: 3 cost time: 8.742780923843384
Epoch: 3, Steps: 208 | Train Loss: 3.310 Vali Loss: 3.807 Vali Acc: 0.074 Test Loss: 3.807 Test Acc: 0.074
Validation loss decreased (-0.069154 --> -0.073627).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2025790
	speed: 0.2628s/iter; left time: 5276.2767s
	iters: 200, epoch: 4 | loss: 3.6352682
	speed: 0.0375s/iter; left time: 748.2178s
Epoch: 4 cost time: 9.240394830703735
Epoch: 4, Steps: 208 | Train Loss: 3.142 Vali Loss: 3.884 Vali Acc: 0.085 Test Loss: 3.884 Test Acc: 0.085
Validation loss decreased (-0.073627 --> -0.084661).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3501658
	speed: 0.2537s/iter; left time: 5041.0426s
	iters: 200, epoch: 5 | loss: 2.9669695
	speed: 0.0411s/iter; left time: 812.0429s
Epoch: 5 cost time: 10.163966655731201
Epoch: 5, Steps: 208 | Train Loss: 2.993 Vali Loss: 3.976 Vali Acc: 0.085 Test Loss: 3.976 Test Acc: 0.085
Validation loss decreased (-0.084661 --> -0.085257).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7494333
	speed: 0.2500s/iter; left time: 4915.2492s
	iters: 200, epoch: 6 | loss: 3.4687612
	speed: 0.0374s/iter; left time: 732.5464s
Epoch: 6 cost time: 9.308344602584839
Epoch: 6, Steps: 208 | Train Loss: 2.855 Vali Loss: 3.962 Vali Acc: 0.091 Test Loss: 3.962 Test Acc: 0.091
Validation loss decreased (-0.085257 --> -0.090924).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0676944
	speed: 0.2431s/iter; left time: 4729.1994s
	iters: 200, epoch: 7 | loss: 2.7480884
	speed: 0.0448s/iter; left time: 867.7830s
Epoch: 7 cost time: 10.301101207733154
Epoch: 7, Steps: 208 | Train Loss: 2.735 Vali Loss: 4.140 Vali Acc: 0.092 Test Loss: 4.140 Test Acc: 0.092
Validation loss decreased (-0.090924 --> -0.091518).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6871512
	speed: 0.2436s/iter; left time: 4688.4650s
	iters: 200, epoch: 8 | loss: 2.8974893
	speed: 0.0489s/iter; left time: 935.9201s
Epoch: 8 cost time: 11.138920783996582
Epoch: 8, Steps: 208 | Train Loss: 2.607 Vali Loss: 4.142 Vali Acc: 0.094 Test Loss: 4.142 Test Acc: 0.094
Validation loss decreased (-0.091518 --> -0.093606).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9239438
	speed: 0.2593s/iter; left time: 4935.4879s
	iters: 200, epoch: 9 | loss: 3.1566336
	speed: 0.0420s/iter; left time: 794.9157s
Epoch: 9 cost time: 9.208031177520752
Epoch: 9, Steps: 208 | Train Loss: 2.486 Vali Loss: 4.204 Vali Acc: 0.086 Test Loss: 4.204 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.0516691
	speed: 0.2532s/iter; left time: 4766.8183s
	iters: 200, epoch: 10 | loss: 2.3859107
	speed: 0.0400s/iter; left time: 748.9821s
Epoch: 10 cost time: 10.070297718048096
Epoch: 10, Steps: 208 | Train Loss: 2.360 Vali Loss: 4.251 Vali Acc: 0.103 Test Loss: 4.251 Test Acc: 0.103
Validation loss decreased (-0.093606 --> -0.102850).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3026783
	speed: 0.2626s/iter; left time: 4889.6781s
	iters: 200, epoch: 11 | loss: 2.3524477
	speed: 0.0433s/iter; left time: 801.9178s
Epoch: 11 cost time: 10.040165662765503
Epoch: 11, Steps: 208 | Train Loss: 2.252 Vali Loss: 4.433 Vali Acc: 0.099 Test Loss: 4.433 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0169730
	speed: 0.2741s/iter; left time: 5047.2795s
	iters: 200, epoch: 12 | loss: 1.8622705
	speed: 0.0501s/iter; left time: 917.4451s
Epoch: 12 cost time: 11.348845958709717
Epoch: 12, Steps: 208 | Train Loss: 2.073 Vali Loss: 4.533 Vali Acc: 0.097 Test Loss: 4.533 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.0515187
	speed: 0.2628s/iter; left time: 4783.9739s
	iters: 200, epoch: 13 | loss: 1.9740447
	speed: 0.0441s/iter; left time: 798.8662s
Epoch: 13 cost time: 9.896050214767456
Epoch: 13, Steps: 208 | Train Loss: 1.955 Vali Loss: 4.686 Vali Acc: 0.104 Test Loss: 4.686 Test Acc: 0.104
Validation loss decreased (-0.102850 --> -0.104039).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0852551
	speed: 0.2736s/iter; left time: 4924.2823s
	iters: 200, epoch: 14 | loss: 2.2407179
	speed: 0.0431s/iter; left time: 770.6769s
Epoch: 14 cost time: 9.932327032089233
Epoch: 14, Steps: 208 | Train Loss: 1.856 Vali Loss: 4.868 Vali Acc: 0.093 Test Loss: 4.868 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6479278
	speed: 0.2648s/iter; left time: 4710.9518s
	iters: 200, epoch: 15 | loss: 2.1505930
	speed: 0.0421s/iter; left time: 744.4060s
Epoch: 15 cost time: 10.661012172698975
Epoch: 15, Steps: 208 | Train Loss: 1.747 Vali Loss: 5.082 Vali Acc: 0.099 Test Loss: 5.082 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5633528
	speed: 0.2652s/iter; left time: 4662.5638s
	iters: 200, epoch: 16 | loss: 3.0246198
	speed: 0.0412s/iter; left time: 719.9579s
Epoch: 16 cost time: 9.938416719436646
Epoch: 16, Steps: 208 | Train Loss: 1.632 Vali Loss: 5.188 Vali Acc: 0.105 Test Loss: 5.188 Test Acc: 0.105
Validation loss decreased (-0.104039 --> -0.104929).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7444686
	speed: 0.2792s/iter; left time: 4850.5140s
	iters: 200, epoch: 17 | loss: 1.3478079
	speed: 0.0450s/iter; left time: 777.6604s
Epoch: 17 cost time: 10.63228964805603
Epoch: 17, Steps: 208 | Train Loss: 1.571 Vali Loss: 5.434 Vali Acc: 0.107 Test Loss: 5.434 Test Acc: 0.107
Validation loss decreased (-0.104929 --> -0.107312).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6398706
	speed: 0.2580s/iter; left time: 4427.7566s
	iters: 200, epoch: 18 | loss: 1.1826804
	speed: 0.0425s/iter; left time: 725.2227s
Epoch: 18 cost time: 9.816435813903809
Epoch: 18, Steps: 208 | Train Loss: 1.418 Vali Loss: 5.593 Vali Acc: 0.104 Test Loss: 5.593 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6613278
	speed: 0.2730s/iter; left time: 4629.1259s
	iters: 200, epoch: 19 | loss: 1.9967510
	speed: 0.0409s/iter; left time: 689.6553s
Epoch: 19 cost time: 10.606178760528564
Epoch: 19, Steps: 208 | Train Loss: 1.331 Vali Loss: 5.775 Vali Acc: 0.106 Test Loss: 5.775 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.1662204
	speed: 0.2366s/iter; left time: 3962.5279s
	iters: 200, epoch: 20 | loss: 1.8977909
	speed: 0.0396s/iter; left time: 659.5486s
Epoch: 20 cost time: 9.446782112121582
Epoch: 20, Steps: 208 | Train Loss: 1.257 Vali Loss: 6.056 Vali Acc: 0.099 Test Loss: 6.056 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.6861382
	speed: 0.2376s/iter; left time: 3929.3585s
	iters: 200, epoch: 21 | loss: 1.2069426
	speed: 0.0416s/iter; left time: 683.4227s
Epoch: 21 cost time: 9.03296184539795
Epoch: 21, Steps: 208 | Train Loss: 1.188 Vali Loss: 6.328 Vali Acc: 0.104 Test Loss: 6.328 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.1712903
	speed: 0.2208s/iter; left time: 3605.6874s
	iters: 200, epoch: 22 | loss: 1.0986890
	speed: 0.0387s/iter; left time: 628.2009s
Epoch: 22 cost time: 9.058975219726562
Epoch: 22, Steps: 208 | Train Loss: 1.074 Vali Loss: 6.519 Vali Acc: 0.098 Test Loss: 6.519 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.0938790
	speed: 0.2360s/iter; left time: 3805.6728s
	iters: 200, epoch: 23 | loss: 0.7381601
	speed: 0.0351s/iter; left time: 562.8813s
Epoch: 23 cost time: 9.067766189575195
Epoch: 23, Steps: 208 | Train Loss: 1.016 Vali Loss: 6.861 Vali Acc: 0.101 Test Loss: 6.861 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.5979365
	speed: 0.2106s/iter; left time: 3351.6140s
	iters: 200, epoch: 24 | loss: 1.1752155
	speed: 0.0347s/iter; left time: 548.7348s
Epoch: 24 cost time: 8.490744829177856
Epoch: 24, Steps: 208 | Train Loss: 0.927 Vali Loss: 7.044 Vali Acc: 0.103 Test Loss: 7.044 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.7782611
	speed: 0.2328s/iter; left time: 3656.4760s
	iters: 200, epoch: 25 | loss: 1.0917228
	speed: 0.0381s/iter; left time: 593.9382s
Epoch: 25 cost time: 8.960898399353027
Epoch: 25, Steps: 208 | Train Loss: 0.910 Vali Loss: 7.296 Vali Acc: 0.096 Test Loss: 7.296 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.9949485
	speed: 0.2251s/iter; left time: 3489.0334s
	iters: 200, epoch: 26 | loss: 0.8081318
	speed: 0.0355s/iter; left time: 546.7000s
Epoch: 26 cost time: 8.608541250228882
Epoch: 26, Steps: 208 | Train Loss: 0.832 Vali Loss: 7.540 Vali Acc: 0.097 Test Loss: 7.540 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.2732284
	speed: 0.2171s/iter; left time: 3320.2883s
	iters: 200, epoch: 27 | loss: 1.1548728
	speed: 0.0319s/iter; left time: 484.6653s
Epoch: 27 cost time: 8.41995644569397
Epoch: 27, Steps: 208 | Train Loss: 0.805 Vali Loss: 7.891 Vali Acc: 0.103 Test Loss: 7.891 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10736653742916791
model parameter : 142151
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4180906
	speed: 0.0764s/iter; left time: 1581.1167s
	iters: 200, epoch: 1 | loss: 3.6949599
	speed: 0.0384s/iter; left time: 790.7771s
Epoch: 1 cost time: 11.949127912521362
Epoch: 1, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.745 Vali Acc: 0.050 Test Loss: 3.745 Test Acc: 0.050
Validation loss decreased (inf --> -0.049470).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5727534
	speed: 0.2208s/iter; left time: 4525.2863s
	iters: 200, epoch: 2 | loss: 3.4236219
	speed: 0.0391s/iter; left time: 797.0977s
Epoch: 2 cost time: 8.61065936088562
Epoch: 2, Steps: 208 | Train Loss: 3.593 Vali Loss: 3.845 Vali Acc: 0.061 Test Loss: 3.845 Test Acc: 0.061
Validation loss decreased (-0.049470 --> -0.060504).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2901495
	speed: 0.2142s/iter; left time: 4344.3055s
	iters: 200, epoch: 3 | loss: 2.9533291
	speed: 0.0344s/iter; left time: 693.7846s
Epoch: 3 cost time: 8.054785251617432
Epoch: 3, Steps: 208 | Train Loss: 3.420 Vali Loss: 3.833 Vali Acc: 0.071 Test Loss: 3.833 Test Acc: 0.071
Validation loss decreased (-0.060504 --> -0.070645).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7994633
	speed: 0.2205s/iter; left time: 4427.7632s
	iters: 200, epoch: 4 | loss: 3.0491984
	speed: 0.0378s/iter; left time: 755.5115s
Epoch: 4 cost time: 8.560197353363037
Epoch: 4, Steps: 208 | Train Loss: 3.204 Vali Loss: 3.855 Vali Acc: 0.072 Test Loss: 3.855 Test Acc: 0.072
Validation loss decreased (-0.070645 --> -0.071837).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1306193
	speed: 0.2242s/iter; left time: 4454.1177s
	iters: 200, epoch: 5 | loss: 3.5318308
	speed: 0.0398s/iter; left time: 786.5473s
Epoch: 5 cost time: 9.231229543685913
Epoch: 5, Steps: 208 | Train Loss: 3.071 Vali Loss: 3.926 Vali Acc: 0.081 Test Loss: 3.926 Test Acc: 0.081
Validation loss decreased (-0.071837 --> -0.081082).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0209630
	speed: 0.2476s/iter; left time: 4868.0620s
	iters: 200, epoch: 6 | loss: 3.5268571
	speed: 0.0372s/iter; left time: 727.8488s
Epoch: 6 cost time: 8.713252782821655
Epoch: 6, Steps: 208 | Train Loss: 2.940 Vali Loss: 3.987 Vali Acc: 0.082 Test Loss: 3.987 Test Acc: 0.082
Validation loss decreased (-0.081082 --> -0.082274).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9682002
	speed: 0.2316s/iter; left time: 4505.3490s
	iters: 200, epoch: 7 | loss: 3.0587482
	speed: 0.0294s/iter; left time: 569.5908s
Epoch: 7 cost time: 7.631436824798584
Epoch: 7, Steps: 208 | Train Loss: 2.823 Vali Loss: 4.032 Vali Acc: 0.091 Test Loss: 4.032 Test Acc: 0.091
Validation loss decreased (-0.082274 --> -0.090625).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6437275
	speed: 0.2028s/iter; left time: 3902.0221s
	iters: 200, epoch: 8 | loss: 3.3461251
	speed: 0.0353s/iter; left time: 676.0925s
Epoch: 8 cost time: 8.537990093231201
Epoch: 8, Steps: 208 | Train Loss: 2.714 Vali Loss: 4.000 Vali Acc: 0.099 Test Loss: 4.000 Test Acc: 0.099
Validation loss decreased (-0.090625 --> -0.098976).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8250461
	speed: 0.2224s/iter; left time: 4234.0905s
	iters: 200, epoch: 9 | loss: 2.8587065
	speed: 0.0373s/iter; left time: 706.6791s
Epoch: 9 cost time: 8.252251625061035
Epoch: 9, Steps: 208 | Train Loss: 2.575 Vali Loss: 4.101 Vali Acc: 0.089 Test Loss: 4.101 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4498377
	speed: 0.2294s/iter; left time: 4319.9822s
	iters: 200, epoch: 10 | loss: 3.2003036
	speed: 0.0420s/iter; left time: 786.8583s
Epoch: 10 cost time: 9.990729331970215
Epoch: 10, Steps: 208 | Train Loss: 2.451 Vali Loss: 4.104 Vali Acc: 0.097 Test Loss: 4.104 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.2946196
	speed: 0.2325s/iter; left time: 4328.9139s
	iters: 200, epoch: 11 | loss: 2.3605680
	speed: 0.0348s/iter; left time: 644.3659s
Epoch: 11 cost time: 8.802226066589355
Epoch: 11, Steps: 208 | Train Loss: 2.332 Vali Loss: 4.258 Vali Acc: 0.103 Test Loss: 4.258 Test Acc: 0.103
Validation loss decreased (-0.098976 --> -0.103447).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7569110
	speed: 0.2469s/iter; left time: 4547.0017s
	iters: 200, epoch: 12 | loss: 1.8355485
	speed: 0.0366s/iter; left time: 669.6964s
Epoch: 12 cost time: 9.153294324874878
Epoch: 12, Steps: 208 | Train Loss: 2.204 Vali Loss: 4.437 Vali Acc: 0.102 Test Loss: 4.437 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6078602
	speed: 0.2598s/iter; left time: 4729.8449s
	iters: 200, epoch: 13 | loss: 2.0148268
	speed: 0.0411s/iter; left time: 743.7523s
Epoch: 13 cost time: 9.849443912506104
Epoch: 13, Steps: 208 | Train Loss: 2.102 Vali Loss: 4.479 Vali Acc: 0.106 Test Loss: 4.479 Test Acc: 0.106
Validation loss decreased (-0.103447 --> -0.106427).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6414526
	speed: 0.2442s/iter; left time: 4394.8361s
	iters: 200, epoch: 14 | loss: 2.1101155
	speed: 0.0419s/iter; left time: 750.5151s
Epoch: 14 cost time: 9.437587022781372
Epoch: 14, Steps: 208 | Train Loss: 1.975 Vali Loss: 4.612 Vali Acc: 0.106 Test Loss: 4.612 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.8186237
	speed: 0.2419s/iter; left time: 4303.4227s
	iters: 200, epoch: 15 | loss: 2.3103228
	speed: 0.0401s/iter; left time: 708.9460s
Epoch: 15 cost time: 9.244405746459961
Epoch: 15, Steps: 208 | Train Loss: 1.882 Vali Loss: 4.797 Vali Acc: 0.093 Test Loss: 4.797 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3824377
	speed: 0.2227s/iter; left time: 3914.9454s
	iters: 200, epoch: 16 | loss: 1.6820030
	speed: 0.0362s/iter; left time: 632.3520s
Epoch: 16 cost time: 8.475391626358032
Epoch: 16, Steps: 208 | Train Loss: 1.773 Vali Loss: 5.016 Vali Acc: 0.097 Test Loss: 5.016 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2998006
	speed: 0.2363s/iter; left time: 4105.0653s
	iters: 200, epoch: 17 | loss: 1.6818197
	speed: 0.0363s/iter; left time: 627.0700s
Epoch: 17 cost time: 8.964453220367432
Epoch: 17, Steps: 208 | Train Loss: 1.643 Vali Loss: 5.255 Vali Acc: 0.104 Test Loss: 5.255 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.5719296
	speed: 0.2290s/iter; left time: 3930.5952s
	iters: 200, epoch: 18 | loss: 1.3745924
	speed: 0.0369s/iter; left time: 630.0550s
Epoch: 18 cost time: 9.534623384475708
Epoch: 18, Steps: 208 | Train Loss: 1.554 Vali Loss: 5.400 Vali Acc: 0.106 Test Loss: 5.400 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.9311277
	speed: 0.2169s/iter; left time: 3677.9157s
	iters: 200, epoch: 19 | loss: 1.8782694
	speed: 0.0387s/iter; left time: 651.7511s
Epoch: 19 cost time: 8.358995199203491
Epoch: 19, Steps: 208 | Train Loss: 1.472 Vali Loss: 5.737 Vali Acc: 0.105 Test Loss: 5.737 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.3915944
	speed: 0.2338s/iter; left time: 3915.6379s
	iters: 200, epoch: 20 | loss: 1.5908943
	speed: 0.0331s/iter; left time: 550.7485s
Epoch: 20 cost time: 8.608137130737305
Epoch: 20, Steps: 208 | Train Loss: 1.400 Vali Loss: 5.766 Vali Acc: 0.101 Test Loss: 5.766 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.4242231
	speed: 0.2494s/iter; left time: 4125.6116s
	iters: 200, epoch: 21 | loss: 1.2712808
	speed: 0.0390s/iter; left time: 640.6141s
Epoch: 21 cost time: 9.737233400344849
Epoch: 21, Steps: 208 | Train Loss: 1.316 Vali Loss: 6.003 Vali Acc: 0.107 Test Loss: 6.003 Test Acc: 0.107
Validation loss decreased (-0.106427 --> -0.106710).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.4523854
	speed: 0.2226s/iter; left time: 3636.2887s
	iters: 200, epoch: 22 | loss: 1.1036398
	speed: 0.0360s/iter; left time: 584.7464s
Epoch: 22 cost time: 7.908081293106079
Epoch: 22, Steps: 208 | Train Loss: 1.255 Vali Loss: 6.315 Vali Acc: 0.103 Test Loss: 6.315 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2741642
	speed: 0.2320s/iter; left time: 3741.5149s
	iters: 200, epoch: 23 | loss: 0.9613103
	speed: 0.0385s/iter; left time: 617.1651s
Epoch: 23 cost time: 8.931143045425415
Epoch: 23, Steps: 208 | Train Loss: 1.137 Vali Loss: 6.610 Vali Acc: 0.101 Test Loss: 6.610 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.0942723
	speed: 0.2306s/iter; left time: 3669.7523s
	iters: 200, epoch: 24 | loss: 1.0556611
	speed: 0.0401s/iter; left time: 634.8924s
Epoch: 24 cost time: 9.337413311004639
Epoch: 24, Steps: 208 | Train Loss: 1.116 Vali Loss: 6.705 Vali Acc: 0.105 Test Loss: 6.705 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.3948662
	speed: 0.2508s/iter; left time: 3940.2570s
	iters: 200, epoch: 25 | loss: 1.1983595
	speed: 0.0398s/iter; left time: 621.5266s
Epoch: 25 cost time: 9.725907802581787
Epoch: 25, Steps: 208 | Train Loss: 1.045 Vali Loss: 6.944 Vali Acc: 0.101 Test Loss: 6.944 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.8324683
	speed: 0.2315s/iter; left time: 3587.9428s
	iters: 200, epoch: 26 | loss: 0.9350495
	speed: 0.0370s/iter; left time: 569.1048s
Epoch: 26 cost time: 8.313406944274902
Epoch: 26, Steps: 208 | Train Loss: 1.005 Vali Loss: 7.215 Vali Acc: 0.098 Test Loss: 7.215 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.8322569
	speed: 0.2568s/iter; left time: 3926.7592s
	iters: 200, epoch: 27 | loss: 1.6563100
	speed: 0.0350s/iter; left time: 531.4483s
Epoch: 27 cost time: 8.252764701843262
Epoch: 27, Steps: 208 | Train Loss: 0.940 Vali Loss: 7.391 Vali Acc: 0.099 Test Loss: 7.391 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.7168180
	speed: 0.2274s/iter; left time: 3430.0297s
	iters: 200, epoch: 28 | loss: 0.6932364
	speed: 0.0414s/iter; left time: 621.0063s
Epoch: 28 cost time: 9.577112913131714
Epoch: 28, Steps: 208 | Train Loss: 0.904 Vali Loss: 7.688 Vali Acc: 0.103 Test Loss: 7.688 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.8263277
	speed: 0.2193s/iter; left time: 3262.4758s
	iters: 200, epoch: 29 | loss: 0.7849813
	speed: 0.0380s/iter; left time: 561.6328s
Epoch: 29 cost time: 8.912450790405273
Epoch: 29, Steps: 208 | Train Loss: 0.858 Vali Loss: 7.929 Vali Acc: 0.095 Test Loss: 7.929 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.4946907
	speed: 0.2175s/iter; left time: 3191.2016s
	iters: 200, epoch: 30 | loss: 1.1418717
	speed: 0.0309s/iter; left time: 449.7200s
Epoch: 30 cost time: 7.97346043586731
Epoch: 30, Steps: 208 | Train Loss: 0.814 Vali Loss: 7.963 Vali Acc: 0.101 Test Loss: 7.963 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.0530190
	speed: 0.1996s/iter; left time: 2886.1346s
	iters: 200, epoch: 31 | loss: 1.0520059
	speed: 0.0332s/iter; left time: 477.4172s
Epoch: 31 cost time: 7.968381881713867
Epoch: 31, Steps: 208 | Train Loss: 0.782 Vali Loss: 8.292 Vali Acc: 0.098 Test Loss: 8.292 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm32_nh4_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10677005666567253
model parameter : 115047
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1525922
	speed: 0.0869s/iter; left time: 1798.3989s
	iters: 200, epoch: 1 | loss: 4.4939170
	speed: 0.0485s/iter; left time: 998.3326s
Epoch: 1 cost time: 14.013485193252563
Epoch: 1, Steps: 208 | Train Loss: 4.042 Vali Loss: 4.274 Vali Acc: 0.052 Test Loss: 4.274 Test Acc: 0.052
Validation loss decreased (inf --> -0.052149).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1171558
	speed: 0.2951s/iter; left time: 6047.2814s
	iters: 200, epoch: 2 | loss: 3.4149227
	speed: 0.0476s/iter; left time: 971.3028s
Epoch: 2 cost time: 10.894245386123657
Epoch: 2, Steps: 208 | Train Loss: 3.690 Vali Loss: 4.126 Vali Acc: 0.082 Test Loss: 4.126 Test Acc: 0.082
Validation loss decreased (-0.052149 --> -0.082273).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9034488
	speed: 0.3152s/iter; left time: 6392.9208s
	iters: 200, epoch: 3 | loss: 2.8729343
	speed: 0.0563s/iter; left time: 1135.6504s
Epoch: 3 cost time: 13.524529457092285
Epoch: 3, Steps: 208 | Train Loss: 3.222 Vali Loss: 4.243 Vali Acc: 0.082 Test Loss: 4.243 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.1978550
	speed: 0.3025s/iter; left time: 6073.3135s
	iters: 200, epoch: 4 | loss: 2.8475671
	speed: 0.0550s/iter; left time: 1097.8044s
Epoch: 4 cost time: 12.102030992507935
Epoch: 4, Steps: 208 | Train Loss: 2.898 Vali Loss: 4.196 Vali Acc: 0.090 Test Loss: 4.196 Test Acc: 0.090
Validation loss decreased (-0.082273 --> -0.089728).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4656203
	speed: 0.3181s/iter; left time: 6319.5723s
	iters: 200, epoch: 5 | loss: 2.9445429
	speed: 0.0514s/iter; left time: 1016.9732s
Epoch: 5 cost time: 11.775222301483154
Epoch: 5, Steps: 208 | Train Loss: 2.592 Vali Loss: 4.610 Vali Acc: 0.089 Test Loss: 4.610 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9725540
	speed: 0.3094s/iter; left time: 6083.6393s
	iters: 200, epoch: 6 | loss: 2.5116138
	speed: 0.0515s/iter; left time: 1007.4765s
Epoch: 6 cost time: 12.146233558654785
Epoch: 6, Steps: 208 | Train Loss: 2.258 Vali Loss: 5.005 Vali Acc: 0.098 Test Loss: 5.005 Test Acc: 0.098
Validation loss decreased (-0.089728 --> -0.097475).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9914194
	speed: 0.3144s/iter; left time: 6116.9342s
	iters: 200, epoch: 7 | loss: 2.3687112
	speed: 0.0565s/iter; left time: 1094.1686s
Epoch: 7 cost time: 12.92654037475586
Epoch: 7, Steps: 208 | Train Loss: 1.946 Vali Loss: 5.265 Vali Acc: 0.090 Test Loss: 5.265 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8135071
	speed: 0.2950s/iter; left time: 5677.3845s
	iters: 200, epoch: 8 | loss: 0.6720713
	speed: 0.0449s/iter; left time: 859.6566s
Epoch: 8 cost time: 10.43856406211853
Epoch: 8, Steps: 208 | Train Loss: 1.669 Vali Loss: 5.774 Vali Acc: 0.101 Test Loss: 5.774 Test Acc: 0.101
Validation loss decreased (-0.097475 --> -0.101344).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2437927
	speed: 0.2860s/iter; left time: 5444.5341s
	iters: 200, epoch: 9 | loss: 2.1477060
	speed: 0.0467s/iter; left time: 883.4906s
Epoch: 9 cost time: 10.136402606964111
Epoch: 9, Steps: 208 | Train Loss: 1.409 Vali Loss: 6.069 Vali Acc: 0.100 Test Loss: 6.069 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2982535
	speed: 0.2876s/iter; left time: 5415.8897s
	iters: 200, epoch: 10 | loss: 1.2654274
	speed: 0.0559s/iter; left time: 1047.0733s
Epoch: 10 cost time: 12.891916036605835
Epoch: 10, Steps: 208 | Train Loss: 1.146 Vali Loss: 6.507 Vali Acc: 0.102 Test Loss: 6.507 Test Acc: 0.102
Validation loss decreased (-0.101344 --> -0.101635).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4676143
	speed: 0.3021s/iter; left time: 5625.4839s
	iters: 200, epoch: 11 | loss: 1.1545162
	speed: 0.0537s/iter; left time: 993.7874s
Epoch: 11 cost time: 12.153287649154663
Epoch: 11, Steps: 208 | Train Loss: 0.984 Vali Loss: 7.310 Vali Acc: 0.097 Test Loss: 7.310 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1411188
	speed: 0.3236s/iter; left time: 5959.3320s
	iters: 200, epoch: 12 | loss: 0.7732843
	speed: 0.0496s/iter; left time: 908.4446s
Epoch: 12 cost time: 12.315297365188599
Epoch: 12, Steps: 208 | Train Loss: 0.814 Vali Loss: 7.525 Vali Acc: 0.098 Test Loss: 7.525 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6210001
	speed: 0.3082s/iter; left time: 5611.2646s
	iters: 200, epoch: 13 | loss: 1.1820575
	speed: 0.0496s/iter; left time: 898.3567s
Epoch: 13 cost time: 12.828014612197876
Epoch: 13, Steps: 208 | Train Loss: 0.725 Vali Loss: 8.168 Vali Acc: 0.102 Test Loss: 8.168 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7367437
	speed: 0.3010s/iter; left time: 5417.9356s
	iters: 200, epoch: 14 | loss: 1.2368456
	speed: 0.0507s/iter; left time: 906.7656s
Epoch: 14 cost time: 11.989461183547974
Epoch: 14, Steps: 208 | Train Loss: 0.645 Vali Loss: 8.785 Vali Acc: 0.101 Test Loss: 8.785 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.5526376
	speed: 0.3123s/iter; left time: 5554.7512s
	iters: 200, epoch: 15 | loss: 0.5809754
	speed: 0.0577s/iter; left time: 1020.2147s
Epoch: 15 cost time: 12.571264028549194
Epoch: 15, Steps: 208 | Train Loss: 0.559 Vali Loss: 9.015 Vali Acc: 0.096 Test Loss: 9.015 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.6008324
	speed: 0.2949s/iter; left time: 5184.8649s
	iters: 200, epoch: 16 | loss: 0.3636131
	speed: 0.0458s/iter; left time: 799.9708s
Epoch: 16 cost time: 11.208419799804688
Epoch: 16, Steps: 208 | Train Loss: 0.479 Vali Loss: 9.876 Vali Acc: 0.100 Test Loss: 9.876 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6939651
	speed: 0.2969s/iter; left time: 5158.3662s
	iters: 200, epoch: 17 | loss: 0.6522006
	speed: 0.0456s/iter; left time: 787.9933s
Epoch: 17 cost time: 11.526519298553467
Epoch: 17, Steps: 208 | Train Loss: 0.442 Vali Loss: 10.243 Vali Acc: 0.096 Test Loss: 10.243 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.7106853
	speed: 0.2791s/iter; left time: 4790.4064s
	iters: 200, epoch: 18 | loss: 0.4665673
	speed: 0.0435s/iter; left time: 742.0220s
Epoch: 18 cost time: 10.402173042297363
Epoch: 18, Steps: 208 | Train Loss: 0.410 Vali Loss: 10.699 Vali Acc: 0.100 Test Loss: 10.699 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0334311
	speed: 0.2865s/iter; left time: 4858.7780s
	iters: 200, epoch: 19 | loss: 0.2676010
	speed: 0.0510s/iter; left time: 860.1368s
Epoch: 19 cost time: 12.605775833129883
Epoch: 19, Steps: 208 | Train Loss: 0.351 Vali Loss: 10.865 Vali Acc: 0.101 Test Loss: 10.865 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1646705
	speed: 0.3091s/iter; left time: 5177.7892s
	iters: 200, epoch: 20 | loss: 1.1038010
	speed: 0.0557s/iter; left time: 927.3863s
Epoch: 20 cost time: 13.288572311401367
Epoch: 20, Steps: 208 | Train Loss: 0.339 Vali Loss: 11.494 Vali Acc: 0.098 Test Loss: 11.494 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10169997017596183
model parameter : 513607
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8146694
	speed: 0.0918s/iter; left time: 1900.1961s
	iters: 200, epoch: 1 | loss: 4.0574737
	speed: 0.0410s/iter; left time: 844.3772s
Epoch: 1 cost time: 13.869629859924316
Epoch: 1, Steps: 208 | Train Loss: 3.846 Vali Loss: 3.870 Vali Acc: 0.061 Test Loss: 3.870 Test Acc: 0.061
Validation loss decreased (inf --> -0.061399).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9799495
	speed: 0.3038s/iter; left time: 6224.9911s
	iters: 200, epoch: 2 | loss: 3.8233781
	speed: 0.0464s/iter; left time: 945.8877s
Epoch: 2 cost time: 11.981994152069092
Epoch: 2, Steps: 208 | Train Loss: 3.498 Vali Loss: 3.754 Vali Acc: 0.087 Test Loss: 3.754 Test Acc: 0.087
Validation loss decreased (-0.061399 --> -0.086750).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4953389
	speed: 0.2761s/iter; left time: 5599.7936s
	iters: 200, epoch: 3 | loss: 2.8577104
	speed: 0.0481s/iter; left time: 971.6611s
Epoch: 3 cost time: 10.788429021835327
Epoch: 3, Steps: 208 | Train Loss: 3.173 Vali Loss: 3.715 Vali Acc: 0.100 Test Loss: 3.715 Test Acc: 0.100
Validation loss decreased (-0.086750 --> -0.100172).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7423401
	speed: 0.3021s/iter; left time: 6064.7654s
	iters: 200, epoch: 4 | loss: 2.8762567
	speed: 0.0471s/iter; left time: 941.5973s
Epoch: 4 cost time: 11.514549255371094
Epoch: 4, Steps: 208 | Train Loss: 2.982 Vali Loss: 3.866 Vali Acc: 0.099 Test Loss: 3.866 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2768614
	speed: 0.3045s/iter; left time: 6049.9184s
	iters: 200, epoch: 5 | loss: 2.8756413
	speed: 0.0479s/iter; left time: 946.4584s
Epoch: 5 cost time: 12.391480922698975
Epoch: 5, Steps: 208 | Train Loss: 2.790 Vali Loss: 4.180 Vali Acc: 0.098 Test Loss: 4.180 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0358572
	speed: 0.2641s/iter; left time: 5192.8469s
	iters: 200, epoch: 6 | loss: 3.7555041
	speed: 0.0442s/iter; left time: 865.5734s
Epoch: 6 cost time: 10.91631531715393
Epoch: 6, Steps: 208 | Train Loss: 2.626 Vali Loss: 4.130 Vali Acc: 0.098 Test Loss: 4.130 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.6102540
	speed: 0.2533s/iter; left time: 4927.9409s
	iters: 200, epoch: 7 | loss: 2.8830571
	speed: 0.0439s/iter; left time: 849.0394s
Epoch: 7 cost time: 9.917827367782593
Epoch: 7, Steps: 208 | Train Loss: 2.443 Vali Loss: 4.250 Vali Acc: 0.104 Test Loss: 4.250 Test Acc: 0.104
Validation loss decreased (-0.100172 --> -0.103745).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2026737
	speed: 0.2835s/iter; left time: 5455.1574s
	iters: 200, epoch: 8 | loss: 3.0258918
	speed: 0.0455s/iter; left time: 870.7463s
Epoch: 8 cost time: 11.079376459121704
Epoch: 8, Steps: 208 | Train Loss: 2.259 Vali Loss: 4.341 Vali Acc: 0.109 Test Loss: 4.341 Test Acc: 0.109
Validation loss decreased (-0.103745 --> -0.109411).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8204296
	speed: 0.2626s/iter; left time: 4998.2324s
	iters: 200, epoch: 9 | loss: 2.5125268
	speed: 0.0484s/iter; left time: 915.7439s
Epoch: 9 cost time: 11.245458126068115
Epoch: 9, Steps: 208 | Train Loss: 2.138 Vali Loss: 4.465 Vali Acc: 0.108 Test Loss: 4.465 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0721488
	speed: 0.2609s/iter; left time: 4912.3746s
	iters: 200, epoch: 10 | loss: 2.2242327
	speed: 0.0411s/iter; left time: 770.1490s
Epoch: 10 cost time: 10.315439462661743
Epoch: 10, Steps: 208 | Train Loss: 1.949 Vali Loss: 4.505 Vali Acc: 0.112 Test Loss: 4.505 Test Acc: 0.112
Validation loss decreased (-0.109411 --> -0.111795).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3199072
	speed: 0.2674s/iter; left time: 4979.8404s
	iters: 200, epoch: 11 | loss: 1.7182844
	speed: 0.0408s/iter; left time: 755.0161s
Epoch: 11 cost time: 10.159498453140259
Epoch: 11, Steps: 208 | Train Loss: 1.794 Vali Loss: 4.801 Vali Acc: 0.114 Test Loss: 4.801 Test Acc: 0.114
Validation loss decreased (-0.111795 --> -0.113582).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8770623
	speed: 0.2531s/iter; left time: 4661.1768s
	iters: 200, epoch: 12 | loss: 2.1802959
	speed: 0.0429s/iter; left time: 785.5381s
Epoch: 12 cost time: 10.75063443183899
Epoch: 12, Steps: 208 | Train Loss: 1.650 Vali Loss: 4.864 Vali Acc: 0.111 Test Loss: 4.864 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1128353
	speed: 0.2427s/iter; left time: 4418.6918s
	iters: 200, epoch: 13 | loss: 1.6027015
	speed: 0.0396s/iter; left time: 717.5504s
Epoch: 13 cost time: 9.99252986907959
Epoch: 13, Steps: 208 | Train Loss: 1.516 Vali Loss: 5.046 Vali Acc: 0.112 Test Loss: 5.046 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8063920
	speed: 0.2412s/iter; left time: 4340.1141s
	iters: 200, epoch: 14 | loss: 1.8255831
	speed: 0.0371s/iter; left time: 663.1525s
Epoch: 14 cost time: 9.116844892501831
Epoch: 14, Steps: 208 | Train Loss: 1.408 Vali Loss: 5.328 Vali Acc: 0.124 Test Loss: 5.328 Test Acc: 0.124
Validation loss decreased (-0.113582 --> -0.124313).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8090582
	speed: 0.2394s/iter; left time: 4258.3664s
	iters: 200, epoch: 15 | loss: 1.3433878
	speed: 0.0408s/iter; left time: 720.8446s
Epoch: 15 cost time: 10.056137800216675
Epoch: 15, Steps: 208 | Train Loss: 1.266 Vali Loss: 5.860 Vali Acc: 0.121 Test Loss: 5.860 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2779323
	speed: 0.2411s/iter; left time: 4238.6205s
	iters: 200, epoch: 16 | loss: 0.9610262
	speed: 0.0384s/iter; left time: 670.5625s
Epoch: 16 cost time: 9.789416313171387
Epoch: 16, Steps: 208 | Train Loss: 1.168 Vali Loss: 5.949 Vali Acc: 0.119 Test Loss: 5.949 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5859717
	speed: 0.2410s/iter; left time: 4187.0760s
	iters: 200, epoch: 17 | loss: 1.3805819
	speed: 0.0447s/iter; left time: 771.8988s
Epoch: 17 cost time: 10.132155895233154
Epoch: 17, Steps: 208 | Train Loss: 1.106 Vali Loss: 6.171 Vali Acc: 0.111 Test Loss: 6.171 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.9988373
	speed: 0.2489s/iter; left time: 4272.2674s
	iters: 200, epoch: 18 | loss: 1.5617927
	speed: 0.0405s/iter; left time: 691.2209s
Epoch: 18 cost time: 9.913893699645996
Epoch: 18, Steps: 208 | Train Loss: 0.994 Vali Loss: 6.708 Vali Acc: 0.123 Test Loss: 6.708 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7198546
	speed: 0.2601s/iter; left time: 4410.1342s
	iters: 200, epoch: 19 | loss: 1.4968154
	speed: 0.0458s/iter; left time: 771.6911s
Epoch: 19 cost time: 10.79314374923706
Epoch: 19, Steps: 208 | Train Loss: 0.952 Vali Loss: 6.835 Vali Acc: 0.118 Test Loss: 6.835 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5253199
	speed: 0.2620s/iter; left time: 4388.5951s
	iters: 200, epoch: 20 | loss: 1.5547965
	speed: 0.0465s/iter; left time: 774.6009s
Epoch: 20 cost time: 10.544397115707397
Epoch: 20, Steps: 208 | Train Loss: 0.851 Vali Loss: 7.215 Vali Acc: 0.126 Test Loss: 7.215 Test Acc: 0.126
Validation loss decreased (-0.124313 --> -0.125487).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.6988696
	speed: 0.2651s/iter; left time: 4384.2719s
	iters: 200, epoch: 21 | loss: 0.5605490
	speed: 0.0459s/iter; left time: 754.0339s
Epoch: 21 cost time: 10.62905216217041
Epoch: 21, Steps: 208 | Train Loss: 0.801 Vali Loss: 7.295 Vali Acc: 0.118 Test Loss: 7.295 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5505779
	speed: 0.2712s/iter; left time: 4430.3101s
	iters: 200, epoch: 22 | loss: 1.2502084
	speed: 0.0501s/iter; left time: 812.5731s
Epoch: 22 cost time: 11.492188692092896
Epoch: 22, Steps: 208 | Train Loss: 0.760 Vali Loss: 7.755 Vali Acc: 0.115 Test Loss: 7.755 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5777646
	speed: 0.2782s/iter; left time: 4485.4252s
	iters: 200, epoch: 23 | loss: 1.1651459
	speed: 0.0404s/iter; left time: 647.2938s
Epoch: 23 cost time: 11.010379314422607
Epoch: 23, Steps: 208 | Train Loss: 0.700 Vali Loss: 8.273 Vali Acc: 0.120 Test Loss: 8.273 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3180685
	speed: 0.2569s/iter; left time: 4089.4744s
	iters: 200, epoch: 24 | loss: 1.2666997
	speed: 0.0406s/iter; left time: 641.7748s
Epoch: 24 cost time: 9.815906524658203
Epoch: 24, Steps: 208 | Train Loss: 0.652 Vali Loss: 8.410 Vali Acc: 0.121 Test Loss: 8.410 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.6993634
	speed: 0.2552s/iter; left time: 4008.4522s
	iters: 200, epoch: 25 | loss: 0.7525632
	speed: 0.0367s/iter; left time: 572.6029s
Epoch: 25 cost time: 9.662726640701294
Epoch: 25, Steps: 208 | Train Loss: 0.618 Vali Loss: 8.847 Vali Acc: 0.113 Test Loss: 8.847 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.2036118
	speed: 0.2602s/iter; left time: 4032.8547s
	iters: 200, epoch: 26 | loss: 0.6180493
	speed: 0.0474s/iter; left time: 729.6136s
Epoch: 26 cost time: 10.469243049621582
Epoch: 26, Steps: 208 | Train Loss: 0.595 Vali Loss: 9.072 Vali Acc: 0.122 Test Loss: 9.072 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.4472983
	speed: 0.2718s/iter; left time: 4156.9976s
	iters: 200, epoch: 27 | loss: 0.3709679
	speed: 0.0415s/iter; left time: 629.8047s
Epoch: 27 cost time: 9.903632879257202
Epoch: 27, Steps: 208 | Train Loss: 0.538 Vali Loss: 9.866 Vali Acc: 0.118 Test Loss: 9.866 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.5671275
	speed: 0.2636s/iter; left time: 3975.6963s
	iters: 200, epoch: 28 | loss: 0.8087851
	speed: 0.0426s/iter; left time: 638.8000s
Epoch: 28 cost time: 9.942759037017822
Epoch: 28, Steps: 208 | Train Loss: 0.540 Vali Loss: 9.330 Vali Acc: 0.115 Test Loss: 9.330 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.2632957
	speed: 0.2630s/iter; left time: 3913.2568s
	iters: 200, epoch: 29 | loss: 0.5107335
	speed: 0.0378s/iter; left time: 557.8930s
Epoch: 29 cost time: 10.057996988296509
Epoch: 29, Steps: 208 | Train Loss: 0.543 Vali Loss: 9.512 Vali Acc: 0.115 Test Loss: 9.512 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.3244435
	speed: 0.2902s/iter; left time: 4257.2664s
	iters: 200, epoch: 30 | loss: 0.9025120
	speed: 0.0430s/iter; left time: 626.7760s
Epoch: 30 cost time: 11.637536525726318
Epoch: 30, Steps: 208 | Train Loss: 0.478 Vali Loss: 9.805 Vali Acc: 0.117 Test Loss: 9.805 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12555920071577692
model parameter : 266583
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8395679
	speed: 0.0934s/iter; left time: 1932.9455s
	iters: 200, epoch: 1 | loss: 3.8275597
	speed: 0.0469s/iter; left time: 966.4156s
Epoch: 1 cost time: 14.496308326721191
Epoch: 1, Steps: 208 | Train Loss: 3.799 Vali Loss: 3.757 Vali Acc: 0.064 Test Loss: 3.757 Test Acc: 0.064
Validation loss decreased (inf --> -0.064382).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3724384
	speed: 0.2880s/iter; left time: 5901.8635s
	iters: 200, epoch: 2 | loss: 3.3858457
	speed: 0.0469s/iter; left time: 956.1641s
Epoch: 2 cost time: 10.312865495681763
Epoch: 2, Steps: 208 | Train Loss: 3.495 Vali Loss: 3.673 Vali Acc: 0.084 Test Loss: 3.673 Test Acc: 0.084
Validation loss decreased (-0.064382 --> -0.083769).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1444933
	speed: 0.2972s/iter; left time: 6028.8629s
	iters: 200, epoch: 3 | loss: 3.6423466
	speed: 0.0475s/iter; left time: 958.2895s
Epoch: 3 cost time: 11.916460275650024
Epoch: 3, Steps: 208 | Train Loss: 3.201 Vali Loss: 3.809 Vali Acc: 0.088 Test Loss: 3.809 Test Acc: 0.088
Validation loss decreased (-0.083769 --> -0.088241).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7972751
	speed: 0.2832s/iter; left time: 5686.7039s
	iters: 200, epoch: 4 | loss: 3.0084648
	speed: 0.0438s/iter; left time: 874.4217s
Epoch: 4 cost time: 10.838391542434692
Epoch: 4, Steps: 208 | Train Loss: 3.005 Vali Loss: 3.937 Vali Acc: 0.086 Test Loss: 3.937 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.5455256
	speed: 0.2671s/iter; left time: 5307.2200s
	iters: 200, epoch: 5 | loss: 2.9510717
	speed: 0.0453s/iter; left time: 896.1531s
Epoch: 5 cost time: 10.271666049957275
Epoch: 5, Steps: 208 | Train Loss: 2.841 Vali Loss: 4.032 Vali Acc: 0.089 Test Loss: 4.032 Test Acc: 0.089
Validation loss decreased (-0.088241 --> -0.089432).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7592199
	speed: 0.2700s/iter; left time: 5308.0148s
	iters: 200, epoch: 6 | loss: 2.3960516
	speed: 0.0433s/iter; left time: 847.4877s
Epoch: 6 cost time: 10.660934925079346
Epoch: 6, Steps: 208 | Train Loss: 2.687 Vali Loss: 4.141 Vali Acc: 0.093 Test Loss: 4.141 Test Acc: 0.093
Validation loss decreased (-0.089432 --> -0.093308).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7967875
	speed: 0.2781s/iter; left time: 5410.3069s
	iters: 200, epoch: 7 | loss: 3.0888474
	speed: 0.0412s/iter; left time: 798.1341s
Epoch: 7 cost time: 9.807427883148193
Epoch: 7, Steps: 208 | Train Loss: 2.521 Vali Loss: 4.240 Vali Acc: 0.098 Test Loss: 4.240 Test Acc: 0.098
Validation loss decreased (-0.093308 --> -0.097482).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7316360
	speed: 0.2869s/iter; left time: 5522.0679s
	iters: 200, epoch: 8 | loss: 3.1420519
	speed: 0.0476s/iter; left time: 911.5999s
Epoch: 8 cost time: 10.889848470687866
Epoch: 8, Steps: 208 | Train Loss: 2.365 Vali Loss: 4.280 Vali Acc: 0.096 Test Loss: 4.280 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.6444151
	speed: 0.2890s/iter; left time: 5502.6419s
	iters: 200, epoch: 9 | loss: 2.5279636
	speed: 0.0440s/iter; left time: 833.8484s
Epoch: 9 cost time: 10.192476272583008
Epoch: 9, Steps: 208 | Train Loss: 2.224 Vali Loss: 4.533 Vali Acc: 0.098 Test Loss: 4.533 Test Acc: 0.098
Validation loss decreased (-0.097482 --> -0.097778).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4256828
	speed: 0.2989s/iter; left time: 5628.0648s
	iters: 200, epoch: 10 | loss: 2.0747514
	speed: 0.0429s/iter; left time: 803.6226s
Epoch: 10 cost time: 11.13125991821289
Epoch: 10, Steps: 208 | Train Loss: 2.077 Vali Loss: 4.509 Vali Acc: 0.105 Test Loss: 4.509 Test Acc: 0.105
Validation loss decreased (-0.097778 --> -0.104637).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0971892
	speed: 0.2782s/iter; left time: 5180.0254s
	iters: 200, epoch: 11 | loss: 3.2829585
	speed: 0.0450s/iter; left time: 832.8262s
Epoch: 11 cost time: 10.409673929214478
Epoch: 11, Steps: 208 | Train Loss: 1.941 Vali Loss: 4.743 Vali Acc: 0.109 Test Loss: 4.743 Test Acc: 0.109
Validation loss decreased (-0.104637 --> -0.108810).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4274492
	speed: 0.2858s/iter; left time: 5262.1882s
	iters: 200, epoch: 12 | loss: 1.9676077
	speed: 0.0500s/iter; left time: 914.8592s
Epoch: 12 cost time: 11.297459363937378
Epoch: 12, Steps: 208 | Train Loss: 1.825 Vali Loss: 4.828 Vali Acc: 0.104 Test Loss: 4.828 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4073669
	speed: 0.2655s/iter; left time: 4833.3815s
	iters: 200, epoch: 13 | loss: 1.6848456
	speed: 0.0437s/iter; left time: 790.6806s
Epoch: 13 cost time: 10.090177536010742
Epoch: 13, Steps: 208 | Train Loss: 1.694 Vali Loss: 4.988 Vali Acc: 0.104 Test Loss: 4.988 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.8444506
	speed: 0.2771s/iter; left time: 4986.1958s
	iters: 200, epoch: 14 | loss: 1.8105525
	speed: 0.0393s/iter; left time: 703.2566s
Epoch: 14 cost time: 9.88383150100708
Epoch: 14, Steps: 208 | Train Loss: 1.637 Vali Loss: 5.318 Vali Acc: 0.096 Test Loss: 5.318 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2487966
	speed: 0.2529s/iter; left time: 4498.7889s
	iters: 200, epoch: 15 | loss: 1.5816600
	speed: 0.0458s/iter; left time: 810.7060s
Epoch: 15 cost time: 10.892189741134644
Epoch: 15, Steps: 208 | Train Loss: 1.528 Vali Loss: 5.343 Vali Acc: 0.109 Test Loss: 5.343 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1059433
	speed: 0.2545s/iter; left time: 4474.6871s
	iters: 200, epoch: 16 | loss: 1.9381678
	speed: 0.0378s/iter; left time: 660.4635s
Epoch: 16 cost time: 9.614215850830078
Epoch: 16, Steps: 208 | Train Loss: 1.416 Vali Loss: 5.613 Vali Acc: 0.101 Test Loss: 5.613 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1433661
	speed: 0.2848s/iter; left time: 4947.9575s
	iters: 200, epoch: 17 | loss: 2.3125393
	speed: 0.0454s/iter; left time: 783.5843s
Epoch: 17 cost time: 10.77265191078186
Epoch: 17, Steps: 208 | Train Loss: 1.364 Vali Loss: 5.909 Vali Acc: 0.100 Test Loss: 5.909 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.1476623
	speed: 0.3088s/iter; left time: 5299.7437s
	iters: 200, epoch: 18 | loss: 1.7511662
	speed: 0.0452s/iter; left time: 770.8835s
Epoch: 18 cost time: 10.857836723327637
Epoch: 18, Steps: 208 | Train Loss: 1.269 Vali Loss: 6.221 Vali Acc: 0.103 Test Loss: 6.221 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0600603
	speed: 0.2883s/iter; left time: 4888.2320s
	iters: 200, epoch: 19 | loss: 1.1345220
	speed: 0.0461s/iter; left time: 777.1723s
Epoch: 19 cost time: 10.740205764770508
Epoch: 19, Steps: 208 | Train Loss: 1.208 Vali Loss: 6.314 Vali Acc: 0.106 Test Loss: 6.314 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.3602209
	speed: 0.2737s/iter; left time: 4583.7107s
	iters: 200, epoch: 20 | loss: 1.5763317
	speed: 0.0415s/iter; left time: 691.5576s
Epoch: 20 cost time: 10.513121366500854
Epoch: 20, Steps: 208 | Train Loss: 1.121 Vali Loss: 6.545 Vali Acc: 0.100 Test Loss: 6.545 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.9972537
	speed: 0.2514s/iter; left time: 4158.1295s
	iters: 200, epoch: 21 | loss: 0.9001166
	speed: 0.0491s/iter; left time: 808.0266s
Epoch: 21 cost time: 10.566446542739868
Epoch: 21, Steps: 208 | Train Loss: 1.065 Vali Loss: 6.812 Vali Acc: 0.103 Test Loss: 6.812 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10885773933790635
model parameter : 184311
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0539012
	speed: 0.0879s/iter; left time: 1818.9692s
	iters: 200, epoch: 1 | loss: 3.6730547
	speed: 0.0518s/iter; left time: 1067.5226s
Epoch: 1 cost time: 14.360162734985352
Epoch: 1, Steps: 208 | Train Loss: 3.797 Vali Loss: 3.712 Vali Acc: 0.060 Test Loss: 3.712 Test Acc: 0.060
Validation loss decreased (inf --> -0.059611).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7130053
	speed: 0.2940s/iter; left time: 6025.5065s
	iters: 200, epoch: 2 | loss: 3.6463318
	speed: 0.0511s/iter; left time: 1042.9947s
Epoch: 2 cost time: 11.554248809814453
Epoch: 2, Steps: 208 | Train Loss: 3.509 Vali Loss: 3.701 Vali Acc: 0.077 Test Loss: 3.701 Test Acc: 0.077
Validation loss decreased (-0.059611 --> -0.077207).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7625670
	speed: 0.2991s/iter; left time: 6066.3369s
	iters: 200, epoch: 3 | loss: 3.2938170
	speed: 0.0503s/iter; left time: 1016.2655s
Epoch: 3 cost time: 12.04161810874939
Epoch: 3, Steps: 208 | Train Loss: 3.241 Vali Loss: 3.662 Vali Acc: 0.082 Test Loss: 3.662 Test Acc: 0.082
Validation loss decreased (-0.077207 --> -0.082278).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8469203
	speed: 0.2745s/iter; left time: 5510.2671s
	iters: 200, epoch: 4 | loss: 3.0982432
	speed: 0.0518s/iter; left time: 1035.2222s
Epoch: 4 cost time: 11.230309963226318
Epoch: 4, Steps: 208 | Train Loss: 3.071 Vali Loss: 3.775 Vali Acc: 0.082 Test Loss: 3.775 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.9599249
	speed: 0.2905s/iter; left time: 5771.2825s
	iters: 200, epoch: 5 | loss: 3.2320557
	speed: 0.0494s/iter; left time: 977.1246s
Epoch: 5 cost time: 11.817105293273926
Epoch: 5, Steps: 208 | Train Loss: 2.921 Vali Loss: 3.749 Vali Acc: 0.093 Test Loss: 3.749 Test Acc: 0.093
Validation loss decreased (-0.082278 --> -0.092715).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4795501
	speed: 0.2840s/iter; left time: 5583.7012s
	iters: 200, epoch: 6 | loss: 2.7435687
	speed: 0.0535s/iter; left time: 1046.4270s
Epoch: 6 cost time: 12.36833643913269
Epoch: 6, Steps: 208 | Train Loss: 2.809 Vali Loss: 3.887 Vali Acc: 0.090 Test Loss: 3.887 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.8067760
	speed: 0.3074s/iter; left time: 5980.3645s
	iters: 200, epoch: 7 | loss: 3.2786739
	speed: 0.0512s/iter; left time: 991.5088s
Epoch: 7 cost time: 11.792977571487427
Epoch: 7, Steps: 208 | Train Loss: 2.674 Vali Loss: 3.911 Vali Acc: 0.093 Test Loss: 3.911 Test Acc: 0.093
Validation loss decreased (-0.092715 --> -0.093310).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7780697
	speed: 0.3230s/iter; left time: 6217.0253s
	iters: 200, epoch: 8 | loss: 3.1138031
	speed: 0.0501s/iter; left time: 959.1022s
Epoch: 8 cost time: 11.370749950408936
Epoch: 8, Steps: 208 | Train Loss: 2.542 Vali Loss: 3.978 Vali Acc: 0.092 Test Loss: 3.978 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5869648
	speed: 0.3130s/iter; left time: 5959.4764s
	iters: 200, epoch: 9 | loss: 2.8570876
	speed: 0.0492s/iter; left time: 930.9604s
Epoch: 9 cost time: 12.265650510787964
Epoch: 9, Steps: 208 | Train Loss: 2.417 Vali Loss: 4.002 Vali Acc: 0.094 Test Loss: 4.002 Test Acc: 0.094
Validation loss decreased (-0.093310 --> -0.093906).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0043228
	speed: 0.3104s/iter; left time: 5845.4502s
	iters: 200, epoch: 10 | loss: 2.2037706
	speed: 0.0548s/iter; left time: 1026.2365s
Epoch: 10 cost time: 13.471238851547241
Epoch: 10, Steps: 208 | Train Loss: 2.303 Vali Loss: 4.077 Vali Acc: 0.103 Test Loss: 4.077 Test Acc: 0.103
Validation loss decreased (-0.093906 --> -0.103449).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6752795
	speed: 0.2984s/iter; left time: 5556.8665s
	iters: 200, epoch: 11 | loss: 2.4659474
	speed: 0.0494s/iter; left time: 914.5627s
Epoch: 11 cost time: 11.194570779800415
Epoch: 11, Steps: 208 | Train Loss: 2.183 Vali Loss: 4.272 Vali Acc: 0.099 Test Loss: 4.272 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.6006954
	speed: 0.2935s/iter; left time: 5404.4715s
	iters: 200, epoch: 12 | loss: 2.2174964
	speed: 0.0469s/iter; left time: 858.7335s
Epoch: 12 cost time: 11.211918354034424
Epoch: 12, Steps: 208 | Train Loss: 2.069 Vali Loss: 4.286 Vali Acc: 0.106 Test Loss: 4.286 Test Acc: 0.106
Validation loss decreased (-0.103449 --> -0.105534).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7946615
	speed: 0.2827s/iter; left time: 5146.2775s
	iters: 200, epoch: 13 | loss: 2.2545352
	speed: 0.0544s/iter; left time: 985.5418s
Epoch: 13 cost time: 11.511627197265625
Epoch: 13, Steps: 208 | Train Loss: 1.990 Vali Loss: 4.382 Vali Acc: 0.104 Test Loss: 4.382 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.8693118
	speed: 0.2978s/iter; left time: 5358.9684s
	iters: 200, epoch: 14 | loss: 2.3219452
	speed: 0.0408s/iter; left time: 729.5321s
Epoch: 14 cost time: 10.648985147476196
Epoch: 14, Steps: 208 | Train Loss: 1.885 Vali Loss: 4.591 Vali Acc: 0.107 Test Loss: 4.591 Test Acc: 0.107
Validation loss decreased (-0.105534 --> -0.107022).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8317429
	speed: 0.2806s/iter; left time: 4990.8977s
	iters: 200, epoch: 15 | loss: 1.7441185
	speed: 0.0474s/iter; left time: 838.1550s
Epoch: 15 cost time: 10.27339482307434
Epoch: 15, Steps: 208 | Train Loss: 1.804 Vali Loss: 4.743 Vali Acc: 0.103 Test Loss: 4.743 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.0478501
	speed: 0.3026s/iter; left time: 5319.5986s
	iters: 200, epoch: 16 | loss: 2.1445465
	speed: 0.0499s/iter; left time: 872.2923s
Epoch: 16 cost time: 11.570184707641602
Epoch: 16, Steps: 208 | Train Loss: 1.720 Vali Loss: 4.796 Vali Acc: 0.106 Test Loss: 4.796 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2781603
	speed: 0.3002s/iter; left time: 5215.2512s
	iters: 200, epoch: 17 | loss: 1.3039740
	speed: 0.0489s/iter; left time: 844.7688s
Epoch: 17 cost time: 11.857209920883179
Epoch: 17, Steps: 208 | Train Loss: 1.632 Vali Loss: 5.050 Vali Acc: 0.107 Test Loss: 5.050 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.4813470
	speed: 0.2798s/iter; left time: 4802.8132s
	iters: 200, epoch: 18 | loss: 2.1846220
	speed: 0.0502s/iter; left time: 856.9678s
Epoch: 18 cost time: 11.842565774917603
Epoch: 18, Steps: 208 | Train Loss: 1.541 Vali Loss: 5.193 Vali Acc: 0.105 Test Loss: 5.193 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.3576880
	speed: 0.2629s/iter; left time: 4458.6398s
	iters: 200, epoch: 19 | loss: 1.4740351
	speed: 0.0493s/iter; left time: 831.1322s
Epoch: 19 cost time: 11.48548412322998
Epoch: 19, Steps: 208 | Train Loss: 1.493 Vali Loss: 5.426 Vali Acc: 0.109 Test Loss: 5.426 Test Acc: 0.109
Validation loss decreased (-0.107022 --> -0.109102).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7384146
	speed: 0.3025s/iter; left time: 5065.8789s
	iters: 200, epoch: 20 | loss: 1.1951444
	speed: 0.0497s/iter; left time: 827.2420s
Epoch: 20 cost time: 10.840802431106567
Epoch: 20, Steps: 208 | Train Loss: 1.447 Vali Loss: 5.624 Vali Acc: 0.107 Test Loss: 5.624 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.0480362
	speed: 0.3027s/iter; left time: 5006.2560s
	iters: 200, epoch: 21 | loss: 1.2118376
	speed: 0.0508s/iter; left time: 835.1264s
Epoch: 21 cost time: 12.050176620483398
Epoch: 21, Steps: 208 | Train Loss: 1.348 Vali Loss: 5.705 Vali Acc: 0.109 Test Loss: 5.705 Test Acc: 0.109
Validation loss decreased (-0.109102 --> -0.109397).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0579128
	speed: 0.2835s/iter; left time: 4630.8153s
	iters: 200, epoch: 22 | loss: 1.3014072
	speed: 0.0492s/iter; left time: 798.2293s
Epoch: 22 cost time: 11.245789289474487
Epoch: 22, Steps: 208 | Train Loss: 1.290 Vali Loss: 6.011 Vali Acc: 0.104 Test Loss: 6.011 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2675909
	speed: 0.2692s/iter; left time: 4341.6508s
	iters: 200, epoch: 23 | loss: 2.0555606
	speed: 0.0475s/iter; left time: 760.7902s
Epoch: 23 cost time: 10.346885681152344
Epoch: 23, Steps: 208 | Train Loss: 1.254 Vali Loss: 6.187 Vali Acc: 0.100 Test Loss: 6.187 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.0359743
	speed: 0.3007s/iter; left time: 4786.9826s
	iters: 200, epoch: 24 | loss: 1.6240984
	speed: 0.0460s/iter; left time: 728.2909s
Epoch: 24 cost time: 10.577853679656982
Epoch: 24, Steps: 208 | Train Loss: 1.211 Vali Loss: 6.277 Vali Acc: 0.106 Test Loss: 6.277 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.8904260
	speed: 0.3059s/iter; left time: 4805.1079s
	iters: 200, epoch: 25 | loss: 1.8830107
	speed: 0.0512s/iter; left time: 798.9652s
Epoch: 25 cost time: 11.815874338150024
Epoch: 25, Steps: 208 | Train Loss: 1.167 Vali Loss: 6.491 Vali Acc: 0.104 Test Loss: 6.491 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.6699007
	speed: 0.2989s/iter; left time: 4632.9969s
	iters: 200, epoch: 26 | loss: 1.7290889
	speed: 0.0551s/iter; left time: 849.3231s
Epoch: 26 cost time: 13.085005521774292
Epoch: 26, Steps: 208 | Train Loss: 1.142 Vali Loss: 6.631 Vali Acc: 0.106 Test Loss: 6.631 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.2302282
	speed: 0.2926s/iter; left time: 4474.2983s
	iters: 200, epoch: 27 | loss: 0.9495903
	speed: 0.0473s/iter; left time: 718.6586s
Epoch: 27 cost time: 11.318567991256714
Epoch: 27, Steps: 208 | Train Loss: 1.075 Vali Loss: 6.733 Vali Acc: 0.108 Test Loss: 6.733 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.9438350
	speed: 0.3113s/iter; left time: 4695.5032s
	iters: 200, epoch: 28 | loss: 0.9836009
	speed: 0.0557s/iter; left time: 834.9509s
Epoch: 28 cost time: 12.263197660446167
Epoch: 28, Steps: 208 | Train Loss: 1.044 Vali Loss: 7.097 Vali Acc: 0.112 Test Loss: 7.097 Test Acc: 0.112
Validation loss decreased (-0.109397 --> -0.112366).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.8688967
	speed: 0.3227s/iter; left time: 4801.0322s
	iters: 200, epoch: 29 | loss: 1.7365924
	speed: 0.0484s/iter; left time: 714.8334s
Epoch: 29 cost time: 13.259459495544434
Epoch: 29, Steps: 208 | Train Loss: 0.990 Vali Loss: 7.053 Vali Acc: 0.110 Test Loss: 7.053 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.7231120
	speed: 0.2771s/iter; left time: 4064.3163s
	iters: 200, epoch: 30 | loss: 2.4668932
	speed: 0.0476s/iter; left time: 692.9800s
Epoch: 30 cost time: 11.191911220550537
Epoch: 30, Steps: 208 | Train Loss: 0.951 Vali Loss: 7.312 Vali Acc: 0.107 Test Loss: 7.312 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.9842266
	speed: 0.2763s/iter; left time: 3995.4671s
	iters: 200, epoch: 31 | loss: 1.2691877
	speed: 0.0439s/iter; left time: 630.8945s
Epoch: 31 cost time: 10.956997394561768
Epoch: 31, Steps: 208 | Train Loss: 0.938 Vali Loss: 7.421 Vali Acc: 0.112 Test Loss: 7.421 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.3952763
	speed: 0.2982s/iter; left time: 4249.5394s
	iters: 200, epoch: 32 | loss: 1.5781624
	speed: 0.0423s/iter; left time: 598.5176s
Epoch: 32 cost time: 10.862199783325195
Epoch: 32, Steps: 208 | Train Loss: 0.888 Vali Loss: 7.598 Vali Acc: 0.110 Test Loss: 7.598 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.7550566
	speed: 0.3041s/iter; left time: 4271.5254s
	iters: 200, epoch: 33 | loss: 1.5263981
	speed: 0.0477s/iter; left time: 664.5302s
Epoch: 33 cost time: 11.671368837356567
Epoch: 33, Steps: 208 | Train Loss: 0.852 Vali Loss: 7.914 Vali Acc: 0.103 Test Loss: 7.914 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.7240034
	speed: 0.2987s/iter; left time: 4132.7746s
	iters: 200, epoch: 34 | loss: 0.7543576
	speed: 0.0485s/iter; left time: 666.8970s
Epoch: 34 cost time: 11.305518865585327
Epoch: 34, Steps: 208 | Train Loss: 0.852 Vali Loss: 7.850 Vali Acc: 0.109 Test Loss: 7.850 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.0885690
	speed: 0.2793s/iter; left time: 3806.8120s
	iters: 200, epoch: 35 | loss: 0.9419456
	speed: 0.0448s/iter; left time: 606.0791s
Epoch: 35 cost time: 11.10178017616272
Epoch: 35, Steps: 208 | Train Loss: 0.802 Vali Loss: 8.004 Vali Acc: 0.106 Test Loss: 8.004 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.5079037
	speed: 0.3177s/iter; left time: 4263.6304s
	iters: 200, epoch: 36 | loss: 0.3683117
	speed: 0.0464s/iter; left time: 617.6446s
Epoch: 36 cost time: 12.120032548904419
Epoch: 36, Steps: 208 | Train Loss: 0.767 Vali Loss: 8.296 Vali Acc: 0.108 Test Loss: 8.296 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 1.2566726
	speed: 0.2817s/iter; left time: 3721.8739s
	iters: 200, epoch: 37 | loss: 0.7650084
	speed: 0.0424s/iter; left time: 555.5232s
Epoch: 37 cost time: 10.61190938949585
Epoch: 37, Steps: 208 | Train Loss: 0.744 Vali Loss: 8.555 Vali Acc: 0.106 Test Loss: 8.555 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.8910630
	speed: 0.2651s/iter; left time: 3447.5291s
	iters: 200, epoch: 38 | loss: 0.8206051
	speed: 0.0468s/iter; left time: 603.5270s
Epoch: 38 cost time: 10.444355010986328
Epoch: 38, Steps: 208 | Train Loss: 0.722 Vali Loss: 8.824 Vali Acc: 0.112 Test Loss: 8.824 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11243662391887861
model parameter : 150071
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8555810
	speed: 0.0850s/iter; left time: 1760.3118s
	iters: 200, epoch: 1 | loss: 4.1262531
	speed: 0.0397s/iter; left time: 818.6527s
Epoch: 1 cost time: 13.07108736038208
Epoch: 1, Steps: 208 | Train Loss: 3.773 Vali Loss: 3.705 Vali Acc: 0.051 Test Loss: 3.705 Test Acc: 0.051
Validation loss decreased (inf --> -0.050962).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6588783
	speed: 0.2325s/iter; left time: 4764.5985s
	iters: 200, epoch: 2 | loss: 3.6433272
	speed: 0.0442s/iter; left time: 902.0983s
Epoch: 2 cost time: 10.231180429458618
Epoch: 2, Steps: 208 | Train Loss: 3.567 Vali Loss: 3.651 Vali Acc: 0.066 Test Loss: 3.651 Test Acc: 0.066
Validation loss decreased (-0.050962 --> -0.066173).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2425296
	speed: 0.2559s/iter; left time: 5191.2636s
	iters: 200, epoch: 3 | loss: 3.3736129
	speed: 0.0439s/iter; left time: 886.9931s
Epoch: 3 cost time: 9.801246643066406
Epoch: 3, Steps: 208 | Train Loss: 3.331 Vali Loss: 3.655 Vali Acc: 0.079 Test Loss: 3.655 Test Acc: 0.079
Validation loss decreased (-0.066173 --> -0.079295).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3143125
	speed: 0.2413s/iter; left time: 4844.3968s
	iters: 200, epoch: 4 | loss: 3.2342658
	speed: 0.0426s/iter; left time: 851.6008s
Epoch: 4 cost time: 9.5071439743042
Epoch: 4, Steps: 208 | Train Loss: 3.169 Vali Loss: 3.693 Vali Acc: 0.083 Test Loss: 3.693 Test Acc: 0.083
Validation loss decreased (-0.079295 --> -0.082874).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1832948
	speed: 0.2600s/iter; left time: 5165.0477s
	iters: 200, epoch: 5 | loss: 3.1765804
	speed: 0.0389s/iter; left time: 768.1840s
Epoch: 5 cost time: 9.36789584159851
Epoch: 5, Steps: 208 | Train Loss: 3.028 Vali Loss: 3.718 Vali Acc: 0.089 Test Loss: 3.718 Test Acc: 0.089
Validation loss decreased (-0.082874 --> -0.088540).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0081258
	speed: 0.2499s/iter; left time: 4913.5153s
	iters: 200, epoch: 6 | loss: 2.5142946
	speed: 0.0435s/iter; left time: 851.7328s
Epoch: 6 cost time: 9.959399700164795
Epoch: 6, Steps: 208 | Train Loss: 2.897 Vali Loss: 3.713 Vali Acc: 0.100 Test Loss: 3.713 Test Acc: 0.100
Validation loss decreased (-0.088540 --> -0.100172).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8708007
	speed: 0.2411s/iter; left time: 4689.7376s
	iters: 200, epoch: 7 | loss: 2.9123905
	speed: 0.0402s/iter; left time: 778.8306s
Epoch: 7 cost time: 9.638881921768188
Epoch: 7, Steps: 208 | Train Loss: 2.785 Vali Loss: 3.748 Vali Acc: 0.101 Test Loss: 3.748 Test Acc: 0.101
Validation loss decreased (-0.100172 --> -0.100470).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9615357
	speed: 0.2492s/iter; left time: 4794.9044s
	iters: 200, epoch: 8 | loss: 2.2471581
	speed: 0.0377s/iter; left time: 722.2831s
Epoch: 8 cost time: 9.377420425415039
Epoch: 8, Steps: 208 | Train Loss: 2.697 Vali Loss: 3.734 Vali Acc: 0.106 Test Loss: 3.734 Test Acc: 0.106
Validation loss decreased (-0.100470 --> -0.105838).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9522974
	speed: 0.2393s/iter; left time: 4556.1396s
	iters: 200, epoch: 9 | loss: 2.5025816
	speed: 0.0416s/iter; left time: 788.3759s
Epoch: 9 cost time: 8.984977960586548
Epoch: 9, Steps: 208 | Train Loss: 2.588 Vali Loss: 3.908 Vali Acc: 0.109 Test Loss: 3.908 Test Acc: 0.109
Validation loss decreased (-0.105838 --> -0.109117).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9568462
	speed: 0.2292s/iter; left time: 4315.2038s
	iters: 200, epoch: 10 | loss: 2.5823932
	speed: 0.0378s/iter; left time: 708.7413s
Epoch: 10 cost time: 9.045294284820557
Epoch: 10, Steps: 208 | Train Loss: 2.539 Vali Loss: 3.937 Vali Acc: 0.100 Test Loss: 3.937 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.1278808
	speed: 0.2470s/iter; left time: 4598.8854s
	iters: 200, epoch: 11 | loss: 3.2134070
	speed: 0.0401s/iter; left time: 741.9393s
Epoch: 11 cost time: 9.1808602809906
Epoch: 11, Steps: 208 | Train Loss: 2.423 Vali Loss: 3.929 Vali Acc: 0.101 Test Loss: 3.929 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.6421266
	speed: 0.2365s/iter; left time: 4353.8354s
	iters: 200, epoch: 12 | loss: 2.6915865
	speed: 0.0355s/iter; left time: 650.1869s
Epoch: 12 cost time: 8.43857717514038
Epoch: 12, Steps: 208 | Train Loss: 2.363 Vali Loss: 4.111 Vali Acc: 0.115 Test Loss: 4.111 Test Acc: 0.115
Validation loss decreased (-0.109117 --> -0.114483).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.6791906
	speed: 0.2438s/iter; left time: 4438.1313s
	iters: 200, epoch: 13 | loss: 3.2460968
	speed: 0.0422s/iter; left time: 764.2236s
Epoch: 13 cost time: 9.872004985809326
Epoch: 13, Steps: 208 | Train Loss: 2.280 Vali Loss: 4.083 Vali Acc: 0.106 Test Loss: 4.083 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.3817978
	speed: 0.2347s/iter; left time: 4223.3069s
	iters: 200, epoch: 14 | loss: 2.6184289
	speed: 0.0476s/iter; left time: 852.7565s
Epoch: 14 cost time: 10.052852869033813
Epoch: 14, Steps: 208 | Train Loss: 2.225 Vali Loss: 4.131 Vali Acc: 0.113 Test Loss: 4.131 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.1728222
	speed: 0.2329s/iter; left time: 4142.5994s
	iters: 200, epoch: 15 | loss: 2.0282490
	speed: 0.0403s/iter; left time: 712.2283s
Epoch: 15 cost time: 9.04446268081665
Epoch: 15, Steps: 208 | Train Loss: 2.159 Vali Loss: 4.124 Vali Acc: 0.106 Test Loss: 4.124 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.3710632
	speed: 0.2214s/iter; left time: 3892.9432s
	iters: 200, epoch: 16 | loss: 2.4041488
	speed: 0.0348s/iter; left time: 608.1441s
Epoch: 16 cost time: 8.30135726928711
Epoch: 16, Steps: 208 | Train Loss: 2.067 Vali Loss: 4.273 Vali Acc: 0.115 Test Loss: 4.273 Test Acc: 0.115
Validation loss decreased (-0.114483 --> -0.115376).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7542526
	speed: 0.2372s/iter; left time: 4120.1265s
	iters: 200, epoch: 17 | loss: 2.0901680
	speed: 0.0443s/iter; left time: 765.2008s
Epoch: 17 cost time: 10.073318004608154
Epoch: 17, Steps: 208 | Train Loss: 1.990 Vali Loss: 4.378 Vali Acc: 0.110 Test Loss: 4.378 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.2551134
	speed: 0.2400s/iter; left time: 4119.8327s
	iters: 200, epoch: 18 | loss: 2.3930650
	speed: 0.0443s/iter; left time: 756.0546s
Epoch: 18 cost time: 10.466965675354004
Epoch: 18, Steps: 208 | Train Loss: 1.937 Vali Loss: 4.584 Vali Acc: 0.106 Test Loss: 4.584 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 2.5743015
	speed: 0.2405s/iter; left time: 4077.5851s
	iters: 200, epoch: 19 | loss: 2.6920443
	speed: 0.0423s/iter; left time: 713.8043s
Epoch: 19 cost time: 9.787114381790161
Epoch: 19, Steps: 208 | Train Loss: 1.850 Vali Loss: 4.592 Vali Acc: 0.112 Test Loss: 4.592 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.8409630
	speed: 0.2398s/iter; left time: 4016.2801s
	iters: 200, epoch: 20 | loss: 1.7091618
	speed: 0.0428s/iter; left time: 713.3888s
Epoch: 20 cost time: 10.657992601394653
Epoch: 20, Steps: 208 | Train Loss: 1.793 Vali Loss: 4.677 Vali Acc: 0.114 Test Loss: 4.677 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.9195231
	speed: 0.2411s/iter; left time: 3988.6638s
	iters: 200, epoch: 21 | loss: 1.8530704
	speed: 0.0388s/iter; left time: 637.4929s
Epoch: 21 cost time: 9.150070190429688
Epoch: 21, Steps: 208 | Train Loss: 1.761 Vali Loss: 4.765 Vali Acc: 0.107 Test Loss: 4.765 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.9812844
	speed: 0.2670s/iter; left time: 4361.4204s
	iters: 200, epoch: 22 | loss: 1.9452841
	speed: 0.0410s/iter; left time: 665.0142s
Epoch: 22 cost time: 9.42233395576477
Epoch: 22, Steps: 208 | Train Loss: 1.699 Vali Loss: 5.047 Vali Acc: 0.109 Test Loss: 5.047 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.5291802
	speed: 0.2677s/iter; left time: 4316.7984s
	iters: 200, epoch: 23 | loss: 1.8800414
	speed: 0.0510s/iter; left time: 817.4310s
Epoch: 23 cost time: 12.188952207565308
Epoch: 23, Steps: 208 | Train Loss: 1.629 Vali Loss: 5.158 Vali Acc: 0.106 Test Loss: 5.158 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.0725012
	speed: 0.2738s/iter; left time: 4357.5839s
	iters: 200, epoch: 24 | loss: 2.3016055
	speed: 0.0490s/iter; left time: 775.5259s
Epoch: 24 cost time: 11.397346258163452
Epoch: 24, Steps: 208 | Train Loss: 1.585 Vali Loss: 5.120 Vali Acc: 0.115 Test Loss: 5.120 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.7443750
	speed: 0.2697s/iter; left time: 4236.9300s
	iters: 200, epoch: 25 | loss: 1.0887718
	speed: 0.0496s/iter; left time: 773.7182s
Epoch: 25 cost time: 11.226174116134644
Epoch: 25, Steps: 208 | Train Loss: 1.537 Vali Loss: 5.168 Vali Acc: 0.119 Test Loss: 5.168 Test Acc: 0.119
Validation loss decreased (-0.115376 --> -0.118648).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.4800159
	speed: 0.2665s/iter; left time: 4131.1928s
	iters: 200, epoch: 26 | loss: 2.0214686
	speed: 0.0457s/iter; left time: 704.4943s
Epoch: 26 cost time: 10.304469585418701
Epoch: 26, Steps: 208 | Train Loss: 1.511 Vali Loss: 5.432 Vali Acc: 0.110 Test Loss: 5.432 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.1818864
	speed: 0.2629s/iter; left time: 4020.9548s
	iters: 200, epoch: 27 | loss: 1.7988049
	speed: 0.0469s/iter; left time: 712.8454s
Epoch: 27 cost time: 10.785805463790894
Epoch: 27, Steps: 208 | Train Loss: 1.454 Vali Loss: 5.528 Vali Acc: 0.113 Test Loss: 5.528 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.2704498
	speed: 0.2499s/iter; left time: 3769.9283s
	iters: 200, epoch: 28 | loss: 1.6463414
	speed: 0.0481s/iter; left time: 720.1004s
Epoch: 28 cost time: 10.430829763412476
Epoch: 28, Steps: 208 | Train Loss: 1.418 Vali Loss: 5.674 Vali Acc: 0.115 Test Loss: 5.674 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.7714145
	speed: 0.2653s/iter; left time: 3946.4375s
	iters: 200, epoch: 29 | loss: 1.4908144
	speed: 0.0435s/iter; left time: 642.8832s
Epoch: 29 cost time: 10.087214231491089
Epoch: 29, Steps: 208 | Train Loss: 1.352 Vali Loss: 5.891 Vali Acc: 0.114 Test Loss: 5.891 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.1990621
	speed: 0.2805s/iter; left time: 4113.9495s
	iters: 200, epoch: 30 | loss: 2.0036457
	speed: 0.0520s/iter; left time: 757.1825s
Epoch: 30 cost time: 11.624996423721313
Epoch: 30, Steps: 208 | Train Loss: 1.317 Vali Loss: 6.048 Vali Acc: 0.110 Test Loss: 6.048 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 2.0007470
	speed: 0.2795s/iter; left time: 4041.6738s
	iters: 200, epoch: 31 | loss: 1.4172686
	speed: 0.0507s/iter; left time: 728.0214s
Epoch: 31 cost time: 11.242128133773804
Epoch: 31, Steps: 208 | Train Loss: 1.310 Vali Loss: 6.056 Vali Acc: 0.118 Test Loss: 6.056 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.5057187
	speed: 0.2664s/iter; left time: 3796.8961s
	iters: 200, epoch: 32 | loss: 2.2528396
	speed: 0.0409s/iter; left time: 578.6137s
Epoch: 32 cost time: 9.803484916687012
Epoch: 32, Steps: 208 | Train Loss: 1.236 Vali Loss: 6.193 Vali Acc: 0.110 Test Loss: 6.193 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.3850752
	speed: 0.2307s/iter; left time: 3239.5971s
	iters: 200, epoch: 33 | loss: 1.2082886
	speed: 0.0377s/iter; left time: 525.5291s
Epoch: 33 cost time: 9.548772096633911
Epoch: 33, Steps: 208 | Train Loss: 1.216 Vali Loss: 6.397 Vali Acc: 0.111 Test Loss: 6.397 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.5593249
	speed: 0.2489s/iter; left time: 3443.6941s
	iters: 200, epoch: 34 | loss: 1.4779695
	speed: 0.0377s/iter; left time: 518.1921s
Epoch: 34 cost time: 8.722393035888672
Epoch: 34, Steps: 208 | Train Loss: 1.156 Vali Loss: 6.517 Vali Acc: 0.110 Test Loss: 6.517 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 1.2654552
	speed: 0.2625s/iter; left time: 3577.8338s
	iters: 200, epoch: 35 | loss: 0.9580965
	speed: 0.0399s/iter; left time: 539.4332s
Epoch: 35 cost time: 9.941386461257935
Epoch: 35, Steps: 208 | Train Loss: 1.156 Vali Loss: 6.708 Vali Acc: 0.110 Test Loss: 6.708 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11869967193558008
model parameter : 102199
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7816410
	speed: 0.0908s/iter; left time: 1879.0811s
	iters: 200, epoch: 1 | loss: 3.3329997
	speed: 0.0494s/iter; left time: 1017.6695s
Epoch: 1 cost time: 14.684727907180786
Epoch: 1, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.674 Vali Acc: 0.052 Test Loss: 3.674 Test Acc: 0.052
Validation loss decreased (inf --> -0.052454).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6935301
	speed: 0.2855s/iter; left time: 5851.1745s
	iters: 200, epoch: 2 | loss: 3.3293779
	speed: 0.0457s/iter; left time: 931.2789s
Epoch: 2 cost time: 10.480305910110474
Epoch: 2, Steps: 208 | Train Loss: 3.586 Vali Loss: 3.668 Vali Acc: 0.062 Test Loss: 3.668 Test Acc: 0.062
Validation loss decreased (-0.052454 --> -0.061997).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7410407
	speed: 0.2903s/iter; left time: 5888.5033s
	iters: 200, epoch: 3 | loss: 3.5240681
	speed: 0.0465s/iter; left time: 939.0996s
Epoch: 3 cost time: 10.984274864196777
Epoch: 3, Steps: 208 | Train Loss: 3.392 Vali Loss: 3.642 Vali Acc: 0.079 Test Loss: 3.642 Test Acc: 0.079
Validation loss decreased (-0.061997 --> -0.079296).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4292145
	speed: 0.2954s/iter; left time: 5931.4556s
	iters: 200, epoch: 4 | loss: 2.9154012
	speed: 0.0467s/iter; left time: 933.5887s
Epoch: 4 cost time: 11.161852359771729
Epoch: 4, Steps: 208 | Train Loss: 3.219 Vali Loss: 3.621 Vali Acc: 0.078 Test Loss: 3.621 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.7692242
	speed: 0.2951s/iter; left time: 5863.7906s
	iters: 200, epoch: 5 | loss: 2.7817612
	speed: 0.0469s/iter; left time: 927.8064s
Epoch: 5 cost time: 10.820436477661133
Epoch: 5, Steps: 208 | Train Loss: 3.101 Vali Loss: 3.637 Vali Acc: 0.083 Test Loss: 3.637 Test Acc: 0.083
Validation loss decreased (-0.079296 --> -0.083173).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7950697
	speed: 0.3091s/iter; left time: 6077.7412s
	iters: 200, epoch: 6 | loss: 3.4909074
	speed: 0.0497s/iter; left time: 972.7142s
Epoch: 6 cost time: 11.167243003845215
Epoch: 6, Steps: 208 | Train Loss: 2.997 Vali Loss: 3.558 Vali Acc: 0.090 Test Loss: 3.558 Test Acc: 0.090
Validation loss decreased (-0.083173 --> -0.089735).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0497894
	speed: 0.2910s/iter; left time: 5660.2508s
	iters: 200, epoch: 7 | loss: 3.3668139
	speed: 0.0495s/iter; left time: 957.1828s
Epoch: 7 cost time: 11.420033693313599
Epoch: 7, Steps: 208 | Train Loss: 2.910 Vali Loss: 3.606 Vali Acc: 0.095 Test Loss: 3.606 Test Acc: 0.095
Validation loss decreased (-0.089735 --> -0.094506).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9925168
	speed: 0.3045s/iter; left time: 5859.8069s
	iters: 200, epoch: 8 | loss: 2.7036197
	speed: 0.0453s/iter; left time: 866.7793s
Epoch: 8 cost time: 11.1353759765625
Epoch: 8, Steps: 208 | Train Loss: 2.836 Vali Loss: 3.758 Vali Acc: 0.095 Test Loss: 3.758 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.9170890
	speed: 0.3090s/iter; left time: 5882.1236s
	iters: 200, epoch: 9 | loss: 3.1515291
	speed: 0.0529s/iter; left time: 1001.2667s
Epoch: 9 cost time: 11.681071281433105
Epoch: 9, Steps: 208 | Train Loss: 2.740 Vali Loss: 3.711 Vali Acc: 0.098 Test Loss: 3.711 Test Acc: 0.098
Validation loss decreased (-0.094506 --> -0.098382).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6515532
	speed: 0.3126s/iter; left time: 5886.5397s
	iters: 200, epoch: 10 | loss: 3.1083181
	speed: 0.0453s/iter; left time: 847.8060s
Epoch: 10 cost time: 11.23283839225769
Epoch: 10, Steps: 208 | Train Loss: 2.645 Vali Loss: 3.706 Vali Acc: 0.102 Test Loss: 3.706 Test Acc: 0.102
Validation loss decreased (-0.098382 --> -0.101961).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2943110
	speed: 0.3060s/iter; left time: 5698.8362s
	iters: 200, epoch: 11 | loss: 2.8193624
	speed: 0.0458s/iter; left time: 849.1047s
Epoch: 11 cost time: 11.077064037322998
Epoch: 11, Steps: 208 | Train Loss: 2.569 Vali Loss: 3.797 Vali Acc: 0.097 Test Loss: 3.797 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3988504
	speed: 0.3148s/iter; left time: 5795.5455s
	iters: 200, epoch: 12 | loss: 2.2260439
	speed: 0.0459s/iter; left time: 841.2306s
Epoch: 12 cost time: 10.957848310470581
Epoch: 12, Steps: 208 | Train Loss: 2.484 Vali Loss: 3.836 Vali Acc: 0.107 Test Loss: 3.836 Test Acc: 0.107
Validation loss decreased (-0.101961 --> -0.106732).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.9507918
	speed: 0.3106s/iter; left time: 5654.8382s
	iters: 200, epoch: 13 | loss: 2.4485645
	speed: 0.0501s/iter; left time: 906.8782s
Epoch: 13 cost time: 11.322220802307129
Epoch: 13, Steps: 208 | Train Loss: 2.419 Vali Loss: 3.887 Vali Acc: 0.101 Test Loss: 3.887 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.4401774
	speed: 0.3166s/iter; left time: 5696.9604s
	iters: 200, epoch: 14 | loss: 2.2728112
	speed: 0.0497s/iter; left time: 888.9896s
Epoch: 14 cost time: 11.801530599594116
Epoch: 14, Steps: 208 | Train Loss: 2.342 Vali Loss: 3.988 Vali Acc: 0.097 Test Loss: 3.988 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.7265208
	speed: 0.3062s/iter; left time: 5446.1173s
	iters: 200, epoch: 15 | loss: 2.3830280
	speed: 0.0454s/iter; left time: 802.4768s
Epoch: 15 cost time: 10.732350826263428
Epoch: 15, Steps: 208 | Train Loss: 2.273 Vali Loss: 3.980 Vali Acc: 0.103 Test Loss: 3.980 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.7122660
	speed: 0.3115s/iter; left time: 5476.4049s
	iters: 200, epoch: 16 | loss: 2.6924262
	speed: 0.0435s/iter; left time: 761.2126s
Epoch: 16 cost time: 11.363357782363892
Epoch: 16, Steps: 208 | Train Loss: 2.225 Vali Loss: 4.083 Vali Acc: 0.096 Test Loss: 4.083 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.9287578
	speed: 0.2919s/iter; left time: 5071.0795s
	iters: 200, epoch: 17 | loss: 2.2036147
	speed: 0.0471s/iter; left time: 813.4363s
Epoch: 17 cost time: 11.34905743598938
Epoch: 17, Steps: 208 | Train Loss: 2.158 Vali Loss: 4.102 Vali Acc: 0.102 Test Loss: 4.102 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.3107171
	speed: 0.2968s/iter; left time: 5094.6767s
	iters: 200, epoch: 18 | loss: 2.1317205
	speed: 0.0564s/iter; left time: 963.0372s
Epoch: 18 cost time: 13.124544143676758
Epoch: 18, Steps: 208 | Train Loss: 2.090 Vali Loss: 4.194 Vali Acc: 0.104 Test Loss: 4.194 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.6045032
	speed: 0.3011s/iter; left time: 5106.2919s
	iters: 200, epoch: 19 | loss: 1.6582404
	speed: 0.0516s/iter; left time: 870.2104s
Epoch: 19 cost time: 11.67203950881958
Epoch: 19, Steps: 208 | Train Loss: 2.044 Vali Loss: 4.378 Vali Acc: 0.101 Test Loss: 4.378 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.6917956
	speed: 0.2913s/iter; left time: 4878.7427s
	iters: 200, epoch: 20 | loss: 1.8227990
	speed: 0.0498s/iter; left time: 829.8011s
Epoch: 20 cost time: 11.185445308685303
Epoch: 20, Steps: 208 | Train Loss: 1.964 Vali Loss: 4.435 Vali Acc: 0.101 Test Loss: 4.435 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.8974930
	speed: 0.3070s/iter; left time: 5078.4376s
	iters: 200, epoch: 21 | loss: 2.5181959
	speed: 0.0403s/iter; left time: 662.0926s
Epoch: 21 cost time: 10.557249546051025
Epoch: 21, Steps: 208 | Train Loss: 1.923 Vali Loss: 4.516 Vali Acc: 0.106 Test Loss: 4.516 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.8247917
	speed: 0.2861s/iter; left time: 4672.5167s
	iters: 200, epoch: 22 | loss: 2.0761528
	speed: 0.0538s/iter; left time: 872.6536s
Epoch: 22 cost time: 11.71998643875122
Epoch: 22, Steps: 208 | Train Loss: 1.876 Vali Loss: 4.565 Vali Acc: 0.112 Test Loss: 4.565 Test Acc: 0.112
Validation loss decreased (-0.106732 --> -0.111794).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.4401339
	speed: 0.2929s/iter; left time: 4723.6048s
	iters: 200, epoch: 23 | loss: 2.0583396
	speed: 0.0459s/iter; left time: 735.1117s
Epoch: 23 cost time: 10.971888065338135
Epoch: 23, Steps: 208 | Train Loss: 1.831 Vali Loss: 4.742 Vali Acc: 0.101 Test Loss: 4.742 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.7178890
	speed: 0.3005s/iter; left time: 4783.2822s
	iters: 200, epoch: 24 | loss: 1.8764498
	speed: 0.0455s/iter; left time: 719.4531s
Epoch: 24 cost time: 11.420973300933838
Epoch: 24, Steps: 208 | Train Loss: 1.751 Vali Loss: 4.856 Vali Acc: 0.104 Test Loss: 4.856 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.6598943
	speed: 0.2983s/iter; left time: 4685.2679s
	iters: 200, epoch: 25 | loss: 2.7229018
	speed: 0.0469s/iter; left time: 731.6794s
Epoch: 25 cost time: 10.556519985198975
Epoch: 25, Steps: 208 | Train Loss: 1.723 Vali Loss: 4.895 Vali Acc: 0.104 Test Loss: 4.895 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.5010879
	speed: 0.3141s/iter; left time: 4869.5171s
	iters: 200, epoch: 26 | loss: 2.3762443
	speed: 0.0498s/iter; left time: 766.2920s
Epoch: 26 cost time: 11.710623025894165
Epoch: 26, Steps: 208 | Train Loss: 1.675 Vali Loss: 5.107 Vali Acc: 0.106 Test Loss: 5.107 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.9005315
	speed: 0.2956s/iter; left time: 4520.5235s
	iters: 200, epoch: 27 | loss: 2.1942809
	speed: 0.0535s/iter; left time: 812.6238s
Epoch: 27 cost time: 11.977020025253296
Epoch: 27, Steps: 208 | Train Loss: 1.630 Vali Loss: 5.134 Vali Acc: 0.103 Test Loss: 5.134 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.1685951
	speed: 0.3138s/iter; left time: 4733.1516s
	iters: 200, epoch: 28 | loss: 2.1864946
	speed: 0.0547s/iter; left time: 819.0922s
Epoch: 28 cost time: 12.110826969146729
Epoch: 28, Steps: 208 | Train Loss: 1.581 Vali Loss: 5.310 Vali Acc: 0.106 Test Loss: 5.310 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 2.0411720
	speed: 0.2897s/iter; left time: 4310.5137s
	iters: 200, epoch: 29 | loss: 1.6396666
	speed: 0.0426s/iter; left time: 629.7861s
Epoch: 29 cost time: 10.312044143676758
Epoch: 29, Steps: 208 | Train Loss: 1.542 Vali Loss: 5.369 Vali Acc: 0.105 Test Loss: 5.369 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.6964819
	speed: 0.3096s/iter; left time: 4541.2505s
	iters: 200, epoch: 30 | loss: 1.0153110
	speed: 0.0492s/iter; left time: 716.2821s
Epoch: 30 cost time: 11.490428447723389
Epoch: 30, Steps: 208 | Train Loss: 1.508 Vali Loss: 5.566 Vali Acc: 0.111 Test Loss: 5.566 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.6418077
	speed: 0.3108s/iter; left time: 4493.8830s
	iters: 200, epoch: 31 | loss: 1.2926649
	speed: 0.0412s/iter; left time: 591.0764s
Epoch: 31 cost time: 11.30811595916748
Epoch: 31, Steps: 208 | Train Loss: 1.437 Vali Loss: 5.608 Vali Acc: 0.104 Test Loss: 5.608 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.2789638
	speed: 0.3303s/iter; left time: 4707.7076s
	iters: 200, epoch: 32 | loss: 2.0197766
	speed: 0.0469s/iter; left time: 663.9235s
Epoch: 32 cost time: 12.304305076599121
Epoch: 32, Steps: 208 | Train Loss: 1.463 Vali Loss: 5.705 Vali Acc: 0.098 Test Loss: 5.705 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11184014315538324
model parameter : 81783
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9046345
	speed: 0.0813s/iter; left time: 1682.4883s
	iters: 200, epoch: 1 | loss: 3.8418708
	speed: 0.0394s/iter; left time: 810.9199s
Epoch: 1 cost time: 12.63471245765686
Epoch: 1, Steps: 208 | Train Loss: 3.773 Vali Loss: 3.655 Vali Acc: 0.051 Test Loss: 3.655 Test Acc: 0.051
Validation loss decreased (inf --> -0.050664).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7761831
	speed: 0.2697s/iter; left time: 5527.1590s
	iters: 200, epoch: 2 | loss: 4.1768999
	speed: 0.0427s/iter; left time: 871.2820s
Epoch: 2 cost time: 10.376444816589355
Epoch: 2, Steps: 208 | Train Loss: 3.614 Vali Loss: 3.683 Vali Acc: 0.056 Test Loss: 3.683 Test Acc: 0.056
Validation loss decreased (-0.050664 --> -0.056331).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2933202
	speed: 0.2670s/iter; left time: 5416.1771s
	iters: 200, epoch: 3 | loss: 3.4868245
	speed: 0.0465s/iter; left time: 938.7847s
Epoch: 3 cost time: 10.972255945205688
Epoch: 3, Steps: 208 | Train Loss: 3.495 Vali Loss: 3.600 Vali Acc: 0.071 Test Loss: 3.600 Test Acc: 0.071
Validation loss decreased (-0.056331 --> -0.071243).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1485097
	speed: 0.2767s/iter; left time: 5555.0624s
	iters: 200, epoch: 4 | loss: 3.4123797
	speed: 0.0412s/iter; left time: 822.9767s
Epoch: 4 cost time: 10.429771900177002
Epoch: 4, Steps: 208 | Train Loss: 3.323 Vali Loss: 3.558 Vali Acc: 0.077 Test Loss: 3.558 Test Acc: 0.077
Validation loss decreased (-0.071243 --> -0.076910).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0845089
	speed: 0.2643s/iter; left time: 5252.3496s
	iters: 200, epoch: 5 | loss: 3.3092883
	speed: 0.0491s/iter; left time: 970.6960s
Epoch: 5 cost time: 10.734350204467773
Epoch: 5, Steps: 208 | Train Loss: 3.194 Vali Loss: 3.580 Vali Acc: 0.076 Test Loss: 3.580 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.0318887
	speed: 0.2728s/iter; left time: 5364.3471s
	iters: 200, epoch: 6 | loss: 3.4949601
	speed: 0.0510s/iter; left time: 997.2048s
Epoch: 6 cost time: 10.891971826553345
Epoch: 6, Steps: 208 | Train Loss: 3.103 Vali Loss: 3.592 Vali Acc: 0.077 Test Loss: 3.592 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.6652255
	speed: 0.2720s/iter; left time: 5291.3296s
	iters: 200, epoch: 7 | loss: 2.6925039
	speed: 0.0497s/iter; left time: 961.8417s
Epoch: 7 cost time: 11.190482378005981
Epoch: 7, Steps: 208 | Train Loss: 3.001 Vali Loss: 3.603 Vali Acc: 0.085 Test Loss: 3.603 Test Acc: 0.085
Validation loss decreased (-0.076910 --> -0.085261).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8668017
	speed: 0.2677s/iter; left time: 5151.0835s
	iters: 200, epoch: 8 | loss: 3.6346221
	speed: 0.0435s/iter; left time: 832.7058s
Epoch: 8 cost time: 10.085082292556763
Epoch: 8, Steps: 208 | Train Loss: 2.899 Vali Loss: 3.589 Vali Acc: 0.096 Test Loss: 3.589 Test Acc: 0.096
Validation loss decreased (-0.085261 --> -0.096296).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8037496
	speed: 0.2684s/iter; left time: 5110.1511s
	iters: 200, epoch: 9 | loss: 3.2002430
	speed: 0.0425s/iter; left time: 804.2533s
Epoch: 9 cost time: 9.359454154968262
Epoch: 9, Steps: 208 | Train Loss: 2.847 Vali Loss: 3.631 Vali Acc: 0.093 Test Loss: 3.631 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.1533344
	speed: 0.2553s/iter; left time: 4806.6978s
	iters: 200, epoch: 10 | loss: 2.1343675
	speed: 0.0390s/iter; left time: 729.6960s
Epoch: 10 cost time: 9.462990283966064
Epoch: 10, Steps: 208 | Train Loss: 2.761 Vali Loss: 3.626 Vali Acc: 0.104 Test Loss: 3.626 Test Acc: 0.104
Validation loss decreased (-0.096296 --> -0.104348).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5471714
	speed: 0.2644s/iter; left time: 4923.1417s
	iters: 200, epoch: 11 | loss: 2.1933305
	speed: 0.0470s/iter; left time: 870.3990s
Epoch: 11 cost time: 10.808529376983643
Epoch: 11, Steps: 208 | Train Loss: 2.679 Vali Loss: 3.674 Vali Acc: 0.107 Test Loss: 3.674 Test Acc: 0.107
Validation loss decreased (-0.104348 --> -0.107330).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5991921
	speed: 0.2651s/iter; left time: 4880.3899s
	iters: 200, epoch: 12 | loss: 3.1541343
	speed: 0.0446s/iter; left time: 817.1778s
Epoch: 12 cost time: 10.678240537643433
Epoch: 12, Steps: 208 | Train Loss: 2.623 Vali Loss: 3.726 Vali Acc: 0.100 Test Loss: 3.726 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.6541607
	speed: 0.2682s/iter; left time: 4881.9347s
	iters: 200, epoch: 13 | loss: 2.5552447
	speed: 0.0415s/iter; left time: 752.1689s
Epoch: 13 cost time: 10.357783555984497
Epoch: 13, Steps: 208 | Train Loss: 2.555 Vali Loss: 3.759 Vali Acc: 0.097 Test Loss: 3.759 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.7045131
	speed: 0.2622s/iter; left time: 4718.3801s
	iters: 200, epoch: 14 | loss: 2.5652130
	speed: 0.0509s/iter; left time: 911.2635s
Epoch: 14 cost time: 11.265379428863525
Epoch: 14, Steps: 208 | Train Loss: 2.493 Vali Loss: 3.809 Vali Acc: 0.111 Test Loss: 3.809 Test Acc: 0.111
Validation loss decreased (-0.107330 --> -0.110907).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.3443825
	speed: 0.2821s/iter; left time: 5018.3086s
	iters: 200, epoch: 15 | loss: 2.0296104
	speed: 0.0488s/iter; left time: 863.8883s
Epoch: 15 cost time: 10.626044273376465
Epoch: 15, Steps: 208 | Train Loss: 2.425 Vali Loss: 3.911 Vali Acc: 0.106 Test Loss: 3.911 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.1277661
	speed: 0.2502s/iter; left time: 4398.5474s
	iters: 200, epoch: 16 | loss: 2.4537909
	speed: 0.0448s/iter; left time: 783.4977s
Epoch: 16 cost time: 10.451194047927856
Epoch: 16, Steps: 208 | Train Loss: 2.388 Vali Loss: 3.906 Vali Acc: 0.109 Test Loss: 3.906 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.1279159
	speed: 0.2522s/iter; left time: 4381.4355s
	iters: 200, epoch: 17 | loss: 1.8708551
	speed: 0.0400s/iter; left time: 690.7730s
Epoch: 17 cost time: 9.431722402572632
Epoch: 17, Steps: 208 | Train Loss: 2.280 Vali Loss: 4.002 Vali Acc: 0.108 Test Loss: 4.002 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.1056466
	speed: 0.2548s/iter; left time: 4373.3661s
	iters: 200, epoch: 18 | loss: 2.3497062
	speed: 0.0418s/iter; left time: 713.5183s
Epoch: 18 cost time: 10.128377199172974
Epoch: 18, Steps: 208 | Train Loss: 2.215 Vali Loss: 4.164 Vali Acc: 0.110 Test Loss: 4.164 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.3949492
	speed: 0.2494s/iter; left time: 4228.8560s
	iters: 200, epoch: 19 | loss: 2.7037113
	speed: 0.0397s/iter; left time: 669.8786s
Epoch: 19 cost time: 9.909064531326294
Epoch: 19, Steps: 208 | Train Loss: 2.180 Vali Loss: 4.229 Vali Acc: 0.106 Test Loss: 4.229 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.5447564
	speed: 0.2586s/iter; left time: 4331.4547s
	iters: 200, epoch: 20 | loss: 2.2098885
	speed: 0.0436s/iter; left time: 726.2985s
Epoch: 20 cost time: 10.41251826286316
Epoch: 20, Steps: 208 | Train Loss: 2.115 Vali Loss: 4.347 Vali Acc: 0.101 Test Loss: 4.347 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 2.1035821
	speed: 0.2649s/iter; left time: 4381.0276s
	iters: 200, epoch: 21 | loss: 2.4719863
	speed: 0.0432s/iter; left time: 710.9138s
Epoch: 21 cost time: 10.252190351486206
Epoch: 21, Steps: 208 | Train Loss: 2.057 Vali Loss: 4.371 Vali Acc: 0.102 Test Loss: 4.371 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 2.1304991
	speed: 0.2621s/iter; left time: 4280.4645s
	iters: 200, epoch: 22 | loss: 1.9848412
	speed: 0.0440s/iter; left time: 714.6089s
Epoch: 22 cost time: 10.39870572090149
Epoch: 22, Steps: 208 | Train Loss: 2.012 Vali Loss: 4.480 Vali Acc: 0.106 Test Loss: 4.480 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.8303545
	speed: 0.2756s/iter; left time: 4443.8882s
	iters: 200, epoch: 23 | loss: 1.4782041
	speed: 0.0442s/iter; left time: 708.3562s
Epoch: 23 cost time: 10.562031269073486
Epoch: 23, Steps: 208 | Train Loss: 1.957 Vali Loss: 4.503 Vali Acc: 0.109 Test Loss: 4.503 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.6515744
	speed: 0.2808s/iter; left time: 4468.8701s
	iters: 200, epoch: 24 | loss: 2.0712099
	speed: 0.0536s/iter; left time: 848.4414s
Epoch: 24 cost time: 13.045910596847534
Epoch: 24, Steps: 208 | Train Loss: 1.928 Vali Loss: 4.635 Vali Acc: 0.111 Test Loss: 4.635 Test Acc: 0.111
Validation loss decreased (-0.110907 --> -0.111197).  Saving model ...
	iters: 100, epoch: 25 | loss: 2.3993073
	speed: 0.3074s/iter; left time: 4828.4958s
	iters: 200, epoch: 25 | loss: 1.9045053
	speed: 0.0601s/iter; left time: 938.0408s
Epoch: 25 cost time: 12.553696393966675
Epoch: 25, Steps: 208 | Train Loss: 1.885 Vali Loss: 4.755 Vali Acc: 0.103 Test Loss: 4.755 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 2.6170616
	speed: 0.3096s/iter; left time: 4799.1491s
	iters: 200, epoch: 26 | loss: 2.3405111
	speed: 0.0547s/iter; left time: 842.7668s
Epoch: 26 cost time: 12.908324718475342
Epoch: 26, Steps: 208 | Train Loss: 1.831 Vali Loss: 4.877 Vali Acc: 0.102 Test Loss: 4.877 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 2.4428589
	speed: 0.3106s/iter; left time: 4750.5984s
	iters: 200, epoch: 27 | loss: 1.6987176
	speed: 0.0518s/iter; left time: 787.7536s
Epoch: 27 cost time: 11.804734468460083
Epoch: 27, Steps: 208 | Train Loss: 1.805 Vali Loss: 4.887 Vali Acc: 0.105 Test Loss: 4.887 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.6380340
	speed: 0.3011s/iter; left time: 4542.2789s
	iters: 200, epoch: 28 | loss: 1.5373306
	speed: 0.0460s/iter; left time: 689.5281s
Epoch: 28 cost time: 10.879772901535034
Epoch: 28, Steps: 208 | Train Loss: 1.739 Vali Loss: 5.015 Vali Acc: 0.103 Test Loss: 5.015 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.7000346
	speed: 0.2945s/iter; left time: 4380.9912s
	iters: 200, epoch: 29 | loss: 1.8291730
	speed: 0.0438s/iter; left time: 646.6172s
Epoch: 29 cost time: 10.54699969291687
Epoch: 29, Steps: 208 | Train Loss: 1.714 Vali Loss: 5.162 Vali Acc: 0.109 Test Loss: 5.162 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.4225820
	speed: 0.3139s/iter; left time: 4605.2301s
	iters: 200, epoch: 30 | loss: 1.7672282
	speed: 0.0478s/iter; left time: 696.0051s
Epoch: 30 cost time: 12.056376934051514
Epoch: 30, Steps: 208 | Train Loss: 1.654 Vali Loss: 5.246 Vali Acc: 0.109 Test Loss: 5.246 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.5714248
	speed: 0.3366s/iter; left time: 4867.6828s
	iters: 200, epoch: 31 | loss: 1.4802992
	speed: 0.0568s/iter; left time: 815.3945s
Epoch: 31 cost time: 12.889881134033203
Epoch: 31, Steps: 208 | Train Loss: 1.661 Vali Loss: 5.406 Vali Acc: 0.106 Test Loss: 5.406 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 1.8967558
	speed: 0.3318s/iter; left time: 4729.6252s
	iters: 200, epoch: 32 | loss: 1.7698917
	speed: 0.0526s/iter; left time: 744.0332s
Epoch: 32 cost time: 12.391150951385498
Epoch: 32, Steps: 208 | Train Loss: 1.622 Vali Loss: 5.412 Vali Acc: 0.106 Test Loss: 5.412 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 2.0477152
	speed: 0.3301s/iter; left time: 4635.8503s
	iters: 200, epoch: 33 | loss: 1.4699919
	speed: 0.0485s/iter; left time: 676.8791s
Epoch: 33 cost time: 11.837127447128296
Epoch: 33, Steps: 208 | Train Loss: 1.567 Vali Loss: 5.560 Vali Acc: 0.109 Test Loss: 5.560 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.7960346
	speed: 0.3318s/iter; left time: 4591.3453s
	iters: 200, epoch: 34 | loss: 1.6680162
	speed: 0.0513s/iter; left time: 704.0765s
Epoch: 34 cost time: 12.340146780014038
Epoch: 34, Steps: 208 | Train Loss: 1.558 Vali Loss: 5.634 Vali Acc: 0.099 Test Loss: 5.634 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11124366239188786
model parameter : 68231
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2009635
	speed: 0.0921s/iter; left time: 1906.3391s
	iters: 200, epoch: 1 | loss: 4.4409628
	speed: 0.0510s/iter; left time: 1051.2921s
Epoch: 1 cost time: 15.030100107192993
Epoch: 1, Steps: 208 | Train Loss: 4.051 Vali Loss: 4.152 Vali Acc: 0.058 Test Loss: 4.152 Test Acc: 0.058
Validation loss decreased (inf --> -0.057519).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7499337
	speed: 0.2961s/iter; left time: 6068.6898s
	iters: 200, epoch: 2 | loss: 4.0824924
	speed: 0.0519s/iter; left time: 1057.4759s
Epoch: 2 cost time: 11.882099151611328
Epoch: 2, Steps: 208 | Train Loss: 3.709 Vali Loss: 4.000 Vali Acc: 0.077 Test Loss: 4.000 Test Acc: 0.077
Validation loss decreased (-0.057519 --> -0.076608).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6342096
	speed: 0.2952s/iter; left time: 5988.6773s
	iters: 200, epoch: 3 | loss: 3.7754591
	speed: 0.0533s/iter; left time: 1075.2608s
Epoch: 3 cost time: 12.156396389007568
Epoch: 3, Steps: 208 | Train Loss: 3.201 Vali Loss: 3.627 Vali Acc: 0.090 Test Loss: 3.627 Test Acc: 0.090
Validation loss decreased (-0.076608 --> -0.090032).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4151869
	speed: 0.2933s/iter; left time: 5889.0152s
	iters: 200, epoch: 4 | loss: 3.4377525
	speed: 0.0565s/iter; left time: 1128.6713s
Epoch: 4 cost time: 12.925386905670166
Epoch: 4, Steps: 208 | Train Loss: 2.912 Vali Loss: 4.076 Vali Acc: 0.089 Test Loss: 4.076 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3722928
	speed: 0.3085s/iter; left time: 6128.8551s
	iters: 200, epoch: 5 | loss: 3.9789438
	speed: 0.0609s/iter; left time: 1203.1593s
Epoch: 5 cost time: 13.520743370056152
Epoch: 5, Steps: 208 | Train Loss: 2.744 Vali Loss: 4.317 Vali Acc: 0.089 Test Loss: 4.317 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8114520
	speed: 0.3022s/iter; left time: 5942.4021s
	iters: 200, epoch: 6 | loss: 2.6148400
	speed: 0.0685s/iter; left time: 1339.3320s
Epoch: 6 cost time: 14.713857412338257
Epoch: 6, Steps: 208 | Train Loss: 2.486 Vali Loss: 4.905 Vali Acc: 0.095 Test Loss: 4.905 Test Acc: 0.095
Validation loss decreased (-0.090032 --> -0.095388).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0336483
	speed: 0.3139s/iter; left time: 6105.4253s
	iters: 200, epoch: 7 | loss: 1.7147305
	speed: 0.0599s/iter; left time: 1159.1509s
Epoch: 7 cost time: 13.510069131851196
Epoch: 7, Steps: 208 | Train Loss: 2.208 Vali Loss: 7.669 Vali Acc: 0.055 Test Loss: 7.669 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7919378
	speed: 0.2911s/iter; left time: 5602.8897s
	iters: 200, epoch: 8 | loss: 2.0038316
	speed: 0.0470s/iter; left time: 900.3486s
Epoch: 8 cost time: 11.101927995681763
Epoch: 8, Steps: 208 | Train Loss: 1.885 Vali Loss: 5.270 Vali Acc: 0.096 Test Loss: 5.270 Test Acc: 0.096
Validation loss decreased (-0.095388 --> -0.096279).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9038998
	speed: 0.2590s/iter; left time: 4931.2893s
	iters: 200, epoch: 9 | loss: 2.2843280
	speed: 0.0517s/iter; left time: 979.7199s
Epoch: 9 cost time: 11.625460624694824
Epoch: 9, Steps: 208 | Train Loss: 1.659 Vali Loss: 5.489 Vali Acc: 0.096 Test Loss: 5.489 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6998912
	speed: 0.2843s/iter; left time: 5353.2550s
	iters: 200, epoch: 10 | loss: 1.9471216
	speed: 0.0487s/iter; left time: 912.7499s
Epoch: 10 cost time: 12.090641736984253
Epoch: 10, Steps: 208 | Train Loss: 1.451 Vali Loss: 5.785 Vali Acc: 0.109 Test Loss: 5.785 Test Acc: 0.109
Validation loss decreased (-0.096279 --> -0.109098).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6709788
	speed: 0.2986s/iter; left time: 5560.5630s
	iters: 200, epoch: 11 | loss: 1.8914191
	speed: 0.0565s/iter; left time: 1047.1298s
Epoch: 11 cost time: 12.793221712112427
Epoch: 11, Steps: 208 | Train Loss: 1.254 Vali Loss: 6.255 Vali Acc: 0.103 Test Loss: 6.255 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2872179
	speed: 0.3056s/iter; left time: 5627.0886s
	iters: 200, epoch: 12 | loss: 0.7137331
	speed: 0.0518s/iter; left time: 948.7619s
Epoch: 12 cost time: 11.643195629119873
Epoch: 12, Steps: 208 | Train Loss: 1.134 Vali Loss: 6.459 Vali Acc: 0.098 Test Loss: 6.459 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7399773
	speed: 0.2899s/iter; left time: 5276.9706s
	iters: 200, epoch: 13 | loss: 1.1136318
	speed: 0.0537s/iter; left time: 972.0267s
Epoch: 13 cost time: 12.228519439697266
Epoch: 13, Steps: 208 | Train Loss: 0.973 Vali Loss: 7.342 Vali Acc: 0.107 Test Loss: 7.342 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5331953
	speed: 0.3003s/iter; left time: 5403.9992s
	iters: 200, epoch: 14 | loss: 0.3555718
	speed: 0.0527s/iter; left time: 943.9892s
Epoch: 14 cost time: 11.995420694351196
Epoch: 14, Steps: 208 | Train Loss: 0.831 Vali Loss: 7.598 Vali Acc: 0.094 Test Loss: 7.598 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.9009637
	speed: 0.2862s/iter; left time: 5091.9056s
	iters: 200, epoch: 15 | loss: 1.1718528
	speed: 0.0467s/iter; left time: 825.8035s
Epoch: 15 cost time: 11.795737266540527
Epoch: 15, Steps: 208 | Train Loss: 0.739 Vali Loss: 8.319 Vali Acc: 0.100 Test Loss: 8.319 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4056409
	speed: 0.2909s/iter; left time: 5113.9371s
	iters: 200, epoch: 16 | loss: 1.4067287
	speed: 0.0568s/iter; left time: 992.1046s
Epoch: 16 cost time: 12.478510856628418
Epoch: 16, Steps: 208 | Train Loss: 0.669 Vali Loss: 8.756 Vali Acc: 0.101 Test Loss: 8.756 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.8822542
	speed: 0.2614s/iter; left time: 4542.0046s
	iters: 200, epoch: 17 | loss: 0.7030134
	speed: 0.0513s/iter; left time: 886.7177s
Epoch: 17 cost time: 10.985563278198242
Epoch: 17, Steps: 208 | Train Loss: 0.599 Vali Loss: 8.892 Vali Acc: 0.110 Test Loss: 8.892 Test Acc: 0.110
Validation loss decreased (-0.109098 --> -0.109962).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2968848
	speed: 0.2508s/iter; left time: 4304.6934s
	iters: 200, epoch: 18 | loss: 1.0370954
	speed: 0.0562s/iter; left time: 959.5276s
Epoch: 18 cost time: 11.919031381607056
Epoch: 18, Steps: 208 | Train Loss: 0.514 Vali Loss: 9.260 Vali Acc: 0.109 Test Loss: 9.260 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3393340
	speed: 0.2727s/iter; left time: 4624.5258s
	iters: 200, epoch: 19 | loss: 0.8204192
	speed: 0.0529s/iter; left time: 892.5100s
Epoch: 19 cost time: 11.873915672302246
Epoch: 19, Steps: 208 | Train Loss: 0.442 Vali Loss: 10.024 Vali Acc: 0.106 Test Loss: 10.024 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2732019
	speed: 0.2813s/iter; left time: 4711.9325s
	iters: 200, epoch: 20 | loss: 0.1032918
	speed: 0.0589s/iter; left time: 980.8400s
Epoch: 20 cost time: 12.939578533172607
Epoch: 20, Steps: 208 | Train Loss: 0.426 Vali Loss: 10.598 Vali Acc: 0.110 Test Loss: 10.598 Test Acc: 0.110
Validation loss decreased (-0.109962 --> -0.110243).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3589806
	speed: 0.2788s/iter; left time: 4611.9102s
	iters: 200, epoch: 21 | loss: 0.2860330
	speed: 0.0498s/iter; left time: 818.7447s
Epoch: 21 cost time: 11.517516851425171
Epoch: 21, Steps: 208 | Train Loss: 0.406 Vali Loss: 10.584 Vali Acc: 0.112 Test Loss: 10.584 Test Acc: 0.112
Validation loss decreased (-0.110243 --> -0.111734).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2495825
	speed: 0.2541s/iter; left time: 4150.7463s
	iters: 200, epoch: 22 | loss: 0.4979090
	speed: 0.0513s/iter; left time: 832.7617s
Epoch: 22 cost time: 11.561865329742432
Epoch: 22, Steps: 208 | Train Loss: 0.363 Vali Loss: 10.913 Vali Acc: 0.103 Test Loss: 10.913 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4091988
	speed: 0.2664s/iter; left time: 4295.2740s
	iters: 200, epoch: 23 | loss: 0.4572107
	speed: 0.0559s/iter; left time: 896.2502s
Epoch: 23 cost time: 12.406397819519043
Epoch: 23, Steps: 208 | Train Loss: 0.353 Vali Loss: 11.546 Vali Acc: 0.110 Test Loss: 11.546 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2560019
	speed: 0.2640s/iter; left time: 4201.9130s
	iters: 200, epoch: 24 | loss: 0.3396826
	speed: 0.0515s/iter; left time: 814.3304s
Epoch: 24 cost time: 11.118255138397217
Epoch: 24, Steps: 208 | Train Loss: 0.339 Vali Loss: 12.100 Vali Acc: 0.107 Test Loss: 12.100 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.4567866
	speed: 0.2917s/iter; left time: 4583.0797s
	iters: 200, epoch: 25 | loss: 0.2322868
	speed: 0.0453s/iter; left time: 707.4471s
Epoch: 25 cost time: 11.433527708053589
Epoch: 25, Steps: 208 | Train Loss: 0.300 Vali Loss: 11.965 Vali Acc: 0.103 Test Loss: 11.965 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0846353
	speed: 0.3047s/iter; left time: 4723.7464s
	iters: 200, epoch: 26 | loss: 0.7842577
	speed: 0.0554s/iter; left time: 853.0297s
Epoch: 26 cost time: 13.37691879272461
Epoch: 26, Steps: 208 | Train Loss: 0.309 Vali Loss: 12.129 Vali Acc: 0.103 Test Loss: 12.129 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0695577
	speed: 0.2913s/iter; left time: 4454.5445s
	iters: 200, epoch: 27 | loss: 0.7951405
	speed: 0.0624s/iter; left time: 947.7492s
Epoch: 27 cost time: 14.168015480041504
Epoch: 27, Steps: 208 | Train Loss: 0.262 Vali Loss: 13.084 Vali Acc: 0.103 Test Loss: 13.084 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.4467804
	speed: 0.3089s/iter; left time: 4659.7219s
	iters: 200, epoch: 28 | loss: 0.2799816
	speed: 0.0628s/iter; left time: 940.9752s
Epoch: 28 cost time: 14.01073408126831
Epoch: 28, Steps: 208 | Train Loss: 0.254 Vali Loss: 13.232 Vali Acc: 0.109 Test Loss: 13.232 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.5529619
	speed: 0.2954s/iter; left time: 4394.1383s
	iters: 200, epoch: 29 | loss: 0.2573305
	speed: 0.0507s/iter; left time: 749.5966s
Epoch: 29 cost time: 11.645717144012451
Epoch: 29, Steps: 208 | Train Loss: 0.227 Vali Loss: 13.767 Vali Acc: 0.110 Test Loss: 13.767 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.3166629
	speed: 0.2733s/iter; left time: 4009.2556s
	iters: 200, epoch: 30 | loss: 0.6432578
	speed: 0.0511s/iter; left time: 744.3065s
Epoch: 30 cost time: 12.125069379806519
Epoch: 30, Steps: 208 | Train Loss: 0.218 Vali Loss: 13.904 Vali Acc: 0.101 Test Loss: 13.904 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0520314
	speed: 0.2791s/iter; left time: 4035.9707s
	iters: 200, epoch: 31 | loss: 0.3837372
	speed: 0.0538s/iter; left time: 773.0666s
Epoch: 31 cost time: 12.514234781265259
Epoch: 31, Steps: 208 | Train Loss: 0.238 Vali Loss: 14.530 Vali Acc: 0.105 Test Loss: 14.530 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11184014315538324
model parameter : 505159
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8548534
	speed: 0.0818s/iter; left time: 1693.3430s
	iters: 200, epoch: 1 | loss: 3.6783774
	speed: 0.0486s/iter; left time: 1001.0673s
Epoch: 1 cost time: 13.563971281051636
Epoch: 1, Steps: 208 | Train Loss: 3.865 Vali Loss: 3.891 Vali Acc: 0.061 Test Loss: 3.891 Test Acc: 0.061
Validation loss decreased (inf --> -0.061100).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1849027
	speed: 0.2726s/iter; left time: 5587.2572s
	iters: 200, epoch: 2 | loss: 3.5256252
	speed: 0.0414s/iter; left time: 844.4174s
Epoch: 2 cost time: 10.638355255126953
Epoch: 2, Steps: 208 | Train Loss: 3.587 Vali Loss: 3.823 Vali Acc: 0.079 Test Loss: 3.823 Test Acc: 0.079
Validation loss decreased (-0.061100 --> -0.078697).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1275163
	speed: 0.2746s/iter; left time: 5570.8304s
	iters: 200, epoch: 3 | loss: 3.3782108
	speed: 0.0462s/iter; left time: 933.0813s
Epoch: 3 cost time: 10.506336688995361
Epoch: 3, Steps: 208 | Train Loss: 3.224 Vali Loss: 3.684 Vali Acc: 0.095 Test Loss: 3.684 Test Acc: 0.095
Validation loss decreased (-0.078697 --> -0.094804).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6636920
	speed: 0.2790s/iter; left time: 5601.1309s
	iters: 200, epoch: 4 | loss: 3.1819091
	speed: 0.0538s/iter; left time: 1074.5769s
Epoch: 4 cost time: 11.992993354797363
Epoch: 4, Steps: 208 | Train Loss: 2.996 Vali Loss: 3.955 Vali Acc: 0.097 Test Loss: 3.955 Test Acc: 0.097
Validation loss decreased (-0.094804 --> -0.097187).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9645262
	speed: 0.2818s/iter; left time: 5599.0824s
	iters: 200, epoch: 5 | loss: 3.6046674
	speed: 0.0477s/iter; left time: 943.9298s
Epoch: 5 cost time: 11.018940210342407
Epoch: 5, Steps: 208 | Train Loss: 2.811 Vali Loss: 3.925 Vali Acc: 0.106 Test Loss: 3.925 Test Acc: 0.106
Validation loss decreased (-0.097187 --> -0.105538).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1179466
	speed: 0.2661s/iter; left time: 5232.3019s
	iters: 200, epoch: 6 | loss: 2.7380948
	speed: 0.0390s/iter; left time: 762.5102s
Epoch: 6 cost time: 9.236463785171509
Epoch: 6, Steps: 208 | Train Loss: 2.649 Vali Loss: 4.134 Vali Acc: 0.108 Test Loss: 4.134 Test Acc: 0.108
Validation loss decreased (-0.105538 --> -0.107623).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7078753
	speed: 0.2402s/iter; left time: 4673.5772s
	iters: 200, epoch: 7 | loss: 3.2816370
	speed: 0.0430s/iter; left time: 832.2907s
Epoch: 7 cost time: 10.173239469528198
Epoch: 7, Steps: 208 | Train Loss: 2.486 Vali Loss: 4.177 Vali Acc: 0.112 Test Loss: 4.177 Test Acc: 0.112
Validation loss decreased (-0.107623 --> -0.111500).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4331303
	speed: 0.2490s/iter; left time: 4792.0282s
	iters: 200, epoch: 8 | loss: 2.7318194
	speed: 0.0423s/iter; left time: 809.9388s
Epoch: 8 cost time: 9.612813472747803
Epoch: 8, Steps: 208 | Train Loss: 2.300 Vali Loss: 4.154 Vali Acc: 0.108 Test Loss: 4.154 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6518531
	speed: 0.2464s/iter; left time: 4691.0423s
	iters: 200, epoch: 9 | loss: 2.1517806
	speed: 0.0447s/iter; left time: 846.4108s
Epoch: 9 cost time: 10.183579444885254
Epoch: 9, Steps: 208 | Train Loss: 2.127 Vali Loss: 4.350 Vali Acc: 0.111 Test Loss: 4.350 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9588032
	speed: 0.2421s/iter; left time: 4559.3768s
	iters: 200, epoch: 10 | loss: 3.0447888
	speed: 0.0475s/iter; left time: 889.9869s
Epoch: 10 cost time: 10.179296016693115
Epoch: 10, Steps: 208 | Train Loss: 1.969 Vali Loss: 4.522 Vali Acc: 0.112 Test Loss: 4.522 Test Acc: 0.112
Validation loss decreased (-0.111500 --> -0.112093).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4155566
	speed: 0.2468s/iter; left time: 4595.2994s
	iters: 200, epoch: 11 | loss: 1.4609458
	speed: 0.0381s/iter; left time: 706.4802s
Epoch: 11 cost time: 9.66009521484375
Epoch: 11, Steps: 208 | Train Loss: 1.853 Vali Loss: 4.663 Vali Acc: 0.113 Test Loss: 4.663 Test Acc: 0.113
Validation loss decreased (-0.112093 --> -0.112986).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5601614
	speed: 0.2388s/iter; left time: 4396.9684s
	iters: 200, epoch: 12 | loss: 1.5284892
	speed: 0.0457s/iter; left time: 836.2514s
Epoch: 12 cost time: 10.223457098007202
Epoch: 12, Steps: 208 | Train Loss: 1.670 Vali Loss: 4.858 Vali Acc: 0.115 Test Loss: 4.858 Test Acc: 0.115
Validation loss decreased (-0.112986 --> -0.114774).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7634486
	speed: 0.2278s/iter; left time: 4146.3790s
	iters: 200, epoch: 13 | loss: 1.5020357
	speed: 0.0374s/iter; left time: 677.4081s
Epoch: 13 cost time: 9.116463422775269
Epoch: 13, Steps: 208 | Train Loss: 1.530 Vali Loss: 5.055 Vali Acc: 0.120 Test Loss: 5.055 Test Acc: 0.120
Validation loss decreased (-0.114774 --> -0.119842).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2594342
	speed: 0.2486s/iter; left time: 4474.3534s
	iters: 200, epoch: 14 | loss: 1.6187687
	speed: 0.0409s/iter; left time: 732.3393s
Epoch: 14 cost time: 9.259103775024414
Epoch: 14, Steps: 208 | Train Loss: 1.402 Vali Loss: 5.223 Vali Acc: 0.117 Test Loss: 5.223 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7670888
	speed: 0.2420s/iter; left time: 4305.1689s
	iters: 200, epoch: 15 | loss: 1.4939206
	speed: 0.0351s/iter; left time: 620.9623s
Epoch: 15 cost time: 8.803099393844604
Epoch: 15, Steps: 208 | Train Loss: 1.314 Vali Loss: 5.451 Vali Acc: 0.119 Test Loss: 5.451 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4473410
	speed: 0.2361s/iter; left time: 4150.4614s
	iters: 200, epoch: 16 | loss: 1.6996031
	speed: 0.0426s/iter; left time: 745.3577s
Epoch: 16 cost time: 9.457197427749634
Epoch: 16, Steps: 208 | Train Loss: 1.183 Vali Loss: 5.991 Vali Acc: 0.119 Test Loss: 5.991 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2086433
	speed: 0.2331s/iter; left time: 4050.0079s
	iters: 200, epoch: 17 | loss: 1.0948846
	speed: 0.0379s/iter; left time: 654.9035s
Epoch: 17 cost time: 9.226152420043945
Epoch: 17, Steps: 208 | Train Loss: 1.109 Vali Loss: 6.203 Vali Acc: 0.115 Test Loss: 6.203 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5159390
	speed: 0.2313s/iter; left time: 3970.2978s
	iters: 200, epoch: 18 | loss: 1.2046814
	speed: 0.0397s/iter; left time: 677.2864s
Epoch: 18 cost time: 9.102210521697998
Epoch: 18, Steps: 208 | Train Loss: 1.033 Vali Loss: 6.520 Vali Acc: 0.115 Test Loss: 6.520 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8744847
	speed: 0.2444s/iter; left time: 4144.2343s
	iters: 200, epoch: 19 | loss: 1.4447641
	speed: 0.0410s/iter; left time: 690.7402s
Epoch: 19 cost time: 9.548693180084229
Epoch: 19, Steps: 208 | Train Loss: 0.937 Vali Loss: 7.037 Vali Acc: 0.115 Test Loss: 7.037 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6613985
	speed: 0.2568s/iter; left time: 4300.3339s
	iters: 200, epoch: 20 | loss: 0.9330378
	speed: 0.0446s/iter; left time: 742.4622s
Epoch: 20 cost time: 10.259698867797852
Epoch: 20, Steps: 208 | Train Loss: 0.880 Vali Loss: 7.127 Vali Acc: 0.114 Test Loss: 7.127 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.9196761
	speed: 0.2693s/iter; left time: 4454.9942s
	iters: 200, epoch: 21 | loss: 0.5734555
	speed: 0.0460s/iter; left time: 755.6696s
Epoch: 21 cost time: 10.340045690536499
Epoch: 21, Steps: 208 | Train Loss: 0.799 Vali Loss: 7.332 Vali Acc: 0.123 Test Loss: 7.332 Test Acc: 0.123
Validation loss decreased (-0.119842 --> -0.123100).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.6726810
	speed: 0.2802s/iter; left time: 4576.4513s
	iters: 200, epoch: 22 | loss: 0.2739721
	speed: 0.0500s/iter; left time: 811.6998s
Epoch: 22 cost time: 11.028234958648682
Epoch: 22, Steps: 208 | Train Loss: 0.757 Vali Loss: 7.920 Vali Acc: 0.118 Test Loss: 7.920 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.8589694
	speed: 0.2591s/iter; left time: 4178.6565s
	iters: 200, epoch: 23 | loss: 0.4560250
	speed: 0.0470s/iter; left time: 753.1781s
Epoch: 23 cost time: 10.672000646591187
Epoch: 23, Steps: 208 | Train Loss: 0.715 Vali Loss: 8.075 Vali Acc: 0.119 Test Loss: 8.075 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.7299829
	speed: 0.2551s/iter; left time: 4059.8059s
	iters: 200, epoch: 24 | loss: 1.4093362
	speed: 0.0474s/iter; left time: 749.2293s
Epoch: 24 cost time: 10.722628593444824
Epoch: 24, Steps: 208 | Train Loss: 0.695 Vali Loss: 8.310 Vali Acc: 0.116 Test Loss: 8.310 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.6876379
	speed: 0.2735s/iter; left time: 4296.1841s
	iters: 200, epoch: 25 | loss: 0.6719515
	speed: 0.0506s/iter; left time: 789.0909s
Epoch: 25 cost time: 11.035961866378784
Epoch: 25, Steps: 208 | Train Loss: 0.648 Vali Loss: 8.732 Vali Acc: 0.113 Test Loss: 8.732 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.7099362
	speed: 0.2854s/iter; left time: 4423.5345s
	iters: 200, epoch: 26 | loss: 1.0761311
	speed: 0.0505s/iter; left time: 777.0390s
Epoch: 26 cost time: 11.379320621490479
Epoch: 26, Steps: 208 | Train Loss: 0.605 Vali Loss: 8.809 Vali Acc: 0.117 Test Loss: 8.809 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.5050203
	speed: 0.2834s/iter; left time: 4333.9916s
	iters: 200, epoch: 27 | loss: 0.5720456
	speed: 0.0472s/iter; left time: 716.7174s
Epoch: 27 cost time: 11.001049280166626
Epoch: 27, Steps: 208 | Train Loss: 0.560 Vali Loss: 9.525 Vali Acc: 0.112 Test Loss: 9.525 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.4914078
	speed: 0.2849s/iter; left time: 4297.9018s
	iters: 200, epoch: 28 | loss: 0.7600787
	speed: 0.0465s/iter; left time: 696.2764s
Epoch: 28 cost time: 10.984479188919067
Epoch: 28, Steps: 208 | Train Loss: 0.554 Vali Loss: 9.666 Vali Acc: 0.118 Test Loss: 9.666 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.5940998
	speed: 0.2873s/iter; left time: 4273.7643s
	iters: 200, epoch: 29 | loss: 0.5712877
	speed: 0.0482s/iter; left time: 712.6772s
Epoch: 29 cost time: 11.510639190673828
Epoch: 29, Steps: 208 | Train Loss: 0.514 Vali Loss: 9.857 Vali Acc: 0.114 Test Loss: 9.857 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.1087149
	speed: 0.2894s/iter; left time: 4245.3855s
	iters: 200, epoch: 30 | loss: 0.5338051
	speed: 0.0472s/iter; left time: 687.3766s
Epoch: 30 cost time: 11.071057081222534
Epoch: 30, Steps: 208 | Train Loss: 0.523 Vali Loss: 10.028 Vali Acc: 0.119 Test Loss: 10.028 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.6374546
	speed: 0.2775s/iter; left time: 4013.3655s
	iters: 200, epoch: 31 | loss: 0.3814857
	speed: 0.0490s/iter; left time: 703.6144s
Epoch: 31 cost time: 11.279472351074219
Epoch: 31, Steps: 208 | Train Loss: 0.479 Vali Loss: 10.405 Vali Acc: 0.112 Test Loss: 10.405 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12317327766179541
model parameter : 258135
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8829272
	speed: 0.0904s/iter; left time: 1870.6409s
	iters: 200, epoch: 1 | loss: 4.1653886
	speed: 0.0507s/iter; left time: 1044.5607s
Epoch: 1 cost time: 14.629363298416138
Epoch: 1, Steps: 208 | Train Loss: 3.791 Vali Loss: 3.771 Vali Acc: 0.056 Test Loss: 3.771 Test Acc: 0.056
Validation loss decreased (inf --> -0.056031).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1316235
	speed: 0.3035s/iter; left time: 6219.7621s
	iters: 200, epoch: 2 | loss: 3.5578549
	speed: 0.0552s/iter; left time: 1126.0239s
Epoch: 2 cost time: 12.258498430252075
Epoch: 2, Steps: 208 | Train Loss: 3.541 Vali Loss: 3.775 Vali Acc: 0.069 Test Loss: 3.775 Test Acc: 0.069
Validation loss decreased (-0.056031 --> -0.068856).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7311549
	speed: 0.3200s/iter; left time: 6491.6893s
	iters: 200, epoch: 3 | loss: 3.0893831
	speed: 0.0495s/iter; left time: 998.1529s
Epoch: 3 cost time: 12.040510416030884
Epoch: 3, Steps: 208 | Train Loss: 3.215 Vali Loss: 3.822 Vali Acc: 0.091 Test Loss: 3.822 Test Acc: 0.091
Validation loss decreased (-0.068856 --> -0.090925).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2891684
	speed: 0.3245s/iter; left time: 6514.9913s
	iters: 200, epoch: 4 | loss: 2.8715053
	speed: 0.0500s/iter; left time: 999.1270s
Epoch: 4 cost time: 12.091062307357788
Epoch: 4, Steps: 208 | Train Loss: 3.015 Vali Loss: 3.931 Vali Acc: 0.090 Test Loss: 3.931 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4359150
	speed: 0.3090s/iter; left time: 6139.6987s
	iters: 200, epoch: 5 | loss: 3.0171473
	speed: 0.0473s/iter; left time: 935.5803s
Epoch: 5 cost time: 11.559687852859497
Epoch: 5, Steps: 208 | Train Loss: 2.839 Vali Loss: 3.870 Vali Acc: 0.093 Test Loss: 3.870 Test Acc: 0.093
Validation loss decreased (-0.090925 --> -0.092714).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2045407
	speed: 0.3040s/iter; left time: 5977.8870s
	iters: 200, epoch: 6 | loss: 2.8826869
	speed: 0.0522s/iter; left time: 1020.4838s
Epoch: 6 cost time: 11.461497783660889
Epoch: 6, Steps: 208 | Train Loss: 2.675 Vali Loss: 4.020 Vali Acc: 0.095 Test Loss: 4.020 Test Acc: 0.095
Validation loss decreased (-0.092714 --> -0.094502).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1110883
	speed: 0.3220s/iter; left time: 6264.3552s
	iters: 200, epoch: 7 | loss: 2.9990735
	speed: 0.0499s/iter; left time: 964.8532s
Epoch: 7 cost time: 11.940966129302979
Epoch: 7, Steps: 208 | Train Loss: 2.546 Vali Loss: 4.138 Vali Acc: 0.096 Test Loss: 4.138 Test Acc: 0.096
Validation loss decreased (-0.094502 --> -0.095694).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7551718
	speed: 0.3178s/iter; left time: 6115.4736s
	iters: 200, epoch: 8 | loss: 2.5515709
	speed: 0.0549s/iter; left time: 1050.4986s
Epoch: 8 cost time: 13.094308137893677
Epoch: 8, Steps: 208 | Train Loss: 2.405 Vali Loss: 4.127 Vali Acc: 0.101 Test Loss: 4.127 Test Acc: 0.101
Validation loss decreased (-0.095694 --> -0.100764).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0582287
	speed: 0.3189s/iter; left time: 6070.9915s
	iters: 200, epoch: 9 | loss: 2.5545793
	speed: 0.0532s/iter; left time: 1008.3287s
Epoch: 9 cost time: 12.462390899658203
Epoch: 9, Steps: 208 | Train Loss: 2.262 Vali Loss: 4.278 Vali Acc: 0.094 Test Loss: 4.278 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3237774
	speed: 0.3189s/iter; left time: 6003.7320s
	iters: 200, epoch: 10 | loss: 2.6193566
	speed: 0.0493s/iter; left time: 923.5107s
Epoch: 10 cost time: 11.807064294815063
Epoch: 10, Steps: 208 | Train Loss: 2.138 Vali Loss: 4.328 Vali Acc: 0.103 Test Loss: 4.328 Test Acc: 0.103
Validation loss decreased (-0.100764 --> -0.102850).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1514661
	speed: 0.3192s/iter; left time: 5942.9545s
	iters: 200, epoch: 11 | loss: 2.0998628
	speed: 0.0464s/iter; left time: 859.9414s
Epoch: 11 cost time: 11.415512561798096
Epoch: 11, Steps: 208 | Train Loss: 2.046 Vali Loss: 4.610 Vali Acc: 0.098 Test Loss: 4.610 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9001451
	speed: 0.3126s/iter; left time: 5755.8225s
	iters: 200, epoch: 12 | loss: 2.7135448
	speed: 0.0486s/iter; left time: 890.0270s
Epoch: 12 cost time: 11.329117059707642
Epoch: 12, Steps: 208 | Train Loss: 1.932 Vali Loss: 4.651 Vali Acc: 0.101 Test Loss: 4.651 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6347340
	speed: 0.3086s/iter; left time: 5618.1985s
	iters: 200, epoch: 13 | loss: 1.7746711
	speed: 0.0516s/iter; left time: 934.8703s
Epoch: 13 cost time: 11.783859491348267
Epoch: 13, Steps: 208 | Train Loss: 1.795 Vali Loss: 4.721 Vali Acc: 0.106 Test Loss: 4.721 Test Acc: 0.106
Validation loss decreased (-0.102850 --> -0.105530).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5256251
	speed: 0.3018s/iter; left time: 5432.1413s
	iters: 200, epoch: 14 | loss: 1.9171138
	speed: 0.0480s/iter; left time: 859.3853s
Epoch: 14 cost time: 11.103337049484253
Epoch: 14, Steps: 208 | Train Loss: 1.739 Vali Loss: 4.882 Vali Acc: 0.107 Test Loss: 4.882 Test Acc: 0.107
Validation loss decreased (-0.105530 --> -0.107019).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1905627
	speed: 0.2955s/iter; left time: 5256.5388s
	iters: 200, epoch: 15 | loss: 1.5107673
	speed: 0.0489s/iter; left time: 864.6149s
Epoch: 15 cost time: 10.759167432785034
Epoch: 15, Steps: 208 | Train Loss: 1.626 Vali Loss: 5.119 Vali Acc: 0.107 Test Loss: 5.119 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.6212941
	speed: 0.3139s/iter; left time: 5518.8081s
	iters: 200, epoch: 16 | loss: 1.9732901
	speed: 0.0494s/iter; left time: 862.8600s
Epoch: 16 cost time: 11.980839014053345
Epoch: 16, Steps: 208 | Train Loss: 1.528 Vali Loss: 5.444 Vali Acc: 0.106 Test Loss: 5.444 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2169625
	speed: 0.3341s/iter; left time: 5805.1875s
	iters: 200, epoch: 17 | loss: 1.5652547
	speed: 0.0446s/iter; left time: 769.6662s
Epoch: 17 cost time: 11.080212116241455
Epoch: 17, Steps: 208 | Train Loss: 1.458 Vali Loss: 5.498 Vali Acc: 0.103 Test Loss: 5.498 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.6388553
	speed: 0.3148s/iter; left time: 5402.8011s
	iters: 200, epoch: 18 | loss: 1.1333385
	speed: 0.0504s/iter; left time: 860.4807s
Epoch: 18 cost time: 11.488147258758545
Epoch: 18, Steps: 208 | Train Loss: 1.385 Vali Loss: 5.784 Vali Acc: 0.111 Test Loss: 5.784 Test Acc: 0.111
Validation loss decreased (-0.107019 --> -0.110589).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.7549958
	speed: 0.3146s/iter; left time: 5335.0560s
	iters: 200, epoch: 19 | loss: 1.2942188
	speed: 0.0542s/iter; left time: 913.5442s
Epoch: 19 cost time: 12.30751895904541
Epoch: 19, Steps: 208 | Train Loss: 1.326 Vali Loss: 5.867 Vali Acc: 0.106 Test Loss: 5.867 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1135700
	speed: 0.3104s/iter; left time: 5198.4347s
	iters: 200, epoch: 20 | loss: 2.6834462
	speed: 0.0524s/iter; left time: 872.2107s
Epoch: 20 cost time: 11.949100971221924
Epoch: 20, Steps: 208 | Train Loss: 1.253 Vali Loss: 6.116 Vali Acc: 0.106 Test Loss: 6.116 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2425452
	speed: 0.3050s/iter; left time: 5045.5417s
	iters: 200, epoch: 21 | loss: 1.7085603
	speed: 0.0517s/iter; left time: 850.3766s
Epoch: 21 cost time: 12.228624820709229
Epoch: 21, Steps: 208 | Train Loss: 1.188 Vali Loss: 6.243 Vali Acc: 0.105 Test Loss: 6.243 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.9259177
	speed: 0.2981s/iter; left time: 4868.5507s
	iters: 200, epoch: 22 | loss: 1.7603786
	speed: 0.0512s/iter; left time: 831.5090s
Epoch: 22 cost time: 11.693794250488281
Epoch: 22, Steps: 208 | Train Loss: 1.142 Vali Loss: 6.408 Vali Acc: 0.105 Test Loss: 6.408 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.0138692
	speed: 0.2956s/iter; left time: 4765.8954s
	iters: 200, epoch: 23 | loss: 1.3732876
	speed: 0.0534s/iter; left time: 855.2714s
Epoch: 23 cost time: 11.9385404586792
Epoch: 23, Steps: 208 | Train Loss: 1.084 Vali Loss: 6.732 Vali Acc: 0.107 Test Loss: 6.732 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.7784923
	speed: 0.3152s/iter; left time: 5016.3461s
	iters: 200, epoch: 24 | loss: 1.0282503
	speed: 0.0538s/iter; left time: 850.9160s
Epoch: 24 cost time: 12.171205043792725
Epoch: 24, Steps: 208 | Train Loss: 1.032 Vali Loss: 6.938 Vali Acc: 0.102 Test Loss: 6.938 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.1960636
	speed: 0.3013s/iter; left time: 4733.8387s
	iters: 200, epoch: 25 | loss: 0.9962214
	speed: 0.0466s/iter; left time: 726.6537s
Epoch: 25 cost time: 11.158138990402222
Epoch: 25, Steps: 208 | Train Loss: 0.995 Vali Loss: 7.362 Vali Acc: 0.103 Test Loss: 7.362 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.8154927
	speed: 0.3148s/iter; left time: 4879.7011s
	iters: 200, epoch: 26 | loss: 0.4526266
	speed: 0.0468s/iter; left time: 721.2060s
Epoch: 26 cost time: 11.688286304473877
Epoch: 26, Steps: 208 | Train Loss: 0.978 Vali Loss: 7.335 Vali Acc: 0.103 Test Loss: 7.335 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.8177610
	speed: 0.3164s/iter; left time: 4838.9186s
	iters: 200, epoch: 27 | loss: 1.6724477
	speed: 0.0469s/iter; left time: 712.4330s
Epoch: 27 cost time: 11.578725814819336
Epoch: 27, Steps: 208 | Train Loss: 0.914 Vali Loss: 7.396 Vali Acc: 0.110 Test Loss: 7.396 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.9241378
	speed: 0.3239s/iter; left time: 4886.3767s
	iters: 200, epoch: 28 | loss: 1.1286561
	speed: 0.0541s/iter; left time: 810.0967s
Epoch: 28 cost time: 12.061306953430176
Epoch: 28, Steps: 208 | Train Loss: 0.885 Vali Loss: 7.751 Vali Acc: 0.115 Test Loss: 7.751 Test Acc: 0.115
Validation loss decreased (-0.110589 --> -0.115342).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.8118023
	speed: 0.3288s/iter; left time: 4891.2389s
	iters: 200, epoch: 29 | loss: 0.7629266
	speed: 0.0564s/iter; left time: 833.6354s
Epoch: 29 cost time: 12.681391477584839
Epoch: 29, Steps: 208 | Train Loss: 0.834 Vali Loss: 8.131 Vali Acc: 0.104 Test Loss: 8.131 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.5941616
	speed: 0.3048s/iter; left time: 4471.6162s
	iters: 200, epoch: 30 | loss: 1.4802625
	speed: 0.0519s/iter; left time: 756.4997s
Epoch: 30 cost time: 11.730974197387695
Epoch: 30, Steps: 208 | Train Loss: 0.815 Vali Loss: 8.146 Vali Acc: 0.109 Test Loss: 8.146 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.8744580
	speed: 0.2921s/iter; left time: 4223.5932s
	iters: 200, epoch: 31 | loss: 0.9869112
	speed: 0.0553s/iter; left time: 794.4921s
Epoch: 31 cost time: 12.650701999664307
Epoch: 31, Steps: 208 | Train Loss: 0.807 Vali Loss: 8.251 Vali Acc: 0.108 Test Loss: 8.251 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.9373319
	speed: 0.3013s/iter; left time: 4295.0034s
	iters: 200, epoch: 32 | loss: 0.7164795
	speed: 0.0478s/iter; left time: 676.6545s
Epoch: 32 cost time: 11.653644800186157
Epoch: 32, Steps: 208 | Train Loss: 0.770 Vali Loss: 8.513 Vali Acc: 0.106 Test Loss: 8.513 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.5293771
	speed: 0.3391s/iter; left time: 4762.2693s
	iters: 200, epoch: 33 | loss: 0.7752653
	speed: 0.0547s/iter; left time: 763.0194s
Epoch: 33 cost time: 12.78749418258667
Epoch: 33, Steps: 208 | Train Loss: 0.763 Vali Loss: 8.828 Vali Acc: 0.111 Test Loss: 8.828 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.5217901
	speed: 0.3172s/iter; left time: 4388.6375s
	iters: 200, epoch: 34 | loss: 0.8296466
	speed: 0.0569s/iter; left time: 781.1980s
Epoch: 34 cost time: 12.963082790374756
Epoch: 34, Steps: 208 | Train Loss: 0.728 Vali Loss: 8.774 Vali Acc: 0.112 Test Loss: 8.774 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.3972793
	speed: 0.2994s/iter; left time: 4079.9245s
	iters: 200, epoch: 35 | loss: 0.7209886
	speed: 0.0541s/iter; left time: 731.2799s
Epoch: 35 cost time: 12.466006994247437
Epoch: 35, Steps: 208 | Train Loss: 0.675 Vali Loss: 9.114 Vali Acc: 0.111 Test Loss: 9.114 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.6804880
	speed: 0.2921s/iter; left time: 3920.6250s
	iters: 200, epoch: 36 | loss: 0.9323106
	speed: 0.0558s/iter; left time: 743.2070s
Epoch: 36 cost time: 12.185222864151001
Epoch: 36, Steps: 208 | Train Loss: 0.660 Vali Loss: 9.276 Vali Acc: 0.105 Test Loss: 9.276 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.3874902
	speed: 0.2949s/iter; left time: 3896.5499s
	iters: 200, epoch: 37 | loss: 0.6234322
	speed: 0.0508s/iter; left time: 666.5155s
Epoch: 37 cost time: 11.230259895324707
Epoch: 37, Steps: 208 | Train Loss: 0.692 Vali Loss: 9.394 Vali Acc: 0.107 Test Loss: 9.394 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 1.1006455
	speed: 0.2912s/iter; left time: 3786.4881s
	iters: 200, epoch: 38 | loss: 0.8150038
	speed: 0.0492s/iter; left time: 634.8496s
Epoch: 38 cost time: 11.418610334396362
Epoch: 38, Steps: 208 | Train Loss: 0.624 Vali Loss: 9.578 Vali Acc: 0.104 Test Loss: 9.578 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1154190277363555
model parameter : 175863
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9765167
	speed: 0.0883s/iter; left time: 1827.5858s
	iters: 200, epoch: 1 | loss: 4.0452709
	speed: 0.0507s/iter; left time: 1043.4967s
Epoch: 1 cost time: 14.64250111579895
Epoch: 1, Steps: 208 | Train Loss: 3.802 Vali Loss: 3.785 Vali Acc: 0.053 Test Loss: 3.785 Test Acc: 0.053
Validation loss decreased (inf --> -0.053347).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6742849
	speed: 0.3149s/iter; left time: 6452.6493s
	iters: 200, epoch: 2 | loss: 3.3406360
	speed: 0.0462s/iter; left time: 941.4285s
Epoch: 2 cost time: 11.275902032852173
Epoch: 2, Steps: 208 | Train Loss: 3.575 Vali Loss: 3.700 Vali Acc: 0.069 Test Loss: 3.700 Test Acc: 0.069
Validation loss decreased (-0.053347 --> -0.069453).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4263303
	speed: 0.3279s/iter; left time: 6650.7888s
	iters: 200, epoch: 3 | loss: 3.2498021
	speed: 0.0538s/iter; left time: 1086.7206s
Epoch: 3 cost time: 12.669372320175171
Epoch: 3, Steps: 208 | Train Loss: 3.321 Vali Loss: 3.713 Vali Acc: 0.077 Test Loss: 3.713 Test Acc: 0.077
Validation loss decreased (-0.069453 --> -0.076909).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4393215
	speed: 0.3032s/iter; left time: 6088.1865s
	iters: 200, epoch: 4 | loss: 3.0559447
	speed: 0.0470s/iter; left time: 938.0192s
Epoch: 4 cost time: 10.700492858886719
Epoch: 4, Steps: 208 | Train Loss: 3.123 Vali Loss: 3.739 Vali Acc: 0.086 Test Loss: 3.739 Test Acc: 0.086
Validation loss decreased (-0.076909 --> -0.085558).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1546769
	speed: 0.3026s/iter; left time: 6011.5457s
	iters: 200, epoch: 5 | loss: 2.9787645
	speed: 0.0462s/iter; left time: 913.1332s
Epoch: 5 cost time: 11.237474203109741
Epoch: 5, Steps: 208 | Train Loss: 2.936 Vali Loss: 3.808 Vali Acc: 0.086 Test Loss: 3.808 Test Acc: 0.086
Validation loss decreased (-0.085558 --> -0.086153).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8990040
	speed: 0.3030s/iter; left time: 5956.7710s
	iters: 200, epoch: 6 | loss: 2.9843230
	speed: 0.0468s/iter; left time: 914.8468s
Epoch: 6 cost time: 10.679241418838501
Epoch: 6, Steps: 208 | Train Loss: 2.778 Vali Loss: 3.917 Vali Acc: 0.102 Test Loss: 3.917 Test Acc: 0.102
Validation loss decreased (-0.086153 --> -0.101959).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6221595
	speed: 0.2965s/iter; left time: 5767.7648s
	iters: 200, epoch: 7 | loss: 3.2308834
	speed: 0.0527s/iter; left time: 1018.9477s
Epoch: 7 cost time: 12.021965503692627
Epoch: 7, Steps: 208 | Train Loss: 2.650 Vali Loss: 4.013 Vali Acc: 0.096 Test Loss: 4.013 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4408619
	speed: 0.3072s/iter; left time: 5912.7485s
	iters: 200, epoch: 8 | loss: 2.3538525
	speed: 0.0476s/iter; left time: 911.2088s
Epoch: 8 cost time: 11.89425802230835
Epoch: 8, Steps: 208 | Train Loss: 2.518 Vali Loss: 4.053 Vali Acc: 0.097 Test Loss: 4.053 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5024381
	speed: 0.3080s/iter; left time: 5863.4096s
	iters: 200, epoch: 9 | loss: 3.2135077
	speed: 0.0615s/iter; left time: 1163.7373s
Epoch: 9 cost time: 13.042136430740356
Epoch: 9, Steps: 208 | Train Loss: 2.412 Vali Loss: 4.075 Vali Acc: 0.103 Test Loss: 4.075 Test Acc: 0.103
Validation loss decreased (-0.101959 --> -0.102554).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3046510
	speed: 0.2996s/iter; left time: 5640.2962s
	iters: 200, epoch: 10 | loss: 2.7524152
	speed: 0.0506s/iter; left time: 948.4439s
Epoch: 10 cost time: 11.480242490768433
Epoch: 10, Steps: 208 | Train Loss: 2.259 Vali Loss: 4.194 Vali Acc: 0.099 Test Loss: 4.194 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8408072
	speed: 0.2963s/iter; left time: 5518.1974s
	iters: 200, epoch: 11 | loss: 2.1973002
	speed: 0.0544s/iter; left time: 1008.0384s
Epoch: 11 cost time: 12.083611011505127
Epoch: 11, Steps: 208 | Train Loss: 2.177 Vali Loss: 4.330 Vali Acc: 0.108 Test Loss: 4.330 Test Acc: 0.108
Validation loss decreased (-0.102554 --> -0.107621).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.1581893
	speed: 0.3154s/iter; left time: 5807.2925s
	iters: 200, epoch: 12 | loss: 2.2242856
	speed: 0.0479s/iter; left time: 878.0302s
Epoch: 12 cost time: 11.121114730834961
Epoch: 12, Steps: 208 | Train Loss: 2.118 Vali Loss: 4.456 Vali Acc: 0.104 Test Loss: 4.456 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5694835
	speed: 0.3189s/iter; left time: 5805.5889s
	iters: 200, epoch: 13 | loss: 2.0255930
	speed: 0.0545s/iter; left time: 986.3970s
Epoch: 13 cost time: 11.822428941726685
Epoch: 13, Steps: 208 | Train Loss: 2.030 Vali Loss: 4.460 Vali Acc: 0.104 Test Loss: 4.460 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.4620099
	speed: 0.3154s/iter; left time: 5675.5358s
	iters: 200, epoch: 14 | loss: 2.3215151
	speed: 0.0516s/iter; left time: 923.2770s
Epoch: 14 cost time: 11.714207172393799
Epoch: 14, Steps: 208 | Train Loss: 1.915 Vali Loss: 4.604 Vali Acc: 0.107 Test Loss: 4.604 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4930894
	speed: 0.3296s/iter; left time: 5862.6047s
	iters: 200, epoch: 15 | loss: 1.6237341
	speed: 0.0508s/iter; left time: 897.8680s
Epoch: 15 cost time: 11.539047718048096
Epoch: 15, Steps: 208 | Train Loss: 1.855 Vali Loss: 4.706 Vali Acc: 0.108 Test Loss: 4.706 Test Acc: 0.108
Validation loss decreased (-0.107621 --> -0.108214).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3429866
	speed: 0.3035s/iter; left time: 5335.9518s
	iters: 200, epoch: 16 | loss: 2.5067325
	speed: 0.0473s/iter; left time: 827.1690s
Epoch: 16 cost time: 11.726251602172852
Epoch: 16, Steps: 208 | Train Loss: 1.786 Vali Loss: 4.794 Vali Acc: 0.112 Test Loss: 4.794 Test Acc: 0.112
Validation loss decreased (-0.108214 --> -0.112389).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6953893
	speed: 0.3003s/iter; left time: 5216.5435s
	iters: 200, epoch: 17 | loss: 2.5313258
	speed: 0.0543s/iter; left time: 938.1520s
Epoch: 17 cost time: 12.364232301712036
Epoch: 17, Steps: 208 | Train Loss: 1.685 Vali Loss: 4.916 Vali Acc: 0.110 Test Loss: 4.916 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5192442
	speed: 0.2814s/iter; left time: 4830.3901s
	iters: 200, epoch: 18 | loss: 1.2111371
	speed: 0.0515s/iter; left time: 879.5108s
Epoch: 18 cost time: 11.934080123901367
Epoch: 18, Steps: 208 | Train Loss: 1.634 Vali Loss: 5.050 Vali Acc: 0.103 Test Loss: 5.050 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1516006
	speed: 0.2888s/iter; left time: 4897.5016s
	iters: 200, epoch: 19 | loss: 1.0097270
	speed: 0.0542s/iter; left time: 913.2822s
Epoch: 19 cost time: 12.263261318206787
Epoch: 19, Steps: 208 | Train Loss: 1.571 Vali Loss: 5.221 Vali Acc: 0.108 Test Loss: 5.221 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.7957072
	speed: 0.3159s/iter; left time: 5291.3909s
	iters: 200, epoch: 20 | loss: 1.6574742
	speed: 0.0485s/iter; left time: 806.6923s
Epoch: 20 cost time: 12.457051277160645
Epoch: 20, Steps: 208 | Train Loss: 1.515 Vali Loss: 5.323 Vali Acc: 0.105 Test Loss: 5.323 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.9010190
	speed: 0.3192s/iter; left time: 5279.6908s
	iters: 200, epoch: 21 | loss: 1.7058544
	speed: 0.0516s/iter; left time: 848.3520s
Epoch: 21 cost time: 12.31546688079834
Epoch: 21, Steps: 208 | Train Loss: 1.473 Vali Loss: 5.433 Vali Acc: 0.121 Test Loss: 5.433 Test Acc: 0.121
Validation loss decreased (-0.112389 --> -0.120733).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.1293900
	speed: 0.3035s/iter; left time: 4957.3009s
	iters: 200, epoch: 22 | loss: 1.7202762
	speed: 0.0477s/iter; left time: 774.3763s
Epoch: 22 cost time: 11.763765573501587
Epoch: 22, Steps: 208 | Train Loss: 1.405 Vali Loss: 5.636 Vali Acc: 0.113 Test Loss: 5.636 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.4747446
	speed: 0.3129s/iter; left time: 5046.1802s
	iters: 200, epoch: 23 | loss: 1.9103017
	speed: 0.0535s/iter; left time: 857.5015s
Epoch: 23 cost time: 12.865455150604248
Epoch: 23, Steps: 208 | Train Loss: 1.332 Vali Loss: 5.880 Vali Acc: 0.110 Test Loss: 5.880 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.0428085
	speed: 0.3270s/iter; left time: 5204.6208s
	iters: 200, epoch: 24 | loss: 0.6837327
	speed: 0.0533s/iter; left time: 842.3208s
Epoch: 24 cost time: 12.759939670562744
Epoch: 24, Steps: 208 | Train Loss: 1.279 Vali Loss: 6.064 Vali Acc: 0.110 Test Loss: 6.064 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.5247370
	speed: 0.2902s/iter; left time: 4558.7257s
	iters: 200, epoch: 25 | loss: 1.5697197
	speed: 0.0426s/iter; left time: 664.5146s
Epoch: 25 cost time: 11.192223072052002
Epoch: 25, Steps: 208 | Train Loss: 1.250 Vali Loss: 6.071 Vali Acc: 0.107 Test Loss: 6.071 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.0258408
	speed: 0.2814s/iter; left time: 4361.4537s
	iters: 200, epoch: 26 | loss: 1.4426566
	speed: 0.0428s/iter; left time: 659.7137s
Epoch: 26 cost time: 9.663634061813354
Epoch: 26, Steps: 208 | Train Loss: 1.208 Vali Loss: 6.343 Vali Acc: 0.109 Test Loss: 6.343 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.9768448
	speed: 0.2980s/iter; left time: 4558.0447s
	iters: 200, epoch: 27 | loss: 1.4837461
	speed: 0.0483s/iter; left time: 733.1026s
Epoch: 27 cost time: 11.43556809425354
Epoch: 27, Steps: 208 | Train Loss: 1.141 Vali Loss: 6.559 Vali Acc: 0.109 Test Loss: 6.559 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.7929641
	speed: 0.3148s/iter; left time: 4748.5853s
	iters: 200, epoch: 28 | loss: 0.9403213
	speed: 0.0500s/iter; left time: 749.6374s
Epoch: 28 cost time: 11.649475336074829
Epoch: 28, Steps: 208 | Train Loss: 1.155 Vali Loss: 6.681 Vali Acc: 0.107 Test Loss: 6.681 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.4169322
	speed: 0.3214s/iter; left time: 4781.1009s
	iters: 200, epoch: 29 | loss: 1.7922215
	speed: 0.0561s/iter; left time: 828.2529s
Epoch: 29 cost time: 12.143690586090088
Epoch: 29, Steps: 208 | Train Loss: 1.069 Vali Loss: 6.918 Vali Acc: 0.106 Test Loss: 6.918 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.8391383
	speed: 0.3174s/iter; left time: 4656.6340s
	iters: 200, epoch: 30 | loss: 1.0011652
	speed: 0.0565s/iter; left time: 822.4739s
Epoch: 30 cost time: 12.527538776397705
Epoch: 30, Steps: 208 | Train Loss: 1.043 Vali Loss: 7.049 Vali Acc: 0.119 Test Loss: 7.049 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.5905429
	speed: 0.3271s/iter; left time: 4730.1132s
	iters: 200, epoch: 31 | loss: 1.3642063
	speed: 0.0585s/iter; left time: 840.2961s
Epoch: 31 cost time: 13.107975959777832
Epoch: 31, Steps: 208 | Train Loss: 1.003 Vali Loss: 7.251 Vali Acc: 0.110 Test Loss: 7.251 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1207873546078139
model parameter : 141623
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6513631
	speed: 0.0972s/iter; left time: 2011.7766s
	iters: 200, epoch: 1 | loss: 3.6708057
	speed: 0.0473s/iter; left time: 974.4206s
Epoch: 1 cost time: 15.02902102470398
Epoch: 1, Steps: 208 | Train Loss: 3.763 Vali Loss: 3.717 Vali Acc: 0.056 Test Loss: 3.717 Test Acc: 0.056
Validation loss decreased (inf --> -0.056330).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4319844
	speed: 0.3042s/iter; left time: 6233.1804s
	iters: 200, epoch: 2 | loss: 3.9489999
	speed: 0.0478s/iter; left time: 973.9057s
Epoch: 2 cost time: 11.299785852432251
Epoch: 2, Steps: 208 | Train Loss: 3.583 Vali Loss: 3.715 Vali Acc: 0.072 Test Loss: 3.715 Test Acc: 0.072
Validation loss decreased (-0.056330 --> -0.071541).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1778975
	speed: 0.2835s/iter; left time: 5750.5142s
	iters: 200, epoch: 3 | loss: 3.2815838
	speed: 0.0501s/iter; left time: 1010.6648s
Epoch: 3 cost time: 12.05935001373291
Epoch: 3, Steps: 208 | Train Loss: 3.364 Vali Loss: 3.624 Vali Acc: 0.084 Test Loss: 3.624 Test Acc: 0.084
Validation loss decreased (-0.071541 --> -0.084068).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9461846
	speed: 0.2893s/iter; left time: 5809.0342s
	iters: 200, epoch: 4 | loss: 3.6267681
	speed: 0.0521s/iter; left time: 1041.0035s
Epoch: 4 cost time: 12.04364275932312
Epoch: 4, Steps: 208 | Train Loss: 3.194 Vali Loss: 3.691 Vali Acc: 0.078 Test Loss: 3.691 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2302551
	speed: 0.2747s/iter; left time: 5457.4220s
	iters: 200, epoch: 5 | loss: 3.2715752
	speed: 0.0457s/iter; left time: 903.8884s
Epoch: 5 cost time: 11.236001253128052
Epoch: 5, Steps: 208 | Train Loss: 3.051 Vali Loss: 3.709 Vali Acc: 0.092 Test Loss: 3.709 Test Acc: 0.092
Validation loss decreased (-0.084068 --> -0.091821).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9956996
	speed: 0.2641s/iter; left time: 5192.9315s
	iters: 200, epoch: 6 | loss: 2.8886209
	speed: 0.0510s/iter; left time: 996.8230s
Epoch: 6 cost time: 11.266652345657349
Epoch: 6, Steps: 208 | Train Loss: 2.945 Vali Loss: 3.795 Vali Acc: 0.089 Test Loss: 3.795 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.6403275
	speed: 0.2682s/iter; left time: 5216.9107s
	iters: 200, epoch: 7 | loss: 2.6989965
	speed: 0.0531s/iter; left time: 1028.5801s
Epoch: 7 cost time: 11.409871101379395
Epoch: 7, Steps: 208 | Train Loss: 2.818 Vali Loss: 3.752 Vali Acc: 0.094 Test Loss: 3.752 Test Acc: 0.094
Validation loss decreased (-0.091821 --> -0.093908).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3961799
	speed: 0.2675s/iter; left time: 5147.1619s
	iters: 200, epoch: 8 | loss: 2.6500897
	speed: 0.0479s/iter; left time: 917.7369s
Epoch: 8 cost time: 10.622586011886597
Epoch: 8, Steps: 208 | Train Loss: 2.724 Vali Loss: 3.823 Vali Acc: 0.101 Test Loss: 3.823 Test Acc: 0.101
Validation loss decreased (-0.093908 --> -0.100767).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0296593
	speed: 0.2608s/iter; left time: 4963.9869s
	iters: 200, epoch: 9 | loss: 3.1280954
	speed: 0.0419s/iter; left time: 792.9343s
Epoch: 9 cost time: 10.24710464477539
Epoch: 9, Steps: 208 | Train Loss: 2.620 Vali Loss: 3.849 Vali Acc: 0.103 Test Loss: 3.849 Test Acc: 0.103
Validation loss decreased (-0.100767 --> -0.102854).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5854342
	speed: 0.2824s/iter; left time: 5316.5529s
	iters: 200, epoch: 10 | loss: 2.8936372
	speed: 0.0511s/iter; left time: 956.9573s
Epoch: 10 cost time: 12.19610857963562
Epoch: 10, Steps: 208 | Train Loss: 2.529 Vali Loss: 3.907 Vali Acc: 0.115 Test Loss: 3.907 Test Acc: 0.115
Validation loss decreased (-0.102854 --> -0.114783).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.7056775
	speed: 0.2907s/iter; left time: 5413.3228s
	iters: 200, epoch: 11 | loss: 2.5553892
	speed: 0.0496s/iter; left time: 917.9456s
Epoch: 11 cost time: 11.929063320159912
Epoch: 11, Steps: 208 | Train Loss: 2.467 Vali Loss: 4.005 Vali Acc: 0.104 Test Loss: 4.005 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.4453514
	speed: 0.2694s/iter; left time: 4960.7905s
	iters: 200, epoch: 12 | loss: 2.7601514
	speed: 0.0454s/iter; left time: 831.0340s
Epoch: 12 cost time: 11.265929460525513
Epoch: 12, Steps: 208 | Train Loss: 2.381 Vali Loss: 3.996 Vali Acc: 0.116 Test Loss: 3.996 Test Acc: 0.116
Validation loss decreased (-0.114783 --> -0.115677).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2328172
	speed: 0.2705s/iter; left time: 4924.1146s
	iters: 200, epoch: 13 | loss: 2.5090787
	speed: 0.0444s/iter; left time: 803.4500s
Epoch: 13 cost time: 10.972092866897583
Epoch: 13, Steps: 208 | Train Loss: 2.293 Vali Loss: 4.109 Vali Acc: 0.113 Test Loss: 4.109 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.1161578
	speed: 0.2530s/iter; left time: 4553.5925s
	iters: 200, epoch: 14 | loss: 2.3962975
	speed: 0.0451s/iter; left time: 807.9300s
Epoch: 14 cost time: 10.800880908966064
Epoch: 14, Steps: 208 | Train Loss: 2.215 Vali Loss: 4.115 Vali Acc: 0.110 Test Loss: 4.115 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.0064728
	speed: 0.2547s/iter; left time: 4530.7046s
	iters: 200, epoch: 15 | loss: 2.0182893
	speed: 0.0466s/iter; left time: 824.6678s
Epoch: 15 cost time: 10.920556545257568
Epoch: 15, Steps: 208 | Train Loss: 2.160 Vali Loss: 4.190 Vali Acc: 0.113 Test Loss: 4.190 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.3047242
	speed: 0.2805s/iter; left time: 4930.7602s
	iters: 200, epoch: 16 | loss: 1.6525520
	speed: 0.0478s/iter; left time: 836.3759s
Epoch: 16 cost time: 11.68135690689087
Epoch: 16, Steps: 208 | Train Loss: 2.096 Vali Loss: 4.361 Vali Acc: 0.100 Test Loss: 4.361 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.3578556
	speed: 0.2949s/iter; left time: 5123.0867s
	iters: 200, epoch: 17 | loss: 1.8530033
	speed: 0.0451s/iter; left time: 779.3570s
Epoch: 17 cost time: 11.280709981918335
Epoch: 17, Steps: 208 | Train Loss: 2.036 Vali Loss: 4.324 Vali Acc: 0.115 Test Loss: 4.324 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.9152055
	speed: 0.2829s/iter; left time: 4855.1926s
	iters: 200, epoch: 18 | loss: 2.3798006
	speed: 0.0454s/iter; left time: 774.9709s
Epoch: 18 cost time: 10.69551396369934
Epoch: 18, Steps: 208 | Train Loss: 1.997 Vali Loss: 4.442 Vali Acc: 0.114 Test Loss: 4.442 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.9689829
	speed: 0.2844s/iter; left time: 4822.6483s
	iters: 200, epoch: 19 | loss: 1.5556631
	speed: 0.0420s/iter; left time: 707.6993s
Epoch: 19 cost time: 10.51719355583191
Epoch: 19, Steps: 208 | Train Loss: 1.960 Vali Loss: 4.595 Vali Acc: 0.110 Test Loss: 4.595 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.8717130
	speed: 0.2717s/iter; left time: 4550.7889s
	iters: 200, epoch: 20 | loss: 2.3961585
	speed: 0.0445s/iter; left time: 741.6709s
Epoch: 20 cost time: 11.065645217895508
Epoch: 20, Steps: 208 | Train Loss: 1.863 Vali Loss: 4.609 Vali Acc: 0.112 Test Loss: 4.609 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.1333768
	speed: 0.2620s/iter; left time: 4333.2230s
	iters: 200, epoch: 21 | loss: 2.4836705
	speed: 0.0449s/iter; left time: 737.8738s
Epoch: 21 cost time: 11.212166786193848
Epoch: 21, Steps: 208 | Train Loss: 1.851 Vali Loss: 4.695 Vali Acc: 0.110 Test Loss: 4.695 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.0087450
	speed: 0.2694s/iter; left time: 4400.8250s
	iters: 200, epoch: 22 | loss: 1.4190810
	speed: 0.0503s/iter; left time: 817.0756s
Epoch: 22 cost time: 11.564768075942993
Epoch: 22, Steps: 208 | Train Loss: 1.759 Vali Loss: 4.798 Vali Acc: 0.107 Test Loss: 4.798 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11571726811810319
model parameter : 93751
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6357980
	speed: 0.0908s/iter; left time: 1879.1971s
	iters: 200, epoch: 1 | loss: 3.6880722
	speed: 0.0591s/iter; left time: 1217.7843s
Epoch: 1 cost time: 15.697988986968994
Epoch: 1, Steps: 208 | Train Loss: 3.756 Vali Loss: 3.684 Vali Acc: 0.051 Test Loss: 3.684 Test Acc: 0.051
Validation loss decreased (inf --> -0.050664).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7167242
	speed: 0.3094s/iter; left time: 6340.1472s
	iters: 200, epoch: 2 | loss: 3.3288443
	speed: 0.0556s/iter; left time: 1133.2058s
Epoch: 2 cost time: 12.810931921005249
Epoch: 2, Steps: 208 | Train Loss: 3.594 Vali Loss: 3.735 Vali Acc: 0.058 Test Loss: 3.735 Test Acc: 0.058
Validation loss decreased (-0.050664 --> -0.057523).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4165664
	speed: 0.3235s/iter; left time: 6563.1192s
	iters: 200, epoch: 3 | loss: 3.3271887
	speed: 0.0572s/iter; left time: 1155.4676s
Epoch: 3 cost time: 13.905184745788574
Epoch: 3, Steps: 208 | Train Loss: 3.460 Vali Loss: 3.685 Vali Acc: 0.067 Test Loss: 3.685 Test Acc: 0.067
Validation loss decreased (-0.057523 --> -0.066471).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0427008
	speed: 0.3086s/iter; left time: 6196.7400s
	iters: 200, epoch: 4 | loss: 2.7918861
	speed: 0.0503s/iter; left time: 1004.0358s
Epoch: 4 cost time: 12.66440463066101
Epoch: 4, Steps: 208 | Train Loss: 3.259 Vali Loss: 3.616 Vali Acc: 0.074 Test Loss: 3.616 Test Acc: 0.074
Validation loss decreased (-0.066471 --> -0.073927).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5392766
	speed: 0.2995s/iter; left time: 5950.5555s
	iters: 200, epoch: 5 | loss: 3.1101871
	speed: 0.0471s/iter; left time: 930.2246s
Epoch: 5 cost time: 11.081925630569458
Epoch: 5, Steps: 208 | Train Loss: 3.119 Vali Loss: 3.590 Vali Acc: 0.084 Test Loss: 3.590 Test Acc: 0.084
Validation loss decreased (-0.073927 --> -0.084068).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2890778
	speed: 0.2936s/iter; left time: 5772.6519s
	iters: 200, epoch: 6 | loss: 2.8756704
	speed: 0.0514s/iter; left time: 1005.6424s
Epoch: 6 cost time: 10.908856868743896
Epoch: 6, Steps: 208 | Train Loss: 3.012 Vali Loss: 3.654 Vali Acc: 0.090 Test Loss: 3.654 Test Acc: 0.090
Validation loss decreased (-0.084068 --> -0.090330).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3763828
	speed: 0.3071s/iter; left time: 5974.3616s
	iters: 200, epoch: 7 | loss: 3.4019706
	speed: 0.0489s/iter; left time: 946.3171s
Epoch: 7 cost time: 11.57329249382019
Epoch: 7, Steps: 208 | Train Loss: 2.914 Vali Loss: 3.727 Vali Acc: 0.086 Test Loss: 3.727 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.1142740
	speed: 0.3344s/iter; left time: 6436.3541s
	iters: 200, epoch: 8 | loss: 2.7014577
	speed: 0.0512s/iter; left time: 980.7052s
Epoch: 8 cost time: 12.334706544876099
Epoch: 8, Steps: 208 | Train Loss: 2.867 Vali Loss: 3.719 Vali Acc: 0.097 Test Loss: 3.719 Test Acc: 0.097
Validation loss decreased (-0.090330 --> -0.097189).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5326970
	speed: 0.3276s/iter; left time: 6235.7577s
	iters: 200, epoch: 9 | loss: 3.1485305
	speed: 0.0585s/iter; left time: 1108.7589s
Epoch: 9 cost time: 13.181556224822998
Epoch: 9, Steps: 208 | Train Loss: 2.753 Vali Loss: 3.768 Vali Acc: 0.097 Test Loss: 3.768 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.5943153
	speed: 0.3295s/iter; left time: 6204.3300s
	iters: 200, epoch: 10 | loss: 3.0492773
	speed: 0.0554s/iter; left time: 1038.1503s
Epoch: 10 cost time: 11.870058059692383
Epoch: 10, Steps: 208 | Train Loss: 2.698 Vali Loss: 3.793 Vali Acc: 0.090 Test Loss: 3.793 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.7811475
	speed: 0.3248s/iter; left time: 6047.3324s
	iters: 200, epoch: 11 | loss: 2.8883367
	speed: 0.0473s/iter; left time: 876.7187s
Epoch: 11 cost time: 12.28342890739441
Epoch: 11, Steps: 208 | Train Loss: 2.630 Vali Loss: 3.775 Vali Acc: 0.095 Test Loss: 3.775 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.5608804
	speed: 0.3106s/iter; left time: 5719.4685s
	iters: 200, epoch: 12 | loss: 2.9771481
	speed: 0.0503s/iter; left time: 920.4843s
Epoch: 12 cost time: 12.337512731552124
Epoch: 12, Steps: 208 | Train Loss: 2.560 Vali Loss: 3.871 Vali Acc: 0.100 Test Loss: 3.871 Test Acc: 0.100
Validation loss decreased (-0.097189 --> -0.099574).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.5016813
	speed: 0.3190s/iter; left time: 5807.9675s
	iters: 200, epoch: 13 | loss: 2.7070324
	speed: 0.0473s/iter; left time: 855.9838s
Epoch: 13 cost time: 11.025529384613037
Epoch: 13, Steps: 208 | Train Loss: 2.482 Vali Loss: 3.872 Vali Acc: 0.102 Test Loss: 3.872 Test Acc: 0.102
Validation loss decreased (-0.099574 --> -0.101661).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.3735702
	speed: 0.3227s/iter; left time: 5808.3076s
	iters: 200, epoch: 14 | loss: 2.8320467
	speed: 0.0552s/iter; left time: 987.6153s
Epoch: 14 cost time: 13.087399005889893
Epoch: 14, Steps: 208 | Train Loss: 2.427 Vali Loss: 3.915 Vali Acc: 0.096 Test Loss: 3.915 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.1501272
	speed: 0.3138s/iter; left time: 5581.4669s
	iters: 200, epoch: 15 | loss: 2.5905924
	speed: 0.0584s/iter; left time: 1032.3844s
Epoch: 15 cost time: 12.809239387512207
Epoch: 15, Steps: 208 | Train Loss: 2.377 Vali Loss: 4.024 Vali Acc: 0.101 Test Loss: 4.024 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.1463163
	speed: 0.2925s/iter; left time: 5143.1412s
	iters: 200, epoch: 16 | loss: 1.6521004
	speed: 0.0500s/iter; left time: 874.5707s
Epoch: 16 cost time: 12.059915781021118
Epoch: 16, Steps: 208 | Train Loss: 2.320 Vali Loss: 4.075 Vali Acc: 0.098 Test Loss: 4.075 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.7469344
	speed: 0.2957s/iter; left time: 5136.4717s
	iters: 200, epoch: 17 | loss: 2.3253582
	speed: 0.0411s/iter; left time: 710.4054s
Epoch: 17 cost time: 10.489458560943604
Epoch: 17, Steps: 208 | Train Loss: 2.261 Vali Loss: 4.136 Vali Acc: 0.103 Test Loss: 4.136 Test Acc: 0.103
Validation loss decreased (-0.101661 --> -0.102852).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.9948455
	speed: 0.3069s/iter; left time: 5268.2480s
	iters: 200, epoch: 18 | loss: 1.7740619
	speed: 0.0510s/iter; left time: 869.4822s
Epoch: 18 cost time: 12.181782484054565
Epoch: 18, Steps: 208 | Train Loss: 2.202 Vali Loss: 4.252 Vali Acc: 0.099 Test Loss: 4.252 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.3194880
	speed: 0.3159s/iter; left time: 5357.4250s
	iters: 200, epoch: 19 | loss: 3.2680938
	speed: 0.0544s/iter; left time: 917.4775s
Epoch: 19 cost time: 12.628371715545654
Epoch: 19, Steps: 208 | Train Loss: 2.156 Vali Loss: 4.349 Vali Acc: 0.096 Test Loss: 4.349 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.7025595
	speed: 0.3277s/iter; left time: 5488.8304s
	iters: 200, epoch: 20 | loss: 1.9900324
	speed: 0.0466s/iter; left time: 775.0704s
Epoch: 20 cost time: 12.533066987991333
Epoch: 20, Steps: 208 | Train Loss: 2.071 Vali Loss: 4.418 Vali Acc: 0.100 Test Loss: 4.418 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 2.3660553
	speed: 0.3049s/iter; left time: 5042.6041s
	iters: 200, epoch: 21 | loss: 2.2181370
	speed: 0.0580s/iter; left time: 953.5721s
Epoch: 21 cost time: 12.641570329666138
Epoch: 21, Steps: 208 | Train Loss: 2.076 Vali Loss: 4.487 Vali Acc: 0.112 Test Loss: 4.487 Test Acc: 0.112
Validation loss decreased (-0.102852 --> -0.111497).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.7391815
	speed: 0.3117s/iter; left time: 5091.0579s
	iters: 200, epoch: 22 | loss: 2.9272308
	speed: 0.0510s/iter; left time: 827.6501s
Epoch: 22 cost time: 12.068290710449219
Epoch: 22, Steps: 208 | Train Loss: 2.000 Vali Loss: 4.494 Vali Acc: 0.104 Test Loss: 4.494 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.7403188
	speed: 0.3199s/iter; left time: 5157.9905s
	iters: 200, epoch: 23 | loss: 2.2504208
	speed: 0.0484s/iter; left time: 775.5479s
Epoch: 23 cost time: 11.471643924713135
Epoch: 23, Steps: 208 | Train Loss: 1.988 Vali Loss: 4.583 Vali Acc: 0.107 Test Loss: 4.583 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.9995748
	speed: 0.3250s/iter; left time: 5172.4081s
	iters: 200, epoch: 24 | loss: 1.8176470
	speed: 0.0560s/iter; left time: 885.6860s
Epoch: 24 cost time: 12.672679662704468
Epoch: 24, Steps: 208 | Train Loss: 1.931 Vali Loss: 4.644 Vali Acc: 0.106 Test Loss: 4.644 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 2.7628515
	speed: 0.3360s/iter; left time: 5278.9313s
	iters: 200, epoch: 25 | loss: 2.0462422
	speed: 0.0589s/iter; left time: 919.6090s
Epoch: 25 cost time: 14.158929586410522
Epoch: 25, Steps: 208 | Train Loss: 1.893 Vali Loss: 4.733 Vali Acc: 0.108 Test Loss: 4.733 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.3162771
	speed: 0.3229s/iter; left time: 5004.9774s
	iters: 200, epoch: 26 | loss: 1.5581479
	speed: 0.0519s/iter; left time: 799.5008s
Epoch: 26 cost time: 12.500359773635864
Epoch: 26, Steps: 208 | Train Loss: 1.860 Vali Loss: 4.850 Vali Acc: 0.099 Test Loss: 4.850 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.3574703
	speed: 0.3189s/iter; left time: 4877.6658s
	iters: 200, epoch: 27 | loss: 2.4037175
	speed: 0.0505s/iter; left time: 766.8191s
Epoch: 27 cost time: 11.715915203094482
Epoch: 27, Steps: 208 | Train Loss: 1.842 Vali Loss: 4.808 Vali Acc: 0.101 Test Loss: 4.808 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 2.1052299
	speed: 0.3361s/iter; left time: 5069.4634s
	iters: 200, epoch: 28 | loss: 2.9358199
	speed: 0.0543s/iter; left time: 812.9804s
Epoch: 28 cost time: 12.324265480041504
Epoch: 28, Steps: 208 | Train Loss: 1.780 Vali Loss: 5.009 Vali Acc: 0.105 Test Loss: 5.009 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.6998045
	speed: 0.3280s/iter; left time: 4879.1906s
	iters: 200, epoch: 29 | loss: 2.1551263
	speed: 0.0570s/iter; left time: 843.0016s
Epoch: 29 cost time: 12.643115282058716
Epoch: 29, Steps: 208 | Train Loss: 1.745 Vali Loss: 5.091 Vali Acc: 0.108 Test Loss: 5.091 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.8800521
	speed: 0.3266s/iter; left time: 4791.1490s
	iters: 200, epoch: 30 | loss: 2.2443151
	speed: 0.0535s/iter; left time: 778.8107s
Epoch: 30 cost time: 12.27161169052124
Epoch: 30, Steps: 208 | Train Loss: 1.701 Vali Loss: 5.134 Vali Acc: 0.106 Test Loss: 5.134 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.4294280
	speed: 0.3226s/iter; left time: 4665.6494s
	iters: 200, epoch: 31 | loss: 1.1277188
	speed: 0.0519s/iter; left time: 745.3653s
Epoch: 31 cost time: 11.608688831329346
Epoch: 31, Steps: 208 | Train Loss: 1.673 Vali Loss: 5.267 Vali Acc: 0.099 Test Loss: 5.267 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11154190277363556
model parameter : 73335
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9113042
	speed: 0.0997s/iter; left time: 2063.2319s
	iters: 200, epoch: 1 | loss: 3.4137473
	speed: 0.0502s/iter; left time: 1034.6961s
Epoch: 1 cost time: 15.593998432159424
Epoch: 1, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.679 Vali Acc: 0.054 Test Loss: 3.679 Test Acc: 0.054
Validation loss decreased (inf --> -0.054243).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7506201
	speed: 0.3129s/iter; left time: 6412.7569s
	iters: 200, epoch: 2 | loss: 3.9376907
	speed: 0.0579s/iter; left time: 1181.3335s
Epoch: 2 cost time: 12.977901935577393
Epoch: 2, Steps: 208 | Train Loss: 3.599 Vali Loss: 3.692 Vali Acc: 0.058 Test Loss: 3.692 Test Acc: 0.058
Validation loss decreased (-0.054243 --> -0.057523).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5073853
	speed: 0.2905s/iter; left time: 5892.3127s
	iters: 200, epoch: 3 | loss: 3.5309141
	speed: 0.0567s/iter; left time: 1143.6265s
Epoch: 3 cost time: 12.671493530273438
Epoch: 3, Steps: 208 | Train Loss: 3.485 Vali Loss: 3.679 Vali Acc: 0.064 Test Loss: 3.679 Test Acc: 0.064
Validation loss decreased (-0.057523 --> -0.063787).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2422638
	speed: 0.2871s/iter; left time: 5763.8820s
	iters: 200, epoch: 4 | loss: 3.4793231
	speed: 0.0522s/iter; left time: 1043.6209s
Epoch: 4 cost time: 11.555931091308594
Epoch: 4, Steps: 208 | Train Loss: 3.323 Vali Loss: 3.602 Vali Acc: 0.072 Test Loss: 3.602 Test Acc: 0.072
Validation loss decreased (-0.063787 --> -0.071840).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0937407
	speed: 0.2731s/iter; left time: 5425.3057s
	iters: 200, epoch: 5 | loss: 3.4706128
	speed: 0.0508s/iter; left time: 1004.9032s
Epoch: 5 cost time: 12.005474090576172
Epoch: 5, Steps: 208 | Train Loss: 3.177 Vali Loss: 3.646 Vali Acc: 0.067 Test Loss: 3.646 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1925168
	speed: 0.2761s/iter; left time: 5429.3261s
	iters: 200, epoch: 6 | loss: 3.1808898
	speed: 0.0523s/iter; left time: 1022.9200s
Epoch: 6 cost time: 12.258440256118774
Epoch: 6, Steps: 208 | Train Loss: 3.073 Vali Loss: 3.630 Vali Acc: 0.080 Test Loss: 3.630 Test Acc: 0.080
Validation loss decreased (-0.071840 --> -0.080190).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0783138
	speed: 0.2916s/iter; left time: 5672.8437s
	iters: 200, epoch: 7 | loss: 2.9183228
	speed: 0.0522s/iter; left time: 1010.0769s
Epoch: 7 cost time: 12.37276005744934
Epoch: 7, Steps: 208 | Train Loss: 2.989 Vali Loss: 3.642 Vali Acc: 0.076 Test Loss: 3.642 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0945528
	speed: 0.3009s/iter; left time: 5791.0420s
	iters: 200, epoch: 8 | loss: 3.0739017
	speed: 0.0544s/iter; left time: 1041.6935s
Epoch: 8 cost time: 12.38119626045227
Epoch: 8, Steps: 208 | Train Loss: 2.901 Vali Loss: 3.723 Vali Acc: 0.086 Test Loss: 3.723 Test Acc: 0.086
Validation loss decreased (-0.080190 --> -0.085558).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8379726
	speed: 0.3065s/iter; left time: 5834.7323s
	iters: 200, epoch: 9 | loss: 3.0170875
	speed: 0.0519s/iter; left time: 983.3665s
Epoch: 9 cost time: 11.703244686126709
Epoch: 9, Steps: 208 | Train Loss: 2.836 Vali Loss: 3.645 Vali Acc: 0.092 Test Loss: 3.645 Test Acc: 0.092
Validation loss decreased (-0.085558 --> -0.091523).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4555628
	speed: 0.3133s/iter; left time: 5898.3232s
	iters: 200, epoch: 10 | loss: 3.0925832
	speed: 0.0513s/iter; left time: 960.6636s
Epoch: 10 cost time: 11.655131101608276
Epoch: 10, Steps: 208 | Train Loss: 2.754 Vali Loss: 3.698 Vali Acc: 0.089 Test Loss: 3.698 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.7295954
	speed: 0.3151s/iter; left time: 5868.2431s
	iters: 200, epoch: 11 | loss: 3.6107874
	speed: 0.0477s/iter; left time: 882.7062s
Epoch: 11 cost time: 11.553481578826904
Epoch: 11, Steps: 208 | Train Loss: 2.704 Vali Loss: 3.768 Vali Acc: 0.095 Test Loss: 3.768 Test Acc: 0.095
Validation loss decreased (-0.091523 --> -0.094803).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.9762235
	speed: 0.2983s/iter; left time: 5492.8227s
	iters: 200, epoch: 12 | loss: 2.8631361
	speed: 0.0447s/iter; left time: 817.8510s
Epoch: 12 cost time: 10.725585460662842
Epoch: 12, Steps: 208 | Train Loss: 2.638 Vali Loss: 3.768 Vali Acc: 0.101 Test Loss: 3.768 Test Acc: 0.101
Validation loss decreased (-0.094803 --> -0.100768).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0531075
	speed: 0.2776s/iter; left time: 5053.6726s
	iters: 200, epoch: 13 | loss: 1.8688587
	speed: 0.0441s/iter; left time: 798.0124s
Epoch: 13 cost time: 10.871574401855469
Epoch: 13, Steps: 208 | Train Loss: 2.565 Vali Loss: 3.824 Vali Acc: 0.098 Test Loss: 3.824 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2623568
	speed: 0.2816s/iter; left time: 5068.5932s
	iters: 200, epoch: 14 | loss: 3.4681849
	speed: 0.0463s/iter; left time: 829.4019s
Epoch: 14 cost time: 10.906516075134277
Epoch: 14, Steps: 208 | Train Loss: 2.518 Vali Loss: 3.873 Vali Acc: 0.095 Test Loss: 3.873 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.2897446
	speed: 0.2865s/iter; left time: 5097.4263s
	iters: 200, epoch: 15 | loss: 2.6133490
	speed: 0.0480s/iter; left time: 849.4097s
Epoch: 15 cost time: 11.410501718521118
Epoch: 15, Steps: 208 | Train Loss: 2.460 Vali Loss: 3.976 Vali Acc: 0.094 Test Loss: 3.976 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.5462685
	speed: 0.2906s/iter; left time: 5108.3660s
	iters: 200, epoch: 16 | loss: 2.2568440
	speed: 0.0455s/iter; left time: 794.6487s
Epoch: 16 cost time: 10.894533157348633
Epoch: 16, Steps: 208 | Train Loss: 2.397 Vali Loss: 4.052 Vali Acc: 0.092 Test Loss: 4.052 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.2871637
	speed: 0.2921s/iter; left time: 5074.4327s
	iters: 200, epoch: 17 | loss: 2.5312219
	speed: 0.0501s/iter; left time: 865.8934s
Epoch: 17 cost time: 11.025726556777954
Epoch: 17, Steps: 208 | Train Loss: 2.335 Vali Loss: 4.104 Vali Acc: 0.090 Test Loss: 4.104 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.5959899
	speed: 0.3086s/iter; left time: 5297.6001s
	iters: 200, epoch: 18 | loss: 2.8243179
	speed: 0.0484s/iter; left time: 825.1311s
Epoch: 18 cost time: 11.121016502380371
Epoch: 18, Steps: 208 | Train Loss: 2.320 Vali Loss: 4.117 Vali Acc: 0.098 Test Loss: 4.117 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.1559107
	speed: 0.3112s/iter; left time: 5276.9508s
	iters: 200, epoch: 19 | loss: 2.5988657
	speed: 0.0464s/iter; left time: 782.4559s
Epoch: 19 cost time: 11.278331756591797
Epoch: 19, Steps: 208 | Train Loss: 2.252 Vali Loss: 4.233 Vali Acc: 0.088 Test Loss: 4.233 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.1426735
	speed: 0.2917s/iter; left time: 4885.7778s
	iters: 200, epoch: 20 | loss: 2.0461602
	speed: 0.0439s/iter; left time: 730.3146s
Epoch: 20 cost time: 10.489100456237793
Epoch: 20, Steps: 208 | Train Loss: 2.222 Vali Loss: 4.348 Vali Acc: 0.087 Test Loss: 4.348 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.5653892
	speed: 0.2975s/iter; left time: 4920.2145s
	iters: 200, epoch: 21 | loss: 1.9386001
	speed: 0.0536s/iter; left time: 881.7637s
Epoch: 21 cost time: 12.163497924804688
Epoch: 21, Steps: 208 | Train Loss: 2.158 Vali Loss: 4.416 Vali Acc: 0.089 Test Loss: 4.416 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.6696167
	speed: 0.3024s/iter; left time: 4938.3577s
	iters: 200, epoch: 22 | loss: 2.6652250
	speed: 0.0491s/iter; left time: 797.1850s
Epoch: 22 cost time: 11.333610773086548
Epoch: 22, Steps: 208 | Train Loss: 2.122 Vali Loss: 4.440 Vali Acc: 0.092 Test Loss: 4.440 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10080524903071876
model parameter : 59783
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3544545
	speed: 0.1011s/iter; left time: 2091.8734s
	iters: 200, epoch: 1 | loss: 4.5309124
	speed: 0.0698s/iter; left time: 1437.2745s
Epoch: 1 cost time: 17.77583384513855
Epoch: 1, Steps: 208 | Train Loss: 4.056 Vali Loss: 4.236 Vali Acc: 0.055 Test Loss: 4.236 Test Acc: 0.055
Validation loss decreased (inf --> -0.054536).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3190169
	speed: 0.3329s/iter; left time: 6821.7829s
	iters: 200, epoch: 2 | loss: 3.7790859
	speed: 0.0738s/iter; left time: 1504.0397s
Epoch: 2 cost time: 16.944971799850464
Epoch: 2, Steps: 208 | Train Loss: 3.695 Vali Loss: 4.171 Vali Acc: 0.066 Test Loss: 4.171 Test Acc: 0.066
Validation loss decreased (-0.054536 --> -0.065571).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0063782
	speed: 0.3099s/iter; left time: 6286.7275s
	iters: 200, epoch: 3 | loss: 2.6493697
	speed: 0.0926s/iter; left time: 1868.2595s
Epoch: 3 cost time: 18.415099143981934
Epoch: 3, Steps: 208 | Train Loss: 3.258 Vali Loss: 4.165 Vali Acc: 0.076 Test Loss: 4.165 Test Acc: 0.076
Validation loss decreased (-0.065571 --> -0.076308).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6792524
	speed: 0.3284s/iter; left time: 6593.8476s
	iters: 200, epoch: 4 | loss: 3.1903324
	speed: 0.0792s/iter; left time: 1582.2696s
Epoch: 4 cost time: 17.405905723571777
Epoch: 4, Steps: 208 | Train Loss: 2.983 Vali Loss: 4.141 Vali Acc: 0.089 Test Loss: 4.141 Test Acc: 0.089
Validation loss decreased (-0.076308 --> -0.088536).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7075500
	speed: 0.3022s/iter; left time: 6005.2513s
	iters: 200, epoch: 5 | loss: 2.9216528
	speed: 0.0538s/iter; left time: 1063.9831s
Epoch: 5 cost time: 13.280574321746826
Epoch: 5, Steps: 208 | Train Loss: 2.708 Vali Loss: 4.708 Vali Acc: 0.090 Test Loss: 4.708 Test Acc: 0.090
Validation loss decreased (-0.088536 --> -0.090320).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8464980
	speed: 0.2894s/iter; left time: 5689.7039s
	iters: 200, epoch: 6 | loss: 3.5757701
	speed: 0.0537s/iter; left time: 1050.0260s
Epoch: 6 cost time: 13.061786651611328
Epoch: 6, Steps: 208 | Train Loss: 2.440 Vali Loss: 4.423 Vali Acc: 0.094 Test Loss: 4.423 Test Acc: 0.094
Validation loss decreased (-0.090320 --> -0.093901).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5410168
	speed: 0.2885s/iter; left time: 5612.2275s
	iters: 200, epoch: 7 | loss: 2.3456888
	speed: 0.0622s/iter; left time: 1203.9827s
Epoch: 7 cost time: 14.451956987380981
Epoch: 7, Steps: 208 | Train Loss: 2.166 Vali Loss: 5.327 Vali Acc: 0.079 Test Loss: 5.327 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4746542
	speed: 0.2961s/iter; left time: 5698.4727s
	iters: 200, epoch: 8 | loss: 1.7029442
	speed: 0.0556s/iter; left time: 1063.7409s
Epoch: 8 cost time: 12.405219793319702
Epoch: 8, Steps: 208 | Train Loss: 1.909 Vali Loss: 5.084 Vali Acc: 0.088 Test Loss: 5.084 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5109394
	speed: 0.3050s/iter; left time: 5806.6792s
	iters: 200, epoch: 9 | loss: 2.4159291
	speed: 0.0590s/iter; left time: 1117.5392s
Epoch: 9 cost time: 14.176176309585571
Epoch: 9, Steps: 208 | Train Loss: 1.708 Vali Loss: 5.914 Vali Acc: 0.092 Test Loss: 5.914 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4439167
	speed: 0.2903s/iter; left time: 5466.7573s
	iters: 200, epoch: 10 | loss: 1.4211268
	speed: 0.0663s/iter; left time: 1240.9321s
Epoch: 10 cost time: 14.063453912734985
Epoch: 10, Steps: 208 | Train Loss: 1.451 Vali Loss: 5.889 Vali Acc: 0.088 Test Loss: 5.889 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5209124
	speed: 0.2805s/iter; left time: 5223.6687s
	iters: 200, epoch: 11 | loss: 1.3605388
	speed: 0.0555s/iter; left time: 1027.4019s
Epoch: 11 cost time: 12.774864673614502
Epoch: 11, Steps: 208 | Train Loss: 1.254 Vali Loss: 6.435 Vali Acc: 0.098 Test Loss: 6.435 Test Acc: 0.098
Validation loss decreased (-0.093901 --> -0.097758).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1088156
	speed: 0.2794s/iter; left time: 5144.0386s
	iters: 200, epoch: 12 | loss: 1.0190786
	speed: 0.0530s/iter; left time: 970.8451s
Epoch: 12 cost time: 12.345254898071289
Epoch: 12, Steps: 208 | Train Loss: 1.090 Vali Loss: 6.753 Vali Acc: 0.100 Test Loss: 6.753 Test Acc: 0.100
Validation loss decreased (-0.097758 --> -0.100141).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6570022
	speed: 0.2900s/iter; left time: 5280.2825s
	iters: 200, epoch: 13 | loss: 0.7810301
	speed: 0.0592s/iter; left time: 1071.5993s
Epoch: 13 cost time: 12.946059942245483
Epoch: 13, Steps: 208 | Train Loss: 0.939 Vali Loss: 7.223 Vali Acc: 0.107 Test Loss: 7.223 Test Acc: 0.107
Validation loss decreased (-0.100141 --> -0.107294).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5407425
	speed: 0.3164s/iter; left time: 5693.4018s
	iters: 200, epoch: 14 | loss: 0.7671117
	speed: 0.0588s/iter; left time: 1052.9112s
Epoch: 14 cost time: 13.3972487449646
Epoch: 14, Steps: 208 | Train Loss: 0.816 Vali Loss: 7.627 Vali Acc: 0.102 Test Loss: 7.627 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7310143
	speed: 0.3273s/iter; left time: 5821.5088s
	iters: 200, epoch: 15 | loss: 1.2485732
	speed: 0.0616s/iter; left time: 1090.2526s
Epoch: 15 cost time: 15.337960243225098
Epoch: 15, Steps: 208 | Train Loss: 0.724 Vali Loss: 8.574 Vali Acc: 0.100 Test Loss: 8.574 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3132528
	speed: 0.3326s/iter; left time: 5848.2189s
	iters: 200, epoch: 16 | loss: 0.3082838
	speed: 0.0724s/iter; left time: 1265.3874s
Epoch: 16 cost time: 16.59675621986389
Epoch: 16, Steps: 208 | Train Loss: 0.624 Vali Loss: 8.758 Vali Acc: 0.103 Test Loss: 8.758 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9873753
	speed: 0.3549s/iter; left time: 6165.7761s
	iters: 200, epoch: 17 | loss: 0.7039976
	speed: 0.0825s/iter; left time: 1425.5650s
Epoch: 17 cost time: 18.992300987243652
Epoch: 17, Steps: 208 | Train Loss: 0.561 Vali Loss: 9.462 Vali Acc: 0.092 Test Loss: 9.462 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5291758
	speed: 0.3781s/iter; left time: 6490.7564s
	iters: 200, epoch: 18 | loss: 0.4779461
	speed: 0.0849s/iter; left time: 1448.8915s
Epoch: 18 cost time: 18.720129251480103
Epoch: 18, Steps: 208 | Train Loss: 0.494 Vali Loss: 10.275 Vali Acc: 0.096 Test Loss: 10.275 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8347816
	speed: 0.3619s/iter; left time: 6137.2667s
	iters: 200, epoch: 19 | loss: 0.7559073
	speed: 0.0848s/iter; left time: 1429.6261s
Epoch: 19 cost time: 18.515719413757324
Epoch: 19, Steps: 208 | Train Loss: 0.458 Vali Loss: 10.445 Vali Acc: 0.096 Test Loss: 10.445 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1980219
	speed: 0.3698s/iter; left time: 6194.0991s
	iters: 200, epoch: 20 | loss: 1.0219909
	speed: 0.0901s/iter; left time: 1499.6475s
Epoch: 20 cost time: 19.43143653869629
Epoch: 20, Steps: 208 | Train Loss: 0.408 Vali Loss: 11.183 Vali Acc: 0.098 Test Loss: 11.183 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1709612
	speed: 0.3474s/iter; left time: 5746.6013s
	iters: 200, epoch: 21 | loss: 0.4299711
	speed: 0.0790s/iter; left time: 1298.2093s
Epoch: 21 cost time: 17.24219846725464
Epoch: 21, Steps: 208 | Train Loss: 0.403 Vali Loss: 11.257 Vali Acc: 0.097 Test Loss: 11.257 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0726175
	speed: 0.3530s/iter; left time: 5766.2222s
	iters: 200, epoch: 22 | loss: 0.7447904
	speed: 0.0775s/iter; left time: 1257.4329s
Epoch: 22 cost time: 17.118615865707397
Epoch: 22, Steps: 208 | Train Loss: 0.361 Vali Loss: 11.875 Vali Acc: 0.100 Test Loss: 11.875 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2478780
	speed: 0.3544s/iter; left time: 5715.3314s
	iters: 200, epoch: 23 | loss: 0.0520678
	speed: 0.0778s/iter; left time: 1247.5170s
Epoch: 23 cost time: 17.366472482681274
Epoch: 23, Steps: 208 | Train Loss: 0.302 Vali Loss: 12.026 Vali Acc: 0.095 Test Loss: 12.026 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10736653742916791
model parameter : 500935
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8084919
	speed: 0.0915s/iter; left time: 1893.9425s
	iters: 200, epoch: 1 | loss: 3.3585429
	speed: 0.0504s/iter; left time: 1038.1578s
Epoch: 1 cost time: 14.790510654449463
Epoch: 1, Steps: 208 | Train Loss: 3.853 Vali Loss: 3.949 Vali Acc: 0.063 Test Loss: 3.949 Test Acc: 0.063
Validation loss decreased (inf --> -0.062591).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8761706
	speed: 0.2974s/iter; left time: 6094.9012s
	iters: 200, epoch: 2 | loss: 4.1105452
	speed: 0.0480s/iter; left time: 978.9749s
Epoch: 2 cost time: 11.390901803970337
Epoch: 2, Steps: 208 | Train Loss: 3.611 Vali Loss: 3.903 Vali Acc: 0.069 Test Loss: 3.903 Test Acc: 0.069
Validation loss decreased (-0.062591 --> -0.068556).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6251223
	speed: 0.3051s/iter; left time: 6188.7041s
	iters: 200, epoch: 3 | loss: 4.2178512
	speed: 0.0515s/iter; left time: 1038.7946s
Epoch: 3 cost time: 11.444463729858398
Epoch: 3, Steps: 208 | Train Loss: 3.259 Vali Loss: 4.007 Vali Acc: 0.070 Test Loss: 4.007 Test Acc: 0.070
Validation loss decreased (-0.068556 --> -0.070345).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9043617
	speed: 0.3217s/iter; left time: 6457.7906s
	iters: 200, epoch: 4 | loss: 2.7750576
	speed: 0.0525s/iter; left time: 1048.6958s
Epoch: 4 cost time: 13.137407302856445
Epoch: 4, Steps: 208 | Train Loss: 3.007 Vali Loss: 4.239 Vali Acc: 0.082 Test Loss: 4.239 Test Acc: 0.082
Validation loss decreased (-0.070345 --> -0.082272).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7136552
	speed: 0.3120s/iter; left time: 6198.3906s
	iters: 200, epoch: 5 | loss: 3.4592690
	speed: 0.0492s/iter; left time: 972.9487s
Epoch: 5 cost time: 12.375802516937256
Epoch: 5, Steps: 208 | Train Loss: 2.771 Vali Loss: 4.226 Vali Acc: 0.096 Test Loss: 4.226 Test Acc: 0.096
Validation loss decreased (-0.082272 --> -0.095991).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0913491
	speed: 0.3137s/iter; left time: 6168.4157s
	iters: 200, epoch: 6 | loss: 2.4211774
	speed: 0.0499s/iter; left time: 975.1821s
Epoch: 6 cost time: 11.40178918838501
Epoch: 6, Steps: 208 | Train Loss: 2.604 Vali Loss: 4.412 Vali Acc: 0.103 Test Loss: 4.412 Test Acc: 0.103
Validation loss decreased (-0.095991 --> -0.102551).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7032430
	speed: 0.3085s/iter; left time: 6000.4599s
	iters: 200, epoch: 7 | loss: 2.1407788
	speed: 0.0540s/iter; left time: 1044.9148s
Epoch: 7 cost time: 12.580390930175781
Epoch: 7, Steps: 208 | Train Loss: 2.420 Vali Loss: 4.466 Vali Acc: 0.093 Test Loss: 4.466 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3638799
	speed: 0.2995s/iter; left time: 5764.7540s
	iters: 200, epoch: 8 | loss: 1.8244178
	speed: 0.0514s/iter; left time: 985.0040s
Epoch: 8 cost time: 11.683239459991455
Epoch: 8, Steps: 208 | Train Loss: 2.254 Vali Loss: 4.514 Vali Acc: 0.103 Test Loss: 4.514 Test Acc: 0.103
Validation loss decreased (-0.102551 --> -0.103444).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2946646
	speed: 0.3213s/iter; left time: 6116.8633s
	iters: 200, epoch: 9 | loss: 2.4077709
	speed: 0.0546s/iter; left time: 1033.3430s
Epoch: 9 cost time: 12.253060102462769
Epoch: 9, Steps: 208 | Train Loss: 2.098 Vali Loss: 4.793 Vali Acc: 0.096 Test Loss: 4.793 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9057455
	speed: 0.3135s/iter; left time: 5902.6646s
	iters: 200, epoch: 10 | loss: 2.8175192
	speed: 0.0526s/iter; left time: 985.1459s
Epoch: 10 cost time: 12.33496880531311
Epoch: 10, Steps: 208 | Train Loss: 1.961 Vali Loss: 4.766 Vali Acc: 0.103 Test Loss: 4.766 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9027205
	speed: 0.3084s/iter; left time: 5742.5550s
	iters: 200, epoch: 11 | loss: 1.6298714
	speed: 0.0490s/iter; left time: 907.7992s
Epoch: 11 cost time: 11.489701986312866
Epoch: 11, Steps: 208 | Train Loss: 1.816 Vali Loss: 4.855 Vali Acc: 0.105 Test Loss: 4.855 Test Acc: 0.105
Validation loss decreased (-0.103444 --> -0.104634).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9321830
	speed: 0.3063s/iter; left time: 5640.6495s
	iters: 200, epoch: 12 | loss: 1.5880417
	speed: 0.0469s/iter; left time: 859.4510s
Epoch: 12 cost time: 12.38569712638855
Epoch: 12, Steps: 208 | Train Loss: 1.689 Vali Loss: 5.170 Vali Acc: 0.107 Test Loss: 5.170 Test Acc: 0.107
Validation loss decreased (-0.104634 --> -0.107315).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2193210
	speed: 0.3148s/iter; left time: 5731.4872s
	iters: 200, epoch: 13 | loss: 1.3593708
	speed: 0.0431s/iter; left time: 780.9621s
Epoch: 13 cost time: 11.172000169754028
Epoch: 13, Steps: 208 | Train Loss: 1.534 Vali Loss: 5.539 Vali Acc: 0.109 Test Loss: 5.539 Test Acc: 0.109
Validation loss decreased (-0.107315 --> -0.109399).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6086199
	speed: 0.3287s/iter; left time: 5914.9950s
	iters: 200, epoch: 14 | loss: 2.2690189
	speed: 0.0512s/iter; left time: 915.5773s
Epoch: 14 cost time: 12.326771259307861
Epoch: 14, Steps: 208 | Train Loss: 1.434 Vali Loss: 5.550 Vali Acc: 0.104 Test Loss: 5.550 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2278460
	speed: 0.3252s/iter; left time: 5785.8081s
	iters: 200, epoch: 15 | loss: 0.8514445
	speed: 0.0577s/iter; left time: 1020.0822s
Epoch: 15 cost time: 13.390789985656738
Epoch: 15, Steps: 208 | Train Loss: 1.327 Vali Loss: 6.097 Vali Acc: 0.106 Test Loss: 6.097 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4376456
	speed: 0.3117s/iter; left time: 5480.7271s
	iters: 200, epoch: 16 | loss: 1.3296276
	speed: 0.0503s/iter; left time: 880.0817s
Epoch: 16 cost time: 11.789672374725342
Epoch: 16, Steps: 208 | Train Loss: 1.247 Vali Loss: 6.278 Vali Acc: 0.106 Test Loss: 6.278 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9398770
	speed: 0.3174s/iter; left time: 5514.7785s
	iters: 200, epoch: 17 | loss: 1.3324891
	speed: 0.0501s/iter; left time: 864.9726s
Epoch: 17 cost time: 11.974258184432983
Epoch: 17, Steps: 208 | Train Loss: 1.149 Vali Loss: 6.526 Vali Acc: 0.104 Test Loss: 6.526 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7693999
	speed: 0.3074s/iter; left time: 5275.6794s
	iters: 200, epoch: 18 | loss: 1.4667330
	speed: 0.0478s/iter; left time: 815.7970s
Epoch: 18 cost time: 11.285602331161499
Epoch: 18, Steps: 208 | Train Loss: 1.104 Vali Loss: 6.646 Vali Acc: 0.102 Test Loss: 6.646 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6896443
	speed: 0.3201s/iter; left time: 5427.3883s
	iters: 200, epoch: 19 | loss: 1.6087492
	speed: 0.0539s/iter; left time: 908.2122s
Epoch: 19 cost time: 12.576626300811768
Epoch: 19, Steps: 208 | Train Loss: 1.030 Vali Loss: 6.989 Vali Acc: 0.112 Test Loss: 6.989 Test Acc: 0.112
Validation loss decreased (-0.109399 --> -0.112367).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6636785
	speed: 0.3252s/iter; left time: 5445.9490s
	iters: 200, epoch: 20 | loss: 0.9891205
	speed: 0.0528s/iter; left time: 879.3259s
Epoch: 20 cost time: 13.118647813796997
Epoch: 20, Steps: 208 | Train Loss: 0.960 Vali Loss: 7.418 Vali Acc: 0.105 Test Loss: 7.418 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8045393
	speed: 0.3140s/iter; left time: 5193.2047s
	iters: 200, epoch: 21 | loss: 1.3099239
	speed: 0.0477s/iter; left time: 784.3698s
Epoch: 21 cost time: 10.99190092086792
Epoch: 21, Steps: 208 | Train Loss: 0.887 Vali Loss: 7.479 Vali Acc: 0.104 Test Loss: 7.479 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.6175987
	speed: 0.3073s/iter; left time: 5018.8644s
	iters: 200, epoch: 22 | loss: 1.3080486
	speed: 0.0548s/iter; left time: 889.9867s
Epoch: 22 cost time: 12.124828338623047
Epoch: 22, Steps: 208 | Train Loss: 0.872 Vali Loss: 7.817 Vali Acc: 0.104 Test Loss: 7.817 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.6310570
	speed: 0.3095s/iter; left time: 4990.7501s
	iters: 200, epoch: 23 | loss: 0.5984998
	speed: 0.0521s/iter; left time: 834.2143s
Epoch: 23 cost time: 12.491201639175415
Epoch: 23, Steps: 208 | Train Loss: 0.810 Vali Loss: 8.155 Vali Acc: 0.112 Test Loss: 8.155 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4254124
	speed: 0.3183s/iter; left time: 5066.0093s
	iters: 200, epoch: 24 | loss: 0.8840171
	speed: 0.0467s/iter; left time: 738.6787s
Epoch: 24 cost time: 10.917750358581543
Epoch: 24, Steps: 208 | Train Loss: 0.757 Vali Loss: 8.356 Vali Acc: 0.106 Test Loss: 8.356 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.4238544
	speed: 0.3234s/iter; left time: 5080.4527s
	iters: 200, epoch: 25 | loss: 1.0324091
	speed: 0.0498s/iter; left time: 776.7680s
Epoch: 25 cost time: 11.828813076019287
Epoch: 25, Steps: 208 | Train Loss: 0.720 Vali Loss: 8.488 Vali Acc: 0.104 Test Loss: 8.488 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.4708388
	speed: 0.3509s/iter; left time: 5439.7568s
	iters: 200, epoch: 26 | loss: 1.6774054
	speed: 0.0515s/iter; left time: 793.6551s
Epoch: 26 cost time: 12.771223545074463
Epoch: 26, Steps: 208 | Train Loss: 0.696 Vali Loss: 8.754 Vali Acc: 0.101 Test Loss: 8.754 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.8290538
	speed: 0.3291s/iter; left time: 5032.3558s
	iters: 200, epoch: 27 | loss: 0.9221836
	speed: 0.0577s/iter; left time: 876.0912s
Epoch: 27 cost time: 13.921720504760742
Epoch: 27, Steps: 208 | Train Loss: 0.686 Vali Loss: 8.902 Vali Acc: 0.107 Test Loss: 8.902 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.6603930
	speed: 0.3257s/iter; left time: 4913.8417s
	iters: 200, epoch: 28 | loss: 0.8724813
	speed: 0.0517s/iter; left time: 774.4624s
Epoch: 28 cost time: 12.569849252700806
Epoch: 28, Steps: 208 | Train Loss: 0.611 Vali Loss: 9.273 Vali Acc: 0.109 Test Loss: 9.273 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.7498406
	speed: 0.3058s/iter; left time: 4548.7663s
	iters: 200, epoch: 29 | loss: 1.1632464
	speed: 0.0537s/iter; left time: 793.4395s
Epoch: 29 cost time: 12.032423973083496
Epoch: 29, Steps: 208 | Train Loss: 0.632 Vali Loss: 9.183 Vali Acc: 0.108 Test Loss: 9.183 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11243662391887861
model parameter : 253911
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7368548
	speed: 0.0837s/iter; left time: 1733.5761s
	iters: 200, epoch: 1 | loss: 3.8009667
	speed: 0.0450s/iter; left time: 927.6231s
Epoch: 1 cost time: 13.41188669204712
Epoch: 1, Steps: 208 | Train Loss: 3.830 Vali Loss: 3.812 Vali Acc: 0.052 Test Loss: 3.812 Test Acc: 0.052
Validation loss decreased (inf --> -0.052154).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5468330
	speed: 0.2553s/iter; left time: 5231.7057s
	iters: 200, epoch: 2 | loss: 3.3993459
	speed: 0.0444s/iter; left time: 905.4746s
Epoch: 2 cost time: 10.532466888427734
Epoch: 2, Steps: 208 | Train Loss: 3.525 Vali Loss: 3.764 Vali Acc: 0.069 Test Loss: 3.764 Test Acc: 0.069
Validation loss decreased (-0.052154 --> -0.068558).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2792876
	speed: 0.2746s/iter; left time: 5571.2538s
	iters: 200, epoch: 3 | loss: 2.8848889
	speed: 0.0462s/iter; left time: 932.7550s
Epoch: 3 cost time: 10.543491840362549
Epoch: 3, Steps: 208 | Train Loss: 3.240 Vali Loss: 3.894 Vali Acc: 0.084 Test Loss: 3.894 Test Acc: 0.084
Validation loss decreased (-0.068558 --> -0.083468).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9528794
	speed: 0.2647s/iter; left time: 5314.5946s
	iters: 200, epoch: 4 | loss: 3.5696867
	speed: 0.0424s/iter; left time: 847.2817s
Epoch: 4 cost time: 9.4447340965271
Epoch: 4, Steps: 208 | Train Loss: 3.014 Vali Loss: 3.986 Vali Acc: 0.085 Test Loss: 3.986 Test Acc: 0.085
Validation loss decreased (-0.083468 --> -0.085257).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2666826
	speed: 0.2421s/iter; left time: 4810.0918s
	iters: 200, epoch: 5 | loss: 3.1194932
	speed: 0.0424s/iter; left time: 837.3825s
Epoch: 5 cost time: 9.361112833023071
Epoch: 5, Steps: 208 | Train Loss: 2.868 Vali Loss: 3.944 Vali Acc: 0.085 Test Loss: 3.944 Test Acc: 0.085
Validation loss decreased (-0.085257 --> -0.085257).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0033808
	speed: 0.2418s/iter; left time: 4753.7901s
	iters: 200, epoch: 6 | loss: 2.7225018
	speed: 0.0392s/iter; left time: 767.7017s
Epoch: 6 cost time: 9.185553312301636
Epoch: 6, Steps: 208 | Train Loss: 2.715 Vali Loss: 4.017 Vali Acc: 0.092 Test Loss: 4.017 Test Acc: 0.092
Validation loss decreased (-0.085257 --> -0.092116).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4990954
	speed: 0.2428s/iter; left time: 4723.8747s
	iters: 200, epoch: 7 | loss: 2.4477570
	speed: 0.0518s/iter; left time: 1002.2387s
Epoch: 7 cost time: 10.872419357299805
Epoch: 7, Steps: 208 | Train Loss: 2.578 Vali Loss: 4.169 Vali Acc: 0.087 Test Loss: 4.169 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7549913
	speed: 0.2751s/iter; left time: 5294.7732s
	iters: 200, epoch: 8 | loss: 2.4979868
	speed: 0.0471s/iter; left time: 902.0183s
Epoch: 8 cost time: 10.90361738204956
Epoch: 8, Steps: 208 | Train Loss: 2.449 Vali Loss: 4.187 Vali Acc: 0.092 Test Loss: 4.187 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7917645
	speed: 0.2661s/iter; left time: 5064.8012s
	iters: 200, epoch: 9 | loss: 2.8746009
	speed: 0.0424s/iter; left time: 803.6494s
Epoch: 9 cost time: 10.610641479492188
Epoch: 9, Steps: 208 | Train Loss: 2.323 Vali Loss: 4.198 Vali Acc: 0.098 Test Loss: 4.198 Test Acc: 0.098
Validation loss decreased (-0.092116 --> -0.098377).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8462789
	speed: 0.2725s/iter; left time: 5130.8879s
	iters: 200, epoch: 10 | loss: 2.7474241
	speed: 0.0430s/iter; left time: 805.9085s
Epoch: 10 cost time: 10.7290620803833
Epoch: 10, Steps: 208 | Train Loss: 2.181 Vali Loss: 4.261 Vali Acc: 0.099 Test Loss: 4.261 Test Acc: 0.099
Validation loss decreased (-0.098377 --> -0.098973).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9163228
	speed: 0.2711s/iter; left time: 5049.0832s
	iters: 200, epoch: 11 | loss: 2.2048738
	speed: 0.0437s/iter; left time: 809.0436s
Epoch: 11 cost time: 9.994909524917603
Epoch: 11, Steps: 208 | Train Loss: 2.078 Vali Loss: 4.307 Vali Acc: 0.098 Test Loss: 4.307 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.1445816
	speed: 0.2656s/iter; left time: 4889.6684s
	iters: 200, epoch: 12 | loss: 2.2117453
	speed: 0.0446s/iter; left time: 816.4243s
Epoch: 12 cost time: 11.047255754470825
Epoch: 12, Steps: 208 | Train Loss: 1.960 Vali Loss: 4.581 Vali Acc: 0.106 Test Loss: 4.581 Test Acc: 0.106
Validation loss decreased (-0.098973 --> -0.105830).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8418643
	speed: 0.2828s/iter; left time: 5148.2836s
	iters: 200, epoch: 13 | loss: 1.9305496
	speed: 0.0463s/iter; left time: 837.7031s
Epoch: 13 cost time: 11.199931383132935
Epoch: 13, Steps: 208 | Train Loss: 1.873 Vali Loss: 4.710 Vali Acc: 0.104 Test Loss: 4.710 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7030864
	speed: 0.2782s/iter; left time: 5007.0818s
	iters: 200, epoch: 14 | loss: 1.8418645
	speed: 0.0516s/iter; left time: 924.1568s
Epoch: 14 cost time: 11.883135318756104
Epoch: 14, Steps: 208 | Train Loss: 1.777 Vali Loss: 4.836 Vali Acc: 0.107 Test Loss: 4.836 Test Acc: 0.107
Validation loss decreased (-0.105830 --> -0.106722).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9579110
	speed: 0.2677s/iter; left time: 4761.4331s
	iters: 200, epoch: 15 | loss: 2.2493985
	speed: 0.0490s/iter; left time: 865.9733s
Epoch: 15 cost time: 11.21982479095459
Epoch: 15, Steps: 208 | Train Loss: 1.698 Vali Loss: 4.904 Vali Acc: 0.106 Test Loss: 4.904 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8554206
	speed: 0.2834s/iter; left time: 4983.0495s
	iters: 200, epoch: 16 | loss: 1.4332976
	speed: 0.0477s/iter; left time: 833.0152s
Epoch: 16 cost time: 10.655078887939453
Epoch: 16, Steps: 208 | Train Loss: 1.598 Vali Loss: 5.050 Vali Acc: 0.107 Test Loss: 5.050 Test Acc: 0.107
Validation loss decreased (-0.106722 --> -0.107018).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1841635
	speed: 0.2625s/iter; left time: 4561.1597s
	iters: 200, epoch: 17 | loss: 1.2529907
	speed: 0.0375s/iter; left time: 648.3098s
Epoch: 17 cost time: 9.117202997207642
Epoch: 17, Steps: 208 | Train Loss: 1.520 Vali Loss: 5.267 Vali Acc: 0.109 Test Loss: 5.267 Test Acc: 0.109
Validation loss decreased (-0.107018 --> -0.108507).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3819817
	speed: 0.2260s/iter; left time: 3879.6579s
	iters: 200, epoch: 18 | loss: 1.8392541
	speed: 0.0408s/iter; left time: 696.9485s
Epoch: 18 cost time: 9.712539196014404
Epoch: 18, Steps: 208 | Train Loss: 1.455 Vali Loss: 5.546 Vali Acc: 0.106 Test Loss: 5.546 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.1995013
	speed: 0.2247s/iter; left time: 3809.6841s
	iters: 200, epoch: 19 | loss: 2.0216820
	speed: 0.0414s/iter; left time: 698.5362s
Epoch: 19 cost time: 9.2776780128479
Epoch: 19, Steps: 208 | Train Loss: 1.387 Vali Loss: 5.528 Vali Acc: 0.114 Test Loss: 5.528 Test Acc: 0.114
Validation loss decreased (-0.108507 --> -0.114171).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7197113
	speed: 0.2671s/iter; left time: 4473.4715s
	iters: 200, epoch: 20 | loss: 1.1667322
	speed: 0.0451s/iter; left time: 750.3158s
Epoch: 20 cost time: 10.70313286781311
Epoch: 20, Steps: 208 | Train Loss: 1.325 Vali Loss: 5.776 Vali Acc: 0.109 Test Loss: 5.776 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.1804552
	speed: 0.2689s/iter; left time: 4447.8135s
	iters: 200, epoch: 21 | loss: 1.6209977
	speed: 0.0434s/iter; left time: 714.2091s
Epoch: 21 cost time: 10.4410400390625
Epoch: 21, Steps: 208 | Train Loss: 1.255 Vali Loss: 6.044 Vali Acc: 0.112 Test Loss: 6.044 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.1568972
	speed: 0.2794s/iter; left time: 4563.7341s
	iters: 200, epoch: 22 | loss: 1.0715877
	speed: 0.0468s/iter; left time: 758.9726s
Epoch: 22 cost time: 10.957342386245728
Epoch: 22, Steps: 208 | Train Loss: 1.210 Vali Loss: 6.121 Vali Acc: 0.112 Test Loss: 6.121 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.0671598
	speed: 0.2760s/iter; left time: 4450.0879s
	iters: 200, epoch: 23 | loss: 0.6040602
	speed: 0.0423s/iter; left time: 677.7399s
Epoch: 23 cost time: 9.979249000549316
Epoch: 23, Steps: 208 | Train Loss: 1.143 Vali Loss: 6.448 Vali Acc: 0.113 Test Loss: 6.448 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.2052854
	speed: 0.2769s/iter; left time: 4406.8006s
	iters: 200, epoch: 24 | loss: 1.1895099
	speed: 0.0449s/iter; left time: 710.7662s
Epoch: 24 cost time: 10.612546443939209
Epoch: 24, Steps: 208 | Train Loss: 1.082 Vali Loss: 6.614 Vali Acc: 0.113 Test Loss: 6.614 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.8803216
	speed: 0.2650s/iter; left time: 4162.6134s
	iters: 200, epoch: 25 | loss: 0.8931494
	speed: 0.0488s/iter; left time: 761.8622s
Epoch: 25 cost time: 11.100391626358032
Epoch: 25, Steps: 208 | Train Loss: 1.059 Vali Loss: 6.863 Vali Acc: 0.112 Test Loss: 6.863 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.6920276
	speed: 0.2705s/iter; left time: 4193.5464s
	iters: 200, epoch: 26 | loss: 1.0924292
	speed: 0.0462s/iter; left time: 712.2952s
Epoch: 26 cost time: 10.894432067871094
Epoch: 26, Steps: 208 | Train Loss: 1.053 Vali Loss: 6.891 Vali Acc: 0.106 Test Loss: 6.891 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.8019022
	speed: 0.2572s/iter; left time: 3933.0582s
	iters: 200, epoch: 27 | loss: 0.9848502
	speed: 0.0459s/iter; left time: 697.0856s
Epoch: 27 cost time: 10.069161653518677
Epoch: 27, Steps: 208 | Train Loss: 0.994 Vali Loss: 7.110 Vali Acc: 0.115 Test Loss: 7.110 Test Acc: 0.115
Validation loss decreased (-0.114171 --> -0.115050).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.0004312
	speed: 0.2620s/iter; left time: 3952.0300s
	iters: 200, epoch: 28 | loss: 1.4008505
	speed: 0.0443s/iter; left time: 663.8875s
Epoch: 28 cost time: 10.367000341415405
Epoch: 28, Steps: 208 | Train Loss: 0.951 Vali Loss: 7.207 Vali Acc: 0.109 Test Loss: 7.207 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.6950821
	speed: 0.2780s/iter; left time: 4136.3853s
	iters: 200, epoch: 29 | loss: 2.3283544
	speed: 0.0433s/iter; left time: 640.1567s
Epoch: 29 cost time: 10.201733350753784
Epoch: 29, Steps: 208 | Train Loss: 0.923 Vali Loss: 7.601 Vali Acc: 0.118 Test Loss: 7.601 Test Acc: 0.118
Validation loss decreased (-0.115050 --> -0.118027).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.6319138
	speed: 0.2892s/iter; left time: 4242.0316s
	iters: 200, epoch: 30 | loss: 0.7170357
	speed: 0.0476s/iter; left time: 693.8815s
Epoch: 30 cost time: 11.010227918624878
Epoch: 30, Steps: 208 | Train Loss: 0.868 Vali Loss: 7.701 Vali Acc: 0.116 Test Loss: 7.701 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.3078756
	speed: 0.2776s/iter; left time: 4013.9378s
	iters: 200, epoch: 31 | loss: 0.9182006
	speed: 0.0464s/iter; left time: 665.6365s
Epoch: 31 cost time: 10.639644622802734
Epoch: 31, Steps: 208 | Train Loss: 0.845 Vali Loss: 7.742 Vali Acc: 0.107 Test Loss: 7.742 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.8250203
	speed: 0.2741s/iter; left time: 3906.3608s
	iters: 200, epoch: 32 | loss: 1.1417809
	speed: 0.0414s/iter; left time: 586.4265s
Epoch: 32 cost time: 10.042763233184814
Epoch: 32, Steps: 208 | Train Loss: 0.825 Vali Loss: 8.040 Vali Acc: 0.108 Test Loss: 8.040 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.6466155
	speed: 0.2477s/iter; left time: 3478.9666s
	iters: 200, epoch: 33 | loss: 0.8268393
	speed: 0.0446s/iter; left time: 621.9373s
Epoch: 33 cost time: 10.454937219619751
Epoch: 33, Steps: 208 | Train Loss: 0.817 Vali Loss: 8.498 Vali Acc: 0.115 Test Loss: 8.498 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.8445905
	speed: 0.2588s/iter; left time: 3581.2497s
	iters: 200, epoch: 34 | loss: 1.2043457
	speed: 0.0411s/iter; left time: 564.9549s
Epoch: 34 cost time: 9.747167110443115
Epoch: 34, Steps: 208 | Train Loss: 0.764 Vali Loss: 8.442 Vali Acc: 0.108 Test Loss: 8.442 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.1571059
	speed: 0.2661s/iter; left time: 3627.1692s
	iters: 200, epoch: 35 | loss: 1.0355346
	speed: 0.0427s/iter; left time: 577.7581s
Epoch: 35 cost time: 10.054706811904907
Epoch: 35, Steps: 208 | Train Loss: 0.757 Vali Loss: 8.578 Vali Acc: 0.114 Test Loss: 8.578 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.6070060
	speed: 0.2536s/iter; left time: 3403.6165s
	iters: 200, epoch: 36 | loss: 0.9284107
	speed: 0.0473s/iter; left time: 629.9997s
Epoch: 36 cost time: 10.676617622375488
Epoch: 36, Steps: 208 | Train Loss: 0.745 Vali Loss: 8.991 Vali Acc: 0.114 Test Loss: 8.991 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.6256982
	speed: 0.2606s/iter; left time: 3443.5305s
	iters: 200, epoch: 37 | loss: 1.0058109
	speed: 0.0390s/iter; left time: 511.8303s
Epoch: 37 cost time: 9.238847017288208
Epoch: 37, Steps: 208 | Train Loss: 0.712 Vali Loss: 8.950 Vali Acc: 0.108 Test Loss: 8.950 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.7401145
	speed: 0.2893s/iter; left time: 3761.9212s
	iters: 200, epoch: 38 | loss: 0.6685537
	speed: 0.0501s/iter; left time: 646.1738s
Epoch: 38 cost time: 11.968445539474487
Epoch: 38, Steps: 208 | Train Loss: 0.662 Vali Loss: 9.282 Vali Acc: 0.112 Test Loss: 9.282 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.5136633
	speed: 0.3161s/iter; left time: 4044.5244s
	iters: 200, epoch: 39 | loss: 1.2243919
	speed: 0.0563s/iter; left time: 714.4498s
Epoch: 39 cost time: 12.820891618728638
Epoch: 39, Steps: 208 | Train Loss: 0.706 Vali Loss: 9.182 Vali Acc: 0.106 Test Loss: 9.182 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1181031911720847
model parameter : 171639
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8476963
	speed: 0.1160s/iter; left time: 2401.2906s
	iters: 200, epoch: 1 | loss: 3.5521853
	speed: 0.0549s/iter; left time: 1130.1409s
Epoch: 1 cost time: 17.69077706336975
Epoch: 1, Steps: 208 | Train Loss: 3.797 Vali Loss: 3.769 Vali Acc: 0.052 Test Loss: 3.769 Test Acc: 0.052
Validation loss decreased (inf --> -0.052453).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0651367
	speed: 0.3723s/iter; left time: 7628.6941s
	iters: 200, epoch: 2 | loss: 2.9893057
	speed: 0.0531s/iter; left time: 1082.9215s
Epoch: 2 cost time: 13.460105657577515
Epoch: 2, Steps: 208 | Train Loss: 3.581 Vali Loss: 3.729 Vali Acc: 0.070 Test Loss: 3.729 Test Acc: 0.070
Validation loss decreased (-0.052453 --> -0.070347).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5831375
	speed: 0.3446s/iter; left time: 6990.7374s
	iters: 200, epoch: 3 | loss: 3.5750613
	speed: 0.0592s/iter; left time: 1195.5061s
Epoch: 3 cost time: 13.682726860046387
Epoch: 3, Steps: 208 | Train Loss: 3.317 Vali Loss: 3.739 Vali Acc: 0.077 Test Loss: 3.739 Test Acc: 0.077
Validation loss decreased (-0.070347 --> -0.076610).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5857265
	speed: 0.3512s/iter; left time: 7050.3310s
	iters: 200, epoch: 4 | loss: 3.3116884
	speed: 0.0631s/iter; left time: 1261.2766s
Epoch: 4 cost time: 13.824550867080688
Epoch: 4, Steps: 208 | Train Loss: 3.136 Vali Loss: 3.757 Vali Acc: 0.087 Test Loss: 3.757 Test Acc: 0.087
Validation loss decreased (-0.076610 --> -0.086750).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3644695
	speed: 0.3441s/iter; left time: 6837.1882s
	iters: 200, epoch: 5 | loss: 3.0196934
	speed: 0.0598s/iter; left time: 1182.0533s
Epoch: 5 cost time: 13.9588942527771
Epoch: 5, Steps: 208 | Train Loss: 2.989 Vali Loss: 3.804 Vali Acc: 0.094 Test Loss: 3.804 Test Acc: 0.094
Validation loss decreased (-0.086750 --> -0.093609).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4543059
	speed: 0.3136s/iter; left time: 6165.9870s
	iters: 200, epoch: 6 | loss: 3.9587779
	speed: 0.0586s/iter; left time: 1146.4376s
Epoch: 6 cost time: 12.653578519821167
Epoch: 6, Steps: 208 | Train Loss: 2.879 Vali Loss: 3.829 Vali Acc: 0.092 Test Loss: 3.829 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.8070278
	speed: 0.3392s/iter; left time: 6598.5090s
	iters: 200, epoch: 7 | loss: 3.2826495
	speed: 0.0621s/iter; left time: 1202.6056s
Epoch: 7 cost time: 13.759931087493896
Epoch: 7, Steps: 208 | Train Loss: 2.727 Vali Loss: 3.916 Vali Acc: 0.096 Test Loss: 3.916 Test Acc: 0.096
Validation loss decreased (-0.093609 --> -0.095696).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3511336
	speed: 0.3295s/iter; left time: 6341.2499s
	iters: 200, epoch: 8 | loss: 3.0235720
	speed: 0.0603s/iter; left time: 1155.0050s
Epoch: 8 cost time: 13.041816711425781
Epoch: 8, Steps: 208 | Train Loss: 2.615 Vali Loss: 3.931 Vali Acc: 0.097 Test Loss: 3.931 Test Acc: 0.097
Validation loss decreased (-0.095696 --> -0.096889).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7876773
	speed: 0.3400s/iter; left time: 6473.0996s
	iters: 200, epoch: 9 | loss: 3.4558773
	speed: 0.0541s/iter; left time: 1024.1297s
Epoch: 9 cost time: 13.109423637390137
Epoch: 9, Steps: 208 | Train Loss: 2.476 Vali Loss: 3.892 Vali Acc: 0.101 Test Loss: 3.892 Test Acc: 0.101
Validation loss decreased (-0.096889 --> -0.101363).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3964195
	speed: 0.3524s/iter; left time: 6635.7809s
	iters: 200, epoch: 10 | loss: 2.8732140
	speed: 0.0571s/iter; left time: 1069.6833s
Epoch: 10 cost time: 13.144578695297241
Epoch: 10, Steps: 208 | Train Loss: 2.373 Vali Loss: 3.976 Vali Acc: 0.095 Test Loss: 3.976 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.4968383
	speed: 0.3356s/iter; left time: 6248.6747s
	iters: 200, epoch: 11 | loss: 3.5597458
	speed: 0.0503s/iter; left time: 931.6793s
Epoch: 11 cost time: 11.859861850738525
Epoch: 11, Steps: 208 | Train Loss: 2.281 Vali Loss: 4.099 Vali Acc: 0.105 Test Loss: 4.099 Test Acc: 0.105
Validation loss decreased (-0.101363 --> -0.105238).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4536061
	speed: 0.3274s/iter; left time: 6028.8896s
	iters: 200, epoch: 12 | loss: 2.2878149
	speed: 0.0560s/iter; left time: 1025.1898s
Epoch: 12 cost time: 12.459707975387573
Epoch: 12, Steps: 208 | Train Loss: 2.168 Vali Loss: 4.201 Vali Acc: 0.106 Test Loss: 4.201 Test Acc: 0.106
Validation loss decreased (-0.105238 --> -0.106430).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.5173647
	speed: 0.3437s/iter; left time: 6256.8645s
	iters: 200, epoch: 13 | loss: 1.7556705
	speed: 0.0533s/iter; left time: 964.5511s
Epoch: 13 cost time: 12.074394702911377
Epoch: 13, Steps: 208 | Train Loss: 2.074 Vali Loss: 4.280 Vali Acc: 0.101 Test Loss: 4.280 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.8738141
	speed: 0.3605s/iter; left time: 6487.2762s
	iters: 200, epoch: 14 | loss: 2.1427655
	speed: 0.0630s/iter; left time: 1126.6271s
Epoch: 14 cost time: 13.90184998512268
Epoch: 14, Steps: 208 | Train Loss: 2.027 Vali Loss: 4.407 Vali Acc: 0.112 Test Loss: 4.407 Test Acc: 0.112
Validation loss decreased (-0.106430 --> -0.112393).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.1288829
	speed: 0.3590s/iter; left time: 6387.1011s
	iters: 200, epoch: 15 | loss: 2.0161252
	speed: 0.0536s/iter; left time: 948.0350s
Epoch: 15 cost time: 13.499088525772095
Epoch: 15, Steps: 208 | Train Loss: 1.922 Vali Loss: 4.483 Vali Acc: 0.109 Test Loss: 4.483 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.1322737
	speed: 0.3645s/iter; left time: 6409.0501s
	iters: 200, epoch: 16 | loss: 1.8073463
	speed: 0.0588s/iter; left time: 1027.5716s
Epoch: 16 cost time: 13.549869775772095
Epoch: 16, Steps: 208 | Train Loss: 1.837 Vali Loss: 4.522 Vali Acc: 0.105 Test Loss: 4.522 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.7764755
	speed: 0.3594s/iter; left time: 6244.5903s
	iters: 200, epoch: 17 | loss: 1.9735947
	speed: 0.0575s/iter; left time: 993.9256s
Epoch: 17 cost time: 13.358867406845093
Epoch: 17, Steps: 208 | Train Loss: 1.769 Vali Loss: 4.841 Vali Acc: 0.110 Test Loss: 4.841 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.0608723
	speed: 0.3482s/iter; left time: 5976.1245s
	iters: 200, epoch: 18 | loss: 1.1281822
	speed: 0.0589s/iter; left time: 1005.8944s
Epoch: 18 cost time: 14.019672870635986
Epoch: 18, Steps: 208 | Train Loss: 1.724 Vali Loss: 4.903 Vali Acc: 0.112 Test Loss: 4.903 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.5451103
	speed: 0.3598s/iter; left time: 6101.2631s
	iters: 200, epoch: 19 | loss: 2.2014987
	speed: 0.0496s/iter; left time: 835.9297s
Epoch: 19 cost time: 13.628227949142456
Epoch: 19, Steps: 208 | Train Loss: 1.663 Vali Loss: 5.065 Vali Acc: 0.104 Test Loss: 5.065 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.6837898
	speed: 0.3400s/iter; left time: 5695.3201s
	iters: 200, epoch: 20 | loss: 2.2020247
	speed: 0.0537s/iter; left time: 894.4400s
Epoch: 20 cost time: 12.891041040420532
Epoch: 20, Steps: 208 | Train Loss: 1.614 Vali Loss: 5.237 Vali Acc: 0.110 Test Loss: 5.237 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.3547125
	speed: 0.3540s/iter; left time: 5855.2988s
	iters: 200, epoch: 21 | loss: 2.2566652
	speed: 0.0555s/iter; left time: 913.0854s
Epoch: 21 cost time: 13.363540172576904
Epoch: 21, Steps: 208 | Train Loss: 1.537 Vali Loss: 5.170 Vali Acc: 0.111 Test Loss: 5.170 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.4171762
	speed: 0.3425s/iter; left time: 5594.0869s
	iters: 200, epoch: 22 | loss: 1.2228591
	speed: 0.0648s/iter; left time: 1052.2468s
Epoch: 22 cost time: 13.933924198150635
Epoch: 22, Steps: 208 | Train Loss: 1.495 Vali Loss: 5.270 Vali Acc: 0.107 Test Loss: 5.270 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.9979906
	speed: 0.4021s/iter; left time: 6484.4547s
	iters: 200, epoch: 23 | loss: 2.5467451
	speed: 0.0661s/iter; left time: 1059.4580s
Epoch: 23 cost time: 16.429263591766357
Epoch: 23, Steps: 208 | Train Loss: 1.464 Vali Loss: 5.465 Vali Acc: 0.114 Test Loss: 5.465 Test Acc: 0.114
Validation loss decreased (-0.112393 --> -0.114171).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.0277674
	speed: 0.4315s/iter; left time: 6868.1358s
	iters: 200, epoch: 24 | loss: 1.6564770
	speed: 0.0776s/iter; left time: 1227.9179s
Epoch: 24 cost time: 16.51670241355896
Epoch: 24, Steps: 208 | Train Loss: 1.404 Vali Loss: 5.736 Vali Acc: 0.109 Test Loss: 5.736 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.0156242
	speed: 0.4312s/iter; left time: 6774.1801s
	iters: 200, epoch: 25 | loss: 1.5304596
	speed: 0.0703s/iter; left time: 1097.9853s
Epoch: 25 cost time: 17.21602773666382
Epoch: 25, Steps: 208 | Train Loss: 1.368 Vali Loss: 5.837 Vali Acc: 0.107 Test Loss: 5.837 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.2774403
	speed: 0.4063s/iter; left time: 6297.8295s
	iters: 200, epoch: 26 | loss: 1.9766880
	speed: 0.0782s/iter; left time: 1203.9197s
Epoch: 26 cost time: 16.66891098022461
Epoch: 26, Steps: 208 | Train Loss: 1.322 Vali Loss: 5.995 Vali Acc: 0.109 Test Loss: 5.995 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.6108387
	speed: 0.4099s/iter; left time: 6268.6801s
	iters: 200, epoch: 27 | loss: 1.5008215
	speed: 0.0719s/iter; left time: 1092.6638s
Epoch: 27 cost time: 17.09895372390747
Epoch: 27, Steps: 208 | Train Loss: 1.302 Vali Loss: 6.033 Vali Acc: 0.112 Test Loss: 6.033 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.1691805
	speed: 0.3885s/iter; left time: 5861.1532s
	iters: 200, epoch: 28 | loss: 1.1188159
	speed: 0.0683s/iter; left time: 1023.8578s
Epoch: 28 cost time: 16.759551525115967
Epoch: 28, Steps: 208 | Train Loss: 1.245 Vali Loss: 6.187 Vali Acc: 0.108 Test Loss: 6.187 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.8257298
	speed: 0.4015s/iter; left time: 5972.4774s
	iters: 200, epoch: 29 | loss: 1.5150187
	speed: 0.0705s/iter; left time: 1041.1914s
Epoch: 29 cost time: 16.787181615829468
Epoch: 29, Steps: 208 | Train Loss: 1.204 Vali Loss: 6.181 Vali Acc: 0.107 Test Loss: 6.181 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.7761371
	speed: 0.3733s/iter; left time: 5475.9060s
	iters: 200, epoch: 30 | loss: 1.8191652
	speed: 0.0720s/iter; left time: 1049.4116s
Epoch: 30 cost time: 15.628428936004639
Epoch: 30, Steps: 208 | Train Loss: 1.170 Vali Loss: 6.408 Vali Acc: 0.115 Test Loss: 6.408 Test Acc: 0.115
Validation loss decreased (-0.114171 --> -0.114460).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.9059128
	speed: 0.3864s/iter; left time: 5587.6525s
	iters: 200, epoch: 31 | loss: 1.1848543
	speed: 0.0699s/iter; left time: 1003.9397s
Epoch: 31 cost time: 15.12352180480957
Epoch: 31, Steps: 208 | Train Loss: 1.136 Vali Loss: 6.576 Vali Acc: 0.112 Test Loss: 6.576 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.6637640
	speed: 0.3654s/iter; left time: 5208.1403s
	iters: 200, epoch: 32 | loss: 1.0249681
	speed: 0.0733s/iter; left time: 1037.3911s
Epoch: 32 cost time: 16.205241203308105
Epoch: 32, Steps: 208 | Train Loss: 1.082 Vali Loss: 6.797 Vali Acc: 0.105 Test Loss: 6.797 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.1985630
	speed: 0.3425s/iter; left time: 4810.2497s
	iters: 200, epoch: 33 | loss: 1.9433240
	speed: 0.0667s/iter; left time: 930.5827s
Epoch: 33 cost time: 15.005687713623047
Epoch: 33, Steps: 208 | Train Loss: 1.077 Vali Loss: 6.878 Vali Acc: 0.110 Test Loss: 6.878 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.3980136
	speed: 0.3388s/iter; left time: 4688.5152s
	iters: 200, epoch: 34 | loss: 1.0865643
	speed: 0.0617s/iter; left time: 847.7436s
Epoch: 34 cost time: 13.801644563674927
Epoch: 34, Steps: 208 | Train Loss: 1.064 Vali Loss: 7.015 Vali Acc: 0.103 Test Loss: 7.015 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.9534358
	speed: 0.3411s/iter; left time: 4649.5027s
	iters: 200, epoch: 35 | loss: 1.1501184
	speed: 0.0623s/iter; left time: 843.1063s
Epoch: 35 cost time: 13.79282808303833
Epoch: 35, Steps: 208 | Train Loss: 1.006 Vali Loss: 7.201 Vali Acc: 0.110 Test Loss: 7.201 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 1.5445439
	speed: 0.3985s/iter; left time: 5348.8640s
	iters: 200, epoch: 36 | loss: 0.7099346
	speed: 0.0650s/iter; left time: 865.9740s
Epoch: 36 cost time: 15.011650800704956
Epoch: 36, Steps: 208 | Train Loss: 0.954 Vali Loss: 7.324 Vali Acc: 0.111 Test Loss: 7.324 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.5324118
	speed: 0.3951s/iter; left time: 5220.4571s
	iters: 200, epoch: 37 | loss: 0.9961913
	speed: 0.0601s/iter; left time: 787.9677s
Epoch: 37 cost time: 14.647005558013916
Epoch: 37, Steps: 208 | Train Loss: 0.961 Vali Loss: 7.498 Vali Acc: 0.106 Test Loss: 7.498 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.9473727
	speed: 0.3911s/iter; left time: 5086.6583s
	iters: 200, epoch: 38 | loss: 1.4633499
	speed: 0.0545s/iter; left time: 703.1693s
Epoch: 38 cost time: 13.850162029266357
Epoch: 38, Steps: 208 | Train Loss: 0.927 Vali Loss: 7.601 Vali Acc: 0.109 Test Loss: 7.601 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.6492095
	speed: 0.3791s/iter; left time: 4851.8708s
	iters: 200, epoch: 39 | loss: 0.8136835
	speed: 0.0627s/iter; left time: 795.6982s
Epoch: 39 cost time: 14.731026649475098
Epoch: 39, Steps: 208 | Train Loss: 0.933 Vali Loss: 7.545 Vali Acc: 0.116 Test Loss: 7.545 Test Acc: 0.116
Validation loss decreased (-0.114460 --> -0.116238).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.6643556
	speed: 0.4354s/iter; left time: 5481.3548s
	iters: 200, epoch: 40 | loss: 1.2624034
	speed: 0.0582s/iter; left time: 727.2238s
Epoch: 40 cost time: 14.292998313903809
Epoch: 40, Steps: 208 | Train Loss: 0.886 Vali Loss: 7.920 Vali Acc: 0.107 Test Loss: 7.920 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.6088743
	speed: 0.3894s/iter; left time: 4820.9629s
	iters: 200, epoch: 41 | loss: 0.7132614
	speed: 0.0620s/iter; left time: 761.2628s
Epoch: 41 cost time: 14.83307433128357
Epoch: 41, Steps: 208 | Train Loss: 0.849 Vali Loss: 8.104 Vali Acc: 0.113 Test Loss: 8.104 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.7104462
	speed: 0.3721s/iter; left time: 4529.9790s
	iters: 200, epoch: 42 | loss: 1.0943745
	speed: 0.0586s/iter; left time: 707.2388s
Epoch: 42 cost time: 14.220660924911499
Epoch: 42, Steps: 208 | Train Loss: 0.856 Vali Loss: 8.158 Vali Acc: 0.111 Test Loss: 8.158 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.4978154
	speed: 0.3758s/iter; left time: 4496.6774s
	iters: 200, epoch: 43 | loss: 1.3596326
	speed: 0.0633s/iter; left time: 751.0136s
Epoch: 43 cost time: 15.378349304199219
Epoch: 43, Steps: 208 | Train Loss: 0.821 Vali Loss: 8.233 Vali Acc: 0.111 Test Loss: 8.233 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.6624168
	speed: 0.4031s/iter; left time: 4739.1551s
	iters: 200, epoch: 44 | loss: 1.1456711
	speed: 0.0706s/iter; left time: 822.4768s
Epoch: 44 cost time: 16.408875465393066
Epoch: 44, Steps: 208 | Train Loss: 0.828 Vali Loss: 8.340 Vali Acc: 0.114 Test Loss: 8.340 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.5040585
	speed: 0.3912s/iter; left time: 4518.5173s
	iters: 200, epoch: 45 | loss: 0.8105969
	speed: 0.0706s/iter; left time: 808.5248s
Epoch: 45 cost time: 16.497926712036133
Epoch: 45, Steps: 208 | Train Loss: 0.792 Vali Loss: 8.649 Vali Acc: 0.108 Test Loss: 8.649 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.1155598
	speed: 0.3182s/iter; left time: 3608.5211s
	iters: 200, epoch: 46 | loss: 0.6199659
	speed: 0.0597s/iter; left time: 671.5829s
Epoch: 46 cost time: 12.800258159637451
Epoch: 46, Steps: 208 | Train Loss: 0.764 Vali Loss: 8.689 Vali Acc: 0.108 Test Loss: 8.689 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.6397214
	speed: 0.3436s/iter; left time: 3824.8669s
	iters: 200, epoch: 47 | loss: 0.6946776
	speed: 0.0533s/iter; left time: 587.7846s
Epoch: 47 cost time: 12.736313343048096
Epoch: 47, Steps: 208 | Train Loss: 0.764 Vali Loss: 8.525 Vali Acc: 0.116 Test Loss: 8.525 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.6070129
	speed: 0.3134s/iter; left time: 3423.8315s
	iters: 200, epoch: 48 | loss: 0.5323951
	speed: 0.0601s/iter; left time: 650.0854s
Epoch: 48 cost time: 13.577765226364136
Epoch: 48, Steps: 208 | Train Loss: 0.716 Vali Loss: 8.950 Vali Acc: 0.112 Test Loss: 8.950 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.6746438
	speed: 0.3097s/iter; left time: 3319.0259s
	iters: 200, epoch: 49 | loss: 0.8258650
	speed: 0.0580s/iter; left time: 615.6414s
Epoch: 49 cost time: 13.707623481750488
Epoch: 49, Steps: 208 | Train Loss: 0.731 Vali Loss: 8.973 Vali Acc: 0.111 Test Loss: 8.973 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11631374888159857
model parameter : 137399
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5453012
	speed: 0.1028s/iter; left time: 2128.4396s
	iters: 200, epoch: 1 | loss: 3.6669707
	speed: 0.0674s/iter; left time: 1389.1240s
Epoch: 1 cost time: 17.782548427581787
Epoch: 1, Steps: 208 | Train Loss: 3.784 Vali Loss: 3.726 Vali Acc: 0.047 Test Loss: 3.726 Test Acc: 0.047
Validation loss decreased (inf --> -0.046786).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2697401
	speed: 0.3270s/iter; left time: 6700.8253s
	iters: 200, epoch: 2 | loss: 3.1861229
	speed: 0.0516s/iter; left time: 1053.0549s
Epoch: 2 cost time: 12.629205226898193
Epoch: 2, Steps: 208 | Train Loss: 3.596 Vali Loss: 3.796 Vali Acc: 0.058 Test Loss: 3.796 Test Acc: 0.058
Validation loss decreased (-0.046786 --> -0.057821).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4014835
	speed: 0.2931s/iter; left time: 5946.1689s
	iters: 200, epoch: 3 | loss: 3.2386858
	speed: 0.0504s/iter; left time: 1017.6643s
Epoch: 3 cost time: 11.973722696304321
Epoch: 3, Steps: 208 | Train Loss: 3.430 Vali Loss: 3.683 Vali Acc: 0.075 Test Loss: 3.683 Test Acc: 0.075
Validation loss decreased (-0.057821 --> -0.075120).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5212274
	speed: 0.3566s/iter; left time: 7158.5222s
	iters: 200, epoch: 4 | loss: 3.1712217
	speed: 0.0597s/iter; left time: 1191.9445s
Epoch: 4 cost time: 13.206400871276855
Epoch: 4, Steps: 208 | Train Loss: 3.220 Vali Loss: 3.645 Vali Acc: 0.086 Test Loss: 3.645 Test Acc: 0.086
Validation loss decreased (-0.075120 --> -0.085559).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8473556
	speed: 0.3404s/iter; left time: 6762.6454s
	iters: 200, epoch: 5 | loss: 2.8548400
	speed: 0.0573s/iter; left time: 1132.9663s
Epoch: 5 cost time: 13.747737884521484
Epoch: 5, Steps: 208 | Train Loss: 3.062 Vali Loss: 3.711 Vali Acc: 0.086 Test Loss: 3.711 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9092801
	speed: 0.3387s/iter; left time: 6659.9012s
	iters: 200, epoch: 6 | loss: 3.6883876
	speed: 0.0635s/iter; left time: 1242.8103s
Epoch: 6 cost time: 14.390251398086548
Epoch: 6, Steps: 208 | Train Loss: 2.959 Vali Loss: 3.692 Vali Acc: 0.093 Test Loss: 3.692 Test Acc: 0.093
Validation loss decreased (-0.085559 --> -0.093014).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3267846
	speed: 0.3497s/iter; left time: 6803.1587s
	iters: 200, epoch: 7 | loss: 3.0946827
	speed: 0.0544s/iter; left time: 1052.8550s
Epoch: 7 cost time: 13.20744776725769
Epoch: 7, Steps: 208 | Train Loss: 2.834 Vali Loss: 3.732 Vali Acc: 0.091 Test Loss: 3.732 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0395045
	speed: 0.3016s/iter; left time: 5803.4347s
	iters: 200, epoch: 8 | loss: 2.6873665
	speed: 0.0492s/iter; left time: 941.4272s
Epoch: 8 cost time: 11.191439867019653
Epoch: 8, Steps: 208 | Train Loss: 2.767 Vali Loss: 3.833 Vali Acc: 0.096 Test Loss: 3.833 Test Acc: 0.096
Validation loss decreased (-0.093014 --> -0.095697).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6683218
	speed: 0.3335s/iter; left time: 6348.6019s
	iters: 200, epoch: 9 | loss: 2.7298429
	speed: 0.0575s/iter; left time: 1089.3523s
Epoch: 9 cost time: 12.141487836837769
Epoch: 9, Steps: 208 | Train Loss: 2.656 Vali Loss: 3.835 Vali Acc: 0.099 Test Loss: 3.835 Test Acc: 0.099
Validation loss decreased (-0.095697 --> -0.099276).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5535529
	speed: 0.3585s/iter; left time: 6749.5861s
	iters: 200, epoch: 10 | loss: 2.6892552
	speed: 0.0653s/iter; left time: 1223.8955s
Epoch: 10 cost time: 14.737707614898682
Epoch: 10, Steps: 208 | Train Loss: 2.579 Vali Loss: 4.005 Vali Acc: 0.100 Test Loss: 4.005 Test Acc: 0.100
Validation loss decreased (-0.099276 --> -0.099572).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.8793907
	speed: 0.3858s/iter; left time: 7184.4732s
	iters: 200, epoch: 11 | loss: 2.7420633
	speed: 0.0774s/iter; left time: 1433.1185s
Epoch: 11 cost time: 17.042001247406006
Epoch: 11, Steps: 208 | Train Loss: 2.492 Vali Loss: 3.869 Vali Acc: 0.107 Test Loss: 3.869 Test Acc: 0.107
Validation loss decreased (-0.099572 --> -0.107328).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.8617816
	speed: 0.3949s/iter; left time: 7270.7282s
	iters: 200, epoch: 12 | loss: 2.2255824
	speed: 0.0729s/iter; left time: 1335.7204s
Epoch: 12 cost time: 15.96437120437622
Epoch: 12, Steps: 208 | Train Loss: 2.440 Vali Loss: 3.965 Vali Acc: 0.106 Test Loss: 3.965 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8569252
	speed: 0.3932s/iter; left time: 7158.7134s
	iters: 200, epoch: 13 | loss: 2.3215206
	speed: 0.0629s/iter; left time: 1138.6149s
Epoch: 13 cost time: 15.112688541412354
Epoch: 13, Steps: 208 | Train Loss: 2.374 Vali Loss: 4.050 Vali Acc: 0.112 Test Loss: 4.050 Test Acc: 0.112
Validation loss decreased (-0.107328 --> -0.111800).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0823436
	speed: 0.3875s/iter; left time: 6974.6272s
	iters: 200, epoch: 14 | loss: 2.2763712
	speed: 0.0727s/iter; left time: 1301.9503s
Epoch: 14 cost time: 16.20250177383423
Epoch: 14, Steps: 208 | Train Loss: 2.275 Vali Loss: 4.041 Vali Acc: 0.109 Test Loss: 4.041 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.8273661
	speed: 0.4043s/iter; left time: 7192.2588s
	iters: 200, epoch: 15 | loss: 2.4775038
	speed: 0.0730s/iter; left time: 1291.8402s
Epoch: 15 cost time: 16.61255383491516
Epoch: 15, Steps: 208 | Train Loss: 2.260 Vali Loss: 4.093 Vali Acc: 0.114 Test Loss: 4.093 Test Acc: 0.114
Validation loss decreased (-0.111800 --> -0.114185).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8314531
	speed: 0.3922s/iter; left time: 6894.3963s
	iters: 200, epoch: 16 | loss: 2.0635457
	speed: 0.0721s/iter; left time: 1260.8367s
Epoch: 16 cost time: 15.935727834701538
Epoch: 16, Steps: 208 | Train Loss: 2.168 Vali Loss: 4.161 Vali Acc: 0.112 Test Loss: 4.161 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.8405225
	speed: 0.3957s/iter; left time: 6873.6748s
	iters: 200, epoch: 17 | loss: 1.9660593
	speed: 0.0693s/iter; left time: 1197.1905s
Epoch: 17 cost time: 15.833374500274658
Epoch: 17, Steps: 208 | Train Loss: 2.120 Vali Loss: 4.222 Vali Acc: 0.108 Test Loss: 4.222 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 3.2803109
	speed: 0.3921s/iter; left time: 6730.1105s
	iters: 200, epoch: 18 | loss: 2.2005730
	speed: 0.0750s/iter; left time: 1279.6939s
Epoch: 18 cost time: 16.37751054763794
Epoch: 18, Steps: 208 | Train Loss: 2.065 Vali Loss: 4.269 Vali Acc: 0.109 Test Loss: 4.269 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.0989451
	speed: 0.3579s/iter; left time: 6069.2619s
	iters: 200, epoch: 19 | loss: 1.3147701
	speed: 0.0695s/iter; left time: 1171.7457s
Epoch: 19 cost time: 15.279527425765991
Epoch: 19, Steps: 208 | Train Loss: 2.028 Vali Loss: 4.345 Vali Acc: 0.109 Test Loss: 4.345 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.8983052
	speed: 0.3628s/iter; left time: 6076.5488s
	iters: 200, epoch: 20 | loss: 2.4637227
	speed: 0.0723s/iter; left time: 1204.2083s
Epoch: 20 cost time: 15.202714204788208
Epoch: 20, Steps: 208 | Train Loss: 1.982 Vali Loss: 4.424 Vali Acc: 0.109 Test Loss: 4.424 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.7374549
	speed: 0.3610s/iter; left time: 5971.3287s
	iters: 200, epoch: 21 | loss: 1.7073746
	speed: 0.0541s/iter; left time: 889.9998s
Epoch: 21 cost time: 12.891149044036865
Epoch: 21, Steps: 208 | Train Loss: 1.921 Vali Loss: 4.515 Vali Acc: 0.113 Test Loss: 4.515 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.8947639
	speed: 0.3403s/iter; left time: 5557.6833s
	iters: 200, epoch: 22 | loss: 1.7188059
	speed: 0.0611s/iter; left time: 991.8967s
Epoch: 22 cost time: 13.069748163223267
Epoch: 22, Steps: 208 | Train Loss: 1.871 Vali Loss: 4.608 Vali Acc: 0.109 Test Loss: 4.608 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 2.5674453
	speed: 0.3445s/iter; left time: 5555.1457s
	iters: 200, epoch: 23 | loss: 1.6393806
	speed: 0.0528s/iter; left time: 845.3379s
Epoch: 23 cost time: 13.51120924949646
Epoch: 23, Steps: 208 | Train Loss: 1.821 Vali Loss: 4.716 Vali Acc: 0.110 Test Loss: 4.716 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.4396791
	speed: 0.3425s/iter; left time: 5451.2441s
	iters: 200, epoch: 24 | loss: 2.3239083
	speed: 0.0693s/iter; left time: 1095.6736s
Epoch: 24 cost time: 15.94245958328247
Epoch: 24, Steps: 208 | Train Loss: 1.789 Vali Loss: 4.802 Vali Acc: 0.108 Test Loss: 4.802 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.2186308
	speed: 0.3596s/iter; left time: 5648.7442s
	iters: 200, epoch: 25 | loss: 2.3216333
	speed: 0.0615s/iter; left time: 960.6759s
Epoch: 25 cost time: 14.176158666610718
Epoch: 25, Steps: 208 | Train Loss: 1.765 Vali Loss: 4.885 Vali Acc: 0.112 Test Loss: 4.885 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11422606620936475
model parameter : 89527
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6633856
	speed: 0.1029s/iter; left time: 2130.9703s
	iters: 200, epoch: 1 | loss: 3.6973548
	speed: 0.0557s/iter; left time: 1148.0738s
Epoch: 1 cost time: 16.842937707901
Epoch: 1, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.694 Vali Acc: 0.050 Test Loss: 3.694 Test Acc: 0.050
Validation loss decreased (inf --> -0.050067).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2638533
	speed: 0.3864s/iter; left time: 7918.4414s
	iters: 200, epoch: 2 | loss: 3.6117878
	speed: 0.0571s/iter; left time: 1164.1180s
Epoch: 2 cost time: 12.934356689453125
Epoch: 2, Steps: 208 | Train Loss: 3.589 Vali Loss: 3.755 Vali Acc: 0.053 Test Loss: 3.755 Test Acc: 0.053
Validation loss decreased (-0.050067 --> -0.053347).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4237502
	speed: 0.3767s/iter; left time: 7642.2723s
	iters: 200, epoch: 3 | loss: 3.4903948
	speed: 0.0665s/iter; left time: 1341.3703s
Epoch: 3 cost time: 14.694164752960205
Epoch: 3, Steps: 208 | Train Loss: 3.447 Vali Loss: 3.647 Vali Acc: 0.064 Test Loss: 3.647 Test Acc: 0.064
Validation loss decreased (-0.053347 --> -0.063787).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5553496
	speed: 0.3886s/iter; left time: 7802.0228s
	iters: 200, epoch: 4 | loss: 3.4106121
	speed: 0.0727s/iter; left time: 1452.6474s
Epoch: 4 cost time: 16.011029481887817
Epoch: 4, Steps: 208 | Train Loss: 3.270 Vali Loss: 3.658 Vali Acc: 0.083 Test Loss: 3.658 Test Acc: 0.083
Validation loss decreased (-0.063787 --> -0.083172).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1294413
	speed: 0.2005s/iter; left time: 3983.8037s
	iters: 200, epoch: 5 | loss: 2.9716399
	speed: 0.0327s/iter; left time: 646.6394s
Epoch: 5 cost time: 7.326744794845581
Epoch: 5, Steps: 208 | Train Loss: 3.132 Vali Loss: 3.641 Vali Acc: 0.076 Test Loss: 3.641 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.7013335
	speed: 0.1184s/iter; left time: 2327.9895s
	iters: 200, epoch: 6 | loss: 3.0778584
	speed: 0.0312s/iter; left time: 610.5440s
Epoch: 6 cost time: 6.636109828948975
Epoch: 6, Steps: 208 | Train Loss: 3.030 Vali Loss: 3.657 Vali Acc: 0.081 Test Loss: 3.657 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.0284383
	speed: 0.1183s/iter; left time: 2300.7438s
	iters: 200, epoch: 7 | loss: 3.0301957
	speed: 0.0330s/iter; left time: 638.1030s
Epoch: 7 cost time: 7.203271865844727
Epoch: 7, Steps: 208 | Train Loss: 2.969 Vali Loss: 3.738 Vali Acc: 0.083 Test Loss: 3.738 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.1618338
	speed: 0.1139s/iter; left time: 2191.4137s
	iters: 200, epoch: 8 | loss: 2.5962470
	speed: 0.0330s/iter; left time: 632.1065s
Epoch: 8 cost time: 7.228973150253296
Epoch: 8, Steps: 208 | Train Loss: 2.895 Vali Loss: 3.766 Vali Acc: 0.073 Test Loss: 3.766 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.0572424
	speed: 0.1146s/iter; left time: 2181.2667s
	iters: 200, epoch: 9 | loss: 3.0509942
	speed: 0.0290s/iter; left time: 549.8368s
Epoch: 9 cost time: 6.721402406692505
Epoch: 9, Steps: 208 | Train Loss: 2.804 Vali Loss: 3.673 Vali Acc: 0.084 Test Loss: 3.673 Test Acc: 0.084
Validation loss decreased (-0.083172 --> -0.084365).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5993662
	speed: 0.1151s/iter; left time: 2167.5039s
	iters: 200, epoch: 10 | loss: 2.9177365
	speed: 0.0328s/iter; left time: 615.1301s
Epoch: 10 cost time: 7.184635639190674
Epoch: 10, Steps: 208 | Train Loss: 2.738 Vali Loss: 3.839 Vali Acc: 0.078 Test Loss: 3.839 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.7555258
	speed: 0.1101s/iter; left time: 2049.8519s
	iters: 200, epoch: 11 | loss: 2.9143517
	speed: 0.0314s/iter; left time: 581.3650s
Epoch: 11 cost time: 6.69924259185791
Epoch: 11, Steps: 208 | Train Loss: 2.677 Vali Loss: 3.698 Vali Acc: 0.095 Test Loss: 3.698 Test Acc: 0.095
Validation loss decreased (-0.084365 --> -0.095102).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.4358938
	speed: 0.1168s/iter; left time: 2151.2340s
	iters: 200, epoch: 12 | loss: 3.4215884
	speed: 0.0323s/iter; left time: 591.3018s
Epoch: 12 cost time: 7.134454965591431
Epoch: 12, Steps: 208 | Train Loss: 2.604 Vali Loss: 3.832 Vali Acc: 0.093 Test Loss: 3.832 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.7942834
	speed: 0.1085s/iter; left time: 1975.2571s
	iters: 200, epoch: 13 | loss: 3.1538038
	speed: 0.0244s/iter; left time: 441.4005s
Epoch: 13 cost time: 5.7188122272491455
Epoch: 13, Steps: 208 | Train Loss: 2.539 Vali Loss: 3.803 Vali Acc: 0.090 Test Loss: 3.803 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.3526366
	speed: 0.0959s/iter; left time: 1725.4587s
	iters: 200, epoch: 14 | loss: 2.3195179
	speed: 0.0301s/iter; left time: 538.4644s
Epoch: 14 cost time: 6.44720196723938
Epoch: 14, Steps: 208 | Train Loss: 2.484 Vali Loss: 3.843 Vali Acc: 0.086 Test Loss: 3.843 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.9607661
	speed: 0.1051s/iter; left time: 1869.9745s
	iters: 200, epoch: 15 | loss: 3.0347867
	speed: 0.0278s/iter; left time: 491.9869s
Epoch: 15 cost time: 6.217843532562256
Epoch: 15, Steps: 208 | Train Loss: 2.417 Vali Loss: 3.889 Vali Acc: 0.098 Test Loss: 3.889 Test Acc: 0.098
Validation loss decreased (-0.095102 --> -0.098380).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.4266455
	speed: 0.1092s/iter; left time: 1920.1240s
	iters: 200, epoch: 16 | loss: 2.1534278
	speed: 0.0291s/iter; left time: 507.8831s
Epoch: 16 cost time: 6.540325403213501
Epoch: 16, Steps: 208 | Train Loss: 2.366 Vali Loss: 3.973 Vali Acc: 0.089 Test Loss: 3.973 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.0955811
	speed: 0.1079s/iter; left time: 1874.3962s
	iters: 200, epoch: 17 | loss: 2.6691697
	speed: 0.0307s/iter; left time: 529.9037s
Epoch: 17 cost time: 6.664101600646973
Epoch: 17, Steps: 208 | Train Loss: 2.324 Vali Loss: 4.101 Vali Acc: 0.088 Test Loss: 4.101 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.3913593
	speed: 0.1066s/iter; left time: 1829.6068s
	iters: 200, epoch: 18 | loss: 2.1175003
	speed: 0.0287s/iter; left time: 488.9870s
Epoch: 18 cost time: 6.384028196334839
Epoch: 18, Steps: 208 | Train Loss: 2.264 Vali Loss: 4.135 Vali Acc: 0.088 Test Loss: 4.135 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.1960213
	speed: 0.1081s/iter; left time: 1832.8347s
	iters: 200, epoch: 19 | loss: 2.4910374
	speed: 0.0291s/iter; left time: 489.7892s
Epoch: 19 cost time: 6.528209686279297
Epoch: 19, Steps: 208 | Train Loss: 2.211 Vali Loss: 4.081 Vali Acc: 0.101 Test Loss: 4.081 Test Acc: 0.101
Validation loss decreased (-0.098380 --> -0.101063).  Saving model ...
	iters: 100, epoch: 20 | loss: 2.5488703
	speed: 0.1059s/iter; left time: 1773.4751s
	iters: 200, epoch: 20 | loss: 2.2653618
	speed: 0.0300s/iter; left time: 499.4910s
Epoch: 20 cost time: 6.54730486869812
Epoch: 20, Steps: 208 | Train Loss: 2.201 Vali Loss: 4.173 Vali Acc: 0.089 Test Loss: 4.173 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.8173944
	speed: 0.1048s/iter; left time: 1733.4149s
	iters: 200, epoch: 21 | loss: 2.7060802
	speed: 0.0289s/iter; left time: 475.0129s
Epoch: 21 cost time: 6.343871355056763
Epoch: 21, Steps: 208 | Train Loss: 2.135 Vali Loss: 4.288 Vali Acc: 0.098 Test Loss: 4.288 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4289178
	speed: 0.1075s/iter; left time: 1755.9330s
	iters: 200, epoch: 22 | loss: 2.1764054
	speed: 0.0278s/iter; left time: 452.0847s
Epoch: 22 cost time: 6.538970232009888
Epoch: 22, Steps: 208 | Train Loss: 2.092 Vali Loss: 4.353 Vali Acc: 0.097 Test Loss: 4.353 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 2.1622694
	speed: 0.1113s/iter; left time: 1795.2141s
	iters: 200, epoch: 23 | loss: 2.7226200
	speed: 0.0256s/iter; left time: 410.8973s
Epoch: 23 cost time: 6.340320587158203
Epoch: 23, Steps: 208 | Train Loss: 2.050 Vali Loss: 4.408 Vali Acc: 0.100 Test Loss: 4.408 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.5247478
	speed: 0.1065s/iter; left time: 1695.1221s
	iters: 200, epoch: 24 | loss: 1.1660409
	speed: 0.0290s/iter; left time: 459.2426s
Epoch: 24 cost time: 6.384148120880127
Epoch: 24, Steps: 208 | Train Loss: 1.997 Vali Loss: 4.572 Vali Acc: 0.099 Test Loss: 4.572 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 2.1659541
	speed: 0.1072s/iter; left time: 1683.8685s
	iters: 200, epoch: 25 | loss: 1.7356539
	speed: 0.0263s/iter; left time: 409.7404s
Epoch: 25 cost time: 5.86122727394104
Epoch: 25, Steps: 208 | Train Loss: 1.971 Vali Loss: 4.529 Vali Acc: 0.102 Test Loss: 4.529 Test Acc: 0.102
Validation loss decreased (-0.101063 --> -0.101655).  Saving model ...
	iters: 100, epoch: 26 | loss: 2.4013171
	speed: 0.1089s/iter; left time: 1687.5271s
	iters: 200, epoch: 26 | loss: 1.9593420
	speed: 0.0257s/iter; left time: 395.7010s
Epoch: 26 cost time: 5.977558851242065
Epoch: 26, Steps: 208 | Train Loss: 1.963 Vali Loss: 4.599 Vali Acc: 0.101 Test Loss: 4.599 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.5847994
	speed: 0.1094s/iter; left time: 1672.3060s
	iters: 200, epoch: 27 | loss: 2.0254803
	speed: 0.0285s/iter; left time: 432.3926s
Epoch: 27 cost time: 6.363874435424805
Epoch: 27, Steps: 208 | Train Loss: 1.908 Vali Loss: 4.668 Vali Acc: 0.096 Test Loss: 4.668 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 2.0399661
	speed: 0.1106s/iter; left time: 1667.9102s
	iters: 200, epoch: 28 | loss: 1.5150921
	speed: 0.0281s/iter; left time: 420.9303s
Epoch: 28 cost time: 6.427233457565308
Epoch: 28, Steps: 208 | Train Loss: 1.880 Vali Loss: 4.768 Vali Acc: 0.096 Test Loss: 4.768 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 2.0826597
	speed: 0.1054s/iter; left time: 1567.9988s
	iters: 200, epoch: 29 | loss: 2.2554410
	speed: 0.0285s/iter; left time: 421.5825s
Epoch: 29 cost time: 6.102013349533081
Epoch: 29, Steps: 208 | Train Loss: 1.858 Vali Loss: 4.826 Vali Acc: 0.105 Test Loss: 4.826 Test Acc: 0.105
Validation loss decreased (-0.101655 --> -0.105231).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.8047651
	speed: 0.1033s/iter; left time: 1514.8198s
	iters: 200, epoch: 30 | loss: 1.9714779
	speed: 0.0255s/iter; left time: 371.9227s
Epoch: 30 cost time: 5.790018796920776
Epoch: 30, Steps: 208 | Train Loss: 1.817 Vali Loss: 4.849 Vali Acc: 0.101 Test Loss: 4.849 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 2.1829987
	speed: 0.1098s/iter; left time: 1587.6822s
	iters: 200, epoch: 31 | loss: 1.8663329
	speed: 0.0274s/iter; left time: 392.9939s
Epoch: 31 cost time: 6.354321002960205
Epoch: 31, Steps: 208 | Train Loss: 1.799 Vali Loss: 4.944 Vali Acc: 0.093 Test Loss: 4.944 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.3243946
	speed: 0.1080s/iter; left time: 1538.7113s
	iters: 200, epoch: 32 | loss: 2.5264876
	speed: 0.0297s/iter; left time: 419.7306s
Epoch: 32 cost time: 6.552728176116943
Epoch: 32, Steps: 208 | Train Loss: 1.765 Vali Loss: 5.107 Vali Acc: 0.093 Test Loss: 5.107 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.7525504
	speed: 0.1051s/iter; left time: 1476.8213s
	iters: 200, epoch: 33 | loss: 2.0405097
	speed: 0.0298s/iter; left time: 415.0277s
Epoch: 33 cost time: 6.444807767868042
Epoch: 33, Steps: 208 | Train Loss: 1.736 Vali Loss: 5.094 Vali Acc: 0.097 Test Loss: 5.094 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.8757870
	speed: 0.1076s/iter; left time: 1488.5328s
	iters: 200, epoch: 34 | loss: 2.3478248
	speed: 0.0273s/iter; left time: 374.4865s
Epoch: 34 cost time: 6.051828861236572
Epoch: 34, Steps: 208 | Train Loss: 1.674 Vali Loss: 5.262 Vali Acc: 0.097 Test Loss: 5.262 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 1.1423397
	speed: 0.1077s/iter; left time: 1467.5387s
	iters: 200, epoch: 35 | loss: 2.0601742
	speed: 0.0279s/iter; left time: 377.2585s
Epoch: 35 cost time: 6.358394145965576
Epoch: 35, Steps: 208 | Train Loss: 1.669 Vali Loss: 5.341 Vali Acc: 0.098 Test Loss: 5.341 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 1.4814968
	speed: 0.0994s/iter; left time: 1334.5878s
	iters: 200, epoch: 36 | loss: 1.7100114
	speed: 0.0315s/iter; left time: 419.1622s
Epoch: 36 cost time: 6.09837532043457
Epoch: 36, Steps: 208 | Train Loss: 1.669 Vali Loss: 5.514 Vali Acc: 0.095 Test Loss: 5.514 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 1.8310432
	speed: 0.1153s/iter; left time: 1523.1962s
	iters: 200, epoch: 37 | loss: 2.6073074
	speed: 0.0310s/iter; left time: 406.2489s
Epoch: 37 cost time: 6.949265480041504
Epoch: 37, Steps: 208 | Train Loss: 1.653 Vali Loss: 5.468 Vali Acc: 0.101 Test Loss: 5.468 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.2420396
	speed: 0.1147s/iter; left time: 1491.4253s
	iters: 200, epoch: 38 | loss: 0.9447968
	speed: 0.0275s/iter; left time: 355.1509s
Epoch: 38 cost time: 6.317339897155762
Epoch: 38, Steps: 208 | Train Loss: 1.618 Vali Loss: 5.534 Vali Acc: 0.103 Test Loss: 5.534 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 1.6876910
	speed: 0.1213s/iter; left time: 1551.7921s
	iters: 200, epoch: 39 | loss: 1.5011302
	speed: 0.0302s/iter; left time: 383.2572s
Epoch: 39 cost time: 6.88102388381958
Epoch: 39, Steps: 208 | Train Loss: 1.571 Vali Loss: 5.642 Vali Acc: 0.098 Test Loss: 5.642 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10527885475693409
model parameter : 69111
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7810652
	speed: 0.0458s/iter; left time: 947.2259s
	iters: 200, epoch: 1 | loss: 3.7260041
	speed: 0.0303s/iter; left time: 624.9805s
Epoch: 1 cost time: 7.9172751903533936
Epoch: 1, Steps: 208 | Train Loss: 3.795 Vali Loss: 3.682 Vali Acc: 0.048 Test Loss: 3.682 Test Acc: 0.048
Validation loss decreased (inf --> -0.048278).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8596225
	speed: 0.1131s/iter; left time: 2318.3922s
	iters: 200, epoch: 2 | loss: 3.9089432
	speed: 0.0286s/iter; left time: 584.2563s
Epoch: 2 cost time: 6.22605299949646
Epoch: 2, Steps: 208 | Train Loss: 3.617 Vali Loss: 3.694 Vali Acc: 0.056 Test Loss: 3.694 Test Acc: 0.056
Validation loss decreased (-0.048278 --> -0.056330).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5642562
	speed: 0.1272s/iter; left time: 2581.0858s
	iters: 200, epoch: 3 | loss: 3.8912961
	speed: 0.0279s/iter; left time: 564.0411s
Epoch: 3 cost time: 6.701396942138672
Epoch: 3, Steps: 208 | Train Loss: 3.513 Vali Loss: 3.710 Vali Acc: 0.060 Test Loss: 3.710 Test Acc: 0.060
Validation loss decreased (-0.056330 --> -0.059909).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2091167
	speed: 0.1245s/iter; left time: 2499.3656s
	iters: 200, epoch: 4 | loss: 3.1477501
	speed: 0.0319s/iter; left time: 637.9142s
Epoch: 4 cost time: 7.0466930866241455
Epoch: 4, Steps: 208 | Train Loss: 3.377 Vali Loss: 3.692 Vali Acc: 0.065 Test Loss: 3.692 Test Acc: 0.065
Validation loss decreased (-0.059909 --> -0.064979).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4434850
	speed: 0.1291s/iter; left time: 2565.2764s
	iters: 200, epoch: 5 | loss: 3.5309651
	speed: 0.0310s/iter; left time: 613.1618s
Epoch: 5 cost time: 6.945241928100586
Epoch: 5, Steps: 208 | Train Loss: 3.259 Vali Loss: 3.694 Vali Acc: 0.074 Test Loss: 3.694 Test Acc: 0.074
Validation loss decreased (-0.064979 --> -0.073927).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0908608
	speed: 0.1273s/iter; left time: 2503.4495s
	iters: 200, epoch: 6 | loss: 3.3255656
	speed: 0.0307s/iter; left time: 601.0349s
Epoch: 6 cost time: 6.74371862411499
Epoch: 6, Steps: 208 | Train Loss: 3.169 Vali Loss: 3.623 Vali Acc: 0.084 Test Loss: 3.623 Test Acc: 0.084
Validation loss decreased (-0.073927 --> -0.083471).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2885311
	speed: 0.1239s/iter; left time: 2409.2718s
	iters: 200, epoch: 7 | loss: 2.7968857
	speed: 0.0281s/iter; left time: 544.0696s
Epoch: 7 cost time: 6.406813144683838
Epoch: 7, Steps: 208 | Train Loss: 3.070 Vali Loss: 3.677 Vali Acc: 0.084 Test Loss: 3.677 Test Acc: 0.084
Validation loss decreased (-0.083471 --> -0.083769).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.3477581
	speed: 0.1268s/iter; left time: 2439.5141s
	iters: 200, epoch: 8 | loss: 3.2815971
	speed: 0.0310s/iter; left time: 593.1548s
Epoch: 8 cost time: 6.849557638168335
Epoch: 8, Steps: 208 | Train Loss: 2.977 Vali Loss: 3.697 Vali Acc: 0.089 Test Loss: 3.697 Test Acc: 0.089
Validation loss decreased (-0.083769 --> -0.088839).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7221370
	speed: 0.1352s/iter; left time: 2574.2634s
	iters: 200, epoch: 9 | loss: 2.9733758
	speed: 0.0318s/iter; left time: 601.7234s
Epoch: 9 cost time: 7.1795268058776855
Epoch: 9, Steps: 208 | Train Loss: 2.903 Vali Loss: 3.677 Vali Acc: 0.089 Test Loss: 3.677 Test Acc: 0.089
Validation loss decreased (-0.088839 --> -0.089137).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6494555
	speed: 0.1400s/iter; left time: 2636.8446s
	iters: 200, epoch: 10 | loss: 3.1196563
	speed: 0.0323s/iter; left time: 605.6379s
Epoch: 10 cost time: 7.025907278060913
Epoch: 10, Steps: 208 | Train Loss: 2.828 Vali Loss: 3.729 Vali Acc: 0.091 Test Loss: 3.729 Test Acc: 0.091
Validation loss decreased (-0.089137 --> -0.090926).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5402627
	speed: 0.1310s/iter; left time: 2439.3330s
	iters: 200, epoch: 11 | loss: 2.5209551
	speed: 0.0290s/iter; left time: 537.9828s
Epoch: 11 cost time: 6.463203191757202
Epoch: 11, Steps: 208 | Train Loss: 2.762 Vali Loss: 3.714 Vali Acc: 0.091 Test Loss: 3.714 Test Acc: 0.091
Validation loss decreased (-0.090926 --> -0.090926).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.8453691
	speed: 0.1366s/iter; left time: 2515.1010s
	iters: 200, epoch: 12 | loss: 2.5608151
	speed: 0.0244s/iter; left time: 447.7024s
Epoch: 12 cost time: 6.118414878845215
Epoch: 12, Steps: 208 | Train Loss: 2.726 Vali Loss: 3.746 Vali Acc: 0.094 Test Loss: 3.746 Test Acc: 0.094
Validation loss decreased (-0.090926 --> -0.093908).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.1112556
	speed: 0.1372s/iter; left time: 2497.7019s
	iters: 200, epoch: 13 | loss: 3.1725042
	speed: 0.0282s/iter; left time: 510.7047s
Epoch: 13 cost time: 6.607371091842651
Epoch: 13, Steps: 208 | Train Loss: 2.640 Vali Loss: 3.790 Vali Acc: 0.102 Test Loss: 3.790 Test Acc: 0.102
Validation loss decreased (-0.093908 --> -0.102259).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.7293580
	speed: 0.1394s/iter; left time: 2507.9902s
	iters: 200, epoch: 14 | loss: 2.9299815
	speed: 0.0308s/iter; left time: 551.2991s
Epoch: 14 cost time: 6.8966851234436035
Epoch: 14, Steps: 208 | Train Loss: 2.589 Vali Loss: 3.795 Vali Acc: 0.101 Test Loss: 3.795 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 3.0285258
	speed: 0.1419s/iter; left time: 2523.3858s
	iters: 200, epoch: 15 | loss: 2.8491769
	speed: 0.0303s/iter; left time: 536.6318s
Epoch: 15 cost time: 6.702417612075806
Epoch: 15, Steps: 208 | Train Loss: 2.528 Vali Loss: 3.944 Vali Acc: 0.095 Test Loss: 3.944 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.2425518
	speed: 0.1407s/iter; left time: 2473.4178s
	iters: 200, epoch: 16 | loss: 2.6411703
	speed: 0.0306s/iter; left time: 535.5979s
Epoch: 16 cost time: 6.836697578430176
Epoch: 16, Steps: 208 | Train Loss: 2.479 Vali Loss: 3.937 Vali Acc: 0.101 Test Loss: 3.937 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.3331721
	speed: 0.1394s/iter; left time: 2421.6645s
	iters: 200, epoch: 17 | loss: 2.3094606
	speed: 0.0298s/iter; left time: 514.3571s
Epoch: 17 cost time: 6.901144981384277
Epoch: 17, Steps: 208 | Train Loss: 2.447 Vali Loss: 4.011 Vali Acc: 0.100 Test Loss: 4.011 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.2442524
	speed: 0.1363s/iter; left time: 2339.6396s
	iters: 200, epoch: 18 | loss: 2.4667065
	speed: 0.0303s/iter; left time: 517.6832s
Epoch: 18 cost time: 6.582179307937622
Epoch: 18, Steps: 208 | Train Loss: 2.392 Vali Loss: 4.044 Vali Acc: 0.105 Test Loss: 4.044 Test Acc: 0.105
Validation loss decreased (-0.102259 --> -0.104642).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.6843309
	speed: 0.1333s/iter; left time: 2259.9129s
	iters: 200, epoch: 19 | loss: 2.3795471
	speed: 0.0283s/iter; left time: 476.7318s
Epoch: 19 cost time: 6.23184609413147
Epoch: 19, Steps: 208 | Train Loss: 2.363 Vali Loss: 4.101 Vali Acc: 0.106 Test Loss: 4.101 Test Acc: 0.106
Validation loss decreased (-0.104642 --> -0.105834).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.8442665
	speed: 0.1326s/iter; left time: 2221.1830s
	iters: 200, epoch: 20 | loss: 2.1877072
	speed: 0.0270s/iter; left time: 449.6998s
Epoch: 20 cost time: 6.358177423477173
Epoch: 20, Steps: 208 | Train Loss: 2.302 Vali Loss: 4.144 Vali Acc: 0.105 Test Loss: 4.144 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 2.1152487
	speed: 0.1393s/iter; left time: 2303.9843s
	iters: 200, epoch: 21 | loss: 2.3885634
	speed: 0.0267s/iter; left time: 439.1031s
Epoch: 21 cost time: 6.265348672866821
Epoch: 21, Steps: 208 | Train Loss: 2.255 Vali Loss: 4.219 Vali Acc: 0.107 Test Loss: 4.219 Test Acc: 0.107
Validation loss decreased (-0.105834 --> -0.107324).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.9266777
	speed: 0.1355s/iter; left time: 2213.0696s
	iters: 200, epoch: 22 | loss: 2.0099196
	speed: 0.0286s/iter; left time: 463.9659s
Epoch: 22 cost time: 6.603264093399048
Epoch: 22, Steps: 208 | Train Loss: 2.217 Vali Loss: 4.337 Vali Acc: 0.100 Test Loss: 4.337 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 2.5729749
	speed: 0.1315s/iter; left time: 2121.0892s
	iters: 200, epoch: 23 | loss: 2.5687516
	speed: 0.0290s/iter; left time: 465.0654s
Epoch: 23 cost time: 6.546258926391602
Epoch: 23, Steps: 208 | Train Loss: 2.188 Vali Loss: 4.342 Vali Acc: 0.106 Test Loss: 4.342 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 2.3244989
	speed: 0.1348s/iter; left time: 2146.1247s
	iters: 200, epoch: 24 | loss: 2.9373894
	speed: 0.0311s/iter; left time: 491.8547s
Epoch: 24 cost time: 6.93487811088562
Epoch: 24, Steps: 208 | Train Loss: 2.134 Vali Loss: 4.441 Vali Acc: 0.102 Test Loss: 4.441 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.6720171
	speed: 0.1388s/iter; left time: 2179.6797s
	iters: 200, epoch: 25 | loss: 1.5827405
	speed: 0.0306s/iter; left time: 476.8559s
Epoch: 25 cost time: 6.655188083648682
Epoch: 25, Steps: 208 | Train Loss: 2.117 Vali Loss: 4.522 Vali Acc: 0.097 Test Loss: 4.522 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 2.2513771
	speed: 0.1358s/iter; left time: 2105.1844s
	iters: 200, epoch: 26 | loss: 2.2116575
	speed: 0.0285s/iter; left time: 438.9060s
Epoch: 26 cost time: 6.371039867401123
Epoch: 26, Steps: 208 | Train Loss: 2.081 Vali Loss: 4.525 Vali Acc: 0.097 Test Loss: 4.525 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 2.3903484
	speed: 0.1379s/iter; left time: 2108.5676s
	iters: 200, epoch: 27 | loss: 2.6309063
	speed: 0.0286s/iter; left time: 433.8751s
Epoch: 27 cost time: 6.655415296554565
Epoch: 27, Steps: 208 | Train Loss: 2.063 Vali Loss: 4.642 Vali Acc: 0.099 Test Loss: 4.642 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 2.1965220
	speed: 0.1344s/iter; left time: 2027.5033s
	iters: 200, epoch: 28 | loss: 2.0458102
	speed: 0.0251s/iter; left time: 376.4391s
Epoch: 28 cost time: 5.815593242645264
Epoch: 28, Steps: 208 | Train Loss: 2.011 Vali Loss: 4.708 Vali Acc: 0.100 Test Loss: 4.708 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 2.3079958
	speed: 0.1384s/iter; left time: 2059.3741s
	iters: 200, epoch: 29 | loss: 2.4559660
	speed: 0.0289s/iter; left time: 427.4052s
Epoch: 29 cost time: 6.751533031463623
Epoch: 29, Steps: 208 | Train Loss: 1.992 Vali Loss: 4.768 Vali Acc: 0.096 Test Loss: 4.768 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.3911653
	speed: 0.1384s/iter; left time: 2029.5322s
	iters: 200, epoch: 30 | loss: 1.9847467
	speed: 0.0294s/iter; left time: 427.9591s
Epoch: 30 cost time: 6.622615337371826
Epoch: 30, Steps: 208 | Train Loss: 1.971 Vali Loss: 4.778 Vali Acc: 0.094 Test Loss: 4.778 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 2.1028788
	speed: 0.1375s/iter; left time: 1988.1832s
	iters: 200, epoch: 31 | loss: 2.7397232
	speed: 0.0301s/iter; left time: 431.6536s
Epoch: 31 cost time: 6.509857892990112
Epoch: 31, Steps: 208 | Train Loss: 1.924 Vali Loss: 4.854 Vali Acc: 0.098 Test Loss: 4.854 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el2_dm16_nh4_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10736653742916791
model parameter : 55559
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.5997772
	speed: 0.0778s/iter; left time: 1610.5585s
	iters: 200, epoch: 1 | loss: 3.2598150
	speed: 0.0590s/iter; left time: 1215.9067s
Epoch: 1 cost time: 14.250694990158081
Epoch: 1, Steps: 208 | Train Loss: 5.692 Vali Loss: 3.703 Vali Acc: 0.062 Test Loss: 3.703 Test Acc: 0.062
Validation loss decreased (inf --> -0.061699).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7840469
	speed: 0.2035s/iter; left time: 4170.6366s
	iters: 200, epoch: 2 | loss: 4.5745616
	speed: 0.0620s/iter; left time: 1264.4037s
Epoch: 2 cost time: 12.986389636993408
Epoch: 2, Steps: 208 | Train Loss: 4.107 Vali Loss: 4.365 Vali Acc: 0.074 Test Loss: 4.365 Test Acc: 0.074
Validation loss decreased (-0.061699 --> -0.073920).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.6468058
	speed: 0.2062s/iter; left time: 4183.6742s
	iters: 200, epoch: 3 | loss: 5.2502875
	speed: 0.0620s/iter; left time: 1252.1276s
Epoch: 3 cost time: 13.033812999725342
Epoch: 3, Steps: 208 | Train Loss: 4.857 Vali Loss: 4.342 Vali Acc: 0.096 Test Loss: 4.342 Test Acc: 0.096
Validation loss decreased (-0.073920 --> -0.096288).  Saving model ...
	iters: 100, epoch: 4 | loss: 5.5180731
	speed: 0.2108s/iter; left time: 4231.9871s
	iters: 200, epoch: 4 | loss: 4.9225850
	speed: 0.0640s/iter; left time: 1277.9448s
Epoch: 4 cost time: 13.219190120697021
Epoch: 4, Steps: 208 | Train Loss: 5.617 Vali Loss: 5.668 Vali Acc: 0.095 Test Loss: 5.668 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 8.7036438
	speed: 0.2049s/iter; left time: 4070.7740s
	iters: 200, epoch: 5 | loss: 6.3470292
	speed: 0.0579s/iter; left time: 1144.3980s
Epoch: 5 cost time: 12.142732620239258
Epoch: 5, Steps: 208 | Train Loss: 5.990 Vali Loss: 6.792 Vali Acc: 0.089 Test Loss: 6.792 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 4.8098407
	speed: 0.1996s/iter; left time: 3923.7105s
	iters: 200, epoch: 6 | loss: 3.5778832
	speed: 0.0574s/iter; left time: 1123.6197s
Epoch: 6 cost time: 12.48633098602295
Epoch: 6, Steps: 208 | Train Loss: 5.629 Vali Loss: 6.081 Vali Acc: 0.098 Test Loss: 6.081 Test Acc: 0.098
Validation loss decreased (-0.096288 --> -0.098060).  Saving model ...
	iters: 100, epoch: 7 | loss: 6.8017468
	speed: 0.2018s/iter; left time: 3926.5479s
	iters: 200, epoch: 7 | loss: 6.7321095
	speed: 0.0574s/iter; left time: 1111.1894s
Epoch: 7 cost time: 12.513163566589355
Epoch: 7, Steps: 208 | Train Loss: 5.477 Vali Loss: 6.214 Vali Acc: 0.097 Test Loss: 6.214 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9298539
	speed: 0.2002s/iter; left time: 3851.9412s
	iters: 200, epoch: 8 | loss: 3.9603312
	speed: 0.0567s/iter; left time: 1084.7684s
Epoch: 8 cost time: 12.366276741027832
Epoch: 8, Steps: 208 | Train Loss: 4.896 Vali Loss: 7.801 Vali Acc: 0.099 Test Loss: 7.801 Test Acc: 0.099
Validation loss decreased (-0.098060 --> -0.098938).  Saving model ...
	iters: 100, epoch: 9 | loss: 4.5334620
	speed: 0.2031s/iter; left time: 3866.0207s
	iters: 200, epoch: 9 | loss: 2.5500865
	speed: 0.0549s/iter; left time: 1039.0064s
Epoch: 9 cost time: 12.175834655761719
Epoch: 9, Steps: 208 | Train Loss: 3.997 Vali Loss: 7.814 Vali Acc: 0.092 Test Loss: 7.814 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2468481
	speed: 0.1911s/iter; left time: 3598.7670s
	iters: 200, epoch: 10 | loss: 3.7619820
	speed: 0.0516s/iter; left time: 966.0304s
Epoch: 10 cost time: 11.215140342712402
Epoch: 10, Steps: 208 | Train Loss: 2.848 Vali Loss: 11.336 Vali Acc: 0.059 Test Loss: 11.336 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2726119
	speed: 0.1949s/iter; left time: 3629.0433s
	iters: 200, epoch: 11 | loss: 2.2997751
	speed: 0.0573s/iter; left time: 1060.9243s
Epoch: 11 cost time: 11.714860916137695
Epoch: 11, Steps: 208 | Train Loss: 1.938 Vali Loss: 10.367 Vali Acc: 0.071 Test Loss: 10.367 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3972970
	speed: 0.1905s/iter; left time: 3508.0335s
	iters: 200, epoch: 12 | loss: 1.8171310
	speed: 0.0543s/iter; left time: 993.7452s
Epoch: 12 cost time: 11.568238019943237
Epoch: 12, Steps: 208 | Train Loss: 1.441 Vali Loss: 8.055 Vali Acc: 0.071 Test Loss: 8.055 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1551989
	speed: 0.1958s/iter; left time: 3563.8466s
	iters: 200, epoch: 13 | loss: 2.2959819
	speed: 0.0558s/iter; left time: 1010.4748s
Epoch: 13 cost time: 12.03095555305481
Epoch: 13, Steps: 208 | Train Loss: 1.117 Vali Loss: 7.178 Vali Acc: 0.108 Test Loss: 7.178 Test Acc: 0.108
Validation loss decreased (-0.098938 --> -0.107593).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6285335
	speed: 0.1997s/iter; left time: 3594.6530s
	iters: 200, epoch: 14 | loss: 1.6792394
	speed: 0.0534s/iter; left time: 955.8186s
Epoch: 14 cost time: 11.895772457122803
Epoch: 14, Steps: 208 | Train Loss: 0.928 Vali Loss: 7.990 Vali Acc: 0.093 Test Loss: 7.990 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6402273
	speed: 0.2067s/iter; left time: 3677.0585s
	iters: 200, epoch: 15 | loss: 0.6918232
	speed: 0.0615s/iter; left time: 1087.7168s
Epoch: 15 cost time: 13.173208236694336
Epoch: 15, Steps: 208 | Train Loss: 0.784 Vali Loss: 8.151 Vali Acc: 0.111 Test Loss: 8.151 Test Acc: 0.111
Validation loss decreased (-0.107593 --> -0.111162).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6608948
	speed: 0.1948s/iter; left time: 3425.2255s
	iters: 200, epoch: 16 | loss: 2.4448969
	speed: 0.0544s/iter; left time: 950.4692s
Epoch: 16 cost time: 11.686169385910034
Epoch: 16, Steps: 208 | Train Loss: 0.652 Vali Loss: 8.466 Vali Acc: 0.103 Test Loss: 8.466 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4966156
	speed: 0.2026s/iter; left time: 3519.0776s
	iters: 200, epoch: 17 | loss: 0.1852513
	speed: 0.0624s/iter; left time: 1076.9822s
Epoch: 17 cost time: 12.948792934417725
Epoch: 17, Steps: 208 | Train Loss: 0.552 Vali Loss: 8.803 Vali Acc: 0.112 Test Loss: 8.803 Test Acc: 0.112
Validation loss decreased (-0.111162 --> -0.111752).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0986017
	speed: 0.2068s/iter; left time: 3550.1211s
	iters: 200, epoch: 18 | loss: 0.5321445
	speed: 0.0634s/iter; left time: 1082.1942s
Epoch: 18 cost time: 13.518522262573242
Epoch: 18, Steps: 208 | Train Loss: 0.442 Vali Loss: 9.895 Vali Acc: 0.106 Test Loss: 9.895 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1885285
	speed: 0.2009s/iter; left time: 3406.9952s
	iters: 200, epoch: 19 | loss: 0.2585117
	speed: 0.0639s/iter; left time: 1078.0027s
Epoch: 19 cost time: 13.774799346923828
Epoch: 19, Steps: 208 | Train Loss: 0.388 Vali Loss: 9.561 Vali Acc: 0.104 Test Loss: 9.561 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2176733
	speed: 0.2027s/iter; left time: 3394.7247s
	iters: 200, epoch: 20 | loss: 0.4000931
	speed: 0.0616s/iter; left time: 1024.9906s
Epoch: 20 cost time: 13.413343667984009
Epoch: 20, Steps: 208 | Train Loss: 0.310 Vali Loss: 10.759 Vali Acc: 0.107 Test Loss: 10.759 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0915737
	speed: 0.2003s/iter; left time: 3313.2128s
	iters: 200, epoch: 21 | loss: 0.0639067
	speed: 0.0597s/iter; left time: 981.0539s
Epoch: 21 cost time: 13.306808710098267
Epoch: 21, Steps: 208 | Train Loss: 0.274 Vali Loss: 11.540 Vali Acc: 0.111 Test Loss: 11.540 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.8293629
	speed: 0.2072s/iter; left time: 3383.6351s
	iters: 200, epoch: 22 | loss: 0.2269638
	speed: 0.0622s/iter; left time: 1010.2191s
Epoch: 22 cost time: 13.076086044311523
Epoch: 22, Steps: 208 | Train Loss: 0.256 Vali Loss: 11.368 Vali Acc: 0.101 Test Loss: 11.368 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2380168
	speed: 0.2101s/iter; left time: 3387.2529s
	iters: 200, epoch: 23 | loss: 0.2996991
	speed: 0.0637s/iter; left time: 1020.5420s
Epoch: 23 cost time: 13.64150595664978
Epoch: 23, Steps: 208 | Train Loss: 0.246 Vali Loss: 11.162 Vali Acc: 0.101 Test Loss: 11.162 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.1273254
	speed: 0.2104s/iter; left time: 3348.3222s
	iters: 200, epoch: 24 | loss: 0.4357348
	speed: 0.0620s/iter; left time: 980.5761s
Epoch: 24 cost time: 13.417618989944458
Epoch: 24, Steps: 208 | Train Loss: 0.194 Vali Loss: 11.839 Vali Acc: 0.105 Test Loss: 11.839 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.3503974
	speed: 0.2083s/iter; left time: 3271.6246s
	iters: 200, epoch: 25 | loss: 0.4464977
	speed: 0.0589s/iter; left time: 919.1290s
Epoch: 25 cost time: 13.045546770095825
Epoch: 25, Steps: 208 | Train Loss: 0.222 Vali Loss: 13.347 Vali Acc: 0.098 Test Loss: 13.347 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0355277
	speed: 0.2108s/iter; left time: 3268.3650s
	iters: 200, epoch: 26 | loss: 0.4169179
	speed: 0.0485s/iter; left time: 747.5305s
Epoch: 26 cost time: 10.847402095794678
Epoch: 26, Steps: 208 | Train Loss: 0.214 Vali Loss: 11.451 Vali Acc: 0.098 Test Loss: 11.451 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0387793
	speed: 0.1880s/iter; left time: 2875.4897s
	iters: 200, epoch: 27 | loss: 0.0149448
	speed: 0.0551s/iter; left time: 837.5740s
Epoch: 27 cost time: 11.286051511764526
Epoch: 27, Steps: 208 | Train Loss: 0.149 Vali Loss: 12.872 Vali Acc: 0.104 Test Loss: 12.872 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11184014315538324
model parameter : 4087207
model size : 18.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8575730
	speed: 0.0531s/iter; left time: 1099.8119s
	iters: 200, epoch: 1 | loss: 4.2144518
	speed: 0.0332s/iter; left time: 683.5261s
Epoch: 1 cost time: 8.95822286605835
Epoch: 1, Steps: 208 | Train Loss: 4.857 Vali Loss: 3.631 Vali Acc: 0.061 Test Loss: 3.631 Test Acc: 0.061
Validation loss decreased (inf --> -0.061401).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8249965
	speed: 0.1316s/iter; left time: 2696.4561s
	iters: 200, epoch: 2 | loss: 4.1043696
	speed: 0.0256s/iter; left time: 522.7179s
Epoch: 2 cost time: 5.751313924789429
Epoch: 2, Steps: 208 | Train Loss: 3.535 Vali Loss: 3.729 Vali Acc: 0.097 Test Loss: 3.729 Test Acc: 0.097
Validation loss decreased (-0.061401 --> -0.097189).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6315725
	speed: 0.1334s/iter; left time: 2705.6747s
	iters: 200, epoch: 3 | loss: 3.9554682
	speed: 0.0268s/iter; left time: 540.5329s
Epoch: 3 cost time: 6.807349920272827
Epoch: 3, Steps: 208 | Train Loss: 3.931 Vali Loss: 4.363 Vali Acc: 0.083 Test Loss: 4.363 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.4196754
	speed: 0.1400s/iter; left time: 2810.2634s
	iters: 200, epoch: 4 | loss: 4.2567940
	speed: 0.0330s/iter; left time: 658.4481s
Epoch: 4 cost time: 7.273564100265503
Epoch: 4, Steps: 208 | Train Loss: 4.318 Vali Loss: 4.883 Vali Acc: 0.091 Test Loss: 4.883 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.8477068
	speed: 0.1357s/iter; left time: 2695.3328s
	iters: 200, epoch: 5 | loss: 4.5199223
	speed: 0.0326s/iter; left time: 644.2929s
Epoch: 5 cost time: 7.10878324508667
Epoch: 5, Steps: 208 | Train Loss: 4.468 Vali Loss: 4.776 Vali Acc: 0.122 Test Loss: 4.776 Test Acc: 0.122
Validation loss decreased (-0.097189 --> -0.121933).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.4575863
	speed: 0.1379s/iter; left time: 2712.0848s
	iters: 200, epoch: 6 | loss: 3.6582234
	speed: 0.0344s/iter; left time: 672.6696s
Epoch: 6 cost time: 7.228852033615112
Epoch: 6, Steps: 208 | Train Loss: 4.463 Vali Loss: 5.915 Vali Acc: 0.105 Test Loss: 5.915 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.5282712
	speed: 0.1359s/iter; left time: 2642.7990s
	iters: 200, epoch: 7 | loss: 5.2120886
	speed: 0.0318s/iter; left time: 615.4443s
Epoch: 7 cost time: 6.957373142242432
Epoch: 7, Steps: 208 | Train Loss: 4.216 Vali Loss: 5.529 Vali Acc: 0.107 Test Loss: 5.529 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.2141943
	speed: 0.1355s/iter; left time: 2607.0081s
	iters: 200, epoch: 8 | loss: 4.7021213
	speed: 0.0300s/iter; left time: 575.2590s
Epoch: 8 cost time: 6.488291025161743
Epoch: 8, Steps: 208 | Train Loss: 4.030 Vali Loss: 5.504 Vali Acc: 0.113 Test Loss: 5.504 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.0622542
	speed: 0.1365s/iter; left time: 2597.8442s
	iters: 200, epoch: 9 | loss: 4.1198239
	speed: 0.0363s/iter; left time: 687.2972s
Epoch: 9 cost time: 6.933300971984863
Epoch: 9, Steps: 208 | Train Loss: 3.410 Vali Loss: 5.784 Vali Acc: 0.119 Test Loss: 5.784 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.8029504
	speed: 0.1497s/iter; left time: 2818.1627s
	iters: 200, epoch: 10 | loss: 1.7514298
	speed: 0.0350s/iter; left time: 655.4979s
Epoch: 10 cost time: 7.872728586196899
Epoch: 10, Steps: 208 | Train Loss: 2.741 Vali Loss: 7.287 Vali Acc: 0.078 Test Loss: 7.287 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.3006783
	speed: 0.1517s/iter; left time: 2825.3713s
	iters: 200, epoch: 11 | loss: 2.4125748
	speed: 0.0344s/iter; left time: 636.5510s
Epoch: 11 cost time: 7.818323135375977
Epoch: 11, Steps: 208 | Train Loss: 2.102 Vali Loss: 7.069 Vali Acc: 0.108 Test Loss: 7.069 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.5807303
	speed: 0.1506s/iter; left time: 2773.1438s
	iters: 200, epoch: 12 | loss: 1.3052768
	speed: 0.0345s/iter; left time: 632.2563s
Epoch: 12 cost time: 7.832038164138794
Epoch: 12, Steps: 208 | Train Loss: 1.592 Vali Loss: 7.161 Vali Acc: 0.099 Test Loss: 7.161 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.1281296
	speed: 0.1498s/iter; left time: 2727.4815s
	iters: 200, epoch: 13 | loss: 1.8298211
	speed: 0.0349s/iter; left time: 631.5203s
Epoch: 13 cost time: 7.925297737121582
Epoch: 13, Steps: 208 | Train Loss: 1.214 Vali Loss: 7.116 Vali Acc: 0.117 Test Loss: 7.116 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.1450027
	speed: 0.1483s/iter; left time: 2669.6598s
	iters: 200, epoch: 14 | loss: 1.3462292
	speed: 0.0354s/iter; left time: 633.8811s
Epoch: 14 cost time: 8.009167194366455
Epoch: 14, Steps: 208 | Train Loss: 0.986 Vali Loss: 7.333 Vali Acc: 0.124 Test Loss: 7.333 Test Acc: 0.124
Validation loss decreased (-0.121933 --> -0.124293).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3873007
	speed: 0.1549s/iter; left time: 2755.7294s
	iters: 200, epoch: 15 | loss: 1.1625633
	speed: 0.0356s/iter; left time: 630.3804s
Epoch: 15 cost time: 8.144731044769287
Epoch: 15, Steps: 208 | Train Loss: 0.787 Vali Loss: 7.033 Vali Acc: 0.127 Test Loss: 7.033 Test Acc: 0.127
Validation loss decreased (-0.124293 --> -0.127278).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6228679
	speed: 0.1539s/iter; left time: 2706.4767s
	iters: 200, epoch: 16 | loss: 0.9333524
	speed: 0.0361s/iter; left time: 630.8389s
Epoch: 16 cost time: 8.282027244567871
Epoch: 16, Steps: 208 | Train Loss: 0.635 Vali Loss: 7.554 Vali Acc: 0.120 Test Loss: 7.554 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2814718
	speed: 0.1532s/iter; left time: 2661.9425s
	iters: 200, epoch: 17 | loss: 0.7546303
	speed: 0.0363s/iter; left time: 627.8094s
Epoch: 17 cost time: 8.135278224945068
Epoch: 17, Steps: 208 | Train Loss: 0.566 Vali Loss: 8.266 Vali Acc: 0.113 Test Loss: 8.266 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4263990
	speed: 0.1502s/iter; left time: 2577.9006s
	iters: 200, epoch: 18 | loss: 0.3150162
	speed: 0.0361s/iter; left time: 615.3357s
Epoch: 18 cost time: 7.949877023696899
Epoch: 18, Steps: 208 | Train Loss: 0.419 Vali Loss: 8.509 Vali Acc: 0.116 Test Loss: 8.509 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0809552
	speed: 0.1569s/iter; left time: 2660.9035s
	iters: 200, epoch: 19 | loss: 0.0500523
	speed: 0.0363s/iter; left time: 611.5104s
Epoch: 19 cost time: 8.113325834274292
Epoch: 19, Steps: 208 | Train Loss: 0.390 Vali Loss: 8.487 Vali Acc: 0.119 Test Loss: 8.487 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1057746
	speed: 0.1526s/iter; left time: 2555.1241s
	iters: 200, epoch: 20 | loss: 0.7938488
	speed: 0.0370s/iter; left time: 615.8850s
Epoch: 20 cost time: 8.14815878868103
Epoch: 20, Steps: 208 | Train Loss: 0.321 Vali Loss: 8.733 Vali Acc: 0.120 Test Loss: 8.733 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1751852
	speed: 0.1543s/iter; left time: 2551.7401s
	iters: 200, epoch: 21 | loss: 0.4698378
	speed: 0.0370s/iter; left time: 608.1335s
Epoch: 21 cost time: 8.168954610824585
Epoch: 21, Steps: 208 | Train Loss: 0.272 Vali Loss: 9.295 Vali Acc: 0.125 Test Loss: 9.295 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0402221
	speed: 0.1537s/iter; left time: 2510.8586s
	iters: 200, epoch: 22 | loss: 0.1075898
	speed: 0.0378s/iter; left time: 612.8691s
Epoch: 22 cost time: 8.141303300857544
Epoch: 22, Steps: 208 | Train Loss: 0.273 Vali Loss: 10.517 Vali Acc: 0.124 Test Loss: 10.517 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.2211809
	speed: 0.1515s/iter; left time: 2443.1340s
	iters: 200, epoch: 23 | loss: 0.4163447
	speed: 0.0374s/iter; left time: 599.1828s
Epoch: 23 cost time: 8.231324434280396
Epoch: 23, Steps: 208 | Train Loss: 0.261 Vali Loss: 10.028 Vali Acc: 0.121 Test Loss: 10.028 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1073595
	speed: 0.1372s/iter; left time: 2183.4600s
	iters: 200, epoch: 24 | loss: 0.3958841
	speed: 0.0330s/iter; left time: 521.4187s
Epoch: 24 cost time: 7.222911357879639
Epoch: 24, Steps: 208 | Train Loss: 0.199 Vali Loss: 10.564 Vali Acc: 0.127 Test Loss: 10.564 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0123803
	speed: 0.1381s/iter; left time: 2168.9725s
	iters: 200, epoch: 25 | loss: 0.1577862
	speed: 0.0335s/iter; left time: 522.5901s
Epoch: 25 cost time: 7.414840936660767
Epoch: 25, Steps: 208 | Train Loss: 0.183 Vali Loss: 10.420 Vali Acc: 0.121 Test Loss: 10.420 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12734864300626306
model parameter : 2111015
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.2072415
	speed: 0.0484s/iter; left time: 1001.5567s
	iters: 200, epoch: 1 | loss: 2.8543353
	speed: 0.0291s/iter; left time: 600.1171s
Epoch: 1 cost time: 8.089333772659302
Epoch: 1, Steps: 208 | Train Loss: 4.633 Vali Loss: 3.804 Vali Acc: 0.058 Test Loss: 3.804 Test Acc: 0.058
Validation loss decreased (inf --> -0.057821).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7430656
	speed: 0.1163s/iter; left time: 2382.3769s
	iters: 200, epoch: 2 | loss: 3.5334318
	speed: 0.0292s/iter; left time: 594.9421s
Epoch: 2 cost time: 6.34260892868042
Epoch: 2, Steps: 208 | Train Loss: 3.439 Vali Loss: 3.600 Vali Acc: 0.092 Test Loss: 3.600 Test Acc: 0.092
Validation loss decreased (-0.057821 --> -0.091822).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0834589
	speed: 0.1152s/iter; left time: 2336.6889s
	iters: 200, epoch: 3 | loss: 4.1855574
	speed: 0.0200s/iter; left time: 403.1315s
Epoch: 3 cost time: 4.97003436088562
Epoch: 3, Steps: 208 | Train Loss: 3.658 Vali Loss: 4.334 Vali Acc: 0.084 Test Loss: 4.334 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.6818762
	speed: 0.1134s/iter; left time: 2275.8694s
	iters: 200, epoch: 4 | loss: 4.2396946
	speed: 0.0252s/iter; left time: 504.0336s
Epoch: 4 cost time: 5.652159929275513
Epoch: 4, Steps: 208 | Train Loss: 3.807 Vali Loss: 4.213 Vali Acc: 0.107 Test Loss: 4.213 Test Acc: 0.107
Validation loss decreased (-0.091822 --> -0.107324).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0618119
	speed: 0.1159s/iter; left time: 2303.7271s
	iters: 200, epoch: 5 | loss: 4.6224093
	speed: 0.0251s/iter; left time: 496.6299s
Epoch: 5 cost time: 5.670639514923096
Epoch: 5, Steps: 208 | Train Loss: 3.907 Vali Loss: 4.498 Vali Acc: 0.109 Test Loss: 4.498 Test Acc: 0.109
Validation loss decreased (-0.107324 --> -0.108813).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3480258
	speed: 0.1255s/iter; left time: 2468.2536s
	iters: 200, epoch: 6 | loss: 2.8671117
	speed: 0.0245s/iter; left time: 480.0781s
Epoch: 6 cost time: 5.834306955337524
Epoch: 6, Steps: 208 | Train Loss: 3.914 Vali Loss: 5.256 Vali Acc: 0.088 Test Loss: 5.256 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.3544624
	speed: 0.1194s/iter; left time: 2322.5090s
	iters: 200, epoch: 7 | loss: 5.3194690
	speed: 0.0260s/iter; left time: 503.8390s
Epoch: 7 cost time: 5.975740194320679
Epoch: 7, Steps: 208 | Train Loss: 3.761 Vali Loss: 5.049 Vali Acc: 0.111 Test Loss: 5.049 Test Acc: 0.111
Validation loss decreased (-0.108813 --> -0.110895).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4378157
	speed: 0.1289s/iter; left time: 2480.7318s
	iters: 200, epoch: 8 | loss: 2.5209877
	speed: 0.0276s/iter; left time: 528.4403s
Epoch: 8 cost time: 6.211855888366699
Epoch: 8, Steps: 208 | Train Loss: 3.509 Vali Loss: 5.333 Vali Acc: 0.118 Test Loss: 5.333 Test Acc: 0.118
Validation loss decreased (-0.110895 --> -0.117752).  Saving model ...
	iters: 100, epoch: 9 | loss: 4.0675197
	speed: 0.1304s/iter; left time: 2481.6264s
	iters: 200, epoch: 9 | loss: 2.1342175
	speed: 0.0260s/iter; left time: 492.6911s
Epoch: 9 cost time: 6.047234058380127
Epoch: 9, Steps: 208 | Train Loss: 3.100 Vali Loss: 5.307 Vali Acc: 0.112 Test Loss: 5.307 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3753800
	speed: 0.1276s/iter; left time: 2403.0303s
	iters: 200, epoch: 10 | loss: 3.9096251
	speed: 0.0311s/iter; left time: 582.8757s
Epoch: 10 cost time: 7.077792406082153
Epoch: 10, Steps: 208 | Train Loss: 2.617 Vali Loss: 5.531 Vali Acc: 0.114 Test Loss: 5.531 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6555966
	speed: 0.1297s/iter; left time: 2414.6219s
	iters: 200, epoch: 11 | loss: 1.8141013
	speed: 0.0323s/iter; left time: 598.4412s
Epoch: 11 cost time: 6.826067686080933
Epoch: 11, Steps: 208 | Train Loss: 2.021 Vali Loss: 6.845 Vali Acc: 0.107 Test Loss: 6.845 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.6213515
	speed: 0.1266s/iter; left time: 2330.8952s
	iters: 200, epoch: 12 | loss: 2.1196482
	speed: 0.0301s/iter; left time: 551.8913s
Epoch: 12 cost time: 6.619165897369385
Epoch: 12, Steps: 208 | Train Loss: 1.600 Vali Loss: 6.265 Vali Acc: 0.103 Test Loss: 6.265 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.8659294
	speed: 0.1252s/iter; left time: 2279.3517s
	iters: 200, epoch: 13 | loss: 1.1696013
	speed: 0.0296s/iter; left time: 535.7974s
Epoch: 13 cost time: 6.743972301483154
Epoch: 13, Steps: 208 | Train Loss: 1.238 Vali Loss: 6.755 Vali Acc: 0.105 Test Loss: 6.755 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.4637444
	speed: 0.1230s/iter; left time: 2214.0738s
	iters: 200, epoch: 14 | loss: 1.3726480
	speed: 0.0311s/iter; left time: 557.3071s
Epoch: 14 cost time: 6.8938446044921875
Epoch: 14, Steps: 208 | Train Loss: 0.976 Vali Loss: 7.045 Vali Acc: 0.119 Test Loss: 7.045 Test Acc: 0.119
Validation loss decreased (-0.117752 --> -0.119226).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1428909
	speed: 0.1297s/iter; left time: 2307.8090s
	iters: 200, epoch: 15 | loss: 0.8904360
	speed: 0.0318s/iter; left time: 562.7141s
Epoch: 15 cost time: 6.9858269691467285
Epoch: 15, Steps: 208 | Train Loss: 0.763 Vali Loss: 7.272 Vali Acc: 0.123 Test Loss: 7.272 Test Acc: 0.123
Validation loss decreased (-0.119226 --> -0.122802).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2108054
	speed: 0.1254s/iter; left time: 2204.4407s
	iters: 200, epoch: 16 | loss: 0.7941280
	speed: 0.0313s/iter; left time: 547.4134s
Epoch: 16 cost time: 7.042412519454956
Epoch: 16, Steps: 208 | Train Loss: 0.653 Vali Loss: 8.157 Vali Acc: 0.112 Test Loss: 8.157 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2160383
	speed: 0.1265s/iter; left time: 2196.9895s
	iters: 200, epoch: 17 | loss: 0.7178299
	speed: 0.0319s/iter; left time: 550.5374s
Epoch: 17 cost time: 6.925230026245117
Epoch: 17, Steps: 208 | Train Loss: 0.482 Vali Loss: 8.467 Vali Acc: 0.121 Test Loss: 8.467 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4751919
	speed: 0.1301s/iter; left time: 2232.5983s
	iters: 200, epoch: 18 | loss: 0.6636183
	speed: 0.0286s/iter; left time: 488.7203s
Epoch: 18 cost time: 6.54484486579895
Epoch: 18, Steps: 208 | Train Loss: 0.433 Vali Loss: 8.433 Vali Acc: 0.108 Test Loss: 8.433 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0974871
	speed: 0.1270s/iter; left time: 2152.9312s
	iters: 200, epoch: 19 | loss: 0.2361887
	speed: 0.0293s/iter; left time: 494.4862s
Epoch: 19 cost time: 6.7009596824646
Epoch: 19, Steps: 208 | Train Loss: 0.368 Vali Loss: 9.112 Vali Acc: 0.115 Test Loss: 9.112 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4332305
	speed: 0.1244s/iter; left time: 2083.3290s
	iters: 200, epoch: 20 | loss: 0.5098058
	speed: 0.0318s/iter; left time: 529.7017s
Epoch: 20 cost time: 6.984321355819702
Epoch: 20, Steps: 208 | Train Loss: 0.343 Vali Loss: 9.368 Vali Acc: 0.123 Test Loss: 9.368 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2416250
	speed: 0.1261s/iter; left time: 2085.0642s
	iters: 200, epoch: 21 | loss: 0.0842836
	speed: 0.0317s/iter; left time: 520.9525s
Epoch: 21 cost time: 7.0372865200042725
Epoch: 21, Steps: 208 | Train Loss: 0.295 Vali Loss: 9.907 Vali Acc: 0.126 Test Loss: 9.907 Test Acc: 0.126
Validation loss decreased (-0.122802 --> -0.126355).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2656273
	speed: 0.1311s/iter; left time: 2140.5887s
	iters: 200, epoch: 22 | loss: 0.0780367
	speed: 0.0316s/iter; left time: 512.5026s
Epoch: 22 cost time: 7.05184006690979
Epoch: 22, Steps: 208 | Train Loss: 0.280 Vali Loss: 10.297 Vali Acc: 0.119 Test Loss: 10.297 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4570928
	speed: 0.1676s/iter; left time: 2702.7044s
	iters: 200, epoch: 23 | loss: 0.7736574
	speed: 0.0459s/iter; left time: 735.6808s
Epoch: 23 cost time: 9.981752395629883
Epoch: 23, Steps: 208 | Train Loss: 0.282 Vali Loss: 11.361 Vali Acc: 0.117 Test Loss: 11.361 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0325985
	speed: 0.1835s/iter; left time: 2921.0929s
	iters: 200, epoch: 24 | loss: 0.1588668
	speed: 0.0444s/iter; left time: 701.9969s
Epoch: 24 cost time: 9.740780115127563
Epoch: 24, Steps: 208 | Train Loss: 0.215 Vali Loss: 10.738 Vali Acc: 0.115 Test Loss: 10.738 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0899684
	speed: 0.1811s/iter; left time: 2845.3001s
	iters: 200, epoch: 25 | loss: 0.0473827
	speed: 0.0453s/iter; left time: 706.9400s
Epoch: 25 cost time: 10.09565782546997
Epoch: 25, Steps: 208 | Train Loss: 0.214 Vali Loss: 10.621 Vali Acc: 0.108 Test Loss: 10.621 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.2568502
	speed: 0.1614s/iter; left time: 2501.7609s
	iters: 200, epoch: 26 | loss: 0.0740647
	speed: 0.0322s/iter; left time: 496.3781s
Epoch: 26 cost time: 7.641006231307983
Epoch: 26, Steps: 208 | Train Loss: 0.253 Vali Loss: 11.197 Vali Acc: 0.117 Test Loss: 11.197 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1299034
	speed: 0.1644s/iter; left time: 2514.6746s
	iters: 200, epoch: 27 | loss: 0.0729138
	speed: 0.0338s/iter; left time: 513.3750s
Epoch: 27 cost time: 7.6154351234436035
Epoch: 27, Steps: 208 | Train Loss: 0.227 Vali Loss: 11.920 Vali Acc: 0.121 Test Loss: 11.920 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.1581486
	speed: 0.1492s/iter; left time: 2251.3356s
	iters: 200, epoch: 28 | loss: 0.0608593
	speed: 0.0298s/iter; left time: 446.2411s
Epoch: 28 cost time: 6.796602487564087
Epoch: 28, Steps: 208 | Train Loss: 0.200 Vali Loss: 11.133 Vali Acc: 0.110 Test Loss: 11.133 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0248333
	speed: 0.1623s/iter; left time: 2414.1965s
	iters: 200, epoch: 29 | loss: 0.0621317
	speed: 0.0293s/iter; left time: 432.3887s
Epoch: 29 cost time: 6.985016107559204
Epoch: 29, Steps: 208 | Train Loss: 0.210 Vali Loss: 11.920 Vali Acc: 0.114 Test Loss: 11.920 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0371270
	speed: 0.1598s/iter; left time: 2344.2372s
	iters: 200, epoch: 30 | loss: 0.1066943
	speed: 0.0334s/iter; left time: 486.9862s
Epoch: 30 cost time: 7.266538619995117
Epoch: 30, Steps: 208 | Train Loss: 0.199 Vali Loss: 11.244 Vali Acc: 0.110 Test Loss: 11.244 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0144265
	speed: 0.1712s/iter; left time: 2475.2865s
	iters: 200, epoch: 31 | loss: 0.0345480
	speed: 0.0406s/iter; left time: 582.7911s
Epoch: 31 cost time: 8.514583349227905
Epoch: 31, Steps: 208 | Train Loss: 0.177 Vali Loss: 11.713 Vali Acc: 0.121 Test Loss: 11.713 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12645392186101997
model parameter : 1452839
model size : 7.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9710224
	speed: 0.0538s/iter; left time: 1113.5834s
	iters: 200, epoch: 1 | loss: 3.7508447
	speed: 0.0302s/iter; left time: 622.9626s
Epoch: 1 cost time: 8.770314455032349
Epoch: 1, Steps: 208 | Train Loss: 4.496 Vali Loss: 3.837 Vali Acc: 0.061 Test Loss: 3.837 Test Acc: 0.061
Validation loss decreased (inf --> -0.061101).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9556582
	speed: 0.1475s/iter; left time: 3023.2076s
	iters: 200, epoch: 2 | loss: 4.1401639
	speed: 0.0254s/iter; left time: 518.1079s
Epoch: 2 cost time: 6.051181316375732
Epoch: 2, Steps: 208 | Train Loss: 3.465 Vali Loss: 3.433 Vali Acc: 0.100 Test Loss: 3.433 Test Acc: 0.100
Validation loss decreased (-0.061101 --> -0.099876).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4242473
	speed: 0.1499s/iter; left time: 3041.3607s
	iters: 200, epoch: 3 | loss: 3.3676269
	speed: 0.0277s/iter; left time: 559.6748s
Epoch: 3 cost time: 6.545013666152954
Epoch: 3, Steps: 208 | Train Loss: 3.518 Vali Loss: 3.720 Vali Acc: 0.099 Test Loss: 3.720 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.8121362
	speed: 0.1454s/iter; left time: 2919.8119s
	iters: 200, epoch: 4 | loss: 4.2915688
	speed: 0.0298s/iter; left time: 594.4141s
Epoch: 4 cost time: 6.637097120285034
Epoch: 4, Steps: 208 | Train Loss: 3.630 Vali Loss: 3.881 Vali Acc: 0.101 Test Loss: 3.881 Test Acc: 0.101
Validation loss decreased (-0.099876 --> -0.101363).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6088240
	speed: 0.1513s/iter; left time: 3006.8992s
	iters: 200, epoch: 5 | loss: 3.9781067
	speed: 0.0292s/iter; left time: 577.4614s
Epoch: 5 cost time: 6.871398687362671
Epoch: 5, Steps: 208 | Train Loss: 3.763 Vali Loss: 4.558 Vali Acc: 0.106 Test Loss: 4.558 Test Acc: 0.106
Validation loss decreased (-0.101363 --> -0.106426).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3989797
	speed: 0.1559s/iter; left time: 3064.9288s
	iters: 200, epoch: 6 | loss: 4.8861685
	speed: 0.0389s/iter; left time: 760.0350s
Epoch: 6 cost time: 7.78259801864624
Epoch: 6, Steps: 208 | Train Loss: 3.777 Vali Loss: 4.725 Vali Acc: 0.098 Test Loss: 4.725 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.8633542
	speed: 0.1709s/iter; left time: 3324.7451s
	iters: 200, epoch: 7 | loss: 4.0253401
	speed: 0.0418s/iter; left time: 808.4008s
Epoch: 7 cost time: 9.14902925491333
Epoch: 7, Steps: 208 | Train Loss: 3.656 Vali Loss: 5.300 Vali Acc: 0.098 Test Loss: 5.300 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.8432806
	speed: 0.1703s/iter; left time: 3277.1728s
	iters: 200, epoch: 8 | loss: 3.8820224
	speed: 0.0412s/iter; left time: 788.0472s
Epoch: 8 cost time: 9.386780977249146
Epoch: 8, Steps: 208 | Train Loss: 3.408 Vali Loss: 4.750 Vali Acc: 0.107 Test Loss: 4.750 Test Acc: 0.107
Validation loss decreased (-0.106426 --> -0.107021).  Saving model ...
	iters: 100, epoch: 9 | loss: 4.1778035
	speed: 0.1528s/iter; left time: 2908.8920s
	iters: 200, epoch: 9 | loss: 2.8027196
	speed: 0.0384s/iter; left time: 726.3422s
Epoch: 9 cost time: 8.332716703414917
Epoch: 9, Steps: 208 | Train Loss: 3.108 Vali Loss: 5.152 Vali Acc: 0.117 Test Loss: 5.152 Test Acc: 0.117
Validation loss decreased (-0.107021 --> -0.116560).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8280127
	speed: 0.1638s/iter; left time: 3083.5589s
	iters: 200, epoch: 10 | loss: 2.6737831
	speed: 0.0380s/iter; left time: 711.3279s
Epoch: 10 cost time: 8.48796010017395
Epoch: 10, Steps: 208 | Train Loss: 2.661 Vali Loss: 5.782 Vali Acc: 0.108 Test Loss: 5.782 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1017320
	speed: 0.1638s/iter; left time: 3050.6980s
	iters: 200, epoch: 11 | loss: 2.9757090
	speed: 0.0380s/iter; left time: 703.8992s
Epoch: 11 cost time: 8.363964796066284
Epoch: 11, Steps: 208 | Train Loss: 2.213 Vali Loss: 5.965 Vali Acc: 0.106 Test Loss: 5.965 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6867052
	speed: 0.1533s/iter; left time: 2821.9952s
	iters: 200, epoch: 12 | loss: 1.4963363
	speed: 0.0356s/iter; left time: 651.0793s
Epoch: 12 cost time: 7.804663896560669
Epoch: 12, Steps: 208 | Train Loss: 1.820 Vali Loss: 5.949 Vali Acc: 0.114 Test Loss: 5.949 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0271925
	speed: 0.1583s/iter; left time: 2881.5575s
	iters: 200, epoch: 13 | loss: 2.0708952
	speed: 0.0494s/iter; left time: 894.7058s
Epoch: 13 cost time: 9.490180492401123
Epoch: 13, Steps: 208 | Train Loss: 1.423 Vali Loss: 6.199 Vali Acc: 0.118 Test Loss: 6.199 Test Acc: 0.118
Validation loss decreased (-0.116560 --> -0.118339).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3060632
	speed: 0.1990s/iter; left time: 3580.7274s
	iters: 200, epoch: 14 | loss: 1.2340373
	speed: 0.0465s/iter; left time: 831.5344s
Epoch: 14 cost time: 10.797732591629028
Epoch: 14, Steps: 208 | Train Loss: 1.153 Vali Loss: 6.774 Vali Acc: 0.111 Test Loss: 6.774 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0708530
	speed: 0.1885s/iter; left time: 3353.9094s
	iters: 200, epoch: 15 | loss: 1.4014928
	speed: 0.0526s/iter; left time: 931.1346s
Epoch: 15 cost time: 11.466310977935791
Epoch: 15, Steps: 208 | Train Loss: 0.956 Vali Loss: 7.079 Vali Acc: 0.108 Test Loss: 7.079 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.1221695
	speed: 0.1897s/iter; left time: 3335.6369s
	iters: 200, epoch: 16 | loss: 0.9079534
	speed: 0.0446s/iter; left time: 779.3877s
Epoch: 16 cost time: 10.210567712783813
Epoch: 16, Steps: 208 | Train Loss: 0.775 Vali Loss: 7.042 Vali Acc: 0.118 Test Loss: 7.042 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.5830550
	speed: 0.1778s/iter; left time: 3088.0554s
	iters: 200, epoch: 17 | loss: 0.7450928
	speed: 0.0385s/iter; left time: 664.4199s
Epoch: 17 cost time: 8.613651275634766
Epoch: 17, Steps: 208 | Train Loss: 0.611 Vali Loss: 7.723 Vali Acc: 0.119 Test Loss: 7.723 Test Acc: 0.119
Validation loss decreased (-0.118339 --> -0.118622).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.9514894
	speed: 0.1824s/iter; left time: 3131.0864s
	iters: 200, epoch: 18 | loss: 0.7018835
	speed: 0.0435s/iter; left time: 742.3954s
Epoch: 18 cost time: 9.543328523635864
Epoch: 18, Steps: 208 | Train Loss: 0.512 Vali Loss: 8.394 Vali Acc: 0.115 Test Loss: 8.394 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5547158
	speed: 0.1734s/iter; left time: 2940.8968s
	iters: 200, epoch: 19 | loss: 0.2293526
	speed: 0.0447s/iter; left time: 753.9225s
Epoch: 19 cost time: 9.88341999053955
Epoch: 19, Steps: 208 | Train Loss: 0.430 Vali Loss: 8.161 Vali Acc: 0.116 Test Loss: 8.161 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.6072916
	speed: 0.1667s/iter; left time: 2791.3444s
	iters: 200, epoch: 20 | loss: 0.6329691
	speed: 0.0364s/iter; left time: 605.5772s
Epoch: 20 cost time: 8.069511890411377
Epoch: 20, Steps: 208 | Train Loss: 0.379 Vali Loss: 8.705 Vali Acc: 0.114 Test Loss: 8.705 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.3187769
	speed: 0.1809s/iter; left time: 2991.9542s
	iters: 200, epoch: 21 | loss: 0.2447559
	speed: 0.0514s/iter; left time: 844.7719s
Epoch: 21 cost time: 10.975345611572266
Epoch: 21, Steps: 208 | Train Loss: 0.329 Vali Loss: 8.641 Vali Acc: 0.119 Test Loss: 8.641 Test Acc: 0.119
Validation loss decreased (-0.118622 --> -0.118911).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2155672
	speed: 0.1860s/iter; left time: 3037.5459s
	iters: 200, epoch: 22 | loss: 0.5821706
	speed: 0.0503s/iter; left time: 816.9277s
Epoch: 22 cost time: 11.091017246246338
Epoch: 22, Steps: 208 | Train Loss: 0.333 Vali Loss: 9.984 Vali Acc: 0.117 Test Loss: 9.984 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2298738
	speed: 0.1781s/iter; left time: 2872.5166s
	iters: 200, epoch: 23 | loss: 0.4415196
	speed: 0.0391s/iter; left time: 626.4853s
Epoch: 23 cost time: 8.610193014144897
Epoch: 23, Steps: 208 | Train Loss: 0.269 Vali Loss: 10.010 Vali Acc: 0.122 Test Loss: 10.010 Test Acc: 0.122
Validation loss decreased (-0.118911 --> -0.122178).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0529773
	speed: 0.1799s/iter; left time: 2863.6828s
	iters: 200, epoch: 24 | loss: 0.2201320
	speed: 0.0345s/iter; left time: 544.9464s
Epoch: 24 cost time: 8.233707666397095
Epoch: 24, Steps: 208 | Train Loss: 0.302 Vali Loss: 9.697 Vali Acc: 0.119 Test Loss: 9.697 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.3268776
	speed: 0.1715s/iter; left time: 2693.8091s
	iters: 200, epoch: 25 | loss: 0.3051356
	speed: 0.0388s/iter; left time: 605.2639s
Epoch: 25 cost time: 8.552817583084106
Epoch: 25, Steps: 208 | Train Loss: 0.251 Vali Loss: 10.042 Vali Acc: 0.112 Test Loss: 10.042 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3263689
	speed: 0.1496s/iter; left time: 2318.3852s
	iters: 200, epoch: 26 | loss: 0.0628184
	speed: 0.0349s/iter; left time: 536.8563s
Epoch: 26 cost time: 7.066821813583374
Epoch: 26, Steps: 208 | Train Loss: 0.226 Vali Loss: 11.294 Vali Acc: 0.123 Test Loss: 11.294 Test Acc: 0.123
Validation loss decreased (-0.122178 --> -0.123359).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0353297
	speed: 0.1662s/iter; left time: 2540.9430s
	iters: 200, epoch: 27 | loss: 0.1905688
	speed: 0.0299s/iter; left time: 454.9296s
Epoch: 27 cost time: 6.640319347381592
Epoch: 27, Steps: 208 | Train Loss: 0.204 Vali Loss: 11.057 Vali Acc: 0.118 Test Loss: 11.057 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0166493
	speed: 0.1705s/iter; left time: 2571.7599s
	iters: 200, epoch: 28 | loss: 0.0337705
	speed: 0.0401s/iter; left time: 600.9328s
Epoch: 28 cost time: 8.80164361000061
Epoch: 28, Steps: 208 | Train Loss: 0.237 Vali Loss: 11.203 Vali Acc: 0.115 Test Loss: 11.203 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.1262045
	speed: 0.1806s/iter; left time: 2686.9950s
	iters: 200, epoch: 29 | loss: 0.4261530
	speed: 0.0478s/iter; left time: 706.9324s
Epoch: 29 cost time: 10.560516119003296
Epoch: 29, Steps: 208 | Train Loss: 0.226 Vali Loss: 10.926 Vali Acc: 0.120 Test Loss: 10.926 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.1559673
	speed: 0.1747s/iter; left time: 2563.3141s
	iters: 200, epoch: 30 | loss: 0.4006322
	speed: 0.0409s/iter; left time: 596.2549s
Epoch: 30 cost time: 8.866558313369751
Epoch: 30, Steps: 208 | Train Loss: 0.239 Vali Loss: 12.010 Vali Acc: 0.120 Test Loss: 12.010 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.3733876
	speed: 0.1879s/iter; left time: 2716.6966s
	iters: 200, epoch: 31 | loss: 0.0650658
	speed: 0.0465s/iter; left time: 667.8989s
Epoch: 31 cost time: 10.452469825744629
Epoch: 31, Steps: 208 | Train Loss: 0.216 Vali Loss: 12.347 Vali Acc: 0.112 Test Loss: 12.347 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0132833
	speed: 0.1647s/iter; left time: 2347.0304s
	iters: 200, epoch: 32 | loss: 0.0282318
	speed: 0.0368s/iter; left time: 520.4590s
Epoch: 32 cost time: 8.072605848312378
Epoch: 32, Steps: 208 | Train Loss: 0.192 Vali Loss: 11.433 Vali Acc: 0.121 Test Loss: 11.433 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0581333
	speed: 0.1484s/iter; left time: 2084.3890s
	iters: 200, epoch: 33 | loss: 0.3362742
	speed: 0.0373s/iter; left time: 520.1163s
Epoch: 33 cost time: 7.635389089584351
Epoch: 33, Steps: 208 | Train Loss: 0.171 Vali Loss: 11.667 Vali Acc: 0.116 Test Loss: 11.667 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0161255
	speed: 0.1677s/iter; left time: 2320.5885s
	iters: 200, epoch: 34 | loss: 0.2156526
	speed: 0.0319s/iter; left time: 438.2856s
Epoch: 34 cost time: 7.729948997497559
Epoch: 34, Steps: 208 | Train Loss: 0.198 Vali Loss: 12.530 Vali Acc: 0.118 Test Loss: 12.530 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0100652
	speed: 0.1671s/iter; left time: 2277.7653s
	iters: 200, epoch: 35 | loss: 1.0041553
	speed: 0.0386s/iter; left time: 522.7692s
Epoch: 35 cost time: 8.811676979064941
Epoch: 35, Steps: 208 | Train Loss: 0.193 Vali Loss: 12.539 Vali Acc: 0.115 Test Loss: 12.539 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.3553494
	speed: 0.1648s/iter; left time: 2212.2348s
	iters: 200, epoch: 36 | loss: 0.1113496
	speed: 0.0465s/iter; left time: 619.4756s
Epoch: 36 cost time: 9.328103303909302
Epoch: 36, Steps: 208 | Train Loss: 0.176 Vali Loss: 13.056 Vali Acc: 0.115 Test Loss: 13.056 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1234715180435431
model parameter : 1178919
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8314219
	speed: 0.0701s/iter; left time: 1451.5153s
	iters: 200, epoch: 1 | loss: 4.3825712
	speed: 0.0489s/iter; left time: 1006.8297s
Epoch: 1 cost time: 12.38442587852478
Epoch: 1, Steps: 208 | Train Loss: 4.284 Vali Loss: 4.363 Vali Acc: 0.060 Test Loss: 4.363 Test Acc: 0.060
Validation loss decreased (inf --> -0.059903).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9386475
	speed: 0.1741s/iter; left time: 3567.7274s
	iters: 200, epoch: 2 | loss: 2.8676825
	speed: 0.0424s/iter; left time: 864.0065s
Epoch: 2 cost time: 9.50382113456726
Epoch: 2, Steps: 208 | Train Loss: 3.578 Vali Loss: 3.590 Vali Acc: 0.078 Test Loss: 3.590 Test Acc: 0.078
Validation loss decreased (-0.059903 --> -0.078401).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2319703
	speed: 0.1726s/iter; left time: 3500.2121s
	iters: 200, epoch: 3 | loss: 3.4484758
	speed: 0.0340s/iter; left time: 685.5631s
Epoch: 3 cost time: 7.98912787437439
Epoch: 3, Steps: 208 | Train Loss: 3.317 Vali Loss: 4.134 Vali Acc: 0.087 Test Loss: 4.134 Test Acc: 0.087
Validation loss decreased (-0.078401 --> -0.087045).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.5819845
	speed: 0.1706s/iter; left time: 3426.0589s
	iters: 200, epoch: 4 | loss: 3.0130832
	speed: 0.0433s/iter; left time: 864.5930s
Epoch: 4 cost time: 9.518175840377808
Epoch: 4, Steps: 208 | Train Loss: 3.400 Vali Loss: 3.870 Vali Acc: 0.093 Test Loss: 3.870 Test Acc: 0.093
Validation loss decreased (-0.087045 --> -0.092714).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3351741
	speed: 0.1714s/iter; left time: 3405.1633s
	iters: 200, epoch: 5 | loss: 3.7827728
	speed: 0.0417s/iter; left time: 824.6484s
Epoch: 5 cost time: 8.917503118515015
Epoch: 5, Steps: 208 | Train Loss: 3.439 Vali Loss: 4.198 Vali Acc: 0.096 Test Loss: 4.198 Test Acc: 0.096
Validation loss decreased (-0.092714 --> -0.095991).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6959691
	speed: 0.1694s/iter; left time: 3331.4338s
	iters: 200, epoch: 6 | loss: 3.2485471
	speed: 0.0360s/iter; left time: 703.7395s
Epoch: 6 cost time: 8.028753995895386
Epoch: 6, Steps: 208 | Train Loss: 3.338 Vali Loss: 4.322 Vali Acc: 0.097 Test Loss: 4.322 Test Acc: 0.097
Validation loss decreased (-0.095991 --> -0.096587).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.6749728
	speed: 0.1761s/iter; left time: 3425.6987s
	iters: 200, epoch: 7 | loss: 3.6743145
	speed: 0.0472s/iter; left time: 914.4270s
Epoch: 7 cost time: 10.136001586914062
Epoch: 7, Steps: 208 | Train Loss: 3.310 Vali Loss: 4.490 Vali Acc: 0.096 Test Loss: 4.490 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2280972
	speed: 0.1750s/iter; left time: 3368.0935s
	iters: 200, epoch: 8 | loss: 4.0750446
	speed: 0.0499s/iter; left time: 955.9835s
Epoch: 8 cost time: 10.594082117080688
Epoch: 8, Steps: 208 | Train Loss: 3.133 Vali Loss: 4.558 Vali Acc: 0.090 Test Loss: 4.558 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.1482272
	speed: 0.1865s/iter; left time: 3550.4062s
	iters: 200, epoch: 9 | loss: 3.0833690
	speed: 0.0433s/iter; left time: 820.3453s
Epoch: 9 cost time: 9.567114353179932
Epoch: 9, Steps: 208 | Train Loss: 2.811 Vali Loss: 5.074 Vali Acc: 0.103 Test Loss: 5.074 Test Acc: 0.103
Validation loss decreased (-0.096587 --> -0.103439).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7550235
	speed: 0.1690s/iter; left time: 3182.7655s
	iters: 200, epoch: 10 | loss: 2.6598837
	speed: 0.0319s/iter; left time: 597.8458s
Epoch: 10 cost time: 7.941555976867676
Epoch: 10, Steps: 208 | Train Loss: 2.551 Vali Loss: 5.853 Vali Acc: 0.102 Test Loss: 5.853 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1600727
	speed: 0.1566s/iter; left time: 2915.7977s
	iters: 200, epoch: 11 | loss: 1.9037297
	speed: 0.0388s/iter; left time: 718.7511s
Epoch: 11 cost time: 8.395710945129395
Epoch: 11, Steps: 208 | Train Loss: 2.187 Vali Loss: 6.152 Vali Acc: 0.107 Test Loss: 6.152 Test Acc: 0.107
Validation loss decreased (-0.103439 --> -0.107305).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3210030
	speed: 0.1678s/iter; left time: 3089.9085s
	iters: 200, epoch: 12 | loss: 1.9172719
	speed: 0.0382s/iter; left time: 699.1501s
Epoch: 12 cost time: 8.518949508666992
Epoch: 12, Steps: 208 | Train Loss: 1.894 Vali Loss: 5.643 Vali Acc: 0.107 Test Loss: 5.643 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.0673556
	speed: 0.1667s/iter; left time: 3034.1100s
	iters: 200, epoch: 13 | loss: 2.2749681
	speed: 0.0350s/iter; left time: 634.1923s
Epoch: 13 cost time: 7.857845783233643
Epoch: 13, Steps: 208 | Train Loss: 1.584 Vali Loss: 6.433 Vali Acc: 0.103 Test Loss: 6.433 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1366543
	speed: 0.1657s/iter; left time: 2981.3302s
	iters: 200, epoch: 14 | loss: 1.8618208
	speed: 0.0371s/iter; left time: 663.2413s
Epoch: 14 cost time: 8.429872274398804
Epoch: 14, Steps: 208 | Train Loss: 1.261 Vali Loss: 6.499 Vali Acc: 0.102 Test Loss: 6.499 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7224600
	speed: 0.1765s/iter; left time: 3140.0620s
	iters: 200, epoch: 15 | loss: 1.4814792
	speed: 0.0448s/iter; left time: 792.9300s
Epoch: 15 cost time: 9.857717990875244
Epoch: 15, Steps: 208 | Train Loss: 1.055 Vali Loss: 6.561 Vali Acc: 0.106 Test Loss: 6.561 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5998784
	speed: 0.1690s/iter; left time: 2971.9324s
	iters: 200, epoch: 16 | loss: 0.8999556
	speed: 0.0377s/iter; left time: 658.9661s
Epoch: 16 cost time: 8.136651277542114
Epoch: 16, Steps: 208 | Train Loss: 0.839 Vali Loss: 7.242 Vali Acc: 0.100 Test Loss: 7.242 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3417166
	speed: 0.1767s/iter; left time: 3069.7718s
	iters: 200, epoch: 17 | loss: 1.0336007
	speed: 0.0346s/iter; left time: 597.2809s
Epoch: 17 cost time: 8.563677787780762
Epoch: 17, Steps: 208 | Train Loss: 0.703 Vali Loss: 7.656 Vali Acc: 0.103 Test Loss: 7.656 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3247260
	speed: 0.1702s/iter; left time: 2921.6320s
	iters: 200, epoch: 18 | loss: 0.5453550
	speed: 0.0309s/iter; left time: 527.6729s
Epoch: 18 cost time: 7.519516229629517
Epoch: 18, Steps: 208 | Train Loss: 0.610 Vali Loss: 8.657 Vali Acc: 0.106 Test Loss: 8.657 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1822393
	speed: 0.1405s/iter; left time: 2383.0618s
	iters: 200, epoch: 19 | loss: 1.3257252
	speed: 0.0320s/iter; left time: 538.9581s
Epoch: 19 cost time: 6.867781639099121
Epoch: 19, Steps: 208 | Train Loss: 0.540 Vali Loss: 8.655 Vali Acc: 0.106 Test Loss: 8.655 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.2845069
	speed: 0.1437s/iter; left time: 2407.5064s
	iters: 200, epoch: 20 | loss: 0.1669444
	speed: 0.0280s/iter; left time: 466.5925s
Epoch: 20 cost time: 6.381127119064331
Epoch: 20, Steps: 208 | Train Loss: 0.448 Vali Loss: 8.857 Vali Acc: 0.103 Test Loss: 8.857 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4316103
	speed: 0.1537s/iter; left time: 2542.6785s
	iters: 200, epoch: 21 | loss: 1.5067039
	speed: 0.0281s/iter; left time: 462.0261s
Epoch: 21 cost time: 6.751808404922485
Epoch: 21, Steps: 208 | Train Loss: 0.402 Vali Loss: 9.366 Vali Acc: 0.112 Test Loss: 9.366 Test Acc: 0.112
Validation loss decreased (-0.107305 --> -0.111448).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1724515
	speed: 0.1570s/iter; left time: 2563.4945s
	iters: 200, epoch: 22 | loss: 0.2134728
	speed: 0.0330s/iter; left time: 536.4612s
Epoch: 22 cost time: 7.543530702590942
Epoch: 22, Steps: 208 | Train Loss: 0.378 Vali Loss: 9.987 Vali Acc: 0.105 Test Loss: 9.987 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1314211
	speed: 0.1562s/iter; left time: 2519.2696s
	iters: 200, epoch: 23 | loss: 0.3672695
	speed: 0.0393s/iter; left time: 630.4383s
Epoch: 23 cost time: 8.50093150138855
Epoch: 23, Steps: 208 | Train Loss: 0.364 Vali Loss: 9.770 Vali Acc: 0.104 Test Loss: 9.770 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.4113245
	speed: 0.1660s/iter; left time: 2642.6679s
	iters: 200, epoch: 24 | loss: 0.2885452
	speed: 0.0332s/iter; left time: 525.7365s
Epoch: 24 cost time: 7.462662696838379
Epoch: 24, Steps: 208 | Train Loss: 0.292 Vali Loss: 10.260 Vali Acc: 0.107 Test Loss: 10.260 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0908293
	speed: 0.1713s/iter; left time: 2690.5269s
	iters: 200, epoch: 25 | loss: 0.4204661
	speed: 0.0388s/iter; left time: 604.9783s
Epoch: 25 cost time: 8.621876955032349
Epoch: 25, Steps: 208 | Train Loss: 0.271 Vali Loss: 10.770 Vali Acc: 0.096 Test Loss: 10.770 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.9663690
	speed: 0.1550s/iter; left time: 2403.3419s
	iters: 200, epoch: 26 | loss: 0.2123584
	speed: 0.0277s/iter; left time: 426.7352s
Epoch: 26 cost time: 6.5469372272491455
Epoch: 26, Steps: 208 | Train Loss: 0.288 Vali Loss: 10.974 Vali Acc: 0.103 Test Loss: 10.974 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0084597
	speed: 0.1566s/iter; left time: 2395.3178s
	iters: 200, epoch: 27 | loss: 0.2108171
	speed: 0.0273s/iter; left time: 414.1783s
Epoch: 27 cost time: 6.454410791397095
Epoch: 27, Steps: 208 | Train Loss: 0.281 Vali Loss: 10.803 Vali Acc: 0.101 Test Loss: 10.803 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.5640455
	speed: 0.1565s/iter; left time: 2361.2194s
	iters: 200, epoch: 28 | loss: 0.1441254
	speed: 0.0258s/iter; left time: 387.0125s
Epoch: 28 cost time: 6.126109838485718
Epoch: 28, Steps: 208 | Train Loss: 0.263 Vali Loss: 11.202 Vali Acc: 0.107 Test Loss: 11.202 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0781465
	speed: 0.1585s/iter; left time: 2357.3990s
	iters: 200, epoch: 29 | loss: 0.1400604
	speed: 0.0229s/iter; left time: 338.2695s
Epoch: 29 cost time: 6.27392840385437
Epoch: 29, Steps: 208 | Train Loss: 0.248 Vali Loss: 11.433 Vali Acc: 0.098 Test Loss: 11.433 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.2814311
	speed: 0.1717s/iter; left time: 2518.6966s
	iters: 200, epoch: 30 | loss: 0.1705256
	speed: 0.0371s/iter; left time: 540.5849s
Epoch: 30 cost time: 8.290381908416748
Epoch: 30, Steps: 208 | Train Loss: 0.218 Vali Loss: 12.290 Vali Acc: 0.100 Test Loss: 12.290 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.7074639
	speed: 0.1698s/iter; left time: 2455.0054s
	iters: 200, epoch: 31 | loss: 0.5492274
	speed: 0.0424s/iter; left time: 609.3894s
Epoch: 31 cost time: 9.154125928878784
Epoch: 31, Steps: 208 | Train Loss: 0.242 Vali Loss: 12.260 Vali Acc: 0.097 Test Loss: 12.260 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11154190277363556
model parameter : 795943
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1388531
	speed: 0.0619s/iter; left time: 1281.1923s
	iters: 200, epoch: 1 | loss: 4.4132056
	speed: 0.0453s/iter; left time: 932.7086s
Epoch: 1 cost time: 11.169921875
Epoch: 1, Steps: 208 | Train Loss: 4.113 Vali Loss: 4.428 Vali Acc: 0.050 Test Loss: 4.428 Test Acc: 0.050
Validation loss decreased (inf --> -0.050060).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5662892
	speed: 0.1687s/iter; left time: 3456.7997s
	iters: 200, epoch: 2 | loss: 4.1491966
	speed: 0.0368s/iter; left time: 751.0218s
Epoch: 2 cost time: 8.176455974578857
Epoch: 2, Steps: 208 | Train Loss: 3.649 Vali Loss: 3.654 Vali Acc: 0.063 Test Loss: 3.654 Test Acc: 0.063
Validation loss decreased (-0.050060 --> -0.062594).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0883133
	speed: 0.1681s/iter; left time: 3410.5464s
	iters: 200, epoch: 3 | loss: 3.3256505
	speed: 0.0363s/iter; left time: 733.0836s
Epoch: 3 cost time: 8.366617202758789
Epoch: 3, Steps: 208 | Train Loss: 3.326 Vali Loss: 3.804 Vali Acc: 0.070 Test Loss: 3.804 Test Acc: 0.070
Validation loss decreased (-0.062594 --> -0.070048).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2043576
	speed: 0.1709s/iter; left time: 3430.9180s
	iters: 200, epoch: 4 | loss: 4.0743957
	speed: 0.0396s/iter; left time: 790.2304s
Epoch: 4 cost time: 8.737046480178833
Epoch: 4, Steps: 208 | Train Loss: 3.272 Vali Loss: 3.713 Vali Acc: 0.095 Test Loss: 3.713 Test Acc: 0.095
Validation loss decreased (-0.070048 --> -0.094505).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1217852
	speed: 0.1664s/iter; left time: 3306.9039s
	iters: 200, epoch: 5 | loss: 3.6553760
	speed: 0.0360s/iter; left time: 712.0270s
Epoch: 5 cost time: 8.016553163528442
Epoch: 5, Steps: 208 | Train Loss: 3.322 Vali Loss: 4.131 Vali Acc: 0.087 Test Loss: 4.131 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.5195220
	speed: 0.1611s/iter; left time: 3166.7063s
	iters: 200, epoch: 6 | loss: 3.6391172
	speed: 0.0343s/iter; left time: 671.8523s
Epoch: 6 cost time: 7.726682424545288
Epoch: 6, Steps: 208 | Train Loss: 3.322 Vali Loss: 4.104 Vali Acc: 0.101 Test Loss: 4.104 Test Acc: 0.101
Validation loss decreased (-0.094505 --> -0.100764).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1412151
	speed: 0.1757s/iter; left time: 3417.3686s
	iters: 200, epoch: 7 | loss: 4.2856793
	speed: 0.0437s/iter; left time: 844.7985s
Epoch: 7 cost time: 9.610178709030151
Epoch: 7, Steps: 208 | Train Loss: 3.197 Vali Loss: 3.915 Vali Acc: 0.104 Test Loss: 3.915 Test Acc: 0.104
Validation loss decreased (-0.100764 --> -0.104345).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2160945
	speed: 0.1771s/iter; left time: 3407.5987s
	iters: 200, epoch: 8 | loss: 3.0715892
	speed: 0.0452s/iter; left time: 864.4924s
Epoch: 8 cost time: 9.74693775177002
Epoch: 8, Steps: 208 | Train Loss: 3.062 Vali Loss: 4.734 Vali Acc: 0.106 Test Loss: 4.734 Test Acc: 0.106
Validation loss decreased (-0.104345 --> -0.106424).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1987591
	speed: 0.1821s/iter; left time: 3466.3671s
	iters: 200, epoch: 9 | loss: 3.1244419
	speed: 0.0429s/iter; left time: 812.6504s
Epoch: 9 cost time: 9.474757194519043
Epoch: 9, Steps: 208 | Train Loss: 2.894 Vali Loss: 5.152 Vali Acc: 0.101 Test Loss: 5.152 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.4619000
	speed: 0.1651s/iter; left time: 3108.7342s
	iters: 200, epoch: 10 | loss: 2.6178770
	speed: 0.0381s/iter; left time: 714.0158s
Epoch: 10 cost time: 8.269917249679565
Epoch: 10, Steps: 208 | Train Loss: 2.515 Vali Loss: 4.868 Vali Acc: 0.104 Test Loss: 4.868 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9865990
	speed: 0.1944s/iter; left time: 3620.6285s
	iters: 200, epoch: 11 | loss: 2.5213752
	speed: 0.0494s/iter; left time: 914.1557s
Epoch: 11 cost time: 10.730712890625
Epoch: 11, Steps: 208 | Train Loss: 2.274 Vali Loss: 5.307 Vali Acc: 0.103 Test Loss: 5.307 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.1843364
	speed: 0.1969s/iter; left time: 3626.0012s
	iters: 200, epoch: 12 | loss: 1.5119641
	speed: 0.0463s/iter; left time: 848.3201s
Epoch: 12 cost time: 10.12033200263977
Epoch: 12, Steps: 208 | Train Loss: 1.933 Vali Loss: 5.485 Vali Acc: 0.098 Test Loss: 5.485 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.7704706
	speed: 0.1857s/iter; left time: 3380.7228s
	iters: 200, epoch: 13 | loss: 2.3219528
	speed: 0.0387s/iter; left time: 699.9316s
Epoch: 13 cost time: 8.716456651687622
Epoch: 13, Steps: 208 | Train Loss: 1.694 Vali Loss: 6.281 Vali Acc: 0.101 Test Loss: 6.281 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3822047
	speed: 0.1917s/iter; left time: 3450.0029s
	iters: 200, epoch: 14 | loss: 0.9186730
	speed: 0.0405s/iter; left time: 724.5946s
Epoch: 14 cost time: 9.43597960472107
Epoch: 14, Steps: 208 | Train Loss: 1.381 Vali Loss: 6.343 Vali Acc: 0.105 Test Loss: 6.343 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.8609906
	speed: 0.1931s/iter; left time: 3435.2170s
	iters: 200, epoch: 15 | loss: 1.9882144
	speed: 0.0448s/iter; left time: 792.9534s
Epoch: 15 cost time: 10.034062623977661
Epoch: 15, Steps: 208 | Train Loss: 1.147 Vali Loss: 6.600 Vali Acc: 0.111 Test Loss: 6.600 Test Acc: 0.111
Validation loss decreased (-0.106424 --> -0.110581).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3353750
	speed: 0.2074s/iter; left time: 3646.6440s
	iters: 200, epoch: 16 | loss: 0.4246075
	speed: 0.0455s/iter; left time: 795.0733s
Epoch: 16 cost time: 10.695567607879639
Epoch: 16, Steps: 208 | Train Loss: 0.928 Vali Loss: 7.104 Vali Acc: 0.105 Test Loss: 7.104 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7457306
	speed: 0.1979s/iter; left time: 3438.9785s
	iters: 200, epoch: 17 | loss: 0.8735892
	speed: 0.0364s/iter; left time: 629.5980s
Epoch: 17 cost time: 8.573184728622437
Epoch: 17, Steps: 208 | Train Loss: 0.797 Vali Loss: 7.465 Vali Acc: 0.107 Test Loss: 7.465 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.1551275
	speed: 0.1580s/iter; left time: 2712.3553s
	iters: 200, epoch: 18 | loss: 0.5787632
	speed: 0.0354s/iter; left time: 604.1310s
Epoch: 18 cost time: 8.038819313049316
Epoch: 18, Steps: 208 | Train Loss: 0.643 Vali Loss: 7.992 Vali Acc: 0.112 Test Loss: 7.992 Test Acc: 0.112
Validation loss decreased (-0.110581 --> -0.112357).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4644713
	speed: 0.1713s/iter; left time: 2904.4396s
	iters: 200, epoch: 19 | loss: 0.6121650
	speed: 0.0339s/iter; left time: 570.6816s
Epoch: 19 cost time: 7.720582008361816
Epoch: 19, Steps: 208 | Train Loss: 0.575 Vali Loss: 7.943 Vali Acc: 0.110 Test Loss: 7.943 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.4652427
	speed: 0.1699s/iter; left time: 2845.6849s
	iters: 200, epoch: 20 | loss: 0.5877115
	speed: 0.0396s/iter; left time: 659.5814s
Epoch: 20 cost time: 8.619876384735107
Epoch: 20, Steps: 208 | Train Loss: 0.489 Vali Loss: 8.496 Vali Acc: 0.101 Test Loss: 8.496 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.3471176
	speed: 0.1806s/iter; left time: 2986.5592s
	iters: 200, epoch: 21 | loss: 0.2711577
	speed: 0.0388s/iter; left time: 637.7535s
Epoch: 21 cost time: 8.47897481918335
Epoch: 21, Steps: 208 | Train Loss: 0.398 Vali Loss: 9.198 Vali Acc: 0.110 Test Loss: 9.198 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.6118241
	speed: 0.1752s/iter; left time: 2861.2167s
	iters: 200, epoch: 22 | loss: 0.1728556
	speed: 0.0334s/iter; left time: 541.9142s
Epoch: 22 cost time: 7.816369533538818
Epoch: 22, Steps: 208 | Train Loss: 0.381 Vali Loss: 9.492 Vali Acc: 0.101 Test Loss: 9.492 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.6300954
	speed: 0.2007s/iter; left time: 3236.3799s
	iters: 200, epoch: 23 | loss: 0.5248428
	speed: 0.0482s/iter; left time: 773.0721s
Epoch: 23 cost time: 10.692673206329346
Epoch: 23, Steps: 208 | Train Loss: 0.344 Vali Loss: 10.055 Vali Acc: 0.099 Test Loss: 10.055 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.4562982
	speed: 0.2056s/iter; left time: 3272.1898s
	iters: 200, epoch: 24 | loss: 0.2123283
	speed: 0.0499s/iter; left time: 789.0668s
Epoch: 24 cost time: 10.959989070892334
Epoch: 24, Steps: 208 | Train Loss: 0.341 Vali Loss: 10.118 Vali Acc: 0.100 Test Loss: 10.118 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6380985
	speed: 0.1725s/iter; left time: 2709.4374s
	iters: 200, epoch: 25 | loss: 0.4365344
	speed: 0.0360s/iter; left time: 561.8944s
Epoch: 25 cost time: 7.759980916976929
Epoch: 25, Steps: 208 | Train Loss: 0.345 Vali Loss: 10.099 Vali Acc: 0.112 Test Loss: 10.099 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0372311
	speed: 0.1726s/iter; left time: 2675.6317s
	iters: 200, epoch: 26 | loss: 0.0281772
	speed: 0.0219s/iter; left time: 337.9257s
Epoch: 26 cost time: 6.788036823272705
Epoch: 26, Steps: 208 | Train Loss: 0.293 Vali Loss: 10.787 Vali Acc: 0.104 Test Loss: 10.787 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.2785041
	speed: 0.1965s/iter; left time: 3005.2693s
	iters: 200, epoch: 27 | loss: 0.3205941
	speed: 0.0510s/iter; left time: 774.4744s
Epoch: 27 cost time: 10.683236122131348
Epoch: 27, Steps: 208 | Train Loss: 0.299 Vali Loss: 10.963 Vali Acc: 0.101 Test Loss: 10.963 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.1126958
	speed: 0.1969s/iter; left time: 2970.1649s
	iters: 200, epoch: 28 | loss: 1.1927886
	speed: 0.0514s/iter; left time: 770.5060s
Epoch: 28 cost time: 10.797147035598755
Epoch: 28, Steps: 208 | Train Loss: 0.268 Vali Loss: 11.566 Vali Acc: 0.099 Test Loss: 11.566 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11243662391887861
model parameter : 632615
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0884571
	speed: 0.0702s/iter; left time: 1454.0116s
	iters: 200, epoch: 1 | loss: 3.8876114
	speed: 0.0467s/iter; left time: 961.6552s
Epoch: 1 cost time: 12.312110185623169
Epoch: 1, Steps: 208 | Train Loss: 3.996 Vali Loss: 4.289 Vali Acc: 0.051 Test Loss: 4.289 Test Acc: 0.051
Validation loss decreased (inf --> -0.050658).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0509691
	speed: 0.2031s/iter; left time: 4162.7705s
	iters: 200, epoch: 2 | loss: 3.9103732
	speed: 0.0531s/iter; left time: 1082.8786s
Epoch: 2 cost time: 11.682490587234497
Epoch: 2, Steps: 208 | Train Loss: 3.737 Vali Loss: 3.835 Vali Acc: 0.055 Test Loss: 3.835 Test Acc: 0.055
Validation loss decreased (-0.050658 --> -0.055136).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3469968
	speed: 0.2234s/iter; left time: 4532.2446s
	iters: 200, epoch: 3 | loss: 3.5665665
	speed: 0.0504s/iter; left time: 1018.1364s
Epoch: 3 cost time: 11.312788963317871
Epoch: 3, Steps: 208 | Train Loss: 3.334 Vali Loss: 3.629 Vali Acc: 0.089 Test Loss: 3.629 Test Acc: 0.089
Validation loss decreased (-0.055136 --> -0.089138).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1404438
	speed: 0.1998s/iter; left time: 4010.5510s
	iters: 200, epoch: 4 | loss: 3.2290428
	speed: 0.0417s/iter; left time: 832.5550s
Epoch: 4 cost time: 9.535229444503784
Epoch: 4, Steps: 208 | Train Loss: 3.229 Vali Loss: 3.810 Vali Acc: 0.080 Test Loss: 3.810 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.1219008
	speed: 0.1937s/iter; left time: 3849.5213s
	iters: 200, epoch: 5 | loss: 3.6268241
	speed: 0.0479s/iter; left time: 946.1616s
Epoch: 5 cost time: 10.114283561706543
Epoch: 5, Steps: 208 | Train Loss: 3.165 Vali Loss: 4.039 Vali Acc: 0.091 Test Loss: 4.039 Test Acc: 0.091
Validation loss decreased (-0.089138 --> -0.090923).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1410668
	speed: 0.2007s/iter; left time: 3946.7807s
	iters: 200, epoch: 6 | loss: 2.9277356
	speed: 0.0444s/iter; left time: 868.3535s
Epoch: 6 cost time: 9.746621131896973
Epoch: 6, Steps: 208 | Train Loss: 3.144 Vali Loss: 4.187 Vali Acc: 0.094 Test Loss: 4.187 Test Acc: 0.094
Validation loss decreased (-0.090923 --> -0.093904).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.7289515
	speed: 0.1969s/iter; left time: 3829.3460s
	iters: 200, epoch: 7 | loss: 3.5903370
	speed: 0.0437s/iter; left time: 846.5154s
Epoch: 7 cost time: 9.710088729858398
Epoch: 7, Steps: 208 | Train Loss: 3.023 Vali Loss: 4.576 Vali Acc: 0.089 Test Loss: 4.576 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4242816
	speed: 0.1935s/iter; left time: 3723.4916s
	iters: 200, epoch: 8 | loss: 3.4487863
	speed: 0.0468s/iter; left time: 896.7414s
Epoch: 8 cost time: 10.10003113746643
Epoch: 8, Steps: 208 | Train Loss: 2.874 Vali Loss: 4.762 Vali Acc: 0.095 Test Loss: 4.762 Test Acc: 0.095
Validation loss decreased (-0.093904 --> -0.095091).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0510824
	speed: 0.1906s/iter; left time: 3627.5458s
	iters: 200, epoch: 9 | loss: 3.6356215
	speed: 0.0482s/iter; left time: 912.6537s
Epoch: 9 cost time: 9.781111001968384
Epoch: 9, Steps: 208 | Train Loss: 2.702 Vali Loss: 4.961 Vali Acc: 0.103 Test Loss: 4.961 Test Acc: 0.103
Validation loss decreased (-0.095091 --> -0.103440).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9291354
	speed: 0.2186s/iter; left time: 4115.3128s
	iters: 200, epoch: 10 | loss: 2.6045442
	speed: 0.0549s/iter; left time: 1027.7024s
Epoch: 10 cost time: 12.01499605178833
Epoch: 10, Steps: 208 | Train Loss: 2.481 Vali Loss: 5.350 Vali Acc: 0.094 Test Loss: 5.350 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2024248
	speed: 0.2034s/iter; left time: 3786.9408s
	iters: 200, epoch: 11 | loss: 2.2880659
	speed: 0.0455s/iter; left time: 842.7826s
Epoch: 11 cost time: 9.871545791625977
Epoch: 11, Steps: 208 | Train Loss: 2.229 Vali Loss: 5.683 Vali Acc: 0.105 Test Loss: 5.683 Test Acc: 0.105
Validation loss decreased (-0.103440 --> -0.104924).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1775090
	speed: 0.2082s/iter; left time: 3834.2433s
	iters: 200, epoch: 12 | loss: 1.5076531
	speed: 0.0480s/iter; left time: 878.2329s
Epoch: 12 cost time: 10.4258291721344
Epoch: 12, Steps: 208 | Train Loss: 1.950 Vali Loss: 5.785 Vali Acc: 0.115 Test Loss: 5.785 Test Acc: 0.115
Validation loss decreased (-0.104924 --> -0.114466).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5540355
	speed: 0.1959s/iter; left time: 3566.8065s
	iters: 200, epoch: 13 | loss: 1.9699461
	speed: 0.0482s/iter; left time: 872.6303s
Epoch: 13 cost time: 10.14426326751709
Epoch: 13, Steps: 208 | Train Loss: 1.718 Vali Loss: 6.984 Vali Acc: 0.104 Test Loss: 6.984 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3326491
	speed: 0.1736s/iter; left time: 3123.9678s
	iters: 200, epoch: 14 | loss: 2.4911025
	speed: 0.0422s/iter; left time: 754.9603s
Epoch: 14 cost time: 8.637201309204102
Epoch: 14, Steps: 208 | Train Loss: 1.461 Vali Loss: 6.584 Vali Acc: 0.110 Test Loss: 6.584 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.8748978
	speed: 0.1789s/iter; left time: 3182.6625s
	iters: 200, epoch: 15 | loss: 1.3153826
	speed: 0.0372s/iter; left time: 658.7690s
Epoch: 15 cost time: 8.361572980880737
Epoch: 15, Steps: 208 | Train Loss: 1.260 Vali Loss: 7.057 Vali Acc: 0.101 Test Loss: 7.057 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3027422
	speed: 0.1858s/iter; left time: 3266.0794s
	iters: 200, epoch: 16 | loss: 1.1725975
	speed: 0.0393s/iter; left time: 686.9030s
Epoch: 16 cost time: 9.294404745101929
Epoch: 16, Steps: 208 | Train Loss: 1.035 Vali Loss: 7.462 Vali Acc: 0.105 Test Loss: 7.462 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0943696
	speed: 0.1839s/iter; left time: 3195.2072s
	iters: 200, epoch: 17 | loss: 0.6434157
	speed: 0.0467s/iter; left time: 805.8551s
Epoch: 17 cost time: 9.774594783782959
Epoch: 17, Steps: 208 | Train Loss: 0.924 Vali Loss: 7.554 Vali Acc: 0.106 Test Loss: 7.554 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2613541
	speed: 0.1966s/iter; left time: 3374.0758s
	iters: 200, epoch: 18 | loss: 1.0769067
	speed: 0.0476s/iter; left time: 811.9491s
Epoch: 18 cost time: 9.966119289398193
Epoch: 18, Steps: 208 | Train Loss: 0.751 Vali Loss: 7.753 Vali Acc: 0.101 Test Loss: 7.753 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.8903841
	speed: 0.2009s/iter; left time: 3407.1654s
	iters: 200, epoch: 19 | loss: 0.9925030
	speed: 0.0432s/iter; left time: 727.8718s
Epoch: 19 cost time: 9.827659845352173
Epoch: 19, Steps: 208 | Train Loss: 0.643 Vali Loss: 7.766 Vali Acc: 0.114 Test Loss: 7.766 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.4210864
	speed: 0.1768s/iter; left time: 2961.5787s
	iters: 200, epoch: 20 | loss: 0.6476455
	speed: 0.0277s/iter; left time: 460.6220s
Epoch: 20 cost time: 6.572854518890381
Epoch: 20, Steps: 208 | Train Loss: 0.545 Vali Loss: 8.438 Vali Acc: 0.107 Test Loss: 8.438 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3922215
	speed: 0.1538s/iter; left time: 2543.8897s
	iters: 200, epoch: 21 | loss: 0.6372352
	speed: 0.0323s/iter; left time: 531.4155s
Epoch: 21 cost time: 6.444674253463745
Epoch: 21, Steps: 208 | Train Loss: 0.477 Vali Loss: 8.138 Vali Acc: 0.103 Test Loss: 8.138 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.4228824
	speed: 0.1728s/iter; left time: 2822.1756s
	iters: 200, epoch: 22 | loss: 0.9275189
	speed: 0.0368s/iter; left time: 597.7643s
Epoch: 22 cost time: 8.274761199951172
Epoch: 22, Steps: 208 | Train Loss: 0.420 Vali Loss: 9.605 Vali Acc: 0.103 Test Loss: 9.605 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11452430659111244
model parameter : 524199
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.0934868
	speed: 0.0956s/iter; left time: 1978.8530s
	iters: 200, epoch: 1 | loss: 3.7872269
	speed: 0.0689s/iter; left time: 1420.0963s
Epoch: 1 cost time: 17.13252568244934
Epoch: 1, Steps: 208 | Train Loss: 5.808 Vali Loss: 3.605 Vali Acc: 0.069 Test Loss: 3.605 Test Acc: 0.069
Validation loss decreased (inf --> -0.068559).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6913595
	speed: 0.2850s/iter; left time: 5841.0107s
	iters: 200, epoch: 2 | loss: 4.7719407
	speed: 0.0810s/iter; left time: 1652.7695s
Epoch: 2 cost time: 16.903177499771118
Epoch: 2, Steps: 208 | Train Loss: 4.123 Vali Loss: 3.763 Vali Acc: 0.080 Test Loss: 3.763 Test Acc: 0.080
Validation loss decreased (-0.068559 --> -0.080189).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9136486
	speed: 0.2948s/iter; left time: 5980.1746s
	iters: 200, epoch: 3 | loss: 6.7314744
	speed: 0.0848s/iter; left time: 1710.9623s
Epoch: 3 cost time: 17.392739295959473
Epoch: 3, Steps: 208 | Train Loss: 4.990 Vali Loss: 4.585 Vali Acc: 0.095 Test Loss: 4.585 Test Acc: 0.095
Validation loss decreased (-0.080189 --> -0.095093).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5215948
	speed: 0.2984s/iter; left time: 5991.3870s
	iters: 200, epoch: 4 | loss: 8.0121136
	speed: 0.0765s/iter; left time: 1528.4339s
Epoch: 4 cost time: 16.503172636032104
Epoch: 4, Steps: 208 | Train Loss: 5.543 Vali Loss: 4.506 Vali Acc: 0.106 Test Loss: 4.506 Test Acc: 0.106
Validation loss decreased (-0.095093 --> -0.105532).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.9946599
	speed: 0.2769s/iter; left time: 5500.7351s
	iters: 200, epoch: 5 | loss: 5.3367682
	speed: 0.0640s/iter; left time: 1265.2987s
Epoch: 5 cost time: 13.582756280899048
Epoch: 5, Steps: 208 | Train Loss: 5.901 Vali Loss: 6.210 Vali Acc: 0.098 Test Loss: 6.210 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.9488435
	speed: 0.2891s/iter; left time: 5684.8691s
	iters: 200, epoch: 6 | loss: 6.9325361
	speed: 0.0765s/iter; left time: 1497.3855s
Epoch: 6 cost time: 16.483293533325195
Epoch: 6, Steps: 208 | Train Loss: 5.791 Vali Loss: 5.976 Vali Acc: 0.098 Test Loss: 5.976 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.1589246
	speed: 0.3002s/iter; left time: 5839.3678s
	iters: 200, epoch: 7 | loss: 7.9338846
	speed: 0.0953s/iter; left time: 1844.1972s
Epoch: 7 cost time: 19.650917053222656
Epoch: 7, Steps: 208 | Train Loss: 5.349 Vali Loss: 6.724 Vali Acc: 0.106 Test Loss: 6.724 Test Acc: 0.106
Validation loss decreased (-0.105532 --> -0.105808).  Saving model ...
	iters: 100, epoch: 8 | loss: 4.0941091
	speed: 0.3484s/iter; left time: 6705.1065s
	iters: 200, epoch: 8 | loss: 7.3826094
	speed: 0.0953s/iter; left time: 1825.1640s
Epoch: 8 cost time: 20.401336669921875
Epoch: 8, Steps: 208 | Train Loss: 4.746 Vali Loss: 7.540 Vali Acc: 0.113 Test Loss: 7.540 Test Acc: 0.113
Validation loss decreased (-0.105808 --> -0.112958).  Saving model ...
	iters: 100, epoch: 9 | loss: 4.3699389
	speed: 0.3244s/iter; left time: 6175.4961s
	iters: 200, epoch: 9 | loss: 3.4569974
	speed: 0.0884s/iter; left time: 1674.9330s
Epoch: 9 cost time: 19.174720764160156
Epoch: 9, Steps: 208 | Train Loss: 3.763 Vali Loss: 8.128 Vali Acc: 0.098 Test Loss: 8.128 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.5237937
	speed: 0.2715s/iter; left time: 5112.7544s
	iters: 200, epoch: 10 | loss: 4.2805099
	speed: 0.0644s/iter; left time: 1205.9863s
Epoch: 10 cost time: 13.920406341552734
Epoch: 10, Steps: 208 | Train Loss: 2.759 Vali Loss: 8.748 Vali Acc: 0.089 Test Loss: 8.748 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5457073
	speed: 0.3081s/iter; left time: 5737.7591s
	iters: 200, epoch: 11 | loss: 1.0792342
	speed: 0.0816s/iter; left time: 1512.0418s
Epoch: 11 cost time: 18.013251066207886
Epoch: 11, Steps: 208 | Train Loss: 1.841 Vali Loss: 10.784 Vali Acc: 0.083 Test Loss: 10.784 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2086578
	speed: 0.3048s/iter; left time: 5611.4295s
	iters: 200, epoch: 12 | loss: 1.3455634
	speed: 0.0821s/iter; left time: 1504.0123s
Epoch: 12 cost time: 17.73512315750122
Epoch: 12, Steps: 208 | Train Loss: 1.338 Vali Loss: 8.113 Vali Acc: 0.093 Test Loss: 8.113 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.4665837
	speed: 0.3225s/iter; left time: 5871.8273s
	iters: 200, epoch: 13 | loss: 1.7358335
	speed: 0.0925s/iter; left time: 1674.4926s
Epoch: 13 cost time: 19.558622360229492
Epoch: 13, Steps: 208 | Train Loss: 1.044 Vali Loss: 7.728 Vali Acc: 0.102 Test Loss: 7.728 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7954058
	speed: 0.3262s/iter; left time: 5870.7154s
	iters: 200, epoch: 14 | loss: 1.7641028
	speed: 0.0884s/iter; left time: 1582.5890s
Epoch: 14 cost time: 19.136732816696167
Epoch: 14, Steps: 208 | Train Loss: 0.853 Vali Loss: 7.660 Vali Acc: 0.102 Test Loss: 7.660 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3782917
	speed: 0.2863s/iter; left time: 5092.2432s
	iters: 200, epoch: 15 | loss: 0.7779270
	speed: 0.0664s/iter; left time: 1173.8816s
Epoch: 15 cost time: 14.358651161193848
Epoch: 15, Steps: 208 | Train Loss: 0.746 Vali Loss: 8.415 Vali Acc: 0.102 Test Loss: 8.415 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.6690307
	speed: 0.2800s/iter; left time: 4922.4904s
	iters: 200, epoch: 16 | loss: 1.3338147
	speed: 0.0729s/iter; left time: 1273.6868s
Epoch: 16 cost time: 15.5188467502594
Epoch: 16, Steps: 208 | Train Loss: 0.626 Vali Loss: 8.535 Vali Acc: 0.104 Test Loss: 8.535 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.4814913
	speed: 0.2719s/iter; left time: 4724.3069s
	iters: 200, epoch: 17 | loss: 0.4089282
	speed: 0.0633s/iter; left time: 1092.8029s
Epoch: 17 cost time: 13.70992374420166
Epoch: 17, Steps: 208 | Train Loss: 0.524 Vali Loss: 8.491 Vali Acc: 0.097 Test Loss: 8.491 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1575200
	speed: 0.2862s/iter; left time: 4913.1081s
	iters: 200, epoch: 18 | loss: 0.3615532
	speed: 0.0757s/iter; left time: 1291.5006s
Epoch: 18 cost time: 17.04681968688965
Epoch: 18, Steps: 208 | Train Loss: 0.444 Vali Loss: 9.846 Vali Acc: 0.105 Test Loss: 9.846 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.113033104682374
model parameter : 4054311
model size : 17.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.2846255
	speed: 0.0696s/iter; left time: 1440.9530s
	iters: 200, epoch: 1 | loss: 4.2094121
	speed: 0.0426s/iter; left time: 878.3055s
Epoch: 1 cost time: 11.676138639450073
Epoch: 1, Steps: 208 | Train Loss: 4.938 Vali Loss: 3.638 Vali Acc: 0.060 Test Loss: 3.638 Test Acc: 0.060
Validation loss decreased (inf --> -0.059612).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1360841
	speed: 0.1874s/iter; left time: 3841.1239s
	iters: 200, epoch: 2 | loss: 4.3200912
	speed: 0.0504s/iter; left time: 1027.3614s
Epoch: 2 cost time: 11.385728359222412
Epoch: 2, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.847 Vali Acc: 0.084 Test Loss: 3.847 Test Acc: 0.084
Validation loss decreased (-0.059612 --> -0.084364).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.4473362
	speed: 0.1973s/iter; left time: 4002.5130s
	iters: 200, epoch: 3 | loss: 5.1099095
	speed: 0.0479s/iter; left time: 966.9178s
Epoch: 3 cost time: 10.740282773971558
Epoch: 3, Steps: 208 | Train Loss: 4.046 Vali Loss: 4.184 Vali Acc: 0.087 Test Loss: 4.184 Test Acc: 0.087
Validation loss decreased (-0.084364 --> -0.087343).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1118331
	speed: 0.2066s/iter; left time: 4146.9117s
	iters: 200, epoch: 4 | loss: 4.0699463
	speed: 0.0531s/iter; left time: 1060.2757s
Epoch: 4 cost time: 10.707916259765625
Epoch: 4, Steps: 208 | Train Loss: 4.332 Vali Loss: 4.421 Vali Acc: 0.112 Test Loss: 4.421 Test Acc: 0.112
Validation loss decreased (-0.087343 --> -0.112094).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.7502165
	speed: 0.1953s/iter; left time: 3881.3135s
	iters: 200, epoch: 5 | loss: 3.4623315
	speed: 0.0481s/iter; left time: 951.8407s
Epoch: 5 cost time: 9.681449174880981
Epoch: 5, Steps: 208 | Train Loss: 4.500 Vali Loss: 5.334 Vali Acc: 0.083 Test Loss: 5.334 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 5.8016872
	speed: 0.2352s/iter; left time: 4624.7280s
	iters: 200, epoch: 6 | loss: 4.8964887
	speed: 0.0568s/iter; left time: 1112.0060s
Epoch: 6 cost time: 13.370206594467163
Epoch: 6, Steps: 208 | Train Loss: 4.411 Vali Loss: 5.051 Vali Acc: 0.110 Test Loss: 5.051 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.0650024
	speed: 0.2335s/iter; left time: 4542.1727s
	iters: 200, epoch: 7 | loss: 5.0079813
	speed: 0.0511s/iter; left time: 988.8733s
Epoch: 7 cost time: 12.512499332427979
Epoch: 7, Steps: 208 | Train Loss: 4.325 Vali Loss: 5.083 Vali Acc: 0.111 Test Loss: 5.083 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 4.8955297
	speed: 0.2195s/iter; left time: 4223.3860s
	iters: 200, epoch: 8 | loss: 2.7276351
	speed: 0.0596s/iter; left time: 1140.4243s
Epoch: 8 cost time: 12.955557584762573
Epoch: 8, Steps: 208 | Train Loss: 3.795 Vali Loss: 5.794 Vali Acc: 0.116 Test Loss: 5.794 Test Acc: 0.116
Validation loss decreased (-0.112094 --> -0.115659).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.6834331
	speed: 0.2510s/iter; left time: 4779.2030s
	iters: 200, epoch: 9 | loss: 3.1598284
	speed: 0.0588s/iter; left time: 1114.0379s
Epoch: 9 cost time: 12.913103103637695
Epoch: 9, Steps: 208 | Train Loss: 3.317 Vali Loss: 6.365 Vali Acc: 0.112 Test Loss: 6.365 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.5356190
	speed: 0.2379s/iter; left time: 4479.7114s
	iters: 200, epoch: 10 | loss: 2.1870723
	speed: 0.0614s/iter; left time: 1150.1551s
Epoch: 10 cost time: 13.512483596801758
Epoch: 10, Steps: 208 | Train Loss: 2.593 Vali Loss: 7.863 Vali Acc: 0.063 Test Loss: 7.863 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.0442352
	speed: 0.2370s/iter; left time: 4412.4372s
	iters: 200, epoch: 11 | loss: 1.8654567
	speed: 0.0406s/iter; left time: 751.8922s
Epoch: 11 cost time: 10.51981806755066
Epoch: 11, Steps: 208 | Train Loss: 1.983 Vali Loss: 6.656 Vali Acc: 0.116 Test Loss: 6.656 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7111756
	speed: 0.1829s/iter; left time: 3367.2044s
	iters: 200, epoch: 12 | loss: 1.4032515
	speed: 0.0441s/iter; left time: 808.0347s
Epoch: 12 cost time: 9.777654886245728
Epoch: 12, Steps: 208 | Train Loss: 1.441 Vali Loss: 6.759 Vali Acc: 0.110 Test Loss: 6.759 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9106855
	speed: 0.2505s/iter; left time: 4560.7643s
	iters: 200, epoch: 13 | loss: 1.4070941
	speed: 0.0543s/iter; left time: 983.5157s
Epoch: 13 cost time: 12.631678819656372
Epoch: 13, Steps: 208 | Train Loss: 1.111 Vali Loss: 6.964 Vali Acc: 0.107 Test Loss: 6.964 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.4868647
	speed: 0.2278s/iter; left time: 4099.0139s
	iters: 200, epoch: 14 | loss: 0.6489165
	speed: 0.0553s/iter; left time: 989.5986s
Epoch: 14 cost time: 12.45461916923523
Epoch: 14, Steps: 208 | Train Loss: 0.951 Vali Loss: 7.835 Vali Acc: 0.111 Test Loss: 7.835 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6671974
	speed: 0.2405s/iter; left time: 4278.8066s
	iters: 200, epoch: 15 | loss: 0.7652800
	speed: 0.0636s/iter; left time: 1124.2715s
Epoch: 15 cost time: 13.555696725845337
Epoch: 15, Steps: 208 | Train Loss: 0.760 Vali Loss: 7.718 Vali Acc: 0.120 Test Loss: 7.718 Test Acc: 0.120
Validation loss decreased (-0.115659 --> -0.120412).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3590423
	speed: 0.2334s/iter; left time: 4102.8984s
	iters: 200, epoch: 16 | loss: 1.0889579
	speed: 0.0549s/iter; left time: 959.4731s
Epoch: 16 cost time: 12.133992433547974
Epoch: 16, Steps: 208 | Train Loss: 0.604 Vali Loss: 8.338 Vali Acc: 0.115 Test Loss: 8.338 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.9643210
	speed: 0.2333s/iter; left time: 4053.5662s
	iters: 200, epoch: 17 | loss: 0.5508911
	speed: 0.0579s/iter; left time: 999.4927s
Epoch: 17 cost time: 12.891841173171997
Epoch: 17, Steps: 208 | Train Loss: 0.514 Vali Loss: 8.343 Vali Acc: 0.113 Test Loss: 8.343 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8784695
	speed: 0.2554s/iter; left time: 4384.2726s
	iters: 200, epoch: 18 | loss: 0.4138362
	speed: 0.0672s/iter; left time: 1146.0289s
Epoch: 18 cost time: 15.055521011352539
Epoch: 18, Steps: 208 | Train Loss: 0.419 Vali Loss: 9.346 Vali Acc: 0.116 Test Loss: 9.346 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1769794
	speed: 0.2462s/iter; left time: 4174.7572s
	iters: 200, epoch: 19 | loss: 0.4688855
	speed: 0.0520s/iter; left time: 876.2161s
Epoch: 19 cost time: 11.894310474395752
Epoch: 19, Steps: 208 | Train Loss: 0.365 Vali Loss: 9.802 Vali Acc: 0.113 Test Loss: 9.802 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9362711
	speed: 0.2491s/iter; left time: 4172.2843s
	iters: 200, epoch: 20 | loss: 0.7455612
	speed: 0.0573s/iter; left time: 953.8273s
Epoch: 20 cost time: 12.95366644859314
Epoch: 20, Steps: 208 | Train Loss: 0.374 Vali Loss: 9.554 Vali Acc: 0.123 Test Loss: 9.554 Test Acc: 0.123
Validation loss decreased (-0.120412 --> -0.122481).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1764507
	speed: 0.2396s/iter; left time: 3962.9401s
	iters: 200, epoch: 21 | loss: 0.2689483
	speed: 0.0587s/iter; left time: 964.4402s
Epoch: 21 cost time: 13.023859024047852
Epoch: 21, Steps: 208 | Train Loss: 0.289 Vali Loss: 10.167 Vali Acc: 0.116 Test Loss: 10.167 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2844458
	speed: 0.2198s/iter; left time: 3590.0666s
	iters: 200, epoch: 22 | loss: 0.3585285
	speed: 0.0521s/iter; left time: 845.4879s
Epoch: 22 cost time: 11.010528326034546
Epoch: 22, Steps: 208 | Train Loss: 0.242 Vali Loss: 11.080 Vali Acc: 0.114 Test Loss: 11.080 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0943662
	speed: 0.2201s/iter; left time: 3549.5323s
	iters: 200, epoch: 23 | loss: 0.3476948
	speed: 0.0527s/iter; left time: 843.8650s
Epoch: 23 cost time: 11.414825677871704
Epoch: 23, Steps: 208 | Train Loss: 0.240 Vali Loss: 11.418 Vali Acc: 0.108 Test Loss: 11.418 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1802942
	speed: 0.2338s/iter; left time: 3721.9561s
	iters: 200, epoch: 24 | loss: 0.3957122
	speed: 0.0464s/iter; left time: 734.5526s
Epoch: 24 cost time: 11.58870792388916
Epoch: 24, Steps: 208 | Train Loss: 0.232 Vali Loss: 10.610 Vali Acc: 0.106 Test Loss: 10.610 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2698151
	speed: 0.2203s/iter; left time: 3460.8343s
	iters: 200, epoch: 25 | loss: 0.6152169
	speed: 0.0617s/iter; left time: 962.7020s
Epoch: 25 cost time: 13.252839803695679
Epoch: 25, Steps: 208 | Train Loss: 0.248 Vali Loss: 10.898 Vali Acc: 0.110 Test Loss: 10.898 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.4944325
	speed: 0.2063s/iter; left time: 3197.3644s
	iters: 200, epoch: 26 | loss: 0.3621362
	speed: 0.0461s/iter; left time: 710.5998s
Epoch: 26 cost time: 9.375272035598755
Epoch: 26, Steps: 208 | Train Loss: 0.198 Vali Loss: 11.346 Vali Acc: 0.114 Test Loss: 11.346 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1939715
	speed: 0.2090s/iter; left time: 3196.0994s
	iters: 200, epoch: 27 | loss: 0.0720755
	speed: 0.0404s/iter; left time: 614.1673s
Epoch: 27 cost time: 8.995050191879272
Epoch: 27, Steps: 208 | Train Loss: 0.204 Vali Loss: 11.154 Vali Acc: 0.109 Test Loss: 11.154 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0533645
	speed: 0.1976s/iter; left time: 2980.5525s
	iters: 200, epoch: 28 | loss: 0.1365343
	speed: 0.0437s/iter; left time: 654.1215s
Epoch: 28 cost time: 9.46054196357727
Epoch: 28, Steps: 208 | Train Loss: 0.190 Vali Loss: 10.931 Vali Acc: 0.107 Test Loss: 10.931 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1970464
	speed: 0.2124s/iter; left time: 3159.9381s
	iters: 200, epoch: 29 | loss: 0.0279745
	speed: 0.0386s/iter; left time: 571.0310s
Epoch: 29 cost time: 8.894675731658936
Epoch: 29, Steps: 208 | Train Loss: 0.179 Vali Loss: 11.194 Vali Acc: 0.110 Test Loss: 11.194 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1036147
	speed: 0.2224s/iter; left time: 3262.7379s
	iters: 200, epoch: 30 | loss: 0.3480748
	speed: 0.0507s/iter; left time: 738.8558s
Epoch: 30 cost time: 11.519795179367065
Epoch: 30, Steps: 208 | Train Loss: 0.165 Vali Loss: 12.972 Vali Acc: 0.112 Test Loss: 12.972 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12257679689830003
model parameter : 2078119
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3949680
	speed: 0.0722s/iter; left time: 1493.7914s
	iters: 200, epoch: 1 | loss: 3.9193387
	speed: 0.0438s/iter; left time: 903.1871s
Epoch: 1 cost time: 12.008946657180786
Epoch: 1, Steps: 208 | Train Loss: 4.699 Vali Loss: 3.789 Vali Acc: 0.063 Test Loss: 3.789 Test Acc: 0.063
Validation loss decreased (inf --> -0.063189).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2724531
	speed: 0.1988s/iter; left time: 4073.0720s
	iters: 200, epoch: 2 | loss: 3.9699173
	speed: 0.0520s/iter; left time: 1060.3187s
Epoch: 2 cost time: 11.309626579284668
Epoch: 2, Steps: 208 | Train Loss: 3.497 Vali Loss: 3.667 Vali Acc: 0.084 Test Loss: 3.667 Test Acc: 0.084
Validation loss decreased (-0.063189 --> -0.083471).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2833753
	speed: 0.1957s/iter; left time: 3969.8649s
	iters: 200, epoch: 3 | loss: 4.5928535
	speed: 0.0515s/iter; left time: 1038.8880s
Epoch: 3 cost time: 11.553529500961304
Epoch: 3, Steps: 208 | Train Loss: 3.630 Vali Loss: 4.048 Vali Acc: 0.077 Test Loss: 4.048 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4934492
	speed: 0.2017s/iter; left time: 4048.8717s
	iters: 200, epoch: 4 | loss: 4.2185693
	speed: 0.0507s/iter; left time: 1013.0456s
Epoch: 4 cost time: 11.105286359786987
Epoch: 4, Steps: 208 | Train Loss: 3.890 Vali Loss: 4.185 Vali Acc: 0.100 Test Loss: 4.185 Test Acc: 0.100
Validation loss decreased (-0.083471 --> -0.100167).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0213099
	speed: 0.2083s/iter; left time: 4139.3100s
	iters: 200, epoch: 5 | loss: 4.9278402
	speed: 0.0615s/iter; left time: 1214.8410s
Epoch: 5 cost time: 12.631775379180908
Epoch: 5, Steps: 208 | Train Loss: 4.003 Vali Loss: 4.462 Vali Acc: 0.103 Test Loss: 4.462 Test Acc: 0.103
Validation loss decreased (-0.100167 --> -0.103445).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1143236
	speed: 0.2173s/iter; left time: 4272.6258s
	iters: 200, epoch: 6 | loss: 3.6058571
	speed: 0.0566s/iter; left time: 1106.5208s
Epoch: 6 cost time: 12.975778579711914
Epoch: 6, Steps: 208 | Train Loss: 4.006 Vali Loss: 4.575 Vali Acc: 0.113 Test Loss: 4.575 Test Acc: 0.113
Validation loss decreased (-0.103445 --> -0.112987).  Saving model ...
	iters: 100, epoch: 7 | loss: 6.0109062
	speed: 0.1978s/iter; left time: 3848.1337s
	iters: 200, epoch: 7 | loss: 4.0755410
	speed: 0.0585s/iter; left time: 1132.2367s
Epoch: 7 cost time: 12.09123969078064
Epoch: 7, Steps: 208 | Train Loss: 3.833 Vali Loss: 4.681 Vali Acc: 0.114 Test Loss: 4.681 Test Acc: 0.114
Validation loss decreased (-0.112987 --> -0.113881).  Saving model ...
	iters: 100, epoch: 8 | loss: 4.7872801
	speed: 0.2195s/iter; left time: 4224.9190s
	iters: 200, epoch: 8 | loss: 3.0070925
	speed: 0.0530s/iter; left time: 1014.7577s
Epoch: 8 cost time: 11.893443822860718
Epoch: 8, Steps: 208 | Train Loss: 3.556 Vali Loss: 5.042 Vali Acc: 0.116 Test Loss: 5.042 Test Acc: 0.116
Validation loss decreased (-0.113881 --> -0.116263).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.7308099
	speed: 0.2161s/iter; left time: 4114.6429s
	iters: 200, epoch: 9 | loss: 3.5461874
	speed: 0.0519s/iter; left time: 981.9900s
Epoch: 9 cost time: 11.196354866027832
Epoch: 9, Steps: 208 | Train Loss: 3.170 Vali Loss: 5.296 Vali Acc: 0.109 Test Loss: 5.296 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2278111
	speed: 0.2132s/iter; left time: 4013.6439s
	iters: 200, epoch: 10 | loss: 2.6646485
	speed: 0.0373s/iter; left time: 698.9776s
Epoch: 10 cost time: 9.177742719650269
Epoch: 10, Steps: 208 | Train Loss: 2.674 Vali Loss: 6.504 Vali Acc: 0.117 Test Loss: 6.504 Test Acc: 0.117
Validation loss decreased (-0.116263 --> -0.116547).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6467599
	speed: 0.2081s/iter; left time: 3874.4015s
	iters: 200, epoch: 11 | loss: 1.9763457
	speed: 0.0412s/iter; left time: 762.7820s
Epoch: 11 cost time: 9.43582010269165
Epoch: 11, Steps: 208 | Train Loss: 2.048 Vali Loss: 5.389 Vali Acc: 0.123 Test Loss: 5.389 Test Acc: 0.123
Validation loss decreased (-0.116547 --> -0.122523).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4241310
	speed: 0.2042s/iter; left time: 3759.9256s
	iters: 200, epoch: 12 | loss: 1.8731139
	speed: 0.0471s/iter; left time: 862.1732s
Epoch: 12 cost time: 10.557889223098755
Epoch: 12, Steps: 208 | Train Loss: 1.699 Vali Loss: 5.941 Vali Acc: 0.108 Test Loss: 5.941 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5238672
	speed: 0.1810s/iter; left time: 3294.5269s
	iters: 200, epoch: 13 | loss: 1.4826837
	speed: 0.0366s/iter; left time: 662.6068s
Epoch: 13 cost time: 7.8986899852752686
Epoch: 13, Steps: 208 | Train Loss: 1.338 Vali Loss: 5.986 Vali Acc: 0.132 Test Loss: 5.986 Test Acc: 0.132
Validation loss decreased (-0.122523 --> -0.132061).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6216944
	speed: 0.1960s/iter; left time: 3527.7510s
	iters: 200, epoch: 14 | loss: 1.1240324
	speed: 0.0536s/iter; left time: 959.0843s
Epoch: 14 cost time: 11.268698930740356
Epoch: 14, Steps: 208 | Train Loss: 1.079 Vali Loss: 6.462 Vali Acc: 0.122 Test Loss: 6.462 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5211807
	speed: 0.2087s/iter; left time: 3712.3916s
	iters: 200, epoch: 15 | loss: 0.9703588
	speed: 0.0470s/iter; left time: 831.9336s
Epoch: 15 cost time: 10.980537176132202
Epoch: 15, Steps: 208 | Train Loss: 0.822 Vali Loss: 7.007 Vali Acc: 0.123 Test Loss: 7.007 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5448506
	speed: 0.2096s/iter; left time: 3684.7013s
	iters: 200, epoch: 16 | loss: 0.3122266
	speed: 0.0480s/iter; left time: 839.6534s
Epoch: 16 cost time: 11.061270475387573
Epoch: 16, Steps: 208 | Train Loss: 0.701 Vali Loss: 7.669 Vali Acc: 0.128 Test Loss: 7.669 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1707558
	speed: 0.1880s/iter; left time: 3266.5389s
	iters: 200, epoch: 17 | loss: 0.3305970
	speed: 0.0281s/iter; left time: 485.7175s
Epoch: 17 cost time: 7.090020179748535
Epoch: 17, Steps: 208 | Train Loss: 0.539 Vali Loss: 8.317 Vali Acc: 0.126 Test Loss: 8.317 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0730843
	speed: 0.1909s/iter; left time: 3276.2124s
	iters: 200, epoch: 18 | loss: 0.2039405
	speed: 0.0361s/iter; left time: 615.9763s
Epoch: 18 cost time: 9.080595970153809
Epoch: 18, Steps: 208 | Train Loss: 0.429 Vali Loss: 9.009 Vali Acc: 0.126 Test Loss: 9.009 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8875347
	speed: 0.2073s/iter; left time: 3515.0315s
	iters: 200, epoch: 19 | loss: 0.4174701
	speed: 0.0513s/iter; left time: 864.6436s
Epoch: 19 cost time: 11.50059199333191
Epoch: 19, Steps: 208 | Train Loss: 0.399 Vali Loss: 8.551 Vali Acc: 0.129 Test Loss: 8.551 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2918867
	speed: 0.2175s/iter; left time: 3642.3894s
	iters: 200, epoch: 20 | loss: 0.5705120
	speed: 0.0621s/iter; left time: 1034.1001s
Epoch: 20 cost time: 12.703815460205078
Epoch: 20, Steps: 208 | Train Loss: 0.368 Vali Loss: 9.104 Vali Acc: 0.131 Test Loss: 9.104 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6518830
	speed: 0.2279s/iter; left time: 3769.5833s
	iters: 200, epoch: 21 | loss: 0.8344509
	speed: 0.0610s/iter; left time: 1002.6976s
Epoch: 21 cost time: 13.07011079788208
Epoch: 21, Steps: 208 | Train Loss: 0.317 Vali Loss: 9.800 Vali Acc: 0.121 Test Loss: 9.800 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3401465
	speed: 0.2202s/iter; left time: 3596.1153s
	iters: 200, epoch: 22 | loss: 0.3771128
	speed: 0.0592s/iter; left time: 960.5559s
Epoch: 22 cost time: 13.161126136779785
Epoch: 22, Steps: 208 | Train Loss: 0.269 Vali Loss: 9.463 Vali Acc: 0.122 Test Loss: 9.463 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1345241
	speed: 0.2093s/iter; left time: 3375.4280s
	iters: 200, epoch: 23 | loss: 0.1683184
	speed: 0.0508s/iter; left time: 814.3845s
Epoch: 23 cost time: 11.30260944366455
Epoch: 23, Steps: 208 | Train Loss: 0.279 Vali Loss: 10.482 Vali Acc: 0.125 Test Loss: 10.482 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13212048911422605
model parameter : 1419943
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9205141
	speed: 0.0715s/iter; left time: 1480.0354s
	iters: 200, epoch: 1 | loss: 4.3026080
	speed: 0.0484s/iter; left time: 998.0713s
Epoch: 1 cost time: 12.538854837417603
Epoch: 1, Steps: 208 | Train Loss: 4.557 Vali Loss: 4.043 Vali Acc: 0.058 Test Loss: 4.043 Test Acc: 0.058
Validation loss decreased (inf --> -0.057818).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2662671
	speed: 0.1987s/iter; left time: 4071.4362s
	iters: 200, epoch: 2 | loss: 4.0142159
	speed: 0.0535s/iter; left time: 1090.2345s
Epoch: 2 cost time: 11.425348997116089
Epoch: 2, Steps: 208 | Train Loss: 3.518 Vali Loss: 3.481 Vali Acc: 0.087 Test Loss: 3.481 Test Acc: 0.087
Validation loss decreased (-0.057818 --> -0.087051).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2239423
	speed: 0.2166s/iter; left time: 4393.6036s
	iters: 200, epoch: 3 | loss: 4.0635824
	speed: 0.0605s/iter; left time: 1221.1858s
Epoch: 3 cost time: 12.611113548278809
Epoch: 3, Steps: 208 | Train Loss: 3.508 Vali Loss: 3.539 Vali Acc: 0.101 Test Loss: 3.539 Test Acc: 0.101
Validation loss decreased (-0.087051 --> -0.100770).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9495354
	speed: 0.2141s/iter; left time: 4298.5494s
	iters: 200, epoch: 4 | loss: 4.6539660
	speed: 0.0586s/iter; left time: 1170.8825s
Epoch: 4 cost time: 12.69452691078186
Epoch: 4, Steps: 208 | Train Loss: 3.672 Vali Loss: 4.268 Vali Acc: 0.105 Test Loss: 4.268 Test Acc: 0.105
Validation loss decreased (-0.100770 --> -0.104640).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9466326
	speed: 0.2039s/iter; left time: 4051.0455s
	iters: 200, epoch: 5 | loss: 4.1428738
	speed: 0.0480s/iter; left time: 949.0088s
Epoch: 5 cost time: 10.65342116355896
Epoch: 5, Steps: 208 | Train Loss: 3.722 Vali Loss: 5.777 Vali Acc: 0.067 Test Loss: 5.777 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1763034
	speed: 0.1818s/iter; left time: 3574.2571s
	iters: 200, epoch: 6 | loss: 3.7496033
	speed: 0.0289s/iter; left time: 564.3808s
Epoch: 6 cost time: 6.837317228317261
Epoch: 6, Steps: 208 | Train Loss: 3.757 Vali Loss: 4.275 Vali Acc: 0.120 Test Loss: 4.275 Test Acc: 0.120
Validation loss decreased (-0.104640 --> -0.120446).  Saving model ...
	iters: 100, epoch: 7 | loss: 4.5607290
	speed: 0.1898s/iter; left time: 3691.9611s
	iters: 200, epoch: 7 | loss: 3.5140746
	speed: 0.0334s/iter; left time: 645.5341s
Epoch: 7 cost time: 8.5353364944458
Epoch: 7, Steps: 208 | Train Loss: 3.606 Vali Loss: 4.762 Vali Acc: 0.114 Test Loss: 4.762 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 4.5068488
	speed: 0.1939s/iter; left time: 3731.2933s
	iters: 200, epoch: 8 | loss: 3.5031199
	speed: 0.0406s/iter; left time: 777.4700s
Epoch: 8 cost time: 8.928811311721802
Epoch: 8, Steps: 208 | Train Loss: 3.425 Vali Loss: 5.140 Vali Acc: 0.108 Test Loss: 5.140 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.9359822
	speed: 0.1901s/iter; left time: 3618.3650s
	iters: 200, epoch: 9 | loss: 3.4741988
	speed: 0.0364s/iter; left time: 689.5430s
Epoch: 9 cost time: 8.512227296829224
Epoch: 9, Steps: 208 | Train Loss: 3.125 Vali Loss: 5.061 Vali Acc: 0.120 Test Loss: 5.061 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.9346831
	speed: 0.1976s/iter; left time: 3720.2108s
	iters: 200, epoch: 10 | loss: 2.6546905
	speed: 0.0385s/iter; left time: 721.4230s
Epoch: 10 cost time: 8.7348313331604
Epoch: 10, Steps: 208 | Train Loss: 2.642 Vali Loss: 5.518 Vali Acc: 0.112 Test Loss: 5.518 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.1077349
	speed: 0.1993s/iter; left time: 3711.8633s
	iters: 200, epoch: 11 | loss: 2.9575183
	speed: 0.0529s/iter; left time: 978.8496s
Epoch: 11 cost time: 11.009706020355225
Epoch: 11, Steps: 208 | Train Loss: 2.200 Vali Loss: 6.883 Vali Acc: 0.084 Test Loss: 6.883 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.9703882
	speed: 0.2140s/iter; left time: 3940.9603s
	iters: 200, epoch: 12 | loss: 1.5838450
	speed: 0.0437s/iter; left time: 799.4899s
Epoch: 12 cost time: 10.617156744003296
Epoch: 12, Steps: 208 | Train Loss: 1.731 Vali Loss: 5.966 Vali Acc: 0.117 Test Loss: 5.966 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.9946798
	speed: 0.1924s/iter; left time: 3501.9876s
	iters: 200, epoch: 13 | loss: 1.6262434
	speed: 0.0436s/iter; left time: 789.9831s
Epoch: 13 cost time: 9.131747007369995
Epoch: 13, Steps: 208 | Train Loss: 1.477 Vali Loss: 5.995 Vali Acc: 0.106 Test Loss: 5.995 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4846517
	speed: 0.1967s/iter; left time: 3539.1624s
	iters: 200, epoch: 14 | loss: 1.1409972
	speed: 0.0483s/iter; left time: 864.2420s
Epoch: 14 cost time: 10.309556722640991
Epoch: 14, Steps: 208 | Train Loss: 1.188 Vali Loss: 6.132 Vali Acc: 0.118 Test Loss: 6.132 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0276699
	speed: 0.1964s/iter; left time: 3493.8394s
	iters: 200, epoch: 15 | loss: 0.9940538
	speed: 0.0476s/iter; left time: 842.1811s
Epoch: 15 cost time: 10.779444456100464
Epoch: 15, Steps: 208 | Train Loss: 0.957 Vali Loss: 6.508 Vali Acc: 0.123 Test Loss: 6.508 Test Acc: 0.123
Validation loss decreased (-0.120446 --> -0.122512).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6588593
	speed: 0.2116s/iter; left time: 3719.4379s
	iters: 200, epoch: 16 | loss: 0.6775882
	speed: 0.0479s/iter; left time: 837.5824s
Epoch: 16 cost time: 10.914345264434814
Epoch: 16, Steps: 208 | Train Loss: 0.757 Vali Loss: 6.662 Vali Acc: 0.113 Test Loss: 6.662 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8280391
	speed: 0.1944s/iter; left time: 3377.7442s
	iters: 200, epoch: 17 | loss: 1.2464762
	speed: 0.0384s/iter; left time: 663.9466s
Epoch: 17 cost time: 8.659189701080322
Epoch: 17, Steps: 208 | Train Loss: 0.646 Vali Loss: 7.414 Vali Acc: 0.120 Test Loss: 7.414 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.9035136
	speed: 0.2056s/iter; left time: 3529.2995s
	iters: 200, epoch: 18 | loss: 0.6541433
	speed: 0.0575s/iter; left time: 981.3224s
Epoch: 18 cost time: 12.582365274429321
Epoch: 18, Steps: 208 | Train Loss: 0.504 Vali Loss: 8.438 Vali Acc: 0.124 Test Loss: 8.438 Test Acc: 0.124
Validation loss decreased (-0.122512 --> -0.124282).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.7193221
	speed: 0.2168s/iter; left time: 3676.8663s
	iters: 200, epoch: 19 | loss: 0.9729849
	speed: 0.0603s/iter; left time: 1017.1796s
Epoch: 19 cost time: 13.242350101470947
Epoch: 19, Steps: 208 | Train Loss: 0.470 Vali Loss: 8.092 Vali Acc: 0.117 Test Loss: 8.092 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1406457
	speed: 0.2089s/iter; left time: 3498.9088s
	iters: 200, epoch: 20 | loss: 0.5779625
	speed: 0.0497s/iter; left time: 827.4350s
Epoch: 20 cost time: 11.040712356567383
Epoch: 20, Steps: 208 | Train Loss: 0.379 Vali Loss: 8.530 Vali Acc: 0.127 Test Loss: 8.530 Test Acc: 0.127
Validation loss decreased (-0.124282 --> -0.126667).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3736453
	speed: 0.1999s/iter; left time: 3307.1154s
	iters: 200, epoch: 21 | loss: 0.2261562
	speed: 0.0464s/iter; left time: 762.0662s
Epoch: 21 cost time: 9.918691635131836
Epoch: 21, Steps: 208 | Train Loss: 0.333 Vali Loss: 9.402 Vali Acc: 0.116 Test Loss: 9.402 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1934539
	speed: 0.1991s/iter; left time: 3252.0243s
	iters: 200, epoch: 22 | loss: 0.8397126
	speed: 0.0417s/iter; left time: 676.9898s
Epoch: 22 cost time: 10.072662830352783
Epoch: 22, Steps: 208 | Train Loss: 0.387 Vali Loss: 9.140 Vali Acc: 0.117 Test Loss: 9.140 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.6225511
	speed: 0.2057s/iter; left time: 3316.6422s
	iters: 200, epoch: 23 | loss: 0.0429054
	speed: 0.0467s/iter; left time: 747.9953s
Epoch: 23 cost time: 10.539488792419434
Epoch: 23, Steps: 208 | Train Loss: 0.318 Vali Loss: 10.006 Vali Acc: 0.123 Test Loss: 10.006 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1124812
	speed: 0.1766s/iter; left time: 2810.4311s
	iters: 200, epoch: 24 | loss: 0.6250527
	speed: 0.0269s/iter; left time: 424.7683s
Epoch: 24 cost time: 6.646600246429443
Epoch: 24, Steps: 208 | Train Loss: 0.272 Vali Loss: 9.959 Vali Acc: 0.123 Test Loss: 9.959 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0417021
	speed: 0.1854s/iter; left time: 2911.9570s
	iters: 200, epoch: 25 | loss: 0.6063412
	speed: 0.0467s/iter; left time: 728.4225s
Epoch: 25 cost time: 10.2778000831604
Epoch: 25, Steps: 208 | Train Loss: 0.244 Vali Loss: 9.908 Vali Acc: 0.113 Test Loss: 9.908 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0852720
	speed: 0.2015s/iter; left time: 3122.8089s
	iters: 200, epoch: 26 | loss: 0.5138529
	speed: 0.0504s/iter; left time: 776.9545s
Epoch: 26 cost time: 10.937011003494263
Epoch: 26, Steps: 208 | Train Loss: 0.227 Vali Loss: 11.216 Vali Acc: 0.125 Test Loss: 11.216 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.7523836
	speed: 0.2003s/iter; left time: 3062.7626s
	iters: 200, epoch: 27 | loss: 0.2867024
	speed: 0.0409s/iter; left time: 621.6337s
Epoch: 27 cost time: 9.484167098999023
Epoch: 27, Steps: 208 | Train Loss: 0.239 Vali Loss: 11.138 Vali Acc: 0.124 Test Loss: 11.138 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0574499
	speed: 0.1948s/iter; left time: 2938.7804s
	iters: 200, epoch: 28 | loss: 0.4883982
	speed: 0.0400s/iter; left time: 600.1215s
Epoch: 28 cost time: 9.015268325805664
Epoch: 28, Steps: 208 | Train Loss: 0.199 Vali Loss: 10.952 Vali Acc: 0.120 Test Loss: 10.952 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0415521
	speed: 0.1985s/iter; left time: 2952.3517s
	iters: 200, epoch: 29 | loss: 0.4435381
	speed: 0.0410s/iter; left time: 606.0711s
Epoch: 29 cost time: 8.852360963821411
Epoch: 29, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.254 Vali Acc: 0.117 Test Loss: 11.254 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1195696
	speed: 0.1929s/iter; left time: 2829.7628s
	iters: 200, epoch: 30 | loss: 0.4329133
	speed: 0.0372s/iter; left time: 541.7469s
Epoch: 30 cost time: 8.408321857452393
Epoch: 30, Steps: 208 | Train Loss: 0.218 Vali Loss: 11.046 Vali Acc: 0.116 Test Loss: 11.046 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12675216224276767
model parameter : 1146023
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6479936
	speed: 0.0731s/iter; left time: 1513.3490s
	iters: 200, epoch: 1 | loss: 3.9991763
	speed: 0.0512s/iter; left time: 1055.6012s
Epoch: 1 cost time: 12.853597640991211
Epoch: 1, Steps: 208 | Train Loss: 4.231 Vali Loss: 4.302 Vali Acc: 0.058 Test Loss: 4.302 Test Acc: 0.058
Validation loss decreased (inf --> -0.058114).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9781792
	speed: 0.1935s/iter; left time: 3965.2265s
	iters: 200, epoch: 2 | loss: 3.9617639
	speed: 0.0543s/iter; left time: 1107.7641s
Epoch: 2 cost time: 10.35861849784851
Epoch: 2, Steps: 208 | Train Loss: 3.583 Vali Loss: 3.528 Vali Acc: 0.087 Test Loss: 3.528 Test Acc: 0.087
Validation loss decreased (-0.058114 --> -0.087051).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7833338
	speed: 0.2038s/iter; left time: 4134.9197s
	iters: 200, epoch: 3 | loss: 3.0478122
	speed: 0.0499s/iter; left time: 1006.7715s
Epoch: 3 cost time: 11.505401372909546
Epoch: 3, Steps: 208 | Train Loss: 3.405 Vali Loss: 3.816 Vali Acc: 0.081 Test Loss: 3.816 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.9645607
	speed: 0.1870s/iter; left time: 3755.0783s
	iters: 200, epoch: 4 | loss: 3.3730154
	speed: 0.0478s/iter; left time: 954.3744s
Epoch: 4 cost time: 9.874345779418945
Epoch: 4, Steps: 208 | Train Loss: 3.399 Vali Loss: 4.030 Vali Acc: 0.084 Test Loss: 4.030 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.2369461
	speed: 0.1928s/iter; left time: 3830.5805s
	iters: 200, epoch: 5 | loss: 3.4932587
	speed: 0.0432s/iter; left time: 854.6909s
Epoch: 5 cost time: 9.7655611038208
Epoch: 5, Steps: 208 | Train Loss: 3.451 Vali Loss: 4.262 Vali Acc: 0.085 Test Loss: 4.262 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.7194588
	speed: 0.1548s/iter; left time: 3044.2221s
	iters: 200, epoch: 6 | loss: 2.8559868
	speed: 0.0414s/iter; left time: 809.4221s
Epoch: 6 cost time: 8.620177745819092
Epoch: 6, Steps: 208 | Train Loss: 3.350 Vali Loss: 4.321 Vali Acc: 0.106 Test Loss: 4.321 Test Acc: 0.106
Validation loss decreased (-0.087051 --> -0.106130).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5742471
	speed: 0.1945s/iter; left time: 3783.4258s
	iters: 200, epoch: 7 | loss: 3.5214968
	speed: 0.0498s/iter; left time: 964.1514s
Epoch: 7 cost time: 10.78585410118103
Epoch: 7, Steps: 208 | Train Loss: 3.285 Vali Loss: 4.432 Vali Acc: 0.093 Test Loss: 4.432 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2202961
	speed: 0.2118s/iter; left time: 4075.5011s
	iters: 200, epoch: 8 | loss: 3.7402844
	speed: 0.0581s/iter; left time: 1111.9623s
Epoch: 8 cost time: 12.661391019821167
Epoch: 8, Steps: 208 | Train Loss: 3.114 Vali Loss: 4.662 Vali Acc: 0.107 Test Loss: 4.662 Test Acc: 0.107
Validation loss decreased (-0.106130 --> -0.107022).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6842046
	speed: 0.2104s/iter; left time: 4005.2555s
	iters: 200, epoch: 9 | loss: 4.6914306
	speed: 0.0542s/iter; left time: 1027.2029s
Epoch: 9 cost time: 11.709943056106567
Epoch: 9, Steps: 208 | Train Loss: 2.940 Vali Loss: 4.731 Vali Acc: 0.106 Test Loss: 4.731 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9268293
	speed: 0.2106s/iter; left time: 3964.4588s
	iters: 200, epoch: 10 | loss: 1.7374538
	speed: 0.0558s/iter; left time: 1044.2995s
Epoch: 10 cost time: 12.030773162841797
Epoch: 10, Steps: 208 | Train Loss: 2.585 Vali Loss: 5.109 Vali Acc: 0.104 Test Loss: 5.109 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.6723540
	speed: 0.1823s/iter; left time: 3394.7458s
	iters: 200, epoch: 11 | loss: 3.4331720
	speed: 0.0330s/iter; left time: 611.9361s
Epoch: 11 cost time: 7.722103595733643
Epoch: 11, Steps: 208 | Train Loss: 2.284 Vali Loss: 6.040 Vali Acc: 0.110 Test Loss: 6.040 Test Acc: 0.110
Validation loss decreased (-0.107022 --> -0.110289).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1827996
	speed: 0.1828s/iter; left time: 3365.3334s
	iters: 200, epoch: 12 | loss: 2.1086388
	speed: 0.0338s/iter; left time: 618.5749s
Epoch: 12 cost time: 8.25517988204956
Epoch: 12, Steps: 208 | Train Loss: 1.971 Vali Loss: 5.856 Vali Acc: 0.108 Test Loss: 5.856 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7308205
	speed: 0.1979s/iter; left time: 3602.8170s
	iters: 200, epoch: 13 | loss: 1.3027642
	speed: 0.0379s/iter; left time: 685.9471s
Epoch: 13 cost time: 8.289721727371216
Epoch: 13, Steps: 208 | Train Loss: 1.666 Vali Loss: 6.112 Vali Acc: 0.115 Test Loss: 6.112 Test Acc: 0.115
Validation loss decreased (-0.110289 --> -0.115060).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0534785
	speed: 0.1941s/iter; left time: 3492.6307s
	iters: 200, epoch: 14 | loss: 2.2742605
	speed: 0.0304s/iter; left time: 544.7092s
Epoch: 14 cost time: 7.834285020828247
Epoch: 14, Steps: 208 | Train Loss: 1.410 Vali Loss: 5.913 Vali Acc: 0.112 Test Loss: 5.913 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5894645
	speed: 0.1899s/iter; left time: 3378.5925s
	iters: 200, epoch: 15 | loss: 1.3222533
	speed: 0.0417s/iter; left time: 737.8936s
Epoch: 15 cost time: 8.456578969955444
Epoch: 15, Steps: 208 | Train Loss: 1.165 Vali Loss: 6.169 Vali Acc: 0.117 Test Loss: 6.169 Test Acc: 0.117
Validation loss decreased (-0.115060 --> -0.116550).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2660943
	speed: 0.1998s/iter; left time: 3513.0032s
	iters: 200, epoch: 16 | loss: 0.8212433
	speed: 0.0376s/iter; left time: 656.6766s
Epoch: 16 cost time: 9.253332138061523
Epoch: 16, Steps: 208 | Train Loss: 0.953 Vali Loss: 6.852 Vali Acc: 0.107 Test Loss: 6.852 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3868140
	speed: 0.1682s/iter; left time: 2921.9075s
	iters: 200, epoch: 17 | loss: 0.5417725
	speed: 0.0320s/iter; left time: 553.3411s
Epoch: 17 cost time: 7.3953492641448975
Epoch: 17, Steps: 208 | Train Loss: 0.803 Vali Loss: 6.701 Vali Acc: 0.109 Test Loss: 6.701 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7466864
	speed: 0.1701s/iter; left time: 2919.4949s
	iters: 200, epoch: 18 | loss: 0.8601008
	speed: 0.0319s/iter; left time: 544.1302s
Epoch: 18 cost time: 7.304065227508545
Epoch: 18, Steps: 208 | Train Loss: 0.672 Vali Loss: 7.894 Vali Acc: 0.114 Test Loss: 7.894 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6851252
	speed: 0.1817s/iter; left time: 3080.5302s
	iters: 200, epoch: 19 | loss: 0.3548098
	speed: 0.0348s/iter; left time: 586.5507s
Epoch: 19 cost time: 8.086759090423584
Epoch: 19, Steps: 208 | Train Loss: 0.562 Vali Loss: 7.845 Vali Acc: 0.117 Test Loss: 7.845 Test Acc: 0.117
Validation loss decreased (-0.116550 --> -0.116832).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4681142
	speed: 0.1771s/iter; left time: 2965.8972s
	iters: 200, epoch: 20 | loss: 0.8623527
	speed: 0.0314s/iter; left time: 522.0576s
Epoch: 20 cost time: 7.3009467124938965
Epoch: 20, Steps: 208 | Train Loss: 0.489 Vali Loss: 8.289 Vali Acc: 0.112 Test Loss: 8.289 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3650497
	speed: 0.1797s/iter; left time: 2973.0346s
	iters: 200, epoch: 21 | loss: 0.7590421
	speed: 0.0435s/iter; left time: 715.3778s
Epoch: 21 cost time: 8.030260562896729
Epoch: 21, Steps: 208 | Train Loss: 0.441 Vali Loss: 8.709 Vali Acc: 0.116 Test Loss: 8.709 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.6305118
	speed: 0.1933s/iter; left time: 3157.7286s
	iters: 200, epoch: 22 | loss: 0.3993100
	speed: 0.0427s/iter; left time: 692.8708s
Epoch: 22 cost time: 9.843076467514038
Epoch: 22, Steps: 208 | Train Loss: 0.400 Vali Loss: 8.664 Vali Acc: 0.113 Test Loss: 8.664 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.5118923
	speed: 0.1990s/iter; left time: 3208.5935s
	iters: 200, epoch: 23 | loss: 0.0846860
	speed: 0.0532s/iter; left time: 852.7021s
Epoch: 23 cost time: 11.471171379089355
Epoch: 23, Steps: 208 | Train Loss: 0.382 Vali Loss: 8.891 Vali Acc: 0.113 Test Loss: 8.891 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.7797179
	speed: 0.1920s/iter; left time: 3055.8728s
	iters: 200, epoch: 24 | loss: 0.4660693
	speed: 0.0389s/iter; left time: 614.7705s
Epoch: 24 cost time: 9.421710968017578
Epoch: 24, Steps: 208 | Train Loss: 0.340 Vali Loss: 9.724 Vali Acc: 0.116 Test Loss: 9.724 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.5010443
	speed: 0.1881s/iter; left time: 2954.1524s
	iters: 200, epoch: 25 | loss: 0.4059226
	speed: 0.0531s/iter; left time: 828.4151s
Epoch: 25 cost time: 11.538737535476685
Epoch: 25, Steps: 208 | Train Loss: 0.288 Vali Loss: 10.384 Vali Acc: 0.118 Test Loss: 10.384 Test Acc: 0.118
Validation loss decreased (-0.116832 --> -0.117403).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0298204
	speed: 0.2154s/iter; left time: 3338.6790s
	iters: 200, epoch: 26 | loss: 0.1196046
	speed: 0.0515s/iter; left time: 792.6443s
Epoch: 26 cost time: 11.517777919769287
Epoch: 26, Steps: 208 | Train Loss: 0.280 Vali Loss: 10.253 Vali Acc: 0.103 Test Loss: 10.253 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0585387
	speed: 0.2002s/iter; left time: 3061.1718s
	iters: 200, epoch: 27 | loss: 0.3805188
	speed: 0.0486s/iter; left time: 738.4510s
Epoch: 27 cost time: 10.360686540603638
Epoch: 27, Steps: 208 | Train Loss: 0.260 Vali Loss: 10.374 Vali Acc: 0.109 Test Loss: 10.374 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.1864450
	speed: 0.2055s/iter; left time: 3100.6071s
	iters: 200, epoch: 28 | loss: 0.3873155
	speed: 0.0460s/iter; left time: 689.6256s
Epoch: 28 cost time: 10.564635276794434
Epoch: 28, Steps: 208 | Train Loss: 0.293 Vali Loss: 10.730 Vali Acc: 0.114 Test Loss: 10.730 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.1060044
	speed: 0.2048s/iter; left time: 3046.1249s
	iters: 200, epoch: 29 | loss: 0.0847103
	speed: 0.0511s/iter; left time: 754.6302s
Epoch: 29 cost time: 11.322300434112549
Epoch: 29, Steps: 208 | Train Loss: 0.286 Vali Loss: 10.890 Vali Acc: 0.111 Test Loss: 10.890 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.2319565
	speed: 0.2174s/iter; left time: 3189.4828s
	iters: 200, epoch: 30 | loss: 0.3369385
	speed: 0.0615s/iter; left time: 896.1964s
Epoch: 30 cost time: 13.142686128616333
Epoch: 30, Steps: 208 | Train Loss: 0.257 Vali Loss: 11.098 Vali Acc: 0.113 Test Loss: 11.098 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.4974270
	speed: 0.2023s/iter; left time: 2926.0408s
	iters: 200, epoch: 31 | loss: 0.0711744
	speed: 0.0618s/iter; left time: 887.0508s
Epoch: 31 cost time: 12.067694187164307
Epoch: 31, Steps: 208 | Train Loss: 0.270 Vali Loss: 11.552 Vali Acc: 0.116 Test Loss: 11.552 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0134097
	speed: 0.1892s/iter; left time: 2697.0594s
	iters: 200, epoch: 32 | loss: 0.0439544
	speed: 0.0346s/iter; left time: 490.2597s
Epoch: 32 cost time: 7.486886501312256
Epoch: 32, Steps: 208 | Train Loss: 0.242 Vali Loss: 11.507 Vali Acc: 0.112 Test Loss: 11.507 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0084422
	speed: 0.2004s/iter; left time: 2815.0308s
	iters: 200, epoch: 33 | loss: 0.2169573
	speed: 0.0360s/iter; left time: 501.7613s
Epoch: 33 cost time: 8.709369659423828
Epoch: 33, Steps: 208 | Train Loss: 0.233 Vali Loss: 11.317 Vali Acc: 0.104 Test Loss: 11.317 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.2671076
	speed: 0.2082s/iter; left time: 2880.4314s
	iters: 200, epoch: 34 | loss: 0.6355995
	speed: 0.0394s/iter; left time: 541.3417s
Epoch: 34 cost time: 9.284302711486816
Epoch: 34, Steps: 208 | Train Loss: 0.226 Vali Loss: 12.539 Vali Acc: 0.102 Test Loss: 12.539 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.3082885
	speed: 0.2009s/iter; left time: 2738.5204s
	iters: 200, epoch: 35 | loss: 0.2721267
	speed: 0.0418s/iter; left time: 565.4149s
Epoch: 35 cost time: 9.245536088943481
Epoch: 35, Steps: 208 | Train Loss: 0.199 Vali Loss: 12.000 Vali Acc: 0.120 Test Loss: 12.000 Test Acc: 0.120
Validation loss decreased (-0.117403 --> -0.119773).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.9237690
	speed: 0.2016s/iter; left time: 2706.1186s
	iters: 200, epoch: 36 | loss: 0.0070914
	speed: 0.0439s/iter; left time: 584.2041s
Epoch: 36 cost time: 8.984627962112427
Epoch: 36, Steps: 208 | Train Loss: 0.235 Vali Loss: 12.948 Vali Acc: 0.115 Test Loss: 12.948 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.5814438
	speed: 0.1901s/iter; left time: 2511.8718s
	iters: 200, epoch: 37 | loss: 0.2884921
	speed: 0.0514s/iter; left time: 674.2675s
Epoch: 37 cost time: 10.655956029891968
Epoch: 37, Steps: 208 | Train Loss: 0.223 Vali Loss: 12.354 Vali Acc: 0.125 Test Loss: 12.354 Test Acc: 0.125
Validation loss decreased (-0.119773 --> -0.124541).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.2347789
	speed: 0.2057s/iter; left time: 2675.5098s
	iters: 200, epoch: 38 | loss: 0.2146138
	speed: 0.0533s/iter; left time: 687.3147s
Epoch: 38 cost time: 11.51172161102295
Epoch: 38, Steps: 208 | Train Loss: 0.220 Vali Loss: 12.674 Vali Acc: 0.115 Test Loss: 12.674 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.2281432
	speed: 0.1958s/iter; left time: 2505.1105s
	iters: 200, epoch: 39 | loss: 0.0731592
	speed: 0.0352s/iter; left time: 446.9872s
Epoch: 39 cost time: 8.070873260498047
Epoch: 39, Steps: 208 | Train Loss: 0.221 Vali Loss: 12.858 Vali Acc: 0.110 Test Loss: 12.858 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0675846
	speed: 0.1878s/iter; left time: 2363.8937s
	iters: 200, epoch: 40 | loss: 0.4356107
	speed: 0.0279s/iter; left time: 348.9756s
Epoch: 40 cost time: 7.073542356491089
Epoch: 40, Steps: 208 | Train Loss: 0.210 Vali Loss: 13.336 Vali Acc: 0.104 Test Loss: 13.336 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.0057383
	speed: 0.1877s/iter; left time: 2324.4956s
	iters: 200, epoch: 41 | loss: 0.2722533
	speed: 0.0493s/iter; left time: 605.0477s
Epoch: 41 cost time: 10.80984354019165
Epoch: 41, Steps: 208 | Train Loss: 0.204 Vali Loss: 13.049 Vali Acc: 0.110 Test Loss: 13.049 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.0778448
	speed: 0.1956s/iter; left time: 2381.1519s
	iters: 200, epoch: 42 | loss: 0.0907418
	speed: 0.0512s/iter; left time: 618.1360s
Epoch: 42 cost time: 11.323433876037598
Epoch: 42, Steps: 208 | Train Loss: 0.183 Vali Loss: 13.118 Vali Acc: 0.105 Test Loss: 13.118 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 0.2043005
	speed: 0.1841s/iter; left time: 2203.2619s
	iters: 200, epoch: 43 | loss: 0.0742620
	speed: 0.0437s/iter; left time: 519.0543s
Epoch: 43 cost time: 9.278441667556763
Epoch: 43, Steps: 208 | Train Loss: 0.184 Vali Loss: 13.398 Vali Acc: 0.105 Test Loss: 13.398 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 0.2415437
	speed: 0.2063s/iter; left time: 2425.9870s
	iters: 200, epoch: 44 | loss: 0.1369522
	speed: 0.0556s/iter; left time: 648.4794s
Epoch: 44 cost time: 11.777823448181152
Epoch: 44, Steps: 208 | Train Loss: 0.174 Vali Loss: 13.467 Vali Acc: 0.109 Test Loss: 13.467 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 45 | loss: 0.5651979
	speed: 0.2257s/iter; left time: 2606.9911s
	iters: 200, epoch: 45 | loss: 0.2311774
	speed: 0.0573s/iter; left time: 655.8227s
Epoch: 45 cost time: 12.805779695510864
Epoch: 45, Steps: 208 | Train Loss: 0.204 Vali Loss: 13.742 Vali Acc: 0.108 Test Loss: 13.742 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 46 | loss: 0.0285040
	speed: 0.2169s/iter; left time: 2460.1464s
	iters: 200, epoch: 46 | loss: 0.0866249
	speed: 0.0589s/iter; left time: 661.8392s
Epoch: 46 cost time: 13.011598825454712
Epoch: 46, Steps: 208 | Train Loss: 0.168 Vali Loss: 13.901 Vali Acc: 0.104 Test Loss: 13.901 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 47 | loss: 0.0394464
	speed: 0.2066s/iter; left time: 2300.1381s
	iters: 200, epoch: 47 | loss: 0.0250144
	speed: 0.0529s/iter; left time: 584.0079s
Epoch: 47 cost time: 11.172035217285156
Epoch: 47, Steps: 208 | Train Loss: 0.204 Vali Loss: 14.352 Vali Acc: 0.109 Test Loss: 14.352 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 763047
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7737775
	speed: 0.0714s/iter; left time: 1477.3131s
	iters: 200, epoch: 1 | loss: 4.7088261
	speed: 0.0448s/iter; left time: 922.9868s
Epoch: 1 cost time: 12.02377200126648
Epoch: 1, Steps: 208 | Train Loss: 4.106 Vali Loss: 4.447 Vali Acc: 0.054 Test Loss: 4.447 Test Acc: 0.054
Validation loss decreased (inf --> -0.053937).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7776487
	speed: 0.2085s/iter; left time: 4272.2820s
	iters: 200, epoch: 2 | loss: 3.0734601
	speed: 0.0525s/iter; left time: 1069.7339s
Epoch: 2 cost time: 11.466046810150146
Epoch: 2, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.529 Vali Acc: 0.067 Test Loss: 3.529 Test Acc: 0.067
Validation loss decreased (-0.053937 --> -0.067069).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6697016
	speed: 0.1925s/iter; left time: 3904.5484s
	iters: 200, epoch: 3 | loss: 3.5327396
	speed: 0.0382s/iter; left time: 772.0161s
Epoch: 3 cost time: 8.489187479019165
Epoch: 3, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.664 Vali Acc: 0.075 Test Loss: 3.664 Test Acc: 0.075
Validation loss decreased (-0.067069 --> -0.075120).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2446139
	speed: 0.1920s/iter; left time: 3854.3260s
	iters: 200, epoch: 4 | loss: 3.8995824
	speed: 0.0484s/iter; left time: 966.7348s
Epoch: 4 cost time: 10.643558263778687
Epoch: 4, Steps: 208 | Train Loss: 3.352 Vali Loss: 4.108 Vali Acc: 0.085 Test Loss: 4.108 Test Acc: 0.085
Validation loss decreased (-0.075120 --> -0.084659).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3125615
	speed: 0.1983s/iter; left time: 3939.6561s
	iters: 200, epoch: 5 | loss: 3.1726775
	speed: 0.0429s/iter; left time: 848.4562s
Epoch: 5 cost time: 9.871706485748291
Epoch: 5, Steps: 208 | Train Loss: 3.310 Vali Loss: 4.253 Vali Acc: 0.086 Test Loss: 4.253 Test Acc: 0.086
Validation loss decreased (-0.084659 --> -0.086149).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1426516
	speed: 0.1800s/iter; left time: 3538.1205s
	iters: 200, epoch: 6 | loss: 3.7783484
	speed: 0.0303s/iter; left time: 592.9399s
Epoch: 6 cost time: 6.9237565994262695
Epoch: 6, Steps: 208 | Train Loss: 3.228 Vali Loss: 4.377 Vali Acc: 0.093 Test Loss: 4.377 Test Acc: 0.093
Validation loss decreased (-0.086149 --> -0.093007).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3386981
	speed: 0.1758s/iter; left time: 3418.9997s
	iters: 200, epoch: 7 | loss: 2.9861338
	speed: 0.0367s/iter; left time: 709.3009s
Epoch: 7 cost time: 7.96957802772522
Epoch: 7, Steps: 208 | Train Loss: 3.114 Vali Loss: 4.453 Vali Acc: 0.099 Test Loss: 4.453 Test Acc: 0.099
Validation loss decreased (-0.093007 --> -0.098971).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4698122
	speed: 0.1742s/iter; left time: 3353.1952s
	iters: 200, epoch: 8 | loss: 2.4138429
	speed: 0.0361s/iter; left time: 690.5007s
Epoch: 8 cost time: 7.560954570770264
Epoch: 8, Steps: 208 | Train Loss: 3.009 Vali Loss: 4.791 Vali Acc: 0.112 Test Loss: 4.791 Test Acc: 0.112
Validation loss decreased (-0.098971 --> -0.111494).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7318723
	speed: 0.1914s/iter; left time: 3642.9885s
	iters: 200, epoch: 9 | loss: 3.1546867
	speed: 0.0317s/iter; left time: 600.7058s
Epoch: 9 cost time: 7.828353643417358
Epoch: 9, Steps: 208 | Train Loss: 2.798 Vali Loss: 4.943 Vali Acc: 0.095 Test Loss: 4.943 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7515955
	speed: 0.1854s/iter; left time: 3491.7466s
	iters: 200, epoch: 10 | loss: 2.8930190
	speed: 0.0413s/iter; left time: 773.4632s
Epoch: 10 cost time: 8.461440801620483
Epoch: 10, Steps: 208 | Train Loss: 2.568 Vali Loss: 5.159 Vali Acc: 0.107 Test Loss: 5.159 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.7968876
	speed: 0.1982s/iter; left time: 3691.0615s
	iters: 200, epoch: 11 | loss: 3.0425143
	speed: 0.0416s/iter; left time: 771.0352s
Epoch: 11 cost time: 9.450358152389526
Epoch: 11, Steps: 208 | Train Loss: 2.322 Vali Loss: 5.687 Vali Acc: 0.104 Test Loss: 5.687 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.0956221
	speed: 0.2002s/iter; left time: 3685.8246s
	iters: 200, epoch: 12 | loss: 2.1338894
	speed: 0.0450s/iter; left time: 824.1447s
Epoch: 12 cost time: 10.237467527389526
Epoch: 12, Steps: 208 | Train Loss: 2.071 Vali Loss: 5.462 Vali Acc: 0.107 Test Loss: 5.462 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.9773358
	speed: 0.1804s/iter; left time: 3284.7173s
	iters: 200, epoch: 13 | loss: 1.7905644
	speed: 0.0478s/iter; left time: 866.0488s
Epoch: 13 cost time: 9.7099928855896
Epoch: 13, Steps: 208 | Train Loss: 1.775 Vali Loss: 5.996 Vali Acc: 0.104 Test Loss: 5.996 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.0939748
	speed: 0.2014s/iter; left time: 3624.9365s
	iters: 200, epoch: 14 | loss: 2.9712348
	speed: 0.0488s/iter; left time: 872.7136s
Epoch: 14 cost time: 10.518117427825928
Epoch: 14, Steps: 208 | Train Loss: 1.532 Vali Loss: 6.117 Vali Acc: 0.109 Test Loss: 6.117 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.4573259
	speed: 0.1925s/iter; left time: 3423.6645s
	iters: 200, epoch: 15 | loss: 2.7322807
	speed: 0.0494s/iter; left time: 874.2961s
Epoch: 15 cost time: 10.260647296905518
Epoch: 15, Steps: 208 | Train Loss: 1.301 Vali Loss: 6.365 Vali Acc: 0.110 Test Loss: 6.365 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.2081736
	speed: 0.1850s/iter; left time: 3251.7601s
	iters: 200, epoch: 16 | loss: 1.3264179
	speed: 0.0443s/iter; left time: 775.2783s
Epoch: 16 cost time: 9.770590543746948
Epoch: 16, Steps: 208 | Train Loss: 1.114 Vali Loss: 6.379 Vali Acc: 0.107 Test Loss: 6.379 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0288532
	speed: 0.1950s/iter; left time: 3388.3607s
	iters: 200, epoch: 17 | loss: 1.1122861
	speed: 0.0588s/iter; left time: 1015.4407s
Epoch: 17 cost time: 12.43041205406189
Epoch: 17, Steps: 208 | Train Loss: 0.928 Vali Loss: 7.036 Vali Acc: 0.115 Test Loss: 7.036 Test Acc: 0.115
Validation loss decreased (-0.111494 --> -0.114752).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.7545240
	speed: 0.2153s/iter; left time: 3695.9990s
	iters: 200, epoch: 18 | loss: 1.1144459
	speed: 0.0512s/iter; left time: 873.9681s
Epoch: 18 cost time: 11.995280742645264
Epoch: 18, Steps: 208 | Train Loss: 0.799 Vali Loss: 7.537 Vali Acc: 0.114 Test Loss: 7.537 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.9205403
	speed: 0.1972s/iter; left time: 3343.5210s
	iters: 200, epoch: 19 | loss: 0.9833419
	speed: 0.0596s/iter; left time: 1005.2714s
Epoch: 19 cost time: 12.520144701004028
Epoch: 19, Steps: 208 | Train Loss: 0.670 Vali Loss: 7.591 Vali Acc: 0.112 Test Loss: 7.591 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1967652
	speed: 0.1980s/iter; left time: 3315.5657s
	iters: 200, epoch: 20 | loss: 0.7154266
	speed: 0.0430s/iter; left time: 715.3482s
Epoch: 20 cost time: 9.605549573898315
Epoch: 20, Steps: 208 | Train Loss: 0.606 Vali Loss: 8.122 Vali Acc: 0.099 Test Loss: 8.122 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.6241271
	speed: 0.2039s/iter; left time: 3373.4475s
	iters: 200, epoch: 21 | loss: 1.1977699
	speed: 0.0412s/iter; left time: 677.5272s
Epoch: 21 cost time: 9.982137441635132
Epoch: 21, Steps: 208 | Train Loss: 0.544 Vali Loss: 8.368 Vali Acc: 0.107 Test Loss: 8.368 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2182528
	speed: 0.2043s/iter; left time: 3336.1511s
	iters: 200, epoch: 22 | loss: 0.4916532
	speed: 0.0415s/iter; left time: 672.9382s
Epoch: 22 cost time: 9.720938205718994
Epoch: 22, Steps: 208 | Train Loss: 0.465 Vali Loss: 8.513 Vali Acc: 0.113 Test Loss: 8.513 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.8674704
	speed: 0.1867s/iter; left time: 3010.6218s
	iters: 200, epoch: 23 | loss: 0.9913428
	speed: 0.0387s/iter; left time: 619.8711s
Epoch: 23 cost time: 8.622995376586914
Epoch: 23, Steps: 208 | Train Loss: 0.413 Vali Loss: 9.194 Vali Acc: 0.102 Test Loss: 9.194 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0465566
	speed: 0.1888s/iter; left time: 3004.9298s
	iters: 200, epoch: 24 | loss: 0.1653722
	speed: 0.0381s/iter; left time: 603.0574s
Epoch: 24 cost time: 8.133034944534302
Epoch: 24, Steps: 208 | Train Loss: 0.395 Vali Loss: 9.282 Vali Acc: 0.108 Test Loss: 9.282 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.5702596
	speed: 0.2032s/iter; left time: 3191.4249s
	iters: 200, epoch: 25 | loss: 0.4555094
	speed: 0.0457s/iter; left time: 713.8355s
Epoch: 25 cost time: 10.243353843688965
Epoch: 25, Steps: 208 | Train Loss: 0.376 Vali Loss: 9.631 Vali Acc: 0.109 Test Loss: 9.631 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1832749
	speed: 0.2008s/iter; left time: 3113.0985s
	iters: 200, epoch: 26 | loss: 0.2666645
	speed: 0.0408s/iter; left time: 628.0884s
Epoch: 26 cost time: 9.214180707931519
Epoch: 26, Steps: 208 | Train Loss: 0.327 Vali Loss: 10.085 Vali Acc: 0.099 Test Loss: 10.085 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1905061
	speed: 0.1736s/iter; left time: 2654.6622s
	iters: 200, epoch: 27 | loss: 0.5825358
	speed: 0.0368s/iter; left time: 558.4759s
Epoch: 27 cost time: 8.254992008209229
Epoch: 27, Steps: 208 | Train Loss: 0.335 Vali Loss: 10.403 Vali Acc: 0.107 Test Loss: 10.403 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11482254697286012
model parameter : 599719
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3095493
	speed: 0.0585s/iter; left time: 1211.2117s
	iters: 200, epoch: 1 | loss: 4.4759746
	speed: 0.0298s/iter; left time: 614.0390s
Epoch: 1 cost time: 9.241252183914185
Epoch: 1, Steps: 208 | Train Loss: 4.004 Vali Loss: 4.333 Vali Acc: 0.054 Test Loss: 4.333 Test Acc: 0.054
Validation loss decreased (inf --> -0.053640).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8954561
	speed: 0.1766s/iter; left time: 3618.3003s
	iters: 200, epoch: 2 | loss: 3.7096033
	speed: 0.0268s/iter; left time: 547.4510s
Epoch: 2 cost time: 6.531197547912598
Epoch: 2, Steps: 208 | Train Loss: 3.798 Vali Loss: 3.731 Vali Acc: 0.073 Test Loss: 3.731 Test Acc: 0.073
Validation loss decreased (-0.053640 --> -0.073330).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9816263
	speed: 0.1926s/iter; left time: 3906.3379s
	iters: 200, epoch: 3 | loss: 3.2707036
	speed: 0.0489s/iter; left time: 987.9474s
Epoch: 3 cost time: 10.606911182403564
Epoch: 3, Steps: 208 | Train Loss: 3.338 Vali Loss: 4.077 Vali Acc: 0.070 Test Loss: 4.077 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2940872
	speed: 0.2096s/iter; left time: 4207.5086s
	iters: 200, epoch: 4 | loss: 3.2900462
	speed: 0.0491s/iter; left time: 981.4070s
Epoch: 4 cost time: 10.896526098251343
Epoch: 4, Steps: 208 | Train Loss: 3.251 Vali Loss: 3.902 Vali Acc: 0.078 Test Loss: 3.902 Test Acc: 0.078
Validation loss decreased (-0.073330 --> -0.077802).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1225471
	speed: 0.2048s/iter; left time: 4068.9994s
	iters: 200, epoch: 5 | loss: 4.2228227
	speed: 0.0541s/iter; left time: 1069.8662s
Epoch: 5 cost time: 11.929158926010132
Epoch: 5, Steps: 208 | Train Loss: 3.164 Vali Loss: 4.328 Vali Acc: 0.079 Test Loss: 4.328 Test Acc: 0.079
Validation loss decreased (-0.077802 --> -0.078990).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7901773
	speed: 0.1939s/iter; left time: 3812.7003s
	iters: 200, epoch: 6 | loss: 2.4106669
	speed: 0.0445s/iter; left time: 871.4281s
Epoch: 6 cost time: 10.084529638290405
Epoch: 6, Steps: 208 | Train Loss: 3.068 Vali Loss: 4.165 Vali Acc: 0.095 Test Loss: 4.165 Test Acc: 0.095
Validation loss decreased (-0.078990 --> -0.095097).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4588428
	speed: 0.1978s/iter; left time: 3847.2081s
	iters: 200, epoch: 7 | loss: 2.7669818
	speed: 0.0475s/iter; left time: 918.7384s
Epoch: 7 cost time: 10.467716217041016
Epoch: 7, Steps: 208 | Train Loss: 2.996 Vali Loss: 4.542 Vali Acc: 0.086 Test Loss: 4.542 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.8026836
	speed: 0.1902s/iter; left time: 3659.6365s
	iters: 200, epoch: 8 | loss: 1.8706909
	speed: 0.0360s/iter; left time: 688.5513s
Epoch: 8 cost time: 8.193256378173828
Epoch: 8, Steps: 208 | Train Loss: 2.831 Vali Loss: 4.903 Vali Acc: 0.089 Test Loss: 4.903 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.7665355
	speed: 0.1978s/iter; left time: 3764.9563s
	iters: 200, epoch: 9 | loss: 3.3810730
	speed: 0.0452s/iter; left time: 856.5058s
Epoch: 9 cost time: 9.98772644996643
Epoch: 9, Steps: 208 | Train Loss: 2.680 Vali Loss: 4.787 Vali Acc: 0.104 Test Loss: 4.787 Test Acc: 0.104
Validation loss decreased (-0.095097 --> -0.104038).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9964514
	speed: 0.1900s/iter; left time: 3576.6372s
	iters: 200, epoch: 10 | loss: 2.8312004
	speed: 0.0567s/iter; left time: 1062.4710s
Epoch: 10 cost time: 11.320655584335327
Epoch: 10, Steps: 208 | Train Loss: 2.470 Vali Loss: 5.559 Vali Acc: 0.101 Test Loss: 5.559 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1853969
	speed: 0.2078s/iter; left time: 3869.7001s
	iters: 200, epoch: 11 | loss: 2.0472007
	speed: 0.0508s/iter; left time: 941.6237s
Epoch: 11 cost time: 11.543083190917969
Epoch: 11, Steps: 208 | Train Loss: 2.206 Vali Loss: 5.914 Vali Acc: 0.100 Test Loss: 5.914 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8312316
	speed: 0.2069s/iter; left time: 3810.4328s
	iters: 200, epoch: 12 | loss: 1.3973426
	speed: 0.0519s/iter; left time: 950.1244s
Epoch: 12 cost time: 12.167728424072266
Epoch: 12, Steps: 208 | Train Loss: 1.976 Vali Loss: 6.359 Vali Acc: 0.110 Test Loss: 6.359 Test Acc: 0.110
Validation loss decreased (-0.104038 --> -0.110285).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8818221
	speed: 0.1881s/iter; left time: 3423.7977s
	iters: 200, epoch: 13 | loss: 2.0649972
	speed: 0.0364s/iter; left time: 659.4005s
Epoch: 13 cost time: 8.69209337234497
Epoch: 13, Steps: 208 | Train Loss: 1.742 Vali Loss: 5.539 Vali Acc: 0.103 Test Loss: 5.539 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.8149002
	speed: 0.1969s/iter; left time: 3543.0886s
	iters: 200, epoch: 14 | loss: 1.8769913
	speed: 0.0279s/iter; left time: 499.3313s
Epoch: 14 cost time: 6.828677415847778
Epoch: 14, Steps: 208 | Train Loss: 1.510 Vali Loss: 6.420 Vali Acc: 0.100 Test Loss: 6.420 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5287144
	speed: 0.1850s/iter; left time: 3291.7361s
	iters: 200, epoch: 15 | loss: 1.0927664
	speed: 0.0345s/iter; left time: 609.6499s
Epoch: 15 cost time: 7.7426581382751465
Epoch: 15, Steps: 208 | Train Loss: 1.384 Vali Loss: 6.255 Vali Acc: 0.108 Test Loss: 6.255 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6296365
	speed: 0.1943s/iter; left time: 3415.1646s
	iters: 200, epoch: 16 | loss: 1.3312827
	speed: 0.0343s/iter; left time: 600.0078s
Epoch: 16 cost time: 8.550117015838623
Epoch: 16, Steps: 208 | Train Loss: 1.181 Vali Loss: 6.954 Vali Acc: 0.109 Test Loss: 6.954 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6643348
	speed: 0.1877s/iter; left time: 3261.5078s
	iters: 200, epoch: 17 | loss: 0.6326764
	speed: 0.0338s/iter; left time: 583.3332s
Epoch: 17 cost time: 7.208754062652588
Epoch: 17, Steps: 208 | Train Loss: 1.017 Vali Loss: 7.287 Vali Acc: 0.110 Test Loss: 7.287 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.3897367
	speed: 0.1928s/iter; left time: 3309.9416s
	iters: 200, epoch: 18 | loss: 0.6931788
	speed: 0.0398s/iter; left time: 679.0895s
Epoch: 18 cost time: 9.449154376983643
Epoch: 18, Steps: 208 | Train Loss: 0.860 Vali Loss: 7.365 Vali Acc: 0.106 Test Loss: 7.365 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.8059757
	speed: 0.1975s/iter; left time: 3348.9375s
	iters: 200, epoch: 19 | loss: 0.3083887
	speed: 0.0442s/iter; left time: 745.2282s
Epoch: 19 cost time: 9.72229528427124
Epoch: 19, Steps: 208 | Train Loss: 0.748 Vali Loss: 8.133 Vali Acc: 0.105 Test Loss: 8.133 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.0765994
	speed: 0.1826s/iter; left time: 3058.4888s
	iters: 200, epoch: 20 | loss: 1.1223524
	speed: 0.0297s/iter; left time: 494.5946s
Epoch: 20 cost time: 6.81521201133728
Epoch: 20, Steps: 208 | Train Loss: 0.677 Vali Loss: 8.362 Vali Acc: 0.107 Test Loss: 8.362 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3602797
	speed: 0.1924s/iter; left time: 3181.9614s
	iters: 200, epoch: 21 | loss: 0.4552639
	speed: 0.0352s/iter; left time: 578.5548s
Epoch: 21 cost time: 8.51792311668396
Epoch: 21, Steps: 208 | Train Loss: 0.582 Vali Loss: 8.631 Vali Acc: 0.114 Test Loss: 8.631 Test Acc: 0.114
Validation loss decreased (-0.110285 --> -0.114140).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0179167
	speed: 0.1942s/iter; left time: 3171.7687s
	iters: 200, epoch: 22 | loss: 0.1577264
	speed: 0.0453s/iter; left time: 734.9628s
Epoch: 22 cost time: 10.081496953964233
Epoch: 22, Steps: 208 | Train Loss: 0.557 Vali Loss: 8.770 Vali Acc: 0.105 Test Loss: 8.770 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1554835
	speed: 0.1980s/iter; left time: 3192.7435s
	iters: 200, epoch: 23 | loss: 0.7157783
	speed: 0.0456s/iter; left time: 730.4210s
Epoch: 23 cost time: 10.216494083404541
Epoch: 23, Steps: 208 | Train Loss: 0.493 Vali Loss: 9.089 Vali Acc: 0.098 Test Loss: 9.089 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.4919305
	speed: 0.2011s/iter; left time: 3200.2764s
	iters: 200, epoch: 24 | loss: 0.4764298
	speed: 0.0431s/iter; left time: 681.6387s
Epoch: 24 cost time: 9.763755798339844
Epoch: 24, Steps: 208 | Train Loss: 0.435 Vali Loss: 9.761 Vali Acc: 0.105 Test Loss: 9.761 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.2134888
	speed: 0.2234s/iter; left time: 3509.6692s
	iters: 200, epoch: 25 | loss: 1.0657858
	speed: 0.0520s/iter; left time: 811.2613s
Epoch: 25 cost time: 11.51505732536316
Epoch: 25, Steps: 208 | Train Loss: 0.405 Vali Loss: 9.723 Vali Acc: 0.108 Test Loss: 9.723 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.2844247
	speed: 0.1977s/iter; left time: 3065.2501s
	iters: 200, epoch: 26 | loss: 0.2627549
	speed: 0.0435s/iter; left time: 669.7820s
Epoch: 26 cost time: 9.751538038253784
Epoch: 26, Steps: 208 | Train Loss: 0.380 Vali Loss: 9.719 Vali Acc: 0.107 Test Loss: 9.719 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.3193687
	speed: 0.1992s/iter; left time: 3046.8974s
	iters: 200, epoch: 27 | loss: 0.7290485
	speed: 0.0410s/iter; left time: 623.4910s
Epoch: 27 cost time: 9.371687889099121
Epoch: 27, Steps: 208 | Train Loss: 0.385 Vali Loss: 10.085 Vali Acc: 0.115 Test Loss: 10.085 Test Acc: 0.115
Validation loss decreased (-0.114140 --> -0.115020).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.1452470
	speed: 0.2069s/iter; left time: 3121.0926s
	iters: 200, epoch: 28 | loss: 0.0520873
	speed: 0.0404s/iter; left time: 605.6203s
Epoch: 28 cost time: 9.701645135879517
Epoch: 28, Steps: 208 | Train Loss: 0.337 Vali Loss: 10.942 Vali Acc: 0.105 Test Loss: 10.942 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.1866164
	speed: 0.2063s/iter; left time: 3068.5214s
	iters: 200, epoch: 29 | loss: 0.5418416
	speed: 0.0445s/iter; left time: 657.4701s
Epoch: 29 cost time: 9.943313837051392
Epoch: 29, Steps: 208 | Train Loss: 0.367 Vali Loss: 10.917 Vali Acc: 0.104 Test Loss: 10.917 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0730063
	speed: 0.2132s/iter; left time: 3127.0377s
	iters: 200, epoch: 30 | loss: 0.7633091
	speed: 0.0444s/iter; left time: 646.7241s
Epoch: 30 cost time: 9.983746528625488
Epoch: 30, Steps: 208 | Train Loss: 0.338 Vali Loss: 11.306 Vali Acc: 0.106 Test Loss: 11.306 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.2265318
	speed: 0.2008s/iter; left time: 2903.1980s
	iters: 200, epoch: 31 | loss: 0.1178801
	speed: 0.0358s/iter; left time: 514.7378s
Epoch: 31 cost time: 8.374712467193604
Epoch: 31, Steps: 208 | Train Loss: 0.322 Vali Loss: 11.026 Vali Acc: 0.106 Test Loss: 11.026 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.3358701
	speed: 0.2021s/iter; left time: 2880.0606s
	iters: 200, epoch: 32 | loss: 0.0362615
	speed: 0.0362s/iter; left time: 512.8746s
Epoch: 32 cost time: 8.263310194015503
Epoch: 32, Steps: 208 | Train Loss: 0.286 Vali Loss: 12.022 Vali Acc: 0.108 Test Loss: 12.022 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0511917
	speed: 0.1926s/iter; left time: 2704.4461s
	iters: 200, epoch: 33 | loss: 0.1333607
	speed: 0.0452s/iter; left time: 630.3599s
Epoch: 33 cost time: 9.844826221466064
Epoch: 33, Steps: 208 | Train Loss: 0.279 Vali Loss: 11.945 Vali Acc: 0.098 Test Loss: 11.945 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0819713
	speed: 0.1975s/iter; left time: 2733.0093s
	iters: 200, epoch: 34 | loss: 0.4980159
	speed: 0.0384s/iter; left time: 527.2167s
Epoch: 34 cost time: 8.562965631484985
Epoch: 34, Steps: 208 | Train Loss: 0.272 Vali Loss: 12.606 Vali Acc: 0.103 Test Loss: 12.606 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.1824161
	speed: 0.1895s/iter; left time: 2582.7349s
	iters: 200, epoch: 35 | loss: 0.1341705
	speed: 0.0374s/iter; left time: 505.4209s
Epoch: 35 cost time: 7.820188999176025
Epoch: 35, Steps: 208 | Train Loss: 0.273 Vali Loss: 11.988 Vali Acc: 0.098 Test Loss: 11.988 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0108236
	speed: 0.1938s/iter; left time: 2600.4513s
	iters: 200, epoch: 36 | loss: 0.0659585
	speed: 0.0344s/iter; left time: 457.7387s
Epoch: 36 cost time: 7.628281354904175
Epoch: 36, Steps: 208 | Train Loss: 0.255 Vali Loss: 11.781 Vali Acc: 0.102 Test Loss: 11.781 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.3198046
	speed: 0.2020s/iter; left time: 2669.4902s
	iters: 200, epoch: 37 | loss: 0.0363582
	speed: 0.0374s/iter; left time: 490.0991s
Epoch: 37 cost time: 8.138349294662476
Epoch: 37, Steps: 208 | Train Loss: 0.259 Vali Loss: 12.381 Vali Acc: 0.107 Test Loss: 12.381 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11512078735460782
model parameter : 491303
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 8.4383488
	speed: 0.0938s/iter; left time: 1942.3079s
	iters: 200, epoch: 1 | loss: 3.6913068
	speed: 0.0736s/iter; left time: 1515.5320s
Epoch: 1 cost time: 17.47554063796997
Epoch: 1, Steps: 208 | Train Loss: 5.955 Vali Loss: 3.715 Vali Acc: 0.071 Test Loss: 3.715 Test Acc: 0.071
Validation loss decreased (inf --> -0.070944).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9562151
	speed: 0.2935s/iter; left time: 6015.6467s
	iters: 200, epoch: 2 | loss: 4.2865133
	speed: 0.0763s/iter; left time: 1556.2574s
Epoch: 2 cost time: 16.73758840560913
Epoch: 2, Steps: 208 | Train Loss: 4.263 Vali Loss: 3.843 Vali Acc: 0.082 Test Loss: 3.843 Test Acc: 0.082
Validation loss decreased (-0.070944 --> -0.081978).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.3452311
	speed: 0.2728s/iter; left time: 5533.4491s
	iters: 200, epoch: 3 | loss: 6.4201856
	speed: 0.0679s/iter; left time: 1370.8146s
Epoch: 3 cost time: 14.599823713302612
Epoch: 3, Steps: 208 | Train Loss: 5.121 Vali Loss: 4.192 Vali Acc: 0.098 Test Loss: 4.192 Test Acc: 0.098
Validation loss decreased (-0.081978 --> -0.097781).  Saving model ...
	iters: 100, epoch: 4 | loss: 7.0901241
	speed: 0.2685s/iter; left time: 5391.0259s
	iters: 200, epoch: 4 | loss: 6.0602083
	speed: 0.0684s/iter; left time: 1366.9139s
Epoch: 4 cost time: 14.550539493560791
Epoch: 4, Steps: 208 | Train Loss: 5.753 Vali Loss: 5.259 Vali Acc: 0.088 Test Loss: 5.259 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 6.2104769
	speed: 0.2494s/iter; left time: 4954.4146s
	iters: 200, epoch: 5 | loss: 4.7618408
	speed: 0.0622s/iter; left time: 1229.5784s
Epoch: 5 cost time: 13.0211341381073
Epoch: 5, Steps: 208 | Train Loss: 5.874 Vali Loss: 6.075 Vali Acc: 0.106 Test Loss: 6.075 Test Acc: 0.106
Validation loss decreased (-0.097781 --> -0.105516).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.6556711
	speed: 0.2767s/iter; left time: 5439.3340s
	iters: 200, epoch: 6 | loss: 7.0178099
	speed: 0.0837s/iter; left time: 1636.7103s
Epoch: 6 cost time: 17.51604461669922
Epoch: 6, Steps: 208 | Train Loss: 5.804 Vali Loss: 6.192 Vali Acc: 0.087 Test Loss: 6.192 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 6.3355579
	speed: 0.2963s/iter; left time: 5763.4585s
	iters: 200, epoch: 7 | loss: 3.8255656
	speed: 0.0786s/iter; left time: 1521.6759s
Epoch: 7 cost time: 17.007027626037598
Epoch: 7, Steps: 208 | Train Loss: 5.387 Vali Loss: 6.551 Vali Acc: 0.106 Test Loss: 6.551 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 8.5580883
	speed: 0.2992s/iter; left time: 5757.4946s
	iters: 200, epoch: 8 | loss: 5.8822427
	speed: 0.0667s/iter; left time: 1277.6400s
Epoch: 8 cost time: 15.97708249092102
Epoch: 8, Steps: 208 | Train Loss: 4.550 Vali Loss: 6.566 Vali Acc: 0.102 Test Loss: 6.566 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.2844367
	speed: 0.2630s/iter; left time: 5007.4221s
	iters: 200, epoch: 9 | loss: 6.2677989
	speed: 0.0420s/iter; left time: 796.0913s
Epoch: 9 cost time: 12.121764659881592
Epoch: 9, Steps: 208 | Train Loss: 3.647 Vali Loss: 9.754 Vali Acc: 0.069 Test Loss: 9.754 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.4102013
	speed: 0.2268s/iter; left time: 4271.2490s
	iters: 200, epoch: 10 | loss: 3.7097967
	speed: 0.0532s/iter; left time: 996.8724s
Epoch: 10 cost time: 11.843485355377197
Epoch: 10, Steps: 208 | Train Loss: 2.487 Vali Loss: 10.611 Vali Acc: 0.064 Test Loss: 10.611 Test Acc: 0.064
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.0970237
	speed: 0.2291s/iter; left time: 4265.7422s
	iters: 200, epoch: 11 | loss: 2.1364708
	speed: 0.0542s/iter; left time: 1004.5992s
Epoch: 11 cost time: 11.468449115753174
Epoch: 11, Steps: 208 | Train Loss: 1.746 Vali Loss: 7.506 Vali Acc: 0.098 Test Loss: 7.506 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.0256741
	speed: 0.2449s/iter; left time: 4508.7022s
	iters: 200, epoch: 12 | loss: 2.5518007
	speed: 0.0720s/iter; left time: 1317.6661s
Epoch: 12 cost time: 14.378849267959595
Epoch: 12, Steps: 208 | Train Loss: 1.338 Vali Loss: 8.363 Vali Acc: 0.067 Test Loss: 8.363 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6868246
	speed: 0.2721s/iter; left time: 4952.8302s
	iters: 200, epoch: 13 | loss: 0.5386398
	speed: 0.0663s/iter; left time: 1200.2417s
Epoch: 13 cost time: 14.672349691390991
Epoch: 13, Steps: 208 | Train Loss: 1.076 Vali Loss: 7.436 Vali Acc: 0.100 Test Loss: 7.436 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.2733660
	speed: 0.2600s/iter; left time: 4679.4991s
	iters: 200, epoch: 14 | loss: 0.6962228
	speed: 0.0497s/iter; left time: 889.2001s
Epoch: 14 cost time: 11.413347005844116
Epoch: 14, Steps: 208 | Train Loss: 0.905 Vali Loss: 8.088 Vali Acc: 0.103 Test Loss: 8.088 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.8348923
	speed: 0.2106s/iter; left time: 3746.3093s
	iters: 200, epoch: 15 | loss: 0.6785694
	speed: 0.0530s/iter; left time: 937.7541s
Epoch: 15 cost time: 11.075616836547852
Epoch: 15, Steps: 208 | Train Loss: 0.749 Vali Loss: 8.252 Vali Acc: 0.106 Test Loss: 8.252 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10557709513868178
model parameter : 4037863
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.4755559
	speed: 0.0641s/iter; left time: 1327.5913s
	iters: 200, epoch: 1 | loss: 4.0348101
	speed: 0.0400s/iter; left time: 824.1038s
Epoch: 1 cost time: 10.861865043640137
Epoch: 1, Steps: 208 | Train Loss: 4.923 Vali Loss: 3.633 Vali Acc: 0.068 Test Loss: 3.633 Test Acc: 0.068
Validation loss decreased (inf --> -0.067664).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0738139
	speed: 0.2100s/iter; left time: 4304.5376s
	iters: 200, epoch: 2 | loss: 3.8090434
	speed: 0.0453s/iter; left time: 923.7307s
Epoch: 2 cost time: 10.357042789459229
Epoch: 2, Steps: 208 | Train Loss: 3.721 Vali Loss: 3.603 Vali Acc: 0.094 Test Loss: 3.603 Test Acc: 0.094
Validation loss decreased (-0.067664 --> -0.093611).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1282563
	speed: 0.2410s/iter; left time: 4889.0128s
	iters: 200, epoch: 3 | loss: 3.6058557
	speed: 0.0538s/iter; left time: 1085.6836s
Epoch: 3 cost time: 12.402451276779175
Epoch: 3, Steps: 208 | Train Loss: 4.158 Vali Loss: 4.545 Vali Acc: 0.087 Test Loss: 4.545 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 6.2868018
	speed: 0.2199s/iter; left time: 4414.3822s
	iters: 200, epoch: 4 | loss: 5.3006997
	speed: 0.0569s/iter; left time: 1136.7192s
Epoch: 4 cost time: 12.139686346054077
Epoch: 4, Steps: 208 | Train Loss: 4.411 Vali Loss: 4.470 Vali Acc: 0.106 Test Loss: 4.470 Test Acc: 0.106
Validation loss decreased (-0.093611 --> -0.105532).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.8463526
	speed: 0.2210s/iter; left time: 4390.6278s
	iters: 200, epoch: 5 | loss: 4.6873417
	speed: 0.0471s/iter; left time: 932.0377s
Epoch: 5 cost time: 11.02160906791687
Epoch: 5, Steps: 208 | Train Loss: 4.571 Vali Loss: 4.263 Vali Acc: 0.118 Test Loss: 4.263 Test Acc: 0.118
Validation loss decreased (-0.105532 --> -0.118359).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.6761107
	speed: 0.2126s/iter; left time: 4179.1992s
	iters: 200, epoch: 6 | loss: 5.7810359
	speed: 0.0474s/iter; left time: 927.7409s
Epoch: 6 cost time: 10.82353687286377
Epoch: 6, Steps: 208 | Train Loss: 4.461 Vali Loss: 4.774 Vali Acc: 0.125 Test Loss: 4.774 Test Acc: 0.125
Validation loss decreased (-0.118359 --> -0.125213).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.5408230
	speed: 0.2206s/iter; left time: 4292.1332s
	iters: 200, epoch: 7 | loss: 3.8012857
	speed: 0.0538s/iter; left time: 1041.1736s
Epoch: 7 cost time: 11.384676694869995
Epoch: 7, Steps: 208 | Train Loss: 4.219 Vali Loss: 5.142 Vali Acc: 0.120 Test Loss: 5.142 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 5.4857101
	speed: 0.2179s/iter; left time: 4193.0228s
	iters: 200, epoch: 8 | loss: 3.7289112
	speed: 0.0535s/iter; left time: 1023.3709s
Epoch: 8 cost time: 11.524799346923828
Epoch: 8, Steps: 208 | Train Loss: 3.850 Vali Loss: 5.076 Vali Acc: 0.120 Test Loss: 5.076 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 4.1114779
	speed: 0.2145s/iter; left time: 4083.0307s
	iters: 200, epoch: 9 | loss: 4.1645098
	speed: 0.0541s/iter; left time: 1024.1140s
Epoch: 9 cost time: 11.669152021408081
Epoch: 9, Steps: 208 | Train Loss: 3.193 Vali Loss: 5.652 Vali Acc: 0.122 Test Loss: 5.652 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.4599247
	speed: 0.2381s/iter; left time: 4482.5501s
	iters: 200, epoch: 10 | loss: 2.3145227
	speed: 0.0527s/iter; left time: 986.9512s
Epoch: 10 cost time: 12.88385558128357
Epoch: 10, Steps: 208 | Train Loss: 2.548 Vali Loss: 6.243 Vali Acc: 0.108 Test Loss: 6.243 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8453677
	speed: 0.2085s/iter; left time: 3882.9463s
	iters: 200, epoch: 11 | loss: 2.4315896
	speed: 0.0535s/iter; left time: 990.2750s
Epoch: 11 cost time: 11.014043092727661
Epoch: 11, Steps: 208 | Train Loss: 1.880 Vali Loss: 6.231 Vali Acc: 0.130 Test Loss: 6.231 Test Acc: 0.130
Validation loss decreased (-0.125213 --> -0.129672).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9944393
	speed: 0.1767s/iter; left time: 3254.0286s
	iters: 200, epoch: 12 | loss: 1.7565358
	speed: 0.0369s/iter; left time: 675.6976s
Epoch: 12 cost time: 8.216721057891846
Epoch: 12, Steps: 208 | Train Loss: 1.459 Vali Loss: 6.217 Vali Acc: 0.124 Test Loss: 6.217 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1844145
	speed: 0.1813s/iter; left time: 3300.9369s
	iters: 200, epoch: 13 | loss: 1.4079120
	speed: 0.0358s/iter; left time: 648.3842s
Epoch: 13 cost time: 7.838659763336182
Epoch: 13, Steps: 208 | Train Loss: 1.181 Vali Loss: 7.251 Vali Acc: 0.116 Test Loss: 7.251 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3447423
	speed: 0.1829s/iter; left time: 3292.4330s
	iters: 200, epoch: 14 | loss: 2.0193403
	speed: 0.0366s/iter; left time: 655.2095s
Epoch: 14 cost time: 8.301325798034668
Epoch: 14, Steps: 208 | Train Loss: 0.982 Vali Loss: 7.250 Vali Acc: 0.117 Test Loss: 7.250 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9159166
	speed: 0.1978s/iter; left time: 3518.6497s
	iters: 200, epoch: 15 | loss: 1.2355572
	speed: 0.0285s/iter; left time: 503.7911s
Epoch: 15 cost time: 7.411736965179443
Epoch: 15, Steps: 208 | Train Loss: 0.819 Vali Loss: 7.132 Vali Acc: 0.127 Test Loss: 7.132 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5037683
	speed: 0.1636s/iter; left time: 2876.9256s
	iters: 200, epoch: 16 | loss: 0.9879453
	speed: 0.0486s/iter; left time: 850.0256s
Epoch: 16 cost time: 9.328681707382202
Epoch: 16, Steps: 208 | Train Loss: 0.640 Vali Loss: 7.963 Vali Acc: 0.122 Test Loss: 7.963 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1858244
	speed: 0.2085s/iter; left time: 3622.3529s
	iters: 200, epoch: 17 | loss: 1.4289359
	speed: 0.0443s/iter; left time: 765.2044s
Epoch: 17 cost time: 9.72023606300354
Epoch: 17, Steps: 208 | Train Loss: 0.568 Vali Loss: 7.709 Vali Acc: 0.120 Test Loss: 7.709 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1768621
	speed: 0.2138s/iter; left time: 3669.2698s
	iters: 200, epoch: 18 | loss: 0.4056153
	speed: 0.0451s/iter; left time: 769.5524s
Epoch: 18 cost time: 10.250934839248657
Epoch: 18, Steps: 208 | Train Loss: 0.423 Vali Loss: 8.267 Vali Acc: 0.123 Test Loss: 8.267 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2201928
	speed: 0.1858s/iter; left time: 3150.8450s
	iters: 200, epoch: 19 | loss: 0.7032231
	speed: 0.0359s/iter; left time: 604.5064s
Epoch: 19 cost time: 8.37050175666809
Epoch: 19, Steps: 208 | Train Loss: 0.371 Vali Loss: 8.651 Vali Acc: 0.127 Test Loss: 8.651 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1775533
	speed: 0.2143s/iter; left time: 3590.0362s
	iters: 200, epoch: 20 | loss: 0.4870737
	speed: 0.0494s/iter; left time: 822.2393s
Epoch: 20 cost time: 11.14961862564087
Epoch: 20, Steps: 208 | Train Loss: 0.322 Vali Loss: 9.617 Vali Acc: 0.120 Test Loss: 9.617 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.1076486
	speed: 0.2056s/iter; left time: 3400.4646s
	iters: 200, epoch: 21 | loss: 0.2679586
	speed: 0.0484s/iter; left time: 796.5220s
Epoch: 21 cost time: 10.848025798797607
Epoch: 21, Steps: 208 | Train Loss: 0.288 Vali Loss: 9.665 Vali Acc: 0.112 Test Loss: 9.665 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12973456606024455
model parameter : 2061671
model size : 10.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8877554
	speed: 0.0799s/iter; left time: 1653.9556s
	iters: 200, epoch: 1 | loss: 3.8384686
	speed: 0.0522s/iter; left time: 1074.4771s
Epoch: 1 cost time: 13.69525694847107
Epoch: 1, Steps: 208 | Train Loss: 4.729 Vali Loss: 3.711 Vali Acc: 0.071 Test Loss: 3.711 Test Acc: 0.071
Validation loss decreased (inf --> -0.070646).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8607008
	speed: 0.2003s/iter; left time: 4104.2899s
	iters: 200, epoch: 2 | loss: 3.6392577
	speed: 0.0503s/iter; left time: 1025.0109s
Epoch: 2 cost time: 11.029405117034912
Epoch: 2, Steps: 208 | Train Loss: 3.587 Vali Loss: 3.677 Vali Acc: 0.079 Test Loss: 3.677 Test Acc: 0.079
Validation loss decreased (-0.070646 --> -0.079295).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7158854
	speed: 0.1977s/iter; left time: 4010.4050s
	iters: 200, epoch: 3 | loss: 4.8818607
	speed: 0.0487s/iter; left time: 982.3208s
Epoch: 3 cost time: 10.646522998809814
Epoch: 3, Steps: 208 | Train Loss: 3.736 Vali Loss: 3.766 Vali Acc: 0.105 Test Loss: 3.766 Test Acc: 0.105
Validation loss decreased (-0.079295 --> -0.104645).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.8663092
	speed: 0.1966s/iter; left time: 3946.6958s
	iters: 200, epoch: 4 | loss: 5.1113253
	speed: 0.0408s/iter; left time: 815.5713s
Epoch: 4 cost time: 9.141162395477295
Epoch: 4, Steps: 208 | Train Loss: 3.913 Vali Loss: 4.110 Vali Acc: 0.107 Test Loss: 4.110 Test Acc: 0.107
Validation loss decreased (-0.104645 --> -0.107325).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7958252
	speed: 0.1848s/iter; left time: 3672.7324s
	iters: 200, epoch: 5 | loss: 4.8255110
	speed: 0.0431s/iter; left time: 852.6544s
Epoch: 5 cost time: 9.718945503234863
Epoch: 5, Steps: 208 | Train Loss: 4.018 Vali Loss: 4.300 Vali Acc: 0.103 Test Loss: 4.300 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.8785205
	speed: 0.1919s/iter; left time: 3773.6646s
	iters: 200, epoch: 6 | loss: 5.6398363
	speed: 0.0338s/iter; left time: 660.3782s
Epoch: 6 cost time: 8.06382703781128
Epoch: 6, Steps: 208 | Train Loss: 4.024 Vali Loss: 4.494 Vali Acc: 0.113 Test Loss: 4.494 Test Acc: 0.113
Validation loss decreased (-0.107325 --> -0.112988).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7706814
	speed: 0.1582s/iter; left time: 3077.5348s
	iters: 200, epoch: 7 | loss: 3.5916824
	speed: 0.0323s/iter; left time: 624.3343s
Epoch: 7 cost time: 7.359215259552002
Epoch: 7, Steps: 208 | Train Loss: 3.818 Vali Loss: 4.644 Vali Acc: 0.123 Test Loss: 4.644 Test Acc: 0.123
Validation loss decreased (-0.112988 --> -0.123425).  Saving model ...
	iters: 100, epoch: 8 | loss: 4.5045762
	speed: 0.1805s/iter; left time: 3473.4196s
	iters: 200, epoch: 8 | loss: 2.6414776
	speed: 0.0339s/iter; left time: 648.6968s
Epoch: 8 cost time: 7.47906494140625
Epoch: 8, Steps: 208 | Train Loss: 3.457 Vali Loss: 5.060 Vali Acc: 0.117 Test Loss: 5.060 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5230742
	speed: 0.1908s/iter; left time: 3632.9036s
	iters: 200, epoch: 9 | loss: 2.0205469
	speed: 0.0358s/iter; left time: 677.6023s
Epoch: 9 cost time: 9.169847011566162
Epoch: 9, Steps: 208 | Train Loss: 3.036 Vali Loss: 5.478 Vali Acc: 0.123 Test Loss: 5.478 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.7964046
	speed: 0.1894s/iter; left time: 3566.6888s
	iters: 200, epoch: 10 | loss: 3.6658125
	speed: 0.0390s/iter; left time: 730.5644s
Epoch: 10 cost time: 8.784538269042969
Epoch: 10, Steps: 208 | Train Loss: 2.626 Vali Loss: 5.885 Vali Acc: 0.090 Test Loss: 5.885 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5718973
	speed: 0.1647s/iter; left time: 3066.9414s
	iters: 200, epoch: 11 | loss: 2.3860462
	speed: 0.0314s/iter; left time: 581.8975s
Epoch: 11 cost time: 6.686434507369995
Epoch: 11, Steps: 208 | Train Loss: 1.973 Vali Loss: 5.858 Vali Acc: 0.121 Test Loss: 5.858 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2489460
	speed: 0.1565s/iter; left time: 2881.0915s
	iters: 200, epoch: 12 | loss: 1.3625798
	speed: 0.0292s/iter; left time: 535.0648s
Epoch: 12 cost time: 6.7707860469818115
Epoch: 12, Steps: 208 | Train Loss: 1.586 Vali Loss: 5.935 Vali Acc: 0.111 Test Loss: 5.935 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0599980
	speed: 0.1813s/iter; left time: 3300.6852s
	iters: 200, epoch: 13 | loss: 1.8122913
	speed: 0.0339s/iter; left time: 613.8775s
Epoch: 13 cost time: 7.6390910148620605
Epoch: 13, Steps: 208 | Train Loss: 1.241 Vali Loss: 6.056 Vali Acc: 0.117 Test Loss: 6.056 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.6596668
	speed: 0.1569s/iter; left time: 2823.4036s
	iters: 200, epoch: 14 | loss: 0.6920929
	speed: 0.0344s/iter; left time: 614.8998s
Epoch: 14 cost time: 7.337337255477905
Epoch: 14, Steps: 208 | Train Loss: 0.962 Vali Loss: 6.988 Vali Acc: 0.118 Test Loss: 6.988 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.4053003
	speed: 0.1745s/iter; left time: 3103.8004s
	iters: 200, epoch: 15 | loss: 0.5225975
	speed: 0.0274s/iter; left time: 484.2486s
Epoch: 15 cost time: 6.571729421615601
Epoch: 15, Steps: 208 | Train Loss: 0.744 Vali Loss: 7.106 Vali Acc: 0.119 Test Loss: 7.106 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2962547
	speed: 0.1851s/iter; left time: 3253.3934s
	iters: 200, epoch: 16 | loss: 1.0766196
	speed: 0.0508s/iter; left time: 887.4516s
Epoch: 16 cost time: 10.626065731048584
Epoch: 16, Steps: 208 | Train Loss: 0.604 Vali Loss: 7.589 Vali Acc: 0.123 Test Loss: 7.589 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0556335
	speed: 0.2061s/iter; left time: 3580.3843s
	iters: 200, epoch: 17 | loss: 0.8547162
	speed: 0.0517s/iter; left time: 893.0727s
Epoch: 17 cost time: 11.431098699569702
Epoch: 17, Steps: 208 | Train Loss: 0.520 Vali Loss: 7.918 Vali Acc: 0.125 Test Loss: 7.918 Test Acc: 0.125
Validation loss decreased (-0.123425 --> -0.124585).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4485411
	speed: 0.1886s/iter; left time: 3237.8808s
	iters: 200, epoch: 18 | loss: 0.3431785
	speed: 0.0457s/iter; left time: 779.1840s
Epoch: 18 cost time: 10.18459439277649
Epoch: 18, Steps: 208 | Train Loss: 0.462 Vali Loss: 8.324 Vali Acc: 0.121 Test Loss: 8.324 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3783751
	speed: 0.1948s/iter; left time: 3303.0739s
	iters: 200, epoch: 19 | loss: 0.3476737
	speed: 0.0413s/iter; left time: 695.4049s
Epoch: 19 cost time: 9.31570291519165
Epoch: 19, Steps: 208 | Train Loss: 0.360 Vali Loss: 8.843 Vali Acc: 0.123 Test Loss: 8.843 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3511714
	speed: 0.1870s/iter; left time: 3132.4787s
	iters: 200, epoch: 20 | loss: 0.0619564
	speed: 0.0381s/iter; left time: 634.3378s
Epoch: 20 cost time: 8.690712451934814
Epoch: 20, Steps: 208 | Train Loss: 0.371 Vali Loss: 9.578 Vali Acc: 0.118 Test Loss: 9.578 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.6848693
	speed: 0.1738s/iter; left time: 2875.4597s
	iters: 200, epoch: 21 | loss: 0.4340540
	speed: 0.0412s/iter; left time: 678.1781s
Epoch: 21 cost time: 9.17224407196045
Epoch: 21, Steps: 208 | Train Loss: 0.331 Vali Loss: 9.372 Vali Acc: 0.114 Test Loss: 9.372 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0260797
	speed: 0.1860s/iter; left time: 3037.8112s
	iters: 200, epoch: 22 | loss: 0.3175843
	speed: 0.0386s/iter; left time: 626.2241s
Epoch: 22 cost time: 8.696226119995117
Epoch: 22, Steps: 208 | Train Loss: 0.305 Vali Loss: 9.435 Vali Acc: 0.111 Test Loss: 9.435 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0326799
	speed: 0.1746s/iter; left time: 2816.1375s
	iters: 200, epoch: 23 | loss: 0.2749824
	speed: 0.0336s/iter; left time: 538.3683s
Epoch: 23 cost time: 7.804347276687622
Epoch: 23, Steps: 208 | Train Loss: 0.256 Vali Loss: 9.999 Vali Acc: 0.113 Test Loss: 9.999 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.1073024
	speed: 0.2002s/iter; left time: 3187.2209s
	iters: 200, epoch: 24 | loss: 0.1425208
	speed: 0.0488s/iter; left time: 772.0011s
Epoch: 24 cost time: 10.891459941864014
Epoch: 24, Steps: 208 | Train Loss: 0.239 Vali Loss: 10.352 Vali Acc: 0.118 Test Loss: 10.352 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0687773
	speed: 0.1976s/iter; left time: 3104.5426s
	iters: 200, epoch: 25 | loss: 0.3181259
	speed: 0.0369s/iter; left time: 575.4322s
Epoch: 25 cost time: 8.514467716217041
Epoch: 25, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.639 Vali Acc: 0.116 Test Loss: 10.639 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2282099
	speed: 0.1763s/iter; left time: 2732.8843s
	iters: 200, epoch: 26 | loss: 0.1612725
	speed: 0.0268s/iter; left time: 412.7536s
Epoch: 26 cost time: 6.670058727264404
Epoch: 26, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.969 Vali Acc: 0.106 Test Loss: 10.969 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.4384670
	speed: 0.1583s/iter; left time: 2421.0434s
	iters: 200, epoch: 27 | loss: 0.5360943
	speed: 0.0271s/iter; left time: 412.1367s
Epoch: 27 cost time: 6.368833303451538
Epoch: 27, Steps: 208 | Train Loss: 0.223 Vali Loss: 11.410 Vali Acc: 0.119 Test Loss: 11.410 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 1403495
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7831435
	speed: 0.0564s/iter; left time: 1168.4769s
	iters: 200, epoch: 1 | loss: 4.6221371
	speed: 0.0282s/iter; left time: 580.9701s
Epoch: 1 cost time: 8.854602813720703
Epoch: 1, Steps: 208 | Train Loss: 4.577 Vali Loss: 4.029 Vali Acc: 0.056 Test Loss: 4.029 Test Acc: 0.056
Validation loss decreased (inf --> -0.055731).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6178398
	speed: 0.1651s/iter; left time: 3383.8844s
	iters: 200, epoch: 2 | loss: 3.3781643
	speed: 0.0282s/iter; left time: 575.4945s
Epoch: 2 cost time: 6.6879589557647705
Epoch: 2, Steps: 208 | Train Loss: 3.564 Vali Loss: 3.545 Vali Acc: 0.085 Test Loss: 3.545 Test Acc: 0.085
Validation loss decreased (-0.055731 --> -0.085261).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9322577
	speed: 0.1802s/iter; left time: 3655.6600s
	iters: 200, epoch: 3 | loss: 3.8893673
	speed: 0.0383s/iter; left time: 772.6958s
Epoch: 3 cost time: 8.784655570983887
Epoch: 3, Steps: 208 | Train Loss: 3.595 Vali Loss: 3.808 Vali Acc: 0.095 Test Loss: 3.808 Test Acc: 0.095
Validation loss decreased (-0.085261 --> -0.095399).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3044884
	speed: 0.1873s/iter; left time: 3760.9775s
	iters: 200, epoch: 4 | loss: 3.0646822
	speed: 0.0370s/iter; left time: 740.1471s
Epoch: 4 cost time: 8.636740922927856
Epoch: 4, Steps: 208 | Train Loss: 3.731 Vali Loss: 4.004 Vali Acc: 0.101 Test Loss: 4.004 Test Acc: 0.101
Validation loss decreased (-0.095399 --> -0.101362).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8719068
	speed: 0.1753s/iter; left time: 3482.2138s
	iters: 200, epoch: 5 | loss: 3.9848926
	speed: 0.0291s/iter; left time: 575.5830s
Epoch: 5 cost time: 7.811520099639893
Epoch: 5, Steps: 208 | Train Loss: 3.759 Vali Loss: 4.070 Vali Acc: 0.103 Test Loss: 4.070 Test Acc: 0.103
Validation loss decreased (-0.101362 --> -0.103449).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2419841
	speed: 0.1549s/iter; left time: 3044.8447s
	iters: 200, epoch: 6 | loss: 3.0050192
	speed: 0.0354s/iter; left time: 691.5649s
Epoch: 6 cost time: 7.1768903732299805
Epoch: 6, Steps: 208 | Train Loss: 3.710 Vali Loss: 4.295 Vali Acc: 0.112 Test Loss: 4.295 Test Acc: 0.112
Validation loss decreased (-0.103449 --> -0.112394).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.7535658
	speed: 0.1785s/iter; left time: 3473.2785s
	iters: 200, epoch: 7 | loss: 3.5742438
	speed: 0.0402s/iter; left time: 778.7619s
Epoch: 7 cost time: 8.903834819793701
Epoch: 7, Steps: 208 | Train Loss: 3.568 Vali Loss: 4.627 Vali Acc: 0.110 Test Loss: 4.627 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3936942
	speed: 0.1851s/iter; left time: 3562.5120s
	iters: 200, epoch: 8 | loss: 5.0038157
	speed: 0.0387s/iter; left time: 741.0222s
Epoch: 8 cost time: 8.608346223831177
Epoch: 8, Steps: 208 | Train Loss: 3.350 Vali Loss: 4.564 Vali Acc: 0.118 Test Loss: 4.564 Test Acc: 0.118
Validation loss decreased (-0.112394 --> -0.117461).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0558951
	speed: 0.1785s/iter; left time: 3398.3508s
	iters: 200, epoch: 9 | loss: 3.2883079
	speed: 0.0385s/iter; left time: 729.5745s
Epoch: 9 cost time: 8.761553525924683
Epoch: 9, Steps: 208 | Train Loss: 2.911 Vali Loss: 4.999 Vali Acc: 0.110 Test Loss: 4.999 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.9306674
	speed: 0.1859s/iter; left time: 3500.5431s
	iters: 200, epoch: 10 | loss: 2.6713898
	speed: 0.0447s/iter; left time: 837.8835s
Epoch: 10 cost time: 9.725388526916504
Epoch: 10, Steps: 208 | Train Loss: 2.488 Vali Loss: 5.920 Vali Acc: 0.105 Test Loss: 5.920 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3142772
	speed: 0.1825s/iter; left time: 3397.6948s
	iters: 200, epoch: 11 | loss: 1.8862271
	speed: 0.0483s/iter; left time: 895.1679s
Epoch: 11 cost time: 10.507052659988403
Epoch: 11, Steps: 208 | Train Loss: 2.049 Vali Loss: 5.719 Vali Acc: 0.114 Test Loss: 5.719 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4854162
	speed: 0.2030s/iter; left time: 3737.8871s
	iters: 200, epoch: 12 | loss: 2.1350968
	speed: 0.0478s/iter; left time: 874.7245s
Epoch: 12 cost time: 10.901753187179565
Epoch: 12, Steps: 208 | Train Loss: 1.638 Vali Loss: 5.738 Vali Acc: 0.109 Test Loss: 5.738 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1407963
	speed: 0.1871s/iter; left time: 3405.6333s
	iters: 200, epoch: 13 | loss: 1.4664203
	speed: 0.0377s/iter; left time: 682.5454s
Epoch: 13 cost time: 8.428882837295532
Epoch: 13, Steps: 208 | Train Loss: 1.269 Vali Loss: 6.646 Vali Acc: 0.110 Test Loss: 6.646 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 2.0714834
	speed: 0.1723s/iter; left time: 3100.9362s
	iters: 200, epoch: 14 | loss: 1.0550749
	speed: 0.0383s/iter; left time: 685.2546s
Epoch: 14 cost time: 8.471554279327393
Epoch: 14, Steps: 208 | Train Loss: 0.967 Vali Loss: 6.641 Vali Acc: 0.104 Test Loss: 6.641 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.4808714
	speed: 0.1820s/iter; left time: 3237.8572s
	iters: 200, epoch: 15 | loss: 1.3667823
	speed: 0.0396s/iter; left time: 700.9248s
Epoch: 15 cost time: 8.89892053604126
Epoch: 15, Steps: 208 | Train Loss: 0.838 Vali Loss: 7.456 Vali Acc: 0.110 Test Loss: 7.456 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.3024061
	speed: 0.1532s/iter; left time: 2693.0274s
	iters: 200, epoch: 16 | loss: 0.4257409
	speed: 0.0260s/iter; left time: 454.4036s
Epoch: 16 cost time: 6.218249082565308
Epoch: 16, Steps: 208 | Train Loss: 0.662 Vali Loss: 7.482 Vali Acc: 0.111 Test Loss: 7.482 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.3839391
	speed: 0.1560s/iter; left time: 2709.3489s
	iters: 200, epoch: 17 | loss: 0.3820327
	speed: 0.0317s/iter; left time: 548.0539s
Epoch: 17 cost time: 7.008006811141968
Epoch: 17, Steps: 208 | Train Loss: 0.514 Vali Loss: 7.982 Vali Acc: 0.111 Test Loss: 7.982 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.5499399
	speed: 0.1641s/iter; left time: 2816.7429s
	iters: 200, epoch: 18 | loss: 0.7210018
	speed: 0.0269s/iter; left time: 459.5365s
Epoch: 18 cost time: 6.832157611846924
Epoch: 18, Steps: 208 | Train Loss: 0.495 Vali Loss: 8.341 Vali Acc: 0.109 Test Loss: 8.341 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11750671040858933
model parameter : 1129575
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7762771
	speed: 0.0509s/iter; left time: 1054.0173s
	iters: 200, epoch: 1 | loss: 4.5758662
	speed: 0.0211s/iter; left time: 434.8000s
Epoch: 1 cost time: 7.633578300476074
Epoch: 1, Steps: 208 | Train Loss: 4.248 Vali Loss: 4.169 Vali Acc: 0.051 Test Loss: 4.169 Test Acc: 0.051
Validation loss decreased (inf --> -0.051256).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7246699
	speed: 0.1548s/iter; left time: 3172.6227s
	iters: 200, epoch: 2 | loss: 3.3907454
	speed: 0.0333s/iter; left time: 679.3031s
Epoch: 2 cost time: 7.07399845123291
Epoch: 2, Steps: 208 | Train Loss: 3.570 Vali Loss: 3.540 Vali Acc: 0.089 Test Loss: 3.540 Test Acc: 0.089
Validation loss decreased (-0.051256 --> -0.088840).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8151197
	speed: 0.1737s/iter; left time: 3524.4773s
	iters: 200, epoch: 3 | loss: 3.6859896
	speed: 0.0328s/iter; left time: 662.4669s
Epoch: 3 cost time: 8.039631366729736
Epoch: 3, Steps: 208 | Train Loss: 3.417 Vali Loss: 4.311 Vali Acc: 0.046 Test Loss: 4.311 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.8415096
	speed: 0.1750s/iter; left time: 3513.8603s
	iters: 200, epoch: 4 | loss: 3.3786170
	speed: 0.0309s/iter; left time: 617.2637s
Epoch: 4 cost time: 7.509949207305908
Epoch: 4, Steps: 208 | Train Loss: 3.430 Vali Loss: 3.999 Vali Acc: 0.093 Test Loss: 3.999 Test Acc: 0.093
Validation loss decreased (-0.088840 --> -0.093309).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4573729
	speed: 0.1741s/iter; left time: 3458.3615s
	iters: 200, epoch: 5 | loss: 4.3508043
	speed: 0.0251s/iter; left time: 495.5715s
Epoch: 5 cost time: 6.422774791717529
Epoch: 5, Steps: 208 | Train Loss: 3.445 Vali Loss: 4.040 Vali Acc: 0.104 Test Loss: 4.040 Test Acc: 0.104
Validation loss decreased (-0.093309 --> -0.104045).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.5198011
	speed: 0.1522s/iter; left time: 2993.0905s
	iters: 200, epoch: 6 | loss: 3.6838052
	speed: 0.0336s/iter; left time: 657.4752s
Epoch: 6 cost time: 6.736616373062134
Epoch: 6, Steps: 208 | Train Loss: 3.400 Vali Loss: 4.573 Vali Acc: 0.104 Test Loss: 4.573 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.8168478
	speed: 0.1763s/iter; left time: 3428.8633s
	iters: 200, epoch: 7 | loss: 3.6207166
	speed: 0.0317s/iter; left time: 613.6870s
Epoch: 7 cost time: 7.285532712936401
Epoch: 7, Steps: 208 | Train Loss: 3.338 Vali Loss: 4.778 Vali Acc: 0.101 Test Loss: 4.778 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.5151348
	speed: 0.1630s/iter; left time: 3137.2835s
	iters: 200, epoch: 8 | loss: 3.5007143
	speed: 0.0387s/iter; left time: 741.5706s
Epoch: 8 cost time: 8.693047285079956
Epoch: 8, Steps: 208 | Train Loss: 3.132 Vali Loss: 4.701 Vali Acc: 0.106 Test Loss: 4.701 Test Acc: 0.106
Validation loss decreased (-0.104045 --> -0.105828).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7369170
	speed: 0.1551s/iter; left time: 2951.7138s
	iters: 200, epoch: 9 | loss: 3.0012796
	speed: 0.0179s/iter; left time: 339.7055s
Epoch: 9 cost time: 4.679773569107056
Epoch: 9, Steps: 208 | Train Loss: 2.913 Vali Loss: 4.966 Vali Acc: 0.112 Test Loss: 4.966 Test Acc: 0.112
Validation loss decreased (-0.105828 --> -0.112387).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2150819
	speed: 0.1310s/iter; left time: 2466.6387s
	iters: 200, epoch: 10 | loss: 2.5184453
	speed: 0.0224s/iter; left time: 420.0909s
Epoch: 10 cost time: 4.9154298305511475
Epoch: 10, Steps: 208 | Train Loss: 2.661 Vali Loss: 5.027 Vali Acc: 0.114 Test Loss: 5.027 Test Acc: 0.114
Validation loss decreased (-0.112387 --> -0.113878).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0101297
	speed: 0.1413s/iter; left time: 2631.6250s
	iters: 200, epoch: 11 | loss: 3.0881834
	speed: 0.0229s/iter; left time: 424.7925s
Epoch: 11 cost time: 5.463467359542847
Epoch: 11, Steps: 208 | Train Loss: 2.283 Vali Loss: 5.369 Vali Acc: 0.110 Test Loss: 5.369 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6440284
	speed: 0.1771s/iter; left time: 3260.4983s
	iters: 200, epoch: 12 | loss: 1.9720583
	speed: 0.0355s/iter; left time: 650.1737s
Epoch: 12 cost time: 7.988540887832642
Epoch: 12, Steps: 208 | Train Loss: 2.049 Vali Loss: 5.394 Vali Acc: 0.119 Test Loss: 5.394 Test Acc: 0.119
Validation loss decreased (-0.113878 --> -0.118944).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6077250
	speed: 0.1616s/iter; left time: 2942.2493s
	iters: 200, epoch: 13 | loss: 2.1998205
	speed: 0.0288s/iter; left time: 522.0445s
Epoch: 13 cost time: 6.894585132598877
Epoch: 13, Steps: 208 | Train Loss: 1.696 Vali Loss: 5.531 Vali Acc: 0.112 Test Loss: 5.531 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9082295
	speed: 0.1689s/iter; left time: 3040.3816s
	iters: 200, epoch: 14 | loss: 1.4200648
	speed: 0.0359s/iter; left time: 642.9024s
Epoch: 14 cost time: 8.284499645233154
Epoch: 14, Steps: 208 | Train Loss: 1.451 Vali Loss: 5.851 Vali Acc: 0.112 Test Loss: 5.851 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5089414
	speed: 0.1790s/iter; left time: 3184.3751s
	iters: 200, epoch: 15 | loss: 1.3463703
	speed: 0.0353s/iter; left time: 623.9066s
Epoch: 15 cost time: 8.120624303817749
Epoch: 15, Steps: 208 | Train Loss: 1.227 Vali Loss: 6.426 Vali Acc: 0.112 Test Loss: 6.426 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8859226
	speed: 0.1795s/iter; left time: 3155.5903s
	iters: 200, epoch: 16 | loss: 1.3124716
	speed: 0.0376s/iter; left time: 658.0824s
Epoch: 16 cost time: 8.602924823760986
Epoch: 16, Steps: 208 | Train Loss: 1.007 Vali Loss: 6.825 Vali Acc: 0.112 Test Loss: 6.825 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6526219
	speed: 0.2003s/iter; left time: 3480.1489s
	iters: 200, epoch: 17 | loss: 0.8616253
	speed: 0.0436s/iter; left time: 752.5099s
Epoch: 17 cost time: 9.624561548233032
Epoch: 17, Steps: 208 | Train Loss: 0.861 Vali Loss: 7.023 Vali Acc: 0.117 Test Loss: 7.023 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1097876
	speed: 0.1842s/iter; left time: 3161.5320s
	iters: 200, epoch: 18 | loss: 0.9606363
	speed: 0.0364s/iter; left time: 621.2909s
Epoch: 18 cost time: 8.708662748336792
Epoch: 18, Steps: 208 | Train Loss: 0.711 Vali Loss: 7.707 Vali Acc: 0.112 Test Loss: 7.707 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4413583
	speed: 0.1710s/iter; left time: 2899.9968s
	iters: 200, epoch: 19 | loss: 0.8100646
	speed: 0.0224s/iter; left time: 378.0108s
Epoch: 19 cost time: 6.6950695514678955
Epoch: 19, Steps: 208 | Train Loss: 0.627 Vali Loss: 7.895 Vali Acc: 0.111 Test Loss: 7.895 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6296424
	speed: 0.1516s/iter; left time: 2539.8277s
	iters: 200, epoch: 20 | loss: 0.5267239
	speed: 0.0235s/iter; left time: 391.5352s
Epoch: 20 cost time: 5.439094066619873
Epoch: 20, Steps: 208 | Train Loss: 0.547 Vali Loss: 7.821 Vali Acc: 0.106 Test Loss: 7.821 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.4400376
	speed: 0.1493s/iter; left time: 2469.4315s
	iters: 200, epoch: 21 | loss: 0.2794263
	speed: 0.0256s/iter; left time: 421.3547s
Epoch: 21 cost time: 5.772191762924194
Epoch: 21, Steps: 208 | Train Loss: 0.458 Vali Loss: 8.730 Vali Acc: 0.105 Test Loss: 8.730 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.8457252
	speed: 0.1619s/iter; left time: 2643.7978s
	iters: 200, epoch: 22 | loss: 0.4603913
	speed: 0.0254s/iter; left time: 412.7012s
Epoch: 22 cost time: 5.779908895492554
Epoch: 22, Steps: 208 | Train Loss: 0.421 Vali Loss: 9.348 Vali Acc: 0.110 Test Loss: 9.348 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11899791231732777
model parameter : 746599
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8716092
	speed: 0.0495s/iter; left time: 1024.5280s
	iters: 200, epoch: 1 | loss: 4.3149037
	speed: 0.0210s/iter; left time: 433.2621s
Epoch: 1 cost time: 7.3046276569366455
Epoch: 1, Steps: 208 | Train Loss: 4.119 Vali Loss: 4.468 Vali Acc: 0.057 Test Loss: 4.468 Test Acc: 0.057
Validation loss decreased (inf --> -0.056621).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7769463
	speed: 0.1621s/iter; left time: 3322.6938s
	iters: 200, epoch: 2 | loss: 3.4920018
	speed: 0.0297s/iter; left time: 604.7255s
Epoch: 2 cost time: 7.19466233253479
Epoch: 2, Steps: 208 | Train Loss: 3.716 Vali Loss: 3.550 Vali Acc: 0.073 Test Loss: 3.550 Test Acc: 0.073
Validation loss decreased (-0.056621 --> -0.073332).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8414137
	speed: 0.1763s/iter; left time: 3576.1385s
	iters: 200, epoch: 3 | loss: 2.9352751
	speed: 0.0314s/iter; left time: 634.1822s
Epoch: 3 cost time: 7.264904260635376
Epoch: 3, Steps: 208 | Train Loss: 3.344 Vali Loss: 3.923 Vali Acc: 0.085 Test Loss: 3.923 Test Acc: 0.085
Validation loss decreased (-0.073332 --> -0.085258).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9205680
	speed: 0.1659s/iter; left time: 3330.8132s
	iters: 200, epoch: 4 | loss: 3.2419388
	speed: 0.0242s/iter; left time: 483.3825s
Epoch: 4 cost time: 6.02778959274292
Epoch: 4, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.832 Vali Acc: 0.094 Test Loss: 3.832 Test Acc: 0.094
Validation loss decreased (-0.085258 --> -0.093609).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8746369
	speed: 0.1838s/iter; left time: 3651.4009s
	iters: 200, epoch: 5 | loss: 2.8937507
	speed: 0.0354s/iter; left time: 699.2099s
Epoch: 5 cost time: 8.287114143371582
Epoch: 5, Steps: 208 | Train Loss: 3.338 Vali Loss: 4.478 Vali Acc: 0.085 Test Loss: 4.478 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.3466244
	speed: 0.1871s/iter; left time: 3677.6958s
	iters: 200, epoch: 6 | loss: 2.4920146
	speed: 0.0378s/iter; left time: 738.5623s
Epoch: 6 cost time: 8.556835412979126
Epoch: 6, Steps: 208 | Train Loss: 3.250 Vali Loss: 4.526 Vali Acc: 0.104 Test Loss: 4.526 Test Acc: 0.104
Validation loss decreased (-0.093609 --> -0.103742).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8729980
	speed: 0.1661s/iter; left time: 3231.2311s
	iters: 200, epoch: 7 | loss: 2.7340655
	speed: 0.0293s/iter; left time: 566.9746s
Epoch: 7 cost time: 6.6295037269592285
Epoch: 7, Steps: 208 | Train Loss: 3.171 Vali Loss: 4.497 Vali Acc: 0.097 Test Loss: 4.497 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.1235495
	speed: 0.1562s/iter; left time: 3006.5207s
	iters: 200, epoch: 8 | loss: 3.3231378
	speed: 0.0443s/iter; left time: 847.4369s
Epoch: 8 cost time: 9.176753520965576
Epoch: 8, Steps: 208 | Train Loss: 2.962 Vali Loss: 4.473 Vali Acc: 0.103 Test Loss: 4.473 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.6336532
	speed: 0.1957s/iter; left time: 3726.1624s
	iters: 200, epoch: 9 | loss: 3.7329926
	speed: 0.0524s/iter; left time: 991.6612s
Epoch: 9 cost time: 11.169471263885498
Epoch: 9, Steps: 208 | Train Loss: 2.772 Vali Loss: 4.798 Vali Acc: 0.108 Test Loss: 4.798 Test Acc: 0.108
Validation loss decreased (-0.103742 --> -0.107617).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7713737
	speed: 0.2194s/iter; left time: 4130.7893s
	iters: 200, epoch: 10 | loss: 2.5317667
	speed: 0.0480s/iter; left time: 898.3791s
Epoch: 10 cost time: 11.591115236282349
Epoch: 10, Steps: 208 | Train Loss: 2.557 Vali Loss: 5.188 Vali Acc: 0.109 Test Loss: 5.188 Test Acc: 0.109
Validation loss decreased (-0.107617 --> -0.109104).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.6358671
	speed: 0.2143s/iter; left time: 3990.6536s
	iters: 200, epoch: 11 | loss: 3.2444339
	speed: 0.0566s/iter; left time: 1048.0317s
Epoch: 11 cost time: 12.42520022392273
Epoch: 11, Steps: 208 | Train Loss: 2.307 Vali Loss: 5.131 Vali Acc: 0.108 Test Loss: 5.131 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9263840
	speed: 0.1968s/iter; left time: 3623.6229s
	iters: 200, epoch: 12 | loss: 2.6807442
	speed: 0.0357s/iter; left time: 652.8838s
Epoch: 12 cost time: 9.490428924560547
Epoch: 12, Steps: 208 | Train Loss: 2.080 Vali Loss: 5.526 Vali Acc: 0.107 Test Loss: 5.526 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6208487
	speed: 0.1820s/iter; left time: 3313.5516s
	iters: 200, epoch: 13 | loss: 2.2225420
	speed: 0.0326s/iter; left time: 590.6450s
Epoch: 13 cost time: 7.246631383895874
Epoch: 13, Steps: 208 | Train Loss: 1.784 Vali Loss: 5.623 Vali Acc: 0.100 Test Loss: 5.623 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.5187804
	speed: 0.1588s/iter; left time: 2857.1658s
	iters: 200, epoch: 14 | loss: 1.4198105
	speed: 0.0254s/iter; left time: 454.3149s
Epoch: 14 cost time: 5.816959857940674
Epoch: 14, Steps: 208 | Train Loss: 1.555 Vali Loss: 5.990 Vali Acc: 0.113 Test Loss: 5.990 Test Acc: 0.113
Validation loss decreased (-0.109104 --> -0.112973).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3055325
	speed: 0.1674s/iter; left time: 2977.6331s
	iters: 200, epoch: 15 | loss: 1.6555620
	speed: 0.0267s/iter; left time: 472.9994s
Epoch: 15 cost time: 6.427725791931152
Epoch: 15, Steps: 208 | Train Loss: 1.339 Vali Loss: 6.486 Vali Acc: 0.106 Test Loss: 6.486 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4310039
	speed: 0.1507s/iter; left time: 2649.8276s
	iters: 200, epoch: 16 | loss: 1.4415518
	speed: 0.0232s/iter; left time: 405.9870s
Epoch: 16 cost time: 5.707799434661865
Epoch: 16, Steps: 208 | Train Loss: 1.124 Vali Loss: 6.442 Vali Acc: 0.108 Test Loss: 6.442 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7008410
	speed: 0.1885s/iter; left time: 3274.8775s
	iters: 200, epoch: 17 | loss: 1.4102027
	speed: 0.0445s/iter; left time: 768.1558s
Epoch: 17 cost time: 9.822420120239258
Epoch: 17, Steps: 208 | Train Loss: 0.953 Vali Loss: 7.030 Vali Acc: 0.110 Test Loss: 7.030 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7149251
	speed: 0.1916s/iter; left time: 3288.9557s
	iters: 200, epoch: 18 | loss: 0.6753654
	speed: 0.0442s/iter; left time: 754.9531s
Epoch: 18 cost time: 9.95317268371582
Epoch: 18, Steps: 208 | Train Loss: 0.823 Vali Loss: 7.351 Vali Acc: 0.114 Test Loss: 7.351 Test Acc: 0.114
Validation loss decreased (-0.112973 --> -0.114153).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2543204
	speed: 0.1893s/iter; left time: 3209.2333s
	iters: 200, epoch: 19 | loss: 1.2849205
	speed: 0.0327s/iter; left time: 551.5302s
Epoch: 19 cost time: 7.6652514934539795
Epoch: 19, Steps: 208 | Train Loss: 0.704 Vali Loss: 7.338 Vali Acc: 0.107 Test Loss: 7.338 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7727559
	speed: 0.1779s/iter; left time: 2980.4079s
	iters: 200, epoch: 20 | loss: 0.4790097
	speed: 0.0306s/iter; left time: 509.8657s
Epoch: 20 cost time: 6.632254362106323
Epoch: 20, Steps: 208 | Train Loss: 0.658 Vali Loss: 8.059 Vali Acc: 0.109 Test Loss: 8.059 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.9111893
	speed: 0.1678s/iter; left time: 2775.1535s
	iters: 200, epoch: 21 | loss: 0.7269405
	speed: 0.0322s/iter; left time: 528.6459s
Epoch: 21 cost time: 7.3872175216674805
Epoch: 21, Steps: 208 | Train Loss: 0.549 Vali Loss: 8.802 Vali Acc: 0.113 Test Loss: 8.802 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.0778532
	speed: 0.1883s/iter; left time: 3075.5756s
	iters: 200, epoch: 22 | loss: 0.3627377
	speed: 0.0376s/iter; left time: 611.0621s
Epoch: 22 cost time: 9.057182550430298
Epoch: 22, Steps: 208 | Train Loss: 0.481 Vali Loss: 8.777 Vali Acc: 0.111 Test Loss: 8.777 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.4397215
	speed: 0.1904s/iter; left time: 3069.8130s
	iters: 200, epoch: 23 | loss: 0.2409716
	speed: 0.0465s/iter; left time: 744.5613s
Epoch: 23 cost time: 10.186729431152344
Epoch: 23, Steps: 208 | Train Loss: 0.440 Vali Loss: 9.444 Vali Acc: 0.112 Test Loss: 9.444 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.3469677
	speed: 0.2193s/iter; left time: 3490.6942s
	iters: 200, epoch: 24 | loss: 1.0097681
	speed: 0.0554s/iter; left time: 876.6617s
Epoch: 24 cost time: 12.139606714248657
Epoch: 24, Steps: 208 | Train Loss: 0.386 Vali Loss: 9.162 Vali Acc: 0.113 Test Loss: 9.162 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1167457
	speed: 0.2143s/iter; left time: 3367.0331s
	iters: 200, epoch: 25 | loss: 0.3164972
	speed: 0.0540s/iter; left time: 843.2001s
Epoch: 25 cost time: 11.643009662628174
Epoch: 25, Steps: 208 | Train Loss: 0.408 Vali Loss: 9.876 Vali Acc: 0.111 Test Loss: 9.876 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1832569
	speed: 0.2010s/iter; left time: 3115.3365s
	iters: 200, epoch: 26 | loss: 0.2419222
	speed: 0.0396s/iter; left time: 610.1876s
Epoch: 26 cost time: 9.179195165634155
Epoch: 26, Steps: 208 | Train Loss: 0.369 Vali Loss: 10.444 Vali Acc: 0.101 Test Loss: 10.444 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.5617230
	speed: 0.2026s/iter; left time: 3098.0904s
	iters: 200, epoch: 27 | loss: 0.3143194
	speed: 0.0375s/iter; left time: 569.4773s
Epoch: 27 cost time: 9.026041984558105
Epoch: 27, Steps: 208 | Train Loss: 0.337 Vali Loss: 9.948 Vali Acc: 0.107 Test Loss: 9.948 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.1570204
	speed: 0.2073s/iter; left time: 3127.7002s
	iters: 200, epoch: 28 | loss: 0.4788304
	speed: 0.0484s/iter; left time: 724.7130s
Epoch: 28 cost time: 10.2922043800354
Epoch: 28, Steps: 208 | Train Loss: 0.364 Vali Loss: 10.629 Vali Acc: 0.113 Test Loss: 10.629 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11422606620936475
model parameter : 583271
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8391597
	speed: 0.0553s/iter; left time: 1144.8865s
	iters: 200, epoch: 1 | loss: 4.4119582
	speed: 0.0298s/iter; left time: 614.5261s
Epoch: 1 cost time: 8.897383213043213
Epoch: 1, Steps: 208 | Train Loss: 3.999 Vali Loss: 4.219 Vali Acc: 0.054 Test Loss: 4.219 Test Acc: 0.054
Validation loss decreased (inf --> -0.054238).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2681413
	speed: 0.1755s/iter; left time: 3595.7150s
	iters: 200, epoch: 2 | loss: 3.8098631
	speed: 0.0387s/iter; left time: 788.9423s
Epoch: 2 cost time: 8.542309045791626
Epoch: 2, Steps: 208 | Train Loss: 3.771 Vali Loss: 3.845 Vali Acc: 0.057 Test Loss: 3.845 Test Acc: 0.057
Validation loss decreased (-0.054238 --> -0.056627).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5153894
	speed: 0.1980s/iter; left time: 4017.0376s
	iters: 200, epoch: 3 | loss: 3.5812047
	speed: 0.0489s/iter; left time: 987.4518s
Epoch: 3 cost time: 10.430712223052979
Epoch: 3, Steps: 208 | Train Loss: 3.347 Vali Loss: 4.069 Vali Acc: 0.064 Test Loss: 4.069 Test Acc: 0.064
Validation loss decreased (-0.056627 --> -0.063783).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5364246
	speed: 0.1841s/iter; left time: 3696.4412s
	iters: 200, epoch: 4 | loss: 4.0843215
	speed: 0.0371s/iter; left time: 742.0174s
Epoch: 4 cost time: 8.210566997528076
Epoch: 4, Steps: 208 | Train Loss: 3.270 Vali Loss: 3.914 Vali Acc: 0.096 Test Loss: 3.914 Test Acc: 0.096
Validation loss decreased (-0.063783 --> -0.096293).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5059524
	speed: 0.1817s/iter; left time: 3610.6912s
	iters: 200, epoch: 5 | loss: 3.8229122
	speed: 0.0290s/iter; left time: 572.4589s
Epoch: 5 cost time: 7.307297229766846
Epoch: 5, Steps: 208 | Train Loss: 3.235 Vali Loss: 4.063 Vali Acc: 0.088 Test Loss: 4.063 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9438972
	speed: 0.1703s/iter; left time: 3348.4816s
	iters: 200, epoch: 6 | loss: 2.7791455
	speed: 0.0258s/iter; left time: 504.5481s
Epoch: 6 cost time: 6.355932712554932
Epoch: 6, Steps: 208 | Train Loss: 3.144 Vali Loss: 4.451 Vali Acc: 0.075 Test Loss: 4.451 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.9652181
	speed: 0.1708s/iter; left time: 3322.0335s
	iters: 200, epoch: 7 | loss: 3.0664248
	speed: 0.0266s/iter; left time: 514.0072s
Epoch: 7 cost time: 6.479715824127197
Epoch: 7, Steps: 208 | Train Loss: 3.046 Vali Loss: 4.328 Vali Acc: 0.101 Test Loss: 4.328 Test Acc: 0.101
Validation loss decreased (-0.096293 --> -0.101358).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.5007210
	speed: 0.1928s/iter; left time: 3710.5251s
	iters: 200, epoch: 8 | loss: 3.4703944
	speed: 0.0466s/iter; left time: 892.9838s
Epoch: 8 cost time: 10.499380111694336
Epoch: 8, Steps: 208 | Train Loss: 2.893 Vali Loss: 4.759 Vali Acc: 0.098 Test Loss: 4.759 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5947254
	speed: 0.2044s/iter; left time: 3892.0634s
	iters: 200, epoch: 9 | loss: 2.3605049
	speed: 0.0566s/iter; left time: 1070.9074s
Epoch: 9 cost time: 12.22426462173462
Epoch: 9, Steps: 208 | Train Loss: 2.641 Vali Loss: 5.117 Vali Acc: 0.102 Test Loss: 5.117 Test Acc: 0.102
Validation loss decreased (-0.101358 --> -0.101649).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1237133
	speed: 0.2111s/iter; left time: 3974.4410s
	iters: 200, epoch: 10 | loss: 3.1494143
	speed: 0.0543s/iter; left time: 1016.4947s
Epoch: 10 cost time: 11.096661567687988
Epoch: 10, Steps: 208 | Train Loss: 2.526 Vali Loss: 5.532 Vali Acc: 0.102 Test Loss: 5.532 Test Acc: 0.102
Validation loss decreased (-0.101649 --> -0.102241).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6878589
	speed: 0.2162s/iter; left time: 4025.8702s
	iters: 200, epoch: 11 | loss: 2.0083961
	speed: 0.0489s/iter; left time: 905.2078s
Epoch: 11 cost time: 11.16987657546997
Epoch: 11, Steps: 208 | Train Loss: 2.269 Vali Loss: 5.421 Vali Acc: 0.095 Test Loss: 5.421 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4418479
	speed: 0.1825s/iter; left time: 3360.7813s
	iters: 200, epoch: 12 | loss: 3.1661296
	speed: 0.0368s/iter; left time: 673.9246s
Epoch: 12 cost time: 8.466849327087402
Epoch: 12, Steps: 208 | Train Loss: 2.069 Vali Loss: 5.534 Vali Acc: 0.094 Test Loss: 5.534 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.1907108
	speed: 0.2012s/iter; left time: 3662.4636s
	iters: 200, epoch: 13 | loss: 1.9375157
	speed: 0.0450s/iter; left time: 815.4971s
Epoch: 13 cost time: 9.937134742736816
Epoch: 13, Steps: 208 | Train Loss: 1.824 Vali Loss: 5.853 Vali Acc: 0.089 Test Loss: 5.853 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.7431884
	speed: 0.1951s/iter; left time: 3511.0628s
	iters: 200, epoch: 14 | loss: 1.3392706
	speed: 0.0433s/iter; left time: 774.9199s
Epoch: 14 cost time: 9.832290649414062
Epoch: 14, Steps: 208 | Train Loss: 1.588 Vali Loss: 6.147 Vali Acc: 0.097 Test Loss: 6.147 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7565182
	speed: 0.2028s/iter; left time: 3608.1344s
	iters: 200, epoch: 15 | loss: 1.8058062
	speed: 0.0437s/iter; left time: 773.0325s
Epoch: 15 cost time: 9.111489295959473
Epoch: 15, Steps: 208 | Train Loss: 1.466 Vali Loss: 6.489 Vali Acc: 0.109 Test Loss: 6.489 Test Acc: 0.109
Validation loss decreased (-0.102241 --> -0.108793).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0471680
	speed: 0.1669s/iter; left time: 2934.8902s
	iters: 200, epoch: 16 | loss: 2.8630373
	speed: 0.0288s/iter; left time: 503.8505s
Epoch: 16 cost time: 6.03087854385376
Epoch: 16, Steps: 208 | Train Loss: 1.256 Vali Loss: 6.792 Vali Acc: 0.106 Test Loss: 6.792 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0690904
	speed: 0.1916s/iter; left time: 3328.9758s
	iters: 200, epoch: 17 | loss: 0.9832311
	speed: 0.0273s/iter; left time: 472.2212s
Epoch: 17 cost time: 6.891417026519775
Epoch: 17, Steps: 208 | Train Loss: 1.059 Vali Loss: 7.139 Vali Acc: 0.102 Test Loss: 7.139 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7548831
	speed: 0.1626s/iter; left time: 2791.6477s
	iters: 200, epoch: 18 | loss: 1.4156389
	speed: 0.0307s/iter; left time: 524.3146s
Epoch: 18 cost time: 6.999523639678955
Epoch: 18, Steps: 208 | Train Loss: 0.974 Vali Loss: 7.356 Vali Acc: 0.098 Test Loss: 7.356 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.2851310
	speed: 0.1673s/iter; left time: 2836.1701s
	iters: 200, epoch: 19 | loss: 1.1920607
	speed: 0.0309s/iter; left time: 521.4154s
Epoch: 19 cost time: 6.774418354034424
Epoch: 19, Steps: 208 | Train Loss: 0.842 Vali Loss: 7.584 Vali Acc: 0.102 Test Loss: 7.584 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.1055634
	speed: 0.1612s/iter; left time: 2700.0201s
	iters: 200, epoch: 20 | loss: 0.3717076
	speed: 0.0273s/iter; left time: 455.2379s
Epoch: 20 cost time: 6.89021372795105
Epoch: 20, Steps: 208 | Train Loss: 0.740 Vali Loss: 8.054 Vali Acc: 0.106 Test Loss: 8.054 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1418314
	speed: 0.1547s/iter; left time: 2559.2153s
	iters: 200, epoch: 21 | loss: 0.8307297
	speed: 0.0272s/iter; left time: 447.1043s
Epoch: 21 cost time: 6.305120229721069
Epoch: 21, Steps: 208 | Train Loss: 0.650 Vali Loss: 8.517 Vali Acc: 0.100 Test Loss: 8.517 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.7802392
	speed: 0.1554s/iter; left time: 2538.8348s
	iters: 200, epoch: 22 | loss: 0.7891837
	speed: 0.0232s/iter; left time: 377.3100s
Epoch: 22 cost time: 5.343671560287476
Epoch: 22, Steps: 208 | Train Loss: 0.565 Vali Loss: 9.057 Vali Acc: 0.102 Test Loss: 9.057 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.8664965
	speed: 0.1572s/iter; left time: 2534.5041s
	iters: 200, epoch: 23 | loss: 0.8077598
	speed: 0.0245s/iter; left time: 392.9523s
Epoch: 23 cost time: 5.584152460098267
Epoch: 23, Steps: 208 | Train Loss: 0.528 Vali Loss: 9.200 Vali Acc: 0.098 Test Loss: 9.200 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.5660577
	speed: 0.1564s/iter; left time: 2488.9582s
	iters: 200, epoch: 24 | loss: 0.3835133
	speed: 0.0363s/iter; left time: 574.6132s
Epoch: 24 cost time: 7.162686109542847
Epoch: 24, Steps: 208 | Train Loss: 0.518 Vali Loss: 9.186 Vali Acc: 0.101 Test Loss: 9.186 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.8052849
	speed: 0.2133s/iter; left time: 3351.2919s
	iters: 200, epoch: 25 | loss: 0.4044589
	speed: 0.0521s/iter; left time: 812.9476s
Epoch: 25 cost time: 11.478863000869751
Epoch: 25, Steps: 208 | Train Loss: 0.436 Vali Loss: 9.857 Vali Acc: 0.100 Test Loss: 9.857 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm128_nh16_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10885773933790635
model parameter : 474855
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.5394421
	speed: 0.0941s/iter; left time: 1948.8053s
	iters: 200, epoch: 1 | loss: 3.5783551
	speed: 0.0609s/iter; left time: 1254.2596s
Epoch: 1 cost time: 16.124027729034424
Epoch: 1, Steps: 208 | Train Loss: 5.290 Vali Loss: 4.885 Vali Acc: 0.053 Test Loss: 4.885 Test Acc: 0.053
Validation loss decreased (inf --> -0.052740).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8446059
	speed: 0.2405s/iter; left time: 4928.7947s
	iters: 200, epoch: 2 | loss: 4.4390001
	speed: 0.0623s/iter; left time: 1271.0294s
Epoch: 2 cost time: 13.554547786712646
Epoch: 2, Steps: 208 | Train Loss: 3.676 Vali Loss: 3.789 Vali Acc: 0.090 Test Loss: 3.789 Test Acc: 0.090
Validation loss decreased (-0.052740 --> -0.089732).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.4464264
	speed: 0.2531s/iter; left time: 5134.8940s
	iters: 200, epoch: 3 | loss: 3.6120570
	speed: 0.0623s/iter; left time: 1258.2330s
Epoch: 3 cost time: 13.722603797912598
Epoch: 3, Steps: 208 | Train Loss: 3.898 Vali Loss: 4.377 Vali Acc: 0.076 Test Loss: 4.377 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.8140287
	speed: 0.2623s/iter; left time: 5266.2431s
	iters: 200, epoch: 4 | loss: 5.7618079
	speed: 0.0685s/iter; left time: 1369.1901s
Epoch: 4 cost time: 14.933008193969727
Epoch: 4, Steps: 208 | Train Loss: 4.081 Vali Loss: 4.207 Vali Acc: 0.099 Test Loss: 4.207 Test Acc: 0.099
Validation loss decreased (-0.089732 --> -0.099272).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.6834779
	speed: 0.2801s/iter; left time: 5565.9137s
	iters: 200, epoch: 5 | loss: 6.1512532
	speed: 0.0667s/iter; left time: 1318.2234s
Epoch: 5 cost time: 14.9860098361969
Epoch: 5, Steps: 208 | Train Loss: 4.190 Vali Loss: 5.135 Vali Acc: 0.085 Test Loss: 5.135 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.6626430
	speed: 0.2683s/iter; left time: 5274.6922s
	iters: 200, epoch: 6 | loss: 2.4414177
	speed: 0.0585s/iter; left time: 1144.1997s
Epoch: 6 cost time: 13.546727657318115
Epoch: 6, Steps: 208 | Train Loss: 3.964 Vali Loss: 5.364 Vali Acc: 0.106 Test Loss: 5.364 Test Acc: 0.106
Validation loss decreased (-0.099272 --> -0.106120).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3199267
	speed: 0.2229s/iter; left time: 4336.8064s
	iters: 200, epoch: 7 | loss: 4.3565984
	speed: 0.0459s/iter; left time: 889.1795s
Epoch: 7 cost time: 11.007973670959473
Epoch: 7, Steps: 208 | Train Loss: 3.537 Vali Loss: 5.317 Vali Acc: 0.101 Test Loss: 5.317 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5576816
	speed: 0.2162s/iter; left time: 4160.8258s
	iters: 200, epoch: 8 | loss: 3.2075171
	speed: 0.0455s/iter; left time: 871.0458s
Epoch: 8 cost time: 10.679163694381714
Epoch: 8, Steps: 208 | Train Loss: 2.904 Vali Loss: 6.745 Vali Acc: 0.079 Test Loss: 6.745 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6338295
	speed: 0.2036s/iter; left time: 3876.6103s
	iters: 200, epoch: 9 | loss: 1.5881213
	speed: 0.0388s/iter; left time: 735.1484s
Epoch: 9 cost time: 9.240880727767944
Epoch: 9, Steps: 208 | Train Loss: 2.080 Vali Loss: 6.185 Vali Acc: 0.078 Test Loss: 6.185 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1962748
	speed: 0.2161s/iter; left time: 4068.0514s
	iters: 200, epoch: 10 | loss: 1.7256691
	speed: 0.0426s/iter; left time: 797.3426s
Epoch: 10 cost time: 10.511984586715698
Epoch: 10, Steps: 208 | Train Loss: 1.633 Vali Loss: 7.061 Vali Acc: 0.100 Test Loss: 7.061 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6234921
	speed: 0.2543s/iter; left time: 4734.8844s
	iters: 200, epoch: 11 | loss: 1.7006258
	speed: 0.0528s/iter; left time: 978.3543s
Epoch: 11 cost time: 12.616787910461426
Epoch: 11, Steps: 208 | Train Loss: 1.352 Vali Loss: 6.207 Vali Acc: 0.098 Test Loss: 6.207 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3447161
	speed: 0.2518s/iter; left time: 4637.0932s
	iters: 200, epoch: 12 | loss: 1.2777323
	speed: 0.0510s/iter; left time: 934.2797s
Epoch: 12 cost time: 12.173856258392334
Epoch: 12, Steps: 208 | Train Loss: 1.152 Vali Loss: 6.440 Vali Acc: 0.102 Test Loss: 6.440 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.5141351
	speed: 0.2296s/iter; left time: 4179.9332s
	iters: 200, epoch: 13 | loss: 1.1989444
	speed: 0.0562s/iter; left time: 1017.1701s
Epoch: 13 cost time: 12.59549069404602
Epoch: 13, Steps: 208 | Train Loss: 0.976 Vali Loss: 7.705 Vali Acc: 0.100 Test Loss: 7.705 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.8069268
	speed: 0.2387s/iter; left time: 4295.2280s
	iters: 200, epoch: 14 | loss: 0.8233324
	speed: 0.0552s/iter; left time: 988.2649s
Epoch: 14 cost time: 12.208517789840698
Epoch: 14, Steps: 208 | Train Loss: 0.820 Vali Loss: 7.820 Vali Acc: 0.099 Test Loss: 7.820 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.5699258
	speed: 0.2415s/iter; left time: 4296.3524s
	iters: 200, epoch: 15 | loss: 1.0021622
	speed: 0.0558s/iter; left time: 986.6544s
Epoch: 15 cost time: 12.526278257369995
Epoch: 15, Steps: 208 | Train Loss: 0.685 Vali Loss: 8.032 Vali Acc: 0.107 Test Loss: 8.032 Test Acc: 0.107
Validation loss decreased (-0.106120 --> -0.107286).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2977205
	speed: 0.2561s/iter; left time: 4502.6948s
	iters: 200, epoch: 16 | loss: 0.4357746
	speed: 0.0737s/iter; left time: 1288.9349s
Epoch: 16 cost time: 15.065521717071533
Epoch: 16, Steps: 208 | Train Loss: 0.577 Vali Loss: 8.390 Vali Acc: 0.104 Test Loss: 8.390 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3980322
	speed: 0.2871s/iter; left time: 4987.7386s
	iters: 200, epoch: 17 | loss: 0.6664389
	speed: 0.0718s/iter; left time: 1240.4515s
Epoch: 17 cost time: 16.153083562850952
Epoch: 17, Steps: 208 | Train Loss: 0.470 Vali Loss: 8.969 Vali Acc: 0.107 Test Loss: 8.969 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3027392
	speed: 0.2694s/iter; left time: 4624.4585s
	iters: 200, epoch: 18 | loss: 0.3106430
	speed: 0.0602s/iter; left time: 1026.5052s
Epoch: 18 cost time: 14.18165636062622
Epoch: 18, Steps: 208 | Train Loss: 0.376 Vali Loss: 9.143 Vali Acc: 0.112 Test Loss: 9.143 Test Acc: 0.112
Validation loss decreased (-0.107286 --> -0.111450).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1855370
	speed: 0.2683s/iter; left time: 4550.1799s
	iters: 200, epoch: 19 | loss: 0.5701239
	speed: 0.0613s/iter; left time: 1033.6416s
Epoch: 19 cost time: 13.845083475112915
Epoch: 19, Steps: 208 | Train Loss: 0.310 Vali Loss: 10.280 Vali Acc: 0.104 Test Loss: 10.280 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0857543
	speed: 0.2182s/iter; left time: 3654.9780s
	iters: 200, epoch: 20 | loss: 0.4868201
	speed: 0.0430s/iter; left time: 715.4078s
Epoch: 20 cost time: 9.940260887145996
Epoch: 20, Steps: 208 | Train Loss: 0.279 Vali Loss: 10.559 Vali Acc: 0.108 Test Loss: 10.559 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0810893
	speed: 0.2179s/iter; left time: 3604.9207s
	iters: 200, epoch: 21 | loss: 0.3649147
	speed: 0.0463s/iter; left time: 761.7718s
Epoch: 21 cost time: 10.240572690963745
Epoch: 21, Steps: 208 | Train Loss: 0.265 Vali Loss: 11.504 Vali Acc: 0.095 Test Loss: 11.504 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0033075
	speed: 0.1957s/iter; left time: 3196.1620s
	iters: 200, epoch: 22 | loss: 0.3184808
	speed: 0.0483s/iter; left time: 784.6119s
Epoch: 22 cost time: 10.198725938796997
Epoch: 22, Steps: 208 | Train Loss: 0.206 Vali Loss: 11.935 Vali Acc: 0.101 Test Loss: 11.935 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0175480
	speed: 0.2327s/iter; left time: 3751.5830s
	iters: 200, epoch: 23 | loss: 0.0603540
	speed: 0.0561s/iter; left time: 898.4551s
Epoch: 23 cost time: 11.642508506774902
Epoch: 23, Steps: 208 | Train Loss: 0.222 Vali Loss: 11.340 Vali Acc: 0.115 Test Loss: 11.340 Test Acc: 0.115
Validation loss decreased (-0.111450 --> -0.115007).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0229744
	speed: 0.2335s/iter; left time: 3716.9216s
	iters: 200, epoch: 24 | loss: 0.1198043
	speed: 0.0429s/iter; left time: 678.8512s
Epoch: 24 cost time: 9.25589632987976
Epoch: 24, Steps: 208 | Train Loss: 0.195 Vali Loss: 11.561 Vali Acc: 0.103 Test Loss: 11.561 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.5012879
	speed: 0.1967s/iter; left time: 3089.4160s
	iters: 200, epoch: 25 | loss: 0.1468186
	speed: 0.0397s/iter; left time: 619.3388s
Epoch: 25 cost time: 9.229413747787476
Epoch: 25, Steps: 208 | Train Loss: 0.172 Vali Loss: 13.219 Vali Acc: 0.110 Test Loss: 13.219 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0361600
	speed: 0.1991s/iter; left time: 3086.2583s
	iters: 200, epoch: 26 | loss: 0.1582425
	speed: 0.0404s/iter; left time: 622.4533s
Epoch: 26 cost time: 8.935786247253418
Epoch: 26, Steps: 208 | Train Loss: 0.148 Vali Loss: 12.984 Vali Acc: 0.110 Test Loss: 12.984 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1455627
	speed: 0.2043s/iter; left time: 3124.1641s
	iters: 200, epoch: 27 | loss: 0.0142191
	speed: 0.0596s/iter; left time: 905.4205s
Epoch: 27 cost time: 13.29464316368103
Epoch: 27, Steps: 208 | Train Loss: 0.165 Vali Loss: 13.572 Vali Acc: 0.107 Test Loss: 13.572 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.5728515
	speed: 0.2470s/iter; left time: 3725.2566s
	iters: 200, epoch: 28 | loss: 0.2552696
	speed: 0.0638s/iter; left time: 956.4871s
Epoch: 28 cost time: 14.223137855529785
Epoch: 28, Steps: 208 | Train Loss: 0.161 Vali Loss: 13.043 Vali Acc: 0.106 Test Loss: 13.043 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.1375465
	speed: 0.2916s/iter; left time: 4338.8621s
	iters: 200, epoch: 29 | loss: 0.0773636
	speed: 0.0746s/iter; left time: 1102.7506s
Epoch: 29 cost time: 16.38722825050354
Epoch: 29, Steps: 208 | Train Loss: 0.143 Vali Loss: 13.428 Vali Acc: 0.108 Test Loss: 13.428 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0129259
	speed: 0.2814s/iter; left time: 4127.8972s
	iters: 200, epoch: 30 | loss: 0.0159394
	speed: 0.0592s/iter; left time: 862.9041s
Epoch: 30 cost time: 14.5249605178833
Epoch: 30, Steps: 208 | Train Loss: 0.139 Vali Loss: 14.150 Vali Acc: 0.101 Test Loss: 14.150 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.1466097
	speed: 0.2505s/iter; left time: 3622.6372s
	iters: 200, epoch: 31 | loss: 0.2476719
	speed: 0.0603s/iter; left time: 866.4222s
Epoch: 31 cost time: 13.587236404418945
Epoch: 31, Steps: 208 | Train Loss: 0.133 Vali Loss: 13.772 Vali Acc: 0.107 Test Loss: 13.772 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0648170
	speed: 0.2671s/iter; left time: 3807.4010s
	iters: 200, epoch: 32 | loss: 0.3428108
	speed: 0.0563s/iter; left time: 796.6742s
Epoch: 32 cost time: 12.102277517318726
Epoch: 32, Steps: 208 | Train Loss: 0.106 Vali Loss: 14.737 Vali Acc: 0.108 Test Loss: 14.737 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.1743267
	speed: 0.2497s/iter; left time: 3506.3847s
	iters: 200, epoch: 33 | loss: 0.0514725
	speed: 0.0395s/iter; left time: 551.2271s
Epoch: 33 cost time: 9.431758642196655
Epoch: 33, Steps: 208 | Train Loss: 0.121 Vali Loss: 14.193 Vali Acc: 0.104 Test Loss: 14.193 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11512078735460782
model parameter : 2027367
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4512420
	speed: 0.0616s/iter; left time: 1274.3798s
	iters: 200, epoch: 1 | loss: 3.6182604
	speed: 0.0347s/iter; left time: 714.4470s
Epoch: 1 cost time: 9.973639726638794
Epoch: 1, Steps: 208 | Train Loss: 4.434 Vali Loss: 4.688 Vali Acc: 0.063 Test Loss: 4.688 Test Acc: 0.063
Validation loss decreased (inf --> -0.063180).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6594646
	speed: 0.1854s/iter; left time: 3799.3298s
	iters: 200, epoch: 2 | loss: 3.7879503
	speed: 0.0280s/iter; left time: 571.6324s
Epoch: 2 cost time: 6.918269872665405
Epoch: 2, Steps: 208 | Train Loss: 3.649 Vali Loss: 3.512 Vali Acc: 0.089 Test Loss: 3.512 Test Acc: 0.089
Validation loss decreased (-0.063180 --> -0.089139).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9431574
	speed: 0.1851s/iter; left time: 3755.2705s
	iters: 200, epoch: 3 | loss: 4.6456809
	speed: 0.0272s/iter; left time: 548.5489s
Epoch: 3 cost time: 6.745812177658081
Epoch: 3, Steps: 208 | Train Loss: 3.363 Vali Loss: 4.622 Vali Acc: 0.065 Test Loss: 4.622 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.9359357
	speed: 0.1874s/iter; left time: 3761.6934s
	iters: 200, epoch: 4 | loss: 3.6002893
	speed: 0.0291s/iter; left time: 581.1813s
Epoch: 4 cost time: 7.3922247886657715
Epoch: 4, Steps: 208 | Train Loss: 3.493 Vali Loss: 4.542 Vali Acc: 0.074 Test Loss: 4.542 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.5719533
	speed: 0.1716s/iter; left time: 3409.6806s
	iters: 200, epoch: 5 | loss: 4.8181281
	speed: 0.0342s/iter; left time: 676.4719s
Epoch: 5 cost time: 7.594181537628174
Epoch: 5, Steps: 208 | Train Loss: 3.531 Vali Loss: 4.347 Vali Acc: 0.097 Test Loss: 4.347 Test Acc: 0.097
Validation loss decreased (-0.089139 --> -0.096885).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2960222
	speed: 0.1847s/iter; left time: 3631.3560s
	iters: 200, epoch: 6 | loss: 3.1410251
	speed: 0.0316s/iter; left time: 618.9046s
Epoch: 6 cost time: 7.49819016456604
Epoch: 6, Steps: 208 | Train Loss: 3.467 Vali Loss: 4.582 Vali Acc: 0.103 Test Loss: 4.582 Test Acc: 0.103
Validation loss decreased (-0.096885 --> -0.103444).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9561679
	speed: 0.1972s/iter; left time: 3835.7343s
	iters: 200, epoch: 7 | loss: 4.9619312
	speed: 0.0480s/iter; left time: 928.2414s
Epoch: 7 cost time: 10.675490379333496
Epoch: 7, Steps: 208 | Train Loss: 3.148 Vali Loss: 4.636 Vali Acc: 0.079 Test Loss: 4.636 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.9475863
	speed: 0.2166s/iter; left time: 4168.1986s
	iters: 200, epoch: 8 | loss: 2.1792717
	speed: 0.0515s/iter; left time: 986.8778s
Epoch: 8 cost time: 11.4148690700531
Epoch: 8, Steps: 208 | Train Loss: 2.829 Vali Loss: 4.924 Vali Acc: 0.091 Test Loss: 4.924 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3249819
	speed: 0.2058s/iter; left time: 3918.3205s
	iters: 200, epoch: 9 | loss: 3.6512592
	speed: 0.0414s/iter; left time: 783.2372s
Epoch: 9 cost time: 9.957536935806274
Epoch: 9, Steps: 208 | Train Loss: 2.331 Vali Loss: 5.363 Vali Acc: 0.094 Test Loss: 5.363 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3969809
	speed: 0.2128s/iter; left time: 4006.1135s
	iters: 200, epoch: 10 | loss: 1.9718146
	speed: 0.0401s/iter; left time: 750.5161s
Epoch: 10 cost time: 9.05890965461731
Epoch: 10, Steps: 208 | Train Loss: 1.932 Vali Loss: 4.974 Vali Acc: 0.102 Test Loss: 4.974 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5857135
	speed: 0.2055s/iter; left time: 3826.2123s
	iters: 200, epoch: 11 | loss: 1.6999414
	speed: 0.0391s/iter; left time: 723.7261s
Epoch: 11 cost time: 9.130683183670044
Epoch: 11, Steps: 208 | Train Loss: 1.567 Vali Loss: 5.480 Vali Acc: 0.116 Test Loss: 5.480 Test Acc: 0.116
Validation loss decreased (-0.103444 --> -0.115961).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1441156
	speed: 0.2127s/iter; left time: 3916.5815s
	iters: 200, epoch: 12 | loss: 1.5252866
	speed: 0.0406s/iter; left time: 743.4512s
Epoch: 12 cost time: 9.1423921585083
Epoch: 12, Steps: 208 | Train Loss: 1.405 Vali Loss: 5.719 Vali Acc: 0.118 Test Loss: 5.719 Test Acc: 0.118
Validation loss decreased (-0.115961 --> -0.118344).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2270303
	speed: 0.2156s/iter; left time: 3924.3274s
	iters: 200, epoch: 13 | loss: 0.6147805
	speed: 0.0352s/iter; left time: 636.7394s
Epoch: 13 cost time: 8.055842161178589
Epoch: 13, Steps: 208 | Train Loss: 1.163 Vali Loss: 6.080 Vali Acc: 0.118 Test Loss: 6.080 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0731535
	speed: 0.1820s/iter; left time: 3275.8314s
	iters: 200, epoch: 14 | loss: 0.9722370
	speed: 0.0324s/iter; left time: 580.3119s
Epoch: 14 cost time: 7.530320644378662
Epoch: 14, Steps: 208 | Train Loss: 0.961 Vali Loss: 6.864 Vali Acc: 0.125 Test Loss: 6.864 Test Acc: 0.125
Validation loss decreased (-0.118344 --> -0.124596).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5259667
	speed: 0.1972s/iter; left time: 3508.6954s
	iters: 200, epoch: 15 | loss: 0.9396462
	speed: 0.0386s/iter; left time: 682.9647s
Epoch: 15 cost time: 8.990037441253662
Epoch: 15, Steps: 208 | Train Loss: 0.851 Vali Loss: 7.243 Vali Acc: 0.114 Test Loss: 7.243 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7006438
	speed: 0.1830s/iter; left time: 3218.0214s
	iters: 200, epoch: 16 | loss: 0.8738280
	speed: 0.0316s/iter; left time: 551.8059s
Epoch: 16 cost time: 8.12891674041748
Epoch: 16, Steps: 208 | Train Loss: 0.649 Vali Loss: 7.472 Vali Acc: 0.123 Test Loss: 7.472 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6379015
	speed: 0.1929s/iter; left time: 3350.5255s
	iters: 200, epoch: 17 | loss: 0.8086037
	speed: 0.0344s/iter; left time: 594.2761s
Epoch: 17 cost time: 7.752557039260864
Epoch: 17, Steps: 208 | Train Loss: 0.558 Vali Loss: 8.385 Vali Acc: 0.123 Test Loss: 8.385 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6245844
	speed: 0.2073s/iter; left time: 3558.5302s
	iters: 200, epoch: 18 | loss: 0.3166743
	speed: 0.0290s/iter; left time: 494.8938s
Epoch: 18 cost time: 7.695927858352661
Epoch: 18, Steps: 208 | Train Loss: 0.476 Vali Loss: 8.286 Vali Acc: 0.118 Test Loss: 8.286 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2070488
	speed: 0.1980s/iter; left time: 3357.6473s
	iters: 200, epoch: 19 | loss: 0.5054888
	speed: 0.0311s/iter; left time: 523.9636s
Epoch: 19 cost time: 7.1154091358184814
Epoch: 19, Steps: 208 | Train Loss: 0.412 Vali Loss: 8.662 Vali Acc: 0.123 Test Loss: 8.662 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1660544
	speed: 0.1976s/iter; left time: 3309.0167s
	iters: 200, epoch: 20 | loss: 0.5504768
	speed: 0.0265s/iter; left time: 441.8348s
Epoch: 20 cost time: 6.562635898590088
Epoch: 20, Steps: 208 | Train Loss: 0.328 Vali Loss: 9.824 Vali Acc: 0.112 Test Loss: 9.824 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2121302
	speed: 0.1970s/iter; left time: 3257.9252s
	iters: 200, epoch: 21 | loss: 0.4706019
	speed: 0.0343s/iter; left time: 563.7803s
Epoch: 21 cost time: 8.116133689880371
Epoch: 21, Steps: 208 | Train Loss: 0.306 Vali Loss: 10.086 Vali Acc: 0.122 Test Loss: 10.086 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1639226
	speed: 0.2063s/iter; left time: 3369.7682s
	iters: 200, epoch: 22 | loss: 0.4767349
	speed: 0.0512s/iter; left time: 830.4842s
Epoch: 22 cost time: 10.912184476852417
Epoch: 22, Steps: 208 | Train Loss: 0.246 Vali Loss: 10.145 Vali Acc: 0.123 Test Loss: 10.145 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0178145
	speed: 0.2026s/iter; left time: 3266.6597s
	iters: 200, epoch: 23 | loss: 0.6012975
	speed: 0.0375s/iter; left time: 600.4833s
Epoch: 23 cost time: 8.809010744094849
Epoch: 23, Steps: 208 | Train Loss: 0.221 Vali Loss: 10.268 Vali Acc: 0.122 Test Loss: 10.268 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.3109607
	speed: 0.1987s/iter; left time: 3163.0834s
	iters: 200, epoch: 24 | loss: 0.7248465
	speed: 0.0372s/iter; left time: 589.1443s
Epoch: 24 cost time: 8.428879499435425
Epoch: 24, Steps: 208 | Train Loss: 0.235 Vali Loss: 10.440 Vali Acc: 0.119 Test Loss: 10.440 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 1039271
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2204447
	speed: 0.0664s/iter; left time: 1374.9216s
	iters: 200, epoch: 1 | loss: 3.5879831
	speed: 0.0346s/iter; left time: 712.5699s
Epoch: 1 cost time: 10.577407121658325
Epoch: 1, Steps: 208 | Train Loss: 4.244 Vali Loss: 4.508 Vali Acc: 0.062 Test Loss: 4.508 Test Acc: 0.062
Validation loss decreased (inf --> -0.061989).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2323239
	speed: 0.2095s/iter; left time: 4294.2836s
	iters: 200, epoch: 2 | loss: 3.5794835
	speed: 0.0481s/iter; left time: 981.5658s
Epoch: 2 cost time: 10.167081117630005
Epoch: 2, Steps: 208 | Train Loss: 3.666 Vali Loss: 3.783 Vali Acc: 0.079 Test Loss: 3.783 Test Acc: 0.079
Validation loss decreased (-0.061989 --> -0.078698).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7857389
	speed: 0.2139s/iter; left time: 4339.4650s
	iters: 200, epoch: 3 | loss: 3.1629832
	speed: 0.0502s/iter; left time: 1012.3606s
Epoch: 3 cost time: 11.170330047607422
Epoch: 3, Steps: 208 | Train Loss: 3.271 Vali Loss: 4.210 Vali Acc: 0.083 Test Loss: 4.210 Test Acc: 0.083
Validation loss decreased (-0.078698 --> -0.082570).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2684674
	speed: 0.1887s/iter; left time: 3789.2070s
	iters: 200, epoch: 4 | loss: 3.3822012
	speed: 0.0305s/iter; left time: 609.4679s
Epoch: 4 cost time: 7.116081714630127
Epoch: 4, Steps: 208 | Train Loss: 3.312 Vali Loss: 4.226 Vali Acc: 0.093 Test Loss: 4.226 Test Acc: 0.093
Validation loss decreased (-0.082570 --> -0.092710).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2294958
	speed: 0.1772s/iter; left time: 3520.3121s
	iters: 200, epoch: 5 | loss: 4.2046499
	speed: 0.0284s/iter; left time: 560.4954s
Epoch: 5 cost time: 7.216925144195557
Epoch: 5, Steps: 208 | Train Loss: 3.260 Vali Loss: 4.439 Vali Acc: 0.101 Test Loss: 4.439 Test Acc: 0.101
Validation loss decreased (-0.092710 --> -0.100761).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.0428967
	speed: 0.1856s/iter; left time: 3648.5062s
	iters: 200, epoch: 6 | loss: 3.5935745
	speed: 0.0258s/iter; left time: 504.0896s
Epoch: 6 cost time: 6.427639484405518
Epoch: 6, Steps: 208 | Train Loss: 3.176 Vali Loss: 4.360 Vali Acc: 0.106 Test Loss: 4.360 Test Acc: 0.106
Validation loss decreased (-0.100761 --> -0.106428).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2588153
	speed: 0.1822s/iter; left time: 3544.4653s
	iters: 200, epoch: 7 | loss: 2.8086629
	speed: 0.0235s/iter; left time: 454.1524s
Epoch: 7 cost time: 6.487028360366821
Epoch: 7, Steps: 208 | Train Loss: 2.986 Vali Loss: 4.666 Vali Acc: 0.093 Test Loss: 4.666 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.8800132
	speed: 0.1770s/iter; left time: 3406.2564s
	iters: 200, epoch: 8 | loss: 2.7423835
	speed: 0.0266s/iter; left time: 508.9554s
Epoch: 8 cost time: 6.105679512023926
Epoch: 8, Steps: 208 | Train Loss: 2.693 Vali Loss: 4.668 Vali Acc: 0.099 Test Loss: 4.668 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.8294449
	speed: 0.1758s/iter; left time: 3346.6377s
	iters: 200, epoch: 9 | loss: 3.0849509
	speed: 0.0294s/iter; left time: 557.5755s
Epoch: 9 cost time: 7.028588771820068
Epoch: 9, Steps: 208 | Train Loss: 2.344 Vali Loss: 4.954 Vali Acc: 0.107 Test Loss: 4.954 Test Acc: 0.107
Validation loss decreased (-0.106428 --> -0.106721).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4262605
	speed: 0.1916s/iter; left time: 3608.3409s
	iters: 200, epoch: 10 | loss: 2.2176476
	speed: 0.0306s/iter; left time: 572.4718s
Epoch: 10 cost time: 7.355047225952148
Epoch: 10, Steps: 208 | Train Loss: 1.977 Vali Loss: 4.817 Vali Acc: 0.109 Test Loss: 4.817 Test Acc: 0.109
Validation loss decreased (-0.106721 --> -0.109406).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5736136
	speed: 0.1865s/iter; left time: 3473.2468s
	iters: 200, epoch: 11 | loss: 2.1549034
	speed: 0.0352s/iter; left time: 652.0775s
Epoch: 11 cost time: 7.900076866149902
Epoch: 11, Steps: 208 | Train Loss: 1.672 Vali Loss: 5.347 Vali Acc: 0.118 Test Loss: 5.347 Test Acc: 0.118
Validation loss decreased (-0.109406 --> -0.118348).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0450811
	speed: 0.1974s/iter; left time: 3635.1798s
	iters: 200, epoch: 12 | loss: 2.9755998
	speed: 0.0391s/iter; left time: 716.5945s
Epoch: 12 cost time: 8.845273971557617
Epoch: 12, Steps: 208 | Train Loss: 1.376 Vali Loss: 5.324 Vali Acc: 0.124 Test Loss: 5.324 Test Acc: 0.124
Validation loss decreased (-0.118348 --> -0.124015).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9483450
	speed: 0.1978s/iter; left time: 3601.6827s
	iters: 200, epoch: 13 | loss: 1.5753338
	speed: 0.0391s/iter; left time: 707.9631s
Epoch: 13 cost time: 8.834125280380249
Epoch: 13, Steps: 208 | Train Loss: 1.146 Vali Loss: 6.092 Vali Acc: 0.112 Test Loss: 6.092 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9757527
	speed: 0.1954s/iter; left time: 3516.4863s
	iters: 200, epoch: 14 | loss: 1.3150353
	speed: 0.0383s/iter; left time: 684.8230s
Epoch: 14 cost time: 8.743712425231934
Epoch: 14, Steps: 208 | Train Loss: 0.980 Vali Loss: 6.538 Vali Acc: 0.112 Test Loss: 6.538 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7606794
	speed: 0.1922s/iter; left time: 3418.5193s
	iters: 200, epoch: 15 | loss: 1.4518105
	speed: 0.0363s/iter; left time: 641.3568s
Epoch: 15 cost time: 8.46051549911499
Epoch: 15, Steps: 208 | Train Loss: 0.792 Vali Loss: 7.028 Vali Acc: 0.118 Test Loss: 7.028 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4126550
	speed: 0.2021s/iter; left time: 3552.3506s
	iters: 200, epoch: 16 | loss: 0.8026936
	speed: 0.0480s/iter; left time: 838.9238s
Epoch: 16 cost time: 10.327017784118652
Epoch: 16, Steps: 208 | Train Loss: 0.706 Vali Loss: 7.505 Vali Acc: 0.121 Test Loss: 7.505 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.8616823
	speed: 0.2120s/iter; left time: 3683.1871s
	iters: 200, epoch: 17 | loss: 0.4859207
	speed: 0.0470s/iter; left time: 810.9860s
Epoch: 17 cost time: 10.280227422714233
Epoch: 17, Steps: 208 | Train Loss: 0.561 Vali Loss: 7.682 Vali Acc: 0.112 Test Loss: 7.682 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1637804
	speed: 0.2115s/iter; left time: 3630.9096s
	iters: 200, epoch: 18 | loss: 0.7062953
	speed: 0.0356s/iter; left time: 607.0127s
Epoch: 18 cost time: 9.050193071365356
Epoch: 18, Steps: 208 | Train Loss: 0.473 Vali Loss: 8.324 Vali Acc: 0.118 Test Loss: 8.324 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4568669
	speed: 0.1783s/iter; left time: 3022.7836s
	iters: 200, epoch: 19 | loss: 0.5760882
	speed: 0.0276s/iter; left time: 464.9123s
Epoch: 19 cost time: 6.82415771484375
Epoch: 19, Steps: 208 | Train Loss: 0.416 Vali Loss: 8.666 Vali Acc: 0.113 Test Loss: 8.666 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1175591
	speed: 0.1928s/iter; left time: 3228.6268s
	iters: 200, epoch: 20 | loss: 0.6602030
	speed: 0.0289s/iter; left time: 481.0264s
Epoch: 20 cost time: 6.974814176559448
Epoch: 20, Steps: 208 | Train Loss: 0.393 Vali Loss: 9.504 Vali Acc: 0.117 Test Loss: 9.504 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.4490880
	speed: 0.1691s/iter; left time: 2797.0902s
	iters: 200, epoch: 21 | loss: 1.0619969
	speed: 0.0237s/iter; left time: 389.1886s
Epoch: 21 cost time: 5.8344950675964355
Epoch: 21, Steps: 208 | Train Loss: 0.342 Vali Loss: 9.567 Vali Acc: 0.120 Test Loss: 9.567 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0907474
	speed: 0.1834s/iter; left time: 2995.1773s
	iters: 200, epoch: 22 | loss: 0.4676561
	speed: 0.0248s/iter; left time: 402.6487s
Epoch: 22 cost time: 6.321593284606934
Epoch: 22, Steps: 208 | Train Loss: 0.303 Vali Loss: 10.431 Vali Acc: 0.114 Test Loss: 10.431 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12406799880703848
model parameter : 710183
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1960526
	speed: 0.0649s/iter; left time: 1344.3546s
	iters: 200, epoch: 1 | loss: 5.0951061
	speed: 0.0305s/iter; left time: 628.6233s
Epoch: 1 cost time: 10.038253545761108
Epoch: 1, Steps: 208 | Train Loss: 4.101 Vali Loss: 4.464 Vali Acc: 0.056 Test Loss: 4.464 Test Acc: 0.056
Validation loss decreased (inf --> -0.056025).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5804834
	speed: 0.1960s/iter; left time: 4017.4879s
	iters: 200, epoch: 2 | loss: 4.4007034
	speed: 0.0299s/iter; left time: 610.4132s
Epoch: 2 cost time: 6.954145908355713
Epoch: 2, Steps: 208 | Train Loss: 3.767 Vali Loss: 3.875 Vali Acc: 0.078 Test Loss: 3.875 Test Acc: 0.078
Validation loss decreased (-0.056025 --> -0.078398).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4852612
	speed: 0.1950s/iter; left time: 3955.2747s
	iters: 200, epoch: 3 | loss: 3.6895328
	speed: 0.0382s/iter; left time: 770.5692s
Epoch: 3 cost time: 8.968615770339966
Epoch: 3, Steps: 208 | Train Loss: 3.208 Vali Loss: 3.911 Vali Acc: 0.083 Test Loss: 3.911 Test Acc: 0.083
Validation loss decreased (-0.078398 --> -0.082573).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1225088
	speed: 0.2009s/iter; left time: 4032.6433s
	iters: 200, epoch: 4 | loss: 3.5549321
	speed: 0.0393s/iter; left time: 784.1854s
Epoch: 4 cost time: 8.949807167053223
Epoch: 4, Steps: 208 | Train Loss: 3.135 Vali Loss: 4.477 Vali Acc: 0.067 Test Loss: 4.477 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.0304680
	speed: 0.2024s/iter; left time: 4020.7792s
	iters: 200, epoch: 5 | loss: 3.3443348
	speed: 0.0370s/iter; left time: 731.0784s
Epoch: 5 cost time: 8.743901252746582
Epoch: 5, Steps: 208 | Train Loss: 3.092 Vali Loss: 4.255 Vali Acc: 0.104 Test Loss: 4.255 Test Acc: 0.104
Validation loss decreased (-0.082573 --> -0.103745).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7898369
	speed: 0.2058s/iter; left time: 4046.4474s
	iters: 200, epoch: 6 | loss: 3.6341410
	speed: 0.0351s/iter; left time: 686.6350s
Epoch: 6 cost time: 8.481204271316528
Epoch: 6, Steps: 208 | Train Loss: 2.991 Vali Loss: 4.456 Vali Acc: 0.098 Test Loss: 4.456 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6794348
	speed: 0.2221s/iter; left time: 4320.1326s
	iters: 200, epoch: 7 | loss: 2.6328444
	speed: 0.0470s/iter; left time: 908.7735s
Epoch: 7 cost time: 10.542240381240845
Epoch: 7, Steps: 208 | Train Loss: 2.853 Vali Loss: 4.735 Vali Acc: 0.098 Test Loss: 4.735 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3870993
	speed: 0.2154s/iter; left time: 4145.8499s
	iters: 200, epoch: 8 | loss: 3.4987919
	speed: 0.0473s/iter; left time: 905.5674s
Epoch: 8 cost time: 10.706844329833984
Epoch: 8, Steps: 208 | Train Loss: 2.584 Vali Loss: 4.736 Vali Acc: 0.097 Test Loss: 4.736 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.2619548
	speed: 0.2230s/iter; left time: 4244.9985s
	iters: 200, epoch: 9 | loss: 2.4670544
	speed: 0.0399s/iter; left time: 756.5304s
Epoch: 9 cost time: 9.130796670913696
Epoch: 9, Steps: 208 | Train Loss: 2.257 Vali Loss: 4.783 Vali Acc: 0.112 Test Loss: 4.783 Test Acc: 0.112
Validation loss decreased (-0.103745 --> -0.112091).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2548676
	speed: 0.1976s/iter; left time: 3720.3189s
	iters: 200, epoch: 10 | loss: 2.1924446
	speed: 0.0296s/iter; left time: 554.1603s
Epoch: 10 cost time: 7.206515312194824
Epoch: 10, Steps: 208 | Train Loss: 1.924 Vali Loss: 5.313 Vali Acc: 0.118 Test Loss: 5.313 Test Acc: 0.118
Validation loss decreased (-0.112091 --> -0.118348).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7786037
	speed: 0.2017s/iter; left time: 3755.6130s
	iters: 200, epoch: 11 | loss: 2.4938192
	speed: 0.0338s/iter; left time: 626.7885s
Epoch: 11 cost time: 7.45586895942688
Epoch: 11, Steps: 208 | Train Loss: 1.632 Vali Loss: 5.420 Vali Acc: 0.115 Test Loss: 5.420 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2265567
	speed: 0.1957s/iter; left time: 3603.7119s
	iters: 200, epoch: 12 | loss: 1.2102739
	speed: 0.0277s/iter; left time: 507.0602s
Epoch: 12 cost time: 6.758381366729736
Epoch: 12, Steps: 208 | Train Loss: 1.380 Vali Loss: 5.831 Vali Acc: 0.121 Test Loss: 5.831 Test Acc: 0.121
Validation loss decreased (-0.118348 --> -0.120729).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1532103
	speed: 0.2139s/iter; left time: 3894.1249s
	iters: 200, epoch: 13 | loss: 1.0279471
	speed: 0.0303s/iter; left time: 548.1708s
Epoch: 13 cost time: 7.246112108230591
Epoch: 13, Steps: 208 | Train Loss: 1.170 Vali Loss: 6.087 Vali Acc: 0.111 Test Loss: 6.087 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3079748
	speed: 0.1983s/iter; left time: 3567.9311s
	iters: 200, epoch: 14 | loss: 1.3652072
	speed: 0.0302s/iter; left time: 541.2865s
Epoch: 14 cost time: 7.327547073364258
Epoch: 14, Steps: 208 | Train Loss: 0.972 Vali Loss: 6.449 Vali Acc: 0.115 Test Loss: 6.449 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7401851
	speed: 0.2082s/iter; left time: 3703.3239s
	iters: 200, epoch: 15 | loss: 1.1278958
	speed: 0.0333s/iter; left time: 589.2980s
Epoch: 15 cost time: 8.138691902160645
Epoch: 15, Steps: 208 | Train Loss: 0.794 Vali Loss: 7.033 Vali Acc: 0.117 Test Loss: 7.033 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6713139
	speed: 0.2136s/iter; left time: 3755.8131s
	iters: 200, epoch: 16 | loss: 0.7842537
	speed: 0.0296s/iter; left time: 516.6354s
Epoch: 16 cost time: 7.570678472518921
Epoch: 16, Steps: 208 | Train Loss: 0.682 Vali Loss: 7.291 Vali Acc: 0.113 Test Loss: 7.291 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0531797
	speed: 0.2258s/iter; left time: 3923.1308s
	iters: 200, epoch: 17 | loss: 1.2185514
	speed: 0.0609s/iter; left time: 1051.3747s
Epoch: 17 cost time: 11.419889450073242
Epoch: 17, Steps: 208 | Train Loss: 0.587 Vali Loss: 7.814 Vali Acc: 0.118 Test Loss: 7.814 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4575592
	speed: 0.2346s/iter; left time: 4027.2529s
	iters: 200, epoch: 18 | loss: 0.9533553
	speed: 0.0400s/iter; left time: 682.1162s
Epoch: 18 cost time: 9.05007290840149
Epoch: 18, Steps: 208 | Train Loss: 0.522 Vali Loss: 8.115 Vali Acc: 0.115 Test Loss: 8.115 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4441465
	speed: 0.2047s/iter; left time: 3471.2009s
	iters: 200, epoch: 19 | loss: 0.3255279
	speed: 0.0352s/iter; left time: 593.7570s
Epoch: 19 cost time: 8.325347661972046
Epoch: 19, Steps: 208 | Train Loss: 0.478 Vali Loss: 8.405 Vali Acc: 0.119 Test Loss: 8.405 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6005777
	speed: 0.2172s/iter; left time: 3637.7450s
	iters: 200, epoch: 20 | loss: 0.2199117
	speed: 0.0475s/iter; left time: 790.8057s
Epoch: 20 cost time: 10.555079460144043
Epoch: 20, Steps: 208 | Train Loss: 0.390 Vali Loss: 8.734 Vali Acc: 0.120 Test Loss: 8.734 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1013611
	speed: 0.2133s/iter; left time: 3528.3280s
	iters: 200, epoch: 21 | loss: 0.6610973
	speed: 0.0491s/iter; left time: 807.7010s
Epoch: 21 cost time: 10.876277685165405
Epoch: 21, Steps: 208 | Train Loss: 0.366 Vali Loss: 9.272 Vali Acc: 0.123 Test Loss: 9.272 Test Acc: 0.123
Validation loss decreased (-0.120729 --> -0.123379).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1298034
	speed: 0.2093s/iter; left time: 3417.8016s
	iters: 200, epoch: 22 | loss: 0.0802745
	speed: 0.0431s/iter; left time: 699.2810s
Epoch: 22 cost time: 9.966648817062378
Epoch: 22, Steps: 208 | Train Loss: 0.318 Vali Loss: 9.478 Vali Acc: 0.126 Test Loss: 9.478 Test Acc: 0.126
Validation loss decreased (-0.123379 --> -0.126359).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.6392618
	speed: 0.2350s/iter; left time: 3789.8384s
	iters: 200, epoch: 23 | loss: 0.1434995
	speed: 0.0415s/iter; left time: 664.5282s
Epoch: 23 cost time: 9.32837700843811
Epoch: 23, Steps: 208 | Train Loss: 0.319 Vali Loss: 10.160 Vali Acc: 0.116 Test Loss: 10.160 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.2713125
	speed: 0.1944s/iter; left time: 3094.6324s
	iters: 200, epoch: 24 | loss: 0.7475342
	speed: 0.0296s/iter; left time: 468.0543s
Epoch: 24 cost time: 6.98082709312439
Epoch: 24, Steps: 208 | Train Loss: 0.266 Vali Loss: 10.588 Vali Acc: 0.113 Test Loss: 10.588 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.1212048
	speed: 0.2173s/iter; left time: 3413.2492s
	iters: 200, epoch: 25 | loss: 0.2849545
	speed: 0.0275s/iter; left time: 429.9389s
Epoch: 25 cost time: 6.979775905609131
Epoch: 25, Steps: 208 | Train Loss: 0.274 Vali Loss: 10.417 Vali Acc: 0.115 Test Loss: 10.417 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.4658048
	speed: 0.2012s/iter; left time: 3118.3011s
	iters: 200, epoch: 26 | loss: 0.0782745
	speed: 0.0293s/iter; left time: 451.6997s
Epoch: 26 cost time: 7.091638565063477
Epoch: 26, Steps: 208 | Train Loss: 0.236 Vali Loss: 11.191 Vali Acc: 0.112 Test Loss: 11.191 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.1461869
	speed: 0.2144s/iter; left time: 3278.6030s
	iters: 200, epoch: 27 | loss: 0.5676407
	speed: 0.0320s/iter; left time: 485.7005s
Epoch: 27 cost time: 7.306891918182373
Epoch: 27, Steps: 208 | Train Loss: 0.266 Vali Loss: 11.025 Vali Acc: 0.123 Test Loss: 11.025 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.4654907
	speed: 0.2133s/iter; left time: 3218.0461s
	iters: 200, epoch: 28 | loss: 0.3777320
	speed: 0.0501s/iter; left time: 750.2563s
Epoch: 28 cost time: 11.104530096054077
Epoch: 28, Steps: 208 | Train Loss: 0.252 Vali Loss: 11.732 Vali Acc: 0.125 Test Loss: 11.732 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.1970842
	speed: 0.2093s/iter; left time: 3113.2419s
	iters: 200, epoch: 29 | loss: 0.0789459
	speed: 0.0337s/iter; left time: 497.2613s
Epoch: 29 cost time: 8.058959245681763
Epoch: 29, Steps: 208 | Train Loss: 0.211 Vali Loss: 11.835 Vali Acc: 0.117 Test Loss: 11.835 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.4720844
	speed: 0.2587s/iter; left time: 3794.2196s
	iters: 200, epoch: 30 | loss: 0.3594624
	speed: 0.0478s/iter; left time: 696.6046s
Epoch: 30 cost time: 11.158414363861084
Epoch: 30, Steps: 208 | Train Loss: 0.198 Vali Loss: 11.890 Vali Acc: 0.112 Test Loss: 11.890 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.6975382
	speed: 0.2746s/iter; left time: 3970.9310s
	iters: 200, epoch: 31 | loss: 0.2383557
	speed: 0.0626s/iter; left time: 899.6451s
Epoch: 31 cost time: 14.16973876953125
Epoch: 31, Steps: 208 | Train Loss: 0.205 Vali Loss: 12.159 Vali Acc: 0.122 Test Loss: 12.159 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.2610904
	speed: 0.2725s/iter; left time: 3884.6194s
	iters: 200, epoch: 32 | loss: 0.0712362
	speed: 0.0602s/iter; left time: 851.9875s
Epoch: 32 cost time: 13.562284708023071
Epoch: 32, Steps: 208 | Train Loss: 0.191 Vali Loss: 12.476 Vali Acc: 0.118 Test Loss: 12.476 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12645392186101997
model parameter : 573223
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8417625
	speed: 0.0982s/iter; left time: 2032.5770s
	iters: 200, epoch: 1 | loss: 3.9621267
	speed: 0.0784s/iter; left time: 1615.8812s
Epoch: 1 cost time: 18.42556118965149
Epoch: 1, Steps: 208 | Train Loss: 3.957 Vali Loss: 4.083 Vali Acc: 0.061 Test Loss: 4.083 Test Acc: 0.061
Validation loss decreased (inf --> -0.061397).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7292907
	speed: 0.2777s/iter; left time: 5690.3459s
	iters: 200, epoch: 2 | loss: 4.0541377
	speed: 0.0567s/iter; left time: 1156.6677s
Epoch: 2 cost time: 12.572765350341797
Epoch: 2, Steps: 208 | Train Loss: 3.720 Vali Loss: 4.040 Vali Acc: 0.075 Test Loss: 4.040 Test Acc: 0.075
Validation loss decreased (-0.061397 --> -0.075116).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6597171
	speed: 0.2832s/iter; left time: 5745.6873s
	iters: 200, epoch: 3 | loss: 3.0705733
	speed: 0.0462s/iter; left time: 932.0154s
Epoch: 3 cost time: 11.212757110595703
Epoch: 3, Steps: 208 | Train Loss: 3.351 Vali Loss: 4.309 Vali Acc: 0.079 Test Loss: 4.309 Test Acc: 0.079
Validation loss decreased (-0.075116 --> -0.078991).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6053393
	speed: 0.2814s/iter; left time: 5649.6177s
	iters: 200, epoch: 4 | loss: 3.9538152
	speed: 0.0615s/iter; left time: 1227.8063s
Epoch: 4 cost time: 13.65049433708191
Epoch: 4, Steps: 208 | Train Loss: 3.136 Vali Loss: 4.264 Vali Acc: 0.080 Test Loss: 4.264 Test Acc: 0.080
Validation loss decreased (-0.078991 --> -0.079886).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4859309
	speed: 0.2472s/iter; left time: 4910.9384s
	iters: 200, epoch: 5 | loss: 3.1665168
	speed: 0.0510s/iter; left time: 1009.0446s
Epoch: 5 cost time: 10.361212253570557
Epoch: 5, Steps: 208 | Train Loss: 2.952 Vali Loss: 4.575 Vali Acc: 0.088 Test Loss: 4.575 Test Acc: 0.088
Validation loss decreased (-0.079886 --> -0.087935).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6913030
	speed: 0.2748s/iter; left time: 5403.7434s
	iters: 200, epoch: 6 | loss: 3.9225132
	speed: 0.0413s/iter; left time: 807.7990s
Epoch: 6 cost time: 10.034806489944458
Epoch: 6, Steps: 208 | Train Loss: 2.809 Vali Loss: 4.860 Vali Acc: 0.101 Test Loss: 4.860 Test Acc: 0.101
Validation loss decreased (-0.087935 --> -0.100458).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9229469
	speed: 0.2618s/iter; left time: 5091.9540s
	iters: 200, epoch: 7 | loss: 3.2961955
	speed: 0.0407s/iter; left time: 788.0292s
Epoch: 7 cost time: 9.920244216918945
Epoch: 7, Steps: 208 | Train Loss: 2.667 Vali Loss: 4.775 Vali Acc: 0.096 Test Loss: 4.775 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5153329
	speed: 0.2729s/iter; left time: 5252.6321s
	iters: 200, epoch: 8 | loss: 2.5116076
	speed: 0.0633s/iter; left time: 1212.3186s
Epoch: 8 cost time: 14.185744524002075
Epoch: 8, Steps: 208 | Train Loss: 2.459 Vali Loss: 4.917 Vali Acc: 0.102 Test Loss: 4.917 Test Acc: 0.102
Validation loss decreased (-0.100458 --> -0.102247).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0935860
	speed: 0.2573s/iter; left time: 4898.1481s
	iters: 200, epoch: 9 | loss: 2.0739982
	speed: 0.0357s/iter; left time: 676.6580s
Epoch: 9 cost time: 8.276378154754639
Epoch: 9, Steps: 208 | Train Loss: 2.228 Vali Loss: 5.017 Vali Acc: 0.105 Test Loss: 5.017 Test Acc: 0.105
Validation loss decreased (-0.102247 --> -0.105229).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8293676
	speed: 0.2320s/iter; left time: 4368.1363s
	iters: 200, epoch: 10 | loss: 2.0727777
	speed: 0.0372s/iter; left time: 697.1548s
Epoch: 10 cost time: 7.912044286727905
Epoch: 10, Steps: 208 | Train Loss: 1.948 Vali Loss: 5.435 Vali Acc: 0.103 Test Loss: 5.435 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2876248
	speed: 0.2344s/iter; left time: 4364.2969s
	iters: 200, epoch: 11 | loss: 2.1204951
	speed: 0.0455s/iter; left time: 842.9034s
Epoch: 11 cost time: 9.684344053268433
Epoch: 11, Steps: 208 | Train Loss: 1.751 Vali Loss: 5.448 Vali Acc: 0.105 Test Loss: 5.448 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4173586
	speed: 0.2402s/iter; left time: 4422.5228s
	iters: 200, epoch: 12 | loss: 1.7400324
	speed: 0.0344s/iter; left time: 629.7198s
Epoch: 12 cost time: 8.586788415908813
Epoch: 12, Steps: 208 | Train Loss: 1.529 Vali Loss: 5.713 Vali Acc: 0.106 Test Loss: 5.713 Test Acc: 0.106
Validation loss decreased (-0.105229 --> -0.105818).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2113544
	speed: 0.2712s/iter; left time: 4936.7623s
	iters: 200, epoch: 13 | loss: 2.1035070
	speed: 0.0492s/iter; left time: 890.2350s
Epoch: 13 cost time: 10.89265251159668
Epoch: 13, Steps: 208 | Train Loss: 1.282 Vali Loss: 6.153 Vali Acc: 0.098 Test Loss: 6.153 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1929868
	speed: 0.2810s/iter; left time: 5056.8933s
	iters: 200, epoch: 14 | loss: 1.9406958
	speed: 0.0569s/iter; left time: 1019.1383s
Epoch: 14 cost time: 13.475959539413452
Epoch: 14, Steps: 208 | Train Loss: 1.159 Vali Loss: 6.310 Vali Acc: 0.106 Test Loss: 6.310 Test Acc: 0.106
Validation loss decreased (-0.105818 --> -0.106409).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8077159
	speed: 0.2769s/iter; left time: 4926.3745s
	iters: 200, epoch: 15 | loss: 1.6555411
	speed: 0.0698s/iter; left time: 1235.2312s
Epoch: 15 cost time: 14.875215530395508
Epoch: 15, Steps: 208 | Train Loss: 0.963 Vali Loss: 6.809 Vali Acc: 0.111 Test Loss: 6.809 Test Acc: 0.111
Validation loss decreased (-0.106409 --> -0.110877).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.8907827
	speed: 0.2570s/iter; left time: 4518.0070s
	iters: 200, epoch: 16 | loss: 0.8318058
	speed: 0.0598s/iter; left time: 1045.0630s
Epoch: 16 cost time: 13.587746143341064
Epoch: 16, Steps: 208 | Train Loss: 0.842 Vali Loss: 7.059 Vali Acc: 0.112 Test Loss: 7.059 Test Acc: 0.112
Validation loss decreased (-0.110877 --> -0.112366).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3282435
	speed: 0.2641s/iter; left time: 4589.0767s
	iters: 200, epoch: 17 | loss: 1.0918969
	speed: 0.0527s/iter; left time: 909.9458s
Epoch: 17 cost time: 12.347614526748657
Epoch: 17, Steps: 208 | Train Loss: 0.746 Vali Loss: 7.376 Vali Acc: 0.105 Test Loss: 7.376 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6636408
	speed: 0.2844s/iter; left time: 4881.0626s
	iters: 200, epoch: 18 | loss: 0.6989078
	speed: 0.0664s/iter; left time: 1132.2651s
Epoch: 18 cost time: 14.282198429107666
Epoch: 18, Steps: 208 | Train Loss: 0.654 Vali Loss: 8.118 Vali Acc: 0.109 Test Loss: 8.118 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4025453
	speed: 0.2726s/iter; left time: 4623.0921s
	iters: 200, epoch: 19 | loss: 0.5431833
	speed: 0.0546s/iter; left time: 920.7581s
Epoch: 19 cost time: 12.182216882705688
Epoch: 19, Steps: 208 | Train Loss: 0.574 Vali Loss: 8.228 Vali Acc: 0.105 Test Loss: 8.228 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3148897
	speed: 0.3158s/iter; left time: 5288.7671s
	iters: 200, epoch: 20 | loss: 0.6964129
	speed: 0.0376s/iter; left time: 626.8005s
Epoch: 20 cost time: 12.772502183914185
Epoch: 20, Steps: 208 | Train Loss: 0.513 Vali Loss: 9.020 Vali Acc: 0.110 Test Loss: 9.020 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2588089
	speed: 0.2497s/iter; left time: 4130.0596s
	iters: 200, epoch: 21 | loss: 0.3744478
	speed: 0.0509s/iter; left time: 837.2194s
Epoch: 21 cost time: 11.251935720443726
Epoch: 21, Steps: 208 | Train Loss: 0.440 Vali Loss: 9.218 Vali Acc: 0.111 Test Loss: 9.218 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0345139
	speed: 0.2618s/iter; left time: 4276.3510s
	iters: 200, epoch: 22 | loss: 0.4442620
	speed: 0.0504s/iter; left time: 818.1678s
Epoch: 22 cost time: 10.982036590576172
Epoch: 22, Steps: 208 | Train Loss: 0.407 Vali Loss: 9.492 Vali Acc: 0.101 Test Loss: 9.492 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.4928485
	speed: 0.2827s/iter; left time: 4558.9505s
	iters: 200, epoch: 23 | loss: 0.6460268
	speed: 0.0476s/iter; left time: 762.5752s
Epoch: 23 cost time: 11.759887456893921
Epoch: 23, Steps: 208 | Train Loss: 0.398 Vali Loss: 9.768 Vali Acc: 0.103 Test Loss: 9.768 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2043055
	speed: 0.2903s/iter; left time: 4620.5433s
	iters: 200, epoch: 24 | loss: 0.4001170
	speed: 0.0517s/iter; left time: 817.2042s
Epoch: 24 cost time: 12.113726139068604
Epoch: 24, Steps: 208 | Train Loss: 0.360 Vali Loss: 10.051 Vali Acc: 0.106 Test Loss: 10.051 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.5360605
	speed: 0.2602s/iter; left time: 4087.3761s
	iters: 200, epoch: 25 | loss: 0.2790675
	speed: 0.0329s/iter; left time: 514.0354s
Epoch: 25 cost time: 9.356582403182983
Epoch: 25, Steps: 208 | Train Loss: 0.323 Vali Loss: 10.528 Vali Acc: 0.103 Test Loss: 10.528 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.3238050
	speed: 0.2705s/iter; left time: 4192.3337s
	iters: 200, epoch: 26 | loss: 0.1692693
	speed: 0.0440s/iter; left time: 677.2571s
Epoch: 26 cost time: 9.662593841552734
Epoch: 26, Steps: 208 | Train Loss: 0.309 Vali Loss: 10.369 Vali Acc: 0.111 Test Loss: 10.369 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11243662391887861
model parameter : 381735
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4287767
	speed: 0.0737s/iter; left time: 1525.9118s
	iters: 200, epoch: 1 | loss: 3.6763918
	speed: 0.0438s/iter; left time: 901.8144s
Epoch: 1 cost time: 12.138887405395508
Epoch: 1, Steps: 208 | Train Loss: 3.856 Vali Loss: 4.030 Vali Acc: 0.062 Test Loss: 4.030 Test Acc: 0.062
Validation loss decreased (inf --> -0.061994).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5808938
	speed: 0.2671s/iter; left time: 5473.8149s
	iters: 200, epoch: 2 | loss: 3.5146179
	speed: 0.0430s/iter; left time: 877.1558s
Epoch: 2 cost time: 9.877622127532959
Epoch: 2, Steps: 208 | Train Loss: 3.656 Vali Loss: 4.006 Vali Acc: 0.076 Test Loss: 4.006 Test Acc: 0.076
Validation loss decreased (-0.061994 --> -0.075713).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4986749
	speed: 0.2577s/iter; left time: 5227.3192s
	iters: 200, epoch: 3 | loss: 4.0574479
	speed: 0.0375s/iter; left time: 756.8875s
Epoch: 3 cost time: 8.757116556167603
Epoch: 3, Steps: 208 | Train Loss: 3.359 Vali Loss: 4.107 Vali Acc: 0.066 Test Loss: 4.107 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2596536
	speed: 0.2676s/iter; left time: 5372.4199s
	iters: 200, epoch: 4 | loss: 2.7491033
	speed: 0.0400s/iter; left time: 799.9090s
Epoch: 4 cost time: 9.381409883499146
Epoch: 4, Steps: 208 | Train Loss: 3.140 Vali Loss: 4.135 Vali Acc: 0.086 Test Loss: 4.135 Test Acc: 0.086
Validation loss decreased (-0.075713 --> -0.086448).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4133856
	speed: 0.2552s/iter; left time: 5070.2250s
	iters: 200, epoch: 5 | loss: 2.7964773
	speed: 0.0414s/iter; left time: 818.8340s
Epoch: 5 cost time: 9.423083543777466
Epoch: 5, Steps: 208 | Train Loss: 2.976 Vali Loss: 4.204 Vali Acc: 0.093 Test Loss: 4.204 Test Acc: 0.093
Validation loss decreased (-0.086448 --> -0.092711).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1563482
	speed: 0.2677s/iter; left time: 5263.5690s
	iters: 200, epoch: 6 | loss: 3.0862930
	speed: 0.0509s/iter; left time: 994.7645s
Epoch: 6 cost time: 11.375961303710938
Epoch: 6, Steps: 208 | Train Loss: 2.829 Vali Loss: 4.437 Vali Acc: 0.098 Test Loss: 4.437 Test Acc: 0.098
Validation loss decreased (-0.092711 --> -0.097778).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1109874
	speed: 0.2636s/iter; left time: 5128.1825s
	iters: 200, epoch: 7 | loss: 2.4934943
	speed: 0.0420s/iter; left time: 812.1535s
Epoch: 7 cost time: 8.965730667114258
Epoch: 7, Steps: 208 | Train Loss: 2.617 Vali Loss: 4.597 Vali Acc: 0.106 Test Loss: 4.597 Test Acc: 0.106
Validation loss decreased (-0.097778 --> -0.105829).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3278096
	speed: 0.2752s/iter; left time: 5295.5520s
	iters: 200, epoch: 8 | loss: 3.3290815
	speed: 0.0436s/iter; left time: 834.5875s
Epoch: 8 cost time: 9.947442531585693
Epoch: 8, Steps: 208 | Train Loss: 2.436 Vali Loss: 4.853 Vali Acc: 0.103 Test Loss: 4.853 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5813425
	speed: 0.2796s/iter; left time: 5323.1496s
	iters: 200, epoch: 9 | loss: 2.8861423
	speed: 0.0436s/iter; left time: 825.4230s
Epoch: 9 cost time: 10.296264886856079
Epoch: 9, Steps: 208 | Train Loss: 2.245 Vali Loss: 4.994 Vali Acc: 0.106 Test Loss: 4.994 Test Acc: 0.106
Validation loss decreased (-0.105829 --> -0.106124).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3698587
	speed: 0.2684s/iter; left time: 5054.3157s
	iters: 200, epoch: 10 | loss: 1.6457721
	speed: 0.0395s/iter; left time: 740.3202s
Epoch: 10 cost time: 9.193624019622803
Epoch: 10, Steps: 208 | Train Loss: 1.995 Vali Loss: 5.062 Vali Acc: 0.106 Test Loss: 5.062 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3950007
	speed: 0.2611s/iter; left time: 4861.4914s
	iters: 200, epoch: 11 | loss: 1.7063262
	speed: 0.0475s/iter; left time: 880.5529s
Epoch: 11 cost time: 11.05727767944336
Epoch: 11, Steps: 208 | Train Loss: 1.813 Vali Loss: 5.550 Vali Acc: 0.114 Test Loss: 5.550 Test Acc: 0.114
Validation loss decreased (-0.106124 --> -0.114171).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1633106
	speed: 0.2706s/iter; left time: 4981.8125s
	iters: 200, epoch: 12 | loss: 2.5668902
	speed: 0.0398s/iter; left time: 728.8269s
Epoch: 12 cost time: 8.782604217529297
Epoch: 12, Steps: 208 | Train Loss: 1.593 Vali Loss: 5.594 Vali Acc: 0.108 Test Loss: 5.594 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.9419147
	speed: 0.2710s/iter; left time: 4934.4615s
	iters: 200, epoch: 13 | loss: 2.7792668
	speed: 0.0332s/iter; left time: 601.3429s
Epoch: 13 cost time: 9.037730693817139
Epoch: 13, Steps: 208 | Train Loss: 1.393 Vali Loss: 5.912 Vali Acc: 0.102 Test Loss: 5.912 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1403774
	speed: 0.2814s/iter; left time: 5065.0866s
	iters: 200, epoch: 14 | loss: 0.6392023
	speed: 0.0411s/iter; left time: 736.1188s
Epoch: 14 cost time: 10.037886381149292
Epoch: 14, Steps: 208 | Train Loss: 1.203 Vali Loss: 6.181 Vali Acc: 0.110 Test Loss: 6.181 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4782127
	speed: 0.2717s/iter; left time: 4833.4422s
	iters: 200, epoch: 15 | loss: 0.9989917
	speed: 0.0457s/iter; left time: 808.3747s
Epoch: 15 cost time: 10.13902473449707
Epoch: 15, Steps: 208 | Train Loss: 1.075 Vali Loss: 6.600 Vali Acc: 0.109 Test Loss: 6.600 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.8767208
	speed: 0.2655s/iter; left time: 4667.0304s
	iters: 200, epoch: 16 | loss: 1.4032937
	speed: 0.0375s/iter; left time: 654.7160s
Epoch: 16 cost time: 8.478851795196533
Epoch: 16, Steps: 208 | Train Loss: 0.921 Vali Loss: 7.056 Vali Acc: 0.103 Test Loss: 7.056 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.4555584
	speed: 0.2774s/iter; left time: 4819.7544s
	iters: 200, epoch: 17 | loss: 0.2667076
	speed: 0.0310s/iter; left time: 535.2829s
Epoch: 17 cost time: 8.24623441696167
Epoch: 17, Steps: 208 | Train Loss: 0.803 Vali Loss: 7.427 Vali Acc: 0.103 Test Loss: 7.427 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8364949
	speed: 0.2599s/iter; left time: 4461.5641s
	iters: 200, epoch: 18 | loss: 0.5628166
	speed: 0.0436s/iter; left time: 743.6268s
Epoch: 18 cost time: 9.662776470184326
Epoch: 18, Steps: 208 | Train Loss: 0.723 Vali Loss: 7.702 Vali Acc: 0.107 Test Loss: 7.702 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.4349015
	speed: 0.2867s/iter; left time: 4861.3591s
	iters: 200, epoch: 19 | loss: 0.5960692
	speed: 0.0445s/iter; left time: 750.4887s
Epoch: 19 cost time: 9.982994794845581
Epoch: 19, Steps: 208 | Train Loss: 0.665 Vali Loss: 8.083 Vali Acc: 0.114 Test Loss: 8.083 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.7895281
	speed: 0.2830s/iter; left time: 4739.9387s
	iters: 200, epoch: 20 | loss: 0.8661890
	speed: 0.0466s/iter; left time: 775.6545s
Epoch: 20 cost time: 10.229682445526123
Epoch: 20, Steps: 208 | Train Loss: 0.570 Vali Loss: 8.290 Vali Acc: 0.108 Test Loss: 8.290 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4170254
	speed: 0.2843s/iter; left time: 4701.9688s
	iters: 200, epoch: 21 | loss: 0.3506497
	speed: 0.0519s/iter; left time: 853.3770s
Epoch: 21 cost time: 11.18427848815918
Epoch: 21, Steps: 208 | Train Loss: 0.546 Vali Loss: 8.765 Vali Acc: 0.113 Test Loss: 8.765 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11422606620936475
model parameter : 300071
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9064364
	speed: 0.0905s/iter; left time: 1872.6335s
	iters: 200, epoch: 1 | loss: 4.1340437
	speed: 0.0551s/iter; left time: 1134.1232s
Epoch: 1 cost time: 15.022343158721924
Epoch: 1, Steps: 208 | Train Loss: 3.837 Vali Loss: 3.881 Vali Acc: 0.054 Test Loss: 3.881 Test Acc: 0.054
Validation loss decreased (inf --> -0.053644).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7771211
	speed: 0.2979s/iter; left time: 6105.6649s
	iters: 200, epoch: 2 | loss: 3.6307130
	speed: 0.0579s/iter; left time: 1180.0960s
Epoch: 2 cost time: 12.360076904296875
Epoch: 2, Steps: 208 | Train Loss: 3.655 Vali Loss: 3.997 Vali Acc: 0.070 Test Loss: 3.997 Test Acc: 0.070
Validation loss decreased (-0.053644 --> -0.070047).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6894600
	speed: 0.3155s/iter; left time: 6400.5167s
	iters: 200, epoch: 3 | loss: 3.2442033
	speed: 0.0459s/iter; left time: 927.0661s
Epoch: 3 cost time: 10.900963544845581
Epoch: 3, Steps: 208 | Train Loss: 3.420 Vali Loss: 4.007 Vali Acc: 0.074 Test Loss: 4.007 Test Acc: 0.074
Validation loss decreased (-0.070047 --> -0.074222).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0771797
	speed: 0.2845s/iter; left time: 5712.2369s
	iters: 200, epoch: 4 | loss: 3.2070820
	speed: 0.0472s/iter; left time: 943.3645s
Epoch: 4 cost time: 11.36567997932434
Epoch: 4, Steps: 208 | Train Loss: 3.175 Vali Loss: 4.051 Vali Acc: 0.090 Test Loss: 4.051 Test Acc: 0.090
Validation loss decreased (-0.074222 --> -0.089730).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9836085
	speed: 0.3001s/iter; left time: 5963.6608s
	iters: 200, epoch: 5 | loss: 3.5279548
	speed: 0.0421s/iter; left time: 831.8230s
Epoch: 5 cost time: 10.337889432907104
Epoch: 5, Steps: 208 | Train Loss: 2.999 Vali Loss: 4.297 Vali Acc: 0.092 Test Loss: 4.297 Test Acc: 0.092
Validation loss decreased (-0.089730 --> -0.091517).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3846698
	speed: 0.2959s/iter; left time: 5817.6849s
	iters: 200, epoch: 6 | loss: 2.5685010
	speed: 0.0475s/iter; left time: 928.2217s
Epoch: 6 cost time: 10.892330646514893
Epoch: 6, Steps: 208 | Train Loss: 2.832 Vali Loss: 4.386 Vali Acc: 0.095 Test Loss: 4.386 Test Acc: 0.095
Validation loss decreased (-0.091517 --> -0.094498).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6476648
	speed: 0.3081s/iter; left time: 5992.8153s
	iters: 200, epoch: 7 | loss: 3.4910507
	speed: 0.0409s/iter; left time: 791.7766s
Epoch: 7 cost time: 10.41746211051941
Epoch: 7, Steps: 208 | Train Loss: 2.623 Vali Loss: 4.590 Vali Acc: 0.092 Test Loss: 4.590 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.8066387
	speed: 0.3032s/iter; left time: 5834.9820s
	iters: 200, epoch: 8 | loss: 2.7355831
	speed: 0.0498s/iter; left time: 953.4067s
Epoch: 8 cost time: 11.37997817993164
Epoch: 8, Steps: 208 | Train Loss: 2.439 Vali Loss: 4.748 Vali Acc: 0.096 Test Loss: 4.748 Test Acc: 0.096
Validation loss decreased (-0.094498 --> -0.095986).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8660905
	speed: 0.2761s/iter; left time: 5256.2006s
	iters: 200, epoch: 9 | loss: 2.0027664
	speed: 0.0386s/iter; left time: 730.7264s
Epoch: 9 cost time: 9.701834201812744
Epoch: 9, Steps: 208 | Train Loss: 2.201 Vali Loss: 4.922 Vali Acc: 0.099 Test Loss: 4.922 Test Acc: 0.099
Validation loss decreased (-0.095986 --> -0.098967).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4910778
	speed: 0.2979s/iter; left time: 5609.8843s
	iters: 200, epoch: 10 | loss: 1.7694961
	speed: 0.0439s/iter; left time: 822.1388s
Epoch: 10 cost time: 10.296013593673706
Epoch: 10, Steps: 208 | Train Loss: 1.977 Vali Loss: 5.202 Vali Acc: 0.104 Test Loss: 5.202 Test Acc: 0.104
Validation loss decreased (-0.098967 --> -0.104034).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1193814
	speed: 0.2814s/iter; left time: 5239.5768s
	iters: 200, epoch: 11 | loss: 1.2200419
	speed: 0.0435s/iter; left time: 806.4581s
Epoch: 11 cost time: 9.625487089157104
Epoch: 11, Steps: 208 | Train Loss: 1.740 Vali Loss: 5.482 Vali Acc: 0.109 Test Loss: 5.482 Test Acc: 0.109
Validation loss decreased (-0.104034 --> -0.109399).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6327616
	speed: 0.2782s/iter; left time: 5123.1782s
	iters: 200, epoch: 12 | loss: 2.4893034
	speed: 0.0414s/iter; left time: 758.8505s
Epoch: 12 cost time: 9.6495680809021
Epoch: 12, Steps: 208 | Train Loss: 1.542 Vali Loss: 5.906 Vali Acc: 0.101 Test Loss: 5.906 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1556582
	speed: 0.2854s/iter; left time: 5195.6081s
	iters: 200, epoch: 13 | loss: 1.7133281
	speed: 0.0388s/iter; left time: 703.3496s
Epoch: 13 cost time: 9.987569808959961
Epoch: 13, Steps: 208 | Train Loss: 1.348 Vali Loss: 6.186 Vali Acc: 0.109 Test Loss: 6.186 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5337820
	speed: 0.2901s/iter; left time: 5221.1403s
	iters: 200, epoch: 14 | loss: 1.5281773
	speed: 0.0492s/iter; left time: 880.1953s
Epoch: 14 cost time: 11.606834650039673
Epoch: 14, Steps: 208 | Train Loss: 1.182 Vali Loss: 6.553 Vali Acc: 0.104 Test Loss: 6.553 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2645203
	speed: 0.2897s/iter; left time: 5153.5297s
	iters: 200, epoch: 15 | loss: 0.7779706
	speed: 0.0451s/iter; left time: 798.0528s
Epoch: 15 cost time: 10.542327165603638
Epoch: 15, Steps: 208 | Train Loss: 0.974 Vali Loss: 6.904 Vali Acc: 0.094 Test Loss: 6.904 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.7243329
	speed: 0.2479s/iter; left time: 4358.2074s
	iters: 200, epoch: 16 | loss: 0.5424139
	speed: 0.0370s/iter; left time: 647.0788s
Epoch: 16 cost time: 9.04526138305664
Epoch: 16, Steps: 208 | Train Loss: 0.917 Vali Loss: 7.260 Vali Acc: 0.103 Test Loss: 7.260 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.4691879
	speed: 0.2595s/iter; left time: 4508.1179s
	iters: 200, epoch: 17 | loss: 1.8330039
	speed: 0.0399s/iter; left time: 689.0868s
Epoch: 17 cost time: 9.558041095733643
Epoch: 17, Steps: 208 | Train Loss: 0.813 Vali Loss: 7.635 Vali Acc: 0.099 Test Loss: 7.635 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3181021
	speed: 0.3088s/iter; left time: 5300.9843s
	iters: 200, epoch: 18 | loss: 0.6356773
	speed: 0.0450s/iter; left time: 767.5535s
Epoch: 18 cost time: 10.389695644378662
Epoch: 18, Steps: 208 | Train Loss: 0.698 Vali Loss: 7.986 Vali Acc: 0.099 Test Loss: 7.986 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.2157109
	speed: 0.2856s/iter; left time: 4842.9302s
	iters: 200, epoch: 19 | loss: 1.1542788
	speed: 0.0407s/iter; left time: 685.2884s
Epoch: 19 cost time: 8.49805998802185
Epoch: 19, Steps: 208 | Train Loss: 0.598 Vali Loss: 8.345 Vali Acc: 0.098 Test Loss: 8.345 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.4275044
	speed: 0.2898s/iter; left time: 4853.9847s
	iters: 200, epoch: 20 | loss: 0.9638578
	speed: 0.0477s/iter; left time: 793.7174s
Epoch: 20 cost time: 11.242271184921265
Epoch: 20, Steps: 208 | Train Loss: 0.549 Vali Loss: 8.664 Vali Acc: 0.101 Test Loss: 8.664 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.6816703
	speed: 0.2807s/iter; left time: 4643.1979s
	iters: 200, epoch: 21 | loss: 0.6377380
	speed: 0.0452s/iter; left time: 743.5659s
Epoch: 21 cost time: 9.860275983810425
Epoch: 21, Steps: 208 | Train Loss: 0.508 Vali Loss: 9.250 Vali Acc: 0.101 Test Loss: 9.250 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 245863
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.9036274
	speed: 0.1194s/iter; left time: 2471.9763s
	iters: 200, epoch: 1 | loss: 6.0070848
	speed: 0.0855s/iter; left time: 1760.6019s
Epoch: 1 cost time: 21.52518105506897
Epoch: 1, Steps: 208 | Train Loss: 5.450 Vali Loss: 4.805 Vali Acc: 0.069 Test Loss: 4.805 Test Acc: 0.069
Validation loss decreased (inf --> -0.069144).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4934583
	speed: 0.3620s/iter; left time: 7418.3553s
	iters: 200, epoch: 2 | loss: 3.6350617
	speed: 0.0649s/iter; left time: 1322.7457s
Epoch: 2 cost time: 16.662694692611694
Epoch: 2, Steps: 208 | Train Loss: 3.681 Vali Loss: 3.606 Vali Acc: 0.087 Test Loss: 3.606 Test Acc: 0.087
Validation loss decreased (-0.069144 --> -0.086752).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.8089542
	speed: 0.3435s/iter; left time: 6968.2467s
	iters: 200, epoch: 3 | loss: 4.9197359
	speed: 0.0896s/iter; left time: 1808.8051s
Epoch: 3 cost time: 19.02589750289917
Epoch: 3, Steps: 208 | Train Loss: 3.927 Vali Loss: 6.362 Vali Acc: 0.035 Test Loss: 6.362 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.8619976
	speed: 0.2742s/iter; left time: 5504.5591s
	iters: 200, epoch: 4 | loss: 4.4322166
	speed: 0.0625s/iter; left time: 1248.8644s
Epoch: 4 cost time: 12.02712607383728
Epoch: 4, Steps: 208 | Train Loss: 4.050 Vali Loss: 4.252 Vali Acc: 0.101 Test Loss: 4.252 Test Acc: 0.101
Validation loss decreased (-0.086752 --> -0.100464).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.7837548
	speed: 0.3198s/iter; left time: 6353.6326s
	iters: 200, epoch: 5 | loss: 3.8757939
	speed: 0.0518s/iter; left time: 1024.3467s
Epoch: 5 cost time: 11.901335716247559
Epoch: 5, Steps: 208 | Train Loss: 4.076 Vali Loss: 4.990 Vali Acc: 0.102 Test Loss: 4.990 Test Acc: 0.102
Validation loss decreased (-0.100464 --> -0.102247).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.1224532
	speed: 0.3271s/iter; left time: 6432.0302s
	iters: 200, epoch: 6 | loss: 5.3486962
	speed: 0.0715s/iter; left time: 1398.3848s
Epoch: 6 cost time: 16.234580755233765
Epoch: 6, Steps: 208 | Train Loss: 3.836 Vali Loss: 5.194 Vali Acc: 0.095 Test Loss: 5.194 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.4009178
	speed: 0.2919s/iter; left time: 5677.8007s
	iters: 200, epoch: 7 | loss: 3.4673417
	speed: 0.0727s/iter; left time: 1406.9974s
Epoch: 7 cost time: 16.237441778182983
Epoch: 7, Steps: 208 | Train Loss: 3.478 Vali Loss: 6.193 Vali Acc: 0.089 Test Loss: 6.193 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3329699
	speed: 0.3108s/iter; left time: 5981.8432s
	iters: 200, epoch: 8 | loss: 2.3904164
	speed: 0.0850s/iter; left time: 1627.3277s
Epoch: 8 cost time: 16.330934286117554
Epoch: 8, Steps: 208 | Train Loss: 2.750 Vali Loss: 7.910 Vali Acc: 0.054 Test Loss: 7.910 Test Acc: 0.054
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3709475
	speed: 0.3819s/iter; left time: 7270.0036s
	iters: 200, epoch: 9 | loss: 3.1920230
	speed: 0.0853s/iter; left time: 1614.8428s
Epoch: 9 cost time: 19.18837833404541
Epoch: 9, Steps: 208 | Train Loss: 2.052 Vali Loss: 8.016 Vali Acc: 0.081 Test Loss: 8.016 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.2165923
	speed: 0.3856s/iter; left time: 7260.0811s
	iters: 200, epoch: 10 | loss: 2.9707303
	speed: 0.0767s/iter; left time: 1435.9895s
Epoch: 10 cost time: 19.356709241867065
Epoch: 10, Steps: 208 | Train Loss: 1.574 Vali Loss: 5.654 Vali Acc: 0.101 Test Loss: 5.654 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4487228
	speed: 0.3385s/iter; left time: 6304.0366s
	iters: 200, epoch: 11 | loss: 1.1541071
	speed: 0.0947s/iter; left time: 1754.2583s
Epoch: 11 cost time: 19.80476951599121
Epoch: 11, Steps: 208 | Train Loss: 1.244 Vali Loss: 6.926 Vali Acc: 0.103 Test Loss: 6.926 Test Acc: 0.103
Validation loss decreased (-0.102247 --> -0.103122).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7039751
	speed: 0.3625s/iter; left time: 6675.0436s
	iters: 200, epoch: 12 | loss: 1.2077707
	speed: 0.0859s/iter; left time: 1572.4561s
Epoch: 12 cost time: 17.44399404525757
Epoch: 12, Steps: 208 | Train Loss: 1.051 Vali Loss: 6.864 Vali Acc: 0.111 Test Loss: 6.864 Test Acc: 0.111
Validation loss decreased (-0.103122 --> -0.110579).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5550640
	speed: 0.3661s/iter; left time: 6664.4638s
	iters: 200, epoch: 13 | loss: 1.0945001
	speed: 0.0644s/iter; left time: 1165.0715s
Epoch: 13 cost time: 15.01215124130249
Epoch: 13, Steps: 208 | Train Loss: 0.853 Vali Loss: 7.464 Vali Acc: 0.101 Test Loss: 7.464 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9941543
	speed: 0.3785s/iter; left time: 6811.3353s
	iters: 200, epoch: 14 | loss: 0.3701403
	speed: 0.0743s/iter; left time: 1329.8432s
Epoch: 14 cost time: 17.655921697616577
Epoch: 14, Steps: 208 | Train Loss: 0.750 Vali Loss: 8.254 Vali Acc: 0.108 Test Loss: 8.254 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9512253
	speed: 0.3527s/iter; left time: 6274.9417s
	iters: 200, epoch: 15 | loss: 0.4266649
	speed: 0.0795s/iter; left time: 1405.8558s
Epoch: 15 cost time: 19.762965440750122
Epoch: 15, Steps: 208 | Train Loss: 0.646 Vali Loss: 8.335 Vali Acc: 0.103 Test Loss: 8.335 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2205750
	speed: 0.2709s/iter; left time: 4762.7717s
	iters: 200, epoch: 16 | loss: 0.4674907
	speed: 0.0451s/iter; left time: 789.2579s
Epoch: 16 cost time: 10.539790630340576
Epoch: 16, Steps: 208 | Train Loss: 0.527 Vali Loss: 9.188 Vali Acc: 0.116 Test Loss: 9.188 Test Acc: 0.116
Validation loss decreased (-0.110579 --> -0.116222).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2958547
	speed: 0.3235s/iter; left time: 5620.8150s
	iters: 200, epoch: 17 | loss: 0.6237407
	speed: 0.0642s/iter; left time: 1108.1341s
Epoch: 17 cost time: 13.474898099899292
Epoch: 17, Steps: 208 | Train Loss: 0.440 Vali Loss: 9.413 Vali Acc: 0.104 Test Loss: 9.413 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2109010
	speed: 0.3301s/iter; left time: 5666.1871s
	iters: 200, epoch: 18 | loss: 0.8722779
	speed: 0.0691s/iter; left time: 1178.3596s
Epoch: 18 cost time: 15.950959920883179
Epoch: 18, Steps: 208 | Train Loss: 0.376 Vali Loss: 9.803 Vali Acc: 0.103 Test Loss: 9.803 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.0594604
	speed: 0.3306s/iter; left time: 5605.3186s
	iters: 200, epoch: 19 | loss: 0.6674417
	speed: 0.0854s/iter; left time: 1439.6610s
Epoch: 19 cost time: 17.996427536010742
Epoch: 19, Steps: 208 | Train Loss: 0.302 Vali Loss: 11.212 Vali Acc: 0.109 Test Loss: 11.212 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.0963098
	speed: 0.3382s/iter; left time: 5664.0024s
	iters: 200, epoch: 20 | loss: 0.3294249
	speed: 0.0840s/iter; left time: 1399.2466s
Epoch: 20 cost time: 17.369246006011963
Epoch: 20, Steps: 208 | Train Loss: 0.262 Vali Loss: 11.134 Vali Acc: 0.096 Test Loss: 11.134 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0470101
	speed: 0.3871s/iter; left time: 6403.2646s
	iters: 200, epoch: 21 | loss: 0.2014985
	speed: 0.0751s/iter; left time: 1235.2211s
Epoch: 21 cost time: 17.26997137069702
Epoch: 21, Steps: 208 | Train Loss: 0.247 Vali Loss: 11.277 Vali Acc: 0.104 Test Loss: 11.277 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2502353
	speed: 0.3746s/iter; left time: 6118.0308s
	iters: 200, epoch: 22 | loss: 0.2357451
	speed: 0.0836s/iter; left time: 1357.4921s
Epoch: 22 cost time: 19.285444259643555
Epoch: 22, Steps: 208 | Train Loss: 0.242 Vali Loss: 12.072 Vali Acc: 0.102 Test Loss: 12.072 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0075205
	speed: 0.3549s/iter; left time: 5723.4484s
	iters: 200, epoch: 23 | loss: 0.1736681
	speed: 0.0766s/iter; left time: 1226.8894s
Epoch: 23 cost time: 17.630626678466797
Epoch: 23, Steps: 208 | Train Loss: 0.195 Vali Loss: 12.566 Vali Acc: 0.091 Test Loss: 12.566 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1110321
	speed: 0.3247s/iter; left time: 5168.7951s
	iters: 200, epoch: 24 | loss: 0.4063069
	speed: 0.0970s/iter; left time: 1534.2706s
Epoch: 24 cost time: 18.98085641860962
Epoch: 24, Steps: 208 | Train Loss: 0.155 Vali Loss: 13.638 Vali Acc: 0.102 Test Loss: 13.638 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0124074
	speed: 0.3289s/iter; left time: 5167.2076s
	iters: 200, epoch: 25 | loss: 0.5299815
	speed: 0.0690s/iter; left time: 1076.6691s
Epoch: 25 cost time: 14.728748083114624
Epoch: 25, Steps: 208 | Train Loss: 0.188 Vali Loss: 12.831 Vali Acc: 0.106 Test Loss: 12.831 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0333723
	speed: 0.3546s/iter; left time: 5497.3566s
	iters: 200, epoch: 26 | loss: 0.2587169
	speed: 0.0783s/iter; left time: 1206.5768s
Epoch: 26 cost time: 18.29324984550476
Epoch: 26, Steps: 208 | Train Loss: 0.181 Vali Loss: 13.433 Vali Acc: 0.104 Test Loss: 13.433 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11631374888159857
model parameter : 2010855
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9431267
	speed: 0.1165s/iter; left time: 2410.9304s
	iters: 200, epoch: 1 | loss: 3.3806870
	speed: 0.0629s/iter; left time: 1295.3908s
Epoch: 1 cost time: 18.54785442352295
Epoch: 1, Steps: 208 | Train Loss: 4.523 Vali Loss: 4.548 Vali Acc: 0.076 Test Loss: 4.548 Test Acc: 0.076
Validation loss decreased (inf --> -0.075708).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9199460
	speed: 0.2946s/iter; left time: 6037.5574s
	iters: 200, epoch: 2 | loss: 4.5715241
	speed: 0.0535s/iter; left time: 1091.5592s
Epoch: 2 cost time: 11.404675960540771
Epoch: 2, Steps: 208 | Train Loss: 3.597 Vali Loss: 3.443 Vali Acc: 0.092 Test Loss: 3.443 Test Acc: 0.092
Validation loss decreased (-0.075708 --> -0.092420).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4026809
	speed: 0.3286s/iter; left time: 6666.0928s
	iters: 200, epoch: 3 | loss: 3.7077148
	speed: 0.0444s/iter; left time: 895.8480s
Epoch: 3 cost time: 12.56854510307312
Epoch: 3, Steps: 208 | Train Loss: 3.407 Vali Loss: 3.863 Vali Acc: 0.100 Test Loss: 3.863 Test Acc: 0.100
Validation loss decreased (-0.092420 --> -0.099872).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0486166
	speed: 0.3089s/iter; left time: 6202.6839s
	iters: 200, epoch: 4 | loss: 3.9495227
	speed: 0.0447s/iter; left time: 892.6069s
Epoch: 4 cost time: 10.720027208328247
Epoch: 4, Steps: 208 | Train Loss: 3.490 Vali Loss: 4.396 Vali Acc: 0.091 Test Loss: 4.396 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.9897869
	speed: 0.3952s/iter; left time: 7852.2876s
	iters: 200, epoch: 5 | loss: 3.6851318
	speed: 0.0878s/iter; left time: 1735.5876s
Epoch: 5 cost time: 21.461726903915405
Epoch: 5, Steps: 208 | Train Loss: 3.523 Vali Loss: 4.558 Vali Acc: 0.084 Test Loss: 4.558 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.8915126
	speed: 0.3762s/iter; left time: 7396.3819s
	iters: 200, epoch: 6 | loss: 4.1794524
	speed: 0.0873s/iter; left time: 1707.6392s
Epoch: 6 cost time: 19.326141119003296
Epoch: 6, Steps: 208 | Train Loss: 3.351 Vali Loss: 4.855 Vali Acc: 0.089 Test Loss: 4.855 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.5571189
	speed: 0.3096s/iter; left time: 6023.2022s
	iters: 200, epoch: 7 | loss: 3.7762980
	speed: 0.0719s/iter; left time: 1390.5965s
Epoch: 7 cost time: 15.246897459030151
Epoch: 7, Steps: 208 | Train Loss: 3.178 Vali Loss: 4.488 Vali Acc: 0.107 Test Loss: 4.488 Test Acc: 0.107
Validation loss decreased (-0.099872 --> -0.107023).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4079731
	speed: 0.3262s/iter; left time: 6278.3384s
	iters: 200, epoch: 8 | loss: 2.2665162
	speed: 0.0590s/iter; left time: 1130.3743s
Epoch: 8 cost time: 14.991255760192871
Epoch: 8, Steps: 208 | Train Loss: 2.785 Vali Loss: 5.438 Vali Acc: 0.090 Test Loss: 5.438 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9776931
	speed: 0.3183s/iter; left time: 6059.1082s
	iters: 200, epoch: 9 | loss: 2.1520667
	speed: 0.0601s/iter; left time: 1138.0412s
Epoch: 9 cost time: 15.06672716140747
Epoch: 9, Steps: 208 | Train Loss: 2.319 Vali Loss: 4.847 Vali Acc: 0.102 Test Loss: 4.847 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.3885527
	speed: 0.3380s/iter; left time: 6363.9818s
	iters: 200, epoch: 10 | loss: 1.4096889
	speed: 0.0608s/iter; left time: 1138.2432s
Epoch: 10 cost time: 14.049487352371216
Epoch: 10, Steps: 208 | Train Loss: 1.913 Vali Loss: 4.949 Vali Acc: 0.113 Test Loss: 4.949 Test Acc: 0.113
Validation loss decreased (-0.107023 --> -0.113282).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7537689
	speed: 0.3226s/iter; left time: 6007.8669s
	iters: 200, epoch: 11 | loss: 2.2820032
	speed: 0.0628s/iter; left time: 1162.5159s
Epoch: 11 cost time: 13.508323192596436
Epoch: 11, Steps: 208 | Train Loss: 1.562 Vali Loss: 5.707 Vali Acc: 0.118 Test Loss: 5.707 Test Acc: 0.118
Validation loss decreased (-0.113282 --> -0.118046).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0404077
	speed: 0.3314s/iter; left time: 6101.8331s
	iters: 200, epoch: 12 | loss: 1.2043247
	speed: 0.0832s/iter; left time: 1523.2772s
Epoch: 12 cost time: 16.153878211975098
Epoch: 12, Steps: 208 | Train Loss: 1.320 Vali Loss: 5.262 Vali Acc: 0.134 Test Loss: 5.262 Test Acc: 0.134
Validation loss decreased (-0.118046 --> -0.134156).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6013413
	speed: 0.3080s/iter; left time: 5606.3799s
	iters: 200, epoch: 13 | loss: 1.7180790
	speed: 0.0372s/iter; left time: 673.5844s
Epoch: 13 cost time: 10.06976842880249
Epoch: 13, Steps: 208 | Train Loss: 1.181 Vali Loss: 6.108 Vali Acc: 0.115 Test Loss: 6.108 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1722105
	speed: 0.3030s/iter; left time: 5452.5261s
	iters: 200, epoch: 14 | loss: 0.8784122
	speed: 0.0456s/iter; left time: 815.4779s
Epoch: 14 cost time: 10.66579532623291
Epoch: 14, Steps: 208 | Train Loss: 0.937 Vali Loss: 6.418 Vali Acc: 0.115 Test Loss: 6.418 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7035344
	speed: 0.3037s/iter; left time: 5401.9572s
	iters: 200, epoch: 15 | loss: 0.8132584
	speed: 0.0529s/iter; left time: 936.0479s
Epoch: 15 cost time: 13.150402307510376
Epoch: 15, Steps: 208 | Train Loss: 0.755 Vali Loss: 7.091 Vali Acc: 0.126 Test Loss: 7.091 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2272910
	speed: 0.2748s/iter; left time: 4830.4057s
	iters: 200, epoch: 16 | loss: 0.8790295
	speed: 0.0495s/iter; left time: 865.6211s
Epoch: 16 cost time: 10.852574348449707
Epoch: 16, Steps: 208 | Train Loss: 0.628 Vali Loss: 7.458 Vali Acc: 0.119 Test Loss: 7.458 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7123479
	speed: 0.3414s/iter; left time: 5931.6744s
	iters: 200, epoch: 17 | loss: 0.5216513
	speed: 0.0986s/iter; left time: 1702.6045s
Epoch: 17 cost time: 20.70995831489563
Epoch: 17, Steps: 208 | Train Loss: 0.512 Vali Loss: 8.210 Vali Acc: 0.120 Test Loss: 8.210 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4263165
	speed: 0.3522s/iter; left time: 6046.1976s
	iters: 200, epoch: 18 | loss: 0.4352952
	speed: 0.0720s/iter; left time: 1228.6709s
Epoch: 18 cost time: 15.621203184127808
Epoch: 18, Steps: 208 | Train Loss: 0.450 Vali Loss: 8.386 Vali Acc: 0.129 Test Loss: 8.386 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2465418
	speed: 0.3596s/iter; left time: 6098.1217s
	iters: 200, epoch: 19 | loss: 0.4491799
	speed: 0.0717s/iter; left time: 1208.1510s
Epoch: 19 cost time: 15.57250165939331
Epoch: 19, Steps: 208 | Train Loss: 0.427 Vali Loss: 8.762 Vali Acc: 0.125 Test Loss: 8.762 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0962473
	speed: 0.3587s/iter; left time: 6008.4133s
	iters: 200, epoch: 20 | loss: 0.2797467
	speed: 0.0753s/iter; left time: 1253.4273s
Epoch: 20 cost time: 17.982361316680908
Epoch: 20, Steps: 208 | Train Loss: 0.352 Vali Loss: 9.344 Vali Acc: 0.119 Test Loss: 9.344 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3624077
	speed: 0.3281s/iter; left time: 5427.2392s
	iters: 200, epoch: 21 | loss: 0.6000882
	speed: 0.0751s/iter; left time: 1234.9874s
Epoch: 21 cost time: 15.200809717178345
Epoch: 21, Steps: 208 | Train Loss: 0.314 Vali Loss: 9.401 Vali Acc: 0.127 Test Loss: 9.401 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5025548
	speed: 0.3378s/iter; left time: 5516.6478s
	iters: 200, epoch: 22 | loss: 0.6144097
	speed: 0.0460s/iter; left time: 747.3697s
Epoch: 22 cost time: 10.982175827026367
Epoch: 22, Steps: 208 | Train Loss: 0.276 Vali Loss: 10.271 Vali Acc: 0.123 Test Loss: 10.271 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13420817178645988
model parameter : 1022759
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6067758
	speed: 0.1037s/iter; left time: 2146.8546s
	iters: 200, epoch: 1 | loss: 4.0318718
	speed: 0.0488s/iter; left time: 1006.2590s
Epoch: 1 cost time: 16.134069681167603
Epoch: 1, Steps: 208 | Train Loss: 4.220 Vali Loss: 4.500 Vali Acc: 0.061 Test Loss: 4.500 Test Acc: 0.061
Validation loss decreased (inf --> -0.061393).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8391271
	speed: 0.2648s/iter; left time: 5426.7075s
	iters: 200, epoch: 2 | loss: 3.7886922
	speed: 0.0436s/iter; left time: 889.3634s
Epoch: 2 cost time: 10.063467264175415
Epoch: 2, Steps: 208 | Train Loss: 3.759 Vali Loss: 3.783 Vali Acc: 0.072 Test Loss: 3.783 Test Acc: 0.072
Validation loss decreased (-0.061393 --> -0.071540).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9575653
	speed: 0.2766s/iter; left time: 5610.0957s
	iters: 200, epoch: 3 | loss: 3.4895802
	speed: 0.0417s/iter; left time: 842.2573s
Epoch: 3 cost time: 10.516257286071777
Epoch: 3, Steps: 208 | Train Loss: 3.263 Vali Loss: 3.756 Vali Acc: 0.081 Test Loss: 3.756 Test Acc: 0.081
Validation loss decreased (-0.071540 --> -0.081084).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7952054
	speed: 0.2725s/iter; left time: 5471.6923s
	iters: 200, epoch: 4 | loss: 3.7261112
	speed: 0.0479s/iter; left time: 957.0192s
Epoch: 4 cost time: 11.127119779586792
Epoch: 4, Steps: 208 | Train Loss: 3.277 Vali Loss: 4.048 Vali Acc: 0.088 Test Loss: 4.048 Test Acc: 0.088
Validation loss decreased (-0.081084 --> -0.087642).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0153024
	speed: 0.2481s/iter; left time: 4928.6012s
	iters: 200, epoch: 5 | loss: 4.0560050
	speed: 0.0390s/iter; left time: 770.6467s
Epoch: 5 cost time: 9.808912992477417
Epoch: 5, Steps: 208 | Train Loss: 3.237 Vali Loss: 4.211 Vali Acc: 0.094 Test Loss: 4.211 Test Acc: 0.094
Validation loss decreased (-0.087642 --> -0.094202).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.9325206
	speed: 0.2768s/iter; left time: 5442.9441s
	iters: 200, epoch: 6 | loss: 2.7198734
	speed: 0.0510s/iter; left time: 998.5437s
Epoch: 6 cost time: 11.855519771575928
Epoch: 6, Steps: 208 | Train Loss: 3.185 Vali Loss: 4.557 Vali Acc: 0.087 Test Loss: 4.557 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2543602
	speed: 0.2755s/iter; left time: 5358.3962s
	iters: 200, epoch: 7 | loss: 3.8691876
	speed: 0.0585s/iter; left time: 1132.3665s
Epoch: 7 cost time: 13.202840328216553
Epoch: 7, Steps: 208 | Train Loss: 3.012 Vali Loss: 4.753 Vali Acc: 0.107 Test Loss: 4.753 Test Acc: 0.107
Validation loss decreased (-0.094202 --> -0.107319).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9948928
	speed: 0.3286s/iter; left time: 6323.7220s
	iters: 200, epoch: 8 | loss: 3.3933632
	speed: 0.0771s/iter; left time: 1477.0300s
Epoch: 8 cost time: 16.267651081085205
Epoch: 8, Steps: 208 | Train Loss: 2.703 Vali Loss: 5.130 Vali Acc: 0.104 Test Loss: 5.130 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.0987775
	speed: 0.3563s/iter; left time: 6783.4761s
	iters: 200, epoch: 9 | loss: 2.7862821
	speed: 0.0658s/iter; left time: 1246.1843s
Epoch: 9 cost time: 16.95005464553833
Epoch: 9, Steps: 208 | Train Loss: 2.386 Vali Loss: 5.115 Vali Acc: 0.108 Test Loss: 5.115 Test Acc: 0.108
Validation loss decreased (-0.107319 --> -0.107912).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9151285
	speed: 0.3294s/iter; left time: 6202.7665s
	iters: 200, epoch: 10 | loss: 2.2939720
	speed: 0.0721s/iter; left time: 1350.3084s
Epoch: 10 cost time: 15.464483976364136
Epoch: 10, Steps: 208 | Train Loss: 2.033 Vali Loss: 5.259 Vali Acc: 0.114 Test Loss: 5.259 Test Acc: 0.114
Validation loss decreased (-0.107912 --> -0.113577).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8731546
	speed: 0.3369s/iter; left time: 6274.2631s
	iters: 200, epoch: 11 | loss: 1.7117858
	speed: 0.0648s/iter; left time: 1200.6850s
Epoch: 11 cost time: 14.12352180480957
Epoch: 11, Steps: 208 | Train Loss: 1.700 Vali Loss: 5.375 Vali Acc: 0.122 Test Loss: 5.375 Test Acc: 0.122
Validation loss decreased (-0.113577 --> -0.121628).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2650447
	speed: 0.3273s/iter; left time: 6025.9572s
	iters: 200, epoch: 12 | loss: 2.3042910
	speed: 0.0612s/iter; left time: 1119.8478s
Epoch: 12 cost time: 13.881464719772339
Epoch: 12, Steps: 208 | Train Loss: 1.435 Vali Loss: 5.517 Vali Acc: 0.115 Test Loss: 5.517 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7846762
	speed: 0.3186s/iter; left time: 5799.9789s
	iters: 200, epoch: 13 | loss: 1.4587662
	speed: 0.0466s/iter; left time: 843.4247s
Epoch: 13 cost time: 12.009876728057861
Epoch: 13, Steps: 208 | Train Loss: 1.224 Vali Loss: 5.849 Vali Acc: 0.119 Test Loss: 5.849 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6553319
	speed: 0.3246s/iter; left time: 5841.9681s
	iters: 200, epoch: 14 | loss: 1.0232754
	speed: 0.0782s/iter; left time: 1400.3035s
Epoch: 14 cost time: 17.991679191589355
Epoch: 14, Steps: 208 | Train Loss: 1.025 Vali Loss: 6.677 Vali Acc: 0.123 Test Loss: 6.677 Test Acc: 0.123
Validation loss decreased (-0.121628 --> -0.123107).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1551511
	speed: 0.3251s/iter; left time: 5782.3745s
	iters: 200, epoch: 15 | loss: 1.6670660
	speed: 0.0557s/iter; left time: 985.0487s
Epoch: 15 cost time: 11.704339027404785
Epoch: 15, Steps: 208 | Train Loss: 0.869 Vali Loss: 6.896 Vali Acc: 0.114 Test Loss: 6.896 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1845173
	speed: 0.2689s/iter; left time: 4727.6644s
	iters: 200, epoch: 16 | loss: 1.0716203
	speed: 0.0525s/iter; left time: 918.4406s
Epoch: 16 cost time: 11.480595111846924
Epoch: 16, Steps: 208 | Train Loss: 0.702 Vali Loss: 7.339 Vali Acc: 0.121 Test Loss: 7.339 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4201027
	speed: 0.2919s/iter; left time: 5070.3304s
	iters: 200, epoch: 17 | loss: 0.6655136
	speed: 0.0441s/iter; left time: 761.3180s
Epoch: 17 cost time: 11.2138991355896
Epoch: 17, Steps: 208 | Train Loss: 0.603 Vali Loss: 8.049 Vali Acc: 0.112 Test Loss: 8.049 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3823484
	speed: 0.2909s/iter; left time: 4992.6797s
	iters: 200, epoch: 18 | loss: 0.5255993
	speed: 0.0713s/iter; left time: 1216.1359s
Epoch: 18 cost time: 14.075302124023438
Epoch: 18, Steps: 208 | Train Loss: 0.539 Vali Loss: 8.172 Vali Acc: 0.121 Test Loss: 8.172 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.4443624
	speed: 0.3218s/iter; left time: 5456.2486s
	iters: 200, epoch: 19 | loss: 0.2991590
	speed: 0.0590s/iter; left time: 994.5878s
Epoch: 19 cost time: 14.37830638885498
Epoch: 19, Steps: 208 | Train Loss: 0.477 Vali Loss: 8.815 Vali Acc: 0.109 Test Loss: 8.815 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1049592
	speed: 0.3293s/iter; left time: 5514.9783s
	iters: 200, epoch: 20 | loss: 1.0768626
	speed: 0.0543s/iter; left time: 904.4271s
Epoch: 20 cost time: 12.804131984710693
Epoch: 20, Steps: 208 | Train Loss: 0.412 Vali Loss: 9.220 Vali Acc: 0.125 Test Loss: 9.220 Test Acc: 0.125
Validation loss decreased (-0.123107 --> -0.124871).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0931353
	speed: 0.3510s/iter; left time: 5805.2844s
	iters: 200, epoch: 21 | loss: 0.4803016
	speed: 0.0858s/iter; left time: 1411.4027s
Epoch: 21 cost time: 17.85440707206726
Epoch: 21, Steps: 208 | Train Loss: 0.362 Vali Loss: 9.635 Vali Acc: 0.117 Test Loss: 9.635 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2855687
	speed: 0.3212s/iter; left time: 5246.8584s
	iters: 200, epoch: 22 | loss: 0.6168492
	speed: 0.0604s/iter; left time: 980.4986s
Epoch: 22 cost time: 13.227758407592773
Epoch: 22, Steps: 208 | Train Loss: 0.348 Vali Loss: 9.925 Vali Acc: 0.118 Test Loss: 9.925 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2764678
	speed: 0.3098s/iter; left time: 4995.1926s
	iters: 200, epoch: 23 | loss: 0.1248025
	speed: 0.0548s/iter; left time: 877.4920s
Epoch: 23 cost time: 12.568295240402222
Epoch: 23, Steps: 208 | Train Loss: 0.304 Vali Loss: 9.769 Vali Acc: 0.114 Test Loss: 9.769 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1393877
	speed: 0.3025s/iter; left time: 4814.7929s
	iters: 200, epoch: 24 | loss: 0.2839639
	speed: 0.0508s/iter; left time: 803.1988s
Epoch: 24 cost time: 11.398868083953857
Epoch: 24, Steps: 208 | Train Loss: 0.286 Vali Loss: 10.910 Vali Acc: 0.118 Test Loss: 10.910 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.4115363
	speed: 0.2774s/iter; left time: 4357.7233s
	iters: 200, epoch: 25 | loss: 0.3589483
	speed: 0.0370s/iter; left time: 578.1363s
Epoch: 25 cost time: 9.306260108947754
Epoch: 25, Steps: 208 | Train Loss: 0.280 Vali Loss: 10.849 Vali Acc: 0.119 Test Loss: 10.849 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0768821
	speed: 0.2697s/iter; left time: 4180.6037s
	iters: 200, epoch: 26 | loss: 0.6735438
	speed: 0.0328s/iter; left time: 505.4167s
Epoch: 26 cost time: 8.296224355697632
Epoch: 26, Steps: 208 | Train Loss: 0.268 Vali Loss: 11.262 Vali Acc: 0.112 Test Loss: 11.262 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1685334
	speed: 0.2593s/iter; left time: 3965.5810s
	iters: 200, epoch: 27 | loss: 0.2857745
	speed: 0.0421s/iter; left time: 639.1701s
Epoch: 27 cost time: 10.345579385757446
Epoch: 27, Steps: 208 | Train Loss: 0.250 Vali Loss: 11.459 Vali Acc: 0.117 Test Loss: 11.459 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1482783
	speed: 0.2615s/iter; left time: 3944.7955s
	iters: 200, epoch: 28 | loss: 0.2227791
	speed: 0.0693s/iter; left time: 1039.1181s
Epoch: 28 cost time: 12.477390050888062
Epoch: 28, Steps: 208 | Train Loss: 0.214 Vali Loss: 11.726 Vali Acc: 0.114 Test Loss: 11.726 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0714480
	speed: 0.2795s/iter; left time: 4158.1100s
	iters: 200, epoch: 29 | loss: 0.6352068
	speed: 0.0447s/iter; left time: 660.1567s
Epoch: 29 cost time: 10.828274488449097
Epoch: 29, Steps: 208 | Train Loss: 0.226 Vali Loss: 11.791 Vali Acc: 0.118 Test Loss: 11.791 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.6218313
	speed: 0.3070s/iter; left time: 4503.7814s
	iters: 200, epoch: 30 | loss: 0.3000604
	speed: 0.0381s/iter; left time: 554.8735s
Epoch: 30 cost time: 9.624280452728271
Epoch: 30, Steps: 208 | Train Loss: 0.230 Vali Loss: 12.428 Vali Acc: 0.114 Test Loss: 12.428 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12496271995228155
model parameter : 693671
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3516273
	speed: 0.0975s/iter; left time: 2017.3803s
	iters: 200, epoch: 1 | loss: 4.9533873
	speed: 0.0663s/iter; left time: 1365.0063s
Epoch: 1 cost time: 17.13550066947937
Epoch: 1, Steps: 208 | Train Loss: 4.131 Vali Loss: 4.353 Vali Acc: 0.062 Test Loss: 4.353 Test Acc: 0.062
Validation loss decreased (inf --> -0.061692).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5228755
	speed: 0.3011s/iter; left time: 6169.9021s
	iters: 200, epoch: 2 | loss: 4.2682400
	speed: 0.0490s/iter; left time: 999.8499s
Epoch: 2 cost time: 12.03407073020935
Epoch: 2, Steps: 208 | Train Loss: 3.763 Vali Loss: 3.844 Vali Acc: 0.075 Test Loss: 3.844 Test Acc: 0.075
Validation loss decreased (-0.061692 --> -0.074820).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6913693
	speed: 0.3246s/iter; left time: 6585.1038s
	iters: 200, epoch: 3 | loss: 3.7144604
	speed: 0.0631s/iter; left time: 1274.6523s
Epoch: 3 cost time: 14.666402101516724
Epoch: 3, Steps: 208 | Train Loss: 3.229 Vali Loss: 3.706 Vali Acc: 0.096 Test Loss: 3.706 Test Acc: 0.096
Validation loss decreased (-0.074820 --> -0.096295).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7054625
	speed: 0.2930s/iter; left time: 5883.4835s
	iters: 200, epoch: 4 | loss: 2.3762405
	speed: 0.0681s/iter; left time: 1361.0711s
Epoch: 4 cost time: 14.870802879333496
Epoch: 4, Steps: 208 | Train Loss: 3.121 Vali Loss: 4.165 Vali Acc: 0.092 Test Loss: 4.165 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2898295
	speed: 0.2995s/iter; left time: 5950.8974s
	iters: 200, epoch: 5 | loss: 3.5348980
	speed: 0.0582s/iter; left time: 1150.9756s
Epoch: 5 cost time: 12.845717191696167
Epoch: 5, Steps: 208 | Train Loss: 3.114 Vali Loss: 4.448 Vali Acc: 0.086 Test Loss: 4.448 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.2945716
	speed: 0.2928s/iter; left time: 5755.8023s
	iters: 200, epoch: 6 | loss: 4.0356660
	speed: 0.0428s/iter; left time: 836.4636s
Epoch: 6 cost time: 10.405849695205688
Epoch: 6, Steps: 208 | Train Loss: 3.011 Vali Loss: 4.532 Vali Acc: 0.106 Test Loss: 4.532 Test Acc: 0.106
Validation loss decreased (-0.096295 --> -0.105532).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7270367
	speed: 0.2948s/iter; left time: 5735.4347s
	iters: 200, epoch: 7 | loss: 2.9680982
	speed: 0.0482s/iter; left time: 932.4062s
Epoch: 7 cost time: 10.945947170257568
Epoch: 7, Steps: 208 | Train Loss: 2.867 Vali Loss: 4.448 Vali Acc: 0.112 Test Loss: 4.448 Test Acc: 0.112
Validation loss decreased (-0.105532 --> -0.112392).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6150763
	speed: 0.3008s/iter; left time: 5788.7592s
	iters: 200, epoch: 8 | loss: 2.8209267
	speed: 0.0459s/iter; left time: 878.6801s
Epoch: 8 cost time: 11.873908996582031
Epoch: 8, Steps: 208 | Train Loss: 2.611 Vali Loss: 4.819 Vali Acc: 0.121 Test Loss: 4.819 Test Acc: 0.121
Validation loss decreased (-0.112392 --> -0.121037).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5445817
	speed: 0.2986s/iter; left time: 5685.1869s
	iters: 200, epoch: 9 | loss: 2.6494985
	speed: 0.0563s/iter; left time: 1065.3717s
Epoch: 9 cost time: 12.58060097694397
Epoch: 9, Steps: 208 | Train Loss: 2.343 Vali Loss: 4.945 Vali Acc: 0.112 Test Loss: 4.945 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2875133
	speed: 0.2757s/iter; left time: 5191.0205s
	iters: 200, epoch: 10 | loss: 3.1555343
	speed: 0.0554s/iter; left time: 1037.8799s
Epoch: 10 cost time: 11.352241277694702
Epoch: 10, Steps: 208 | Train Loss: 2.046 Vali Loss: 4.954 Vali Acc: 0.117 Test Loss: 4.954 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7926838
	speed: 0.2686s/iter; left time: 5002.2944s
	iters: 200, epoch: 11 | loss: 1.9095870
	speed: 0.0402s/iter; left time: 744.3003s
Epoch: 11 cost time: 9.231002569198608
Epoch: 11, Steps: 208 | Train Loss: 1.782 Vali Loss: 5.455 Vali Acc: 0.108 Test Loss: 5.455 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4380214
	speed: 0.2947s/iter; left time: 5426.4748s
	iters: 200, epoch: 12 | loss: 1.5879083
	speed: 0.0502s/iter; left time: 918.9363s
Epoch: 12 cost time: 12.430252313613892
Epoch: 12, Steps: 208 | Train Loss: 1.535 Vali Loss: 5.588 Vali Acc: 0.122 Test Loss: 5.588 Test Acc: 0.122
Validation loss decreased (-0.121037 --> -0.121924).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6575571
	speed: 0.3153s/iter; left time: 5739.4742s
	iters: 200, epoch: 13 | loss: 1.2486182
	speed: 0.0528s/iter; left time: 956.3404s
Epoch: 13 cost time: 11.890211582183838
Epoch: 13, Steps: 208 | Train Loss: 1.297 Vali Loss: 5.748 Vali Acc: 0.115 Test Loss: 5.748 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8572420
	speed: 0.3186s/iter; left time: 5732.9883s
	iters: 200, epoch: 14 | loss: 0.9221225
	speed: 0.0806s/iter; left time: 1441.9611s
Epoch: 14 cost time: 16.870901346206665
Epoch: 14, Steps: 208 | Train Loss: 1.096 Vali Loss: 6.306 Vali Acc: 0.119 Test Loss: 6.306 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.0917149
	speed: 0.3112s/iter; left time: 5535.4691s
	iters: 200, epoch: 15 | loss: 1.3022506
	speed: 0.0666s/iter; left time: 1177.3896s
Epoch: 15 cost time: 14.138855934143066
Epoch: 15, Steps: 208 | Train Loss: 0.942 Vali Loss: 6.234 Vali Acc: 0.111 Test Loss: 6.234 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8691640
	speed: 0.3078s/iter; left time: 5410.9525s
	iters: 200, epoch: 16 | loss: 0.9183546
	speed: 0.0485s/iter; left time: 848.3210s
Epoch: 16 cost time: 11.341533184051514
Epoch: 16, Steps: 208 | Train Loss: 0.779 Vali Loss: 6.941 Vali Acc: 0.119 Test Loss: 6.941 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3665286
	speed: 0.3044s/iter; left time: 5287.7489s
	iters: 200, epoch: 17 | loss: 1.2037017
	speed: 0.0491s/iter; left time: 847.3500s
Epoch: 17 cost time: 12.020422220230103
Epoch: 17, Steps: 208 | Train Loss: 0.668 Vali Loss: 7.569 Vali Acc: 0.111 Test Loss: 7.569 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4720433
	speed: 0.2715s/iter; left time: 4660.4179s
	iters: 200, epoch: 18 | loss: 0.6629162
	speed: 0.0564s/iter; left time: 962.7451s
Epoch: 18 cost time: 11.476218223571777
Epoch: 18, Steps: 208 | Train Loss: 0.591 Vali Loss: 7.914 Vali Acc: 0.118 Test Loss: 7.914 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.5487265
	speed: 0.2609s/iter; left time: 4424.1612s
	iters: 200, epoch: 19 | loss: 0.2902297
	speed: 0.0396s/iter; left time: 667.9950s
Epoch: 19 cost time: 9.72732400894165
Epoch: 19, Steps: 208 | Train Loss: 0.509 Vali Loss: 8.114 Vali Acc: 0.115 Test Loss: 8.114 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.7734563
	speed: 0.2697s/iter; left time: 4516.6970s
	iters: 200, epoch: 20 | loss: 0.6008963
	speed: 0.0354s/iter; left time: 589.2985s
Epoch: 20 cost time: 8.745630025863647
Epoch: 20, Steps: 208 | Train Loss: 0.435 Vali Loss: 8.670 Vali Acc: 0.119 Test Loss: 8.670 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2124695
	speed: 0.2834s/iter; left time: 4687.2090s
	iters: 200, epoch: 21 | loss: 0.7811891
	speed: 0.0405s/iter; left time: 666.3303s
Epoch: 21 cost time: 9.422719240188599
Epoch: 21, Steps: 208 | Train Loss: 0.413 Vali Loss: 8.992 Vali Acc: 0.118 Test Loss: 8.992 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.0810204
	speed: 0.3031s/iter; left time: 4949.9297s
	iters: 200, epoch: 22 | loss: 0.7873206
	speed: 0.0716s/iter; left time: 1161.5682s
Epoch: 22 cost time: 15.178319692611694
Epoch: 22, Steps: 208 | Train Loss: 0.383 Vali Loss: 9.536 Vali Acc: 0.118 Test Loss: 9.536 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12198031613480466
model parameter : 556711
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6779592
	speed: 0.0890s/iter; left time: 1842.1377s
	iters: 200, epoch: 1 | loss: 4.2295861
	speed: 0.0631s/iter; left time: 1299.5040s
Epoch: 1 cost time: 16.004573822021484
Epoch: 1, Steps: 208 | Train Loss: 3.934 Vali Loss: 4.133 Vali Acc: 0.045 Test Loss: 4.133 Test Acc: 0.045
Validation loss decreased (inf --> -0.044695).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3800304
	speed: 0.3012s/iter; left time: 6172.9245s
	iters: 200, epoch: 2 | loss: 3.5454690
	speed: 0.0488s/iter; left time: 995.0454s
Epoch: 2 cost time: 10.37668776512146
Epoch: 2, Steps: 208 | Train Loss: 3.733 Vali Loss: 4.108 Vali Acc: 0.064 Test Loss: 4.108 Test Acc: 0.064
Validation loss decreased (-0.044695 --> -0.064081).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4081454
	speed: 0.3125s/iter; left time: 6338.4038s
	iters: 200, epoch: 3 | loss: 3.8203173
	speed: 0.0487s/iter; left time: 983.3780s
Epoch: 3 cost time: 12.87516474723816
Epoch: 3, Steps: 208 | Train Loss: 3.317 Vali Loss: 4.179 Vali Acc: 0.072 Test Loss: 4.179 Test Acc: 0.072
Validation loss decreased (-0.064081 --> -0.072132).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9821782
	speed: 0.3139s/iter; left time: 6301.7216s
	iters: 200, epoch: 4 | loss: 3.1748548
	speed: 0.0604s/iter; left time: 1206.0390s
Epoch: 4 cost time: 13.337585687637329
Epoch: 4, Steps: 208 | Train Loss: 3.091 Vali Loss: 4.091 Vali Acc: 0.078 Test Loss: 4.091 Test Acc: 0.078
Validation loss decreased (-0.072132 --> -0.078396).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1335359
	speed: 0.3000s/iter; left time: 5959.9502s
	iters: 200, epoch: 5 | loss: 2.9640808
	speed: 0.0754s/iter; left time: 1491.3920s
Epoch: 5 cost time: 15.013025522232056
Epoch: 5, Steps: 208 | Train Loss: 2.977 Vali Loss: 4.491 Vali Acc: 0.084 Test Loss: 4.491 Test Acc: 0.084
Validation loss decreased (-0.078396 --> -0.084357).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5302868
	speed: 0.3047s/iter; left time: 5990.5255s
	iters: 200, epoch: 6 | loss: 2.8662326
	speed: 0.0348s/iter; left time: 679.8569s
Epoch: 6 cost time: 10.277122974395752
Epoch: 6, Steps: 208 | Train Loss: 2.896 Vali Loss: 4.481 Vali Acc: 0.098 Test Loss: 4.481 Test Acc: 0.098
Validation loss decreased (-0.084357 --> -0.097778).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2721896
	speed: 0.2769s/iter; left time: 5387.4009s
	iters: 200, epoch: 7 | loss: 3.7458866
	speed: 0.0399s/iter; left time: 772.8352s
Epoch: 7 cost time: 9.263344526290894
Epoch: 7, Steps: 208 | Train Loss: 2.786 Vali Loss: 4.613 Vali Acc: 0.101 Test Loss: 4.613 Test Acc: 0.101
Validation loss decreased (-0.097778 --> -0.101057).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6585639
	speed: 0.2915s/iter; left time: 5609.6429s
	iters: 200, epoch: 8 | loss: 2.7752559
	speed: 0.0411s/iter; left time: 786.0901s
Epoch: 8 cost time: 10.02944016456604
Epoch: 8, Steps: 208 | Train Loss: 2.594 Vali Loss: 4.677 Vali Acc: 0.109 Test Loss: 4.677 Test Acc: 0.109
Validation loss decreased (-0.101057 --> -0.109109).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9306527
	speed: 0.2873s/iter; left time: 5469.4139s
	iters: 200, epoch: 9 | loss: 2.7380583
	speed: 0.0347s/iter; left time: 657.0579s
Epoch: 9 cost time: 8.453182458877563
Epoch: 9, Steps: 208 | Train Loss: 2.406 Vali Loss: 4.673 Vali Acc: 0.115 Test Loss: 4.673 Test Acc: 0.115
Validation loss decreased (-0.109109 --> -0.115074).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1562395
	speed: 0.2671s/iter; left time: 5029.1744s
	iters: 200, epoch: 10 | loss: 2.1716607
	speed: 0.0433s/iter; left time: 811.0573s
Epoch: 10 cost time: 10.045795917510986
Epoch: 10, Steps: 208 | Train Loss: 2.160 Vali Loss: 4.878 Vali Acc: 0.109 Test Loss: 4.878 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.0990167
	speed: 0.2765s/iter; left time: 5149.5884s
	iters: 200, epoch: 11 | loss: 2.0696254
	speed: 0.0419s/iter; left time: 775.7842s
Epoch: 11 cost time: 9.961979150772095
Epoch: 11, Steps: 208 | Train Loss: 1.895 Vali Loss: 5.087 Vali Acc: 0.108 Test Loss: 5.087 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3516383
	speed: 0.2680s/iter; left time: 4934.3078s
	iters: 200, epoch: 12 | loss: 2.5021164
	speed: 0.0396s/iter; left time: 724.6176s
Epoch: 12 cost time: 8.954553842544556
Epoch: 12, Steps: 208 | Train Loss: 1.730 Vali Loss: 5.148 Vali Acc: 0.112 Test Loss: 5.148 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5634346
	speed: 0.2851s/iter; left time: 5190.9216s
	iters: 200, epoch: 13 | loss: 1.7994171
	speed: 0.0619s/iter; left time: 1120.5564s
Epoch: 13 cost time: 13.992090463638306
Epoch: 13, Steps: 208 | Train Loss: 1.526 Vali Loss: 5.370 Vali Acc: 0.118 Test Loss: 5.370 Test Acc: 0.118
Validation loss decreased (-0.115074 --> -0.117751).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5279455
	speed: 0.2748s/iter; left time: 4945.1362s
	iters: 200, epoch: 14 | loss: 1.5441334
	speed: 0.0364s/iter; left time: 651.1272s
Epoch: 14 cost time: 9.046460390090942
Epoch: 14, Steps: 208 | Train Loss: 1.325 Vali Loss: 5.644 Vali Acc: 0.117 Test Loss: 5.644 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7040030
	speed: 0.2789s/iter; left time: 4960.6256s
	iters: 200, epoch: 15 | loss: 1.4534811
	speed: 0.0441s/iter; left time: 780.6616s
Epoch: 15 cost time: 11.131632089614868
Epoch: 15, Steps: 208 | Train Loss: 1.162 Vali Loss: 6.169 Vali Acc: 0.112 Test Loss: 6.169 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.6994219
	speed: 0.2734s/iter; left time: 4807.4236s
	iters: 200, epoch: 16 | loss: 1.0165101
	speed: 0.0546s/iter; left time: 955.2834s
Epoch: 16 cost time: 12.319177150726318
Epoch: 16, Steps: 208 | Train Loss: 1.004 Vali Loss: 6.527 Vali Acc: 0.121 Test Loss: 6.527 Test Acc: 0.121
Validation loss decreased (-0.117751 --> -0.120722).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7885917
	speed: 0.3241s/iter; left time: 5631.0366s
	iters: 200, epoch: 17 | loss: 1.1949506
	speed: 0.0718s/iter; left time: 1240.5188s
Epoch: 17 cost time: 16.22831106185913
Epoch: 17, Steps: 208 | Train Loss: 0.868 Vali Loss: 6.819 Vali Acc: 0.120 Test Loss: 6.819 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5099114
	speed: 0.2949s/iter; left time: 5062.2026s
	iters: 200, epoch: 18 | loss: 0.5833015
	speed: 0.0383s/iter; left time: 654.0245s
Epoch: 18 cost time: 9.118078708648682
Epoch: 18, Steps: 208 | Train Loss: 0.769 Vali Loss: 7.369 Vali Acc: 0.116 Test Loss: 7.369 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2408939
	speed: 0.2668s/iter; left time: 4524.4394s
	iters: 200, epoch: 19 | loss: 0.7652913
	speed: 0.0414s/iter; left time: 698.5987s
Epoch: 19 cost time: 9.85350751876831
Epoch: 19, Steps: 208 | Train Loss: 0.700 Vali Loss: 7.565 Vali Acc: 0.110 Test Loss: 7.565 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.3574755
	speed: 0.2453s/iter; left time: 4108.4166s
	iters: 200, epoch: 20 | loss: 0.4221992
	speed: 0.0496s/iter; left time: 825.3957s
Epoch: 20 cost time: 10.011114597320557
Epoch: 20, Steps: 208 | Train Loss: 0.591 Vali Loss: 7.781 Vali Acc: 0.115 Test Loss: 7.781 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.6409772
	speed: 0.2525s/iter; left time: 4176.9646s
	iters: 200, epoch: 21 | loss: 0.6084259
	speed: 0.0312s/iter; left time: 513.3195s
Epoch: 21 cost time: 8.654831171035767
Epoch: 21, Steps: 208 | Train Loss: 0.529 Vali Loss: 8.448 Vali Acc: 0.109 Test Loss: 8.448 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3138626
	speed: 0.2570s/iter; left time: 4197.2671s
	iters: 200, epoch: 22 | loss: 1.6458511
	speed: 0.0323s/iter; left time: 523.5616s
Epoch: 22 cost time: 7.887874603271484
Epoch: 22, Steps: 208 | Train Loss: 0.488 Vali Loss: 8.742 Vali Acc: 0.119 Test Loss: 8.742 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.4201339
	speed: 0.2684s/iter; left time: 4327.8934s
	iters: 200, epoch: 23 | loss: 0.8491829
	speed: 0.0606s/iter; left time: 971.8033s
Epoch: 23 cost time: 12.354697227478027
Epoch: 23, Steps: 208 | Train Loss: 0.453 Vali Loss: 9.192 Vali Acc: 0.118 Test Loss: 9.192 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1769037
	speed: 0.2654s/iter; left time: 4224.2655s
	iters: 200, epoch: 24 | loss: 0.6384962
	speed: 0.0439s/iter; left time: 693.7686s
Epoch: 24 cost time: 10.076245069503784
Epoch: 24, Steps: 208 | Train Loss: 0.417 Vali Loss: 9.271 Vali Acc: 0.112 Test Loss: 9.271 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.8002536
	speed: 0.2946s/iter; left time: 4627.8413s
	iters: 200, epoch: 25 | loss: 0.3776978
	speed: 0.0435s/iter; left time: 679.6814s
Epoch: 25 cost time: 10.623432397842407
Epoch: 25, Steps: 208 | Train Loss: 0.391 Vali Loss: 9.615 Vali Acc: 0.111 Test Loss: 9.615 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.3432263
	speed: 0.2852s/iter; left time: 4420.5718s
	iters: 200, epoch: 26 | loss: 0.2102712
	speed: 0.0432s/iter; left time: 665.3574s
Epoch: 26 cost time: 10.888723850250244
Epoch: 26, Steps: 208 | Train Loss: 0.375 Vali Loss: 10.037 Vali Acc: 0.111 Test Loss: 10.037 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1207873546078139
model parameter : 365223
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4047120
	speed: 0.0741s/iter; left time: 1533.1613s
	iters: 200, epoch: 1 | loss: 3.6666408
	speed: 0.0382s/iter; left time: 786.3525s
Epoch: 1 cost time: 11.675938606262207
Epoch: 1, Steps: 208 | Train Loss: 3.867 Vali Loss: 3.981 Vali Acc: 0.051 Test Loss: 3.981 Test Acc: 0.051
Validation loss decreased (inf --> -0.050959).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5721254
	speed: 0.2769s/iter; left time: 5674.1317s
	iters: 200, epoch: 2 | loss: 3.3610904
	speed: 0.0372s/iter; left time: 759.6167s
Epoch: 2 cost time: 8.9625403881073
Epoch: 2, Steps: 208 | Train Loss: 3.644 Vali Loss: 4.011 Vali Acc: 0.082 Test Loss: 4.011 Test Acc: 0.082
Validation loss decreased (-0.050959 --> -0.082274).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8786612
	speed: 0.2857s/iter; left time: 5796.3608s
	iters: 200, epoch: 3 | loss: 3.2376420
	speed: 0.0362s/iter; left time: 729.7551s
Epoch: 3 cost time: 9.25732135772705
Epoch: 3, Steps: 208 | Train Loss: 3.329 Vali Loss: 4.148 Vali Acc: 0.081 Test Loss: 4.148 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.9929900
	speed: 0.2904s/iter; left time: 5830.8535s
	iters: 200, epoch: 4 | loss: 4.1447239
	speed: 0.0461s/iter; left time: 920.4555s
Epoch: 4 cost time: 11.212705135345459
Epoch: 4, Steps: 208 | Train Loss: 3.142 Vali Loss: 4.227 Vali Acc: 0.090 Test Loss: 4.227 Test Acc: 0.090
Validation loss decreased (-0.082274 --> -0.089728).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3223312
	speed: 0.2656s/iter; left time: 5277.2161s
	iters: 200, epoch: 5 | loss: 4.2282352
	speed: 0.0407s/iter; left time: 803.8256s
Epoch: 5 cost time: 9.258692741394043
Epoch: 5, Steps: 208 | Train Loss: 3.000 Vali Loss: 4.247 Vali Acc: 0.084 Test Loss: 4.247 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.7195826
	speed: 0.2547s/iter; left time: 5007.8263s
	iters: 200, epoch: 6 | loss: 3.3451281
	speed: 0.0344s/iter; left time: 672.2325s
Epoch: 6 cost time: 8.328203678131104
Epoch: 6, Steps: 208 | Train Loss: 2.830 Vali Loss: 4.562 Vali Acc: 0.090 Test Loss: 4.562 Test Acc: 0.090
Validation loss decreased (-0.089728 --> -0.090321).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0931091
	speed: 0.2589s/iter; left time: 5035.8491s
	iters: 200, epoch: 7 | loss: 2.3797488
	speed: 0.0354s/iter; left time: 684.5702s
Epoch: 7 cost time: 9.011218547821045
Epoch: 7, Steps: 208 | Train Loss: 2.665 Vali Loss: 4.943 Vali Acc: 0.078 Test Loss: 4.943 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4920156
	speed: 0.2429s/iter; left time: 4675.4687s
	iters: 200, epoch: 8 | loss: 2.4311743
	speed: 0.0322s/iter; left time: 615.7049s
Epoch: 8 cost time: 7.573530673980713
Epoch: 8, Steps: 208 | Train Loss: 2.482 Vali Loss: 4.882 Vali Acc: 0.096 Test Loss: 4.882 Test Acc: 0.096
Validation loss decreased (-0.090321 --> -0.095686).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1696153
	speed: 0.2749s/iter; left time: 5233.6907s
	iters: 200, epoch: 9 | loss: 2.1010849
	speed: 0.0419s/iter; left time: 794.2925s
Epoch: 9 cost time: 10.137541770935059
Epoch: 9, Steps: 208 | Train Loss: 2.306 Vali Loss: 4.889 Vali Acc: 0.095 Test Loss: 4.889 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3798137
	speed: 0.2925s/iter; left time: 5506.8242s
	iters: 200, epoch: 10 | loss: 2.7173383
	speed: 0.0467s/iter; left time: 874.1063s
Epoch: 10 cost time: 10.774967908859253
Epoch: 10, Steps: 208 | Train Loss: 2.093 Vali Loss: 5.113 Vali Acc: 0.101 Test Loss: 5.113 Test Acc: 0.101
Validation loss decreased (-0.095686 --> -0.100754).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4399542
	speed: 0.2853s/iter; left time: 5311.9191s
	iters: 200, epoch: 11 | loss: 2.3594625
	speed: 0.0421s/iter; left time: 779.3551s
Epoch: 11 cost time: 10.627872228622437
Epoch: 11, Steps: 208 | Train Loss: 1.918 Vali Loss: 5.094 Vali Acc: 0.106 Test Loss: 5.094 Test Acc: 0.106
Validation loss decreased (-0.100754 --> -0.105526).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4221240
	speed: 0.2718s/iter; left time: 5004.4319s
	iters: 200, epoch: 12 | loss: 3.3544488
	speed: 0.0406s/iter; left time: 742.6283s
Epoch: 12 cost time: 9.120534420013428
Epoch: 12, Steps: 208 | Train Loss: 1.714 Vali Loss: 5.560 Vali Acc: 0.102 Test Loss: 5.560 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6067736
	speed: 0.2744s/iter; left time: 4995.7575s
	iters: 200, epoch: 13 | loss: 1.2449502
	speed: 0.0358s/iter; left time: 647.6994s
Epoch: 13 cost time: 8.9920814037323
Epoch: 13, Steps: 208 | Train Loss: 1.516 Vali Loss: 5.823 Vali Acc: 0.106 Test Loss: 5.823 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2994864
	speed: 0.2659s/iter; left time: 4784.5314s
	iters: 200, epoch: 14 | loss: 2.0395269
	speed: 0.0299s/iter; left time: 535.5613s
Epoch: 14 cost time: 8.478560209274292
Epoch: 14, Steps: 208 | Train Loss: 1.354 Vali Loss: 6.014 Vali Acc: 0.108 Test Loss: 6.014 Test Acc: 0.108
Validation loss decreased (-0.105526 --> -0.107605).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0433702
	speed: 0.2353s/iter; left time: 4186.2367s
	iters: 200, epoch: 15 | loss: 1.5214728
	speed: 0.0367s/iter; left time: 649.5294s
Epoch: 15 cost time: 8.31387972831726
Epoch: 15, Steps: 208 | Train Loss: 1.180 Vali Loss: 6.449 Vali Acc: 0.110 Test Loss: 6.449 Test Acc: 0.110
Validation loss decreased (-0.107605 --> -0.110284).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6710278
	speed: 0.2671s/iter; left time: 4695.8009s
	iters: 200, epoch: 16 | loss: 1.1020534
	speed: 0.0347s/iter; left time: 605.8716s
Epoch: 16 cost time: 8.86755657196045
Epoch: 16, Steps: 208 | Train Loss: 1.040 Vali Loss: 6.751 Vali Acc: 0.111 Test Loss: 6.751 Test Acc: 0.111
Validation loss decreased (-0.110284 --> -0.111176).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6467509
	speed: 0.2893s/iter; left time: 5025.7286s
	iters: 200, epoch: 17 | loss: 1.3014075
	speed: 0.0355s/iter; left time: 613.2565s
Epoch: 17 cost time: 8.911388397216797
Epoch: 17, Steps: 208 | Train Loss: 0.939 Vali Loss: 6.942 Vali Acc: 0.108 Test Loss: 6.942 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3591377
	speed: 0.2741s/iter; left time: 4704.0913s
	iters: 200, epoch: 18 | loss: 1.5383346
	speed: 0.0382s/iter; left time: 651.8936s
Epoch: 18 cost time: 9.267897605895996
Epoch: 18, Steps: 208 | Train Loss: 0.813 Vali Loss: 7.497 Vali Acc: 0.107 Test Loss: 7.497 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.0281054
	speed: 0.2703s/iter; left time: 4582.7996s
	iters: 200, epoch: 19 | loss: 0.5126600
	speed: 0.0387s/iter; left time: 652.1962s
Epoch: 19 cost time: 10.003936290740967
Epoch: 19, Steps: 208 | Train Loss: 0.734 Vali Loss: 7.620 Vali Acc: 0.101 Test Loss: 7.620 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.9830058
	speed: 0.2625s/iter; left time: 4397.3155s
	iters: 200, epoch: 20 | loss: 0.6274385
	speed: 0.0339s/iter; left time: 563.8207s
Epoch: 20 cost time: 8.65944218635559
Epoch: 20, Steps: 208 | Train Loss: 0.667 Vali Loss: 8.166 Vali Acc: 0.102 Test Loss: 8.166 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.8496423
	speed: 0.2728s/iter; left time: 4512.2586s
	iters: 200, epoch: 21 | loss: 0.2684550
	speed: 0.0395s/iter; left time: 650.1528s
Epoch: 21 cost time: 9.256526231765747
Epoch: 21, Steps: 208 | Train Loss: 0.584 Vali Loss: 8.429 Vali Acc: 0.111 Test Loss: 8.429 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.4399513
	speed: 0.2966s/iter; left time: 4844.2531s
	iters: 200, epoch: 22 | loss: 0.7575521
	speed: 0.0439s/iter; left time: 712.1323s
Epoch: 22 cost time: 10.127136707305908
Epoch: 22, Steps: 208 | Train Loss: 0.557 Vali Loss: 8.704 Vali Acc: 0.105 Test Loss: 8.704 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.6400000
	speed: 0.2963s/iter; left time: 4778.3869s
	iters: 200, epoch: 23 | loss: 0.8563992
	speed: 0.0430s/iter; left time: 689.4668s
Epoch: 23 cost time: 10.084981679916382
Epoch: 23, Steps: 208 | Train Loss: 0.475 Vali Loss: 9.120 Vali Acc: 0.101 Test Loss: 9.120 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2286099
	speed: 0.2921s/iter; left time: 4648.7598s
	iters: 200, epoch: 24 | loss: 0.7771318
	speed: 0.0431s/iter; left time: 681.1760s
Epoch: 24 cost time: 9.522843599319458
Epoch: 24, Steps: 208 | Train Loss: 0.478 Vali Loss: 9.252 Vali Acc: 0.108 Test Loss: 9.252 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1120625
	speed: 0.2813s/iter; left time: 4418.3356s
	iters: 200, epoch: 25 | loss: 0.8731779
	speed: 0.0385s/iter; left time: 600.6022s
Epoch: 25 cost time: 9.577938318252563
Epoch: 25, Steps: 208 | Train Loss: 0.413 Vali Loss: 9.947 Vali Acc: 0.105 Test Loss: 9.947 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2494539
	speed: 0.2742s/iter; left time: 4250.6156s
	iters: 200, epoch: 26 | loss: 0.3513302
	speed: 0.0377s/iter; left time: 580.4788s
Epoch: 26 cost time: 8.977631330490112
Epoch: 26, Steps: 208 | Train Loss: 0.403 Vali Loss: 10.355 Vali Acc: 0.110 Test Loss: 10.355 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11124366239188786
model parameter : 283559
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8310440
	speed: 0.0718s/iter; left time: 1485.4956s
	iters: 200, epoch: 1 | loss: 3.8544977
	speed: 0.0341s/iter; left time: 701.8253s
Epoch: 1 cost time: 11.036549806594849
Epoch: 1, Steps: 208 | Train Loss: 3.826 Vali Loss: 3.910 Vali Acc: 0.057 Test Loss: 3.910 Test Acc: 0.057
Validation loss decreased (inf --> -0.056627).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5947461
	speed: 0.2623s/iter; left time: 5376.0671s
	iters: 200, epoch: 2 | loss: 3.9924245
	speed: 0.0399s/iter; left time: 814.1054s
Epoch: 2 cost time: 9.095072984695435
Epoch: 2, Steps: 208 | Train Loss: 3.716 Vali Loss: 4.000 Vali Acc: 0.064 Test Loss: 4.000 Test Acc: 0.064
Validation loss decreased (-0.056627 --> -0.064082).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6374187
	speed: 0.2578s/iter; left time: 5230.0414s
	iters: 200, epoch: 3 | loss: 4.1959953
	speed: 0.0389s/iter; left time: 784.7418s
Epoch: 3 cost time: 8.388456583023071
Epoch: 3, Steps: 208 | Train Loss: 3.448 Vali Loss: 4.032 Vali Acc: 0.077 Test Loss: 4.032 Test Acc: 0.077
Validation loss decreased (-0.064082 --> -0.076607).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1799836
	speed: 0.2589s/iter; left time: 5198.2370s
	iters: 200, epoch: 4 | loss: 4.5393853
	speed: 0.0417s/iter; left time: 832.1689s
Epoch: 4 cost time: 9.4861319065094
Epoch: 4, Steps: 208 | Train Loss: 3.237 Vali Loss: 4.069 Vali Acc: 0.083 Test Loss: 4.069 Test Acc: 0.083
Validation loss decreased (-0.076607 --> -0.082870).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8174891
	speed: 0.2536s/iter; left time: 5039.4943s
	iters: 200, epoch: 5 | loss: 2.9170203
	speed: 0.0406s/iter; left time: 803.4391s
Epoch: 5 cost time: 9.31144905090332
Epoch: 5, Steps: 208 | Train Loss: 3.034 Vali Loss: 4.259 Vali Acc: 0.088 Test Loss: 4.259 Test Acc: 0.088
Validation loss decreased (-0.082870 --> -0.087938).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4793689
	speed: 0.2497s/iter; left time: 4909.7891s
	iters: 200, epoch: 6 | loss: 3.0747867
	speed: 0.0353s/iter; left time: 690.4708s
Epoch: 6 cost time: 8.692787647247314
Epoch: 6, Steps: 208 | Train Loss: 2.890 Vali Loss: 4.405 Vali Acc: 0.089 Test Loss: 4.405 Test Acc: 0.089
Validation loss decreased (-0.087938 --> -0.089130).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4622002
	speed: 0.2556s/iter; left time: 4971.7798s
	iters: 200, epoch: 7 | loss: 3.0016749
	speed: 0.0355s/iter; left time: 687.1377s
Epoch: 7 cost time: 8.5851469039917
Epoch: 7, Steps: 208 | Train Loss: 2.721 Vali Loss: 4.325 Vali Acc: 0.106 Test Loss: 4.325 Test Acc: 0.106
Validation loss decreased (-0.089130 --> -0.106130).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0851431
	speed: 0.2591s/iter; left time: 4987.1622s
	iters: 200, epoch: 8 | loss: 3.4572148
	speed: 0.0392s/iter; left time: 750.6462s
Epoch: 8 cost time: 9.077923059463501
Epoch: 8, Steps: 208 | Train Loss: 2.531 Vali Loss: 4.561 Vali Acc: 0.098 Test Loss: 4.561 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0557957
	speed: 0.2586s/iter; left time: 4922.8950s
	iters: 200, epoch: 9 | loss: 2.6722436
	speed: 0.0391s/iter; left time: 740.9289s
Epoch: 9 cost time: 9.144391298294067
Epoch: 9, Steps: 208 | Train Loss: 2.363 Vali Loss: 4.621 Vali Acc: 0.105 Test Loss: 4.621 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.1040013
	speed: 0.2562s/iter; left time: 4824.7664s
	iters: 200, epoch: 10 | loss: 2.2576396
	speed: 0.0414s/iter; left time: 774.5650s
Epoch: 10 cost time: 9.287971258163452
Epoch: 10, Steps: 208 | Train Loss: 2.170 Vali Loss: 4.986 Vali Acc: 0.099 Test Loss: 4.986 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7439227
	speed: 0.2480s/iter; left time: 4618.6792s
	iters: 200, epoch: 11 | loss: 2.0500507
	speed: 0.0361s/iter; left time: 668.6241s
Epoch: 11 cost time: 8.202003717422485
Epoch: 11, Steps: 208 | Train Loss: 2.011 Vali Loss: 5.011 Vali Acc: 0.112 Test Loss: 5.011 Test Acc: 0.112
Validation loss decreased (-0.106130 --> -0.112088).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7925483
	speed: 0.2745s/iter; left time: 5054.4606s
	iters: 200, epoch: 12 | loss: 1.9666849
	speed: 0.0455s/iter; left time: 833.8198s
Epoch: 12 cost time: 10.46115779876709
Epoch: 12, Steps: 208 | Train Loss: 1.795 Vali Loss: 5.260 Vali Acc: 0.113 Test Loss: 5.260 Test Acc: 0.113
Validation loss decreased (-0.112088 --> -0.113279).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0536127
	speed: 0.2831s/iter; left time: 5153.1807s
	iters: 200, epoch: 13 | loss: 1.5576830
	speed: 0.0386s/iter; left time: 698.3408s
Epoch: 13 cost time: 9.245968341827393
Epoch: 13, Steps: 208 | Train Loss: 1.598 Vali Loss: 5.541 Vali Acc: 0.104 Test Loss: 5.541 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5049750
	speed: 0.2444s/iter; left time: 4399.2330s
	iters: 200, epoch: 14 | loss: 1.7971824
	speed: 0.0391s/iter; left time: 698.8870s
Epoch: 14 cost time: 9.216850280761719
Epoch: 14, Steps: 208 | Train Loss: 1.432 Vali Loss: 5.826 Vali Acc: 0.111 Test Loss: 5.826 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9580664
	speed: 0.2397s/iter; left time: 4263.7575s
	iters: 200, epoch: 15 | loss: 1.3189350
	speed: 0.0393s/iter; left time: 695.1276s
Epoch: 15 cost time: 8.69438886642456
Epoch: 15, Steps: 208 | Train Loss: 1.279 Vali Loss: 6.197 Vali Acc: 0.104 Test Loss: 6.197 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0744432
	speed: 0.2511s/iter; left time: 4414.0702s
	iters: 200, epoch: 16 | loss: 1.7108682
	speed: 0.0314s/iter; left time: 548.3435s
Epoch: 16 cost time: 7.96990966796875
Epoch: 16, Steps: 208 | Train Loss: 1.137 Vali Loss: 6.544 Vali Acc: 0.102 Test Loss: 6.544 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9607265
	speed: 0.2351s/iter; left time: 4084.8556s
	iters: 200, epoch: 17 | loss: 1.1316154
	speed: 0.0332s/iter; left time: 573.9253s
Epoch: 17 cost time: 7.882786989212036
Epoch: 17, Steps: 208 | Train Loss: 1.009 Vali Loss: 6.855 Vali Acc: 0.112 Test Loss: 6.855 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.2207168
	speed: 0.2430s/iter; left time: 4171.8180s
	iters: 200, epoch: 18 | loss: 0.7942878
	speed: 0.0339s/iter; left time: 579.2139s
Epoch: 18 cost time: 7.979601144790649
Epoch: 18, Steps: 208 | Train Loss: 0.917 Vali Loss: 7.185 Vali Acc: 0.099 Test Loss: 7.185 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.5091276
	speed: 0.2452s/iter; left time: 4157.2162s
	iters: 200, epoch: 19 | loss: 1.4758255
	speed: 0.0374s/iter; left time: 631.1441s
Epoch: 19 cost time: 8.996449947357178
Epoch: 19, Steps: 208 | Train Loss: 0.843 Vali Loss: 7.366 Vali Acc: 0.111 Test Loss: 7.366 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2720773
	speed: 0.2681s/iter; left time: 4489.9304s
	iters: 200, epoch: 20 | loss: 1.4697995
	speed: 0.0350s/iter; left time: 583.4537s
Epoch: 20 cost time: 8.461179733276367
Epoch: 20, Steps: 208 | Train Loss: 0.693 Vali Loss: 8.062 Vali Acc: 0.101 Test Loss: 8.062 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.2532582
	speed: 0.2591s/iter; left time: 4285.0052s
	iters: 200, epoch: 21 | loss: 1.0321825
	speed: 0.0435s/iter; left time: 714.8957s
Epoch: 21 cost time: 10.061509370803833
Epoch: 21, Steps: 208 | Train Loss: 0.678 Vali Loss: 8.234 Vali Acc: 0.098 Test Loss: 8.234 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5405983
	speed: 0.2566s/iter; left time: 4191.6678s
	iters: 200, epoch: 22 | loss: 0.6294315
	speed: 0.0353s/iter; left time: 573.6749s
Epoch: 22 cost time: 8.86817455291748
Epoch: 22, Steps: 208 | Train Loss: 0.616 Vali Loss: 8.656 Vali Acc: 0.102 Test Loss: 8.656 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11333134506412168
model parameter : 229351
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.6034474
	speed: 0.1235s/iter; left time: 2555.6646s
	iters: 200, epoch: 1 | loss: 3.5854409
	speed: 0.0999s/iter; left time: 2058.9582s
Epoch: 1 cost time: 23.43068790435791
Epoch: 1, Steps: 208 | Train Loss: 5.386 Vali Loss: 4.213 Vali Acc: 0.058 Test Loss: 4.213 Test Acc: 0.058
Validation loss decreased (inf --> -0.057518).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5009637
	speed: 0.3953s/iter; left time: 8101.1509s
	iters: 200, epoch: 2 | loss: 3.6087291
	speed: 0.0955s/iter; left time: 1948.4610s
Epoch: 2 cost time: 21.486136436462402
Epoch: 2, Steps: 208 | Train Loss: 3.769 Vali Loss: 3.873 Vali Acc: 0.075 Test Loss: 3.873 Test Acc: 0.075
Validation loss decreased (-0.057518 --> -0.074521).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2904015
	speed: 0.3724s/iter; left time: 7554.8701s
	iters: 200, epoch: 3 | loss: 3.2882876
	speed: 0.1024s/iter; left time: 2066.1567s
Epoch: 3 cost time: 19.932783842086792
Epoch: 3, Steps: 208 | Train Loss: 3.938 Vali Loss: 3.994 Vali Acc: 0.093 Test Loss: 3.994 Test Acc: 0.093
Validation loss decreased (-0.074521 --> -0.093309).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0753150
	speed: 0.3576s/iter; left time: 7180.4225s
	iters: 200, epoch: 4 | loss: 4.9354935
	speed: 0.0804s/iter; left time: 1605.2165s
Epoch: 4 cost time: 17.84105682373047
Epoch: 4, Steps: 208 | Train Loss: 4.122 Vali Loss: 4.725 Vali Acc: 0.100 Test Loss: 4.725 Test Acc: 0.100
Validation loss decreased (-0.093309 --> -0.099565).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.4130063
	speed: 0.3372s/iter; left time: 6699.9779s
	iters: 200, epoch: 5 | loss: 3.8221376
	speed: 0.0564s/iter; left time: 1114.2971s
Epoch: 5 cost time: 12.944565534591675
Epoch: 5, Steps: 208 | Train Loss: 4.132 Vali Loss: 4.903 Vali Acc: 0.099 Test Loss: 4.903 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1267340
	speed: 0.3243s/iter; left time: 6375.8097s
	iters: 200, epoch: 6 | loss: 3.6749110
	speed: 0.0583s/iter; left time: 1139.6452s
Epoch: 6 cost time: 12.283028602600098
Epoch: 6, Steps: 208 | Train Loss: 3.948 Vali Loss: 4.608 Vali Acc: 0.095 Test Loss: 4.608 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.0664954
	speed: 0.3336s/iter; left time: 6490.0850s
	iters: 200, epoch: 7 | loss: 2.6937952
	speed: 0.0497s/iter; left time: 962.6639s
Epoch: 7 cost time: 12.867531299591064
Epoch: 7, Steps: 208 | Train Loss: 3.438 Vali Loss: 5.412 Vali Acc: 0.096 Test Loss: 5.412 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6323056
	speed: 0.2889s/iter; left time: 5560.6352s
	iters: 200, epoch: 8 | loss: 3.6239605
	speed: 0.0441s/iter; left time: 844.4967s
Epoch: 8 cost time: 10.434792518615723
Epoch: 8, Steps: 208 | Train Loss: 2.815 Vali Loss: 10.881 Vali Acc: 0.058 Test Loss: 10.881 Test Acc: 0.058
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.1861165
	speed: 0.2692s/iter; left time: 5124.3885s
	iters: 200, epoch: 9 | loss: 2.1985879
	speed: 0.0462s/iter; left time: 875.7121s
Epoch: 9 cost time: 10.76681923866272
Epoch: 9, Steps: 208 | Train Loss: 1.989 Vali Loss: 6.547 Vali Acc: 0.078 Test Loss: 6.547 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5882785
	speed: 0.3786s/iter; left time: 7128.4598s
	iters: 200, epoch: 10 | loss: 1.5981218
	speed: 0.0934s/iter; left time: 1749.5519s
Epoch: 10 cost time: 22.46146869659424
Epoch: 10, Steps: 208 | Train Loss: 1.597 Vali Loss: 6.356 Vali Acc: 0.083 Test Loss: 6.356 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.6366948
	speed: 0.4000s/iter; left time: 7448.5447s
	iters: 200, epoch: 11 | loss: 1.5755051
	speed: 0.1068s/iter; left time: 1978.9602s
Epoch: 11 cost time: 23.33384656906128
Epoch: 11, Steps: 208 | Train Loss: 1.375 Vali Loss: 6.058 Vali Acc: 0.109 Test Loss: 6.058 Test Acc: 0.109
Validation loss decreased (-0.099565 --> -0.109394).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7122855
	speed: 0.3870s/iter; left time: 7126.0005s
	iters: 200, epoch: 12 | loss: 0.8928807
	speed: 0.0954s/iter; left time: 1747.8654s
Epoch: 12 cost time: 21.052480220794678
Epoch: 12, Steps: 208 | Train Loss: 1.132 Vali Loss: 6.559 Vali Acc: 0.106 Test Loss: 6.559 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4179626
	speed: 0.3555s/iter; left time: 6472.3140s
	iters: 200, epoch: 13 | loss: 1.9554520
	speed: 0.0979s/iter; left time: 1772.1914s
Epoch: 13 cost time: 19.08744525909424
Epoch: 13, Steps: 208 | Train Loss: 0.972 Vali Loss: 6.796 Vali Acc: 0.109 Test Loss: 6.796 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6773580
	speed: 0.3718s/iter; left time: 6691.2592s
	iters: 200, epoch: 14 | loss: 1.0028812
	speed: 0.0864s/iter; left time: 1545.5027s
Epoch: 14 cost time: 19.482699394226074
Epoch: 14, Steps: 208 | Train Loss: 0.784 Vali Loss: 7.328 Vali Acc: 0.115 Test Loss: 7.328 Test Acc: 0.115
Validation loss decreased (-0.109394 --> -0.115346).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1034134
	speed: 0.3548s/iter; left time: 6311.8662s
	iters: 200, epoch: 15 | loss: 1.4446996
	speed: 0.0997s/iter; left time: 1764.4281s
Epoch: 15 cost time: 19.183664321899414
Epoch: 15, Steps: 208 | Train Loss: 0.666 Vali Loss: 8.365 Vali Acc: 0.109 Test Loss: 8.365 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3969554
	speed: 0.3709s/iter; left time: 6521.4626s
	iters: 200, epoch: 16 | loss: 0.6115901
	speed: 0.1003s/iter; left time: 1752.8817s
Epoch: 16 cost time: 20.90996217727661
Epoch: 16, Steps: 208 | Train Loss: 0.509 Vali Loss: 8.904 Vali Acc: 0.111 Test Loss: 8.904 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4585997
	speed: 0.3549s/iter; left time: 6164.9318s
	iters: 200, epoch: 17 | loss: 0.7207913
	speed: 0.0898s/iter; left time: 1550.3124s
Epoch: 17 cost time: 17.791898012161255
Epoch: 17, Steps: 208 | Train Loss: 0.454 Vali Loss: 9.081 Vali Acc: 0.105 Test Loss: 9.081 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0138645
	speed: 0.3008s/iter; left time: 5163.9699s
	iters: 200, epoch: 18 | loss: 0.3863113
	speed: 0.0780s/iter; left time: 1330.6597s
Epoch: 18 cost time: 14.91787052154541
Epoch: 18, Steps: 208 | Train Loss: 0.367 Vali Loss: 9.267 Vali Acc: 0.109 Test Loss: 9.267 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0928674
	speed: 0.3102s/iter; left time: 5259.7397s
	iters: 200, epoch: 19 | loss: 0.3104399
	speed: 0.0556s/iter; left time: 936.8919s
Epoch: 19 cost time: 12.241891384124756
Epoch: 19, Steps: 208 | Train Loss: 0.328 Vali Loss: 9.988 Vali Acc: 0.112 Test Loss: 9.988 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5730102
	speed: 0.3458s/iter; left time: 5792.1019s
	iters: 200, epoch: 20 | loss: 0.4666994
	speed: 0.0842s/iter; left time: 1401.2938s
Epoch: 20 cost time: 17.194960355758667
Epoch: 20, Steps: 208 | Train Loss: 0.280 Vali Loss: 9.926 Vali Acc: 0.110 Test Loss: 9.926 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1755921
	speed: 0.3632s/iter; left time: 6008.1799s
	iters: 200, epoch: 21 | loss: 0.1736283
	speed: 0.0820s/iter; left time: 1347.9086s
Epoch: 21 cost time: 17.64552330970764
Epoch: 21, Steps: 208 | Train Loss: 0.220 Vali Loss: 11.443 Vali Acc: 0.108 Test Loss: 11.443 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1188572
	speed: 0.3799s/iter; left time: 6204.6837s
	iters: 200, epoch: 22 | loss: 0.0480003
	speed: 0.0940s/iter; left time: 1525.8472s
Epoch: 22 cost time: 20.256543397903442
Epoch: 22, Steps: 208 | Train Loss: 0.204 Vali Loss: 12.063 Vali Acc: 0.115 Test Loss: 12.063 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2205666
	speed: 0.3705s/iter; left time: 5973.8609s
	iters: 200, epoch: 23 | loss: 0.0619543
	speed: 0.0771s/iter; left time: 1235.7612s
Epoch: 23 cost time: 19.83068609237671
Epoch: 23, Steps: 208 | Train Loss: 0.220 Vali Loss: 10.940 Vali Acc: 0.103 Test Loss: 10.940 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2477141
	speed: 0.3715s/iter; left time: 5912.7467s
	iters: 200, epoch: 24 | loss: 0.3068461
	speed: 0.0890s/iter; left time: 1407.1570s
Epoch: 24 cost time: 20.22239923477173
Epoch: 24, Steps: 208 | Train Loss: 0.191 Vali Loss: 11.811 Vali Acc: 0.103 Test Loss: 11.811 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1154190277363555
model parameter : 2002599
model size : 8.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0255189
	speed: 0.0796s/iter; left time: 1647.8180s
	iters: 200, epoch: 1 | loss: 5.3243713
	speed: 0.0441s/iter; left time: 909.3198s
Epoch: 1 cost time: 13.07870626449585
Epoch: 1, Steps: 208 | Train Loss: 4.569 Vali Loss: 4.682 Vali Acc: 0.063 Test Loss: 4.682 Test Acc: 0.063
Validation loss decreased (inf --> -0.063180).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1634741
	speed: 0.3221s/iter; left time: 6601.6607s
	iters: 200, epoch: 2 | loss: 3.6543541
	speed: 0.0544s/iter; left time: 1110.2237s
Epoch: 2 cost time: 14.310329914093018
Epoch: 2, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.967 Vali Acc: 0.083 Test Loss: 3.967 Test Acc: 0.083
Validation loss decreased (-0.063180 --> -0.082871).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6369014
	speed: 0.3052s/iter; left time: 6191.4141s
	iters: 200, epoch: 3 | loss: 3.9488609
	speed: 0.0653s/iter; left time: 1317.8877s
Epoch: 3 cost time: 14.372783899307251
Epoch: 3, Steps: 208 | Train Loss: 3.469 Vali Loss: 4.348 Vali Acc: 0.078 Test Loss: 4.348 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4473848
	speed: 0.2835s/iter; left time: 5691.7963s
	iters: 200, epoch: 4 | loss: 3.0912318
	speed: 0.0549s/iter; left time: 1097.6790s
Epoch: 4 cost time: 10.811996221542358
Epoch: 4, Steps: 208 | Train Loss: 3.531 Vali Loss: 4.435 Vali Acc: 0.092 Test Loss: 4.435 Test Acc: 0.092
Validation loss decreased (-0.082871 --> -0.092410).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0760202
	speed: 0.2992s/iter; left time: 5944.0541s
	iters: 200, epoch: 5 | loss: 3.1693192
	speed: 0.0551s/iter; left time: 1089.1843s
Epoch: 5 cost time: 11.318060636520386
Epoch: 5, Steps: 208 | Train Loss: 3.507 Vali Loss: 4.493 Vali Acc: 0.101 Test Loss: 4.493 Test Acc: 0.101
Validation loss decreased (-0.092410 --> -0.100462).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7741017
	speed: 0.2940s/iter; left time: 5779.5884s
	iters: 200, epoch: 6 | loss: 3.3663211
	speed: 0.0517s/iter; left time: 1011.6129s
Epoch: 6 cost time: 11.311136722564697
Epoch: 6, Steps: 208 | Train Loss: 3.404 Vali Loss: 4.568 Vali Acc: 0.109 Test Loss: 4.568 Test Acc: 0.109
Validation loss decreased (-0.100462 --> -0.108812).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7986217
	speed: 0.3137s/iter; left time: 6102.7009s
	iters: 200, epoch: 7 | loss: 3.0959024
	speed: 0.0509s/iter; left time: 984.2195s
Epoch: 7 cost time: 12.8866548538208
Epoch: 7, Steps: 208 | Train Loss: 3.165 Vali Loss: 4.302 Vali Acc: 0.111 Test Loss: 4.302 Test Acc: 0.111
Validation loss decreased (-0.108812 --> -0.110604).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.9593925
	speed: 0.3086s/iter; left time: 5938.3554s
	iters: 200, epoch: 8 | loss: 3.6614223
	speed: 0.0567s/iter; left time: 1085.4148s
Epoch: 8 cost time: 13.927444458007812
Epoch: 8, Steps: 208 | Train Loss: 2.812 Vali Loss: 5.113 Vali Acc: 0.109 Test Loss: 5.113 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.9078157
	speed: 0.3078s/iter; left time: 5859.4846s
	iters: 200, epoch: 9 | loss: 2.5568566
	speed: 0.0904s/iter; left time: 1711.0129s
Epoch: 9 cost time: 17.86468482017517
Epoch: 9, Steps: 208 | Train Loss: 2.313 Vali Loss: 6.465 Vali Acc: 0.079 Test Loss: 6.465 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0030303
	speed: 0.3353s/iter; left time: 6314.0811s
	iters: 200, epoch: 10 | loss: 2.3402693
	speed: 0.0693s/iter; left time: 1297.1648s
Epoch: 10 cost time: 16.646220922470093
Epoch: 10, Steps: 208 | Train Loss: 1.963 Vali Loss: 5.165 Vali Acc: 0.106 Test Loss: 5.165 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.0159547
	speed: 0.2898s/iter; left time: 5396.8368s
	iters: 200, epoch: 11 | loss: 1.3888717
	speed: 0.0479s/iter; left time: 886.9967s
Epoch: 11 cost time: 11.037297487258911
Epoch: 11, Steps: 208 | Train Loss: 1.666 Vali Loss: 5.151 Vali Acc: 0.109 Test Loss: 5.151 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7519031
	speed: 0.2793s/iter; left time: 5143.2710s
	iters: 200, epoch: 12 | loss: 1.4902643
	speed: 0.0358s/iter; left time: 656.0350s
Epoch: 12 cost time: 10.137369394302368
Epoch: 12, Steps: 208 | Train Loss: 1.454 Vali Loss: 5.517 Vali Acc: 0.108 Test Loss: 5.517 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.7941299
	speed: 0.2825s/iter; left time: 5143.0664s
	iters: 200, epoch: 13 | loss: 1.0855888
	speed: 0.0406s/iter; left time: 735.0174s
Epoch: 13 cost time: 10.49888825416565
Epoch: 13, Steps: 208 | Train Loss: 1.186 Vali Loss: 5.821 Vali Acc: 0.118 Test Loss: 5.821 Test Acc: 0.118
Validation loss decreased (-0.110604 --> -0.118343).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8100519
	speed: 0.2952s/iter; left time: 5311.8287s
	iters: 200, epoch: 14 | loss: 0.5969091
	speed: 0.0365s/iter; left time: 652.6057s
Epoch: 14 cost time: 9.943552732467651
Epoch: 14, Steps: 208 | Train Loss: 0.990 Vali Loss: 6.435 Vali Acc: 0.108 Test Loss: 6.435 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1440735
	speed: 0.2712s/iter; left time: 4825.1958s
	iters: 200, epoch: 15 | loss: 1.8499752
	speed: 0.0399s/iter; left time: 705.3152s
Epoch: 15 cost time: 9.54731297492981
Epoch: 15, Steps: 208 | Train Loss: 0.770 Vali Loss: 7.222 Vali Acc: 0.108 Test Loss: 7.222 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3700804
	speed: 0.2855s/iter; left time: 5019.3451s
	iters: 200, epoch: 16 | loss: 1.1056471
	speed: 0.0516s/iter; left time: 901.1956s
Epoch: 16 cost time: 11.03557300567627
Epoch: 16, Steps: 208 | Train Loss: 0.658 Vali Loss: 7.368 Vali Acc: 0.104 Test Loss: 7.368 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6297358
	speed: 0.2756s/iter; left time: 4787.4467s
	iters: 200, epoch: 17 | loss: 0.6056799
	speed: 0.0381s/iter; left time: 657.3218s
Epoch: 17 cost time: 10.397393703460693
Epoch: 17, Steps: 208 | Train Loss: 0.553 Vali Loss: 8.174 Vali Acc: 0.109 Test Loss: 8.174 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4761277
	speed: 0.2526s/iter; left time: 4336.4280s
	iters: 200, epoch: 18 | loss: 1.2799753
	speed: 0.0469s/iter; left time: 799.6345s
Epoch: 18 cost time: 11.027440547943115
Epoch: 18, Steps: 208 | Train Loss: 0.490 Vali Loss: 8.186 Vali Acc: 0.110 Test Loss: 8.186 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3477667
	speed: 0.2445s/iter; left time: 4146.5449s
	iters: 200, epoch: 19 | loss: 0.2382127
	speed: 0.0384s/iter; left time: 647.6201s
Epoch: 19 cost time: 9.12781548500061
Epoch: 19, Steps: 208 | Train Loss: 0.411 Vali Loss: 9.077 Vali Acc: 0.112 Test Loss: 9.077 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2391199
	speed: 0.2709s/iter; left time: 4537.9480s
	iters: 200, epoch: 20 | loss: 0.5688540
	speed: 0.0392s/iter; left time: 653.4247s
Epoch: 20 cost time: 9.954327821731567
Epoch: 20, Steps: 208 | Train Loss: 0.392 Vali Loss: 9.598 Vali Acc: 0.116 Test Loss: 9.598 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.3313152
	speed: 0.2944s/iter; left time: 4869.1616s
	iters: 200, epoch: 21 | loss: 0.6743658
	speed: 0.0532s/iter; left time: 874.4796s
Epoch: 21 cost time: 12.925993919372559
Epoch: 21, Steps: 208 | Train Loss: 0.352 Vali Loss: 9.607 Vali Acc: 0.107 Test Loss: 9.607 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1728163
	speed: 0.2802s/iter; left time: 4576.1759s
	iters: 200, epoch: 22 | loss: 0.0850620
	speed: 0.0660s/iter; left time: 1070.9949s
Epoch: 22 cost time: 14.083728313446045
Epoch: 22, Steps: 208 | Train Loss: 0.297 Vali Loss: 10.000 Vali Acc: 0.114 Test Loss: 10.000 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3372892
	speed: 0.3020s/iter; left time: 4870.4072s
	iters: 200, epoch: 23 | loss: 0.4546560
	speed: 0.0747s/iter; left time: 1197.0528s
Epoch: 23 cost time: 15.190737962722778
Epoch: 23, Steps: 208 | Train Loss: 0.278 Vali Loss: 10.171 Vali Acc: 0.108 Test Loss: 10.171 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11840143155383238
model parameter : 1014503
model size : 5.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5237689
	speed: 0.0758s/iter; left time: 1568.1569s
	iters: 200, epoch: 1 | loss: 4.5459900
	speed: 0.0336s/iter; left time: 693.1181s
Epoch: 1 cost time: 11.641581535339355
Epoch: 1, Steps: 208 | Train Loss: 4.281 Vali Loss: 4.456 Vali Acc: 0.056 Test Loss: 4.456 Test Acc: 0.056
Validation loss decreased (inf --> -0.056025).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5797029
	speed: 0.3098s/iter; left time: 6349.2665s
	iters: 200, epoch: 2 | loss: 3.1809402
	speed: 0.0442s/iter; left time: 901.9702s
Epoch: 2 cost time: 10.28590703010559
Epoch: 2, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.796 Vali Acc: 0.079 Test Loss: 3.796 Test Acc: 0.079
Validation loss decreased (-0.056025 --> -0.079294).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6459370
	speed: 0.3013s/iter; left time: 6112.0381s
	iters: 200, epoch: 3 | loss: 3.1693473
	speed: 0.0454s/iter; left time: 915.8566s
Epoch: 3 cost time: 10.3388090133667
Epoch: 3, Steps: 208 | Train Loss: 3.356 Vali Loss: 4.007 Vali Acc: 0.078 Test Loss: 4.007 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5761988
	speed: 0.2992s/iter; left time: 6007.4595s
	iters: 200, epoch: 4 | loss: 3.7743161
	speed: 0.0404s/iter; left time: 806.8658s
Epoch: 4 cost time: 9.316593170166016
Epoch: 4, Steps: 208 | Train Loss: 3.302 Vali Loss: 4.245 Vali Acc: 0.088 Test Loss: 4.245 Test Acc: 0.088
Validation loss decreased (-0.079294 --> -0.087640).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4154665
	speed: 0.2847s/iter; left time: 5656.2732s
	iters: 200, epoch: 5 | loss: 4.3439736
	speed: 0.0432s/iter; left time: 853.7750s
Epoch: 5 cost time: 10.111169576644897
Epoch: 5, Steps: 208 | Train Loss: 3.325 Vali Loss: 4.533 Vali Acc: 0.089 Test Loss: 4.533 Test Acc: 0.089
Validation loss decreased (-0.087640 --> -0.089427).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7363126
	speed: 0.2847s/iter; left time: 5597.5403s
	iters: 200, epoch: 6 | loss: 2.7922249
	speed: 0.0570s/iter; left time: 1114.8306s
Epoch: 6 cost time: 11.30579423904419
Epoch: 6, Steps: 208 | Train Loss: 3.213 Vali Loss: 4.452 Vali Acc: 0.099 Test Loss: 4.452 Test Acc: 0.099
Validation loss decreased (-0.089427 --> -0.099270).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1603861
	speed: 0.3249s/iter; left time: 6319.5779s
	iters: 200, epoch: 7 | loss: 2.7646029
	speed: 0.0668s/iter; left time: 1292.8745s
Epoch: 7 cost time: 15.646063327789307
Epoch: 7, Steps: 208 | Train Loss: 3.057 Vali Loss: 4.524 Vali Acc: 0.101 Test Loss: 4.524 Test Acc: 0.101
Validation loss decreased (-0.099270 --> -0.101058).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0820014
	speed: 0.3239s/iter; left time: 6233.0896s
	iters: 200, epoch: 8 | loss: 2.9081733
	speed: 0.0616s/iter; left time: 1178.6198s
Epoch: 8 cost time: 14.822554349899292
Epoch: 8, Steps: 208 | Train Loss: 2.791 Vali Loss: 4.594 Vali Acc: 0.109 Test Loss: 4.594 Test Acc: 0.109
Validation loss decreased (-0.101058 --> -0.108812).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1608527
	speed: 0.3240s/iter; left time: 6167.8422s
	iters: 200, epoch: 9 | loss: 3.2778027
	speed: 0.0607s/iter; left time: 1149.1201s
Epoch: 9 cost time: 13.316804885864258
Epoch: 9, Steps: 208 | Train Loss: 2.419 Vali Loss: 4.625 Vali Acc: 0.105 Test Loss: 4.625 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4741048
	speed: 0.2890s/iter; left time: 5441.8657s
	iters: 200, epoch: 10 | loss: 2.0210433
	speed: 0.0515s/iter; left time: 965.3268s
Epoch: 10 cost time: 11.162464618682861
Epoch: 10, Steps: 208 | Train Loss: 2.063 Vali Loss: 5.013 Vali Acc: 0.108 Test Loss: 5.013 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5430089
	speed: 0.3117s/iter; left time: 5804.3092s
	iters: 200, epoch: 11 | loss: 1.5531799
	speed: 0.0574s/iter; left time: 1063.2869s
Epoch: 11 cost time: 12.734779596328735
Epoch: 11, Steps: 208 | Train Loss: 1.774 Vali Loss: 5.348 Vali Acc: 0.103 Test Loss: 5.348 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7193539
	speed: 0.2904s/iter; left time: 5347.0431s
	iters: 200, epoch: 12 | loss: 2.2208407
	speed: 0.0454s/iter; left time: 830.5371s
Epoch: 12 cost time: 9.947667837142944
Epoch: 12, Steps: 208 | Train Loss: 1.516 Vali Loss: 5.121 Vali Acc: 0.118 Test Loss: 5.121 Test Acc: 0.118
Validation loss decreased (-0.108812 --> -0.117456).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7059434
	speed: 0.3047s/iter; left time: 5546.1853s
	iters: 200, epoch: 13 | loss: 1.3385899
	speed: 0.0460s/iter; left time: 831.9974s
Epoch: 13 cost time: 11.964208841323853
Epoch: 13, Steps: 208 | Train Loss: 1.312 Vali Loss: 6.045 Vali Acc: 0.122 Test Loss: 6.045 Test Acc: 0.122
Validation loss decreased (-0.117456 --> -0.121920).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7163340
	speed: 0.2676s/iter; left time: 4816.1551s
	iters: 200, epoch: 14 | loss: 1.3612238
	speed: 0.0364s/iter; left time: 650.6772s
Epoch: 14 cost time: 8.647248268127441
Epoch: 14, Steps: 208 | Train Loss: 1.115 Vali Loss: 6.134 Vali Acc: 0.118 Test Loss: 6.134 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6263541
	speed: 0.3012s/iter; left time: 5357.2053s
	iters: 200, epoch: 15 | loss: 1.1094822
	speed: 0.0529s/iter; left time: 935.9149s
Epoch: 15 cost time: 12.614554166793823
Epoch: 15, Steps: 208 | Train Loss: 0.915 Vali Loss: 6.387 Vali Acc: 0.115 Test Loss: 6.387 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0914873
	speed: 0.2910s/iter; left time: 5116.4326s
	iters: 200, epoch: 16 | loss: 1.1356437
	speed: 0.0463s/iter; left time: 808.9235s
Epoch: 16 cost time: 10.20072865486145
Epoch: 16, Steps: 208 | Train Loss: 0.768 Vali Loss: 7.021 Vali Acc: 0.114 Test Loss: 7.021 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7424458
	speed: 0.2857s/iter; left time: 4963.0180s
	iters: 200, epoch: 17 | loss: 0.9220484
	speed: 0.0434s/iter; left time: 748.8312s
Epoch: 17 cost time: 10.025359153747559
Epoch: 17, Steps: 208 | Train Loss: 0.643 Vali Loss: 7.802 Vali Acc: 0.119 Test Loss: 7.802 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5134251
	speed: 0.2946s/iter; left time: 5057.1883s
	iters: 200, epoch: 18 | loss: 0.9050438
	speed: 0.0604s/iter; left time: 1031.5110s
Epoch: 18 cost time: 12.93388032913208
Epoch: 18, Steps: 208 | Train Loss: 0.584 Vali Loss: 8.035 Vali Acc: 0.117 Test Loss: 8.035 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3316622
	speed: 0.3209s/iter; left time: 5440.9673s
	iters: 200, epoch: 19 | loss: 0.9071406
	speed: 0.0532s/iter; left time: 896.0839s
Epoch: 19 cost time: 13.380387306213379
Epoch: 19, Steps: 208 | Train Loss: 0.542 Vali Loss: 8.404 Vali Acc: 0.114 Test Loss: 8.404 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3973274
	speed: 0.3237s/iter; left time: 5421.6177s
	iters: 200, epoch: 20 | loss: 0.4406724
	speed: 0.0571s/iter; left time: 949.8633s
Epoch: 20 cost time: 13.328894853591919
Epoch: 20, Steps: 208 | Train Loss: 0.458 Vali Loss: 8.897 Vali Acc: 0.110 Test Loss: 8.897 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.4832960
	speed: 0.3038s/iter; left time: 5025.6883s
	iters: 200, epoch: 21 | loss: 0.5163445
	speed: 0.0524s/iter; left time: 862.3177s
Epoch: 21 cost time: 12.86897611618042
Epoch: 21, Steps: 208 | Train Loss: 0.431 Vali Loss: 9.565 Vali Acc: 0.111 Test Loss: 9.565 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.9057571
	speed: 0.3099s/iter; left time: 5061.6115s
	iters: 200, epoch: 22 | loss: 0.5013547
	speed: 0.0708s/iter; left time: 1149.5509s
Epoch: 22 cost time: 15.165500402450562
Epoch: 22, Steps: 208 | Train Loss: 0.415 Vali Loss: 9.317 Vali Acc: 0.110 Test Loss: 9.317 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4947418
	speed: 0.2914s/iter; left time: 4698.9965s
	iters: 200, epoch: 23 | loss: 0.2300315
	speed: 0.0325s/iter; left time: 520.6828s
Epoch: 23 cost time: 9.399326086044312
Epoch: 23, Steps: 208 | Train Loss: 0.360 Vali Loss: 9.780 Vali Acc: 0.111 Test Loss: 9.780 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12198031613480466
model parameter : 685415
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0295210
	speed: 0.0894s/iter; left time: 1851.2096s
	iters: 200, epoch: 1 | loss: 4.0978899
	speed: 0.0453s/iter; left time: 934.0177s
Epoch: 1 cost time: 13.789213180541992
Epoch: 1, Steps: 208 | Train Loss: 4.149 Vali Loss: 4.262 Vali Acc: 0.060 Test Loss: 4.262 Test Acc: 0.060
Validation loss decreased (inf --> -0.060202).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6877456
	speed: 0.2432s/iter; left time: 4983.8066s
	iters: 200, epoch: 2 | loss: 3.6912336
	speed: 0.0425s/iter; left time: 867.2272s
Epoch: 2 cost time: 9.164007663726807
Epoch: 2, Steps: 208 | Train Loss: 3.887 Vali Loss: 3.875 Vali Acc: 0.077 Test Loss: 3.875 Test Acc: 0.077
Validation loss decreased (-0.060202 --> -0.076907).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8828092
	speed: 0.2460s/iter; left time: 4990.0967s
	iters: 200, epoch: 3 | loss: 3.5734818
	speed: 0.0289s/iter; left time: 582.7949s
Epoch: 3 cost time: 7.636305809020996
Epoch: 3, Steps: 208 | Train Loss: 3.252 Vali Loss: 3.920 Vali Acc: 0.080 Test Loss: 3.920 Test Acc: 0.080
Validation loss decreased (-0.076907 --> -0.079889).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9588046
	speed: 0.2506s/iter; left time: 5031.1980s
	iters: 200, epoch: 4 | loss: 4.2280517
	speed: 0.0339s/iter; left time: 677.9647s
Epoch: 4 cost time: 8.625738859176636
Epoch: 4, Steps: 208 | Train Loss: 3.112 Vali Loss: 4.156 Vali Acc: 0.091 Test Loss: 4.156 Test Acc: 0.091
Validation loss decreased (-0.079889 --> -0.090624).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9583421
	speed: 0.2515s/iter; left time: 4997.2287s
	iters: 200, epoch: 5 | loss: 3.1641648
	speed: 0.0378s/iter; left time: 748.2101s
Epoch: 5 cost time: 9.710585117340088
Epoch: 5, Steps: 208 | Train Loss: 3.138 Vali Loss: 4.459 Vali Acc: 0.089 Test Loss: 4.459 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9979837
	speed: 0.2687s/iter; left time: 5282.1596s
	iters: 200, epoch: 6 | loss: 2.5860400
	speed: 0.0519s/iter; left time: 1014.3727s
Epoch: 6 cost time: 12.124688625335693
Epoch: 6, Steps: 208 | Train Loss: 3.024 Vali Loss: 4.752 Vali Acc: 0.106 Test Loss: 4.752 Test Acc: 0.106
Validation loss decreased (-0.090624 --> -0.106424).  Saving model ...
	iters: 100, epoch: 7 | loss: 4.4971347
	speed: 0.2866s/iter; left time: 5576.0741s
	iters: 200, epoch: 7 | loss: 3.6955495
	speed: 0.0499s/iter; left time: 965.5779s
Epoch: 7 cost time: 11.644861221313477
Epoch: 7, Steps: 208 | Train Loss: 2.871 Vali Loss: 4.713 Vali Acc: 0.102 Test Loss: 4.713 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.4106896
	speed: 0.3138s/iter; left time: 6038.7831s
	iters: 200, epoch: 8 | loss: 3.2746251
	speed: 0.0572s/iter; left time: 1095.1772s
Epoch: 8 cost time: 13.453748226165771
Epoch: 8, Steps: 208 | Train Loss: 2.625 Vali Loss: 4.994 Vali Acc: 0.107 Test Loss: 4.994 Test Acc: 0.107
Validation loss decreased (-0.106424 --> -0.107317).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1591003
	speed: 0.3044s/iter; left time: 5795.7158s
	iters: 200, epoch: 9 | loss: 2.3341784
	speed: 0.0694s/iter; left time: 1313.4993s
Epoch: 9 cost time: 14.943338632583618
Epoch: 9, Steps: 208 | Train Loss: 2.324 Vali Loss: 5.034 Vali Acc: 0.112 Test Loss: 5.034 Test Acc: 0.112
Validation loss decreased (-0.107317 --> -0.111790).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5073814
	speed: 0.2922s/iter; left time: 5501.5336s
	iters: 200, epoch: 10 | loss: 2.7963691
	speed: 0.0616s/iter; left time: 1152.9105s
Epoch: 10 cost time: 12.875131607055664
Epoch: 10, Steps: 208 | Train Loss: 2.061 Vali Loss: 4.969 Vali Acc: 0.107 Test Loss: 4.969 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1431916
	speed: 0.2780s/iter; left time: 5177.5638s
	iters: 200, epoch: 11 | loss: 1.6556813
	speed: 0.0343s/iter; left time: 634.7987s
Epoch: 11 cost time: 9.722155570983887
Epoch: 11, Steps: 208 | Train Loss: 1.802 Vali Loss: 5.214 Vali Acc: 0.109 Test Loss: 5.214 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3974004
	speed: 0.2486s/iter; left time: 4578.0533s
	iters: 200, epoch: 12 | loss: 1.7875972
	speed: 0.0365s/iter; left time: 667.9905s
Epoch: 12 cost time: 8.536189794540405
Epoch: 12, Steps: 208 | Train Loss: 1.549 Vali Loss: 5.478 Vali Acc: 0.121 Test Loss: 5.478 Test Acc: 0.121
Validation loss decreased (-0.111790 --> -0.120733).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2822698
	speed: 0.2467s/iter; left time: 4491.5476s
	iters: 200, epoch: 13 | loss: 1.7235060
	speed: 0.0387s/iter; left time: 700.2970s
Epoch: 13 cost time: 9.870431184768677
Epoch: 13, Steps: 208 | Train Loss: 1.311 Vali Loss: 5.858 Vali Acc: 0.133 Test Loss: 5.858 Test Acc: 0.133
Validation loss decreased (-0.120733 --> -0.132658).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5668356
	speed: 0.2569s/iter; left time: 4624.3109s
	iters: 200, epoch: 14 | loss: 0.7394320
	speed: 0.0434s/iter; left time: 777.0803s
Epoch: 14 cost time: 9.355713129043579
Epoch: 14, Steps: 208 | Train Loss: 1.112 Vali Loss: 5.936 Vali Acc: 0.120 Test Loss: 5.936 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1303791
	speed: 0.2784s/iter; left time: 4952.3482s
	iters: 200, epoch: 15 | loss: 0.8445675
	speed: 0.0390s/iter; left time: 689.5796s
Epoch: 15 cost time: 9.942543029785156
Epoch: 15, Steps: 208 | Train Loss: 0.940 Vali Loss: 6.451 Vali Acc: 0.129 Test Loss: 6.451 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3908602
	speed: 0.2872s/iter; left time: 5049.6278s
	iters: 200, epoch: 16 | loss: 0.6121366
	speed: 0.0406s/iter; left time: 709.1821s
Epoch: 16 cost time: 10.732475519180298
Epoch: 16, Steps: 208 | Train Loss: 0.836 Vali Loss: 7.024 Vali Acc: 0.125 Test Loss: 7.024 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7413213
	speed: 0.2690s/iter; left time: 4672.8960s
	iters: 200, epoch: 17 | loss: 1.2841883
	speed: 0.0344s/iter; left time: 594.4122s
Epoch: 17 cost time: 9.319515466690063
Epoch: 17, Steps: 208 | Train Loss: 0.708 Vali Loss: 7.131 Vali Acc: 0.123 Test Loss: 7.131 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4202534
	speed: 0.2406s/iter; left time: 4129.4387s
	iters: 200, epoch: 18 | loss: 0.3981847
	speed: 0.0570s/iter; left time: 971.9411s
Epoch: 18 cost time: 11.714451789855957
Epoch: 18, Steps: 208 | Train Loss: 0.610 Vali Loss: 7.534 Vali Acc: 0.131 Test Loss: 7.534 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.2698492
	speed: 0.2913s/iter; left time: 4940.1762s
	iters: 200, epoch: 19 | loss: 0.5784188
	speed: 0.0444s/iter; left time: 749.1599s
Epoch: 19 cost time: 10.955992460250854
Epoch: 19, Steps: 208 | Train Loss: 0.556 Vali Loss: 8.433 Vali Acc: 0.122 Test Loss: 8.433 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3742741
	speed: 0.2791s/iter; left time: 4675.1099s
	iters: 200, epoch: 20 | loss: 0.8515006
	speed: 0.0480s/iter; left time: 798.6099s
Epoch: 20 cost time: 11.27405047416687
Epoch: 20, Steps: 208 | Train Loss: 0.517 Vali Loss: 8.627 Vali Acc: 0.115 Test Loss: 8.627 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2870094
	speed: 0.2860s/iter; left time: 4730.6797s
	iters: 200, epoch: 21 | loss: 0.5164761
	speed: 0.0687s/iter; left time: 1129.8695s
Epoch: 21 cost time: 14.994632482528687
Epoch: 21, Steps: 208 | Train Loss: 0.445 Vali Loss: 9.071 Vali Acc: 0.117 Test Loss: 9.071 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3812107
	speed: 0.2790s/iter; left time: 4557.4210s
	iters: 200, epoch: 22 | loss: 0.2882170
	speed: 0.0693s/iter; left time: 1125.3995s
Epoch: 22 cost time: 14.947093725204468
Epoch: 22, Steps: 208 | Train Loss: 0.394 Vali Loss: 9.159 Vali Acc: 0.122 Test Loss: 9.159 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1274859
	speed: 0.2814s/iter; left time: 4537.8313s
	iters: 200, epoch: 23 | loss: 0.5915133
	speed: 0.0495s/iter; left time: 793.2959s
Epoch: 23 cost time: 11.019128799438477
Epoch: 23, Steps: 208 | Train Loss: 0.378 Vali Loss: 9.774 Vali Acc: 0.123 Test Loss: 9.774 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13271696987772144
model parameter : 548455
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8475156
	speed: 0.0724s/iter; left time: 1499.0188s
	iters: 200, epoch: 1 | loss: 4.0582819
	speed: 0.0427s/iter; left time: 879.6655s
Epoch: 1 cost time: 11.889344930648804
Epoch: 1, Steps: 208 | Train Loss: 3.924 Vali Loss: 4.218 Vali Acc: 0.056 Test Loss: 4.218 Test Acc: 0.056
Validation loss decreased (inf --> -0.056325).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8691127
	speed: 0.2415s/iter; left time: 4949.0888s
	iters: 200, epoch: 2 | loss: 3.9190254
	speed: 0.0457s/iter; left time: 932.5166s
Epoch: 2 cost time: 9.226688385009766
Epoch: 2, Steps: 208 | Train Loss: 3.730 Vali Loss: 4.113 Vali Acc: 0.065 Test Loss: 4.113 Test Acc: 0.065
Validation loss decreased (-0.056325 --> -0.065274).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5518751
	speed: 0.2172s/iter; left time: 4405.5548s
	iters: 200, epoch: 3 | loss: 3.4999590
	speed: 0.0414s/iter; left time: 835.7717s
Epoch: 3 cost time: 8.502298831939697
Epoch: 3, Steps: 208 | Train Loss: 3.315 Vali Loss: 3.880 Vali Acc: 0.067 Test Loss: 3.880 Test Acc: 0.067
Validation loss decreased (-0.065274 --> -0.066767).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7623901
	speed: 0.2417s/iter; left time: 4852.1867s
	iters: 200, epoch: 4 | loss: 3.5612555
	speed: 0.0343s/iter; left time: 685.5571s
Epoch: 4 cost time: 8.382349729537964
Epoch: 4, Steps: 208 | Train Loss: 3.142 Vali Loss: 4.075 Vali Acc: 0.078 Test Loss: 4.075 Test Acc: 0.078
Validation loss decreased (-0.066767 --> -0.078098).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5405324
	speed: 0.2445s/iter; left time: 4857.7775s
	iters: 200, epoch: 5 | loss: 2.7719853
	speed: 0.0358s/iter; left time: 707.8375s
Epoch: 5 cost time: 8.20195460319519
Epoch: 5, Steps: 208 | Train Loss: 3.020 Vali Loss: 4.324 Vali Acc: 0.082 Test Loss: 4.324 Test Acc: 0.082
Validation loss decreased (-0.078098 --> -0.081675).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6410198
	speed: 0.2351s/iter; left time: 4621.5124s
	iters: 200, epoch: 6 | loss: 2.8656261
	speed: 0.0307s/iter; left time: 599.9442s
Epoch: 6 cost time: 7.681617498397827
Epoch: 6, Steps: 208 | Train Loss: 2.945 Vali Loss: 4.445 Vali Acc: 0.086 Test Loss: 4.445 Test Acc: 0.086
Validation loss decreased (-0.081675 --> -0.085849).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3897815
	speed: 0.2788s/iter; left time: 5422.6652s
	iters: 200, epoch: 7 | loss: 3.2691524
	speed: 0.0489s/iter; left time: 945.6340s
Epoch: 7 cost time: 11.417980194091797
Epoch: 7, Steps: 208 | Train Loss: 2.798 Vali Loss: 4.547 Vali Acc: 0.098 Test Loss: 4.547 Test Acc: 0.098
Validation loss decreased (-0.085849 --> -0.098374).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0757186
	speed: 0.2724s/iter; left time: 5242.1129s
	iters: 200, epoch: 8 | loss: 2.5605810
	speed: 0.0484s/iter; left time: 927.3846s
Epoch: 8 cost time: 10.929829120635986
Epoch: 8, Steps: 208 | Train Loss: 2.606 Vali Loss: 4.711 Vali Acc: 0.095 Test Loss: 4.711 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7782453
	speed: 0.2504s/iter; left time: 4767.1712s
	iters: 200, epoch: 9 | loss: 2.6227455
	speed: 0.0514s/iter; left time: 972.6850s
Epoch: 9 cost time: 10.779298782348633
Epoch: 9, Steps: 208 | Train Loss: 2.436 Vali Loss: 4.972 Vali Acc: 0.100 Test Loss: 4.972 Test Acc: 0.100
Validation loss decreased (-0.098374 --> -0.099563).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2900062
	speed: 0.2508s/iter; left time: 4722.7550s
	iters: 200, epoch: 10 | loss: 3.0754344
	speed: 0.0336s/iter; left time: 629.8961s
Epoch: 10 cost time: 8.230155944824219
Epoch: 10, Steps: 208 | Train Loss: 2.225 Vali Loss: 5.083 Vali Acc: 0.106 Test Loss: 5.083 Test Acc: 0.106
Validation loss decreased (-0.099563 --> -0.105526).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6988846
	speed: 0.2542s/iter; left time: 4734.0057s
	iters: 200, epoch: 11 | loss: 2.4690595
	speed: 0.0350s/iter; left time: 647.4676s
Epoch: 11 cost time: 9.427083730697632
Epoch: 11, Steps: 208 | Train Loss: 2.010 Vali Loss: 5.086 Vali Acc: 0.106 Test Loss: 5.086 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7583399
	speed: 0.2787s/iter; left time: 5132.1342s
	iters: 200, epoch: 12 | loss: 1.4379966
	speed: 0.0601s/iter; left time: 1100.9600s
Epoch: 12 cost time: 13.128120183944702
Epoch: 12, Steps: 208 | Train Loss: 1.836 Vali Loss: 5.351 Vali Acc: 0.109 Test Loss: 5.351 Test Acc: 0.109
Validation loss decreased (-0.105526 --> -0.108804).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5245483
	speed: 0.2372s/iter; left time: 4317.5985s
	iters: 200, epoch: 13 | loss: 2.3689334
	speed: 0.0397s/iter; left time: 719.4269s
Epoch: 13 cost time: 8.872706651687622
Epoch: 13, Steps: 208 | Train Loss: 1.650 Vali Loss: 5.292 Vali Acc: 0.112 Test Loss: 5.292 Test Acc: 0.112
Validation loss decreased (-0.108804 --> -0.111489).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2954400
	speed: 0.2648s/iter; left time: 4765.0367s
	iters: 200, epoch: 14 | loss: 1.2710315
	speed: 0.0320s/iter; left time: 573.5031s
Epoch: 14 cost time: 7.925289869308472
Epoch: 14, Steps: 208 | Train Loss: 1.472 Vali Loss: 5.600 Vali Acc: 0.111 Test Loss: 5.600 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4781444
	speed: 0.2739s/iter; left time: 4872.4614s
	iters: 200, epoch: 15 | loss: 1.2862403
	speed: 0.0439s/iter; left time: 776.2420s
Epoch: 15 cost time: 10.519775152206421
Epoch: 15, Steps: 208 | Train Loss: 1.329 Vali Loss: 6.072 Vali Acc: 0.112 Test Loss: 6.072 Test Acc: 0.112
Validation loss decreased (-0.111489 --> -0.112376).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3129885
	speed: 0.2562s/iter; left time: 4504.6871s
	iters: 200, epoch: 16 | loss: 0.9749913
	speed: 0.0348s/iter; left time: 607.6029s
Epoch: 16 cost time: 7.992857456207275
Epoch: 16, Steps: 208 | Train Loss: 1.177 Vali Loss: 6.232 Vali Acc: 0.106 Test Loss: 6.232 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8016137
	speed: 0.2177s/iter; left time: 3782.0707s
	iters: 200, epoch: 17 | loss: 1.1071255
	speed: 0.0295s/iter; left time: 509.7657s
Epoch: 17 cost time: 7.099673748016357
Epoch: 17, Steps: 208 | Train Loss: 1.014 Vali Loss: 6.705 Vali Acc: 0.113 Test Loss: 6.705 Test Acc: 0.113
Validation loss decreased (-0.112376 --> -0.112668).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6729596
	speed: 0.2232s/iter; left time: 3830.9638s
	iters: 200, epoch: 18 | loss: 0.8600912
	speed: 0.0255s/iter; left time: 435.4895s
Epoch: 18 cost time: 6.626181602478027
Epoch: 18, Steps: 208 | Train Loss: 0.906 Vali Loss: 6.924 Vali Acc: 0.114 Test Loss: 6.924 Test Acc: 0.114
Validation loss decreased (-0.112668 --> -0.113560).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.7211875
	speed: 0.2120s/iter; left time: 3595.0277s
	iters: 200, epoch: 19 | loss: 0.7511429
	speed: 0.0297s/iter; left time: 499.9753s
Epoch: 19 cost time: 7.428696632385254
Epoch: 19, Steps: 208 | Train Loss: 0.831 Vali Loss: 7.240 Vali Acc: 0.108 Test Loss: 7.240 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.2994359
	speed: 0.2318s/iter; left time: 3881.9013s
	iters: 200, epoch: 20 | loss: 0.7778226
	speed: 0.0406s/iter; left time: 675.9817s
Epoch: 20 cost time: 9.742474794387817
Epoch: 20, Steps: 208 | Train Loss: 0.727 Vali Loss: 7.880 Vali Acc: 0.106 Test Loss: 7.880 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.7349388
	speed: 0.2861s/iter; left time: 4732.2493s
	iters: 200, epoch: 21 | loss: 0.7517450
	speed: 0.0578s/iter; left time: 950.0448s
Epoch: 21 cost time: 14.168928384780884
Epoch: 21, Steps: 208 | Train Loss: 0.633 Vali Loss: 8.022 Vali Acc: 0.111 Test Loss: 8.022 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.6217460
	speed: 0.2851s/iter; left time: 4657.3176s
	iters: 200, epoch: 22 | loss: 1.2838953
	speed: 0.0610s/iter; left time: 990.3805s
Epoch: 22 cost time: 13.805706977844238
Epoch: 22, Steps: 208 | Train Loss: 0.606 Vali Loss: 8.318 Vali Acc: 0.113 Test Loss: 8.318 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.0186843
	speed: 0.3018s/iter; left time: 4866.0329s
	iters: 200, epoch: 23 | loss: 0.6045286
	speed: 0.0590s/iter; left time: 945.9702s
Epoch: 23 cost time: 12.573160648345947
Epoch: 23, Steps: 208 | Train Loss: 0.540 Vali Loss: 8.749 Vali Acc: 0.112 Test Loss: 8.749 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.3267685
	speed: 0.3004s/iter; left time: 4781.3667s
	iters: 200, epoch: 24 | loss: 0.5765108
	speed: 0.0445s/iter; left time: 703.6062s
Epoch: 24 cost time: 11.284049034118652
Epoch: 24, Steps: 208 | Train Loss: 0.508 Vali Loss: 8.948 Vali Acc: 0.109 Test Loss: 8.948 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.5981804
	speed: 0.2717s/iter; left time: 4268.5420s
	iters: 200, epoch: 25 | loss: 0.9100912
	speed: 0.0384s/iter; left time: 599.1055s
Epoch: 25 cost time: 9.237873315811157
Epoch: 25, Steps: 208 | Train Loss: 0.475 Vali Loss: 9.492 Vali Acc: 0.103 Test Loss: 9.492 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.4798038
	speed: 0.2948s/iter; left time: 4569.3870s
	iters: 200, epoch: 26 | loss: 0.3058269
	speed: 0.0436s/iter; left time: 671.8319s
Epoch: 26 cost time: 11.302210569381714
Epoch: 26, Steps: 208 | Train Loss: 0.452 Vali Loss: 9.483 Vali Acc: 0.109 Test Loss: 9.483 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1803885
	speed: 0.2928s/iter; left time: 4477.6414s
	iters: 200, epoch: 27 | loss: 0.8779535
	speed: 0.0516s/iter; left time: 784.5442s
Epoch: 27 cost time: 11.901307106018066
Epoch: 27, Steps: 208 | Train Loss: 0.388 Vali Loss: 10.024 Vali Acc: 0.105 Test Loss: 10.024 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.6938784
	speed: 0.2805s/iter; left time: 4231.3571s
	iters: 200, epoch: 28 | loss: 0.1046803
	speed: 0.0505s/iter; left time: 756.5000s
Epoch: 28 cost time: 11.172649621963501
Epoch: 28, Steps: 208 | Train Loss: 0.357 Vali Loss: 10.690 Vali Acc: 0.106 Test Loss: 10.690 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11362958544586937
model parameter : 356967
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7956672
	speed: 0.0795s/iter; left time: 1646.3928s
	iters: 200, epoch: 1 | loss: 3.7675688
	speed: 0.0402s/iter; left time: 827.9722s
Epoch: 1 cost time: 12.360235929489136
Epoch: 1, Steps: 208 | Train Loss: 3.867 Vali Loss: 4.052 Vali Acc: 0.050 Test Loss: 4.052 Test Acc: 0.050
Validation loss decreased (inf --> -0.049766).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1044264
	speed: 0.2723s/iter; left time: 5579.7260s
	iters: 200, epoch: 2 | loss: 3.0699859
	speed: 0.0390s/iter; left time: 794.9383s
Epoch: 2 cost time: 9.192128658294678
Epoch: 2, Steps: 208 | Train Loss: 3.703 Vali Loss: 4.041 Vali Acc: 0.077 Test Loss: 4.041 Test Acc: 0.077
Validation loss decreased (-0.049766 --> -0.076906).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8096223
	speed: 0.2813s/iter; left time: 5706.0374s
	iters: 200, epoch: 3 | loss: 3.2915318
	speed: 0.0375s/iter; left time: 756.8990s
Epoch: 3 cost time: 8.873016357421875
Epoch: 3, Steps: 208 | Train Loss: 3.432 Vali Loss: 4.121 Vali Acc: 0.077 Test Loss: 4.121 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4477077
	speed: 0.2758s/iter; left time: 5536.2376s
	iters: 200, epoch: 4 | loss: 3.4149749
	speed: 0.0459s/iter; left time: 916.7150s
Epoch: 4 cost time: 10.09706997871399
Epoch: 4, Steps: 208 | Train Loss: 3.180 Vali Loss: 4.055 Vali Acc: 0.084 Test Loss: 4.055 Test Acc: 0.084
Validation loss decreased (-0.076906 --> -0.084361).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1108687
	speed: 0.2702s/iter; left time: 5369.4447s
	iters: 200, epoch: 5 | loss: 3.2872410
	speed: 0.0414s/iter; left time: 819.3639s
Epoch: 5 cost time: 9.326832056045532
Epoch: 5, Steps: 208 | Train Loss: 3.037 Vali Loss: 4.239 Vali Acc: 0.077 Test Loss: 4.239 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.3920221
	speed: 0.2817s/iter; left time: 5538.1264s
	iters: 200, epoch: 6 | loss: 3.2881351
	speed: 0.0370s/iter; left time: 722.8714s
Epoch: 6 cost time: 8.94830060005188
Epoch: 6, Steps: 208 | Train Loss: 2.890 Vali Loss: 4.514 Vali Acc: 0.102 Test Loss: 4.514 Test Acc: 0.102
Validation loss decreased (-0.084361 --> -0.101655).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7087383
	speed: 0.2812s/iter; left time: 5470.7512s
	iters: 200, epoch: 7 | loss: 3.2733636
	speed: 0.0394s/iter; left time: 762.8009s
Epoch: 7 cost time: 9.320433616638184
Epoch: 7, Steps: 208 | Train Loss: 2.754 Vali Loss: 4.513 Vali Acc: 0.093 Test Loss: 4.513 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7777555
	speed: 0.2708s/iter; left time: 5212.1855s
	iters: 200, epoch: 8 | loss: 2.6389389
	speed: 0.0305s/iter; left time: 584.8727s
Epoch: 8 cost time: 8.684482336044312
Epoch: 8, Steps: 208 | Train Loss: 2.585 Vali Loss: 4.696 Vali Acc: 0.093 Test Loss: 4.696 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5216250
	speed: 0.2668s/iter; left time: 5078.2672s
	iters: 200, epoch: 9 | loss: 2.0508616
	speed: 0.0289s/iter; left time: 547.0080s
Epoch: 9 cost time: 7.8802876472473145
Epoch: 9, Steps: 208 | Train Loss: 2.352 Vali Loss: 4.914 Vali Acc: 0.101 Test Loss: 4.914 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.0193121
	speed: 0.2586s/iter; left time: 4869.0525s
	iters: 200, epoch: 10 | loss: 2.4611766
	speed: 0.0363s/iter; left time: 679.7399s
Epoch: 10 cost time: 8.623406171798706
Epoch: 10, Steps: 208 | Train Loss: 2.227 Vali Loss: 4.846 Vali Acc: 0.097 Test Loss: 4.846 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.7833765
	speed: 0.2688s/iter; left time: 5006.2327s
	iters: 200, epoch: 11 | loss: 2.4381986
	speed: 0.0381s/iter; left time: 705.9344s
Epoch: 11 cost time: 8.921209812164307
Epoch: 11, Steps: 208 | Train Loss: 2.027 Vali Loss: 4.955 Vali Acc: 0.097 Test Loss: 4.955 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.5381250
	speed: 0.2887s/iter; left time: 5316.5037s
	iters: 200, epoch: 12 | loss: 1.9068768
	speed: 0.0410s/iter; left time: 750.3668s
Epoch: 12 cost time: 10.018698930740356
Epoch: 12, Steps: 208 | Train Loss: 1.835 Vali Loss: 5.249 Vali Acc: 0.095 Test Loss: 5.249 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.4620718
	speed: 0.2778s/iter; left time: 5057.9209s
	iters: 200, epoch: 13 | loss: 1.9966239
	speed: 0.0384s/iter; left time: 694.8605s
Epoch: 13 cost time: 8.912249088287354
Epoch: 13, Steps: 208 | Train Loss: 1.715 Vali Loss: 5.318 Vali Acc: 0.100 Test Loss: 5.318 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.6524127
	speed: 0.2726s/iter; left time: 4906.7159s
	iters: 200, epoch: 14 | loss: 1.5673749
	speed: 0.0393s/iter; left time: 702.9202s
Epoch: 14 cost time: 9.162784814834595
Epoch: 14, Steps: 208 | Train Loss: 1.532 Vali Loss: 5.853 Vali Acc: 0.112 Test Loss: 5.853 Test Acc: 0.112
Validation loss decreased (-0.101655 --> -0.111483).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0154935
	speed: 0.2907s/iter; left time: 5170.7049s
	iters: 200, epoch: 15 | loss: 1.5553241
	speed: 0.0370s/iter; left time: 655.2568s
Epoch: 15 cost time: 9.116235733032227
Epoch: 15, Steps: 208 | Train Loss: 1.385 Vali Loss: 5.808 Vali Acc: 0.103 Test Loss: 5.808 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1785754
	speed: 0.2900s/iter; left time: 5098.3454s
	iters: 200, epoch: 16 | loss: 1.6173064
	speed: 0.0369s/iter; left time: 644.8079s
Epoch: 16 cost time: 9.440604209899902
Epoch: 16, Steps: 208 | Train Loss: 1.230 Vali Loss: 6.272 Vali Acc: 0.106 Test Loss: 6.272 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9118142
	speed: 0.2881s/iter; left time: 5005.0352s
	iters: 200, epoch: 17 | loss: 1.6111373
	speed: 0.0459s/iter; left time: 793.1301s
Epoch: 17 cost time: 10.723710298538208
Epoch: 17, Steps: 208 | Train Loss: 1.097 Vali Loss: 6.534 Vali Acc: 0.111 Test Loss: 6.534 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2419516
	speed: 0.2894s/iter; left time: 4967.3824s
	iters: 200, epoch: 18 | loss: 1.7099117
	speed: 0.0398s/iter; left time: 679.4599s
Epoch: 18 cost time: 9.8422532081604
Epoch: 18, Steps: 208 | Train Loss: 0.987 Vali Loss: 6.899 Vali Acc: 0.114 Test Loss: 6.899 Test Acc: 0.114
Validation loss decreased (-0.111483 --> -0.113561).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5027102
	speed: 0.2823s/iter; left time: 4786.8257s
	iters: 200, epoch: 19 | loss: 1.1071568
	speed: 0.0376s/iter; left time: 634.5020s
Epoch: 19 cost time: 8.722838640213013
Epoch: 19, Steps: 208 | Train Loss: 0.905 Vali Loss: 7.190 Vali Acc: 0.107 Test Loss: 7.190 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.5778759
	speed: 0.2662s/iter; left time: 4459.0018s
	iters: 200, epoch: 20 | loss: 0.4289882
	speed: 0.0399s/iter; left time: 664.8954s
Epoch: 20 cost time: 9.325689554214478
Epoch: 20, Steps: 208 | Train Loss: 0.807 Vali Loss: 7.399 Vali Acc: 0.101 Test Loss: 7.399 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.4910340
	speed: 0.2395s/iter; left time: 3961.6364s
	iters: 200, epoch: 21 | loss: 1.1863784
	speed: 0.0344s/iter; left time: 566.0850s
Epoch: 21 cost time: 7.94438099861145
Epoch: 21, Steps: 208 | Train Loss: 0.736 Vali Loss: 7.716 Vali Acc: 0.109 Test Loss: 7.716 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.0844272
	speed: 0.2368s/iter; left time: 3867.6861s
	iters: 200, epoch: 22 | loss: 1.4068599
	speed: 0.0257s/iter; left time: 416.9056s
Epoch: 22 cost time: 7.1884238719940186
Epoch: 22, Steps: 208 | Train Loss: 0.687 Vali Loss: 7.999 Vali Acc: 0.102 Test Loss: 7.999 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.5855812
	speed: 0.2484s/iter; left time: 4004.6450s
	iters: 200, epoch: 23 | loss: 0.5835108
	speed: 0.0333s/iter; left time: 534.0893s
Epoch: 23 cost time: 8.903954029083252
Epoch: 23, Steps: 208 | Train Loss: 0.622 Vali Loss: 8.246 Vali Acc: 0.108 Test Loss: 8.246 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.7116885
	speed: 0.2325s/iter; left time: 3700.8354s
	iters: 200, epoch: 24 | loss: 0.3129815
	speed: 0.0342s/iter; left time: 540.3661s
Epoch: 24 cost time: 8.321673393249512
Epoch: 24, Steps: 208 | Train Loss: 0.566 Vali Loss: 8.728 Vali Acc: 0.108 Test Loss: 8.728 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.8318208
	speed: 0.2660s/iter; left time: 4178.5081s
	iters: 200, epoch: 25 | loss: 0.2392748
	speed: 0.0415s/iter; left time: 647.8828s
Epoch: 25 cost time: 9.747307300567627
Epoch: 25, Steps: 208 | Train Loss: 0.546 Vali Loss: 9.103 Vali Acc: 0.107 Test Loss: 9.103 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.4702476
	speed: 0.2845s/iter; left time: 4409.9016s
	iters: 200, epoch: 26 | loss: 0.4080121
	speed: 0.0350s/iter; left time: 538.4056s
Epoch: 26 cost time: 8.661411762237549
Epoch: 26, Steps: 208 | Train Loss: 0.498 Vali Loss: 9.237 Vali Acc: 0.101 Test Loss: 9.237 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.7753193
	speed: 0.2827s/iter; left time: 4323.8962s
	iters: 200, epoch: 27 | loss: 0.5546734
	speed: 0.0372s/iter; left time: 565.6320s
Epoch: 27 cost time: 9.762864589691162
Epoch: 27, Steps: 208 | Train Loss: 0.508 Vali Loss: 9.407 Vali Acc: 0.099 Test Loss: 9.407 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.7335621
	speed: 0.2868s/iter; left time: 4326.3388s
	iters: 200, epoch: 28 | loss: 0.5079105
	speed: 0.0379s/iter; left time: 567.8360s
Epoch: 28 cost time: 9.113903522491455
Epoch: 28, Steps: 208 | Train Loss: 0.436 Vali Loss: 9.756 Vali Acc: 0.105 Test Loss: 9.756 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11362958544586937
model parameter : 275303
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9026487
	speed: 0.0689s/iter; left time: 1425.2816s
	iters: 200, epoch: 1 | loss: 4.0193315
	speed: 0.0400s/iter; left time: 824.0481s
Epoch: 1 cost time: 11.410562753677368
Epoch: 1, Steps: 208 | Train Loss: 3.817 Vali Loss: 3.868 Vali Acc: 0.064 Test Loss: 3.868 Test Acc: 0.064
Validation loss decreased (inf --> -0.064083).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4448059
	speed: 0.2716s/iter; left time: 5565.9465s
	iters: 200, epoch: 2 | loss: 3.9169865
	speed: 0.0406s/iter; left time: 828.0923s
Epoch: 2 cost time: 10.325008869171143
Epoch: 2, Steps: 208 | Train Loss: 3.661 Vali Loss: 3.955 Vali Acc: 0.061 Test Loss: 3.955 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4325984
	speed: 0.2853s/iter; left time: 5786.8467s
	iters: 200, epoch: 3 | loss: 3.9494042
	speed: 0.0329s/iter; left time: 664.3569s
Epoch: 3 cost time: 8.284512281417847
Epoch: 3, Steps: 208 | Train Loss: 3.407 Vali Loss: 4.052 Vali Acc: 0.072 Test Loss: 4.052 Test Acc: 0.072
Validation loss decreased (-0.064083 --> -0.072432).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2536523
	speed: 0.2624s/iter; left time: 5267.8456s
	iters: 200, epoch: 4 | loss: 3.0240755
	speed: 0.0302s/iter; left time: 604.1858s
Epoch: 4 cost time: 7.275954484939575
Epoch: 4, Steps: 208 | Train Loss: 3.200 Vali Loss: 4.162 Vali Acc: 0.080 Test Loss: 4.162 Test Acc: 0.080
Validation loss decreased (-0.072432 --> -0.079887).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0873296
	speed: 0.2449s/iter; left time: 4865.2330s
	iters: 200, epoch: 5 | loss: 2.6705890
	speed: 0.0317s/iter; left time: 626.5723s
Epoch: 5 cost time: 7.737134695053101
Epoch: 5, Steps: 208 | Train Loss: 3.058 Vali Loss: 4.188 Vali Acc: 0.090 Test Loss: 4.188 Test Acc: 0.090
Validation loss decreased (-0.079887 --> -0.090027).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1977301
	speed: 0.2564s/iter; left time: 5042.0146s
	iters: 200, epoch: 6 | loss: 2.7391160
	speed: 0.0412s/iter; left time: 806.2512s
Epoch: 6 cost time: 9.111701250076294
Epoch: 6, Steps: 208 | Train Loss: 2.883 Vali Loss: 4.442 Vali Acc: 0.099 Test Loss: 4.442 Test Acc: 0.099
Validation loss decreased (-0.090027 --> -0.099270).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1866400
	speed: 0.2493s/iter; left time: 4848.9352s
	iters: 200, epoch: 7 | loss: 3.1156995
	speed: 0.0423s/iter; left time: 818.7503s
Epoch: 7 cost time: 8.760624170303345
Epoch: 7, Steps: 208 | Train Loss: 2.698 Vali Loss: 4.401 Vali Acc: 0.107 Test Loss: 4.401 Test Acc: 0.107
Validation loss decreased (-0.099270 --> -0.106726).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9185903
	speed: 0.2604s/iter; left time: 5011.5577s
	iters: 200, epoch: 8 | loss: 2.7125313
	speed: 0.0332s/iter; left time: 635.5183s
Epoch: 8 cost time: 8.024667024612427
Epoch: 8, Steps: 208 | Train Loss: 2.557 Vali Loss: 4.591 Vali Acc: 0.101 Test Loss: 4.591 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.7175708
	speed: 0.2871s/iter; left time: 5465.9619s
	iters: 200, epoch: 9 | loss: 2.9492786
	speed: 0.0346s/iter; left time: 654.5621s
Epoch: 9 cost time: 8.762400388717651
Epoch: 9, Steps: 208 | Train Loss: 2.396 Vali Loss: 4.813 Vali Acc: 0.109 Test Loss: 4.813 Test Acc: 0.109
Validation loss decreased (-0.106726 --> -0.109406).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7246037
	speed: 0.2732s/iter; left time: 5143.2784s
	iters: 200, epoch: 10 | loss: 1.7971911
	speed: 0.0342s/iter; left time: 640.5882s
Epoch: 10 cost time: 9.087225198745728
Epoch: 10, Steps: 208 | Train Loss: 2.237 Vali Loss: 4.868 Vali Acc: 0.112 Test Loss: 4.868 Test Acc: 0.112
Validation loss decreased (-0.109406 --> -0.111791).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4043946
	speed: 0.2600s/iter; left time: 4841.6992s
	iters: 200, epoch: 11 | loss: 1.9499826
	speed: 0.0439s/iter; left time: 812.5880s
Epoch: 11 cost time: 9.846094608306885
Epoch: 11, Steps: 208 | Train Loss: 2.057 Vali Loss: 5.076 Vali Acc: 0.106 Test Loss: 5.076 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0192366
	speed: 0.2478s/iter; left time: 4563.4007s
	iters: 200, epoch: 12 | loss: 1.9503394
	speed: 0.0306s/iter; left time: 560.1360s
Epoch: 12 cost time: 8.008435726165771
Epoch: 12, Steps: 208 | Train Loss: 1.868 Vali Loss: 5.376 Vali Acc: 0.106 Test Loss: 5.376 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5615146
	speed: 0.2431s/iter; left time: 4424.7366s
	iters: 200, epoch: 13 | loss: 2.2227108
	speed: 0.0345s/iter; left time: 624.7068s
Epoch: 13 cost time: 8.33260989189148
Epoch: 13, Steps: 208 | Train Loss: 1.723 Vali Loss: 5.385 Vali Acc: 0.113 Test Loss: 5.385 Test Acc: 0.113
Validation loss decreased (-0.111791 --> -0.112681).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7132444
	speed: 0.2582s/iter; left time: 4647.3261s
	iters: 200, epoch: 14 | loss: 1.6355877
	speed: 0.0342s/iter; left time: 612.0375s
Epoch: 14 cost time: 7.9114015102386475
Epoch: 14, Steps: 208 | Train Loss: 1.572 Vali Loss: 5.799 Vali Acc: 0.103 Test Loss: 5.799 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9822276
	speed: 0.3034s/iter; left time: 5397.8645s
	iters: 200, epoch: 15 | loss: 1.0880537
	speed: 0.0359s/iter; left time: 635.4942s
Epoch: 15 cost time: 8.910781621932983
Epoch: 15, Steps: 208 | Train Loss: 1.450 Vali Loss: 6.165 Vali Acc: 0.111 Test Loss: 6.165 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5833790
	speed: 0.3003s/iter; left time: 5278.7448s
	iters: 200, epoch: 16 | loss: 1.3833450
	speed: 0.0368s/iter; left time: 643.4155s
Epoch: 16 cost time: 9.58664846420288
Epoch: 16, Steps: 208 | Train Loss: 1.304 Vali Loss: 6.361 Vali Acc: 0.112 Test Loss: 6.361 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2431295
	speed: 0.2711s/iter; left time: 4709.8179s
	iters: 200, epoch: 17 | loss: 1.9903498
	speed: 0.0418s/iter; left time: 722.1999s
Epoch: 17 cost time: 9.745225429534912
Epoch: 17, Steps: 208 | Train Loss: 1.184 Vali Loss: 6.591 Vali Acc: 0.099 Test Loss: 6.591 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.4232770
	speed: 0.2661s/iter; left time: 4567.0330s
	iters: 200, epoch: 18 | loss: 0.9879456
	speed: 0.0372s/iter; left time: 634.2346s
Epoch: 18 cost time: 9.206298351287842
Epoch: 18, Steps: 208 | Train Loss: 1.074 Vali Loss: 6.835 Vali Acc: 0.106 Test Loss: 6.835 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7321517
	speed: 0.2738s/iter; left time: 4642.2516s
	iters: 200, epoch: 19 | loss: 1.1476244
	speed: 0.0373s/iter; left time: 629.0508s
Epoch: 19 cost time: 8.594455242156982
Epoch: 19, Steps: 208 | Train Loss: 0.976 Vali Loss: 7.290 Vali Acc: 0.105 Test Loss: 7.290 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.2208484
	speed: 0.2694s/iter; left time: 4512.3022s
	iters: 200, epoch: 20 | loss: 1.4213425
	speed: 0.0333s/iter; left time: 553.9401s
Epoch: 20 cost time: 9.031588315963745
Epoch: 20, Steps: 208 | Train Loss: 0.882 Vali Loss: 7.424 Vali Acc: 0.106 Test Loss: 7.424 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.2978792
	speed: 0.2624s/iter; left time: 4340.6036s
	iters: 200, epoch: 21 | loss: 1.0394627
	speed: 0.0403s/iter; left time: 662.0539s
Epoch: 21 cost time: 9.44014835357666
Epoch: 21, Steps: 208 | Train Loss: 0.807 Vali Loss: 7.899 Vali Acc: 0.104 Test Loss: 7.899 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.1791185
	speed: 0.2525s/iter; left time: 4124.4392s
	iters: 200, epoch: 22 | loss: 1.0082176
	speed: 0.0379s/iter; left time: 615.0140s
Epoch: 22 cost time: 8.67658519744873
Epoch: 22, Steps: 208 | Train Loss: 0.752 Vali Loss: 7.996 Vali Acc: 0.114 Test Loss: 7.996 Test Acc: 0.114
Validation loss decreased (-0.112681 --> -0.113550).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.3189085
	speed: 0.2837s/iter; left time: 4574.2027s
	iters: 200, epoch: 23 | loss: 0.5121998
	speed: 0.0340s/iter; left time: 545.3513s
Epoch: 23 cost time: 8.610235214233398
Epoch: 23, Steps: 208 | Train Loss: 0.691 Vali Loss: 8.402 Vali Acc: 0.106 Test Loss: 8.402 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.4659654
	speed: 0.2499s/iter; left time: 3978.3449s
	iters: 200, epoch: 24 | loss: 0.7789637
	speed: 0.0322s/iter; left time: 509.7208s
Epoch: 24 cost time: 7.776241064071655
Epoch: 24, Steps: 208 | Train Loss: 0.639 Vali Loss: 8.699 Vali Acc: 0.106 Test Loss: 8.699 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2032789
	speed: 0.2614s/iter; left time: 4106.3633s
	iters: 200, epoch: 25 | loss: 0.9326363
	speed: 0.0453s/iter; left time: 706.3715s
Epoch: 25 cost time: 10.481200456619263
Epoch: 25, Steps: 208 | Train Loss: 0.590 Vali Loss: 8.862 Vali Acc: 0.109 Test Loss: 8.862 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.3174933
	speed: 0.2410s/iter; left time: 3736.0118s
	iters: 200, epoch: 26 | loss: 0.2838540
	speed: 0.0344s/iter; left time: 529.7068s
Epoch: 26 cost time: 8.09025764465332
Epoch: 26, Steps: 208 | Train Loss: 0.563 Vali Loss: 9.123 Vali Acc: 0.110 Test Loss: 9.123 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.1787506
	speed: 0.2626s/iter; left time: 4016.0447s
	iters: 200, epoch: 27 | loss: 0.9116564
	speed: 0.0350s/iter; left time: 531.3309s
Epoch: 27 cost time: 8.337054014205933
Epoch: 27, Steps: 208 | Train Loss: 0.508 Vali Loss: 9.764 Vali Acc: 0.105 Test Loss: 9.764 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.4537192
	speed: 0.2585s/iter; left time: 3899.2344s
	iters: 200, epoch: 28 | loss: 0.5458929
	speed: 0.0404s/iter; left time: 604.7294s
Epoch: 28 cost time: 9.044143676757812
Epoch: 28, Steps: 208 | Train Loss: 0.520 Vali Loss: 9.824 Vali Acc: 0.106 Test Loss: 9.824 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.5629166
	speed: 0.2854s/iter; left time: 4245.7141s
	iters: 200, epoch: 29 | loss: 0.6596612
	speed: 0.0467s/iter; left time: 690.3174s
Epoch: 29 cost time: 10.407865524291992
Epoch: 29, Steps: 208 | Train Loss: 0.462 Vali Loss: 10.174 Vali Acc: 0.101 Test Loss: 10.174 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.4216846
	speed: 0.2741s/iter; left time: 4021.4277s
	iters: 200, epoch: 30 | loss: 0.8862582
	speed: 0.0351s/iter; left time: 512.0545s
Epoch: 30 cost time: 8.820959091186523
Epoch: 30, Steps: 208 | Train Loss: 0.462 Vali Loss: 10.406 Vali Acc: 0.100 Test Loss: 10.406 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.1586827
	speed: 0.2769s/iter; left time: 4003.9258s
	iters: 200, epoch: 31 | loss: 0.6115338
	speed: 0.0310s/iter; left time: 444.6482s
Epoch: 31 cost time: 8.07274842262268
Epoch: 31, Steps: 208 | Train Loss: 0.444 Vali Loss: 10.548 Vali Acc: 0.110 Test Loss: 10.548 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.1195619
	speed: 0.2641s/iter; left time: 3764.6948s
	iters: 200, epoch: 32 | loss: 0.2496967
	speed: 0.0294s/iter; left time: 415.5725s
Epoch: 32 cost time: 7.568085432052612
Epoch: 32, Steps: 208 | Train Loss: 0.392 Vali Loss: 10.822 Vali Acc: 0.109 Test Loss: 10.822 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm64_nh16_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11362958544586937
model parameter : 221095
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9193306
	speed: 0.0829s/iter; left time: 1716.0006s
	iters: 200, epoch: 1 | loss: 4.6200113
	speed: 0.0405s/iter; left time: 834.4618s
Epoch: 1 cost time: 12.735641241073608
Epoch: 1, Steps: 208 | Train Loss: 4.505 Vali Loss: 5.198 Vali Acc: 0.056 Test Loss: 5.198 Test Acc: 0.056
Validation loss decreased (inf --> -0.056315).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9600606
	speed: 0.2846s/iter; left time: 5832.4398s
	iters: 200, epoch: 2 | loss: 4.5262113
	speed: 0.0475s/iter; left time: 969.6761s
Epoch: 2 cost time: 11.44412899017334
Epoch: 2, Steps: 208 | Train Loss: 4.242 Vali Loss: 3.950 Vali Acc: 0.070 Test Loss: 3.950 Test Acc: 0.070
Validation loss decreased (-0.056315 --> -0.070047).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7973995
	speed: 0.2720s/iter; left time: 5517.6868s
	iters: 200, epoch: 3 | loss: 3.7373502
	speed: 0.0461s/iter; left time: 929.5289s
Epoch: 3 cost time: 9.833365201950073
Epoch: 3, Steps: 208 | Train Loss: 3.420 Vali Loss: 4.495 Vali Acc: 0.078 Test Loss: 4.495 Test Acc: 0.078
Validation loss decreased (-0.070047 --> -0.077796).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.2745991
	speed: 0.2890s/iter; left time: 5801.3125s
	iters: 200, epoch: 4 | loss: 3.0308645
	speed: 0.0419s/iter; left time: 837.1663s
Epoch: 4 cost time: 9.71018671989441
Epoch: 4, Steps: 208 | Train Loss: 3.397 Vali Loss: 4.603 Vali Acc: 0.074 Test Loss: 4.603 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.8768482
	speed: 0.2824s/iter; left time: 5610.7281s
	iters: 200, epoch: 5 | loss: 2.6612942
	speed: 0.0432s/iter; left time: 854.9051s
Epoch: 5 cost time: 9.98148250579834
Epoch: 5, Steps: 208 | Train Loss: 3.302 Vali Loss: 4.810 Vali Acc: 0.078 Test Loss: 4.810 Test Acc: 0.078
Validation loss decreased (-0.077796 --> -0.078389).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4287374
	speed: 0.2882s/iter; left time: 5665.6434s
	iters: 200, epoch: 6 | loss: 3.8735042
	speed: 0.0410s/iter; left time: 802.6521s
Epoch: 6 cost time: 10.685952186584473
Epoch: 6, Steps: 208 | Train Loss: 3.056 Vali Loss: 4.741 Vali Acc: 0.094 Test Loss: 4.741 Test Acc: 0.094
Validation loss decreased (-0.078389 --> -0.093600).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7737803
	speed: 0.2631s/iter; left time: 5118.2629s
	iters: 200, epoch: 7 | loss: 3.7822871
	speed: 0.0477s/iter; left time: 922.9305s
Epoch: 7 cost time: 10.080573558807373
Epoch: 7, Steps: 208 | Train Loss: 2.650 Vali Loss: 5.178 Vali Acc: 0.091 Test Loss: 5.178 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5919092
	speed: 0.2734s/iter; left time: 5261.7338s
	iters: 200, epoch: 8 | loss: 2.5387669
	speed: 0.0394s/iter; left time: 755.1063s
Epoch: 8 cost time: 9.195664405822754
Epoch: 8, Steps: 208 | Train Loss: 2.169 Vali Loss: 5.696 Vali Acc: 0.095 Test Loss: 5.696 Test Acc: 0.095
Validation loss decreased (-0.093600 --> -0.095082).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9073840
	speed: 0.2672s/iter; left time: 5087.5319s
	iters: 200, epoch: 9 | loss: 2.4690855
	speed: 0.0403s/iter; left time: 763.4280s
Epoch: 9 cost time: 9.010688304901123
Epoch: 9, Steps: 208 | Train Loss: 1.795 Vali Loss: 5.768 Vali Acc: 0.101 Test Loss: 5.768 Test Acc: 0.101
Validation loss decreased (-0.095082 --> -0.100449).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7848092
	speed: 0.2527s/iter; left time: 4757.5919s
	iters: 200, epoch: 10 | loss: 1.8653408
	speed: 0.0364s/iter; left time: 681.6275s
Epoch: 10 cost time: 8.416900634765625
Epoch: 10, Steps: 208 | Train Loss: 1.569 Vali Loss: 5.564 Vali Acc: 0.103 Test Loss: 5.564 Test Acc: 0.103
Validation loss decreased (-0.100449 --> -0.102837).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0920686
	speed: 0.2602s/iter; left time: 4845.0185s
	iters: 200, epoch: 11 | loss: 3.0787747
	speed: 0.0487s/iter; left time: 902.4871s
Epoch: 11 cost time: 10.649610996246338
Epoch: 11, Steps: 208 | Train Loss: 1.384 Vali Loss: 6.354 Vali Acc: 0.101 Test Loss: 6.354 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0556653
	speed: 0.2698s/iter; left time: 4967.4148s
	iters: 200, epoch: 12 | loss: 1.2886318
	speed: 0.0487s/iter; left time: 892.2556s
Epoch: 12 cost time: 10.400111675262451
Epoch: 12, Steps: 208 | Train Loss: 1.201 Vali Loss: 6.662 Vali Acc: 0.098 Test Loss: 6.662 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2627697
	speed: 0.2947s/iter; left time: 5364.1424s
	iters: 200, epoch: 13 | loss: 1.7455790
	speed: 0.0327s/iter; left time: 592.6589s
Epoch: 13 cost time: 8.827438116073608
Epoch: 13, Steps: 208 | Train Loss: 1.060 Vali Loss: 7.042 Vali Acc: 0.095 Test Loss: 7.042 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0631677
	speed: 0.3025s/iter; left time: 5444.2611s
	iters: 200, epoch: 14 | loss: 1.0025986
	speed: 0.0494s/iter; left time: 883.2963s
Epoch: 14 cost time: 10.852224826812744
Epoch: 14, Steps: 208 | Train Loss: 0.887 Vali Loss: 7.533 Vali Acc: 0.094 Test Loss: 7.533 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.9681820
	speed: 0.2946s/iter; left time: 5240.4013s
	iters: 200, epoch: 15 | loss: 1.8269215
	speed: 0.0469s/iter; left time: 828.7482s
Epoch: 15 cost time: 10.951524257659912
Epoch: 15, Steps: 208 | Train Loss: 0.735 Vali Loss: 8.307 Vali Acc: 0.108 Test Loss: 8.307 Test Acc: 0.108
Validation loss decreased (-0.102837 --> -0.107582).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6581713
	speed: 0.2858s/iter; left time: 5024.2746s
	iters: 200, epoch: 16 | loss: 0.3543029
	speed: 0.0456s/iter; left time: 796.5466s
Epoch: 16 cost time: 11.47086238861084
Epoch: 16, Steps: 208 | Train Loss: 0.599 Vali Loss: 8.814 Vali Acc: 0.107 Test Loss: 8.814 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4665285
	speed: 0.2943s/iter; left time: 5112.2001s
	iters: 200, epoch: 17 | loss: 1.0218246
	speed: 0.0538s/iter; left time: 928.9168s
Epoch: 17 cost time: 12.652936697006226
Epoch: 17, Steps: 208 | Train Loss: 0.525 Vali Loss: 9.386 Vali Acc: 0.102 Test Loss: 9.386 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.6547482
	speed: 0.2486s/iter; left time: 4266.5291s
	iters: 200, epoch: 18 | loss: 0.4891984
	speed: 0.0366s/iter; left time: 625.0054s
Epoch: 18 cost time: 8.761810779571533
Epoch: 18, Steps: 208 | Train Loss: 0.452 Vali Loss: 9.932 Vali Acc: 0.108 Test Loss: 9.932 Test Acc: 0.108
Validation loss decreased (-0.107582 --> -0.107864).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.2567070
	speed: 0.2632s/iter; left time: 4462.2539s
	iters: 200, epoch: 19 | loss: 0.4523885
	speed: 0.0302s/iter; left time: 509.2111s
Epoch: 19 cost time: 7.22662878036499
Epoch: 19, Steps: 208 | Train Loss: 0.410 Vali Loss: 10.061 Vali Acc: 0.100 Test Loss: 10.061 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7603348
	speed: 0.2409s/iter; left time: 4034.0685s
	iters: 200, epoch: 20 | loss: 0.3614315
	speed: 0.0439s/iter; left time: 730.1070s
Epoch: 20 cost time: 9.397671937942505
Epoch: 20, Steps: 208 | Train Loss: 0.348 Vali Loss: 10.770 Vali Acc: 0.103 Test Loss: 10.770 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2443232
	speed: 0.2794s/iter; left time: 4622.0040s
	iters: 200, epoch: 21 | loss: 0.1811164
	speed: 0.0503s/iter; left time: 827.2730s
Epoch: 21 cost time: 11.70979619026184
Epoch: 21, Steps: 208 | Train Loss: 0.313 Vali Loss: 11.252 Vali Acc: 0.100 Test Loss: 11.252 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.2454875
	speed: 0.2452s/iter; left time: 4004.7695s
	iters: 200, epoch: 22 | loss: 0.4894890
	speed: 0.0382s/iter; left time: 620.3206s
Epoch: 22 cost time: 8.745004415512085
Epoch: 22, Steps: 208 | Train Loss: 0.275 Vali Loss: 11.670 Vali Acc: 0.108 Test Loss: 11.670 Test Acc: 0.108
Validation loss decreased (-0.107864 --> -0.108145).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1836695
	speed: 0.2653s/iter; left time: 4277.5582s
	iters: 200, epoch: 23 | loss: 0.2194693
	speed: 0.0422s/iter; left time: 676.6101s
Epoch: 23 cost time: 9.397834539413452
Epoch: 23, Steps: 208 | Train Loss: 0.277 Vali Loss: 11.780 Vali Acc: 0.103 Test Loss: 11.780 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.2571718
	speed: 0.3084s/iter; left time: 4908.0557s
	iters: 200, epoch: 24 | loss: 0.1225077
	speed: 0.0448s/iter; left time: 708.0030s
Epoch: 24 cost time: 10.446856260299683
Epoch: 24, Steps: 208 | Train Loss: 0.259 Vali Loss: 12.178 Vali Acc: 0.111 Test Loss: 12.178 Test Acc: 0.111
Validation loss decreased (-0.108145 --> -0.111122).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.3221657
	speed: 0.3020s/iter; left time: 4743.7979s
	iters: 200, epoch: 25 | loss: 0.1628154
	speed: 0.0352s/iter; left time: 548.6622s
Epoch: 25 cost time: 9.23293685913086
Epoch: 25, Steps: 208 | Train Loss: 0.239 Vali Loss: 12.911 Vali Acc: 0.111 Test Loss: 12.911 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0716080
	speed: 0.2778s/iter; left time: 4306.3841s
	iters: 200, epoch: 26 | loss: 0.2302119
	speed: 0.0509s/iter; left time: 784.3901s
Epoch: 26 cost time: 10.633407831192017
Epoch: 26, Steps: 208 | Train Loss: 0.203 Vali Loss: 13.165 Vali Acc: 0.112 Test Loss: 13.165 Test Acc: 0.112
Validation loss decreased (-0.111122 --> -0.111410).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0663567
	speed: 0.2914s/iter; left time: 4456.7044s
	iters: 200, epoch: 27 | loss: 0.2460626
	speed: 0.0481s/iter; left time: 730.2677s
Epoch: 27 cost time: 11.060849905014038
Epoch: 27, Steps: 208 | Train Loss: 0.202 Vali Loss: 13.666 Vali Acc: 0.105 Test Loss: 13.666 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0116547
	speed: 0.3007s/iter; left time: 4536.7290s
	iters: 200, epoch: 28 | loss: 0.0275817
	speed: 0.0350s/iter; left time: 524.8276s
Epoch: 28 cost time: 9.924748420715332
Epoch: 28, Steps: 208 | Train Loss: 0.201 Vali Loss: 13.742 Vali Acc: 0.102 Test Loss: 13.742 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0937776
	speed: 0.2732s/iter; left time: 4064.9304s
	iters: 200, epoch: 29 | loss: 0.1275487
	speed: 0.0397s/iter; left time: 587.3446s
Epoch: 29 cost time: 9.604233503341675
Epoch: 29, Steps: 208 | Train Loss: 0.159 Vali Loss: 13.622 Vali Acc: 0.106 Test Loss: 13.622 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0345041
	speed: 0.2702s/iter; left time: 3963.9397s
	iters: 200, epoch: 30 | loss: 0.4745902
	speed: 0.0330s/iter; left time: 480.0745s
Epoch: 30 cost time: 8.194939136505127
Epoch: 30, Steps: 208 | Train Loss: 0.153 Vali Loss: 14.950 Vali Acc: 0.103 Test Loss: 14.950 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0423864
	speed: 0.2637s/iter; left time: 3813.0151s
	iters: 200, epoch: 31 | loss: 0.0057155
	speed: 0.0382s/iter; left time: 548.2147s
Epoch: 31 cost time: 9.215466737747192
Epoch: 31, Steps: 208 | Train Loss: 0.162 Vali Loss: 14.707 Vali Acc: 0.106 Test Loss: 14.707 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.5721006
	speed: 0.2641s/iter; left time: 3763.8109s
	iters: 200, epoch: 32 | loss: 0.0523294
	speed: 0.0402s/iter; left time: 569.4632s
Epoch: 32 cost time: 9.852004289627075
Epoch: 32, Steps: 208 | Train Loss: 0.162 Vali Loss: 15.066 Vali Acc: 0.103 Test Loss: 15.066 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0857477
	speed: 0.2638s/iter; left time: 3705.4323s
	iters: 200, epoch: 33 | loss: 0.1341312
	speed: 0.0528s/iter; left time: 736.3047s
Epoch: 33 cost time: 11.91097640991211
Epoch: 33, Steps: 208 | Train Loss: 0.131 Vali Loss: 15.258 Vali Acc: 0.108 Test Loss: 15.258 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0023965
	speed: 0.2765s/iter; left time: 3825.3731s
	iters: 200, epoch: 34 | loss: 0.1339395
	speed: 0.0339s/iter; left time: 466.3279s
Epoch: 34 cost time: 9.240058422088623
Epoch: 34, Steps: 208 | Train Loss: 0.128 Vali Loss: 15.653 Vali Acc: 0.109 Test Loss: 15.653 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0115328
	speed: 0.2895s/iter; left time: 3945.5579s
	iters: 200, epoch: 35 | loss: 0.0306490
	speed: 0.0366s/iter; left time: 495.5850s
Epoch: 35 cost time: 9.551545143127441
Epoch: 35, Steps: 208 | Train Loss: 0.136 Vali Loss: 15.591 Vali Acc: 0.106 Test Loss: 15.591 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0605386
	speed: 0.2683s/iter; left time: 3600.4755s
	iters: 200, epoch: 36 | loss: 0.4599235
	speed: 0.0541s/iter; left time: 721.1007s
Epoch: 36 cost time: 11.994487285614014
Epoch: 36, Steps: 208 | Train Loss: 0.135 Vali Loss: 16.411 Vali Acc: 0.106 Test Loss: 16.411 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11154190277363556
model parameter : 1009735
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0232801
	speed: 0.0774s/iter; left time: 1602.3343s
	iters: 200, epoch: 1 | loss: 4.6748567
	speed: 0.0381s/iter; left time: 785.5950s
Epoch: 1 cost time: 12.241488695144653
Epoch: 1, Steps: 208 | Train Loss: 4.072 Vali Loss: 4.277 Vali Acc: 0.047 Test Loss: 4.277 Test Acc: 0.047
Validation loss decreased (inf --> -0.046781).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7616649
	speed: 0.2891s/iter; left time: 5924.8048s
	iters: 200, epoch: 2 | loss: 3.5699961
	speed: 0.0437s/iter; left time: 891.6044s
Epoch: 2 cost time: 11.412779808044434
Epoch: 2, Steps: 208 | Train Loss: 3.739 Vali Loss: 4.424 Vali Acc: 0.072 Test Loss: 4.424 Test Acc: 0.072
Validation loss decreased (-0.046781 --> -0.071533).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6127856
	speed: 0.2802s/iter; left time: 5683.2210s
	iters: 200, epoch: 3 | loss: 2.9045768
	speed: 0.0471s/iter; left time: 950.7574s
Epoch: 3 cost time: 10.949024438858032
Epoch: 3, Steps: 208 | Train Loss: 3.316 Vali Loss: 4.386 Vali Acc: 0.075 Test Loss: 4.386 Test Acc: 0.075
Validation loss decreased (-0.071533 --> -0.074814).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4561820
	speed: 0.2649s/iter; left time: 5318.1359s
	iters: 200, epoch: 4 | loss: 3.1577106
	speed: 0.0377s/iter; left time: 752.7907s
Epoch: 4 cost time: 9.265148162841797
Epoch: 4, Steps: 208 | Train Loss: 3.039 Vali Loss: 4.712 Vali Acc: 0.093 Test Loss: 4.712 Test Acc: 0.093
Validation loss decreased (-0.074814 --> -0.093302).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2324824
	speed: 0.2524s/iter; left time: 5015.4278s
	iters: 200, epoch: 5 | loss: 4.0033517
	speed: 0.0346s/iter; left time: 683.4406s
Epoch: 5 cost time: 8.4026939868927
Epoch: 5, Steps: 208 | Train Loss: 2.900 Vali Loss: 4.677 Vali Acc: 0.097 Test Loss: 4.677 Test Acc: 0.097
Validation loss decreased (-0.093302 --> -0.096583).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7927370
	speed: 0.2712s/iter; left time: 5332.4657s
	iters: 200, epoch: 6 | loss: 3.0900402
	speed: 0.0314s/iter; left time: 613.4882s
Epoch: 6 cost time: 8.88258171081543
Epoch: 6, Steps: 208 | Train Loss: 2.684 Vali Loss: 4.829 Vali Acc: 0.098 Test Loss: 4.829 Test Acc: 0.098
Validation loss decreased (-0.096583 --> -0.097476).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1496444
	speed: 0.3104s/iter; left time: 6037.5773s
	iters: 200, epoch: 7 | loss: 2.6336026
	speed: 0.0426s/iter; left time: 824.2620s
Epoch: 7 cost time: 10.564716815948486
Epoch: 7, Steps: 208 | Train Loss: 2.428 Vali Loss: 5.021 Vali Acc: 0.098 Test Loss: 5.021 Test Acc: 0.098
Validation loss decreased (-0.097476 --> -0.098071).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8273991
	speed: 0.2983s/iter; left time: 5740.8342s
	iters: 200, epoch: 8 | loss: 2.9605315
	speed: 0.0520s/iter; left time: 994.7329s
Epoch: 8 cost time: 11.58588719367981
Epoch: 8, Steps: 208 | Train Loss: 2.139 Vali Loss: 5.077 Vali Acc: 0.104 Test Loss: 5.077 Test Acc: 0.104
Validation loss decreased (-0.098071 --> -0.104333).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7484835
	speed: 0.3105s/iter; left time: 5911.8185s
	iters: 200, epoch: 9 | loss: 2.8872344
	speed: 0.0461s/iter; left time: 872.7313s
Epoch: 9 cost time: 10.892233848571777
Epoch: 9, Steps: 208 | Train Loss: 1.857 Vali Loss: 5.213 Vali Acc: 0.104 Test Loss: 5.213 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0591316
	speed: 0.2766s/iter; left time: 5207.9717s
	iters: 200, epoch: 10 | loss: 1.5073103
	speed: 0.0478s/iter; left time: 896.0781s
Epoch: 10 cost time: 10.999072074890137
Epoch: 10, Steps: 208 | Train Loss: 1.642 Vali Loss: 5.538 Vali Acc: 0.100 Test Loss: 5.538 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.1653416
	speed: 0.2745s/iter; left time: 5111.6983s
	iters: 200, epoch: 11 | loss: 2.2744522
	speed: 0.0376s/iter; left time: 697.2410s
Epoch: 11 cost time: 9.13037633895874
Epoch: 11, Steps: 208 | Train Loss: 1.424 Vali Loss: 6.033 Vali Acc: 0.100 Test Loss: 6.033 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2837384
	speed: 0.2481s/iter; left time: 4568.6687s
	iters: 200, epoch: 12 | loss: 0.9839525
	speed: 0.0392s/iter; left time: 717.4165s
Epoch: 12 cost time: 8.357087850570679
Epoch: 12, Steps: 208 | Train Loss: 1.287 Vali Loss: 6.212 Vali Acc: 0.106 Test Loss: 6.212 Test Acc: 0.106
Validation loss decreased (-0.104333 --> -0.106410).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0268909
	speed: 0.2721s/iter; left time: 4953.4072s
	iters: 200, epoch: 13 | loss: 1.5400388
	speed: 0.0318s/iter; left time: 575.0227s
Epoch: 13 cost time: 8.443662881851196
Epoch: 13, Steps: 208 | Train Loss: 1.107 Vali Loss: 6.617 Vali Acc: 0.104 Test Loss: 6.617 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7908304
	speed: 0.2791s/iter; left time: 5023.0798s
	iters: 200, epoch: 14 | loss: 1.4831589
	speed: 0.0458s/iter; left time: 819.4756s
Epoch: 14 cost time: 10.39519214630127
Epoch: 14, Steps: 208 | Train Loss: 0.969 Vali Loss: 7.115 Vali Acc: 0.101 Test Loss: 7.115 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7774171
	speed: 0.2839s/iter; left time: 5049.4301s
	iters: 200, epoch: 15 | loss: 1.5962516
	speed: 0.0483s/iter; left time: 854.2129s
Epoch: 15 cost time: 10.464538335800171
Epoch: 15, Steps: 208 | Train Loss: 0.857 Vali Loss: 7.688 Vali Acc: 0.110 Test Loss: 7.688 Test Acc: 0.110
Validation loss decreased (-0.106410 --> -0.110272).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6114449
	speed: 0.2780s/iter; left time: 4887.8472s
	iters: 200, epoch: 16 | loss: 1.5147526
	speed: 0.0491s/iter; left time: 857.6899s
Epoch: 16 cost time: 10.666077852249146
Epoch: 16, Steps: 208 | Train Loss: 0.758 Vali Loss: 7.873 Vali Acc: 0.102 Test Loss: 7.873 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2606541
	speed: 0.2990s/iter; left time: 5194.3764s
	iters: 200, epoch: 17 | loss: 0.6132528
	speed: 0.0391s/iter; left time: 674.8294s
Epoch: 17 cost time: 9.935957193374634
Epoch: 17, Steps: 208 | Train Loss: 0.673 Vali Loss: 8.433 Vali Acc: 0.105 Test Loss: 8.433 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.0172368
	speed: 0.3028s/iter; left time: 5198.1518s
	iters: 200, epoch: 18 | loss: 0.9430473
	speed: 0.0620s/iter; left time: 1058.3961s
Epoch: 18 cost time: 12.934524536132812
Epoch: 18, Steps: 208 | Train Loss: 0.591 Vali Loss: 8.836 Vali Acc: 0.102 Test Loss: 8.836 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8057830
	speed: 0.2826s/iter; left time: 4792.3834s
	iters: 200, epoch: 19 | loss: 0.7981475
	speed: 0.0504s/iter; left time: 849.3586s
Epoch: 19 cost time: 11.194947957992554
Epoch: 19, Steps: 208 | Train Loss: 0.512 Vali Loss: 9.164 Vali Acc: 0.104 Test Loss: 9.164 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.2865702
	speed: 0.2947s/iter; left time: 4935.2430s
	iters: 200, epoch: 20 | loss: 1.1243119
	speed: 0.0487s/iter; left time: 810.2784s
Epoch: 20 cost time: 11.064439535140991
Epoch: 20, Steps: 208 | Train Loss: 0.497 Vali Loss: 10.194 Vali Acc: 0.097 Test Loss: 10.194 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3199297
	speed: 0.2968s/iter; left time: 4909.2768s
	iters: 200, epoch: 21 | loss: 0.5211611
	speed: 0.0452s/iter; left time: 743.3789s
Epoch: 21 cost time: 11.543982744216919
Epoch: 21, Steps: 208 | Train Loss: 0.434 Vali Loss: 9.977 Vali Acc: 0.103 Test Loss: 9.977 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.5475606
	speed: 0.2749s/iter; left time: 4489.7224s
	iters: 200, epoch: 22 | loss: 0.4059279
	speed: 0.0392s/iter; left time: 636.7137s
Epoch: 22 cost time: 9.354392051696777
Epoch: 22, Steps: 208 | Train Loss: 0.406 Vali Loss: 10.156 Vali Acc: 0.103 Test Loss: 10.156 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.6068589
	speed: 0.2782s/iter; left time: 4486.3489s
	iters: 200, epoch: 23 | loss: 0.7607419
	speed: 0.0300s/iter; left time: 480.0539s
Epoch: 23 cost time: 8.05250072479248
Epoch: 23, Steps: 208 | Train Loss: 0.366 Vali Loss: 11.040 Vali Acc: 0.110 Test Loss: 11.040 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.5959659
	speed: 0.2405s/iter; left time: 3827.7902s
	iters: 200, epoch: 24 | loss: 0.4118550
	speed: 0.0344s/iter; left time: 543.5792s
Epoch: 24 cost time: 9.039074182510376
Epoch: 24, Steps: 208 | Train Loss: 0.341 Vali Loss: 11.243 Vali Acc: 0.095 Test Loss: 11.243 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.5532954
	speed: 0.2434s/iter; left time: 3824.0891s
	iters: 200, epoch: 25 | loss: 0.7938485
	speed: 0.0328s/iter; left time: 512.0478s
Epoch: 25 cost time: 8.380442380905151
Epoch: 25, Steps: 208 | Train Loss: 0.362 Vali Loss: 11.644 Vali Acc: 0.107 Test Loss: 11.644 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1103489412466448
model parameter : 515687
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1526623
	speed: 0.0851s/iter; left time: 1761.1772s
	iters: 200, epoch: 1 | loss: 3.8263159
	speed: 0.0468s/iter; left time: 963.1848s
Epoch: 1 cost time: 13.647176504135132
Epoch: 1, Steps: 208 | Train Loss: 3.952 Vali Loss: 4.010 Vali Acc: 0.054 Test Loss: 4.010 Test Acc: 0.054
Validation loss decreased (inf --> -0.053643).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4382062
	speed: 0.2738s/iter; left time: 5611.8510s
	iters: 200, epoch: 2 | loss: 3.2549210
	speed: 0.0392s/iter; left time: 799.9160s
Epoch: 2 cost time: 9.087613821029663
Epoch: 2, Steps: 208 | Train Loss: 3.650 Vali Loss: 4.043 Vali Acc: 0.078 Test Loss: 4.043 Test Acc: 0.078
Validation loss decreased (-0.053643 --> -0.077502).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5169230
	speed: 0.2702s/iter; left time: 5481.4017s
	iters: 200, epoch: 3 | loss: 2.8874729
	speed: 0.0423s/iter; left time: 854.1495s
Epoch: 3 cost time: 9.890904664993286
Epoch: 3, Steps: 208 | Train Loss: 3.295 Vali Loss: 4.101 Vali Acc: 0.087 Test Loss: 4.101 Test Acc: 0.087
Validation loss decreased (-0.077502 --> -0.087045).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0212440
	speed: 0.2352s/iter; left time: 4722.2382s
	iters: 200, epoch: 4 | loss: 3.3474689
	speed: 0.0393s/iter; left time: 785.9407s
Epoch: 4 cost time: 9.176567554473877
Epoch: 4, Steps: 208 | Train Loss: 3.043 Vali Loss: 4.485 Vali Acc: 0.084 Test Loss: 4.485 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.7752442
	speed: 0.2485s/iter; left time: 4937.1812s
	iters: 200, epoch: 5 | loss: 2.7872298
	speed: 0.0374s/iter; left time: 738.5449s
Epoch: 5 cost time: 9.406613111495972
Epoch: 5, Steps: 208 | Train Loss: 2.850 Vali Loss: 4.604 Vali Acc: 0.096 Test Loss: 4.604 Test Acc: 0.096
Validation loss decreased (-0.087045 --> -0.095689).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5935585
	speed: 0.2603s/iter; left time: 5118.3834s
	iters: 200, epoch: 6 | loss: 3.6413124
	speed: 0.0347s/iter; left time: 678.7535s
Epoch: 6 cost time: 8.273425817489624
Epoch: 6, Steps: 208 | Train Loss: 2.643 Vali Loss: 4.626 Vali Acc: 0.093 Test Loss: 4.626 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6724916
	speed: 0.2676s/iter; left time: 5205.3501s
	iters: 200, epoch: 7 | loss: 2.9981506
	speed: 0.0417s/iter; left time: 806.6134s
Epoch: 7 cost time: 10.339894533157349
Epoch: 7, Steps: 208 | Train Loss: 2.438 Vali Loss: 4.685 Vali Acc: 0.104 Test Loss: 4.685 Test Acc: 0.104
Validation loss decreased (-0.095689 --> -0.104039).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3961120
	speed: 0.2445s/iter; left time: 4706.3057s
	iters: 200, epoch: 8 | loss: 2.7709880
	speed: 0.0479s/iter; left time: 917.5269s
Epoch: 8 cost time: 9.561380863189697
Epoch: 8, Steps: 208 | Train Loss: 2.253 Vali Loss: 4.683 Vali Acc: 0.109 Test Loss: 4.683 Test Acc: 0.109
Validation loss decreased (-0.104039 --> -0.108513).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1711075
	speed: 0.2772s/iter; left time: 5277.2912s
	iters: 200, epoch: 9 | loss: 2.9424074
	speed: 0.0407s/iter; left time: 771.3717s
Epoch: 9 cost time: 9.863640308380127
Epoch: 9, Steps: 208 | Train Loss: 2.064 Vali Loss: 4.966 Vali Acc: 0.111 Test Loss: 4.966 Test Acc: 0.111
Validation loss decreased (-0.108513 --> -0.111194).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9257525
	speed: 0.3035s/iter; left time: 5714.1569s
	iters: 200, epoch: 10 | loss: 2.1581807
	speed: 0.0446s/iter; left time: 835.5792s
Epoch: 10 cost time: 9.673862218856812
Epoch: 10, Steps: 208 | Train Loss: 1.879 Vali Loss: 5.037 Vali Acc: 0.112 Test Loss: 5.037 Test Acc: 0.112
Validation loss decreased (-0.111194 --> -0.112088).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8167575
	speed: 0.2815s/iter; left time: 5242.3011s
	iters: 200, epoch: 11 | loss: 2.3397217
	speed: 0.0428s/iter; left time: 791.8338s
Epoch: 11 cost time: 9.572391271591187
Epoch: 11, Steps: 208 | Train Loss: 1.681 Vali Loss: 5.519 Vali Acc: 0.102 Test Loss: 5.519 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3130248
	speed: 0.2876s/iter; left time: 5295.7601s
	iters: 200, epoch: 12 | loss: 1.8335044
	speed: 0.0404s/iter; left time: 739.0719s
Epoch: 12 cost time: 9.712705612182617
Epoch: 12, Steps: 208 | Train Loss: 1.521 Vali Loss: 5.566 Vali Acc: 0.106 Test Loss: 5.566 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9362484
	speed: 0.2745s/iter; left time: 4997.3571s
	iters: 200, epoch: 13 | loss: 2.1324234
	speed: 0.0341s/iter; left time: 616.9473s
Epoch: 13 cost time: 9.173164367675781
Epoch: 13, Steps: 208 | Train Loss: 1.350 Vali Loss: 5.771 Vali Acc: 0.104 Test Loss: 5.771 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7487479
	speed: 0.2830s/iter; left time: 5093.2281s
	iters: 200, epoch: 14 | loss: 1.7806431
	speed: 0.0493s/iter; left time: 882.7486s
Epoch: 14 cost time: 12.100743055343628
Epoch: 14, Steps: 208 | Train Loss: 1.217 Vali Loss: 6.059 Vali Acc: 0.110 Test Loss: 6.059 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7391287
	speed: 0.2662s/iter; left time: 4735.2559s
	iters: 200, epoch: 15 | loss: 1.2123655
	speed: 0.0462s/iter; left time: 817.9803s
Epoch: 15 cost time: 10.138279914855957
Epoch: 15, Steps: 208 | Train Loss: 1.055 Vali Loss: 6.518 Vali Acc: 0.108 Test Loss: 6.518 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0068729
	speed: 0.2652s/iter; left time: 4661.9180s
	iters: 200, epoch: 16 | loss: 1.1071539
	speed: 0.0423s/iter; left time: 739.6510s
Epoch: 16 cost time: 9.34143328666687
Epoch: 16, Steps: 208 | Train Loss: 0.940 Vali Loss: 6.873 Vali Acc: 0.105 Test Loss: 6.873 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6207480
	speed: 0.2698s/iter; left time: 4687.2388s
	iters: 200, epoch: 17 | loss: 0.8775143
	speed: 0.0335s/iter; left time: 579.0042s
Epoch: 17 cost time: 7.9675233364105225
Epoch: 17, Steps: 208 | Train Loss: 0.835 Vali Loss: 7.337 Vali Acc: 0.109 Test Loss: 7.337 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.2978160
	speed: 0.2823s/iter; left time: 4845.9449s
	iters: 200, epoch: 18 | loss: 1.4557155
	speed: 0.0274s/iter; left time: 468.3680s
Epoch: 18 cost time: 8.828569173812866
Epoch: 18, Steps: 208 | Train Loss: 0.770 Vali Loss: 7.584 Vali Acc: 0.107 Test Loss: 7.584 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.4447906
	speed: 0.2602s/iter; left time: 4412.4949s
	iters: 200, epoch: 19 | loss: 1.0750849
	speed: 0.0332s/iter; left time: 558.9042s
Epoch: 19 cost time: 7.744216680526733
Epoch: 19, Steps: 208 | Train Loss: 0.690 Vali Loss: 7.914 Vali Acc: 0.112 Test Loss: 7.914 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.2837423
	speed: 0.2520s/iter; left time: 4220.7934s
	iters: 200, epoch: 20 | loss: 0.6229061
	speed: 0.0313s/iter; left time: 521.3478s
Epoch: 20 cost time: 8.497321844100952
Epoch: 20, Steps: 208 | Train Loss: 0.606 Vali Loss: 8.284 Vali Acc: 0.108 Test Loss: 8.284 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11213838353713093
model parameter : 351143
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7920775
	speed: 0.0852s/iter; left time: 1764.5741s
	iters: 200, epoch: 1 | loss: 4.1103106
	speed: 0.0417s/iter; left time: 858.3085s
Epoch: 1 cost time: 13.119843006134033
Epoch: 1, Steps: 208 | Train Loss: 3.887 Vali Loss: 4.040 Vali Acc: 0.058 Test Loss: 4.040 Test Acc: 0.058
Validation loss decreased (inf --> -0.057818).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2751853
	speed: 0.2623s/iter; left time: 5374.9038s
	iters: 200, epoch: 2 | loss: 3.5613065
	speed: 0.0437s/iter; left time: 891.9982s
Epoch: 2 cost time: 9.473783254623413
Epoch: 2, Steps: 208 | Train Loss: 3.605 Vali Loss: 4.087 Vali Acc: 0.072 Test Loss: 4.087 Test Acc: 0.072
Validation loss decreased (-0.057818 --> -0.071537).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8887396
	speed: 0.2773s/iter; left time: 5625.4245s
	iters: 200, epoch: 3 | loss: 3.4713373
	speed: 0.0377s/iter; left time: 761.4023s
Epoch: 3 cost time: 8.889808177947998
Epoch: 3, Steps: 208 | Train Loss: 3.297 Vali Loss: 4.000 Vali Acc: 0.084 Test Loss: 4.000 Test Acc: 0.084
Validation loss decreased (-0.071537 --> -0.084362).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3043969
	speed: 0.2876s/iter; left time: 5775.0265s
	iters: 200, epoch: 4 | loss: 3.6879404
	speed: 0.0432s/iter; left time: 863.3617s
Epoch: 4 cost time: 9.92798900604248
Epoch: 4, Steps: 208 | Train Loss: 3.090 Vali Loss: 4.239 Vali Acc: 0.081 Test Loss: 4.239 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8471897
	speed: 0.2848s/iter; left time: 5659.2373s
	iters: 200, epoch: 5 | loss: 2.8942060
	speed: 0.0322s/iter; left time: 636.3663s
Epoch: 5 cost time: 7.7440454959869385
Epoch: 5, Steps: 208 | Train Loss: 2.902 Vali Loss: 4.229 Vali Acc: 0.098 Test Loss: 4.229 Test Acc: 0.098
Validation loss decreased (-0.084362 --> -0.098079).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9078755
	speed: 0.2635s/iter; left time: 5181.4723s
	iters: 200, epoch: 6 | loss: 3.6867917
	speed: 0.0338s/iter; left time: 662.0486s
Epoch: 6 cost time: 8.589110374450684
Epoch: 6, Steps: 208 | Train Loss: 2.722 Vali Loss: 4.278 Vali Acc: 0.103 Test Loss: 4.278 Test Acc: 0.103
Validation loss decreased (-0.098079 --> -0.102850).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7559087
	speed: 0.2506s/iter; left time: 4875.0801s
	iters: 200, epoch: 7 | loss: 3.2591319
	speed: 0.0366s/iter; left time: 708.3077s
Epoch: 7 cost time: 9.017637491226196
Epoch: 7, Steps: 208 | Train Loss: 2.568 Vali Loss: 4.419 Vali Acc: 0.101 Test Loss: 4.419 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.2797756
	speed: 0.2572s/iter; left time: 4950.4449s
	iters: 200, epoch: 8 | loss: 2.7392747
	speed: 0.0397s/iter; left time: 759.8363s
Epoch: 8 cost time: 8.050393342971802
Epoch: 8, Steps: 208 | Train Loss: 2.435 Vali Loss: 4.430 Vali Acc: 0.106 Test Loss: 4.430 Test Acc: 0.106
Validation loss decreased (-0.102850 --> -0.105831).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6814389
	speed: 0.2771s/iter; left time: 5275.8787s
	iters: 200, epoch: 9 | loss: 2.8706005
	speed: 0.0303s/iter; left time: 573.5715s
Epoch: 9 cost time: 8.257909536361694
Epoch: 9, Steps: 208 | Train Loss: 2.218 Vali Loss: 4.542 Vali Acc: 0.109 Test Loss: 4.542 Test Acc: 0.109
Validation loss decreased (-0.105831 --> -0.109111).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8161367
	speed: 0.2759s/iter; left time: 5194.8418s
	iters: 200, epoch: 10 | loss: 2.2639410
	speed: 0.0368s/iter; left time: 688.8798s
Epoch: 10 cost time: 9.174853324890137
Epoch: 10, Steps: 208 | Train Loss: 2.024 Vali Loss: 4.733 Vali Acc: 0.109 Test Loss: 4.733 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.0224743
	speed: 0.2701s/iter; left time: 5028.9031s
	iters: 200, epoch: 11 | loss: 2.2639790
	speed: 0.0421s/iter; left time: 780.3408s
Epoch: 11 cost time: 10.01582145690918
Epoch: 11, Steps: 208 | Train Loss: 1.884 Vali Loss: 4.801 Vali Acc: 0.112 Test Loss: 4.801 Test Acc: 0.112
Validation loss decreased (-0.109111 --> -0.111494).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0604401
	speed: 0.2760s/iter; left time: 5082.0246s
	iters: 200, epoch: 12 | loss: 2.4270053
	speed: 0.0456s/iter; left time: 835.7740s
Epoch: 12 cost time: 10.147867918014526
Epoch: 12, Steps: 208 | Train Loss: 1.707 Vali Loss: 5.109 Vali Acc: 0.115 Test Loss: 5.109 Test Acc: 0.115
Validation loss decreased (-0.111494 --> -0.115070).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2837986
	speed: 0.2713s/iter; left time: 4939.3983s
	iters: 200, epoch: 13 | loss: 2.2501583
	speed: 0.0383s/iter; left time: 694.2122s
Epoch: 13 cost time: 9.030253171920776
Epoch: 13, Steps: 208 | Train Loss: 1.573 Vali Loss: 5.340 Vali Acc: 0.112 Test Loss: 5.340 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5468937
	speed: 0.2825s/iter; left time: 5083.9069s
	iters: 200, epoch: 14 | loss: 1.2132295
	speed: 0.0447s/iter; left time: 799.3141s
Epoch: 14 cost time: 10.563007831573486
Epoch: 14, Steps: 208 | Train Loss: 1.386 Vali Loss: 5.626 Vali Acc: 0.108 Test Loss: 5.626 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5258843
	speed: 0.2613s/iter; left time: 4648.8588s
	iters: 200, epoch: 15 | loss: 1.6384270
	speed: 0.0382s/iter; left time: 676.3330s
Epoch: 15 cost time: 8.178265571594238
Epoch: 15, Steps: 208 | Train Loss: 1.290 Vali Loss: 5.745 Vali Acc: 0.112 Test Loss: 5.745 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0725753
	speed: 0.2544s/iter; left time: 4472.5315s
	iters: 200, epoch: 16 | loss: 1.3147388
	speed: 0.0295s/iter; left time: 515.3471s
Epoch: 16 cost time: 7.9283459186553955
Epoch: 16, Steps: 208 | Train Loss: 1.183 Vali Loss: 6.166 Vali Acc: 0.112 Test Loss: 6.166 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.1559452
	speed: 0.2291s/iter; left time: 3980.2857s
	iters: 200, epoch: 17 | loss: 1.1625419
	speed: 0.0333s/iter; left time: 574.3908s
Epoch: 17 cost time: 7.829402446746826
Epoch: 17, Steps: 208 | Train Loss: 1.077 Vali Loss: 6.459 Vali Acc: 0.109 Test Loss: 6.459 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.4658496
	speed: 0.2369s/iter; left time: 4066.3198s
	iters: 200, epoch: 18 | loss: 1.0327343
	speed: 0.0351s/iter; left time: 598.9749s
Epoch: 18 cost time: 8.71573281288147
Epoch: 18, Steps: 208 | Train Loss: 0.999 Vali Loss: 6.801 Vali Acc: 0.109 Test Loss: 6.801 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.7935290
	speed: 0.2435s/iter; left time: 4129.4217s
	iters: 200, epoch: 19 | loss: 0.9672651
	speed: 0.0331s/iter; left time: 558.2598s
Epoch: 19 cost time: 8.571176528930664
Epoch: 19, Steps: 208 | Train Loss: 0.891 Vali Loss: 6.922 Vali Acc: 0.106 Test Loss: 6.922 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.8694082
	speed: 0.2491s/iter; left time: 4172.8977s
	iters: 200, epoch: 20 | loss: 0.4509146
	speed: 0.0332s/iter; left time: 552.4188s
Epoch: 20 cost time: 7.8691864013671875
Epoch: 20, Steps: 208 | Train Loss: 0.789 Vali Loss: 7.551 Vali Acc: 0.103 Test Loss: 7.551 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.7991874
	speed: 0.2741s/iter; left time: 4534.0934s
	iters: 200, epoch: 21 | loss: 0.9153362
	speed: 0.0384s/iter; left time: 631.9399s
Epoch: 21 cost time: 8.850244522094727
Epoch: 21, Steps: 208 | Train Loss: 0.745 Vali Loss: 7.504 Vali Acc: 0.107 Test Loss: 7.504 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.3818676
	speed: 0.2710s/iter; left time: 4426.4086s
	iters: 200, epoch: 22 | loss: 0.7966835
	speed: 0.0391s/iter; left time: 634.3172s
Epoch: 22 cost time: 9.007022380828857
Epoch: 22, Steps: 208 | Train Loss: 0.674 Vali Loss: 8.082 Vali Acc: 0.109 Test Loss: 8.082 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11512078735460782
model parameter : 282663
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6586084
	speed: 0.0732s/iter; left time: 1515.7357s
	iters: 200, epoch: 1 | loss: 4.1958752
	speed: 0.0331s/iter; left time: 682.8345s
Epoch: 1 cost time: 11.077432632446289
Epoch: 1, Steps: 208 | Train Loss: 3.807 Vali Loss: 3.860 Vali Acc: 0.052 Test Loss: 3.860 Test Acc: 0.052
Validation loss decreased (inf --> -0.051557).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3316512
	speed: 0.2562s/iter; left time: 5249.9512s
	iters: 200, epoch: 2 | loss: 2.9232936
	speed: 0.0366s/iter; left time: 746.3111s
Epoch: 2 cost time: 8.866621017456055
Epoch: 2, Steps: 208 | Train Loss: 3.627 Vali Loss: 3.836 Vali Acc: 0.063 Test Loss: 3.836 Test Acc: 0.063
Validation loss decreased (-0.051557 --> -0.062890).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9872890
	speed: 0.2699s/iter; left time: 5475.2368s
	iters: 200, epoch: 3 | loss: 3.0325437
	speed: 0.0391s/iter; left time: 790.0969s
Epoch: 3 cost time: 9.679393529891968
Epoch: 3, Steps: 208 | Train Loss: 3.304 Vali Loss: 3.872 Vali Acc: 0.080 Test Loss: 3.872 Test Acc: 0.080
Validation loss decreased (-0.062890 --> -0.079890).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9122884
	speed: 0.2141s/iter; left time: 4298.2979s
	iters: 200, epoch: 4 | loss: 3.2078052
	speed: 0.0330s/iter; left time: 658.5445s
Epoch: 4 cost time: 6.833268404006958
Epoch: 4, Steps: 208 | Train Loss: 3.082 Vali Loss: 4.002 Vali Acc: 0.077 Test Loss: 4.002 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3297174
	speed: 0.2361s/iter; left time: 4690.6540s
	iters: 200, epoch: 5 | loss: 2.9277697
	speed: 0.0330s/iter; left time: 653.1307s
Epoch: 5 cost time: 8.038828372955322
Epoch: 5, Steps: 208 | Train Loss: 2.932 Vali Loss: 4.251 Vali Acc: 0.078 Test Loss: 4.251 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.0072021
	speed: 0.2376s/iter; left time: 4672.0994s
	iters: 200, epoch: 6 | loss: 2.6971920
	speed: 0.0342s/iter; left time: 669.9487s
Epoch: 6 cost time: 8.250866413116455
Epoch: 6, Steps: 208 | Train Loss: 2.813 Vali Loss: 4.078 Vali Acc: 0.089 Test Loss: 4.078 Test Acc: 0.089
Validation loss decreased (-0.079890 --> -0.089133).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8780248
	speed: 0.2424s/iter; left time: 4714.5167s
	iters: 200, epoch: 7 | loss: 3.8087733
	speed: 0.0386s/iter; left time: 747.3486s
Epoch: 7 cost time: 9.300504922866821
Epoch: 7, Steps: 208 | Train Loss: 2.647 Vali Loss: 4.296 Vali Acc: 0.101 Test Loss: 4.296 Test Acc: 0.101
Validation loss decreased (-0.089133 --> -0.101061).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5796046
	speed: 0.2714s/iter; left time: 5223.2050s
	iters: 200, epoch: 8 | loss: 2.4069569
	speed: 0.0352s/iter; left time: 673.7640s
Epoch: 8 cost time: 8.094507694244385
Epoch: 8, Steps: 208 | Train Loss: 2.507 Vali Loss: 4.260 Vali Acc: 0.095 Test Loss: 4.260 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1924629
	speed: 0.2827s/iter; left time: 5382.3539s
	iters: 200, epoch: 9 | loss: 2.4402721
	speed: 0.0330s/iter; left time: 624.6965s
Epoch: 9 cost time: 8.501187324523926
Epoch: 9, Steps: 208 | Train Loss: 2.342 Vali Loss: 4.392 Vali Acc: 0.101 Test Loss: 4.392 Test Acc: 0.101
Validation loss decreased (-0.101061 --> -0.101358).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5425187
	speed: 0.2928s/iter; left time: 5513.7337s
	iters: 200, epoch: 10 | loss: 2.2754617
	speed: 0.0401s/iter; left time: 751.3761s
Epoch: 10 cost time: 10.338726043701172
Epoch: 10, Steps: 208 | Train Loss: 2.176 Vali Loss: 4.515 Vali Acc: 0.105 Test Loss: 4.515 Test Acc: 0.105
Validation loss decreased (-0.101358 --> -0.105234).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5076072
	speed: 0.2869s/iter; left time: 5341.5134s
	iters: 200, epoch: 11 | loss: 1.8568798
	speed: 0.0408s/iter; left time: 755.0200s
Epoch: 11 cost time: 10.890813827514648
Epoch: 11, Steps: 208 | Train Loss: 2.063 Vali Loss: 4.713 Vali Acc: 0.102 Test Loss: 4.713 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2000880
	speed: 0.2766s/iter; left time: 5092.3226s
	iters: 200, epoch: 12 | loss: 2.3145423
	speed: 0.0428s/iter; left time: 783.1425s
Epoch: 12 cost time: 10.155079364776611
Epoch: 12, Steps: 208 | Train Loss: 1.896 Vali Loss: 4.858 Vali Acc: 0.106 Test Loss: 4.858 Test Acc: 0.106
Validation loss decreased (-0.105234 --> -0.105827).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1492910
	speed: 0.2559s/iter; left time: 4658.0744s
	iters: 200, epoch: 13 | loss: 2.1585140
	speed: 0.0370s/iter; left time: 670.0029s
Epoch: 13 cost time: 9.217459440231323
Epoch: 13, Steps: 208 | Train Loss: 1.769 Vali Loss: 5.026 Vali Acc: 0.105 Test Loss: 5.026 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3526663
	speed: 0.2620s/iter; left time: 4715.4248s
	iters: 200, epoch: 14 | loss: 1.6758423
	speed: 0.0318s/iter; left time: 569.3811s
Epoch: 14 cost time: 8.18626856803894
Epoch: 14, Steps: 208 | Train Loss: 1.660 Vali Loss: 5.389 Vali Acc: 0.112 Test Loss: 5.389 Test Acc: 0.112
Validation loss decreased (-0.105827 --> -0.112383).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9463301
	speed: 0.2491s/iter; left time: 4432.0874s
	iters: 200, epoch: 15 | loss: 3.0358353
	speed: 0.0320s/iter; left time: 565.9682s
Epoch: 15 cost time: 8.115351676940918
Epoch: 15, Steps: 208 | Train Loss: 1.538 Vali Loss: 5.539 Vali Acc: 0.108 Test Loss: 5.539 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.7865559
	speed: 0.2604s/iter; left time: 4577.3617s
	iters: 200, epoch: 16 | loss: 2.1938152
	speed: 0.0414s/iter; left time: 722.8806s
Epoch: 16 cost time: 10.143155336380005
Epoch: 16, Steps: 208 | Train Loss: 1.423 Vali Loss: 5.824 Vali Acc: 0.106 Test Loss: 5.824 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9014544
	speed: 0.2538s/iter; left time: 4408.8264s
	iters: 200, epoch: 17 | loss: 2.2068398
	speed: 0.0362s/iter; left time: 625.4593s
Epoch: 17 cost time: 8.974032402038574
Epoch: 17, Steps: 208 | Train Loss: 1.306 Vali Loss: 5.983 Vali Acc: 0.104 Test Loss: 5.983 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2194362
	speed: 0.2595s/iter; left time: 4454.7380s
	iters: 200, epoch: 18 | loss: 2.1418245
	speed: 0.0397s/iter; left time: 677.2903s
Epoch: 18 cost time: 8.958070516586304
Epoch: 18, Steps: 208 | Train Loss: 1.234 Vali Loss: 6.252 Vali Acc: 0.103 Test Loss: 6.252 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.9412387
	speed: 0.2744s/iter; left time: 4652.6777s
	iters: 200, epoch: 19 | loss: 2.1228681
	speed: 0.0397s/iter; left time: 668.7730s
Epoch: 19 cost time: 9.474410772323608
Epoch: 19, Steps: 208 | Train Loss: 1.104 Vali Loss: 6.511 Vali Acc: 0.107 Test Loss: 6.511 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.1759075
	speed: 0.2744s/iter; left time: 4596.2401s
	iters: 200, epoch: 20 | loss: 1.1218611
	speed: 0.0331s/iter; left time: 551.2173s
Epoch: 20 cost time: 8.575464487075806
Epoch: 20, Steps: 208 | Train Loss: 1.059 Vali Loss: 6.860 Vali Acc: 0.106 Test Loss: 6.860 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6240121
	speed: 0.2640s/iter; left time: 4366.9046s
	iters: 200, epoch: 21 | loss: 0.4913015
	speed: 0.0335s/iter; left time: 549.9919s
Epoch: 21 cost time: 9.107076406478882
Epoch: 21, Steps: 208 | Train Loss: 0.968 Vali Loss: 7.048 Vali Acc: 0.099 Test Loss: 7.048 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.3228494
	speed: 0.2658s/iter; left time: 4341.5158s
	iters: 200, epoch: 22 | loss: 0.9457269
	speed: 0.0357s/iter; left time: 579.3300s
Epoch: 22 cost time: 9.474057674407959
Epoch: 22, Steps: 208 | Train Loss: 0.908 Vali Loss: 7.298 Vali Acc: 0.103 Test Loss: 7.298 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.8273201
	speed: 0.2575s/iter; left time: 4151.9592s
	iters: 200, epoch: 23 | loss: 1.0249422
	speed: 0.0415s/iter; left time: 665.4584s
Epoch: 23 cost time: 8.944050788879395
Epoch: 23, Steps: 208 | Train Loss: 0.830 Vali Loss: 7.756 Vali Acc: 0.099 Test Loss: 7.756 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.5477205
	speed: 0.2418s/iter; left time: 3849.0773s
	iters: 200, epoch: 24 | loss: 1.0873135
	speed: 0.0361s/iter; left time: 570.2154s
Epoch: 24 cost time: 8.571042537689209
Epoch: 24, Steps: 208 | Train Loss: 0.772 Vali Loss: 8.152 Vali Acc: 0.105 Test Loss: 8.152 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11243662391887861
model parameter : 186919
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7085605
	speed: 0.0849s/iter; left time: 1758.0453s
	iters: 200, epoch: 1 | loss: 3.9539418
	speed: 0.0380s/iter; left time: 782.8493s
Epoch: 1 cost time: 12.804866313934326
Epoch: 1, Steps: 208 | Train Loss: 3.773 Vali Loss: 3.762 Vali Acc: 0.056 Test Loss: 3.762 Test Acc: 0.056
Validation loss decreased (inf --> -0.056032).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8781924
	speed: 0.2370s/iter; left time: 4857.5316s
	iters: 200, epoch: 2 | loss: 4.0759554
	speed: 0.0339s/iter; left time: 690.7211s
Epoch: 2 cost time: 8.96729826927185
Epoch: 2, Steps: 208 | Train Loss: 3.559 Vali Loss: 3.820 Vali Acc: 0.064 Test Loss: 3.820 Test Acc: 0.064
Validation loss decreased (-0.056032 --> -0.064083).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2731535
	speed: 0.2550s/iter; left time: 5173.1047s
	iters: 200, epoch: 3 | loss: 3.0718267
	speed: 0.0390s/iter; left time: 787.4782s
Epoch: 3 cost time: 8.606087923049927
Epoch: 3, Steps: 208 | Train Loss: 3.300 Vali Loss: 3.905 Vali Acc: 0.077 Test Loss: 3.905 Test Acc: 0.077
Validation loss decreased (-0.064083 --> -0.076609).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0312254
	speed: 0.2635s/iter; left time: 5290.9681s
	iters: 200, epoch: 4 | loss: 3.5509002
	speed: 0.0382s/iter; left time: 763.1517s
Epoch: 4 cost time: 8.595518589019775
Epoch: 4, Steps: 208 | Train Loss: 3.125 Vali Loss: 3.886 Vali Acc: 0.081 Test Loss: 3.886 Test Acc: 0.081
Validation loss decreased (-0.076609 --> -0.081083).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4994888
	speed: 0.2634s/iter; left time: 5233.5263s
	iters: 200, epoch: 5 | loss: 3.0793872
	speed: 0.0398s/iter; left time: 787.6002s
Epoch: 5 cost time: 9.041808128356934
Epoch: 5, Steps: 208 | Train Loss: 2.996 Vali Loss: 3.927 Vali Acc: 0.090 Test Loss: 3.927 Test Acc: 0.090
Validation loss decreased (-0.081083 --> -0.090328).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3488715
	speed: 0.2699s/iter; left time: 5305.7304s
	iters: 200, epoch: 6 | loss: 2.2943606
	speed: 0.0399s/iter; left time: 780.4483s
Epoch: 6 cost time: 9.39796757698059
Epoch: 6, Steps: 208 | Train Loss: 2.878 Vali Loss: 3.977 Vali Acc: 0.095 Test Loss: 3.977 Test Acc: 0.095
Validation loss decreased (-0.090328 --> -0.094502).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8516142
	speed: 0.2856s/iter; left time: 5556.2153s
	iters: 200, epoch: 7 | loss: 2.9453726
	speed: 0.0401s/iter; left time: 776.7877s
Epoch: 7 cost time: 8.92289400100708
Epoch: 7, Steps: 208 | Train Loss: 2.770 Vali Loss: 4.131 Vali Acc: 0.088 Test Loss: 4.131 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0097640
	speed: 0.2786s/iter; left time: 5362.1831s
	iters: 200, epoch: 8 | loss: 2.8370504
	speed: 0.0343s/iter; left time: 656.4535s
Epoch: 8 cost time: 8.238717079162598
Epoch: 8, Steps: 208 | Train Loss: 2.663 Vali Loss: 4.167 Vali Acc: 0.095 Test Loss: 4.167 Test Acc: 0.095
Validation loss decreased (-0.094502 --> -0.095395).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5764513
	speed: 0.2680s/iter; left time: 5101.4966s
	iters: 200, epoch: 9 | loss: 2.9615853
	speed: 0.0374s/iter; left time: 708.7965s
Epoch: 9 cost time: 8.606753826141357
Epoch: 9, Steps: 208 | Train Loss: 2.518 Vali Loss: 4.323 Vali Acc: 0.092 Test Loss: 4.323 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4604752
	speed: 0.2770s/iter; left time: 5215.7633s
	iters: 200, epoch: 10 | loss: 2.5509970
	speed: 0.0372s/iter; left time: 697.0542s
Epoch: 10 cost time: 8.937031984329224
Epoch: 10, Steps: 208 | Train Loss: 2.417 Vali Loss: 4.385 Vali Acc: 0.098 Test Loss: 4.385 Test Acc: 0.098
Validation loss decreased (-0.095395 --> -0.097779).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4106593
	speed: 0.2658s/iter; left time: 4949.1905s
	iters: 200, epoch: 11 | loss: 2.1837859
	speed: 0.0377s/iter; left time: 698.8364s
Epoch: 11 cost time: 9.611796140670776
Epoch: 11, Steps: 208 | Train Loss: 2.294 Vali Loss: 4.362 Vali Acc: 0.103 Test Loss: 4.362 Test Acc: 0.103
Validation loss decreased (-0.097779 --> -0.102551).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7411356
	speed: 0.2604s/iter; left time: 4794.9305s
	iters: 200, epoch: 12 | loss: 2.0885000
	speed: 0.0446s/iter; left time: 815.9779s
Epoch: 12 cost time: 10.394815683364868
Epoch: 12, Steps: 208 | Train Loss: 2.153 Vali Loss: 4.477 Vali Acc: 0.102 Test Loss: 4.477 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.1074784
	speed: 0.2924s/iter; left time: 5322.6554s
	iters: 200, epoch: 13 | loss: 1.8362410
	speed: 0.0427s/iter; left time: 773.5910s
Epoch: 13 cost time: 10.055970907211304
Epoch: 13, Steps: 208 | Train Loss: 2.048 Vali Loss: 4.515 Vali Acc: 0.104 Test Loss: 4.515 Test Acc: 0.104
Validation loss decreased (-0.102551 --> -0.104041).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6240981
	speed: 0.2860s/iter; left time: 5146.5263s
	iters: 200, epoch: 14 | loss: 2.2868259
	speed: 0.0411s/iter; left time: 734.7300s
Epoch: 14 cost time: 9.523687362670898
Epoch: 14, Steps: 208 | Train Loss: 1.923 Vali Loss: 4.749 Vali Acc: 0.101 Test Loss: 4.749 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.5562232
	speed: 0.2604s/iter; left time: 4632.3210s
	iters: 200, epoch: 15 | loss: 1.8883090
	speed: 0.0407s/iter; left time: 719.8073s
Epoch: 15 cost time: 8.952329635620117
Epoch: 15, Steps: 208 | Train Loss: 1.806 Vali Loss: 4.925 Vali Acc: 0.109 Test Loss: 4.925 Test Acc: 0.109
Validation loss decreased (-0.104041 --> -0.109405).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3752801
	speed: 0.2615s/iter; left time: 4597.7263s
	iters: 200, epoch: 16 | loss: 1.6656680
	speed: 0.0371s/iter; left time: 647.8247s
Epoch: 16 cost time: 8.493171453475952
Epoch: 16, Steps: 208 | Train Loss: 1.685 Vali Loss: 5.133 Vali Acc: 0.102 Test Loss: 5.133 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5771940
	speed: 0.2546s/iter; left time: 4423.6684s
	iters: 200, epoch: 17 | loss: 2.0900631
	speed: 0.0317s/iter; left time: 546.9773s
Epoch: 17 cost time: 8.305946588516235
Epoch: 17, Steps: 208 | Train Loss: 1.558 Vali Loss: 5.293 Vali Acc: 0.106 Test Loss: 5.293 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4204717
	speed: 0.2624s/iter; left time: 4503.8189s
	iters: 200, epoch: 18 | loss: 1.3669271
	speed: 0.0343s/iter; left time: 584.7476s
Epoch: 18 cost time: 8.970763444900513
Epoch: 18, Steps: 208 | Train Loss: 1.481 Vali Loss: 5.516 Vali Acc: 0.104 Test Loss: 5.516 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.3945211
	speed: 0.2259s/iter; left time: 3830.0508s
	iters: 200, epoch: 19 | loss: 2.0931826
	speed: 0.0421s/iter; left time: 709.2929s
Epoch: 19 cost time: 8.945124626159668
Epoch: 19, Steps: 208 | Train Loss: 1.358 Vali Loss: 5.779 Vali Acc: 0.104 Test Loss: 5.779 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2074014
	speed: 0.2329s/iter; left time: 3901.4541s
	iters: 200, epoch: 20 | loss: 1.5934474
	speed: 0.0314s/iter; left time: 523.4976s
Epoch: 20 cost time: 8.107451677322388
Epoch: 20, Steps: 208 | Train Loss: 1.274 Vali Loss: 6.027 Vali Acc: 0.102 Test Loss: 6.027 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8685580
	speed: 0.2698s/iter; left time: 4462.2180s
	iters: 200, epoch: 21 | loss: 1.3781114
	speed: 0.0341s/iter; left time: 561.0020s
Epoch: 21 cost time: 9.073546648025513
Epoch: 21, Steps: 208 | Train Loss: 1.193 Vali Loss: 6.250 Vali Acc: 0.099 Test Loss: 6.250 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.1664426
	speed: 0.2631s/iter; left time: 4297.8156s
	iters: 200, epoch: 22 | loss: 1.1660323
	speed: 0.0341s/iter; left time: 553.1821s
Epoch: 22 cost time: 8.767482280731201
Epoch: 22, Steps: 208 | Train Loss: 1.106 Vali Loss: 6.471 Vali Acc: 0.103 Test Loss: 6.471 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.4603900
	speed: 0.2570s/iter; left time: 4143.9984s
	iters: 200, epoch: 23 | loss: 0.6978350
	speed: 0.0419s/iter; left time: 671.5417s
Epoch: 23 cost time: 10.025581121444702
Epoch: 23, Steps: 208 | Train Loss: 1.022 Vali Loss: 6.723 Vali Acc: 0.099 Test Loss: 6.723 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.6082897
	speed: 0.2659s/iter; left time: 4232.1165s
	iters: 200, epoch: 24 | loss: 2.2220838
	speed: 0.0437s/iter; left time: 691.5844s
Epoch: 24 cost time: 9.740116834640503
Epoch: 24, Steps: 208 | Train Loss: 0.954 Vali Loss: 7.019 Vali Acc: 0.103 Test Loss: 7.019 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.9414403
	speed: 0.2608s/iter; left time: 4096.3087s
	iters: 200, epoch: 25 | loss: 0.7735190
	speed: 0.0388s/iter; left time: 605.2266s
Epoch: 25 cost time: 8.80568265914917
Epoch: 25, Steps: 208 | Train Loss: 0.873 Vali Loss: 7.410 Vali Acc: 0.100 Test Loss: 7.410 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 146087
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8437257
	speed: 0.0822s/iter; left time: 1700.8576s
	iters: 200, epoch: 1 | loss: 3.5332680
	speed: 0.0401s/iter; left time: 825.9027s
Epoch: 1 cost time: 12.74706244468689
Epoch: 1, Steps: 208 | Train Loss: 3.756 Vali Loss: 3.757 Vali Acc: 0.052 Test Loss: 3.757 Test Acc: 0.052
Validation loss decreased (inf --> -0.052453).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5365465
	speed: 0.2715s/iter; left time: 5563.9964s
	iters: 200, epoch: 2 | loss: 3.7116895
	speed: 0.0368s/iter; left time: 750.7981s
Epoch: 2 cost time: 9.040613174438477
Epoch: 2, Steps: 208 | Train Loss: 3.614 Vali Loss: 3.832 Vali Acc: 0.057 Test Loss: 3.832 Test Acc: 0.057
Validation loss decreased (-0.052453 --> -0.057224).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8970556
	speed: 0.2641s/iter; left time: 5356.5526s
	iters: 200, epoch: 3 | loss: 3.5889022
	speed: 0.0389s/iter; left time: 785.6162s
Epoch: 3 cost time: 9.483003854751587
Epoch: 3, Steps: 208 | Train Loss: 3.420 Vali Loss: 3.865 Vali Acc: 0.064 Test Loss: 3.865 Test Acc: 0.064
Validation loss decreased (-0.057224 --> -0.064083).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1764197
	speed: 0.2591s/iter; left time: 5201.6617s
	iters: 200, epoch: 4 | loss: 3.2587669
	speed: 0.0353s/iter; left time: 705.6230s
Epoch: 4 cost time: 8.80764651298523
Epoch: 4, Steps: 208 | Train Loss: 3.208 Vali Loss: 3.894 Vali Acc: 0.069 Test Loss: 3.894 Test Acc: 0.069
Validation loss decreased (-0.064083 --> -0.069153).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9545243
	speed: 0.2714s/iter; left time: 5392.7930s
	iters: 200, epoch: 5 | loss: 3.7587333
	speed: 0.0382s/iter; left time: 755.3165s
Epoch: 5 cost time: 9.477113485336304
Epoch: 5, Steps: 208 | Train Loss: 3.079 Vali Loss: 3.959 Vali Acc: 0.081 Test Loss: 3.959 Test Acc: 0.081
Validation loss decreased (-0.069153 --> -0.081380).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3222508
	speed: 0.2770s/iter; left time: 5446.6837s
	iters: 200, epoch: 6 | loss: 3.2314591
	speed: 0.0349s/iter; left time: 682.3037s
Epoch: 6 cost time: 8.952821493148804
Epoch: 6, Steps: 208 | Train Loss: 2.922 Vali Loss: 3.937 Vali Acc: 0.085 Test Loss: 3.937 Test Acc: 0.085
Validation loss decreased (-0.081380 --> -0.085257).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1295650
	speed: 0.2629s/iter; left time: 5113.7864s
	iters: 200, epoch: 7 | loss: 2.8278515
	speed: 0.0396s/iter; left time: 766.7595s
Epoch: 7 cost time: 8.866480112075806
Epoch: 7, Steps: 208 | Train Loss: 2.799 Vali Loss: 4.055 Vali Acc: 0.091 Test Loss: 4.055 Test Acc: 0.091
Validation loss decreased (-0.085257 --> -0.091221).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7598078
	speed: 0.2488s/iter; left time: 4788.9378s
	iters: 200, epoch: 8 | loss: 3.0692105
	speed: 0.0364s/iter; left time: 696.0202s
Epoch: 8 cost time: 8.985762119293213
Epoch: 8, Steps: 208 | Train Loss: 2.670 Vali Loss: 4.173 Vali Acc: 0.089 Test Loss: 4.173 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.8918824
	speed: 0.2594s/iter; left time: 4938.8958s
	iters: 200, epoch: 9 | loss: 3.1149282
	speed: 0.0362s/iter; left time: 685.4947s
Epoch: 9 cost time: 8.76880145072937
Epoch: 9, Steps: 208 | Train Loss: 2.572 Vali Loss: 4.113 Vali Acc: 0.095 Test Loss: 4.113 Test Acc: 0.095
Validation loss decreased (-0.091221 --> -0.095098).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8798003
	speed: 0.2390s/iter; left time: 4500.8372s
	iters: 200, epoch: 10 | loss: 2.5694270
	speed: 0.0332s/iter; left time: 621.4644s
Epoch: 10 cost time: 7.896582126617432
Epoch: 10, Steps: 208 | Train Loss: 2.449 Vali Loss: 4.333 Vali Acc: 0.096 Test Loss: 4.333 Test Acc: 0.096
Validation loss decreased (-0.095098 --> -0.095990).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3737738
	speed: 0.2569s/iter; left time: 4784.5141s
	iters: 200, epoch: 11 | loss: 1.9855191
	speed: 0.0331s/iter; left time: 612.4011s
Epoch: 11 cost time: 7.9968602657318115
Epoch: 11, Steps: 208 | Train Loss: 2.302 Vali Loss: 4.430 Vali Acc: 0.096 Test Loss: 4.430 Test Acc: 0.096
Validation loss decreased (-0.095990 --> -0.096287).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.6705036
	speed: 0.2388s/iter; left time: 4397.4869s
	iters: 200, epoch: 12 | loss: 2.0004835
	speed: 0.0359s/iter; left time: 658.2128s
Epoch: 12 cost time: 8.305564880371094
Epoch: 12, Steps: 208 | Train Loss: 2.183 Vali Loss: 4.485 Vali Acc: 0.098 Test Loss: 4.485 Test Acc: 0.098
Validation loss decreased (-0.096287 --> -0.098076).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7995687
	speed: 0.2572s/iter; left time: 4683.1280s
	iters: 200, epoch: 13 | loss: 2.6918714
	speed: 0.0415s/iter; left time: 751.4132s
Epoch: 13 cost time: 9.965434312820435
Epoch: 13, Steps: 208 | Train Loss: 2.100 Vali Loss: 4.631 Vali Acc: 0.096 Test Loss: 4.631 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 3.2645149
	speed: 0.2369s/iter; left time: 4263.4854s
	iters: 200, epoch: 14 | loss: 2.4181499
	speed: 0.0329s/iter; left time: 588.4370s
Epoch: 14 cost time: 8.45057201385498
Epoch: 14, Steps: 208 | Train Loss: 1.967 Vali Loss: 4.772 Vali Acc: 0.095 Test Loss: 4.772 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.9125192
	speed: 0.2298s/iter; left time: 4087.7564s
	iters: 200, epoch: 15 | loss: 2.2045803
	speed: 0.0316s/iter; left time: 558.6279s
Epoch: 15 cost time: 7.462573528289795
Epoch: 15, Steps: 208 | Train Loss: 1.852 Vali Loss: 4.919 Vali Acc: 0.095 Test Loss: 4.919 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.6975483
	speed: 0.2190s/iter; left time: 3851.0732s
	iters: 200, epoch: 16 | loss: 1.3211783
	speed: 0.0327s/iter; left time: 572.1579s
Epoch: 16 cost time: 8.281787395477295
Epoch: 16, Steps: 208 | Train Loss: 1.727 Vali Loss: 5.122 Vali Acc: 0.108 Test Loss: 5.122 Test Acc: 0.108
Validation loss decreased (-0.098076 --> -0.107614).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.6896696
	speed: 0.2303s/iter; left time: 4001.8320s
	iters: 200, epoch: 17 | loss: 1.1643971
	speed: 0.0324s/iter; left time: 558.8548s
Epoch: 17 cost time: 7.9326536655426025
Epoch: 17, Steps: 208 | Train Loss: 1.650 Vali Loss: 5.277 Vali Acc: 0.096 Test Loss: 5.277 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.9549766
	speed: 0.2060s/iter; left time: 3535.8691s
	iters: 200, epoch: 18 | loss: 2.1943672
	speed: 0.0328s/iter; left time: 560.5229s
Epoch: 18 cost time: 7.591887712478638
Epoch: 18, Steps: 208 | Train Loss: 1.519 Vali Loss: 5.519 Vali Acc: 0.099 Test Loss: 5.519 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8603820
	speed: 0.2172s/iter; left time: 3682.4681s
	iters: 200, epoch: 19 | loss: 1.5710514
	speed: 0.0354s/iter; left time: 596.9659s
Epoch: 19 cost time: 8.227505922317505
Epoch: 19, Steps: 208 | Train Loss: 1.443 Vali Loss: 5.760 Vali Acc: 0.091 Test Loss: 5.760 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.3098960
	speed: 0.2386s/iter; left time: 3996.3312s
	iters: 200, epoch: 20 | loss: 0.9644722
	speed: 0.0353s/iter; left time: 588.0896s
Epoch: 20 cost time: 8.001699209213257
Epoch: 20, Steps: 208 | Train Loss: 1.338 Vali Loss: 5.931 Vali Acc: 0.098 Test Loss: 5.931 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.2641239
	speed: 0.2419s/iter; left time: 4000.9468s
	iters: 200, epoch: 21 | loss: 1.7603941
	speed: 0.0336s/iter; left time: 552.8946s
Epoch: 21 cost time: 8.279813051223755
Epoch: 21, Steps: 208 | Train Loss: 1.256 Vali Loss: 6.182 Vali Acc: 0.103 Test Loss: 6.182 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.0840508
	speed: 0.2233s/iter; left time: 3647.5551s
	iters: 200, epoch: 22 | loss: 1.8009142
	speed: 0.0253s/iter; left time: 410.6928s
Epoch: 22 cost time: 7.079586744308472
Epoch: 22, Steps: 208 | Train Loss: 1.161 Vali Loss: 6.380 Vali Acc: 0.101 Test Loss: 6.380 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.6716601
	speed: 0.2621s/iter; left time: 4226.1982s
	iters: 200, epoch: 23 | loss: 1.5092100
	speed: 0.0343s/iter; left time: 549.6848s
Epoch: 23 cost time: 9.253539800643921
Epoch: 23, Steps: 208 | Train Loss: 1.067 Vali Loss: 6.565 Vali Acc: 0.102 Test Loss: 6.565 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.1016344
	speed: 0.2537s/iter; left time: 4038.1773s
	iters: 200, epoch: 24 | loss: 1.0736266
	speed: 0.0365s/iter; left time: 577.8057s
Epoch: 24 cost time: 9.136837005615234
Epoch: 24, Steps: 208 | Train Loss: 1.004 Vali Loss: 6.826 Vali Acc: 0.102 Test Loss: 6.826 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.0687995
	speed: 0.2590s/iter; left time: 4067.9349s
	iters: 200, epoch: 25 | loss: 0.9040849
	speed: 0.0357s/iter; left time: 557.9458s
Epoch: 25 cost time: 8.811942338943481
Epoch: 25, Steps: 208 | Train Loss: 0.938 Vali Loss: 7.243 Vali Acc: 0.096 Test Loss: 7.243 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.9054142
	speed: 0.2776s/iter; left time: 4302.5512s
	iters: 200, epoch: 26 | loss: 1.0227661
	speed: 0.0372s/iter; left time: 572.7418s
Epoch: 26 cost time: 9.187788248062134
Epoch: 26, Steps: 208 | Train Loss: 0.906 Vali Loss: 7.547 Vali Acc: 0.106 Test Loss: 7.547 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1076647778109156
model parameter : 118983
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8808579
	speed: 0.0882s/iter; left time: 1825.2885s
	iters: 200, epoch: 1 | loss: 5.5053215
	speed: 0.0436s/iter; left time: 898.2579s
Epoch: 1 cost time: 13.658623456954956
Epoch: 1, Steps: 208 | Train Loss: 4.575 Vali Loss: 5.104 Vali Acc: 0.064 Test Loss: 5.104 Test Acc: 0.064
Validation loss decreased (inf --> -0.064369).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6646891
	speed: 0.3009s/iter; left time: 6165.3879s
	iters: 200, epoch: 2 | loss: 4.0131321
	speed: 0.0483s/iter; left time: 985.6126s
Epoch: 2 cost time: 11.159452199935913
Epoch: 2, Steps: 208 | Train Loss: 4.383 Vali Loss: 4.414 Vali Acc: 0.074 Test Loss: 4.414 Test Acc: 0.074
Validation loss decreased (-0.064369 --> -0.073621).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2579846
	speed: 0.3049s/iter; left time: 6185.3161s
	iters: 200, epoch: 3 | loss: 3.1907399
	speed: 0.0489s/iter; left time: 987.0239s
Epoch: 3 cost time: 10.724626064300537
Epoch: 3, Steps: 208 | Train Loss: 3.541 Vali Loss: 3.920 Vali Acc: 0.085 Test Loss: 3.920 Test Acc: 0.085
Validation loss decreased (-0.073621 --> -0.085258).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9615526
	speed: 0.2809s/iter; left time: 5639.0314s
	iters: 200, epoch: 4 | loss: 3.6909456
	speed: 0.0345s/iter; left time: 689.6949s
Epoch: 4 cost time: 8.40115237236023
Epoch: 4, Steps: 208 | Train Loss: 3.383 Vali Loss: 4.297 Vali Acc: 0.086 Test Loss: 4.297 Test Acc: 0.086
Validation loss decreased (-0.085258 --> -0.085850).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0916896
	speed: 0.2891s/iter; left time: 5743.2297s
	iters: 200, epoch: 5 | loss: 4.1483974
	speed: 0.0429s/iter; left time: 848.3257s
Epoch: 5 cost time: 10.300562620162964
Epoch: 5, Steps: 208 | Train Loss: 3.298 Vali Loss: 4.646 Vali Acc: 0.086 Test Loss: 4.646 Test Acc: 0.086
Validation loss decreased (-0.085850 --> -0.086443).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7067487
	speed: 0.2854s/iter; left time: 5611.5148s
	iters: 200, epoch: 6 | loss: 3.3877544
	speed: 0.0466s/iter; left time: 911.2844s
Epoch: 6 cost time: 10.83675742149353
Epoch: 6, Steps: 208 | Train Loss: 3.105 Vali Loss: 4.558 Vali Acc: 0.090 Test Loss: 4.558 Test Acc: 0.090
Validation loss decreased (-0.086443 --> -0.090023).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9799132
	speed: 0.2515s/iter; left time: 4892.5137s
	iters: 200, epoch: 7 | loss: 2.9821012
	speed: 0.0381s/iter; left time: 737.4944s
Epoch: 7 cost time: 9.344623565673828
Epoch: 7, Steps: 208 | Train Loss: 2.626 Vali Loss: 5.735 Vali Acc: 0.075 Test Loss: 5.735 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0285726
	speed: 0.2789s/iter; left time: 5366.9821s
	iters: 200, epoch: 8 | loss: 2.1182487
	speed: 0.0371s/iter; left time: 710.8493s
Epoch: 8 cost time: 9.595455646514893
Epoch: 8, Steps: 208 | Train Loss: 2.127 Vali Loss: 5.908 Vali Acc: 0.080 Test Loss: 5.908 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.8871880
	speed: 0.2703s/iter; left time: 5145.2582s
	iters: 200, epoch: 9 | loss: 2.0481372
	speed: 0.0417s/iter; left time: 790.4839s
Epoch: 9 cost time: 9.58630084991455
Epoch: 9, Steps: 208 | Train Loss: 1.839 Vali Loss: 5.783 Vali Acc: 0.088 Test Loss: 5.783 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5033425
	speed: 0.2782s/iter; left time: 5237.6252s
	iters: 200, epoch: 10 | loss: 2.6587079
	speed: 0.0379s/iter; left time: 709.5420s
Epoch: 10 cost time: 9.10868215560913
Epoch: 10, Steps: 208 | Train Loss: 1.688 Vali Loss: 6.243 Vali Acc: 0.090 Test Loss: 6.243 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5711728
	speed: 0.2612s/iter; left time: 4863.3696s
	iters: 200, epoch: 11 | loss: 2.5362322
	speed: 0.0337s/iter; left time: 624.3086s
Epoch: 11 cost time: 8.204346656799316
Epoch: 11, Steps: 208 | Train Loss: 1.479 Vali Loss: 5.599 Vali Acc: 0.100 Test Loss: 5.599 Test Acc: 0.100
Validation loss decreased (-0.090023 --> -0.099556).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6579230
	speed: 0.2639s/iter; left time: 4858.8202s
	iters: 200, epoch: 12 | loss: 2.1002517
	speed: 0.0339s/iter; left time: 621.2154s
Epoch: 12 cost time: 8.684982061386108
Epoch: 12, Steps: 208 | Train Loss: 1.348 Vali Loss: 5.564 Vali Acc: 0.111 Test Loss: 5.564 Test Acc: 0.111
Validation loss decreased (-0.099556 --> -0.110592).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7971030
	speed: 0.2617s/iter; left time: 4764.7119s
	iters: 200, epoch: 13 | loss: 1.1258917
	speed: 0.0347s/iter; left time: 627.5958s
Epoch: 13 cost time: 8.587459325790405
Epoch: 13, Steps: 208 | Train Loss: 1.157 Vali Loss: 6.202 Vali Acc: 0.102 Test Loss: 6.202 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5026702
	speed: 0.2533s/iter; left time: 4558.5646s
	iters: 200, epoch: 14 | loss: 1.0793250
	speed: 0.0356s/iter; left time: 636.5394s
Epoch: 14 cost time: 8.353242874145508
Epoch: 14, Steps: 208 | Train Loss: 0.996 Vali Loss: 6.562 Vali Acc: 0.107 Test Loss: 6.562 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7584431
	speed: 0.2703s/iter; left time: 4808.7221s
	iters: 200, epoch: 15 | loss: 1.0137773
	speed: 0.0395s/iter; left time: 699.3160s
Epoch: 15 cost time: 9.180939674377441
Epoch: 15, Steps: 208 | Train Loss: 0.858 Vali Loss: 7.387 Vali Acc: 0.109 Test Loss: 7.387 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2297605
	speed: 0.2790s/iter; left time: 4904.5592s
	iters: 200, epoch: 16 | loss: 0.9984928
	speed: 0.0412s/iter; left time: 719.6225s
Epoch: 16 cost time: 9.922664403915405
Epoch: 16, Steps: 208 | Train Loss: 0.711 Vali Loss: 8.306 Vali Acc: 0.109 Test Loss: 8.306 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7700211
	speed: 0.2592s/iter; left time: 4502.3961s
	iters: 200, epoch: 17 | loss: 1.9110112
	speed: 0.0442s/iter; left time: 763.1148s
Epoch: 17 cost time: 10.163486957550049
Epoch: 17, Steps: 208 | Train Loss: 0.595 Vali Loss: 9.072 Vali Acc: 0.108 Test Loss: 9.072 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3916253
	speed: 0.2759s/iter; left time: 4736.4142s
	iters: 200, epoch: 18 | loss: 0.4054690
	speed: 0.0357s/iter; left time: 608.6709s
Epoch: 18 cost time: 9.568209648132324
Epoch: 18, Steps: 208 | Train Loss: 0.517 Vali Loss: 9.045 Vali Acc: 0.113 Test Loss: 9.045 Test Acc: 0.113
Validation loss decreased (-0.110592 --> -0.112943).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6732290
	speed: 0.2819s/iter; left time: 4779.8226s
	iters: 200, epoch: 19 | loss: 0.2842865
	speed: 0.0432s/iter; left time: 728.0230s
Epoch: 19 cost time: 9.738997459411621
Epoch: 19, Steps: 208 | Train Loss: 0.450 Vali Loss: 9.372 Vali Acc: 0.107 Test Loss: 9.372 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1380610
	speed: 0.2749s/iter; left time: 4603.6228s
	iters: 200, epoch: 20 | loss: 0.7079253
	speed: 0.0503s/iter; left time: 837.3332s
Epoch: 20 cost time: 11.165377616882324
Epoch: 20, Steps: 208 | Train Loss: 0.386 Vali Loss: 10.027 Vali Acc: 0.106 Test Loss: 10.027 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1357798
	speed: 0.2701s/iter; left time: 4468.4239s
	iters: 200, epoch: 21 | loss: 0.1819326
	speed: 0.0359s/iter; left time: 590.1876s
Epoch: 21 cost time: 8.703219175338745
Epoch: 21, Steps: 208 | Train Loss: 0.324 Vali Loss: 11.197 Vali Acc: 0.098 Test Loss: 11.197 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.3138867
	speed: 0.2935s/iter; left time: 4793.3475s
	iters: 200, epoch: 22 | loss: 0.9882531
	speed: 0.0355s/iter; left time: 576.1458s
Epoch: 22 cost time: 9.934591054916382
Epoch: 22, Steps: 208 | Train Loss: 0.329 Vali Loss: 10.989 Vali Acc: 0.101 Test Loss: 10.989 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0267705
	speed: 0.2651s/iter; left time: 4275.3856s
	iters: 200, epoch: 23 | loss: 0.1917115
	speed: 0.0356s/iter; left time: 570.3827s
Epoch: 23 cost time: 9.144572496414185
Epoch: 23, Steps: 208 | Train Loss: 0.250 Vali Loss: 11.693 Vali Acc: 0.108 Test Loss: 11.693 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1770162
	speed: 0.2668s/iter; left time: 4246.1835s
	iters: 200, epoch: 24 | loss: 0.5423241
	speed: 0.0392s/iter; left time: 620.4889s
Epoch: 24 cost time: 9.900071382522583
Epoch: 24, Steps: 208 | Train Loss: 0.236 Vali Loss: 11.756 Vali Acc: 0.112 Test Loss: 11.756 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.8477642
	speed: 0.2625s/iter; left time: 4124.3113s
	iters: 200, epoch: 25 | loss: 0.1036785
	speed: 0.0486s/iter; left time: 758.4256s
Epoch: 25 cost time: 10.719711303710938
Epoch: 25, Steps: 208 | Train Loss: 0.265 Vali Loss: 12.424 Vali Acc: 0.106 Test Loss: 12.424 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0661871
	speed: 0.2879s/iter; left time: 4463.3253s
	iters: 200, epoch: 26 | loss: 0.2775639
	speed: 0.0382s/iter; left time: 588.6262s
Epoch: 26 cost time: 10.25157380104065
Epoch: 26, Steps: 208 | Train Loss: 0.208 Vali Loss: 12.631 Vali Acc: 0.109 Test Loss: 12.631 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1290405
	speed: 0.2862s/iter; left time: 4376.5492s
	iters: 200, epoch: 27 | loss: 1.1164150
	speed: 0.0506s/iter; left time: 768.8248s
Epoch: 27 cost time: 11.077385663986206
Epoch: 27, Steps: 208 | Train Loss: 0.228 Vali Loss: 12.840 Vali Acc: 0.116 Test Loss: 12.840 Test Acc: 0.116
Validation loss decreased (-0.112943 --> -0.116185).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0497987
	speed: 0.2920s/iter; left time: 4404.1503s
	iters: 200, epoch: 28 | loss: 0.4670223
	speed: 0.0415s/iter; left time: 622.5726s
Epoch: 28 cost time: 9.712045907974243
Epoch: 28, Steps: 208 | Train Loss: 0.213 Vali Loss: 13.619 Vali Acc: 0.109 Test Loss: 13.619 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.1465118
	speed: 0.2751s/iter; left time: 4092.3151s
	iters: 200, epoch: 29 | loss: 0.0149961
	speed: 0.0364s/iter; left time: 538.2289s
Epoch: 29 cost time: 9.34701418876648
Epoch: 29, Steps: 208 | Train Loss: 0.206 Vali Loss: 12.974 Vali Acc: 0.109 Test Loss: 12.974 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0516382
	speed: 0.2700s/iter; left time: 3960.1894s
	iters: 200, epoch: 30 | loss: 0.1601387
	speed: 0.0418s/iter; left time: 608.3951s
Epoch: 30 cost time: 9.405867099761963
Epoch: 30, Steps: 208 | Train Loss: 0.179 Vali Loss: 14.738 Vali Acc: 0.103 Test Loss: 14.738 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0275217
	speed: 0.2448s/iter; left time: 3540.4055s
	iters: 200, epoch: 31 | loss: 0.0126845
	speed: 0.0346s/iter; left time: 496.9810s
Epoch: 31 cost time: 8.523665189743042
Epoch: 31, Steps: 208 | Train Loss: 0.182 Vali Loss: 14.262 Vali Acc: 0.103 Test Loss: 14.262 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.2824197
	speed: 0.2572s/iter; left time: 3666.3158s
	iters: 200, epoch: 32 | loss: 0.3635973
	speed: 0.0357s/iter; left time: 505.0260s
Epoch: 32 cost time: 8.901954889297485
Epoch: 32, Steps: 208 | Train Loss: 0.173 Vali Loss: 14.474 Vali Acc: 0.100 Test Loss: 14.474 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.1177592
	speed: 0.2446s/iter; left time: 3435.8163s
	iters: 200, epoch: 33 | loss: 0.1781725
	speed: 0.0341s/iter; left time: 475.8782s
Epoch: 33 cost time: 8.340544939041138
Epoch: 33, Steps: 208 | Train Loss: 0.136 Vali Loss: 14.942 Vali Acc: 0.098 Test Loss: 14.942 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.2274032
	speed: 0.2866s/iter; left time: 3966.1417s
	iters: 200, epoch: 34 | loss: 0.0243066
	speed: 0.0330s/iter; left time: 453.0111s
Epoch: 34 cost time: 8.799197435379028
Epoch: 34, Steps: 208 | Train Loss: 0.147 Vali Loss: 15.071 Vali Acc: 0.097 Test Loss: 15.071 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.1146720
	speed: 0.2878s/iter; left time: 3923.0840s
	iters: 200, epoch: 35 | loss: 0.0994579
	speed: 0.0421s/iter; left time: 570.1436s
Epoch: 35 cost time: 10.164910793304443
Epoch: 35, Steps: 208 | Train Loss: 0.150 Vali Loss: 15.662 Vali Acc: 0.102 Test Loss: 15.662 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.1699006
	speed: 0.2718s/iter; left time: 3647.6077s
	iters: 200, epoch: 36 | loss: 0.0480865
	speed: 0.0459s/iter; left time: 611.6451s
Epoch: 36 cost time: 10.618527173995972
Epoch: 36, Steps: 208 | Train Loss: 0.135 Vali Loss: 15.704 Vali Acc: 0.110 Test Loss: 15.704 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0098727
	speed: 0.2846s/iter; left time: 3760.7052s
	iters: 200, epoch: 37 | loss: 0.1676163
	speed: 0.0502s/iter; left time: 658.1909s
Epoch: 37 cost time: 11.646021842956543
Epoch: 37, Steps: 208 | Train Loss: 0.135 Vali Loss: 15.660 Vali Acc: 0.102 Test Loss: 15.660 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11631374888159857
model parameter : 1001415
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7826991
	speed: 0.0774s/iter; left time: 1601.2729s
	iters: 200, epoch: 1 | loss: 3.8269417
	speed: 0.0357s/iter; left time: 734.7707s
Epoch: 1 cost time: 11.640860557556152
Epoch: 1, Steps: 208 | Train Loss: 4.079 Vali Loss: 4.316 Vali Acc: 0.057 Test Loss: 4.316 Test Acc: 0.057
Validation loss decreased (inf --> -0.056921).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4027975
	speed: 0.2633s/iter; left time: 5396.4584s
	iters: 200, epoch: 2 | loss: 3.7005630
	speed: 0.0349s/iter; left time: 712.3728s
Epoch: 2 cost time: 9.191465139389038
Epoch: 2, Steps: 208 | Train Loss: 3.839 Vali Loss: 4.306 Vali Acc: 0.082 Test Loss: 4.306 Test Acc: 0.082
Validation loss decreased (-0.056921 --> -0.082271).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6309547
	speed: 0.2613s/iter; left time: 5300.2716s
	iters: 200, epoch: 3 | loss: 3.3954086
	speed: 0.0357s/iter; left time: 719.9699s
Epoch: 3 cost time: 8.925035238265991
Epoch: 3, Steps: 208 | Train Loss: 3.433 Vali Loss: 4.437 Vali Acc: 0.072 Test Loss: 4.437 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6756511
	speed: 0.2539s/iter; left time: 5096.8333s
	iters: 200, epoch: 4 | loss: 3.6550932
	speed: 0.0441s/iter; left time: 880.1353s
Epoch: 4 cost time: 10.003732919692993
Epoch: 4, Steps: 208 | Train Loss: 3.147 Vali Loss: 4.312 Vali Acc: 0.076 Test Loss: 4.312 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.8815289
	speed: 0.2641s/iter; left time: 5247.6502s
	iters: 200, epoch: 5 | loss: 4.0782480
	speed: 0.0366s/iter; left time: 724.5333s
Epoch: 5 cost time: 8.949539184570312
Epoch: 5, Steps: 208 | Train Loss: 2.954 Vali Loss: 4.369 Vali Acc: 0.098 Test Loss: 4.369 Test Acc: 0.098
Validation loss decreased (-0.082271 --> -0.097779).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5567923
	speed: 0.2477s/iter; left time: 4870.4074s
	iters: 200, epoch: 6 | loss: 3.1435170
	speed: 0.0417s/iter; left time: 815.7032s
Epoch: 6 cost time: 9.572300672531128
Epoch: 6, Steps: 208 | Train Loss: 2.719 Vali Loss: 4.529 Vali Acc: 0.097 Test Loss: 4.529 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.9072423
	speed: 0.2892s/iter; left time: 5626.5209s
	iters: 200, epoch: 7 | loss: 2.6839473
	speed: 0.0427s/iter; left time: 825.9267s
Epoch: 7 cost time: 10.351596117019653
Epoch: 7, Steps: 208 | Train Loss: 2.483 Vali Loss: 4.828 Vali Acc: 0.098 Test Loss: 4.828 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8102132
	speed: 0.2803s/iter; left time: 5393.5752s
	iters: 200, epoch: 8 | loss: 2.4502764
	speed: 0.0438s/iter; left time: 839.2177s
Epoch: 8 cost time: 11.092987537384033
Epoch: 8, Steps: 208 | Train Loss: 2.208 Vali Loss: 4.911 Vali Acc: 0.104 Test Loss: 4.911 Test Acc: 0.104
Validation loss decreased (-0.097779 --> -0.104037).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1684749
	speed: 0.3058s/iter; left time: 5821.0923s
	iters: 200, epoch: 9 | loss: 2.2738373
	speed: 0.0522s/iter; left time: 988.0582s
Epoch: 9 cost time: 12.78451418876648
Epoch: 9, Steps: 208 | Train Loss: 1.989 Vali Loss: 5.171 Vali Acc: 0.095 Test Loss: 5.171 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0193007
	speed: 0.2506s/iter; left time: 4718.7613s
	iters: 200, epoch: 10 | loss: 2.1205738
	speed: 0.0348s/iter; left time: 652.6660s
Epoch: 10 cost time: 8.269192695617676
Epoch: 10, Steps: 208 | Train Loss: 1.714 Vali Loss: 5.909 Vali Acc: 0.084 Test Loss: 5.909 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2247986
	speed: 0.2727s/iter; left time: 5077.5784s
	iters: 200, epoch: 11 | loss: 1.4283816
	speed: 0.0388s/iter; left time: 718.3805s
Epoch: 11 cost time: 9.505226612091064
Epoch: 11, Steps: 208 | Train Loss: 1.512 Vali Loss: 5.504 Vali Acc: 0.101 Test Loss: 5.504 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3953027
	speed: 0.2634s/iter; left time: 4849.8038s
	iters: 200, epoch: 12 | loss: 1.8369021
	speed: 0.0362s/iter; left time: 662.3286s
Epoch: 12 cost time: 8.553987264633179
Epoch: 12, Steps: 208 | Train Loss: 1.333 Vali Loss: 5.828 Vali Acc: 0.107 Test Loss: 5.828 Test Acc: 0.107
Validation loss decreased (-0.104037 --> -0.107308).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9473485
	speed: 0.2747s/iter; left time: 5001.0539s
	iters: 200, epoch: 13 | loss: 1.5614570
	speed: 0.0387s/iter; left time: 700.1724s
Epoch: 13 cost time: 9.380967617034912
Epoch: 13, Steps: 208 | Train Loss: 1.172 Vali Loss: 6.144 Vali Acc: 0.109 Test Loss: 6.144 Test Acc: 0.109
Validation loss decreased (-0.107308 --> -0.109095).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6091856
	speed: 0.2816s/iter; left time: 5068.4121s
	iters: 200, epoch: 14 | loss: 2.3593869
	speed: 0.0394s/iter; left time: 705.0389s
Epoch: 14 cost time: 10.115540266036987
Epoch: 14, Steps: 208 | Train Loss: 1.024 Vali Loss: 6.602 Vali Acc: 0.106 Test Loss: 6.602 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4671433
	speed: 0.2834s/iter; left time: 5042.1638s
	iters: 200, epoch: 15 | loss: 1.3774108
	speed: 0.0515s/iter; left time: 910.2006s
Epoch: 15 cost time: 11.775755882263184
Epoch: 15, Steps: 208 | Train Loss: 0.889 Vali Loss: 6.944 Vali Acc: 0.110 Test Loss: 6.944 Test Acc: 0.110
Validation loss decreased (-0.109095 --> -0.110280).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5947688
	speed: 0.2771s/iter; left time: 4872.4589s
	iters: 200, epoch: 16 | loss: 1.0871104
	speed: 0.0498s/iter; left time: 869.8867s
Epoch: 16 cost time: 11.08817458152771
Epoch: 16, Steps: 208 | Train Loss: 0.766 Vali Loss: 7.638 Vali Acc: 0.106 Test Loss: 7.638 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8879585
	speed: 0.2684s/iter; left time: 4662.6155s
	iters: 200, epoch: 17 | loss: 1.1165144
	speed: 0.0468s/iter; left time: 808.4530s
Epoch: 17 cost time: 9.870832204818726
Epoch: 17, Steps: 208 | Train Loss: 0.685 Vali Loss: 7.864 Vali Acc: 0.114 Test Loss: 7.864 Test Acc: 0.114
Validation loss decreased (-0.110280 --> -0.113551).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0313338
	speed: 0.2781s/iter; left time: 4773.3354s
	iters: 200, epoch: 18 | loss: 0.6666590
	speed: 0.0446s/iter; left time: 761.8468s
Epoch: 18 cost time: 9.832936525344849
Epoch: 18, Steps: 208 | Train Loss: 0.653 Vali Loss: 8.184 Vali Acc: 0.106 Test Loss: 8.184 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2605911
	speed: 0.2614s/iter; left time: 4432.7983s
	iters: 200, epoch: 19 | loss: 0.8755162
	speed: 0.0364s/iter; left time: 614.2889s
Epoch: 19 cost time: 8.710579872131348
Epoch: 19, Steps: 208 | Train Loss: 0.574 Vali Loss: 8.692 Vali Acc: 0.112 Test Loss: 8.692 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.6416457
	speed: 0.2510s/iter; left time: 4204.1570s
	iters: 200, epoch: 20 | loss: 0.7437689
	speed: 0.0385s/iter; left time: 640.4817s
Epoch: 20 cost time: 9.370434999465942
Epoch: 20, Steps: 208 | Train Loss: 0.516 Vali Loss: 8.742 Vali Acc: 0.108 Test Loss: 8.742 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2829985
	speed: 0.2386s/iter; left time: 3946.2314s
	iters: 200, epoch: 21 | loss: 0.7914546
	speed: 0.0436s/iter; left time: 716.0113s
Epoch: 21 cost time: 9.047110080718994
Epoch: 21, Steps: 208 | Train Loss: 0.468 Vali Loss: 9.310 Vali Acc: 0.110 Test Loss: 9.310 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.3988727
	speed: 0.2644s/iter; left time: 4318.9615s
	iters: 200, epoch: 22 | loss: 0.5739909
	speed: 0.0308s/iter; left time: 500.4626s
Epoch: 22 cost time: 7.689011812210083
Epoch: 22, Steps: 208 | Train Loss: 0.419 Vali Loss: 9.614 Vali Acc: 0.108 Test Loss: 9.614 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3585023
	speed: 0.2599s/iter; left time: 4190.1296s
	iters: 200, epoch: 23 | loss: 0.2751229
	speed: 0.0332s/iter; left time: 531.8245s
Epoch: 23 cost time: 9.29582667350769
Epoch: 23, Steps: 208 | Train Loss: 0.390 Vali Loss: 10.117 Vali Acc: 0.108 Test Loss: 10.117 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.5560650
	speed: 0.2362s/iter; left time: 3760.1634s
	iters: 200, epoch: 24 | loss: 0.7113562
	speed: 0.0321s/iter; left time: 507.8129s
Epoch: 24 cost time: 7.712493658065796
Epoch: 24, Steps: 208 | Train Loss: 0.380 Vali Loss: 10.421 Vali Acc: 0.098 Test Loss: 10.421 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0996638
	speed: 0.2420s/iter; left time: 3800.8305s
	iters: 200, epoch: 25 | loss: 0.2819082
	speed: 0.0346s/iter; left time: 540.4614s
Epoch: 25 cost time: 7.967942476272583
Epoch: 25, Steps: 208 | Train Loss: 0.366 Vali Loss: 10.679 Vali Acc: 0.102 Test Loss: 10.679 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2231728
	speed: 0.2432s/iter; left time: 3769.2963s
	iters: 200, epoch: 26 | loss: 0.9340792
	speed: 0.0357s/iter; left time: 549.3940s
Epoch: 26 cost time: 8.552903413772583
Epoch: 26, Steps: 208 | Train Loss: 0.320 Vali Loss: 11.112 Vali Acc: 0.102 Test Loss: 11.112 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.5055159
	speed: 0.2426s/iter; left time: 3709.8820s
	iters: 200, epoch: 27 | loss: 0.3017485
	speed: 0.0453s/iter; left time: 688.1651s
Epoch: 27 cost time: 9.628485679626465
Epoch: 27, Steps: 208 | Train Loss: 0.286 Vali Loss: 11.351 Vali Acc: 0.115 Test Loss: 11.351 Test Acc: 0.115
Validation loss decreased (-0.113551 --> -0.114709).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.2025683
	speed: 0.2569s/iter; left time: 3875.6889s
	iters: 200, epoch: 28 | loss: 0.3543264
	speed: 0.0404s/iter; left time: 606.0409s
Epoch: 28 cost time: 10.32505178451538
Epoch: 28, Steps: 208 | Train Loss: 0.314 Vali Loss: 11.906 Vali Acc: 0.107 Test Loss: 11.906 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.3153523
	speed: 0.2771s/iter; left time: 4121.9449s
	iters: 200, epoch: 29 | loss: 0.2119374
	speed: 0.0436s/iter; left time: 644.8772s
Epoch: 29 cost time: 10.465866804122925
Epoch: 29, Steps: 208 | Train Loss: 0.272 Vali Loss: 12.055 Vali Acc: 0.103 Test Loss: 12.055 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.7520545
	speed: 0.2819s/iter; left time: 4135.8069s
	iters: 200, epoch: 30 | loss: 0.1925848
	speed: 0.0479s/iter; left time: 698.0075s
Epoch: 30 cost time: 11.625147342681885
Epoch: 30, Steps: 208 | Train Loss: 0.264 Vali Loss: 12.193 Vali Acc: 0.112 Test Loss: 12.193 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0574625
	speed: 0.2856s/iter; left time: 4130.0881s
	iters: 200, epoch: 31 | loss: 0.3504296
	speed: 0.0444s/iter; left time: 637.8716s
Epoch: 31 cost time: 9.78225326538086
Epoch: 31, Steps: 208 | Train Loss: 0.233 Vali Loss: 12.894 Vali Acc: 0.109 Test Loss: 12.894 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.6542240
	speed: 0.2682s/iter; left time: 3823.0998s
	iters: 200, epoch: 32 | loss: 0.4401872
	speed: 0.0377s/iter; left time: 533.7152s
Epoch: 32 cost time: 8.779691219329834
Epoch: 32, Steps: 208 | Train Loss: 0.239 Vali Loss: 12.707 Vali Acc: 0.109 Test Loss: 12.707 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.2954496
	speed: 0.2584s/iter; left time: 3628.6022s
	iters: 200, epoch: 33 | loss: 0.1860297
	speed: 0.0385s/iter; left time: 536.7520s
Epoch: 33 cost time: 8.494314908981323
Epoch: 33, Steps: 208 | Train Loss: 0.241 Vali Loss: 13.012 Vali Acc: 0.106 Test Loss: 13.012 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.1537823
	speed: 0.2522s/iter; left time: 3489.8812s
	iters: 200, epoch: 34 | loss: 0.0264251
	speed: 0.0407s/iter; left time: 558.9493s
Epoch: 34 cost time: 9.076043605804443
Epoch: 34, Steps: 208 | Train Loss: 0.254 Vali Loss: 13.359 Vali Acc: 0.111 Test Loss: 13.359 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.6898139
	speed: 0.2693s/iter; left time: 3670.5853s
	iters: 200, epoch: 35 | loss: 0.0239927
	speed: 0.0447s/iter; left time: 604.8982s
Epoch: 35 cost time: 11.343981266021729
Epoch: 35, Steps: 208 | Train Loss: 0.246 Vali Loss: 13.188 Vali Acc: 0.108 Test Loss: 13.188 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.3256812
	speed: 0.2692s/iter; left time: 3612.9307s
	iters: 200, epoch: 36 | loss: 0.4941167
	speed: 0.0483s/iter; left time: 643.6622s
Epoch: 36 cost time: 10.627133846282959
Epoch: 36, Steps: 208 | Train Loss: 0.221 Vali Loss: 13.600 Vali Acc: 0.114 Test Loss: 13.600 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.1875688
	speed: 0.2656s/iter; left time: 3509.4613s
	iters: 200, epoch: 37 | loss: 0.0232278
	speed: 0.0379s/iter; left time: 497.3295s
Epoch: 37 cost time: 9.57799744606018
Epoch: 37, Steps: 208 | Train Loss: 0.225 Vali Loss: 13.912 Vali Acc: 0.108 Test Loss: 13.912 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11482254697286012
model parameter : 507367
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8470879
	speed: 0.0836s/iter; left time: 1731.1911s
	iters: 200, epoch: 1 | loss: 3.9522076
	speed: 0.0402s/iter; left time: 828.2338s
Epoch: 1 cost time: 13.037864685058594
Epoch: 1, Steps: 208 | Train Loss: 3.940 Vali Loss: 4.092 Vali Acc: 0.055 Test Loss: 4.092 Test Acc: 0.055
Validation loss decreased (inf --> -0.055432).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6210942
	speed: 0.2512s/iter; left time: 5147.2371s
	iters: 200, epoch: 2 | loss: 4.5713019
	speed: 0.0301s/iter; left time: 613.0534s
Epoch: 2 cost time: 8.151031255722046
Epoch: 2, Steps: 208 | Train Loss: 3.715 Vali Loss: 4.120 Vali Acc: 0.071 Test Loss: 4.120 Test Acc: 0.071
Validation loss decreased (-0.055432 --> -0.071238).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5737700
	speed: 0.2516s/iter; left time: 5103.4947s
	iters: 200, epoch: 3 | loss: 3.1188893
	speed: 0.0395s/iter; left time: 797.5632s
Epoch: 3 cost time: 9.595742464065552
Epoch: 3, Steps: 208 | Train Loss: 3.302 Vali Loss: 4.129 Vali Acc: 0.087 Test Loss: 4.129 Test Acc: 0.087
Validation loss decreased (-0.071238 --> -0.086747).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6536224
	speed: 0.2406s/iter; left time: 4830.1120s
	iters: 200, epoch: 4 | loss: 3.2910521
	speed: 0.0352s/iter; left time: 703.2044s
Epoch: 4 cost time: 8.558329820632935
Epoch: 4, Steps: 208 | Train Loss: 3.082 Vali Loss: 4.288 Vali Acc: 0.086 Test Loss: 4.288 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.6618116
	speed: 0.2241s/iter; left time: 4451.8830s
	iters: 200, epoch: 5 | loss: 4.6181221
	speed: 0.0298s/iter; left time: 589.2788s
Epoch: 5 cost time: 7.064344644546509
Epoch: 5, Steps: 208 | Train Loss: 2.832 Vali Loss: 4.350 Vali Acc: 0.092 Test Loss: 4.350 Test Acc: 0.092
Validation loss decreased (-0.086747 --> -0.091516).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4392228
	speed: 0.2463s/iter; left time: 4842.9308s
	iters: 200, epoch: 6 | loss: 3.0229397
	speed: 0.0273s/iter; left time: 533.2041s
Epoch: 6 cost time: 7.529522180557251
Epoch: 6, Steps: 208 | Train Loss: 2.687 Vali Loss: 4.519 Vali Acc: 0.100 Test Loss: 4.519 Test Acc: 0.100
Validation loss decreased (-0.091516 --> -0.099567).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0835457
	speed: 0.2361s/iter; left time: 4593.7278s
	iters: 200, epoch: 7 | loss: 2.8335948
	speed: 0.0351s/iter; left time: 679.2643s
Epoch: 7 cost time: 8.09498906135559
Epoch: 7, Steps: 208 | Train Loss: 2.467 Vali Loss: 4.691 Vali Acc: 0.094 Test Loss: 4.691 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0667598
	speed: 0.2359s/iter; left time: 4540.6555s
	iters: 200, epoch: 8 | loss: 2.3749011
	speed: 0.0417s/iter; left time: 798.3922s
Epoch: 8 cost time: 9.123507022857666
Epoch: 8, Steps: 208 | Train Loss: 2.260 Vali Loss: 4.695 Vali Acc: 0.109 Test Loss: 4.695 Test Acc: 0.109
Validation loss decreased (-0.099567 --> -0.109407).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5985370
	speed: 0.2605s/iter; left time: 4959.8590s
	iters: 200, epoch: 9 | loss: 1.8842330
	speed: 0.0342s/iter; left time: 647.4724s
Epoch: 9 cost time: 8.658299446105957
Epoch: 9, Steps: 208 | Train Loss: 2.073 Vali Loss: 4.926 Vali Acc: 0.104 Test Loss: 4.926 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8543530
	speed: 0.2772s/iter; left time: 5219.1879s
	iters: 200, epoch: 10 | loss: 1.9674032
	speed: 0.0393s/iter; left time: 736.9592s
Epoch: 10 cost time: 10.736538887023926
Epoch: 10, Steps: 208 | Train Loss: 1.890 Vali Loss: 5.129 Vali Acc: 0.101 Test Loss: 5.129 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4077432
	speed: 0.2723s/iter; left time: 5069.6599s
	iters: 200, epoch: 11 | loss: 2.4719529
	speed: 0.0514s/iter; left time: 951.3859s
Epoch: 11 cost time: 12.47999358177185
Epoch: 11, Steps: 208 | Train Loss: 1.722 Vali Loss: 5.311 Vali Acc: 0.102 Test Loss: 5.311 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.5316371
	speed: 0.2542s/iter; left time: 4679.9743s
	iters: 200, epoch: 12 | loss: 1.4735003
	speed: 0.0308s/iter; left time: 563.9120s
Epoch: 12 cost time: 7.701309680938721
Epoch: 12, Steps: 208 | Train Loss: 1.534 Vali Loss: 5.457 Vali Acc: 0.100 Test Loss: 5.457 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.8472202
	speed: 0.2616s/iter; left time: 4762.7177s
	iters: 200, epoch: 13 | loss: 1.0554404
	speed: 0.0297s/iter; left time: 536.8797s
Epoch: 13 cost time: 7.851968288421631
Epoch: 13, Steps: 208 | Train Loss: 1.392 Vali Loss: 5.995 Vali Acc: 0.102 Test Loss: 5.995 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.0863427
	speed: 0.2470s/iter; left time: 4446.1146s
	iters: 200, epoch: 14 | loss: 1.3434050
	speed: 0.0417s/iter; left time: 746.4854s
Epoch: 14 cost time: 9.401506900787354
Epoch: 14, Steps: 208 | Train Loss: 1.281 Vali Loss: 6.245 Vali Acc: 0.105 Test Loss: 6.245 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2498472
	speed: 0.2510s/iter; left time: 4465.3330s
	iters: 200, epoch: 15 | loss: 1.8854431
	speed: 0.0408s/iter; left time: 721.3208s
Epoch: 15 cost time: 10.128023624420166
Epoch: 15, Steps: 208 | Train Loss: 1.134 Vali Loss: 6.678 Vali Acc: 0.105 Test Loss: 6.678 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.6003166
	speed: 0.2353s/iter; left time: 4136.6407s
	iters: 200, epoch: 16 | loss: 0.9686733
	speed: 0.0301s/iter; left time: 526.2387s
Epoch: 16 cost time: 7.422022581100464
Epoch: 16, Steps: 208 | Train Loss: 1.038 Vali Loss: 7.049 Vali Acc: 0.102 Test Loss: 7.049 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.3775272
	speed: 0.2491s/iter; left time: 4327.7595s
	iters: 200, epoch: 17 | loss: 0.6518294
	speed: 0.0379s/iter; left time: 653.8058s
Epoch: 17 cost time: 8.352432012557983
Epoch: 17, Steps: 208 | Train Loss: 0.921 Vali Loss: 7.335 Vali Acc: 0.103 Test Loss: 7.335 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.0541954
	speed: 0.2458s/iter; left time: 4219.8949s
	iters: 200, epoch: 18 | loss: 1.5313257
	speed: 0.0344s/iter; left time: 586.8864s
Epoch: 18 cost time: 8.623910665512085
Epoch: 18, Steps: 208 | Train Loss: 0.831 Vali Loss: 7.622 Vali Acc: 0.100 Test Loss: 7.622 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 342823
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3644674
	speed: 0.0754s/iter; left time: 1561.1385s
	iters: 200, epoch: 1 | loss: 3.4129431
	speed: 0.0305s/iter; left time: 628.0447s
Epoch: 1 cost time: 10.991545915603638
Epoch: 1, Steps: 208 | Train Loss: 3.900 Vali Loss: 4.036 Vali Acc: 0.050 Test Loss: 4.036 Test Acc: 0.050
Validation loss decreased (inf --> -0.049468).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4278567
	speed: 0.2184s/iter; left time: 4475.4504s
	iters: 200, epoch: 2 | loss: 4.0702357
	speed: 0.0320s/iter; left time: 653.2044s
Epoch: 2 cost time: 7.072605133056641
Epoch: 2, Steps: 208 | Train Loss: 3.655 Vali Loss: 3.965 Vali Acc: 0.069 Test Loss: 3.965 Test Acc: 0.069
Validation loss decreased (-0.049468 --> -0.069152).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4440246
	speed: 0.2304s/iter; left time: 4673.1489s
	iters: 200, epoch: 3 | loss: 3.2860146
	speed: 0.0316s/iter; left time: 638.3795s
Epoch: 3 cost time: 7.323469877243042
Epoch: 3, Steps: 208 | Train Loss: 3.352 Vali Loss: 4.085 Vali Acc: 0.078 Test Loss: 4.085 Test Acc: 0.078
Validation loss decreased (-0.069152 --> -0.078396).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3300290
	speed: 0.2120s/iter; left time: 4257.0022s
	iters: 200, epoch: 4 | loss: 3.7603297
	speed: 0.0276s/iter; left time: 551.7622s
Epoch: 4 cost time: 6.615602016448975
Epoch: 4, Steps: 208 | Train Loss: 3.078 Vali Loss: 4.281 Vali Acc: 0.083 Test Loss: 4.281 Test Acc: 0.083
Validation loss decreased (-0.078396 --> -0.083166).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2980404
	speed: 0.2232s/iter; left time: 4435.0912s
	iters: 200, epoch: 5 | loss: 3.7129560
	speed: 0.0311s/iter; left time: 614.2703s
Epoch: 5 cost time: 7.534491300582886
Epoch: 5, Steps: 208 | Train Loss: 2.925 Vali Loss: 4.407 Vali Acc: 0.089 Test Loss: 4.407 Test Acc: 0.089
Validation loss decreased (-0.083166 --> -0.088533).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9645669
	speed: 0.2153s/iter; left time: 4232.6832s
	iters: 200, epoch: 6 | loss: 2.3403127
	speed: 0.0308s/iter; left time: 603.4557s
Epoch: 6 cost time: 7.3922834396362305
Epoch: 6, Steps: 208 | Train Loss: 2.751 Vali Loss: 4.322 Vali Acc: 0.100 Test Loss: 4.322 Test Acc: 0.100
Validation loss decreased (-0.088533 --> -0.099867).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8311729
	speed: 0.2070s/iter; left time: 4025.8498s
	iters: 200, epoch: 7 | loss: 3.4711480
	speed: 0.0262s/iter; left time: 507.2193s
Epoch: 7 cost time: 6.774724006652832
Epoch: 7, Steps: 208 | Train Loss: 2.578 Vali Loss: 4.611 Vali Acc: 0.090 Test Loss: 4.611 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0111904
	speed: 0.2134s/iter; left time: 4106.0889s
	iters: 200, epoch: 8 | loss: 2.2923727
	speed: 0.0278s/iter; left time: 531.3544s
Epoch: 8 cost time: 7.0149760246276855
Epoch: 8, Steps: 208 | Train Loss: 2.430 Vali Loss: 4.551 Vali Acc: 0.100 Test Loss: 4.551 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3499098
	speed: 0.2035s/iter; left time: 3873.8833s
	iters: 200, epoch: 9 | loss: 3.0826471
	speed: 0.0306s/iter; left time: 579.4856s
Epoch: 9 cost time: 7.390299081802368
Epoch: 9, Steps: 208 | Train Loss: 2.265 Vali Loss: 4.620 Vali Acc: 0.099 Test Loss: 4.620 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9523305
	speed: 0.2460s/iter; left time: 4631.3997s
	iters: 200, epoch: 10 | loss: 2.3079064
	speed: 0.0344s/iter; left time: 644.4444s
Epoch: 10 cost time: 8.42246389389038
Epoch: 10, Steps: 208 | Train Loss: 2.076 Vali Loss: 4.630 Vali Acc: 0.101 Test Loss: 4.630 Test Acc: 0.101
Validation loss decreased (-0.099867 --> -0.100461).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3283938
	speed: 0.2446s/iter; left time: 4554.1714s
	iters: 200, epoch: 11 | loss: 2.5545936
	speed: 0.0368s/iter; left time: 681.1583s
Epoch: 11 cost time: 8.443293809890747
Epoch: 11, Steps: 208 | Train Loss: 1.946 Vali Loss: 4.906 Vali Acc: 0.102 Test Loss: 4.906 Test Acc: 0.102
Validation loss decreased (-0.100461 --> -0.101651).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9028378
	speed: 0.2514s/iter; left time: 4629.1922s
	iters: 200, epoch: 12 | loss: 1.6362224
	speed: 0.0344s/iter; left time: 630.6385s
Epoch: 12 cost time: 8.310119152069092
Epoch: 12, Steps: 208 | Train Loss: 1.771 Vali Loss: 4.972 Vali Acc: 0.108 Test Loss: 4.972 Test Acc: 0.108
Validation loss decreased (-0.101651 --> -0.107615).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6162504
	speed: 0.2466s/iter; left time: 4488.7253s
	iters: 200, epoch: 13 | loss: 1.7969234
	speed: 0.0367s/iter; left time: 664.1379s
Epoch: 13 cost time: 8.274456262588501
Epoch: 13, Steps: 208 | Train Loss: 1.632 Vali Loss: 5.259 Vali Acc: 0.103 Test Loss: 5.259 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5025927
	speed: 0.2434s/iter; left time: 4381.1823s
	iters: 200, epoch: 14 | loss: 1.0453483
	speed: 0.0417s/iter; left time: 746.4032s
Epoch: 14 cost time: 9.39870834350586
Epoch: 14, Steps: 208 | Train Loss: 1.501 Vali Loss: 5.541 Vali Acc: 0.099 Test Loss: 5.541 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4481927
	speed: 0.2329s/iter; left time: 4143.4701s
	iters: 200, epoch: 15 | loss: 1.6483598
	speed: 0.0313s/iter; left time: 554.0335s
Epoch: 15 cost time: 7.115525245666504
Epoch: 15, Steps: 208 | Train Loss: 1.367 Vali Loss: 5.692 Vali Acc: 0.112 Test Loss: 5.692 Test Acc: 0.112
Validation loss decreased (-0.107615 --> -0.111485).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.8422492
	speed: 0.2225s/iter; left time: 3910.9908s
	iters: 200, epoch: 16 | loss: 1.6304142
	speed: 0.0292s/iter; left time: 509.6352s
Epoch: 16 cost time: 7.2089855670928955
Epoch: 16, Steps: 208 | Train Loss: 1.265 Vali Loss: 6.071 Vali Acc: 0.096 Test Loss: 6.071 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2226627
	speed: 0.2357s/iter; left time: 4095.0184s
	iters: 200, epoch: 17 | loss: 2.0199137
	speed: 0.0354s/iter; left time: 611.7582s
Epoch: 17 cost time: 8.30331540107727
Epoch: 17, Steps: 208 | Train Loss: 1.185 Vali Loss: 6.302 Vali Acc: 0.104 Test Loss: 6.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5456418
	speed: 0.2415s/iter; left time: 4144.9286s
	iters: 200, epoch: 18 | loss: 1.2322249
	speed: 0.0322s/iter; left time: 548.6507s
Epoch: 18 cost time: 7.796724081039429
Epoch: 18, Steps: 208 | Train Loss: 1.073 Vali Loss: 6.504 Vali Acc: 0.109 Test Loss: 6.504 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.6823285
	speed: 0.2470s/iter; left time: 4188.4510s
	iters: 200, epoch: 19 | loss: 1.9542979
	speed: 0.0353s/iter; left time: 595.1495s
Epoch: 19 cost time: 8.138983726501465
Epoch: 19, Steps: 208 | Train Loss: 0.987 Vali Loss: 6.884 Vali Acc: 0.109 Test Loss: 6.884 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.7908010
	speed: 0.2362s/iter; left time: 3955.7464s
	iters: 200, epoch: 20 | loss: 0.5906591
	speed: 0.0352s/iter; left time: 585.5239s
Epoch: 20 cost time: 8.46699595451355
Epoch: 20, Steps: 208 | Train Loss: 0.909 Vali Loss: 7.202 Vali Acc: 0.109 Test Loss: 7.202 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5438120
	speed: 0.2544s/iter; left time: 4208.4850s
	iters: 200, epoch: 21 | loss: 1.0147295
	speed: 0.0319s/iter; left time: 523.9837s
Epoch: 21 cost time: 8.200407028198242
Epoch: 21, Steps: 208 | Train Loss: 0.847 Vali Loss: 7.336 Vali Acc: 0.103 Test Loss: 7.336 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2941849
	speed: 0.2571s/iter; left time: 4199.7198s
	iters: 200, epoch: 22 | loss: 0.8510486
	speed: 0.0322s/iter; left time: 523.4099s
Epoch: 22 cost time: 8.01401424407959
Epoch: 22, Steps: 208 | Train Loss: 0.770 Vali Loss: 7.763 Vali Acc: 0.105 Test Loss: 7.763 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.6057771
	speed: 0.2397s/iter; left time: 3865.0941s
	iters: 200, epoch: 23 | loss: 0.8431908
	speed: 0.0336s/iter; left time: 539.1099s
Epoch: 23 cost time: 8.218420028686523
Epoch: 23, Steps: 208 | Train Loss: 0.717 Vali Loss: 8.160 Vali Acc: 0.110 Test Loss: 8.160 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.3460975
	speed: 0.2375s/iter; left time: 3780.4741s
	iters: 200, epoch: 24 | loss: 1.0199252
	speed: 0.0302s/iter; left time: 477.1341s
Epoch: 24 cost time: 7.714630842208862
Epoch: 24, Steps: 208 | Train Loss: 0.652 Vali Loss: 8.202 Vali Acc: 0.106 Test Loss: 8.202 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.7630282
	speed: 0.2311s/iter; left time: 3630.1346s
	iters: 200, epoch: 25 | loss: 0.8335615
	speed: 0.0320s/iter; left time: 499.4987s
Epoch: 25 cost time: 7.892024278640747
Epoch: 25, Steps: 208 | Train Loss: 0.589 Vali Loss: 8.549 Vali Acc: 0.105 Test Loss: 8.549 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11154190277363556
model parameter : 274343
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7000360
	speed: 0.0810s/iter; left time: 1677.6005s
	iters: 200, epoch: 1 | loss: 3.8328245
	speed: 0.0380s/iter; left time: 783.0940s
Epoch: 1 cost time: 12.21623182296753
Epoch: 1, Steps: 208 | Train Loss: 3.815 Vali Loss: 3.817 Vali Acc: 0.059 Test Loss: 3.817 Test Acc: 0.059
Validation loss decreased (inf --> -0.059312).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8892164
	speed: 0.2557s/iter; left time: 5240.2119s
	iters: 200, epoch: 2 | loss: 3.7484570
	speed: 0.0310s/iter; left time: 631.3485s
Epoch: 2 cost time: 8.159669160842896
Epoch: 2, Steps: 208 | Train Loss: 3.618 Vali Loss: 3.881 Vali Acc: 0.059 Test Loss: 3.881 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6666644
	speed: 0.2630s/iter; left time: 5334.3326s
	iters: 200, epoch: 3 | loss: 3.1769648
	speed: 0.0314s/iter; left time: 633.1571s
Epoch: 3 cost time: 8.080037832260132
Epoch: 3, Steps: 208 | Train Loss: 3.322 Vali Loss: 3.873 Vali Acc: 0.078 Test Loss: 3.873 Test Acc: 0.078
Validation loss decreased (-0.059312 --> -0.078398).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5754056
	speed: 0.2569s/iter; left time: 5158.3626s
	iters: 200, epoch: 4 | loss: 2.6357946
	speed: 0.0319s/iter; left time: 636.9537s
Epoch: 4 cost time: 8.269458293914795
Epoch: 4, Steps: 208 | Train Loss: 3.109 Vali Loss: 3.890 Vali Acc: 0.081 Test Loss: 3.890 Test Acc: 0.081
Validation loss decreased (-0.078398 --> -0.081381).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7815697
	speed: 0.2621s/iter; left time: 5207.1219s
	iters: 200, epoch: 5 | loss: 3.2200017
	speed: 0.0336s/iter; left time: 664.3139s
Epoch: 5 cost time: 9.207193851470947
Epoch: 5, Steps: 208 | Train Loss: 2.974 Vali Loss: 4.159 Vali Acc: 0.075 Test Loss: 4.159 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4672675
	speed: 0.2548s/iter; left time: 5010.5112s
	iters: 200, epoch: 6 | loss: 3.0222132
	speed: 0.0332s/iter; left time: 649.1817s
Epoch: 6 cost time: 8.481187343597412
Epoch: 6, Steps: 208 | Train Loss: 2.850 Vali Loss: 4.053 Vali Acc: 0.102 Test Loss: 4.053 Test Acc: 0.102
Validation loss decreased (-0.081381 --> -0.101958).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8715556
	speed: 0.2625s/iter; left time: 5106.9321s
	iters: 200, epoch: 7 | loss: 2.7479353
	speed: 0.0362s/iter; left time: 700.9879s
Epoch: 7 cost time: 8.632572889328003
Epoch: 7, Steps: 208 | Train Loss: 2.717 Vali Loss: 4.130 Vali Acc: 0.102 Test Loss: 4.130 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0333652
	speed: 0.2735s/iter; left time: 5263.9158s
	iters: 200, epoch: 8 | loss: 2.5039887
	speed: 0.0340s/iter; left time: 650.6460s
Epoch: 8 cost time: 8.747536897659302
Epoch: 8, Steps: 208 | Train Loss: 2.630 Vali Loss: 4.196 Vali Acc: 0.098 Test Loss: 4.196 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.4802547
	speed: 0.2750s/iter; left time: 5234.3751s
	iters: 200, epoch: 9 | loss: 3.7891672
	speed: 0.0408s/iter; left time: 772.5910s
Epoch: 9 cost time: 9.224601745605469
Epoch: 9, Steps: 208 | Train Loss: 2.457 Vali Loss: 4.377 Vali Acc: 0.098 Test Loss: 4.377 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.0811849
	speed: 0.2597s/iter; left time: 4890.6163s
	iters: 200, epoch: 10 | loss: 2.5342567
	speed: 0.0374s/iter; left time: 700.7316s
Epoch: 10 cost time: 8.520675420761108
Epoch: 10, Steps: 208 | Train Loss: 2.327 Vali Loss: 4.423 Vali Acc: 0.104 Test Loss: 4.423 Test Acc: 0.104
Validation loss decreased (-0.101958 --> -0.104340).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9907142
	speed: 0.2630s/iter; left time: 4896.6161s
	iters: 200, epoch: 11 | loss: 2.1668525
	speed: 0.0329s/iter; left time: 609.0135s
Epoch: 11 cost time: 8.514167308807373
Epoch: 11, Steps: 208 | Train Loss: 2.196 Vali Loss: 4.558 Vali Acc: 0.101 Test Loss: 4.558 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0755172
	speed: 0.2664s/iter; left time: 4906.0126s
	iters: 200, epoch: 12 | loss: 2.3322320
	speed: 0.0346s/iter; left time: 634.0072s
Epoch: 12 cost time: 8.044255018234253
Epoch: 12, Steps: 208 | Train Loss: 2.077 Vali Loss: 4.593 Vali Acc: 0.107 Test Loss: 4.593 Test Acc: 0.107
Validation loss decreased (-0.104340 --> -0.107321).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7812078
	speed: 0.2723s/iter; left time: 4956.6493s
	iters: 200, epoch: 13 | loss: 1.8775793
	speed: 0.0286s/iter; left time: 517.2815s
Epoch: 13 cost time: 7.545754432678223
Epoch: 13, Steps: 208 | Train Loss: 1.947 Vali Loss: 4.743 Vali Acc: 0.111 Test Loss: 4.743 Test Acc: 0.111
Validation loss decreased (-0.107321 --> -0.111196).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1311433
	speed: 0.2410s/iter; left time: 4336.5151s
	iters: 200, epoch: 14 | loss: 1.3641899
	speed: 0.0349s/iter; left time: 624.9288s
Epoch: 14 cost time: 7.792407274246216
Epoch: 14, Steps: 208 | Train Loss: 1.839 Vali Loss: 4.997 Vali Acc: 0.107 Test Loss: 4.997 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.8234208
	speed: 0.2585s/iter; left time: 4599.1576s
	iters: 200, epoch: 15 | loss: 2.1338227
	speed: 0.0371s/iter; left time: 655.9947s
Epoch: 15 cost time: 9.010218143463135
Epoch: 15, Steps: 208 | Train Loss: 1.730 Vali Loss: 5.151 Vali Acc: 0.106 Test Loss: 5.151 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4872386
	speed: 0.2610s/iter; left time: 4587.8662s
	iters: 200, epoch: 16 | loss: 2.1545115
	speed: 0.0412s/iter; left time: 720.5478s
Epoch: 16 cost time: 9.051075458526611
Epoch: 16, Steps: 208 | Train Loss: 1.625 Vali Loss: 5.227 Vali Acc: 0.110 Test Loss: 5.227 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3451422
	speed: 0.2386s/iter; left time: 4144.3834s
	iters: 200, epoch: 17 | loss: 1.9601581
	speed: 0.0308s/iter; left time: 532.3802s
Epoch: 17 cost time: 7.258554697036743
Epoch: 17, Steps: 208 | Train Loss: 1.521 Vali Loss: 5.434 Vali Acc: 0.109 Test Loss: 5.434 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.5842053
	speed: 0.2377s/iter; left time: 4080.8456s
	iters: 200, epoch: 18 | loss: 1.4703900
	speed: 0.0302s/iter; left time: 515.3096s
Epoch: 18 cost time: 7.309391736984253
Epoch: 18, Steps: 208 | Train Loss: 1.419 Vali Loss: 5.823 Vali Acc: 0.106 Test Loss: 5.823 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.7423742
	speed: 0.2407s/iter; left time: 4080.9202s
	iters: 200, epoch: 19 | loss: 1.8716676
	speed: 0.0361s/iter; left time: 609.0395s
Epoch: 19 cost time: 8.464427947998047
Epoch: 19, Steps: 208 | Train Loss: 1.346 Vali Loss: 5.910 Vali Acc: 0.105 Test Loss: 5.910 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.7505553
	speed: 0.2395s/iter; left time: 4010.5920s
	iters: 200, epoch: 20 | loss: 0.9945111
	speed: 0.0350s/iter; left time: 582.2801s
Epoch: 20 cost time: 8.415649175643921
Epoch: 20, Steps: 208 | Train Loss: 1.255 Vali Loss: 6.015 Vali Acc: 0.104 Test Loss: 6.015 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.1162753
	speed: 0.2500s/iter; left time: 4134.6662s
	iters: 200, epoch: 21 | loss: 1.3846078
	speed: 0.0313s/iter; left time: 515.4232s
Epoch: 21 cost time: 8.130188226699829
Epoch: 21, Steps: 208 | Train Loss: 1.176 Vali Loss: 6.417 Vali Acc: 0.109 Test Loss: 6.417 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.9590253
	speed: 0.2538s/iter; left time: 4145.7606s
	iters: 200, epoch: 22 | loss: 1.0914211
	speed: 0.0428s/iter; left time: 694.4017s
Epoch: 22 cost time: 9.445196151733398
Epoch: 22, Steps: 208 | Train Loss: 1.119 Vali Loss: 6.585 Vali Acc: 0.103 Test Loss: 6.585 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.5636451
	speed: 0.2611s/iter; left time: 4209.6277s
	iters: 200, epoch: 23 | loss: 0.5427802
	speed: 0.0310s/iter; left time: 497.0880s
Epoch: 23 cost time: 7.954282760620117
Epoch: 23, Steps: 208 | Train Loss: 1.021 Vali Loss: 6.756 Vali Acc: 0.108 Test Loss: 6.756 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11124366239188786
model parameter : 178599
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6997018
	speed: 0.0740s/iter; left time: 1532.2893s
	iters: 200, epoch: 1 | loss: 3.5705602
	speed: 0.0397s/iter; left time: 817.3409s
Epoch: 1 cost time: 11.82767915725708
Epoch: 1, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.741 Vali Acc: 0.052 Test Loss: 3.741 Test Acc: 0.052
Validation loss decreased (inf --> -0.052453).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6351426
	speed: 0.2721s/iter; left time: 5575.8858s
	iters: 200, epoch: 2 | loss: 3.6696939
	speed: 0.0360s/iter; left time: 735.0715s
Epoch: 2 cost time: 8.246028184890747
Epoch: 2, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.863 Vali Acc: 0.056 Test Loss: 3.863 Test Acc: 0.056
Validation loss decreased (-0.052453 --> -0.056329).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0711491
	speed: 0.2549s/iter; left time: 5170.1536s
	iters: 200, epoch: 3 | loss: 3.4862235
	speed: 0.0346s/iter; left time: 697.8769s
Epoch: 3 cost time: 8.348472118377686
Epoch: 3, Steps: 208 | Train Loss: 3.365 Vali Loss: 3.850 Vali Acc: 0.077 Test Loss: 3.850 Test Acc: 0.077
Validation loss decreased (-0.056329 --> -0.077206).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1001368
	speed: 0.2501s/iter; left time: 5020.6268s
	iters: 200, epoch: 4 | loss: 3.0047812
	speed: 0.0312s/iter; left time: 622.4132s
Epoch: 4 cost time: 8.556068181991577
Epoch: 4, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.912 Vali Acc: 0.076 Test Loss: 3.912 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.7199631
	speed: 0.2419s/iter; left time: 4806.8195s
	iters: 200, epoch: 5 | loss: 3.3082981
	speed: 0.0390s/iter; left time: 771.6454s
Epoch: 5 cost time: 9.198801040649414
Epoch: 5, Steps: 208 | Train Loss: 3.042 Vali Loss: 4.023 Vali Acc: 0.086 Test Loss: 4.023 Test Acc: 0.086
Validation loss decreased (-0.077206 --> -0.086449).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4254503
	speed: 0.2367s/iter; left time: 4653.4139s
	iters: 200, epoch: 6 | loss: 3.2433870
	speed: 0.0337s/iter; left time: 658.6914s
Epoch: 6 cost time: 8.054586172103882
Epoch: 6, Steps: 208 | Train Loss: 2.900 Vali Loss: 3.965 Vali Acc: 0.092 Test Loss: 3.965 Test Acc: 0.092
Validation loss decreased (-0.086449 --> -0.092415).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8819156
	speed: 0.2402s/iter; left time: 4673.2357s
	iters: 200, epoch: 7 | loss: 2.4689720
	speed: 0.0277s/iter; left time: 537.0258s
Epoch: 7 cost time: 7.467126369476318
Epoch: 7, Steps: 208 | Train Loss: 2.787 Vali Loss: 4.115 Vali Acc: 0.092 Test Loss: 4.115 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.6974058
	speed: 0.2482s/iter; left time: 4776.7006s
	iters: 200, epoch: 8 | loss: 2.7207100
	speed: 0.0364s/iter; left time: 697.7202s
Epoch: 8 cost time: 8.907082080841064
Epoch: 8, Steps: 208 | Train Loss: 2.671 Vali Loss: 4.146 Vali Acc: 0.084 Test Loss: 4.146 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5102656
	speed: 0.2453s/iter; left time: 4668.9002s
	iters: 200, epoch: 9 | loss: 3.4298835
	speed: 0.0387s/iter; left time: 732.5231s
Epoch: 9 cost time: 9.594604253768921
Epoch: 9, Steps: 208 | Train Loss: 2.539 Vali Loss: 4.252 Vali Acc: 0.096 Test Loss: 4.252 Test Acc: 0.096
Validation loss decreased (-0.092415 --> -0.096289).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7691882
	speed: 0.2764s/iter; left time: 5204.5490s
	iters: 200, epoch: 10 | loss: 2.1839910
	speed: 0.0343s/iter; left time: 642.5390s
Epoch: 10 cost time: 8.710177421569824
Epoch: 10, Steps: 208 | Train Loss: 2.446 Vali Loss: 4.231 Vali Acc: 0.099 Test Loss: 4.231 Test Acc: 0.099
Validation loss decreased (-0.096289 --> -0.098973).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3296537
	speed: 0.2663s/iter; left time: 4957.9491s
	iters: 200, epoch: 11 | loss: 2.2797480
	speed: 0.0394s/iter; left time: 729.9442s
Epoch: 11 cost time: 9.721209526062012
Epoch: 11, Steps: 208 | Train Loss: 2.340 Vali Loss: 4.420 Vali Acc: 0.100 Test Loss: 4.420 Test Acc: 0.100
Validation loss decreased (-0.098973 --> -0.099568).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3581176
	speed: 0.2791s/iter; left time: 5139.3087s
	iters: 200, epoch: 12 | loss: 2.0271142
	speed: 0.0417s/iter; left time: 764.5350s
Epoch: 12 cost time: 9.91727089881897
Epoch: 12, Steps: 208 | Train Loss: 2.229 Vali Loss: 4.413 Vali Acc: 0.100 Test Loss: 4.413 Test Acc: 0.100
Validation loss decreased (-0.099568 --> -0.099866).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9823015
	speed: 0.2782s/iter; left time: 5065.2745s
	iters: 200, epoch: 13 | loss: 2.3305676
	speed: 0.0387s/iter; left time: 700.9420s
Epoch: 13 cost time: 10.341887474060059
Epoch: 13, Steps: 208 | Train Loss: 2.142 Vali Loss: 4.440 Vali Acc: 0.097 Test Loss: 4.440 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6465856
	speed: 0.2678s/iter; left time: 4819.7512s
	iters: 200, epoch: 14 | loss: 2.4175642
	speed: 0.0382s/iter; left time: 683.1606s
Epoch: 14 cost time: 9.497679233551025
Epoch: 14, Steps: 208 | Train Loss: 2.027 Vali Loss: 4.644 Vali Acc: 0.103 Test Loss: 4.644 Test Acc: 0.103
Validation loss decreased (-0.099866 --> -0.103443).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.1774795
	speed: 0.2802s/iter; left time: 4985.1813s
	iters: 200, epoch: 15 | loss: 2.1678634
	speed: 0.0383s/iter; left time: 678.3619s
Epoch: 15 cost time: 9.881739616394043
Epoch: 15, Steps: 208 | Train Loss: 1.927 Vali Loss: 4.717 Vali Acc: 0.095 Test Loss: 4.717 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.1646051
	speed: 0.2651s/iter; left time: 4661.0638s
	iters: 200, epoch: 16 | loss: 1.5011508
	speed: 0.0380s/iter; left time: 663.6319s
Epoch: 16 cost time: 9.815856456756592
Epoch: 16, Steps: 208 | Train Loss: 1.844 Vali Loss: 4.910 Vali Acc: 0.100 Test Loss: 4.910 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.7947813
	speed: 0.2738s/iter; left time: 4756.6463s
	iters: 200, epoch: 17 | loss: 1.6680298
	speed: 0.0334s/iter; left time: 576.9223s
Epoch: 17 cost time: 9.598370790481567
Epoch: 17, Steps: 208 | Train Loss: 1.743 Vali Loss: 5.053 Vali Acc: 0.104 Test Loss: 5.053 Test Acc: 0.104
Validation loss decreased (-0.103443 --> -0.104334).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3476681
	speed: 0.2670s/iter; left time: 4582.8189s
	iters: 200, epoch: 18 | loss: 2.1932886
	speed: 0.0348s/iter; left time: 594.1522s
Epoch: 18 cost time: 8.780785083770752
Epoch: 18, Steps: 208 | Train Loss: 1.638 Vali Loss: 5.278 Vali Acc: 0.102 Test Loss: 5.278 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.5035094
	speed: 0.2709s/iter; left time: 4593.5243s
	iters: 200, epoch: 19 | loss: 1.5696795
	speed: 0.0381s/iter; left time: 641.4794s
Epoch: 19 cost time: 8.969473600387573
Epoch: 19, Steps: 208 | Train Loss: 1.553 Vali Loss: 5.447 Vali Acc: 0.104 Test Loss: 5.447 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.5255319
	speed: 0.2700s/iter; left time: 4521.9538s
	iters: 200, epoch: 20 | loss: 1.6832329
	speed: 0.0419s/iter; left time: 697.7068s
Epoch: 20 cost time: 9.710390090942383
Epoch: 20, Steps: 208 | Train Loss: 1.464 Vali Loss: 5.521 Vali Acc: 0.104 Test Loss: 5.521 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.3108699
	speed: 0.2671s/iter; left time: 4418.3035s
	iters: 200, epoch: 21 | loss: 1.5582441
	speed: 0.0420s/iter; left time: 690.5186s
Epoch: 21 cost time: 9.77711296081543
Epoch: 21, Steps: 208 | Train Loss: 1.388 Vali Loss: 5.701 Vali Acc: 0.105 Test Loss: 5.701 Test Acc: 0.105
Validation loss decreased (-0.104334 --> -0.104924).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.9212515
	speed: 0.2804s/iter; left time: 4579.2370s
	iters: 200, epoch: 22 | loss: 1.5023233
	speed: 0.0418s/iter; left time: 678.8721s
Epoch: 22 cost time: 9.835866451263428
Epoch: 22, Steps: 208 | Train Loss: 1.306 Vali Loss: 6.039 Vali Acc: 0.099 Test Loss: 6.039 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.8476959
	speed: 0.3025s/iter; left time: 4878.0186s
	iters: 200, epoch: 23 | loss: 1.6151552
	speed: 0.0412s/iter; left time: 660.7981s
Epoch: 23 cost time: 10.023749351501465
Epoch: 23, Steps: 208 | Train Loss: 1.235 Vali Loss: 6.233 Vali Acc: 0.102 Test Loss: 6.233 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.1955624
	speed: 0.2766s/iter; left time: 4401.9588s
	iters: 200, epoch: 24 | loss: 1.3007399
	speed: 0.0405s/iter; left time: 640.1902s
Epoch: 24 cost time: 10.338820695877075
Epoch: 24, Steps: 208 | Train Loss: 1.178 Vali Loss: 6.320 Vali Acc: 0.106 Test Loss: 6.320 Test Acc: 0.106
Validation loss decreased (-0.104924 --> -0.106409).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.3429410
	speed: 0.2604s/iter; left time: 4091.0760s
	iters: 200, epoch: 25 | loss: 0.9408702
	speed: 0.0378s/iter; left time: 590.1126s
Epoch: 25 cost time: 9.437300443649292
Epoch: 25, Steps: 208 | Train Loss: 1.130 Vali Loss: 6.498 Vali Acc: 0.109 Test Loss: 6.498 Test Acc: 0.109
Validation loss decreased (-0.106409 --> -0.108495).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0368025
	speed: 0.2629s/iter; left time: 4075.7390s
	iters: 200, epoch: 26 | loss: 0.7072514
	speed: 0.0342s/iter; left time: 526.5951s
Epoch: 26 cost time: 9.461201906204224
Epoch: 26, Steps: 208 | Train Loss: 1.036 Vali Loss: 6.767 Vali Acc: 0.106 Test Loss: 6.767 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.2323288
	speed: 0.2620s/iter; left time: 4006.0520s
	iters: 200, epoch: 27 | loss: 0.9491863
	speed: 0.0407s/iter; left time: 618.9952s
Epoch: 27 cost time: 9.983751058578491
Epoch: 27, Steps: 208 | Train Loss: 1.011 Vali Loss: 7.092 Vali Acc: 0.111 Test Loss: 7.092 Test Acc: 0.111
Validation loss decreased (-0.108495 --> -0.110875).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.0353848
	speed: 0.2700s/iter; left time: 4072.9326s
	iters: 200, epoch: 28 | loss: 0.5505206
	speed: 0.0445s/iter; left time: 667.2490s
Epoch: 28 cost time: 10.808967590332031
Epoch: 28, Steps: 208 | Train Loss: 0.953 Vali Loss: 7.182 Vali Acc: 0.103 Test Loss: 7.182 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.4674569
	speed: 0.2718s/iter; left time: 4043.2403s
	iters: 200, epoch: 29 | loss: 1.0141702
	speed: 0.0336s/iter; left time: 496.7123s
Epoch: 29 cost time: 8.898292779922485
Epoch: 29, Steps: 208 | Train Loss: 0.909 Vali Loss: 7.483 Vali Acc: 0.103 Test Loss: 7.483 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.7869180
	speed: 0.2768s/iter; left time: 4060.8795s
	iters: 200, epoch: 30 | loss: 1.1941377
	speed: 0.0400s/iter; left time: 583.4657s
Epoch: 30 cost time: 9.816403865814209
Epoch: 30, Steps: 208 | Train Loss: 0.892 Vali Loss: 7.706 Vali Acc: 0.110 Test Loss: 7.706 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.8130817
	speed: 0.2772s/iter; left time: 4008.7836s
	iters: 200, epoch: 31 | loss: 2.2233655
	speed: 0.0345s/iter; left time: 495.9262s
Epoch: 31 cost time: 9.268321990966797
Epoch: 31, Steps: 208 | Train Loss: 0.801 Vali Loss: 7.905 Vali Acc: 0.105 Test Loss: 7.905 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.4127023
	speed: 0.2821s/iter; left time: 4020.7829s
	iters: 200, epoch: 32 | loss: 0.9906904
	speed: 0.0410s/iter; left time: 579.9809s
Epoch: 32 cost time: 9.794033288955688
Epoch: 32, Steps: 208 | Train Loss: 0.787 Vali Loss: 8.132 Vali Acc: 0.109 Test Loss: 8.132 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.6168281
	speed: 0.2816s/iter; left time: 3955.5128s
	iters: 200, epoch: 33 | loss: 0.5349358
	speed: 0.0398s/iter; left time: 555.0575s
Epoch: 33 cost time: 9.97367000579834
Epoch: 33, Steps: 208 | Train Loss: 0.709 Vali Loss: 8.422 Vali Acc: 0.100 Test Loss: 8.422 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.6910318
	speed: 0.2787s/iter; left time: 3855.9747s
	iters: 200, epoch: 34 | loss: 0.3243502
	speed: 0.0425s/iter; left time: 584.3765s
Epoch: 34 cost time: 10.423431158065796
Epoch: 34, Steps: 208 | Train Loss: 0.710 Vali Loss: 8.615 Vali Acc: 0.103 Test Loss: 8.615 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.2208065
	speed: 0.2801s/iter; left time: 3818.1581s
	iters: 200, epoch: 35 | loss: 1.1237398
	speed: 0.0344s/iter; left time: 464.8989s
Epoch: 35 cost time: 9.28394865989685
Epoch: 35, Steps: 208 | Train Loss: 0.653 Vali Loss: 8.850 Vali Acc: 0.101 Test Loss: 8.850 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.5507697
	speed: 0.2726s/iter; left time: 3659.1171s
	iters: 200, epoch: 36 | loss: 0.4732099
	speed: 0.0397s/iter; left time: 528.9634s
Epoch: 36 cost time: 9.961644411087036
Epoch: 36, Steps: 208 | Train Loss: 0.653 Vali Loss: 8.900 Vali Acc: 0.106 Test Loss: 8.900 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0920058
	speed: 0.2582s/iter; left time: 3411.4631s
	iters: 200, epoch: 37 | loss: 0.8478298
	speed: 0.0316s/iter; left time: 414.3763s
Epoch: 37 cost time: 9.018280506134033
Epoch: 37, Steps: 208 | Train Loss: 0.643 Vali Loss: 9.281 Vali Acc: 0.104 Test Loss: 9.281 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11094542201014017
model parameter : 137767
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7097528
	speed: 0.0850s/iter; left time: 1760.4332s
	iters: 200, epoch: 1 | loss: 3.7721155
	speed: 0.0363s/iter; left time: 748.8349s
Epoch: 1 cost time: 12.631561756134033
Epoch: 1, Steps: 208 | Train Loss: 3.790 Vali Loss: 3.725 Vali Acc: 0.053 Test Loss: 3.725 Test Acc: 0.053
Validation loss decreased (inf --> -0.053348).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7710557
	speed: 0.2873s/iter; left time: 5886.6933s
	iters: 200, epoch: 2 | loss: 3.4737093
	speed: 0.0354s/iter; left time: 722.8034s
Epoch: 2 cost time: 8.687487602233887
Epoch: 2, Steps: 208 | Train Loss: 3.616 Vali Loss: 3.831 Vali Acc: 0.057 Test Loss: 3.831 Test Acc: 0.057
Validation loss decreased (-0.053348 --> -0.057224).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5991719
	speed: 0.2833s/iter; left time: 5747.6025s
	iters: 200, epoch: 3 | loss: 3.5806804
	speed: 0.0454s/iter; left time: 915.8527s
Epoch: 3 cost time: 10.268044471740723
Epoch: 3, Steps: 208 | Train Loss: 3.450 Vali Loss: 3.836 Vali Acc: 0.062 Test Loss: 3.836 Test Acc: 0.062
Validation loss decreased (-0.057224 --> -0.061697).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9787474
	speed: 0.2862s/iter; left time: 5745.3967s
	iters: 200, epoch: 4 | loss: 3.3502245
	speed: 0.0355s/iter; left time: 709.0197s
Epoch: 4 cost time: 9.48404860496521
Epoch: 4, Steps: 208 | Train Loss: 3.258 Vali Loss: 3.875 Vali Acc: 0.066 Test Loss: 3.875 Test Acc: 0.066
Validation loss decreased (-0.061697 --> -0.065872).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3175220
	speed: 0.2817s/iter; left time: 5596.1523s
	iters: 200, epoch: 5 | loss: 3.4571223
	speed: 0.0442s/iter; left time: 873.9173s
Epoch: 5 cost time: 10.3258957862854
Epoch: 5, Steps: 208 | Train Loss: 3.106 Vali Loss: 3.931 Vali Acc: 0.077 Test Loss: 3.931 Test Acc: 0.077
Validation loss decreased (-0.065872 --> -0.077205).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8934059
	speed: 0.2658s/iter; left time: 5226.8475s
	iters: 200, epoch: 6 | loss: 3.6825497
	speed: 0.0380s/iter; left time: 743.1422s
Epoch: 6 cost time: 9.108486413955688
Epoch: 6, Steps: 208 | Train Loss: 2.965 Vali Loss: 4.005 Vali Acc: 0.072 Test Loss: 4.005 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0221608
	speed: 0.2672s/iter; left time: 5198.2654s
	iters: 200, epoch: 7 | loss: 3.0779684
	speed: 0.0353s/iter; left time: 682.9305s
Epoch: 7 cost time: 8.680981636047363
Epoch: 7, Steps: 208 | Train Loss: 2.899 Vali Loss: 4.021 Vali Acc: 0.086 Test Loss: 4.021 Test Acc: 0.086
Validation loss decreased (-0.077205 --> -0.086151).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7728288
	speed: 0.2739s/iter; left time: 5271.6047s
	iters: 200, epoch: 8 | loss: 4.0089993
	speed: 0.0383s/iter; left time: 734.1118s
Epoch: 8 cost time: 9.57375693321228
Epoch: 8, Steps: 208 | Train Loss: 2.763 Vali Loss: 4.011 Vali Acc: 0.092 Test Loss: 4.011 Test Acc: 0.092
Validation loss decreased (-0.086151 --> -0.092116).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1904705
	speed: 0.2575s/iter; left time: 4902.0317s
	iters: 200, epoch: 9 | loss: 3.3344421
	speed: 0.0351s/iter; left time: 664.8421s
Epoch: 9 cost time: 8.615111351013184
Epoch: 9, Steps: 208 | Train Loss: 2.637 Vali Loss: 4.130 Vali Acc: 0.089 Test Loss: 4.130 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7865350
	speed: 0.2637s/iter; left time: 4964.7229s
	iters: 200, epoch: 10 | loss: 2.6267557
	speed: 0.0341s/iter; left time: 639.4501s
Epoch: 10 cost time: 8.78597640991211
Epoch: 10, Steps: 208 | Train Loss: 2.519 Vali Loss: 4.254 Vali Acc: 0.092 Test Loss: 4.254 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.1192341
	speed: 0.2508s/iter; left time: 4670.1368s
	iters: 200, epoch: 11 | loss: 3.3003237
	speed: 0.0380s/iter; left time: 704.3053s
Epoch: 11 cost time: 8.81295895576477
Epoch: 11, Steps: 208 | Train Loss: 2.413 Vali Loss: 4.273 Vali Acc: 0.090 Test Loss: 4.273 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.2231021
	speed: 0.2390s/iter; left time: 4400.6999s
	iters: 200, epoch: 12 | loss: 2.8565967
	speed: 0.0399s/iter; left time: 730.5578s
Epoch: 12 cost time: 9.046719312667847
Epoch: 12, Steps: 208 | Train Loss: 2.291 Vali Loss: 4.338 Vali Acc: 0.089 Test Loss: 4.338 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.9193422
	speed: 0.2562s/iter; left time: 4664.7177s
	iters: 200, epoch: 13 | loss: 2.6837070
	speed: 0.0346s/iter; left time: 627.1888s
Epoch: 13 cost time: 9.14867615699768
Epoch: 13, Steps: 208 | Train Loss: 2.198 Vali Loss: 4.478 Vali Acc: 0.100 Test Loss: 4.478 Test Acc: 0.100
Validation loss decreased (-0.092116 --> -0.099568).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2319796
	speed: 0.2778s/iter; left time: 4999.1923s
	iters: 200, epoch: 14 | loss: 2.4901152
	speed: 0.0341s/iter; left time: 610.4595s
Epoch: 14 cost time: 9.377196788787842
Epoch: 14, Steps: 208 | Train Loss: 2.094 Vali Loss: 4.568 Vali Acc: 0.093 Test Loss: 4.568 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9565529
	speed: 0.2547s/iter; left time: 4531.4783s
	iters: 200, epoch: 15 | loss: 2.3034754
	speed: 0.0327s/iter; left time: 578.5378s
Epoch: 15 cost time: 8.720255851745605
Epoch: 15, Steps: 208 | Train Loss: 1.977 Vali Loss: 4.779 Vali Acc: 0.097 Test Loss: 4.779 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.4562347
	speed: 0.3265s/iter; left time: 5740.2503s
	iters: 200, epoch: 16 | loss: 2.7031541
	speed: 0.0478s/iter; left time: 834.7322s
Epoch: 16 cost time: 11.769903898239136
Epoch: 16, Steps: 208 | Train Loss: 1.879 Vali Loss: 4.894 Vali Acc: 0.098 Test Loss: 4.894 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.2619438
	speed: 0.3069s/iter; left time: 5331.3272s
	iters: 200, epoch: 17 | loss: 0.9920092
	speed: 0.0413s/iter; left time: 712.8485s
Epoch: 17 cost time: 10.251206159591675
Epoch: 17, Steps: 208 | Train Loss: 1.801 Vali Loss: 5.002 Vali Acc: 0.097 Test Loss: 5.002 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.8187946
	speed: 0.3164s/iter; left time: 5431.8047s
	iters: 200, epoch: 18 | loss: 1.6084819
	speed: 0.0451s/iter; left time: 769.4677s
Epoch: 18 cost time: 10.498904705047607
Epoch: 18, Steps: 208 | Train Loss: 1.709 Vali Loss: 5.243 Vali Acc: 0.099 Test Loss: 5.243 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.3802438
	speed: 0.3042s/iter; left time: 5158.7244s
	iters: 200, epoch: 19 | loss: 2.2489524
	speed: 0.0463s/iter; left time: 781.2756s
Epoch: 19 cost time: 10.044342279434204
Epoch: 19, Steps: 208 | Train Loss: 1.618 Vali Loss: 5.344 Vali Acc: 0.098 Test Loss: 5.344 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.8515725
	speed: 0.2800s/iter; left time: 4688.9978s
	iters: 200, epoch: 20 | loss: 1.5255159
	speed: 0.0401s/iter; left time: 667.9176s
Epoch: 20 cost time: 10.22765064239502
Epoch: 20, Steps: 208 | Train Loss: 1.488 Vali Loss: 5.560 Vali Acc: 0.100 Test Loss: 5.560 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.4673378
	speed: 0.3078s/iter; left time: 5090.7041s
	iters: 200, epoch: 21 | loss: 1.1756556
	speed: 0.0428s/iter; left time: 704.2536s
Epoch: 21 cost time: 10.04044222831726
Epoch: 21, Steps: 208 | Train Loss: 1.462 Vali Loss: 5.765 Vali Acc: 0.102 Test Loss: 5.765 Test Acc: 0.102
Validation loss decreased (-0.099568 --> -0.101941).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.1196364
	speed: 0.3124s/iter; left time: 5103.2088s
	iters: 200, epoch: 22 | loss: 1.3594897
	speed: 0.0462s/iter; left time: 749.4580s
Epoch: 22 cost time: 10.603387355804443
Epoch: 22, Steps: 208 | Train Loss: 1.364 Vali Loss: 5.931 Vali Acc: 0.102 Test Loss: 5.931 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.3192332
	speed: 0.3117s/iter; left time: 5026.2839s
	iters: 200, epoch: 23 | loss: 1.5074662
	speed: 0.0453s/iter; left time: 726.2722s
Epoch: 23 cost time: 10.923568964004517
Epoch: 23, Steps: 208 | Train Loss: 1.290 Vali Loss: 6.132 Vali Acc: 0.104 Test Loss: 6.132 Test Acc: 0.104
Validation loss decreased (-0.101941 --> -0.104025).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.2430433
	speed: 0.3154s/iter; left time: 5020.4347s
	iters: 200, epoch: 24 | loss: 1.5424976
	speed: 0.0440s/iter; left time: 695.9020s
Epoch: 24 cost time: 10.665828227996826
Epoch: 24, Steps: 208 | Train Loss: 1.227 Vali Loss: 6.461 Vali Acc: 0.102 Test Loss: 6.461 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.6231992
	speed: 0.3156s/iter; left time: 4958.1939s
	iters: 200, epoch: 25 | loss: 1.9712716
	speed: 0.0419s/iter; left time: 654.2597s
Epoch: 25 cost time: 10.544039011001587
Epoch: 25, Steps: 208 | Train Loss: 1.163 Vali Loss: 6.674 Vali Acc: 0.103 Test Loss: 6.674 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.8531514
	speed: 0.3177s/iter; left time: 4924.5383s
	iters: 200, epoch: 26 | loss: 0.9042147
	speed: 0.0422s/iter; left time: 649.7376s
Epoch: 26 cost time: 10.353087186813354
Epoch: 26, Steps: 208 | Train Loss: 1.113 Vali Loss: 6.859 Vali Acc: 0.095 Test Loss: 6.859 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.5075333
	speed: 0.3151s/iter; left time: 4819.0808s
	iters: 200, epoch: 27 | loss: 1.4198209
	speed: 0.0376s/iter; left time: 571.2494s
Epoch: 27 cost time: 9.969942092895508
Epoch: 27, Steps: 208 | Train Loss: 1.076 Vali Loss: 7.099 Vali Acc: 0.095 Test Loss: 7.099 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.8304218
	speed: 0.3048s/iter; left time: 4598.1145s
	iters: 200, epoch: 28 | loss: 0.9146199
	speed: 0.0389s/iter; left time: 583.1009s
Epoch: 28 cost time: 9.708751440048218
Epoch: 28, Steps: 208 | Train Loss: 1.055 Vali Loss: 7.254 Vali Acc: 0.095 Test Loss: 7.254 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.5783619
	speed: 0.2953s/iter; left time: 4393.8993s
	iters: 200, epoch: 29 | loss: 1.2703393
	speed: 0.0347s/iter; left time: 513.1003s
Epoch: 29 cost time: 9.265409469604492
Epoch: 29, Steps: 208 | Train Loss: 0.974 Vali Loss: 7.426 Vali Acc: 0.098 Test Loss: 7.426 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.9044642
	speed: 0.2866s/iter; left time: 4204.7227s
	iters: 200, epoch: 30 | loss: 0.5810966
	speed: 0.0388s/iter; left time: 565.5147s
Epoch: 30 cost time: 9.096031427383423
Epoch: 30, Steps: 208 | Train Loss: 0.915 Vali Loss: 7.637 Vali Acc: 0.099 Test Loss: 7.637 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.9415994
	speed: 0.2856s/iter; left time: 4130.2314s
	iters: 200, epoch: 31 | loss: 1.0992516
	speed: 0.0400s/iter; left time: 574.0753s
Epoch: 31 cost time: 9.407103776931763
Epoch: 31, Steps: 208 | Train Loss: 0.885 Vali Loss: 7.877 Vali Acc: 0.101 Test Loss: 7.877 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.7834323
	speed: 0.2806s/iter; left time: 3999.5741s
	iters: 200, epoch: 32 | loss: 1.3195373
	speed: 0.0410s/iter; left time: 580.6118s
Epoch: 32 cost time: 9.26626443862915
Epoch: 32, Steps: 208 | Train Loss: 0.834 Vali Loss: 8.127 Vali Acc: 0.100 Test Loss: 8.127 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.6705399
	speed: 0.2888s/iter; left time: 4055.5559s
	iters: 200, epoch: 33 | loss: 1.8217106
	speed: 0.0370s/iter; left time: 516.3774s
Epoch: 33 cost time: 9.39892053604126
Epoch: 33, Steps: 208 | Train Loss: 0.814 Vali Loss: 8.298 Vali Acc: 0.096 Test Loss: 8.298 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10408589322994334
model parameter : 110663
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6620684
	speed: 0.0885s/iter; left time: 1832.2682s
	iters: 200, epoch: 1 | loss: 5.4722266
	speed: 0.0416s/iter; left time: 857.1028s
Epoch: 1 cost time: 13.52927827835083
Epoch: 1, Steps: 208 | Train Loss: 4.623 Vali Loss: 5.494 Vali Acc: 0.055 Test Loss: 5.494 Test Acc: 0.055
Validation loss decreased (inf --> -0.055120).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7700896
	speed: 0.2825s/iter; left time: 5789.1834s
	iters: 200, epoch: 2 | loss: 4.6514301
	speed: 0.0527s/iter; left time: 1073.8036s
Epoch: 2 cost time: 11.608017206192017
Epoch: 2, Steps: 208 | Train Loss: 4.478 Vali Loss: 4.484 Vali Acc: 0.064 Test Loss: 4.484 Test Acc: 0.064
Validation loss decreased (-0.055120 --> -0.064077).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7056241
	speed: 0.2814s/iter; left time: 5708.7048s
	iters: 200, epoch: 3 | loss: 3.2688501
	speed: 0.0494s/iter; left time: 998.0852s
Epoch: 3 cost time: 11.415435314178467
Epoch: 3, Steps: 208 | Train Loss: 3.469 Vali Loss: 4.155 Vali Acc: 0.081 Test Loss: 4.155 Test Acc: 0.081
Validation loss decreased (-0.064077 --> -0.081378).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6704326
	speed: 0.2671s/iter; left time: 5362.9704s
	iters: 200, epoch: 4 | loss: 4.2406511
	speed: 0.0433s/iter; left time: 865.4862s
Epoch: 4 cost time: 10.358002424240112
Epoch: 4, Steps: 208 | Train Loss: 3.389 Vali Loss: 4.353 Vali Acc: 0.081 Test Loss: 4.353 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.6922202
	speed: 0.2907s/iter; left time: 5776.8074s
	iters: 200, epoch: 5 | loss: 3.5938408
	speed: 0.0441s/iter; left time: 871.8899s
Epoch: 5 cost time: 10.825977563858032
Epoch: 5, Steps: 208 | Train Loss: 3.310 Vali Loss: 4.490 Vali Acc: 0.097 Test Loss: 4.490 Test Acc: 0.097
Validation loss decreased (-0.081378 --> -0.096585).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6531625
	speed: 0.2903s/iter; left time: 5708.2420s
	iters: 200, epoch: 6 | loss: 4.0675597
	speed: 0.0490s/iter; left time: 958.5604s
Epoch: 6 cost time: 10.747344493865967
Epoch: 6, Steps: 208 | Train Loss: 3.116 Vali Loss: 4.803 Vali Acc: 0.088 Test Loss: 4.803 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.6435454
	speed: 0.3164s/iter; left time: 6154.1585s
	iters: 200, epoch: 7 | loss: 3.1780565
	speed: 0.0483s/iter; left time: 934.5823s
Epoch: 7 cost time: 11.944077968597412
Epoch: 7, Steps: 208 | Train Loss: 2.680 Vali Loss: 5.463 Vali Acc: 0.076 Test Loss: 5.463 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.7277849
	speed: 0.3019s/iter; left time: 5810.4245s
	iters: 200, epoch: 8 | loss: 2.3589544
	speed: 0.0434s/iter; left time: 831.5912s
Epoch: 8 cost time: 10.939344882965088
Epoch: 8, Steps: 208 | Train Loss: 2.222 Vali Loss: 5.064 Vali Acc: 0.104 Test Loss: 5.064 Test Acc: 0.104
Validation loss decreased (-0.096585 --> -0.104333).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1619320
	speed: 0.3143s/iter; left time: 5983.2946s
	iters: 200, epoch: 9 | loss: 1.4092031
	speed: 0.0635s/iter; left time: 1201.6261s
Epoch: 9 cost time: 13.640149593353271
Epoch: 9, Steps: 208 | Train Loss: 1.906 Vali Loss: 5.096 Vali Acc: 0.095 Test Loss: 5.096 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7209163
	speed: 0.3284s/iter; left time: 6183.9355s
	iters: 200, epoch: 10 | loss: 2.6295872
	speed: 0.0673s/iter; left time: 1261.1153s
Epoch: 10 cost time: 14.871841430664062
Epoch: 10, Steps: 208 | Train Loss: 1.687 Vali Loss: 5.357 Vali Acc: 0.098 Test Loss: 5.357 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5740223
	speed: 0.3167s/iter; left time: 5897.8842s
	iters: 200, epoch: 11 | loss: 2.3495493
	speed: 0.0604s/iter; left time: 1119.0141s
Epoch: 11 cost time: 13.733604192733765
Epoch: 11, Steps: 208 | Train Loss: 1.516 Vali Loss: 5.543 Vali Acc: 0.102 Test Loss: 5.543 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8059939
	speed: 0.3093s/iter; left time: 5695.5867s
	iters: 200, epoch: 12 | loss: 2.1697800
	speed: 0.0460s/iter; left time: 842.8463s
Epoch: 12 cost time: 11.434239625930786
Epoch: 12, Steps: 208 | Train Loss: 1.386 Vali Loss: 5.994 Vali Acc: 0.101 Test Loss: 5.994 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1651077
	speed: 0.3323s/iter; left time: 6050.1338s
	iters: 200, epoch: 13 | loss: 1.1798548
	speed: 0.0568s/iter; left time: 1029.2499s
Epoch: 13 cost time: 13.598532438278198
Epoch: 13, Steps: 208 | Train Loss: 1.130 Vali Loss: 6.867 Vali Acc: 0.115 Test Loss: 6.867 Test Acc: 0.115
Validation loss decreased (-0.104333 --> -0.115052).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2694105
	speed: 0.3182s/iter; left time: 5727.0898s
	iters: 200, epoch: 14 | loss: 1.4806687
	speed: 0.0642s/iter; left time: 1148.9687s
Epoch: 14 cost time: 12.696468114852905
Epoch: 14, Steps: 208 | Train Loss: 1.017 Vali Loss: 6.894 Vali Acc: 0.102 Test Loss: 6.894 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2635797
	speed: 0.3021s/iter; left time: 5374.4334s
	iters: 200, epoch: 15 | loss: 1.2468598
	speed: 0.0506s/iter; left time: 894.9603s
Epoch: 15 cost time: 12.086641311645508
Epoch: 15, Steps: 208 | Train Loss: 0.828 Vali Loss: 7.847 Vali Acc: 0.109 Test Loss: 7.847 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3896824
	speed: 0.3063s/iter; left time: 5384.6522s
	iters: 200, epoch: 16 | loss: 0.6315614
	speed: 0.0540s/iter; left time: 943.8168s
Epoch: 16 cost time: 12.424043655395508
Epoch: 16, Steps: 208 | Train Loss: 0.686 Vali Loss: 8.288 Vali Acc: 0.103 Test Loss: 8.288 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2202950
	speed: 0.3231s/iter; left time: 5613.3637s
	iters: 200, epoch: 17 | loss: 1.1360537
	speed: 0.0678s/iter; left time: 1171.0258s
Epoch: 17 cost time: 14.979488611221313
Epoch: 17, Steps: 208 | Train Loss: 0.607 Vali Loss: 8.785 Vali Acc: 0.113 Test Loss: 8.785 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2383396
	speed: 0.3090s/iter; left time: 5303.6713s
	iters: 200, epoch: 18 | loss: 0.2671460
	speed: 0.0624s/iter; left time: 1065.0982s
Epoch: 18 cost time: 13.595290660858154
Epoch: 18, Steps: 208 | Train Loss: 0.505 Vali Loss: 9.491 Vali Acc: 0.106 Test Loss: 9.491 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.2977407
	speed: 0.3226s/iter; left time: 5470.7379s
	iters: 200, epoch: 19 | loss: 0.3383414
	speed: 0.0520s/iter; left time: 876.6919s
Epoch: 19 cost time: 12.304259061813354
Epoch: 19, Steps: 208 | Train Loss: 0.461 Vali Loss: 9.677 Vali Acc: 0.104 Test Loss: 9.677 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1895470
	speed: 0.3200s/iter; left time: 5359.3354s
	iters: 200, epoch: 20 | loss: 0.0798174
	speed: 0.0493s/iter; left time: 820.5636s
Epoch: 20 cost time: 12.07970929145813
Epoch: 20, Steps: 208 | Train Loss: 0.380 Vali Loss: 10.651 Vali Acc: 0.112 Test Loss: 10.651 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2799363
	speed: 0.3105s/iter; left time: 5135.8220s
	iters: 200, epoch: 21 | loss: 0.1474720
	speed: 0.0542s/iter; left time: 891.3837s
Epoch: 21 cost time: 13.074854135513306
Epoch: 21, Steps: 208 | Train Loss: 0.349 Vali Loss: 11.264 Vali Acc: 0.110 Test Loss: 11.264 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6858897
	speed: 0.3082s/iter; left time: 5034.1368s
	iters: 200, epoch: 22 | loss: 0.4923612
	speed: 0.0511s/iter; left time: 829.5008s
Epoch: 22 cost time: 11.994327068328857
Epoch: 22, Steps: 208 | Train Loss: 0.313 Vali Loss: 10.944 Vali Acc: 0.104 Test Loss: 10.944 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4288045
	speed: 0.3153s/iter; left time: 5083.6116s
	iters: 200, epoch: 23 | loss: 0.6304074
	speed: 0.0525s/iter; left time: 841.1553s
Epoch: 23 cost time: 12.280159711837769
Epoch: 23, Steps: 208 | Train Loss: 0.304 Vali Loss: 11.889 Vali Acc: 0.114 Test Loss: 11.889 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11512078735460782
model parameter : 997255
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2157626
	speed: 0.0883s/iter; left time: 1827.2217s
	iters: 200, epoch: 1 | loss: 4.1989508
	speed: 0.0454s/iter; left time: 934.4868s
Epoch: 1 cost time: 13.844646453857422
Epoch: 1, Steps: 208 | Train Loss: 4.078 Vali Loss: 4.537 Vali Acc: 0.062 Test Loss: 4.537 Test Acc: 0.062
Validation loss decreased (inf --> -0.062287).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2865281
	speed: 0.2735s/iter; left time: 5605.4468s
	iters: 200, epoch: 2 | loss: 3.7803073
	speed: 0.0411s/iter; left time: 838.2607s
Epoch: 2 cost time: 9.339524507522583
Epoch: 2, Steps: 208 | Train Loss: 3.882 Vali Loss: 4.192 Vali Acc: 0.078 Test Loss: 4.192 Test Acc: 0.078
Validation loss decreased (-0.062287 --> -0.077501).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8299799
	speed: 0.2538s/iter; left time: 5147.9889s
	iters: 200, epoch: 3 | loss: 3.6250646
	speed: 0.0372s/iter; left time: 750.7473s
Epoch: 3 cost time: 8.80851697921753
Epoch: 3, Steps: 208 | Train Loss: 3.507 Vali Loss: 4.137 Vali Acc: 0.082 Test Loss: 4.137 Test Acc: 0.082
Validation loss decreased (-0.077501 --> -0.081975).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5653210
	speed: 0.2450s/iter; left time: 4919.5810s
	iters: 200, epoch: 4 | loss: 3.2549267
	speed: 0.0433s/iter; left time: 865.9477s
Epoch: 4 cost time: 9.500564575195312
Epoch: 4, Steps: 208 | Train Loss: 3.158 Vali Loss: 4.208 Vali Acc: 0.094 Test Loss: 4.208 Test Acc: 0.094
Validation loss decreased (-0.081975 --> -0.094202).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4781766
	speed: 0.2527s/iter; left time: 5020.9175s
	iters: 200, epoch: 5 | loss: 2.9234028
	speed: 0.0470s/iter; left time: 928.4720s
Epoch: 5 cost time: 10.130252122879028
Epoch: 5, Steps: 208 | Train Loss: 2.982 Vali Loss: 5.022 Vali Acc: 0.076 Test Loss: 5.022 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.3771093
	speed: 0.2798s/iter; left time: 5502.0307s
	iters: 200, epoch: 6 | loss: 3.5935500
	speed: 0.0448s/iter; left time: 875.7747s
Epoch: 6 cost time: 11.05887746810913
Epoch: 6, Steps: 208 | Train Loss: 2.863 Vali Loss: 4.663 Vali Acc: 0.097 Test Loss: 4.663 Test Acc: 0.097
Validation loss decreased (-0.094202 --> -0.096583).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8205001
	speed: 0.2645s/iter; left time: 5146.0044s
	iters: 200, epoch: 7 | loss: 2.6028302
	speed: 0.0426s/iter; left time: 823.8786s
Epoch: 7 cost time: 10.71995735168457
Epoch: 7, Steps: 208 | Train Loss: 2.627 Vali Loss: 4.943 Vali Acc: 0.087 Test Loss: 4.943 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5511680
	speed: 0.2640s/iter; left time: 5081.4991s
	iters: 200, epoch: 8 | loss: 2.4969025
	speed: 0.0437s/iter; left time: 837.0022s
Epoch: 8 cost time: 9.893500328063965
Epoch: 8, Steps: 208 | Train Loss: 2.432 Vali Loss: 4.775 Vali Acc: 0.095 Test Loss: 4.775 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5775006
	speed: 0.2611s/iter; left time: 4969.7318s
	iters: 200, epoch: 9 | loss: 2.2237365
	speed: 0.0434s/iter; left time: 822.2144s
Epoch: 9 cost time: 9.853995323181152
Epoch: 9, Steps: 208 | Train Loss: 2.216 Vali Loss: 4.464 Vali Acc: 0.107 Test Loss: 4.464 Test Acc: 0.107
Validation loss decreased (-0.096583 --> -0.107322).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8096085
	speed: 0.2786s/iter; left time: 5245.1499s
	iters: 200, epoch: 10 | loss: 1.5720735
	speed: 0.0566s/iter; left time: 1059.6741s
Epoch: 10 cost time: 12.44711184501648
Epoch: 10, Steps: 208 | Train Loss: 1.934 Vali Loss: 4.649 Vali Acc: 0.121 Test Loss: 4.649 Test Acc: 0.121
Validation loss decreased (-0.107322 --> -0.121337).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7090322
	speed: 0.2697s/iter; left time: 5021.2670s
	iters: 200, epoch: 11 | loss: 2.4359245
	speed: 0.0498s/iter; left time: 921.6738s
Epoch: 11 cost time: 11.365689754486084
Epoch: 11, Steps: 208 | Train Loss: 1.750 Vali Loss: 4.985 Vali Acc: 0.121 Test Loss: 4.985 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5442163
	speed: 0.2992s/iter; left time: 5508.4201s
	iters: 200, epoch: 12 | loss: 2.1723592
	speed: 0.0508s/iter; left time: 930.0597s
Epoch: 12 cost time: 12.28507375717163
Epoch: 12, Steps: 208 | Train Loss: 1.600 Vali Loss: 5.206 Vali Acc: 0.119 Test Loss: 5.206 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5484517
	speed: 0.3005s/iter; left time: 5470.3246s
	iters: 200, epoch: 13 | loss: 1.6483464
	speed: 0.0619s/iter; left time: 1120.9888s
Epoch: 13 cost time: 13.904304265975952
Epoch: 13, Steps: 208 | Train Loss: 1.397 Vali Loss: 5.573 Vali Acc: 0.121 Test Loss: 5.573 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4135058
	speed: 0.2653s/iter; left time: 4773.9425s
	iters: 200, epoch: 14 | loss: 1.7407110
	speed: 0.0480s/iter; left time: 858.5312s
Epoch: 14 cost time: 10.642815113067627
Epoch: 14, Steps: 208 | Train Loss: 1.233 Vali Loss: 6.050 Vali Acc: 0.109 Test Loss: 6.050 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2974559
	speed: 0.2785s/iter; left time: 4955.0983s
	iters: 200, epoch: 15 | loss: 1.1567755
	speed: 0.0522s/iter; left time: 923.9094s
Epoch: 15 cost time: 11.195313692092896
Epoch: 15, Steps: 208 | Train Loss: 1.071 Vali Loss: 6.608 Vali Acc: 0.106 Test Loss: 6.608 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.8093328
	speed: 0.2823s/iter; left time: 4963.7189s
	iters: 200, epoch: 16 | loss: 1.3108493
	speed: 0.0542s/iter; left time: 947.7463s
Epoch: 16 cost time: 12.4516761302948
Epoch: 16, Steps: 208 | Train Loss: 0.933 Vali Loss: 6.790 Vali Acc: 0.109 Test Loss: 6.790 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.1066338
	speed: 0.2765s/iter; left time: 4803.6223s
	iters: 200, epoch: 17 | loss: 0.9219499
	speed: 0.0464s/iter; left time: 800.8336s
Epoch: 17 cost time: 10.734947204589844
Epoch: 17, Steps: 208 | Train Loss: 0.865 Vali Loss: 7.242 Vali Acc: 0.113 Test Loss: 7.242 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.4179423
	speed: 0.2661s/iter; left time: 4566.8817s
	iters: 200, epoch: 18 | loss: 1.0054066
	speed: 0.0429s/iter; left time: 731.6547s
Epoch: 18 cost time: 10.610061168670654
Epoch: 18, Steps: 208 | Train Loss: 0.784 Vali Loss: 7.452 Vali Acc: 0.107 Test Loss: 7.452 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.2501380
	speed: 0.2897s/iter; left time: 4912.0956s
	iters: 200, epoch: 19 | loss: 0.3149077
	speed: 0.0618s/iter; left time: 1042.3745s
Epoch: 19 cost time: 13.837186098098755
Epoch: 19, Steps: 208 | Train Loss: 0.678 Vali Loss: 8.031 Vali Acc: 0.108 Test Loss: 8.031 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.2536464
	speed: 0.2616s/iter; left time: 4382.3119s
	iters: 200, epoch: 20 | loss: 1.0746807
	speed: 0.0443s/iter; left time: 736.9496s
Epoch: 20 cost time: 10.651196479797363
Epoch: 20, Steps: 208 | Train Loss: 0.614 Vali Loss: 8.506 Vali Acc: 0.117 Test Loss: 8.506 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12138383537130927
model parameter : 503207
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2942734
	speed: 0.0870s/iter; left time: 1801.8042s
	iters: 200, epoch: 1 | loss: 4.4041390
	speed: 0.0457s/iter; left time: 941.3009s
Epoch: 1 cost time: 13.873236179351807
Epoch: 1, Steps: 208 | Train Loss: 3.962 Vali Loss: 4.035 Vali Acc: 0.059 Test Loss: 4.035 Test Acc: 0.059
Validation loss decreased (inf --> -0.059309).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0729332
	speed: 0.2556s/iter; left time: 5237.9978s
	iters: 200, epoch: 2 | loss: 3.6619337
	speed: 0.0393s/iter; left time: 801.9749s
Epoch: 2 cost time: 9.377198219299316
Epoch: 2, Steps: 208 | Train Loss: 3.723 Vali Loss: 4.295 Vali Acc: 0.068 Test Loss: 4.295 Test Acc: 0.068
Validation loss decreased (-0.059309 --> -0.067658).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8408771
	speed: 0.2722s/iter; left time: 5522.5807s
	iters: 200, epoch: 3 | loss: 3.0684059
	speed: 0.0396s/iter; left time: 798.3996s
Epoch: 3 cost time: 9.647693872451782
Epoch: 3, Steps: 208 | Train Loss: 3.379 Vali Loss: 4.515 Vali Acc: 0.070 Test Loss: 4.515 Test Acc: 0.070
Validation loss decreased (-0.067658 --> -0.069743).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4943099
	speed: 0.2848s/iter; left time: 5717.6568s
	iters: 200, epoch: 4 | loss: 3.1813707
	speed: 0.0509s/iter; left time: 1017.2790s
Epoch: 4 cost time: 12.463570594787598
Epoch: 4, Steps: 208 | Train Loss: 3.097 Vali Loss: 4.667 Vali Acc: 0.078 Test Loss: 4.667 Test Acc: 0.078
Validation loss decreased (-0.069743 --> -0.078092).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9964411
	speed: 0.2941s/iter; left time: 5844.3369s
	iters: 200, epoch: 5 | loss: 2.9424214
	speed: 0.0561s/iter; left time: 1109.1198s
Epoch: 5 cost time: 12.71081018447876
Epoch: 5, Steps: 208 | Train Loss: 2.921 Vali Loss: 4.654 Vali Acc: 0.086 Test Loss: 4.654 Test Acc: 0.086
Validation loss decreased (-0.078092 --> -0.085847).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7365422
	speed: 0.2836s/iter; left time: 5576.7918s
	iters: 200, epoch: 6 | loss: 2.9256494
	speed: 0.0379s/iter; left time: 741.0139s
Epoch: 6 cost time: 9.501297235488892
Epoch: 6, Steps: 208 | Train Loss: 2.777 Vali Loss: 4.501 Vali Acc: 0.098 Test Loss: 4.501 Test Acc: 0.098
Validation loss decreased (-0.085847 --> -0.097480).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7898290
	speed: 0.2793s/iter; left time: 5433.6666s
	iters: 200, epoch: 7 | loss: 2.7586470
	speed: 0.0389s/iter; left time: 753.7332s
Epoch: 7 cost time: 9.668653011322021
Epoch: 7, Steps: 208 | Train Loss: 2.565 Vali Loss: 4.513 Vali Acc: 0.104 Test Loss: 4.513 Test Acc: 0.104
Validation loss decreased (-0.097480 --> -0.104041).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.9598787
	speed: 0.2724s/iter; left time: 5241.5953s
	iters: 200, epoch: 8 | loss: 3.3938823
	speed: 0.0482s/iter; left time: 922.7097s
Epoch: 8 cost time: 11.02429723739624
Epoch: 8, Steps: 208 | Train Loss: 2.381 Vali Loss: 4.480 Vali Acc: 0.095 Test Loss: 4.480 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.6138871
	speed: 0.2661s/iter; left time: 5066.6296s
	iters: 200, epoch: 9 | loss: 2.4521933
	speed: 0.0446s/iter; left time: 844.5968s
Epoch: 9 cost time: 10.523388147354126
Epoch: 9, Steps: 208 | Train Loss: 2.214 Vali Loss: 4.527 Vali Acc: 0.111 Test Loss: 4.527 Test Acc: 0.111
Validation loss decreased (-0.104041 --> -0.110900).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1884549
	speed: 0.2581s/iter; left time: 4858.9294s
	iters: 200, epoch: 10 | loss: 3.2777424
	speed: 0.0491s/iter; left time: 919.2754s
Epoch: 10 cost time: 11.039860725402832
Epoch: 10, Steps: 208 | Train Loss: 2.036 Vali Loss: 4.647 Vali Acc: 0.109 Test Loss: 4.647 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9622658
	speed: 0.3055s/iter; left time: 5688.4731s
	iters: 200, epoch: 11 | loss: 2.3488264
	speed: 0.0508s/iter; left time: 940.8709s
Epoch: 11 cost time: 12.852513790130615
Epoch: 11, Steps: 208 | Train Loss: 1.863 Vali Loss: 4.749 Vali Acc: 0.113 Test Loss: 4.749 Test Acc: 0.113
Validation loss decreased (-0.110900 --> -0.113284).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4920248
	speed: 0.2921s/iter; left time: 5378.8518s
	iters: 200, epoch: 12 | loss: 2.4379022
	speed: 0.0620s/iter; left time: 1134.9977s
Epoch: 12 cost time: 13.726906776428223
Epoch: 12, Steps: 208 | Train Loss: 1.709 Vali Loss: 5.097 Vali Acc: 0.111 Test Loss: 5.097 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6576983
	speed: 0.2952s/iter; left time: 5373.6869s
	iters: 200, epoch: 13 | loss: 2.0883646
	speed: 0.0524s/iter; left time: 948.5950s
Epoch: 13 cost time: 12.212872982025146
Epoch: 13, Steps: 208 | Train Loss: 1.562 Vali Loss: 5.260 Vali Acc: 0.102 Test Loss: 5.260 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5862194
	speed: 0.2932s/iter; left time: 5276.8053s
	iters: 200, epoch: 14 | loss: 2.1382020
	speed: 0.0478s/iter; left time: 854.9641s
Epoch: 14 cost time: 11.465254306793213
Epoch: 14, Steps: 208 | Train Loss: 1.436 Vali Loss: 5.550 Vali Acc: 0.111 Test Loss: 5.550 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0181997
	speed: 0.2927s/iter; left time: 5206.4460s
	iters: 200, epoch: 15 | loss: 1.8572174
	speed: 0.0599s/iter; left time: 1058.6919s
Epoch: 15 cost time: 13.672645568847656
Epoch: 15, Steps: 208 | Train Loss: 1.315 Vali Loss: 5.887 Vali Acc: 0.097 Test Loss: 5.887 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2565017
	speed: 0.2840s/iter; left time: 4993.2196s
	iters: 200, epoch: 16 | loss: 1.3023810
	speed: 0.0459s/iter; left time: 803.0935s
Epoch: 16 cost time: 10.963121175765991
Epoch: 16, Steps: 208 | Train Loss: 1.196 Vali Loss: 6.154 Vali Acc: 0.098 Test Loss: 6.154 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9864697
	speed: 0.2950s/iter; left time: 5124.4026s
	iters: 200, epoch: 17 | loss: 0.8184698
	speed: 0.0481s/iter; left time: 830.2400s
Epoch: 17 cost time: 11.375848770141602
Epoch: 17, Steps: 208 | Train Loss: 1.058 Vali Loss: 6.496 Vali Acc: 0.104 Test Loss: 6.496 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3057390
	speed: 0.2898s/iter; left time: 4974.5054s
	iters: 200, epoch: 18 | loss: 0.8548356
	speed: 0.0628s/iter; left time: 1071.6043s
Epoch: 18 cost time: 13.615522861480713
Epoch: 18, Steps: 208 | Train Loss: 1.005 Vali Loss: 6.849 Vali Acc: 0.109 Test Loss: 6.849 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.9296801
	speed: 0.2675s/iter; left time: 4535.6225s
	iters: 200, epoch: 19 | loss: 0.5833325
	speed: 0.0459s/iter; left time: 773.7034s
Epoch: 19 cost time: 10.965991020202637
Epoch: 19, Steps: 208 | Train Loss: 0.899 Vali Loss: 7.040 Vali Acc: 0.104 Test Loss: 7.040 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2958879
	speed: 0.2800s/iter; left time: 4689.5560s
	iters: 200, epoch: 20 | loss: 0.8005239
	speed: 0.0436s/iter; left time: 725.7088s
Epoch: 20 cost time: 10.43870210647583
Epoch: 20, Steps: 208 | Train Loss: 0.845 Vali Loss: 7.408 Vali Acc: 0.105 Test Loss: 7.408 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.5636619
	speed: 0.2886s/iter; left time: 4774.0886s
	iters: 200, epoch: 21 | loss: 0.5699952
	speed: 0.0548s/iter; left time: 900.9993s
Epoch: 21 cost time: 12.61424207687378
Epoch: 21, Steps: 208 | Train Loss: 0.807 Vali Loss: 7.747 Vali Acc: 0.106 Test Loss: 7.747 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11333134506412168
model parameter : 338663
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8223469
	speed: 0.0829s/iter; left time: 1716.3201s
	iters: 200, epoch: 1 | loss: 4.1262112
	speed: 0.0412s/iter; left time: 848.2984s
Epoch: 1 cost time: 12.974576950073242
Epoch: 1, Steps: 208 | Train Loss: 3.890 Vali Loss: 3.948 Vali Acc: 0.058 Test Loss: 3.948 Test Acc: 0.058
Validation loss decreased (inf --> -0.058117).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5252719
	speed: 0.3156s/iter; left time: 6466.6640s
	iters: 200, epoch: 2 | loss: 3.7744691
	speed: 0.0391s/iter; left time: 796.8825s
Epoch: 2 cost time: 9.490758657455444
Epoch: 2, Steps: 208 | Train Loss: 3.668 Vali Loss: 4.043 Vali Acc: 0.072 Test Loss: 4.043 Test Acc: 0.072
Validation loss decreased (-0.058117 --> -0.071537).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3831604
	speed: 0.2880s/iter; left time: 5842.8471s
	iters: 200, epoch: 3 | loss: 3.0568020
	speed: 0.0490s/iter; left time: 988.1394s
Epoch: 3 cost time: 10.460162162780762
Epoch: 3, Steps: 208 | Train Loss: 3.326 Vali Loss: 4.104 Vali Acc: 0.082 Test Loss: 4.104 Test Acc: 0.082
Validation loss decreased (-0.071537 --> -0.081975).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7067804
	speed: 0.3009s/iter; left time: 6041.7657s
	iters: 200, epoch: 4 | loss: 4.2828770
	speed: 0.0433s/iter; left time: 864.6271s
Epoch: 4 cost time: 10.246750116348267
Epoch: 4, Steps: 208 | Train Loss: 3.111 Vali Loss: 4.253 Vali Acc: 0.087 Test Loss: 4.253 Test Acc: 0.087
Validation loss decreased (-0.081975 --> -0.087044).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0920756
	speed: 0.2952s/iter; left time: 5865.2708s
	iters: 200, epoch: 5 | loss: 2.8675654
	speed: 0.0443s/iter; left time: 876.1857s
Epoch: 5 cost time: 10.557598114013672
Epoch: 5, Steps: 208 | Train Loss: 2.936 Vali Loss: 4.191 Vali Acc: 0.098 Test Loss: 4.191 Test Acc: 0.098
Validation loss decreased (-0.087044 --> -0.097483).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2731807
	speed: 0.3190s/iter; left time: 6271.3267s
	iters: 200, epoch: 6 | loss: 2.9394259
	speed: 0.0391s/iter; left time: 765.6338s
Epoch: 6 cost time: 10.279773473739624
Epoch: 6, Steps: 208 | Train Loss: 2.773 Vali Loss: 4.335 Vali Acc: 0.102 Test Loss: 4.335 Test Acc: 0.102
Validation loss decreased (-0.097483 --> -0.101657).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9776497
	speed: 0.2912s/iter; left time: 5664.9024s
	iters: 200, epoch: 7 | loss: 2.6429121
	speed: 0.0449s/iter; left time: 868.9515s
Epoch: 7 cost time: 9.993967294692993
Epoch: 7, Steps: 208 | Train Loss: 2.644 Vali Loss: 4.283 Vali Acc: 0.104 Test Loss: 4.283 Test Acc: 0.104
Validation loss decreased (-0.101657 --> -0.103745).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0295856
	speed: 0.3012s/iter; left time: 5797.1700s
	iters: 200, epoch: 8 | loss: 2.5330076
	speed: 0.0407s/iter; left time: 779.2228s
Epoch: 8 cost time: 9.538140773773193
Epoch: 8, Steps: 208 | Train Loss: 2.454 Vali Loss: 4.475 Vali Acc: 0.103 Test Loss: 4.475 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1898677
	speed: 0.2969s/iter; left time: 5652.2856s
	iters: 200, epoch: 9 | loss: 3.0239060
	speed: 0.0421s/iter; left time: 796.6156s
Epoch: 9 cost time: 9.711261749267578
Epoch: 9, Steps: 208 | Train Loss: 2.324 Vali Loss: 4.384 Vali Acc: 0.113 Test Loss: 4.384 Test Acc: 0.113
Validation loss decreased (-0.103745 --> -0.112691).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7031059
	speed: 0.3016s/iter; left time: 5678.3975s
	iters: 200, epoch: 10 | loss: 2.7287838
	speed: 0.0459s/iter; left time: 860.2873s
Epoch: 10 cost time: 10.610182523727417
Epoch: 10, Steps: 208 | Train Loss: 2.179 Vali Loss: 4.566 Vali Acc: 0.093 Test Loss: 4.566 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3391902
	speed: 0.2915s/iter; left time: 5428.0807s
	iters: 200, epoch: 11 | loss: 2.4483564
	speed: 0.0434s/iter; left time: 803.5063s
Epoch: 11 cost time: 10.535455226898193
Epoch: 11, Steps: 208 | Train Loss: 2.037 Vali Loss: 4.626 Vali Acc: 0.112 Test Loss: 4.626 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.9869853
	speed: 0.2801s/iter; left time: 5157.2598s
	iters: 200, epoch: 12 | loss: 1.6145582
	speed: 0.0397s/iter; left time: 726.1771s
Epoch: 12 cost time: 8.283815145492554
Epoch: 12, Steps: 208 | Train Loss: 1.884 Vali Loss: 4.824 Vali Acc: 0.108 Test Loss: 4.824 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.2093208
	speed: 0.2773s/iter; left time: 5048.9923s
	iters: 200, epoch: 13 | loss: 1.3406906
	speed: 0.0332s/iter; left time: 600.8909s
Epoch: 13 cost time: 8.282020092010498
Epoch: 13, Steps: 208 | Train Loss: 1.751 Vali Loss: 5.081 Vali Acc: 0.106 Test Loss: 5.081 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.8362567
	speed: 0.2724s/iter; left time: 4901.5473s
	iters: 200, epoch: 14 | loss: 1.7545161
	speed: 0.0388s/iter; left time: 694.9490s
Epoch: 14 cost time: 9.121309280395508
Epoch: 14, Steps: 208 | Train Loss: 1.616 Vali Loss: 5.135 Vali Acc: 0.109 Test Loss: 5.135 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.0109918
	speed: 0.2796s/iter; left time: 4974.0913s
	iters: 200, epoch: 15 | loss: 1.8243167
	speed: 0.0448s/iter; left time: 792.0537s
Epoch: 15 cost time: 10.014894485473633
Epoch: 15, Steps: 208 | Train Loss: 1.494 Vali Loss: 5.468 Vali Acc: 0.113 Test Loss: 5.468 Test Acc: 0.113
Validation loss decreased (-0.112691 --> -0.113277).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6936896
	speed: 0.2898s/iter; left time: 5094.2671s
	iters: 200, epoch: 16 | loss: 1.9204559
	speed: 0.0438s/iter; left time: 764.9822s
Epoch: 16 cost time: 10.082792043685913
Epoch: 16, Steps: 208 | Train Loss: 1.383 Vali Loss: 5.629 Vali Acc: 0.110 Test Loss: 5.629 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.6168230
	speed: 0.2828s/iter; left time: 4913.7308s
	iters: 200, epoch: 17 | loss: 1.2388825
	speed: 0.0363s/iter; left time: 626.6219s
Epoch: 17 cost time: 9.339807748794556
Epoch: 17, Steps: 208 | Train Loss: 1.309 Vali Loss: 5.949 Vali Acc: 0.112 Test Loss: 5.949 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4254378
	speed: 0.2758s/iter; left time: 4733.7632s
	iters: 200, epoch: 18 | loss: 1.4614463
	speed: 0.0390s/iter; left time: 664.8493s
Epoch: 18 cost time: 9.080434799194336
Epoch: 18, Steps: 208 | Train Loss: 1.213 Vali Loss: 6.102 Vali Acc: 0.112 Test Loss: 6.102 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4490741
	speed: 0.2950s/iter; left time: 5001.4960s
	iters: 200, epoch: 19 | loss: 1.6721517
	speed: 0.0395s/iter; left time: 666.2486s
Epoch: 19 cost time: 10.15398645401001
Epoch: 19, Steps: 208 | Train Loss: 1.104 Vali Loss: 6.420 Vali Acc: 0.119 Test Loss: 6.420 Test Acc: 0.119
Validation loss decreased (-0.113277 --> -0.119232).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.8234180
	speed: 0.2998s/iter; left time: 5020.6559s
	iters: 200, epoch: 20 | loss: 1.9259940
	speed: 0.0415s/iter; left time: 690.6110s
Epoch: 20 cost time: 10.399562358856201
Epoch: 20, Steps: 208 | Train Loss: 1.006 Vali Loss: 6.790 Vali Acc: 0.101 Test Loss: 6.790 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.9631336
	speed: 0.2869s/iter; left time: 4746.3206s
	iters: 200, epoch: 21 | loss: 0.5385735
	speed: 0.0399s/iter; left time: 656.0482s
Epoch: 21 cost time: 8.971920728683472
Epoch: 21, Steps: 208 | Train Loss: 0.960 Vali Loss: 7.067 Vali Acc: 0.108 Test Loss: 7.067 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4093890
	speed: 0.2909s/iter; left time: 4751.0892s
	iters: 200, epoch: 22 | loss: 0.9162714
	speed: 0.0419s/iter; left time: 679.7682s
Epoch: 22 cost time: 9.772988557815552
Epoch: 22, Steps: 208 | Train Loss: 0.861 Vali Loss: 7.366 Vali Acc: 0.110 Test Loss: 7.366 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.5806506
	speed: 0.2751s/iter; left time: 4436.3540s
	iters: 200, epoch: 23 | loss: 1.3399713
	speed: 0.0356s/iter; left time: 570.1382s
Epoch: 23 cost time: 8.692634582519531
Epoch: 23, Steps: 208 | Train Loss: 0.815 Vali Loss: 7.502 Vali Acc: 0.112 Test Loss: 7.502 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.9228804
	speed: 0.2484s/iter; left time: 3953.7123s
	iters: 200, epoch: 24 | loss: 1.0437331
	speed: 0.0403s/iter; left time: 636.6360s
Epoch: 24 cost time: 9.460425853729248
Epoch: 24, Steps: 208 | Train Loss: 0.775 Vali Loss: 7.801 Vali Acc: 0.113 Test Loss: 7.801 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.3317683
	speed: 0.2526s/iter; left time: 3967.7973s
	iters: 200, epoch: 25 | loss: 1.0507377
	speed: 0.0437s/iter; left time: 681.6452s
Epoch: 25 cost time: 9.712697982788086
Epoch: 25, Steps: 208 | Train Loss: 0.713 Vali Loss: 8.110 Vali Acc: 0.105 Test Loss: 8.110 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.9194629
	speed: 0.2686s/iter; left time: 4163.8517s
	iters: 200, epoch: 26 | loss: 0.2800451
	speed: 0.0443s/iter; left time: 681.6338s
Epoch: 26 cost time: 10.5602707862854
Epoch: 26, Steps: 208 | Train Loss: 0.697 Vali Loss: 8.301 Vali Acc: 0.108 Test Loss: 8.301 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.6818880
	speed: 0.2461s/iter; left time: 3762.8668s
	iters: 200, epoch: 27 | loss: 0.6534098
	speed: 0.0369s/iter; left time: 560.4128s
Epoch: 27 cost time: 9.0957350730896
Epoch: 27, Steps: 208 | Train Loss: 0.618 Vali Loss: 8.619 Vali Acc: 0.112 Test Loss: 8.619 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2530863
	speed: 0.2620s/iter; left time: 3952.8288s
	iters: 200, epoch: 28 | loss: 0.6847672
	speed: 0.0377s/iter; left time: 564.7568s
Epoch: 28 cost time: 9.033873558044434
Epoch: 28, Steps: 208 | Train Loss: 0.589 Vali Loss: 8.959 Vali Acc: 0.102 Test Loss: 8.959 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.4134662
	speed: 0.2527s/iter; left time: 3759.7554s
	iters: 200, epoch: 29 | loss: 0.7168180
	speed: 0.0412s/iter; left time: 608.9742s
Epoch: 29 cost time: 9.274455785751343
Epoch: 29, Steps: 208 | Train Loss: 0.572 Vali Loss: 9.447 Vali Acc: 0.105 Test Loss: 9.447 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11929615269907545
model parameter : 270183
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9563165
	speed: 0.0719s/iter; left time: 1488.0545s
	iters: 200, epoch: 1 | loss: 3.5237343
	speed: 0.0375s/iter; left time: 773.3391s
Epoch: 1 cost time: 11.490376472473145
Epoch: 1, Steps: 208 | Train Loss: 3.822 Vali Loss: 3.809 Vali Acc: 0.056 Test Loss: 3.809 Test Acc: 0.056
Validation loss decreased (inf --> -0.055733).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4103808
	speed: 0.2782s/iter; left time: 5702.1255s
	iters: 200, epoch: 2 | loss: 3.6855433
	speed: 0.0383s/iter; left time: 780.6676s
Epoch: 2 cost time: 8.880738735198975
Epoch: 2, Steps: 208 | Train Loss: 3.631 Vali Loss: 3.881 Vali Acc: 0.071 Test Loss: 3.881 Test Acc: 0.071
Validation loss decreased (-0.055733 --> -0.070942).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8127611
	speed: 0.2694s/iter; left time: 5464.2196s
	iters: 200, epoch: 3 | loss: 3.8678827
	speed: 0.0373s/iter; left time: 753.2234s
Epoch: 3 cost time: 8.99541711807251
Epoch: 3, Steps: 208 | Train Loss: 3.330 Vali Loss: 3.885 Vali Acc: 0.079 Test Loss: 3.885 Test Acc: 0.079
Validation loss decreased (-0.070942 --> -0.078995).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8377819
	speed: 0.2718s/iter; left time: 5457.5999s
	iters: 200, epoch: 4 | loss: 3.6333885
	speed: 0.0398s/iter; left time: 794.6529s
Epoch: 4 cost time: 8.86215353012085
Epoch: 4, Steps: 208 | Train Loss: 3.126 Vali Loss: 3.978 Vali Acc: 0.081 Test Loss: 3.978 Test Acc: 0.081
Validation loss decreased (-0.078995 --> -0.080485).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1161661
	speed: 0.2630s/iter; left time: 5225.6209s
	iters: 200, epoch: 5 | loss: 2.7686298
	speed: 0.0416s/iter; left time: 822.1363s
Epoch: 5 cost time: 9.149872541427612
Epoch: 5, Steps: 208 | Train Loss: 2.969 Vali Loss: 4.105 Vali Acc: 0.078 Test Loss: 4.105 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4703050
	speed: 0.2629s/iter; left time: 5169.1306s
	iters: 200, epoch: 6 | loss: 3.2993903
	speed: 0.0426s/iter; left time: 833.8400s
Epoch: 6 cost time: 9.300482988357544
Epoch: 6, Steps: 208 | Train Loss: 2.837 Vali Loss: 4.183 Vali Acc: 0.088 Test Loss: 4.183 Test Acc: 0.088
Validation loss decreased (-0.080485 --> -0.087641).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3482757
	speed: 0.2680s/iter; left time: 5213.2520s
	iters: 200, epoch: 7 | loss: 3.4064157
	speed: 0.0372s/iter; left time: 719.1546s
Epoch: 7 cost time: 8.905836820602417
Epoch: 7, Steps: 208 | Train Loss: 2.713 Vali Loss: 4.150 Vali Acc: 0.102 Test Loss: 4.150 Test Acc: 0.102
Validation loss decreased (-0.087641 --> -0.101957).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5000401
	speed: 0.2726s/iter; left time: 5245.5621s
	iters: 200, epoch: 8 | loss: 3.2470181
	speed: 0.0386s/iter; left time: 739.5465s
Epoch: 8 cost time: 8.994640111923218
Epoch: 8, Steps: 208 | Train Loss: 2.587 Vali Loss: 4.265 Vali Acc: 0.099 Test Loss: 4.265 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5592432
	speed: 0.2732s/iter; left time: 5201.7739s
	iters: 200, epoch: 9 | loss: 1.9138186
	speed: 0.0375s/iter; left time: 710.1426s
Epoch: 9 cost time: 9.141426801681519
Epoch: 9, Steps: 208 | Train Loss: 2.457 Vali Loss: 4.303 Vali Acc: 0.104 Test Loss: 4.303 Test Acc: 0.104
Validation loss decreased (-0.101957 --> -0.104341).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6158617
	speed: 0.2627s/iter; left time: 4946.0397s
	iters: 200, epoch: 10 | loss: 3.0194478
	speed: 0.0401s/iter; left time: 751.4819s
Epoch: 10 cost time: 9.642888069152832
Epoch: 10, Steps: 208 | Train Loss: 2.372 Vali Loss: 4.441 Vali Acc: 0.095 Test Loss: 4.441 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1507118
	speed: 0.2765s/iter; left time: 5148.4486s
	iters: 200, epoch: 11 | loss: 2.0784180
	speed: 0.0391s/iter; left time: 724.1325s
Epoch: 11 cost time: 9.967204093933105
Epoch: 11, Steps: 208 | Train Loss: 2.235 Vali Loss: 4.505 Vali Acc: 0.098 Test Loss: 4.505 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8525221
	speed: 0.2645s/iter; left time: 4869.6676s
	iters: 200, epoch: 12 | loss: 2.9777017
	speed: 0.0418s/iter; left time: 765.1262s
Epoch: 12 cost time: 9.962493181228638
Epoch: 12, Steps: 208 | Train Loss: 2.138 Vali Loss: 4.582 Vali Acc: 0.102 Test Loss: 4.582 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.2034516
	speed: 0.2854s/iter; left time: 5195.0134s
	iters: 200, epoch: 13 | loss: 2.3533494
	speed: 0.0393s/iter; left time: 711.7830s
Epoch: 13 cost time: 9.346563577651978
Epoch: 13, Steps: 208 | Train Loss: 2.058 Vali Loss: 4.609 Vali Acc: 0.105 Test Loss: 4.609 Test Acc: 0.105
Validation loss decreased (-0.104341 --> -0.104636).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3846359
	speed: 0.2845s/iter; left time: 5120.4409s
	iters: 200, epoch: 14 | loss: 3.1346238
	speed: 0.0374s/iter; left time: 669.4975s
Epoch: 14 cost time: 8.998631477355957
Epoch: 14, Steps: 208 | Train Loss: 1.937 Vali Loss: 4.746 Vali Acc: 0.104 Test Loss: 4.746 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0737302
	speed: 0.2912s/iter; left time: 5180.1505s
	iters: 200, epoch: 15 | loss: 2.4872839
	speed: 0.0398s/iter; left time: 704.8252s
Epoch: 15 cost time: 8.862488508224487
Epoch: 15, Steps: 208 | Train Loss: 1.838 Vali Loss: 5.003 Vali Acc: 0.100 Test Loss: 5.003 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.2732451
	speed: 0.2736s/iter; left time: 4809.3307s
	iters: 200, epoch: 16 | loss: 1.7744048
	speed: 0.0377s/iter; left time: 659.7749s
Epoch: 16 cost time: 8.671612977981567
Epoch: 16, Steps: 208 | Train Loss: 1.769 Vali Loss: 5.143 Vali Acc: 0.106 Test Loss: 5.143 Test Acc: 0.106
Validation loss decreased (-0.104636 --> -0.105824).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6888642
	speed: 0.2716s/iter; left time: 4717.9669s
	iters: 200, epoch: 17 | loss: 1.5038325
	speed: 0.0376s/iter; left time: 649.4569s
Epoch: 17 cost time: 9.100213766098022
Epoch: 17, Steps: 208 | Train Loss: 1.673 Vali Loss: 5.300 Vali Acc: 0.106 Test Loss: 5.300 Test Acc: 0.106
Validation loss decreased (-0.105824 --> -0.106121).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.0511575
	speed: 0.2725s/iter; left time: 4677.1592s
	iters: 200, epoch: 18 | loss: 2.1637988
	speed: 0.0401s/iter; left time: 683.5557s
Epoch: 18 cost time: 8.924393892288208
Epoch: 18, Steps: 208 | Train Loss: 1.563 Vali Loss: 5.393 Vali Acc: 0.097 Test Loss: 5.393 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.3590802
	speed: 0.2938s/iter; left time: 4981.9481s
	iters: 200, epoch: 19 | loss: 1.8892026
	speed: 0.0421s/iter; left time: 709.1750s
Epoch: 19 cost time: 10.336143970489502
Epoch: 19, Steps: 208 | Train Loss: 1.520 Vali Loss: 5.751 Vali Acc: 0.103 Test Loss: 5.751 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.3014065
	speed: 0.2952s/iter; left time: 4944.2830s
	iters: 200, epoch: 20 | loss: 1.0340595
	speed: 0.0428s/iter; left time: 712.1885s
Epoch: 20 cost time: 10.09605073928833
Epoch: 20, Steps: 208 | Train Loss: 1.402 Vali Loss: 5.736 Vali Acc: 0.101 Test Loss: 5.736 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.7879267
	speed: 0.2778s/iter; left time: 4594.9365s
	iters: 200, epoch: 21 | loss: 1.1807408
	speed: 0.0422s/iter; left time: 694.3973s
Epoch: 21 cost time: 9.915269136428833
Epoch: 21, Steps: 208 | Train Loss: 1.372 Vali Loss: 6.111 Vali Acc: 0.104 Test Loss: 6.111 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.9086448
	speed: 0.2760s/iter; left time: 4507.6682s
	iters: 200, epoch: 22 | loss: 1.5609823
	speed: 0.0428s/iter; left time: 695.0245s
Epoch: 22 cost time: 9.433018922805786
Epoch: 22, Steps: 208 | Train Loss: 1.273 Vali Loss: 6.221 Vali Acc: 0.100 Test Loss: 6.221 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.7581174
	speed: 0.2831s/iter; left time: 4564.7329s
	iters: 200, epoch: 23 | loss: 1.3206612
	speed: 0.0367s/iter; left time: 588.1839s
Epoch: 23 cost time: 8.834859609603882
Epoch: 23, Steps: 208 | Train Loss: 1.227 Vali Loss: 6.236 Vali Acc: 0.107 Test Loss: 6.236 Test Acc: 0.107
Validation loss decreased (-0.106121 --> -0.106708).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.6333072
	speed: 0.2868s/iter; left time: 4564.4013s
	iters: 200, epoch: 24 | loss: 1.1870160
	speed: 0.0391s/iter; left time: 619.0239s
Epoch: 24 cost time: 9.30661153793335
Epoch: 24, Steps: 208 | Train Loss: 1.159 Vali Loss: 6.455 Vali Acc: 0.102 Test Loss: 6.455 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.0313426
	speed: 0.2882s/iter; left time: 4526.9763s
	iters: 200, epoch: 25 | loss: 0.8972994
	speed: 0.0433s/iter; left time: 675.8672s
Epoch: 25 cost time: 9.634702682495117
Epoch: 25, Steps: 208 | Train Loss: 1.104 Vali Loss: 6.929 Vali Acc: 0.097 Test Loss: 6.929 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.6573685
	speed: 0.2964s/iter; left time: 4594.9000s
	iters: 200, epoch: 26 | loss: 1.5351481
	speed: 0.0386s/iter; left time: 595.2246s
Epoch: 26 cost time: 9.904225826263428
Epoch: 26, Steps: 208 | Train Loss: 1.053 Vali Loss: 6.970 Vali Acc: 0.104 Test Loss: 6.970 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.6251062
	speed: 0.2843s/iter; left time: 4348.3576s
	iters: 200, epoch: 27 | loss: 1.3628224
	speed: 0.0359s/iter; left time: 545.0954s
Epoch: 27 cost time: 8.656332969665527
Epoch: 27, Steps: 208 | Train Loss: 1.005 Vali Loss: 7.183 Vali Acc: 0.101 Test Loss: 7.183 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.5456496
	speed: 0.2794s/iter; left time: 4214.5867s
	iters: 200, epoch: 28 | loss: 0.7694800
	speed: 0.0380s/iter; left time: 568.7806s
Epoch: 28 cost time: 9.217475652694702
Epoch: 28, Steps: 208 | Train Loss: 0.957 Vali Loss: 7.396 Vali Acc: 0.102 Test Loss: 7.396 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.7860150
	speed: 0.2650s/iter; left time: 3942.2583s
	iters: 200, epoch: 29 | loss: 1.0385566
	speed: 0.0378s/iter; left time: 559.2668s
Epoch: 29 cost time: 9.190301656723022
Epoch: 29, Steps: 208 | Train Loss: 0.880 Vali Loss: 7.642 Vali Acc: 0.100 Test Loss: 7.642 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.7739142
	speed: 0.2827s/iter; left time: 4147.3373s
	iters: 200, epoch: 30 | loss: 0.9596694
	speed: 0.0461s/iter; left time: 671.1430s
Epoch: 30 cost time: 10.610066413879395
Epoch: 30, Steps: 208 | Train Loss: 0.846 Vali Loss: 7.954 Vali Acc: 0.098 Test Loss: 7.954 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.8065042
	speed: 0.2747s/iter; left time: 3972.4800s
	iters: 200, epoch: 31 | loss: 0.5891201
	speed: 0.0392s/iter; left time: 562.8480s
Epoch: 31 cost time: 9.387935161590576
Epoch: 31, Steps: 208 | Train Loss: 0.841 Vali Loss: 8.075 Vali Acc: 0.095 Test Loss: 8.075 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.5437201
	speed: 0.2881s/iter; left time: 4106.6543s
	iters: 200, epoch: 32 | loss: 0.4548733
	speed: 0.0425s/iter; left time: 600.8544s
Epoch: 32 cost time: 9.713850259780884
Epoch: 32, Steps: 208 | Train Loss: 0.801 Vali Loss: 8.368 Vali Acc: 0.101 Test Loss: 8.368 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.0041193
	speed: 0.2814s/iter; left time: 3952.9458s
	iters: 200, epoch: 33 | loss: 0.8474739
	speed: 0.0371s/iter; left time: 517.5747s
Epoch: 33 cost time: 9.264780044555664
Epoch: 33, Steps: 208 | Train Loss: 0.767 Vali Loss: 8.572 Vali Acc: 0.101 Test Loss: 8.572 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10677005666567253
model parameter : 174439
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8606982
	speed: 0.0730s/iter; left time: 1511.4345s
	iters: 200, epoch: 1 | loss: 3.8298178
	speed: 0.0325s/iter; left time: 669.1086s
Epoch: 1 cost time: 10.97806167602539
Epoch: 1, Steps: 208 | Train Loss: 3.789 Vali Loss: 3.755 Vali Acc: 0.060 Test Loss: 3.755 Test Acc: 0.060
Validation loss decreased (inf --> -0.059909).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5904891
	speed: 0.2417s/iter; left time: 4954.0196s
	iters: 200, epoch: 2 | loss: 3.7711592
	speed: 0.0383s/iter; left time: 780.5627s
Epoch: 2 cost time: 8.645294189453125
Epoch: 2, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.875 Vali Acc: 0.055 Test Loss: 3.875 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2129135
	speed: 0.2583s/iter; left time: 5240.2722s
	iters: 200, epoch: 3 | loss: 3.7380404
	speed: 0.0336s/iter; left time: 678.1018s
Epoch: 3 cost time: 8.098766565322876
Epoch: 3, Steps: 208 | Train Loss: 3.395 Vali Loss: 3.921 Vali Acc: 0.065 Test Loss: 3.921 Test Acc: 0.065
Validation loss decreased (-0.059909 --> -0.065275).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7367325
	speed: 0.2558s/iter; left time: 5136.3402s
	iters: 200, epoch: 4 | loss: 3.7663448
	speed: 0.0378s/iter; left time: 754.8153s
Epoch: 4 cost time: 8.441840648651123
Epoch: 4, Steps: 208 | Train Loss: 3.193 Vali Loss: 3.948 Vali Acc: 0.078 Test Loss: 3.948 Test Acc: 0.078
Validation loss decreased (-0.065275 --> -0.077801).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9267378
	speed: 0.2471s/iter; left time: 4910.0728s
	iters: 200, epoch: 5 | loss: 3.5666406
	speed: 0.0343s/iter; left time: 677.8949s
Epoch: 5 cost time: 8.369412422180176
Epoch: 5, Steps: 208 | Train Loss: 3.103 Vali Loss: 4.002 Vali Acc: 0.073 Test Loss: 4.002 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4815979
	speed: 0.2660s/iter; left time: 5229.8197s
	iters: 200, epoch: 6 | loss: 3.7988858
	speed: 0.0386s/iter; left time: 755.1344s
Epoch: 6 cost time: 8.977721452713013
Epoch: 6, Steps: 208 | Train Loss: 2.953 Vali Loss: 3.984 Vali Acc: 0.092 Test Loss: 3.984 Test Acc: 0.092
Validation loss decreased (-0.077801 --> -0.091520).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7213564
	speed: 0.2606s/iter; left time: 5069.6244s
	iters: 200, epoch: 7 | loss: 2.8349605
	speed: 0.0348s/iter; left time: 673.6175s
Epoch: 7 cost time: 8.52623176574707
Epoch: 7, Steps: 208 | Train Loss: 2.860 Vali Loss: 4.102 Vali Acc: 0.083 Test Loss: 4.102 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9905510
	speed: 0.2568s/iter; left time: 4941.6437s
	iters: 200, epoch: 8 | loss: 3.2122066
	speed: 0.0393s/iter; left time: 753.0470s
Epoch: 8 cost time: 9.342260122299194
Epoch: 8, Steps: 208 | Train Loss: 2.737 Vali Loss: 4.188 Vali Acc: 0.088 Test Loss: 4.188 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5011487
	speed: 0.2398s/iter; left time: 4564.7521s
	iters: 200, epoch: 9 | loss: 3.4622552
	speed: 0.0306s/iter; left time: 579.7637s
Epoch: 9 cost time: 7.58865213394165
Epoch: 9, Steps: 208 | Train Loss: 2.634 Vali Loss: 4.208 Vali Acc: 0.092 Test Loss: 4.208 Test Acc: 0.092
Validation loss decreased (-0.091520 --> -0.092114).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5337040
	speed: 0.2527s/iter; left time: 4758.7683s
	iters: 200, epoch: 10 | loss: 2.7196050
	speed: 0.0370s/iter; left time: 692.9986s
Epoch: 10 cost time: 8.752014875411987
Epoch: 10, Steps: 208 | Train Loss: 2.504 Vali Loss: 4.181 Vali Acc: 0.094 Test Loss: 4.181 Test Acc: 0.094
Validation loss decreased (-0.092114 --> -0.093904).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3574955
	speed: 0.2457s/iter; left time: 4574.9187s
	iters: 200, epoch: 11 | loss: 3.1953282
	speed: 0.0339s/iter; left time: 626.9578s
Epoch: 11 cost time: 8.59869384765625
Epoch: 11, Steps: 208 | Train Loss: 2.408 Vali Loss: 4.278 Vali Acc: 0.099 Test Loss: 4.278 Test Acc: 0.099
Validation loss decreased (-0.093904 --> -0.099271).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3697541
	speed: 0.2476s/iter; left time: 4559.3512s
	iters: 200, epoch: 12 | loss: 2.3015344
	speed: 0.0323s/iter; left time: 591.0033s
Epoch: 12 cost time: 7.622544050216675
Epoch: 12, Steps: 208 | Train Loss: 2.330 Vali Loss: 4.322 Vali Acc: 0.103 Test Loss: 4.322 Test Acc: 0.103
Validation loss decreased (-0.099271 --> -0.103148).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0455663
	speed: 0.2529s/iter; left time: 4604.2590s
	iters: 200, epoch: 13 | loss: 2.5284123
	speed: 0.0345s/iter; left time: 624.7559s
Epoch: 13 cost time: 8.065117835998535
Epoch: 13, Steps: 208 | Train Loss: 2.197 Vali Loss: 4.475 Vali Acc: 0.098 Test Loss: 4.475 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.5948083
	speed: 0.2361s/iter; left time: 4249.2923s
	iters: 200, epoch: 14 | loss: 2.6292768
	speed: 0.0316s/iter; left time: 565.1503s
Epoch: 14 cost time: 7.361490488052368
Epoch: 14, Steps: 208 | Train Loss: 2.111 Vali Loss: 4.631 Vali Acc: 0.095 Test Loss: 4.631 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.6968882
	speed: 0.2360s/iter; left time: 4197.8484s
	iters: 200, epoch: 15 | loss: 2.6616087
	speed: 0.0327s/iter; left time: 578.2315s
Epoch: 15 cost time: 7.505012512207031
Epoch: 15, Steps: 208 | Train Loss: 2.036 Vali Loss: 4.702 Vali Acc: 0.101 Test Loss: 4.702 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.1332426
	speed: 0.2296s/iter; left time: 4036.3985s
	iters: 200, epoch: 16 | loss: 1.7193892
	speed: 0.0314s/iter; left time: 549.6151s
Epoch: 16 cost time: 7.3703179359436035
Epoch: 16, Steps: 208 | Train Loss: 1.916 Vali Loss: 4.770 Vali Acc: 0.098 Test Loss: 4.770 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.1506248
	speed: 0.2351s/iter; left time: 4084.0522s
	iters: 200, epoch: 17 | loss: 2.2288585
	speed: 0.0332s/iter; left time: 573.6243s
Epoch: 17 cost time: 8.467151880264282
Epoch: 17, Steps: 208 | Train Loss: 1.852 Vali Loss: 4.952 Vali Acc: 0.101 Test Loss: 4.952 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.6304145
	speed: 0.2290s/iter; left time: 3930.7234s
	iters: 200, epoch: 18 | loss: 1.6629920
	speed: 0.0346s/iter; left time: 590.0122s
Epoch: 18 cost time: 8.025540828704834
Epoch: 18, Steps: 208 | Train Loss: 1.723 Vali Loss: 5.132 Vali Acc: 0.099 Test Loss: 5.132 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.6930978
	speed: 0.2530s/iter; left time: 4289.8314s
	iters: 200, epoch: 19 | loss: 2.7425351
	speed: 0.0354s/iter; left time: 596.2522s
Epoch: 19 cost time: 9.306883573532104
Epoch: 19, Steps: 208 | Train Loss: 1.669 Vali Loss: 5.299 Vali Acc: 0.097 Test Loss: 5.299 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.5086803
	speed: 0.2474s/iter; left time: 4143.4726s
	iters: 200, epoch: 20 | loss: 1.6344920
	speed: 0.0391s/iter; left time: 650.6347s
Epoch: 20 cost time: 9.15132212638855
Epoch: 20, Steps: 208 | Train Loss: 1.561 Vali Loss: 5.453 Vali Acc: 0.099 Test Loss: 5.453 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.9424303
	speed: 0.2411s/iter; left time: 3988.7790s
	iters: 200, epoch: 21 | loss: 1.6248173
	speed: 0.0361s/iter; left time: 593.0713s
Epoch: 21 cost time: 8.567757844924927
Epoch: 21, Steps: 208 | Train Loss: 1.527 Vali Loss: 5.630 Vali Acc: 0.103 Test Loss: 5.630 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.4634029
	speed: 0.2591s/iter; left time: 4232.6838s
	iters: 200, epoch: 22 | loss: 1.1368110
	speed: 0.0350s/iter; left time: 567.3719s
Epoch: 22 cost time: 8.653394222259521
Epoch: 22, Steps: 208 | Train Loss: 1.459 Vali Loss: 5.751 Vali Acc: 0.101 Test Loss: 5.751 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10319117208470027
model parameter : 133607
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5620441
	speed: 0.0655s/iter; left time: 1356.1183s
	iters: 200, epoch: 1 | loss: 4.0587807
	speed: 0.0372s/iter; left time: 767.2064s
Epoch: 1 cost time: 10.620601892471313
Epoch: 1, Steps: 208 | Train Loss: 3.780 Vali Loss: 3.777 Vali Acc: 0.055 Test Loss: 3.777 Test Acc: 0.055
Validation loss decreased (inf --> -0.055137).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4920774
	speed: 0.2726s/iter; left time: 5585.5515s
	iters: 200, epoch: 2 | loss: 3.5304487
	speed: 0.0348s/iter; left time: 709.7714s
Epoch: 2 cost time: 8.92598271369934
Epoch: 2, Steps: 208 | Train Loss: 3.620 Vali Loss: 3.839 Vali Acc: 0.048 Test Loss: 3.839 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5992351
	speed: 0.2791s/iter; left time: 5662.2413s
	iters: 200, epoch: 3 | loss: 3.5706053
	speed: 0.0421s/iter; left time: 849.2065s
Epoch: 3 cost time: 9.424249172210693
Epoch: 3, Steps: 208 | Train Loss: 3.434 Vali Loss: 3.806 Vali Acc: 0.068 Test Loss: 3.806 Test Acc: 0.068
Validation loss decreased (-0.055137 --> -0.067663).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5729878
	speed: 0.2809s/iter; left time: 5640.0415s
	iters: 200, epoch: 4 | loss: 3.2316110
	speed: 0.0391s/iter; left time: 780.9956s
Epoch: 4 cost time: 9.126829624176025
Epoch: 4, Steps: 208 | Train Loss: 3.244 Vali Loss: 3.879 Vali Acc: 0.072 Test Loss: 3.879 Test Acc: 0.072
Validation loss decreased (-0.067663 --> -0.072434).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8866138
	speed: 0.2960s/iter; left time: 5881.4545s
	iters: 200, epoch: 5 | loss: 3.7881012
	speed: 0.0384s/iter; left time: 759.5310s
Epoch: 5 cost time: 9.56556487083435
Epoch: 5, Steps: 208 | Train Loss: 3.100 Vali Loss: 3.909 Vali Acc: 0.079 Test Loss: 3.909 Test Acc: 0.079
Validation loss decreased (-0.072434 --> -0.079293).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0142121
	speed: 0.2852s/iter; left time: 5607.7142s
	iters: 200, epoch: 6 | loss: 3.0660522
	speed: 0.0362s/iter; left time: 707.1523s
Epoch: 6 cost time: 8.258662462234497
Epoch: 6, Steps: 208 | Train Loss: 3.004 Vali Loss: 3.965 Vali Acc: 0.081 Test Loss: 3.965 Test Acc: 0.081
Validation loss decreased (-0.079293 --> -0.080783).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1647942
	speed: 0.2628s/iter; left time: 5112.9885s
	iters: 200, epoch: 7 | loss: 3.7277133
	speed: 0.0385s/iter; left time: 745.6289s
Epoch: 7 cost time: 8.494790315628052
Epoch: 7, Steps: 208 | Train Loss: 2.889 Vali Loss: 4.006 Vali Acc: 0.082 Test Loss: 4.006 Test Acc: 0.082
Validation loss decreased (-0.080783 --> -0.082274).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9351704
	speed: 0.2610s/iter; left time: 5022.0933s
	iters: 200, epoch: 8 | loss: 2.6754394
	speed: 0.0394s/iter; left time: 753.8835s
Epoch: 8 cost time: 9.193054914474487
Epoch: 8, Steps: 208 | Train Loss: 2.785 Vali Loss: 4.110 Vali Acc: 0.089 Test Loss: 4.110 Test Acc: 0.089
Validation loss decreased (-0.082274 --> -0.088835).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7701313
	speed: 0.2557s/iter; left time: 4867.6594s
	iters: 200, epoch: 9 | loss: 2.6835368
	speed: 0.0363s/iter; left time: 688.0100s
Epoch: 9 cost time: 8.708532810211182
Epoch: 9, Steps: 208 | Train Loss: 2.710 Vali Loss: 4.123 Vali Acc: 0.089 Test Loss: 4.123 Test Acc: 0.089
Validation loss decreased (-0.088835 --> -0.089431).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2831104
	speed: 0.2731s/iter; left time: 5141.5198s
	iters: 200, epoch: 10 | loss: 2.5193312
	speed: 0.0441s/iter; left time: 825.5266s
Epoch: 10 cost time: 9.644111394882202
Epoch: 10, Steps: 208 | Train Loss: 2.609 Vali Loss: 4.193 Vali Acc: 0.087 Test Loss: 4.193 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.7074594
	speed: 0.3013s/iter; left time: 5610.9364s
	iters: 200, epoch: 11 | loss: 3.2031102
	speed: 0.0384s/iter; left time: 711.5335s
Epoch: 11 cost time: 9.697412252426147
Epoch: 11, Steps: 208 | Train Loss: 2.532 Vali Loss: 4.157 Vali Acc: 0.096 Test Loss: 4.157 Test Acc: 0.096
Validation loss decreased (-0.089431 --> -0.096290).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9381373
	speed: 0.2801s/iter; left time: 5158.1655s
	iters: 200, epoch: 12 | loss: 2.3638370
	speed: 0.0397s/iter; left time: 727.3072s
Epoch: 12 cost time: 9.335464000701904
Epoch: 12, Steps: 208 | Train Loss: 2.436 Vali Loss: 4.250 Vali Acc: 0.094 Test Loss: 4.250 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7135060
	speed: 0.2823s/iter; left time: 5139.4624s
	iters: 200, epoch: 13 | loss: 2.3479841
	speed: 0.0326s/iter; left time: 589.7084s
Epoch: 13 cost time: 8.679736614227295
Epoch: 13, Steps: 208 | Train Loss: 2.340 Vali Loss: 4.334 Vali Acc: 0.098 Test Loss: 4.334 Test Acc: 0.098
Validation loss decreased (-0.096290 --> -0.098078).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1369164
	speed: 0.2832s/iter; left time: 5097.0021s
	iters: 200, epoch: 14 | loss: 3.1927164
	speed: 0.0356s/iter; left time: 636.5133s
Epoch: 14 cost time: 8.447054862976074
Epoch: 14, Steps: 208 | Train Loss: 2.249 Vali Loss: 4.371 Vali Acc: 0.094 Test Loss: 4.371 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.6779873
	speed: 0.2757s/iter; left time: 4904.0109s
	iters: 200, epoch: 15 | loss: 2.7874455
	speed: 0.0450s/iter; left time: 796.4955s
Epoch: 15 cost time: 10.422185897827148
Epoch: 15, Steps: 208 | Train Loss: 2.210 Vali Loss: 4.427 Vali Acc: 0.100 Test Loss: 4.427 Test Acc: 0.100
Validation loss decreased (-0.098078 --> -0.100165).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5170029
	speed: 0.2723s/iter; left time: 4787.9630s
	iters: 200, epoch: 16 | loss: 2.2524915
	speed: 0.0412s/iter; left time: 720.0213s
Epoch: 16 cost time: 9.341758012771606
Epoch: 16, Steps: 208 | Train Loss: 2.107 Vali Loss: 4.557 Vali Acc: 0.098 Test Loss: 4.557 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.3559890
	speed: 0.2786s/iter; left time: 4840.3632s
	iters: 200, epoch: 17 | loss: 2.4428902
	speed: 0.0406s/iter; left time: 702.1307s
Epoch: 17 cost time: 9.7821786403656
Epoch: 17, Steps: 208 | Train Loss: 2.024 Vali Loss: 4.628 Vali Acc: 0.103 Test Loss: 4.628 Test Acc: 0.103
Validation loss decreased (-0.100165 --> -0.103443).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.1155488
	speed: 0.2867s/iter; left time: 4921.9131s
	iters: 200, epoch: 18 | loss: 1.8835696
	speed: 0.0341s/iter; left time: 582.2667s
Epoch: 18 cost time: 8.94853925704956
Epoch: 18, Steps: 208 | Train Loss: 1.987 Vali Loss: 4.768 Vali Acc: 0.098 Test Loss: 4.768 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.4862032
	speed: 0.2792s/iter; left time: 4733.8287s
	iters: 200, epoch: 19 | loss: 1.9420071
	speed: 0.0396s/iter; left time: 667.5848s
Epoch: 19 cost time: 9.087805032730103
Epoch: 19, Steps: 208 | Train Loss: 1.875 Vali Loss: 4.820 Vali Acc: 0.097 Test Loss: 4.820 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.5781274
	speed: 0.2941s/iter; left time: 4926.6512s
	iters: 200, epoch: 20 | loss: 2.0455589
	speed: 0.0397s/iter; left time: 661.3278s
Epoch: 20 cost time: 9.662100315093994
Epoch: 20, Steps: 208 | Train Loss: 1.810 Vali Loss: 5.011 Vali Acc: 0.094 Test Loss: 5.011 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.6840329
	speed: 0.2986s/iter; left time: 4938.5922s
	iters: 200, epoch: 21 | loss: 1.5508878
	speed: 0.0411s/iter; left time: 675.6330s
Epoch: 21 cost time: 9.871050834655762
Epoch: 21, Steps: 208 | Train Loss: 1.750 Vali Loss: 5.174 Vali Acc: 0.098 Test Loss: 5.174 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.3559299
	speed: 0.2911s/iter; left time: 4753.8220s
	iters: 200, epoch: 22 | loss: 2.4007568
	speed: 0.0414s/iter; left time: 671.8825s
Epoch: 22 cost time: 10.635338306427002
Epoch: 22, Steps: 208 | Train Loss: 1.667 Vali Loss: 5.294 Vali Acc: 0.095 Test Loss: 5.294 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.3774270
	speed: 0.2843s/iter; left time: 4584.3350s
	iters: 200, epoch: 23 | loss: 3.0669737
	speed: 0.0455s/iter; left time: 729.0843s
Epoch: 23 cost time: 10.202625274658203
Epoch: 23, Steps: 208 | Train Loss: 1.617 Vali Loss: 5.485 Vali Acc: 0.091 Test Loss: 5.485 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.4929721
	speed: 0.2637s/iter; left time: 4197.1467s
	iters: 200, epoch: 24 | loss: 1.8287075
	speed: 0.0337s/iter; left time: 533.1628s
Epoch: 24 cost time: 8.729756832122803
Epoch: 24, Steps: 208 | Train Loss: 1.582 Vali Loss: 5.519 Vali Acc: 0.093 Test Loss: 5.519 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.3017769
	speed: 0.2697s/iter; left time: 4237.3374s
	iters: 200, epoch: 25 | loss: 1.9465585
	speed: 0.0400s/iter; left time: 624.1279s
Epoch: 25 cost time: 9.581098079681396
Epoch: 25, Steps: 208 | Train Loss: 1.504 Vali Loss: 5.740 Vali Acc: 0.087 Test Loss: 5.740 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.1950929
	speed: 0.2630s/iter; left time: 4077.2349s
	iters: 200, epoch: 26 | loss: 1.3058373
	speed: 0.0375s/iter; left time: 577.7257s
Epoch: 26 cost time: 9.33186149597168
Epoch: 26, Steps: 208 | Train Loss: 1.429 Vali Loss: 5.885 Vali Acc: 0.098 Test Loss: 5.885 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.9024651
	speed: 0.2872s/iter; left time: 4391.7024s
	iters: 200, epoch: 27 | loss: 1.5831836
	speed: 0.0398s/iter; left time: 605.2596s
Epoch: 27 cost time: 9.43272852897644
Epoch: 27, Steps: 208 | Train Loss: 1.390 Vali Loss: 5.989 Vali Acc: 0.093 Test Loss: 5.989 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm32_nh4_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10348941246644795
model parameter : 106503
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3539467
	speed: 0.0744s/iter; left time: 1539.6193s
	iters: 200, epoch: 1 | loss: 3.7560186
	speed: 0.0457s/iter; left time: 941.4687s
Epoch: 1 cost time: 12.633260726928711
Epoch: 1, Steps: 208 | Train Loss: 4.087 Vali Loss: 4.392 Vali Acc: 0.061 Test Loss: 4.392 Test Acc: 0.061
Validation loss decreased (inf --> -0.060797).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3298697
	speed: 0.2795s/iter; left time: 5728.5069s
	iters: 200, epoch: 2 | loss: 4.0984898
	speed: 0.0410s/iter; left time: 836.9864s
Epoch: 2 cost time: 10.537672281265259
Epoch: 2, Steps: 208 | Train Loss: 3.852 Vali Loss: 4.330 Vali Acc: 0.070 Test Loss: 4.330 Test Acc: 0.070
Validation loss decreased (-0.060797 --> -0.070341).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8146124
	speed: 0.2646s/iter; left time: 5367.3017s
	iters: 200, epoch: 3 | loss: 3.0911667
	speed: 0.0448s/iter; left time: 905.2367s
Epoch: 3 cost time: 10.656809568405151
Epoch: 3, Steps: 208 | Train Loss: 3.348 Vali Loss: 4.143 Vali Acc: 0.080 Test Loss: 4.143 Test Acc: 0.080
Validation loss decreased (-0.070341 --> -0.079589).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3744788
	speed: 0.2819s/iter; left time: 5660.6189s
	iters: 200, epoch: 4 | loss: 4.0940695
	speed: 0.0431s/iter; left time: 860.5764s
Epoch: 4 cost time: 10.321330308914185
Epoch: 4, Steps: 208 | Train Loss: 2.946 Vali Loss: 4.496 Vali Acc: 0.089 Test Loss: 4.496 Test Acc: 0.089
Validation loss decreased (-0.079589 --> -0.089129).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1089513
	speed: 0.2919s/iter; left time: 5799.4280s
	iters: 200, epoch: 5 | loss: 3.3974898
	speed: 0.0411s/iter; left time: 812.6860s
Epoch: 5 cost time: 9.593528509140015
Epoch: 5, Steps: 208 | Train Loss: 2.676 Vali Loss: 4.589 Vali Acc: 0.091 Test Loss: 4.589 Test Acc: 0.091
Validation loss decreased (-0.089129 --> -0.090619).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5451603
	speed: 0.2950s/iter; left time: 5799.1256s
	iters: 200, epoch: 6 | loss: 2.3533211
	speed: 0.0417s/iter; left time: 815.7224s
Epoch: 6 cost time: 10.496322870254517
Epoch: 6, Steps: 208 | Train Loss: 2.388 Vali Loss: 4.922 Vali Acc: 0.096 Test Loss: 4.922 Test Acc: 0.096
Validation loss decreased (-0.090619 --> -0.095686).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4308610
	speed: 0.3062s/iter; left time: 5956.8636s
	iters: 200, epoch: 7 | loss: 2.0402772
	speed: 0.0464s/iter; left time: 897.6155s
Epoch: 7 cost time: 10.946680545806885
Epoch: 7, Steps: 208 | Train Loss: 2.172 Vali Loss: 4.984 Vali Acc: 0.088 Test Loss: 4.984 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0263577
	speed: 0.2768s/iter; left time: 5327.6492s
	iters: 200, epoch: 8 | loss: 1.8449699
	speed: 0.0446s/iter; left time: 853.9960s
Epoch: 8 cost time: 10.226921796798706
Epoch: 8, Steps: 208 | Train Loss: 1.837 Vali Loss: 5.170 Vali Acc: 0.100 Test Loss: 5.170 Test Acc: 0.100
Validation loss decreased (-0.095686 --> -0.099859).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8182510
	speed: 0.2726s/iter; left time: 5189.7365s
	iters: 200, epoch: 9 | loss: 1.7342234
	speed: 0.0475s/iter; left time: 898.7941s
Epoch: 9 cost time: 10.294016599655151
Epoch: 9, Steps: 208 | Train Loss: 1.636 Vali Loss: 5.695 Vali Acc: 0.097 Test Loss: 5.695 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8750691
	speed: 0.2741s/iter; left time: 5161.7203s
	iters: 200, epoch: 10 | loss: 1.2623384
	speed: 0.0446s/iter; left time: 835.1019s
Epoch: 10 cost time: 10.69143271446228
Epoch: 10, Steps: 208 | Train Loss: 1.451 Vali Loss: 5.995 Vali Acc: 0.101 Test Loss: 5.995 Test Acc: 0.101
Validation loss decreased (-0.099859 --> -0.100745).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1780239
	speed: 0.2793s/iter; left time: 5200.1190s
	iters: 200, epoch: 11 | loss: 2.2142911
	speed: 0.0528s/iter; left time: 977.0218s
Epoch: 11 cost time: 11.189535140991211
Epoch: 11, Steps: 208 | Train Loss: 1.245 Vali Loss: 6.313 Vali Acc: 0.097 Test Loss: 6.313 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0895205
	speed: 0.2971s/iter; left time: 5470.6112s
	iters: 200, epoch: 12 | loss: 1.2263134
	speed: 0.0433s/iter; left time: 792.9369s
Epoch: 12 cost time: 10.256958246231079
Epoch: 12, Steps: 208 | Train Loss: 1.105 Vali Loss: 6.655 Vali Acc: 0.102 Test Loss: 6.655 Test Acc: 0.102
Validation loss decreased (-0.100745 --> -0.101633).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5260544
	speed: 0.3004s/iter; left time: 5469.5122s
	iters: 200, epoch: 13 | loss: 0.4128783
	speed: 0.0439s/iter; left time: 793.9321s
Epoch: 13 cost time: 10.396971940994263
Epoch: 13, Steps: 208 | Train Loss: 0.941 Vali Loss: 7.003 Vali Acc: 0.107 Test Loss: 7.003 Test Acc: 0.107
Validation loss decreased (-0.101633 --> -0.107297).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6010117
	speed: 0.2977s/iter; left time: 5358.1691s
	iters: 200, epoch: 14 | loss: 1.2288390
	speed: 0.0460s/iter; left time: 822.4518s
Epoch: 14 cost time: 10.836652755737305
Epoch: 14, Steps: 208 | Train Loss: 0.836 Vali Loss: 7.556 Vali Acc: 0.097 Test Loss: 7.556 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9521880
	speed: 0.2953s/iter; left time: 5253.0355s
	iters: 200, epoch: 15 | loss: 0.8236879
	speed: 0.0526s/iter; left time: 931.1822s
Epoch: 15 cost time: 11.558823347091675
Epoch: 15, Steps: 208 | Train Loss: 0.722 Vali Loss: 8.109 Vali Acc: 0.095 Test Loss: 8.109 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3663929
	speed: 0.2889s/iter; left time: 5079.7810s
	iters: 200, epoch: 16 | loss: 0.4821618
	speed: 0.0454s/iter; left time: 793.2272s
Epoch: 16 cost time: 10.564380168914795
Epoch: 16, Steps: 208 | Train Loss: 0.668 Vali Loss: 8.420 Vali Acc: 0.106 Test Loss: 8.420 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9154601
	speed: 0.2841s/iter; left time: 4935.6952s
	iters: 200, epoch: 17 | loss: 0.7671322
	speed: 0.0449s/iter; left time: 775.1941s
Epoch: 17 cost time: 10.767470836639404
Epoch: 17, Steps: 208 | Train Loss: 0.546 Vali Loss: 9.434 Vali Acc: 0.100 Test Loss: 9.434 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5136204
	speed: 0.2707s/iter; left time: 4646.4546s
	iters: 200, epoch: 18 | loss: 1.3034215
	speed: 0.0431s/iter; left time: 735.0791s
Epoch: 18 cost time: 10.151265382766724
Epoch: 18, Steps: 208 | Train Loss: 0.523 Vali Loss: 9.697 Vali Acc: 0.101 Test Loss: 9.697 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6422715
	speed: 0.2663s/iter; left time: 4516.3903s
	iters: 200, epoch: 19 | loss: 1.5306239
	speed: 0.0405s/iter; left time: 682.4247s
Epoch: 19 cost time: 8.906909942626953
Epoch: 19, Steps: 208 | Train Loss: 0.470 Vali Loss: 10.176 Vali Acc: 0.101 Test Loss: 10.176 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0908984
	speed: 0.2814s/iter; left time: 4712.9416s
	iters: 200, epoch: 20 | loss: 0.3809591
	speed: 0.0483s/iter; left time: 803.5151s
Epoch: 20 cost time: 11.422817468643188
Epoch: 20, Steps: 208 | Train Loss: 0.466 Vali Loss: 10.143 Vali Acc: 0.103 Test Loss: 10.143 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.3984331
	speed: 0.3073s/iter; left time: 5082.4551s
	iters: 200, epoch: 21 | loss: 1.4068509
	speed: 0.0499s/iter; left time: 819.6334s
Epoch: 21 cost time: 11.813695430755615
Epoch: 21, Steps: 208 | Train Loss: 0.382 Vali Loss: 10.918 Vali Acc: 0.098 Test Loss: 10.918 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1565622
	speed: 0.3007s/iter; left time: 4910.5384s
	iters: 200, epoch: 22 | loss: 0.5417562
	speed: 0.0485s/iter; left time: 786.9110s
Epoch: 22 cost time: 11.253329515457153
Epoch: 22, Steps: 208 | Train Loss: 0.364 Vali Loss: 11.146 Vali Acc: 0.096 Test Loss: 11.146 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3774011
	speed: 0.2865s/iter; left time: 4619.5331s
	iters: 200, epoch: 23 | loss: 0.4650782
	speed: 0.0369s/iter; left time: 591.8107s
Epoch: 23 cost time: 9.965375423431396
Epoch: 23, Steps: 208 | Train Loss: 0.338 Vali Loss: 11.655 Vali Acc: 0.099 Test Loss: 11.655 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10736653742916791
model parameter : 503991
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0034575
	speed: 0.0817s/iter; left time: 1691.5634s
	iters: 200, epoch: 1 | loss: 3.8921235
	speed: 0.0403s/iter; left time: 829.9292s
Epoch: 1 cost time: 12.784630537033081
Epoch: 1, Steps: 208 | Train Loss: 3.884 Vali Loss: 3.914 Vali Acc: 0.059 Test Loss: 3.914 Test Acc: 0.059
Validation loss decreased (inf --> -0.059311).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1596851
	speed: 0.2860s/iter; left time: 5861.6269s
	iters: 200, epoch: 2 | loss: 3.7744992
	speed: 0.0417s/iter; left time: 851.3181s
Epoch: 2 cost time: 10.617730617523193
Epoch: 2, Steps: 208 | Train Loss: 3.591 Vali Loss: 3.778 Vali Acc: 0.085 Test Loss: 3.778 Test Acc: 0.085
Validation loss decreased (-0.059311 --> -0.084961).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1878676
	speed: 0.2828s/iter; left time: 5736.5370s
	iters: 200, epoch: 3 | loss: 3.5835595
	speed: 0.0429s/iter; left time: 865.9605s
Epoch: 3 cost time: 9.534881353378296
Epoch: 3, Steps: 208 | Train Loss: 3.243 Vali Loss: 3.961 Vali Acc: 0.083 Test Loss: 3.961 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2397881
	speed: 0.2767s/iter; left time: 5555.3249s
	iters: 200, epoch: 4 | loss: 2.9629107
	speed: 0.0338s/iter; left time: 675.7250s
Epoch: 4 cost time: 8.736508846282959
Epoch: 4, Steps: 208 | Train Loss: 3.015 Vali Loss: 3.955 Vali Acc: 0.085 Test Loss: 3.955 Test Acc: 0.085
Validation loss decreased (-0.084961 --> -0.085257).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2342963
	speed: 0.2587s/iter; left time: 5139.4212s
	iters: 200, epoch: 5 | loss: 2.8559694
	speed: 0.0347s/iter; left time: 685.6307s
Epoch: 5 cost time: 8.170595407485962
Epoch: 5, Steps: 208 | Train Loss: 2.831 Vali Loss: 4.053 Vali Acc: 0.093 Test Loss: 4.053 Test Acc: 0.093
Validation loss decreased (-0.085257 --> -0.092712).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4823284
	speed: 0.2632s/iter; left time: 5175.2907s
	iters: 200, epoch: 6 | loss: 1.9341867
	speed: 0.0315s/iter; left time: 616.2667s
Epoch: 6 cost time: 7.714114665985107
Epoch: 6, Steps: 208 | Train Loss: 2.657 Vali Loss: 4.087 Vali Acc: 0.097 Test Loss: 4.087 Test Acc: 0.097
Validation loss decreased (-0.092712 --> -0.096589).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2454674
	speed: 0.2511s/iter; left time: 4885.0798s
	iters: 200, epoch: 7 | loss: 2.5939448
	speed: 0.0397s/iter; left time: 768.4235s
Epoch: 7 cost time: 9.412299633026123
Epoch: 7, Steps: 208 | Train Loss: 2.472 Vali Loss: 4.275 Vali Acc: 0.099 Test Loss: 4.275 Test Acc: 0.099
Validation loss decreased (-0.096589 --> -0.099271).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0787570
	speed: 0.2520s/iter; left time: 4850.3181s
	iters: 200, epoch: 8 | loss: 2.4357948
	speed: 0.0360s/iter; left time: 689.3351s
Epoch: 8 cost time: 8.308978796005249
Epoch: 8, Steps: 208 | Train Loss: 2.285 Vali Loss: 4.383 Vali Acc: 0.092 Test Loss: 4.383 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3450665
	speed: 0.2573s/iter; left time: 4898.4999s
	iters: 200, epoch: 9 | loss: 1.6479673
	speed: 0.0447s/iter; left time: 847.1136s
Epoch: 9 cost time: 9.759607791900635
Epoch: 9, Steps: 208 | Train Loss: 2.129 Vali Loss: 4.433 Vali Acc: 0.112 Test Loss: 4.433 Test Acc: 0.112
Validation loss decreased (-0.099271 --> -0.111796).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5922441
	speed: 0.2732s/iter; left time: 5143.7966s
	iters: 200, epoch: 10 | loss: 2.0393276
	speed: 0.0422s/iter; left time: 790.2738s
Epoch: 10 cost time: 9.594895362854004
Epoch: 10, Steps: 208 | Train Loss: 1.978 Vali Loss: 4.497 Vali Acc: 0.101 Test Loss: 4.497 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0184064
	speed: 0.2646s/iter; left time: 4928.0392s
	iters: 200, epoch: 11 | loss: 2.5360286
	speed: 0.0410s/iter; left time: 760.2554s
Epoch: 11 cost time: 9.574826955795288
Epoch: 11, Steps: 208 | Train Loss: 1.836 Vali Loss: 4.813 Vali Acc: 0.100 Test Loss: 4.813 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.9159110
	speed: 0.2740s/iter; left time: 5045.5425s
	iters: 200, epoch: 12 | loss: 2.6142282
	speed: 0.0399s/iter; left time: 730.0471s
Epoch: 12 cost time: 9.599279165267944
Epoch: 12, Steps: 208 | Train Loss: 1.723 Vali Loss: 4.935 Vali Acc: 0.104 Test Loss: 4.935 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6905329
	speed: 0.2724s/iter; left time: 4959.2014s
	iters: 200, epoch: 13 | loss: 2.4978373
	speed: 0.0404s/iter; left time: 731.5604s
Epoch: 13 cost time: 9.599339723587036
Epoch: 13, Steps: 208 | Train Loss: 1.627 Vali Loss: 5.086 Vali Acc: 0.105 Test Loss: 5.086 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.9732910
	speed: 0.2759s/iter; left time: 4964.9936s
	iters: 200, epoch: 14 | loss: 1.3884205
	speed: 0.0465s/iter; left time: 832.3245s
Epoch: 14 cost time: 10.60408902168274
Epoch: 14, Steps: 208 | Train Loss: 1.479 Vali Loss: 5.364 Vali Acc: 0.096 Test Loss: 5.364 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4909759
	speed: 0.2859s/iter; left time: 5086.5568s
	iters: 200, epoch: 15 | loss: 1.3601886
	speed: 0.0448s/iter; left time: 792.8044s
Epoch: 15 cost time: 10.847339868545532
Epoch: 15, Steps: 208 | Train Loss: 1.397 Vali Loss: 5.624 Vali Acc: 0.109 Test Loss: 5.624 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.1474292
	speed: 0.2895s/iter; left time: 5089.0438s
	iters: 200, epoch: 16 | loss: 1.9654847
	speed: 0.0428s/iter; left time: 748.9008s
Epoch: 16 cost time: 10.021185398101807
Epoch: 16, Steps: 208 | Train Loss: 1.305 Vali Loss: 5.819 Vali Acc: 0.107 Test Loss: 5.819 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.9083124
	speed: 0.2824s/iter; left time: 4906.2199s
	iters: 200, epoch: 17 | loss: 1.1371799
	speed: 0.0394s/iter; left time: 681.1213s
Epoch: 17 cost time: 9.148895978927612
Epoch: 17, Steps: 208 | Train Loss: 1.194 Vali Loss: 6.054 Vali Acc: 0.109 Test Loss: 6.054 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.3304464
	speed: 0.2851s/iter; left time: 4893.3337s
	iters: 200, epoch: 18 | loss: 1.0870291
	speed: 0.0429s/iter; left time: 732.0931s
Epoch: 18 cost time: 9.835444927215576
Epoch: 18, Steps: 208 | Train Loss: 1.111 Vali Loss: 6.418 Vali Acc: 0.110 Test Loss: 6.418 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9722463
	speed: 0.3036s/iter; left time: 5147.6715s
	iters: 200, epoch: 19 | loss: 1.1264420
	speed: 0.0470s/iter; left time: 792.3042s
Epoch: 19 cost time: 10.300821781158447
Epoch: 19, Steps: 208 | Train Loss: 1.048 Vali Loss: 6.689 Vali Acc: 0.105 Test Loss: 6.689 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11184014315538324
model parameter : 256967
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5009971
	speed: 0.0695s/iter; left time: 1439.5726s
	iters: 200, epoch: 1 | loss: 3.6218731
	speed: 0.0375s/iter; left time: 771.8290s
Epoch: 1 cost time: 11.160735130310059
Epoch: 1, Steps: 208 | Train Loss: 3.804 Vali Loss: 3.778 Vali Acc: 0.057 Test Loss: 3.778 Test Acc: 0.057
Validation loss decreased (inf --> -0.056628).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8086433
	speed: 0.2600s/iter; left time: 5327.8450s
	iters: 200, epoch: 2 | loss: 4.0127392
	speed: 0.0389s/iter; left time: 792.5270s
Epoch: 2 cost time: 9.050044536590576
Epoch: 2, Steps: 208 | Train Loss: 3.597 Vali Loss: 3.866 Vali Acc: 0.070 Test Loss: 3.866 Test Acc: 0.070
Validation loss decreased (-0.056628 --> -0.069750).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9017653
	speed: 0.2691s/iter; left time: 5458.6642s
	iters: 200, epoch: 3 | loss: 3.7555413
	speed: 0.0450s/iter; left time: 909.0124s
Epoch: 3 cost time: 9.822333574295044
Epoch: 3, Steps: 208 | Train Loss: 3.296 Vali Loss: 3.878 Vali Acc: 0.084 Test Loss: 3.878 Test Acc: 0.084
Validation loss decreased (-0.069750 --> -0.083469).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8188434
	speed: 0.2741s/iter; left time: 5503.3897s
	iters: 200, epoch: 4 | loss: 3.7553229
	speed: 0.0355s/iter; left time: 710.0069s
Epoch: 4 cost time: 8.750592231750488
Epoch: 4, Steps: 208 | Train Loss: 3.089 Vali Loss: 3.821 Vali Acc: 0.079 Test Loss: 3.821 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.9896870
	speed: 0.2587s/iter; left time: 5140.2948s
	iters: 200, epoch: 5 | loss: 2.7253327
	speed: 0.0351s/iter; left time: 693.6932s
Epoch: 5 cost time: 8.64658236503601
Epoch: 5, Steps: 208 | Train Loss: 2.908 Vali Loss: 4.024 Vali Acc: 0.089 Test Loss: 4.024 Test Acc: 0.089
Validation loss decreased (-0.083469 --> -0.088835).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4127014
	speed: 0.2484s/iter; left time: 4883.7651s
	iters: 200, epoch: 6 | loss: 2.3272657
	speed: 0.0372s/iter; left time: 728.2876s
Epoch: 6 cost time: 8.626893043518066
Epoch: 6, Steps: 208 | Train Loss: 2.746 Vali Loss: 4.020 Vali Acc: 0.088 Test Loss: 4.020 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7822363
	speed: 0.2499s/iter; left time: 4861.6606s
	iters: 200, epoch: 7 | loss: 3.1199970
	speed: 0.0351s/iter; left time: 678.6625s
Epoch: 7 cost time: 8.275718927383423
Epoch: 7, Steps: 208 | Train Loss: 2.554 Vali Loss: 4.084 Vali Acc: 0.093 Test Loss: 4.084 Test Acc: 0.093
Validation loss decreased (-0.088835 --> -0.093010).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3660662
	speed: 0.2543s/iter; left time: 4894.7664s
	iters: 200, epoch: 8 | loss: 1.9290508
	speed: 0.0372s/iter; left time: 711.7804s
Epoch: 8 cost time: 8.720596313476562
Epoch: 8, Steps: 208 | Train Loss: 2.455 Vali Loss: 4.202 Vali Acc: 0.100 Test Loss: 4.202 Test Acc: 0.100
Validation loss decreased (-0.093010 --> -0.099570).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7841773
	speed: 0.2335s/iter; left time: 4444.6343s
	iters: 200, epoch: 9 | loss: 2.4494543
	speed: 0.0330s/iter; left time: 624.0550s
Epoch: 9 cost time: 7.88862943649292
Epoch: 9, Steps: 208 | Train Loss: 2.316 Vali Loss: 4.285 Vali Acc: 0.094 Test Loss: 4.285 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3387294
	speed: 0.2526s/iter; left time: 4756.5219s
	iters: 200, epoch: 10 | loss: 2.6976552
	speed: 0.0377s/iter; left time: 706.6043s
Epoch: 10 cost time: 8.958426237106323
Epoch: 10, Steps: 208 | Train Loss: 2.202 Vali Loss: 4.425 Vali Acc: 0.095 Test Loss: 4.425 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9254191
	speed: 0.2555s/iter; left time: 4756.8528s
	iters: 200, epoch: 11 | loss: 2.3128300
	speed: 0.0374s/iter; left time: 691.9465s
Epoch: 11 cost time: 9.126795768737793
Epoch: 11, Steps: 208 | Train Loss: 2.083 Vali Loss: 4.537 Vali Acc: 0.100 Test Loss: 4.537 Test Acc: 0.100
Validation loss decreased (-0.099570 --> -0.099865).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2915993
	speed: 0.2731s/iter; left time: 5028.2968s
	iters: 200, epoch: 12 | loss: 1.8419505
	speed: 0.0444s/iter; left time: 813.2528s
Epoch: 12 cost time: 10.088306427001953
Epoch: 12, Steps: 208 | Train Loss: 1.947 Vali Loss: 4.684 Vali Acc: 0.105 Test Loss: 4.684 Test Acc: 0.105
Validation loss decreased (-0.099865 --> -0.105232).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3007493
	speed: 0.2861s/iter; left time: 5208.1107s
	iters: 200, epoch: 13 | loss: 2.1465304
	speed: 0.0376s/iter; left time: 680.9985s
Epoch: 13 cost time: 9.61504316329956
Epoch: 13, Steps: 208 | Train Loss: 1.898 Vali Loss: 4.761 Vali Acc: 0.100 Test Loss: 4.761 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.8281636
	speed: 0.2928s/iter; left time: 5270.0859s
	iters: 200, epoch: 14 | loss: 2.6096230
	speed: 0.0329s/iter; left time: 588.0114s
Epoch: 14 cost time: 8.763576984405518
Epoch: 14, Steps: 208 | Train Loss: 1.779 Vali Loss: 4.909 Vali Acc: 0.103 Test Loss: 4.909 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.1123147
	speed: 0.2647s/iter; left time: 4708.8083s
	iters: 200, epoch: 15 | loss: 2.1644540
	speed: 0.0410s/iter; left time: 725.3118s
Epoch: 15 cost time: 8.791885137557983
Epoch: 15, Steps: 208 | Train Loss: 1.702 Vali Loss: 5.112 Vali Acc: 0.107 Test Loss: 5.112 Test Acc: 0.107
Validation loss decreased (-0.105232 --> -0.106719).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6276422
	speed: 0.2394s/iter; left time: 4208.8964s
	iters: 200, epoch: 16 | loss: 2.7252634
	speed: 0.0361s/iter; left time: 631.5302s
Epoch: 16 cost time: 7.931874752044678
Epoch: 16, Steps: 208 | Train Loss: 1.579 Vali Loss: 5.223 Vali Acc: 0.113 Test Loss: 5.223 Test Acc: 0.113
Validation loss decreased (-0.106719 --> -0.112981).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8322761
	speed: 0.2520s/iter; left time: 4378.7583s
	iters: 200, epoch: 17 | loss: 1.6865950
	speed: 0.0336s/iter; left time: 579.7259s
Epoch: 17 cost time: 8.62268614768982
Epoch: 17, Steps: 208 | Train Loss: 1.552 Vali Loss: 5.378 Vali Acc: 0.114 Test Loss: 5.378 Test Acc: 0.114
Validation loss decreased (-0.112981 --> -0.113874).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2530112
	speed: 0.2479s/iter; left time: 4255.3183s
	iters: 200, epoch: 18 | loss: 1.7391405
	speed: 0.0372s/iter; left time: 635.3942s
Epoch: 18 cost time: 8.90301513671875
Epoch: 18, Steps: 208 | Train Loss: 1.481 Vali Loss: 5.686 Vali Acc: 0.103 Test Loss: 5.686 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.1095147
	speed: 0.2588s/iter; left time: 4388.1550s
	iters: 200, epoch: 19 | loss: 2.3127491
	speed: 0.0323s/iter; left time: 544.1185s
Epoch: 19 cost time: 8.356941938400269
Epoch: 19, Steps: 208 | Train Loss: 1.427 Vali Loss: 5.802 Vali Acc: 0.102 Test Loss: 5.802 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.4792825
	speed: 0.2480s/iter; left time: 4153.3828s
	iters: 200, epoch: 20 | loss: 1.5658643
	speed: 0.0348s/iter; left time: 580.1638s
Epoch: 20 cost time: 9.021349430084229
Epoch: 20, Steps: 208 | Train Loss: 1.336 Vali Loss: 6.035 Vali Acc: 0.106 Test Loss: 6.035 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.7925570
	speed: 0.2704s/iter; left time: 4473.2728s
	iters: 200, epoch: 21 | loss: 1.7459114
	speed: 0.0408s/iter; left time: 671.3274s
Epoch: 21 cost time: 9.516198873519897
Epoch: 21, Steps: 208 | Train Loss: 1.282 Vali Loss: 6.139 Vali Acc: 0.109 Test Loss: 6.139 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.4305384
	speed: 0.2754s/iter; left time: 4498.8687s
	iters: 200, epoch: 22 | loss: 1.9026978
	speed: 0.0399s/iter; left time: 647.1356s
Epoch: 22 cost time: 8.869911909103394
Epoch: 22, Steps: 208 | Train Loss: 1.223 Vali Loss: 6.320 Vali Acc: 0.101 Test Loss: 6.320 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.2560902
	speed: 0.2723s/iter; left time: 4391.1314s
	iters: 200, epoch: 23 | loss: 1.4770360
	speed: 0.0459s/iter; left time: 734.9816s
Epoch: 23 cost time: 10.17378830909729
Epoch: 23, Steps: 208 | Train Loss: 1.175 Vali Loss: 6.582 Vali Acc: 0.104 Test Loss: 6.582 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.3321724
	speed: 0.2889s/iter; left time: 4598.6533s
	iters: 200, epoch: 24 | loss: 0.9795134
	speed: 0.0438s/iter; left time: 692.1500s
Epoch: 24 cost time: 9.93736743927002
Epoch: 24, Steps: 208 | Train Loss: 1.131 Vali Loss: 6.795 Vali Acc: 0.106 Test Loss: 6.795 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.2692066
	speed: 0.2718s/iter; left time: 4270.3175s
	iters: 200, epoch: 25 | loss: 0.7680923
	speed: 0.0461s/iter; left time: 719.0727s
Epoch: 25 cost time: 9.802163124084473
Epoch: 25, Steps: 208 | Train Loss: 1.070 Vali Loss: 6.980 Vali Acc: 0.104 Test Loss: 6.980 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.9974074
	speed: 0.2783s/iter; left time: 4313.2083s
	iters: 200, epoch: 26 | loss: 1.0002947
	speed: 0.0452s/iter; left time: 695.4721s
Epoch: 26 cost time: 10.268147945404053
Epoch: 26, Steps: 208 | Train Loss: 1.017 Vali Loss: 7.232 Vali Acc: 0.103 Test Loss: 7.232 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.1791111
	speed: 0.3002s/iter; left time: 4590.4243s
	iters: 200, epoch: 27 | loss: 1.1966815
	speed: 0.0452s/iter; left time: 686.5073s
Epoch: 27 cost time: 10.318482637405396
Epoch: 27, Steps: 208 | Train Loss: 1.012 Vali Loss: 7.351 Vali Acc: 0.103 Test Loss: 7.351 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11392782582761705
model parameter : 174695
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9252505
	speed: 0.0765s/iter; left time: 1583.5129s
	iters: 200, epoch: 1 | loss: 3.7833180
	speed: 0.0421s/iter; left time: 868.2739s
Epoch: 1 cost time: 12.555295705795288
Epoch: 1, Steps: 208 | Train Loss: 3.818 Vali Loss: 3.812 Vali Acc: 0.057 Test Loss: 3.812 Test Acc: 0.057
Validation loss decreased (inf --> -0.056628).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4643378
	speed: 0.2921s/iter; left time: 5985.8245s
	iters: 200, epoch: 2 | loss: 3.4778533
	speed: 0.0459s/iter; left time: 935.4481s
Epoch: 2 cost time: 10.49900507926941
Epoch: 2, Steps: 208 | Train Loss: 3.598 Vali Loss: 3.787 Vali Acc: 0.063 Test Loss: 3.787 Test Acc: 0.063
Validation loss decreased (-0.056628 --> -0.062593).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8510292
	speed: 0.2808s/iter; left time: 5695.9739s
	iters: 200, epoch: 3 | loss: 3.5222449
	speed: 0.0440s/iter; left time: 889.1434s
Epoch: 3 cost time: 10.456865072250366
Epoch: 3, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.854 Vali Acc: 0.064 Test Loss: 3.854 Test Acc: 0.064
Validation loss decreased (-0.062593 --> -0.064083).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4246533
	speed: 0.2884s/iter; left time: 5790.3291s
	iters: 200, epoch: 4 | loss: 2.9719539
	speed: 0.0395s/iter; left time: 788.9478s
Epoch: 4 cost time: 9.651061296463013
Epoch: 4, Steps: 208 | Train Loss: 3.209 Vali Loss: 3.876 Vali Acc: 0.071 Test Loss: 3.876 Test Acc: 0.071
Validation loss decreased (-0.064083 --> -0.070644).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0175295
	speed: 0.2763s/iter; left time: 5490.6240s
	iters: 200, epoch: 5 | loss: 2.4141533
	speed: 0.0362s/iter; left time: 715.6355s
Epoch: 5 cost time: 8.76280403137207
Epoch: 5, Steps: 208 | Train Loss: 3.053 Vali Loss: 3.945 Vali Acc: 0.075 Test Loss: 3.945 Test Acc: 0.075
Validation loss decreased (-0.070644 --> -0.074819).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1616783
	speed: 0.2736s/iter; left time: 5379.9469s
	iters: 200, epoch: 6 | loss: 2.9895244
	speed: 0.0330s/iter; left time: 645.0450s
Epoch: 6 cost time: 8.066949605941772
Epoch: 6, Steps: 208 | Train Loss: 2.918 Vali Loss: 3.877 Vali Acc: 0.084 Test Loss: 3.877 Test Acc: 0.084
Validation loss decreased (-0.074819 --> -0.083469).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1784456
	speed: 0.2778s/iter; left time: 5404.4116s
	iters: 200, epoch: 7 | loss: 3.0191305
	speed: 0.0320s/iter; left time: 619.1192s
Epoch: 7 cost time: 8.172619104385376
Epoch: 7, Steps: 208 | Train Loss: 2.749 Vali Loss: 3.994 Vali Acc: 0.090 Test Loss: 3.994 Test Acc: 0.090
Validation loss decreased (-0.083469 --> -0.089730).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4430535
	speed: 0.2690s/iter; left time: 5176.3285s
	iters: 200, epoch: 8 | loss: 2.9487963
	speed: 0.0351s/iter; left time: 671.6897s
Epoch: 8 cost time: 8.559518575668335
Epoch: 8, Steps: 208 | Train Loss: 2.645 Vali Loss: 3.999 Vali Acc: 0.092 Test Loss: 3.999 Test Acc: 0.092
Validation loss decreased (-0.089730 --> -0.091520).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7515726
	speed: 0.2830s/iter; left time: 5388.1288s
	iters: 200, epoch: 9 | loss: 3.9524899
	speed: 0.0370s/iter; left time: 699.8959s
Epoch: 9 cost time: 9.260133504867554
Epoch: 9, Steps: 208 | Train Loss: 2.523 Vali Loss: 4.033 Vali Acc: 0.089 Test Loss: 4.033 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4857569
	speed: 0.2863s/iter; left time: 5391.0302s
	iters: 200, epoch: 10 | loss: 2.9328947
	speed: 0.0410s/iter; left time: 767.4116s
Epoch: 10 cost time: 9.879937171936035
Epoch: 10, Steps: 208 | Train Loss: 2.417 Vali Loss: 4.027 Vali Acc: 0.100 Test Loss: 4.027 Test Acc: 0.100
Validation loss decreased (-0.091520 --> -0.099572).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4899321
	speed: 0.2796s/iter; left time: 5207.1808s
	iters: 200, epoch: 11 | loss: 2.7722380
	speed: 0.0390s/iter; left time: 722.3137s
Epoch: 11 cost time: 9.350458860397339
Epoch: 11, Steps: 208 | Train Loss: 2.314 Vali Loss: 4.168 Vali Acc: 0.097 Test Loss: 4.168 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8937694
	speed: 0.2758s/iter; left time: 5077.4133s
	iters: 200, epoch: 12 | loss: 2.7626436
	speed: 0.0416s/iter; left time: 762.5636s
Epoch: 12 cost time: 9.706600189208984
Epoch: 12, Steps: 208 | Train Loss: 2.175 Vali Loss: 4.248 Vali Acc: 0.102 Test Loss: 4.248 Test Acc: 0.102
Validation loss decreased (-0.099572 --> -0.101657).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3273025
	speed: 0.2731s/iter; left time: 4971.7239s
	iters: 200, epoch: 13 | loss: 2.5647707
	speed: 0.0386s/iter; left time: 698.8974s
Epoch: 13 cost time: 9.10297679901123
Epoch: 13, Steps: 208 | Train Loss: 2.092 Vali Loss: 4.347 Vali Acc: 0.091 Test Loss: 4.347 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3439952
	speed: 0.2669s/iter; left time: 4802.9453s
	iters: 200, epoch: 14 | loss: 1.9371581
	speed: 0.0407s/iter; left time: 728.1211s
Epoch: 14 cost time: 9.12038516998291
Epoch: 14, Steps: 208 | Train Loss: 1.990 Vali Loss: 4.568 Vali Acc: 0.095 Test Loss: 4.568 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7439394
	speed: 0.2741s/iter; left time: 4876.4311s
	iters: 200, epoch: 15 | loss: 1.3971596
	speed: 0.0391s/iter; left time: 690.9338s
Epoch: 15 cost time: 9.312114953994751
Epoch: 15, Steps: 208 | Train Loss: 1.931 Vali Loss: 4.633 Vali Acc: 0.097 Test Loss: 4.633 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.7090718
	speed: 0.2595s/iter; left time: 4562.9325s
	iters: 200, epoch: 16 | loss: 1.7106324
	speed: 0.0284s/iter; left time: 496.9361s
Epoch: 16 cost time: 7.449224233627319
Epoch: 16, Steps: 208 | Train Loss: 1.824 Vali Loss: 4.764 Vali Acc: 0.101 Test Loss: 4.764 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3854783
	speed: 0.2479s/iter; left time: 4306.4152s
	iters: 200, epoch: 17 | loss: 1.7364715
	speed: 0.0330s/iter; left time: 569.5405s
Epoch: 17 cost time: 8.138798952102661
Epoch: 17, Steps: 208 | Train Loss: 1.789 Vali Loss: 4.821 Vali Acc: 0.097 Test Loss: 4.821 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.9365517
	speed: 0.2569s/iter; left time: 4409.2451s
	iters: 200, epoch: 18 | loss: 1.5687008
	speed: 0.0352s/iter; left time: 600.6751s
Epoch: 18 cost time: 8.724299669265747
Epoch: 18, Steps: 208 | Train Loss: 1.709 Vali Loss: 5.043 Vali Acc: 0.097 Test Loss: 5.043 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.6757940
	speed: 0.2590s/iter; left time: 4391.6887s
	iters: 200, epoch: 19 | loss: 1.6518322
	speed: 0.0381s/iter; left time: 641.9269s
Epoch: 19 cost time: 9.176435947418213
Epoch: 19, Steps: 208 | Train Loss: 1.675 Vali Loss: 5.145 Vali Acc: 0.095 Test Loss: 5.145 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.7726188
	speed: 0.2601s/iter; left time: 4357.2102s
	iters: 200, epoch: 20 | loss: 1.2352085
	speed: 0.0412s/iter; left time: 685.1769s
Epoch: 20 cost time: 9.450837850570679
Epoch: 20, Steps: 208 | Train Loss: 1.633 Vali Loss: 5.281 Vali Acc: 0.103 Test Loss: 5.281 Test Acc: 0.103
Validation loss decreased (-0.101657 --> -0.102542).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.0247105
	speed: 0.2867s/iter; left time: 4742.2639s
	iters: 200, epoch: 21 | loss: 2.0452394
	speed: 0.0413s/iter; left time: 679.3972s
Epoch: 21 cost time: 9.980221033096313
Epoch: 21, Steps: 208 | Train Loss: 1.539 Vali Loss: 5.438 Vali Acc: 0.103 Test Loss: 5.438 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.6456772
	speed: 0.2897s/iter; left time: 4731.7809s
	iters: 200, epoch: 22 | loss: 1.3085220
	speed: 0.0359s/iter; left time: 582.4484s
Epoch: 22 cost time: 8.989049434661865
Epoch: 22, Steps: 208 | Train Loss: 1.499 Vali Loss: 5.593 Vali Acc: 0.098 Test Loss: 5.593 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 2.0254502
	speed: 0.2627s/iter; left time: 4235.9136s
	iters: 200, epoch: 23 | loss: 1.5100998
	speed: 0.0392s/iter; left time: 628.3768s
Epoch: 23 cost time: 8.84722089767456
Epoch: 23, Steps: 208 | Train Loss: 1.430 Vali Loss: 5.715 Vali Acc: 0.097 Test Loss: 5.715 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.0213323
	speed: 0.2682s/iter; left time: 4268.7817s
	iters: 200, epoch: 24 | loss: 1.4289068
	speed: 0.0390s/iter; left time: 616.1957s
Epoch: 24 cost time: 9.289904594421387
Epoch: 24, Steps: 208 | Train Loss: 1.411 Vali Loss: 5.776 Vali Acc: 0.099 Test Loss: 5.776 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 2.0952792
	speed: 0.2747s/iter; left time: 4315.7157s
	iters: 200, epoch: 25 | loss: 1.5534955
	speed: 0.0432s/iter; left time: 674.8926s
Epoch: 25 cost time: 9.416223526000977
Epoch: 25, Steps: 208 | Train Loss: 1.352 Vali Loss: 6.027 Vali Acc: 0.097 Test Loss: 6.027 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.8046992
	speed: 0.2832s/iter; left time: 4389.3476s
	iters: 200, epoch: 26 | loss: 1.6206734
	speed: 0.0353s/iter; left time: 543.7089s
Epoch: 26 cost time: 9.443455696105957
Epoch: 26, Steps: 208 | Train Loss: 1.277 Vali Loss: 6.207 Vali Acc: 0.095 Test Loss: 6.207 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.3319839
	speed: 0.2760s/iter; left time: 4221.5761s
	iters: 200, epoch: 27 | loss: 1.1627012
	speed: 0.0361s/iter; left time: 548.4335s
Epoch: 27 cost time: 9.199189186096191
Epoch: 27, Steps: 208 | Train Loss: 1.283 Vali Loss: 6.313 Vali Acc: 0.100 Test Loss: 6.313 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.7630126
	speed: 0.2600s/iter; left time: 3921.8815s
	iters: 200, epoch: 28 | loss: 0.9960102
	speed: 0.0357s/iter; left time: 535.3941s
Epoch: 28 cost time: 8.19360089302063
Epoch: 28, Steps: 208 | Train Loss: 1.252 Vali Loss: 6.407 Vali Acc: 0.101 Test Loss: 6.407 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.1777462
	speed: 0.2557s/iter; left time: 3803.4836s
	iters: 200, epoch: 29 | loss: 1.3679976
	speed: 0.0357s/iter; left time: 527.1592s
Epoch: 29 cost time: 8.235654592514038
Epoch: 29, Steps: 208 | Train Loss: 1.223 Vali Loss: 6.492 Vali Acc: 0.106 Test Loss: 6.492 Test Acc: 0.106
Validation loss decreased (-0.102542 --> -0.106109).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.2125190
	speed: 0.2371s/iter; left time: 3478.3209s
	iters: 200, epoch: 30 | loss: 1.5953896
	speed: 0.0355s/iter; left time: 517.5900s
Epoch: 30 cost time: 8.426824808120728
Epoch: 30, Steps: 208 | Train Loss: 1.176 Vali Loss: 6.671 Vali Acc: 0.106 Test Loss: 6.671 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.7321053
	speed: 0.2616s/iter; left time: 3783.5068s
	iters: 200, epoch: 31 | loss: 1.0345659
	speed: 0.0375s/iter; left time: 538.5504s
Epoch: 31 cost time: 8.663540124893188
Epoch: 31, Steps: 208 | Train Loss: 1.117 Vali Loss: 6.830 Vali Acc: 0.103 Test Loss: 6.830 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.8677790
	speed: 0.2657s/iter; left time: 3786.9012s
	iters: 200, epoch: 32 | loss: 1.5213544
	speed: 0.0395s/iter; left time: 559.7459s
Epoch: 32 cost time: 9.256748676300049
Epoch: 32, Steps: 208 | Train Loss: 1.106 Vali Loss: 7.084 Vali Acc: 0.101 Test Loss: 7.084 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.8559561
	speed: 0.2669s/iter; left time: 3748.8110s
	iters: 200, epoch: 33 | loss: 1.4695044
	speed: 0.0405s/iter; left time: 565.2643s
Epoch: 33 cost time: 9.63192081451416
Epoch: 33, Steps: 208 | Train Loss: 1.062 Vali Loss: 7.104 Vali Acc: 0.103 Test Loss: 7.104 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.7015973
	speed: 0.2618s/iter; left time: 3622.0202s
	iters: 200, epoch: 34 | loss: 2.6572218
	speed: 0.0319s/iter; left time: 437.7804s
Epoch: 34 cost time: 8.466161012649536
Epoch: 34, Steps: 208 | Train Loss: 1.046 Vali Loss: 7.274 Vali Acc: 0.104 Test Loss: 7.274 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.6285843
	speed: 0.2678s/iter; left time: 3649.8141s
	iters: 200, epoch: 35 | loss: 0.6789754
	speed: 0.0391s/iter; left time: 528.3511s
Epoch: 35 cost time: 9.043975114822388
Epoch: 35, Steps: 208 | Train Loss: 1.037 Vali Loss: 7.399 Vali Acc: 0.102 Test Loss: 7.399 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.7974399
	speed: 0.2610s/iter; left time: 3502.7717s
	iters: 200, epoch: 36 | loss: 1.2415694
	speed: 0.0406s/iter; left time: 540.9730s
Epoch: 36 cost time: 9.203434705734253
Epoch: 36, Steps: 208 | Train Loss: 0.970 Vali Loss: 7.630 Vali Acc: 0.105 Test Loss: 7.630 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.3280998
	speed: 0.2552s/iter; left time: 3372.1866s
	iters: 200, epoch: 37 | loss: 1.1784501
	speed: 0.0367s/iter; left time: 480.8781s
Epoch: 37 cost time: 8.530654191970825
Epoch: 37, Steps: 208 | Train Loss: 0.953 Vali Loss: 7.608 Vali Acc: 0.106 Test Loss: 7.608 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 2.0131311
	speed: 0.2750s/iter; left time: 3576.5565s
	iters: 200, epoch: 38 | loss: 1.2920132
	speed: 0.0415s/iter; left time: 535.7453s
Epoch: 38 cost time: 9.81428599357605
Epoch: 38, Steps: 208 | Train Loss: 0.921 Vali Loss: 7.809 Vali Acc: 0.100 Test Loss: 7.809 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.7758603
	speed: 0.2714s/iter; left time: 3472.5553s
	iters: 200, epoch: 39 | loss: 1.3523728
	speed: 0.0350s/iter; left time: 444.4582s
Epoch: 39 cost time: 8.225537776947021
Epoch: 39, Steps: 208 | Train Loss: 0.881 Vali Loss: 8.148 Vali Acc: 0.104 Test Loss: 8.148 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10617357590217716
model parameter : 140455
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7157581
	speed: 0.0705s/iter; left time: 1458.7112s
	iters: 200, epoch: 1 | loss: 3.4061763
	speed: 0.0331s/iter; left time: 681.0500s
Epoch: 1 cost time: 10.934781074523926
Epoch: 1, Steps: 208 | Train Loss: 3.772 Vali Loss: 3.692 Vali Acc: 0.057 Test Loss: 3.692 Test Acc: 0.057
Validation loss decreased (inf --> -0.057225).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7663574
	speed: 0.2327s/iter; left time: 4767.9518s
	iters: 200, epoch: 2 | loss: 3.4792473
	speed: 0.0309s/iter; left time: 630.1985s
Epoch: 2 cost time: 7.4958391189575195
Epoch: 2, Steps: 208 | Train Loss: 3.581 Vali Loss: 3.744 Vali Acc: 0.062 Test Loss: 3.744 Test Acc: 0.062
Validation loss decreased (-0.057225 --> -0.062295).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5615234
	speed: 0.2196s/iter; left time: 4455.5936s
	iters: 200, epoch: 3 | loss: 3.0596561
	speed: 0.0317s/iter; left time: 639.2914s
Epoch: 3 cost time: 7.284095525741577
Epoch: 3, Steps: 208 | Train Loss: 3.391 Vali Loss: 3.731 Vali Acc: 0.077 Test Loss: 3.731 Test Acc: 0.077
Validation loss decreased (-0.062295 --> -0.076909).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1831934
	speed: 0.2185s/iter; left time: 4386.3209s
	iters: 200, epoch: 4 | loss: 3.0566399
	speed: 0.0327s/iter; left time: 653.4151s
Epoch: 4 cost time: 7.198270797729492
Epoch: 4, Steps: 208 | Train Loss: 3.222 Vali Loss: 3.678 Vali Acc: 0.079 Test Loss: 3.678 Test Acc: 0.079
Validation loss decreased (-0.076909 --> -0.079295).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3399119
	speed: 0.2350s/iter; left time: 4668.9714s
	iters: 200, epoch: 5 | loss: 2.7893996
	speed: 0.0356s/iter; left time: 704.1083s
Epoch: 5 cost time: 7.893083333969116
Epoch: 5, Steps: 208 | Train Loss: 3.077 Vali Loss: 3.728 Vali Acc: 0.083 Test Loss: 3.728 Test Acc: 0.083
Validation loss decreased (-0.079295 --> -0.083172).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9298339
	speed: 0.2315s/iter; left time: 4552.0548s
	iters: 200, epoch: 6 | loss: 3.5498340
	speed: 0.0349s/iter; left time: 683.2940s
Epoch: 6 cost time: 7.969645977020264
Epoch: 6, Steps: 208 | Train Loss: 2.950 Vali Loss: 3.726 Vali Acc: 0.093 Test Loss: 3.726 Test Acc: 0.093
Validation loss decreased (-0.083172 --> -0.092716).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8752050
	speed: 0.2608s/iter; left time: 5073.8902s
	iters: 200, epoch: 7 | loss: 3.5632141
	speed: 0.0336s/iter; left time: 649.6331s
Epoch: 7 cost time: 8.118534088134766
Epoch: 7, Steps: 208 | Train Loss: 2.872 Vali Loss: 3.840 Vali Acc: 0.091 Test Loss: 3.840 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3324234
	speed: 0.2544s/iter; left time: 4895.1863s
	iters: 200, epoch: 8 | loss: 3.0222816
	speed: 0.0361s/iter; left time: 691.8149s
Epoch: 8 cost time: 8.568514347076416
Epoch: 8, Steps: 208 | Train Loss: 2.752 Vali Loss: 3.812 Vali Acc: 0.094 Test Loss: 3.812 Test Acc: 0.094
Validation loss decreased (-0.092716 --> -0.093609).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5991931
	speed: 0.2542s/iter; left time: 4839.9275s
	iters: 200, epoch: 9 | loss: 3.4986067
	speed: 0.0404s/iter; left time: 764.4256s
Epoch: 9 cost time: 9.22770094871521
Epoch: 9, Steps: 208 | Train Loss: 2.669 Vali Loss: 3.868 Vali Acc: 0.104 Test Loss: 3.868 Test Acc: 0.104
Validation loss decreased (-0.093609 --> -0.103749).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5494184
	speed: 0.2499s/iter; left time: 4704.8265s
	iters: 200, epoch: 10 | loss: 2.7480986
	speed: 0.0398s/iter; left time: 745.6921s
Epoch: 10 cost time: 8.916114807128906
Epoch: 10, Steps: 208 | Train Loss: 2.583 Vali Loss: 3.903 Vali Acc: 0.101 Test Loss: 3.903 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2684171
	speed: 0.2343s/iter; left time: 4363.0430s
	iters: 200, epoch: 11 | loss: 2.8553593
	speed: 0.0373s/iter; left time: 690.3519s
Epoch: 11 cost time: 8.84103775024414
Epoch: 11, Steps: 208 | Train Loss: 2.506 Vali Loss: 3.943 Vali Acc: 0.103 Test Loss: 3.943 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3133764
	speed: 0.2590s/iter; left time: 4768.0773s
	iters: 200, epoch: 12 | loss: 2.5556998
	speed: 0.0383s/iter; left time: 700.7563s
Epoch: 12 cost time: 9.253822088241577
Epoch: 12, Steps: 208 | Train Loss: 2.455 Vali Loss: 4.058 Vali Acc: 0.100 Test Loss: 4.058 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.8050920
	speed: 0.2456s/iter; left time: 4471.2296s
	iters: 200, epoch: 13 | loss: 3.4047084
	speed: 0.0346s/iter; left time: 625.8886s
Epoch: 13 cost time: 8.797077894210815
Epoch: 13, Steps: 208 | Train Loss: 2.367 Vali Loss: 4.094 Vali Acc: 0.108 Test Loss: 4.094 Test Acc: 0.108
Validation loss decreased (-0.103749 --> -0.107922).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3776782
	speed: 0.2483s/iter; left time: 4469.5219s
	iters: 200, epoch: 14 | loss: 2.2456114
	speed: 0.0383s/iter; left time: 685.7562s
Epoch: 14 cost time: 9.070444583892822
Epoch: 14, Steps: 208 | Train Loss: 2.307 Vali Loss: 4.127 Vali Acc: 0.100 Test Loss: 4.127 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.5260506
	speed: 0.2477s/iter; left time: 4407.1890s
	iters: 200, epoch: 15 | loss: 2.0912757
	speed: 0.0399s/iter; left time: 706.2159s
Epoch: 15 cost time: 8.918476104736328
Epoch: 15, Steps: 208 | Train Loss: 2.226 Vali Loss: 4.220 Vali Acc: 0.103 Test Loss: 4.220 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.2168989
	speed: 0.2466s/iter; left time: 4335.5735s
	iters: 200, epoch: 16 | loss: 1.9716709
	speed: 0.0343s/iter; left time: 600.4420s
Epoch: 16 cost time: 8.322339296340942
Epoch: 16, Steps: 208 | Train Loss: 2.222 Vali Loss: 4.266 Vali Acc: 0.105 Test Loss: 4.266 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.5281055
	speed: 0.2292s/iter; left time: 3982.1447s
	iters: 200, epoch: 17 | loss: 2.4585009
	speed: 0.0427s/iter; left time: 737.8128s
Epoch: 17 cost time: 8.538466215133667
Epoch: 17, Steps: 208 | Train Loss: 2.121 Vali Loss: 4.405 Vali Acc: 0.096 Test Loss: 4.405 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.3223302
	speed: 0.2311s/iter; left time: 3967.2115s
	iters: 200, epoch: 18 | loss: 2.2223048
	speed: 0.0404s/iter; left time: 688.7375s
Epoch: 18 cost time: 8.57429051399231
Epoch: 18, Steps: 208 | Train Loss: 2.086 Vali Loss: 4.423 Vali Acc: 0.103 Test Loss: 4.423 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.9849143
	speed: 0.2348s/iter; left time: 3982.2354s
	iters: 200, epoch: 19 | loss: 2.7234597
	speed: 0.0401s/iter; left time: 675.5269s
Epoch: 19 cost time: 8.706881284713745
Epoch: 19, Steps: 208 | Train Loss: 2.037 Vali Loss: 4.494 Vali Acc: 0.104 Test Loss: 4.494 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.9830321
	speed: 0.2389s/iter; left time: 4001.7259s
	iters: 200, epoch: 20 | loss: 2.7964416
	speed: 0.0360s/iter; left time: 599.6405s
Epoch: 20 cost time: 8.311565160751343
Epoch: 20, Steps: 208 | Train Loss: 1.982 Vali Loss: 4.596 Vali Acc: 0.102 Test Loss: 4.596 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 2.2631023
	speed: 0.2376s/iter; left time: 3930.1261s
	iters: 200, epoch: 21 | loss: 2.4509158
	speed: 0.0282s/iter; left time: 463.9364s
Epoch: 21 cost time: 7.613731145858765
Epoch: 21, Steps: 208 | Train Loss: 1.936 Vali Loss: 4.756 Vali Acc: 0.109 Test Loss: 4.756 Test Acc: 0.109
Validation loss decreased (-0.107922 --> -0.108810).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.8124030
	speed: 0.2160s/iter; left time: 3527.9272s
	iters: 200, epoch: 22 | loss: 1.7314780
	speed: 0.0220s/iter; left time: 357.1931s
Epoch: 22 cost time: 6.084237575531006
Epoch: 22, Steps: 208 | Train Loss: 1.894 Vali Loss: 4.733 Vali Acc: 0.106 Test Loss: 4.733 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.6747795
	speed: 0.2122s/iter; left time: 3421.3130s
	iters: 200, epoch: 23 | loss: 2.3303020
	speed: 0.0265s/iter; left time: 423.9532s
Epoch: 23 cost time: 6.5364110469818115
Epoch: 23, Steps: 208 | Train Loss: 1.858 Vali Loss: 4.823 Vali Acc: 0.112 Test Loss: 4.823 Test Acc: 0.112
Validation loss decreased (-0.108810 --> -0.112090).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.8932638
	speed: 0.2032s/iter; left time: 3234.8946s
	iters: 200, epoch: 24 | loss: 2.5573766
	speed: 0.0238s/iter; left time: 376.3152s
Epoch: 24 cost time: 6.460963487625122
Epoch: 24, Steps: 208 | Train Loss: 1.786 Vali Loss: 4.933 Vali Acc: 0.110 Test Loss: 4.933 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1981498
	speed: 0.1936s/iter; left time: 3040.6226s
	iters: 200, epoch: 25 | loss: 1.8619680
	speed: 0.0254s/iter; left time: 396.5405s
Epoch: 25 cost time: 6.618268013000488
Epoch: 25, Steps: 208 | Train Loss: 1.762 Vali Loss: 4.967 Vali Acc: 0.109 Test Loss: 4.967 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.9702373
	speed: 0.1891s/iter; left time: 2931.3971s
	iters: 200, epoch: 26 | loss: 1.8357778
	speed: 0.0315s/iter; left time: 484.4423s
Epoch: 26 cost time: 7.308556795120239
Epoch: 26, Steps: 208 | Train Loss: 1.724 Vali Loss: 5.126 Vali Acc: 0.107 Test Loss: 5.126 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.1877650
	speed: 0.2006s/iter; left time: 3067.4369s
	iters: 200, epoch: 27 | loss: 2.1906564
	speed: 0.0315s/iter; left time: 478.1732s
Epoch: 27 cost time: 7.472697734832764
Epoch: 27, Steps: 208 | Train Loss: 1.694 Vali Loss: 5.158 Vali Acc: 0.110 Test Loss: 5.158 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.5640453
	speed: 0.2115s/iter; left time: 3189.7283s
	iters: 200, epoch: 28 | loss: 2.3983548
	speed: 0.0282s/iter; left time: 422.8894s
Epoch: 28 cost time: 7.321501731872559
Epoch: 28, Steps: 208 | Train Loss: 1.633 Vali Loss: 5.373 Vali Acc: 0.101 Test Loss: 5.373 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.4409997
	speed: 0.2218s/iter; left time: 3300.2525s
	iters: 200, epoch: 29 | loss: 1.7933640
	speed: 0.0280s/iter; left time: 414.4929s
Epoch: 29 cost time: 6.853061199188232
Epoch: 29, Steps: 208 | Train Loss: 1.600 Vali Loss: 5.389 Vali Acc: 0.102 Test Loss: 5.389 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.1719971
	speed: 0.2340s/iter; left time: 3432.6031s
	iters: 200, epoch: 30 | loss: 2.1272001
	speed: 0.0241s/iter; left time: 350.6917s
Epoch: 30 cost time: 6.731816530227661
Epoch: 30, Steps: 208 | Train Loss: 1.567 Vali Loss: 5.466 Vali Acc: 0.107 Test Loss: 5.466 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 2.3886724
	speed: 0.2433s/iter; left time: 3518.6650s
	iters: 200, epoch: 31 | loss: 1.0698426
	speed: 0.0344s/iter; left time: 493.4233s
Epoch: 31 cost time: 7.869840621948242
Epoch: 31, Steps: 208 | Train Loss: 1.530 Vali Loss: 5.620 Vali Acc: 0.106 Test Loss: 5.620 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 1.4077929
	speed: 0.2643s/iter; left time: 3767.7704s
	iters: 200, epoch: 32 | loss: 2.1838198
	speed: 0.0322s/iter; left time: 455.7328s
Epoch: 32 cost time: 8.040892601013184
Epoch: 32, Steps: 208 | Train Loss: 1.503 Vali Loss: 5.621 Vali Acc: 0.105 Test Loss: 5.621 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.6738840
	speed: 0.2519s/iter; left time: 3537.9377s
	iters: 200, epoch: 33 | loss: 1.9506766
	speed: 0.0395s/iter; left time: 551.3279s
Epoch: 33 cost time: 8.665974855422974
Epoch: 33, Steps: 208 | Train Loss: 1.470 Vali Loss: 5.782 Vali Acc: 0.107 Test Loss: 5.782 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11213838353713093
model parameter : 92583
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7252653
	speed: 0.0681s/iter; left time: 1409.5139s
	iters: 200, epoch: 1 | loss: 3.4721541
	speed: 0.0348s/iter; left time: 716.2070s
Epoch: 1 cost time: 10.977545261383057
Epoch: 1, Steps: 208 | Train Loss: 3.763 Vali Loss: 3.694 Vali Acc: 0.047 Test Loss: 3.694 Test Acc: 0.047
Validation loss decreased (inf --> -0.047383).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4374270
	speed: 0.2524s/iter; left time: 5172.1292s
	iters: 200, epoch: 2 | loss: 3.9506078
	speed: 0.0343s/iter; left time: 699.7483s
Epoch: 2 cost time: 8.326809406280518
Epoch: 2, Steps: 208 | Train Loss: 3.601 Vali Loss: 3.723 Vali Acc: 0.057 Test Loss: 3.723 Test Acc: 0.057
Validation loss decreased (-0.047383 --> -0.057225).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5298562
	speed: 0.2583s/iter; left time: 5240.2349s
	iters: 200, epoch: 3 | loss: 3.1296501
	speed: 0.0423s/iter; left time: 854.0833s
Epoch: 3 cost time: 9.839815139770508
Epoch: 3, Steps: 208 | Train Loss: 3.482 Vali Loss: 3.733 Vali Acc: 0.066 Test Loss: 3.733 Test Acc: 0.066
Validation loss decreased (-0.057225 --> -0.065874).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2684999
	speed: 0.2682s/iter; left time: 5384.2223s
	iters: 200, epoch: 4 | loss: 3.3548594
	speed: 0.0422s/iter; left time: 842.1605s
Epoch: 4 cost time: 9.92434048652649
Epoch: 4, Steps: 208 | Train Loss: 3.324 Vali Loss: 3.666 Vali Acc: 0.074 Test Loss: 3.666 Test Acc: 0.074
Validation loss decreased (-0.065874 --> -0.073629).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6864519
	speed: 0.2826s/iter; left time: 5614.3056s
	iters: 200, epoch: 5 | loss: 3.4508469
	speed: 0.0408s/iter; left time: 806.6824s
Epoch: 5 cost time: 10.073748350143433
Epoch: 5, Steps: 208 | Train Loss: 3.191 Vali Loss: 3.661 Vali Acc: 0.082 Test Loss: 3.661 Test Acc: 0.082
Validation loss decreased (-0.073629 --> -0.081681).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3349113
	speed: 0.2869s/iter; left time: 5640.5641s
	iters: 200, epoch: 6 | loss: 3.3905432
	speed: 0.0427s/iter; left time: 835.4493s
Epoch: 6 cost time: 10.992060661315918
Epoch: 6, Steps: 208 | Train Loss: 3.073 Vali Loss: 3.703 Vali Acc: 0.079 Test Loss: 3.703 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.8464601
	speed: 0.2819s/iter; left time: 5483.7291s
	iters: 200, epoch: 7 | loss: 3.0409126
	speed: 0.0379s/iter; left time: 732.8743s
Epoch: 7 cost time: 9.220876455307007
Epoch: 7, Steps: 208 | Train Loss: 2.981 Vali Loss: 3.677 Vali Acc: 0.081 Test Loss: 3.677 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.5911043
	speed: 0.2396s/iter; left time: 4611.3416s
	iters: 200, epoch: 8 | loss: 2.4953511
	speed: 0.0313s/iter; left time: 599.7512s
Epoch: 8 cost time: 7.70478630065918
Epoch: 8, Steps: 208 | Train Loss: 2.876 Vali Loss: 3.744 Vali Acc: 0.084 Test Loss: 3.744 Test Acc: 0.084
Validation loss decreased (-0.081681 --> -0.083470).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7184446
	speed: 0.2228s/iter; left time: 4240.5092s
	iters: 200, epoch: 9 | loss: 3.0490108
	speed: 0.0375s/iter; left time: 709.2924s
Epoch: 9 cost time: 8.401320934295654
Epoch: 9, Steps: 208 | Train Loss: 2.802 Vali Loss: 3.758 Vali Acc: 0.088 Test Loss: 3.758 Test Acc: 0.088
Validation loss decreased (-0.083470 --> -0.087645).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8173807
	speed: 0.2078s/iter; left time: 3911.8194s
	iters: 200, epoch: 10 | loss: 2.9981182
	speed: 0.0374s/iter; left time: 700.4237s
Epoch: 10 cost time: 8.270347833633423
Epoch: 10, Steps: 208 | Train Loss: 2.720 Vali Loss: 3.774 Vali Acc: 0.087 Test Loss: 3.774 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.6776118
	speed: 0.2351s/iter; left time: 4377.1124s
	iters: 200, epoch: 11 | loss: 2.1822984
	speed: 0.0340s/iter; left time: 629.4442s
Epoch: 11 cost time: 8.781709432601929
Epoch: 11, Steps: 208 | Train Loss: 2.647 Vali Loss: 3.773 Vali Acc: 0.093 Test Loss: 3.773 Test Acc: 0.093
Validation loss decreased (-0.087645 --> -0.092715).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.1523523
	speed: 0.2460s/iter; left time: 4530.4577s
	iters: 200, epoch: 12 | loss: 3.2641263
	speed: 0.0367s/iter; left time: 672.7000s
Epoch: 12 cost time: 8.931002140045166
Epoch: 12, Steps: 208 | Train Loss: 2.579 Vali Loss: 3.813 Vali Acc: 0.092 Test Loss: 3.813 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.7436981
	speed: 0.2507s/iter; left time: 4563.8566s
	iters: 200, epoch: 13 | loss: 3.2798734
	speed: 0.0382s/iter; left time: 692.4974s
Epoch: 13 cost time: 9.073363304138184
Epoch: 13, Steps: 208 | Train Loss: 2.499 Vali Loss: 3.926 Vali Acc: 0.089 Test Loss: 3.926 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.7806129
	speed: 0.2514s/iter; left time: 4524.6574s
	iters: 200, epoch: 14 | loss: 2.7351792
	speed: 0.0373s/iter; left time: 668.3846s
Epoch: 14 cost time: 9.354082345962524
Epoch: 14, Steps: 208 | Train Loss: 2.451 Vali Loss: 3.971 Vali Acc: 0.092 Test Loss: 3.971 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.2537630
	speed: 0.2437s/iter; left time: 4335.7997s
	iters: 200, epoch: 15 | loss: 2.9568803
	speed: 0.0338s/iter; left time: 598.7223s
Epoch: 15 cost time: 8.671489477157593
Epoch: 15, Steps: 208 | Train Loss: 2.412 Vali Loss: 3.958 Vali Acc: 0.092 Test Loss: 3.958 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.4555206
	speed: 0.2438s/iter; left time: 4286.1235s
	iters: 200, epoch: 16 | loss: 3.2429953
	speed: 0.0409s/iter; left time: 715.2197s
Epoch: 16 cost time: 9.35372281074524
Epoch: 16, Steps: 208 | Train Loss: 2.336 Vali Loss: 4.078 Vali Acc: 0.098 Test Loss: 4.078 Test Acc: 0.098
Validation loss decreased (-0.092715 --> -0.098080).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.6765172
	speed: 0.2488s/iter; left time: 4322.4904s
	iters: 200, epoch: 17 | loss: 2.0170979
	speed: 0.0371s/iter; left time: 641.0577s
Epoch: 17 cost time: 8.874350547790527
Epoch: 17, Steps: 208 | Train Loss: 2.274 Vali Loss: 4.168 Vali Acc: 0.092 Test Loss: 4.168 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.9803410
	speed: 0.2442s/iter; left time: 4191.9493s
	iters: 200, epoch: 18 | loss: 2.1858861
	speed: 0.0381s/iter; left time: 650.5918s
Epoch: 18 cost time: 8.515066862106323
Epoch: 18, Steps: 208 | Train Loss: 2.251 Vali Loss: 4.134 Vali Acc: 0.099 Test Loss: 4.134 Test Acc: 0.099
Validation loss decreased (-0.098080 --> -0.098974).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6971781
	speed: 0.2335s/iter; left time: 3959.7282s
	iters: 200, epoch: 19 | loss: 2.2064443
	speed: 0.0345s/iter; left time: 582.3524s
Epoch: 19 cost time: 8.118027210235596
Epoch: 19, Steps: 208 | Train Loss: 2.218 Vali Loss: 4.195 Vali Acc: 0.097 Test Loss: 4.195 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.7506272
	speed: 0.2290s/iter; left time: 3835.0754s
	iters: 200, epoch: 20 | loss: 1.4617302
	speed: 0.0330s/iter; left time: 549.5208s
Epoch: 20 cost time: 7.418398380279541
Epoch: 20, Steps: 208 | Train Loss: 2.158 Vali Loss: 4.293 Vali Acc: 0.097 Test Loss: 4.293 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.0632493
	speed: 0.2294s/iter; left time: 3794.5069s
	iters: 200, epoch: 21 | loss: 3.1443448
	speed: 0.0319s/iter; left time: 524.0161s
Epoch: 21 cost time: 7.665205001831055
Epoch: 21, Steps: 208 | Train Loss: 2.118 Vali Loss: 4.351 Vali Acc: 0.095 Test Loss: 4.351 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.4724612
	speed: 0.2282s/iter; left time: 3727.1092s
	iters: 200, epoch: 22 | loss: 2.8138809
	speed: 0.0326s/iter; left time: 529.5879s
Epoch: 22 cost time: 7.138829708099365
Epoch: 22, Steps: 208 | Train Loss: 2.061 Vali Loss: 4.408 Vali Acc: 0.098 Test Loss: 4.408 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.6865470
	speed: 0.2244s/iter; left time: 3617.7795s
	iters: 200, epoch: 23 | loss: 2.5220051
	speed: 0.0285s/iter; left time: 457.1595s
Epoch: 23 cost time: 7.148662328720093
Epoch: 23, Steps: 208 | Train Loss: 2.037 Vali Loss: 4.481 Vali Acc: 0.101 Test Loss: 4.481 Test Acc: 0.101
Validation loss decreased (-0.098974 --> -0.101059).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.8200020
	speed: 0.2053s/iter; left time: 3267.3194s
	iters: 200, epoch: 24 | loss: 2.2574618
	speed: 0.0293s/iter; left time: 463.8917s
Epoch: 24 cost time: 6.854968547821045
Epoch: 24, Steps: 208 | Train Loss: 1.986 Vali Loss: 4.520 Vali Acc: 0.095 Test Loss: 4.520 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.8862901
	speed: 0.2151s/iter; left time: 3379.4293s
	iters: 200, epoch: 25 | loss: 2.8727875
	speed: 0.0289s/iter; left time: 450.6871s
Epoch: 25 cost time: 7.2636048793792725
Epoch: 25, Steps: 208 | Train Loss: 1.949 Vali Loss: 4.615 Vali Acc: 0.103 Test Loss: 4.615 Test Acc: 0.103
Validation loss decreased (-0.101059 --> -0.103145).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.7201695
	speed: 0.2054s/iter; left time: 3184.1089s
	iters: 200, epoch: 26 | loss: 1.8445210
	speed: 0.0298s/iter; left time: 458.2951s
Epoch: 26 cost time: 7.00995135307312
Epoch: 26, Steps: 208 | Train Loss: 1.908 Vali Loss: 4.665 Vali Acc: 0.103 Test Loss: 4.665 Test Acc: 0.103
Validation loss decreased (-0.103145 --> -0.103443).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.4409342
	speed: 0.1972s/iter; left time: 3015.5102s
	iters: 200, epoch: 27 | loss: 2.2722421
	speed: 0.0290s/iter; left time: 441.3076s
Epoch: 27 cost time: 7.288126707077026
Epoch: 27, Steps: 208 | Train Loss: 1.877 Vali Loss: 4.714 Vali Acc: 0.101 Test Loss: 4.714 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.0372936
	speed: 0.2180s/iter; left time: 3287.9019s
	iters: 200, epoch: 28 | loss: 2.2469034
	speed: 0.0336s/iter; left time: 503.2799s
Epoch: 28 cost time: 8.078020334243774
Epoch: 28, Steps: 208 | Train Loss: 1.837 Vali Loss: 4.854 Vali Acc: 0.098 Test Loss: 4.854 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.6825830
	speed: 0.2335s/iter; left time: 3474.2566s
	iters: 200, epoch: 29 | loss: 1.2961659
	speed: 0.0360s/iter; left time: 531.9876s
Epoch: 29 cost time: 8.29911208152771
Epoch: 29, Steps: 208 | Train Loss: 1.827 Vali Loss: 4.905 Vali Acc: 0.098 Test Loss: 4.905 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.2143364
	speed: 0.2177s/iter; left time: 3194.1702s
	iters: 200, epoch: 30 | loss: 1.3044686
	speed: 0.0309s/iter; left time: 450.0777s
Epoch: 30 cost time: 7.426312446594238
Epoch: 30, Steps: 208 | Train Loss: 1.781 Vali Loss: 4.921 Vali Acc: 0.098 Test Loss: 4.921 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.7988685
	speed: 0.2151s/iter; left time: 3110.6655s
	iters: 200, epoch: 31 | loss: 1.8217443
	speed: 0.0351s/iter; left time: 503.3741s
Epoch: 31 cost time: 8.316377401351929
Epoch: 31, Steps: 208 | Train Loss: 1.738 Vali Loss: 5.079 Vali Acc: 0.102 Test Loss: 5.079 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 1.3303288
	speed: 0.2405s/iter; left time: 3427.9505s
	iters: 200, epoch: 32 | loss: 1.5327010
	speed: 0.0390s/iter; left time: 551.9489s
Epoch: 32 cost time: 8.3788161277771
Epoch: 32, Steps: 208 | Train Loss: 1.728 Vali Loss: 5.058 Vali Acc: 0.108 Test Loss: 5.058 Test Acc: 0.108
Validation loss decreased (-0.103443 --> -0.107912).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.8303280
	speed: 0.2536s/iter; left time: 3561.8152s
	iters: 200, epoch: 33 | loss: 2.1147079
	speed: 0.0365s/iter; left time: 508.8963s
Epoch: 33 cost time: 8.988642454147339
Epoch: 33, Steps: 208 | Train Loss: 1.652 Vali Loss: 5.181 Vali Acc: 0.107 Test Loss: 5.181 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.7296021
	speed: 0.2471s/iter; left time: 3418.8352s
	iters: 200, epoch: 34 | loss: 1.9652873
	speed: 0.0361s/iter; left time: 495.9236s
Epoch: 34 cost time: 8.854932069778442
Epoch: 34, Steps: 208 | Train Loss: 1.644 Vali Loss: 5.278 Vali Acc: 0.098 Test Loss: 5.278 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 1.6690884
	speed: 0.2471s/iter; left time: 3368.0729s
	iters: 200, epoch: 35 | loss: 1.2580106
	speed: 0.0369s/iter; left time: 499.3266s
Epoch: 35 cost time: 8.573002576828003
Epoch: 35, Steps: 208 | Train Loss: 1.638 Vali Loss: 5.341 Vali Acc: 0.103 Test Loss: 5.341 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 1.6097919
	speed: 0.2397s/iter; left time: 3216.4045s
	iters: 200, epoch: 36 | loss: 2.6167870
	speed: 0.0383s/iter; left time: 510.1922s
Epoch: 36 cost time: 9.11257815361023
Epoch: 36, Steps: 208 | Train Loss: 1.591 Vali Loss: 5.417 Vali Acc: 0.100 Test Loss: 5.417 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 1.9364278
	speed: 0.2390s/iter; left time: 3157.8534s
	iters: 200, epoch: 37 | loss: 1.7328222
	speed: 0.0342s/iter; left time: 448.5414s
Epoch: 37 cost time: 8.495193481445312
Epoch: 37, Steps: 208 | Train Loss: 1.564 Vali Loss: 5.479 Vali Acc: 0.105 Test Loss: 5.479 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 2.1971877
	speed: 0.2455s/iter; left time: 3192.8393s
	iters: 200, epoch: 38 | loss: 1.9007196
	speed: 0.0330s/iter; left time: 425.3771s
Epoch: 38 cost time: 7.6337549686431885
Epoch: 38, Steps: 208 | Train Loss: 1.566 Vali Loss: 5.567 Vali Acc: 0.106 Test Loss: 5.567 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 1.5071645
	speed: 0.2332s/iter; left time: 2983.8425s
	iters: 200, epoch: 39 | loss: 1.7581393
	speed: 0.0341s/iter; left time: 432.8832s
Epoch: 39 cost time: 7.610646963119507
Epoch: 39, Steps: 208 | Train Loss: 1.538 Vali Loss: 5.606 Vali Acc: 0.102 Test Loss: 5.606 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 1.7919698
	speed: 0.2457s/iter; left time: 3092.7553s
	iters: 200, epoch: 40 | loss: 1.0962000
	speed: 0.0340s/iter; left time: 424.7038s
Epoch: 40 cost time: 8.421254873275757
Epoch: 40, Steps: 208 | Train Loss: 1.487 Vali Loss: 5.702 Vali Acc: 0.100 Test Loss: 5.702 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 1.5763326
	speed: 0.2452s/iter; left time: 3036.1932s
	iters: 200, epoch: 41 | loss: 2.0429657
	speed: 0.0365s/iter; left time: 447.7092s
Epoch: 41 cost time: 8.798793077468872
Epoch: 41, Steps: 208 | Train Loss: 1.473 Vali Loss: 5.757 Vali Acc: 0.102 Test Loss: 5.757 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 1.5481253
	speed: 0.2334s/iter; left time: 2841.6958s
	iters: 200, epoch: 42 | loss: 1.8833650
	speed: 0.0340s/iter; left time: 410.4023s
Epoch: 42 cost time: 7.754079103469849
Epoch: 42, Steps: 208 | Train Loss: 1.433 Vali Loss: 5.924 Vali Acc: 0.102 Test Loss: 5.924 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10796301819266328
model parameter : 72167
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7792237
	speed: 0.0754s/iter; left time: 1561.1556s
	iters: 200, epoch: 1 | loss: 4.0551963
	speed: 0.0467s/iter; left time: 962.7065s
Epoch: 1 cost time: 12.628077983856201
Epoch: 1, Steps: 208 | Train Loss: 3.786 Vali Loss: 3.667 Vali Acc: 0.052 Test Loss: 3.667 Test Acc: 0.052
Validation loss decreased (inf --> -0.052454).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6845534
	speed: 0.2821s/iter; left time: 5782.0054s
	iters: 200, epoch: 2 | loss: 3.4950218
	speed: 0.0432s/iter; left time: 881.6574s
Epoch: 2 cost time: 9.46899962425232
Epoch: 2, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.697 Vali Acc: 0.052 Test Loss: 3.697 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5439615
	speed: 0.2847s/iter; left time: 5776.0800s
	iters: 200, epoch: 3 | loss: 3.2395966
	speed: 0.0405s/iter; left time: 817.2021s
Epoch: 3 cost time: 9.355562686920166
Epoch: 3, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.650 Vali Acc: 0.064 Test Loss: 3.650 Test Acc: 0.064
Validation loss decreased (-0.052454 --> -0.063787).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3288412
	speed: 0.2632s/iter; left time: 5284.9839s
	iters: 200, epoch: 4 | loss: 3.5350127
	speed: 0.0395s/iter; left time: 788.8629s
Epoch: 4 cost time: 8.494551181793213
Epoch: 4, Steps: 208 | Train Loss: 3.311 Vali Loss: 3.594 Vali Acc: 0.073 Test Loss: 3.594 Test Acc: 0.073
Validation loss decreased (-0.063787 --> -0.073331).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4411678
	speed: 0.2503s/iter; left time: 4973.5971s
	iters: 200, epoch: 5 | loss: 3.3359361
	speed: 0.0401s/iter; left time: 792.2461s
Epoch: 5 cost time: 9.175387620925903
Epoch: 5, Steps: 208 | Train Loss: 3.189 Vali Loss: 3.666 Vali Acc: 0.074 Test Loss: 3.666 Test Acc: 0.074
Validation loss decreased (-0.073331 --> -0.074225).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0806713
	speed: 0.2767s/iter; left time: 5439.5852s
	iters: 200, epoch: 6 | loss: 3.4092760
	speed: 0.0387s/iter; left time: 756.3179s
Epoch: 6 cost time: 9.018859624862671
Epoch: 6, Steps: 208 | Train Loss: 3.105 Vali Loss: 3.703 Vali Acc: 0.076 Test Loss: 3.703 Test Acc: 0.076
Validation loss decreased (-0.074225 --> -0.076014).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9693501
	speed: 0.2513s/iter; left time: 4889.0691s
	iters: 200, epoch: 7 | loss: 2.9976289
	speed: 0.0352s/iter; left time: 681.9980s
Epoch: 7 cost time: 8.399203538894653
Epoch: 7, Steps: 208 | Train Loss: 3.021 Vali Loss: 3.666 Vali Acc: 0.085 Test Loss: 3.666 Test Acc: 0.085
Validation loss decreased (-0.076014 --> -0.084664).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9671860
	speed: 0.2762s/iter; left time: 5315.8289s
	iters: 200, epoch: 8 | loss: 2.8134506
	speed: 0.0385s/iter; left time: 737.2746s
Epoch: 8 cost time: 9.725800275802612
Epoch: 8, Steps: 208 | Train Loss: 2.943 Vali Loss: 3.709 Vali Acc: 0.085 Test Loss: 3.709 Test Acc: 0.085
Validation loss decreased (-0.084664 --> -0.085260).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0753253
	speed: 0.2813s/iter; left time: 5355.9713s
	iters: 200, epoch: 9 | loss: 2.8423228
	speed: 0.0365s/iter; left time: 691.5215s
Epoch: 9 cost time: 8.833430051803589
Epoch: 9, Steps: 208 | Train Loss: 2.884 Vali Loss: 3.684 Vali Acc: 0.086 Test Loss: 3.684 Test Acc: 0.086
Validation loss decreased (-0.085260 --> -0.085856).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6809919
	speed: 0.2803s/iter; left time: 5276.9328s
	iters: 200, epoch: 10 | loss: 3.3224061
	speed: 0.0360s/iter; left time: 674.3606s
Epoch: 10 cost time: 9.305094957351685
Epoch: 10, Steps: 208 | Train Loss: 2.802 Vali Loss: 3.736 Vali Acc: 0.090 Test Loss: 3.736 Test Acc: 0.090
Validation loss decreased (-0.085856 --> -0.090031).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.7146344
	speed: 0.2805s/iter; left time: 5223.4750s
	iters: 200, epoch: 11 | loss: 3.6267920
	speed: 0.0344s/iter; left time: 636.2455s
Epoch: 11 cost time: 8.399807214736938
Epoch: 11, Steps: 208 | Train Loss: 2.742 Vali Loss: 3.818 Vali Acc: 0.088 Test Loss: 3.818 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.6605232
	speed: 0.2475s/iter; left time: 4556.7465s
	iters: 200, epoch: 12 | loss: 3.2110589
	speed: 0.0323s/iter; left time: 591.7522s
Epoch: 12 cost time: 8.341933727264404
Epoch: 12, Steps: 208 | Train Loss: 2.688 Vali Loss: 3.784 Vali Acc: 0.095 Test Loss: 3.784 Test Acc: 0.095
Validation loss decreased (-0.090031 --> -0.095101).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3230426
	speed: 0.2594s/iter; left time: 4722.2178s
	iters: 200, epoch: 13 | loss: 2.6933990
	speed: 0.0314s/iter; left time: 568.2070s
Epoch: 13 cost time: 8.232881784439087
Epoch: 13, Steps: 208 | Train Loss: 2.628 Vali Loss: 3.792 Vali Acc: 0.099 Test Loss: 3.792 Test Acc: 0.099
Validation loss decreased (-0.095101 --> -0.098680).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.3855896
	speed: 0.2409s/iter; left time: 4334.7784s
	iters: 200, epoch: 14 | loss: 2.8790965
	speed: 0.0356s/iter; left time: 637.3442s
Epoch: 14 cost time: 8.302798509597778
Epoch: 14, Steps: 208 | Train Loss: 2.559 Vali Loss: 3.900 Vali Acc: 0.093 Test Loss: 3.900 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.5352049
	speed: 0.2411s/iter; left time: 4289.4039s
	iters: 200, epoch: 15 | loss: 2.7625883
	speed: 0.0377s/iter; left time: 666.1251s
Epoch: 15 cost time: 9.454840183258057
Epoch: 15, Steps: 208 | Train Loss: 2.538 Vali Loss: 3.905 Vali Acc: 0.089 Test Loss: 3.905 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.1754353
	speed: 0.2401s/iter; left time: 4220.8583s
	iters: 200, epoch: 16 | loss: 2.3786530
	speed: 0.0411s/iter; left time: 717.9107s
Epoch: 16 cost time: 8.99866509437561
Epoch: 16, Steps: 208 | Train Loss: 2.466 Vali Loss: 3.962 Vali Acc: 0.100 Test Loss: 3.962 Test Acc: 0.100
Validation loss decreased (-0.098680 --> -0.100169).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.7768648
	speed: 0.2452s/iter; left time: 4260.2588s
	iters: 200, epoch: 17 | loss: 2.6668227
	speed: 0.0371s/iter; left time: 641.3945s
Epoch: 17 cost time: 8.75322437286377
Epoch: 17, Steps: 208 | Train Loss: 2.430 Vali Loss: 4.010 Vali Acc: 0.097 Test Loss: 4.010 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.0729156
	speed: 0.2388s/iter; left time: 4099.5647s
	iters: 200, epoch: 18 | loss: 2.2082622
	speed: 0.0367s/iter; left time: 626.0285s
Epoch: 18 cost time: 8.904974460601807
Epoch: 18, Steps: 208 | Train Loss: 2.368 Vali Loss: 4.062 Vali Acc: 0.095 Test Loss: 4.062 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.9959463
	speed: 0.2511s/iter; left time: 4258.2039s
	iters: 200, epoch: 19 | loss: 2.3273494
	speed: 0.0351s/iter; left time: 591.7988s
Epoch: 19 cost time: 8.669695615768433
Epoch: 19, Steps: 208 | Train Loss: 2.344 Vali Loss: 4.053 Vali Acc: 0.102 Test Loss: 4.053 Test Acc: 0.102
Validation loss decreased (-0.100169 --> -0.101958).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.9228022
	speed: 0.2285s/iter; left time: 3827.4793s
	iters: 200, epoch: 20 | loss: 2.1514802
	speed: 0.0353s/iter; left time: 588.3049s
Epoch: 20 cost time: 7.7619242668151855
Epoch: 20, Steps: 208 | Train Loss: 2.289 Vali Loss: 4.125 Vali Acc: 0.101 Test Loss: 4.125 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.8204811
	speed: 0.2464s/iter; left time: 4075.3340s
	iters: 200, epoch: 21 | loss: 2.4027739
	speed: 0.0328s/iter; left time: 539.5166s
Epoch: 21 cost time: 7.906931400299072
Epoch: 21, Steps: 208 | Train Loss: 2.258 Vali Loss: 4.189 Vali Acc: 0.097 Test Loss: 4.189 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 2.5127285
	speed: 0.2517s/iter; left time: 4111.7044s
	iters: 200, epoch: 22 | loss: 2.8074343
	speed: 0.0389s/iter; left time: 631.6152s
Epoch: 22 cost time: 8.716604232788086
Epoch: 22, Steps: 208 | Train Loss: 2.219 Vali Loss: 4.263 Vali Acc: 0.102 Test Loss: 4.263 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.7918254
	speed: 0.2594s/iter; left time: 4182.0329s
	iters: 200, epoch: 23 | loss: 2.8206036
	speed: 0.0342s/iter; left time: 548.1951s
Epoch: 23 cost time: 8.283671379089355
Epoch: 23, Steps: 208 | Train Loss: 2.167 Vali Loss: 4.267 Vali Acc: 0.103 Test Loss: 4.267 Test Acc: 0.103
Validation loss decreased (-0.101958 --> -0.102850).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.1706462
	speed: 0.2625s/iter; left time: 4178.4668s
	iters: 200, epoch: 24 | loss: 1.7898042
	speed: 0.0358s/iter; left time: 566.7513s
Epoch: 24 cost time: 8.497998476028442
Epoch: 24, Steps: 208 | Train Loss: 2.121 Vali Loss: 4.397 Vali Acc: 0.097 Test Loss: 4.397 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 2.1738129
	speed: 0.2642s/iter; left time: 4149.6014s
	iters: 200, epoch: 25 | loss: 2.8091431
	speed: 0.0389s/iter; left time: 606.8364s
Epoch: 25 cost time: 9.141170501708984
Epoch: 25, Steps: 208 | Train Loss: 2.101 Vali Loss: 4.445 Vali Acc: 0.101 Test Loss: 4.445 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.9744984
	speed: 0.2770s/iter; left time: 4293.6702s
	iters: 200, epoch: 26 | loss: 1.6448193
	speed: 0.0345s/iter; left time: 530.8557s
Epoch: 26 cost time: 8.539252281188965
Epoch: 26, Steps: 208 | Train Loss: 2.043 Vali Loss: 4.492 Vali Acc: 0.100 Test Loss: 4.492 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 2.5674481
	speed: 0.2736s/iter; left time: 4184.1226s
	iters: 200, epoch: 27 | loss: 2.3807442
	speed: 0.0371s/iter; left time: 564.1892s
Epoch: 27 cost time: 9.086334943771362
Epoch: 27, Steps: 208 | Train Loss: 2.012 Vali Loss: 4.575 Vali Acc: 0.103 Test Loss: 4.575 Test Acc: 0.103
Validation loss decreased (-0.102850 --> -0.103444).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.2505746
	speed: 0.2641s/iter; left time: 3984.6279s
	iters: 200, epoch: 28 | loss: 1.9457593
	speed: 0.0367s/iter; left time: 550.1475s
Epoch: 28 cost time: 8.496443033218384
Epoch: 28, Steps: 208 | Train Loss: 1.973 Vali Loss: 4.687 Vali Acc: 0.098 Test Loss: 4.687 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.6663820
	speed: 0.2646s/iter; left time: 3936.8531s
	iters: 200, epoch: 29 | loss: 1.9509391
	speed: 0.0352s/iter; left time: 519.8363s
Epoch: 29 cost time: 8.94849944114685
Epoch: 29, Steps: 208 | Train Loss: 1.961 Vali Loss: 4.745 Vali Acc: 0.102 Test Loss: 4.745 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 2.1216264
	speed: 0.2555s/iter; left time: 3747.6144s
	iters: 200, epoch: 30 | loss: 1.8134761
	speed: 0.0328s/iter; left time: 478.3103s
Epoch: 30 cost time: 8.234067678451538
Epoch: 30, Steps: 208 | Train Loss: 1.916 Vali Loss: 4.785 Vali Acc: 0.102 Test Loss: 4.785 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 2.3635359
	speed: 0.2506s/iter; left time: 3624.2119s
	iters: 200, epoch: 31 | loss: 2.2677028
	speed: 0.0360s/iter; left time: 516.5439s
Epoch: 31 cost time: 8.30317759513855
Epoch: 31, Steps: 208 | Train Loss: 1.902 Vali Loss: 4.865 Vali Acc: 0.101 Test Loss: 4.865 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 2.0568480
	speed: 0.2442s/iter; left time: 3480.0797s
	iters: 200, epoch: 32 | loss: 2.2966225
	speed: 0.0337s/iter; left time: 476.8678s
Epoch: 32 cost time: 8.157997369766235
Epoch: 32, Steps: 208 | Train Loss: 1.867 Vali Loss: 4.948 Vali Acc: 0.099 Test Loss: 4.948 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 1.5925674
	speed: 0.2592s/iter; left time: 3640.1301s
	iters: 200, epoch: 33 | loss: 1.3605468
	speed: 0.0321s/iter; left time: 448.0465s
Epoch: 33 cost time: 8.193178415298462
Epoch: 33, Steps: 208 | Train Loss: 1.857 Vali Loss: 4.994 Vali Acc: 0.098 Test Loss: 4.994 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 2.5492640
	speed: 0.2437s/iter; left time: 3372.4542s
	iters: 200, epoch: 34 | loss: 1.4601643
	speed: 0.0335s/iter; left time: 460.1705s
Epoch: 34 cost time: 8.275885581970215
Epoch: 34, Steps: 208 | Train Loss: 1.826 Vali Loss: 5.013 Vali Acc: 0.105 Test Loss: 5.013 Test Acc: 0.105
Validation loss decreased (-0.103444 --> -0.104930).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.6818913
	speed: 0.2498s/iter; left time: 3404.0460s
	iters: 200, epoch: 35 | loss: 2.0800450
	speed: 0.0348s/iter; left time: 470.3520s
Epoch: 35 cost time: 8.195769548416138
Epoch: 35, Steps: 208 | Train Loss: 1.796 Vali Loss: 5.092 Vali Acc: 0.097 Test Loss: 5.092 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 2.4510512
	speed: 0.2637s/iter; left time: 3538.9108s
	iters: 200, epoch: 36 | loss: 2.1303272
	speed: 0.0314s/iter; left time: 417.6545s
Epoch: 36 cost time: 7.731527805328369
Epoch: 36, Steps: 208 | Train Loss: 1.753 Vali Loss: 5.161 Vali Acc: 0.100 Test Loss: 5.161 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 2.4848964
	speed: 0.2483s/iter; left time: 3280.3349s
	iters: 200, epoch: 37 | loss: 1.9498101
	speed: 0.0401s/iter; left time: 525.9699s
Epoch: 37 cost time: 9.480565309524536
Epoch: 37, Steps: 208 | Train Loss: 1.739 Vali Loss: 5.209 Vali Acc: 0.104 Test Loss: 5.209 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 2.0495296
	speed: 0.2553s/iter; left time: 3319.8613s
	iters: 200, epoch: 38 | loss: 1.9729235
	speed: 0.0387s/iter; left time: 498.7967s
Epoch: 38 cost time: 8.848610877990723
Epoch: 38, Steps: 208 | Train Loss: 1.707 Vali Loss: 5.326 Vali Acc: 0.106 Test Loss: 5.326 Test Acc: 0.106
Validation loss decreased (-0.104930 --> -0.106120).  Saving model ...
	iters: 100, epoch: 39 | loss: 1.3461803
	speed: 0.2558s/iter; left time: 3273.4192s
	iters: 200, epoch: 39 | loss: 2.4008822
	speed: 0.0346s/iter; left time: 439.1031s
Epoch: 39 cost time: 8.519057273864746
Epoch: 39, Steps: 208 | Train Loss: 1.675 Vali Loss: 5.421 Vali Acc: 0.102 Test Loss: 5.421 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.5488191
	speed: 0.2572s/iter; left time: 3237.7898s
	iters: 200, epoch: 40 | loss: 0.8230412
	speed: 0.0388s/iter; left time: 484.5342s
Epoch: 40 cost time: 8.57077956199646
Epoch: 40, Steps: 208 | Train Loss: 1.667 Vali Loss: 5.483 Vali Acc: 0.103 Test Loss: 5.483 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 1.8870801
	speed: 0.2666s/iter; left time: 3300.8905s
	iters: 200, epoch: 41 | loss: 1.0277863
	speed: 0.0344s/iter; left time: 422.2156s
Epoch: 41 cost time: 8.763919591903687
Epoch: 41, Steps: 208 | Train Loss: 1.639 Vali Loss: 5.541 Vali Acc: 0.102 Test Loss: 5.541 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 1.0504260
	speed: 0.2412s/iter; left time: 2936.2484s
	iters: 200, epoch: 42 | loss: 1.9379534
	speed: 0.0328s/iter; left time: 396.2410s
Epoch: 42 cost time: 8.004201412200928
Epoch: 42, Steps: 208 | Train Loss: 1.645 Vali Loss: 5.561 Vali Acc: 0.108 Test Loss: 5.561 Test Acc: 0.108
Validation loss decreased (-0.106120 --> -0.107907).  Saving model ...
	iters: 100, epoch: 43 | loss: 1.0119891
	speed: 0.2446s/iter; left time: 2926.0846s
	iters: 200, epoch: 43 | loss: 2.5100989
	speed: 0.0318s/iter; left time: 377.8502s
Epoch: 43 cost time: 8.179328680038452
Epoch: 43, Steps: 208 | Train Loss: 1.577 Vali Loss: 5.642 Vali Acc: 0.102 Test Loss: 5.642 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 1.6277561
	speed: 0.2372s/iter; left time: 2788.2240s
	iters: 200, epoch: 44 | loss: 1.4385471
	speed: 0.0398s/iter; left time: 464.3174s
Epoch: 44 cost time: 9.397021770477295
Epoch: 44, Steps: 208 | Train Loss: 1.549 Vali Loss: 5.792 Vali Acc: 0.106 Test Loss: 5.792 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 1.8152834
	speed: 0.2387s/iter; left time: 2756.4951s
	iters: 200, epoch: 45 | loss: 1.8795801
	speed: 0.0336s/iter; left time: 384.2268s
Epoch: 45 cost time: 8.02799391746521
Epoch: 45, Steps: 208 | Train Loss: 1.565 Vali Loss: 5.774 Vali Acc: 0.104 Test Loss: 5.774 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 1.3128192
	speed: 0.2572s/iter; left time: 2916.8690s
	iters: 200, epoch: 46 | loss: 2.0354142
	speed: 0.0333s/iter; left time: 374.2259s
Epoch: 46 cost time: 8.287768363952637
Epoch: 46, Steps: 208 | Train Loss: 1.523 Vali Loss: 5.849 Vali Acc: 0.101 Test Loss: 5.849 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 1.3767891
	speed: 0.2516s/iter; left time: 2800.9244s
	iters: 200, epoch: 47 | loss: 2.0359807
	speed: 0.0329s/iter; left time: 363.4793s
Epoch: 47 cost time: 7.961269855499268
Epoch: 47, Steps: 208 | Train Loss: 1.523 Vali Loss: 5.946 Vali Acc: 0.107 Test Loss: 5.946 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 1.2971615
	speed: 0.2522s/iter; left time: 2754.9433s
	iters: 200, epoch: 48 | loss: 2.0151625
	speed: 0.0370s/iter; left time: 400.6920s
Epoch: 48 cost time: 8.473099708557129
Epoch: 48, Steps: 208 | Train Loss: 1.480 Vali Loss: 6.027 Vali Acc: 0.103 Test Loss: 6.027 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 1.6348913
	speed: 0.2596s/iter; left time: 2782.1615s
	iters: 200, epoch: 49 | loss: 1.5404030
	speed: 0.0345s/iter; left time: 366.2958s
Epoch: 49 cost time: 8.188162326812744
Epoch: 49, Steps: 208 | Train Loss: 1.482 Vali Loss: 6.023 Vali Acc: 0.102 Test Loss: 6.023 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 1.8935678
	speed: 0.2444s/iter; left time: 2568.7943s
	iters: 200, epoch: 50 | loss: 1.2148588
	speed: 0.0334s/iter; left time: 347.2525s
Epoch: 50 cost time: 8.214178562164307
Epoch: 50, Steps: 208 | Train Loss: 1.433 Vali Loss: 6.234 Vali Acc: 0.099 Test Loss: 6.234 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 2.2357504
	speed: 0.2462s/iter; left time: 2536.3589s
	iters: 200, epoch: 51 | loss: 2.1205342
	speed: 0.0342s/iter; left time: 348.9804s
Epoch: 51 cost time: 8.05937147140503
Epoch: 51, Steps: 208 | Train Loss: 1.446 Vali Loss: 6.188 Vali Acc: 0.102 Test Loss: 6.188 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 1.3737769
	speed: 0.2492s/iter; left time: 2515.5144s
	iters: 200, epoch: 52 | loss: 1.2697241
	speed: 0.0397s/iter; left time: 397.2130s
Epoch: 52 cost time: 9.164611577987671
Epoch: 52, Steps: 208 | Train Loss: 1.414 Vali Loss: 6.303 Vali Acc: 0.101 Test Loss: 6.303 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df256_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10796301819266328
model parameter : 58615
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5179303
	speed: 0.0635s/iter; left time: 1314.1828s
	iters: 200, epoch: 1 | loss: 3.5402858
	speed: 0.0322s/iter; left time: 662.4904s
Epoch: 1 cost time: 9.887038230895996
Epoch: 1, Steps: 208 | Train Loss: 4.074 Vali Loss: 4.301 Vali Acc: 0.056 Test Loss: 4.301 Test Acc: 0.056
Validation loss decreased (inf --> -0.056026).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7550483
	speed: 0.2169s/iter; left time: 4445.2264s
	iters: 200, epoch: 2 | loss: 4.4606104
	speed: 0.0258s/iter; left time: 525.9282s
Epoch: 2 cost time: 6.905440330505371
Epoch: 2, Steps: 208 | Train Loss: 3.924 Vali Loss: 4.678 Vali Acc: 0.070 Test Loss: 4.678 Test Acc: 0.070
Validation loss decreased (-0.056026 --> -0.070040).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3256085
	speed: 0.2093s/iter; left time: 4245.3304s
	iters: 200, epoch: 3 | loss: 5.2022791
	speed: 0.0301s/iter; left time: 608.5336s
Epoch: 3 cost time: 7.2789130210876465
Epoch: 3, Steps: 208 | Train Loss: 3.520 Vali Loss: 4.556 Vali Acc: 0.080 Test Loss: 4.556 Test Acc: 0.080
Validation loss decreased (-0.070040 --> -0.080181).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6493857
	speed: 0.2085s/iter; left time: 4186.0439s
	iters: 200, epoch: 4 | loss: 3.9685314
	speed: 0.0310s/iter; left time: 619.5728s
Epoch: 4 cost time: 7.556416034698486
Epoch: 4, Steps: 208 | Train Loss: 3.107 Vali Loss: 4.614 Vali Acc: 0.086 Test Loss: 4.614 Test Acc: 0.086
Validation loss decreased (-0.080181 --> -0.086145).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4030807
	speed: 0.2063s/iter; left time: 4099.0345s
	iters: 200, epoch: 5 | loss: 2.7777369
	speed: 0.0319s/iter; left time: 631.0746s
Epoch: 5 cost time: 7.99184775352478
Epoch: 5, Steps: 208 | Train Loss: 2.754 Vali Loss: 4.827 Vali Acc: 0.085 Test Loss: 4.827 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3939433
	speed: 0.1895s/iter; left time: 3724.8323s
	iters: 200, epoch: 6 | loss: 3.6285143
	speed: 0.0247s/iter; left time: 483.0475s
Epoch: 6 cost time: 7.233309507369995
Epoch: 6, Steps: 208 | Train Loss: 2.435 Vali Loss: 4.553 Vali Acc: 0.100 Test Loss: 4.553 Test Acc: 0.100
Validation loss decreased (-0.086145 --> -0.099567).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0760264
	speed: 0.2049s/iter; left time: 3986.6633s
	iters: 200, epoch: 7 | loss: 2.6793308
	speed: 0.0281s/iter; left time: 544.4518s
Epoch: 7 cost time: 7.134309530258179
Epoch: 7, Steps: 208 | Train Loss: 2.123 Vali Loss: 5.439 Vali Acc: 0.079 Test Loss: 5.439 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7026709
	speed: 0.2007s/iter; left time: 3863.1674s
	iters: 200, epoch: 8 | loss: 2.1616378
	speed: 0.0296s/iter; left time: 565.7493s
Epoch: 8 cost time: 7.659934043884277
Epoch: 8, Steps: 208 | Train Loss: 1.864 Vali Loss: 5.240 Vali Acc: 0.094 Test Loss: 5.240 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7648062
	speed: 0.1897s/iter; left time: 3610.6208s
	iters: 200, epoch: 9 | loss: 2.5477445
	speed: 0.0304s/iter; left time: 574.8327s
Epoch: 9 cost time: 6.722222328186035
Epoch: 9, Steps: 208 | Train Loss: 1.653 Vali Loss: 5.431 Vali Acc: 0.102 Test Loss: 5.431 Test Acc: 0.102
Validation loss decreased (-0.099567 --> -0.101646).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5147678
	speed: 0.1978s/iter; left time: 3724.5945s
	iters: 200, epoch: 10 | loss: 1.6625277
	speed: 0.0360s/iter; left time: 674.8564s
Epoch: 10 cost time: 8.06883978843689
Epoch: 10, Steps: 208 | Train Loss: 1.449 Vali Loss: 5.694 Vali Acc: 0.104 Test Loss: 5.694 Test Acc: 0.104
Validation loss decreased (-0.101646 --> -0.104327).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0653439
	speed: 0.2351s/iter; left time: 4378.2786s
	iters: 200, epoch: 11 | loss: 2.2631071
	speed: 0.0418s/iter; left time: 774.5875s
Epoch: 11 cost time: 9.32176160812378
Epoch: 11, Steps: 208 | Train Loss: 1.305 Vali Loss: 6.036 Vali Acc: 0.100 Test Loss: 6.036 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2498993
	speed: 0.2319s/iter; left time: 4269.9994s
	iters: 200, epoch: 12 | loss: 1.0902443
	speed: 0.0361s/iter; left time: 660.9557s
Epoch: 12 cost time: 8.858469486236572
Epoch: 12, Steps: 208 | Train Loss: 1.112 Vali Loss: 6.494 Vali Acc: 0.104 Test Loss: 6.494 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5437191
	speed: 0.2442s/iter; left time: 4445.9993s
	iters: 200, epoch: 13 | loss: 1.0944473
	speed: 0.0363s/iter; left time: 658.0241s
Epoch: 13 cost time: 8.816851139068604
Epoch: 13, Steps: 208 | Train Loss: 1.006 Vali Loss: 7.068 Vali Acc: 0.096 Test Loss: 7.068 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4768184
	speed: 0.2548s/iter; left time: 4585.0136s
	iters: 200, epoch: 14 | loss: 1.5516880
	speed: 0.0385s/iter; left time: 688.5847s
Epoch: 14 cost time: 9.390825033187866
Epoch: 14, Steps: 208 | Train Loss: 0.876 Vali Loss: 7.342 Vali Acc: 0.102 Test Loss: 7.342 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.5099522
	speed: 0.2463s/iter; left time: 4381.9379s
	iters: 200, epoch: 15 | loss: 0.8133813
	speed: 0.0389s/iter; left time: 688.8055s
Epoch: 15 cost time: 9.215388298034668
Epoch: 15, Steps: 208 | Train Loss: 0.759 Vali Loss: 7.838 Vali Acc: 0.106 Test Loss: 7.838 Test Acc: 0.106
Validation loss decreased (-0.104327 --> -0.105499).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2477038
	speed: 0.2459s/iter; left time: 4322.8091s
	iters: 200, epoch: 16 | loss: 0.8554280
	speed: 0.0429s/iter; left time: 750.7602s
Epoch: 16 cost time: 9.693476915359497
Epoch: 16, Steps: 208 | Train Loss: 0.691 Vali Loss: 8.294 Vali Acc: 0.095 Test Loss: 8.294 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.5258057
	speed: 0.2699s/iter; left time: 4688.6443s
	iters: 200, epoch: 17 | loss: 0.3435085
	speed: 0.0412s/iter; left time: 710.7962s
Epoch: 17 cost time: 9.993980646133423
Epoch: 17, Steps: 208 | Train Loss: 0.616 Vali Loss: 8.867 Vali Acc: 0.095 Test Loss: 8.867 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7894034
	speed: 0.2612s/iter; left time: 4483.2729s
	iters: 200, epoch: 18 | loss: 0.6364958
	speed: 0.0437s/iter; left time: 744.8907s
Epoch: 18 cost time: 10.035293817520142
Epoch: 18, Steps: 208 | Train Loss: 0.555 Vali Loss: 9.457 Vali Acc: 0.101 Test Loss: 9.457 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4616292
	speed: 0.2554s/iter; left time: 4330.8248s
	iters: 200, epoch: 19 | loss: 0.5156373
	speed: 0.0340s/iter; left time: 573.8835s
Epoch: 19 cost time: 7.925485372543335
Epoch: 19, Steps: 208 | Train Loss: 0.506 Vali Loss: 9.823 Vali Acc: 0.101 Test Loss: 9.823 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1719727
	speed: 0.2376s/iter; left time: 3980.2365s
	iters: 200, epoch: 20 | loss: 0.2183099
	speed: 0.0348s/iter; left time: 578.9270s
Epoch: 20 cost time: 8.091131210327148
Epoch: 20, Steps: 208 | Train Loss: 0.463 Vali Loss: 10.534 Vali Acc: 0.101 Test Loss: 10.534 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4238363
	speed: 0.2376s/iter; left time: 3930.4928s
	iters: 200, epoch: 21 | loss: 0.6483812
	speed: 0.0357s/iter; left time: 587.7297s
Epoch: 21 cost time: 8.283519744873047
Epoch: 21, Steps: 208 | Train Loss: 0.450 Vali Loss: 10.745 Vali Acc: 0.103 Test Loss: 10.745 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4547979
	speed: 0.2308s/iter; left time: 3769.5181s
	iters: 200, epoch: 22 | loss: 0.2986110
	speed: 0.0390s/iter; left time: 632.7724s
Epoch: 22 cost time: 8.647180318832397
Epoch: 22, Steps: 208 | Train Loss: 0.404 Vali Loss: 11.020 Vali Acc: 0.104 Test Loss: 11.020 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.1087347
	speed: 0.2293s/iter; left time: 3697.5624s
	iters: 200, epoch: 23 | loss: 0.2275390
	speed: 0.0369s/iter; left time: 590.6735s
Epoch: 23 cost time: 9.170574188232422
Epoch: 23, Steps: 208 | Train Loss: 0.371 Vali Loss: 11.595 Vali Acc: 0.098 Test Loss: 11.595 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.8126042
	speed: 0.2474s/iter; left time: 3938.1357s
	iters: 200, epoch: 24 | loss: 0.1798009
	speed: 0.0350s/iter; left time: 553.5871s
Epoch: 24 cost time: 8.277488231658936
Epoch: 24, Steps: 208 | Train Loss: 0.367 Vali Loss: 11.992 Vali Acc: 0.106 Test Loss: 11.992 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.3898448
	speed: 0.2515s/iter; left time: 3951.4989s
	iters: 200, epoch: 25 | loss: 0.6606730
	speed: 0.0338s/iter; left time: 527.8764s
Epoch: 25 cost time: 7.935419082641602
Epoch: 25, Steps: 208 | Train Loss: 0.323 Vali Loss: 12.140 Vali Acc: 0.101 Test Loss: 12.140 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10557709513868178
model parameter : 499767
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9856675
	speed: 0.0770s/iter; left time: 1593.4903s
	iters: 200, epoch: 1 | loss: 3.9334736
	speed: 0.0400s/iter; left time: 824.5050s
Epoch: 1 cost time: 12.203968524932861
Epoch: 1, Steps: 208 | Train Loss: 3.900 Vali Loss: 3.961 Vali Acc: 0.060 Test Loss: 3.961 Test Acc: 0.060
Validation loss decreased (inf --> -0.059907).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9623301
	speed: 0.2516s/iter; left time: 5155.5620s
	iters: 200, epoch: 2 | loss: 3.9157853
	speed: 0.0424s/iter; left time: 864.5935s
Epoch: 2 cost time: 9.55914306640625
Epoch: 2, Steps: 208 | Train Loss: 3.632 Vali Loss: 3.900 Vali Acc: 0.074 Test Loss: 3.900 Test Acc: 0.074
Validation loss decreased (-0.059907 --> -0.073925).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5502803
	speed: 0.2498s/iter; left time: 5067.6178s
	iters: 200, epoch: 3 | loss: 3.4128981
	speed: 0.0384s/iter; left time: 774.5199s
Epoch: 3 cost time: 9.141911029815674
Epoch: 3, Steps: 208 | Train Loss: 3.311 Vali Loss: 3.947 Vali Acc: 0.085 Test Loss: 3.947 Test Acc: 0.085
Validation loss decreased (-0.073925 --> -0.084959).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3183713
	speed: 0.2557s/iter; left time: 5134.2082s
	iters: 200, epoch: 4 | loss: 3.6519480
	speed: 0.0334s/iter; left time: 666.4460s
Epoch: 4 cost time: 8.129793882369995
Epoch: 4, Steps: 208 | Train Loss: 3.099 Vali Loss: 4.201 Vali Acc: 0.080 Test Loss: 4.201 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.6563625
	speed: 0.2435s/iter; left time: 4838.5018s
	iters: 200, epoch: 5 | loss: 2.6581159
	speed: 0.0405s/iter; left time: 800.9683s
Epoch: 5 cost time: 8.603515625
Epoch: 5, Steps: 208 | Train Loss: 2.907 Vali Loss: 4.199 Vali Acc: 0.093 Test Loss: 4.199 Test Acc: 0.093
Validation loss decreased (-0.084959 --> -0.093307).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4906361
	speed: 0.2458s/iter; left time: 4832.6161s
	iters: 200, epoch: 6 | loss: 2.9792676
	speed: 0.0387s/iter; left time: 756.0760s
Epoch: 6 cost time: 8.621312856674194
Epoch: 6, Steps: 208 | Train Loss: 2.679 Vali Loss: 4.158 Vali Acc: 0.097 Test Loss: 4.158 Test Acc: 0.097
Validation loss decreased (-0.093307 --> -0.097185).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0817583
	speed: 0.2247s/iter; left time: 4370.2437s
	iters: 200, epoch: 7 | loss: 2.8337386
	speed: 0.0379s/iter; left time: 733.6894s
Epoch: 7 cost time: 8.181079387664795
Epoch: 7, Steps: 208 | Train Loss: 2.520 Vali Loss: 4.252 Vali Acc: 0.098 Test Loss: 4.252 Test Acc: 0.098
Validation loss decreased (-0.097185 --> -0.097482).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2511797
	speed: 0.2411s/iter; left time: 4639.4052s
	iters: 200, epoch: 8 | loss: 2.8101418
	speed: 0.0355s/iter; left time: 679.4218s
Epoch: 8 cost time: 8.781682014465332
Epoch: 8, Steps: 208 | Train Loss: 2.347 Vali Loss: 4.302 Vali Acc: 0.104 Test Loss: 4.302 Test Acc: 0.104
Validation loss decreased (-0.097482 --> -0.104341).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9716336
	speed: 0.2442s/iter; left time: 4648.7836s
	iters: 200, epoch: 9 | loss: 3.0908189
	speed: 0.0337s/iter; left time: 638.9404s
Epoch: 9 cost time: 8.013678789138794
Epoch: 9, Steps: 208 | Train Loss: 2.217 Vali Loss: 4.451 Vali Acc: 0.101 Test Loss: 4.451 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.5920358
	speed: 0.2394s/iter; left time: 4506.9024s
	iters: 200, epoch: 10 | loss: 2.7467823
	speed: 0.0352s/iter; left time: 660.1939s
Epoch: 10 cost time: 8.2825345993042
Epoch: 10, Steps: 208 | Train Loss: 2.068 Vali Loss: 4.547 Vali Acc: 0.107 Test Loss: 4.547 Test Acc: 0.107
Validation loss decreased (-0.104341 --> -0.106725).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3325763
	speed: 0.2277s/iter; left time: 4240.8671s
	iters: 200, epoch: 11 | loss: 2.3645132
	speed: 0.0319s/iter; left time: 591.6794s
Epoch: 11 cost time: 8.035962581634521
Epoch: 11, Steps: 208 | Train Loss: 1.927 Vali Loss: 4.691 Vali Acc: 0.106 Test Loss: 4.691 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.4474764
	speed: 0.2424s/iter; left time: 4463.4186s
	iters: 200, epoch: 12 | loss: 2.0519862
	speed: 0.0331s/iter; left time: 606.1695s
Epoch: 12 cost time: 8.194303512573242
Epoch: 12, Steps: 208 | Train Loss: 1.789 Vali Loss: 4.775 Vali Acc: 0.101 Test Loss: 4.775 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.9407412
	speed: 0.2438s/iter; left time: 4437.6808s
	iters: 200, epoch: 13 | loss: 1.9546903
	speed: 0.0304s/iter; left time: 551.1510s
Epoch: 13 cost time: 7.662604808807373
Epoch: 13, Steps: 208 | Train Loss: 1.689 Vali Loss: 5.006 Vali Acc: 0.105 Test Loss: 5.006 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.8970294
	speed: 0.2394s/iter; left time: 4308.3641s
	iters: 200, epoch: 14 | loss: 2.0601044
	speed: 0.0337s/iter; left time: 602.3304s
Epoch: 14 cost time: 7.8918373584747314
Epoch: 14, Steps: 208 | Train Loss: 1.562 Vali Loss: 5.255 Vali Acc: 0.106 Test Loss: 5.255 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4642141
	speed: 0.2437s/iter; left time: 4334.7078s
	iters: 200, epoch: 15 | loss: 1.6794078
	speed: 0.0336s/iter; left time: 594.7727s
Epoch: 15 cost time: 7.862478017807007
Epoch: 15, Steps: 208 | Train Loss: 1.471 Vali Loss: 5.419 Vali Acc: 0.106 Test Loss: 5.419 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2971394
	speed: 0.2345s/iter; left time: 4121.9761s
	iters: 200, epoch: 16 | loss: 1.0249676
	speed: 0.0296s/iter; left time: 518.2326s
Epoch: 16 cost time: 7.464543581008911
Epoch: 16, Steps: 208 | Train Loss: 1.379 Vali Loss: 5.755 Vali Acc: 0.102 Test Loss: 5.755 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.8068806
	speed: 0.2238s/iter; left time: 3887.9544s
	iters: 200, epoch: 17 | loss: 1.6160352
	speed: 0.0287s/iter; left time: 496.1023s
Epoch: 17 cost time: 7.407598495483398
Epoch: 17, Steps: 208 | Train Loss: 1.284 Vali Loss: 5.918 Vali Acc: 0.101 Test Loss: 5.918 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 2.0575147
	speed: 0.2361s/iter; left time: 4052.8588s
	iters: 200, epoch: 18 | loss: 1.9457332
	speed: 0.0354s/iter; left time: 603.8944s
Epoch: 18 cost time: 8.67833924293518
Epoch: 18, Steps: 208 | Train Loss: 1.208 Vali Loss: 6.073 Vali Acc: 0.106 Test Loss: 6.073 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.6706726
	speed: 0.2437s/iter; left time: 4131.8842s
	iters: 200, epoch: 19 | loss: 1.6942781
	speed: 0.0331s/iter; left time: 558.3964s
Epoch: 19 cost time: 7.9453418254852295
Epoch: 19, Steps: 208 | Train Loss: 1.114 Vali Loss: 6.453 Vali Acc: 0.107 Test Loss: 6.453 Test Acc: 0.107
Validation loss decreased (-0.106725 --> -0.107004).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.0310240
	speed: 0.2353s/iter; left time: 3940.8050s
	iters: 200, epoch: 20 | loss: 1.2602787
	speed: 0.0351s/iter; left time: 584.5729s
Epoch: 20 cost time: 7.7693188190460205
Epoch: 20, Steps: 208 | Train Loss: 1.083 Vali Loss: 6.876 Vali Acc: 0.105 Test Loss: 6.876 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.9364374
	speed: 0.2455s/iter; left time: 4060.4393s
	iters: 200, epoch: 21 | loss: 1.1840684
	speed: 0.0349s/iter; left time: 573.3143s
Epoch: 21 cost time: 7.951099872589111
Epoch: 21, Steps: 208 | Train Loss: 0.986 Vali Loss: 6.962 Vali Acc: 0.099 Test Loss: 6.962 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4408296
	speed: 0.2437s/iter; left time: 3980.3139s
	iters: 200, epoch: 22 | loss: 1.5879498
	speed: 0.0354s/iter; left time: 574.8829s
Epoch: 22 cost time: 8.900107145309448
Epoch: 22, Steps: 208 | Train Loss: 0.952 Vali Loss: 7.366 Vali Acc: 0.098 Test Loss: 7.366 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.9782377
	speed: 0.2614s/iter; left time: 4214.3640s
	iters: 200, epoch: 23 | loss: 1.1141491
	speed: 0.0346s/iter; left time: 554.6405s
Epoch: 23 cost time: 8.140196323394775
Epoch: 23, Steps: 208 | Train Loss: 0.912 Vali Loss: 7.456 Vali Acc: 0.102 Test Loss: 7.456 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.8420799
	speed: 0.2692s/iter; left time: 4284.0923s
	iters: 200, epoch: 24 | loss: 1.1769776
	speed: 0.0370s/iter; left time: 585.7307s
Epoch: 24 cost time: 8.628115177154541
Epoch: 24, Steps: 208 | Train Loss: 0.818 Vali Loss: 7.794 Vali Acc: 0.100 Test Loss: 7.794 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.4847030
	speed: 0.2507s/iter; left time: 3938.0828s
	iters: 200, epoch: 25 | loss: 0.5952442
	speed: 0.0342s/iter; left time: 534.2354s
Epoch: 25 cost time: 8.188130855560303
Epoch: 25, Steps: 208 | Train Loss: 0.786 Vali Loss: 8.227 Vali Acc: 0.106 Test Loss: 8.227 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.4900000
	speed: 0.2565s/iter; left time: 3976.6123s
	iters: 200, epoch: 26 | loss: 1.0255984
	speed: 0.0365s/iter; left time: 561.3691s
Epoch: 26 cost time: 8.859045267105103
Epoch: 26, Steps: 208 | Train Loss: 0.796 Vali Loss: 8.244 Vali Acc: 0.101 Test Loss: 8.244 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.7219569
	speed: 0.2508s/iter; left time: 3835.4026s
	iters: 200, epoch: 27 | loss: 1.1037869
	speed: 0.0322s/iter; left time: 489.8416s
Epoch: 27 cost time: 7.359477519989014
Epoch: 27, Steps: 208 | Train Loss: 0.749 Vali Loss: 8.605 Vali Acc: 0.093 Test Loss: 8.605 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.6715117
	speed: 0.2341s/iter; left time: 3531.7385s
	iters: 200, epoch: 28 | loss: 0.9039538
	speed: 0.0323s/iter; left time: 483.7177s
Epoch: 28 cost time: 7.6142778396606445
Epoch: 28, Steps: 208 | Train Loss: 0.705 Vali Loss: 8.774 Vali Acc: 0.100 Test Loss: 8.774 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.7627453
	speed: 0.2056s/iter; left time: 3058.0563s
	iters: 200, epoch: 29 | loss: 1.1919818
	speed: 0.0298s/iter; left time: 440.0444s
Epoch: 29 cost time: 7.0729310512542725
Epoch: 29, Steps: 208 | Train Loss: 0.695 Vali Loss: 9.049 Vali Acc: 0.108 Test Loss: 9.049 Test Acc: 0.108
Validation loss decreased (-0.107004 --> -0.108171).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.3148994
	speed: 0.2005s/iter; left time: 2940.8960s
	iters: 200, epoch: 30 | loss: 0.5676901
	speed: 0.0301s/iter; left time: 438.5916s
Epoch: 30 cost time: 7.070684194564819
Epoch: 30, Steps: 208 | Train Loss: 0.639 Vali Loss: 9.312 Vali Acc: 0.104 Test Loss: 9.312 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.6141447
	speed: 0.1910s/iter; left time: 2761.8009s
	iters: 200, epoch: 31 | loss: 0.4326885
	speed: 0.0279s/iter; left time: 400.0943s
Epoch: 31 cost time: 6.796122074127197
Epoch: 31, Steps: 208 | Train Loss: 0.630 Vali Loss: 9.520 Vali Acc: 0.104 Test Loss: 9.520 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.6659693
	speed: 0.1931s/iter; left time: 2751.5762s
	iters: 200, epoch: 32 | loss: 0.6322565
	speed: 0.0273s/iter; left time: 386.6197s
Epoch: 32 cost time: 6.537289619445801
Epoch: 32, Steps: 208 | Train Loss: 0.598 Vali Loss: 9.546 Vali Acc: 0.099 Test Loss: 9.546 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.5341948
	speed: 0.2101s/iter; left time: 2951.5353s
	iters: 200, epoch: 33 | loss: 0.5839244
	speed: 0.0242s/iter; left time: 337.0036s
Epoch: 33 cost time: 6.7426722049713135
Epoch: 33, Steps: 208 | Train Loss: 0.596 Vali Loss: 9.766 Vali Acc: 0.098 Test Loss: 9.766 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.9202274
	speed: 0.1999s/iter; left time: 2765.4177s
	iters: 200, epoch: 34 | loss: 0.5458505
	speed: 0.0299s/iter; left time: 411.0225s
Epoch: 34 cost time: 7.341515064239502
Epoch: 34, Steps: 208 | Train Loss: 0.537 Vali Loss: 10.195 Vali Acc: 0.100 Test Loss: 10.195 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.6266555
	speed: 0.2005s/iter; left time: 2732.7026s
	iters: 200, epoch: 35 | loss: 0.7221429
	speed: 0.0316s/iter; left time: 428.1659s
Epoch: 35 cost time: 7.320498943328857
Epoch: 35, Steps: 208 | Train Loss: 0.540 Vali Loss: 10.166 Vali Acc: 0.102 Test Loss: 10.166 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.1899892
	speed: 0.2179s/iter; left time: 2924.2795s
	iters: 200, epoch: 36 | loss: 0.2640616
	speed: 0.0313s/iter; left time: 416.9744s
Epoch: 36 cost time: 7.909920930862427
Epoch: 36, Steps: 208 | Train Loss: 0.508 Vali Loss: 10.621 Vali Acc: 0.107 Test Loss: 10.621 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.3801390
	speed: 0.2373s/iter; left time: 3134.9256s
	iters: 200, epoch: 37 | loss: 0.4145857
	speed: 0.0318s/iter; left time: 417.0976s
Epoch: 37 cost time: 7.83100962638855
Epoch: 37, Steps: 208 | Train Loss: 0.526 Vali Loss: 10.912 Vali Acc: 0.102 Test Loss: 10.912 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.9355333
	speed: 0.2246s/iter; left time: 2921.5127s
	iters: 200, epoch: 38 | loss: 0.2878674
	speed: 0.0330s/iter; left time: 425.5164s
Epoch: 38 cost time: 7.648632287979126
Epoch: 38, Steps: 208 | Train Loss: 0.508 Vali Loss: 10.917 Vali Acc: 0.108 Test Loss: 10.917 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.1146924
	speed: 0.2400s/iter; left time: 3071.7808s
	iters: 200, epoch: 39 | loss: 0.2463895
	speed: 0.0409s/iter; left time: 519.3708s
Epoch: 39 cost time: 9.058358907699585
Epoch: 39, Steps: 208 | Train Loss: 0.470 Vali Loss: 11.241 Vali Acc: 0.101 Test Loss: 11.241 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10826125857441098
model parameter : 252743
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0814767
	speed: 0.0713s/iter; left time: 1475.8682s
	iters: 200, epoch: 1 | loss: 3.5209217
	speed: 0.0302s/iter; left time: 621.2185s
Epoch: 1 cost time: 10.597277164459229
Epoch: 1, Steps: 208 | Train Loss: 3.827 Vali Loss: 3.817 Vali Acc: 0.053 Test Loss: 3.817 Test Acc: 0.053
Validation loss decreased (inf --> -0.052750).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4033411
	speed: 0.2406s/iter; left time: 4929.6562s
	iters: 200, epoch: 2 | loss: 3.4382925
	speed: 0.0380s/iter; left time: 775.7534s
Epoch: 2 cost time: 9.046749830245972
Epoch: 2, Steps: 208 | Train Loss: 3.594 Vali Loss: 3.924 Vali Acc: 0.063 Test Loss: 3.924 Test Acc: 0.063
Validation loss decreased (-0.052750 --> -0.062591).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1225767
	speed: 0.2425s/iter; left time: 4918.9069s
	iters: 200, epoch: 3 | loss: 3.1270819
	speed: 0.0366s/iter; left time: 739.3457s
Epoch: 3 cost time: 8.88166069984436
Epoch: 3, Steps: 208 | Train Loss: 3.319 Vali Loss: 3.879 Vali Acc: 0.080 Test Loss: 3.879 Test Acc: 0.080
Validation loss decreased (-0.062591 --> -0.080188).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5716996
	speed: 0.2323s/iter; left time: 4664.1607s
	iters: 200, epoch: 4 | loss: 2.5250154
	speed: 0.0369s/iter; left time: 737.8189s
Epoch: 4 cost time: 8.671210289001465
Epoch: 4, Steps: 208 | Train Loss: 3.083 Vali Loss: 3.932 Vali Acc: 0.087 Test Loss: 3.932 Test Acc: 0.087
Validation loss decreased (-0.080188 --> -0.087345).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8857846
	speed: 0.2344s/iter; left time: 4656.9491s
	iters: 200, epoch: 5 | loss: 3.1554523
	speed: 0.0369s/iter; left time: 728.9064s
Epoch: 5 cost time: 8.777964353561401
Epoch: 5, Steps: 208 | Train Loss: 2.921 Vali Loss: 3.939 Vali Acc: 0.087 Test Loss: 3.939 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4143648
	speed: 0.2243s/iter; left time: 4409.4242s
	iters: 200, epoch: 6 | loss: 3.4525228
	speed: 0.0313s/iter; left time: 612.6299s
Epoch: 6 cost time: 7.828602313995361
Epoch: 6, Steps: 208 | Train Loss: 2.742 Vali Loss: 3.986 Vali Acc: 0.099 Test Loss: 3.986 Test Acc: 0.099
Validation loss decreased (-0.087345 --> -0.098678).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3321352
	speed: 0.2221s/iter; left time: 4320.6060s
	iters: 200, epoch: 7 | loss: 3.1088345
	speed: 0.0320s/iter; left time: 618.4291s
Epoch: 7 cost time: 7.566091775894165
Epoch: 7, Steps: 208 | Train Loss: 2.647 Vali Loss: 4.094 Vali Acc: 0.094 Test Loss: 4.094 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9685240
	speed: 0.2145s/iter; left time: 4127.3436s
	iters: 200, epoch: 8 | loss: 2.4150629
	speed: 0.0335s/iter; left time: 642.1195s
Epoch: 8 cost time: 7.778696298599243
Epoch: 8, Steps: 208 | Train Loss: 2.529 Vali Loss: 4.095 Vali Acc: 0.096 Test Loss: 4.095 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.5299985
	speed: 0.2009s/iter; left time: 3824.2251s
	iters: 200, epoch: 9 | loss: 2.5566235
	speed: 0.0317s/iter; left time: 600.7561s
Epoch: 9 cost time: 7.155726671218872
Epoch: 9, Steps: 208 | Train Loss: 2.376 Vali Loss: 4.195 Vali Acc: 0.102 Test Loss: 4.195 Test Acc: 0.102
Validation loss decreased (-0.098678 --> -0.102255).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6838944
	speed: 0.2094s/iter; left time: 3941.9992s
	iters: 200, epoch: 10 | loss: 2.6932142
	speed: 0.0300s/iter; left time: 562.6934s
Epoch: 10 cost time: 6.948801279067993
Epoch: 10, Steps: 208 | Train Loss: 2.277 Vali Loss: 4.419 Vali Acc: 0.095 Test Loss: 4.419 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.0236278
	speed: 0.2204s/iter; left time: 4103.3096s
	iters: 200, epoch: 11 | loss: 2.6082010
	speed: 0.0309s/iter; left time: 572.1684s
Epoch: 11 cost time: 7.279695510864258
Epoch: 11, Steps: 208 | Train Loss: 2.149 Vali Loss: 4.508 Vali Acc: 0.096 Test Loss: 4.508 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7507826
	speed: 0.2127s/iter; left time: 3916.5397s
	iters: 200, epoch: 12 | loss: 2.9768608
	speed: 0.0311s/iter; left time: 570.1956s
Epoch: 12 cost time: 7.1168293952941895
Epoch: 12, Steps: 208 | Train Loss: 2.069 Vali Loss: 4.562 Vali Acc: 0.097 Test Loss: 4.562 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6888275
	speed: 0.2086s/iter; left time: 3797.6117s
	iters: 200, epoch: 13 | loss: 2.6699300
	speed: 0.0310s/iter; left time: 561.2329s
Epoch: 13 cost time: 7.822300672531128
Epoch: 13, Steps: 208 | Train Loss: 1.955 Vali Loss: 4.688 Vali Acc: 0.100 Test Loss: 4.688 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.3480377
	speed: 0.2203s/iter; left time: 3965.1542s
	iters: 200, epoch: 14 | loss: 2.2842710
	speed: 0.0341s/iter; left time: 610.2876s
Epoch: 14 cost time: 7.882556676864624
Epoch: 14, Steps: 208 | Train Loss: 1.859 Vali Loss: 4.774 Vali Acc: 0.103 Test Loss: 4.774 Test Acc: 0.103
Validation loss decreased (-0.102255 --> -0.102547).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5976489
	speed: 0.2081s/iter; left time: 3702.5216s
	iters: 200, epoch: 15 | loss: 0.9902001
	speed: 0.0381s/iter; left time: 674.2900s
Epoch: 15 cost time: 8.122474908828735
Epoch: 15, Steps: 208 | Train Loss: 1.778 Vali Loss: 4.955 Vali Acc: 0.099 Test Loss: 4.955 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.7203243
	speed: 0.2176s/iter; left time: 3824.9541s
	iters: 200, epoch: 16 | loss: 1.3817786
	speed: 0.0315s/iter; left time: 550.6265s
Epoch: 16 cost time: 7.435931205749512
Epoch: 16, Steps: 208 | Train Loss: 1.695 Vali Loss: 5.080 Vali Acc: 0.095 Test Loss: 5.080 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.6025987
	speed: 0.2229s/iter; left time: 3872.5566s
	iters: 200, epoch: 17 | loss: 1.9137591
	speed: 0.0341s/iter; left time: 589.4953s
Epoch: 17 cost time: 7.693403244018555
Epoch: 17, Steps: 208 | Train Loss: 1.615 Vali Loss: 5.331 Vali Acc: 0.103 Test Loss: 5.331 Test Acc: 0.103
Validation loss decreased (-0.102547 --> -0.103436).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0575156
	speed: 0.2063s/iter; left time: 3541.3173s
	iters: 200, epoch: 18 | loss: 1.8037877
	speed: 0.0287s/iter; left time: 489.1787s
Epoch: 18 cost time: 6.813237428665161
Epoch: 18, Steps: 208 | Train Loss: 1.557 Vali Loss: 5.422 Vali Acc: 0.099 Test Loss: 5.422 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8093975
	speed: 0.2169s/iter; left time: 3677.3078s
	iters: 200, epoch: 19 | loss: 1.6614569
	speed: 0.0324s/iter; left time: 546.4815s
Epoch: 19 cost time: 7.952941179275513
Epoch: 19, Steps: 208 | Train Loss: 1.482 Vali Loss: 5.533 Vali Acc: 0.106 Test Loss: 5.533 Test Acc: 0.106
Validation loss decreased (-0.103436 --> -0.106118).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7886442
	speed: 0.2216s/iter; left time: 3711.0450s
	iters: 200, epoch: 20 | loss: 1.7227545
	speed: 0.0325s/iter; left time: 540.7260s
Epoch: 20 cost time: 7.710924863815308
Epoch: 20, Steps: 208 | Train Loss: 1.415 Vali Loss: 5.755 Vali Acc: 0.099 Test Loss: 5.755 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.3460501
	speed: 0.2228s/iter; left time: 3686.1539s
	iters: 200, epoch: 21 | loss: 1.4841942
	speed: 0.0309s/iter; left time: 508.4490s
Epoch: 21 cost time: 7.837014436721802
Epoch: 21, Steps: 208 | Train Loss: 1.373 Vali Loss: 6.014 Vali Acc: 0.102 Test Loss: 6.014 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0609907
	speed: 0.2092s/iter; left time: 3417.2107s
	iters: 200, epoch: 22 | loss: 1.2637806
	speed: 0.0308s/iter; left time: 499.4262s
Epoch: 22 cost time: 7.619116544723511
Epoch: 22, Steps: 208 | Train Loss: 1.293 Vali Loss: 6.298 Vali Acc: 0.103 Test Loss: 6.298 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.8155140
	speed: 0.2102s/iter; left time: 3388.8769s
	iters: 200, epoch: 23 | loss: 2.1144619
	speed: 0.0245s/iter; left time: 392.0153s
Epoch: 23 cost time: 6.705545663833618
Epoch: 23, Steps: 208 | Train Loss: 1.281 Vali Loss: 6.252 Vali Acc: 0.100 Test Loss: 6.252 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.4325200
	speed: 0.2221s/iter; left time: 3534.9199s
	iters: 200, epoch: 24 | loss: 1.3473479
	speed: 0.0265s/iter; left time: 419.4884s
Epoch: 24 cost time: 6.712122678756714
Epoch: 24, Steps: 208 | Train Loss: 1.221 Vali Loss: 6.432 Vali Acc: 0.103 Test Loss: 6.432 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.0838675
	speed: 0.2079s/iter; left time: 3265.4051s
	iters: 200, epoch: 25 | loss: 1.3999577
	speed: 0.0326s/iter; left time: 508.1122s
Epoch: 25 cost time: 6.952982187271118
Epoch: 25, Steps: 208 | Train Loss: 1.179 Vali Loss: 6.747 Vali Acc: 0.101 Test Loss: 6.747 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.5451699
	speed: 0.2299s/iter; left time: 3563.0592s
	iters: 200, epoch: 26 | loss: 1.8952655
	speed: 0.0354s/iter; left time: 545.9302s
Epoch: 26 cost time: 7.81359338760376
Epoch: 26, Steps: 208 | Train Loss: 1.149 Vali Loss: 6.969 Vali Acc: 0.100 Test Loss: 6.969 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.0229318
	speed: 0.2452s/iter; left time: 3750.0748s
	iters: 200, epoch: 27 | loss: 1.1058304
	speed: 0.0341s/iter; left time: 518.2264s
Epoch: 27 cost time: 8.308358669281006
Epoch: 27, Steps: 208 | Train Loss: 1.102 Vali Loss: 6.898 Vali Acc: 0.098 Test Loss: 6.898 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.7916136
	speed: 0.2451s/iter; left time: 3696.8860s
	iters: 200, epoch: 28 | loss: 0.9873537
	speed: 0.0366s/iter; left time: 548.2773s
Epoch: 28 cost time: 9.019130945205688
Epoch: 28, Steps: 208 | Train Loss: 1.075 Vali Loss: 7.226 Vali Acc: 0.102 Test Loss: 7.226 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.8865533
	speed: 0.2407s/iter; left time: 3580.3843s
	iters: 200, epoch: 29 | loss: 0.8940759
	speed: 0.0319s/iter; left time: 470.7897s
Epoch: 29 cost time: 7.871796131134033
Epoch: 29, Steps: 208 | Train Loss: 1.041 Vali Loss: 7.273 Vali Acc: 0.102 Test Loss: 7.273 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10617357590217716
model parameter : 170471
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9371376
	speed: 0.0645s/iter; left time: 1334.3452s
	iters: 200, epoch: 1 | loss: 3.9649231
	speed: 0.0282s/iter; left time: 581.7921s
Epoch: 1 cost time: 9.6786527633667
Epoch: 1, Steps: 208 | Train Loss: 3.802 Vali Loss: 3.786 Vali Acc: 0.059 Test Loss: 3.786 Test Acc: 0.059
Validation loss decreased (inf --> -0.059014).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5920391
	speed: 0.2195s/iter; left time: 4497.6157s
	iters: 200, epoch: 2 | loss: 3.9298890
	speed: 0.0352s/iter; left time: 716.8941s
Epoch: 2 cost time: 7.796780347824097
Epoch: 2, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.786 Vali Acc: 0.067 Test Loss: 3.786 Test Acc: 0.067
Validation loss decreased (-0.059014 --> -0.067364).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8075221
	speed: 0.2162s/iter; left time: 4385.6726s
	iters: 200, epoch: 3 | loss: 3.8795254
	speed: 0.0357s/iter; left time: 719.7351s
Epoch: 3 cost time: 8.14444613456726
Epoch: 3, Steps: 208 | Train Loss: 3.374 Vali Loss: 3.794 Vali Acc: 0.072 Test Loss: 3.794 Test Acc: 0.072
Validation loss decreased (-0.067364 --> -0.072136).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7844319
	speed: 0.2151s/iter; left time: 4317.6548s
	iters: 200, epoch: 4 | loss: 3.2547801
	speed: 0.0324s/iter; left time: 648.0873s
Epoch: 4 cost time: 7.331246376037598
Epoch: 4, Steps: 208 | Train Loss: 3.200 Vali Loss: 3.808 Vali Acc: 0.083 Test Loss: 3.808 Test Acc: 0.083
Validation loss decreased (-0.072136 --> -0.082873).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4077392
	speed: 0.2071s/iter; left time: 4113.9864s
	iters: 200, epoch: 5 | loss: 3.1766064
	speed: 0.0326s/iter; left time: 644.6672s
Epoch: 5 cost time: 7.5840253829956055
Epoch: 5, Steps: 208 | Train Loss: 3.023 Vali Loss: 3.858 Vali Acc: 0.088 Test Loss: 3.858 Test Acc: 0.088
Validation loss decreased (-0.082873 --> -0.088241).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9823213
	speed: 0.2156s/iter; left time: 4239.5715s
	iters: 200, epoch: 6 | loss: 2.6804421
	speed: 0.0323s/iter; left time: 632.4436s
Epoch: 6 cost time: 7.197048902511597
Epoch: 6, Steps: 208 | Train Loss: 2.876 Vali Loss: 3.871 Vali Acc: 0.087 Test Loss: 3.871 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.4156182
	speed: 0.2188s/iter; left time: 4255.5660s
	iters: 200, epoch: 7 | loss: 2.5610812
	speed: 0.0288s/iter; left time: 558.2668s
Epoch: 7 cost time: 7.477835416793823
Epoch: 7, Steps: 208 | Train Loss: 2.733 Vali Loss: 3.978 Vali Acc: 0.096 Test Loss: 3.978 Test Acc: 0.096
Validation loss decreased (-0.088241 --> -0.095695).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0105317
	speed: 0.2040s/iter; left time: 3925.2441s
	iters: 200, epoch: 8 | loss: 2.8109646
	speed: 0.0322s/iter; left time: 616.1913s
Epoch: 8 cost time: 7.738372325897217
Epoch: 8, Steps: 208 | Train Loss: 2.641 Vali Loss: 3.938 Vali Acc: 0.093 Test Loss: 3.938 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.6057627
	speed: 0.2106s/iter; left time: 4009.3885s
	iters: 200, epoch: 9 | loss: 2.1275923
	speed: 0.0341s/iter; left time: 646.5087s
Epoch: 9 cost time: 7.612841844558716
Epoch: 9, Steps: 208 | Train Loss: 2.509 Vali Loss: 4.037 Vali Acc: 0.097 Test Loss: 4.037 Test Acc: 0.097
Validation loss decreased (-0.095695 --> -0.096888).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9868832
	speed: 0.2456s/iter; left time: 4625.0169s
	iters: 200, epoch: 10 | loss: 2.1239016
	speed: 0.0354s/iter; left time: 663.0500s
Epoch: 10 cost time: 8.395524501800537
Epoch: 10, Steps: 208 | Train Loss: 2.401 Vali Loss: 4.023 Vali Acc: 0.100 Test Loss: 4.023 Test Acc: 0.100
Validation loss decreased (-0.096888 --> -0.099572).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5128443
	speed: 0.2211s/iter; left time: 4117.8051s
	iters: 200, epoch: 11 | loss: 2.6395862
	speed: 0.0305s/iter; left time: 564.6267s
Epoch: 11 cost time: 7.258887052536011
Epoch: 11, Steps: 208 | Train Loss: 2.318 Vali Loss: 4.190 Vali Acc: 0.101 Test Loss: 4.190 Test Acc: 0.101
Validation loss decreased (-0.099572 --> -0.100465).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0209849
	speed: 0.2234s/iter; left time: 4113.0528s
	iters: 200, epoch: 12 | loss: 2.9716260
	speed: 0.0328s/iter; left time: 599.8096s
Epoch: 12 cost time: 7.504368543624878
Epoch: 12, Steps: 208 | Train Loss: 2.216 Vali Loss: 4.278 Vali Acc: 0.098 Test Loss: 4.278 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.9503592
	speed: 0.2201s/iter; left time: 4007.6121s
	iters: 200, epoch: 13 | loss: 2.0819566
	speed: 0.0265s/iter; left time: 480.0861s
Epoch: 13 cost time: 6.666381597518921
Epoch: 13, Steps: 208 | Train Loss: 2.130 Vali Loss: 4.386 Vali Acc: 0.104 Test Loss: 4.386 Test Acc: 0.104
Validation loss decreased (-0.100465 --> -0.104340).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2373428
	speed: 0.2109s/iter; left time: 3795.2479s
	iters: 200, epoch: 14 | loss: 1.5996839
	speed: 0.0288s/iter; left time: 515.4139s
Epoch: 14 cost time: 6.622594594955444
Epoch: 14, Steps: 208 | Train Loss: 2.043 Vali Loss: 4.478 Vali Acc: 0.111 Test Loss: 4.478 Test Acc: 0.111
Validation loss decreased (-0.104340 --> -0.110602).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6591973
	speed: 0.2017s/iter; left time: 3588.4908s
	iters: 200, epoch: 15 | loss: 2.2934504
	speed: 0.0303s/iter; left time: 536.3035s
Epoch: 15 cost time: 7.119373321533203
Epoch: 15, Steps: 208 | Train Loss: 1.983 Vali Loss: 4.591 Vali Acc: 0.102 Test Loss: 4.591 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.0816538
	speed: 0.2092s/iter; left time: 3678.6483s
	iters: 200, epoch: 16 | loss: 2.1273623
	speed: 0.0317s/iter; left time: 554.7376s
Epoch: 16 cost time: 7.994826078414917
Epoch: 16, Steps: 208 | Train Loss: 1.913 Vali Loss: 4.745 Vali Acc: 0.099 Test Loss: 4.745 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.0347967
	speed: 0.2142s/iter; left time: 3721.5068s
	iters: 200, epoch: 17 | loss: 2.0922937
	speed: 0.0334s/iter; left time: 577.7476s
Epoch: 17 cost time: 7.4845359325408936
Epoch: 17, Steps: 208 | Train Loss: 1.848 Vali Loss: 4.739 Vali Acc: 0.105 Test Loss: 4.739 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.2724802
	speed: 0.2129s/iter; left time: 3654.9882s
	iters: 200, epoch: 18 | loss: 2.2716787
	speed: 0.0283s/iter; left time: 483.7371s
Epoch: 18 cost time: 7.399587631225586
Epoch: 18, Steps: 208 | Train Loss: 1.815 Vali Loss: 4.908 Vali Acc: 0.103 Test Loss: 4.908 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.2192550
	speed: 0.2103s/iter; left time: 3565.3158s
	iters: 200, epoch: 19 | loss: 1.2621982
	speed: 0.0327s/iter; left time: 550.5221s
Epoch: 19 cost time: 7.830813646316528
Epoch: 19, Steps: 208 | Train Loss: 1.761 Vali Loss: 4.964 Vali Acc: 0.103 Test Loss: 4.964 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.4933105
	speed: 0.2015s/iter; left time: 3374.3950s
	iters: 200, epoch: 20 | loss: 2.0685260
	speed: 0.0291s/iter; left time: 484.9212s
Epoch: 20 cost time: 6.797086000442505
Epoch: 20, Steps: 208 | Train Loss: 1.684 Vali Loss: 5.054 Vali Acc: 0.105 Test Loss: 5.054 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.9622153
	speed: 0.2079s/iter; left time: 3438.5666s
	iters: 200, epoch: 21 | loss: 1.6735814
	speed: 0.0276s/iter; left time: 453.0868s
Epoch: 21 cost time: 6.737751483917236
Epoch: 21, Steps: 208 | Train Loss: 1.651 Vali Loss: 5.243 Vali Acc: 0.105 Test Loss: 5.243 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.7726201
	speed: 0.2032s/iter; left time: 3318.3145s
	iters: 200, epoch: 22 | loss: 1.8045055
	speed: 0.0317s/iter; left time: 515.2318s
Epoch: 22 cost time: 7.35561990737915
Epoch: 22, Steps: 208 | Train Loss: 1.587 Vali Loss: 5.307 Vali Acc: 0.107 Test Loss: 5.307 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.4843943
	speed: 0.2005s/iter; left time: 3233.3048s
	iters: 200, epoch: 23 | loss: 1.5926086
	speed: 0.0291s/iter; left time: 466.6028s
Epoch: 23 cost time: 6.997249603271484
Epoch: 23, Steps: 208 | Train Loss: 1.551 Vali Loss: 5.448 Vali Acc: 0.106 Test Loss: 5.448 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.5694950
	speed: 0.2132s/iter; left time: 3393.9354s
	iters: 200, epoch: 24 | loss: 1.2723575
	speed: 0.0321s/iter; left time: 507.5266s
Epoch: 24 cost time: 7.8417699337005615
Epoch: 24, Steps: 208 | Train Loss: 1.513 Vali Loss: 5.580 Vali Acc: 0.102 Test Loss: 5.580 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11064718162839249
model parameter : 136231
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6454861
	speed: 0.0618s/iter; left time: 1279.2355s
	iters: 200, epoch: 1 | loss: 3.9773407
	speed: 0.0308s/iter; left time: 635.2806s
Epoch: 1 cost time: 9.61097764968872
Epoch: 1, Steps: 208 | Train Loss: 3.767 Vali Loss: 3.712 Vali Acc: 0.054 Test Loss: 3.712 Test Acc: 0.054
Validation loss decreased (inf --> -0.054243).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5691338
	speed: 0.2330s/iter; left time: 4775.0145s
	iters: 200, epoch: 2 | loss: 3.7409973
	speed: 0.0332s/iter; left time: 677.3123s
Epoch: 2 cost time: 7.663397312164307
Epoch: 2, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.768 Vali Acc: 0.058 Test Loss: 3.768 Test Acc: 0.058
Validation loss decreased (-0.054243 --> -0.058119).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6280875
	speed: 0.2170s/iter; left time: 4401.4810s
	iters: 200, epoch: 3 | loss: 3.8646502
	speed: 0.0322s/iter; left time: 649.1350s
Epoch: 3 cost time: 7.5989670753479
Epoch: 3, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.780 Vali Acc: 0.067 Test Loss: 3.780 Test Acc: 0.067
Validation loss decreased (-0.058119 --> -0.066470).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0470729
	speed: 0.1987s/iter; left time: 3989.1232s
	iters: 200, epoch: 4 | loss: 3.4028981
	speed: 0.0329s/iter; left time: 656.4748s
Epoch: 4 cost time: 7.5446083545684814
Epoch: 4, Steps: 208 | Train Loss: 3.244 Vali Loss: 3.756 Vali Acc: 0.076 Test Loss: 3.756 Test Acc: 0.076
Validation loss decreased (-0.066470 --> -0.076312).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3583403
	speed: 0.2023s/iter; left time: 4020.0959s
	iters: 200, epoch: 5 | loss: 2.9673777
	speed: 0.0324s/iter; left time: 641.2285s
Epoch: 5 cost time: 7.538646459579468
Epoch: 5, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.724 Vali Acc: 0.075 Test Loss: 3.724 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.3495176
	speed: 0.1965s/iter; left time: 3864.0270s
	iters: 200, epoch: 6 | loss: 2.9590774
	speed: 0.0316s/iter; left time: 618.4153s
Epoch: 6 cost time: 7.01685357093811
Epoch: 6, Steps: 208 | Train Loss: 2.991 Vali Loss: 3.782 Vali Acc: 0.084 Test Loss: 3.782 Test Acc: 0.084
Validation loss decreased (-0.076312 --> -0.084364).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6511300
	speed: 0.2010s/iter; left time: 3910.6320s
	iters: 200, epoch: 7 | loss: 3.0357587
	speed: 0.0316s/iter; left time: 611.2637s
Epoch: 7 cost time: 7.088595390319824
Epoch: 7, Steps: 208 | Train Loss: 2.895 Vali Loss: 3.714 Vali Acc: 0.095 Test Loss: 3.714 Test Acc: 0.095
Validation loss decreased (-0.084364 --> -0.095400).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3719313
	speed: 0.1989s/iter; left time: 3828.0595s
	iters: 200, epoch: 8 | loss: 2.5449388
	speed: 0.0282s/iter; left time: 540.6396s
Epoch: 8 cost time: 6.76254415512085
Epoch: 8, Steps: 208 | Train Loss: 2.788 Vali Loss: 3.798 Vali Acc: 0.094 Test Loss: 3.798 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.6385629
	speed: 0.2158s/iter; left time: 4107.9802s
	iters: 200, epoch: 9 | loss: 2.9715660
	speed: 0.0335s/iter; left time: 634.7999s
Epoch: 9 cost time: 7.783555746078491
Epoch: 9, Steps: 208 | Train Loss: 2.738 Vali Loss: 3.811 Vali Acc: 0.092 Test Loss: 3.811 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.5050683
	speed: 0.2059s/iter; left time: 3876.8382s
	iters: 200, epoch: 10 | loss: 2.3316905
	speed: 0.0288s/iter; left time: 539.3020s
Epoch: 10 cost time: 6.887429714202881
Epoch: 10, Steps: 208 | Train Loss: 2.643 Vali Loss: 3.864 Vali Acc: 0.098 Test Loss: 3.864 Test Acc: 0.098
Validation loss decreased (-0.095400 --> -0.097784).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.7890916
	speed: 0.2122s/iter; left time: 3952.1869s
	iters: 200, epoch: 11 | loss: 2.5237861
	speed: 0.0355s/iter; left time: 657.9305s
Epoch: 11 cost time: 7.578438997268677
Epoch: 11, Steps: 208 | Train Loss: 2.551 Vali Loss: 3.825 Vali Acc: 0.103 Test Loss: 3.825 Test Acc: 0.103
Validation loss decreased (-0.097784 --> -0.103153).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4972126
	speed: 0.2124s/iter; left time: 3911.8407s
	iters: 200, epoch: 12 | loss: 2.7443264
	speed: 0.0295s/iter; left time: 539.9145s
Epoch: 12 cost time: 7.107527494430542
Epoch: 12, Steps: 208 | Train Loss: 2.488 Vali Loss: 3.902 Vali Acc: 0.098 Test Loss: 3.902 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3795364
	speed: 0.2063s/iter; left time: 3755.4463s
	iters: 200, epoch: 13 | loss: 2.8201551
	speed: 0.0248s/iter; left time: 448.7709s
Epoch: 13 cost time: 6.3334105014801025
Epoch: 13, Steps: 208 | Train Loss: 2.423 Vali Loss: 3.938 Vali Acc: 0.102 Test Loss: 3.938 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.5919111
	speed: 0.2145s/iter; left time: 3860.2572s
	iters: 200, epoch: 14 | loss: 2.5248966
	speed: 0.0298s/iter; left time: 533.4366s
Epoch: 14 cost time: 6.861304998397827
Epoch: 14, Steps: 208 | Train Loss: 2.377 Vali Loss: 3.979 Vali Acc: 0.105 Test Loss: 3.979 Test Acc: 0.105
Validation loss decreased (-0.103153 --> -0.104643).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.6271367
	speed: 0.2137s/iter; left time: 3801.9830s
	iters: 200, epoch: 15 | loss: 2.3714478
	speed: 0.0335s/iter; left time: 591.8939s
Epoch: 15 cost time: 7.551308870315552
Epoch: 15, Steps: 208 | Train Loss: 2.331 Vali Loss: 4.023 Vali Acc: 0.102 Test Loss: 4.023 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.7117990
	speed: 0.2195s/iter; left time: 3858.1614s
	iters: 200, epoch: 16 | loss: 3.0580039
	speed: 0.0314s/iter; left time: 548.4703s
Epoch: 16 cost time: 7.229079961776733
Epoch: 16, Steps: 208 | Train Loss: 2.272 Vali Loss: 4.124 Vali Acc: 0.106 Test Loss: 4.124 Test Acc: 0.106
Validation loss decreased (-0.104643 --> -0.106132).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.4519448
	speed: 0.2317s/iter; left time: 4026.0066s
	iters: 200, epoch: 17 | loss: 2.7245746
	speed: 0.0353s/iter; left time: 609.2435s
Epoch: 17 cost time: 7.883054971694946
Epoch: 17, Steps: 208 | Train Loss: 2.224 Vali Loss: 4.240 Vali Acc: 0.104 Test Loss: 4.240 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.7264521
	speed: 0.2340s/iter; left time: 4016.9045s
	iters: 200, epoch: 18 | loss: 2.2446294
	speed: 0.0376s/iter; left time: 641.8319s
Epoch: 18 cost time: 8.653865814208984
Epoch: 18, Steps: 208 | Train Loss: 2.149 Vali Loss: 4.260 Vali Acc: 0.110 Test Loss: 4.260 Test Acc: 0.110
Validation loss decreased (-0.106132 --> -0.109710).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.2166777
	speed: 0.2317s/iter; left time: 3928.8752s
	iters: 200, epoch: 19 | loss: 1.9933474
	speed: 0.0315s/iter; left time: 531.2949s
Epoch: 19 cost time: 7.555669069290161
Epoch: 19, Steps: 208 | Train Loss: 2.105 Vali Loss: 4.373 Vali Acc: 0.098 Test Loss: 4.373 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.7139618
	speed: 0.2369s/iter; left time: 3967.1760s
	iters: 200, epoch: 20 | loss: 2.7439013
	speed: 0.0318s/iter; left time: 529.5372s
Epoch: 20 cost time: 7.69835638999939
Epoch: 20, Steps: 208 | Train Loss: 2.066 Vali Loss: 4.389 Vali Acc: 0.098 Test Loss: 4.389 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.8917612
	speed: 0.2244s/iter; left time: 3712.5099s
	iters: 200, epoch: 21 | loss: 3.2827504
	speed: 0.0327s/iter; left time: 537.4674s
Epoch: 21 cost time: 7.4920594692230225
Epoch: 21, Steps: 208 | Train Loss: 2.015 Vali Loss: 4.478 Vali Acc: 0.104 Test Loss: 4.478 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4806676
	speed: 0.2237s/iter; left time: 3653.6466s
	iters: 200, epoch: 22 | loss: 1.8667678
	speed: 0.0324s/iter; left time: 525.9496s
Epoch: 22 cost time: 7.6032867431640625
Epoch: 22, Steps: 208 | Train Loss: 1.998 Vali Loss: 4.528 Vali Acc: 0.104 Test Loss: 4.528 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.8787545
	speed: 0.2205s/iter; left time: 3555.5601s
	iters: 200, epoch: 23 | loss: 1.8397257
	speed: 0.0309s/iter; left time: 494.9565s
Epoch: 23 cost time: 7.311166524887085
Epoch: 23, Steps: 208 | Train Loss: 1.952 Vali Loss: 4.628 Vali Acc: 0.102 Test Loss: 4.628 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.6586874
	speed: 0.1970s/iter; left time: 3136.3259s
	iters: 200, epoch: 24 | loss: 2.5492587
	speed: 0.0273s/iter; left time: 431.0514s
Epoch: 24 cost time: 6.479922771453857
Epoch: 24, Steps: 208 | Train Loss: 1.916 Vali Loss: 4.654 Vali Acc: 0.107 Test Loss: 4.654 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.4070597
	speed: 0.2086s/iter; left time: 3277.5822s
	iters: 200, epoch: 25 | loss: 1.7633206
	speed: 0.0316s/iter; left time: 493.5032s
Epoch: 25 cost time: 7.309565782546997
Epoch: 25, Steps: 208 | Train Loss: 1.852 Vali Loss: 4.750 Vali Acc: 0.107 Test Loss: 4.750 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.6402041
	speed: 0.2088s/iter; left time: 3237.2786s
	iters: 200, epoch: 26 | loss: 1.5178237
	speed: 0.0310s/iter; left time: 477.0756s
Epoch: 26 cost time: 7.588130474090576
Epoch: 26, Steps: 208 | Train Loss: 1.834 Vali Loss: 4.825 Vali Acc: 0.100 Test Loss: 4.825 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.2037435
	speed: 0.2059s/iter; left time: 3149.4051s
	iters: 200, epoch: 27 | loss: 1.7746136
	speed: 0.0264s/iter; left time: 400.3688s
Epoch: 27 cost time: 6.624932765960693
Epoch: 27, Steps: 208 | Train Loss: 1.793 Vali Loss: 4.897 Vali Acc: 0.104 Test Loss: 4.897 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.4071324
	speed: 0.2085s/iter; left time: 3144.7725s
	iters: 200, epoch: 28 | loss: 1.4649581
	speed: 0.0315s/iter; left time: 471.8894s
Epoch: 28 cost time: 7.976611137390137
Epoch: 28, Steps: 208 | Train Loss: 1.761 Vali Loss: 4.979 Vali Acc: 0.105 Test Loss: 4.979 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10975246048314942
model parameter : 88359
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7582011
	speed: 0.0679s/iter; left time: 1406.1024s
	iters: 200, epoch: 1 | loss: 3.2268038
	speed: 0.0283s/iter; left time: 582.4042s
Epoch: 1 cost time: 9.866257429122925
Epoch: 1, Steps: 208 | Train Loss: 3.770 Vali Loss: 3.694 Vali Acc: 0.051 Test Loss: 3.694 Test Acc: 0.051
Validation loss decreased (inf --> -0.051260).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3602526
	speed: 0.2123s/iter; left time: 4350.3879s
	iters: 200, epoch: 2 | loss: 3.8989165
	speed: 0.0317s/iter; left time: 646.8003s
Epoch: 2 cost time: 7.0747129917144775
Epoch: 2, Steps: 208 | Train Loss: 3.594 Vali Loss: 3.764 Vali Acc: 0.055 Test Loss: 3.764 Test Acc: 0.055
Validation loss decreased (-0.051260 --> -0.054540).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5714869
	speed: 0.2254s/iter; left time: 4571.7305s
	iters: 200, epoch: 3 | loss: 3.4424853
	speed: 0.0333s/iter; left time: 671.9119s
Epoch: 3 cost time: 7.721353054046631
Epoch: 3, Steps: 208 | Train Loss: 3.476 Vali Loss: 3.757 Vali Acc: 0.061 Test Loss: 3.757 Test Acc: 0.061
Validation loss decreased (-0.054540 --> -0.060505).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9347253
	speed: 0.2286s/iter; left time: 4589.2408s
	iters: 200, epoch: 4 | loss: 3.5237439
	speed: 0.0316s/iter; left time: 631.0147s
Epoch: 4 cost time: 7.547711372375488
Epoch: 4, Steps: 208 | Train Loss: 3.312 Vali Loss: 3.655 Vali Acc: 0.075 Test Loss: 3.655 Test Acc: 0.075
Validation loss decreased (-0.060505 --> -0.074822).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0642569
	speed: 0.2051s/iter; left time: 4075.5600s
	iters: 200, epoch: 5 | loss: 3.9059756
	speed: 0.0321s/iter; left time: 634.6059s
Epoch: 5 cost time: 7.65195894241333
Epoch: 5, Steps: 208 | Train Loss: 3.180 Vali Loss: 3.672 Vali Acc: 0.079 Test Loss: 3.672 Test Acc: 0.079
Validation loss decreased (-0.074822 --> -0.079295).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4475491
	speed: 0.2166s/iter; left time: 4259.1662s
	iters: 200, epoch: 6 | loss: 3.0669861
	speed: 0.0307s/iter; left time: 600.5316s
Epoch: 6 cost time: 7.481734275817871
Epoch: 6, Steps: 208 | Train Loss: 3.073 Vali Loss: 3.693 Vali Acc: 0.081 Test Loss: 3.693 Test Acc: 0.081
Validation loss decreased (-0.079295 --> -0.081084).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0397739
	speed: 0.2198s/iter; left time: 4275.4963s
	iters: 200, epoch: 7 | loss: 2.8052456
	speed: 0.0306s/iter; left time: 592.5757s
Epoch: 7 cost time: 7.645970344543457
Epoch: 7, Steps: 208 | Train Loss: 2.978 Vali Loss: 3.695 Vali Acc: 0.084 Test Loss: 3.695 Test Acc: 0.084
Validation loss decreased (-0.081084 --> -0.083769).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8810356
	speed: 0.2160s/iter; left time: 4156.1834s
	iters: 200, epoch: 8 | loss: 2.9820423
	speed: 0.0350s/iter; left time: 670.8272s
Epoch: 8 cost time: 7.873772144317627
Epoch: 8, Steps: 208 | Train Loss: 2.910 Vali Loss: 3.729 Vali Acc: 0.080 Test Loss: 3.729 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.3240552
	speed: 0.1991s/iter; left time: 3790.2516s
	iters: 200, epoch: 9 | loss: 2.7733972
	speed: 0.0335s/iter; left time: 633.5156s
Epoch: 9 cost time: 7.616482257843018
Epoch: 9, Steps: 208 | Train Loss: 2.855 Vali Loss: 3.724 Vali Acc: 0.092 Test Loss: 3.724 Test Acc: 0.092
Validation loss decreased (-0.083769 --> -0.091821).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.1149580
	speed: 0.2076s/iter; left time: 3909.2281s
	iters: 200, epoch: 10 | loss: 3.3072603
	speed: 0.0325s/iter; left time: 609.1972s
Epoch: 10 cost time: 7.817595958709717
Epoch: 10, Steps: 208 | Train Loss: 2.779 Vali Loss: 3.727 Vali Acc: 0.084 Test Loss: 3.727 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.6459062
	speed: 0.2170s/iter; left time: 4041.3782s
	iters: 200, epoch: 11 | loss: 2.5026953
	speed: 0.0365s/iter; left time: 676.6691s
Epoch: 11 cost time: 8.429754734039307
Epoch: 11, Steps: 208 | Train Loss: 2.724 Vali Loss: 3.748 Vali Acc: 0.093 Test Loss: 3.748 Test Acc: 0.093
Validation loss decreased (-0.091821 --> -0.092715).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.8971515
	speed: 0.2278s/iter; left time: 4194.9682s
	iters: 200, epoch: 12 | loss: 2.7280967
	speed: 0.0315s/iter; left time: 577.3032s
Epoch: 12 cost time: 8.04432725906372
Epoch: 12, Steps: 208 | Train Loss: 2.641 Vali Loss: 3.804 Vali Acc: 0.096 Test Loss: 3.804 Test Acc: 0.096
Validation loss decreased (-0.092715 --> -0.095697).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.6793847
	speed: 0.2234s/iter; left time: 4066.3915s
	iters: 200, epoch: 13 | loss: 3.0077186
	speed: 0.0261s/iter; left time: 472.0767s
Epoch: 13 cost time: 6.790472507476807
Epoch: 13, Steps: 208 | Train Loss: 2.591 Vali Loss: 3.783 Vali Acc: 0.100 Test Loss: 3.783 Test Acc: 0.100
Validation loss decreased (-0.095697 --> -0.100171).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.5010052
	speed: 0.2142s/iter; left time: 3854.6521s
	iters: 200, epoch: 14 | loss: 2.3471301
	speed: 0.0324s/iter; left time: 579.8032s
Epoch: 14 cost time: 7.882092475891113
Epoch: 14, Steps: 208 | Train Loss: 2.552 Vali Loss: 3.904 Vali Acc: 0.090 Test Loss: 3.904 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 3.0566003
	speed: 0.2210s/iter; left time: 3931.7169s
	iters: 200, epoch: 15 | loss: 2.3726645
	speed: 0.0281s/iter; left time: 496.8225s
Epoch: 15 cost time: 7.116229772567749
Epoch: 15, Steps: 208 | Train Loss: 2.483 Vali Loss: 3.881 Vali Acc: 0.101 Test Loss: 3.881 Test Acc: 0.101
Validation loss decreased (-0.100171 --> -0.101363).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.7513630
	speed: 0.2261s/iter; left time: 3974.6584s
	iters: 200, epoch: 16 | loss: 2.2685118
	speed: 0.0296s/iter; left time: 516.5674s
Epoch: 16 cost time: 7.331055402755737
Epoch: 16, Steps: 208 | Train Loss: 2.434 Vali Loss: 3.882 Vali Acc: 0.101 Test Loss: 3.882 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.0538158
	speed: 0.2307s/iter; left time: 4007.1366s
	iters: 200, epoch: 17 | loss: 2.3827207
	speed: 0.0325s/iter; left time: 560.6557s
Epoch: 17 cost time: 7.840122938156128
Epoch: 17, Steps: 208 | Train Loss: 2.390 Vali Loss: 3.990 Vali Acc: 0.101 Test Loss: 3.990 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.2581713
	speed: 0.2403s/iter; left time: 4125.0762s
	iters: 200, epoch: 18 | loss: 2.5922577
	speed: 0.0362s/iter; left time: 617.5056s
Epoch: 18 cost time: 8.87632155418396
Epoch: 18, Steps: 208 | Train Loss: 2.357 Vali Loss: 3.951 Vali Acc: 0.105 Test Loss: 3.951 Test Acc: 0.105
Validation loss decreased (-0.101363 --> -0.105239).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.7728294
	speed: 0.2478s/iter; left time: 4202.1369s
	iters: 200, epoch: 19 | loss: 2.8462365
	speed: 0.0392s/iter; left time: 661.3369s
Epoch: 19 cost time: 8.969101667404175
Epoch: 19, Steps: 208 | Train Loss: 2.318 Vali Loss: 4.009 Vali Acc: 0.102 Test Loss: 4.009 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.2491772
	speed: 0.2449s/iter; left time: 4101.1874s
	iters: 200, epoch: 20 | loss: 1.9327036
	speed: 0.0373s/iter; left time: 620.9840s
Epoch: 20 cost time: 9.552855730056763
Epoch: 20, Steps: 208 | Train Loss: 2.274 Vali Loss: 4.135 Vali Acc: 0.101 Test Loss: 4.135 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.2267826
	speed: 0.2320s/iter; left time: 3837.8995s
	iters: 200, epoch: 21 | loss: 2.3858099
	speed: 0.0338s/iter; left time: 556.5180s
Epoch: 21 cost time: 7.695669412612915
Epoch: 21, Steps: 208 | Train Loss: 2.212 Vali Loss: 4.154 Vali Acc: 0.099 Test Loss: 4.154 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.6736897
	speed: 0.2125s/iter; left time: 3471.2398s
	iters: 200, epoch: 22 | loss: 2.1972322
	speed: 0.0325s/iter; left time: 527.5123s
Epoch: 22 cost time: 7.978222846984863
Epoch: 22, Steps: 208 | Train Loss: 2.188 Vali Loss: 4.195 Vali Acc: 0.114 Test Loss: 4.195 Test Acc: 0.114
Validation loss decreased (-0.105239 --> -0.114184).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.4978778
	speed: 0.2146s/iter; left time: 3460.9522s
	iters: 200, epoch: 23 | loss: 1.9990983
	speed: 0.0314s/iter; left time: 502.8331s
Epoch: 23 cost time: 7.739012002944946
Epoch: 23, Steps: 208 | Train Loss: 2.174 Vali Loss: 4.235 Vali Acc: 0.112 Test Loss: 4.235 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 2.0354810
	speed: 0.2108s/iter; left time: 3354.6905s
	iters: 200, epoch: 24 | loss: 1.7949888
	speed: 0.0318s/iter; left time: 502.9461s
Epoch: 24 cost time: 7.57465386390686
Epoch: 24, Steps: 208 | Train Loss: 2.112 Vali Loss: 4.317 Vali Acc: 0.108 Test Loss: 4.317 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 2.2268183
	speed: 0.2140s/iter; left time: 3361.0762s
	iters: 200, epoch: 25 | loss: 2.2234354
	speed: 0.0326s/iter; left time: 509.1935s
Epoch: 25 cost time: 7.7534801959991455
Epoch: 25, Steps: 208 | Train Loss: 2.095 Vali Loss: 4.402 Vali Acc: 0.099 Test Loss: 4.402 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 2.1420434
	speed: 0.2217s/iter; left time: 3436.3685s
	iters: 200, epoch: 26 | loss: 1.5213993
	speed: 0.0319s/iter; left time: 491.8438s
Epoch: 26 cost time: 7.382827043533325
Epoch: 26, Steps: 208 | Train Loss: 2.074 Vali Loss: 4.449 Vali Acc: 0.103 Test Loss: 4.449 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 2.4130952
	speed: 0.2187s/iter; left time: 3345.1893s
	iters: 200, epoch: 27 | loss: 2.7095380
	speed: 0.0351s/iter; left time: 533.4671s
Epoch: 27 cost time: 7.844388723373413
Epoch: 27, Steps: 208 | Train Loss: 2.033 Vali Loss: 4.488 Vali Acc: 0.103 Test Loss: 4.488 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 2.0199344
	speed: 0.2272s/iter; left time: 3426.5600s
	iters: 200, epoch: 28 | loss: 2.2578542
	speed: 0.0311s/iter; left time: 466.0354s
Epoch: 28 cost time: 7.5930469036102295
Epoch: 28, Steps: 208 | Train Loss: 1.990 Vali Loss: 4.557 Vali Acc: 0.103 Test Loss: 4.557 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.5833939
	speed: 0.2214s/iter; left time: 3294.3855s
	iters: 200, epoch: 29 | loss: 2.8589849
	speed: 0.0287s/iter; left time: 424.5352s
Epoch: 29 cost time: 7.195412874221802
Epoch: 29, Steps: 208 | Train Loss: 1.984 Vali Loss: 4.583 Vali Acc: 0.100 Test Loss: 4.583 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 2.5383859
	speed: 0.2156s/iter; left time: 3162.9237s
	iters: 200, epoch: 30 | loss: 2.8175416
	speed: 0.0367s/iter; left time: 535.0373s
Epoch: 30 cost time: 7.9789719581604
Epoch: 30, Steps: 208 | Train Loss: 1.974 Vali Loss: 4.669 Vali Acc: 0.100 Test Loss: 4.669 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.1680614
	speed: 0.2300s/iter; left time: 3326.7029s
	iters: 200, epoch: 31 | loss: 2.4448285
	speed: 0.0305s/iter; left time: 438.3211s
Epoch: 31 cost time: 7.549632787704468
Epoch: 31, Steps: 208 | Train Loss: 1.915 Vali Loss: 4.738 Vali Acc: 0.098 Test Loss: 4.738 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.4971547
	speed: 0.2061s/iter; left time: 2938.2207s
	iters: 200, epoch: 32 | loss: 1.8169196
	speed: 0.0264s/iter; left time: 372.9897s
Epoch: 32 cost time: 6.438605546951294
Epoch: 32, Steps: 208 | Train Loss: 1.894 Vali Loss: 4.783 Vali Acc: 0.098 Test Loss: 4.783 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11422606620936475
model parameter : 67943
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8645983
	speed: 0.0656s/iter; left time: 1358.0142s
	iters: 200, epoch: 1 | loss: 3.5942032
	speed: 0.0326s/iter; left time: 671.3446s
Epoch: 1 cost time: 10.181188821792603
Epoch: 1, Steps: 208 | Train Loss: 3.757 Vali Loss: 3.683 Vali Acc: 0.049 Test Loss: 3.683 Test Acc: 0.049
Validation loss decreased (inf --> -0.048875).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4408479
	speed: 0.2145s/iter; left time: 4395.8560s
	iters: 200, epoch: 2 | loss: 3.2825589
	speed: 0.0319s/iter; left time: 650.7343s
Epoch: 2 cost time: 7.683345556259155
Epoch: 2, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.706 Vali Acc: 0.055 Test Loss: 3.706 Test Acc: 0.055
Validation loss decreased (-0.048875 --> -0.054541).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9471469
	speed: 0.2242s/iter; left time: 4548.5282s
	iters: 200, epoch: 3 | loss: 3.5888724
	speed: 0.0342s/iter; left time: 690.4202s
Epoch: 3 cost time: 7.963188171386719
Epoch: 3, Steps: 208 | Train Loss: 3.510 Vali Loss: 3.731 Vali Acc: 0.058 Test Loss: 3.731 Test Acc: 0.058
Validation loss decreased (-0.054541 --> -0.058120).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5731311
	speed: 0.2286s/iter; left time: 4590.5863s
	iters: 200, epoch: 4 | loss: 4.2416048
	speed: 0.0356s/iter; left time: 711.4580s
Epoch: 4 cost time: 7.8182532787323
Epoch: 4, Steps: 208 | Train Loss: 3.409 Vali Loss: 3.689 Vali Acc: 0.067 Test Loss: 3.689 Test Acc: 0.067
Validation loss decreased (-0.058120 --> -0.067067).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8773313
	speed: 0.2440s/iter; left time: 4848.6449s
	iters: 200, epoch: 5 | loss: 3.9456072
	speed: 0.0342s/iter; left time: 675.8472s
Epoch: 5 cost time: 8.77902603149414
Epoch: 5, Steps: 208 | Train Loss: 3.257 Vali Loss: 3.638 Vali Acc: 0.070 Test Loss: 3.638 Test Acc: 0.070
Validation loss decreased (-0.067067 --> -0.070050).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3839824
	speed: 0.2539s/iter; left time: 4992.8573s
	iters: 200, epoch: 6 | loss: 2.8566535
	speed: 0.0366s/iter; left time: 716.6405s
Epoch: 6 cost time: 8.82216739654541
Epoch: 6, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.635 Vali Acc: 0.074 Test Loss: 3.635 Test Acc: 0.074
Validation loss decreased (-0.070050 --> -0.073629).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7594442
	speed: 0.2544s/iter; left time: 4948.7949s
	iters: 200, epoch: 7 | loss: 3.2735465
	speed: 0.0355s/iter; left time: 686.4184s
Epoch: 7 cost time: 8.935540676116943
Epoch: 7, Steps: 208 | Train Loss: 3.058 Vali Loss: 3.661 Vali Acc: 0.079 Test Loss: 3.661 Test Acc: 0.079
Validation loss decreased (-0.073629 --> -0.079295).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4566164
	speed: 0.2547s/iter; left time: 4901.0288s
	iters: 200, epoch: 8 | loss: 2.8651097
	speed: 0.0340s/iter; left time: 651.2869s
Epoch: 8 cost time: 8.022263050079346
Epoch: 8, Steps: 208 | Train Loss: 2.968 Vali Loss: 3.657 Vali Acc: 0.087 Test Loss: 3.657 Test Acc: 0.087
Validation loss decreased (-0.079295 --> -0.087050).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0521517
	speed: 0.2569s/iter; left time: 4890.7232s
	iters: 200, epoch: 9 | loss: 3.2425830
	speed: 0.0346s/iter; left time: 654.7829s
Epoch: 9 cost time: 8.400426149368286
Epoch: 9, Steps: 208 | Train Loss: 2.903 Vali Loss: 3.698 Vali Acc: 0.088 Test Loss: 3.698 Test Acc: 0.088
Validation loss decreased (-0.087050 --> -0.088242).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5964842
	speed: 0.2396s/iter; left time: 4510.5030s
	iters: 200, epoch: 10 | loss: 3.2629988
	speed: 0.0348s/iter; left time: 651.8810s
Epoch: 10 cost time: 8.174952507019043
Epoch: 10, Steps: 208 | Train Loss: 2.837 Vali Loss: 3.702 Vali Acc: 0.084 Test Loss: 3.702 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.8230031
	speed: 0.2353s/iter; left time: 4381.5852s
	iters: 200, epoch: 11 | loss: 3.1615260
	speed: 0.0321s/iter; left time: 595.4474s
Epoch: 11 cost time: 8.073979616165161
Epoch: 11, Steps: 208 | Train Loss: 2.773 Vali Loss: 3.723 Vali Acc: 0.089 Test Loss: 3.723 Test Acc: 0.089
Validation loss decreased (-0.088242 --> -0.088838).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.0436471
	speed: 0.2368s/iter; left time: 4360.7144s
	iters: 200, epoch: 12 | loss: 3.1754401
	speed: 0.0306s/iter; left time: 560.0158s
Epoch: 12 cost time: 7.367019891738892
Epoch: 12, Steps: 208 | Train Loss: 2.713 Vali Loss: 3.712 Vali Acc: 0.091 Test Loss: 3.712 Test Acc: 0.091
Validation loss decreased (-0.088838 --> -0.091224).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.7158830
	speed: 0.2391s/iter; left time: 4352.8321s
	iters: 200, epoch: 13 | loss: 2.9376202
	speed: 0.0342s/iter; left time: 619.5578s
Epoch: 13 cost time: 8.128856658935547
Epoch: 13, Steps: 208 | Train Loss: 2.689 Vali Loss: 3.773 Vali Acc: 0.085 Test Loss: 3.773 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.6979847
	speed: 0.2344s/iter; left time: 4217.9243s
	iters: 200, epoch: 14 | loss: 2.8541241
	speed: 0.0344s/iter; left time: 615.4779s
Epoch: 14 cost time: 8.434870481491089
Epoch: 14, Steps: 208 | Train Loss: 2.621 Vali Loss: 3.817 Vali Acc: 0.088 Test Loss: 3.817 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.8211403
	speed: 0.2323s/iter; left time: 4132.3966s
	iters: 200, epoch: 15 | loss: 2.2756598
	speed: 0.0274s/iter; left time: 485.4118s
Epoch: 15 cost time: 7.5058512687683105
Epoch: 15, Steps: 208 | Train Loss: 2.578 Vali Loss: 3.817 Vali Acc: 0.098 Test Loss: 3.817 Test Acc: 0.098
Validation loss decreased (-0.091224 --> -0.097486).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.1160135
	speed: 0.2265s/iter; left time: 3982.0329s
	iters: 200, epoch: 16 | loss: 1.9530587
	speed: 0.0286s/iter; left time: 499.2652s
Epoch: 16 cost time: 6.723050355911255
Epoch: 16, Steps: 208 | Train Loss: 2.528 Vali Loss: 3.858 Vali Acc: 0.093 Test Loss: 3.858 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.9479582
	speed: 0.2045s/iter; left time: 3552.5461s
	iters: 200, epoch: 17 | loss: 2.1439929
	speed: 0.0263s/iter; left time: 454.2251s
Epoch: 17 cost time: 6.746109485626221
Epoch: 17, Steps: 208 | Train Loss: 2.498 Vali Loss: 3.911 Vali Acc: 0.101 Test Loss: 3.911 Test Acc: 0.101
Validation loss decreased (-0.097486 --> -0.100766).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.7166858
	speed: 0.2002s/iter; left time: 3437.2712s
	iters: 200, epoch: 18 | loss: 2.7778988
	speed: 0.0280s/iter; left time: 478.4547s
Epoch: 18 cost time: 7.098213195800781
Epoch: 18, Steps: 208 | Train Loss: 2.448 Vali Loss: 3.969 Vali Acc: 0.093 Test Loss: 3.969 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.5196383
	speed: 0.1920s/iter; left time: 3255.9956s
	iters: 200, epoch: 19 | loss: 3.1666327
	speed: 0.0246s/iter; left time: 415.2968s
Epoch: 19 cost time: 5.771840333938599
Epoch: 19, Steps: 208 | Train Loss: 2.409 Vali Loss: 3.968 Vali Acc: 0.096 Test Loss: 3.968 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 2.6483498
	speed: 0.1923s/iter; left time: 3220.1841s
	iters: 200, epoch: 20 | loss: 2.0774231
	speed: 0.0275s/iter; left time: 458.2087s
Epoch: 20 cost time: 6.335809946060181
Epoch: 20, Steps: 208 | Train Loss: 2.372 Vali Loss: 4.022 Vali Acc: 0.097 Test Loss: 4.022 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 2.4465642
	speed: 0.1852s/iter; left time: 3063.4693s
	iters: 200, epoch: 21 | loss: 2.6513431
	speed: 0.0243s/iter; left time: 400.0567s
Epoch: 21 cost time: 6.224756717681885
Epoch: 21, Steps: 208 | Train Loss: 2.338 Vali Loss: 4.074 Vali Acc: 0.100 Test Loss: 4.074 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 2.3917441
	speed: 0.1816s/iter; left time: 2965.6331s
	iters: 200, epoch: 22 | loss: 2.5177891
	speed: 0.0244s/iter; left time: 395.8389s
Epoch: 22 cost time: 6.402247667312622
Epoch: 22, Steps: 208 | Train Loss: 2.319 Vali Loss: 4.138 Vali Acc: 0.100 Test Loss: 4.138 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 2.1480947
	speed: 0.1726s/iter; left time: 2783.0679s
	iters: 200, epoch: 23 | loss: 1.6208724
	speed: 0.0225s/iter; left time: 360.6085s
Epoch: 23 cost time: 5.7212135791778564
Epoch: 23, Steps: 208 | Train Loss: 2.268 Vali Loss: 4.163 Vali Acc: 0.100 Test Loss: 4.163 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 2.3394811
	speed: 0.1776s/iter; left time: 2826.9903s
	iters: 200, epoch: 24 | loss: 1.7608937
	speed: 0.0239s/iter; left time: 378.7875s
Epoch: 24 cost time: 6.4839887619018555
Epoch: 24, Steps: 208 | Train Loss: 2.229 Vali Loss: 4.251 Vali Acc: 0.102 Test Loss: 4.251 Test Acc: 0.102
Validation loss decreased (-0.100766 --> -0.101657).  Saving model ...
	iters: 100, epoch: 25 | loss: 2.2340999
	speed: 0.1658s/iter; left time: 2605.3193s
	iters: 200, epoch: 25 | loss: 1.7793065
	speed: 0.0272s/iter; left time: 425.0631s
Epoch: 25 cost time: 6.332348585128784
Epoch: 25, Steps: 208 | Train Loss: 2.198 Vali Loss: 4.275 Vali Acc: 0.104 Test Loss: 4.275 Test Acc: 0.104
Validation loss decreased (-0.101657 --> -0.104043).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.7874786
	speed: 0.1661s/iter; left time: 2574.9823s
	iters: 200, epoch: 26 | loss: 1.6381760
	speed: 0.0254s/iter; left time: 390.6793s
Epoch: 26 cost time: 6.404693126678467
Epoch: 26, Steps: 208 | Train Loss: 2.193 Vali Loss: 4.335 Vali Acc: 0.100 Test Loss: 4.335 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.8439901
	speed: 0.1612s/iter; left time: 2464.5614s
	iters: 200, epoch: 27 | loss: 2.0568225
	speed: 0.0253s/iter; left time: 385.0081s
Epoch: 27 cost time: 6.036388635635376
Epoch: 27, Steps: 208 | Train Loss: 2.143 Vali Loss: 4.334 Vali Acc: 0.104 Test Loss: 4.334 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.6012584
	speed: 0.1994s/iter; left time: 3008.3798s
	iters: 200, epoch: 28 | loss: 2.4921448
	speed: 0.0277s/iter; left time: 415.6428s
Epoch: 28 cost time: 6.98684287071228
Epoch: 28, Steps: 208 | Train Loss: 2.108 Vali Loss: 4.398 Vali Acc: 0.101 Test Loss: 4.398 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.9160558
	speed: 0.2003s/iter; left time: 2979.9600s
	iters: 200, epoch: 29 | loss: 2.4033387
	speed: 0.0280s/iter; left time: 413.2166s
Epoch: 29 cost time: 6.594008207321167
Epoch: 29, Steps: 208 | Train Loss: 2.060 Vali Loss: 4.496 Vali Acc: 0.099 Test Loss: 4.496 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.9910307
	speed: 0.2121s/iter; left time: 3111.1451s
	iters: 200, epoch: 30 | loss: 1.3598952
	speed: 0.0294s/iter; left time: 428.2608s
Epoch: 30 cost time: 6.84853458404541
Epoch: 30, Steps: 208 | Train Loss: 2.042 Vali Loss: 4.539 Vali Acc: 0.102 Test Loss: 4.539 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 2.3908055
	speed: 0.2265s/iter; left time: 3276.0640s
	iters: 200, epoch: 31 | loss: 2.2878768
	speed: 0.0355s/iter; left time: 509.8510s
Epoch: 31 cost time: 8.501719951629639
Epoch: 31, Steps: 208 | Train Loss: 2.046 Vali Loss: 4.618 Vali Acc: 0.098 Test Loss: 4.618 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.9453295
	speed: 0.2343s/iter; left time: 3339.0550s
	iters: 200, epoch: 32 | loss: 1.9301199
	speed: 0.0383s/iter; left time: 542.6424s
Epoch: 32 cost time: 8.749914407730103
Epoch: 32, Steps: 208 | Train Loss: 2.007 Vali Loss: 4.670 Vali Acc: 0.104 Test Loss: 4.670 Test Acc: 0.104
Validation loss decreased (-0.104043 --> -0.104337).  Saving model ...
	iters: 100, epoch: 33 | loss: 2.6398787
	speed: 0.2494s/iter; left time: 3502.9917s
	iters: 200, epoch: 33 | loss: 1.9443550
	speed: 0.0325s/iter; left time: 453.3343s
Epoch: 33 cost time: 8.584131002426147
Epoch: 33, Steps: 208 | Train Loss: 1.976 Vali Loss: 4.670 Vali Acc: 0.102 Test Loss: 4.670 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.8001525
	speed: 0.2264s/iter; left time: 3132.1222s
	iters: 200, epoch: 34 | loss: 2.5021489
	speed: 0.0325s/iter; left time: 446.2461s
Epoch: 34 cost time: 7.567264556884766
Epoch: 34, Steps: 208 | Train Loss: 1.937 Vali Loss: 4.734 Vali Acc: 0.104 Test Loss: 4.734 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 1.7758641
	speed: 0.2246s/iter; left time: 3060.6779s
	iters: 200, epoch: 35 | loss: 1.6744605
	speed: 0.0301s/iter; left time: 407.4586s
Epoch: 35 cost time: 7.517995595932007
Epoch: 35, Steps: 208 | Train Loss: 1.932 Vali Loss: 4.815 Vali Acc: 0.110 Test Loss: 4.815 Test Acc: 0.110
Validation loss decreased (-0.104337 --> -0.109704).  Saving model ...
	iters: 100, epoch: 36 | loss: 2.6415353
	speed: 0.2419s/iter; left time: 3246.0546s
	iters: 200, epoch: 36 | loss: 1.9437150
	speed: 0.0361s/iter; left time: 480.5363s
Epoch: 36 cost time: 8.311473369598389
Epoch: 36, Steps: 208 | Train Loss: 1.921 Vali Loss: 4.860 Vali Acc: 0.103 Test Loss: 4.860 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.3776497
	speed: 0.2307s/iter; left time: 3048.2497s
	iters: 200, epoch: 37 | loss: 2.8413897
	speed: 0.0276s/iter; left time: 361.4442s
Epoch: 37 cost time: 7.0159220695495605
Epoch: 37, Steps: 208 | Train Loss: 1.925 Vali Loss: 4.891 Vali Acc: 0.099 Test Loss: 4.891 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.9252440
	speed: 0.2253s/iter; left time: 2930.1105s
	iters: 200, epoch: 38 | loss: 2.5160687
	speed: 0.0302s/iter; left time: 390.0553s
Epoch: 38 cost time: 7.362624168395996
Epoch: 38, Steps: 208 | Train Loss: 1.878 Vali Loss: 4.952 Vali Acc: 0.104 Test Loss: 4.952 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.9665556
	speed: 0.2203s/iter; left time: 2819.5112s
	iters: 200, epoch: 39 | loss: 2.5685186
	speed: 0.0277s/iter; left time: 351.6323s
Epoch: 39 cost time: 7.38525915145874
Epoch: 39, Steps: 208 | Train Loss: 1.862 Vali Loss: 4.984 Vali Acc: 0.104 Test Loss: 4.984 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 2.2270436
	speed: 0.2098s/iter; left time: 2641.7164s
	iters: 200, epoch: 40 | loss: 2.2371099
	speed: 0.0291s/iter; left time: 363.8276s
Epoch: 40 cost time: 7.076105833053589
Epoch: 40, Steps: 208 | Train Loss: 1.848 Vali Loss: 5.044 Vali Acc: 0.101 Test Loss: 5.044 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 2.2149980
	speed: 0.2108s/iter; left time: 2609.5995s
	iters: 200, epoch: 41 | loss: 1.9994950
	speed: 0.0286s/iter; left time: 350.6946s
Epoch: 41 cost time: 6.92700982093811
Epoch: 41, Steps: 208 | Train Loss: 1.803 Vali Loss: 5.059 Vali Acc: 0.101 Test Loss: 5.059 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 2.0206115
	speed: 0.2090s/iter; left time: 2544.5151s
	iters: 200, epoch: 42 | loss: 2.4810946
	speed: 0.0290s/iter; left time: 350.3339s
Epoch: 42 cost time: 6.964212417602539
Epoch: 42, Steps: 208 | Train Loss: 1.784 Vali Loss: 5.101 Vali Acc: 0.100 Test Loss: 5.101 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 2.1666315
	speed: 0.2060s/iter; left time: 2464.4613s
	iters: 200, epoch: 43 | loss: 2.6120710
	speed: 0.0273s/iter; left time: 323.9675s
Epoch: 43 cost time: 7.537028789520264
Epoch: 43, Steps: 208 | Train Loss: 1.794 Vali Loss: 5.205 Vali Acc: 0.101 Test Loss: 5.205 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 2.2007093
	speed: 0.1961s/iter; left time: 2305.2786s
	iters: 200, epoch: 44 | loss: 2.2355444
	speed: 0.0301s/iter; left time: 351.3117s
Epoch: 44 cost time: 7.223134756088257
Epoch: 44, Steps: 208 | Train Loss: 1.750 Vali Loss: 5.262 Vali Acc: 0.098 Test Loss: 5.262 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 1.6805279
	speed: 0.2219s/iter; left time: 2562.3462s
	iters: 200, epoch: 45 | loss: 2.0628884
	speed: 0.0286s/iter; left time: 327.0002s
Epoch: 45 cost time: 7.936345815658569
Epoch: 45, Steps: 208 | Train Loss: 1.733 Vali Loss: 5.343 Vali Acc: 0.104 Test Loss: 5.343 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df128_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10975246048314942
model parameter : 54391
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6867099
	speed: 0.0809s/iter; left time: 1674.5895s
	iters: 200, epoch: 1 | loss: 3.6610429
	speed: 0.0415s/iter; left time: 855.5385s
Epoch: 1 cost time: 12.724387884140015
Epoch: 1, Steps: 208 | Train Loss: 4.067 Vali Loss: 4.283 Vali Acc: 0.067 Test Loss: 4.283 Test Acc: 0.067
Validation loss decreased (inf --> -0.067061).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3605471
	speed: 0.2261s/iter; left time: 4634.4290s
	iters: 200, epoch: 2 | loss: 3.8709996
	speed: 0.0425s/iter; left time: 866.9248s
Epoch: 2 cost time: 9.829519033432007
Epoch: 2, Steps: 208 | Train Loss: 3.926 Vali Loss: 4.771 Vali Acc: 0.055 Test Loss: 4.771 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4031365
	speed: 0.2340s/iter; left time: 4746.4674s
	iters: 200, epoch: 3 | loss: 3.6938784
	speed: 0.0484s/iter; left time: 977.6110s
Epoch: 3 cost time: 10.558551788330078
Epoch: 3, Steps: 208 | Train Loss: 3.554 Vali Loss: 4.613 Vali Acc: 0.065 Test Loss: 4.613 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.6728373
	speed: 0.2319s/iter; left time: 4654.9930s
	iters: 200, epoch: 4 | loss: 3.2733536
	speed: 0.0472s/iter; left time: 943.2929s
Epoch: 4 cost time: 10.502101421356201
Epoch: 4, Steps: 208 | Train Loss: 3.148 Vali Loss: 4.926 Vali Acc: 0.061 Test Loss: 4.926 Test Acc: 0.061
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.8577385
	speed: 0.2344s/iter; left time: 4657.1958s
	iters: 200, epoch: 5 | loss: 2.1380115
	speed: 0.0403s/iter; left time: 797.5545s
Epoch: 5 cost time: 9.270832538604736
Epoch: 5, Steps: 208 | Train Loss: 2.873 Vali Loss: 4.659 Vali Acc: 0.089 Test Loss: 4.659 Test Acc: 0.089
Validation loss decreased (-0.067061 --> -0.088829).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7252095
	speed: 0.2586s/iter; left time: 5084.3819s
	iters: 200, epoch: 6 | loss: 3.5246418
	speed: 0.0544s/iter; left time: 1064.1099s
Epoch: 6 cost time: 11.71095061302185
Epoch: 6, Steps: 208 | Train Loss: 2.590 Vali Loss: 4.673 Vali Acc: 0.078 Test Loss: 4.673 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4067140
	speed: 0.2734s/iter; left time: 5318.0387s
	iters: 200, epoch: 7 | loss: 2.9775608
	speed: 0.0527s/iter; left time: 1020.7313s
Epoch: 7 cost time: 12.951607704162598
Epoch: 7, Steps: 208 | Train Loss: 2.231 Vali Loss: 5.047 Vali Acc: 0.089 Test Loss: 5.047 Test Acc: 0.089
Validation loss decreased (-0.088829 --> -0.089123).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4676208
	speed: 0.2721s/iter; left time: 5236.4506s
	iters: 200, epoch: 8 | loss: 2.0539100
	speed: 0.0407s/iter; left time: 780.0816s
Epoch: 8 cost time: 9.691268920898438
Epoch: 8, Steps: 208 | Train Loss: 2.021 Vali Loss: 4.898 Vali Acc: 0.093 Test Loss: 4.898 Test Acc: 0.093
Validation loss decreased (-0.089123 --> -0.093300).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9772410
	speed: 0.2646s/iter; left time: 5036.9863s
	iters: 200, epoch: 9 | loss: 2.4620428
	speed: 0.0412s/iter; left time: 780.9422s
Epoch: 9 cost time: 10.646364688873291
Epoch: 9, Steps: 208 | Train Loss: 1.817 Vali Loss: 4.951 Vali Acc: 0.104 Test Loss: 4.951 Test Acc: 0.104
Validation loss decreased (-0.093300 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5287988
	speed: 0.2537s/iter; left time: 4776.6432s
	iters: 200, epoch: 10 | loss: 1.8185346
	speed: 0.0401s/iter; left time: 750.7614s
Epoch: 10 cost time: 9.578995704650879
Epoch: 10, Steps: 208 | Train Loss: 1.600 Vali Loss: 5.486 Vali Acc: 0.101 Test Loss: 5.486 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0267267
	speed: 0.2526s/iter; left time: 4704.2493s
	iters: 200, epoch: 11 | loss: 1.3946421
	speed: 0.0405s/iter; left time: 750.8397s
Epoch: 11 cost time: 9.19136357307434
Epoch: 11, Steps: 208 | Train Loss: 1.507 Vali Loss: 5.682 Vali Acc: 0.097 Test Loss: 5.682 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0707306
	speed: 0.2526s/iter; left time: 4651.4194s
	iters: 200, epoch: 12 | loss: 2.0545189
	speed: 0.0381s/iter; left time: 696.8925s
Epoch: 12 cost time: 9.261176109313965
Epoch: 12, Steps: 208 | Train Loss: 1.293 Vali Loss: 6.087 Vali Acc: 0.106 Test Loss: 6.087 Test Acc: 0.106
Validation loss decreased (-0.104036 --> -0.105814).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3880469
	speed: 0.2492s/iter; left time: 4537.4887s
	iters: 200, epoch: 13 | loss: 1.3902026
	speed: 0.0454s/iter; left time: 821.4500s
Epoch: 13 cost time: 9.8006911277771
Epoch: 13, Steps: 208 | Train Loss: 1.171 Vali Loss: 6.375 Vali Acc: 0.108 Test Loss: 6.375 Test Acc: 0.108
Validation loss decreased (-0.105814 --> -0.107601).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4532330
	speed: 0.2520s/iter; left time: 4535.1642s
	iters: 200, epoch: 14 | loss: 1.5922878
	speed: 0.0399s/iter; left time: 713.8585s
Epoch: 14 cost time: 9.565689086914062
Epoch: 14, Steps: 208 | Train Loss: 1.017 Vali Loss: 6.696 Vali Acc: 0.117 Test Loss: 6.696 Test Acc: 0.117
Validation loss decreased (-0.107601 --> -0.116843).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8755943
	speed: 0.2430s/iter; left time: 4323.5707s
	iters: 200, epoch: 15 | loss: 1.1169498
	speed: 0.0461s/iter; left time: 815.3875s
Epoch: 15 cost time: 9.702085018157959
Epoch: 15, Steps: 208 | Train Loss: 0.899 Vali Loss: 7.212 Vali Acc: 0.112 Test Loss: 7.212 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4084196
	speed: 0.2575s/iter; left time: 4526.6080s
	iters: 200, epoch: 16 | loss: 0.7384377
	speed: 0.0425s/iter; left time: 742.2854s
Epoch: 16 cost time: 10.36427354812622
Epoch: 16, Steps: 208 | Train Loss: 0.806 Vali Loss: 7.719 Vali Acc: 0.113 Test Loss: 7.719 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1662079
	speed: 0.2548s/iter; left time: 4426.1417s
	iters: 200, epoch: 17 | loss: 0.7045221
	speed: 0.0479s/iter; left time: 827.6736s
Epoch: 17 cost time: 11.14237117767334
Epoch: 17, Steps: 208 | Train Loss: 0.731 Vali Loss: 8.271 Vali Acc: 0.119 Test Loss: 8.271 Test Acc: 0.119
Validation loss decreased (-0.116843 --> -0.118617).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1270894
	speed: 0.2477s/iter; left time: 4252.1405s
	iters: 200, epoch: 18 | loss: 0.8879312
	speed: 0.0520s/iter; left time: 886.6644s
Epoch: 18 cost time: 11.577535152435303
Epoch: 18, Steps: 208 | Train Loss: 0.629 Vali Loss: 8.623 Vali Acc: 0.117 Test Loss: 8.623 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2157788
	speed: 0.2274s/iter; left time: 3856.5918s
	iters: 200, epoch: 19 | loss: 0.7490724
	speed: 0.0531s/iter; left time: 895.9056s
Epoch: 19 cost time: 11.50159740447998
Epoch: 19, Steps: 208 | Train Loss: 0.567 Vali Loss: 8.987 Vali Acc: 0.107 Test Loss: 8.987 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.6991901
	speed: 0.2270s/iter; left time: 3801.3727s
	iters: 200, epoch: 20 | loss: 1.0447657
	speed: 0.0444s/iter; left time: 739.9128s
Epoch: 20 cost time: 10.306958675384521
Epoch: 20, Steps: 208 | Train Loss: 0.553 Vali Loss: 9.510 Vali Acc: 0.110 Test Loss: 9.510 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.5019390
	speed: 0.2429s/iter; left time: 4017.4326s
	iters: 200, epoch: 21 | loss: 0.3026714
	speed: 0.0444s/iter; left time: 730.2801s
Epoch: 21 cost time: 10.769508123397827
Epoch: 21, Steps: 208 | Train Loss: 0.476 Vali Loss: 9.790 Vali Acc: 0.103 Test Loss: 9.790 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.3180475
	speed: 0.2660s/iter; left time: 4345.3250s
	iters: 200, epoch: 22 | loss: 1.0399510
	speed: 0.0477s/iter; left time: 774.5798s
Epoch: 22 cost time: 11.667359828948975
Epoch: 22, Steps: 208 | Train Loss: 0.435 Vali Loss: 10.126 Vali Acc: 0.109 Test Loss: 10.126 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3752518
	speed: 0.2635s/iter; left time: 4249.7097s
	iters: 200, epoch: 23 | loss: 0.4823259
	speed: 0.0434s/iter; left time: 695.4870s
Epoch: 23 cost time: 10.403541564941406
Epoch: 23, Steps: 208 | Train Loss: 0.391 Vali Loss: 10.726 Vali Acc: 0.105 Test Loss: 10.726 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.5791821
	speed: 0.2397s/iter; left time: 3814.8126s
	iters: 200, epoch: 24 | loss: 0.5362561
	speed: 0.0342s/iter; left time: 540.6713s
Epoch: 24 cost time: 8.564677476882935
Epoch: 24, Steps: 208 | Train Loss: 0.429 Vali Loss: 11.008 Vali Acc: 0.105 Test Loss: 11.008 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.3204613
	speed: 0.2477s/iter; left time: 3890.9554s
	iters: 200, epoch: 25 | loss: 0.2182459
	speed: 0.0353s/iter; left time: 550.2640s
Epoch: 25 cost time: 8.357268571853638
Epoch: 25, Steps: 208 | Train Loss: 0.386 Vali Loss: 11.245 Vali Acc: 0.112 Test Loss: 11.245 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.5795222
	speed: 0.2381s/iter; left time: 3690.9934s
	iters: 200, epoch: 26 | loss: 0.2873687
	speed: 0.0380s/iter; left time: 584.6317s
Epoch: 26 cost time: 9.139039278030396
Epoch: 26, Steps: 208 | Train Loss: 0.362 Vali Loss: 11.749 Vali Acc: 0.106 Test Loss: 11.749 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.2455858
	speed: 0.2389s/iter; left time: 3653.1591s
	iters: 200, epoch: 27 | loss: 0.6259710
	speed: 0.0474s/iter; left time: 720.3919s
Epoch: 27 cost time: 10.805339813232422
Epoch: 27, Steps: 208 | Train Loss: 0.327 Vali Loss: 11.973 Vali Acc: 0.104 Test Loss: 11.973 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11869967193558008
model parameter : 497655
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1366673
	speed: 0.0616s/iter; left time: 1275.7955s
	iters: 200, epoch: 1 | loss: 3.9164577
	speed: 0.0318s/iter; left time: 655.9154s
Epoch: 1 cost time: 9.802995443344116
Epoch: 1, Steps: 208 | Train Loss: 3.891 Vali Loss: 4.059 Vali Acc: 0.049 Test Loss: 4.059 Test Acc: 0.049
Validation loss decreased (inf --> -0.049169).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3156700
	speed: 0.2194s/iter; left time: 4496.3673s
	iters: 200, epoch: 2 | loss: 3.7993684
	speed: 0.0347s/iter; left time: 707.9940s
Epoch: 2 cost time: 8.22586703300476
Epoch: 2, Steps: 208 | Train Loss: 3.636 Vali Loss: 4.019 Vali Acc: 0.072 Test Loss: 4.019 Test Acc: 0.072
Validation loss decreased (-0.049169 --> -0.072134).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3985403
	speed: 0.2331s/iter; left time: 4728.0074s
	iters: 200, epoch: 3 | loss: 3.5365481
	speed: 0.0381s/iter; left time: 768.7447s
Epoch: 3 cost time: 9.112274646759033
Epoch: 3, Steps: 208 | Train Loss: 3.358 Vali Loss: 4.118 Vali Acc: 0.084 Test Loss: 4.118 Test Acc: 0.084
Validation loss decreased (-0.072134 --> -0.083764).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0111313
	speed: 0.2498s/iter; left time: 5014.8819s
	iters: 200, epoch: 4 | loss: 3.1245003
	speed: 0.0340s/iter; left time: 678.7924s
Epoch: 4 cost time: 8.457737922668457
Epoch: 4, Steps: 208 | Train Loss: 3.159 Vali Loss: 4.059 Vali Acc: 0.095 Test Loss: 4.059 Test Acc: 0.095
Validation loss decreased (-0.083764 --> -0.094502).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2468565
	speed: 0.2451s/iter; left time: 4869.5229s
	iters: 200, epoch: 5 | loss: 2.4135773
	speed: 0.0384s/iter; left time: 759.5021s
Epoch: 5 cost time: 8.796733856201172
Epoch: 5, Steps: 208 | Train Loss: 2.934 Vali Loss: 4.093 Vali Acc: 0.092 Test Loss: 4.093 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.5640380
	speed: 0.2504s/iter; left time: 4923.6047s
	iters: 200, epoch: 6 | loss: 3.6473198
	speed: 0.0384s/iter; left time: 750.5025s
Epoch: 6 cost time: 8.9634370803833
Epoch: 6, Steps: 208 | Train Loss: 2.775 Vali Loss: 4.092 Vali Acc: 0.100 Test Loss: 4.092 Test Acc: 0.100
Validation loss decreased (-0.094502 --> -0.099870).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6879554
	speed: 0.2554s/iter; left time: 4968.9131s
	iters: 200, epoch: 7 | loss: 3.5427852
	speed: 0.0339s/iter; left time: 655.2646s
Epoch: 7 cost time: 8.525891780853271
Epoch: 7, Steps: 208 | Train Loss: 2.619 Vali Loss: 4.110 Vali Acc: 0.103 Test Loss: 4.110 Test Acc: 0.103
Validation loss decreased (-0.099870 --> -0.102852).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3788640
	speed: 0.2449s/iter; left time: 4712.6702s
	iters: 200, epoch: 8 | loss: 2.9952226
	speed: 0.0400s/iter; left time: 766.1527s
Epoch: 8 cost time: 9.201375484466553
Epoch: 8, Steps: 208 | Train Loss: 2.445 Vali Loss: 4.094 Vali Acc: 0.099 Test Loss: 4.094 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8238757
	speed: 0.2398s/iter; left time: 4564.9721s
	iters: 200, epoch: 9 | loss: 2.6366031
	speed: 0.0335s/iter; left time: 633.6343s
Epoch: 9 cost time: 8.517037391662598
Epoch: 9, Steps: 208 | Train Loss: 2.288 Vali Loss: 4.182 Vali Acc: 0.095 Test Loss: 4.182 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.2256615
	speed: 0.2300s/iter; left time: 4329.7785s
	iters: 200, epoch: 10 | loss: 2.1945131
	speed: 0.0306s/iter; left time: 572.5845s
Epoch: 10 cost time: 7.5936737060546875
Epoch: 10, Steps: 208 | Train Loss: 2.160 Vali Loss: 4.268 Vali Acc: 0.106 Test Loss: 4.268 Test Acc: 0.106
Validation loss decreased (-0.102852 --> -0.106131).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3099077
	speed: 0.2147s/iter; left time: 3997.7015s
	iters: 200, epoch: 11 | loss: 2.8061104
	speed: 0.0335s/iter; left time: 620.7371s
Epoch: 11 cost time: 7.719613552093506
Epoch: 11, Steps: 208 | Train Loss: 2.061 Vali Loss: 4.386 Vali Acc: 0.100 Test Loss: 4.386 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.7447648
	speed: 0.2266s/iter; left time: 4172.7621s
	iters: 200, epoch: 12 | loss: 2.8195691
	speed: 0.0335s/iter; left time: 613.2721s
Epoch: 12 cost time: 7.942859888076782
Epoch: 12, Steps: 208 | Train Loss: 1.924 Vali Loss: 4.542 Vali Acc: 0.111 Test Loss: 4.542 Test Acc: 0.111
Validation loss decreased (-0.106131 --> -0.110900).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9938208
	speed: 0.2116s/iter; left time: 3852.8691s
	iters: 200, epoch: 13 | loss: 2.5555146
	speed: 0.0335s/iter; left time: 605.9204s
Epoch: 13 cost time: 7.504062652587891
Epoch: 13, Steps: 208 | Train Loss: 1.796 Vali Loss: 4.704 Vali Acc: 0.101 Test Loss: 4.704 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.0282629
	speed: 0.2239s/iter; left time: 4028.9802s
	iters: 200, epoch: 14 | loss: 1.4800911
	speed: 0.0314s/iter; left time: 561.2744s
Epoch: 14 cost time: 7.725659608840942
Epoch: 14, Steps: 208 | Train Loss: 1.705 Vali Loss: 4.931 Vali Acc: 0.103 Test Loss: 4.931 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2524537
	speed: 0.2323s/iter; left time: 4131.5324s
	iters: 200, epoch: 15 | loss: 1.2860975
	speed: 0.0324s/iter; left time: 572.6163s
Epoch: 15 cost time: 8.163768291473389
Epoch: 15, Steps: 208 | Train Loss: 1.593 Vali Loss: 5.144 Vali Acc: 0.113 Test Loss: 5.144 Test Acc: 0.113
Validation loss decreased (-0.110900 --> -0.112683).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.2877829
	speed: 0.2307s/iter; left time: 4056.1990s
	iters: 200, epoch: 16 | loss: 1.8028288
	speed: 0.0305s/iter; left time: 533.6863s
Epoch: 16 cost time: 7.2486045360565186
Epoch: 16, Steps: 208 | Train Loss: 1.495 Vali Loss: 5.323 Vali Acc: 0.102 Test Loss: 5.323 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.7305969
	speed: 0.2127s/iter; left time: 3694.9713s
	iters: 200, epoch: 17 | loss: 1.0192721
	speed: 0.0270s/iter; left time: 466.2311s
Epoch: 17 cost time: 6.74975061416626
Epoch: 17, Steps: 208 | Train Loss: 1.415 Vali Loss: 5.539 Vali Acc: 0.108 Test Loss: 5.539 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.0380778
	speed: 0.2241s/iter; left time: 3845.9161s
	iters: 200, epoch: 18 | loss: 1.5118821
	speed: 0.0295s/iter; left time: 503.2221s
Epoch: 18 cost time: 7.523194074630737
Epoch: 18, Steps: 208 | Train Loss: 1.325 Vali Loss: 5.769 Vali Acc: 0.104 Test Loss: 5.769 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.1937886
	speed: 0.2160s/iter; left time: 3662.1866s
	iters: 200, epoch: 19 | loss: 1.9109645
	speed: 0.0341s/iter; left time: 574.3348s
Epoch: 19 cost time: 8.235047578811646
Epoch: 19, Steps: 208 | Train Loss: 1.250 Vali Loss: 6.011 Vali Acc: 0.104 Test Loss: 6.011 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2046444
	speed: 0.2385s/iter; left time: 3993.8385s
	iters: 200, epoch: 20 | loss: 1.3596562
	speed: 0.0328s/iter; left time: 545.3239s
Epoch: 20 cost time: 7.632780075073242
Epoch: 20, Steps: 208 | Train Loss: 1.160 Vali Loss: 6.249 Vali Acc: 0.108 Test Loss: 6.249 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8184206
	speed: 0.2388s/iter; left time: 3950.4483s
	iters: 200, epoch: 21 | loss: 1.0220808
	speed: 0.0323s/iter; left time: 530.8224s
Epoch: 21 cost time: 8.126291513442993
Epoch: 21, Steps: 208 | Train Loss: 1.065 Vali Loss: 6.546 Vali Acc: 0.106 Test Loss: 6.546 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.1534119
	speed: 0.2415s/iter; left time: 3944.3703s
	iters: 200, epoch: 22 | loss: 1.2379652
	speed: 0.0365s/iter; left time: 592.9836s
Epoch: 22 cost time: 8.416930913925171
Epoch: 22, Steps: 208 | Train Loss: 1.011 Vali Loss: 6.782 Vali Acc: 0.105 Test Loss: 6.782 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.5339933
	speed: 0.2409s/iter; left time: 3883.8450s
	iters: 200, epoch: 23 | loss: 1.1029950
	speed: 0.0321s/iter; left time: 513.7488s
Epoch: 23 cost time: 8.180428743362427
Epoch: 23, Steps: 208 | Train Loss: 0.969 Vali Loss: 6.971 Vali Acc: 0.103 Test Loss: 6.971 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.7419592
	speed: 0.2325s/iter; left time: 3700.8585s
	iters: 200, epoch: 24 | loss: 1.2644639
	speed: 0.0352s/iter; left time: 556.2579s
Epoch: 24 cost time: 7.9681620597839355
Epoch: 24, Steps: 208 | Train Loss: 0.945 Vali Loss: 7.425 Vali Acc: 0.112 Test Loss: 7.425 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.5112249
	speed: 0.2509s/iter; left time: 3941.6584s
	iters: 200, epoch: 25 | loss: 1.3982592
	speed: 0.0360s/iter; left time: 562.5391s
Epoch: 25 cost time: 8.45836877822876
Epoch: 25, Steps: 208 | Train Loss: 0.897 Vali Loss: 7.520 Vali Acc: 0.106 Test Loss: 7.520 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1127348643006263
model parameter : 250631
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9206061
	speed: 0.0590s/iter; left time: 1221.8564s
	iters: 200, epoch: 1 | loss: 4.1509452
	speed: 0.0297s/iter; left time: 611.1024s
Epoch: 1 cost time: 9.278403520584106
Epoch: 1, Steps: 208 | Train Loss: 3.825 Vali Loss: 3.821 Vali Acc: 0.056 Test Loss: 3.821 Test Acc: 0.056
Validation loss decreased (inf --> -0.056031).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0805445
	speed: 0.1963s/iter; left time: 4023.6531s
	iters: 200, epoch: 2 | loss: 3.1474314
	speed: 0.0304s/iter; left time: 620.4276s
Epoch: 2 cost time: 6.838090419769287
Epoch: 2, Steps: 208 | Train Loss: 3.582 Vali Loss: 3.861 Vali Acc: 0.069 Test Loss: 3.861 Test Acc: 0.069
Validation loss decreased (-0.056031 --> -0.068557).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6779609
	speed: 0.1943s/iter; left time: 3940.9868s
	iters: 200, epoch: 3 | loss: 2.9232028
	speed: 0.0276s/iter; left time: 557.4656s
Epoch: 3 cost time: 6.701093912124634
Epoch: 3, Steps: 208 | Train Loss: 3.293 Vali Loss: 3.930 Vali Acc: 0.079 Test Loss: 3.930 Test Acc: 0.079
Validation loss decreased (-0.068557 --> -0.078696).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9031911
	speed: 0.1996s/iter; left time: 4006.6116s
	iters: 200, epoch: 4 | loss: 3.4121180
	speed: 0.0270s/iter; left time: 539.4006s
Epoch: 4 cost time: 6.229079008102417
Epoch: 4, Steps: 208 | Train Loss: 3.116 Vali Loss: 3.966 Vali Acc: 0.078 Test Loss: 3.966 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.6096871
	speed: 0.1885s/iter; left time: 3746.1964s
	iters: 200, epoch: 5 | loss: 3.6446023
	speed: 0.0298s/iter; left time: 589.9300s
Epoch: 5 cost time: 6.891963481903076
Epoch: 5, Steps: 208 | Train Loss: 2.975 Vali Loss: 4.014 Vali Acc: 0.088 Test Loss: 4.014 Test Acc: 0.088
Validation loss decreased (-0.078696 --> -0.087643).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2751417
	speed: 0.1893s/iter; left time: 3721.5458s
	iters: 200, epoch: 6 | loss: 3.0426967
	speed: 0.0299s/iter; left time: 583.9951s
Epoch: 6 cost time: 6.667810440063477
Epoch: 6, Steps: 208 | Train Loss: 2.821 Vali Loss: 4.018 Vali Acc: 0.089 Test Loss: 4.018 Test Acc: 0.089
Validation loss decreased (-0.087643 --> -0.088537).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4884329
	speed: 0.1839s/iter; left time: 3576.8444s
	iters: 200, epoch: 7 | loss: 2.2799258
	speed: 0.0224s/iter; left time: 433.2788s
Epoch: 7 cost time: 5.507889986038208
Epoch: 7, Steps: 208 | Train Loss: 2.654 Vali Loss: 4.102 Vali Acc: 0.092 Test Loss: 4.102 Test Acc: 0.092
Validation loss decreased (-0.088537 --> -0.091519).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7868285
	speed: 0.1669s/iter; left time: 3212.1665s
	iters: 200, epoch: 8 | loss: 2.2140269
	speed: 0.0232s/iter; left time: 443.9131s
Epoch: 8 cost time: 5.716015577316284
Epoch: 8, Steps: 208 | Train Loss: 2.545 Vali Loss: 4.060 Vali Acc: 0.096 Test Loss: 4.060 Test Acc: 0.096
Validation loss decreased (-0.091519 --> -0.095695).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5267954
	speed: 0.1688s/iter; left time: 3213.5894s
	iters: 200, epoch: 9 | loss: 2.4240198
	speed: 0.0252s/iter; left time: 477.6973s
Epoch: 9 cost time: 5.8623974323272705
Epoch: 9, Steps: 208 | Train Loss: 2.409 Vali Loss: 4.114 Vali Acc: 0.095 Test Loss: 4.114 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9433359
	speed: 0.1797s/iter; left time: 3382.9956s
	iters: 200, epoch: 10 | loss: 3.1561866
	speed: 0.0260s/iter; left time: 486.4813s
Epoch: 10 cost time: 6.504464387893677
Epoch: 10, Steps: 208 | Train Loss: 2.279 Vali Loss: 4.258 Vali Acc: 0.103 Test Loss: 4.258 Test Acc: 0.103
Validation loss decreased (-0.095695 --> -0.103447).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1381578
	speed: 0.1741s/iter; left time: 3241.2199s
	iters: 200, epoch: 11 | loss: 2.8312073
	speed: 0.0286s/iter; left time: 529.1892s
Epoch: 11 cost time: 6.6481287479400635
Epoch: 11, Steps: 208 | Train Loss: 2.193 Vali Loss: 4.326 Vali Acc: 0.101 Test Loss: 4.326 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.6138277
	speed: 0.1810s/iter; left time: 3333.2603s
	iters: 200, epoch: 12 | loss: 2.2925332
	speed: 0.0290s/iter; left time: 531.1363s
Epoch: 12 cost time: 6.819897413253784
Epoch: 12, Steps: 208 | Train Loss: 2.088 Vali Loss: 4.403 Vali Acc: 0.101 Test Loss: 4.403 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.8914468
	speed: 0.1872s/iter; left time: 3407.5582s
	iters: 200, epoch: 13 | loss: 2.5044966
	speed: 0.0319s/iter; left time: 578.0320s
Epoch: 13 cost time: 6.9318578243255615
Epoch: 13, Steps: 208 | Train Loss: 1.990 Vali Loss: 4.563 Vali Acc: 0.099 Test Loss: 4.563 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.5690092
	speed: 0.1870s/iter; left time: 3364.7010s
	iters: 200, epoch: 14 | loss: 2.1967728
	speed: 0.0279s/iter; left time: 498.7408s
Epoch: 14 cost time: 6.373623609542847
Epoch: 14, Steps: 208 | Train Loss: 1.944 Vali Loss: 4.702 Vali Acc: 0.097 Test Loss: 4.702 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.7500932
	speed: 0.1880s/iter; left time: 3343.4647s
	iters: 200, epoch: 15 | loss: 2.5515437
	speed: 0.0298s/iter; left time: 526.5355s
Epoch: 15 cost time: 6.806544780731201
Epoch: 15, Steps: 208 | Train Loss: 1.837 Vali Loss: 4.779 Vali Acc: 0.101 Test Loss: 4.779 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.6738861
	speed: 0.1723s/iter; left time: 3029.3255s
	iters: 200, epoch: 16 | loss: 2.1454051
	speed: 0.0208s/iter; left time: 363.9313s
Epoch: 16 cost time: 5.215691566467285
Epoch: 16, Steps: 208 | Train Loss: 1.773 Vali Loss: 4.896 Vali Acc: 0.102 Test Loss: 4.896 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.8724030
	speed: 0.1587s/iter; left time: 2756.9028s
	iters: 200, epoch: 17 | loss: 2.1227851
	speed: 0.0211s/iter; left time: 363.6218s
Epoch: 17 cost time: 5.114236831665039
Epoch: 17, Steps: 208 | Train Loss: 1.693 Vali Loss: 5.054 Vali Acc: 0.105 Test Loss: 5.054 Test Acc: 0.105
Validation loss decreased (-0.103447 --> -0.104930).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.5407774
	speed: 0.1881s/iter; left time: 3229.0895s
	iters: 200, epoch: 18 | loss: 1.2444055
	speed: 0.0286s/iter; left time: 488.2491s
Epoch: 18 cost time: 7.172215938568115
Epoch: 18, Steps: 208 | Train Loss: 1.640 Vali Loss: 5.221 Vali Acc: 0.104 Test Loss: 5.221 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.3099583
	speed: 0.1912s/iter; left time: 3241.7857s
	iters: 200, epoch: 19 | loss: 1.7925782
	speed: 0.0288s/iter; left time: 485.7382s
Epoch: 19 cost time: 6.891697406768799
Epoch: 19, Steps: 208 | Train Loss: 1.558 Vali Loss: 5.371 Vali Acc: 0.103 Test Loss: 5.371 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.4173278
	speed: 0.2024s/iter; left time: 3389.8092s
	iters: 200, epoch: 20 | loss: 1.1542976
	speed: 0.0317s/iter; left time: 528.5860s
Epoch: 20 cost time: 7.19342303276062
Epoch: 20, Steps: 208 | Train Loss: 1.500 Vali Loss: 5.500 Vali Acc: 0.109 Test Loss: 5.500 Test Acc: 0.109
Validation loss decreased (-0.104930 --> -0.108504).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.9154249
	speed: 0.1937s/iter; left time: 3203.3077s
	iters: 200, epoch: 21 | loss: 1.6434242
	speed: 0.0312s/iter; left time: 512.5768s
Epoch: 21 cost time: 7.2974324226379395
Epoch: 21, Steps: 208 | Train Loss: 1.448 Vali Loss: 5.640 Vali Acc: 0.101 Test Loss: 5.640 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.6463929
	speed: 0.2005s/iter; left time: 3275.0122s
	iters: 200, epoch: 22 | loss: 1.4903665
	speed: 0.0321s/iter; left time: 521.5887s
Epoch: 22 cost time: 7.320754289627075
Epoch: 22, Steps: 208 | Train Loss: 1.392 Vali Loss: 5.881 Vali Acc: 0.105 Test Loss: 5.881 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.4458607
	speed: 0.1953s/iter; left time: 3148.5665s
	iters: 200, epoch: 23 | loss: 1.6937639
	speed: 0.0265s/iter; left time: 424.2669s
Epoch: 23 cost time: 6.746327638626099
Epoch: 23, Steps: 208 | Train Loss: 1.377 Vali Loss: 5.977 Vali Acc: 0.111 Test Loss: 5.977 Test Acc: 0.111
Validation loss decreased (-0.108504 --> -0.110587).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.2712438
	speed: 0.1956s/iter; left time: 3113.1054s
	iters: 200, epoch: 24 | loss: 1.6196215
	speed: 0.0270s/iter; left time: 426.7376s
Epoch: 24 cost time: 6.545057058334351
Epoch: 24, Steps: 208 | Train Loss: 1.317 Vali Loss: 6.167 Vali Acc: 0.102 Test Loss: 6.167 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.4580407
	speed: 0.1918s/iter; left time: 3012.8979s
	iters: 200, epoch: 25 | loss: 1.6427907
	speed: 0.0275s/iter; left time: 429.4927s
Epoch: 25 cost time: 6.747349977493286
Epoch: 25, Steps: 208 | Train Loss: 1.275 Vali Loss: 6.180 Vali Acc: 0.105 Test Loss: 6.180 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.7521768
	speed: 0.1798s/iter; left time: 2786.3965s
	iters: 200, epoch: 26 | loss: 1.1063312
	speed: 0.0279s/iter; left time: 429.8448s
Epoch: 26 cost time: 6.658027172088623
Epoch: 26, Steps: 208 | Train Loss: 1.221 Vali Loss: 6.514 Vali Acc: 0.105 Test Loss: 6.514 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.7689450
	speed: 0.1743s/iter; left time: 2666.0673s
	iters: 200, epoch: 27 | loss: 1.5628033
	speed: 0.0255s/iter; left time: 387.9974s
Epoch: 27 cost time: 6.109391450881958
Epoch: 27, Steps: 208 | Train Loss: 1.185 Vali Loss: 6.589 Vali Acc: 0.105 Test Loss: 6.589 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.9099550
	speed: 0.1705s/iter; left time: 2572.5442s
	iters: 200, epoch: 28 | loss: 2.1267529
	speed: 0.0272s/iter; left time: 407.6817s
Epoch: 28 cost time: 6.72832989692688
Epoch: 28, Steps: 208 | Train Loss: 1.165 Vali Loss: 6.851 Vali Acc: 0.101 Test Loss: 6.851 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.2503681
	speed: 0.1807s/iter; left time: 2688.9308s
	iters: 200, epoch: 29 | loss: 1.6861304
	speed: 0.0250s/iter; left time: 370.1578s
Epoch: 29 cost time: 6.081280469894409
Epoch: 29, Steps: 208 | Train Loss: 1.101 Vali Loss: 7.077 Vali Acc: 0.098 Test Loss: 7.077 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.6337566
	speed: 0.1839s/iter; left time: 2696.9486s
	iters: 200, epoch: 30 | loss: 1.4704933
	speed: 0.0279s/iter; left time: 406.9376s
Epoch: 30 cost time: 6.767609119415283
Epoch: 30, Steps: 208 | Train Loss: 1.090 Vali Loss: 7.177 Vali Acc: 0.101 Test Loss: 7.177 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.0756567
	speed: 0.1821s/iter; left time: 2633.7247s
	iters: 200, epoch: 31 | loss: 1.1061368
	speed: 0.0244s/iter; left time: 350.7232s
Epoch: 31 cost time: 6.125536918640137
Epoch: 31, Steps: 208 | Train Loss: 1.051 Vali Loss: 7.380 Vali Acc: 0.099 Test Loss: 7.380 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 1.0033797
	speed: 0.1794s/iter; left time: 2556.2982s
	iters: 200, epoch: 32 | loss: 1.5634158
	speed: 0.0261s/iter; left time: 369.5538s
Epoch: 32 cost time: 5.906243562698364
Epoch: 32, Steps: 208 | Train Loss: 1.010 Vali Loss: 7.454 Vali Acc: 0.107 Test Loss: 7.454 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.8380044
	speed: 0.1725s/iter; left time: 2422.6781s
	iters: 200, epoch: 33 | loss: 1.1235298
	speed: 0.0273s/iter; left time: 380.5540s
Epoch: 33 cost time: 6.061225891113281
Epoch: 33, Steps: 208 | Train Loss: 0.985 Vali Loss: 7.638 Vali Acc: 0.099 Test Loss: 7.638 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11064718162839249
model parameter : 168359
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9661801
	speed: 0.0579s/iter; left time: 1198.7588s
	iters: 200, epoch: 1 | loss: 3.7900577
	speed: 0.0266s/iter; left time: 547.9318s
Epoch: 1 cost time: 8.727153301239014
Epoch: 1, Steps: 208 | Train Loss: 3.808 Vali Loss: 3.812 Vali Acc: 0.044 Test Loss: 3.812 Test Acc: 0.044
Validation loss decreased (inf --> -0.044101).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7389135
	speed: 0.1777s/iter; left time: 3642.4975s
	iters: 200, epoch: 2 | loss: 2.9857864
	speed: 0.0312s/iter; left time: 635.4849s
Epoch: 2 cost time: 6.55222225189209
Epoch: 2, Steps: 208 | Train Loss: 3.596 Vali Loss: 3.778 Vali Acc: 0.069 Test Loss: 3.778 Test Acc: 0.069
Validation loss decreased (-0.044101 --> -0.069452).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5358157
	speed: 0.1955s/iter; left time: 3965.5934s
	iters: 200, epoch: 3 | loss: 3.1566412
	speed: 0.0284s/iter; left time: 572.7210s
Epoch: 3 cost time: 7.006170749664307
Epoch: 3, Steps: 208 | Train Loss: 3.380 Vali Loss: 3.872 Vali Acc: 0.073 Test Loss: 3.872 Test Acc: 0.073
Validation loss decreased (-0.069452 --> -0.072732).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8249049
	speed: 0.2013s/iter; left time: 4042.3642s
	iters: 200, epoch: 4 | loss: 3.8465946
	speed: 0.0316s/iter; left time: 631.0487s
Epoch: 4 cost time: 7.475926637649536
Epoch: 4, Steps: 208 | Train Loss: 3.231 Vali Loss: 3.857 Vali Acc: 0.079 Test Loss: 3.857 Test Acc: 0.079
Validation loss decreased (-0.072732 --> -0.079293).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9277318
	speed: 0.2018s/iter; left time: 4010.4644s
	iters: 200, epoch: 5 | loss: 3.5504091
	speed: 0.0325s/iter; left time: 641.9748s
Epoch: 5 cost time: 7.132656097412109
Epoch: 5, Steps: 208 | Train Loss: 3.074 Vali Loss: 3.943 Vali Acc: 0.080 Test Loss: 3.943 Test Acc: 0.080
Validation loss decreased (-0.079293 --> -0.080187).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5358543
	speed: 0.1972s/iter; left time: 3876.9950s
	iters: 200, epoch: 6 | loss: 3.5208344
	speed: 0.0298s/iter; left time: 582.7550s
Epoch: 6 cost time: 7.054490089416504
Epoch: 6, Steps: 208 | Train Loss: 2.949 Vali Loss: 3.859 Vali Acc: 0.090 Test Loss: 3.859 Test Acc: 0.090
Validation loss decreased (-0.080187 --> -0.090030).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1766553
	speed: 0.1823s/iter; left time: 3547.1239s
	iters: 200, epoch: 7 | loss: 3.2554688
	speed: 0.0286s/iter; left time: 552.6567s
Epoch: 7 cost time: 7.030833721160889
Epoch: 7, Steps: 208 | Train Loss: 2.823 Vali Loss: 3.885 Vali Acc: 0.093 Test Loss: 3.885 Test Acc: 0.093
Validation loss decreased (-0.090030 --> -0.092714).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2460709
	speed: 0.1810s/iter; left time: 3482.5296s
	iters: 200, epoch: 8 | loss: 3.1687138
	speed: 0.0236s/iter; left time: 451.5854s
Epoch: 8 cost time: 5.80832314491272
Epoch: 8, Steps: 208 | Train Loss: 2.724 Vali Loss: 3.915 Vali Acc: 0.090 Test Loss: 3.915 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.6408110
	speed: 0.1911s/iter; left time: 3638.5722s
	iters: 200, epoch: 9 | loss: 3.0395520
	speed: 0.0270s/iter; left time: 511.3399s
Epoch: 9 cost time: 6.390822649002075
Epoch: 9, Steps: 208 | Train Loss: 2.595 Vali Loss: 3.922 Vali Acc: 0.092 Test Loss: 3.922 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.3965690
	speed: 0.1882s/iter; left time: 3543.8848s
	iters: 200, epoch: 10 | loss: 2.9851928
	speed: 0.0277s/iter; left time: 518.1681s
Epoch: 10 cost time: 6.836763858795166
Epoch: 10, Steps: 208 | Train Loss: 2.506 Vali Loss: 3.988 Vali Acc: 0.090 Test Loss: 3.988 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 3.2226112
	speed: 0.1854s/iter; left time: 3451.5559s
	iters: 200, epoch: 11 | loss: 2.4967837
	speed: 0.0254s/iter; left time: 470.4337s
Epoch: 11 cost time: 6.45538067817688
Epoch: 11, Steps: 208 | Train Loss: 2.433 Vali Loss: 4.022 Vali Acc: 0.095 Test Loss: 4.022 Test Acc: 0.095
Validation loss decreased (-0.092714 --> -0.094502).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4347866
	speed: 0.1834s/iter; left time: 3377.5589s
	iters: 200, epoch: 12 | loss: 2.3115156
	speed: 0.0289s/iter; left time: 529.2834s
Epoch: 12 cost time: 6.557477712631226
Epoch: 12, Steps: 208 | Train Loss: 2.312 Vali Loss: 4.132 Vali Acc: 0.094 Test Loss: 4.132 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2925193
	speed: 0.1953s/iter; left time: 3555.5036s
	iters: 200, epoch: 13 | loss: 3.2417109
	speed: 0.0285s/iter; left time: 515.4663s
Epoch: 13 cost time: 6.843829393386841
Epoch: 13, Steps: 208 | Train Loss: 2.257 Vali Loss: 4.182 Vali Acc: 0.092 Test Loss: 4.182 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.9609803
	speed: 0.1862s/iter; left time: 3351.6794s
	iters: 200, epoch: 14 | loss: 2.5137234
	speed: 0.0238s/iter; left time: 425.3479s
Epoch: 14 cost time: 5.711288213729858
Epoch: 14, Steps: 208 | Train Loss: 2.182 Vali Loss: 4.252 Vali Acc: 0.086 Test Loss: 4.252 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7289267
	speed: 0.1838s/iter; left time: 3270.3990s
	iters: 200, epoch: 15 | loss: 2.3933980
	speed: 0.0285s/iter; left time: 504.6256s
Epoch: 15 cost time: 6.522277593612671
Epoch: 15, Steps: 208 | Train Loss: 2.103 Vali Loss: 4.309 Vali Acc: 0.099 Test Loss: 4.309 Test Acc: 0.099
Validation loss decreased (-0.094502 --> -0.098674).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8485242
	speed: 0.1845s/iter; left time: 3243.5368s
	iters: 200, epoch: 16 | loss: 2.0262370
	speed: 0.0271s/iter; left time: 473.8146s
Epoch: 16 cost time: 6.296786069869995
Epoch: 16, Steps: 208 | Train Loss: 2.058 Vali Loss: 4.421 Vali Acc: 0.095 Test Loss: 4.421 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.9611272
	speed: 0.1816s/iter; left time: 3154.3212s
	iters: 200, epoch: 17 | loss: 2.0248137
	speed: 0.0247s/iter; left time: 426.5799s
Epoch: 17 cost time: 5.847650527954102
Epoch: 17, Steps: 208 | Train Loss: 2.002 Vali Loss: 4.530 Vali Acc: 0.095 Test Loss: 4.530 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.5798346
	speed: 0.1808s/iter; left time: 3103.7424s
	iters: 200, epoch: 18 | loss: 1.9559921
	speed: 0.0230s/iter; left time: 391.8124s
Epoch: 18 cost time: 5.62169885635376
Epoch: 18, Steps: 208 | Train Loss: 1.958 Vali Loss: 4.567 Vali Acc: 0.097 Test Loss: 4.567 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4142295
	speed: 0.1922s/iter; left time: 3259.6233s
	iters: 200, epoch: 19 | loss: 2.4682720
	speed: 0.0288s/iter; left time: 485.3133s
Epoch: 19 cost time: 7.120071649551392
Epoch: 19, Steps: 208 | Train Loss: 1.873 Vali Loss: 4.662 Vali Acc: 0.094 Test Loss: 4.662 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 2.4718022
	speed: 0.2054s/iter; left time: 3439.8296s
	iters: 200, epoch: 20 | loss: 2.0874054
	speed: 0.0309s/iter; left time: 514.3549s
Epoch: 20 cost time: 7.1612467765808105
Epoch: 20, Steps: 208 | Train Loss: 1.819 Vali Loss: 4.769 Vali Acc: 0.101 Test Loss: 4.769 Test Acc: 0.101
Validation loss decreased (-0.098674 --> -0.100758).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.7397718
	speed: 0.2056s/iter; left time: 3401.4899s
	iters: 200, epoch: 21 | loss: 1.9926754
	speed: 0.0327s/iter; left time: 537.6799s
Epoch: 21 cost time: 7.468975067138672
Epoch: 21, Steps: 208 | Train Loss: 1.782 Vali Loss: 4.912 Vali Acc: 0.100 Test Loss: 4.912 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.3756082
	speed: 0.1940s/iter; left time: 3168.0636s
	iters: 200, epoch: 22 | loss: 1.7737598
	speed: 0.0290s/iter; left time: 471.4100s
Epoch: 22 cost time: 6.682135343551636
Epoch: 22, Steps: 208 | Train Loss: 1.740 Vali Loss: 5.023 Vali Acc: 0.089 Test Loss: 5.023 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.4861410
	speed: 0.1994s/iter; left time: 3214.6054s
	iters: 200, epoch: 23 | loss: 1.5105684
	speed: 0.0280s/iter; left time: 448.1682s
Epoch: 23 cost time: 6.828676462173462
Epoch: 23, Steps: 208 | Train Loss: 1.684 Vali Loss: 5.159 Vali Acc: 0.099 Test Loss: 5.159 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.7628564
	speed: 0.1983s/iter; left time: 3155.6614s
	iters: 200, epoch: 24 | loss: 1.4109461
	speed: 0.0302s/iter; left time: 478.0924s
Epoch: 24 cost time: 7.095530033111572
Epoch: 24, Steps: 208 | Train Loss: 1.622 Vali Loss: 5.201 Vali Acc: 0.102 Test Loss: 5.201 Test Acc: 0.102
Validation loss decreased (-0.100758 --> -0.101648).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4517435
	speed: 0.1956s/iter; left time: 3073.3423s
	iters: 200, epoch: 25 | loss: 1.8357909
	speed: 0.0268s/iter; left time: 417.8935s
Epoch: 25 cost time: 6.380775213241577
Epoch: 25, Steps: 208 | Train Loss: 1.606 Vali Loss: 5.326 Vali Acc: 0.103 Test Loss: 5.326 Test Acc: 0.103
Validation loss decreased (-0.101648 --> -0.102541).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.8677762
	speed: 0.1940s/iter; left time: 3007.5283s
	iters: 200, epoch: 26 | loss: 1.5891607
	speed: 0.0318s/iter; left time: 489.1294s
Epoch: 26 cost time: 7.011335134506226
Epoch: 26, Steps: 208 | Train Loss: 1.558 Vali Loss: 5.404 Vali Acc: 0.092 Test Loss: 5.404 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 2.2491860
	speed: 0.1898s/iter; left time: 2902.4947s
	iters: 200, epoch: 27 | loss: 1.9961528
	speed: 0.0300s/iter; left time: 455.2570s
Epoch: 27 cost time: 6.622233629226685
Epoch: 27, Steps: 208 | Train Loss: 1.532 Vali Loss: 5.444 Vali Acc: 0.095 Test Loss: 5.444 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.2241530
	speed: 0.1926s/iter; left time: 2905.0353s
	iters: 200, epoch: 28 | loss: 2.8847468
	speed: 0.0283s/iter; left time: 423.6346s
Epoch: 28 cost time: 6.910807132720947
Epoch: 28, Steps: 208 | Train Loss: 1.516 Vali Loss: 5.578 Vali Acc: 0.098 Test Loss: 5.578 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.9243001
	speed: 0.1825s/iter; left time: 2715.3505s
	iters: 200, epoch: 29 | loss: 1.4093606
	speed: 0.0256s/iter; left time: 378.8325s
Epoch: 29 cost time: 6.049466609954834
Epoch: 29, Steps: 208 | Train Loss: 1.451 Vali Loss: 5.710 Vali Acc: 0.098 Test Loss: 5.710 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.5358657
	speed: 0.1759s/iter; left time: 2580.9353s
	iters: 200, epoch: 30 | loss: 1.4232304
	speed: 0.0253s/iter; left time: 369.2253s
Epoch: 30 cost time: 5.947092771530151
Epoch: 30, Steps: 208 | Train Loss: 1.430 Vali Loss: 5.878 Vali Acc: 0.092 Test Loss: 5.878 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.3341839
	speed: 0.1838s/iter; left time: 2658.4974s
	iters: 200, epoch: 31 | loss: 1.3814346
	speed: 0.0263s/iter; left time: 377.5916s
Epoch: 31 cost time: 6.547303676605225
Epoch: 31, Steps: 208 | Train Loss: 1.404 Vali Loss: 5.947 Vali Acc: 0.097 Test Loss: 5.947 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.4884073
	speed: 0.1828s/iter; left time: 2605.7005s
	iters: 200, epoch: 32 | loss: 1.4626733
	speed: 0.0302s/iter; left time: 428.0087s
Epoch: 32 cost time: 6.821894407272339
Epoch: 32, Steps: 208 | Train Loss: 1.341 Vali Loss: 6.058 Vali Acc: 0.098 Test Loss: 6.058 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.2480050
	speed: 0.1808s/iter; left time: 2539.8446s
	iters: 200, epoch: 33 | loss: 1.1209867
	speed: 0.0264s/iter; left time: 367.9683s
Epoch: 33 cost time: 6.415236234664917
Epoch: 33, Steps: 208 | Train Loss: 1.379 Vali Loss: 6.077 Vali Acc: 0.097 Test Loss: 6.077 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.7867438
	speed: 0.1821s/iter; left time: 2520.3319s
	iters: 200, epoch: 34 | loss: 1.2684610
	speed: 0.0262s/iter; left time: 360.2831s
Epoch: 34 cost time: 6.550435781478882
Epoch: 34, Steps: 208 | Train Loss: 1.313 Vali Loss: 6.150 Vali Acc: 0.097 Test Loss: 6.150 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.9782558
	speed: 0.1923s/iter; left time: 2620.3438s
	iters: 200, epoch: 35 | loss: 1.2233684
	speed: 0.0270s/iter; left time: 365.7489s
Epoch: 35 cost time: 6.458524227142334
Epoch: 35, Steps: 208 | Train Loss: 1.287 Vali Loss: 6.424 Vali Acc: 0.091 Test Loss: 6.424 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1025946913212049
model parameter : 134119
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps33_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4614444
	speed: 0.0634s/iter; left time: 1313.2951s
	iters: 200, epoch: 1 | loss: 3.6755888
	speed: 0.0307s/iter; left time: 631.5628s
Epoch: 1 cost time: 9.80997109413147
Epoch: 1, Steps: 208 | Train Loss: 3.762 Vali Loss: 3.699 Vali Acc: 0.059 Test Loss: 3.699 Test Acc: 0.059
Validation loss decreased (inf --> -0.058716).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3945599
	speed: 0.1990s/iter; left time: 4077.8166s
	iters: 200, epoch: 2 | loss: 3.5256469
	speed: 0.0280s/iter; left time: 570.5122s
Epoch: 2 cost time: 6.871465444564819
Epoch: 2, Steps: 208 | Train Loss: 3.590 Vali Loss: 3.767 Vali Acc: 0.061 Test Loss: 3.767 Test Acc: 0.061
Validation loss decreased (-0.058716 --> -0.060803).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4790330
	speed: 0.1995s/iter; left time: 4047.7648s
	iters: 200, epoch: 3 | loss: 3.4299493
	speed: 0.0252s/iter; left time: 508.7754s
Epoch: 3 cost time: 6.3140881061553955
Epoch: 3, Steps: 208 | Train Loss: 3.430 Vali Loss: 3.767 Vali Acc: 0.068 Test Loss: 3.767 Test Acc: 0.068
Validation loss decreased (-0.060803 --> -0.067663).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0078812
	speed: 0.1812s/iter; left time: 3637.7389s
	iters: 200, epoch: 4 | loss: 3.3769987
	speed: 0.0274s/iter; left time: 547.9313s
Epoch: 4 cost time: 6.412886142730713
Epoch: 4, Steps: 208 | Train Loss: 3.288 Vali Loss: 3.745 Vali Acc: 0.069 Test Loss: 3.745 Test Acc: 0.069
Validation loss decreased (-0.067663 --> -0.069453).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2867329
	speed: 0.1820s/iter; left time: 3616.4037s
	iters: 200, epoch: 5 | loss: 3.5913324
	speed: 0.0286s/iter; left time: 565.6807s
Epoch: 5 cost time: 6.934428453445435
Epoch: 5, Steps: 208 | Train Loss: 3.131 Vali Loss: 3.736 Vali Acc: 0.084 Test Loss: 3.736 Test Acc: 0.084
Validation loss decreased (-0.069453 --> -0.083470).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8535845
	speed: 0.1861s/iter; left time: 3658.9269s
	iters: 200, epoch: 6 | loss: 3.3921661
	speed: 0.0269s/iter; left time: 526.1599s
Epoch: 6 cost time: 6.9591310024261475
Epoch: 6, Steps: 208 | Train Loss: 3.023 Vali Loss: 3.782 Vali Acc: 0.079 Test Loss: 3.782 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2893999
	speed: 0.1914s/iter; left time: 3722.5954s
	iters: 200, epoch: 7 | loss: 2.8204064
	speed: 0.0269s/iter; left time: 519.9544s
Epoch: 7 cost time: 6.6874730587005615
Epoch: 7, Steps: 208 | Train Loss: 2.922 Vali Loss: 3.831 Vali Acc: 0.078 Test Loss: 3.831 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.6809063
	speed: 0.1871s/iter; left time: 3601.3341s
	iters: 200, epoch: 8 | loss: 3.2690678
	speed: 0.0271s/iter; left time: 519.3798s
Epoch: 8 cost time: 6.312468767166138
Epoch: 8, Steps: 208 | Train Loss: 2.817 Vali Loss: 3.832 Vali Acc: 0.086 Test Loss: 3.832 Test Acc: 0.086
Validation loss decreased (-0.083470 --> -0.085557).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1883523
	speed: 0.1916s/iter; left time: 3647.2179s
	iters: 200, epoch: 9 | loss: 2.6718996
	speed: 0.0258s/iter; left time: 489.1587s
Epoch: 9 cost time: 6.6547791957855225
Epoch: 9, Steps: 208 | Train Loss: 2.736 Vali Loss: 3.808 Vali Acc: 0.098 Test Loss: 3.808 Test Acc: 0.098
Validation loss decreased (-0.085557 --> -0.097785).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2786014
	speed: 0.1820s/iter; left time: 3426.0491s
	iters: 200, epoch: 10 | loss: 2.3733721
	speed: 0.0281s/iter; left time: 526.4277s
Epoch: 10 cost time: 6.5459065437316895
Epoch: 10, Steps: 208 | Train Loss: 2.668 Vali Loss: 3.833 Vali Acc: 0.096 Test Loss: 3.833 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.3755014
	speed: 0.1847s/iter; left time: 3439.3550s
	iters: 200, epoch: 11 | loss: 2.5235243
	speed: 0.0263s/iter; left time: 487.5624s
Epoch: 11 cost time: 6.025384187698364
Epoch: 11, Steps: 208 | Train Loss: 2.601 Vali Loss: 3.894 Vali Acc: 0.094 Test Loss: 3.894 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3942244
	speed: 0.1840s/iter; left time: 3388.0964s
	iters: 200, epoch: 12 | loss: 2.3633890
	speed: 0.0288s/iter; left time: 527.2454s
Epoch: 12 cost time: 6.567058086395264
Epoch: 12, Steps: 208 | Train Loss: 2.535 Vali Loss: 3.851 Vali Acc: 0.096 Test Loss: 3.851 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.4155037
	speed: 0.1824s/iter; left time: 3320.2647s
	iters: 200, epoch: 13 | loss: 3.0057151
	speed: 0.0316s/iter; left time: 571.3603s
Epoch: 13 cost time: 6.780520677566528
Epoch: 13, Steps: 208 | Train Loss: 2.474 Vali Loss: 3.947 Vali Acc: 0.100 Test Loss: 3.947 Test Acc: 0.100
Validation loss decreased (-0.097785 --> -0.099871).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.4607120
	speed: 0.1801s/iter; left time: 3241.5591s
	iters: 200, epoch: 14 | loss: 2.5969374
	speed: 0.0257s/iter; left time: 459.3960s
Epoch: 14 cost time: 5.950729846954346
Epoch: 14, Steps: 208 | Train Loss: 2.414 Vali Loss: 3.953 Vali Acc: 0.092 Test Loss: 3.953 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.2730911
	speed: 0.1798s/iter; left time: 3197.8697s
	iters: 200, epoch: 15 | loss: 1.9290340
	speed: 0.0243s/iter; left time: 430.2533s
Epoch: 15 cost time: 6.0669403076171875
Epoch: 15, Steps: 208 | Train Loss: 2.352 Vali Loss: 4.051 Vali Acc: 0.108 Test Loss: 4.051 Test Acc: 0.108
Validation loss decreased (-0.099871 --> -0.108221).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5342901
	speed: 0.1874s/iter; left time: 3294.9489s
	iters: 200, epoch: 16 | loss: 2.8892100
	speed: 0.0325s/iter; left time: 568.2264s
Epoch: 16 cost time: 7.139157772064209
Epoch: 16, Steps: 208 | Train Loss: 2.337 Vali Loss: 4.056 Vali Acc: 0.099 Test Loss: 4.056 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.5631237
	speed: 0.1928s/iter; left time: 3348.8887s
	iters: 200, epoch: 17 | loss: 3.2141826
	speed: 0.0278s/iter; left time: 480.9703s
Epoch: 17 cost time: 6.624720335006714
Epoch: 17, Steps: 208 | Train Loss: 2.271 Vali Loss: 4.099 Vali Acc: 0.102 Test Loss: 4.099 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.0032640
	speed: 0.1964s/iter; left time: 3371.8207s
	iters: 200, epoch: 18 | loss: 2.4189246
	speed: 0.0273s/iter; left time: 466.1003s
Epoch: 18 cost time: 6.739680290222168
Epoch: 18, Steps: 208 | Train Loss: 2.223 Vali Loss: 4.214 Vali Acc: 0.101 Test Loss: 4.214 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.6696265
	speed: 0.1962s/iter; left time: 3326.9712s
	iters: 200, epoch: 19 | loss: 2.2948403
	speed: 0.0262s/iter; left time: 441.1118s
Epoch: 19 cost time: 6.3718061447143555
Epoch: 19, Steps: 208 | Train Loss: 2.172 Vali Loss: 4.181 Vali Acc: 0.099 Test Loss: 4.181 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 2.3634503
	speed: 0.1911s/iter; left time: 3200.7623s
	iters: 200, epoch: 20 | loss: 2.1634796
	speed: 0.0262s/iter; left time: 435.9805s
Epoch: 20 cost time: 6.498939037322998
Epoch: 20, Steps: 208 | Train Loss: 2.151 Vali Loss: 4.303 Vali Acc: 0.098 Test Loss: 4.303 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.3622426
	speed: 0.1933s/iter; left time: 3197.0056s
	iters: 200, epoch: 21 | loss: 2.3026416
	speed: 0.0251s/iter; left time: 413.3809s
Epoch: 21 cost time: 6.779221296310425
Epoch: 21, Steps: 208 | Train Loss: 2.092 Vali Loss: 4.341 Vali Acc: 0.102 Test Loss: 4.341 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.9462765
	speed: 0.1878s/iter; left time: 3067.8867s
	iters: 200, epoch: 22 | loss: 2.1268997
	speed: 0.0285s/iter; left time: 462.2203s
Epoch: 22 cost time: 6.632001161575317
Epoch: 22, Steps: 208 | Train Loss: 2.051 Vali Loss: 4.436 Vali Acc: 0.106 Test Loss: 4.436 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 2.0553093
	speed: 0.1895s/iter; left time: 3055.8351s
	iters: 200, epoch: 23 | loss: 1.6634698
	speed: 0.0301s/iter; left time: 483.0858s
Epoch: 23 cost time: 6.942434310913086
Epoch: 23, Steps: 208 | Train Loss: 2.026 Vali Loss: 4.533 Vali Acc: 0.097 Test Loss: 4.533 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.4034822
	speed: 0.1909s/iter; left time: 3038.4932s
	iters: 200, epoch: 24 | loss: 2.4343035
	speed: 0.0310s/iter; left time: 489.9671s
Epoch: 24 cost time: 7.174468755722046
Epoch: 24, Steps: 208 | Train Loss: 1.981 Vali Loss: 4.590 Vali Acc: 0.100 Test Loss: 4.590 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 2.0827773
	speed: 0.2028s/iter; left time: 3186.3338s
	iters: 200, epoch: 25 | loss: 1.6217892
	speed: 0.0292s/iter; left time: 455.9811s
Epoch: 25 cost time: 6.804157495498657
Epoch: 25, Steps: 208 | Train Loss: 1.972 Vali Loss: 4.671 Vali Acc: 0.103 Test Loss: 4.671 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps33_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10826125857441098
model parameter : 86247
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6098204
	speed: 0.0612s/iter; left time: 1266.2995s
	iters: 200, epoch: 1 | loss: 3.5708871
	speed: 0.0287s/iter; left time: 591.7248s
Epoch: 1 cost time: 9.288060188293457
Epoch: 1, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.685 Vali Acc: 0.055 Test Loss: 3.685 Test Acc: 0.055
Validation loss decreased (inf --> -0.055138).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8134980
	speed: 0.1977s/iter; left time: 4050.6397s
	iters: 200, epoch: 2 | loss: 4.1464081
	speed: 0.0273s/iter; left time: 556.9706s
Epoch: 2 cost time: 6.650026559829712
Epoch: 2, Steps: 208 | Train Loss: 3.601 Vali Loss: 3.760 Vali Acc: 0.056 Test Loss: 3.760 Test Acc: 0.056
Validation loss decreased (-0.055138 --> -0.056330).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5449021
	speed: 0.1951s/iter; left time: 3958.4503s
	iters: 200, epoch: 3 | loss: 3.5594733
	speed: 0.0304s/iter; left time: 613.7164s
Epoch: 3 cost time: 7.1612389087677
Epoch: 3, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.779 Vali Acc: 0.061 Test Loss: 3.779 Test Acc: 0.061
Validation loss decreased (-0.056330 --> -0.061400).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4070492
	speed: 0.2065s/iter; left time: 4146.5960s
	iters: 200, epoch: 4 | loss: 3.6410742
	speed: 0.0284s/iter; left time: 567.5862s
Epoch: 4 cost time: 7.220166206359863
Epoch: 4, Steps: 208 | Train Loss: 3.325 Vali Loss: 3.707 Vali Acc: 0.075 Test Loss: 3.707 Test Acc: 0.075
Validation loss decreased (-0.061400 --> -0.074523).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2595849
	speed: 0.2033s/iter; left time: 4038.6968s
	iters: 200, epoch: 5 | loss: 2.9648151
	speed: 0.0308s/iter; left time: 608.6938s
Epoch: 5 cost time: 7.4712607860565186
Epoch: 5, Steps: 208 | Train Loss: 3.186 Vali Loss: 3.725 Vali Acc: 0.071 Test Loss: 3.725 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4783487
	speed: 0.1983s/iter; left time: 3899.0386s
	iters: 200, epoch: 6 | loss: 2.7614632
	speed: 0.0322s/iter; left time: 630.6638s
Epoch: 6 cost time: 7.643837928771973
Epoch: 6, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.737 Vali Acc: 0.075 Test Loss: 3.737 Test Acc: 0.075
Validation loss decreased (-0.074523 --> -0.075417).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0920820
	speed: 0.1813s/iter; left time: 3527.4083s
	iters: 200, epoch: 7 | loss: 2.9984086
	speed: 0.0301s/iter; left time: 582.0252s
Epoch: 7 cost time: 6.9296510219573975
Epoch: 7, Steps: 208 | Train Loss: 3.035 Vali Loss: 3.739 Vali Acc: 0.072 Test Loss: 3.739 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7757373
	speed: 0.1904s/iter; left time: 3664.1384s
	iters: 200, epoch: 8 | loss: 3.5052238
	speed: 0.0285s/iter; left time: 546.1799s
Epoch: 8 cost time: 6.8113038539886475
Epoch: 8, Steps: 208 | Train Loss: 2.969 Vali Loss: 3.722 Vali Acc: 0.077 Test Loss: 3.722 Test Acc: 0.077
Validation loss decreased (-0.075417 --> -0.076611).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7029207
	speed: 0.1806s/iter; left time: 3437.7539s
	iters: 200, epoch: 9 | loss: 2.3369505
	speed: 0.0254s/iter; left time: 480.1278s
Epoch: 9 cost time: 6.141718626022339
Epoch: 9, Steps: 208 | Train Loss: 2.871 Vali Loss: 3.784 Vali Acc: 0.074 Test Loss: 3.784 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.1339111
	speed: 0.1921s/iter; left time: 3616.2124s
	iters: 200, epoch: 10 | loss: 2.9053860
	speed: 0.0244s/iter; left time: 457.0492s
Epoch: 10 cost time: 5.640553951263428
Epoch: 10, Steps: 208 | Train Loss: 2.804 Vali Loss: 3.787 Vali Acc: 0.087 Test Loss: 3.787 Test Acc: 0.087
Validation loss decreased (-0.076611 --> -0.087347).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.7351010
	speed: 0.1964s/iter; left time: 3657.7687s
	iters: 200, epoch: 11 | loss: 2.5328212
	speed: 0.0288s/iter; left time: 532.5541s
Epoch: 11 cost time: 6.6754372119903564
Epoch: 11, Steps: 208 | Train Loss: 2.777 Vali Loss: 3.768 Vali Acc: 0.090 Test Loss: 3.768 Test Acc: 0.090
Validation loss decreased (-0.087347 --> -0.090031).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5607767
	speed: 0.1968s/iter; left time: 3623.8559s
	iters: 200, epoch: 12 | loss: 2.7154481
	speed: 0.0267s/iter; left time: 489.8209s
Epoch: 12 cost time: 6.693021297454834
Epoch: 12, Steps: 208 | Train Loss: 2.695 Vali Loss: 3.839 Vali Acc: 0.082 Test Loss: 3.839 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.7388635
	speed: 0.1871s/iter; left time: 3405.8881s
	iters: 200, epoch: 13 | loss: 3.3486416
	speed: 0.0268s/iter; left time: 484.8390s
Epoch: 13 cost time: 6.33526611328125
Epoch: 13, Steps: 208 | Train Loss: 2.650 Vali Loss: 3.880 Vali Acc: 0.089 Test Loss: 3.880 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.1911628
	speed: 0.1980s/iter; left time: 3563.2505s
	iters: 200, epoch: 14 | loss: 3.1134722
	speed: 0.0302s/iter; left time: 541.1214s
Epoch: 14 cost time: 7.260500431060791
Epoch: 14, Steps: 208 | Train Loss: 2.581 Vali Loss: 3.861 Vali Acc: 0.095 Test Loss: 3.861 Test Acc: 0.095
Validation loss decreased (-0.090031 --> -0.095100).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.2485509
	speed: 0.1943s/iter; left time: 3456.0045s
	iters: 200, epoch: 15 | loss: 2.6378648
	speed: 0.0272s/iter; left time: 481.3586s
Epoch: 15 cost time: 6.79509162902832
Epoch: 15, Steps: 208 | Train Loss: 2.526 Vali Loss: 3.922 Vali Acc: 0.091 Test Loss: 3.922 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.9155607
	speed: 0.1946s/iter; left time: 3420.9641s
	iters: 200, epoch: 16 | loss: 2.3019757
	speed: 0.0307s/iter; left time: 537.1593s
Epoch: 16 cost time: 7.150331735610962
Epoch: 16, Steps: 208 | Train Loss: 2.489 Vali Loss: 3.890 Vali Acc: 0.092 Test Loss: 3.890 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.5246751
	speed: 0.1905s/iter; left time: 3309.1861s
	iters: 200, epoch: 17 | loss: 3.4877477
	speed: 0.0298s/iter; left time: 515.1975s
Epoch: 17 cost time: 7.009125471115112
Epoch: 17, Steps: 208 | Train Loss: 2.438 Vali Loss: 3.927 Vali Acc: 0.097 Test Loss: 3.927 Test Acc: 0.097
Validation loss decreased (-0.095100 --> -0.096889).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.4483187
	speed: 0.1778s/iter; left time: 3051.4002s
	iters: 200, epoch: 18 | loss: 2.3232632
	speed: 0.0265s/iter; left time: 451.4277s
Epoch: 18 cost time: 6.336441993713379
Epoch: 18, Steps: 208 | Train Loss: 2.412 Vali Loss: 3.994 Vali Acc: 0.099 Test Loss: 3.994 Test Acc: 0.099
Validation loss decreased (-0.096889 --> -0.098678).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3841662
	speed: 0.1891s/iter; left time: 3207.2566s
	iters: 200, epoch: 19 | loss: 2.8122332
	speed: 0.0300s/iter; left time: 505.8671s
Epoch: 19 cost time: 6.731040954589844
Epoch: 19, Steps: 208 | Train Loss: 2.360 Vali Loss: 3.991 Vali Acc: 0.094 Test Loss: 3.991 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 3.1709876
	speed: 0.1923s/iter; left time: 3220.8542s
	iters: 200, epoch: 20 | loss: 2.8928981
	speed: 0.0273s/iter; left time: 455.0068s
Epoch: 20 cost time: 6.199048042297363
Epoch: 20, Steps: 208 | Train Loss: 2.315 Vali Loss: 4.037 Vali Acc: 0.095 Test Loss: 4.037 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.0198493
	speed: 0.1844s/iter; left time: 3050.8753s
	iters: 200, epoch: 21 | loss: 2.5136194
	speed: 0.0287s/iter; left time: 472.1238s
Epoch: 21 cost time: 6.760677099227905
Epoch: 21, Steps: 208 | Train Loss: 2.280 Vali Loss: 4.136 Vali Acc: 0.094 Test Loss: 4.136 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.1714795
	speed: 0.1932s/iter; left time: 3155.8362s
	iters: 200, epoch: 22 | loss: 2.0474737
	speed: 0.0255s/iter; left time: 413.3785s
Epoch: 22 cost time: 6.636839866638184
Epoch: 22, Steps: 208 | Train Loss: 2.252 Vali Loss: 4.147 Vali Acc: 0.096 Test Loss: 4.147 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.0772736
	speed: 0.1978s/iter; left time: 3189.0156s
	iters: 200, epoch: 23 | loss: 3.2376366
	speed: 0.0264s/iter; left time: 423.3648s
Epoch: 23 cost time: 6.6011879444122314
Epoch: 23, Steps: 208 | Train Loss: 2.239 Vali Loss: 4.155 Vali Acc: 0.098 Test Loss: 4.155 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.7890544
	speed: 0.2010s/iter; left time: 3198.7782s
	iters: 200, epoch: 24 | loss: 2.4430728
	speed: 0.0240s/iter; left time: 379.9673s
Epoch: 24 cost time: 6.6307384967803955
Epoch: 24, Steps: 208 | Train Loss: 2.195 Vali Loss: 4.209 Vali Acc: 0.098 Test Loss: 4.209 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.5389780
	speed: 0.2044s/iter; left time: 3210.4920s
	iters: 200, epoch: 25 | loss: 2.1130083
	speed: 0.0258s/iter; left time: 402.7074s
Epoch: 25 cost time: 6.527174711227417
Epoch: 25, Steps: 208 | Train Loss: 2.147 Vali Loss: 4.230 Vali Acc: 0.100 Test Loss: 4.230 Test Acc: 0.100
Validation loss decreased (-0.098678 --> -0.099570).  Saving model ...
	iters: 100, epoch: 26 | loss: 2.8372021
	speed: 0.2045s/iter; left time: 3169.9476s
	iters: 200, epoch: 26 | loss: 2.6769249
	speed: 0.0312s/iter; left time: 480.1486s
Epoch: 26 cost time: 7.061759948730469
Epoch: 26, Steps: 208 | Train Loss: 2.131 Vali Loss: 4.307 Vali Acc: 0.096 Test Loss: 4.307 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 2.6047997
	speed: 0.1995s/iter; left time: 3051.6673s
	iters: 200, epoch: 27 | loss: 2.0582430
	speed: 0.0256s/iter; left time: 389.1148s
Epoch: 27 cost time: 6.237996816635132
Epoch: 27, Steps: 208 | Train Loss: 2.109 Vali Loss: 4.346 Vali Acc: 0.099 Test Loss: 4.346 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.9779011
	speed: 0.2069s/iter; left time: 3120.3852s
	iters: 200, epoch: 28 | loss: 2.4218132
	speed: 0.0312s/iter; left time: 467.9798s
Epoch: 28 cost time: 7.335173845291138
Epoch: 28, Steps: 208 | Train Loss: 2.075 Vali Loss: 4.397 Vali Acc: 0.093 Test Loss: 4.397 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.5274909
	speed: 0.2047s/iter; left time: 3045.5826s
	iters: 200, epoch: 29 | loss: 2.0963640
	speed: 0.0317s/iter; left time: 467.9162s
Epoch: 29 cost time: 7.456615209579468
Epoch: 29, Steps: 208 | Train Loss: 2.068 Vali Loss: 4.473 Vali Acc: 0.098 Test Loss: 4.473 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.8277633
	speed: 0.2118s/iter; left time: 3106.5048s
	iters: 200, epoch: 30 | loss: 1.8512974
	speed: 0.0331s/iter; left time: 482.1444s
Epoch: 30 cost time: 7.493765115737915
Epoch: 30, Steps: 208 | Train Loss: 2.033 Vali Loss: 4.511 Vali Acc: 0.094 Test Loss: 4.511 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.7051226
	speed: 0.1868s/iter; left time: 2701.8874s
	iters: 200, epoch: 31 | loss: 1.9948655
	speed: 0.0275s/iter; left time: 395.2519s
Epoch: 31 cost time: 6.419652938842773
Epoch: 31, Steps: 208 | Train Loss: 2.024 Vali Loss: 4.569 Vali Acc: 0.097 Test Loss: 4.569 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.6322212
	speed: 0.1863s/iter; left time: 2655.0861s
	iters: 200, epoch: 32 | loss: 1.9259675
	speed: 0.0288s/iter; left time: 406.9503s
Epoch: 32 cost time: 6.844119071960449
Epoch: 32, Steps: 208 | Train Loss: 1.986 Vali Loss: 4.593 Vali Acc: 0.101 Test Loss: 4.593 Test Acc: 0.101
Validation loss decreased (-0.099570 --> -0.100759).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.9139725
	speed: 0.2014s/iter; left time: 2828.8239s
	iters: 200, epoch: 33 | loss: 2.0501323
	speed: 0.0289s/iter; left time: 402.8147s
Epoch: 33 cost time: 7.023197889328003
Epoch: 33, Steps: 208 | Train Loss: 1.971 Vali Loss: 4.590 Vali Acc: 0.106 Test Loss: 4.590 Test Acc: 0.106
Validation loss decreased (-0.100759 --> -0.105531).  Saving model ...
	iters: 100, epoch: 34 | loss: 2.1783862
	speed: 0.1932s/iter; left time: 2673.4160s
	iters: 200, epoch: 34 | loss: 2.0533979
	speed: 0.0277s/iter; left time: 380.5292s
Epoch: 34 cost time: 6.769862413406372
Epoch: 34, Steps: 208 | Train Loss: 1.956 Vali Loss: 4.645 Vali Acc: 0.095 Test Loss: 4.645 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.8031962
	speed: 0.1930s/iter; left time: 2630.4928s
	iters: 200, epoch: 35 | loss: 1.8926693
	speed: 0.0267s/iter; left time: 360.7761s
Epoch: 35 cost time: 6.180404424667358
Epoch: 35, Steps: 208 | Train Loss: 1.921 Vali Loss: 4.695 Vali Acc: 0.099 Test Loss: 4.695 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.2721020
	speed: 0.1997s/iter; left time: 2680.2377s
	iters: 200, epoch: 36 | loss: 1.7635000
	speed: 0.0298s/iter; left time: 396.3417s
Epoch: 36 cost time: 7.5220441818237305
Epoch: 36, Steps: 208 | Train Loss: 1.905 Vali Loss: 4.800 Vali Acc: 0.097 Test Loss: 4.800 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 1.5509077
	speed: 0.1926s/iter; left time: 2545.0389s
	iters: 200, epoch: 37 | loss: 2.8570333
	speed: 0.0253s/iter; left time: 331.1223s
Epoch: 37 cost time: 6.328661918640137
Epoch: 37, Steps: 208 | Train Loss: 1.876 Vali Loss: 4.849 Vali Acc: 0.093 Test Loss: 4.849 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 2.0912449
	speed: 0.1847s/iter; left time: 2402.6003s
	iters: 200, epoch: 38 | loss: 2.0810590
	speed: 0.0275s/iter; left time: 355.5275s
Epoch: 38 cost time: 6.343130350112915
Epoch: 38, Steps: 208 | Train Loss: 1.874 Vali Loss: 4.863 Vali Acc: 0.099 Test Loss: 4.863 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 2.5558341
	speed: 0.2124s/iter; left time: 2718.0112s
	iters: 200, epoch: 39 | loss: 1.4930205
	speed: 0.0366s/iter; left time: 464.5118s
Epoch: 39 cost time: 8.569154500961304
Epoch: 39, Steps: 208 | Train Loss: 1.830 Vali Loss: 4.950 Vali Acc: 0.095 Test Loss: 4.950 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 2.2947793
	speed: 0.2332s/iter; left time: 2935.1398s
	iters: 200, epoch: 40 | loss: 1.5292284
	speed: 0.0286s/iter; left time: 357.5841s
Epoch: 40 cost time: 7.573125600814819
Epoch: 40, Steps: 208 | Train Loss: 1.846 Vali Loss: 5.008 Vali Acc: 0.094 Test Loss: 5.008 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 1.8560140
	speed: 0.2494s/iter; left time: 3087.6064s
	iters: 200, epoch: 41 | loss: 1.6314161
	speed: 0.0343s/iter; left time: 420.8593s
Epoch: 41 cost time: 8.707351446151733
Epoch: 41, Steps: 208 | Train Loss: 1.810 Vali Loss: 5.025 Vali Acc: 0.095 Test Loss: 5.025 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 2.0084386
	speed: 0.2517s/iter; left time: 3064.4246s
	iters: 200, epoch: 42 | loss: 1.7026697
	speed: 0.0351s/iter; left time: 424.1070s
Epoch: 42 cost time: 8.56132984161377
Epoch: 42, Steps: 208 | Train Loss: 1.794 Vali Loss: 5.075 Vali Acc: 0.100 Test Loss: 5.075 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 1.7521404
	speed: 0.2288s/iter; left time: 2738.0747s
	iters: 200, epoch: 43 | loss: 2.0781496
	speed: 0.0401s/iter; left time: 475.9536s
Epoch: 43 cost time: 8.96875
Epoch: 43, Steps: 208 | Train Loss: 1.777 Vali Loss: 5.124 Vali Acc: 0.097 Test Loss: 5.124 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10557709513868178
model parameter : 65831
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6839142
	speed: 0.0543s/iter; left time: 1123.2055s
	iters: 200, epoch: 1 | loss: 3.6237626
	speed: 0.0293s/iter; left time: 603.1617s
Epoch: 1 cost time: 8.700986862182617
Epoch: 1, Steps: 208 | Train Loss: 3.778 Vali Loss: 3.674 Vali Acc: 0.052 Test Loss: 3.674 Test Acc: 0.052
Validation loss decreased (inf --> -0.051857).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4968367
	speed: 0.1861s/iter; left time: 3814.7657s
	iters: 200, epoch: 2 | loss: 3.7518344
	speed: 0.0319s/iter; left time: 650.4915s
Epoch: 2 cost time: 6.9323508739471436
Epoch: 2, Steps: 208 | Train Loss: 3.617 Vali Loss: 3.699 Vali Acc: 0.057 Test Loss: 3.699 Test Acc: 0.057
Validation loss decreased (-0.051857 --> -0.056629).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7085857
	speed: 0.1781s/iter; left time: 3613.6091s
	iters: 200, epoch: 3 | loss: 3.4969981
	speed: 0.0285s/iter; left time: 576.1539s
Epoch: 3 cost time: 6.506787061691284
Epoch: 3, Steps: 208 | Train Loss: 3.508 Vali Loss: 3.751 Vali Acc: 0.056 Test Loss: 3.751 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.9717531
	speed: 0.1846s/iter; left time: 3706.8903s
	iters: 200, epoch: 4 | loss: 3.6505654
	speed: 0.0298s/iter; left time: 594.8723s
Epoch: 4 cost time: 6.67098331451416
Epoch: 4, Steps: 208 | Train Loss: 3.407 Vali Loss: 3.693 Vali Acc: 0.067 Test Loss: 3.693 Test Acc: 0.067
Validation loss decreased (-0.056629 --> -0.066769).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2844117
	speed: 0.2128s/iter; left time: 4227.5989s
	iters: 200, epoch: 5 | loss: 3.5576391
	speed: 0.0341s/iter; left time: 674.7218s
Epoch: 5 cost time: 7.634209156036377
Epoch: 5, Steps: 208 | Train Loss: 3.289 Vali Loss: 3.700 Vali Acc: 0.064 Test Loss: 3.700 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8602760
	speed: 0.2187s/iter; left time: 4299.1668s
	iters: 200, epoch: 6 | loss: 3.2214234
	speed: 0.0351s/iter; left time: 686.8234s
Epoch: 6 cost time: 7.88288688659668
Epoch: 6, Steps: 208 | Train Loss: 3.169 Vali Loss: 3.661 Vali Acc: 0.076 Test Loss: 3.661 Test Acc: 0.076
Validation loss decreased (-0.066769 --> -0.076313).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7454405
	speed: 0.2148s/iter; left time: 4178.2889s
	iters: 200, epoch: 7 | loss: 3.4327674
	speed: 0.0305s/iter; left time: 590.9907s
Epoch: 7 cost time: 8.115888833999634
Epoch: 7, Steps: 208 | Train Loss: 3.084 Vali Loss: 3.681 Vali Acc: 0.076 Test Loss: 3.681 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5141082
	speed: 0.2115s/iter; left time: 4071.2134s
	iters: 200, epoch: 8 | loss: 3.1325679
	speed: 0.0296s/iter; left time: 567.5502s
Epoch: 8 cost time: 7.291500091552734
Epoch: 8, Steps: 208 | Train Loss: 3.014 Vali Loss: 3.687 Vali Acc: 0.083 Test Loss: 3.687 Test Acc: 0.083
Validation loss decreased (-0.076313 --> -0.082874).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5992880
	speed: 0.2124s/iter; left time: 4043.4872s
	iters: 200, epoch: 9 | loss: 2.9273639
	speed: 0.0305s/iter; left time: 578.0265s
Epoch: 9 cost time: 7.14255952835083
Epoch: 9, Steps: 208 | Train Loss: 2.948 Vali Loss: 3.672 Vali Acc: 0.086 Test Loss: 3.672 Test Acc: 0.086
Validation loss decreased (-0.082874 --> -0.085558).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8258951
	speed: 0.2022s/iter; left time: 3806.5439s
	iters: 200, epoch: 10 | loss: 2.8243585
	speed: 0.0244s/iter; left time: 456.0745s
Epoch: 10 cost time: 6.479369163513184
Epoch: 10, Steps: 208 | Train Loss: 2.884 Vali Loss: 3.727 Vali Acc: 0.096 Test Loss: 3.727 Test Acc: 0.096
Validation loss decreased (-0.085558 --> -0.095996).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.2693388
	speed: 0.1995s/iter; left time: 3715.1324s
	iters: 200, epoch: 11 | loss: 2.7861245
	speed: 0.0269s/iter; left time: 499.1076s
Epoch: 11 cost time: 6.568518400192261
Epoch: 11, Steps: 208 | Train Loss: 2.834 Vali Loss: 3.692 Vali Acc: 0.095 Test Loss: 3.692 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.5477140
	speed: 0.1922s/iter; left time: 3539.6913s
	iters: 200, epoch: 12 | loss: 3.0068877
	speed: 0.0278s/iter; left time: 508.6476s
Epoch: 12 cost time: 6.384385108947754
Epoch: 12, Steps: 208 | Train Loss: 2.777 Vali Loss: 3.730 Vali Acc: 0.091 Test Loss: 3.730 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.5743883
	speed: 0.1950s/iter; left time: 3549.8337s
	iters: 200, epoch: 13 | loss: 2.8321681
	speed: 0.0278s/iter; left time: 502.6314s
Epoch: 13 cost time: 6.743929147720337
Epoch: 13, Steps: 208 | Train Loss: 2.723 Vali Loss: 3.750 Vali Acc: 0.088 Test Loss: 3.750 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.0626132
	speed: 0.1952s/iter; left time: 3512.4755s
	iters: 200, epoch: 14 | loss: 2.1679988
	speed: 0.0327s/iter; left time: 585.4542s
Epoch: 14 cost time: 7.1227617263793945
Epoch: 14, Steps: 208 | Train Loss: 2.683 Vali Loss: 3.765 Vali Acc: 0.092 Test Loss: 3.765 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.1691301
	speed: 0.2033s/iter; left time: 3617.3893s
	iters: 200, epoch: 15 | loss: 2.9077203
	speed: 0.0332s/iter; left time: 586.7503s
Epoch: 15 cost time: 7.260307550430298
Epoch: 15, Steps: 208 | Train Loss: 2.630 Vali Loss: 3.807 Vali Acc: 0.097 Test Loss: 3.807 Test Acc: 0.097
Validation loss decreased (-0.095996 --> -0.097188).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.3042202
	speed: 0.2139s/iter; left time: 3759.9945s
	iters: 200, epoch: 16 | loss: 2.5468740
	speed: 0.0289s/iter; left time: 506.0453s
Epoch: 16 cost time: 7.497738361358643
Epoch: 16, Steps: 208 | Train Loss: 2.572 Vali Loss: 3.868 Vali Acc: 0.095 Test Loss: 3.868 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.6423421
	speed: 0.2081s/iter; left time: 3614.7093s
	iters: 200, epoch: 17 | loss: 2.6701641
	speed: 0.0269s/iter; left time: 464.6126s
Epoch: 17 cost time: 6.902440547943115
Epoch: 17, Steps: 208 | Train Loss: 2.537 Vali Loss: 3.836 Vali Acc: 0.099 Test Loss: 3.836 Test Acc: 0.099
Validation loss decreased (-0.097188 --> -0.098679).  Saving model ...
	iters: 100, epoch: 18 | loss: 3.1186976
	speed: 0.1978s/iter; left time: 3396.0149s
	iters: 200, epoch: 18 | loss: 2.9735937
	speed: 0.0277s/iter; left time: 472.2090s
Epoch: 18 cost time: 6.764545202255249
Epoch: 18, Steps: 208 | Train Loss: 2.472 Vali Loss: 3.940 Vali Acc: 0.096 Test Loss: 3.940 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.3195286
	speed: 0.1956s/iter; left time: 3317.5374s
	iters: 200, epoch: 19 | loss: 3.2217450
	speed: 0.0287s/iter; left time: 483.9701s
Epoch: 19 cost time: 6.699420928955078
Epoch: 19, Steps: 208 | Train Loss: 2.449 Vali Loss: 3.945 Vali Acc: 0.101 Test Loss: 3.945 Test Acc: 0.101
Validation loss decreased (-0.098679 --> -0.101362).  Saving model ...
	iters: 100, epoch: 20 | loss: 2.8094196
	speed: 0.1969s/iter; left time: 3297.7420s
	iters: 200, epoch: 20 | loss: 2.4053135
	speed: 0.0254s/iter; left time: 423.3664s
Epoch: 20 cost time: 6.411161661148071
Epoch: 20, Steps: 208 | Train Loss: 2.415 Vali Loss: 3.960 Vali Acc: 0.099 Test Loss: 3.960 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 2.2521996
	speed: 0.1984s/iter; left time: 3281.6594s
	iters: 200, epoch: 21 | loss: 3.0323963
	speed: 0.0293s/iter; left time: 482.1781s
Epoch: 21 cost time: 7.236742973327637
Epoch: 21, Steps: 208 | Train Loss: 2.364 Vali Loss: 4.041 Vali Acc: 0.107 Test Loss: 4.041 Test Acc: 0.107
Validation loss decreased (-0.101362 --> -0.107028).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.4883289
	speed: 0.2139s/iter; left time: 3492.8327s
	iters: 200, epoch: 22 | loss: 2.7005820
	speed: 0.0307s/iter; left time: 497.8295s
Epoch: 22 cost time: 7.574911594390869
Epoch: 22, Steps: 208 | Train Loss: 2.352 Vali Loss: 4.054 Vali Acc: 0.100 Test Loss: 4.054 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 2.0382767
	speed: 0.2130s/iter; left time: 3434.6877s
	iters: 200, epoch: 23 | loss: 1.6663477
	speed: 0.0288s/iter; left time: 462.2064s
Epoch: 23 cost time: 6.97237229347229
Epoch: 23, Steps: 208 | Train Loss: 2.317 Vali Loss: 4.095 Vali Acc: 0.098 Test Loss: 4.095 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 2.3056636
	speed: 0.2011s/iter; left time: 3200.7624s
	iters: 200, epoch: 24 | loss: 1.6475804
	speed: 0.0309s/iter; left time: 488.0440s
Epoch: 24 cost time: 7.524045705795288
Epoch: 24, Steps: 208 | Train Loss: 2.280 Vali Loss: 4.164 Vali Acc: 0.102 Test Loss: 4.164 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.9606651
	speed: 0.1979s/iter; left time: 3108.4756s
	iters: 200, epoch: 25 | loss: 2.7395151
	speed: 0.0277s/iter; left time: 432.5463s
Epoch: 25 cost time: 7.052808046340942
Epoch: 25, Steps: 208 | Train Loss: 2.267 Vali Loss: 4.166 Vali Acc: 0.103 Test Loss: 4.166 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 2.2650609
	speed: 0.2001s/iter; left time: 3102.3037s
	iters: 200, epoch: 26 | loss: 2.3608692
	speed: 0.0259s/iter; left time: 399.0700s
Epoch: 26 cost time: 6.6838219165802
Epoch: 26, Steps: 208 | Train Loss: 2.245 Vali Loss: 4.269 Vali Acc: 0.096 Test Loss: 4.269 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 2.9361489
	speed: 0.2109s/iter; left time: 3225.1824s
	iters: 200, epoch: 27 | loss: 2.3639200
	speed: 0.0334s/iter; left time: 507.2829s
Epoch: 27 cost time: 7.449929714202881
Epoch: 27, Steps: 208 | Train Loss: 2.210 Vali Loss: 4.265 Vali Acc: 0.100 Test Loss: 4.265 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.7739942
	speed: 0.2136s/iter; left time: 3221.4571s
	iters: 200, epoch: 28 | loss: 2.4887741
	speed: 0.0306s/iter; left time: 459.2067s
Epoch: 28 cost time: 7.1759934425354
Epoch: 28, Steps: 208 | Train Loss: 2.186 Vali Loss: 4.347 Vali Acc: 0.099 Test Loss: 4.347 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 2.2609282
	speed: 0.2126s/iter; left time: 3163.2348s
	iters: 200, epoch: 29 | loss: 1.9073091
	speed: 0.0309s/iter; left time: 456.3477s
Epoch: 29 cost time: 7.314282655715942
Epoch: 29, Steps: 208 | Train Loss: 2.149 Vali Loss: 4.375 Vali Acc: 0.101 Test Loss: 4.375 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 2.1539168
	speed: 0.2090s/iter; left time: 3065.7089s
	iters: 200, epoch: 30 | loss: 1.8060989
	speed: 0.0291s/iter; left time: 423.3734s
Epoch: 30 cost time: 6.766949415206909
Epoch: 30, Steps: 208 | Train Loss: 2.131 Vali Loss: 4.413 Vali Acc: 0.103 Test Loss: 4.413 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.9264874
	speed: 0.2102s/iter; left time: 3039.4171s
	iters: 200, epoch: 31 | loss: 1.3795896
	speed: 0.0285s/iter; left time: 409.4274s
Epoch: 31 cost time: 6.721353769302368
Epoch: 31, Steps: 208 | Train Loss: 2.124 Vali Loss: 4.520 Vali Acc: 0.101 Test Loss: 4.520 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_PatchTST_UEA_ftM_sl217_ll0_pl0_el1_dm16_nh4_df64_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10706829704742023
model parameter : 52279
model size : 0.51MB
