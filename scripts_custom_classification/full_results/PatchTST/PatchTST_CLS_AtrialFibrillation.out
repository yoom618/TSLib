Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.172494888305664
Epoch: 1, Steps: 1 | Train Loss: 1.283 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.397937536239624
Epoch: 2, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4221036434173584
Epoch: 3, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3595137596130371
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.41617631912231445
Epoch: 5, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.45618200302124023
Epoch: 6, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.4852006435394287
Epoch: 7, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.44277167320251465
Epoch: 8, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.40641069412231445
Epoch: 9, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.4081716537475586
Epoch: 10, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.41704559326171875
Epoch: 11, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4280357360839844
Epoch: 12, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.422527551651001
Epoch: 13, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.419924259185791
Epoch: 14, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3920626640319824
Epoch: 15, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.45890378952026367
Epoch: 16, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.45628976821899414
Epoch: 17, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4153130054473877
Epoch: 18, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.474628210067749
Epoch: 19, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.34514451026916504
Epoch: 20, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4399421215057373
Epoch: 21, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.250 Vali Acc: 0.400 Test Loss: 1.250 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.3519296646118164
Epoch: 22, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.36034703254699707
Epoch: 23, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.3464395999908447
Epoch: 24, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.3508131504058838
Epoch: 25, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4183776378631592
Epoch: 26, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.335 Vali Acc: 0.400 Test Loss: 1.335 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4230766296386719
Epoch: 27, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.357 Vali Acc: 0.400 Test Loss: 1.357 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4315817356109619
Epoch: 28, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.380 Vali Acc: 0.400 Test Loss: 1.380 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.3958001136779785
Epoch: 29, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.402 Vali Acc: 0.400 Test Loss: 1.402 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 461187
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.978712558746338
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.33240675926208496
Epoch: 2, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4268496036529541
Epoch: 3, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.42291831970214844
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.327573299407959
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3615455627441406
Epoch: 6, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5314064025878906
Epoch: 7, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4287402629852295
Epoch: 8, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.397871732711792
Epoch: 9, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4709904193878174
Epoch: 10, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.45728373527526855
Epoch: 11, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.393444299697876
Epoch: 12, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4520847797393799
Epoch: 13, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.42662978172302246
Epoch: 14, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.38346123695373535
Epoch: 15, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4800407886505127
Epoch: 16, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.434539794921875
Epoch: 17, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.40604138374328613
Epoch: 18, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 432515
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9264781475067139
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.266 Vali Acc: 0.200 Test Loss: 1.266 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.410830020904541
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.268 Vali Acc: 0.200 Test Loss: 1.268 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39710354804992676
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44654297828674316
Epoch: 4, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4023735523223877
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.274 Vali Acc: 0.200 Test Loss: 1.274 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40350890159606934
Epoch: 6, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.275 Vali Acc: 0.133 Test Loss: 1.275 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4280729293823242
Epoch: 7, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.277 Vali Acc: 0.200 Test Loss: 1.277 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3959064483642578
Epoch: 8, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.279 Vali Acc: 0.200 Test Loss: 1.279 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.42445945739746094
Epoch: 9, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.282 Vali Acc: 0.133 Test Loss: 1.282 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4135754108428955
Epoch: 10, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.286 Vali Acc: 0.133 Test Loss: 1.286 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.43674421310424805
Epoch: 11, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.290 Vali Acc: 0.133 Test Loss: 1.290 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 423811
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0632829666137695
Epoch: 1, Steps: 1 | Train Loss: 1.427 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4616682529449463
Epoch: 2, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4777984619140625
Epoch: 3, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.4584212303161621
Epoch: 4, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4730105400085449
Epoch: 5, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.5074498653411865
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5739617347717285
Epoch: 7, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5754928588867188
Epoch: 8, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5665347576141357
Epoch: 9, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5004374980926514
Epoch: 10, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5168383121490479
Epoch: 11, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.40325164794921875
Epoch: 12, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5366883277893066
Epoch: 13, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.42619752883911133
Epoch: 14, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6981778144836426
Epoch: 15, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4262371063232422
Epoch: 16, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.502269983291626
Epoch: 17, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 421251
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7610433101654053
Epoch: 1, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.137 Vali Acc: 0.533 Test Loss: 1.137 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.3487396240234375
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5088481903076172
Epoch: 3, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.42798519134521484
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.3823988437652588
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.4051837921142578
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.4339311122894287
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.400928258895874
Epoch: 8, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.44210028648376465
Epoch: 9, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.3848130702972412
Epoch: 10, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.5054752826690674
Epoch: 11, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4259073734283447
Epoch: 12, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4217207431793213
Epoch: 13, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4180104732513428
Epoch: 14, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.3961489200592041
Epoch: 15, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4323406219482422
Epoch: 16, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4106433391571045
Epoch: 17, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.3791477680206299
Epoch: 18, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.38248348236083984
Epoch: 19, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.41569995880126953
Epoch: 20, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 419971
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0403482913970947
Epoch: 1, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.457 Vali Acc: 0.267 Test Loss: 1.457 Test Acc: 0.267
Validation loss decreased (inf --> -0.266652).  Saving model ...
Epoch: 2 cost time: 0.415250301361084
Epoch: 2, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.435 Vali Acc: 0.267 Test Loss: 1.435 Test Acc: 0.267
Validation loss decreased (-0.266652 --> -0.266652).  Saving model ...
Epoch: 3 cost time: 0.3900163173675537
Epoch: 3, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.414 Vali Acc: 0.267 Test Loss: 1.414 Test Acc: 0.267
Validation loss decreased (-0.266652 --> -0.266653).  Saving model ...
Epoch: 4 cost time: 0.3834567070007324
Epoch: 4, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.396 Vali Acc: 0.267 Test Loss: 1.396 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 5 cost time: 0.3979973793029785
Epoch: 5, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.381 Vali Acc: 0.267 Test Loss: 1.381 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 6 cost time: 0.39249205589294434
Epoch: 6, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.367 Vali Acc: 0.267 Test Loss: 1.367 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 7 cost time: 0.3844122886657715
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.354 Vali Acc: 0.267 Test Loss: 1.354 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 8 cost time: 0.5199074745178223
Epoch: 8, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.344 Vali Acc: 0.267 Test Loss: 1.344 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 9 cost time: 0.33946919441223145
Epoch: 9, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.334 Vali Acc: 0.267 Test Loss: 1.334 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 10 cost time: 0.3961606025695801
Epoch: 10, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.326 Vali Acc: 0.267 Test Loss: 1.326 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 11 cost time: 0.44017958641052246
Epoch: 11, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.319 Vali Acc: 0.267 Test Loss: 1.319 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 12 cost time: 0.46173882484436035
Epoch: 12, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.314 Vali Acc: 0.267 Test Loss: 1.314 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 0.3691723346710205
Epoch: 13, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.308 Vali Acc: 0.267 Test Loss: 1.308 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 14 cost time: 0.4679594039916992
Epoch: 14, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 15 cost time: 0.5761301517486572
Epoch: 15, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 16 cost time: 0.5023488998413086
Epoch: 16, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 17 cost time: 0.4104604721069336
Epoch: 17, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.291 Vali Acc: 0.333 Test Loss: 1.291 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 18 cost time: 0.4603595733642578
Epoch: 18, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 19 cost time: 0.4143497943878174
Epoch: 19, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 20 cost time: 0.4178140163421631
Epoch: 20, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 21 cost time: 0.47369384765625
Epoch: 21, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4547100067138672
Epoch: 22, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4180757999420166
Epoch: 23, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.491818904876709
Epoch: 24, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4551374912261963
Epoch: 25, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5034253597259521
Epoch: 26, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.45816564559936523
Epoch: 27, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4739065170288086
Epoch: 28, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4201810359954834
Epoch: 29, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.49265146255493164
Epoch: 30, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 421763
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0063490867614746
Epoch: 1, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4762849807739258
Epoch: 2, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4710977077484131
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4797801971435547
Epoch: 4, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5490093231201172
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.568108320236206
Epoch: 6, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.486783504486084
Epoch: 7, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5014593601226807
Epoch: 8, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4854726791381836
Epoch: 9, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.3675401210784912
Epoch: 10, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4614272117614746
Epoch: 11, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4850611686706543
Epoch: 12, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 424323
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9332635402679443
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4121081829071045
Epoch: 2, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4968438148498535
Epoch: 3, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4832632541656494
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4267232418060303
Epoch: 5, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4773378372192383
Epoch: 6, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.5082423686981201
Epoch: 7, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 0.510944128036499
Epoch: 8, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.5164089202880859
Epoch: 9, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.5277025699615479
Epoch: 10, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.4961702823638916
Epoch: 11, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5968468189239502
Epoch: 12, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4251563549041748
Epoch: 13, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5117809772491455
Epoch: 14, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5665023326873779
Epoch: 15, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5348129272460938
Epoch: 16, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5167152881622314
Epoch: 17, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5710246562957764
Epoch: 18, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.45969223976135254
Epoch: 19, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5339169502258301
Epoch: 20, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 362499
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0849449634552
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5883314609527588
Epoch: 2, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5304358005523682
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6912074089050293
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.536888599395752
Epoch: 5, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5052249431610107
Epoch: 6, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5983166694641113
Epoch: 7, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5348460674285889
Epoch: 8, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.49140310287475586
Epoch: 9, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5464749336242676
Epoch: 10, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6185052394866943
Epoch: 11, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4457566738128662
Epoch: 12, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.536468505859375
Epoch: 13, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.5780582427978516
Epoch: 14, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4378340244293213
Epoch: 15, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5658972263336182
Epoch: 16, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5406033992767334
Epoch: 17, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4655582904815674
Epoch: 18, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6709845066070557
Epoch: 19, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6679666042327881
Epoch: 20, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4811685085296631
Epoch: 21, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4375333786010742
Epoch: 22, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.41321587562561035
Epoch: 23, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.214 Vali Acc: 0.467 Test Loss: 1.214 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 333827
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1041295528411865
Epoch: 1, Steps: 1 | Train Loss: 1.405 Vali Loss: 1.518 Vali Acc: 0.333 Test Loss: 1.518 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 0.4822056293487549
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.486 Vali Acc: 0.333 Test Loss: 1.486 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333318).  Saving model ...
Epoch: 3 cost time: 0.5123226642608643
Epoch: 3, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.455 Vali Acc: 0.333 Test Loss: 1.455 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 0.5023436546325684
Epoch: 4, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.428 Vali Acc: 0.333 Test Loss: 1.428 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 0.5116848945617676
Epoch: 5, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.405 Vali Acc: 0.333 Test Loss: 1.405 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 0.518378734588623
Epoch: 6, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.385 Vali Acc: 0.267 Test Loss: 1.385 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5139846801757812
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.366 Vali Acc: 0.200 Test Loss: 1.366 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5207929611206055
Epoch: 8, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.349 Vali Acc: 0.200 Test Loss: 1.349 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5195508003234863
Epoch: 9, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.336 Vali Acc: 0.200 Test Loss: 1.336 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.48717236518859863
Epoch: 10, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.323 Vali Acc: 0.200 Test Loss: 1.323 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.47971057891845703
Epoch: 11, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.315 Vali Acc: 0.200 Test Loss: 1.315 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5447804927825928
Epoch: 12, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.307 Vali Acc: 0.133 Test Loss: 1.307 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.44574618339538574
Epoch: 13, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.301 Vali Acc: 0.133 Test Loss: 1.301 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5628173351287842
Epoch: 14, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.297 Vali Acc: 0.133 Test Loss: 1.297 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5247745513916016
Epoch: 15, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.295 Vali Acc: 0.133 Test Loss: 1.295 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 325123
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.850010633468628
Epoch: 1, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4138977527618408
Epoch: 2, Steps: 1 | Train Loss: 1.358 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.41538000106811523
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4323453903198242
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47650885581970215
Epoch: 5, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.3893260955810547
Epoch: 6, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.4376397132873535
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.48878049850463867
Epoch: 8, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.33565759658813477
Epoch: 9, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5043206214904785
Epoch: 10, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.562185525894165
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4386146068572998
Epoch: 12, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.5229995250701904
Epoch: 13, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6152381896972656
Epoch: 14, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6212308406829834
Epoch: 15, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5652549266815186
Epoch: 16, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.41761231422424316
Epoch: 17, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5213611125946045
Epoch: 18, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.48066186904907227
Epoch: 19, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4621858596801758
Epoch: 20, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.530268669128418
Epoch: 21, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.45586419105529785
Epoch: 22, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4827151298522949
Epoch: 23, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5178916454315186
Epoch: 24, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4401273727416992
Epoch: 25, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4906799793243408
Epoch: 26, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 322563
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.047064781188965
Epoch: 1, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.495586633682251
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5447039604187012
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.4386589527130127
Epoch: 4, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.43676233291625977
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4940943717956543
Epoch: 6, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.42780017852783203
Epoch: 7, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4313182830810547
Epoch: 8, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.45705533027648926
Epoch: 9, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.47941160202026367
Epoch: 10, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4448072910308838
Epoch: 11, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.48137927055358887
Epoch: 12, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.42609381675720215
Epoch: 13, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.48522162437438965
Epoch: 14, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 321283
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1725261211395264
Epoch: 1, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.523982048034668
Epoch: 2, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.555696964263916
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49213075637817383
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5483551025390625
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5327818393707275
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5032868385314941
Epoch: 7, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.47867465019226074
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5832090377807617
Epoch: 9, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.557917594909668
Epoch: 10, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.46559762954711914
Epoch: 11, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 323075
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2181437015533447
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.49499034881591797
Epoch: 2, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5805690288543701
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5095951557159424
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.47162795066833496
Epoch: 5, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.4575207233428955
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.4147329330444336
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3732569217681885
Epoch: 8, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4790925979614258
Epoch: 9, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5681486129760742
Epoch: 10, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.3898775577545166
Epoch: 11, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4674513339996338
Epoch: 12, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5303661823272705
Epoch: 13, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.538593053817749
Epoch: 14, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.49812936782836914
Epoch: 15, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4919612407684326
Epoch: 16, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 325635
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1995816230773926
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5180087089538574
Epoch: 2, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4363393783569336
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.47191286087036133
Epoch: 4, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.4918208122253418
Epoch: 5, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6058840751647949
Epoch: 6, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.442948579788208
Epoch: 7, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5894522666931152
Epoch: 8, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5887446403503418
Epoch: 9, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.44435644149780273
Epoch: 10, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5488839149475098
Epoch: 11, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4387784004211426
Epoch: 12, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.42816901206970215
Epoch: 13, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5193271636962891
Epoch: 14, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 313155
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0555367469787598
Epoch: 1, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.420701265335083
Epoch: 2, Steps: 1 | Train Loss: 1.330 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4697380065917969
Epoch: 3, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.43779754638671875
Epoch: 4, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.46820735931396484
Epoch: 5, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.40226197242736816
Epoch: 6, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3974606990814209
Epoch: 7, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.48629188537597656
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5142529010772705
Epoch: 9, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4822390079498291
Epoch: 10, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.38457536697387695
Epoch: 11, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5133259296417236
Epoch: 12, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4628016948699951
Epoch: 13, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.46487927436828613
Epoch: 14, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5225443840026855
Epoch: 15, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.42082834243774414
Epoch: 16, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4650106430053711
Epoch: 17, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4687337875366211
Epoch: 18, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.505401611328125
Epoch: 19, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5506219863891602
Epoch: 20, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.49818992614746094
Epoch: 21, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.45923876762390137
Epoch: 22, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5036721229553223
Epoch: 23, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6186113357543945
Epoch: 24, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5191183090209961
Epoch: 25, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 284483
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2087619304656982
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46288418769836426
Epoch: 2, Steps: 1 | Train Loss: 1.370 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5066804885864258
Epoch: 3, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5610294342041016
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4196906089782715
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.46160054206848145
Epoch: 6, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3792593479156494
Epoch: 7, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4759840965270996
Epoch: 8, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.42909812927246094
Epoch: 9, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.39936375617980957
Epoch: 10, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.39737534523010254
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4690678119659424
Epoch: 12, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 275779
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.992548942565918
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5047130584716797
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.4672536849975586
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4546318054199219
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.519442081451416
Epoch: 5, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.4538445472717285
Epoch: 6, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.4704399108886719
Epoch: 7, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.5817849636077881
Epoch: 8, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.48118138313293457
Epoch: 9, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.5819501876831055
Epoch: 10, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5245137214660645
Epoch: 11, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5285599231719971
Epoch: 12, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5596723556518555
Epoch: 13, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5406198501586914
Epoch: 14, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6204817295074463
Epoch: 15, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4902822971343994
Epoch: 16, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5072727203369141
Epoch: 17, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5376429557800293
Epoch: 18, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.229 Vali Acc: 0.133 Test Loss: 1.229 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.49723243713378906
Epoch: 19, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 273219
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.994250774383545
Epoch: 1, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.47722744941711426
Epoch: 2, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.40534400939941406
Epoch: 3, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.41702771186828613
Epoch: 4, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5238661766052246
Epoch: 5, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.35167598724365234
Epoch: 6, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3976857662200928
Epoch: 7, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.3849823474884033
Epoch: 8, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4082636833190918
Epoch: 9, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5860404968261719
Epoch: 10, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.43262410163879395
Epoch: 11, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.3961935043334961
Epoch: 12, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 271939
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2081871032714844
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.4998033046722412
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.540473461151123
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.008 Vali Acc: 0.400 Test Loss: 1.008 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.47510504722595215
Epoch: 4, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.4782888889312744
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.003 Vali Acc: 0.400 Test Loss: 1.003 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.4600679874420166
Epoch: 6, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.000 Vali Acc: 0.400 Test Loss: 1.000 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.46668076515197754
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.4713456630706787
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
Validation loss decreased (-0.466657 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.5205478668212891
Epoch: 9, Steps: 1 | Train Loss: 0.984 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.4579122066497803
Epoch: 10, Steps: 1 | Train Loss: 0.963 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.4944629669189453
Epoch: 11, Steps: 1 | Train Loss: 0.827 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4883387088775635
Epoch: 12, Steps: 1 | Train Loss: 0.759 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.46620988845825195
Epoch: 13, Steps: 1 | Train Loss: 0.706 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.5260872840881348
Epoch: 14, Steps: 1 | Train Loss: 0.734 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4793508052825928
Epoch: 15, Steps: 1 | Train Loss: 0.748 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47826337814331055
Epoch: 16, Steps: 1 | Train Loss: 0.695 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4668586254119873
Epoch: 17, Steps: 1 | Train Loss: 0.604 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.48761749267578125
Epoch: 18, Steps: 1 | Train Loss: 0.507 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5044891834259033
Epoch: 19, Steps: 1 | Train Loss: 0.479 Vali Loss: 0.988 Vali Acc: 0.400 Test Loss: 0.988 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7436394691467285
Epoch: 20, Steps: 1 | Train Loss: 0.463 Vali Loss: 0.989 Vali Acc: 0.400 Test Loss: 0.989 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.561469316482544
Epoch: 21, Steps: 1 | Train Loss: 0.437 Vali Loss: 0.991 Vali Acc: 0.400 Test Loss: 0.991 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5112993717193604
Epoch: 22, Steps: 1 | Train Loss: 0.409 Vali Loss: 0.993 Vali Acc: 0.400 Test Loss: 0.993 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.43679213523864746
Epoch: 23, Steps: 1 | Train Loss: 0.326 Vali Loss: 0.995 Vali Acc: 0.400 Test Loss: 0.995 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 273731
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.036877393722534
Epoch: 1, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.310 Vali Acc: 0.267 Test Loss: 1.310 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.44920778274536133
Epoch: 2, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.313 Vali Acc: 0.267 Test Loss: 1.313 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4837503433227539
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.315 Vali Acc: 0.267 Test Loss: 1.315 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44127440452575684
Epoch: 4, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.317 Vali Acc: 0.267 Test Loss: 1.317 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.37122464179992676
Epoch: 5, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.320 Vali Acc: 0.267 Test Loss: 1.320 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47461795806884766
Epoch: 6, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.324 Vali Acc: 0.267 Test Loss: 1.324 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45260119438171387
Epoch: 7, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.326 Vali Acc: 0.267 Test Loss: 1.326 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.43549108505249023
Epoch: 8, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.330 Vali Acc: 0.267 Test Loss: 1.330 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.47058701515197754
Epoch: 9, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.333 Vali Acc: 0.267 Test Loss: 1.333 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.45685410499572754
Epoch: 10, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.336 Vali Acc: 0.267 Test Loss: 1.336 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4757397174835205
Epoch: 11, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.339 Vali Acc: 0.267 Test Loss: 1.339 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm128_nh16_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 276291
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5076286792755127
Epoch: 1, Steps: 1 | Train Loss: 1.284 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46439123153686523
Epoch: 2, Steps: 1 | Train Loss: 1.449 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.544710636138916
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5184862613677979
Epoch: 4, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48206567764282227
Epoch: 5, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.48781251907348633
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4839596748352051
Epoch: 7, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5582387447357178
Epoch: 8, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4857974052429199
Epoch: 9, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.48601436614990234
Epoch: 10, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5274088382720947
Epoch: 11, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 181827
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9473414421081543
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.36360669136047363
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.42254137992858887
Epoch: 3, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.450336217880249
Epoch: 4, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.4352993965148926
Epoch: 5, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.42926812171936035
Epoch: 6, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.5209438800811768
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.4854776859283447
Epoch: 8, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.44335484504699707
Epoch: 9, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.5979926586151123
Epoch: 10, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.4225771427154541
Epoch: 11, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.44678401947021484
Epoch: 12, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.4814279079437256
Epoch: 13, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.4464075565338135
Epoch: 14, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4487032890319824
Epoch: 15, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5212938785552979
Epoch: 16, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.44491124153137207
Epoch: 17, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4711906909942627
Epoch: 18, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4534308910369873
Epoch: 19, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4125838279724121
Epoch: 20, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.47191905975341797
Epoch: 21, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4377286434173584
Epoch: 22, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4956626892089844
Epoch: 23, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 167491
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2987589836120605
Epoch: 1, Steps: 1 | Train Loss: 1.323 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5197567939758301
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5126309394836426
Epoch: 3, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.49460744857788086
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.48770952224731445
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.5226397514343262
Epoch: 6, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5342452526092529
Epoch: 7, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5049793720245361
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5528562068939209
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5667035579681396
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.44463229179382324
Epoch: 11, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5010857582092285
Epoch: 12, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.49411630630493164
Epoch: 13, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4253382682800293
Epoch: 14, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.3909311294555664
Epoch: 15, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.42136597633361816
Epoch: 16, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4334285259246826
Epoch: 17, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.496218204498291
Epoch: 18, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5182406902313232
Epoch: 19, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.516387939453125
Epoch: 20, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5394330024719238
Epoch: 21, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5882103443145752
Epoch: 22, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5250327587127686
Epoch: 23, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.48201751708984375
Epoch: 24, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4757113456726074
Epoch: 25, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 163139
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3953378200531006
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5118503570556641
Epoch: 2, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.210 Vali Acc: 0.133 Test Loss: 1.210 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.5823154449462891
Epoch: 3, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.209 Vali Acc: 0.133 Test Loss: 1.209 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.4693572521209717
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.209 Vali Acc: 0.133 Test Loss: 1.209 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 5 cost time: 0.5816402435302734
Epoch: 5, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 6 cost time: 0.553896427154541
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.5045411586761475
Epoch: 7, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.5505955219268799
Epoch: 8, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.4873654842376709
Epoch: 9, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.47628021240234375
Epoch: 10, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.40086913108825684
Epoch: 11, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.45867180824279785
Epoch: 12, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5559110641479492
Epoch: 13, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5541751384735107
Epoch: 14, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.42766809463500977
Epoch: 15, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5063378810882568
Epoch: 16, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.46576380729675293
Epoch: 17, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.511106014251709
Epoch: 18, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5259990692138672
Epoch: 19, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4756789207458496
Epoch: 20, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4877169132232666
Epoch: 21, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4549696445465088
Epoch: 22, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5746612548828125
Epoch: 23, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5188474655151367
Epoch: 24, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.436234712600708
Epoch: 25, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5077366828918457
Epoch: 26, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5285096168518066
Epoch: 27, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5338625907897949
Epoch: 28, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.49563050270080566
Epoch: 29, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5011980533599854
Epoch: 30, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5835471153259277
Epoch: 31, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7564287185668945
Epoch: 32, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5244183540344238
Epoch: 33, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.273 Vali Acc: 0.400 Test Loss: 1.273 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5382723808288574
Epoch: 34, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 161859
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.355046272277832
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5342755317687988
Epoch: 2, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6228699684143066
Epoch: 3, Steps: 1 | Train Loss: 1.399 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5187878608703613
Epoch: 4, Steps: 1 | Train Loss: 1.329 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5350778102874756
Epoch: 5, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5253803730010986
Epoch: 6, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6102554798126221
Epoch: 7, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.49994778633117676
Epoch: 8, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5292811393737793
Epoch: 9, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4623403549194336
Epoch: 10, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4653620719909668
Epoch: 11, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 161219
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.175684928894043
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.504993200302124
Epoch: 2, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5298771858215332
Epoch: 3, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5149326324462891
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6142821311950684
Epoch: 5, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5361616611480713
Epoch: 6, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5928096771240234
Epoch: 7, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6162886619567871
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.584857702255249
Epoch: 9, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5425021648406982
Epoch: 10, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5356371402740479
Epoch: 11, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.662266731262207
Epoch: 12, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 162115
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.230778694152832
Epoch: 1, Steps: 1 | Train Loss: 1.245 Vali Loss: 0.995 Vali Acc: 0.400 Test Loss: 0.995 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.5257630348205566
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 0.993 Vali Acc: 0.400 Test Loss: 0.993 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.4804401397705078
Epoch: 3, Steps: 1 | Train Loss: 1.230 Vali Loss: 0.991 Vali Acc: 0.400 Test Loss: 0.991 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.5436761379241943
Epoch: 4, Steps: 1 | Train Loss: 1.214 Vali Loss: 0.989 Vali Acc: 0.400 Test Loss: 0.989 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.48172426223754883
Epoch: 5, Steps: 1 | Train Loss: 1.134 Vali Loss: 0.987 Vali Acc: 0.400 Test Loss: 0.987 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.44032859802246094
Epoch: 6, Steps: 1 | Train Loss: 1.251 Vali Loss: 0.986 Vali Acc: 0.400 Test Loss: 0.986 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.5302920341491699
Epoch: 7, Steps: 1 | Train Loss: 1.174 Vali Loss: 0.984 Vali Acc: 0.400 Test Loss: 0.984 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 0.4827754497528076
Epoch: 8, Steps: 1 | Train Loss: 1.197 Vali Loss: 0.983 Vali Acc: 0.400 Test Loss: 0.983 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.4850924015045166
Epoch: 9, Steps: 1 | Train Loss: 1.044 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.46770429611206055
Epoch: 10, Steps: 1 | Train Loss: 1.027 Vali Loss: 0.980 Vali Acc: 0.467 Test Loss: 0.980 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 11 cost time: 0.4419729709625244
Epoch: 11, Steps: 1 | Train Loss: 1.100 Vali Loss: 0.979 Vali Acc: 0.467 Test Loss: 0.979 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 12 cost time: 0.4652566909790039
Epoch: 12, Steps: 1 | Train Loss: 1.068 Vali Loss: 0.977 Vali Acc: 0.467 Test Loss: 0.977 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 13 cost time: 0.46244335174560547
Epoch: 13, Steps: 1 | Train Loss: 0.847 Vali Loss: 0.976 Vali Acc: 0.467 Test Loss: 0.976 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 14 cost time: 0.5404713153839111
Epoch: 14, Steps: 1 | Train Loss: 0.816 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 15 cost time: 0.46619343757629395
Epoch: 15, Steps: 1 | Train Loss: 0.821 Vali Loss: 0.974 Vali Acc: 0.467 Test Loss: 0.974 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 16 cost time: 0.4625966548919678
Epoch: 16, Steps: 1 | Train Loss: 0.967 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 17 cost time: 0.418567419052124
Epoch: 17, Steps: 1 | Train Loss: 0.829 Vali Loss: 0.971 Vali Acc: 0.467 Test Loss: 0.971 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 0.44718384742736816
Epoch: 18, Steps: 1 | Train Loss: 0.817 Vali Loss: 0.970 Vali Acc: 0.467 Test Loss: 0.970 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 0.4378337860107422
Epoch: 19, Steps: 1 | Train Loss: 0.740 Vali Loss: 0.969 Vali Acc: 0.467 Test Loss: 0.969 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 20 cost time: 0.4703097343444824
Epoch: 20, Steps: 1 | Train Loss: 0.800 Vali Loss: 0.968 Vali Acc: 0.467 Test Loss: 0.968 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 21 cost time: 0.43314385414123535
Epoch: 21, Steps: 1 | Train Loss: 0.698 Vali Loss: 0.968 Vali Acc: 0.467 Test Loss: 0.968 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 22 cost time: 0.4517238140106201
Epoch: 22, Steps: 1 | Train Loss: 0.741 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 23 cost time: 0.5460927486419678
Epoch: 23, Steps: 1 | Train Loss: 0.539 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 24 cost time: 0.4669783115386963
Epoch: 24, Steps: 1 | Train Loss: 0.618 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5047857761383057
Epoch: 25, Steps: 1 | Train Loss: 0.538 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5283567905426025
Epoch: 26, Steps: 1 | Train Loss: 0.561 Vali Loss: 0.967 Vali Acc: 0.467 Test Loss: 0.967 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.47779297828674316
Epoch: 27, Steps: 1 | Train Loss: 0.505 Vali Loss: 0.967 Vali Acc: 0.467 Test Loss: 0.967 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.481367826461792
Epoch: 28, Steps: 1 | Train Loss: 0.565 Vali Loss: 0.968 Vali Acc: 0.533 Test Loss: 0.968 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 29 cost time: 0.4822068214416504
Epoch: 29, Steps: 1 | Train Loss: 0.493 Vali Loss: 0.970 Vali Acc: 0.467 Test Loss: 0.970 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.46553587913513184
Epoch: 30, Steps: 1 | Train Loss: 0.407 Vali Loss: 0.972 Vali Acc: 0.400 Test Loss: 0.972 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4844532012939453
Epoch: 31, Steps: 1 | Train Loss: 0.424 Vali Loss: 0.974 Vali Acc: 0.400 Test Loss: 0.974 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.543226957321167
Epoch: 32, Steps: 1 | Train Loss: 0.342 Vali Loss: 0.975 Vali Acc: 0.400 Test Loss: 0.975 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5319535732269287
Epoch: 33, Steps: 1 | Train Loss: 0.314 Vali Loss: 0.977 Vali Acc: 0.400 Test Loss: 0.977 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5279052257537842
Epoch: 34, Steps: 1 | Train Loss: 0.283 Vali Loss: 0.979 Vali Acc: 0.400 Test Loss: 0.979 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.48153162002563477
Epoch: 35, Steps: 1 | Train Loss: 0.360 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.515845775604248
Epoch: 36, Steps: 1 | Train Loss: 0.259 Vali Loss: 0.986 Vali Acc: 0.400 Test Loss: 0.986 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5075280666351318
Epoch: 37, Steps: 1 | Train Loss: 0.237 Vali Loss: 0.990 Vali Acc: 0.400 Test Loss: 0.990 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.4675564765930176
Epoch: 38, Steps: 1 | Train Loss: 0.194 Vali Loss: 0.993 Vali Acc: 0.400 Test Loss: 0.993 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 163395
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2956600189208984
Epoch: 1, Steps: 1 | Train Loss: 1.388 Vali Loss: 1.531 Vali Acc: 0.333 Test Loss: 1.531 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 0.3975718021392822
Epoch: 2, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.479 Vali Acc: 0.333 Test Loss: 1.479 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.44196200370788574
Epoch: 3, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.433 Vali Acc: 0.333 Test Loss: 1.433 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 0.39391183853149414
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.395 Vali Acc: 0.333 Test Loss: 1.395 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 0.44175291061401367
Epoch: 5, Steps: 1 | Train Loss: 1.332 Vali Loss: 1.361 Vali Acc: 0.333 Test Loss: 1.361 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.4834115505218506
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.336 Vali Acc: 0.267 Test Loss: 1.336 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4270031452178955
Epoch: 7, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.311 Vali Acc: 0.333 Test Loss: 1.311 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.4336395263671875
Epoch: 8, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.44405198097229004
Epoch: 9, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5073039531707764
Epoch: 10, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.4259154796600342
Epoch: 11, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40840840339660645
Epoch: 12, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4496934413909912
Epoch: 13, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4791593551635742
Epoch: 14, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6239378452301025
Epoch: 15, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4769597053527832
Epoch: 16, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.3876309394836426
Epoch: 17, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4612400531768799
Epoch: 18, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.316 Vali Acc: 0.267 Test Loss: 1.316 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5455951690673828
Epoch: 19, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.334 Vali Acc: 0.267 Test Loss: 1.334 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4870333671569824
Epoch: 20, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.357 Vali Acc: 0.400 Test Loss: 1.357 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399986).  Saving model ...
Epoch: 21 cost time: 0.4509291648864746
Epoch: 21, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.380 Vali Acc: 0.400 Test Loss: 1.380 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5582938194274902
Epoch: 22, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5561618804931641
Epoch: 23, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.413 Vali Acc: 0.333 Test Loss: 1.413 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5470321178436279
Epoch: 24, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.425 Vali Acc: 0.333 Test Loss: 1.425 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4956841468811035
Epoch: 25, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.435 Vali Acc: 0.333 Test Loss: 1.435 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.45685458183288574
Epoch: 26, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.440 Vali Acc: 0.267 Test Loss: 1.440 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.47928714752197266
Epoch: 27, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.444 Vali Acc: 0.267 Test Loss: 1.444 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6933085918426514
Epoch: 28, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.448 Vali Acc: 0.267 Test Loss: 1.448 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.47196507453918457
Epoch: 29, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.455 Vali Acc: 0.267 Test Loss: 1.455 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6132175922393799
Epoch: 30, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.467 Vali Acc: 0.267 Test Loss: 1.467 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 132291
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3221850395202637
Epoch: 1, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.500286340713501
Epoch: 2, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.43140172958374023
Epoch: 3, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5175044536590576
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5755677223205566
Epoch: 5, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5600557327270508
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5110063552856445
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4847121238708496
Epoch: 8, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4738011360168457
Epoch: 9, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4686455726623535
Epoch: 10, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4318690299987793
Epoch: 11, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.44285035133361816
Epoch: 12, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.48122477531433105
Epoch: 13, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5762786865234375
Epoch: 14, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4491438865661621
Epoch: 15, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 117955
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0598323345184326
Epoch: 1, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.366 Vali Acc: 0.333 Test Loss: 1.366 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.6108710765838623
Epoch: 2, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.352 Vali Acc: 0.333 Test Loss: 1.352 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.5108809471130371
Epoch: 3, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.340 Vali Acc: 0.333 Test Loss: 1.340 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.4910449981689453
Epoch: 4, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.331 Vali Acc: 0.333 Test Loss: 1.331 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.5928430557250977
Epoch: 5, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.322 Vali Acc: 0.333 Test Loss: 1.322 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.548590898513794
Epoch: 6, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 0.5655431747436523
Epoch: 7, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.308 Vali Acc: 0.333 Test Loss: 1.308 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.5277554988861084
Epoch: 8, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4963412284851074
Epoch: 9, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.682868242263794
Epoch: 10, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5046365261077881
Epoch: 11, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6641688346862793
Epoch: 12, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 13 cost time: 0.5862388610839844
Epoch: 13, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 14 cost time: 0.6020400524139404
Epoch: 14, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 15 cost time: 0.5944592952728271
Epoch: 15, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 16 cost time: 0.5842225551605225
Epoch: 16, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.5442280769348145
Epoch: 17, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.48514318466186523
Epoch: 18, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.5627343654632568
Epoch: 19, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6677978038787842
Epoch: 20, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5022530555725098
Epoch: 21, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5528039932250977
Epoch: 22, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5731525421142578
Epoch: 23, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6874682903289795
Epoch: 24, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.289 Vali Acc: 0.267 Test Loss: 1.289 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.593280553817749
Epoch: 25, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5469410419464111
Epoch: 26, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6061301231384277
Epoch: 27, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5117743015289307
Epoch: 28, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 113603
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.065199851989746
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.328 Vali Acc: 0.333 Test Loss: 1.328 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.4259634017944336
Epoch: 2, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.4946634769439697
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.43274855613708496
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4365358352661133
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.448702335357666
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.47930240631103516
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5151083469390869
Epoch: 8, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5404951572418213
Epoch: 9, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.48253798484802246
Epoch: 10, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.53009033203125
Epoch: 11, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.5552535057067871
Epoch: 12, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.47314882278442383
Epoch: 13, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.5637061595916748
Epoch: 14, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6007692813873291
Epoch: 15, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5506391525268555
Epoch: 16, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.48394227027893066
Epoch: 17, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.49560117721557617
Epoch: 18, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5395958423614502
Epoch: 19, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5846755504608154
Epoch: 20, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4465482234954834
Epoch: 21, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4888172149658203
Epoch: 22, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 0.4777827262878418
Epoch: 23, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5047454833984375
Epoch: 24, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5480620861053467
Epoch: 25, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.48021888732910156
Epoch: 26, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5388438701629639
Epoch: 27, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4725308418273926
Epoch: 28, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6171298027038574
Epoch: 29, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.259 Vali Acc: 0.467 Test Loss: 1.259 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 30 cost time: 0.4954090118408203
Epoch: 30, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5651133060455322
Epoch: 31, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.47557830810546875
Epoch: 32, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.273 Vali Acc: 0.400 Test Loss: 1.273 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.540884256362915
Epoch: 33, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4839050769805908
Epoch: 34, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4880955219268799
Epoch: 35, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.437424898147583
Epoch: 36, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.45862340927124023
Epoch: 37, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.44093942642211914
Epoch: 38, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.454423189163208
Epoch: 39, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 112323
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1133737564086914
Epoch: 1, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.42440056800842285
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.49801039695739746
Epoch: 3, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.43062877655029297
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.106 Vali Acc: 0.533 Test Loss: 1.106 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.49135923385620117
Epoch: 5, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4694819450378418
Epoch: 6, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4556090831756592
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.46845030784606934
Epoch: 8, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5823624134063721
Epoch: 9, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4583272933959961
Epoch: 10, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5045466423034668
Epoch: 11, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.448270320892334
Epoch: 12, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5061893463134766
Epoch: 13, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.45958542823791504
Epoch: 14, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 111683
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.285580635070801
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.48635315895080566
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5437846183776855
Epoch: 3, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.4867844581604004
Epoch: 4, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.4394521713256836
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3768117427825928
Epoch: 6, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6867415904998779
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.48639845848083496
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5145139694213867
Epoch: 9, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.4926939010620117
Epoch: 10, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.46102356910705566
Epoch: 11, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.47034192085266113
Epoch: 12, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.506929874420166
Epoch: 13, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.3903806209564209
Epoch: 14, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.4260995388031006
Epoch: 15, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.5275223255157471
Epoch: 16, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.5928707122802734
Epoch: 17, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.4897630214691162
Epoch: 18, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.47898268699645996
Epoch: 19, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.48317909240722656
Epoch: 20, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5369536876678467
Epoch: 21, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5644187927246094
Epoch: 22, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5738420486450195
Epoch: 23, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7647221088409424
Epoch: 24, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5262954235076904
Epoch: 25, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5252785682678223
Epoch: 26, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5390841960906982
Epoch: 27, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 112579
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4470510482788086
Epoch: 1, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4972555637359619
Epoch: 2, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5270648002624512
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.503220796585083
Epoch: 4, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.506394624710083
Epoch: 5, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.524782657623291
Epoch: 6, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.46821093559265137
Epoch: 7, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.478609561920166
Epoch: 8, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5320882797241211
Epoch: 9, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.598686933517456
Epoch: 10, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.519451379776001
Epoch: 11, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5068578720092773
Epoch: 12, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.4401392936706543
Epoch: 13, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.41572141647338867
Epoch: 14, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.5008325576782227
Epoch: 15, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.44173288345336914
Epoch: 16, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.5173776149749756
Epoch: 17, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.4626123905181885
Epoch: 18, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.49149513244628906
Epoch: 19, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4263758659362793
Epoch: 20, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.47319459915161133
Epoch: 21, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4146435260772705
Epoch: 22, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.40671873092651367
Epoch: 23, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5228786468505859
Epoch: 24, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.47983884811401367
Epoch: 25, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.45780038833618164
Epoch: 26, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4608159065246582
Epoch: 27, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.43944740295410156
Epoch: 28, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.504594087600708
Epoch: 29, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.46242189407348633
Epoch: 30, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5220785140991211
Epoch: 31, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5423166751861572
Epoch: 32, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5299172401428223
Epoch: 33, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.49659252166748047
Epoch: 34, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5036516189575195
Epoch: 35, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 113859
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.312934398651123
Epoch: 1, Steps: 1 | Train Loss: 1.339 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7042725086212158
Epoch: 2, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5489888191223145
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5383896827697754
Epoch: 4, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.108 Vali Acc: 0.133 Test Loss: 1.108 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5627162456512451
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5652010440826416
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5433814525604248
Epoch: 7, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6177949905395508
Epoch: 8, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.66575026512146
Epoch: 9, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5432209968566895
Epoch: 10, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5505149364471436
Epoch: 11, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.564680814743042
Epoch: 12, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 107523
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3081722259521484
Epoch: 1, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.40604567527770996
Epoch: 2, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.4623887538909912
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.214 Vali Acc: 0.467 Test Loss: 1.214 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.45688676834106445
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.214 Vali Acc: 0.467 Test Loss: 1.214 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.43622279167175293
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.45075440406799316
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.212 Vali Acc: 0.467 Test Loss: 1.212 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.4634969234466553
Epoch: 7, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4549751281738281
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5683813095092773
Epoch: 9, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.48912715911865234
Epoch: 10, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5172460079193115
Epoch: 11, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.49727296829223633
Epoch: 12, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5413596630096436
Epoch: 13, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5649561882019043
Epoch: 14, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5696897506713867
Epoch: 15, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4597132205963135
Epoch: 16, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 93187
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.336514949798584
Epoch: 1, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.5557060241699219
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.5909450054168701
Epoch: 3, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.275 Vali Acc: 0.400 Test Loss: 1.275 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.7710740566253662
Epoch: 4, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5096964836120605
Epoch: 5, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.265 Vali Acc: 0.267 Test Loss: 1.265 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5624997615814209
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6222198009490967
Epoch: 7, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5767743587493896
Epoch: 8, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.606173038482666
Epoch: 9, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.537757396697998
Epoch: 10, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6690356731414795
Epoch: 11, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4575498104095459
Epoch: 12, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5358712673187256
Epoch: 13, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 88835
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.169463872909546
Epoch: 1, Steps: 1 | Train Loss: 1.307 Vali Loss: 0.938 Vali Acc: 0.600 Test Loss: 0.938 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 0.5330650806427002
Epoch: 2, Steps: 1 | Train Loss: 1.359 Vali Loss: 0.932 Vali Acc: 0.533 Test Loss: 0.932 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.44231247901916504
Epoch: 3, Steps: 1 | Train Loss: 1.400 Vali Loss: 0.927 Vali Acc: 0.533 Test Loss: 0.927 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4139389991760254
Epoch: 4, Steps: 1 | Train Loss: 1.433 Vali Loss: 0.923 Vali Acc: 0.600 Test Loss: 0.923 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 5 cost time: 0.554032564163208
Epoch: 5, Steps: 1 | Train Loss: 1.311 Vali Loss: 0.919 Vali Acc: 0.600 Test Loss: 0.919 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 0.5247864723205566
Epoch: 6, Steps: 1 | Train Loss: 1.225 Vali Loss: 0.915 Vali Acc: 0.667 Test Loss: 0.915 Test Acc: 0.667
Validation loss decreased (-0.599991 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 0.5213782787322998
Epoch: 7, Steps: 1 | Train Loss: 1.375 Vali Loss: 0.912 Vali Acc: 0.667 Test Loss: 0.912 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 0.5543210506439209
Epoch: 8, Steps: 1 | Train Loss: 1.245 Vali Loss: 0.909 Vali Acc: 0.667 Test Loss: 0.909 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 0.5851716995239258
Epoch: 9, Steps: 1 | Train Loss: 1.183 Vali Loss: 0.907 Vali Acc: 0.600 Test Loss: 0.907 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5768210887908936
Epoch: 10, Steps: 1 | Train Loss: 1.066 Vali Loss: 0.905 Vali Acc: 0.533 Test Loss: 0.905 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.572035551071167
Epoch: 11, Steps: 1 | Train Loss: 1.109 Vali Loss: 0.903 Vali Acc: 0.533 Test Loss: 0.903 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5535993576049805
Epoch: 12, Steps: 1 | Train Loss: 1.026 Vali Loss: 0.901 Vali Acc: 0.533 Test Loss: 0.901 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5094931125640869
Epoch: 13, Steps: 1 | Train Loss: 1.116 Vali Loss: 0.899 Vali Acc: 0.533 Test Loss: 0.899 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5400817394256592
Epoch: 14, Steps: 1 | Train Loss: 1.039 Vali Loss: 0.898 Vali Acc: 0.533 Test Loss: 0.898 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5315682888031006
Epoch: 15, Steps: 1 | Train Loss: 0.988 Vali Loss: 0.897 Vali Acc: 0.600 Test Loss: 0.897 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5882601737976074
Epoch: 16, Steps: 1 | Train Loss: 1.002 Vali Loss: 0.896 Vali Acc: 0.600 Test Loss: 0.896 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5729713439941406
Epoch: 17, Steps: 1 | Train Loss: 0.864 Vali Loss: 0.895 Vali Acc: 0.600 Test Loss: 0.895 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4987525939941406
Epoch: 18, Steps: 1 | Train Loss: 0.878 Vali Loss: 0.894 Vali Acc: 0.600 Test Loss: 0.894 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 87555
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4357852935791016
Epoch: 1, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6331453323364258
Epoch: 2, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.4288647174835205
Epoch: 3, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.6169483661651611
Epoch: 4, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.180 Vali Acc: 0.533 Test Loss: 1.180 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.4535496234893799
Epoch: 5, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.175 Vali Acc: 0.533 Test Loss: 1.175 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.5433738231658936
Epoch: 6, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.172 Vali Acc: 0.533 Test Loss: 1.172 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.5175166130065918
Epoch: 7, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.170 Vali Acc: 0.533 Test Loss: 1.170 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.5292413234710693
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.4716823101043701
Epoch: 9, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.49367761611938477
Epoch: 10, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6044180393218994
Epoch: 11, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5206558704376221
Epoch: 12, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6560816764831543
Epoch: 13, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5657620429992676
Epoch: 14, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5262765884399414
Epoch: 15, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5637598037719727
Epoch: 16, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5259926319122314
Epoch: 17, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6148495674133301
Epoch: 18, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 86915
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5071496963500977
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.46080517768859863
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5072808265686035
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5675656795501709
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4709806442260742
Epoch: 5, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5892074108123779
Epoch: 6, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.48915696144104004
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5943167209625244
Epoch: 8, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5558984279632568
Epoch: 9, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5874462127685547
Epoch: 10, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4775257110595703
Epoch: 11, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5569243431091309
Epoch: 12, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.49489378929138184
Epoch: 13, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5208353996276855
Epoch: 14, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 87811
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2030439376831055
Epoch: 1, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.4285404682159424
Epoch: 2, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.4308485984802246
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.4962434768676758
Epoch: 4, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.4012172222137451
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5070345401763916
Epoch: 6, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4429512023925781
Epoch: 7, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.42185544967651367
Epoch: 8, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5085322856903076
Epoch: 9, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4581940174102783
Epoch: 10, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.464428186416626
Epoch: 11, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.272 Vali Acc: 0.133 Test Loss: 1.272 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6001901626586914
Epoch: 12, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.273 Vali Acc: 0.133 Test Loss: 1.273 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.488955020904541
Epoch: 13, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.274 Vali Acc: 0.133 Test Loss: 1.274 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5256390571594238
Epoch: 14, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm64_nh16_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 89091
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.343916893005371
Epoch: 1, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.46379947662353516
Epoch: 2, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5123250484466553
Epoch: 3, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.6123597621917725
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.5484757423400879
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.5104653835296631
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.5676350593566895
Epoch: 7, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5079352855682373
Epoch: 8, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.584484338760376
Epoch: 9, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5167455673217773
Epoch: 10, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5473430156707764
Epoch: 11, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.5193934440612793
Epoch: 12, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5093965530395508
Epoch: 13, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.555962085723877
Epoch: 14, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.578885555267334
Epoch: 15, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4780769348144531
Epoch: 16, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.49318695068359375
Epoch: 17, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4710559844970703
Epoch: 18, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.49251222610473633
Epoch: 19, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.49306511878967285
Epoch: 20, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5154376029968262
Epoch: 21, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5503385066986084
Epoch: 22, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.48702359199523926
Epoch: 23, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.43509507179260254
Epoch: 24, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5942225456237793
Epoch: 25, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.510143518447876
Epoch: 26, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 79011
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4887375831604004
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.48404526710510254
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.46226954460144043
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5374965667724609
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.4510364532470703
Epoch: 5, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.45879697799682617
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.4130256175994873
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.41587209701538086
Epoch: 8, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.43788838386535645
Epoch: 9, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.4298431873321533
Epoch: 10, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5112099647521973
Epoch: 11, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4446992874145508
Epoch: 12, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4845855236053467
Epoch: 13, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4840421676635742
Epoch: 14, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.45938801765441895
Epoch: 15, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4712357521057129
Epoch: 16, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5763552188873291
Epoch: 17, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4450652599334717
Epoch: 18, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5022451877593994
Epoch: 19, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 71843
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1636428833007812
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.42659640312194824
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6577770709991455
Epoch: 3, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.46531224250793457
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.42946863174438477
Epoch: 5, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.49141740798950195
Epoch: 6, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5357239246368408
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.43990063667297363
Epoch: 8, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4695422649383545
Epoch: 9, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4928269386291504
Epoch: 10, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5282306671142578
Epoch: 11, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5281891822814941
Epoch: 12, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.48750829696655273
Epoch: 13, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4532623291015625
Epoch: 14, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5444483757019043
Epoch: 15, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5720264911651611
Epoch: 16, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.5286953449249268
Epoch: 17, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.5694437026977539
Epoch: 18, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.5822381973266602
Epoch: 19, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7788934707641602
Epoch: 20, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6603329181671143
Epoch: 21, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6292710304260254
Epoch: 22, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6427736282348633
Epoch: 23, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.619408130645752
Epoch: 24, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5300514698028564
Epoch: 25, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6518764495849609
Epoch: 26, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4947490692138672
Epoch: 27, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5256984233856201
Epoch: 28, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.5840904712677002
Epoch: 29, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5148239135742188
Epoch: 30, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5629408359527588
Epoch: 31, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5903732776641846
Epoch: 32, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5472996234893799
Epoch: 33, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.543670654296875
Epoch: 34, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5437817573547363
Epoch: 35, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5454473495483398
Epoch: 36, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5880367755889893
Epoch: 37, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6024374961853027
Epoch: 38, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 69667
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1219472885131836
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5152997970581055
Epoch: 2, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.49414801597595215
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.4916987419128418
Epoch: 4, Steps: 1 | Train Loss: 1.444 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4363217353820801
Epoch: 5, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.5148434638977051
Epoch: 6, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5600402355194092
Epoch: 7, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5105156898498535
Epoch: 8, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.48046040534973145
Epoch: 9, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5356342792510986
Epoch: 10, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5529463291168213
Epoch: 11, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5406093597412109
Epoch: 12, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.45670104026794434
Epoch: 13, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.509629487991333
Epoch: 14, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.4852735996246338
Epoch: 15, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4313023090362549
Epoch: 16, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5897729396820068
Epoch: 17, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.644277811050415
Epoch: 18, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5400493144989014
Epoch: 19, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.533592939376831
Epoch: 20, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5508198738098145
Epoch: 21, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.537329912185669
Epoch: 22, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6307809352874756
Epoch: 23, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6450676918029785
Epoch: 24, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 69027
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.357581853866577
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4657878875732422
Epoch: 2, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4497337341308594
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49329447746276855
Epoch: 4, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5696790218353271
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5483086109161377
Epoch: 6, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4512624740600586
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5190215110778809
Epoch: 8, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5552229881286621
Epoch: 9, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.5091302394866943
Epoch: 10, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.7382466793060303
Epoch: 11, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.524916410446167
Epoch: 12, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3955562114715576
Epoch: 13, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5763211250305176
Epoch: 14, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.49520277976989746
Epoch: 15, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5693271160125732
Epoch: 16, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.4421374797821045
Epoch: 17, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.44779253005981445
Epoch: 18, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.44303178787231445
Epoch: 19, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5130219459533691
Epoch: 20, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4779834747314453
Epoch: 21, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4935896396636963
Epoch: 22, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.49462151527404785
Epoch: 23, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.432542085647583
Epoch: 24, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4776012897491455
Epoch: 25, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5005404949188232
Epoch: 26, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4388866424560547
Epoch: 27, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5400798320770264
Epoch: 28, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 68707
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.293518304824829
Epoch: 1, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5468294620513916
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5873873233795166
Epoch: 3, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5447912216186523
Epoch: 4, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.509636640548706
Epoch: 5, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6286695003509521
Epoch: 6, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4924328327178955
Epoch: 7, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5874419212341309
Epoch: 8, Steps: 1 | Train Loss: 1.257 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.6417720317840576
Epoch: 9, Steps: 1 | Train Loss: 1.326 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5981519222259521
Epoch: 10, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7316668033599854
Epoch: 11, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5757782459259033
Epoch: 12, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6126306056976318
Epoch: 13, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5565121173858643
Epoch: 14, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5933854579925537
Epoch: 15, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5595793724060059
Epoch: 16, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6026413440704346
Epoch: 17, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5733091831207275
Epoch: 18, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 69155
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1310179233551025
Epoch: 1, Steps: 1 | Train Loss: 1.357 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.45307278633117676
Epoch: 2, Steps: 1 | Train Loss: 1.532 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4863755702972412
Epoch: 3, Steps: 1 | Train Loss: 1.407 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.44231653213500977
Epoch: 4, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47528719902038574
Epoch: 5, Steps: 1 | Train Loss: 1.380 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.45517706871032715
Epoch: 6, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3869936466217041
Epoch: 7, Steps: 1 | Train Loss: 1.352 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5054471492767334
Epoch: 8, Steps: 1 | Train Loss: 1.349 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.4635772705078125
Epoch: 9, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.45397520065307617
Epoch: 10, Steps: 1 | Train Loss: 1.379 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5304262638092041
Epoch: 11, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5287032127380371
Epoch: 12, Steps: 1 | Train Loss: 1.391 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6544098854064941
Epoch: 13, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.46793627738952637
Epoch: 14, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4446382522583008
Epoch: 15, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5267937183380127
Epoch: 16, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.47990965843200684
Epoch: 17, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4616217613220215
Epoch: 18, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 69795
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1471400260925293
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5363960266113281
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5143139362335205
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4514012336730957
Epoch: 4, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49373793601989746
Epoch: 5, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.206 Vali Acc: 0.133 Test Loss: 1.206 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.50412917137146
Epoch: 6, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5339901447296143
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4562704563140869
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.214 Vali Acc: 0.133 Test Loss: 1.214 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.47811126708984375
Epoch: 9, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4170684814453125
Epoch: 10, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.45413947105407715
Epoch: 11, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 0.5158095359802246
Epoch: 12, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4527573585510254
Epoch: 13, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49231719970703125
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4329042434692383
Epoch: 15, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5449597835540771
Epoch: 16, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4626047611236572
Epoch: 17, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.45412111282348633
Epoch: 18, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5024173259735107
Epoch: 19, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4988870620727539
Epoch: 20, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5294468402862549
Epoch: 21, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 54051
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.326547384262085
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.5663297176361084
Epoch: 2, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5945816040039062
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5121827125549316
Epoch: 4, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.554455041885376
Epoch: 5, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5600590705871582
Epoch: 6, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5544657707214355
Epoch: 7, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.49276304244995117
Epoch: 8, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5414643287658691
Epoch: 9, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5913960933685303
Epoch: 10, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6185696125030518
Epoch: 11, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 46883
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.259810447692871
Epoch: 1, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5047495365142822
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.568483829498291
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5820238590240479
Epoch: 4, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6751034259796143
Epoch: 5, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4957442283630371
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5249543190002441
Epoch: 7, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.49875617027282715
Epoch: 8, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49461817741394043
Epoch: 9, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5913436412811279
Epoch: 10, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4987821578979492
Epoch: 11, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 44707
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.294767141342163
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.45336031913757324
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5532808303833008
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4847731590270996
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5568230152130127
Epoch: 5, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7385945320129395
Epoch: 6, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5736691951751709
Epoch: 7, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4572422504425049
Epoch: 8, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4644308090209961
Epoch: 9, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4906296730041504
Epoch: 10, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6077566146850586
Epoch: 11, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 44067
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2666923999786377
Epoch: 1, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4708418846130371
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5248854160308838
Epoch: 3, Steps: 1 | Train Loss: 1.462 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.44545578956604004
Epoch: 4, Steps: 1 | Train Loss: 1.327 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4916493892669678
Epoch: 5, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.49424028396606445
Epoch: 6, Steps: 1 | Train Loss: 1.295 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4768521785736084
Epoch: 7, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5346112251281738
Epoch: 8, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.48415040969848633
Epoch: 9, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4835035800933838
Epoch: 10, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5243191719055176
Epoch: 11, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5447812080383301
Epoch: 12, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.45800113677978516
Epoch: 13, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4914994239807129
Epoch: 14, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5313363075256348
Epoch: 15, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4590179920196533
Epoch: 16, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4743030071258545
Epoch: 17, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.500868558883667
Epoch: 18, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.5598011016845703
Epoch: 19, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.5468564033508301
Epoch: 20, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.47849345207214355
Epoch: 21, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.5929195880889893
Epoch: 22, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.5168912410736084
Epoch: 23, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.49839043617248535
Epoch: 24, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.561314582824707
Epoch: 25, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.4559197425842285
Epoch: 26, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5919435024261475
Epoch: 27, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5123105049133301
Epoch: 28, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4473710060119629
Epoch: 29, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6119418144226074
Epoch: 30, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6101663112640381
Epoch: 31, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5337119102478027
Epoch: 32, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5305507183074951
Epoch: 33, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5018835067749023
Epoch: 34, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5578875541687012
Epoch: 35, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 43747
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.172877073287964
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4783756732940674
Epoch: 2, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5229313373565674
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4272727966308594
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5344235897064209
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5285985469818115
Epoch: 6, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.49012088775634766
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.46256470680236816
Epoch: 8, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5404922962188721
Epoch: 9, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.523127555847168
Epoch: 10, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5321714878082275
Epoch: 11, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.5108199119567871
Epoch: 12, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5282974243164062
Epoch: 13, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4598870277404785
Epoch: 14, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.49777650833129883
Epoch: 15, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5825798511505127
Epoch: 16, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5165448188781738
Epoch: 17, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.48715758323669434
Epoch: 18, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.45600342750549316
Epoch: 19, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4388706684112549
Epoch: 20, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.3991878032684326
Epoch: 21, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44195
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0663371086120605
Epoch: 1, Steps: 1 | Train Loss: 1.358 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5231292247772217
Epoch: 2, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.46676135063171387
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.47644710540771484
Epoch: 4, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5707321166992188
Epoch: 5, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5979838371276855
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5471560955047607
Epoch: 7, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4892430305480957
Epoch: 8, Steps: 1 | Train Loss: 1.312 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5174915790557861
Epoch: 9, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5446395874023438
Epoch: 10, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5196487903594971
Epoch: 11, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.46462035179138184
Epoch: 12, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5136926174163818
Epoch: 13, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5361332893371582
Epoch: 14, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.46544480323791504
Epoch: 15, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5100748538970947
Epoch: 16, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5617971420288086
Epoch: 17, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.47474050521850586
Epoch: 18, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5168111324310303
Epoch: 19, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5358829498291016
Epoch: 20, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4553697109222412
Epoch: 21, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 44835
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.34546160697937
Epoch: 1, Steps: 1 | Train Loss: 1.412 Vali Loss: 1.377 Vali Acc: 0.333 Test Loss: 1.377 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.4548664093017578
Epoch: 2, Steps: 1 | Train Loss: 1.326 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.482114315032959
Epoch: 3, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.49538660049438477
Epoch: 4, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.4754958152770996
Epoch: 5, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.4338562488555908
Epoch: 6, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.4300076961517334
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.570720911026001
Epoch: 8, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5481374263763428
Epoch: 9, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.47855377197265625
Epoch: 10, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6120455265045166
Epoch: 11, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.43151164054870605
Epoch: 12, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5220675468444824
Epoch: 13, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.5011122226715088
Epoch: 14, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.4443943500518799
Epoch: 15, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.49446821212768555
Epoch: 16, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.4684908390045166
Epoch: 17, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.46842432022094727
Epoch: 18, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.43006348609924316
Epoch: 19, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.480924129486084
Epoch: 20, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.542402982711792
Epoch: 21, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.47473764419555664
Epoch: 22, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4940061569213867
Epoch: 23, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.43894314765930176
Epoch: 24, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4162936210632324
Epoch: 25, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6038937568664551
Epoch: 26, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 41571
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.130049228668213
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.508 Vali Acc: 0.200 Test Loss: 1.508 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.48087620735168457
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.494 Vali Acc: 0.200 Test Loss: 1.494 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.4450874328613281
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.483 Vali Acc: 0.200 Test Loss: 1.483 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 0.48680567741394043
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.472 Vali Acc: 0.200 Test Loss: 1.472 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 0.48877739906311035
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.464 Vali Acc: 0.200 Test Loss: 1.464 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 6 cost time: 0.4060382843017578
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.459 Vali Acc: 0.133 Test Loss: 1.459 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5016365051269531
Epoch: 7, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.455 Vali Acc: 0.133 Test Loss: 1.455 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5644147396087646
Epoch: 8, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.451 Vali Acc: 0.133 Test Loss: 1.451 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.42188215255737305
Epoch: 9, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.448 Vali Acc: 0.133 Test Loss: 1.448 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4491117000579834
Epoch: 10, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.445 Vali Acc: 0.133 Test Loss: 1.445 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.40401673316955566
Epoch: 11, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.442 Vali Acc: 0.133 Test Loss: 1.442 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.47772908210754395
Epoch: 12, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.440 Vali Acc: 0.133 Test Loss: 1.440 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.46170568466186523
Epoch: 13, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.439 Vali Acc: 0.133 Test Loss: 1.439 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.48427653312683105
Epoch: 14, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.438 Vali Acc: 0.133 Test Loss: 1.438 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4980151653289795
Epoch: 15, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.437 Vali Acc: 0.133 Test Loss: 1.437 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 34403
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.062972068786621
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5023789405822754
Epoch: 2, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5215303897857666
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.46969079971313477
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.43723177909851074
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.44361019134521484
Epoch: 6, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4380786418914795
Epoch: 7, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.623666524887085
Epoch: 8, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.44805216789245605
Epoch: 9, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.46649646759033203
Epoch: 10, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5213212966918945
Epoch: 11, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.45522522926330566
Epoch: 12, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.4574770927429199
Epoch: 13, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6241476535797119
Epoch: 14, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.563044548034668
Epoch: 15, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5409088134765625
Epoch: 16, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5292017459869385
Epoch: 17, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5234668254852295
Epoch: 18, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5086338520050049
Epoch: 19, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4426600933074951
Epoch: 20, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.543734073638916
Epoch: 21, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4985661506652832
Epoch: 22, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 32227
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.303426742553711
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.370 Vali Acc: 0.267 Test Loss: 1.370 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 0.5284807682037354
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.367 Vali Acc: 0.200 Test Loss: 1.367 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4891958236694336
Epoch: 3, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.366 Vali Acc: 0.200 Test Loss: 1.366 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4344775676727295
Epoch: 4, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.365 Vali Acc: 0.200 Test Loss: 1.365 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.47852587699890137
Epoch: 5, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.365 Vali Acc: 0.200 Test Loss: 1.365 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5853836536407471
Epoch: 6, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.366 Vali Acc: 0.200 Test Loss: 1.366 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.49245238304138184
Epoch: 7, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.367 Vali Acc: 0.200 Test Loss: 1.367 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4320962429046631
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.368 Vali Acc: 0.200 Test Loss: 1.368 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4884457588195801
Epoch: 9, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.369 Vali Acc: 0.200 Test Loss: 1.369 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.43226003646850586
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.370 Vali Acc: 0.200 Test Loss: 1.370 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.46678709983825684
Epoch: 11, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.371 Vali Acc: 0.200 Test Loss: 1.371 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 31587
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1187593936920166
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.42714476585388184
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4888176918029785
Epoch: 3, Steps: 1 | Train Loss: 1.350 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4629378318786621
Epoch: 4, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4416928291320801
Epoch: 5, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.43547892570495605
Epoch: 6, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.439298152923584
Epoch: 7, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6674168109893799
Epoch: 8, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.47053027153015137
Epoch: 9, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4394855499267578
Epoch: 10, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.40958428382873535
Epoch: 11, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4510776996612549
Epoch: 12, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4021797180175781
Epoch: 13, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.46647119522094727
Epoch: 14, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4864161014556885
Epoch: 15, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4422435760498047
Epoch: 16, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.38553380966186523
Epoch: 17, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4436299800872803
Epoch: 18, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 31267
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.147150754928589
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.4896697998046875
Epoch: 2, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.251 Vali Acc: 0.200 Test Loss: 1.251 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.49501800537109375
Epoch: 3, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4673488140106201
Epoch: 4, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47458505630493164
Epoch: 5, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.42291903495788574
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4324052333831787
Epoch: 7, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4940619468688965
Epoch: 8, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5859870910644531
Epoch: 9, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.277 Vali Acc: 0.200 Test Loss: 1.277 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.51971435546875
Epoch: 10, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.280 Vali Acc: 0.200 Test Loss: 1.280 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4036390781402588
Epoch: 11, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4304063320159912
Epoch: 12, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.287 Vali Acc: 0.200 Test Loss: 1.287 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 31715
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3655178546905518
Epoch: 1, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5637590885162354
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5053834915161133
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5302219390869141
Epoch: 4, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6089303493499756
Epoch: 5, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5719571113586426
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5406296253204346
Epoch: 7, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5782759189605713
Epoch: 8, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5971500873565674
Epoch: 9, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5723998546600342
Epoch: 10, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6076276302337646
Epoch: 11, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm32_nh4_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 32355
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3329246044158936
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.3760561943054199
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.490889310836792
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4901700019836426
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.46985888481140137
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.4744601249694824
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.510157585144043
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.45792698860168457
Epoch: 8, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.506417989730835
Epoch: 9, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.4813699722290039
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.3720407485961914
Epoch: 11, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.48902177810668945
Epoch: 12, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.48022937774658203
Epoch: 13, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.419572114944458
Epoch: 14, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.4616670608520508
Epoch: 15, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4978034496307373
Epoch: 16, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5052776336669922
Epoch: 17, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4810669422149658
Epoch: 18, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4699587821960449
Epoch: 19, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4912452697753906
Epoch: 20, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.515632152557373
Epoch: 21, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.48883843421936035
Epoch: 22, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5043072700500488
Epoch: 23, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5806980133056641
Epoch: 24, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 36819
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2791600227355957
Epoch: 1, Steps: 1 | Train Loss: 1.470 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5883760452270508
Epoch: 2, Steps: 1 | Train Loss: 1.528 Vali Loss: 1.147 Vali Acc: 0.133 Test Loss: 1.147 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5185215473175049
Epoch: 3, Steps: 1 | Train Loss: 1.523 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49132251739501953
Epoch: 4, Steps: 1 | Train Loss: 1.330 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5157191753387451
Epoch: 5, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5892407894134521
Epoch: 6, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4917876720428467
Epoch: 7, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.541964054107666
Epoch: 8, Steps: 1 | Train Loss: 1.370 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5605795383453369
Epoch: 9, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.46726059913635254
Epoch: 10, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5742208957672119
Epoch: 11, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 33235
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3390748500823975
Epoch: 1, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5344750881195068
Epoch: 2, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.248 Vali Acc: 0.133 Test Loss: 1.248 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5081298351287842
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.250 Vali Acc: 0.133 Test Loss: 1.250 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44617676734924316
Epoch: 4, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.251 Vali Acc: 0.133 Test Loss: 1.251 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5891280174255371
Epoch: 5, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.253 Vali Acc: 0.133 Test Loss: 1.253 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6542418003082275
Epoch: 6, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.255 Vali Acc: 0.133 Test Loss: 1.255 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5107028484344482
Epoch: 7, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.256 Vali Acc: 0.133 Test Loss: 1.256 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5766425132751465
Epoch: 8, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.258 Vali Acc: 0.133 Test Loss: 1.258 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.46973323822021484
Epoch: 9, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.260 Vali Acc: 0.133 Test Loss: 1.260 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.646007776260376
Epoch: 10, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.262 Vali Acc: 0.133 Test Loss: 1.262 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4525716304779053
Epoch: 11, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.264 Vali Acc: 0.133 Test Loss: 1.264 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 32147
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.310258626937866
Epoch: 1, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5365936756134033
Epoch: 2, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.45859456062316895
Epoch: 3, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.4301023483276367
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.49367380142211914
Epoch: 5, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.43814706802368164
Epoch: 6, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.47658348083496094
Epoch: 7, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.515733003616333
Epoch: 8, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.44535374641418457
Epoch: 9, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.46126365661621094
Epoch: 10, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5191104412078857
Epoch: 11, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.44366025924682617
Epoch: 12, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.48107266426086426
Epoch: 13, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4723684787750244
Epoch: 14, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.513206958770752
Epoch: 15, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5137159824371338
Epoch: 16, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4602975845336914
Epoch: 17, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 31827
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.253727674484253
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.454 Vali Acc: 0.333 Test Loss: 1.454 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 0.500511646270752
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.418 Vali Acc: 0.333 Test Loss: 1.418 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.4931774139404297
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.384 Vali Acc: 0.333 Test Loss: 1.384 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 0.5338339805603027
Epoch: 4, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.356 Vali Acc: 0.333 Test Loss: 1.356 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.622230052947998
Epoch: 5, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.4739699363708496
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 0.5108788013458252
Epoch: 7, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.590705156326294
Epoch: 8, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.49763011932373047
Epoch: 9, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5867595672607422
Epoch: 10, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.5552933216094971
Epoch: 11, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.5540053844451904
Epoch: 12, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.5166134834289551
Epoch: 13, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.49799561500549316
Epoch: 14, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.5202407836914062
Epoch: 15, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.5567772388458252
Epoch: 16, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.5503630638122559
Epoch: 17, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.548999547958374
Epoch: 18, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.523979663848877
Epoch: 19, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 0.5308065414428711
Epoch: 20, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.5515842437744141
Epoch: 21, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.557957649230957
Epoch: 22, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 0.6182215213775635
Epoch: 23, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.4863309860229492
Epoch: 24, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 0.5561699867248535
Epoch: 25, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 0.5992369651794434
Epoch: 26, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 27 cost time: 0.5473439693450928
Epoch: 27, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 28 cost time: 0.5938146114349365
Epoch: 28, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 29 cost time: 0.595799446105957
Epoch: 29, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 30 cost time: 0.5639853477478027
Epoch: 30, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5581693649291992
Epoch: 31, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5478103160858154
Epoch: 32, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5515084266662598
Epoch: 33, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.560976505279541
Epoch: 34, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.516779899597168
Epoch: 35, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5043351650238037
Epoch: 36, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5249998569488525
Epoch: 37, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.49958252906799316
Epoch: 38, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.46891117095947266
Epoch: 39, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 31667
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2448463439941406
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.43761706352233887
Epoch: 2, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.38413429260253906
Epoch: 3, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5273799896240234
Epoch: 4, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4963653087615967
Epoch: 5, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.251 Vali Acc: 0.200 Test Loss: 1.251 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.44953417778015137
Epoch: 6, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.247 Vali Acc: 0.200 Test Loss: 1.247 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4435596466064453
Epoch: 7, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.48345494270324707
Epoch: 8, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.48050737380981445
Epoch: 9, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.45853281021118164
Epoch: 10, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.45169663429260254
Epoch: 11, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.45882296562194824
Epoch: 12, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.43088865280151367
Epoch: 13, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5082385540008545
Epoch: 14, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4965198040008545
Epoch: 15, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.41075682640075684
Epoch: 16, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.49300670623779297
Epoch: 17, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.419130802154541
Epoch: 18, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5317730903625488
Epoch: 19, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.44319772720336914
Epoch: 20, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 31891
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4292025566101074
Epoch: 1, Steps: 1 | Train Loss: 1.480 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5087087154388428
Epoch: 2, Steps: 1 | Train Loss: 1.257 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5286638736724854
Epoch: 3, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6721153259277344
Epoch: 4, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5380327701568604
Epoch: 5, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5458118915557861
Epoch: 6, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5210402011871338
Epoch: 7, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5457093715667725
Epoch: 8, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4478425979614258
Epoch: 9, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4246668815612793
Epoch: 10, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5320088863372803
Epoch: 11, Steps: 1 | Train Loss: 1.377 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.553767204284668
Epoch: 12, Steps: 1 | Train Loss: 1.343 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.6031153202056885
Epoch: 13, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.542081356048584
Epoch: 14, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.5085911750793457
Epoch: 15, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.5088064670562744
Epoch: 16, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.5397670269012451
Epoch: 17, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.6636998653411865
Epoch: 18, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.5080950260162354
Epoch: 19, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.5530083179473877
Epoch: 20, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.559861421585083
Epoch: 21, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.5743465423583984
Epoch: 22, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.5511505603790283
Epoch: 23, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.567920446395874
Epoch: 24, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.5563564300537109
Epoch: 25, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.6198256015777588
Epoch: 26, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.49432849884033203
Epoch: 27, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.5635476112365723
Epoch: 28, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.4593234062194824
Epoch: 29, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 0.6131443977355957
Epoch: 30, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 0.5037322044372559
Epoch: 31, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 32 cost time: 0.5378720760345459
Epoch: 32, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 33 cost time: 0.5376753807067871
Epoch: 33, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 34 cost time: 0.49889564514160156
Epoch: 34, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 35 cost time: 0.5411040782928467
Epoch: 35, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.49402880668640137
Epoch: 36, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 37 cost time: 0.5046236515045166
Epoch: 37, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6136059761047363
Epoch: 38, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 39 cost time: 0.48889827728271484
Epoch: 39, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 40 cost time: 0.5645921230316162
Epoch: 40, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5090646743774414
Epoch: 41, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.492734432220459
Epoch: 42, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5348362922668457
Epoch: 43, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6153824329376221
Epoch: 44, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5150079727172852
Epoch: 45, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4859809875488281
Epoch: 46, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5697612762451172
Epoch: 47, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.459120512008667
Epoch: 48, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4591395854949951
Epoch: 49, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 32211
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0801284313201904
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.46093010902404785
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.3561210632324219
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4773130416870117
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.49912548065185547
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5581891536712646
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.41956377029418945
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.45106053352355957
Epoch: 8, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4778764247894287
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5001497268676758
Epoch: 10, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5162196159362793
Epoch: 11, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.4477720260620117
Epoch: 12, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.48662352561950684
Epoch: 13, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4729464054107666
Epoch: 14, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.46626996994018555
Epoch: 15, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.5011506080627441
Epoch: 16, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.5177521705627441
Epoch: 17, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5065946578979492
Epoch: 18, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4977552890777588
Epoch: 19, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4893200397491455
Epoch: 20, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5290708541870117
Epoch: 21, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5129809379577637
Epoch: 22, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.45676136016845703
Epoch: 23, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.526829719543457
Epoch: 24, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.42722654342651367
Epoch: 25, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4070107936859131
Epoch: 26, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4377453327178955
Epoch: 27, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.49346160888671875
Epoch: 28, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.45708179473876953
Epoch: 29, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.3933229446411133
Epoch: 30, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.41898083686828613
Epoch: 31, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4966111183166504
Epoch: 32, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6610395908355713
Epoch: 33, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 24147
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.256282329559326
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4724853038787842
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4834251403808594
Epoch: 3, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5847897529602051
Epoch: 4, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5002536773681641
Epoch: 5, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5401382446289062
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.45336079597473145
Epoch: 7, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.40661096572875977
Epoch: 8, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.4619295597076416
Epoch: 9, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.40085721015930176
Epoch: 10, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.4390575885772705
Epoch: 11, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.4732661247253418
Epoch: 12, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.544912576675415
Epoch: 13, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49868345260620117
Epoch: 14, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4835386276245117
Epoch: 15, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4585998058319092
Epoch: 16, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.46916699409484863
Epoch: 17, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4825117588043213
Epoch: 18, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4412801265716553
Epoch: 19, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.42406773567199707
Epoch: 20, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4417417049407959
Epoch: 21, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 20563
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2660601139068604
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4704604148864746
Epoch: 2, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4073619842529297
Epoch: 3, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4685359001159668
Epoch: 4, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5127480030059814
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.38935017585754395
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4328327178955078
Epoch: 7, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4903120994567871
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4528684616088867
Epoch: 9, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4070115089416504
Epoch: 10, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.482790470123291
Epoch: 11, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.47924232482910156
Epoch: 12, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.5187513828277588
Epoch: 13, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4533655643463135
Epoch: 14, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.45756030082702637
Epoch: 15, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.4745981693267822
Epoch: 16, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5113668441772461
Epoch: 17, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5224771499633789
Epoch: 18, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4452638626098633
Epoch: 19, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.466749906539917
Epoch: 20, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5213909149169922
Epoch: 21, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5330948829650879
Epoch: 22, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4789905548095703
Epoch: 23, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4396977424621582
Epoch: 24, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5236771106719971
Epoch: 25, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 19475
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.31449031829834
Epoch: 1, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.306 Vali Acc: 0.333 Test Loss: 1.306 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.4330942630767822
Epoch: 2, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.298 Vali Acc: 0.333 Test Loss: 1.298 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.5600612163543701
Epoch: 3, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.291 Vali Acc: 0.333 Test Loss: 1.291 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.6325545310974121
Epoch: 4, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5437724590301514
Epoch: 5, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4793250560760498
Epoch: 6, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6376340389251709
Epoch: 7, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5542335510253906
Epoch: 8, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5778064727783203
Epoch: 9, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5178344249725342
Epoch: 10, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5931782722473145
Epoch: 11, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5897552967071533
Epoch: 12, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5518293380737305
Epoch: 13, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 19155
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.146876096725464
Epoch: 1, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.44069886207580566
Epoch: 2, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.201 Vali Acc: 0.467 Test Loss: 1.201 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5727903842926025
Epoch: 3, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5056383609771729
Epoch: 4, Steps: 1 | Train Loss: 1.257 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5011730194091797
Epoch: 5, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.49115896224975586
Epoch: 6, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.41167521476745605
Epoch: 7, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5031144618988037
Epoch: 8, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49439311027526855
Epoch: 9, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.48938846588134766
Epoch: 10, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5981528759002686
Epoch: 11, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 18995
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.229862928390503
Epoch: 1, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4856526851654053
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5777838230133057
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.44436073303222656
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5064232349395752
Epoch: 5, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.289 Vali Acc: 0.267 Test Loss: 1.289 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.4802379608154297
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5076909065246582
Epoch: 7, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.5606729984283447
Epoch: 8, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.5189378261566162
Epoch: 9, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.615105152130127
Epoch: 10, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.5038983821868896
Epoch: 11, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 0.5394151210784912
Epoch: 12, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 0.4738786220550537
Epoch: 13, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 14 cost time: 0.48306870460510254
Epoch: 14, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 15 cost time: 0.575178861618042
Epoch: 15, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.5545995235443115
Epoch: 16, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.5216248035430908
Epoch: 17, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.5214083194732666
Epoch: 18, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.266 Vali Acc: 0.333 Test Loss: 1.266 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.5461246967315674
Epoch: 19, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 0.5875768661499023
Epoch: 20, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 0.5629355907440186
Epoch: 21, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 0.5095179080963135
Epoch: 22, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 23 cost time: 0.5440943241119385
Epoch: 23, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 0.5276598930358887
Epoch: 24, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 25 cost time: 0.5468711853027344
Epoch: 25, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6357614994049072
Epoch: 26, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 27 cost time: 0.46280479431152344
Epoch: 27, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5182621479034424
Epoch: 28, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 29 cost time: 0.6633245944976807
Epoch: 29, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 30 cost time: 0.6763510704040527
Epoch: 30, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 31 cost time: 0.5925400257110596
Epoch: 31, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 32 cost time: 0.5014498233795166
Epoch: 32, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 33 cost time: 0.6034643650054932
Epoch: 33, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 34 cost time: 0.591804027557373
Epoch: 34, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 35 cost time: 0.5145010948181152
Epoch: 35, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 36 cost time: 0.5876734256744385
Epoch: 36, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 37 cost time: 0.5242419242858887
Epoch: 37, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 38 cost time: 0.572685956954956
Epoch: 38, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5461981296539307
Epoch: 39, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 40 cost time: 0.6488974094390869
Epoch: 40, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 41 cost time: 0.5371901988983154
Epoch: 41, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 42 cost time: 0.507178783416748
Epoch: 42, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5975825786590576
Epoch: 43, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4750552177429199
Epoch: 44, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 45 cost time: 0.5116007328033447
Epoch: 45, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 46 cost time: 0.5590124130249023
Epoch: 46, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 47 cost time: 0.5309054851531982
Epoch: 47, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 48 cost time: 0.44632840156555176
Epoch: 48, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 49 cost time: 0.5247721672058105
Epoch: 49, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 50 cost time: 0.509833812713623
Epoch: 50, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 51 cost time: 0.46735262870788574
Epoch: 51, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 52 cost time: 0.5929229259490967
Epoch: 52, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 53 cost time: 0.5507593154907227
Epoch: 53, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 54 cost time: 0.5958738327026367
Epoch: 54, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 55 cost time: 0.589097261428833
Epoch: 55, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 56 cost time: 0.6000194549560547
Epoch: 56, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6319451332092285
Epoch: 57, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5261623859405518
Epoch: 58, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5955421924591064
Epoch: 59, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.4359254837036133
Epoch: 60, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.6044368743896484
Epoch: 61, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.528745174407959
Epoch: 62, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.5488667488098145
Epoch: 63, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5674595832824707
Epoch: 64, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5472426414489746
Epoch: 65, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 19219
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1334335803985596
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.48867368698120117
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49631261825561523
Epoch: 3, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4011867046356201
Epoch: 4, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5278818607330322
Epoch: 5, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.43643879890441895
Epoch: 6, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.288 Vali Acc: 0.200 Test Loss: 1.288 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5621011257171631
Epoch: 7, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.291 Vali Acc: 0.200 Test Loss: 1.291 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5067620277404785
Epoch: 8, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.47635960578918457
Epoch: 9, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.42288827896118164
Epoch: 10, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5527248382568359
Epoch: 11, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 19539
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.240356922149658
Epoch: 1, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4120151996612549
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.46470117568969727
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5099563598632812
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5215446949005127
Epoch: 5, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6420683860778809
Epoch: 6, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4425227642059326
Epoch: 7, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5296695232391357
Epoch: 8, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5770771503448486
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5643515586853027
Epoch: 10, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5824532508850098
Epoch: 11, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5180025100708008
Epoch: 12, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.249 Vali Acc: 0.200 Test Loss: 1.249 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 17811
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.215993881225586
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.509521484375
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5003836154937744
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.48349499702453613
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5405595302581787
Epoch: 5, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.43852806091308594
Epoch: 6, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4392693042755127
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5019032955169678
Epoch: 8, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4777686595916748
Epoch: 9, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4944570064544678
Epoch: 10, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.47313404083251953
Epoch: 11, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4878551959991455
Epoch: 12, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4373891353607178
Epoch: 13, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.40781188011169434
Epoch: 14, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.44280552864074707
Epoch: 15, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 14227
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.125696897506714
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.311 Vali Acc: 0.333 Test Loss: 1.311 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.4826219081878662
Epoch: 2, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.49241209030151367
Epoch: 3, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5318429470062256
Epoch: 4, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5138339996337891
Epoch: 5, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.49314379692077637
Epoch: 6, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.7127461433410645
Epoch: 7, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5298051834106445
Epoch: 8, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.5149986743927002
Epoch: 9, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5280442237854004
Epoch: 10, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.6729629039764404
Epoch: 11, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.6008322238922119
Epoch: 12, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.5598258972167969
Epoch: 13, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.46393251419067383
Epoch: 14, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.5961346626281738
Epoch: 15, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.5859639644622803
Epoch: 16, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.45297789573669434
Epoch: 17, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.49245715141296387
Epoch: 18, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5240895748138428
Epoch: 19, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6928563117980957
Epoch: 20, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5010392665863037
Epoch: 21, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4994699954986572
Epoch: 22, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4208064079284668
Epoch: 23, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6194925308227539
Epoch: 24, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.45665502548217773
Epoch: 25, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 0.4903101921081543
Epoch: 26, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 27 cost time: 0.5305643081665039
Epoch: 27, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 28 cost time: 0.5152373313903809
Epoch: 28, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 29 cost time: 0.600172758102417
Epoch: 29, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 30 cost time: 0.4780757427215576
Epoch: 30, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5144853591918945
Epoch: 31, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5402917861938477
Epoch: 32, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.587071418762207
Epoch: 33, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5924410820007324
Epoch: 34, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5955462455749512
Epoch: 35, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6578164100646973
Epoch: 36, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5381684303283691
Epoch: 37, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5813136100769043
Epoch: 38, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5204968452453613
Epoch: 39, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 13139
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2417192459106445
Epoch: 1, Steps: 1 | Train Loss: 1.326 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4292302131652832
Epoch: 2, Steps: 1 | Train Loss: 1.414 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5728116035461426
Epoch: 3, Steps: 1 | Train Loss: 1.326 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5297701358795166
Epoch: 4, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5185868740081787
Epoch: 5, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.443178653717041
Epoch: 6, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4887852668762207
Epoch: 7, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.50765061378479
Epoch: 8, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5139980316162109
Epoch: 9, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4857661724090576
Epoch: 10, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3980240821838379
Epoch: 11, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.5180027484893799
Epoch: 12, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.5661025047302246
Epoch: 13, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.43535685539245605
Epoch: 14, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5182547569274902
Epoch: 15, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5052978992462158
Epoch: 16, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5214183330535889
Epoch: 17, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4011068344116211
Epoch: 18, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4819486141204834
Epoch: 19, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5681812763214111
Epoch: 20, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5089290142059326
Epoch: 21, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4957144260406494
Epoch: 22, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 12819
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.217417001724243
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.43769145011901855
Epoch: 2, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40424394607543945
Epoch: 3, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.44351959228515625
Epoch: 4, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4697582721710205
Epoch: 5, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4406924247741699
Epoch: 6, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5094952583312988
Epoch: 7, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.43514537811279297
Epoch: 8, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.46822023391723633
Epoch: 9, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.40598034858703613
Epoch: 10, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.44440126419067383
Epoch: 11, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.422821044921875
Epoch: 12, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5003335475921631
Epoch: 13, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.39618372917175293
Epoch: 14, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 12659
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.045943260192871
Epoch: 1, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5157067775726318
Epoch: 2, Steps: 1 | Train Loss: 1.389 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4724586009979248
Epoch: 3, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5324110984802246
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.43895459175109863
Epoch: 5, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5333576202392578
Epoch: 6, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5392403602600098
Epoch: 7, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5584676265716553
Epoch: 8, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5453274250030518
Epoch: 9, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4962334632873535
Epoch: 10, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.532090425491333
Epoch: 11, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.526951789855957
Epoch: 12, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 12883
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.150956153869629
Epoch: 1, Steps: 1 | Train Loss: 1.437 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46937131881713867
Epoch: 2, Steps: 1 | Train Loss: 1.381 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5440399646759033
Epoch: 3, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5003395080566406
Epoch: 4, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5922603607177734
Epoch: 5, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.511009931564331
Epoch: 6, Steps: 1 | Train Loss: 1.309 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4508516788482666
Epoch: 7, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6054649353027344
Epoch: 8, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.503382682800293
Epoch: 9, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.47052955627441406
Epoch: 10, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5135481357574463
Epoch: 11, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5801966190338135
Epoch: 12, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.3943946361541748
Epoch: 13, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4415299892425537
Epoch: 14, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.533972978591919
Epoch: 15, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5102007389068604
Epoch: 16, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.48691511154174805
Epoch: 17, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4975724220275879
Epoch: 18, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5153110027313232
Epoch: 19, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.49222421646118164
Epoch: 20, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.45566534996032715
Epoch: 21, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6598973274230957
Epoch: 22, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.47237610816955566
Epoch: 23, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.49577832221984863
Epoch: 24, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el3_dm16_nh4_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 13203
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.492016315460205
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5757942199707031
Epoch: 2, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.5340352058410645
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.6470439434051514
Epoch: 4, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5535264015197754
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5026938915252686
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5216827392578125
Epoch: 7, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4330434799194336
Epoch: 8, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4562263488769531
Epoch: 9, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5758614540100098
Epoch: 10, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6758124828338623
Epoch: 11, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.590050220489502
Epoch: 12, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5115976333618164
Epoch: 13, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 328707
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4732115268707275
Epoch: 1, Steps: 1 | Train Loss: 1.381 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5649816989898682
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6272211074829102
Epoch: 3, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5702311992645264
Epoch: 4, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5571584701538086
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.54604172706604
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.697455883026123
Epoch: 7, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.586158275604248
Epoch: 8, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.672137975692749
Epoch: 9, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5779261589050293
Epoch: 10, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6277439594268799
Epoch: 11, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6166348457336426
Epoch: 12, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5525636672973633
Epoch: 13, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6060812473297119
Epoch: 14, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5232815742492676
Epoch: 15, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5764341354370117
Epoch: 16, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 300035
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1567845344543457
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5317528247833252
Epoch: 2, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.667464017868042
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4749107360839844
Epoch: 4, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6694762706756592
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5484011173248291
Epoch: 6, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5363349914550781
Epoch: 7, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.4773874282836914
Epoch: 8, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5023910999298096
Epoch: 9, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.492264986038208
Epoch: 10, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5590100288391113
Epoch: 11, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5174591541290283
Epoch: 12, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.472287654876709
Epoch: 13, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4828510284423828
Epoch: 14, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.547337532043457
Epoch: 15, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5806076526641846
Epoch: 16, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5244667530059814
Epoch: 17, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5553367137908936
Epoch: 18, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 291331
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1086206436157227
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5558285713195801
Epoch: 2, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6012363433837891
Epoch: 3, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5574600696563721
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5487127304077148
Epoch: 5, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5611884593963623
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5419116020202637
Epoch: 7, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.6352415084838867
Epoch: 8, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5118119716644287
Epoch: 9, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6315422058105469
Epoch: 10, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6233968734741211
Epoch: 11, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6246242523193359
Epoch: 12, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5598480701446533
Epoch: 13, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5744998455047607
Epoch: 14, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5927612781524658
Epoch: 15, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5499188899993896
Epoch: 16, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6665902137756348
Epoch: 17, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5639827251434326
Epoch: 18, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 288771
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1499712467193604
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5169210433959961
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5527870655059814
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6109681129455566
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.589379072189331
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.576352596282959
Epoch: 6, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.550058126449585
Epoch: 7, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.564558744430542
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6289327144622803
Epoch: 9, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6358835697174072
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5599961280822754
Epoch: 11, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5854744911193848
Epoch: 12, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6355085372924805
Epoch: 13, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6209831237792969
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6076078414916992
Epoch: 15, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7848503589630127
Epoch: 16, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5546998977661133
Epoch: 17, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 287491
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9868972301483154
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.6198074817657471
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45733046531677246
Epoch: 3, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5359952449798584
Epoch: 4, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5832679271697998
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.629488468170166
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5163514614105225
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4423675537109375
Epoch: 8, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4965052604675293
Epoch: 9, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5178549289703369
Epoch: 10, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.479583740234375
Epoch: 11, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 289283
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0761115550994873
Epoch: 1, Steps: 1 | Train Loss: 1.558 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.447037935256958
Epoch: 2, Steps: 1 | Train Loss: 1.389 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5158634185791016
Epoch: 3, Steps: 1 | Train Loss: 1.533 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5365211963653564
Epoch: 4, Steps: 1 | Train Loss: 1.438 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.43358588218688965
Epoch: 5, Steps: 1 | Train Loss: 1.430 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5858867168426514
Epoch: 6, Steps: 1 | Train Loss: 1.352 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5355372428894043
Epoch: 7, Steps: 1 | Train Loss: 1.328 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5224318504333496
Epoch: 8, Steps: 1 | Train Loss: 1.363 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5512595176696777
Epoch: 9, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.5575611591339111
Epoch: 10, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.6870450973510742
Epoch: 11, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5499658584594727
Epoch: 12, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5302214622497559
Epoch: 13, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5993993282318115
Epoch: 14, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6315603256225586
Epoch: 15, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8130292892456055
Epoch: 16, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6677439212799072
Epoch: 17, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5967884063720703
Epoch: 18, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.580005407333374
Epoch: 19, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6497824192047119
Epoch: 20, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 291843
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2519569396972656
Epoch: 1, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.241 Vali Acc: 0.400 Test Loss: 1.241 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.49137187004089355
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5055458545684814
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.4592702388763428
Epoch: 4, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.5340948104858398
Epoch: 5, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5381319522857666
Epoch: 6, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.4636533260345459
Epoch: 7, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.4752514362335205
Epoch: 8, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.4835388660430908
Epoch: 9, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.5644872188568115
Epoch: 10, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4650907516479492
Epoch: 11, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6274700164794922
Epoch: 12, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4510219097137451
Epoch: 13, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5858554840087891
Epoch: 14, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5492281913757324
Epoch: 15, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5697920322418213
Epoch: 16, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.277 Vali Acc: 0.400 Test Loss: 1.277 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6004161834716797
Epoch: 17, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5301375389099121
Epoch: 18, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.321 Vali Acc: 0.333 Test Loss: 1.321 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4907217025756836
Epoch: 19, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.331 Vali Acc: 0.267 Test Loss: 1.331 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 262915
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1715266704559326
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.49288368225097656
Epoch: 2, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4209613800048828
Epoch: 3, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5102384090423584
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5017321109771729
Epoch: 5, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.48453354835510254
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.4845399856567383
Epoch: 7, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5478694438934326
Epoch: 8, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4132058620452881
Epoch: 9, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4519989490509033
Epoch: 10, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5480155944824219
Epoch: 11, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4451885223388672
Epoch: 12, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.5726127624511719
Epoch: 13, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4381587505340576
Epoch: 14, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4763298034667969
Epoch: 15, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5033636093139648
Epoch: 16, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.3930056095123291
Epoch: 17, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.4924755096435547
Epoch: 18, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.441770076751709
Epoch: 19, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.43962764739990234
Epoch: 20, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5083866119384766
Epoch: 21, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5410068035125732
Epoch: 22, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.44774651527404785
Epoch: 23, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.48299169540405273
Epoch: 24, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4714179039001465
Epoch: 25, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5450766086578369
Epoch: 26, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4864017963409424
Epoch: 27, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.532785177230835
Epoch: 28, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.330 Vali Acc: 0.400 Test Loss: 1.330 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 234243
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.222238063812256
Epoch: 1, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5955088138580322
Epoch: 2, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6283466815948486
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5360243320465088
Epoch: 4, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5649480819702148
Epoch: 5, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.547461748123169
Epoch: 6, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.5804402828216553
Epoch: 7, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.5862061977386475
Epoch: 8, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.5002098083496094
Epoch: 9, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.6008799076080322
Epoch: 10, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.005 Vali Acc: 0.667 Test Loss: 1.005 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.5926234722137451
Epoch: 11, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.004 Vali Acc: 0.733 Test Loss: 1.004 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 0.5578391551971436
Epoch: 12, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.004 Vali Acc: 0.667 Test Loss: 1.004 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6201260089874268
Epoch: 13, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.004 Vali Acc: 0.667 Test Loss: 1.004 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5257136821746826
Epoch: 14, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.005 Vali Acc: 0.667 Test Loss: 1.005 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5881543159484863
Epoch: 15, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.007 Vali Acc: 0.667 Test Loss: 1.007 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.591033935546875
Epoch: 16, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5382246971130371
Epoch: 17, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.575615644454956
Epoch: 18, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5649962425231934
Epoch: 19, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5440175533294678
Epoch: 20, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5638079643249512
Epoch: 21, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 225539
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1446499824523926
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4915452003479004
Epoch: 2, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.4725477695465088
Epoch: 3, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.46627068519592285
Epoch: 4, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5739667415618896
Epoch: 5, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.5432803630828857
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4876856803894043
Epoch: 7, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5466508865356445
Epoch: 8, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5842704772949219
Epoch: 9, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6597805023193359
Epoch: 10, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6427822113037109
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5600123405456543
Epoch: 12, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6048257350921631
Epoch: 13, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6341593265533447
Epoch: 14, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.45786452293395996
Epoch: 15, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 222979
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1979875564575195
Epoch: 1, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.234 Vali Acc: 0.467 Test Loss: 1.234 Test Acc: 0.467
Validation loss decreased (inf --> -0.466654).  Saving model ...
Epoch: 2 cost time: 0.4129302501678467
Epoch: 2, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5407209396362305
Epoch: 3, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.41570019721984863
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4605748653411865
Epoch: 5, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.46229076385498047
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4905378818511963
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5219523906707764
Epoch: 8, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.41001152992248535
Epoch: 9, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4760115146636963
Epoch: 10, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4860210418701172
Epoch: 11, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 221699
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1581883430480957
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.548877477645874
Epoch: 2, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49326586723327637
Epoch: 3, Steps: 1 | Train Loss: 1.351 Vali Loss: 1.268 Vali Acc: 0.267 Test Loss: 1.268 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4546537399291992
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5457513332366943
Epoch: 5, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5216946601867676
Epoch: 6, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4835965633392334
Epoch: 7, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5283396244049072
Epoch: 8, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5529100894927979
Epoch: 9, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5602884292602539
Epoch: 10, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5453312397003174
Epoch: 11, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 223491
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2861275672912598
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.46300268173217773
Epoch: 2, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.44519901275634766
Epoch: 3, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.447645902633667
Epoch: 4, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5206832885742188
Epoch: 5, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4581751823425293
Epoch: 6, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4245030879974365
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.266 Vali Acc: 0.200 Test Loss: 1.266 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5013332366943359
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.269 Vali Acc: 0.200 Test Loss: 1.269 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4346280097961426
Epoch: 9, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4381437301635742
Epoch: 10, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.274 Vali Acc: 0.200 Test Loss: 1.274 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.468001127243042
Epoch: 11, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.276 Vali Acc: 0.200 Test Loss: 1.276 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 226051
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.263549566268921
Epoch: 1, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.341 Vali Acc: 0.200 Test Loss: 1.341 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.49488377571105957
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.322 Vali Acc: 0.200 Test Loss: 1.322 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.4921095371246338
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.309 Vali Acc: 0.267 Test Loss: 1.309 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5009181499481201
Epoch: 4, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5958337783813477
Epoch: 5, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.45504093170166016
Epoch: 6, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.507251501083374
Epoch: 7, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.295 Vali Acc: 0.200 Test Loss: 1.295 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5290801525115967
Epoch: 8, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.297 Vali Acc: 0.200 Test Loss: 1.297 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.560692548751831
Epoch: 9, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.300 Vali Acc: 0.200 Test Loss: 1.300 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5361194610595703
Epoch: 10, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.300 Vali Acc: 0.133 Test Loss: 1.300 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4749741554260254
Epoch: 11, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.302 Vali Acc: 0.133 Test Loss: 1.302 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5240778923034668
Epoch: 12, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.305 Vali Acc: 0.067 Test Loss: 1.305 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4200582504272461
Epoch: 13, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.313 Vali Acc: 0.133 Test Loss: 1.313 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4451732635498047
Epoch: 14, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.322 Vali Acc: 0.133 Test Loss: 1.322 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.44976329803466797
Epoch: 15, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.334 Vali Acc: 0.200 Test Loss: 1.334 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5240421295166016
Epoch: 16, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.353 Vali Acc: 0.267 Test Loss: 1.353 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 230019
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1080868244171143
Epoch: 1, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4690275192260742
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45790886878967285
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5044372081756592
Epoch: 4, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.40265965461730957
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4892420768737793
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5357239246368408
Epoch: 7, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4080483913421631
Epoch: 8, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4776003360748291
Epoch: 9, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.46448612213134766
Epoch: 10, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4803199768066406
Epoch: 11, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4350433349609375
Epoch: 12, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4398376941680908
Epoch: 13, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5313882827758789
Epoch: 14, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.272 Vali Acc: 0.400 Test Loss: 1.272 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 0.45117878913879395
Epoch: 15, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48171234130859375
Epoch: 16, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5075888633728027
Epoch: 17, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4472026824951172
Epoch: 18, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5105884075164795
Epoch: 19, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5209362506866455
Epoch: 20, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6209127902984619
Epoch: 21, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.343 Vali Acc: 0.400 Test Loss: 1.343 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.530057430267334
Epoch: 22, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.364 Vali Acc: 0.400 Test Loss: 1.364 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4851713180541992
Epoch: 23, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5832161903381348
Epoch: 24, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.400 Vali Acc: 0.400 Test Loss: 1.400 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 201347
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3033690452575684
Epoch: 1, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5102348327636719
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5211217403411865
Epoch: 3, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.46665453910827637
Epoch: 4, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5609157085418701
Epoch: 5, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.47840237617492676
Epoch: 6, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.503591775894165
Epoch: 7, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.49675679206848145
Epoch: 8, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5267186164855957
Epoch: 9, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6102011203765869
Epoch: 10, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5071752071380615
Epoch: 11, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.49872517585754395
Epoch: 12, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5237634181976318
Epoch: 13, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5388584136962891
Epoch: 14, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5193867683410645
Epoch: 15, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5539469718933105
Epoch: 16, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5321564674377441
Epoch: 17, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.567718505859375
Epoch: 18, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6715352535247803
Epoch: 19, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6087703704833984
Epoch: 20, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5968003273010254
Epoch: 21, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 192643
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1250874996185303
Epoch: 1, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.42531895637512207
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5132691860198975
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.44003915786743164
Epoch: 4, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5404617786407471
Epoch: 5, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4500575065612793
Epoch: 6, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4609413146972656
Epoch: 7, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4126136302947998
Epoch: 8, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5179986953735352
Epoch: 9, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5111386775970459
Epoch: 10, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.44553375244140625
Epoch: 11, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4358818531036377
Epoch: 12, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4277472496032715
Epoch: 13, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 190083
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.159803628921509
Epoch: 1, Steps: 1 | Train Loss: 1.318 Vali Loss: 1.131 Vali Acc: 0.133 Test Loss: 1.131 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.40995073318481445
Epoch: 2, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.129 Vali Acc: 0.133 Test Loss: 1.129 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.5365955829620361
Epoch: 3, Steps: 1 | Train Loss: 1.342 Vali Loss: 1.125 Vali Acc: 0.133 Test Loss: 1.125 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 4 cost time: 0.5112698078155518
Epoch: 4, Steps: 1 | Train Loss: 1.345 Vali Loss: 1.123 Vali Acc: 0.133 Test Loss: 1.123 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 5 cost time: 0.49867939949035645
Epoch: 5, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.121 Vali Acc: 0.133 Test Loss: 1.121 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 6 cost time: 0.5049121379852295
Epoch: 6, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.521704912185669
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.5019505023956299
Epoch: 8, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.454007625579834
Epoch: 9, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.5828373432159424
Epoch: 10, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5118095874786377
Epoch: 11, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5750184059143066
Epoch: 12, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.5533239841461182
Epoch: 13, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5733194351196289
Epoch: 14, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5583269596099854
Epoch: 15, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.562279462814331
Epoch: 16, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6012554168701172
Epoch: 17, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5973711013793945
Epoch: 18, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.5420215129852295
Epoch: 19, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5861649513244629
Epoch: 20, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5429959297180176
Epoch: 21, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4763946533203125
Epoch: 22, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6778061389923096
Epoch: 23, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7116668224334717
Epoch: 24, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.531287431716919
Epoch: 25, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5349452495574951
Epoch: 26, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4985675811767578
Epoch: 27, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6306309700012207
Epoch: 28, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 188803
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.268946647644043
Epoch: 1, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.532813549041748
Epoch: 2, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5506963729858398
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5408668518066406
Epoch: 4, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.625744104385376
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5461809635162354
Epoch: 6, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5154502391815186
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5170927047729492
Epoch: 8, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.5859687328338623
Epoch: 9, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.5762391090393066
Epoch: 10, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.5222594738006592
Epoch: 11, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.5237038135528564
Epoch: 12, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.5550768375396729
Epoch: 13, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.5370583534240723
Epoch: 14, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.42964601516723633
Epoch: 15, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.49956512451171875
Epoch: 16, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.456043004989624
Epoch: 17, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.5667679309844971
Epoch: 18, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 19 cost time: 0.476224422454834
Epoch: 19, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4974827766418457
Epoch: 20, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.487548828125
Epoch: 21, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 22 cost time: 0.6661481857299805
Epoch: 22, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.032 Vali Acc: 0.733 Test Loss: 1.032 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733323).  Saving model ...
Epoch: 23 cost time: 0.5403034687042236
Epoch: 23, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.033 Vali Acc: 0.733 Test Loss: 1.033 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5116314888000488
Epoch: 24, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.034 Vali Acc: 0.733 Test Loss: 1.034 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6223948001861572
Epoch: 25, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.035 Vali Acc: 0.800 Test Loss: 1.035 Test Acc: 0.800
Validation loss decreased (-0.733323 --> -0.799990).  Saving model ...
Epoch: 26 cost time: 0.7558448314666748
Epoch: 26, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.036 Vali Acc: 0.800 Test Loss: 1.036 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.48435378074645996
Epoch: 27, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.038 Vali Acc: 0.800 Test Loss: 1.038 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5003728866577148
Epoch: 28, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.040 Vali Acc: 0.800 Test Loss: 1.040 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4671790599822998
Epoch: 29, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.042 Vali Acc: 0.800 Test Loss: 1.042 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6300101280212402
Epoch: 30, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.045 Vali Acc: 0.800 Test Loss: 1.045 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4146840572357178
Epoch: 31, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.048 Vali Acc: 0.800 Test Loss: 1.048 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4867100715637207
Epoch: 32, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.052 Vali Acc: 0.800 Test Loss: 1.052 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5217249393463135
Epoch: 33, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.055 Vali Acc: 0.800 Test Loss: 1.055 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.500532865524292
Epoch: 34, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.059 Vali Acc: 0.800 Test Loss: 1.059 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5505657196044922
Epoch: 35, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.064 Vali Acc: 0.800 Test Loss: 1.064 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.8
model parameter : 190595
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.979161024093628
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4660661220550537
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5010776519775391
Epoch: 3, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.5603711605072021
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4844033718109131
Epoch: 5, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5579392910003662
Epoch: 6, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5052556991577148
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5413460731506348
Epoch: 8, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5296449661254883
Epoch: 9, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5268571376800537
Epoch: 10, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.48577451705932617
Epoch: 11, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.530921220779419
Epoch: 12, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4411804676055908
Epoch: 13, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4939699172973633
Epoch: 14, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.46277594566345215
Epoch: 15, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5442671775817871
Epoch: 16, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5559978485107422
Epoch: 17, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm128_nh16_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 193155
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3201825618743896
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.600 Vali Acc: 0.333 Test Loss: 1.600 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 0.6100010871887207
Epoch: 2, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.519 Vali Acc: 0.333 Test Loss: 1.519 Test Acc: 0.333
Validation loss decreased (-0.333317 --> -0.333318).  Saving model ...
Epoch: 3 cost time: 0.4605753421783447
Epoch: 3, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.453 Vali Acc: 0.267 Test Loss: 1.453 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5750625133514404
Epoch: 4, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.398 Vali Acc: 0.267 Test Loss: 1.398 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.616203784942627
Epoch: 5, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.358 Vali Acc: 0.267 Test Loss: 1.358 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4366035461425781
Epoch: 6, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.329 Vali Acc: 0.267 Test Loss: 1.329 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4856555461883545
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.304 Vali Acc: 0.267 Test Loss: 1.304 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.545011043548584
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.284 Vali Acc: 0.200 Test Loss: 1.284 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5217876434326172
Epoch: 9, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.268 Vali Acc: 0.200 Test Loss: 1.268 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5142242908477783
Epoch: 10, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5073738098144531
Epoch: 11, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4777250289916992
Epoch: 12, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.255 Vali Acc: 0.133 Test Loss: 1.255 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 131843
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0233333110809326
Epoch: 1, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.5350112915039062
Epoch: 2, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.5491673946380615
Epoch: 3, Steps: 1 | Train Loss: 1.297 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5039453506469727
Epoch: 4, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.521554708480835
Epoch: 5, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.46022534370422363
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5380449295043945
Epoch: 7, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.41537022590637207
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4621427059173584
Epoch: 9, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.46822285652160645
Epoch: 10, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6161797046661377
Epoch: 11, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.42662739753723145
Epoch: 12, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4509563446044922
Epoch: 13, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.46843814849853516
Epoch: 14, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5213227272033691
Epoch: 15, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5070803165435791
Epoch: 16, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5389580726623535
Epoch: 17, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 117507
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.126429796218872
Epoch: 1, Steps: 1 | Train Loss: 1.361 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5428977012634277
Epoch: 2, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.46143364906311035
Epoch: 3, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7335226535797119
Epoch: 4, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5314228534698486
Epoch: 5, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5951449871063232
Epoch: 6, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4896512031555176
Epoch: 7, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5216712951660156
Epoch: 8, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7227475643157959
Epoch: 9, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.594393253326416
Epoch: 10, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.56589674949646
Epoch: 11, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5909099578857422
Epoch: 12, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.5179014205932617
Epoch: 13, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.594900369644165
Epoch: 14, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.5919828414916992
Epoch: 15, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6621174812316895
Epoch: 16, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5894694328308105
Epoch: 17, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6196339130401611
Epoch: 18, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6030347347259521
Epoch: 19, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.57967209815979
Epoch: 20, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.556541919708252
Epoch: 21, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5517797470092773
Epoch: 22, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5289905071258545
Epoch: 23, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.49708032608032227
Epoch: 24, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 113155
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4126410484313965
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.208 Vali Acc: 0.533 Test Loss: 1.208 Test Acc: 0.533
Validation loss decreased (inf --> -0.533321).  Saving model ...
Epoch: 2 cost time: 0.527029275894165
Epoch: 2, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.206 Vali Acc: 0.533 Test Loss: 1.206 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 3 cost time: 0.5363039970397949
Epoch: 3, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.205 Vali Acc: 0.600 Test Loss: 1.205 Test Acc: 0.600
Validation loss decreased (-0.533321 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.5134761333465576
Epoch: 4, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.203 Vali Acc: 0.600 Test Loss: 1.203 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.530775785446167
Epoch: 5, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.5152153968811035
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.45870161056518555
Epoch: 7, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.201 Vali Acc: 0.600 Test Loss: 1.201 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.5371942520141602
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5819146633148193
Epoch: 9, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4770193099975586
Epoch: 10, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.203 Vali Acc: 0.600 Test Loss: 1.203 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.49202895164489746
Epoch: 11, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.203 Vali Acc: 0.600 Test Loss: 1.203 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5641489028930664
Epoch: 12, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4244217872619629
Epoch: 13, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4059431552886963
Epoch: 14, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.47626447677612305
Epoch: 15, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5452914237976074
Epoch: 16, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.207 Vali Acc: 0.600 Test Loss: 1.207 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.44904041290283203
Epoch: 17, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.209 Vali Acc: 0.600 Test Loss: 1.209 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 111875
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0948073863983154
Epoch: 1, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.434201717376709
Epoch: 2, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.608130931854248
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.4188368320465088
Epoch: 4, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4969482421875
Epoch: 5, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.4323239326477051
Epoch: 6, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5627648830413818
Epoch: 7, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.48382067680358887
Epoch: 8, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.4833950996398926
Epoch: 9, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.478069543838501
Epoch: 10, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5495319366455078
Epoch: 11, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.5899307727813721
Epoch: 12, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5013332366943359
Epoch: 13, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6697385311126709
Epoch: 14, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.48943042755126953
Epoch: 15, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5716826915740967
Epoch: 16, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.523190975189209
Epoch: 17, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4446234703063965
Epoch: 18, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.486983060836792
Epoch: 19, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4912283420562744
Epoch: 20, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6455078125
Epoch: 21, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 111235
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.289850950241089
Epoch: 1, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.491 Vali Acc: 0.333 Test Loss: 1.491 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 0.5812203884124756
Epoch: 2, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.463 Vali Acc: 0.333 Test Loss: 1.463 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.5963680744171143
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.437 Vali Acc: 0.333 Test Loss: 1.437 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 0.5556368827819824
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.414 Vali Acc: 0.333 Test Loss: 1.414 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 0.6137509346008301
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.395 Vali Acc: 0.333 Test Loss: 1.395 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 0.5234267711639404
Epoch: 6, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.376 Vali Acc: 0.333 Test Loss: 1.376 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 0.5908083915710449
Epoch: 7, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.5144269466400146
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.5769834518432617
Epoch: 9, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.336 Vali Acc: 0.400 Test Loss: 1.336 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.4587376117706299
Epoch: 10, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.4841649532318115
Epoch: 11, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.5652186870574951
Epoch: 12, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.312 Vali Acc: 0.400 Test Loss: 1.312 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.595569372177124
Epoch: 13, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.5409896373748779
Epoch: 14, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 0.5455195903778076
Epoch: 15, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 16 cost time: 0.5486299991607666
Epoch: 16, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 17 cost time: 0.5902214050292969
Epoch: 17, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 18 cost time: 0.5780308246612549
Epoch: 18, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 19 cost time: 0.5303483009338379
Epoch: 19, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 20 cost time: 0.5666069984436035
Epoch: 20, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 21 cost time: 0.6266531944274902
Epoch: 21, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 22 cost time: 0.6803140640258789
Epoch: 22, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5658645629882812
Epoch: 23, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5558881759643555
Epoch: 24, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.285 Vali Acc: 0.333 Test Loss: 1.285 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6088080406188965
Epoch: 25, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5140719413757324
Epoch: 26, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.58404541015625
Epoch: 27, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5033330917358398
Epoch: 28, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.292 Vali Acc: 0.333 Test Loss: 1.292 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5350069999694824
Epoch: 29, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.295 Vali Acc: 0.333 Test Loss: 1.295 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5760607719421387
Epoch: 30, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5365045070648193
Epoch: 31, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 112131
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1496164798736572
Epoch: 1, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.5088717937469482
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.254 Vali Acc: 0.400 Test Loss: 1.254 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.5044071674346924
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.233 Vali Acc: 0.467 Test Loss: 1.233 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466654).  Saving model ...
Epoch: 4 cost time: 0.4890778064727783
Epoch: 4, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.521143913269043
Epoch: 5, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.200 Vali Acc: 0.533 Test Loss: 1.200 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 6 cost time: 0.5701353549957275
Epoch: 6, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.188 Vali Acc: 0.533 Test Loss: 1.188 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 7 cost time: 0.5359148979187012
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.177 Vali Acc: 0.600 Test Loss: 1.177 Test Acc: 0.600
Validation loss decreased (-0.533321 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.5420486927032471
Epoch: 8, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.45408058166503906
Epoch: 9, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.159 Vali Acc: 0.533 Test Loss: 1.159 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6121485233306885
Epoch: 10, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.151 Vali Acc: 0.533 Test Loss: 1.151 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.43618202209472656
Epoch: 11, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5655405521392822
Epoch: 12, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.140 Vali Acc: 0.533 Test Loss: 1.140 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5354588031768799
Epoch: 13, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.135 Vali Acc: 0.533 Test Loss: 1.135 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.49072742462158203
Epoch: 14, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.510124683380127
Epoch: 15, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.128 Vali Acc: 0.533 Test Loss: 1.128 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5052280426025391
Epoch: 16, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.48827266693115234
Epoch: 17, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 113411
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2989373207092285
Epoch: 1, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.295 Vali Acc: 0.400 Test Loss: 1.295 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.5817804336547852
Epoch: 2, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.5975956916809082
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5598537921905518
Epoch: 4, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.5841498374938965
Epoch: 5, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.7162621021270752
Epoch: 6, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.7395408153533936
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5285549163818359
Epoch: 8, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.512078046798706
Epoch: 9, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7564754486083984
Epoch: 10, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6563522815704346
Epoch: 11, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.619744062423706
Epoch: 12, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6052582263946533
Epoch: 13, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6457560062408447
Epoch: 14, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5904386043548584
Epoch: 15, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5933785438537598
Epoch: 16, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 98819
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1531484127044678
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.255 Vali Acc: 0.133 Test Loss: 1.255 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5881152153015137
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.256 Vali Acc: 0.133 Test Loss: 1.256 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5736978054046631
Epoch: 3, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.259 Vali Acc: 0.133 Test Loss: 1.259 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4810295104980469
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.262 Vali Acc: 0.133 Test Loss: 1.262 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5606591701507568
Epoch: 5, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.265 Vali Acc: 0.133 Test Loss: 1.265 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5849368572235107
Epoch: 6, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.267 Vali Acc: 0.133 Test Loss: 1.267 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6338462829589844
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.270 Vali Acc: 0.133 Test Loss: 1.270 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5603311061859131
Epoch: 8, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.273 Vali Acc: 0.133 Test Loss: 1.273 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4524216651916504
Epoch: 9, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.278 Vali Acc: 0.133 Test Loss: 1.278 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6071512699127197
Epoch: 10, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.282 Vali Acc: 0.133 Test Loss: 1.282 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4923579692840576
Epoch: 11, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.287 Vali Acc: 0.133 Test Loss: 1.287 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 84483
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.241486072540283
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5102791786193848
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4773581027984619
Epoch: 3, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4964103698730469
Epoch: 4, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.45264577865600586
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5297024250030518
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5645208358764648
Epoch: 7, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.486161470413208
Epoch: 8, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4800417423248291
Epoch: 9, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4237480163574219
Epoch: 10, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5327134132385254
Epoch: 11, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.5361497402191162
Epoch: 12, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.48009467124938965
Epoch: 13, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.7151355743408203
Epoch: 14, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.447066068649292
Epoch: 15, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5660779476165771
Epoch: 16, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.45149827003479004
Epoch: 17, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5052700042724609
Epoch: 18, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.44772768020629883
Epoch: 19, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5188086032867432
Epoch: 20, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4808521270751953
Epoch: 21, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5960605144500732
Epoch: 22, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.48752665519714355
Epoch: 23, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5578603744506836
Epoch: 24, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 80131
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3096511363983154
Epoch: 1, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5441997051239014
Epoch: 2, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6316201686859131
Epoch: 3, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5873963832855225
Epoch: 4, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5767092704772949
Epoch: 5, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5346462726593018
Epoch: 6, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.47925329208374023
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6288866996765137
Epoch: 8, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6524863243103027
Epoch: 9, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5028467178344727
Epoch: 10, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6203079223632812
Epoch: 11, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 78851
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3011105060577393
Epoch: 1, Steps: 1 | Train Loss: 1.405 Vali Loss: 1.295 Vali Acc: 0.333 Test Loss: 1.295 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.608283519744873
Epoch: 2, Steps: 1 | Train Loss: 1.361 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.541616678237915
Epoch: 3, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.279 Vali Acc: 0.333 Test Loss: 1.279 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5359091758728027
Epoch: 4, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6579141616821289
Epoch: 5, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.541461706161499
Epoch: 6, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5205917358398438
Epoch: 7, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4677259922027588
Epoch: 8, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.582406759262085
Epoch: 9, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4749314785003662
Epoch: 10, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5191290378570557
Epoch: 11, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4678494930267334
Epoch: 12, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.48976778984069824
Epoch: 13, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4961996078491211
Epoch: 14, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.246 Vali Acc: 0.200 Test Loss: 1.246 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5692992210388184
Epoch: 15, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 78211
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2915384769439697
Epoch: 1, Steps: 1 | Train Loss: 1.446 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.5656003952026367
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5504364967346191
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.240 Vali Acc: 0.200 Test Loss: 1.240 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4586293697357178
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.4701251983642578
Epoch: 5, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.49077820777893066
Epoch: 6, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.5644078254699707
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.5972931385040283
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.534351110458374
Epoch: 9, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.221 Vali Acc: 0.133 Test Loss: 1.221 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.525815486907959
Epoch: 10, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.219 Vali Acc: 0.133 Test Loss: 1.219 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5646834373474121
Epoch: 11, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.217 Vali Acc: 0.133 Test Loss: 1.217 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5048973560333252
Epoch: 12, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.216 Vali Acc: 0.133 Test Loss: 1.216 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.586944580078125
Epoch: 13, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.214 Vali Acc: 0.133 Test Loss: 1.214 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5323150157928467
Epoch: 14, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.212 Vali Acc: 0.133 Test Loss: 1.212 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4983553886413574
Epoch: 15, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7032053470611572
Epoch: 16, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.210 Vali Acc: 0.133 Test Loss: 1.210 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4986579418182373
Epoch: 17, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.209 Vali Acc: 0.133 Test Loss: 1.209 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5505554676055908
Epoch: 18, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 79107
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4561080932617188
Epoch: 1, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.455 Vali Acc: 0.333 Test Loss: 1.455 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 0.5443289279937744
Epoch: 2, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.442 Vali Acc: 0.333 Test Loss: 1.442 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.4544644355773926
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.430 Vali Acc: 0.333 Test Loss: 1.430 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 0.6612715721130371
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.419 Vali Acc: 0.333 Test Loss: 1.419 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 0.5459413528442383
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.411 Vali Acc: 0.333 Test Loss: 1.411 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 0.6228675842285156
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.403 Vali Acc: 0.333 Test Loss: 1.403 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 7 cost time: 0.5474803447723389
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.397 Vali Acc: 0.333 Test Loss: 1.397 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 8 cost time: 0.6238987445831299
Epoch: 8, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.392 Vali Acc: 0.333 Test Loss: 1.392 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 9 cost time: 0.4850442409515381
Epoch: 9, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.387 Vali Acc: 0.267 Test Loss: 1.387 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5790128707885742
Epoch: 10, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.381 Vali Acc: 0.267 Test Loss: 1.381 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5002400875091553
Epoch: 11, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.378 Vali Acc: 0.267 Test Loss: 1.378 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.51167893409729
Epoch: 12, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.375 Vali Acc: 0.267 Test Loss: 1.375 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5619637966156006
Epoch: 13, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.372 Vali Acc: 0.267 Test Loss: 1.372 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.585968017578125
Epoch: 14, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.370 Vali Acc: 0.267 Test Loss: 1.370 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5121145248413086
Epoch: 15, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.368 Vali Acc: 0.267 Test Loss: 1.368 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6469986438751221
Epoch: 16, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.367 Vali Acc: 0.267 Test Loss: 1.367 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5495531558990479
Epoch: 17, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.365 Vali Acc: 0.267 Test Loss: 1.365 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6260581016540527
Epoch: 18, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.363 Vali Acc: 0.267 Test Loss: 1.363 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 80387
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3639919757843018
Epoch: 1, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.241 Vali Acc: 0.267 Test Loss: 1.241 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.578441858291626
Epoch: 2, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5507543087005615
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5604455471038818
Epoch: 4, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5903246402740479
Epoch: 5, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.525639533996582
Epoch: 6, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5808751583099365
Epoch: 7, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.6140332221984863
Epoch: 8, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5405368804931641
Epoch: 9, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.7279036045074463
Epoch: 10, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.5770165920257568
Epoch: 11, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.6007165908813477
Epoch: 12, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5119619369506836
Epoch: 13, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5416979789733887
Epoch: 14, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.52069091796875
Epoch: 15, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5362334251403809
Epoch: 16, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.533745527267456
Epoch: 17, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6070542335510254
Epoch: 18, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.49143362045288086
Epoch: 19, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.521186113357544
Epoch: 20, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 0.47284436225891113
Epoch: 21, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4486415386199951
Epoch: 22, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.59775710105896
Epoch: 23, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.45084619522094727
Epoch: 24, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.5358667373657227
Epoch: 25, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.48424625396728516
Epoch: 26, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5455372333526611
Epoch: 27, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4959065914154053
Epoch: 28, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5045990943908691
Epoch: 29, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5421040058135986
Epoch: 30, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5494861602783203
Epoch: 31, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.555356502532959
Epoch: 32, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5195517539978027
Epoch: 33, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.332 Vali Acc: 0.333 Test Loss: 1.332 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5141582489013672
Epoch: 34, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 82307
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2542669773101807
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4438290596008301
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5945839881896973
Epoch: 3, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5799226760864258
Epoch: 4, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.48735880851745605
Epoch: 5, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.525550127029419
Epoch: 6, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5866861343383789
Epoch: 7, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5490310192108154
Epoch: 8, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5139951705932617
Epoch: 9, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6417334079742432
Epoch: 10, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5104398727416992
Epoch: 11, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5755569934844971
Epoch: 12, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.257 Vali Acc: 0.200 Test Loss: 1.257 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 67971
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0823171138763428
Epoch: 1, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5245053768157959
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5236377716064453
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.558661699295044
Epoch: 4, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5053367614746094
Epoch: 5, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5188264846801758
Epoch: 6, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5018119812011719
Epoch: 7, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5288307666778564
Epoch: 8, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5386176109313965
Epoch: 9, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6522953510284424
Epoch: 10, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6588940620422363
Epoch: 11, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5190412998199463
Epoch: 12, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 63619
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0144503116607666
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4828219413757324
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5439534187316895
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4950871467590332
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.542217493057251
Epoch: 5, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.630821704864502
Epoch: 6, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6012139320373535
Epoch: 7, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5877249240875244
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5165770053863525
Epoch: 9, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5497150421142578
Epoch: 10, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5258591175079346
Epoch: 11, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5031964778900146
Epoch: 12, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6035106182098389
Epoch: 13, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.539057731628418
Epoch: 14, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6091752052307129
Epoch: 15, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5553591251373291
Epoch: 16, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 62339
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1257693767547607
Epoch: 1, Steps: 1 | Train Loss: 1.348 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.49257850646972656
Epoch: 2, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4771146774291992
Epoch: 3, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5511927604675293
Epoch: 4, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.49785900115966797
Epoch: 5, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5711269378662109
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5509207248687744
Epoch: 7, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5328831672668457
Epoch: 8, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.5121703147888184
Epoch: 9, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.557142972946167
Epoch: 10, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4871542453765869
Epoch: 11, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.5720951557159424
Epoch: 12, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.5302326679229736
Epoch: 13, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.5849173069000244
Epoch: 14, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.5666799545288086
Epoch: 15, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5135505199432373
Epoch: 16, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.5446760654449463
Epoch: 17, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.5685524940490723
Epoch: 18, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.6530027389526367
Epoch: 19, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.6222460269927979
Epoch: 20, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.5094285011291504
Epoch: 21, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.675990104675293
Epoch: 22, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5914068222045898
Epoch: 23, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5188438892364502
Epoch: 24, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.560819149017334
Epoch: 25, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5145459175109863
Epoch: 26, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5679295063018799
Epoch: 27, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5782592296600342
Epoch: 28, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5110132694244385
Epoch: 29, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7760453224182129
Epoch: 30, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 61699
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.246696710586548
Epoch: 1, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.44974732398986816
Epoch: 2, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.531670093536377
Epoch: 3, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5094425678253174
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.500786542892456
Epoch: 5, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.5186607837677002
Epoch: 6, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.45227599143981934
Epoch: 7, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.6127922534942627
Epoch: 8, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5015711784362793
Epoch: 9, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.468463659286499
Epoch: 10, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.5545260906219482
Epoch: 11, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.513749361038208
Epoch: 12, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6106538772583008
Epoch: 13, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.475538969039917
Epoch: 14, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5761890411376953
Epoch: 15, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5802834033966064
Epoch: 16, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6823222637176514
Epoch: 17, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6107473373413086
Epoch: 18, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.46008777618408203
Epoch: 19, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5164108276367188
Epoch: 20, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5318772792816162
Epoch: 21, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 62595
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0128355026245117
Epoch: 1, Steps: 1 | Train Loss: 1.462 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.48852038383483887
Epoch: 2, Steps: 1 | Train Loss: 1.382 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.5114006996154785
Epoch: 3, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.49713873863220215
Epoch: 4, Steps: 1 | Train Loss: 1.407 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.5936627388000488
Epoch: 5, Steps: 1 | Train Loss: 1.373 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.5162680149078369
Epoch: 6, Steps: 1 | Train Loss: 1.385 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.41707277297973633
Epoch: 7, Steps: 1 | Train Loss: 1.414 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.4902470111846924
Epoch: 8, Steps: 1 | Train Loss: 1.391 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.49233341217041016
Epoch: 9, Steps: 1 | Train Loss: 1.402 Vali Loss: 1.037 Vali Acc: 0.267 Test Loss: 1.037 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5657923221588135
Epoch: 10, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.033 Vali Acc: 0.267 Test Loss: 1.033 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5074460506439209
Epoch: 11, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.028 Vali Acc: 0.333 Test Loss: 1.028 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.5912554264068604
Epoch: 12, Steps: 1 | Train Loss: 1.312 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.4875950813293457
Epoch: 13, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.44759368896484375
Epoch: 14, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 0.4968886375427246
Epoch: 15, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.012 Vali Acc: 0.400 Test Loss: 1.012 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 16 cost time: 0.46514344215393066
Epoch: 16, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 0.4634983539581299
Epoch: 17, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 0.4263577461242676
Epoch: 18, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 0.41420435905456543
Epoch: 19, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 20 cost time: 0.4859778881072998
Epoch: 20, Steps: 1 | Train Loss: 1.063 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 21 cost time: 0.3809366226196289
Epoch: 21, Steps: 1 | Train Loss: 0.914 Vali Loss: 0.995 Vali Acc: 0.400 Test Loss: 0.995 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4834713935852051
Epoch: 22, Steps: 1 | Train Loss: 0.878 Vali Loss: 0.993 Vali Acc: 0.400 Test Loss: 0.993 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.460252046585083
Epoch: 23, Steps: 1 | Train Loss: 0.887 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 24 cost time: 0.5355656147003174
Epoch: 24, Steps: 1 | Train Loss: 0.832 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 0.4899895191192627
Epoch: 25, Steps: 1 | Train Loss: 0.872 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.43798065185546875
Epoch: 26, Steps: 1 | Train Loss: 0.826 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 0.5071401596069336
Epoch: 27, Steps: 1 | Train Loss: 0.790 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.5404791831970215
Epoch: 28, Steps: 1 | Train Loss: 0.710 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.5583169460296631
Epoch: 29, Steps: 1 | Train Loss: 0.695 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 30 cost time: 0.47994399070739746
Epoch: 30, Steps: 1 | Train Loss: 0.625 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 31 cost time: 0.49090099334716797
Epoch: 31, Steps: 1 | Train Loss: 0.688 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 32 cost time: 0.500685453414917
Epoch: 32, Steps: 1 | Train Loss: 0.565 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 33 cost time: 0.5760631561279297
Epoch: 33, Steps: 1 | Train Loss: 0.508 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4947474002838135
Epoch: 34, Steps: 1 | Train Loss: 0.544 Vali Loss: 0.977 Vali Acc: 0.467 Test Loss: 0.977 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4720468521118164
Epoch: 35, Steps: 1 | Train Loss: 0.614 Vali Loss: 0.976 Vali Acc: 0.467 Test Loss: 0.976 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.458967924118042
Epoch: 36, Steps: 1 | Train Loss: 0.471 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5701253414154053
Epoch: 37, Steps: 1 | Train Loss: 0.441 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5269467830657959
Epoch: 38, Steps: 1 | Train Loss: 0.461 Vali Loss: 0.974 Vali Acc: 0.467 Test Loss: 0.974 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5216765403747559
Epoch: 39, Steps: 1 | Train Loss: 0.421 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5423891544342041
Epoch: 40, Steps: 1 | Train Loss: 0.451 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 41 cost time: 0.5655820369720459
Epoch: 41, Steps: 1 | Train Loss: 0.402 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6578056812286377
Epoch: 42, Steps: 1 | Train Loss: 0.334 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4721541404724121
Epoch: 43, Steps: 1 | Train Loss: 0.296 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.630561113357544
Epoch: 44, Steps: 1 | Train Loss: 0.337 Vali Loss: 0.979 Vali Acc: 0.467 Test Loss: 0.979 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.49422335624694824
Epoch: 45, Steps: 1 | Train Loss: 0.251 Vali Loss: 0.981 Vali Acc: 0.467 Test Loss: 0.981 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5146222114562988
Epoch: 46, Steps: 1 | Train Loss: 0.278 Vali Loss: 0.982 Vali Acc: 0.467 Test Loss: 0.982 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5675394535064697
Epoch: 47, Steps: 1 | Train Loss: 0.240 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.41902709007263184
Epoch: 48, Steps: 1 | Train Loss: 0.271 Vali Loss: 0.985 Vali Acc: 0.467 Test Loss: 0.985 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5030367374420166
Epoch: 49, Steps: 1 | Train Loss: 0.220 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.4945399761199951
Epoch: 50, Steps: 1 | Train Loss: 0.176 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm64_nh16_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 63875
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0939066410064697
Epoch: 1, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5198471546173096
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4959828853607178
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47660374641418457
Epoch: 4, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6343238353729248
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5042109489440918
Epoch: 6, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5300133228302002
Epoch: 7, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5143864154815674
Epoch: 8, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4965395927429199
Epoch: 9, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6073482036590576
Epoch: 10, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7075958251953125
Epoch: 11, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 57987
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9039833545684814
Epoch: 1, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.43880629539489746
Epoch: 2, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5539076328277588
Epoch: 3, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4532909393310547
Epoch: 4, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.40482354164123535
Epoch: 5, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5490818023681641
Epoch: 6, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4735414981842041
Epoch: 7, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.45803284645080566
Epoch: 8, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.49555325508117676
Epoch: 9, Steps: 1 | Train Loss: 1.016 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.5332367420196533
Epoch: 10, Steps: 1 | Train Loss: 0.933 Vali Loss: 0.987 Vali Acc: 0.667 Test Loss: 0.987 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.54486083984375
Epoch: 11, Steps: 1 | Train Loss: 0.920 Vali Loss: 0.981 Vali Acc: 0.667 Test Loss: 0.981 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 12 cost time: 0.5283880233764648
Epoch: 12, Steps: 1 | Train Loss: 1.031 Vali Loss: 0.976 Vali Acc: 0.667 Test Loss: 0.976 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 0.4736936092376709
Epoch: 13, Steps: 1 | Train Loss: 0.852 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 14 cost time: 0.5017154216766357
Epoch: 14, Steps: 1 | Train Loss: 0.882 Vali Loss: 0.968 Vali Acc: 0.600 Test Loss: 0.968 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4996356964111328
Epoch: 15, Steps: 1 | Train Loss: 0.898 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5345168113708496
Epoch: 16, Steps: 1 | Train Loss: 0.906 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.43181586265563965
Epoch: 17, Steps: 1 | Train Loss: 0.815 Vali Loss: 0.961 Vali Acc: 0.600 Test Loss: 0.961 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4563324451446533
Epoch: 18, Steps: 1 | Train Loss: 0.745 Vali Loss: 0.960 Vali Acc: 0.600 Test Loss: 0.960 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.45934033393859863
Epoch: 19, Steps: 1 | Train Loss: 0.711 Vali Loss: 0.959 Vali Acc: 0.600 Test Loss: 0.959 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4648880958557129
Epoch: 20, Steps: 1 | Train Loss: 0.804 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.560396671295166
Epoch: 21, Steps: 1 | Train Loss: 0.746 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5921058654785156
Epoch: 22, Steps: 1 | Train Loss: 0.857 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5582754611968994
Epoch: 23, Steps: 1 | Train Loss: 0.723 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 50819
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7753705978393555
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4347343444824219
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.40201640129089355
Epoch: 3, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.4381368160247803
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4320540428161621
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.44936227798461914
Epoch: 6, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5082132816314697
Epoch: 7, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.4877052307128906
Epoch: 8, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.4811372756958008
Epoch: 9, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.4093301296234131
Epoch: 10, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.40157341957092285
Epoch: 11, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5032644271850586
Epoch: 12, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.4377925395965576
Epoch: 13, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.46462154388427734
Epoch: 14, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.4322335720062256
Epoch: 15, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.4545481204986572
Epoch: 16, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.46041297912597656
Epoch: 17, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4894754886627197
Epoch: 18, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.42459940910339355
Epoch: 19, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5022070407867432
Epoch: 20, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4821479320526123
Epoch: 21, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4449491500854492
Epoch: 22, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.43117284774780273
Epoch: 23, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5396151542663574
Epoch: 24, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4424431324005127
Epoch: 25, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 48643
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.13419246673584
Epoch: 1, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5482008457183838
Epoch: 2, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5617918968200684
Epoch: 3, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.251 Vali Acc: 0.200 Test Loss: 1.251 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5280308723449707
Epoch: 4, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.249 Vali Acc: 0.200 Test Loss: 1.249 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5021746158599854
Epoch: 5, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.247 Vali Acc: 0.200 Test Loss: 1.247 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6089332103729248
Epoch: 6, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.246 Vali Acc: 0.200 Test Loss: 1.246 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5216319561004639
Epoch: 7, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.514930009841919
Epoch: 8, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.552351713180542
Epoch: 9, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.495957612991333
Epoch: 10, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4841489791870117
Epoch: 11, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6122064590454102
Epoch: 12, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 48003
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5181660652160645
Epoch: 1, Steps: 1 | Train Loss: 1.505 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6071584224700928
Epoch: 2, Steps: 1 | Train Loss: 1.379 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6713905334472656
Epoch: 3, Steps: 1 | Train Loss: 1.438 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.600327730178833
Epoch: 4, Steps: 1 | Train Loss: 1.430 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5987484455108643
Epoch: 5, Steps: 1 | Train Loss: 1.585 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.5961081981658936
Epoch: 6, Steps: 1 | Train Loss: 1.358 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.72709059715271
Epoch: 7, Steps: 1 | Train Loss: 1.459 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.595341682434082
Epoch: 8, Steps: 1 | Train Loss: 1.419 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6192295551300049
Epoch: 9, Steps: 1 | Train Loss: 1.461 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.60434889793396
Epoch: 10, Steps: 1 | Train Loss: 1.330 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6411101818084717
Epoch: 11, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5857467651367188
Epoch: 12, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5761799812316895
Epoch: 13, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7560751438140869
Epoch: 14, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5755977630615234
Epoch: 15, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 47683
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2131869792938232
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4785890579223633
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5395519733428955
Epoch: 3, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.291 Vali Acc: 0.267 Test Loss: 1.291 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45038843154907227
Epoch: 4, Steps: 1 | Train Loss: 1.318 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.48891782760620117
Epoch: 5, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.297 Vali Acc: 0.333 Test Loss: 1.297 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4808628559112549
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.300 Vali Acc: 0.333 Test Loss: 1.300 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.49540019035339355
Epoch: 7, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.46579813957214355
Epoch: 8, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5734386444091797
Epoch: 9, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.48308491706848145
Epoch: 10, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5017154216766357
Epoch: 11, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4372439384460449
Epoch: 12, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.313 Vali Acc: 0.333 Test Loss: 1.313 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5666122436523438
Epoch: 13, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.48106837272644043
Epoch: 14, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4334416389465332
Epoch: 15, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5711867809295654
Epoch: 16, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5228865146636963
Epoch: 17, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 48131
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2462613582611084
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.473067045211792
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.49593162536621094
Epoch: 3, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5820474624633789
Epoch: 4, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.46536803245544434
Epoch: 5, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.5916967391967773
Epoch: 6, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5351018905639648
Epoch: 7, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.5775415897369385
Epoch: 8, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.6128959655761719
Epoch: 9, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.6210346221923828
Epoch: 10, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.451357364654541
Epoch: 11, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.554640531539917
Epoch: 12, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.5055022239685059
Epoch: 13, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6065459251403809
Epoch: 14, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5426251888275146
Epoch: 15, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7145659923553467
Epoch: 16, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5498831272125244
Epoch: 17, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6463820934295654
Epoch: 18, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.47763872146606445
Epoch: 19, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5975749492645264
Epoch: 20, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5160963535308838
Epoch: 21, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5038480758666992
Epoch: 22, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 48771
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1718389987945557
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
Validation loss decreased (inf --> -0.466654).  Saving model ...
Epoch: 2 cost time: 0.49086809158325195
Epoch: 2, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6832630634307861
Epoch: 3, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5791678428649902
Epoch: 4, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.567530632019043
Epoch: 5, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6529421806335449
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.501685380935669
Epoch: 7, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6207337379455566
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5040216445922852
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4541909694671631
Epoch: 10, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5919334888458252
Epoch: 11, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 41347
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.148139476776123
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.218 Vali Acc: 0.133 Test Loss: 1.218 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5022923946380615
Epoch: 2, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.220 Vali Acc: 0.133 Test Loss: 1.220 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47963857650756836
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.221 Vali Acc: 0.133 Test Loss: 1.221 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5407936573028564
Epoch: 4, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.223 Vali Acc: 0.133 Test Loss: 1.223 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5633745193481445
Epoch: 5, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.225 Vali Acc: 0.133 Test Loss: 1.225 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.45546460151672363
Epoch: 6, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.226 Vali Acc: 0.133 Test Loss: 1.226 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5400607585906982
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.227 Vali Acc: 0.133 Test Loss: 1.227 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5552000999450684
Epoch: 8, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.229 Vali Acc: 0.133 Test Loss: 1.229 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5617978572845459
Epoch: 9, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.230 Vali Acc: 0.133 Test Loss: 1.230 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5236339569091797
Epoch: 10, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.232 Vali Acc: 0.133 Test Loss: 1.232 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.619835376739502
Epoch: 11, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.234 Vali Acc: 0.133 Test Loss: 1.234 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 34179
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2050843238830566
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.358 Vali Acc: 0.333 Test Loss: 1.358 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.4716489315032959
Epoch: 2, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.47107815742492676
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.326 Vali Acc: 0.333 Test Loss: 1.326 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.5950336456298828
Epoch: 4, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.312 Vali Acc: 0.267 Test Loss: 1.312 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.43331313133239746
Epoch: 5, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.301 Vali Acc: 0.333 Test Loss: 1.301 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.4470820426940918
Epoch: 6, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.295 Vali Acc: 0.333 Test Loss: 1.295 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 0.49530982971191406
Epoch: 7, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.5370125770568848
Epoch: 8, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 9 cost time: 0.5021109580993652
Epoch: 9, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5131864547729492
Epoch: 10, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.4990246295928955
Epoch: 11, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.4671652317047119
Epoch: 12, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.4570655822753906
Epoch: 13, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4131038188934326
Epoch: 14, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5082948207855225
Epoch: 15, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.510711669921875
Epoch: 16, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5801255702972412
Epoch: 17, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5005209445953369
Epoch: 18, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5080633163452148
Epoch: 19, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4755992889404297
Epoch: 20, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.47587156295776367
Epoch: 21, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.246 Vali Acc: 0.200 Test Loss: 1.246 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5733916759490967
Epoch: 22, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 32003
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.198282241821289
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4846153259277344
Epoch: 2, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5800402164459229
Epoch: 3, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4673302173614502
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5464515686035156
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5874826908111572
Epoch: 6, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5848350524902344
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4502885341644287
Epoch: 8, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4686863422393799
Epoch: 9, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.494462251663208
Epoch: 10, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4644901752471924
Epoch: 11, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 31363
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.188084363937378
Epoch: 1, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4728670120239258
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5039680004119873
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6359682083129883
Epoch: 4, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5181031227111816
Epoch: 5, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5426499843597412
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6801893711090088
Epoch: 7, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5408234596252441
Epoch: 8, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5555415153503418
Epoch: 9, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5326104164123535
Epoch: 10, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6850357055664062
Epoch: 11, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 31043
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2365241050720215
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.553105354309082
Epoch: 2, Steps: 1 | Train Loss: 1.301 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.4992492198944092
Epoch: 3, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5547997951507568
Epoch: 4, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5685994625091553
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.5831823348999023
Epoch: 6, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5795128345489502
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.6012804508209229
Epoch: 8, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.535484790802002
Epoch: 9, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.5424606800079346
Epoch: 10, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.6124756336212158
Epoch: 11, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.5537173748016357
Epoch: 12, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.5890028476715088
Epoch: 13, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.5927591323852539
Epoch: 14, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.5026264190673828
Epoch: 15, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.5122697353363037
Epoch: 16, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.6041309833526611
Epoch: 17, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.5605323314666748
Epoch: 18, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.7295427322387695
Epoch: 19, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 0.493267297744751
Epoch: 20, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 0.594839334487915
Epoch: 21, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 0.5176398754119873
Epoch: 22, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 23 cost time: 0.4876868724822998
Epoch: 23, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 0.5934393405914307
Epoch: 24, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 25 cost time: 0.6537871360778809
Epoch: 25, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 26 cost time: 0.5336093902587891
Epoch: 26, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 27 cost time: 0.5841860771179199
Epoch: 27, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 28 cost time: 0.5739624500274658
Epoch: 28, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 29 cost time: 0.6503331661224365
Epoch: 29, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 30 cost time: 0.5354130268096924
Epoch: 30, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 31 cost time: 0.5442981719970703
Epoch: 31, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 32 cost time: 0.5025956630706787
Epoch: 32, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5506930351257324
Epoch: 33, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 34 cost time: 0.6163194179534912
Epoch: 34, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 35 cost time: 0.5071511268615723
Epoch: 35, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5829658508300781
Epoch: 36, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4985947608947754
Epoch: 37, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.504472017288208
Epoch: 38, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4949469566345215
Epoch: 39, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5209567546844482
Epoch: 40, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5139162540435791
Epoch: 41, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.45383524894714355
Epoch: 42, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.555426836013794
Epoch: 43, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.47130680084228516
Epoch: 44, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 31491
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1898086071014404
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4636502265930176
Epoch: 2, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6072397232055664
Epoch: 3, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5194594860076904
Epoch: 4, Steps: 1 | Train Loss: 1.379 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5183002948760986
Epoch: 5, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.5560934543609619
Epoch: 6, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.4430069923400879
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5285072326660156
Epoch: 8, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.49668312072753906
Epoch: 9, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.49187302589416504
Epoch: 10, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.516460657119751
Epoch: 11, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.5418643951416016
Epoch: 12, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.4478950500488281
Epoch: 13, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.5233020782470703
Epoch: 14, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.4472792148590088
Epoch: 15, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.50370192527771
Epoch: 16, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4775106906890869
Epoch: 17, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4927849769592285
Epoch: 18, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.45848965644836426
Epoch: 19, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4650909900665283
Epoch: 20, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5155470371246338
Epoch: 21, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5406632423400879
Epoch: 22, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5129942893981934
Epoch: 23, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.596621036529541
Epoch: 24, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 32131
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.421447515487671
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5944418907165527
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5267589092254639
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5237019062042236
Epoch: 4, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5214791297912598
Epoch: 5, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.534874439239502
Epoch: 6, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6300597190856934
Epoch: 7, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5062370300292969
Epoch: 8, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4974808692932129
Epoch: 9, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.45186781883239746
Epoch: 10, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4990980625152588
Epoch: 11, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4917488098144531
Epoch: 12, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5964157581329346
Epoch: 13, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6186392307281494
Epoch: 14, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4812929630279541
Epoch: 15, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5301985740661621
Epoch: 16, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 33027
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.353991985321045
Epoch: 1, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.47346949577331543
Epoch: 2, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.490020751953125
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5463395118713379
Epoch: 4, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.45683789253234863
Epoch: 5, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.549013614654541
Epoch: 6, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.4718039035797119
Epoch: 7, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.5008957386016846
Epoch: 8, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.49297332763671875
Epoch: 9, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5405576229095459
Epoch: 10, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.49286937713623047
Epoch: 11, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.48032402992248535
Epoch: 12, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6512470245361328
Epoch: 13, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5765376091003418
Epoch: 14, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5531661510467529
Epoch: 15, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5653884410858154
Epoch: 16, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5248308181762695
Epoch: 17, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5685007572174072
Epoch: 18, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 25859
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3121695518493652
Epoch: 1, Steps: 1 | Train Loss: 1.426 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6020708084106445
Epoch: 2, Steps: 1 | Train Loss: 1.423 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5321333408355713
Epoch: 3, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6943340301513672
Epoch: 4, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5593099594116211
Epoch: 5, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5264360904693604
Epoch: 6, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5646934509277344
Epoch: 7, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5783665180206299
Epoch: 8, Steps: 1 | Train Loss: 1.387 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5548465251922607
Epoch: 9, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5433783531188965
Epoch: 10, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.6353249549865723
Epoch: 11, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5465526580810547
Epoch: 12, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.6217846870422363
Epoch: 13, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.5587723255157471
Epoch: 14, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.6605350971221924
Epoch: 15, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.6014518737792969
Epoch: 16, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.6084578037261963
Epoch: 17, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.583521842956543
Epoch: 18, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5170409679412842
Epoch: 19, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5171535015106201
Epoch: 20, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5321216583251953
Epoch: 21, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5806930065155029
Epoch: 22, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6352951526641846
Epoch: 23, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.563298225402832
Epoch: 24, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6054542064666748
Epoch: 25, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5693843364715576
Epoch: 26, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6308045387268066
Epoch: 27, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23683
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9231312274932861
Epoch: 1, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.438 Vali Acc: 0.267 Test Loss: 1.438 Test Acc: 0.267
Validation loss decreased (inf --> -0.266652).  Saving model ...
Epoch: 2 cost time: 0.5092487335205078
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.427 Vali Acc: 0.200 Test Loss: 1.427 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.489241361618042
Epoch: 3, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.417 Vali Acc: 0.200 Test Loss: 1.417 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5265994071960449
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.407 Vali Acc: 0.200 Test Loss: 1.407 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5477352142333984
Epoch: 5, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.400 Vali Acc: 0.133 Test Loss: 1.400 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4369022846221924
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.394 Vali Acc: 0.133 Test Loss: 1.394 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.48586392402648926
Epoch: 7, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.390 Vali Acc: 0.133 Test Loss: 1.390 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5954935550689697
Epoch: 8, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.386 Vali Acc: 0.133 Test Loss: 1.386 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5194487571716309
Epoch: 9, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.382 Vali Acc: 0.133 Test Loss: 1.382 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4775967597961426
Epoch: 10, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.378 Vali Acc: 0.133 Test Loss: 1.378 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.504894495010376
Epoch: 11, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.376 Vali Acc: 0.133 Test Loss: 1.376 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 23043
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.287119150161743
Epoch: 1, Steps: 1 | Train Loss: 1.283 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4815950393676758
Epoch: 2, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5585730075836182
Epoch: 3, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6172022819519043
Epoch: 4, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.45879411697387695
Epoch: 5, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5469856262207031
Epoch: 6, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.48117733001708984
Epoch: 7, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.46448493003845215
Epoch: 8, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4819915294647217
Epoch: 9, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5148911476135254
Epoch: 10, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5455124378204346
Epoch: 11, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4973564147949219
Epoch: 12, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.527756929397583
Epoch: 13, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5078442096710205
Epoch: 14, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 22723
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.111516237258911
Epoch: 1, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.47896575927734375
Epoch: 2, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4769763946533203
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4874720573425293
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.523374080657959
Epoch: 5, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4679601192474365
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4841609001159668
Epoch: 7, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5566699504852295
Epoch: 8, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.516653299331665
Epoch: 9, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5297472476959229
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.44919562339782715
Epoch: 11, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 23171
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.123340129852295
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4749715328216553
Epoch: 2, Steps: 1 | Train Loss: 1.377 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4370236396789551
Epoch: 3, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5213391780853271
Epoch: 4, Steps: 1 | Train Loss: 1.309 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4918191432952881
Epoch: 5, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.46880030632019043
Epoch: 6, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.4231281280517578
Epoch: 7, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.440840482711792
Epoch: 8, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.277 Vali Acc: 0.400 Test Loss: 1.277 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.572495698928833
Epoch: 9, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.45847153663635254
Epoch: 10, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.47667407989501953
Epoch: 11, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.285 Vali Acc: 0.333 Test Loss: 1.285 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.518498420715332
Epoch: 12, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.43871212005615234
Epoch: 13, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4369215965270996
Epoch: 14, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6049525737762451
Epoch: 15, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.48703837394714355
Epoch: 16, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm32_nh4_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23811
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3326337337493896
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5213844776153564
Epoch: 2, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5883095264434814
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5682008266448975
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6224062442779541
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.523914098739624
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.54380202293396
Epoch: 7, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6815695762634277
Epoch: 8, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5097582340240479
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.673323392868042
Epoch: 10, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5154869556427002
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 27203
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3199195861816406
Epoch: 1, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4878246784210205
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5689799785614014
Epoch: 3, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5400152206420898
Epoch: 4, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5607833862304688
Epoch: 5, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7437038421630859
Epoch: 6, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.6068675518035889
Epoch: 7, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.6049065589904785
Epoch: 8, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5809929370880127
Epoch: 9, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.5761165618896484
Epoch: 10, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 11 cost time: 0.6373000144958496
Epoch: 11, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 12 cost time: 0.5646133422851562
Epoch: 12, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 0.6210899353027344
Epoch: 13, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.5286350250244141
Epoch: 14, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.6061832904815674
Epoch: 15, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.63004469871521
Epoch: 16, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.5417582988739014
Epoch: 17, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.5370378494262695
Epoch: 18, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.5360147953033447
Epoch: 19, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.6274771690368652
Epoch: 20, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.4719374179840088
Epoch: 21, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.5660214424133301
Epoch: 22, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.49604272842407227
Epoch: 23, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.4695858955383301
Epoch: 24, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5150260925292969
Epoch: 25, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5025901794433594
Epoch: 26, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5727777481079102
Epoch: 27, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5554862022399902
Epoch: 28, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5709972381591797
Epoch: 29, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5679199695587158
Epoch: 30, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 31 cost time: 0.5197060108184814
Epoch: 31, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5462751388549805
Epoch: 32, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6114742755889893
Epoch: 33, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5480210781097412
Epoch: 34, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6201491355895996
Epoch: 35, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5525388717651367
Epoch: 36, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 37 cost time: 0.4730989933013916
Epoch: 37, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 38 cost time: 0.5167422294616699
Epoch: 38, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5156054496765137
Epoch: 39, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.47788143157958984
Epoch: 40, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7255609035491943
Epoch: 41, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4389503002166748
Epoch: 42, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5839917659759521
Epoch: 43, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5756103992462158
Epoch: 44, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5663838386535645
Epoch: 45, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5256388187408447
Epoch: 46, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5362601280212402
Epoch: 47, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 23619
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2623345851898193
Epoch: 1, Steps: 1 | Train Loss: 1.391 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5937013626098633
Epoch: 2, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5987246036529541
Epoch: 3, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5740811824798584
Epoch: 4, Steps: 1 | Train Loss: 1.323 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5598256587982178
Epoch: 5, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.6027300357818604
Epoch: 6, Steps: 1 | Train Loss: 1.379 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.6809415817260742
Epoch: 7, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.6568989753723145
Epoch: 8, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.5816023349761963
Epoch: 9, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.5260224342346191
Epoch: 10, Steps: 1 | Train Loss: 1.366 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.6030008792877197
Epoch: 11, Steps: 1 | Train Loss: 1.358 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.5231702327728271
Epoch: 12, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.6236071586608887
Epoch: 13, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6452913284301758
Epoch: 14, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6281425952911377
Epoch: 15, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5567464828491211
Epoch: 16, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.6508872509002686
Epoch: 17, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.6061184406280518
Epoch: 18, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.5792257785797119
Epoch: 19, Steps: 1 | Train Loss: 1.127 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.6257236003875732
Epoch: 20, Steps: 1 | Train Loss: 1.083 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.6511480808258057
Epoch: 21, Steps: 1 | Train Loss: 1.070 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.6767795085906982
Epoch: 22, Steps: 1 | Train Loss: 1.015 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.7986495494842529
Epoch: 23, Steps: 1 | Train Loss: 1.181 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.6673297882080078
Epoch: 24, Steps: 1 | Train Loss: 1.126 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.6092433929443359
Epoch: 25, Steps: 1 | Train Loss: 1.044 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.7261829376220703
Epoch: 26, Steps: 1 | Train Loss: 0.999 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 0.6570529937744141
Epoch: 27, Steps: 1 | Train Loss: 1.044 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.6906967163085938
Epoch: 28, Steps: 1 | Train Loss: 0.929 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.5924885272979736
Epoch: 29, Steps: 1 | Train Loss: 0.953 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.5874533653259277
Epoch: 30, Steps: 1 | Train Loss: 0.899 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5764281749725342
Epoch: 31, Steps: 1 | Train Loss: 0.988 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6260724067687988
Epoch: 32, Steps: 1 | Train Loss: 0.890 Vali Loss: 0.986 Vali Acc: 0.400 Test Loss: 0.986 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6256060600280762
Epoch: 33, Steps: 1 | Train Loss: 1.050 Vali Loss: 0.986 Vali Acc: 0.333 Test Loss: 0.986 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5359756946563721
Epoch: 34, Steps: 1 | Train Loss: 0.752 Vali Loss: 0.986 Vali Acc: 0.333 Test Loss: 0.986 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.650871753692627
Epoch: 35, Steps: 1 | Train Loss: 0.816 Vali Loss: 0.986 Vali Acc: 0.333 Test Loss: 0.986 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5420687198638916
Epoch: 36, Steps: 1 | Train Loss: 0.861 Vali Loss: 0.986 Vali Acc: 0.333 Test Loss: 0.986 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.534531831741333
Epoch: 37, Steps: 1 | Train Loss: 0.792 Vali Loss: 0.987 Vali Acc: 0.400 Test Loss: 0.987 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6204080581665039
Epoch: 38, Steps: 1 | Train Loss: 0.725 Vali Loss: 0.987 Vali Acc: 0.400 Test Loss: 0.987 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5112707614898682
Epoch: 39, Steps: 1 | Train Loss: 0.733 Vali Loss: 0.987 Vali Acc: 0.400 Test Loss: 0.987 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 22531
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1652705669403076
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5258040428161621
Epoch: 2, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5404462814331055
Epoch: 3, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4989321231842041
Epoch: 4, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4673614501953125
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5955691337585449
Epoch: 6, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5183935165405273
Epoch: 7, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6564137935638428
Epoch: 8, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.48163557052612305
Epoch: 9, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.43373751640319824
Epoch: 10, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5780792236328125
Epoch: 11, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6614181995391846
Epoch: 12, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5553984642028809
Epoch: 13, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.681220531463623
Epoch: 14, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5513565540313721
Epoch: 15, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5934174060821533
Epoch: 16, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6162998676300049
Epoch: 17, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.573148250579834
Epoch: 18, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 22211
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6887612342834473
Epoch: 1, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.617379903793335
Epoch: 2, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.6175925731658936
Epoch: 3, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6074960231781006
Epoch: 4, Steps: 1 | Train Loss: 1.444 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6707234382629395
Epoch: 5, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7212190628051758
Epoch: 6, Steps: 1 | Train Loss: 1.422 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6030166149139404
Epoch: 7, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7005815505981445
Epoch: 8, Steps: 1 | Train Loss: 1.459 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6726362705230713
Epoch: 9, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7126531600952148
Epoch: 10, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6860792636871338
Epoch: 11, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5670664310455322
Epoch: 12, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 22051
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2739930152893066
Epoch: 1, Steps: 1 | Train Loss: 1.321 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6546814441680908
Epoch: 2, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5238533020019531
Epoch: 3, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6168594360351562
Epoch: 4, Steps: 1 | Train Loss: 1.398 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5096707344055176
Epoch: 5, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5515074729919434
Epoch: 6, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.287 Vali Acc: 0.333 Test Loss: 1.287 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 0.5441174507141113
Epoch: 7, Steps: 1 | Train Loss: 1.433 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6236495971679688
Epoch: 8, Steps: 1 | Train Loss: 1.428 Vali Loss: 1.292 Vali Acc: 0.333 Test Loss: 1.292 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4864315986633301
Epoch: 9, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.295 Vali Acc: 0.333 Test Loss: 1.295 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6940836906433105
Epoch: 10, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5320243835449219
Epoch: 11, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.298 Vali Acc: 0.333 Test Loss: 1.298 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6649212837219238
Epoch: 12, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.301 Vali Acc: 0.333 Test Loss: 1.301 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6658928394317627
Epoch: 13, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.302 Vali Acc: 0.333 Test Loss: 1.302 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5748002529144287
Epoch: 14, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6092193126678467
Epoch: 15, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.306 Vali Acc: 0.333 Test Loss: 1.306 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5919718742370605
Epoch: 16, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 22275
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3370511531829834
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5291159152984619
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5962023735046387
Epoch: 3, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.233 Vali Acc: 0.467 Test Loss: 1.233 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 4 cost time: 0.5044748783111572
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 5 cost time: 0.626110315322876
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 6 cost time: 0.5332727432250977
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 7 cost time: 0.7269845008850098
Epoch: 7, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.231 Vali Acc: 0.533 Test Loss: 1.231 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533321).  Saving model ...
Epoch: 8 cost time: 0.537592887878418
Epoch: 8, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.230 Vali Acc: 0.533 Test Loss: 1.230 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 9 cost time: 0.5416498184204102
Epoch: 9, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.229 Vali Acc: 0.533 Test Loss: 1.229 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 10 cost time: 0.5678765773773193
Epoch: 10, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.229 Vali Acc: 0.533 Test Loss: 1.229 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 11 cost time: 0.5493340492248535
Epoch: 11, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.229 Vali Acc: 0.533 Test Loss: 1.229 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 12 cost time: 0.6010029315948486
Epoch: 12, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.228 Vali Acc: 0.533 Test Loss: 1.228 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 13 cost time: 0.5999853610992432
Epoch: 13, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.228 Vali Acc: 0.533 Test Loss: 1.228 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 14 cost time: 0.5287880897521973
Epoch: 14, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.226 Vali Acc: 0.533 Test Loss: 1.226 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 15 cost time: 0.5865902900695801
Epoch: 15, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.226 Vali Acc: 0.533 Test Loss: 1.226 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 16 cost time: 0.7229373455047607
Epoch: 16, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.224 Vali Acc: 0.533 Test Loss: 1.224 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 17 cost time: 0.6484668254852295
Epoch: 17, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.223 Vali Acc: 0.533 Test Loss: 1.223 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 18 cost time: 0.5186843872070312
Epoch: 18, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.221 Vali Acc: 0.533 Test Loss: 1.221 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 19 cost time: 0.7456488609313965
Epoch: 19, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.219 Vali Acc: 0.533 Test Loss: 1.219 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 20 cost time: 0.7081873416900635
Epoch: 20, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.218 Vali Acc: 0.533 Test Loss: 1.218 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 21 cost time: 0.5684871673583984
Epoch: 21, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.216 Vali Acc: 0.533 Test Loss: 1.216 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 22 cost time: 0.5495374202728271
Epoch: 22, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.214 Vali Acc: 0.533 Test Loss: 1.214 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 23 cost time: 0.5414767265319824
Epoch: 23, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.212 Vali Acc: 0.467 Test Loss: 1.212 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5926492214202881
Epoch: 24, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6769847869873047
Epoch: 25, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6406338214874268
Epoch: 26, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.206 Vali Acc: 0.467 Test Loss: 1.206 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7337777614593506
Epoch: 27, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.204 Vali Acc: 0.467 Test Loss: 1.204 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7185201644897461
Epoch: 28, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.587047815322876
Epoch: 29, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.201 Vali Acc: 0.467 Test Loss: 1.201 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6636450290679932
Epoch: 30, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4782848358154297
Epoch: 31, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5844683647155762
Epoch: 32, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.195 Vali Acc: 0.533 Test Loss: 1.195 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 33 cost time: 0.599703311920166
Epoch: 33, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.194 Vali Acc: 0.533 Test Loss: 1.194 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 34 cost time: 0.5639400482177734
Epoch: 34, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.192 Vali Acc: 0.600 Test Loss: 1.192 Test Acc: 0.600
Validation loss decreased (-0.533321 --> -0.599988).  Saving model ...
Epoch: 35 cost time: 0.541921854019165
Epoch: 35, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.190 Vali Acc: 0.600 Test Loss: 1.190 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 36 cost time: 0.4862492084503174
Epoch: 36, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.187 Vali Acc: 0.533 Test Loss: 1.187 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6217739582061768
Epoch: 37, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.185 Vali Acc: 0.533 Test Loss: 1.185 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6557190418243408
Epoch: 38, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.184 Vali Acc: 0.533 Test Loss: 1.184 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5511302947998047
Epoch: 39, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.182 Vali Acc: 0.533 Test Loss: 1.182 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6609921455383301
Epoch: 40, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.180 Vali Acc: 0.533 Test Loss: 1.180 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6847553253173828
Epoch: 41, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5684282779693604
Epoch: 42, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.177 Vali Acc: 0.533 Test Loss: 1.177 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6389431953430176
Epoch: 43, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.176 Vali Acc: 0.533 Test Loss: 1.176 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6388828754425049
Epoch: 44, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.174 Vali Acc: 0.533 Test Loss: 1.174 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6065025329589844
Epoch: 45, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.172 Vali Acc: 0.533 Test Loss: 1.172 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 22595
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.201564311981201
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.48625993728637695
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.002 Vali Acc: 0.667 Test Loss: 1.002 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 0.4845707416534424
Epoch: 3, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.002 Vali Acc: 0.667 Test Loss: 1.002 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 0.4930422306060791
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.001 Vali Acc: 0.667 Test Loss: 1.001 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 0.6126089096069336
Epoch: 5, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 0.47321629524230957
Epoch: 6, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 7 cost time: 0.562769889831543
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 0.4440805912017822
Epoch: 8, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.46417927742004395
Epoch: 9, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5248973369598389
Epoch: 10, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.45955491065979004
Epoch: 11, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5340542793273926
Epoch: 12, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5194766521453857
Epoch: 13, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4285154342651367
Epoch: 14, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.545881986618042
Epoch: 15, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5506815910339355
Epoch: 16, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5444004535675049
Epoch: 17, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 18755
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.353400945663452
Epoch: 1, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5779907703399658
Epoch: 2, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6221165657043457
Epoch: 3, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7315185070037842
Epoch: 4, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5275521278381348
Epoch: 5, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.530811071395874
Epoch: 6, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6313767433166504
Epoch: 7, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6462633609771729
Epoch: 8, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5278275012969971
Epoch: 9, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6158382892608643
Epoch: 10, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5555145740509033
Epoch: 11, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.670325517654419
Epoch: 12, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6050500869750977
Epoch: 13, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7069272994995117
Epoch: 14, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6754400730133057
Epoch: 15, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6254122257232666
Epoch: 16, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5047123432159424
Epoch: 17, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5873010158538818
Epoch: 18, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 15171
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.197183847427368
Epoch: 1, Steps: 1 | Train Loss: 1.482 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5294053554534912
Epoch: 2, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5292589664459229
Epoch: 3, Steps: 1 | Train Loss: 1.382 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5796551704406738
Epoch: 4, Steps: 1 | Train Loss: 1.377 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5224440097808838
Epoch: 5, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5388100147247314
Epoch: 6, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6567070484161377
Epoch: 7, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6432816982269287
Epoch: 8, Steps: 1 | Train Loss: 1.315 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.5847246646881104
Epoch: 9, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5612902641296387
Epoch: 10, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.6129155158996582
Epoch: 11, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7061622142791748
Epoch: 12, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.6528513431549072
Epoch: 13, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.5416338443756104
Epoch: 14, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.505950927734375
Epoch: 15, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5772943496704102
Epoch: 16, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5591890811920166
Epoch: 17, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.551429271697998
Epoch: 18, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6886692047119141
Epoch: 19, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5710265636444092
Epoch: 20, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5561840534210205
Epoch: 21, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.575211763381958
Epoch: 22, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4938511848449707
Epoch: 23, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5759530067443848
Epoch: 24, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4682788848876953
Epoch: 25, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14083
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.213437557220459
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.614325761795044
Epoch: 2, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.43854856491088867
Epoch: 3, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5551135540008545
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5263059139251709
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5768909454345703
Epoch: 6, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5408339500427246
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5713624954223633
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.548933744430542
Epoch: 9, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5692324638366699
Epoch: 10, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6154191493988037
Epoch: 11, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6272182464599609
Epoch: 12, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 13763
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5432984828948975
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5221962928771973
Epoch: 2, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5642163753509521
Epoch: 3, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5676107406616211
Epoch: 4, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5630338191986084
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.537015438079834
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5857975482940674
Epoch: 7, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5747561454772949
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.47714829444885254
Epoch: 9, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5582175254821777
Epoch: 10, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5860683917999268
Epoch: 11, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4872879981994629
Epoch: 12, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5819594860076904
Epoch: 13, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5309920310974121
Epoch: 14, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6841592788696289
Epoch: 15, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.5517885684967041
Epoch: 16, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.7066075801849365
Epoch: 17, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.6165623664855957
Epoch: 18, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.728806734085083
Epoch: 19, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.6049308776855469
Epoch: 20, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.713813066482544
Epoch: 21, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.7022914886474609
Epoch: 22, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 0.6938776969909668
Epoch: 23, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.8607034683227539
Epoch: 24, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 0.9616503715515137
Epoch: 25, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.859208345413208
Epoch: 26, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6910827159881592
Epoch: 27, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7334022521972656
Epoch: 28, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5498793125152588
Epoch: 29, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.527289867401123
Epoch: 30, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.757636308670044
Epoch: 31, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7160780429840088
Epoch: 32, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6285533905029297
Epoch: 33, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.578822135925293
Epoch: 34, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 13603
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1739675998687744
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.335 Vali Acc: 0.267 Test Loss: 1.335 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 0.49813365936279297
Epoch: 2, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.326 Vali Acc: 0.267 Test Loss: 1.326 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 3 cost time: 0.5477123260498047
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.320 Vali Acc: 0.267 Test Loss: 1.320 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 4 cost time: 0.5134048461914062
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.314 Vali Acc: 0.267 Test Loss: 1.314 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.535510778427124
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.310 Vali Acc: 0.267 Test Loss: 1.310 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.49022436141967773
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.307 Vali Acc: 0.200 Test Loss: 1.307 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.48540592193603516
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.305 Vali Acc: 0.200 Test Loss: 1.305 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.49599528312683105
Epoch: 8, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.303 Vali Acc: 0.200 Test Loss: 1.303 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4928007125854492
Epoch: 9, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.4968862533569336
Epoch: 10, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.44181370735168457
Epoch: 11, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.301 Vali Acc: 0.267 Test Loss: 1.301 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 0.4466266632080078
Epoch: 12, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.300 Vali Acc: 0.267 Test Loss: 1.300 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 0.47583484649658203
Epoch: 13, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.301 Vali Acc: 0.267 Test Loss: 1.301 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.598921537399292
Epoch: 14, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.300 Vali Acc: 0.333 Test Loss: 1.300 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 15 cost time: 0.6019272804260254
Epoch: 15, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.301 Vali Acc: 0.333 Test Loss: 1.301 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.49935412406921387
Epoch: 16, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.301 Vali Acc: 0.333 Test Loss: 1.301 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5224325656890869
Epoch: 17, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.302 Vali Acc: 0.333 Test Loss: 1.302 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5460400581359863
Epoch: 18, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5772168636322021
Epoch: 19, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.514561653137207
Epoch: 20, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5150270462036133
Epoch: 21, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6571872234344482
Epoch: 22, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6187150478363037
Epoch: 23, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.631690502166748
Epoch: 24, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 25 cost time: 0.5998687744140625
Epoch: 25, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 26 cost time: 0.6443727016448975
Epoch: 26, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 27 cost time: 0.6522603034973145
Epoch: 27, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6342594623565674
Epoch: 28, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.508042573928833
Epoch: 29, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7021772861480713
Epoch: 30, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6140475273132324
Epoch: 31, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.307 Vali Acc: 0.467 Test Loss: 1.307 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466654).  Saving model ...
Epoch: 32 cost time: 0.6404752731323242
Epoch: 32, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.306 Vali Acc: 0.467 Test Loss: 1.306 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 33 cost time: 0.5458648204803467
Epoch: 33, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.307 Vali Acc: 0.467 Test Loss: 1.307 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5916652679443359
Epoch: 34, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.307 Vali Acc: 0.467 Test Loss: 1.307 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5616312026977539
Epoch: 35, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.306 Vali Acc: 0.467 Test Loss: 1.306 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 36 cost time: 0.4940783977508545
Epoch: 36, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.305 Vali Acc: 0.467 Test Loss: 1.305 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 37 cost time: 0.5332510471343994
Epoch: 37, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.304 Vali Acc: 0.467 Test Loss: 1.304 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 38 cost time: 0.5381922721862793
Epoch: 38, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.303 Vali Acc: 0.467 Test Loss: 1.303 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 39 cost time: 0.5375058650970459
Epoch: 39, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.302 Vali Acc: 0.467 Test Loss: 1.302 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 40 cost time: 0.6172571182250977
Epoch: 40, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.301 Vali Acc: 0.467 Test Loss: 1.301 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 41 cost time: 0.5672674179077148
Epoch: 41, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.301 Vali Acc: 0.467 Test Loss: 1.301 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.709362268447876
Epoch: 42, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.301 Vali Acc: 0.467 Test Loss: 1.301 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 43 cost time: 0.7263047695159912
Epoch: 43, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.300 Vali Acc: 0.467 Test Loss: 1.300 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 44 cost time: 0.611051082611084
Epoch: 44, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.300 Vali Acc: 0.467 Test Loss: 1.300 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 45 cost time: 0.4945850372314453
Epoch: 45, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.299 Vali Acc: 0.467 Test Loss: 1.299 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 46 cost time: 0.5738739967346191
Epoch: 46, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.299 Vali Acc: 0.467 Test Loss: 1.299 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.582688570022583
Epoch: 47, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.299 Vali Acc: 0.467 Test Loss: 1.299 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 48 cost time: 0.78409743309021
Epoch: 48, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.297 Vali Acc: 0.467 Test Loss: 1.297 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 49 cost time: 0.6261558532714844
Epoch: 49, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.297 Vali Acc: 0.467 Test Loss: 1.297 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 50 cost time: 0.650935173034668
Epoch: 50, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.297 Vali Acc: 0.467 Test Loss: 1.297 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 51 cost time: 0.5880708694458008
Epoch: 51, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.296 Vali Acc: 0.467 Test Loss: 1.296 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 52 cost time: 0.6898257732391357
Epoch: 52, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5841860771179199
Epoch: 53, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6452341079711914
Epoch: 54, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5582070350646973
Epoch: 55, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.4619297981262207
Epoch: 56, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.5460913181304932
Epoch: 57, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.514045000076294
Epoch: 58, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.7047874927520752
Epoch: 59, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.4717094898223877
Epoch: 60, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.4948294162750244
Epoch: 61, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 13827
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0681841373443604
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5475966930389404
Epoch: 2, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6542346477508545
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.515617847442627
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.4880714416503906
Epoch: 5, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.46199655532836914
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.4956176280975342
Epoch: 7, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.4372422695159912
Epoch: 8, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4891629219055176
Epoch: 9, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.45538759231567383
Epoch: 10, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4854462146759033
Epoch: 11, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.45789265632629395
Epoch: 12, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.45804333686828613
Epoch: 13, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.43494439125061035
Epoch: 14, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.4189889430999756
Epoch: 15, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.5720429420471191
Epoch: 16, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.5384235382080078
Epoch: 17, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.4827561378479004
Epoch: 18, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.6508731842041016
Epoch: 19, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5195615291595459
Epoch: 20, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.566737174987793
Epoch: 21, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6243414878845215
Epoch: 22, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5476844310760498
Epoch: 23, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.46279168128967285
Epoch: 24, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5630800724029541
Epoch: 25, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5293753147125244
Epoch: 26, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5792098045349121
Epoch: 27, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.523827314376831
Epoch: 28, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 14147
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.238525867462158
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.45804834365844727
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5383749008178711
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4819004535675049
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5365407466888428
Epoch: 5, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6654980182647705
Epoch: 6, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.569699764251709
Epoch: 7, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5619368553161621
Epoch: 8, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5287370681762695
Epoch: 9, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.523259162902832
Epoch: 10, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5247247219085693
Epoch: 11, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4576125144958496
Epoch: 12, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5669739246368408
Epoch: 13, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.48467206954956055
Epoch: 14, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.5409514904022217
Epoch: 15, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.5342137813568115
Epoch: 16, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4652538299560547
Epoch: 17, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.5678014755249023
Epoch: 18, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.4884834289550781
Epoch: 19, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.4614078998565674
Epoch: 20, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.4814167022705078
Epoch: 21, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.5326297283172607
Epoch: 22, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.557201623916626
Epoch: 23, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4953885078430176
Epoch: 24, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.539095401763916
Epoch: 25, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.47854089736938477
Epoch: 26, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.47741007804870605
Epoch: 27, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4721372127532959
Epoch: 28, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6128242015838623
Epoch: 29, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4755089282989502
Epoch: 30, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4103875160217285
Epoch: 31, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.48975706100463867
Epoch: 32, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 14531
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1268787384033203
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5079240798950195
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.49769043922424316
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.43308568000793457
Epoch: 4, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.4574110507965088
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4357922077178955
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5354392528533936
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.477703332901001
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.4562089443206787
Epoch: 9, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.46863842010498047
Epoch: 10, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4807860851287842
Epoch: 11, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4554004669189453
Epoch: 12, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.43600893020629883
Epoch: 13, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4361701011657715
Epoch: 14, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5408644676208496
Epoch: 15, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.601536750793457
Epoch: 16, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.538048267364502
Epoch: 17, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5280344486236572
Epoch: 18, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.536876916885376
Epoch: 19, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6374862194061279
Epoch: 20, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5482711791992188
Epoch: 21, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5560541152954102
Epoch: 22, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5215556621551514
Epoch: 23, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5084009170532227
Epoch: 24, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5626296997070312
Epoch: 25, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5186083316802979
Epoch: 26, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 10947
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.323453187942505
Epoch: 1, Steps: 1 | Train Loss: 1.347 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7032568454742432
Epoch: 2, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5376172065734863
Epoch: 3, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5158851146697998
Epoch: 4, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.5244801044464111
Epoch: 5, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.5520327091217041
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.465376615524292
Epoch: 7, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.5831546783447266
Epoch: 8, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.4842848777770996
Epoch: 9, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.4745349884033203
Epoch: 10, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.5298278331756592
Epoch: 11, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.5738544464111328
Epoch: 12, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5413198471069336
Epoch: 13, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.5905494689941406
Epoch: 14, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.6763229370117188
Epoch: 15, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5578873157501221
Epoch: 16, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6526525020599365
Epoch: 17, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7440862655639648
Epoch: 18, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5622239112854004
Epoch: 19, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.653778076171875
Epoch: 20, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.577113151550293
Epoch: 21, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6067826747894287
Epoch: 22, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6133811473846436
Epoch: 23, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5256497859954834
Epoch: 24, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 9859
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0297725200653076
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.554154634475708
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5291078090667725
Epoch: 3, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5164608955383301
Epoch: 4, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6056437492370605
Epoch: 5, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6068727970123291
Epoch: 6, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.185 Vali Acc: 0.133 Test Loss: 1.185 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5306334495544434
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5142674446105957
Epoch: 8, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6128382682800293
Epoch: 9, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5963590145111084
Epoch: 10, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5672731399536133
Epoch: 11, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5038800239562988
Epoch: 12, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 9539
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3121910095214844
Epoch: 1, Steps: 1 | Train Loss: 1.454 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.5175566673278809
Epoch: 2, Steps: 1 | Train Loss: 1.362 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.48554396629333496
Epoch: 3, Steps: 1 | Train Loss: 1.417 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5439662933349609
Epoch: 4, Steps: 1 | Train Loss: 1.409 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4556460380554199
Epoch: 5, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.497312068939209
Epoch: 6, Steps: 1 | Train Loss: 1.400 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.5478188991546631
Epoch: 7, Steps: 1 | Train Loss: 1.432 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.5561373233795166
Epoch: 8, Steps: 1 | Train Loss: 1.396 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.517754077911377
Epoch: 9, Steps: 1 | Train Loss: 1.349 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.5592288970947266
Epoch: 10, Steps: 1 | Train Loss: 1.286 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.5955097675323486
Epoch: 11, Steps: 1 | Train Loss: 1.465 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.5112547874450684
Epoch: 12, Steps: 1 | Train Loss: 1.312 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.49782729148864746
Epoch: 13, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.584141731262207
Epoch: 14, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.4635045528411865
Epoch: 15, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.494281530380249
Epoch: 16, Steps: 1 | Train Loss: 1.356 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.5018267631530762
Epoch: 17, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.5644049644470215
Epoch: 18, Steps: 1 | Train Loss: 1.429 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 0.46698975563049316
Epoch: 19, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.5930681228637695
Epoch: 20, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 21 cost time: 0.5823934078216553
Epoch: 21, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 0.5162951946258545
Epoch: 22, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.51719069480896
Epoch: 23, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.7804355621337891
Epoch: 24, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.6507313251495361
Epoch: 25, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.6512198448181152
Epoch: 26, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 27 cost time: 0.6012060642242432
Epoch: 27, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 28 cost time: 0.7786557674407959
Epoch: 28, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 29 cost time: 0.7807018756866455
Epoch: 29, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 30 cost time: 0.5928490161895752
Epoch: 30, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 31 cost time: 0.6378185749053955
Epoch: 31, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 32 cost time: 0.6872553825378418
Epoch: 32, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 33 cost time: 0.6652913093566895
Epoch: 33, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 34 cost time: 0.6926326751708984
Epoch: 34, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7084822654724121
Epoch: 35, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6972661018371582
Epoch: 36, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6056480407714844
Epoch: 37, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6526181697845459
Epoch: 38, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6425952911376953
Epoch: 39, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5902626514434814
Epoch: 40, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8927135467529297
Epoch: 41, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.522362470626831
Epoch: 42, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5832130908966064
Epoch: 43, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 9379
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9897632598876953
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.48700809478759766
Epoch: 2, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5672929286956787
Epoch: 3, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.4928412437438965
Epoch: 4, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.561333179473877
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5334978103637695
Epoch: 6, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5135912895202637
Epoch: 7, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.46034884452819824
Epoch: 8, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.570030689239502
Epoch: 9, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5981640815734863
Epoch: 10, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5602662563323975
Epoch: 11, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4300241470336914
Epoch: 12, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.45535755157470703
Epoch: 13, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 9603
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3051888942718506
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5644998550415039
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5092892646789551
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.658576250076294
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.520282506942749
Epoch: 5, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5674493312835693
Epoch: 6, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5896251201629639
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5435090065002441
Epoch: 8, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6398367881774902
Epoch: 9, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5331230163574219
Epoch: 10, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6486203670501709
Epoch: 11, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6231298446655273
Epoch: 12, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6008622646331787
Epoch: 13, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7514209747314453
Epoch: 14, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6511592864990234
Epoch: 15, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5960471630096436
Epoch: 16, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.050 Vali Acc: 0.267 Test Loss: 1.050 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5964102745056152
Epoch: 17, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.049 Vali Acc: 0.267 Test Loss: 1.049 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el2_dm16_nh4_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9923
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4977123737335205
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6494779586791992
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6818230152130127
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5506143569946289
Epoch: 4, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6184134483337402
Epoch: 5, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6015963554382324
Epoch: 6, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6603162288665771
Epoch: 7, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5740089416503906
Epoch: 8, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6778481006622314
Epoch: 9, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6594228744506836
Epoch: 10, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6293189525604248
Epoch: 11, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.533961296081543
Epoch: 12, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5920689105987549
Epoch: 13, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5181934833526611
Epoch: 14, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5144877433776855
Epoch: 15, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5603306293487549
Epoch: 16, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.5488901138305664
Epoch: 17, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5964887142181396
Epoch: 18, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6955051422119141
Epoch: 19, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6096079349517822
Epoch: 20, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.676060676574707
Epoch: 21, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5469999313354492
Epoch: 22, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.628795862197876
Epoch: 23, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6512556076049805
Epoch: 24, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.581674337387085
Epoch: 25, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5696368217468262
Epoch: 26, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 196227
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2640488147735596
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.533618688583374
Epoch: 2, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5964159965515137
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5903315544128418
Epoch: 4, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.545332670211792
Epoch: 5, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5621702671051025
Epoch: 6, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5584523677825928
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5437216758728027
Epoch: 8, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.556912899017334
Epoch: 9, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5401279926300049
Epoch: 10, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5663340091705322
Epoch: 11, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.47876930236816406
Epoch: 12, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5613524913787842
Epoch: 13, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5408945083618164
Epoch: 14, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6765704154968262
Epoch: 15, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5688443183898926
Epoch: 16, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.45624566078186035
Epoch: 17, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.6112444400787354
Epoch: 18, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.555283784866333
Epoch: 19, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6002693176269531
Epoch: 20, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6997456550598145
Epoch: 21, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5449576377868652
Epoch: 22, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5539760589599609
Epoch: 23, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.58005690574646
Epoch: 24, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6284422874450684
Epoch: 25, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5439229011535645
Epoch: 26, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6313621997833252
Epoch: 27, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 167555
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.112673044204712
Epoch: 1, Steps: 1 | Train Loss: 1.340 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.47563648223876953
Epoch: 2, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5989177227020264
Epoch: 3, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.48170042037963867
Epoch: 4, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5735812187194824
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6801712512969971
Epoch: 6, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.533444881439209
Epoch: 7, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.5468947887420654
Epoch: 8, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.691572904586792
Epoch: 9, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5977256298065186
Epoch: 10, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.542788028717041
Epoch: 11, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5708751678466797
Epoch: 12, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5141270160675049
Epoch: 13, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5525379180908203
Epoch: 14, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5395941734313965
Epoch: 15, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.517385721206665
Epoch: 16, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5538766384124756
Epoch: 17, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 158851
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.509066581726074
Epoch: 1, Steps: 1 | Train Loss: 1.518 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5288674831390381
Epoch: 2, Steps: 1 | Train Loss: 1.490 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6431756019592285
Epoch: 3, Steps: 1 | Train Loss: 1.410 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.5356934070587158
Epoch: 4, Steps: 1 | Train Loss: 1.416 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5541801452636719
Epoch: 5, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5883116722106934
Epoch: 6, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.47185754776000977
Epoch: 7, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6343467235565186
Epoch: 8, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.4511563777923584
Epoch: 9, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5523204803466797
Epoch: 10, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5695598125457764
Epoch: 11, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7185347080230713
Epoch: 12, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6350884437561035
Epoch: 13, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5889883041381836
Epoch: 14, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6417670249938965
Epoch: 15, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5404117107391357
Epoch: 16, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.553621768951416
Epoch: 17, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5745441913604736
Epoch: 18, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 156291
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0625929832458496
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5623345375061035
Epoch: 2, Steps: 1 | Train Loss: 1.396 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.47852206230163574
Epoch: 3, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5381679534912109
Epoch: 4, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5771043300628662
Epoch: 5, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5427446365356445
Epoch: 6, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6672906875610352
Epoch: 7, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5789182186126709
Epoch: 8, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6049518585205078
Epoch: 9, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7298421859741211
Epoch: 10, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6786539554595947
Epoch: 11, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5569939613342285
Epoch: 12, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6499683856964111
Epoch: 13, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5310289859771729
Epoch: 14, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 155011
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.543290615081787
Epoch: 1, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5334694385528564
Epoch: 2, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.597891092300415
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6250395774841309
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6235125064849854
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5603330135345459
Epoch: 6, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6007392406463623
Epoch: 7, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.5514688491821289
Epoch: 8, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7858264446258545
Epoch: 9, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4930906295776367
Epoch: 10, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.44269776344299316
Epoch: 11, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5208580493927002
Epoch: 12, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4967844486236572
Epoch: 13, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.530827522277832
Epoch: 14, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4955301284790039
Epoch: 15, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5224306583404541
Epoch: 16, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.48374223709106445
Epoch: 17, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 156803
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.051809787750244
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4346656799316406
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4853227138519287
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.48190927505493164
Epoch: 4, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5585596561431885
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.523209810256958
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 7 cost time: 0.4852886199951172
Epoch: 7, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.5010623931884766
Epoch: 8, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5130598545074463
Epoch: 9, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5186429023742676
Epoch: 10, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5071682929992676
Epoch: 11, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6383442878723145
Epoch: 12, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5556871891021729
Epoch: 13, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6259753704071045
Epoch: 14, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6021161079406738
Epoch: 15, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5584752559661865
Epoch: 16, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.018 Vali Acc: 0.333 Test Loss: 1.018 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6364431381225586
Epoch: 17, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.019 Vali Acc: 0.333 Test Loss: 1.019 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 159363
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.320493221282959
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6499226093292236
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6606552600860596
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6003637313842773
Epoch: 4, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6837797164916992
Epoch: 5, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5934264659881592
Epoch: 6, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7643451690673828
Epoch: 7, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5596287250518799
Epoch: 8, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5942370891571045
Epoch: 9, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5812842845916748
Epoch: 10, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.557075023651123
Epoch: 11, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 163331
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2460789680480957
Epoch: 1, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6906867027282715
Epoch: 2, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5812139511108398
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.7238922119140625
Epoch: 4, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5553631782531738
Epoch: 5, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6213960647583008
Epoch: 6, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5549752712249756
Epoch: 7, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7324721813201904
Epoch: 8, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5864365100860596
Epoch: 9, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.5166795253753662
Epoch: 10, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5222909450531006
Epoch: 11, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.489410400390625
Epoch: 12, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5621483325958252
Epoch: 13, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4876830577850342
Epoch: 14, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6464493274688721
Epoch: 15, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6092658042907715
Epoch: 16, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5273253917694092
Epoch: 17, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6424152851104736
Epoch: 18, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 0.5505056381225586
Epoch: 19, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5514061450958252
Epoch: 20, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7723753452301025
Epoch: 21, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.228 Vali Acc: 0.467 Test Loss: 1.228 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5302867889404297
Epoch: 22, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.242 Vali Acc: 0.400 Test Loss: 1.242 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5454812049865723
Epoch: 23, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.255 Vali Acc: 0.400 Test Loss: 1.255 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4428730010986328
Epoch: 24, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.269 Vali Acc: 0.467 Test Loss: 1.269 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5887854099273682
Epoch: 25, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.282 Vali Acc: 0.467 Test Loss: 1.282 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7232234477996826
Epoch: 26, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.295 Vali Acc: 0.467 Test Loss: 1.295 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7272202968597412
Epoch: 27, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.308 Vali Acc: 0.467 Test Loss: 1.308 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8133857250213623
Epoch: 28, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 134659
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0647215843200684
Epoch: 1, Steps: 1 | Train Loss: 1.347 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5351402759552002
Epoch: 2, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.542717695236206
Epoch: 3, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5337021350860596
Epoch: 4, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5426714420318604
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6236143112182617
Epoch: 6, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5185437202453613
Epoch: 7, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6031763553619385
Epoch: 8, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4931375980377197
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5106971263885498
Epoch: 10, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.491441011428833
Epoch: 11, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5615665912628174
Epoch: 12, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.542595386505127
Epoch: 13, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5544829368591309
Epoch: 14, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5754785537719727
Epoch: 15, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5422854423522949
Epoch: 16, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.5642106533050537
Epoch: 17, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6463406085968018
Epoch: 18, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6681890487670898
Epoch: 19, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6652028560638428
Epoch: 20, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6507089138031006
Epoch: 21, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6436967849731445
Epoch: 22, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5749342441558838
Epoch: 23, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7152819633483887
Epoch: 24, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6814875602722168
Epoch: 25, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5638740062713623
Epoch: 26, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 125955
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1230595111846924
Epoch: 1, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.280 Vali Acc: 0.133 Test Loss: 1.280 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5564613342285156
Epoch: 2, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.277 Vali Acc: 0.133 Test Loss: 1.277 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.4994075298309326
Epoch: 3, Steps: 1 | Train Loss: 1.367 Vali Loss: 1.275 Vali Acc: 0.067 Test Loss: 1.275 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5408086776733398
Epoch: 4, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.273 Vali Acc: 0.067 Test Loss: 1.273 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4618837833404541
Epoch: 5, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.272 Vali Acc: 0.067 Test Loss: 1.272 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5333597660064697
Epoch: 6, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.271 Vali Acc: 0.067 Test Loss: 1.271 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5055313110351562
Epoch: 7, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.271 Vali Acc: 0.067 Test Loss: 1.271 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5479626655578613
Epoch: 8, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.271 Vali Acc: 0.133 Test Loss: 1.271 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 9 cost time: 0.5026764869689941
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.271 Vali Acc: 0.133 Test Loss: 1.271 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5359930992126465
Epoch: 10, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.271 Vali Acc: 0.133 Test Loss: 1.271 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5258655548095703
Epoch: 11, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.272 Vali Acc: 0.133 Test Loss: 1.272 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.49762558937072754
Epoch: 12, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.272 Vali Acc: 0.133 Test Loss: 1.272 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5972714424133301
Epoch: 13, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.274 Vali Acc: 0.133 Test Loss: 1.274 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5739331245422363
Epoch: 14, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.276 Vali Acc: 0.133 Test Loss: 1.276 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4961724281311035
Epoch: 15, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.278 Vali Acc: 0.133 Test Loss: 1.278 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.43349623680114746
Epoch: 16, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.280 Vali Acc: 0.133 Test Loss: 1.280 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5619828701019287
Epoch: 17, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.283 Vali Acc: 0.067 Test Loss: 1.283 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.48287487030029297
Epoch: 18, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.286 Vali Acc: 0.067 Test Loss: 1.286 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 123395
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2886407375335693
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5247437953948975
Epoch: 2, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.162 Vali Acc: 0.533 Test Loss: 1.162 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.507509708404541
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5243339538574219
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.40090203285217285
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.49252820014953613
Epoch: 6, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.556955099105835
Epoch: 7, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5470743179321289
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.45829319953918457
Epoch: 9, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4349498748779297
Epoch: 10, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.46796679496765137
Epoch: 11, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5137228965759277
Epoch: 12, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 122115
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3885855674743652
Epoch: 1, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.45821666717529297
Epoch: 2, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5761475563049316
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5320999622344971
Epoch: 4, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6124358177185059
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5254530906677246
Epoch: 6, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5211772918701172
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5676705837249756
Epoch: 8, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5438308715820312
Epoch: 9, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.6138525009155273
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5457286834716797
Epoch: 11, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.5514085292816162
Epoch: 12, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.5782332420349121
Epoch: 13, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.6235396862030029
Epoch: 14, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.5443737506866455
Epoch: 15, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.565159797668457
Epoch: 16, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.583721399307251
Epoch: 17, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5818464756011963
Epoch: 18, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5305688381195068
Epoch: 19, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5833423137664795
Epoch: 20, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5170536041259766
Epoch: 21, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.630178689956665
Epoch: 22, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5499327182769775
Epoch: 23, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5865890979766846
Epoch: 24, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 123907
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2576210498809814
Epoch: 1, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6654977798461914
Epoch: 2, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4389941692352295
Epoch: 3, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5365443229675293
Epoch: 4, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48723673820495605
Epoch: 5, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4922618865966797
Epoch: 6, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.47922754287719727
Epoch: 7, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.60379958152771
Epoch: 8, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5430476665496826
Epoch: 9, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4662635326385498
Epoch: 10, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4956943988800049
Epoch: 11, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 126467
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.981368064880371
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4188549518585205
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5616142749786377
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5593860149383545
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5040576457977295
Epoch: 5, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4918663501739502
Epoch: 6, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4795382022857666
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5356740951538086
Epoch: 8, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4794614315032959
Epoch: 9, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5415129661560059
Epoch: 10, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5615687370300293
Epoch: 11, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4933345317840576
Epoch: 12, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4691798686981201
Epoch: 13, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 146883
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3053884506225586
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.7357971668243408
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6033639907836914
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.300 Vali Acc: 0.200 Test Loss: 1.300 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5172531604766846
Epoch: 4, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.301 Vali Acc: 0.133 Test Loss: 1.301 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5400848388671875
Epoch: 5, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.302 Vali Acc: 0.133 Test Loss: 1.302 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6791563034057617
Epoch: 6, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.304 Vali Acc: 0.067 Test Loss: 1.304 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7901990413665771
Epoch: 7, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.307 Vali Acc: 0.133 Test Loss: 1.307 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5827047824859619
Epoch: 8, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.311 Vali Acc: 0.133 Test Loss: 1.311 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6062467098236084
Epoch: 9, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.315 Vali Acc: 0.133 Test Loss: 1.315 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5601303577423096
Epoch: 10, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.319 Vali Acc: 0.200 Test Loss: 1.319 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5391652584075928
Epoch: 11, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.325 Vali Acc: 0.200 Test Loss: 1.325 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 118211
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2128987312316895
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5995118618011475
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5616400241851807
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5941405296325684
Epoch: 4, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5962777137756348
Epoch: 5, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.6594057083129883
Epoch: 6, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5403642654418945
Epoch: 7, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7895503044128418
Epoch: 8, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5595512390136719
Epoch: 9, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5935368537902832
Epoch: 10, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6750409603118896
Epoch: 11, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5104453563690186
Epoch: 12, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4784657955169678
Epoch: 13, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.49207091331481934
Epoch: 14, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6845154762268066
Epoch: 15, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 109507
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.237511396408081
Epoch: 1, Steps: 1 | Train Loss: 1.312 Vali Loss: 1.387 Vali Acc: 0.133 Test Loss: 1.387 Test Acc: 0.133
Validation loss decreased (inf --> -0.133319).  Saving model ...
Epoch: 2 cost time: 0.5353531837463379
Epoch: 2, Steps: 1 | Train Loss: 1.352 Vali Loss: 1.389 Vali Acc: 0.133 Test Loss: 1.389 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5099649429321289
Epoch: 3, Steps: 1 | Train Loss: 1.447 Vali Loss: 1.390 Vali Acc: 0.133 Test Loss: 1.390 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5469393730163574
Epoch: 4, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.393 Vali Acc: 0.133 Test Loss: 1.393 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5227572917938232
Epoch: 5, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.395 Vali Acc: 0.133 Test Loss: 1.395 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5040669441223145
Epoch: 6, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.397 Vali Acc: 0.133 Test Loss: 1.397 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5489678382873535
Epoch: 7, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.399 Vali Acc: 0.133 Test Loss: 1.399 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.43990492820739746
Epoch: 8, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.402 Vali Acc: 0.133 Test Loss: 1.402 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.548799991607666
Epoch: 9, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.405 Vali Acc: 0.133 Test Loss: 1.405 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.46445202827453613
Epoch: 10, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.408 Vali Acc: 0.133 Test Loss: 1.408 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4866194725036621
Epoch: 11, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.412 Vali Acc: 0.133 Test Loss: 1.412 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 106947
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7105085849761963
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5828056335449219
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6323721408843994
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6171138286590576
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5796899795532227
Epoch: 5, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.530184268951416
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5440592765808105
Epoch: 7, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5483188629150391
Epoch: 8, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6082515716552734
Epoch: 9, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.655733585357666
Epoch: 10, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5998201370239258
Epoch: 11, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.6360163688659668
Epoch: 12, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.5714342594146729
Epoch: 13, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.5432310104370117
Epoch: 14, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.7245113849639893
Epoch: 15, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.5851686000823975
Epoch: 16, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7558016777038574
Epoch: 17, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6981136798858643
Epoch: 18, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5982980728149414
Epoch: 19, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.024 Vali Acc: 0.667 Test Loss: 1.024 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 20 cost time: 0.5114181041717529
Epoch: 20, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.025 Vali Acc: 0.667 Test Loss: 1.025 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6094276905059814
Epoch: 21, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.026 Vali Acc: 0.667 Test Loss: 1.026 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6423213481903076
Epoch: 22, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5472614765167236
Epoch: 23, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7140414714813232
Epoch: 24, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5603055953979492
Epoch: 25, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.031 Vali Acc: 0.667 Test Loss: 1.031 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.740497350692749
Epoch: 26, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5287370681762695
Epoch: 27, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6653077602386475
Epoch: 28, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.637070894241333
Epoch: 29, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 105667
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1674885749816895
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5470671653747559
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4423501491546631
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.614835262298584
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.47797131538391113
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5526924133300781
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4957287311553955
Epoch: 7, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6338839530944824
Epoch: 8, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.5811073780059814
Epoch: 9, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5152339935302734
Epoch: 10, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.5202796459197998
Epoch: 11, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.5286648273468018
Epoch: 12, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5133330821990967
Epoch: 13, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6433291435241699
Epoch: 14, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5019738674163818
Epoch: 15, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4957082271575928
Epoch: 16, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.47636985778808594
Epoch: 17, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.49274444580078125
Epoch: 18, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.401583194732666
Epoch: 19, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4508175849914551
Epoch: 20, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4123234748840332
Epoch: 21, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 107459
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.352975845336914
Epoch: 1, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4925053119659424
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.47231245040893555
Epoch: 3, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5531854629516602
Epoch: 4, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5680885314941406
Epoch: 5, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5188345909118652
Epoch: 6, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5146224498748779
Epoch: 7, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6295711994171143
Epoch: 8, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5718848705291748
Epoch: 9, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.5281322002410889
Epoch: 10, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.5052375793457031
Epoch: 11, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.5611848831176758
Epoch: 12, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.5349931716918945
Epoch: 13, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.5761511325836182
Epoch: 14, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.5500667095184326
Epoch: 15, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.5749857425689697
Epoch: 16, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.165 Vali Acc: 0.533 Test Loss: 1.165 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.6419703960418701
Epoch: 17, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.165 Vali Acc: 0.533 Test Loss: 1.165 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5456221103668213
Epoch: 18, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.166 Vali Acc: 0.533 Test Loss: 1.166 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5872235298156738
Epoch: 19, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.167 Vali Acc: 0.533 Test Loss: 1.167 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5556955337524414
Epoch: 20, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.46981048583984375
Epoch: 21, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.171 Vali Acc: 0.533 Test Loss: 1.171 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5546765327453613
Epoch: 22, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.173 Vali Acc: 0.533 Test Loss: 1.173 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4668731689453125
Epoch: 23, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.176 Vali Acc: 0.533 Test Loss: 1.176 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5520751476287842
Epoch: 24, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.179 Vali Acc: 0.533 Test Loss: 1.179 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4796147346496582
Epoch: 25, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.47928786277770996
Epoch: 26, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.187 Vali Acc: 0.533 Test Loss: 1.187 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm128_nh16_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 110019
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.245633602142334
Epoch: 1, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5730230808258057
Epoch: 2, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5465660095214844
Epoch: 3, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5638697147369385
Epoch: 4, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.8045461177825928
Epoch: 5, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5655128955841064
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.5847480297088623
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5586326122283936
Epoch: 8, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5056447982788086
Epoch: 9, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5673966407775879
Epoch: 10, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5968441963195801
Epoch: 11, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5474770069122314
Epoch: 12, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5708351135253906
Epoch: 13, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4796273708343506
Epoch: 14, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6484553813934326
Epoch: 15, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.44550538063049316
Epoch: 16, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 81859
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.200744152069092
Epoch: 1, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4691133499145508
Epoch: 2, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5608949661254883
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5150678157806396
Epoch: 4, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.560450553894043
Epoch: 5, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.45321035385131836
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6355717182159424
Epoch: 7, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6162204742431641
Epoch: 8, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6443643569946289
Epoch: 9, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5198988914489746
Epoch: 10, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5440840721130371
Epoch: 11, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6490936279296875
Epoch: 12, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5700516700744629
Epoch: 13, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 67523
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4121367931365967
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.5435843467712402
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.249 Vali Acc: 0.200 Test Loss: 1.249 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6587369441986084
Epoch: 3, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.5958216190338135
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.6124229431152344
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.525829553604126
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5352230072021484
Epoch: 7, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.5146055221557617
Epoch: 8, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.5657618045806885
Epoch: 9, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.48618650436401367
Epoch: 10, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.6582810878753662
Epoch: 11, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.589975118637085
Epoch: 12, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6559906005859375
Epoch: 13, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6190700531005859
Epoch: 14, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6126077175140381
Epoch: 15, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5403494834899902
Epoch: 16, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6007225513458252
Epoch: 17, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6509888172149658
Epoch: 18, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.531153678894043
Epoch: 19, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.48846960067749023
Epoch: 20, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 63171
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1229140758514404
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5267171859741211
Epoch: 2, Steps: 1 | Train Loss: 1.317 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.517005205154419
Epoch: 3, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5194952487945557
Epoch: 4, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4776914119720459
Epoch: 5, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.5119714736938477
Epoch: 6, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.5219824314117432
Epoch: 7, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46259069442749023
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4695124626159668
Epoch: 9, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5458388328552246
Epoch: 10, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4976065158843994
Epoch: 11, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6667630672454834
Epoch: 12, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.572831392288208
Epoch: 13, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5492644309997559
Epoch: 14, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5389328002929688
Epoch: 15, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5241546630859375
Epoch: 16, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 61891
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.188204288482666
Epoch: 1, Steps: 1 | Train Loss: 1.350 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5067272186279297
Epoch: 2, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5693576335906982
Epoch: 3, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5982253551483154
Epoch: 4, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5745539665222168
Epoch: 5, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.265 Vali Acc: 0.267 Test Loss: 1.265 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.6822326183319092
Epoch: 6, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5734477043151855
Epoch: 7, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.6626460552215576
Epoch: 8, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.6767377853393555
Epoch: 9, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.7920475006103516
Epoch: 10, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.6338596343994141
Epoch: 11, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 0.6614954471588135
Epoch: 12, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 0.6926498413085938
Epoch: 13, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.6347627639770508
Epoch: 14, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.6581547260284424
Epoch: 15, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5996503829956055
Epoch: 16, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6030704975128174
Epoch: 17, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6051967144012451
Epoch: 18, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6123745441436768
Epoch: 19, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.722327470779419
Epoch: 20, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6670620441436768
Epoch: 21, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6807188987731934
Epoch: 22, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.266 Vali Acc: 0.333 Test Loss: 1.266 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5953927040100098
Epoch: 23, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6652772426605225
Epoch: 24, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 61251
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.449486017227173
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.48024868965148926
Epoch: 2, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.47794532775878906
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.49582815170288086
Epoch: 4, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.47627735137939453
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.48290443420410156
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6354272365570068
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5030598640441895
Epoch: 8, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5291702747344971
Epoch: 9, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.515134334564209
Epoch: 10, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.4988522529602051
Epoch: 11, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.47743940353393555
Epoch: 12, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.5183067321777344
Epoch: 13, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5581381320953369
Epoch: 14, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5180797576904297
Epoch: 15, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6241722106933594
Epoch: 16, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.622565746307373
Epoch: 17, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5204970836639404
Epoch: 18, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4765751361846924
Epoch: 19, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5018281936645508
Epoch: 20, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.48172807693481445
Epoch: 21, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5558319091796875
Epoch: 22, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 62147
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0784475803375244
Epoch: 1, Steps: 1 | Train Loss: 1.352 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.45470333099365234
Epoch: 2, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.679523229598999
Epoch: 3, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6143758296966553
Epoch: 4, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5076932907104492
Epoch: 5, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5220394134521484
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5062351226806641
Epoch: 7, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.43721985816955566
Epoch: 8, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.44355034828186035
Epoch: 9, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.552088737487793
Epoch: 10, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5770032405853271
Epoch: 11, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5617711544036865
Epoch: 12, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6717495918273926
Epoch: 13, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6614382266998291
Epoch: 14, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5645501613616943
Epoch: 15, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6128630638122559
Epoch: 16, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5814032554626465
Epoch: 17, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.505852222442627
Epoch: 18, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 63427
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.332310438156128
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5788052082061768
Epoch: 2, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6410567760467529
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.643653154373169
Epoch: 4, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.562065601348877
Epoch: 5, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5374252796173096
Epoch: 6, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.558366060256958
Epoch: 7, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5961349010467529
Epoch: 8, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.47915053367614746
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6381771564483643
Epoch: 10, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5389032363891602
Epoch: 11, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 65347
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2703897953033447
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5042240619659424
Epoch: 2, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.466644287109375
Epoch: 3, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6067838668823242
Epoch: 4, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.548189640045166
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5171608924865723
Epoch: 6, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4352853298187256
Epoch: 7, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.560823917388916
Epoch: 8, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4632120132446289
Epoch: 9, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5254576206207275
Epoch: 10, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5371501445770264
Epoch: 11, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 51011
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.232670783996582
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5058648586273193
Epoch: 2, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5867519378662109
Epoch: 3, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5813965797424316
Epoch: 4, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5846738815307617
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6022686958312988
Epoch: 6, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5153465270996094
Epoch: 7, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.546947717666626
Epoch: 8, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.49518704414367676
Epoch: 9, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5030546188354492
Epoch: 10, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6297914981842041
Epoch: 11, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4514479637145996
Epoch: 12, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 46659
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2483553886413574
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.47501707077026367
Epoch: 2, Steps: 1 | Train Loss: 1.304 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.5260512828826904
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.4990546703338623
Epoch: 4, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.4501471519470215
Epoch: 5, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.5212953090667725
Epoch: 6, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6474275588989258
Epoch: 7, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5428564548492432
Epoch: 8, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5411584377288818
Epoch: 9, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5815715789794922
Epoch: 10, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5695552825927734
Epoch: 11, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.6647603511810303
Epoch: 12, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.4779174327850342
Epoch: 13, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.5041985511779785
Epoch: 14, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5360639095306396
Epoch: 15, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4684946537017822
Epoch: 16, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5551505088806152
Epoch: 17, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5489120483398438
Epoch: 18, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7047605514526367
Epoch: 19, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5942528247833252
Epoch: 20, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6558957099914551
Epoch: 21, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5705890655517578
Epoch: 22, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5537219047546387
Epoch: 23, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 45379
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.09162974357605
Epoch: 1, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5370721817016602
Epoch: 2, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4915602207183838
Epoch: 3, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5069453716278076
Epoch: 4, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5300860404968262
Epoch: 5, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4829885959625244
Epoch: 6, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5178470611572266
Epoch: 7, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4521465301513672
Epoch: 8, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5905592441558838
Epoch: 9, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4858098030090332
Epoch: 10, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.41846346855163574
Epoch: 11, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 44739
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0772056579589844
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.348 Vali Acc: 0.200 Test Loss: 1.348 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.4459047317504883
Epoch: 2, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.342 Vali Acc: 0.200 Test Loss: 1.342 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.5691561698913574
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.338 Vali Acc: 0.200 Test Loss: 1.338 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.49138808250427246
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.334 Vali Acc: 0.200 Test Loss: 1.334 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.6722927093505859
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.331 Vali Acc: 0.133 Test Loss: 1.331 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.739248514175415
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.329 Vali Acc: 0.133 Test Loss: 1.329 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5019106864929199
Epoch: 7, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.328 Vali Acc: 0.133 Test Loss: 1.328 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5650973320007324
Epoch: 8, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.326 Vali Acc: 0.133 Test Loss: 1.326 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5159761905670166
Epoch: 9, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.324 Vali Acc: 0.133 Test Loss: 1.324 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5609848499298096
Epoch: 10, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.323 Vali Acc: 0.133 Test Loss: 1.323 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5527563095092773
Epoch: 11, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.322 Vali Acc: 0.067 Test Loss: 1.322 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4811065196990967
Epoch: 12, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.322 Vali Acc: 0.067 Test Loss: 1.322 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5033204555511475
Epoch: 13, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.322 Vali Acc: 0.067 Test Loss: 1.322 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5260429382324219
Epoch: 14, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.322 Vali Acc: 0.067 Test Loss: 1.322 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 45635
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.129469871520996
Epoch: 1, Steps: 1 | Train Loss: 1.371 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.5051248073577881
Epoch: 2, Steps: 1 | Train Loss: 1.424 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.6248393058776855
Epoch: 3, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.6314210891723633
Epoch: 4, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.6220173835754395
Epoch: 5, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.5323135852813721
Epoch: 6, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.562427282333374
Epoch: 7, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 0.5270693302154541
Epoch: 8, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.5265593528747559
Epoch: 9, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.5586369037628174
Epoch: 10, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5535478591918945
Epoch: 11, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5911839008331299
Epoch: 12, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.587376594543457
Epoch: 13, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5947072505950928
Epoch: 14, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5887093544006348
Epoch: 15, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5919284820556641
Epoch: 16, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7207465171813965
Epoch: 17, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5929756164550781
Epoch: 18, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8944776058197021
Epoch: 19, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 46915
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2642643451690674
Epoch: 1, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.203 Vali Acc: 0.133 Test Loss: 1.203 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.6278543472290039
Epoch: 2, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.206 Vali Acc: 0.133 Test Loss: 1.206 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5470447540283203
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.209 Vali Acc: 0.133 Test Loss: 1.209 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.671316385269165
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5709941387176514
Epoch: 5, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8773839473724365
Epoch: 6, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6002593040466309
Epoch: 7, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6100387573242188
Epoch: 8, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 0.5170369148254395
Epoch: 9, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.244 Vali Acc: 0.467 Test Loss: 1.244 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6002252101898193
Epoch: 10, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5951933860778809
Epoch: 11, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5839791297912598
Epoch: 12, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6911866664886475
Epoch: 13, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5410153865814209
Epoch: 14, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5711081027984619
Epoch: 15, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5677025318145752
Epoch: 16, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5378632545471191
Epoch: 17, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5733716487884521
Epoch: 18, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 57091
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9941298961639404
Epoch: 1, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.369 Vali Acc: 0.333 Test Loss: 1.369 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.5130345821380615
Epoch: 2, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.5607461929321289
Epoch: 3, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.5680227279663086
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6861984729766846
Epoch: 5, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5289971828460693
Epoch: 6, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5638225078582764
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5860238075256348
Epoch: 8, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5417516231536865
Epoch: 9, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5860905647277832
Epoch: 10, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5663373470306396
Epoch: 11, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5831303596496582
Epoch: 12, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6725404262542725
Epoch: 13, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 42755
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.356626272201538
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.6236484050750732
Epoch: 2, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.271 Vali Acc: 0.200 Test Loss: 1.271 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.5594663619995117
Epoch: 3, Steps: 1 | Train Loss: 1.358 Vali Loss: 1.269 Vali Acc: 0.200 Test Loss: 1.269 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.5471463203430176
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.6226146221160889
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.265 Vali Acc: 0.200 Test Loss: 1.265 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 6 cost time: 0.6882061958312988
Epoch: 6, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 7 cost time: 0.638369083404541
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 8 cost time: 0.5878570079803467
Epoch: 8, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 9 cost time: 0.7196502685546875
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 10 cost time: 0.6219403743743896
Epoch: 10, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 11 cost time: 0.5931565761566162
Epoch: 11, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 12 cost time: 0.5286006927490234
Epoch: 12, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 13 cost time: 0.4825456142425537
Epoch: 13, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5483987331390381
Epoch: 14, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5485231876373291
Epoch: 15, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.266 Vali Acc: 0.200 Test Loss: 1.266 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.48235177993774414
Epoch: 16, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5786886215209961
Epoch: 17, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5432319641113281
Epoch: 18, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5589122772216797
Epoch: 19, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5246181488037109
Epoch: 20, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
Validation loss decreased (-0.199987 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 0.5792889595031738
Epoch: 21, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.495405912399292
Epoch: 22, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.285 Vali Acc: 0.333 Test Loss: 1.285 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5627596378326416
Epoch: 23, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5676274299621582
Epoch: 24, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6252403259277344
Epoch: 25, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6253206729888916
Epoch: 26, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6340467929840088
Epoch: 27, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.311 Vali Acc: 0.333 Test Loss: 1.311 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6685774326324463
Epoch: 28, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5789275169372559
Epoch: 29, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.323 Vali Acc: 0.333 Test Loss: 1.323 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5440537929534912
Epoch: 30, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 38403
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.097738742828369
Epoch: 1, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.008 Vali Acc: 0.400 Test Loss: 1.008 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.5027010440826416
Epoch: 2, Steps: 1 | Train Loss: 1.481 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 3 cost time: 0.4663667678833008
Epoch: 3, Steps: 1 | Train Loss: 1.246 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 0.5547869205474854
Epoch: 4, Steps: 1 | Train Loss: 1.269 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 5 cost time: 0.5509858131408691
Epoch: 5, Steps: 1 | Train Loss: 1.283 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 6 cost time: 0.5101423263549805
Epoch: 6, Steps: 1 | Train Loss: 1.167 Vali Loss: 0.966 Vali Acc: 0.533 Test Loss: 0.966 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 7 cost time: 0.5948810577392578
Epoch: 7, Steps: 1 | Train Loss: 1.181 Vali Loss: 0.962 Vali Acc: 0.533 Test Loss: 0.962 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 8 cost time: 0.6009104251861572
Epoch: 8, Steps: 1 | Train Loss: 1.237 Vali Loss: 0.958 Vali Acc: 0.533 Test Loss: 0.958 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 9 cost time: 0.4686403274536133
Epoch: 9, Steps: 1 | Train Loss: 1.272 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 10 cost time: 0.641857385635376
Epoch: 10, Steps: 1 | Train Loss: 1.080 Vali Loss: 0.952 Vali Acc: 0.533 Test Loss: 0.952 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 11 cost time: 0.4654960632324219
Epoch: 11, Steps: 1 | Train Loss: 1.197 Vali Loss: 0.950 Vali Acc: 0.533 Test Loss: 0.950 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 12 cost time: 0.5213449001312256
Epoch: 12, Steps: 1 | Train Loss: 1.227 Vali Loss: 0.949 Vali Acc: 0.600 Test Loss: 0.949 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599991).  Saving model ...
Epoch: 13 cost time: 0.5349185466766357
Epoch: 13, Steps: 1 | Train Loss: 1.034 Vali Loss: 0.948 Vali Acc: 0.600 Test Loss: 0.948 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 14 cost time: 0.5332129001617432
Epoch: 14, Steps: 1 | Train Loss: 1.064 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 15 cost time: 0.5924863815307617
Epoch: 15, Steps: 1 | Train Loss: 1.127 Vali Loss: 0.947 Vali Acc: 0.533 Test Loss: 0.947 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5662529468536377
Epoch: 16, Steps: 1 | Train Loss: 0.965 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 17 cost time: 0.5342893600463867
Epoch: 17, Steps: 1 | Train Loss: 0.894 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6205024719238281
Epoch: 18, Steps: 1 | Train Loss: 0.875 Vali Loss: 0.948 Vali Acc: 0.600 Test Loss: 0.948 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6577141284942627
Epoch: 19, Steps: 1 | Train Loss: 0.731 Vali Loss: 0.949 Vali Acc: 0.600 Test Loss: 0.949 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4950690269470215
Epoch: 20, Steps: 1 | Train Loss: 0.867 Vali Loss: 0.950 Vali Acc: 0.600 Test Loss: 0.950 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5143332481384277
Epoch: 21, Steps: 1 | Train Loss: 0.814 Vali Loss: 0.951 Vali Acc: 0.600 Test Loss: 0.951 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5583229064941406
Epoch: 22, Steps: 1 | Train Loss: 0.662 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5370490550994873
Epoch: 23, Steps: 1 | Train Loss: 0.743 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.49310994148254395
Epoch: 24, Steps: 1 | Train Loss: 0.750 Vali Loss: 0.958 Vali Acc: 0.600 Test Loss: 0.958 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.562852144241333
Epoch: 25, Steps: 1 | Train Loss: 0.660 Vali Loss: 0.961 Vali Acc: 0.600 Test Loss: 0.961 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8267674446105957
Epoch: 26, Steps: 1 | Train Loss: 0.685 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 37123
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2525670528411865
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5515942573547363
Epoch: 2, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5132842063903809
Epoch: 3, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7638058662414551
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.510594367980957
Epoch: 5, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5457689762115479
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5361497402191162
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5811049938201904
Epoch: 8, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.7317700386047363
Epoch: 9, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.5179383754730225
Epoch: 10, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.5702526569366455
Epoch: 11, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.45284414291381836
Epoch: 12, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.5312583446502686
Epoch: 13, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.59521484375
Epoch: 14, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.5244638919830322
Epoch: 15, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 0.5265772342681885
Epoch: 16, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 0.5174276828765869
Epoch: 17, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 18 cost time: 0.504716157913208
Epoch: 18, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.5595104694366455
Epoch: 19, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 20 cost time: 0.5621366500854492
Epoch: 20, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.504127025604248
Epoch: 21, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5037620067596436
Epoch: 22, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5762844085693359
Epoch: 23, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.47038865089416504
Epoch: 24, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6100490093231201
Epoch: 25, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6419286727905273
Epoch: 26, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5433127880096436
Epoch: 27, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5661513805389404
Epoch: 28, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5965042114257812
Epoch: 29, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6246528625488281
Epoch: 30, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 36483
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.349973201751709
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4761006832122803
Epoch: 2, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5235400199890137
Epoch: 3, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5183990001678467
Epoch: 4, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5716152191162109
Epoch: 5, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5650243759155273
Epoch: 6, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5355665683746338
Epoch: 7, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5745224952697754
Epoch: 8, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6856818199157715
Epoch: 9, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5947275161743164
Epoch: 10, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5645148754119873
Epoch: 11, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 37379
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0619921684265137
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.4564657211303711
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.4474203586578369
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.41977858543395996
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.5091843605041504
Epoch: 5, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.541905403137207
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.4038829803466797
Epoch: 7, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.49668002128601074
Epoch: 8, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.45645999908447266
Epoch: 9, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.3961191177368164
Epoch: 10, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.47372937202453613
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4232478141784668
Epoch: 12, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5793817043304443
Epoch: 13, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4803948402404785
Epoch: 14, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5292551517486572
Epoch: 15, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5398726463317871
Epoch: 16, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4747765064239502
Epoch: 17, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.567359209060669
Epoch: 18, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4837608337402344
Epoch: 19, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm64_nh16_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 38659
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.329728364944458
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.555433988571167
Epoch: 2, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.5706477165222168
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5345888137817383
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5408389568328857
Epoch: 5, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5780274868011475
Epoch: 6, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5471937656402588
Epoch: 7, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5780942440032959
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5047638416290283
Epoch: 9, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5037741661071777
Epoch: 10, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6477999687194824
Epoch: 11, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5974438190460205
Epoch: 12, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 36963
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3454630374908447
Epoch: 1, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5328571796417236
Epoch: 2, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.5093612670898438
Epoch: 3, Steps: 1 | Train Loss: 1.445 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5685031414031982
Epoch: 4, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5538032054901123
Epoch: 5, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5482921600341797
Epoch: 6, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5314805507659912
Epoch: 7, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5263998508453369
Epoch: 8, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5808472633361816
Epoch: 9, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5766196250915527
Epoch: 10, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.47602391242980957
Epoch: 11, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5056431293487549
Epoch: 12, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4439382553100586
Epoch: 13, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4562554359436035
Epoch: 14, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7292745113372803
Epoch: 15, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5127897262573242
Epoch: 16, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5200419425964355
Epoch: 17, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4630274772644043
Epoch: 18, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.556955099105835
Epoch: 19, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.44864916801452637
Epoch: 20, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.505373477935791
Epoch: 21, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5075149536132812
Epoch: 22, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4957895278930664
Epoch: 23, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5758233070373535
Epoch: 24, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.52730393409729
Epoch: 25, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 29795
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.473666191101074
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5492496490478516
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6216778755187988
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5281951427459717
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6470186710357666
Epoch: 5, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5026743412017822
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5272223949432373
Epoch: 7, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5706555843353271
Epoch: 8, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6423327922821045
Epoch: 9, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6154444217681885
Epoch: 10, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.6634693145751953
Epoch: 11, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5367236137390137
Epoch: 12, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6658518314361572
Epoch: 13, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.5296497344970703
Epoch: 14, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.679802656173706
Epoch: 15, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5674045085906982
Epoch: 16, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5454549789428711
Epoch: 17, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.5875437259674072
Epoch: 18, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5485489368438721
Epoch: 19, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5895130634307861
Epoch: 20, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6320459842681885
Epoch: 21, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.653111457824707
Epoch: 22, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6276209354400635
Epoch: 23, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5722019672393799
Epoch: 24, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5844173431396484
Epoch: 25, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.658149242401123
Epoch: 26, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.544975757598877
Epoch: 27, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 27619
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1430294513702393
Epoch: 1, Steps: 1 | Train Loss: 1.371 Vali Loss: 1.365 Vali Acc: 0.267 Test Loss: 1.365 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 0.4862337112426758
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.348 Vali Acc: 0.267 Test Loss: 1.348 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 3 cost time: 0.46190476417541504
Epoch: 3, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.333 Vali Acc: 0.200 Test Loss: 1.333 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6281261444091797
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.320 Vali Acc: 0.267 Test Loss: 1.320 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 5 cost time: 0.5335297584533691
Epoch: 5, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.308 Vali Acc: 0.267 Test Loss: 1.308 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.4176011085510254
Epoch: 6, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.300 Vali Acc: 0.267 Test Loss: 1.300 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5449047088623047
Epoch: 7, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.4452321529388428
Epoch: 8, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.5099277496337891
Epoch: 9, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.506049394607544
Epoch: 10, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.49031496047973633
Epoch: 11, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.6460275650024414
Epoch: 12, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.5272142887115479
Epoch: 13, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.5208885669708252
Epoch: 14, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.5525763034820557
Epoch: 15, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.49832773208618164
Epoch: 16, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5227916240692139
Epoch: 17, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5110559463500977
Epoch: 18, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7268147468566895
Epoch: 19, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5330567359924316
Epoch: 20, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.653174877166748
Epoch: 21, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.266 Vali Acc: 0.333 Test Loss: 1.266 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 0.5724060535430908
Epoch: 22, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.266 Vali Acc: 0.333 Test Loss: 1.266 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6622323989868164
Epoch: 23, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6733253002166748
Epoch: 24, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4975161552429199
Epoch: 25, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5059192180633545
Epoch: 26, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5659613609313965
Epoch: 27, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6460447311401367
Epoch: 28, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5134766101837158
Epoch: 29, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.49497079849243164
Epoch: 30, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.49898195266723633
Epoch: 31, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 26979
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3634097576141357
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5936236381530762
Epoch: 2, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5718300342559814
Epoch: 3, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5623610019683838
Epoch: 4, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5364444255828857
Epoch: 5, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4915626049041748
Epoch: 6, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5300943851470947
Epoch: 7, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5181291103363037
Epoch: 8, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5012686252593994
Epoch: 9, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5198466777801514
Epoch: 10, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5116808414459229
Epoch: 11, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 26659
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5452709197998047
Epoch: 1, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.281 Vali Acc: 0.200 Test Loss: 1.281 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.6091818809509277
Epoch: 2, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.278 Vali Acc: 0.200 Test Loss: 1.278 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.6083691120147705
Epoch: 3, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.276 Vali Acc: 0.200 Test Loss: 1.276 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.6027421951293945
Epoch: 4, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.5511250495910645
Epoch: 5, Steps: 1 | Train Loss: 1.340 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 6 cost time: 0.5395183563232422
Epoch: 6, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.271 Vali Acc: 0.200 Test Loss: 1.271 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 7 cost time: 0.5158517360687256
Epoch: 7, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 8 cost time: 0.6372168064117432
Epoch: 8, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.269 Vali Acc: 0.200 Test Loss: 1.269 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 9 cost time: 0.5086078643798828
Epoch: 9, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.269 Vali Acc: 0.133 Test Loss: 1.269 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5845630168914795
Epoch: 10, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6259670257568359
Epoch: 11, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.47662878036499023
Epoch: 12, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5449841022491455
Epoch: 13, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5206098556518555
Epoch: 14, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6544473171234131
Epoch: 15, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.609330415725708
Epoch: 16, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5423555374145508
Epoch: 17, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.635312557220459
Epoch: 18, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 27107
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3961946964263916
Epoch: 1, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5850391387939453
Epoch: 2, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5658318996429443
Epoch: 3, Steps: 1 | Train Loss: 1.347 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6224806308746338
Epoch: 4, Steps: 1 | Train Loss: 1.350 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.48693156242370605
Epoch: 5, Steps: 1 | Train Loss: 1.343 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5619711875915527
Epoch: 6, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5557878017425537
Epoch: 7, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6135144233703613
Epoch: 8, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5684971809387207
Epoch: 9, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5368959903717041
Epoch: 10, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5618340969085693
Epoch: 11, Steps: 1 | Train Loss: 1.328 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5331356525421143
Epoch: 12, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5496687889099121
Epoch: 13, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6295762062072754
Epoch: 14, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.605095386505127
Epoch: 15, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5505759716033936
Epoch: 16, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5293521881103516
Epoch: 17, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 27747
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0759596824645996
Epoch: 1, Steps: 1 | Train Loss: 1.502 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.47237420082092285
Epoch: 2, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5760791301727295
Epoch: 3, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5301496982574463
Epoch: 4, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4125401973724365
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4631626605987549
Epoch: 6, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6147065162658691
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5260241031646729
Epoch: 8, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.49997496604919434
Epoch: 9, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5069975852966309
Epoch: 10, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6657462120056152
Epoch: 11, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4687652587890625
Epoch: 12, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 28643
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2341058254241943
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5936834812164307
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6050097942352295
Epoch: 3, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.690025806427002
Epoch: 4, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.48737502098083496
Epoch: 5, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5932168960571289
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5488128662109375
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.502824068069458
Epoch: 8, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.5606918334960938
Epoch: 9, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4957890510559082
Epoch: 10, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.46834254264831543
Epoch: 11, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.6288135051727295
Epoch: 12, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.5360908508300781
Epoch: 13, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.48450469970703125
Epoch: 14, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.580277681350708
Epoch: 15, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.5493817329406738
Epoch: 16, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.6619589328765869
Epoch: 17, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.43111324310302734
Epoch: 18, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.5543391704559326
Epoch: 19, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.5316073894500732
Epoch: 20, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.48454976081848145
Epoch: 21, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.5282073020935059
Epoch: 22, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6013467311859131
Epoch: 23, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4816610813140869
Epoch: 24, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6591055393218994
Epoch: 25, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6158607006072998
Epoch: 26, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6136527061462402
Epoch: 27, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6456661224365234
Epoch: 28, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6356909275054932
Epoch: 29, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.496018648147583
Epoch: 30, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5765540599822998
Epoch: 31, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 21475
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1779167652130127
Epoch: 1, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5859758853912354
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5378422737121582
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.499248743057251
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5787594318389893
Epoch: 5, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.6062033176422119
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.508289098739624
Epoch: 7, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.6329586505889893
Epoch: 8, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5305037498474121
Epoch: 9, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4478020668029785
Epoch: 10, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5564196109771729
Epoch: 11, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5323655605316162
Epoch: 12, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5484983921051025
Epoch: 13, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5804691314697266
Epoch: 14, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.529376745223999
Epoch: 15, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.6687202453613281
Epoch: 16, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5218603610992432
Epoch: 17, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5062851905822754
Epoch: 18, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6164369583129883
Epoch: 19, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.522711992263794
Epoch: 20, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6201729774475098
Epoch: 21, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6115007400512695
Epoch: 22, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5786399841308594
Epoch: 23, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5241580009460449
Epoch: 24, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5683925151824951
Epoch: 25, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 19299
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.32879376411438
Epoch: 1, Steps: 1 | Train Loss: 1.519 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6235091686248779
Epoch: 2, Steps: 1 | Train Loss: 1.445 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.549187183380127
Epoch: 3, Steps: 1 | Train Loss: 1.433 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.762359619140625
Epoch: 4, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5499107837677002
Epoch: 5, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6365435123443604
Epoch: 6, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6002178192138672
Epoch: 7, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5380434989929199
Epoch: 8, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5182850360870361
Epoch: 9, Steps: 1 | Train Loss: 1.311 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5491979122161865
Epoch: 10, Steps: 1 | Train Loss: 1.375 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.520214319229126
Epoch: 11, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 18659
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.139545202255249
Epoch: 1, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5636537075042725
Epoch: 2, Steps: 1 | Train Loss: 1.357 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5338058471679688
Epoch: 3, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6006178855895996
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.46013450622558594
Epoch: 5, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5848245620727539
Epoch: 6, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4820578098297119
Epoch: 7, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5285170078277588
Epoch: 8, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5470914840698242
Epoch: 9, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4712393283843994
Epoch: 10, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5031077861785889
Epoch: 11, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6211509704589844
Epoch: 12, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5451333522796631
Epoch: 13, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.49310731887817383
Epoch: 14, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.47740793228149414
Epoch: 15, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5435652732849121
Epoch: 16, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5087573528289795
Epoch: 17, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4458425045013428
Epoch: 18, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 18339
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.37701678276062
Epoch: 1, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.46575093269348145
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5449955463409424
Epoch: 3, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.4942612648010254
Epoch: 4, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5704061985015869
Epoch: 5, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.535407543182373
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.6390016078948975
Epoch: 7, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.49687933921813965
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.631080150604248
Epoch: 9, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.5820820331573486
Epoch: 10, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.6543989181518555
Epoch: 11, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.48784399032592773
Epoch: 12, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.5538103580474854
Epoch: 13, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.5198359489440918
Epoch: 14, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.5035269260406494
Epoch: 15, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.7398145198822021
Epoch: 16, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.5497362613677979
Epoch: 17, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.5251562595367432
Epoch: 18, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.6797161102294922
Epoch: 19, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.5944938659667969
Epoch: 20, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.5294606685638428
Epoch: 21, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 0.5085985660552979
Epoch: 22, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 0.6262719631195068
Epoch: 23, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 0.6574423313140869
Epoch: 24, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.198 Vali Acc: 0.467 Test Loss: 1.198 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 0.536505937576294
Epoch: 25, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 0.6262481212615967
Epoch: 26, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 0.4556257724761963
Epoch: 27, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 0.5253863334655762
Epoch: 28, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 29 cost time: 0.5310568809509277
Epoch: 29, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 0.5623600482940674
Epoch: 30, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.196 Vali Acc: 0.533 Test Loss: 1.196 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 31 cost time: 0.4832487106323242
Epoch: 31, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.195 Vali Acc: 0.533 Test Loss: 1.195 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 32 cost time: 0.5284457206726074
Epoch: 32, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.195 Vali Acc: 0.533 Test Loss: 1.195 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 33 cost time: 0.4674556255340576
Epoch: 33, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.194 Vali Acc: 0.533 Test Loss: 1.194 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 34 cost time: 0.4805896282196045
Epoch: 34, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.194 Vali Acc: 0.533 Test Loss: 1.194 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 35 cost time: 0.4738733768463135
Epoch: 35, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.194 Vali Acc: 0.533 Test Loss: 1.194 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.59377121925354
Epoch: 36, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.194 Vali Acc: 0.533 Test Loss: 1.194 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 37 cost time: 0.4979517459869385
Epoch: 37, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.194 Vali Acc: 0.600 Test Loss: 1.194 Test Acc: 0.600
Validation loss decreased (-0.533321 --> -0.599988).  Saving model ...
Epoch: 38 cost time: 0.5979127883911133
Epoch: 38, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5186986923217773
Epoch: 39, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5469794273376465
Epoch: 40, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.196 Vali Acc: 0.600 Test Loss: 1.196 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6133453845977783
Epoch: 41, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.197 Vali Acc: 0.600 Test Loss: 1.197 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5142533779144287
Epoch: 42, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6478948593139648
Epoch: 43, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4557929039001465
Epoch: 44, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.199 Vali Acc: 0.600 Test Loss: 1.199 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.47000741958618164
Epoch: 45, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5860128402709961
Epoch: 46, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.201 Vali Acc: 0.533 Test Loss: 1.201 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.45969152450561523
Epoch: 47, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.202 Vali Acc: 0.533 Test Loss: 1.202 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 18787
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3162224292755127
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.140 Vali Acc: 0.533 Test Loss: 1.140 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.6475982666015625
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.137 Vali Acc: 0.533 Test Loss: 1.137 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.573157548904419
Epoch: 3, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5432777404785156
Epoch: 4, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6278951168060303
Epoch: 5, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6397523880004883
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7135014533996582
Epoch: 7, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5286405086517334
Epoch: 8, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6143038272857666
Epoch: 9, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6251933574676514
Epoch: 10, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5551714897155762
Epoch: 11, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5068750381469727
Epoch: 12, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 19427
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3994040489196777
Epoch: 1, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5743837356567383
Epoch: 2, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6404411792755127
Epoch: 3, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5687594413757324
Epoch: 4, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5583133697509766
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.49204206466674805
Epoch: 6, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5801913738250732
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5233566761016846
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6757948398590088
Epoch: 9, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4655435085296631
Epoch: 10, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.6235239505767822
Epoch: 11, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5745480060577393
Epoch: 12, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.4691295623779297
Epoch: 13, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.4616861343383789
Epoch: 14, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.49643874168395996
Epoch: 15, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5334227085113525
Epoch: 16, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.48370909690856934
Epoch: 17, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5193593502044678
Epoch: 18, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4583704471588135
Epoch: 19, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5074455738067627
Epoch: 20, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6453719139099121
Epoch: 21, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.48046231269836426
Epoch: 22, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5696134567260742
Epoch: 23, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5116574764251709
Epoch: 24, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 24483
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0432870388031006
Epoch: 1, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7697639465332031
Epoch: 2, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5049638748168945
Epoch: 3, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.4991762638092041
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5451889038085938
Epoch: 5, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5470619201660156
Epoch: 6, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5303685665130615
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6595673561096191
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.241 Vali Acc: 0.267 Test Loss: 1.241 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6625018119812012
Epoch: 9, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.537869930267334
Epoch: 10, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.5975511074066162
Epoch: 11, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.6138675212860107
Epoch: 12, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.6426784992218018
Epoch: 13, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6189072132110596
Epoch: 14, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6629974842071533
Epoch: 15, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6039142608642578
Epoch: 16, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6852478981018066
Epoch: 17, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6449620723724365
Epoch: 18, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7375421524047852
Epoch: 19, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7076187133789062
Epoch: 20, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6442151069641113
Epoch: 21, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7019152641296387
Epoch: 22, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 17315
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5696465969085693
Epoch: 1, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5388801097869873
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6136817932128906
Epoch: 3, Steps: 1 | Train Loss: 1.358 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6124904155731201
Epoch: 4, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5540578365325928
Epoch: 5, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5366082191467285
Epoch: 6, Steps: 1 | Train Loss: 1.362 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5994324684143066
Epoch: 7, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5324478149414062
Epoch: 8, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5171337127685547
Epoch: 9, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5862350463867188
Epoch: 10, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.47725653648376465
Epoch: 11, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7932701110839844
Epoch: 12, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.48195648193359375
Epoch: 13, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5170502662658691
Epoch: 14, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.5872046947479248
Epoch: 15, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5102858543395996
Epoch: 16, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6294839382171631
Epoch: 17, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5374395847320557
Epoch: 18, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5875875949859619
Epoch: 19, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6427080631256104
Epoch: 20, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.42778921127319336
Epoch: 21, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5455343723297119
Epoch: 22, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4992485046386719
Epoch: 23, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6417253017425537
Epoch: 24, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 15139
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.177035093307495
Epoch: 1, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.326 Vali Acc: 0.200 Test Loss: 1.326 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.5088150501251221
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.331 Vali Acc: 0.200 Test Loss: 1.331 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.558708667755127
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.336 Vali Acc: 0.200 Test Loss: 1.336 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5237579345703125
Epoch: 4, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.340 Vali Acc: 0.200 Test Loss: 1.340 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6175155639648438
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.345 Vali Acc: 0.200 Test Loss: 1.345 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5851559638977051
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.349 Vali Acc: 0.200 Test Loss: 1.349 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.48896265029907227
Epoch: 7, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.353 Vali Acc: 0.200 Test Loss: 1.353 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5823662281036377
Epoch: 8, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.357 Vali Acc: 0.200 Test Loss: 1.357 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.641047477722168
Epoch: 9, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.361 Vali Acc: 0.200 Test Loss: 1.361 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5454678535461426
Epoch: 10, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.365 Vali Acc: 0.200 Test Loss: 1.365 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6420421600341797
Epoch: 11, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.368 Vali Acc: 0.200 Test Loss: 1.368 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 14499
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.272548198699951
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5516905784606934
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5585024356842041
Epoch: 3, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5151920318603516
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5173816680908203
Epoch: 5, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5439701080322266
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.49530720710754395
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5265648365020752
Epoch: 8, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5366983413696289
Epoch: 9, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.5284490585327148
Epoch: 10, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.5746090412139893
Epoch: 11, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.5184366703033447
Epoch: 12, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.4914863109588623
Epoch: 13, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.4604918956756592
Epoch: 14, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.6725754737854004
Epoch: 15, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 0.5160555839538574
Epoch: 16, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 0.5347151756286621
Epoch: 17, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 18 cost time: 0.6184921264648438
Epoch: 18, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.529456377029419
Epoch: 19, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.593524694442749
Epoch: 20, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5612297058105469
Epoch: 21, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.49891114234924316
Epoch: 22, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5648486614227295
Epoch: 23, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5419180393218994
Epoch: 24, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5781643390655518
Epoch: 25, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.606248140335083
Epoch: 26, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6690800189971924
Epoch: 27, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5514183044433594
Epoch: 28, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 29 cost time: 0.5584456920623779
Epoch: 29, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 30 cost time: 0.7140140533447266
Epoch: 30, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 31 cost time: 0.5949976444244385
Epoch: 31, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 32 cost time: 0.6015698909759521
Epoch: 32, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 33 cost time: 0.49581480026245117
Epoch: 33, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 34 cost time: 0.675755500793457
Epoch: 34, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 35 cost time: 0.7218813896179199
Epoch: 35, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.673607587814331
Epoch: 36, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7526111602783203
Epoch: 37, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6113302707672119
Epoch: 38, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.720283031463623
Epoch: 39, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.701533317565918
Epoch: 40, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6596980094909668
Epoch: 41, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6790499687194824
Epoch: 42, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5840251445770264
Epoch: 43, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6150174140930176
Epoch: 44, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 14179
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.091219663619995
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.261 Vali Acc: 0.000 Test Loss: 1.261 Test Acc: 0.000
Validation loss decreased (inf --> 0.000013).  Saving model ...
Epoch: 2 cost time: 0.4119739532470703
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.263 Vali Acc: 0.067 Test Loss: 1.263 Test Acc: 0.067
Validation loss decreased (0.000013 --> -0.066654).  Saving model ...
Epoch: 3 cost time: 0.45305442810058594
Epoch: 3, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.265 Vali Acc: 0.067 Test Loss: 1.265 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.48072052001953125
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.266 Vali Acc: 0.067 Test Loss: 1.266 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5511250495910645
Epoch: 5, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.268 Vali Acc: 0.067 Test Loss: 1.268 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4837489128112793
Epoch: 6, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.268 Vali Acc: 0.067 Test Loss: 1.268 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5422725677490234
Epoch: 7, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.270 Vali Acc: 0.067 Test Loss: 1.270 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5068855285644531
Epoch: 8, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.271 Vali Acc: 0.067 Test Loss: 1.271 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4877629280090332
Epoch: 9, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.272 Vali Acc: 0.067 Test Loss: 1.272 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5180850028991699
Epoch: 10, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.273 Vali Acc: 0.067 Test Loss: 1.273 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.42314910888671875
Epoch: 11, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.274 Vali Acc: 0.067 Test Loss: 1.274 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4817507266998291
Epoch: 12, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.275 Vali Acc: 0.067 Test Loss: 1.275 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.06666666666666667
model parameter : 14627
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9533014297485352
Epoch: 1, Steps: 1 | Train Loss: 1.342 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.45658159255981445
Epoch: 2, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5291736125946045
Epoch: 3, Steps: 1 | Train Loss: 1.438 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.48595714569091797
Epoch: 4, Steps: 1 | Train Loss: 1.349 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.47997236251831055
Epoch: 5, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.5535929203033447
Epoch: 6, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4801959991455078
Epoch: 7, Steps: 1 | Train Loss: 1.367 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5049660205841064
Epoch: 8, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.4772322177886963
Epoch: 9, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.4840693473815918
Epoch: 10, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.5634541511535645
Epoch: 11, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.520270586013794
Epoch: 12, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.574622392654419
Epoch: 13, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.45443177223205566
Epoch: 14, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.4861106872558594
Epoch: 15, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.584059476852417
Epoch: 16, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.5334975719451904
Epoch: 17, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.5132341384887695
Epoch: 18, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.5093121528625488
Epoch: 19, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.501213788986206
Epoch: 20, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.560314416885376
Epoch: 21, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.5786604881286621
Epoch: 22, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 0.5198233127593994
Epoch: 23, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 0.6954870223999023
Epoch: 24, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.4710206985473633
Epoch: 25, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 0.5314853191375732
Epoch: 26, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 27 cost time: 0.4649083614349365
Epoch: 27, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 28 cost time: 0.5052773952484131
Epoch: 28, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 29 cost time: 0.500004768371582
Epoch: 29, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 30 cost time: 0.5078256130218506
Epoch: 30, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 31 cost time: 0.6044778823852539
Epoch: 31, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 32 cost time: 0.5327029228210449
Epoch: 32, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 33 cost time: 0.5439057350158691
Epoch: 33, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.550957202911377
Epoch: 34, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5470666885375977
Epoch: 35, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.49027204513549805
Epoch: 36, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5887174606323242
Epoch: 37, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4534728527069092
Epoch: 38, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5629627704620361
Epoch: 39, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5214736461639404
Epoch: 40, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5098540782928467
Epoch: 41, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5926158428192139
Epoch: 42, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm32_nh4_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 15267
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0799553394317627
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5251595973968506
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46937084197998047
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4696164131164551
Epoch: 4, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4534308910369873
Epoch: 5, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.41069531440734863
Epoch: 6, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.242 Vali Acc: 0.200 Test Loss: 1.242 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5565469264984131
Epoch: 7, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.241 Vali Acc: 0.200 Test Loss: 1.241 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5636098384857178
Epoch: 8, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.240 Vali Acc: 0.200 Test Loss: 1.240 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5795173645019531
Epoch: 9, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.240 Vali Acc: 0.133 Test Loss: 1.240 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5509228706359863
Epoch: 10, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.241 Vali Acc: 0.133 Test Loss: 1.241 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5817747116088867
Epoch: 11, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.241 Vali Acc: 0.133 Test Loss: 1.241 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 17587
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.132150650024414
Epoch: 1, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.295 Vali Acc: 0.333 Test Loss: 1.295 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.46665143966674805
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5910606384277344
Epoch: 3, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5086817741394043
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6731014251708984
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.5223329067230225
Epoch: 6, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5180213451385498
Epoch: 7, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5184154510498047
Epoch: 8, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.6295464038848877
Epoch: 9, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.6137924194335938
Epoch: 10, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.5219416618347168
Epoch: 11, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.5648400783538818
Epoch: 12, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.5938408374786377
Epoch: 13, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.526238203048706
Epoch: 14, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.5627076625823975
Epoch: 15, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.5471451282501221
Epoch: 16, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.6802713871002197
Epoch: 17, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.48426127433776855
Epoch: 18, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.7598171234130859
Epoch: 19, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.6222689151763916
Epoch: 20, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.636183500289917
Epoch: 21, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 0.6129424571990967
Epoch: 22, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 0.676699161529541
Epoch: 23, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.5962662696838379
Epoch: 24, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.6224706172943115
Epoch: 25, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.6005871295928955
Epoch: 26, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.5979804992675781
Epoch: 27, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.5599374771118164
Epoch: 28, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.5773136615753174
Epoch: 29, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.5284397602081299
Epoch: 30, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.530083417892456
Epoch: 31, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 0.4818413257598877
Epoch: 32, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 0.6344912052154541
Epoch: 33, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 0.5713222026824951
Epoch: 34, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 0.48119354248046875
Epoch: 35, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 0.48529648780822754
Epoch: 36, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 0.6362314224243164
Epoch: 37, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 38 cost time: 0.532235860824585
Epoch: 38, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 39 cost time: 0.48208069801330566
Epoch: 39, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 40 cost time: 0.45489001274108887
Epoch: 40, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 41 cost time: 0.4989817142486572
Epoch: 41, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 42 cost time: 0.5172865390777588
Epoch: 42, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 43 cost time: 0.4455687999725342
Epoch: 43, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 44 cost time: 0.5526177883148193
Epoch: 44, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 45 cost time: 0.441448450088501
Epoch: 45, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 46 cost time: 0.5186045169830322
Epoch: 46, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 47 cost time: 0.42965221405029297
Epoch: 47, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 48 cost time: 0.5913901329040527
Epoch: 48, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 49 cost time: 0.49849462509155273
Epoch: 49, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.48430395126342773
Epoch: 50, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5831348896026611
Epoch: 51, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.5082526206970215
Epoch: 52, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5187256336212158
Epoch: 53, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.5454232692718506
Epoch: 54, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.616976261138916
Epoch: 55, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6053762435913086
Epoch: 56, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.4781363010406494
Epoch: 57, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.5367047786712646
Epoch: 58, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14003
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5097625255584717
Epoch: 1, Steps: 1 | Train Loss: 1.321 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.736393928527832
Epoch: 2, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5269134044647217
Epoch: 3, Steps: 1 | Train Loss: 1.385 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6473276615142822
Epoch: 4, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5271787643432617
Epoch: 5, Steps: 1 | Train Loss: 1.349 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.46889472007751465
Epoch: 6, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.537787914276123
Epoch: 7, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5199322700500488
Epoch: 8, Steps: 1 | Train Loss: 1.372 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.574176549911499
Epoch: 9, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5477113723754883
Epoch: 10, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5492560863494873
Epoch: 11, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5171253681182861
Epoch: 12, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6036453247070312
Epoch: 13, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5688354969024658
Epoch: 14, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4622788429260254
Epoch: 15, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.570441484451294
Epoch: 16, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.574152946472168
Epoch: 17, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4689507484436035
Epoch: 18, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5389080047607422
Epoch: 19, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6191651821136475
Epoch: 20, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 12915
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.213332176208496
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5413315296173096
Epoch: 2, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.48949384689331055
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5274097919464111
Epoch: 4, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.4503605365753174
Epoch: 5, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.5460813045501709
Epoch: 6, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5378317832946777
Epoch: 7, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.7288522720336914
Epoch: 8, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.45025014877319336
Epoch: 9, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.5150530338287354
Epoch: 10, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.5288283824920654
Epoch: 11, Steps: 1 | Train Loss: 1.311 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 0.5407578945159912
Epoch: 12, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 0.5177469253540039
Epoch: 13, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 14 cost time: 0.5472955703735352
Epoch: 14, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 15 cost time: 0.7494583129882812
Epoch: 15, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 16 cost time: 0.48984408378601074
Epoch: 16, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 17 cost time: 0.47683262825012207
Epoch: 17, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 18 cost time: 0.5887525081634521
Epoch: 18, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 19 cost time: 0.519378662109375
Epoch: 19, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 20 cost time: 0.6113662719726562
Epoch: 20, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 21 cost time: 0.5347878932952881
Epoch: 21, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 22 cost time: 0.5830404758453369
Epoch: 22, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 23 cost time: 0.47504496574401855
Epoch: 23, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 24 cost time: 0.5547184944152832
Epoch: 24, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 25 cost time: 0.4551990032196045
Epoch: 25, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 26 cost time: 0.7266089916229248
Epoch: 26, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.253 Vali Acc: 0.200 Test Loss: 1.253 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5789403915405273
Epoch: 27, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.251 Vali Acc: 0.200 Test Loss: 1.251 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5447893142700195
Epoch: 28, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.250 Vali Acc: 0.200 Test Loss: 1.250 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6023073196411133
Epoch: 29, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.248 Vali Acc: 0.200 Test Loss: 1.248 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5688779354095459
Epoch: 30, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.247 Vali Acc: 0.200 Test Loss: 1.247 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5072064399719238
Epoch: 31, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5489010810852051
Epoch: 32, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5333917140960693
Epoch: 33, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.243 Vali Acc: 0.200 Test Loss: 1.243 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.683264970779419
Epoch: 34, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.241 Vali Acc: 0.200 Test Loss: 1.241 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5226023197174072
Epoch: 35, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.240 Vali Acc: 0.200 Test Loss: 1.240 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 12595
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.458928346633911
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.354 Vali Acc: 0.267 Test Loss: 1.354 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 0.5234377384185791
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.338 Vali Acc: 0.267 Test Loss: 1.338 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 3 cost time: 0.5047023296356201
Epoch: 3, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.323 Vali Acc: 0.267 Test Loss: 1.323 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 4 cost time: 0.583176851272583
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.311 Vali Acc: 0.267 Test Loss: 1.311 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5286386013031006
Epoch: 5, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.5111269950866699
Epoch: 6, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5107767581939697
Epoch: 7, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.523552417755127
Epoch: 8, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.44548606872558594
Epoch: 9, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.48425745964050293
Epoch: 10, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.5569238662719727
Epoch: 11, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 0.47014474868774414
Epoch: 12, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 0.46015167236328125
Epoch: 13, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 14 cost time: 0.5126433372497559
Epoch: 14, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.268 Vali Acc: 0.267 Test Loss: 1.268 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 15 cost time: 0.4421365261077881
Epoch: 15, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 16 cost time: 0.48412370681762695
Epoch: 16, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 17 cost time: 0.46681833267211914
Epoch: 17, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.4916810989379883
Epoch: 18, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.266 Vali Acc: 0.333 Test Loss: 1.266 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.48052263259887695
Epoch: 19, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.266 Vali Acc: 0.333 Test Loss: 1.266 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 0.4788665771484375
Epoch: 20, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.442859411239624
Epoch: 21, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.44814443588256836
Epoch: 22, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.265 Vali Acc: 0.267 Test Loss: 1.265 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.43315720558166504
Epoch: 23, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 0.3878357410430908
Epoch: 24, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 25 cost time: 0.5076520442962646
Epoch: 25, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 26 cost time: 0.5453157424926758
Epoch: 26, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5883088111877441
Epoch: 27, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4569380283355713
Epoch: 28, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.39298439025878906
Epoch: 29, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 30 cost time: 0.5600085258483887
Epoch: 30, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5195136070251465
Epoch: 31, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5543062686920166
Epoch: 32, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5097229480743408
Epoch: 33, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 34 cost time: 0.5997908115386963
Epoch: 34, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 35 cost time: 0.5631074905395508
Epoch: 35, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5226008892059326
Epoch: 36, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5676453113555908
Epoch: 37, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5565741062164307
Epoch: 38, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5077767372131348
Epoch: 39, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5213842391967773
Epoch: 40, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5996527671813965
Epoch: 41, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5568258762359619
Epoch: 42, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5660216808319092
Epoch: 43, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6873562335968018
Epoch: 44, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 12435
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3424394130706787
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5341899394989014
Epoch: 2, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5496640205383301
Epoch: 3, Steps: 1 | Train Loss: 1.437 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5209238529205322
Epoch: 4, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.49811482429504395
Epoch: 5, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5420572757720947
Epoch: 6, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4876861572265625
Epoch: 7, Steps: 1 | Train Loss: 1.297 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4498622417449951
Epoch: 8, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5938241481781006
Epoch: 9, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.38979530334472656
Epoch: 10, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.43158555030822754
Epoch: 11, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4629526138305664
Epoch: 12, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.46449971199035645
Epoch: 13, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4674265384674072
Epoch: 14, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4955160617828369
Epoch: 15, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.45941805839538574
Epoch: 16, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4942662715911865
Epoch: 17, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.49139833450317383
Epoch: 18, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4649171829223633
Epoch: 19, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5057761669158936
Epoch: 20, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5082674026489258
Epoch: 21, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4739682674407959
Epoch: 22, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5546309947967529
Epoch: 23, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5496737957000732
Epoch: 24, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.49607372283935547
Epoch: 25, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5941629409790039
Epoch: 26, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5151896476745605
Epoch: 27, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12659
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5095272064208984
Epoch: 1, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4868645668029785
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47901368141174316
Epoch: 3, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.589702844619751
Epoch: 4, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.548445463180542
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.503821611404419
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5952813625335693
Epoch: 7, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5092177391052246
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7014894485473633
Epoch: 9, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5215563774108887
Epoch: 10, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5082616806030273
Epoch: 11, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.289 Vali Acc: 0.267 Test Loss: 1.289 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df256_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 12979
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.150501012802124
Epoch: 1, Steps: 1 | Train Loss: 1.361 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.536696195602417
Epoch: 2, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.52754807472229
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.48598647117614746
Epoch: 4, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5929555892944336
Epoch: 5, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.543267011642456
Epoch: 6, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.5232510566711426
Epoch: 7, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6069426536560059
Epoch: 8, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4951920509338379
Epoch: 9, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.5343077182769775
Epoch: 10, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.43011045455932617
Epoch: 11, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.49645113945007324
Epoch: 12, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.530418872833252
Epoch: 13, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5068116188049316
Epoch: 14, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4664483070373535
Epoch: 15, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5343127250671387
Epoch: 16, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.49448728561401367
Epoch: 17, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4798092842102051
Epoch: 18, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.49536657333374023
Epoch: 19, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4572596549987793
Epoch: 20, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5351934432983398
Epoch: 21, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.43976330757141113
Epoch: 22, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 13363
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1061151027679443
Epoch: 1, Steps: 1 | Train Loss: 1.357 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5110447406768799
Epoch: 2, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4971425533294678
Epoch: 3, Steps: 1 | Train Loss: 1.353 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5771207809448242
Epoch: 4, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5124897956848145
Epoch: 5, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.532475471496582
Epoch: 6, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5097639560699463
Epoch: 7, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5411057472229004
Epoch: 8, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.5816473960876465
Epoch: 9, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5395693778991699
Epoch: 10, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6814329624176025
Epoch: 11, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.592339277267456
Epoch: 12, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.53314208984375
Epoch: 13, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.586205005645752
Epoch: 14, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5413899421691895
Epoch: 15, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5521974563598633
Epoch: 16, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6031124591827393
Epoch: 17, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5393846035003662
Epoch: 18, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6125855445861816
Epoch: 19, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 9779
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2975027561187744
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5297787189483643
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.504711389541626
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.6521010398864746
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5337512493133545
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5443034172058105
Epoch: 6, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5629522800445557
Epoch: 7, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5658566951751709
Epoch: 8, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.608069658279419
Epoch: 9, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5035736560821533
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.5038962364196777
Epoch: 11, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5297846794128418
Epoch: 12, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.47528624534606934
Epoch: 13, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5222136974334717
Epoch: 14, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4747490882873535
Epoch: 15, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5331480503082275
Epoch: 16, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5823180675506592
Epoch: 17, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5017738342285156
Epoch: 18, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5919134616851807
Epoch: 19, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.44223713874816895
Epoch: 20, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 8691
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0659966468811035
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5995290279388428
Epoch: 2, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.289 Vali Acc: 0.200 Test Loss: 1.289 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48595213890075684
Epoch: 3, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.290 Vali Acc: 0.200 Test Loss: 1.290 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49330830574035645
Epoch: 4, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.291 Vali Acc: 0.200 Test Loss: 1.291 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.501326322555542
Epoch: 5, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4991621971130371
Epoch: 6, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.556908369064331
Epoch: 7, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5463583469390869
Epoch: 8, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5758702754974365
Epoch: 9, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.301 Vali Acc: 0.267 Test Loss: 1.301 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5137300491333008
Epoch: 10, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.536412239074707
Epoch: 11, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 8371
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2796695232391357
Epoch: 1, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5949504375457764
Epoch: 2, Steps: 1 | Train Loss: 1.368 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4819779396057129
Epoch: 3, Steps: 1 | Train Loss: 1.338 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4685397148132324
Epoch: 4, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5653591156005859
Epoch: 5, Steps: 1 | Train Loss: 1.301 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5349159240722656
Epoch: 6, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.48593568801879883
Epoch: 7, Steps: 1 | Train Loss: 1.310 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4964864253997803
Epoch: 8, Steps: 1 | Train Loss: 1.362 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5131454467773438
Epoch: 9, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5637245178222656
Epoch: 10, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5818932056427002
Epoch: 11, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4974977970123291
Epoch: 12, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5127215385437012
Epoch: 13, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4425392150878906
Epoch: 14, Steps: 1 | Train Loss: 1.321 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5132482051849365
Epoch: 15, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5666553974151611
Epoch: 16, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.46202635765075684
Epoch: 17, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.5458049774169922
Epoch: 18, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.48140406608581543
Epoch: 19, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.48551225662231445
Epoch: 20, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4902157783508301
Epoch: 21, Steps: 1 | Train Loss: 1.301 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.460737943649292
Epoch: 22, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.47559547424316406
Epoch: 23, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.49492883682250977
Epoch: 24, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5245656967163086
Epoch: 25, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.49536824226379395
Epoch: 26, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.47146034240722656
Epoch: 27, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.454509973526001
Epoch: 28, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.51369309425354
Epoch: 29, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 8211
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9676909446716309
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4697146415710449
Epoch: 2, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6019351482391357
Epoch: 3, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5160801410675049
Epoch: 4, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5849239826202393
Epoch: 5, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4812760353088379
Epoch: 6, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5416972637176514
Epoch: 7, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5204873085021973
Epoch: 8, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.5941793918609619
Epoch: 9, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5259804725646973
Epoch: 10, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5792131423950195
Epoch: 11, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5802552700042725
Epoch: 12, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.5439600944519043
Epoch: 13, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.5220403671264648
Epoch: 14, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.5538311004638672
Epoch: 15, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.5038726329803467
Epoch: 16, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.7272109985351562
Epoch: 17, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.5146470069885254
Epoch: 18, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.43998289108276367
Epoch: 19, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.5069270133972168
Epoch: 20, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.4963257312774658
Epoch: 21, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.5129871368408203
Epoch: 22, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 0.5727090835571289
Epoch: 23, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.5508031845092773
Epoch: 24, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 0.5974609851837158
Epoch: 25, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 0.5604069232940674
Epoch: 26, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 27 cost time: 0.5753145217895508
Epoch: 27, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 28 cost time: 0.6111040115356445
Epoch: 28, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 29 cost time: 0.534536600112915
Epoch: 29, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.6621501445770264
Epoch: 30, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.4680173397064209
Epoch: 31, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 0.5590457916259766
Epoch: 32, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 0.5034918785095215
Epoch: 33, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 0.5190472602844238
Epoch: 34, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 0.49741291999816895
Epoch: 35, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 0.4955718517303467
Epoch: 36, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 0.447939395904541
Epoch: 37, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 38 cost time: 0.46257829666137695
Epoch: 38, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 39 cost time: 0.4862527847290039
Epoch: 39, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 40 cost time: 0.5591778755187988
Epoch: 40, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 41 cost time: 0.5559232234954834
Epoch: 41, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 42 cost time: 0.4664316177368164
Epoch: 42, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 43 cost time: 0.6782739162445068
Epoch: 43, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 44 cost time: 0.5328514575958252
Epoch: 44, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 45 cost time: 0.6969282627105713
Epoch: 45, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 46 cost time: 0.5615592002868652
Epoch: 46, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 47 cost time: 0.5352301597595215
Epoch: 47, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5254743099212646
Epoch: 48, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.46172595024108887
Epoch: 49, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.45464205741882324
Epoch: 50, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.43982553482055664
Epoch: 51, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8155074119567871
Epoch: 52, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5284719467163086
Epoch: 53, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.49135470390319824
Epoch: 54, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5368773937225342
Epoch: 55, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.4755895137786865
Epoch: 56, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 57 cost time: 0.543062686920166
Epoch: 57, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5889720916748047
Epoch: 58, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6036396026611328
Epoch: 59, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5582911968231201
Epoch: 60, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 61 cost time: 0.5158627033233643
Epoch: 61, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6002705097198486
Epoch: 62, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 63 cost time: 0.5293002128601074
Epoch: 63, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 64 cost time: 0.5993726253509521
Epoch: 64, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6639866828918457
Epoch: 65, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 66 cost time: 0.550896406173706
Epoch: 66, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6068038940429688
Epoch: 67, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 68 cost time: 0.6517982482910156
Epoch: 68, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5805773735046387
Epoch: 69, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.5742218494415283
Epoch: 70, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5771849155426025
Epoch: 71, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.5083904266357422
Epoch: 72, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5734281539916992
Epoch: 73, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.7246923446655273
Epoch: 74, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.5662424564361572
Epoch: 75, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.5892817974090576
Epoch: 76, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.5784666538238525
Epoch: 77, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 8435
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3285346031188965
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6456236839294434
Epoch: 2, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5072369575500488
Epoch: 3, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5300228595733643
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.506615400314331
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.47341132164001465
Epoch: 6, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5210435390472412
Epoch: 7, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4666924476623535
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.43491172790527344
Epoch: 9, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4183793067932129
Epoch: 10, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.41183018684387207
Epoch: 11, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4866178035736084
Epoch: 12, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.47074007987976074
Epoch: 13, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.47768521308898926
Epoch: 14, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.43736696243286133
Epoch: 15, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5495800971984863
Epoch: 16, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4781534671783447
Epoch: 17, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.4314885139465332
Epoch: 18, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.5058090686798096
Epoch: 19, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.43233346939086914
Epoch: 20, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.5483758449554443
Epoch: 21, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.44339418411254883
Epoch: 22, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.5942471027374268
Epoch: 23, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.4633514881134033
Epoch: 24, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.4592466354370117
Epoch: 25, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.47983241081237793
Epoch: 26, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.3777904510498047
Epoch: 27, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.4643101692199707
Epoch: 28, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.462604284286499
Epoch: 29, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4492833614349365
Epoch: 30, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.48332762718200684
Epoch: 31, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5481109619140625
Epoch: 32, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.45301342010498047
Epoch: 33, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.4914205074310303
Epoch: 34, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 0.4753429889678955
Epoch: 35, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 0.5151293277740479
Epoch: 36, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 0.48750877380371094
Epoch: 37, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5037355422973633
Epoch: 38, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5128633975982666
Epoch: 39, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4180119037628174
Epoch: 40, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5106687545776367
Epoch: 41, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.47638773918151855
Epoch: 42, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5816295146942139
Epoch: 43, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.489565372467041
Epoch: 44, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5046887397766113
Epoch: 45, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6913371086120605
Epoch: 46, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df128_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 8755
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3668367862701416
Epoch: 1, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5236165523529053
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4911496639251709
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4879317283630371
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.554844856262207
Epoch: 5, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5328872203826904
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6017413139343262
Epoch: 7, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.49393558502197266
Epoch: 8, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.58852219581604
Epoch: 9, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5352115631103516
Epoch: 10, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5391080379486084
Epoch: 11, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11251
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.161059617996216
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.48491573333740234
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4546229839324951
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4886965751647949
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4331328868865967
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5270371437072754
Epoch: 6, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5076978206634521
Epoch: 7, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.45528316497802734
Epoch: 8, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4465963840484619
Epoch: 9, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.48232245445251465
Epoch: 10, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.49543023109436035
Epoch: 11, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.4834327697753906
Epoch: 12, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.41172003746032715
Epoch: 13, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.4674110412597656
Epoch: 14, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4868171215057373
Epoch: 15, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.4643065929412842
Epoch: 16, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6031718254089355
Epoch: 17, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5157461166381836
Epoch: 18, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5425171852111816
Epoch: 19, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5831084251403809
Epoch: 20, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6252765655517578
Epoch: 21, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6031434535980225
Epoch: 22, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5235323905944824
Epoch: 23, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4962656497955322
Epoch: 24, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5123324394226074
Epoch: 25, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 7667
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4838361740112305
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5214307308197021
Epoch: 2, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5622828006744385
Epoch: 3, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5339717864990234
Epoch: 4, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5958783626556396
Epoch: 5, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.6691164970397949
Epoch: 6, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6444101333618164
Epoch: 7, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6190640926361084
Epoch: 8, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5126643180847168
Epoch: 9, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5458319187164307
Epoch: 10, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4548616409301758
Epoch: 11, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5357043743133545
Epoch: 12, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4512002468109131
Epoch: 13, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5201892852783203
Epoch: 14, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4749436378479004
Epoch: 15, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 6579
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.012637138366699
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.340 Vali Acc: 0.267 Test Loss: 1.340 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 0.5583887100219727
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.327 Vali Acc: 0.267 Test Loss: 1.327 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 3 cost time: 0.4761340618133545
Epoch: 3, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.316 Vali Acc: 0.267 Test Loss: 1.316 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.441300630569458
Epoch: 4, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.5019352436065674
Epoch: 5, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5523571968078613
Epoch: 6, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.46855854988098145
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.291 Vali Acc: 0.267 Test Loss: 1.291 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5048472881317139
Epoch: 8, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4884486198425293
Epoch: 9, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.518963098526001
Epoch: 10, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.49707841873168945
Epoch: 11, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6355240345001221
Epoch: 12, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5657250881195068
Epoch: 13, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6334757804870605
Epoch: 14, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6259
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4507293701171875
Epoch: 1, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5825436115264893
Epoch: 2, Steps: 1 | Train Loss: 1.355 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6723423004150391
Epoch: 3, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5685460567474365
Epoch: 4, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6062159538269043
Epoch: 5, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5111947059631348
Epoch: 6, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5967006683349609
Epoch: 7, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5154011249542236
Epoch: 8, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5777747631072998
Epoch: 9, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5311281681060791
Epoch: 10, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5320329666137695
Epoch: 11, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6099
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1758999824523926
Epoch: 1, Steps: 1 | Train Loss: 1.592 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 0.5172028541564941
Epoch: 2, Steps: 1 | Train Loss: 1.294 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.59175705909729
Epoch: 3, Steps: 1 | Train Loss: 1.693 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.621675968170166
Epoch: 4, Steps: 1 | Train Loss: 1.367 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.6342251300811768
Epoch: 5, Steps: 1 | Train Loss: 1.392 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.5470268726348877
Epoch: 6, Steps: 1 | Train Loss: 1.473 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.6444456577301025
Epoch: 7, Steps: 1 | Train Loss: 1.402 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 8 cost time: 0.5297751426696777
Epoch: 8, Steps: 1 | Train Loss: 1.329 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 9 cost time: 0.6009306907653809
Epoch: 9, Steps: 1 | Train Loss: 1.379 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 10 cost time: 0.7494885921478271
Epoch: 10, Steps: 1 | Train Loss: 1.239 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 11 cost time: 0.49262142181396484
Epoch: 11, Steps: 1 | Train Loss: 1.292 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 12 cost time: 0.5550558567047119
Epoch: 12, Steps: 1 | Train Loss: 1.351 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.5464189052581787
Epoch: 13, Steps: 1 | Train Loss: 1.302 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.5563614368438721
Epoch: 14, Steps: 1 | Train Loss: 1.312 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.593207597732544
Epoch: 15, Steps: 1 | Train Loss: 1.327 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.6328628063201904
Epoch: 16, Steps: 1 | Train Loss: 1.289 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5536651611328125
Epoch: 17, Steps: 1 | Train Loss: 1.295 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5310146808624268
Epoch: 18, Steps: 1 | Train Loss: 1.270 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6387407779693604
Epoch: 19, Steps: 1 | Train Loss: 1.266 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.6302964687347412
Epoch: 20, Steps: 1 | Train Loss: 1.310 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.5679099559783936
Epoch: 21, Steps: 1 | Train Loss: 1.228 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.5728409290313721
Epoch: 22, Steps: 1 | Train Loss: 1.153 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5568320751190186
Epoch: 23, Steps: 1 | Train Loss: 1.144 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5596959590911865
Epoch: 24, Steps: 1 | Train Loss: 1.214 Vali Loss: 0.967 Vali Acc: 0.467 Test Loss: 0.967 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5914831161499023
Epoch: 25, Steps: 1 | Train Loss: 1.133 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5213921070098877
Epoch: 26, Steps: 1 | Train Loss: 1.178 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5211257934570312
Epoch: 27, Steps: 1 | Train Loss: 1.127 Vali Loss: 0.965 Vali Acc: 0.467 Test Loss: 0.965 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4464092254638672
Epoch: 28, Steps: 1 | Train Loss: 1.084 Vali Loss: 0.964 Vali Acc: 0.467 Test Loss: 0.964 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5893175601959229
Epoch: 29, Steps: 1 | Train Loss: 1.266 Vali Loss: 0.962 Vali Acc: 0.467 Test Loss: 0.962 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.45860767364501953
Epoch: 30, Steps: 1 | Train Loss: 1.133 Vali Loss: 0.962 Vali Acc: 0.467 Test Loss: 0.962 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4875915050506592
Epoch: 31, Steps: 1 | Train Loss: 1.107 Vali Loss: 0.961 Vali Acc: 0.467 Test Loss: 0.961 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6323
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.169297933578491
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.338 Vali Acc: 0.200 Test Loss: 1.338 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.5586059093475342
Epoch: 2, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.336 Vali Acc: 0.200 Test Loss: 1.336 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.5141696929931641
Epoch: 3, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.333 Vali Acc: 0.067 Test Loss: 1.333 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6772327423095703
Epoch: 4, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.331 Vali Acc: 0.067 Test Loss: 1.331 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.667006254196167
Epoch: 5, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.330 Vali Acc: 0.067 Test Loss: 1.330 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5622620582580566
Epoch: 6, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.329 Vali Acc: 0.067 Test Loss: 1.329 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.45558881759643555
Epoch: 7, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.328 Vali Acc: 0.067 Test Loss: 1.328 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5817184448242188
Epoch: 8, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.328 Vali Acc: 0.067 Test Loss: 1.328 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6115806102752686
Epoch: 9, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.328 Vali Acc: 0.067 Test Loss: 1.328 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5918803215026855
Epoch: 10, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.329 Vali Acc: 0.067 Test Loss: 1.329 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.49669361114501953
Epoch: 11, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.329 Vali Acc: 0.067 Test Loss: 1.329 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6960375308990479
Epoch: 12, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.329 Vali Acc: 0.067 Test Loss: 1.329 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_PatchTST_UEA_ftM_sl640_ll0_pl0_el1_dm16_nh4_df64_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 6643
model size : 0.34MB
